var Mpe=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var u$e=Mpe(TT=>{function Cpe(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var Epe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rD(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ipe(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var TQ={exports:{}},iD={},MQ={exports:{}},Ji={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eC=Symbol.for("react.element"),Ppe=Symbol.for("react.portal"),Rpe=Symbol.for("react.fragment"),Lpe=Symbol.for("react.strict_mode"),Dpe=Symbol.for("react.profiler"),Bpe=Symbol.for("react.provider"),kpe=Symbol.for("react.context"),Ope=Symbol.for("react.forward_ref"),Fpe=Symbol.for("react.suspense"),Npe=Symbol.for("react.memo"),zpe=Symbol.for("react.lazy"),Nj=Symbol.iterator;function Upe(n){return n===null||typeof n!="object"?null:(n=Nj&&n[Nj]||n["@@iterator"],typeof n=="function"?n:null)}var CQ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EQ=Object.assign,IQ={};function Lw(n,e,t){this.props=n,this.context=e,this.refs=IQ,this.updater=t||CQ}Lw.prototype.isReactComponent={};Lw.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Lw.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function PQ(){}PQ.prototype=Lw.prototype;function xU(n,e,t){this.props=n,this.context=e,this.refs=IQ,this.updater=t||CQ}var bU=xU.prototype=new PQ;bU.constructor=xU;EQ(bU,Lw.prototype);bU.isPureReactComponent=!0;var zj=Array.isArray,RQ=Object.prototype.hasOwnProperty,wU={current:null},LQ={key:!0,ref:!0,__self:!0,__source:!0};function DQ(n,e,t){var r,s={},o=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(o=""+e.key),e)RQ.call(e,r)&&!LQ.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){for(var a=Array(c),d=0;d<c;d++)a[d]=arguments[d+2];s.children=a}if(n&&n.defaultProps)for(r in c=n.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:eC,type:n,key:o,ref:l,props:s,_owner:wU.current}}function Gpe(n,e){return{$$typeof:eC,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function SU(n){return typeof n=="object"&&n!==null&&n.$$typeof===eC}function Vpe(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Uj=/\/+/g;function gO(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Vpe(""+n.key):e.toString(36)}function oP(n,e,t,r,s){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var l=!1;if(n===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(n.$$typeof){case eC:case Ppe:l=!0}}if(l)return l=n,s=s(l),n=r===""?"."+gO(l,0):r,zj(s)?(t="",n!=null&&(t=n.replace(Uj,"$&/")+"/"),oP(s,e,t,"",function(d){return d})):s!=null&&(SU(s)&&(s=Gpe(s,t+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Uj,"$&/")+"/")+n)),e.push(s)),1;if(l=0,r=r===""?".":r+":",zj(n))for(var c=0;c<n.length;c++){o=n[c];var a=r+gO(o,c);l+=oP(o,e,t,a,s)}else if(a=Upe(n),typeof a=="function")for(n=a.call(n),c=0;!(o=n.next()).done;)o=o.value,a=r+gO(o,c++),l+=oP(o,e,t,a,s);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function kE(n,e,t){if(n==null)return n;var r=[],s=0;return oP(n,r,"","",function(o){return e.call(t,o,s++)}),r}function Hpe(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Oc={current:null},aP={transition:null},jpe={ReactCurrentDispatcher:Oc,ReactCurrentBatchConfig:aP,ReactCurrentOwner:wU};Ji.Children={map:kE,forEach:function(n,e,t){kE(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return kE(n,function(){e++}),e},toArray:function(n){return kE(n,function(e){return e})||[]},only:function(n){if(!SU(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ji.Component=Lw;Ji.Fragment=Rpe;Ji.Profiler=Dpe;Ji.PureComponent=xU;Ji.StrictMode=Lpe;Ji.Suspense=Fpe;Ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jpe;Ji.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=EQ({},n.props),s=n.key,o=n.ref,l=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,l=wU.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var c=n.type.defaultProps;for(a in e)RQ.call(e,a)&&!LQ.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&c!==void 0?c[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){c=Array(a);for(var d=0;d<a;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:eC,type:n.type,key:s,ref:o,props:r,_owner:l}};Ji.createContext=function(n){return n={$$typeof:kpe,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Bpe,_context:n},n.Consumer=n};Ji.createElement=DQ;Ji.createFactory=function(n){var e=DQ.bind(null,n);return e.type=n,e};Ji.createRef=function(){return{current:null}};Ji.forwardRef=function(n){return{$$typeof:Ope,render:n}};Ji.isValidElement=SU;Ji.lazy=function(n){return{$$typeof:zpe,_payload:{_status:-1,_result:n},_init:Hpe}};Ji.memo=function(n,e){return{$$typeof:Npe,type:n,compare:e===void 0?null:e}};Ji.startTransition=function(n){var e=aP.transition;aP.transition={};try{n()}finally{aP.transition=e}};Ji.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ji.useCallback=function(n,e){return Oc.current.useCallback(n,e)};Ji.useContext=function(n){return Oc.current.useContext(n)};Ji.useDebugValue=function(){};Ji.useDeferredValue=function(n){return Oc.current.useDeferredValue(n)};Ji.useEffect=function(n,e){return Oc.current.useEffect(n,e)};Ji.useId=function(){return Oc.current.useId()};Ji.useImperativeHandle=function(n,e,t){return Oc.current.useImperativeHandle(n,e,t)};Ji.useInsertionEffect=function(n,e){return Oc.current.useInsertionEffect(n,e)};Ji.useLayoutEffect=function(n,e){return Oc.current.useLayoutEffect(n,e)};Ji.useMemo=function(n,e){return Oc.current.useMemo(n,e)};Ji.useReducer=function(n,e,t){return Oc.current.useReducer(n,e,t)};Ji.useRef=function(n){return Oc.current.useRef(n)};Ji.useState=function(n){return Oc.current.useState(n)};Ji.useSyncExternalStore=function(n,e,t){return Oc.current.useSyncExternalStore(n,e,t)};Ji.useTransition=function(){return Oc.current.useTransition()};Ji.version="18.2.0";MQ.exports=Ji;var _e=MQ.exports;const Al=rD(_e),UP=Cpe({__proto__:null,default:Al},[_e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wpe=_e,$pe=Symbol.for("react.element"),Xpe=Symbol.for("react.fragment"),qpe=Object.prototype.hasOwnProperty,Ype=Wpe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zpe={key:!0,ref:!0,__self:!0,__source:!0};function BQ(n,e,t){var r,s={},o=null,l=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)qpe.call(e,r)&&!Zpe.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:$pe,type:n,key:o,ref:l,props:s,_owner:Ype.current}}iD.Fragment=Xpe;iD.jsx=BQ;iD.jsxs=BQ;TQ.exports=iD;var pe=TQ.exports;const vi=n=>typeof n=="string",OS=()=>{let n,e;const t=new Promise((r,s)=>{n=r,e=s});return t.resolve=n,t.reject=e,t},Gj=n=>n==null?"":""+n,Kpe=(n,e,t)=>{n.forEach(r=>{e[r]&&(t[r]=e[r])})},Jpe=/###/g,Vj=n=>n&&n.indexOf("###")>-1?n.replace(Jpe,"."):n,Hj=n=>!n||vi(n),rT=(n,e,t)=>{const r=vi(e)?e.split("."):e;let s=0;for(;s<r.length-1;){if(Hj(n))return{};const o=Vj(r[s]);!n[o]&&t&&(n[o]=new t),Object.prototype.hasOwnProperty.call(n,o)?n=n[o]:n={},++s}return Hj(n)?{}:{obj:n,k:Vj(r[s])}},jj=(n,e,t)=>{const{obj:r,k:s}=rT(n,e,Object);if(r!==void 0||e.length===1){r[s]=t;return}let o=e[e.length-1],l=e.slice(0,e.length-1),c=rT(n,l,Object);for(;c.obj===void 0&&l.length;)o=`${l[l.length-1]}.${o}`,l=l.slice(0,l.length-1),c=rT(n,l,Object),c!=null&&c.obj&&typeof c.obj[`${c.k}.${o}`]<"u"&&(c.obj=void 0);c.obj[`${c.k}.${o}`]=t},Qpe=(n,e,t,r)=>{const{obj:s,k:o}=rT(n,e,Object);s[o]=s[o]||[],s[o].push(t)},GP=(n,e)=>{const{obj:t,k:r}=rT(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r]},eme=(n,e,t)=>{const r=GP(n,t);return r!==void 0?r:GP(e,t)},kQ=(n,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in n?vi(n[r])||n[r]instanceof String||vi(e[r])||e[r]instanceof String?t&&(n[r]=e[r]):kQ(n[r],e[r],t):n[r]=e[r]);return n},_1=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var tme={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const nme=n=>vi(n)?n.replace(/[&<>"'\/]/g,e=>tme[e]):n;class rme{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const ime=[" ",",","?","!",";"],sme=new rme(20),ome=(n,e,t)=>{e=e||"",t=t||"";const r=ime.filter(l=>e.indexOf(l)<0&&t.indexOf(l)<0);if(r.length===0)return!0;const s=sme.getRegExp(`(${r.map(l=>l==="?"?"\\?":l).join("|")})`);let o=!s.test(n);if(!o){const l=n.indexOf(t);l>0&&!s.test(n.substring(0,l))&&(o=!0)}return o},QN=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const r=e.split(t);let s=n;for(let o=0;o<r.length;){if(!s||typeof s!="object")return;let l,c="";for(let a=o;a<r.length;++a)if(a!==o&&(c+=t),c+=r[a],l=s[c],l!==void 0){if(["string","number","boolean"].indexOf(typeof l)>-1&&a<r.length-1)continue;o+=a-o+1;break}s=l}return s},VP=n=>n==null?void 0:n.replace("_","-"),ame={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,r;(r=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||r.call(t,console,e)}};class HP{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||ame,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,s){return s&&!this.debug?null:(vi(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new HP(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new HP(this.logger,e)}}var op=new HP;class sD{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(t)||0;this.observers[r].set(t,s+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(l=>{let[c,a]=l;for(let d=0;d<a;d++)c(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(l=>{let[c,a]=l;for(let d=0;d<a;d++)c.apply(c,[e,...r])})}}class Wj extends sD{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){var d,f;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,l=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;e.indexOf(".")>-1?c=e.split("."):(c=[e,t],r&&(Array.isArray(r)?c.push(...r):vi(r)&&o?c.push(...r.split(o)):c.push(r)));const a=GP(this.data,c);return!a&&!t&&!r&&e.indexOf(".")>-1&&(e=c[0],t=c[1],r=c.slice(2).join(".")),a||!l||!vi(r)?a:QN((f=(d=this.data)==null?void 0:d[e])==null?void 0:f[t],r,o)}addResource(e,t,r,s){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const l=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let c=[e,t];r&&(c=c.concat(l?r.split(l):r)),e.indexOf(".")>-1&&(c=e.split("."),s=t,t=c[1]),this.addNamespaces(t),jj(this.data,c,s),o.silent||this.emit("added",e,t,r,s)}addResources(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const o in r)(vi(r[o])||Array.isArray(r[o]))&&this.addResource(e,t,o,r[o],{silent:!0});s.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,s,o){let l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},c=[e,t];e.indexOf(".")>-1&&(c=e.split("."),s=r,r=t,t=c[1]),this.addNamespaces(t);let a=GP(this.data,c)||{};l.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?kQ(a,r,o):a={...a,...r},jj(this.data,c,a),l.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(s=>t[s]&&Object.keys(t[s]).length>0)}toJSON(){return this.data}}var OQ={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,r,s){return n.forEach(o=>{var l;e=((l=this.processors[o])==null?void 0:l.process(e,t,r,s))??e}),e}};const $j={};class jP extends sD{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Kpe(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=op.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,t);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const l=r&&e.indexOf(r)>-1,c=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!ome(e,r,s);if(l&&!c){const a=e.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:e,namespaces:vi(o)?[o]:o};const d=e.split(r);(r!==s||r===s&&this.options.ns.indexOf(d[0])>-1)&&(o=d.shift()),e=d.join(s)}return{key:e,namespaces:vi(o)?[o]:o}}translate(e,t,r){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const s=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,o=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],t),a=c[c.length-1],d=t.lng||this.language,f=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((d==null?void 0:d.toLowerCase())==="cimode"){if(f){const H=t.nsSeparator||this.options.nsSeparator;return s?{res:`${a}${H}${l}`,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:a,usedParams:this.getUsedParamsDetails(t)}:`${a}${H}${l}`}return s?{res:l,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:a,usedParams:this.getUsedParamsDetails(t)}:l}const m=this.resolve(e,t);let _=m==null?void 0:m.res;const x=(m==null?void 0:m.usedKey)||l,A=(m==null?void 0:m.exactUsedKey)||l,I=Object.prototype.toString.apply(_),E=["[object Number]","[object Function]","[object RegExp]"],C=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,L=!this.i18nFormat||this.i18nFormat.handleAsObject,O=!vi(_)&&typeof _!="boolean"&&typeof _!="number";if(L&&_&&O&&E.indexOf(I)<0&&!(vi(C)&&Array.isArray(_))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const H=this.options.returnedObjectHandler?this.options.returnedObjectHandler(x,_,{...t,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return s?(m.res=H,m.usedParams=this.getUsedParamsDetails(t),m):H}if(o){const H=Array.isArray(_),q=H?[]:{},Z=H?A:x;for(const J in _)if(Object.prototype.hasOwnProperty.call(_,J)){const re=`${Z}${o}${J}`;q[J]=this.translate(re,{...t,joinArrays:!1,ns:c}),q[J]===re&&(q[J]=_[J])}_=q}}else if(L&&vi(C)&&Array.isArray(_))_=_.join(C),_&&(_=this.extendTranslation(_,e,t,r));else{let H=!1,q=!1;const Z=t.count!==void 0&&!vi(t.count),J=jP.hasDefaultValue(t),re=Z?this.pluralResolver.getSuffix(d,t.count,t):"",se=t.ordinal&&Z?this.pluralResolver.getSuffix(d,t.count,{ordinal:!1}):"",ae=Z&&!t.ordinal&&t.count===0,he=ae&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${re}`]||t[`defaultValue${se}`]||t.defaultValue;!this.isValidLookup(_)&&J&&(H=!0,_=he),this.isValidLookup(_)||(q=!0,_=l);const Ee=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&q?void 0:_,Pe=J&&he!==_&&this.options.updateMissing;if(q||H||Pe){if(this.logger.log(Pe?"updateKey":"missingKey",d,a,l,Pe?he:_),o){const ye=this.resolve(l,{...t,keySeparator:!1});ye&&ye.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ze=[];const Re=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Re&&Re[0])for(let ye=0;ye<Re.length;ye++)ze.push(Re[ye]);else this.options.saveMissingTo==="all"?ze=this.languageUtils.toResolveHierarchy(t.lng||this.language):ze.push(t.lng||this.language);const rt=(ye,We,Ue)=>{var vt;const gt=J&&Ue!==_?Ue:Ee;this.options.missingKeyHandler?this.options.missingKeyHandler(ye,a,We,gt,Pe,t):(vt=this.backendConnector)!=null&&vt.saveMissing&&this.backendConnector.saveMissing(ye,a,We,gt,Pe,t),this.emit("missingKey",ye,a,We,_)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Z?ze.forEach(ye=>{const We=this.pluralResolver.getSuffixes(ye,t);ae&&t[`defaultValue${this.options.pluralSeparator}zero`]&&We.indexOf(`${this.options.pluralSeparator}zero`)<0&&We.push(`${this.options.pluralSeparator}zero`),We.forEach(Ue=>{rt([ye],l+Ue,t[`defaultValue${Ue}`]||he)})}):rt(ze,l,he))}_=this.extendTranslation(_,e,t,m,r),q&&_===l&&this.options.appendNamespaceToMissingKey&&(_=`${a}:${l}`),(q||H)&&this.options.parseMissingKeyHandler&&(_=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${a}:${l}`:l,H?_:void 0))}return s?(m.res=_,m.usedParams=this.getUsedParamsDetails(t),m):_}extendTranslation(e,t,r,s,o){var d,f;var l=this;if((d=this.i18nFormat)!=null&&d.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const m=vi(e)&&(((f=r==null?void 0:r.interpolation)==null?void 0:f.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let _;if(m){const A=e.match(this.interpolator.nestingRegexp);_=A&&A.length}let x=r.replace&&!vi(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(x={...this.options.interpolation.defaultVariables,...x}),e=this.interpolator.interpolate(e,x,r.lng||this.language||s.usedLng,r),m){const A=e.match(this.interpolator.nestingRegexp),I=A&&A.length;_<I&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var A=arguments.length,I=new Array(A),E=0;E<A;E++)I[E]=arguments[E];return(o==null?void 0:o[0])===I[0]&&!r.context?(l.logger.warn(`It seems you are nesting recursively key: ${I[0]} in key: ${t[0]}`),null):l.translate(...I,t)},r)),r.interpolation&&this.interpolator.reset()}const c=r.postProcess||this.options.postProcess,a=vi(c)?[c]:c;return e!=null&&(a!=null&&a.length)&&r.applyPostProcessor!==!1&&(e=OQ.handle(a,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,s,o,l,c;return vi(e)&&(e=[e]),e.forEach(a=>{if(this.isValidLookup(r))return;const d=this.extractFromKey(a,t),f=d.key;s=f;let m=d.namespaces;this.options.fallbackNS&&(m=m.concat(this.options.fallbackNS));const _=t.count!==void 0&&!vi(t.count),x=_&&!t.ordinal&&t.count===0,A=t.context!==void 0&&(vi(t.context)||typeof t.context=="number")&&t.context!=="",I=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);m.forEach(E=>{var C,L;this.isValidLookup(r)||(c=E,!$j[`${I[0]}-${E}`]&&((C=this.utils)!=null&&C.hasLoadedNamespace)&&!((L=this.utils)!=null&&L.hasLoadedNamespace(c))&&($j[`${I[0]}-${E}`]=!0,this.logger.warn(`key "${s}" for languages "${I.join(", ")}" won't get resolved as namespace "${c}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),I.forEach(O=>{var Z;if(this.isValidLookup(r))return;l=O;const H=[f];if((Z=this.i18nFormat)!=null&&Z.addLookupKeys)this.i18nFormat.addLookupKeys(H,f,O,E,t);else{let J;_&&(J=this.pluralResolver.getSuffix(O,t.count,t));const re=`${this.options.pluralSeparator}zero`,se=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(_&&(H.push(f+J),t.ordinal&&J.indexOf(se)===0&&H.push(f+J.replace(se,this.options.pluralSeparator)),x&&H.push(f+re)),A){const ae=`${f}${this.options.contextSeparator}${t.context}`;H.push(ae),_&&(H.push(ae+J),t.ordinal&&J.indexOf(se)===0&&H.push(ae+J.replace(se,this.options.pluralSeparator)),x&&H.push(ae+re))}}let q;for(;q=H.pop();)this.isValidLookup(r)||(o=q,r=this.getResource(O,E,q,t))}))})}),{res:r,usedKey:s,exactUsedKey:o,usedLng:l,usedNS:c}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r){var o;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(o=this.i18nFormat)!=null&&o.getResource?this.i18nFormat.getResource(e,t,r,s):this.resourceStore.getResource(e,t,r,s)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!vi(e.replace);let s=r?e.replace:e;if(r&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const o of t)delete s[o]}return s}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}class Xj{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=op.create("languageUtils")}getScriptPartFromCode(e){if(e=VP(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=VP(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(vi(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(t=s)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const s=this.getLanguagePartFromCode(r);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find(o=>{if(o===s)return o;if(!(o.indexOf("-")<0&&s.indexOf("-")<0)&&(o.indexOf("-")>0&&s.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===s||o.indexOf(s)===0&&s.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),vi(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),s=[],o=l=>{l&&(this.isSupportedCode(l)?s.push(l):this.logger.warn(`rejecting language code not found in supportedLngs: ${l}`))};return vi(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):vi(e)&&o(this.formatLanguageCode(e)),r.forEach(l=>{s.indexOf(l)<0&&o(this.formatLanguageCode(l))}),s}}const qj={zero:0,one:1,two:2,few:3,many:4,other:5},Yj={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class lme{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=op.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=VP(e==="dev"?"en":e),s=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:r,type:s});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let l;try{l=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Yj;if(!e.match(/-|_/))return Yj;const a=this.languageUtils.getLanguagePartFromCode(e);l=this.getRule(a,t)}return this.pluralRulesCache[o]=l,l}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(s=>`${t}${s}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort((s,o)=>qj[s]-qj[o]).map(s=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(e,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const Zj=function(n,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=eme(n,e,t);return!o&&s&&vi(t)&&(o=QN(n,t,r),o===void 0&&(o=QN(e,t,r))),o},vO=n=>n.replace(/\$/g,"$$$$");class cme{constructor(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=op.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(r=>r),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:s,prefix:o,prefixEscaped:l,suffix:c,suffixEscaped:a,formatSeparator:d,unescapeSuffix:f,unescapePrefix:m,nestingPrefix:_,nestingPrefixEscaped:x,nestingSuffix:A,nestingSuffixEscaped:I,nestingOptionsSeparator:E,maxReplaces:C,alwaysFormat:L}=e.interpolation;this.escape=t!==void 0?t:nme,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=o?_1(o):l||"{{",this.suffix=c?_1(c):a||"}}",this.formatSeparator=d||",",this.unescapePrefix=f?"":m||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=_?_1(_):x||_1("$t("),this.nestingSuffix=A?_1(A):I||_1(")"),this.nestingOptionsSeparator=E||",",this.maxReplaces=C||1e3,this.alwaysFormat=L!==void 0?L:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>(t==null?void 0:t.source)===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,s){var x;let o,l,c;const a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=A=>{if(A.indexOf(this.formatSeparator)<0){const L=Zj(t,a,A,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(L,void 0,r,{...s,...t,interpolationkey:A}):L}const I=A.split(this.formatSeparator),E=I.shift().trim(),C=I.join(this.formatSeparator).trim();return this.format(Zj(t,a,E,this.options.keySeparator,this.options.ignoreJSONStructure),C,r,{...s,...t,interpolationkey:E})};this.resetRegExp();const f=(s==null?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,m=((x=s==null?void 0:s.interpolation)==null?void 0:x.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:A=>vO(A)},{regex:this.regexp,safeValue:A=>this.escapeValue?vO(this.escape(A)):vO(A)}].forEach(A=>{for(c=0;o=A.regex.exec(e);){const I=o[1].trim();if(l=d(I),l===void 0)if(typeof f=="function"){const C=f(e,o,s);l=vi(C)?C:""}else if(s&&Object.prototype.hasOwnProperty.call(s,I))l="";else if(m){l=o[0];continue}else this.logger.warn(`missed to pass in variable ${I} for interpolating ${e}`),l="";else!vi(l)&&!this.useRawValueToEscape&&(l=Gj(l));const E=A.safeValue(l);if(e=e.replace(o[0],E),m?(A.regex.lastIndex+=l.length,A.regex.lastIndex-=o[0].length):A.regex.lastIndex=0,c++,c>=this.maxReplaces)break}}),e}nest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,o,l;const c=(a,d)=>{const f=this.nestingOptionsSeparator;if(a.indexOf(f)<0)return a;const m=a.split(new RegExp(`${f}[ ]*{`));let _=`{${m[1]}`;a=m[0],_=this.interpolate(_,l);const x=_.match(/'/g),A=_.match(/"/g);(((x==null?void 0:x.length)??0)%2===0&&!A||A.length%2!==0)&&(_=_.replace(/'/g,'"'));try{l=JSON.parse(_),d&&(l={...d,...l})}catch(I){return this.logger.warn(`failed parsing options string in nesting for key ${a}`,I),`${a}${f}${_}`}return l.defaultValue&&l.defaultValue.indexOf(this.prefix)>-1&&delete l.defaultValue,a};for(;s=this.nestingRegexp.exec(e);){let a=[];l={...r},l=l.replace&&!vi(l.replace)?l.replace:l,l.applyPostProcessor=!1,delete l.defaultValue;let d=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const f=s[1].split(this.formatSeparator).map(m=>m.trim());s[1]=f.shift(),a=f,d=!0}if(o=t(c.call(this,s[1].trim(),l),l),o&&s[0]===e&&!vi(o))return o;vi(o)||(o=Gj(o)),o||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),o=""),d&&(o=a.reduce((f,m)=>this.format(f,m,r.lng,{...r,interpolationkey:s[1].trim()}),o.trim())),e=e.replace(s[0],o),this.regexp.lastIndex=0}return e}}const ume=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const r=n.split("(");e=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);e==="currency"&&s.indexOf(":")<0?t.currency||(t.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?t.range||(t.range=s.trim()):s.split(";").forEach(l=>{if(l){const[c,...a]=l.split(":"),d=a.join(":").trim().replace(/^'+|'+$/g,""),f=c.trim();t[f]||(t[f]=d),d==="false"&&(t[f]=!1),d==="true"&&(t[f]=!0),isNaN(d)||(t[f]=parseInt(d,10))}})}return{formatName:e,formatOptions:t}},y1=n=>{const e={};return(t,r,s)=>{let o=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(o={...o,[s.interpolationkey]:void 0});const l=r+JSON.stringify(o);let c=e[l];return c||(c=n(VP(r),s),e[l]=c),c(t)}};class hme{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=op.create("formatter"),this.options=e,this.formats={number:y1((t,r)=>{const s=new Intl.NumberFormat(t,{...r});return o=>s.format(o)}),currency:y1((t,r)=>{const s=new Intl.NumberFormat(t,{...r,style:"currency"});return o=>s.format(o)}),datetime:y1((t,r)=>{const s=new Intl.DateTimeFormat(t,{...r});return o=>s.format(o)}),relativetime:y1((t,r)=>{const s=new Intl.RelativeTimeFormat(t,{...r});return o=>s.format(o,r.range||"day")}),list:y1((t,r)=>{const s=new Intl.ListFormat(t,{...r});return o=>s.format(o)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=y1(t)}format(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(c=>c.indexOf(")")>-1)){const c=o.findIndex(a=>a.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,c)].join(this.formatSeparator)}return o.reduce((c,a)=>{var m;const{formatName:d,formatOptions:f}=ume(a);if(this.formats[d]){let _=c;try{const x=((m=s==null?void 0:s.formatParams)==null?void 0:m[s.interpolationkey])||{},A=x.locale||x.lng||s.locale||s.lng||r;_=this.formats[d](c,A,{...f,...s,...x})}catch(x){this.logger.warn(x)}return _}else this.logger.warn(`there was no format function for ${d}`);return c},e)}}const dme=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class fme extends sD{constructor(e,t,r){var o,l;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=op.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],(l=(o=this.backend)==null?void 0:o.init)==null||l.call(o,r,s.backend,s)}queueLoad(e,t,r,s){const o={},l={},c={},a={};return e.forEach(d=>{let f=!0;t.forEach(m=>{const _=`${d}|${m}`;!r.reload&&this.store.hasResourceBundle(d,m)?this.state[_]=2:this.state[_]<0||(this.state[_]===1?l[_]===void 0&&(l[_]=!0):(this.state[_]=1,f=!1,l[_]===void 0&&(l[_]=!0),o[_]===void 0&&(o[_]=!0),a[m]===void 0&&(a[m]=!0)))}),f||(c[d]=!0)}),(Object.keys(o).length||Object.keys(l).length)&&this.queue.push({pending:l,pendingCount:Object.keys(l).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(o),pending:Object.keys(l),toLoadLanguages:Object.keys(c),toLoadNamespaces:Object.keys(a)}}loaded(e,t,r){const s=e.split("|"),o=s[0],l=s[1];t&&this.emit("failedLoading",o,l,t),!t&&r&&this.store.addResourceBundle(o,l,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const c={};this.queue.forEach(a=>{Qpe(a.loaded,[o],l),dme(a,e),t&&a.errors.push(t),a.pendingCount===0&&!a.done&&(Object.keys(a.loaded).forEach(d=>{c[d]||(c[d]={});const f=a.loaded[d];f.length&&f.forEach(m=>{c[d][m]===void 0&&(c[d][m]=!0)})}),a.done=!0,a.errors.length?a.callback(a.errors):a.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(a=>!a.done)}read(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,l=arguments.length>5?arguments[5]:void 0;if(!e.length)return l(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:s,wait:o,callback:l});return}this.readingCalls++;const c=(d,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const m=this.waitingReads.shift();this.read(m.lng,m.ns,m.fcName,m.tried,m.wait,m.callback)}if(d&&f&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,s+1,o*2,l)},o);return}l(d,f)},a=this.backend[r].bind(this.backend);if(a.length===2){try{const d=a(e,t);d&&typeof d.then=="function"?d.then(f=>c(null,f)).catch(c):c(null,d)}catch(d){c(d)}return}return a(e,t,c)}prepareLoading(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();vi(e)&&(e=this.languageUtils.toResolveHierarchy(e)),vi(t)&&(t=[t]);const o=this.queueLoad(e,t,r,s);if(!o.toLoad.length)return o.pending.length||s(),null;o.toLoad.forEach(l=>{this.loadOne(l)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),s=r[0],o=r[1];this.read(s,o,"read",void 0,void 0,(l,c)=>{l&&this.logger.warn(`${t}loading namespace ${o} for language ${s} failed`,l),!l&&c&&this.logger.log(`${t}loaded namespace ${o} for language ${s}`,c),this.loaded(e,l,c)})}saveMissing(e,t,r,s,o){var a,d,f,m,_;let l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((d=(a=this.services)==null?void 0:a.utils)!=null&&d.hasLoadedNamespace&&!((m=(f=this.services)==null?void 0:f.utils)!=null&&m.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((_=this.backend)!=null&&_.create){const x={...l,isUpdate:o},A=this.backend.create.bind(this.backend);if(A.length<6)try{let I;A.length===5?I=A(e,t,r,s,x):I=A(e,t,r,s),I&&typeof I.then=="function"?I.then(E=>c(null,E)).catch(c):c(null,I)}catch(I){c(I)}else A(e,t,r,s,c,x)}!e||!e[0]||this.store.addResource(e[0],t,r,s)}}}const Kj=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),vi(n[1])&&(e.defaultValue=n[1]),vi(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Jj=n=>{var e,t;return vi(n.ns)&&(n.ns=[n.ns]),vi(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),vi(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},OE=()=>{},pme=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class jT extends sD{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Jj(e),this.services={},this.logger=op,this.modules={external:[]},pme(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(vi(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const s=Kj();this.options={...s,...this.options,...Jj(t)},this.options.interpolation={...s.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const o=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?op.init(o(this.modules.logger),this.options):op.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=hme;const m=new Xj(this.options);this.store=new Wj(this.options.resources,this.options);const _=this.services;_.logger=op,_.resourceStore=this.store,_.languageUtils=m,_.pluralResolver=new lme(m,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),f&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(_.formatter=o(f),_.formatter.init(_,this.options),this.options.interpolation.format=_.formatter.format.bind(_.formatter)),_.interpolator=new cme(this.options),_.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},_.backendConnector=new fme(o(this.modules.backend),_.resourceStore,_,this.options),_.backendConnector.on("*",function(x){for(var A=arguments.length,I=new Array(A>1?A-1:0),E=1;E<A;E++)I[E-1]=arguments[E];e.emit(x,...I)}),this.modules.languageDetector&&(_.languageDetector=o(this.modules.languageDetector),_.languageDetector.init&&_.languageDetector.init(_,this.options.detection,this.options)),this.modules.i18nFormat&&(_.i18nFormat=o(this.modules.i18nFormat),_.i18nFormat.init&&_.i18nFormat.init(this)),this.translator=new jP(this.services,this.options),this.translator.on("*",function(x){for(var A=arguments.length,I=new Array(A>1?A-1:0),E=1;E<A;E++)I[E-1]=arguments[E];e.emit(x,...I)}),this.modules.external.forEach(x=>{x.init&&x.init(this)})}if(this.format=this.options.interpolation.format,r||(r=OE),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=function(){return e.store[f](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=function(){return e.store[f](...arguments),e}});const a=OS(),d=()=>{const f=(m,_)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(_),r(m,_)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),a}loadResources(e){var o,l;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OE;const s=vi(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if((s==null?void 0:s.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const c=[],a=d=>{if(!d||d==="cimode")return;this.services.languageUtils.toResolveHierarchy(d).forEach(m=>{m!=="cimode"&&c.indexOf(m)<0&&c.push(m)})};s?a(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(f=>a(f)),(l=(o=this.options.preload)==null?void 0:o.forEach)==null||l.call(o,d=>a(d)),this.services.backendConnector.load(c,this.options.ns,d=>{!d&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(d)})}else r(null)}reloadResources(e,t,r){const s=OS();return typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=OE),this.services.backendConnector.reload(e,t,o=>{s.resolve(),r(o)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&OQ.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const s=OS();this.emit("languageChanging",e);const o=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},l=(a,d)=>{d?(o(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,s.resolve(function(){return r.t(...arguments)}),t&&t(a,function(){return r.t(...arguments)})},c=a=>{var f,m;!e&&!a&&this.services.languageDetector&&(a=[]);const d=vi(a)?a:this.services.languageUtils.getBestMatchFromCodes(a);d&&(this.language||o(d),this.translator.language||this.translator.changeLanguage(d),(m=(f=this.services.languageDetector)==null?void 0:f.cacheUserLanguage)==null||m.call(f,d)),this.loadResources(d,_=>{l(_,d)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?c(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(c):this.services.languageDetector.detect(c):c(e),s}getFixedT(e,t,r){var s=this;const o=function(l,c){let a;if(typeof c!="object"){for(var d=arguments.length,f=new Array(d>2?d-2:0),m=2;m<d;m++)f[m-2]=arguments[m];a=s.options.overloadTranslationOptionHandler([l,c].concat(f))}else a={...c};a.lng=a.lng||o.lng,a.lngs=a.lngs||o.lngs,a.ns=a.ns||o.ns,a.keyPrefix!==""&&(a.keyPrefix=a.keyPrefix||r||o.keyPrefix);const _=s.options.keySeparator||".";let x;return a.keyPrefix&&Array.isArray(l)?x=l.map(A=>`${a.keyPrefix}${_}${A}`):x=a.keyPrefix?`${a.keyPrefix}${_}${l}`:l,s.t(x,a)};return vi(e)?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=r,o}t(){var s;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(s=this.translator)==null?void 0:s.translate(...t)}exists(){var s;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(s=this.translator)==null?void 0:s.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const l=(c,a)=>{const d=this.services.backendConnector.state[`${c}|${a}`];return d===-1||d===0||d===2};if(t.precheck){const c=t.precheck(this,l);if(c!==void 0)return c}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||l(r,e)&&(!s||l(o,e)))}loadNamespaces(e,t){const r=OS();return this.options.ns?(vi(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),t&&t(s)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=OS();vi(e)&&(e=[e]);const s=this.options.preload||[],o=e.filter(l=>s.indexOf(l)<0&&this.services.languageUtils.isSupportedCode(l));return o.length?(this.options.preload=s.concat(o),this.loadResources(l=>{r.resolve(),t&&t(l)}),r):(t&&t(),Promise.resolve())}dir(e){var s,o;if(e||(e=this.resolvedLanguage||(((s=this.languages)==null?void 0:s.length)>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((o=this.services)==null?void 0:o.languageUtils)||new Xj(Kj());return t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new jT(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OE;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},o=new jT(s);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(c=>{o[c]=this[c]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},r){const c=Object.keys(this.store.data).reduce((a,d)=>(a[d]={...this.store.data[d]},Object.keys(a[d]).reduce((f,m)=>(f[m]={...a[d][m]},f),{})),{});o.store=new Wj(c,s),o.services.resourceStore=o.store}return o.translator=new jP(o.services,s),o.translator.on("*",function(c){for(var a=arguments.length,d=new Array(a>1?a-1:0),f=1;f<a;f++)d[f-1]=arguments[f];o.emit(c,...d)}),o.init(s,t),o.translator.options=s,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Pl=jT.createInstance();Pl.createInstance=jT.createInstance;Pl.createInstance;Pl.dir;Pl.init;Pl.loadResources;Pl.reloadResources;Pl.use;Pl.changeLanguage;Pl.getFixedT;Pl.t;Pl.exists;Pl.setDefaultNamespace;Pl.hasLoadedNamespace;Pl.loadNamespaces;Pl.loadLanguages;var e4={},FQ={exports:{}},Wu={},NQ={exports:{}},zQ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ye,We){var Ue=ye.length;ye.push(We);e:for(;0<Ue;){var gt=Ue-1>>>1,vt=ye[gt];if(0<s(vt,We))ye[gt]=We,ye[Ue]=vt,Ue=gt;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var We=ye[0],Ue=ye.pop();if(Ue!==We){ye[0]=Ue;e:for(var gt=0,vt=ye.length,Dt=vt>>>1;gt<Dt;){var lt=2*(gt+1)-1,jt=ye[lt],Qt=lt+1,nn=ye[Qt];if(0>s(jt,Ue))Qt<vt&&0>s(nn,jt)?(ye[gt]=nn,ye[Qt]=Ue,gt=Qt):(ye[gt]=jt,ye[lt]=Ue,gt=lt);else if(Qt<vt&&0>s(nn,Ue))ye[gt]=nn,ye[Qt]=Ue,gt=Qt;else break e}}return We}function s(ye,We){var Ue=ye.sortIndex-We.sortIndex;return Ue!==0?Ue:ye.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var a=[],d=[],f=1,m=null,_=3,x=!1,A=!1,I=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(ye){for(var We=t(d);We!==null;){if(We.callback===null)r(d);else if(We.startTime<=ye)r(d),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(d)}}function H(ye){if(I=!1,O(ye),!A)if(t(a)!==null)A=!0,Re(q);else{var We=t(d);We!==null&&rt(H,We.startTime-ye)}}function q(ye,We){A=!1,I&&(I=!1,C(re),re=-1),x=!0;var Ue=_;try{for(O(We),m=t(a);m!==null&&(!(m.expirationTime>We)||ye&&!he());){var gt=m.callback;if(typeof gt=="function"){m.callback=null,_=m.priorityLevel;var vt=gt(m.expirationTime<=We);We=n.unstable_now(),typeof vt=="function"?m.callback=vt:m===t(a)&&r(a),O(We)}else r(a);m=t(a)}if(m!==null)var Dt=!0;else{var lt=t(d);lt!==null&&rt(H,lt.startTime-We),Dt=!1}return Dt}finally{m=null,_=Ue,x=!1}}var Z=!1,J=null,re=-1,se=5,ae=-1;function he(){return!(n.unstable_now()-ae<se)}function Ae(){if(J!==null){var ye=n.unstable_now();ae=ye;var We=!0;try{We=J(!0,ye)}finally{We?Ee():(Z=!1,J=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Ae)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,ze=Pe.port2;Pe.port1.onmessage=Ae,Ee=function(){ze.postMessage(null)}}else Ee=function(){E(Ae,0)};function Re(ye){J=ye,Z||(Z=!0,Ee())}function rt(ye,We){re=E(function(){ye(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){A||x||(A=!0,Re(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(ye){switch(_){case 1:case 2:case 3:var We=3;break;default:We=_}var Ue=_;_=We;try{return ye()}finally{_=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,We){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ue=_;_=ye;try{return We()}finally{_=Ue}},n.unstable_scheduleCallback=function(ye,We,Ue){var gt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?gt+Ue:gt):Ue=gt,ye){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=Ue+vt,ye={id:f++,callback:We,priorityLevel:ye,startTime:Ue,expirationTime:vt,sortIndex:-1},Ue>gt?(ye.sortIndex=Ue,e(d,ye),t(a)===null&&ye===t(d)&&(I?(C(re),re=-1):I=!0,rt(H,Ue-gt))):(ye.sortIndex=vt,e(a,ye),A||x||(A=!0,Re(q))),ye},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(ye){var We=_;return function(){var Ue=_;_=We;try{return ye.apply(this,arguments)}finally{_=Ue}}}})(zQ);NQ.exports=zQ;var mme=NQ.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UQ=_e,Hu=mme;function Zn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GQ=new Set,WT={};function Ix(n,e){cw(n,e),cw(n+"Capture",e)}function cw(n,e){for(WT[n]=e,n=0;n<e.length;n++)GQ.add(e[n])}var Ym=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),t4=Object.prototype.hasOwnProperty,gme=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Qj={},e7={};function vme(n){return t4.call(e7,n)?!0:t4.call(Qj,n)?!1:gme.test(n)?e7[n]=!0:(Qj[n]=!0,!1)}function _me(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function yme(n,e,t,r){if(e===null||typeof e>"u"||_me(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fc(n,e,t,r,s,o,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=l}var El={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){El[n]=new Fc(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];El[e]=new Fc(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){El[n]=new Fc(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){El[n]=new Fc(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){El[n]=new Fc(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){El[n]=new Fc(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){El[n]=new Fc(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){El[n]=new Fc(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){El[n]=new Fc(n,5,!1,n.toLowerCase(),null,!1,!1)});var AU=/[\-:]([a-z])/g;function TU(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(AU,TU);El[e]=new Fc(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(AU,TU);El[e]=new Fc(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(AU,TU);El[e]=new Fc(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){El[n]=new Fc(n,1,!1,n.toLowerCase(),null,!1,!1)});El.xlinkHref=new Fc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){El[n]=new Fc(n,1,!1,n.toLowerCase(),null,!0,!0)});function MU(n,e,t,r){var s=El.hasOwnProperty(e)?El[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yme(e,t,s,r)&&(t=null),r||s===null?vme(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var ug=UQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,FE=Symbol.for("react.element"),_b=Symbol.for("react.portal"),yb=Symbol.for("react.fragment"),CU=Symbol.for("react.strict_mode"),n4=Symbol.for("react.profiler"),VQ=Symbol.for("react.provider"),HQ=Symbol.for("react.context"),EU=Symbol.for("react.forward_ref"),r4=Symbol.for("react.suspense"),i4=Symbol.for("react.suspense_list"),IU=Symbol.for("react.memo"),Gv=Symbol.for("react.lazy"),jQ=Symbol.for("react.offscreen"),t7=Symbol.iterator;function FS(n){return n===null||typeof n!="object"?null:(n=t7&&n[t7]||n["@@iterator"],typeof n=="function"?n:null)}var Xo=Object.assign,_O;function NA(n){if(_O===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);_O=e&&e[1]||""}return`
`+_O+n}var yO=!1;function xO(n,e){if(!n||yO)return"";yO=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),l=s.length-1,c=o.length-1;1<=l&&0<=c&&s[l]!==o[c];)c--;for(;1<=l&&0<=c;l--,c--)if(s[l]!==o[c]){if(l!==1||c!==1)do if(l--,c--,0>c||s[l]!==o[c]){var a=`
`+s[l].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=l&&0<=c);break}}}finally{yO=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?NA(n):""}function xme(n){switch(n.tag){case 5:return NA(n.type);case 16:return NA("Lazy");case 13:return NA("Suspense");case 19:return NA("SuspenseList");case 0:case 2:case 15:return n=xO(n.type,!1),n;case 11:return n=xO(n.type.render,!1),n;case 1:return n=xO(n.type,!0),n;default:return""}}function s4(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case yb:return"Fragment";case _b:return"Portal";case n4:return"Profiler";case CU:return"StrictMode";case r4:return"Suspense";case i4:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case HQ:return(n.displayName||"Context")+".Consumer";case VQ:return(n._context.displayName||"Context")+".Provider";case EU:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case IU:return e=n.displayName||null,e!==null?e:s4(n.type)||"Memo";case Gv:e=n._payload,n=n._init;try{return s4(n(e))}catch{}}return null}function bme(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return s4(e);case 8:return e===CU?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function y0(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function WQ(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wme(n){var e=WQ(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function NE(n){n._valueTracker||(n._valueTracker=wme(n))}function $Q(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=WQ(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function WP(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function o4(n,e){var t=e.checked;return Xo({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function n7(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=y0(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function XQ(n,e){e=e.checked,e!=null&&MU(n,"checked",e,!1)}function a4(n,e){XQ(n,e);var t=y0(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?l4(n,e.type,t):e.hasOwnProperty("defaultValue")&&l4(n,e.type,y0(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function r7(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function l4(n,e,t){(e!=="number"||WP(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var zA=Array.isArray;function Hb(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+y0(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function c4(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Zn(91));return Xo({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function i7(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Zn(92));if(zA(t)){if(1<t.length)throw Error(Zn(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:y0(t)}}function qQ(n,e){var t=y0(e.value),r=y0(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function s7(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function YQ(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function u4(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?YQ(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var zE,ZQ=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(zE=zE||document.createElement("div"),zE.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=zE.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function $T(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var iT={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sme=["Webkit","ms","Moz","O"];Object.keys(iT).forEach(function(n){Sme.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),iT[e]=iT[n]})});function KQ(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||iT.hasOwnProperty(n)&&iT[n]?(""+e).trim():e+"px"}function JQ(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=KQ(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var Ame=Xo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function h4(n,e){if(e){if(Ame[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Zn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Zn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Zn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Zn(62))}}function d4(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var f4=null;function PU(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var p4=null,jb=null,Wb=null;function o7(n){if(n=rC(n)){if(typeof p4!="function")throw Error(Zn(280));var e=n.stateNode;e&&(e=uD(e),p4(n.stateNode,n.type,e))}}function QQ(n){jb?Wb?Wb.push(n):Wb=[n]:jb=n}function eee(){if(jb){var n=jb,e=Wb;if(Wb=jb=null,o7(n),e)for(n=0;n<e.length;n++)o7(e[n])}}function tee(n,e){return n(e)}function nee(){}var bO=!1;function ree(n,e,t){if(bO)return n(e,t);bO=!0;try{return tee(n,e,t)}finally{bO=!1,(jb!==null||Wb!==null)&&(nee(),eee())}}function XT(n,e){var t=n.stateNode;if(t===null)return null;var r=uD(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Zn(231,e,typeof t));return t}var m4=!1;if(Ym)try{var NS={};Object.defineProperty(NS,"passive",{get:function(){m4=!0}}),window.addEventListener("test",NS,NS),window.removeEventListener("test",NS,NS)}catch{m4=!1}function Tme(n,e,t,r,s,o,l,c,a){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(f){this.onError(f)}}var sT=!1,$P=null,XP=!1,g4=null,Mme={onError:function(n){sT=!0,$P=n}};function Cme(n,e,t,r,s,o,l,c,a){sT=!1,$P=null,Tme.apply(Mme,arguments)}function Eme(n,e,t,r,s,o,l,c,a){if(Cme.apply(this,arguments),sT){if(sT){var d=$P;sT=!1,$P=null}else throw Error(Zn(198));XP||(XP=!0,g4=d)}}function Px(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function iee(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function a7(n){if(Px(n)!==n)throw Error(Zn(188))}function Ime(n){var e=n.alternate;if(!e){if(e=Px(n),e===null)throw Error(Zn(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===t)return a7(s),n;if(o===r)return a7(s),e;o=o.sibling}throw Error(Zn(188))}if(t.return!==r.return)t=s,r=o;else{for(var l=!1,c=s.child;c;){if(c===t){l=!0,t=s,r=o;break}if(c===r){l=!0,r=s,t=o;break}c=c.sibling}if(!l){for(c=o.child;c;){if(c===t){l=!0,t=o,r=s;break}if(c===r){l=!0,r=o,t=s;break}c=c.sibling}if(!l)throw Error(Zn(189))}}if(t.alternate!==r)throw Error(Zn(190))}if(t.tag!==3)throw Error(Zn(188));return t.stateNode.current===t?n:e}function see(n){return n=Ime(n),n!==null?oee(n):null}function oee(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=oee(n);if(e!==null)return e;n=n.sibling}return null}var aee=Hu.unstable_scheduleCallback,l7=Hu.unstable_cancelCallback,Pme=Hu.unstable_shouldYield,Rme=Hu.unstable_requestPaint,ga=Hu.unstable_now,Lme=Hu.unstable_getCurrentPriorityLevel,RU=Hu.unstable_ImmediatePriority,lee=Hu.unstable_UserBlockingPriority,qP=Hu.unstable_NormalPriority,Dme=Hu.unstable_LowPriority,cee=Hu.unstable_IdlePriority,oD=null,dp=null;function Bme(n){if(dp&&typeof dp.onCommitFiberRoot=="function")try{dp.onCommitFiberRoot(oD,n,void 0,(n.current.flags&128)===128)}catch{}}var Kd=Math.clz32?Math.clz32:Fme,kme=Math.log,Ome=Math.LN2;function Fme(n){return n>>>=0,n===0?32:31-(kme(n)/Ome|0)|0}var UE=64,GE=4194304;function UA(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function YP(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,o=n.pingedLanes,l=t&268435455;if(l!==0){var c=l&~s;c!==0?r=UA(c):(o&=l,o!==0&&(r=UA(o)))}else l=t&~s,l!==0?r=UA(l):o!==0&&(r=UA(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Kd(e),s=1<<t,r|=n[t],e&=~s;return r}function Nme(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zme(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,o=n.pendingLanes;0<o;){var l=31-Kd(o),c=1<<l,a=s[l];a===-1?(!(c&t)||c&r)&&(s[l]=Nme(c,e)):a<=e&&(n.expiredLanes|=c),o&=~c}}function v4(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function uee(){var n=UE;return UE<<=1,!(UE&4194240)&&(UE=64),n}function wO(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function tC(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Kd(e),n[e]=t}function Ume(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Kd(t),o=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~o}}function LU(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Kd(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Us=0;function hee(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var dee,DU,fee,pee,mee,_4=!1,VE=[],s0=null,o0=null,a0=null,qT=new Map,YT=new Map,Wv=[],Gme="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c7(n,e){switch(n){case"focusin":case"focusout":s0=null;break;case"dragenter":case"dragleave":o0=null;break;case"mouseover":case"mouseout":a0=null;break;case"pointerover":case"pointerout":qT.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":YT.delete(e.pointerId)}}function zS(n,e,t,r,s,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=rC(e),e!==null&&DU(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Vme(n,e,t,r,s){switch(e){case"focusin":return s0=zS(s0,n,e,t,r,s),!0;case"dragenter":return o0=zS(o0,n,e,t,r,s),!0;case"mouseover":return a0=zS(a0,n,e,t,r,s),!0;case"pointerover":var o=s.pointerId;return qT.set(o,zS(qT.get(o)||null,n,e,t,r,s)),!0;case"gotpointercapture":return o=s.pointerId,YT.set(o,zS(YT.get(o)||null,n,e,t,r,s)),!0}return!1}function gee(n){var e=Iy(n.target);if(e!==null){var t=Px(e);if(t!==null){if(e=t.tag,e===13){if(e=iee(t),e!==null){n.blockedOn=e,mee(n.priority,function(){fee(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function lP(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=y4(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);f4=r,t.target.dispatchEvent(r),f4=null}else return e=rC(t),e!==null&&DU(e),n.blockedOn=t,!1;e.shift()}return!0}function u7(n,e,t){lP(n)&&t.delete(e)}function Hme(){_4=!1,s0!==null&&lP(s0)&&(s0=null),o0!==null&&lP(o0)&&(o0=null),a0!==null&&lP(a0)&&(a0=null),qT.forEach(u7),YT.forEach(u7)}function US(n,e){n.blockedOn===e&&(n.blockedOn=null,_4||(_4=!0,Hu.unstable_scheduleCallback(Hu.unstable_NormalPriority,Hme)))}function ZT(n){function e(s){return US(s,n)}if(0<VE.length){US(VE[0],n);for(var t=1;t<VE.length;t++){var r=VE[t];r.blockedOn===n&&(r.blockedOn=null)}}for(s0!==null&&US(s0,n),o0!==null&&US(o0,n),a0!==null&&US(a0,n),qT.forEach(e),YT.forEach(e),t=0;t<Wv.length;t++)r=Wv[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Wv.length&&(t=Wv[0],t.blockedOn===null);)gee(t),t.blockedOn===null&&Wv.shift()}var $b=ug.ReactCurrentBatchConfig,ZP=!0;function jme(n,e,t,r){var s=Us,o=$b.transition;$b.transition=null;try{Us=1,BU(n,e,t,r)}finally{Us=s,$b.transition=o}}function Wme(n,e,t,r){var s=Us,o=$b.transition;$b.transition=null;try{Us=4,BU(n,e,t,r)}finally{Us=s,$b.transition=o}}function BU(n,e,t,r){if(ZP){var s=y4(n,e,t,r);if(s===null)LO(n,e,r,KP,t),c7(n,r);else if(Vme(s,n,e,t,r))r.stopPropagation();else if(c7(n,r),e&4&&-1<Gme.indexOf(n)){for(;s!==null;){var o=rC(s);if(o!==null&&dee(o),o=y4(n,e,t,r),o===null&&LO(n,e,r,KP,t),o===s)break;s=o}s!==null&&r.stopPropagation()}else LO(n,e,r,null,t)}}var KP=null;function y4(n,e,t,r){if(KP=null,n=PU(r),n=Iy(n),n!==null)if(e=Px(n),e===null)n=null;else if(t=e.tag,t===13){if(n=iee(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return KP=n,null}function vee(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lme()){case RU:return 1;case lee:return 4;case qP:case Dme:return 16;case cee:return 536870912;default:return 16}default:return 16}}var Yv=null,kU=null,cP=null;function _ee(){if(cP)return cP;var n,e=kU,t=e.length,r,s="value"in Yv?Yv.value:Yv.textContent,o=s.length;for(n=0;n<t&&e[n]===s[n];n++);var l=t-n;for(r=1;r<=l&&e[t-r]===s[o-r];r++);return cP=s.slice(n,1<r?1-r:void 0)}function uP(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function HE(){return!0}function h7(){return!1}function $u(n){function e(t,r,s,o,l){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var c in n)n.hasOwnProperty(c)&&(t=n[c],this[c]=t?t(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?HE:h7,this.isPropagationStopped=h7,this}return Xo(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=HE)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=HE)},persist:function(){},isPersistent:HE}),e}var Dw={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OU=$u(Dw),nC=Xo({},Dw,{view:0,detail:0}),$me=$u(nC),SO,AO,GS,aD=Xo({},nC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:FU,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==GS&&(GS&&n.type==="mousemove"?(SO=n.screenX-GS.screenX,AO=n.screenY-GS.screenY):AO=SO=0,GS=n),SO)},movementY:function(n){return"movementY"in n?n.movementY:AO}}),d7=$u(aD),Xme=Xo({},aD,{dataTransfer:0}),qme=$u(Xme),Yme=Xo({},nC,{relatedTarget:0}),TO=$u(Yme),Zme=Xo({},Dw,{animationName:0,elapsedTime:0,pseudoElement:0}),Kme=$u(Zme),Jme=Xo({},Dw,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qme=$u(Jme),ege=Xo({},Dw,{data:0}),f7=$u(ege),tge={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rge={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ige(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=rge[n])?!!e[n]:!1}function FU(){return ige}var sge=Xo({},nC,{key:function(n){if(n.key){var e=tge[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=uP(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?nge[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:FU,charCode:function(n){return n.type==="keypress"?uP(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?uP(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),oge=$u(sge),age=Xo({},aD,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p7=$u(age),lge=Xo({},nC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:FU}),cge=$u(lge),uge=Xo({},Dw,{propertyName:0,elapsedTime:0,pseudoElement:0}),hge=$u(uge),dge=Xo({},aD,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),fge=$u(dge),pge=[9,13,27,32],NU=Ym&&"CompositionEvent"in window,oT=null;Ym&&"documentMode"in document&&(oT=document.documentMode);var mge=Ym&&"TextEvent"in window&&!oT,yee=Ym&&(!NU||oT&&8<oT&&11>=oT),m7=" ",g7=!1;function xee(n,e){switch(n){case"keyup":return pge.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bee(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xb=!1;function gge(n,e){switch(n){case"compositionend":return bee(e);case"keypress":return e.which!==32?null:(g7=!0,m7);case"textInput":return n=e.data,n===m7&&g7?null:n;default:return null}}function vge(n,e){if(xb)return n==="compositionend"||!NU&&xee(n,e)?(n=_ee(),cP=kU=Yv=null,xb=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return yee&&e.locale!=="ko"?null:e.data;default:return null}}var _ge={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function v7(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!_ge[n.type]:e==="textarea"}function wee(n,e,t,r){QQ(r),e=JP(e,"onChange"),0<e.length&&(t=new OU("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var aT=null,KT=null;function yge(n){Dee(n,0)}function lD(n){var e=Sb(n);if($Q(e))return n}function xge(n,e){if(n==="change")return e}var See=!1;if(Ym){var MO;if(Ym){var CO="oninput"in document;if(!CO){var _7=document.createElement("div");_7.setAttribute("oninput","return;"),CO=typeof _7.oninput=="function"}MO=CO}else MO=!1;See=MO&&(!document.documentMode||9<document.documentMode)}function y7(){aT&&(aT.detachEvent("onpropertychange",Aee),KT=aT=null)}function Aee(n){if(n.propertyName==="value"&&lD(KT)){var e=[];wee(e,KT,n,PU(n)),ree(yge,e)}}function bge(n,e,t){n==="focusin"?(y7(),aT=e,KT=t,aT.attachEvent("onpropertychange",Aee)):n==="focusout"&&y7()}function wge(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return lD(KT)}function Sge(n,e){if(n==="click")return lD(e)}function Age(n,e){if(n==="input"||n==="change")return lD(e)}function Tge(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ef=typeof Object.is=="function"?Object.is:Tge;function JT(n,e){if(ef(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!t4.call(e,s)||!ef(n[s],e[s]))return!1}return!0}function x7(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function b7(n,e){var t=x7(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=x7(t)}}function Tee(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Tee(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Mee(){for(var n=window,e=WP();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=WP(n.document)}return e}function zU(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Mge(n){var e=Mee(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Tee(t.ownerDocument.documentElement,t)){if(r!==null&&zU(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!n.extend&&o>r&&(s=r,r=o,o=s),s=b7(t,o);var l=b7(t,r);s&&l&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==l.node||n.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Cge=Ym&&"documentMode"in document&&11>=document.documentMode,bb=null,x4=null,lT=null,b4=!1;function w7(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;b4||bb==null||bb!==WP(r)||(r=bb,"selectionStart"in r&&zU(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),lT&&JT(lT,r)||(lT=r,r=JP(x4,"onSelect"),0<r.length&&(e=new OU("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=bb)))}function jE(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var wb={animationend:jE("Animation","AnimationEnd"),animationiteration:jE("Animation","AnimationIteration"),animationstart:jE("Animation","AnimationStart"),transitionend:jE("Transition","TransitionEnd")},EO={},Cee={};Ym&&(Cee=document.createElement("div").style,"AnimationEvent"in window||(delete wb.animationend.animation,delete wb.animationiteration.animation,delete wb.animationstart.animation),"TransitionEvent"in window||delete wb.transitionend.transition);function cD(n){if(EO[n])return EO[n];if(!wb[n])return n;var e=wb[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Cee)return EO[n]=e[t];return n}var Eee=cD("animationend"),Iee=cD("animationiteration"),Pee=cD("animationstart"),Ree=cD("transitionend"),Lee=new Map,S7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function O0(n,e){Lee.set(n,e),Ix(e,[n])}for(var IO=0;IO<S7.length;IO++){var PO=S7[IO],Ege=PO.toLowerCase(),Ige=PO[0].toUpperCase()+PO.slice(1);O0(Ege,"on"+Ige)}O0(Eee,"onAnimationEnd");O0(Iee,"onAnimationIteration");O0(Pee,"onAnimationStart");O0("dblclick","onDoubleClick");O0("focusin","onFocus");O0("focusout","onBlur");O0(Ree,"onTransitionEnd");cw("onMouseEnter",["mouseout","mouseover"]);cw("onMouseLeave",["mouseout","mouseover"]);cw("onPointerEnter",["pointerout","pointerover"]);cw("onPointerLeave",["pointerout","pointerover"]);Ix("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ix("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ix("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ix("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ix("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ix("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var GA="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pge=new Set("cancel close invalid load scroll toggle".split(" ").concat(GA));function A7(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,Eme(r,e,void 0,n),n.currentTarget=null}function Dee(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var l=r.length-1;0<=l;l--){var c=r[l],a=c.instance,d=c.currentTarget;if(c=c.listener,a!==o&&s.isPropagationStopped())break e;A7(s,c,d),o=a}else for(l=0;l<r.length;l++){if(c=r[l],a=c.instance,d=c.currentTarget,c=c.listener,a!==o&&s.isPropagationStopped())break e;A7(s,c,d),o=a}}}if(XP)throw n=g4,XP=!1,g4=null,n}function _o(n,e){var t=e[M4];t===void 0&&(t=e[M4]=new Set);var r=n+"__bubble";t.has(r)||(Bee(e,n,2,!1),t.add(r))}function RO(n,e,t){var r=0;e&&(r|=4),Bee(t,n,r,e)}var WE="_reactListening"+Math.random().toString(36).slice(2);function QT(n){if(!n[WE]){n[WE]=!0,GQ.forEach(function(t){t!=="selectionchange"&&(Pge.has(t)||RO(t,!1,n),RO(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[WE]||(e[WE]=!0,RO("selectionchange",!1,e))}}function Bee(n,e,t,r){switch(vee(e)){case 1:var s=jme;break;case 4:s=Wme;break;default:s=BU}t=s.bind(null,e,t,n),s=void 0,!m4||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function LO(n,e,t,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===s||a.nodeType===8&&a.parentNode===s))return;l=l.return}for(;c!==null;){if(l=Iy(c),l===null)return;if(a=l.tag,a===5||a===6){r=o=l;continue e}c=c.parentNode}}r=r.return}ree(function(){var d=o,f=PU(t),m=[];e:{var _=Lee.get(n);if(_!==void 0){var x=OU,A=n;switch(n){case"keypress":if(uP(t)===0)break e;case"keydown":case"keyup":x=oge;break;case"focusin":A="focus",x=TO;break;case"focusout":A="blur",x=TO;break;case"beforeblur":case"afterblur":x=TO;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=d7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=qme;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=cge;break;case Eee:case Iee:case Pee:x=Kme;break;case Ree:x=hge;break;case"scroll":x=$me;break;case"wheel":x=fge;break;case"copy":case"cut":case"paste":x=Qme;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=p7}var I=(e&4)!==0,E=!I&&n==="scroll",C=I?_!==null?_+"Capture":null:_;I=[];for(var L=d,O;L!==null;){O=L;var H=O.stateNode;if(O.tag===5&&H!==null&&(O=H,C!==null&&(H=XT(L,C),H!=null&&I.push(eM(L,H,O)))),E)break;L=L.return}0<I.length&&(_=new x(_,A,null,t,f),m.push({event:_,listeners:I}))}}if(!(e&7)){e:{if(_=n==="mouseover"||n==="pointerover",x=n==="mouseout"||n==="pointerout",_&&t!==f4&&(A=t.relatedTarget||t.fromElement)&&(Iy(A)||A[Zm]))break e;if((x||_)&&(_=f.window===f?f:(_=f.ownerDocument)?_.defaultView||_.parentWindow:window,x?(A=t.relatedTarget||t.toElement,x=d,A=A?Iy(A):null,A!==null&&(E=Px(A),A!==E||A.tag!==5&&A.tag!==6)&&(A=null)):(x=null,A=d),x!==A)){if(I=d7,H="onMouseLeave",C="onMouseEnter",L="mouse",(n==="pointerout"||n==="pointerover")&&(I=p7,H="onPointerLeave",C="onPointerEnter",L="pointer"),E=x==null?_:Sb(x),O=A==null?_:Sb(A),_=new I(H,L+"leave",x,t,f),_.target=E,_.relatedTarget=O,H=null,Iy(f)===d&&(I=new I(C,L+"enter",A,t,f),I.target=O,I.relatedTarget=E,H=I),E=H,x&&A)t:{for(I=x,C=A,L=0,O=I;O;O=x1(O))L++;for(O=0,H=C;H;H=x1(H))O++;for(;0<L-O;)I=x1(I),L--;for(;0<O-L;)C=x1(C),O--;for(;L--;){if(I===C||C!==null&&I===C.alternate)break t;I=x1(I),C=x1(C)}I=null}else I=null;x!==null&&T7(m,_,x,I,!1),A!==null&&E!==null&&T7(m,E,A,I,!0)}}e:{if(_=d?Sb(d):window,x=_.nodeName&&_.nodeName.toLowerCase(),x==="select"||x==="input"&&_.type==="file")var q=xge;else if(v7(_))if(See)q=Age;else{q=wge;var Z=bge}else(x=_.nodeName)&&x.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(q=Sge);if(q&&(q=q(n,d))){wee(m,q,t,f);break e}Z&&Z(n,_,d),n==="focusout"&&(Z=_._wrapperState)&&Z.controlled&&_.type==="number"&&l4(_,"number",_.value)}switch(Z=d?Sb(d):window,n){case"focusin":(v7(Z)||Z.contentEditable==="true")&&(bb=Z,x4=d,lT=null);break;case"focusout":lT=x4=bb=null;break;case"mousedown":b4=!0;break;case"contextmenu":case"mouseup":case"dragend":b4=!1,w7(m,t,f);break;case"selectionchange":if(Cge)break;case"keydown":case"keyup":w7(m,t,f)}var J;if(NU)e:{switch(n){case"compositionstart":var re="onCompositionStart";break e;case"compositionend":re="onCompositionEnd";break e;case"compositionupdate":re="onCompositionUpdate";break e}re=void 0}else xb?xee(n,t)&&(re="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(re="onCompositionStart");re&&(yee&&t.locale!=="ko"&&(xb||re!=="onCompositionStart"?re==="onCompositionEnd"&&xb&&(J=_ee()):(Yv=f,kU="value"in Yv?Yv.value:Yv.textContent,xb=!0)),Z=JP(d,re),0<Z.length&&(re=new f7(re,n,null,t,f),m.push({event:re,listeners:Z}),J?re.data=J:(J=bee(t),J!==null&&(re.data=J)))),(J=mge?gge(n,t):vge(n,t))&&(d=JP(d,"onBeforeInput"),0<d.length&&(f=new f7("onBeforeInput","beforeinput",null,t,f),m.push({event:f,listeners:d}),f.data=J))}Dee(m,e)})}function eM(n,e,t){return{instance:n,listener:e,currentTarget:t}}function JP(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=XT(n,t),o!=null&&r.unshift(eM(n,o,s)),o=XT(n,e),o!=null&&r.push(eM(n,o,s))),n=n.return}return r}function x1(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function T7(n,e,t,r,s){for(var o=e._reactName,l=[];t!==null&&t!==r;){var c=t,a=c.alternate,d=c.stateNode;if(a!==null&&a===r)break;c.tag===5&&d!==null&&(c=d,s?(a=XT(t,o),a!=null&&l.unshift(eM(t,a,c))):s||(a=XT(t,o),a!=null&&l.push(eM(t,a,c)))),t=t.return}l.length!==0&&n.push({event:e,listeners:l})}var Rge=/\r\n?/g,Lge=/\u0000|\uFFFD/g;function M7(n){return(typeof n=="string"?n:""+n).replace(Rge,`
`).replace(Lge,"")}function $E(n,e,t){if(e=M7(e),M7(n)!==e&&t)throw Error(Zn(425))}function QP(){}var w4=null,S4=null;function A4(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var T4=typeof setTimeout=="function"?setTimeout:void 0,Dge=typeof clearTimeout=="function"?clearTimeout:void 0,C7=typeof Promise=="function"?Promise:void 0,Bge=typeof queueMicrotask=="function"?queueMicrotask:typeof C7<"u"?function(n){return C7.resolve(null).then(n).catch(kge)}:T4;function kge(n){setTimeout(function(){throw n})}function DO(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),ZT(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);ZT(e)}function l0(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function E7(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Bw=Math.random().toString(36).slice(2),rp="__reactFiber$"+Bw,tM="__reactProps$"+Bw,Zm="__reactContainer$"+Bw,M4="__reactEvents$"+Bw,Oge="__reactListeners$"+Bw,Fge="__reactHandles$"+Bw;function Iy(n){var e=n[rp];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Zm]||t[rp]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=E7(n);n!==null;){if(t=n[rp])return t;n=E7(n)}return e}n=t,t=n.parentNode}return null}function rC(n){return n=n[rp]||n[Zm],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Sb(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Zn(33))}function uD(n){return n[tM]||null}var C4=[],Ab=-1;function F0(n){return{current:n}}function xo(n){0>Ab||(n.current=C4[Ab],C4[Ab]=null,Ab--)}function oo(n,e){Ab++,C4[Ab]=n.current,n.current=e}var x0={},Ql=F0(x0),fu=F0(!1),sx=x0;function uw(n,e){var t=n.type.contextTypes;if(!t)return x0;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in t)s[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function pu(n){return n=n.childContextTypes,n!=null}function eR(){xo(fu),xo(Ql)}function I7(n,e,t){if(Ql.current!==x0)throw Error(Zn(168));oo(Ql,e),oo(fu,t)}function kee(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Zn(108,bme(n)||"Unknown",s));return Xo({},t,r)}function tR(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||x0,sx=Ql.current,oo(Ql,n),oo(fu,fu.current),!0}function P7(n,e,t){var r=n.stateNode;if(!r)throw Error(Zn(169));t?(n=kee(n,e,sx),r.__reactInternalMemoizedMergedChildContext=n,xo(fu),xo(Ql),oo(Ql,n)):xo(fu),oo(fu,t)}var Rm=null,hD=!1,BO=!1;function Oee(n){Rm===null?Rm=[n]:Rm.push(n)}function Nge(n){hD=!0,Oee(n)}function N0(){if(!BO&&Rm!==null){BO=!0;var n=0,e=Us;try{var t=Rm;for(Us=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Rm=null,hD=!1}catch(s){throw Rm!==null&&(Rm=Rm.slice(n+1)),aee(RU,N0),s}finally{Us=e,BO=!1}}return null}var Tb=[],Mb=0,nR=null,rR=0,Sh=[],Ah=0,ox=null,Fm=1,Nm="";function gy(n,e){Tb[Mb++]=rR,Tb[Mb++]=nR,nR=n,rR=e}function Fee(n,e,t){Sh[Ah++]=Fm,Sh[Ah++]=Nm,Sh[Ah++]=ox,ox=n;var r=Fm;n=Nm;var s=32-Kd(r)-1;r&=~(1<<s),t+=1;var o=32-Kd(e)+s;if(30<o){var l=s-s%5;o=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Fm=1<<32-Kd(e)+s|t<<s|r,Nm=o+n}else Fm=1<<o|t<<s|r,Nm=n}function UU(n){n.return!==null&&(gy(n,1),Fee(n,1,0))}function GU(n){for(;n===nR;)nR=Tb[--Mb],Tb[Mb]=null,rR=Tb[--Mb],Tb[Mb]=null;for(;n===ox;)ox=Sh[--Ah],Sh[Ah]=null,Nm=Sh[--Ah],Sh[Ah]=null,Fm=Sh[--Ah],Sh[Ah]=null}var zu=null,Nu=null,Io=!1,jd=null;function Nee(n,e){var t=Ph(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function R7(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,zu=n,Nu=l0(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,zu=n,Nu=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ox!==null?{id:Fm,overflow:Nm}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ph(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,zu=n,Nu=null,!0):!1;default:return!1}}function E4(n){return(n.mode&1)!==0&&(n.flags&128)===0}function I4(n){if(Io){var e=Nu;if(e){var t=e;if(!R7(n,e)){if(E4(n))throw Error(Zn(418));e=l0(t.nextSibling);var r=zu;e&&R7(n,e)?Nee(r,t):(n.flags=n.flags&-4097|2,Io=!1,zu=n)}}else{if(E4(n))throw Error(Zn(418));n.flags=n.flags&-4097|2,Io=!1,zu=n}}}function L7(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;zu=n}function XE(n){if(n!==zu)return!1;if(!Io)return L7(n),Io=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!A4(n.type,n.memoizedProps)),e&&(e=Nu)){if(E4(n))throw zee(),Error(Zn(418));for(;e;)Nee(n,e),e=l0(e.nextSibling)}if(L7(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Zn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Nu=l0(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Nu=null}}else Nu=zu?l0(n.stateNode.nextSibling):null;return!0}function zee(){for(var n=Nu;n;)n=l0(n.nextSibling)}function hw(){Nu=zu=null,Io=!1}function VU(n){jd===null?jd=[n]:jd.push(n)}var zge=ug.ReactCurrentBatchConfig;function Ud(n,e){if(n&&n.defaultProps){e=Xo({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var iR=F0(null),sR=null,Cb=null,HU=null;function jU(){HU=Cb=sR=null}function WU(n){var e=iR.current;xo(iR),n._currentValue=e}function P4(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Xb(n,e){sR=n,HU=Cb=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(cu=!0),n.firstContext=null)}function Nh(n){var e=n._currentValue;if(HU!==n)if(n={context:n,memoizedValue:e,next:null},Cb===null){if(sR===null)throw Error(Zn(308));Cb=n,sR.dependencies={lanes:0,firstContext:n}}else Cb=Cb.next=n;return e}var Py=null;function $U(n){Py===null?Py=[n]:Py.push(n)}function Uee(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,$U(e)):(t.next=s.next,s.next=t),e.interleaved=t,Km(n,r)}function Km(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Vv=!1;function XU(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gee(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function jm(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function c0(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,ys&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Km(n,t)}return s=r.interleaved,s===null?(e.next=e,$U(r)):(e.next=s.next,s.next=e),r.interleaved=e,Km(n,t)}function hP(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,LU(n,t)}}function D7(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var l={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?s=o=l:o=o.next=l,t=t.next}while(t!==null);o===null?s=o=e:o=o.next=e}else s=o=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function oR(n,e,t,r){var s=n.updateQueue;Vv=!1;var o=s.firstBaseUpdate,l=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var a=c,d=a.next;a.next=null,l===null?o=d:l.next=d,l=a;var f=n.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==l&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=a))}if(o!==null){var m=s.baseState;l=0,f=d=a=null,c=o;do{var _=c.lane,x=c.eventTime;if((r&_)===_){f!==null&&(f=f.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var A=n,I=c;switch(_=e,x=t,I.tag){case 1:if(A=I.payload,typeof A=="function"){m=A.call(x,m,_);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=I.payload,_=typeof A=="function"?A.call(x,m,_):A,_==null)break e;m=Xo({},m,_);break e;case 2:Vv=!0}}c.callback!==null&&c.lane!==0&&(n.flags|=64,_=s.effects,_===null?s.effects=[c]:_.push(c))}else x={eventTime:x,lane:_,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=x,a=m):f=f.next=x,l|=_;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;_=c,c=_.next,_.next=null,s.lastBaseUpdate=_,s.shared.pending=null}}while(!0);if(f===null&&(a=m),s.baseState=a,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);lx|=l,n.lanes=l,n.memoizedState=m}}function B7(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(Zn(191,s));s.call(r)}}}var Vee=new UQ.Component().refs;function R4(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Xo({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var dD={isMounted:function(n){return(n=n._reactInternals)?Px(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Pc(),s=h0(n),o=jm(r,s);o.payload=e,t!=null&&(o.callback=t),e=c0(n,o,s),e!==null&&(Jd(e,n,s,r),hP(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Pc(),s=h0(n),o=jm(r,s);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=c0(n,o,s),e!==null&&(Jd(e,n,s,r),hP(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Pc(),r=h0(n),s=jm(t,r);s.tag=2,e!=null&&(s.callback=e),e=c0(n,s,r),e!==null&&(Jd(e,n,r,t),hP(e,n,r))}};function k7(n,e,t,r,s,o,l){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,l):e.prototype&&e.prototype.isPureReactComponent?!JT(t,r)||!JT(s,o):!0}function Hee(n,e,t){var r=!1,s=x0,o=e.contextType;return typeof o=="object"&&o!==null?o=Nh(o):(s=pu(e)?sx:Ql.current,r=e.contextTypes,o=(r=r!=null)?uw(n,s):x0),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dD,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=o),e}function O7(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&dD.enqueueReplaceState(e,e.state,null)}function L4(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs=Vee,XU(n);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Nh(o):(o=pu(e)?sx:Ql.current,s.context=uw(n,o)),s.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(R4(n,e,o,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&dD.enqueueReplaceState(s,s.state,null),oR(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function VS(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Zn(309));var r=t.stateNode}if(!r)throw Error(Zn(147,n));var s=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(l){var c=s.refs;c===Vee&&(c=s.refs={}),l===null?delete c[o]:c[o]=l},e._stringRef=o,e)}if(typeof n!="string")throw Error(Zn(284));if(!t._owner)throw Error(Zn(290,n))}return n}function qE(n,e){throw n=Object.prototype.toString.call(e),Error(Zn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function F7(n){var e=n._init;return e(n._payload)}function jee(n){function e(C,L){if(n){var O=C.deletions;O===null?(C.deletions=[L],C.flags|=16):O.push(L)}}function t(C,L){if(!n)return null;for(;L!==null;)e(C,L),L=L.sibling;return null}function r(C,L){for(C=new Map;L!==null;)L.key!==null?C.set(L.key,L):C.set(L.index,L),L=L.sibling;return C}function s(C,L){return C=d0(C,L),C.index=0,C.sibling=null,C}function o(C,L,O){return C.index=O,n?(O=C.alternate,O!==null?(O=O.index,O<L?(C.flags|=2,L):O):(C.flags|=2,L)):(C.flags|=1048576,L)}function l(C){return n&&C.alternate===null&&(C.flags|=2),C}function c(C,L,O,H){return L===null||L.tag!==6?(L=GO(O,C.mode,H),L.return=C,L):(L=s(L,O),L.return=C,L)}function a(C,L,O,H){var q=O.type;return q===yb?f(C,L,O.props.children,H,O.key):L!==null&&(L.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Gv&&F7(q)===L.type)?(H=s(L,O.props),H.ref=VS(C,L,O),H.return=C,H):(H=vP(O.type,O.key,O.props,null,C.mode,H),H.ref=VS(C,L,O),H.return=C,H)}function d(C,L,O,H){return L===null||L.tag!==4||L.stateNode.containerInfo!==O.containerInfo||L.stateNode.implementation!==O.implementation?(L=VO(O,C.mode,H),L.return=C,L):(L=s(L,O.children||[]),L.return=C,L)}function f(C,L,O,H,q){return L===null||L.tag!==7?(L=Wy(O,C.mode,H,q),L.return=C,L):(L=s(L,O),L.return=C,L)}function m(C,L,O){if(typeof L=="string"&&L!==""||typeof L=="number")return L=GO(""+L,C.mode,O),L.return=C,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case FE:return O=vP(L.type,L.key,L.props,null,C.mode,O),O.ref=VS(C,null,L),O.return=C,O;case _b:return L=VO(L,C.mode,O),L.return=C,L;case Gv:var H=L._init;return m(C,H(L._payload),O)}if(zA(L)||FS(L))return L=Wy(L,C.mode,O,null),L.return=C,L;qE(C,L)}return null}function _(C,L,O,H){var q=L!==null?L.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return q!==null?null:c(C,L,""+O,H);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case FE:return O.key===q?a(C,L,O,H):null;case _b:return O.key===q?d(C,L,O,H):null;case Gv:return q=O._init,_(C,L,q(O._payload),H)}if(zA(O)||FS(O))return q!==null?null:f(C,L,O,H,null);qE(C,O)}return null}function x(C,L,O,H,q){if(typeof H=="string"&&H!==""||typeof H=="number")return C=C.get(O)||null,c(L,C,""+H,q);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case FE:return C=C.get(H.key===null?O:H.key)||null,a(L,C,H,q);case _b:return C=C.get(H.key===null?O:H.key)||null,d(L,C,H,q);case Gv:var Z=H._init;return x(C,L,O,Z(H._payload),q)}if(zA(H)||FS(H))return C=C.get(O)||null,f(L,C,H,q,null);qE(L,H)}return null}function A(C,L,O,H){for(var q=null,Z=null,J=L,re=L=0,se=null;J!==null&&re<O.length;re++){J.index>re?(se=J,J=null):se=J.sibling;var ae=_(C,J,O[re],H);if(ae===null){J===null&&(J=se);break}n&&J&&ae.alternate===null&&e(C,J),L=o(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae,J=se}if(re===O.length)return t(C,J),Io&&gy(C,re),q;if(J===null){for(;re<O.length;re++)J=m(C,O[re],H),J!==null&&(L=o(J,L,re),Z===null?q=J:Z.sibling=J,Z=J);return Io&&gy(C,re),q}for(J=r(C,J);re<O.length;re++)se=x(J,C,re,O[re],H),se!==null&&(n&&se.alternate!==null&&J.delete(se.key===null?re:se.key),L=o(se,L,re),Z===null?q=se:Z.sibling=se,Z=se);return n&&J.forEach(function(he){return e(C,he)}),Io&&gy(C,re),q}function I(C,L,O,H){var q=FS(O);if(typeof q!="function")throw Error(Zn(150));if(O=q.call(O),O==null)throw Error(Zn(151));for(var Z=q=null,J=L,re=L=0,se=null,ae=O.next();J!==null&&!ae.done;re++,ae=O.next()){J.index>re?(se=J,J=null):se=J.sibling;var he=_(C,J,ae.value,H);if(he===null){J===null&&(J=se);break}n&&J&&he.alternate===null&&e(C,J),L=o(he,L,re),Z===null?q=he:Z.sibling=he,Z=he,J=se}if(ae.done)return t(C,J),Io&&gy(C,re),q;if(J===null){for(;!ae.done;re++,ae=O.next())ae=m(C,ae.value,H),ae!==null&&(L=o(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae);return Io&&gy(C,re),q}for(J=r(C,J);!ae.done;re++,ae=O.next())ae=x(J,C,re,ae.value,H),ae!==null&&(n&&ae.alternate!==null&&J.delete(ae.key===null?re:ae.key),L=o(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae);return n&&J.forEach(function(Ae){return e(C,Ae)}),Io&&gy(C,re),q}function E(C,L,O,H){if(typeof O=="object"&&O!==null&&O.type===yb&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case FE:e:{for(var q=O.key,Z=L;Z!==null;){if(Z.key===q){if(q=O.type,q===yb){if(Z.tag===7){t(C,Z.sibling),L=s(Z,O.props.children),L.return=C,C=L;break e}}else if(Z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Gv&&F7(q)===Z.type){t(C,Z.sibling),L=s(Z,O.props),L.ref=VS(C,Z,O),L.return=C,C=L;break e}t(C,Z);break}else e(C,Z);Z=Z.sibling}O.type===yb?(L=Wy(O.props.children,C.mode,H,O.key),L.return=C,C=L):(H=vP(O.type,O.key,O.props,null,C.mode,H),H.ref=VS(C,L,O),H.return=C,C=H)}return l(C);case _b:e:{for(Z=O.key;L!==null;){if(L.key===Z)if(L.tag===4&&L.stateNode.containerInfo===O.containerInfo&&L.stateNode.implementation===O.implementation){t(C,L.sibling),L=s(L,O.children||[]),L.return=C,C=L;break e}else{t(C,L);break}else e(C,L);L=L.sibling}L=VO(O,C.mode,H),L.return=C,C=L}return l(C);case Gv:return Z=O._init,E(C,L,Z(O._payload),H)}if(zA(O))return A(C,L,O,H);if(FS(O))return I(C,L,O,H);qE(C,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,L!==null&&L.tag===6?(t(C,L.sibling),L=s(L,O),L.return=C,C=L):(t(C,L),L=GO(O,C.mode,H),L.return=C,C=L),l(C)):t(C,L)}return E}var dw=jee(!0),Wee=jee(!1),iC={},fp=F0(iC),nM=F0(iC),rM=F0(iC);function Ry(n){if(n===iC)throw Error(Zn(174));return n}function qU(n,e){switch(oo(rM,e),oo(nM,n),oo(fp,iC),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:u4(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=u4(e,n)}xo(fp),oo(fp,e)}function fw(){xo(fp),xo(nM),xo(rM)}function $ee(n){Ry(rM.current);var e=Ry(fp.current),t=u4(e,n.type);e!==t&&(oo(nM,n),oo(fp,t))}function YU(n){nM.current===n&&(xo(fp),xo(nM))}var Ho=F0(0);function aR(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var kO=[];function ZU(){for(var n=0;n<kO.length;n++)kO[n]._workInProgressVersionPrimary=null;kO.length=0}var dP=ug.ReactCurrentDispatcher,OO=ug.ReactCurrentBatchConfig,ax=0,Wo=null,Ha=null,sl=null,lR=!1,cT=!1,iM=0,Uge=0;function Fl(){throw Error(Zn(321))}function KU(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ef(n[t],e[t]))return!1;return!0}function JU(n,e,t,r,s,o){if(ax=o,Wo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dP.current=n===null||n.memoizedState===null?jge:Wge,n=t(r,s),cT){o=0;do{if(cT=!1,iM=0,25<=o)throw Error(Zn(301));o+=1,sl=Ha=null,e.updateQueue=null,dP.current=$ge,n=t(r,s)}while(cT)}if(dP.current=cR,e=Ha!==null&&Ha.next!==null,ax=0,sl=Ha=Wo=null,lR=!1,e)throw Error(Zn(300));return n}function QU(){var n=iM!==0;return iM=0,n}function np(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sl===null?Wo.memoizedState=sl=n:sl=sl.next=n,sl}function zh(){if(Ha===null){var n=Wo.alternate;n=n!==null?n.memoizedState:null}else n=Ha.next;var e=sl===null?Wo.memoizedState:sl.next;if(e!==null)sl=e,Ha=n;else{if(n===null)throw Error(Zn(310));Ha=n,n={memoizedState:Ha.memoizedState,baseState:Ha.baseState,baseQueue:Ha.baseQueue,queue:Ha.queue,next:null},sl===null?Wo.memoizedState=sl=n:sl=sl.next=n}return sl}function sM(n,e){return typeof e=="function"?e(n):e}function FO(n){var e=zh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=Ha,s=r.baseQueue,o=t.pending;if(o!==null){if(s!==null){var l=s.next;s.next=o.next,o.next=l}r.baseQueue=s=o,t.pending=null}if(s!==null){o=s.next,r=r.baseState;var c=l=null,a=null,d=o;do{var f=d.lane;if((ax&f)===f)a!==null&&(a=a.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};a===null?(c=a=m,l=r):a=a.next=m,Wo.lanes|=f,lx|=f}d=d.next}while(d!==null&&d!==o);a===null?l=r:a.next=c,ef(r,e.memoizedState)||(cu=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do o=s.lane,Wo.lanes|=o,lx|=o,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function NO(n){var e=zh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,o=e.memoizedState;if(s!==null){t.pending=null;var l=s=s.next;do o=n(o,l.action),l=l.next;while(l!==s);ef(o,e.memoizedState)||(cu=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function Xee(){}function qee(n,e){var t=Wo,r=zh(),s=e(),o=!ef(r.memoizedState,s);if(o&&(r.memoizedState=s,cu=!0),r=r.queue,e6(Kee.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||sl!==null&&sl.memoizedState.tag&1){if(t.flags|=2048,oM(9,Zee.bind(null,t,r,s,e),void 0,null),ol===null)throw Error(Zn(349));ax&30||Yee(t,e,s)}return s}function Yee(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Wo.updateQueue,e===null?(e={lastEffect:null,stores:null},Wo.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Zee(n,e,t,r){e.value=t,e.getSnapshot=r,Jee(e)&&Qee(n)}function Kee(n,e,t){return t(function(){Jee(e)&&Qee(n)})}function Jee(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ef(n,t)}catch{return!0}}function Qee(n){var e=Km(n,1);e!==null&&Jd(e,n,1,-1)}function N7(n){var e=np();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sM,lastRenderedState:n},e.queue=n,n=n.dispatch=Hge.bind(null,Wo,n),[e.memoizedState,n]}function oM(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Wo.updateQueue,e===null?(e={lastEffect:null,stores:null},Wo.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function ete(){return zh().memoizedState}function fP(n,e,t,r){var s=np();Wo.flags|=n,s.memoizedState=oM(1|e,t,void 0,r===void 0?null:r)}function fD(n,e,t,r){var s=zh();r=r===void 0?null:r;var o=void 0;if(Ha!==null){var l=Ha.memoizedState;if(o=l.destroy,r!==null&&KU(r,l.deps)){s.memoizedState=oM(e,t,o,r);return}}Wo.flags|=n,s.memoizedState=oM(1|e,t,o,r)}function z7(n,e){return fP(8390656,8,n,e)}function e6(n,e){return fD(2048,8,n,e)}function tte(n,e){return fD(4,2,n,e)}function nte(n,e){return fD(4,4,n,e)}function rte(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function ite(n,e,t){return t=t!=null?t.concat([n]):null,fD(4,4,rte.bind(null,e,n),t)}function t6(){}function ste(n,e){var t=zh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&KU(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function ote(n,e){var t=zh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&KU(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function ate(n,e,t){return ax&21?(ef(t,e)||(t=uee(),Wo.lanes|=t,lx|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,cu=!0),n.memoizedState=t)}function Gge(n,e){var t=Us;Us=t!==0&&4>t?t:4,n(!0);var r=OO.transition;OO.transition={};try{n(!1),e()}finally{Us=t,OO.transition=r}}function lte(){return zh().memoizedState}function Vge(n,e,t){var r=h0(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},cte(n))ute(e,t);else if(t=Uee(n,e,t,r),t!==null){var s=Pc();Jd(t,n,r,s),hte(t,e,r)}}function Hge(n,e,t){var r=h0(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(cte(n))ute(e,s);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var l=e.lastRenderedState,c=o(l,t);if(s.hasEagerState=!0,s.eagerState=c,ef(c,l)){var a=e.interleaved;a===null?(s.next=s,$U(e)):(s.next=a.next,a.next=s),e.interleaved=s;return}}catch{}finally{}t=Uee(n,e,s,r),t!==null&&(s=Pc(),Jd(t,n,r,s),hte(t,e,r))}}function cte(n){var e=n.alternate;return n===Wo||e!==null&&e===Wo}function ute(n,e){cT=lR=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function hte(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,LU(n,t)}}var cR={readContext:Nh,useCallback:Fl,useContext:Fl,useEffect:Fl,useImperativeHandle:Fl,useInsertionEffect:Fl,useLayoutEffect:Fl,useMemo:Fl,useReducer:Fl,useRef:Fl,useState:Fl,useDebugValue:Fl,useDeferredValue:Fl,useTransition:Fl,useMutableSource:Fl,useSyncExternalStore:Fl,useId:Fl,unstable_isNewReconciler:!1},jge={readContext:Nh,useCallback:function(n,e){return np().memoizedState=[n,e===void 0?null:e],n},useContext:Nh,useEffect:z7,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,fP(4194308,4,rte.bind(null,e,n),t)},useLayoutEffect:function(n,e){return fP(4194308,4,n,e)},useInsertionEffect:function(n,e){return fP(4,2,n,e)},useMemo:function(n,e){var t=np();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=np();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Vge.bind(null,Wo,n),[r.memoizedState,n]},useRef:function(n){var e=np();return n={current:n},e.memoizedState=n},useState:N7,useDebugValue:t6,useDeferredValue:function(n){return np().memoizedState=n},useTransition:function(){var n=N7(!1),e=n[0];return n=Gge.bind(null,n[1]),np().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Wo,s=np();if(Io){if(t===void 0)throw Error(Zn(407));t=t()}else{if(t=e(),ol===null)throw Error(Zn(349));ax&30||Yee(r,e,t)}s.memoizedState=t;var o={value:t,getSnapshot:e};return s.queue=o,z7(Kee.bind(null,r,o,n),[n]),r.flags|=2048,oM(9,Zee.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=np(),e=ol.identifierPrefix;if(Io){var t=Nm,r=Fm;t=(r&~(1<<32-Kd(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=iM++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Uge++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Wge={readContext:Nh,useCallback:ste,useContext:Nh,useEffect:e6,useImperativeHandle:ite,useInsertionEffect:tte,useLayoutEffect:nte,useMemo:ote,useReducer:FO,useRef:ete,useState:function(){return FO(sM)},useDebugValue:t6,useDeferredValue:function(n){var e=zh();return ate(e,Ha.memoizedState,n)},useTransition:function(){var n=FO(sM)[0],e=zh().memoizedState;return[n,e]},useMutableSource:Xee,useSyncExternalStore:qee,useId:lte,unstable_isNewReconciler:!1},$ge={readContext:Nh,useCallback:ste,useContext:Nh,useEffect:e6,useImperativeHandle:ite,useInsertionEffect:tte,useLayoutEffect:nte,useMemo:ote,useReducer:NO,useRef:ete,useState:function(){return NO(sM)},useDebugValue:t6,useDeferredValue:function(n){var e=zh();return Ha===null?e.memoizedState=n:ate(e,Ha.memoizedState,n)},useTransition:function(){var n=NO(sM)[0],e=zh().memoizedState;return[n,e]},useMutableSource:Xee,useSyncExternalStore:qee,useId:lte,unstable_isNewReconciler:!1};function pw(n,e){try{var t="",r=e;do t+=xme(r),r=r.return;while(r);var s=t}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:s,digest:null}}function zO(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function D4(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Xge=typeof WeakMap=="function"?WeakMap:Map;function dte(n,e,t){t=jm(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){hR||(hR=!0,H4=r),D4(n,e)},t}function fte(n,e,t){t=jm(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){D4(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){D4(n,e),typeof r!="function"&&(u0===null?u0=new Set([this]):u0.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),t}function U7(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new Xge;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=ave.bind(null,n,e,t),e.then(n,n))}function G7(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function V7(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=jm(-1,1),e.tag=2,c0(t,e,1))),t.lanes|=1),n)}var qge=ug.ReactCurrentOwner,cu=!1;function Sc(n,e,t,r){e.child=n===null?Wee(e,null,t,r):dw(e,n.child,t,r)}function H7(n,e,t,r,s){t=t.render;var o=e.ref;return Xb(e,s),r=JU(n,e,t,r,o,s),t=QU(),n!==null&&!cu?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Jm(n,e,s)):(Io&&t&&UU(e),e.flags|=1,Sc(n,e,r,s),e.child)}function j7(n,e,t,r,s){if(n===null){var o=t.type;return typeof o=="function"&&!c6(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,pte(n,e,o,r,s)):(n=vP(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&s)){var l=o.memoizedProps;if(t=t.compare,t=t!==null?t:JT,t(l,r)&&n.ref===e.ref)return Jm(n,e,s)}return e.flags|=1,n=d0(o,r),n.ref=e.ref,n.return=e,e.child=n}function pte(n,e,t,r,s){if(n!==null){var o=n.memoizedProps;if(JT(o,r)&&n.ref===e.ref)if(cu=!1,e.pendingProps=r=o,(n.lanes&s)!==0)n.flags&131072&&(cu=!0);else return e.lanes=n.lanes,Jm(n,e,s)}return B4(n,e,t,r,s)}function mte(n,e,t){var r=e.pendingProps,s=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},oo(Ib,ku),ku|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,oo(Ib,ku),ku|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,oo(Ib,ku),ku|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,oo(Ib,ku),ku|=r;return Sc(n,e,s,t),e.child}function gte(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function B4(n,e,t,r,s){var o=pu(t)?sx:Ql.current;return o=uw(e,o),Xb(e,s),t=JU(n,e,t,r,o,s),r=QU(),n!==null&&!cu?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Jm(n,e,s)):(Io&&r&&UU(e),e.flags|=1,Sc(n,e,t,s),e.child)}function W7(n,e,t,r,s){if(pu(t)){var o=!0;tR(e)}else o=!1;if(Xb(e,s),e.stateNode===null)pP(n,e),Hee(e,t,r),L4(e,t,r,s),r=!0;else if(n===null){var l=e.stateNode,c=e.memoizedProps;l.props=c;var a=l.context,d=t.contextType;typeof d=="object"&&d!==null?d=Nh(d):(d=pu(t)?sx:Ql.current,d=uw(e,d));var f=t.getDerivedStateFromProps,m=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||a!==d)&&O7(e,l,r,d),Vv=!1;var _=e.memoizedState;l.state=_,oR(e,r,l,s),a=e.memoizedState,c!==r||_!==a||fu.current||Vv?(typeof f=="function"&&(R4(e,t,f,r),a=e.memoizedState),(c=Vv||k7(e,t,c,r,_,a,d))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),l.props=r,l.state=a,l.context=d,r=c):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,Gee(n,e),c=e.memoizedProps,d=e.type===e.elementType?c:Ud(e.type,c),l.props=d,m=e.pendingProps,_=l.context,a=t.contextType,typeof a=="object"&&a!==null?a=Nh(a):(a=pu(t)?sx:Ql.current,a=uw(e,a));var x=t.getDerivedStateFromProps;(f=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==m||_!==a)&&O7(e,l,r,a),Vv=!1,_=e.memoizedState,l.state=_,oR(e,r,l,s);var A=e.memoizedState;c!==m||_!==A||fu.current||Vv?(typeof x=="function"&&(R4(e,t,x,r),A=e.memoizedState),(d=Vv||k7(e,t,d,r,_,A,a)||!1)?(f||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,A,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,A,a)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),l.props=r,l.state=A,l.context=a,r=d):(typeof l.componentDidUpdate!="function"||c===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),r=!1)}return k4(n,e,t,r,o,s)}function k4(n,e,t,r,s,o){gte(n,e);var l=(e.flags&128)!==0;if(!r&&!l)return s&&P7(e,t,!1),Jm(n,e,o);r=e.stateNode,qge.current=e;var c=l&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&l?(e.child=dw(e,n.child,null,o),e.child=dw(e,null,c,o)):Sc(n,e,c,o),e.memoizedState=r.state,s&&P7(e,t,!0),e.child}function vte(n){var e=n.stateNode;e.pendingContext?I7(n,e.pendingContext,e.pendingContext!==e.context):e.context&&I7(n,e.context,!1),qU(n,e.containerInfo)}function $7(n,e,t,r,s){return hw(),VU(s),e.flags|=256,Sc(n,e,t,r),e.child}var O4={dehydrated:null,treeContext:null,retryLane:0};function F4(n){return{baseLanes:n,cachePool:null,transitions:null}}function _te(n,e,t){var r=e.pendingProps,s=Ho.current,o=!1,l=(e.flags&128)!==0,c;if((c=l)||(c=n!==null&&n.memoizedState===null?!1:(s&2)!==0),c?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),oo(Ho,s&1),n===null)return I4(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,n=r.fallback,o?(r=e.mode,o=e.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=gD(l,r,0,null),n=Wy(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=F4(t),e.memoizedState=O4,n):n6(e,l));if(s=n.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Yge(n,e,l,r,c,s,t);if(o){o=r.fallback,l=e.mode,s=n.child,c=s.sibling;var a={mode:"hidden",children:r.children};return!(l&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=d0(s,a),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?o=d0(c,o):(o=Wy(o,l,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,l=n.child.memoizedState,l=l===null?F4(t):{baseLanes:l.baseLanes|t,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=n.childLanes&~t,e.memoizedState=O4,r}return o=n.child,n=o.sibling,r=d0(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function n6(n,e){return e=gD({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function YE(n,e,t,r){return r!==null&&VU(r),dw(e,n.child,null,t),n=n6(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Yge(n,e,t,r,s,o,l){if(t)return e.flags&256?(e.flags&=-257,r=zO(Error(Zn(422))),YE(n,e,l,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=gD({mode:"visible",children:r.children},s,0,null),o=Wy(o,s,l,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&dw(e,n.child,null,l),e.child.memoizedState=F4(l),e.memoizedState=O4,o);if(!(e.mode&1))return YE(n,e,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(Zn(419)),r=zO(o,r,void 0),YE(n,e,l,r)}if(c=(l&n.childLanes)!==0,cu||c){if(r=ol,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Km(n,s),Jd(r,n,s,-1))}return l6(),r=zO(Error(Zn(421))),YE(n,e,l,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=lve.bind(null,n),s._reactRetry=e,null):(n=o.treeContext,Nu=l0(s.nextSibling),zu=e,Io=!0,jd=null,n!==null&&(Sh[Ah++]=Fm,Sh[Ah++]=Nm,Sh[Ah++]=ox,Fm=n.id,Nm=n.overflow,ox=e),e=n6(e,r.children),e.flags|=4096,e)}function X7(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),P4(n.return,e,t)}function UO(n,e,t,r,s){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=s)}function yte(n,e,t){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Sc(n,e,r.children,t),r=Ho.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&X7(n,t,e);else if(n.tag===19)X7(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(oo(Ho,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&aR(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),UO(e,!1,s,t,o);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&aR(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}UO(e,!0,t,null,o);break;case"together":UO(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pP(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Jm(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),lx|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Zn(153));if(e.child!==null){for(n=e.child,t=d0(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=d0(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Zge(n,e,t){switch(e.tag){case 3:vte(e),hw();break;case 5:$ee(e);break;case 1:pu(e.type)&&tR(e);break;case 4:qU(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;oo(iR,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(oo(Ho,Ho.current&1),e.flags|=128,null):t&e.child.childLanes?_te(n,e,t):(oo(Ho,Ho.current&1),n=Jm(n,e,t),n!==null?n.sibling:null);oo(Ho,Ho.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return yte(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),oo(Ho,Ho.current),r)break;return null;case 22:case 23:return e.lanes=0,mte(n,e,t)}return Jm(n,e,t)}var xte,N4,bte,wte;xte=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};N4=function(){};bte=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Ry(fp.current);var o=null;switch(t){case"input":s=o4(n,s),r=o4(n,r),o=[];break;case"select":s=Xo({},s,{value:void 0}),r=Xo({},r,{value:void 0}),o=[];break;case"textarea":s=c4(n,s),r=c4(n,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=QP)}h4(t,r);var l;t=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(l in c)c.hasOwnProperty(l)&&(t||(t={}),t[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(WT.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var a=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&a!==c&&(a!=null||c!=null))if(d==="style")if(c){for(l in c)!c.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(t||(t={}),t[l]="");for(l in a)a.hasOwnProperty(l)&&c[l]!==a[l]&&(t||(t={}),t[l]=a[l])}else t||(o||(o=[]),o.push(d,t)),t=a;else d==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,c=c?c.__html:void 0,a!=null&&c!==a&&(o=o||[]).push(d,a)):d==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(d,""+a):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(WT.hasOwnProperty(d)?(a!=null&&d==="onScroll"&&_o("scroll",n),o||c===a||(o=[])):(o=o||[]).push(d,a))}t&&(o=o||[]).push("style",t);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};wte=function(n,e,t,r){t!==r&&(e.flags|=4)};function HS(n,e){if(!Io)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Nl(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Kge(n,e,t){var r=e.pendingProps;switch(GU(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nl(e),null;case 1:return pu(e.type)&&eR(),Nl(e),null;case 3:return r=e.stateNode,fw(),xo(fu),xo(Ql),ZU(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(XE(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jd!==null&&($4(jd),jd=null))),N4(n,e),Nl(e),null;case 5:YU(e);var s=Ry(rM.current);if(t=e.type,n!==null&&e.stateNode!=null)bte(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Zn(166));return Nl(e),null}if(n=Ry(fp.current),XE(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[rp]=e,r[tM]=o,n=(e.mode&1)!==0,t){case"dialog":_o("cancel",r),_o("close",r);break;case"iframe":case"object":case"embed":_o("load",r);break;case"video":case"audio":for(s=0;s<GA.length;s++)_o(GA[s],r);break;case"source":_o("error",r);break;case"img":case"image":case"link":_o("error",r),_o("load",r);break;case"details":_o("toggle",r);break;case"input":n7(r,o),_o("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_o("invalid",r);break;case"textarea":i7(r,o),_o("invalid",r)}h4(t,o),s=null;for(var l in o)if(o.hasOwnProperty(l)){var c=o[l];l==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&$E(r.textContent,c,n),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&$E(r.textContent,c,n),s=["children",""+c]):WT.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&_o("scroll",r)}switch(t){case"input":NE(r),r7(r,o,!0);break;case"textarea":NE(r),s7(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=QP)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=YQ(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=l.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=l.createElement(t,{is:r.is}):(n=l.createElement(t),t==="select"&&(l=n,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):n=l.createElementNS(n,t),n[rp]=e,n[tM]=r,xte(n,e,!1,!1),e.stateNode=n;e:{switch(l=d4(t,r),t){case"dialog":_o("cancel",n),_o("close",n),s=r;break;case"iframe":case"object":case"embed":_o("load",n),s=r;break;case"video":case"audio":for(s=0;s<GA.length;s++)_o(GA[s],n);s=r;break;case"source":_o("error",n),s=r;break;case"img":case"image":case"link":_o("error",n),_o("load",n),s=r;break;case"details":_o("toggle",n),s=r;break;case"input":n7(n,r),s=o4(n,r),_o("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Xo({},r,{value:void 0}),_o("invalid",n);break;case"textarea":i7(n,r),s=c4(n,r),_o("invalid",n);break;default:s=r}h4(t,s),c=s;for(o in c)if(c.hasOwnProperty(o)){var a=c[o];o==="style"?JQ(n,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&ZQ(n,a)):o==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&$T(n,a):typeof a=="number"&&$T(n,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(WT.hasOwnProperty(o)?a!=null&&o==="onScroll"&&_o("scroll",n):a!=null&&MU(n,o,a,l))}switch(t){case"input":NE(n),r7(n,r,!1);break;case"textarea":NE(n),s7(n);break;case"option":r.value!=null&&n.setAttribute("value",""+y0(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?Hb(n,!!r.multiple,o,!1):r.defaultValue!=null&&Hb(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=QP)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nl(e),null;case 6:if(n&&e.stateNode!=null)wte(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Zn(166));if(t=Ry(rM.current),Ry(fp.current),XE(e)){if(r=e.stateNode,t=e.memoizedProps,r[rp]=e,(o=r.nodeValue!==t)&&(n=zu,n!==null))switch(n.tag){case 3:$E(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&$E(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[rp]=e,e.stateNode=r}return Nl(e),null;case 13:if(xo(Ho),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Io&&Nu!==null&&e.mode&1&&!(e.flags&128))zee(),hw(),e.flags|=98560,o=!1;else if(o=XE(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(Zn(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Zn(317));o[rp]=e}else hw(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nl(e),o=!1}else jd!==null&&($4(jd),jd=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Ho.current&1?Wa===0&&(Wa=3):l6())),e.updateQueue!==null&&(e.flags|=4),Nl(e),null);case 4:return fw(),N4(n,e),n===null&&QT(e.stateNode.containerInfo),Nl(e),null;case 10:return WU(e.type._context),Nl(e),null;case 17:return pu(e.type)&&eR(),Nl(e),null;case 19:if(xo(Ho),o=e.memoizedState,o===null)return Nl(e),null;if(r=(e.flags&128)!==0,l=o.rendering,l===null)if(r)HS(o,!1);else{if(Wa!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(l=aR(n),l!==null){for(e.flags|=128,HS(o,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,n=l.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return oo(Ho,Ho.current&1|2),e.child}n=n.sibling}o.tail!==null&&ga()>mw&&(e.flags|=128,r=!0,HS(o,!1),e.lanes=4194304)}else{if(!r)if(n=aR(l),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),HS(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Io)return Nl(e),null}else 2*ga()-o.renderingStartTime>mw&&t!==1073741824&&(e.flags|=128,r=!0,HS(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(t=o.last,t!==null?t.sibling=l:e.child=l,o.last=l)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ga(),e.sibling=null,t=Ho.current,oo(Ho,r?t&1|2:t&1),e):(Nl(e),null);case 22:case 23:return a6(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ku&1073741824&&(Nl(e),e.subtreeFlags&6&&(e.flags|=8192)):Nl(e),null;case 24:return null;case 25:return null}throw Error(Zn(156,e.tag))}function Jge(n,e){switch(GU(e),e.tag){case 1:return pu(e.type)&&eR(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return fw(),xo(fu),xo(Ql),ZU(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return YU(e),null;case 13:if(xo(Ho),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Zn(340));hw()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return xo(Ho),null;case 4:return fw(),null;case 10:return WU(e.type._context),null;case 22:case 23:return a6(),null;case 24:return null;default:return null}}var ZE=!1,Xl=!1,Qge=typeof WeakSet=="function"?WeakSet:Set,Er=null;function Eb(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){na(n,e,r)}else t.current=null}function z4(n,e,t){try{t()}catch(r){na(n,e,r)}}var q7=!1;function eve(n,e){if(w4=ZP,n=Mee(),zU(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var l=0,c=-1,a=-1,d=0,f=0,m=n,_=null;t:for(;;){for(var x;m!==t||s!==0&&m.nodeType!==3||(c=l+s),m!==o||r!==0&&m.nodeType!==3||(a=l+r),m.nodeType===3&&(l+=m.nodeValue.length),(x=m.firstChild)!==null;)_=m,m=x;for(;;){if(m===n)break t;if(_===t&&++d===s&&(c=l),_===o&&++f===r&&(a=l),(x=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=x}t=c===-1||a===-1?null:{start:c,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(S4={focusedElem:n,selectionRange:t},ZP=!1,Er=e;Er!==null;)if(e=Er,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Er=n;else for(;Er!==null;){e=Er;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var I=A.memoizedProps,E=A.memoizedState,C=e.stateNode,L=C.getSnapshotBeforeUpdate(e.elementType===e.type?I:Ud(e.type,I),E);C.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var O=e.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zn(163))}}catch(H){na(e,e.return,H)}if(n=e.sibling,n!==null){n.return=e.return,Er=n;break}Er=e.return}return A=q7,q7=!1,A}function uT(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var o=s.destroy;s.destroy=void 0,o!==void 0&&z4(e,t,o)}s=s.next}while(s!==r)}}function pD(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function U4(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Ste(n){var e=n.alternate;e!==null&&(n.alternate=null,Ste(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[rp],delete e[tM],delete e[M4],delete e[Oge],delete e[Fge])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Ate(n){return n.tag===5||n.tag===3||n.tag===4}function Y7(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Ate(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function G4(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=QP));else if(r!==4&&(n=n.child,n!==null))for(G4(n,e,t),n=n.sibling;n!==null;)G4(n,e,t),n=n.sibling}function V4(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(V4(n,e,t),n=n.sibling;n!==null;)V4(n,e,t),n=n.sibling}var xl=null,Hd=!1;function gv(n,e,t){for(t=t.child;t!==null;)Tte(n,e,t),t=t.sibling}function Tte(n,e,t){if(dp&&typeof dp.onCommitFiberUnmount=="function")try{dp.onCommitFiberUnmount(oD,t)}catch{}switch(t.tag){case 5:Xl||Eb(t,e);case 6:var r=xl,s=Hd;xl=null,gv(n,e,t),xl=r,Hd=s,xl!==null&&(Hd?(n=xl,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):xl.removeChild(t.stateNode));break;case 18:xl!==null&&(Hd?(n=xl,t=t.stateNode,n.nodeType===8?DO(n.parentNode,t):n.nodeType===1&&DO(n,t),ZT(n)):DO(xl,t.stateNode));break;case 4:r=xl,s=Hd,xl=t.stateNode.containerInfo,Hd=!0,gv(n,e,t),xl=r,Hd=s;break;case 0:case 11:case 14:case 15:if(!Xl&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&z4(t,e,l),s=s.next}while(s!==r)}gv(n,e,t);break;case 1:if(!Xl&&(Eb(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(c){na(t,e,c)}gv(n,e,t);break;case 21:gv(n,e,t);break;case 22:t.mode&1?(Xl=(r=Xl)||t.memoizedState!==null,gv(n,e,t),Xl=r):gv(n,e,t);break;default:gv(n,e,t)}}function Z7(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Qge),e.forEach(function(r){var s=cve.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Pd(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var o=n,l=e,c=l;e:for(;c!==null;){switch(c.tag){case 5:xl=c.stateNode,Hd=!1;break e;case 3:xl=c.stateNode.containerInfo,Hd=!0;break e;case 4:xl=c.stateNode.containerInfo,Hd=!0;break e}c=c.return}if(xl===null)throw Error(Zn(160));Tte(o,l,s),xl=null,Hd=!1;var a=s.alternate;a!==null&&(a.return=null),s.return=null}catch(d){na(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Mte(e,n),e=e.sibling}function Mte(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Pd(e,n),Yf(n),r&4){try{uT(3,n,n.return),pD(3,n)}catch(I){na(n,n.return,I)}try{uT(5,n,n.return)}catch(I){na(n,n.return,I)}}break;case 1:Pd(e,n),Yf(n),r&512&&t!==null&&Eb(t,t.return);break;case 5:if(Pd(e,n),Yf(n),r&512&&t!==null&&Eb(t,t.return),n.flags&32){var s=n.stateNode;try{$T(s,"")}catch(I){na(n,n.return,I)}}if(r&4&&(s=n.stateNode,s!=null)){var o=n.memoizedProps,l=t!==null?t.memoizedProps:o,c=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&XQ(s,o),d4(c,l);var d=d4(c,o);for(l=0;l<a.length;l+=2){var f=a[l],m=a[l+1];f==="style"?JQ(s,m):f==="dangerouslySetInnerHTML"?ZQ(s,m):f==="children"?$T(s,m):MU(s,f,m,d)}switch(c){case"input":a4(s,o);break;case"textarea":qQ(s,o);break;case"select":var _=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var x=o.value;x!=null?Hb(s,!!o.multiple,x,!1):_!==!!o.multiple&&(o.defaultValue!=null?Hb(s,!!o.multiple,o.defaultValue,!0):Hb(s,!!o.multiple,o.multiple?[]:"",!1))}s[tM]=o}catch(I){na(n,n.return,I)}}break;case 6:if(Pd(e,n),Yf(n),r&4){if(n.stateNode===null)throw Error(Zn(162));s=n.stateNode,o=n.memoizedProps;try{s.nodeValue=o}catch(I){na(n,n.return,I)}}break;case 3:if(Pd(e,n),Yf(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{ZT(e.containerInfo)}catch(I){na(n,n.return,I)}break;case 4:Pd(e,n),Yf(n);break;case 13:Pd(e,n),Yf(n),s=n.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(s6=ga())),r&4&&Z7(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(Xl=(d=Xl)||f,Pd(e,n),Xl=d):Pd(e,n),Yf(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!f&&n.mode&1)for(Er=n,f=n.child;f!==null;){for(m=Er=f;Er!==null;){switch(_=Er,x=_.child,_.tag){case 0:case 11:case 14:case 15:uT(4,_,_.return);break;case 1:Eb(_,_.return);var A=_.stateNode;if(typeof A.componentWillUnmount=="function"){r=_,t=_.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(I){na(r,t,I)}}break;case 5:Eb(_,_.return);break;case 22:if(_.memoizedState!==null){J7(m);continue}}x!==null?(x.return=_,Er=x):J7(m)}f=f.sibling}e:for(f=null,m=n;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=m.stateNode,a=m.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,c.style.display=KQ("display",l))}catch(I){na(n,n.return,I)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(I){na(n,n.return,I)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Pd(e,n),Yf(n),r&4&&Z7(n);break;case 21:break;default:Pd(e,n),Yf(n)}}function Yf(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Ate(t)){var r=t;break e}t=t.return}throw Error(Zn(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&($T(s,""),r.flags&=-33);var o=Y7(n);V4(n,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,c=Y7(n);G4(n,c,l);break;default:throw Error(Zn(161))}}catch(a){na(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function tve(n,e,t){Er=n,Cte(n)}function Cte(n,e,t){for(var r=(n.mode&1)!==0;Er!==null;){var s=Er,o=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||ZE;if(!l){var c=s.alternate,a=c!==null&&c.memoizedState!==null||Xl;c=ZE;var d=Xl;if(ZE=l,(Xl=a)&&!d)for(Er=s;Er!==null;)l=Er,a=l.child,l.tag===22&&l.memoizedState!==null?Q7(s):a!==null?(a.return=l,Er=a):Q7(s);for(;o!==null;)Er=o,Cte(o),o=o.sibling;Er=s,ZE=c,Xl=d}K7(n)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Er=o):K7(n)}}function K7(n){for(;Er!==null;){var e=Er;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xl||pD(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xl)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Ud(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&B7(e,o,r);break;case 3:var l=e.updateQueue;if(l!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}B7(e,l,t)}break;case 5:var c=e.stateNode;if(t===null&&e.flags&4){t=c;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&ZT(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zn(163))}Xl||e.flags&512&&U4(e)}catch(_){na(e,e.return,_)}}if(e===n){Er=null;break}if(t=e.sibling,t!==null){t.return=e.return,Er=t;break}Er=e.return}}function J7(n){for(;Er!==null;){var e=Er;if(e===n){Er=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Er=t;break}Er=e.return}}function Q7(n){for(;Er!==null;){var e=Er;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{pD(4,e)}catch(a){na(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(a){na(e,s,a)}}var o=e.return;try{U4(e)}catch(a){na(e,o,a)}break;case 5:var l=e.return;try{U4(e)}catch(a){na(e,l,a)}}}catch(a){na(e,e.return,a)}if(e===n){Er=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Er=c;break}Er=e.return}}var nve=Math.ceil,uR=ug.ReactCurrentDispatcher,r6=ug.ReactCurrentOwner,Lh=ug.ReactCurrentBatchConfig,ys=0,ol=null,Ta=null,Tl=0,ku=0,Ib=F0(0),Wa=0,aM=null,lx=0,mD=0,i6=0,hT=null,su=null,s6=0,mw=1/0,Mm=null,hR=!1,H4=null,u0=null,KE=!1,Zv=null,dR=0,dT=0,j4=null,mP=-1,gP=0;function Pc(){return ys&6?ga():mP!==-1?mP:mP=ga()}function h0(n){return n.mode&1?ys&2&&Tl!==0?Tl&-Tl:zge.transition!==null?(gP===0&&(gP=uee()),gP):(n=Us,n!==0||(n=window.event,n=n===void 0?16:vee(n.type)),n):1}function Jd(n,e,t,r){if(50<dT)throw dT=0,j4=null,Error(Zn(185));tC(n,t,r),(!(ys&2)||n!==ol)&&(n===ol&&(!(ys&2)&&(mD|=t),Wa===4&&$v(n,Tl)),mu(n,r),t===1&&ys===0&&!(e.mode&1)&&(mw=ga()+500,hD&&N0()))}function mu(n,e){var t=n.callbackNode;zme(n,e);var r=YP(n,n===ol?Tl:0);if(r===0)t!==null&&l7(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&l7(t),e===1)n.tag===0?Nge(eW.bind(null,n)):Oee(eW.bind(null,n)),Bge(function(){!(ys&6)&&N0()}),t=null;else{switch(hee(r)){case 1:t=RU;break;case 4:t=lee;break;case 16:t=qP;break;case 536870912:t=cee;break;default:t=qP}t=kte(t,Ete.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Ete(n,e){if(mP=-1,gP=0,ys&6)throw Error(Zn(327));var t=n.callbackNode;if(qb()&&n.callbackNode!==t)return null;var r=YP(n,n===ol?Tl:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=fR(n,r);else{e=r;var s=ys;ys|=2;var o=Pte();(ol!==n||Tl!==e)&&(Mm=null,mw=ga()+500,jy(n,e));do try{sve();break}catch(c){Ite(n,c)}while(!0);jU(),uR.current=o,ys=s,Ta!==null?e=0:(ol=null,Tl=0,e=Wa)}if(e!==0){if(e===2&&(s=v4(n),s!==0&&(r=s,e=W4(n,s))),e===1)throw t=aM,jy(n,0),$v(n,r),mu(n,ga()),t;if(e===6)$v(n,r);else{if(s=n.current.alternate,!(r&30)&&!rve(s)&&(e=fR(n,r),e===2&&(o=v4(n),o!==0&&(r=o,e=W4(n,o))),e===1))throw t=aM,jy(n,0),$v(n,r),mu(n,ga()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(Zn(345));case 2:vy(n,su,Mm);break;case 3:if($v(n,r),(r&130023424)===r&&(e=s6+500-ga(),10<e)){if(YP(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Pc(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=T4(vy.bind(null,n,su,Mm),e);break}vy(n,su,Mm);break;case 4:if($v(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var l=31-Kd(r);o=1<<l,l=e[l],l>s&&(s=l),r&=~o}if(r=s,r=ga()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nve(r/1960))-r,10<r){n.timeoutHandle=T4(vy.bind(null,n,su,Mm),r);break}vy(n,su,Mm);break;case 5:vy(n,su,Mm);break;default:throw Error(Zn(329))}}}return mu(n,ga()),n.callbackNode===t?Ete.bind(null,n):null}function W4(n,e){var t=hT;return n.current.memoizedState.isDehydrated&&(jy(n,e).flags|=256),n=fR(n,e),n!==2&&(e=su,su=t,e!==null&&$4(e)),n}function $4(n){su===null?su=n:su.push.apply(su,n)}function rve(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],o=s.getSnapshot;s=s.value;try{if(!ef(o(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function $v(n,e){for(e&=~i6,e&=~mD,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Kd(e),r=1<<t;n[t]=-1,e&=~r}}function eW(n){if(ys&6)throw Error(Zn(327));qb();var e=YP(n,0);if(!(e&1))return mu(n,ga()),null;var t=fR(n,e);if(n.tag!==0&&t===2){var r=v4(n);r!==0&&(e=r,t=W4(n,r))}if(t===1)throw t=aM,jy(n,0),$v(n,e),mu(n,ga()),t;if(t===6)throw Error(Zn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,vy(n,su,Mm),mu(n,ga()),null}function o6(n,e){var t=ys;ys|=1;try{return n(e)}finally{ys=t,ys===0&&(mw=ga()+500,hD&&N0())}}function cx(n){Zv!==null&&Zv.tag===0&&!(ys&6)&&qb();var e=ys;ys|=1;var t=Lh.transition,r=Us;try{if(Lh.transition=null,Us=1,n)return n()}finally{Us=r,Lh.transition=t,ys=e,!(ys&6)&&N0()}}function a6(){ku=Ib.current,xo(Ib)}function jy(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Dge(t)),Ta!==null)for(t=Ta.return;t!==null;){var r=t;switch(GU(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&eR();break;case 3:fw(),xo(fu),xo(Ql),ZU();break;case 5:YU(r);break;case 4:fw();break;case 13:xo(Ho);break;case 19:xo(Ho);break;case 10:WU(r.type._context);break;case 22:case 23:a6()}t=t.return}if(ol=n,Ta=n=d0(n.current,null),Tl=ku=e,Wa=0,aM=null,i6=mD=lx=0,su=hT=null,Py!==null){for(e=0;e<Py.length;e++)if(t=Py[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,o=t.pending;if(o!==null){var l=o.next;o.next=s,r.next=l}t.pending=r}Py=null}return n}function Ite(n,e){do{var t=Ta;try{if(jU(),dP.current=cR,lR){for(var r=Wo.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}lR=!1}if(ax=0,sl=Ha=Wo=null,cT=!1,iM=0,r6.current=null,t===null||t.return===null){Wa=1,aM=e,Ta=null;break}e:{var o=n,l=t.return,c=t,a=e;if(e=Tl,c.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var d=a,f=c,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var _=f.alternate;_?(f.updateQueue=_.updateQueue,f.memoizedState=_.memoizedState,f.lanes=_.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=G7(l);if(x!==null){x.flags&=-257,V7(x,l,c,o,e),x.mode&1&&U7(o,d,e),e=x,a=d;var A=e.updateQueue;if(A===null){var I=new Set;I.add(a),e.updateQueue=I}else A.add(a);break e}else{if(!(e&1)){U7(o,d,e),l6();break e}a=Error(Zn(426))}}else if(Io&&c.mode&1){var E=G7(l);if(E!==null){!(E.flags&65536)&&(E.flags|=256),V7(E,l,c,o,e),VU(pw(a,c));break e}}o=a=pw(a,c),Wa!==4&&(Wa=2),hT===null?hT=[o]:hT.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var C=dte(o,a,e);D7(o,C);break e;case 1:c=a;var L=o.type,O=o.stateNode;if(!(o.flags&128)&&(typeof L.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(u0===null||!u0.has(O)))){o.flags|=65536,e&=-e,o.lanes|=e;var H=fte(o,c,e);D7(o,H);break e}}o=o.return}while(o!==null)}Lte(t)}catch(q){e=q,Ta===t&&t!==null&&(Ta=t=t.return);continue}break}while(!0)}function Pte(){var n=uR.current;return uR.current=cR,n===null?cR:n}function l6(){(Wa===0||Wa===3||Wa===2)&&(Wa=4),ol===null||!(lx&268435455)&&!(mD&268435455)||$v(ol,Tl)}function fR(n,e){var t=ys;ys|=2;var r=Pte();(ol!==n||Tl!==e)&&(Mm=null,jy(n,e));do try{ive();break}catch(s){Ite(n,s)}while(!0);if(jU(),ys=t,uR.current=r,Ta!==null)throw Error(Zn(261));return ol=null,Tl=0,Wa}function ive(){for(;Ta!==null;)Rte(Ta)}function sve(){for(;Ta!==null&&!Pme();)Rte(Ta)}function Rte(n){var e=Bte(n.alternate,n,ku);n.memoizedProps=n.pendingProps,e===null?Lte(n):Ta=e,r6.current=null}function Lte(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Jge(t,e),t!==null){t.flags&=32767,Ta=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Wa=6,Ta=null;return}}else if(t=Kge(t,e,ku),t!==null){Ta=t;return}if(e=e.sibling,e!==null){Ta=e;return}Ta=e=n}while(e!==null);Wa===0&&(Wa=5)}function vy(n,e,t){var r=Us,s=Lh.transition;try{Lh.transition=null,Us=1,ove(n,e,t,r)}finally{Lh.transition=s,Us=r}return null}function ove(n,e,t,r){do qb();while(Zv!==null);if(ys&6)throw Error(Zn(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Zn(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(Ume(n,o),n===ol&&(Ta=ol=null,Tl=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||KE||(KE=!0,kte(qP,function(){return qb(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=Lh.transition,Lh.transition=null;var l=Us;Us=1;var c=ys;ys|=4,r6.current=null,eve(n,t),Mte(t,n),Mge(S4),ZP=!!w4,S4=w4=null,n.current=t,tve(t),Rme(),ys=c,Us=l,Lh.transition=o}else n.current=t;if(KE&&(KE=!1,Zv=n,dR=s),o=n.pendingLanes,o===0&&(u0=null),Bme(t.stateNode),mu(n,ga()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(hR)throw hR=!1,n=H4,H4=null,n;return dR&1&&n.tag!==0&&qb(),o=n.pendingLanes,o&1?n===j4?dT++:(dT=0,j4=n):dT=0,N0(),null}function qb(){if(Zv!==null){var n=hee(dR),e=Lh.transition,t=Us;try{if(Lh.transition=null,Us=16>n?16:n,Zv===null)var r=!1;else{if(n=Zv,Zv=null,dR=0,ys&6)throw Error(Zn(331));var s=ys;for(ys|=4,Er=n.current;Er!==null;){var o=Er,l=o.child;if(Er.flags&16){var c=o.deletions;if(c!==null){for(var a=0;a<c.length;a++){var d=c[a];for(Er=d;Er!==null;){var f=Er;switch(f.tag){case 0:case 11:case 15:uT(8,f,o)}var m=f.child;if(m!==null)m.return=f,Er=m;else for(;Er!==null;){f=Er;var _=f.sibling,x=f.return;if(Ste(f),f===d){Er=null;break}if(_!==null){_.return=x,Er=_;break}Er=x}}}var A=o.alternate;if(A!==null){var I=A.child;if(I!==null){A.child=null;do{var E=I.sibling;I.sibling=null,I=E}while(I!==null)}}Er=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,Er=l;else e:for(;Er!==null;){if(o=Er,o.flags&2048)switch(o.tag){case 0:case 11:case 15:uT(9,o,o.return)}var C=o.sibling;if(C!==null){C.return=o.return,Er=C;break e}Er=o.return}}var L=n.current;for(Er=L;Er!==null;){l=Er;var O=l.child;if(l.subtreeFlags&2064&&O!==null)O.return=l,Er=O;else e:for(l=L;Er!==null;){if(c=Er,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:pD(9,c)}}catch(q){na(c,c.return,q)}if(c===l){Er=null;break e}var H=c.sibling;if(H!==null){H.return=c.return,Er=H;break e}Er=c.return}}if(ys=s,N0(),dp&&typeof dp.onPostCommitFiberRoot=="function")try{dp.onPostCommitFiberRoot(oD,n)}catch{}r=!0}return r}finally{Us=t,Lh.transition=e}}return!1}function tW(n,e,t){e=pw(t,e),e=dte(n,e,1),n=c0(n,e,1),e=Pc(),n!==null&&(tC(n,1,e),mu(n,e))}function na(n,e,t){if(n.tag===3)tW(n,n,t);else for(;e!==null;){if(e.tag===3){tW(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(u0===null||!u0.has(r))){n=pw(t,n),n=fte(e,n,1),e=c0(e,n,1),n=Pc(),e!==null&&(tC(e,1,n),mu(e,n));break}}e=e.return}}function ave(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Pc(),n.pingedLanes|=n.suspendedLanes&t,ol===n&&(Tl&t)===t&&(Wa===4||Wa===3&&(Tl&130023424)===Tl&&500>ga()-s6?jy(n,0):i6|=t),mu(n,e)}function Dte(n,e){e===0&&(n.mode&1?(e=GE,GE<<=1,!(GE&130023424)&&(GE=4194304)):e=1);var t=Pc();n=Km(n,e),n!==null&&(tC(n,e,t),mu(n,t))}function lve(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Dte(n,t)}function cve(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Zn(314))}r!==null&&r.delete(e),Dte(n,t)}var Bte;Bte=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||fu.current)cu=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return cu=!1,Zge(n,e,t);cu=!!(n.flags&131072)}else cu=!1,Io&&e.flags&1048576&&Fee(e,rR,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pP(n,e),n=e.pendingProps;var s=uw(e,Ql.current);Xb(e,t),s=JU(null,e,r,n,s,t);var o=QU();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pu(r)?(o=!0,tR(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,XU(e),s.updater=dD,e.stateNode=s,s._reactInternals=e,L4(e,r,n,t),e=k4(null,e,r,!0,o,t)):(e.tag=0,Io&&o&&UU(e),Sc(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(pP(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=hve(r),n=Ud(r,n),s){case 0:e=B4(null,e,r,n,t);break e;case 1:e=W7(null,e,r,n,t);break e;case 11:e=H7(null,e,r,n,t);break e;case 14:e=j7(null,e,r,Ud(r.type,n),t);break e}throw Error(Zn(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ud(r,s),B4(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ud(r,s),W7(n,e,r,s,t);case 3:e:{if(vte(e),n===null)throw Error(Zn(387));r=e.pendingProps,o=e.memoizedState,s=o.element,Gee(n,e),oR(e,r,null,t);var l=e.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=pw(Error(Zn(423)),e),e=$7(n,e,r,t,s);break e}else if(r!==s){s=pw(Error(Zn(424)),e),e=$7(n,e,r,t,s);break e}else for(Nu=l0(e.stateNode.containerInfo.firstChild),zu=e,Io=!0,jd=null,t=Wee(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hw(),r===s){e=Jm(n,e,t);break e}Sc(n,e,r,t)}e=e.child}return e;case 5:return $ee(e),n===null&&I4(e),r=e.type,s=e.pendingProps,o=n!==null?n.memoizedProps:null,l=s.children,A4(r,s)?l=null:o!==null&&A4(r,o)&&(e.flags|=32),gte(n,e),Sc(n,e,l,t),e.child;case 6:return n===null&&I4(e),null;case 13:return _te(n,e,t);case 4:return qU(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=dw(e,null,r,t):Sc(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ud(r,s),H7(n,e,r,s,t);case 7:return Sc(n,e,e.pendingProps,t),e.child;case 8:return Sc(n,e,e.pendingProps.children,t),e.child;case 12:return Sc(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,l=s.value,oo(iR,r._currentValue),r._currentValue=l,o!==null)if(ef(o.value,l)){if(o.children===s.children&&!fu.current){e=Jm(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var c=o.dependencies;if(c!==null){l=o.child;for(var a=c.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=jm(-1,t&-t),a.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?a.next=a:(a.next=f.next,f.next=a),d.pending=a}}o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),P4(o.return,t,e),c.lanes|=t;break}a=a.next}}else if(o.tag===10)l=o.type===e.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(Zn(341));l.lanes|=t,c=l.alternate,c!==null&&(c.lanes|=t),P4(l,t,e),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===e){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}Sc(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Xb(e,t),s=Nh(s),r=r(s),e.flags|=1,Sc(n,e,r,t),e.child;case 14:return r=e.type,s=Ud(r,e.pendingProps),s=Ud(r.type,s),j7(n,e,r,s,t);case 15:return pte(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ud(r,s),pP(n,e),e.tag=1,pu(r)?(n=!0,tR(e)):n=!1,Xb(e,t),Hee(e,r,s),L4(e,r,s,t),k4(null,e,r,!0,n,t);case 19:return yte(n,e,t);case 22:return mte(n,e,t)}throw Error(Zn(156,e.tag))};function kte(n,e){return aee(n,e)}function uve(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ph(n,e,t,r){return new uve(n,e,t,r)}function c6(n){return n=n.prototype,!(!n||!n.isReactComponent)}function hve(n){if(typeof n=="function")return c6(n)?1:0;if(n!=null){if(n=n.$$typeof,n===EU)return 11;if(n===IU)return 14}return 2}function d0(n,e){var t=n.alternate;return t===null?(t=Ph(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function vP(n,e,t,r,s,o){var l=2;if(r=n,typeof n=="function")c6(n)&&(l=1);else if(typeof n=="string")l=5;else e:switch(n){case yb:return Wy(t.children,s,o,e);case CU:l=8,s|=8;break;case n4:return n=Ph(12,t,e,s|2),n.elementType=n4,n.lanes=o,n;case r4:return n=Ph(13,t,e,s),n.elementType=r4,n.lanes=o,n;case i4:return n=Ph(19,t,e,s),n.elementType=i4,n.lanes=o,n;case jQ:return gD(t,s,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case VQ:l=10;break e;case HQ:l=9;break e;case EU:l=11;break e;case IU:l=14;break e;case Gv:l=16,r=null;break e}throw Error(Zn(130,n==null?n:typeof n,""))}return e=Ph(l,t,e,s),e.elementType=n,e.type=r,e.lanes=o,e}function Wy(n,e,t,r){return n=Ph(7,n,r,e),n.lanes=t,n}function gD(n,e,t,r){return n=Ph(22,n,r,e),n.elementType=jQ,n.lanes=t,n.stateNode={isHidden:!1},n}function GO(n,e,t){return n=Ph(6,n,null,e),n.lanes=t,n}function VO(n,e,t){return e=Ph(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function dve(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wO(0),this.expirationTimes=wO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wO(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function u6(n,e,t,r,s,o,l,c,a){return n=new dve(n,e,t,c,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ph(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},XU(o),n}function fve(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_b,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Ote(n){if(!n)return x0;n=n._reactInternals;e:{if(Px(n)!==n||n.tag!==1)throw Error(Zn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Zn(171))}if(n.tag===1){var t=n.type;if(pu(t))return kee(n,t,e)}return e}function Fte(n,e,t,r,s,o,l,c,a){return n=u6(t,r,!0,n,s,o,l,c,a),n.context=Ote(null),t=n.current,r=Pc(),s=h0(t),o=jm(r,s),o.callback=e??null,c0(t,o,s),n.current.lanes=s,tC(n,s,r),mu(n,r),n}function vD(n,e,t,r){var s=e.current,o=Pc(),l=h0(s);return t=Ote(t),e.context===null?e.context=t:e.pendingContext=t,e=jm(o,l),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=c0(s,e,l),n!==null&&(Jd(n,s,l,o),hP(n,s,l)),l}function pR(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function nW(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function h6(n,e){nW(n,e),(n=n.alternate)&&nW(n,e)}function pve(){return null}var Nte=typeof reportError=="function"?reportError:function(n){console.error(n)};function d6(n){this._internalRoot=n}_D.prototype.render=d6.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Zn(409));vD(n,e,null,null)};_D.prototype.unmount=d6.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;cx(function(){vD(null,n,null,null)}),e[Zm]=null}};function _D(n){this._internalRoot=n}_D.prototype.unstable_scheduleHydration=function(n){if(n){var e=pee();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Wv.length&&e!==0&&e<Wv[t].priority;t++);Wv.splice(t,0,n),t===0&&gee(n)}};function f6(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function yD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function rW(){}function mve(n,e,t,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=pR(l);o.call(d)}}var l=Fte(e,r,n,0,null,!1,!1,"",rW);return n._reactRootContainer=l,n[Zm]=l.current,QT(n.nodeType===8?n.parentNode:n),cx(),l}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=pR(a);c.call(d)}}var a=u6(n,0,!1,null,null,!1,!1,"",rW);return n._reactRootContainer=a,n[Zm]=a.current,QT(n.nodeType===8?n.parentNode:n),cx(function(){vD(e,a,t,r)}),a}function xD(n,e,t,r,s){var o=t._reactRootContainer;if(o){var l=o;if(typeof s=="function"){var c=s;s=function(){var a=pR(l);c.call(a)}}vD(e,l,n,s)}else l=mve(t,e,n,s,r);return pR(l)}dee=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=UA(e.pendingLanes);t!==0&&(LU(e,t|1),mu(e,ga()),!(ys&6)&&(mw=ga()+500,N0()))}break;case 13:cx(function(){var r=Km(n,1);if(r!==null){var s=Pc();Jd(r,n,1,s)}}),h6(n,1)}};DU=function(n){if(n.tag===13){var e=Km(n,134217728);if(e!==null){var t=Pc();Jd(e,n,134217728,t)}h6(n,134217728)}};fee=function(n){if(n.tag===13){var e=h0(n),t=Km(n,e);if(t!==null){var r=Pc();Jd(t,n,e,r)}h6(n,e)}};pee=function(){return Us};mee=function(n,e){var t=Us;try{return Us=n,e()}finally{Us=t}};p4=function(n,e,t){switch(e){case"input":if(a4(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=uD(r);if(!s)throw Error(Zn(90));$Q(r),a4(r,s)}}}break;case"textarea":qQ(n,t);break;case"select":e=t.value,e!=null&&Hb(n,!!t.multiple,e,!1)}};tee=o6;nee=cx;var gve={usingClientEntryPoint:!1,Events:[rC,Sb,uD,QQ,eee,o6]},jS={findFiberByHostInstance:Iy,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vve={bundleType:jS.bundleType,version:jS.version,rendererPackageName:jS.rendererPackageName,rendererConfig:jS.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ug.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=see(n),n===null?null:n.stateNode},findFiberByHostInstance:jS.findFiberByHostInstance||pve,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var JE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!JE.isDisabled&&JE.supportsFiber)try{oD=JE.inject(vve),dp=JE}catch{}}Wu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gve;Wu.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f6(e))throw Error(Zn(200));return fve(n,e,null,t)};Wu.createRoot=function(n,e){if(!f6(n))throw Error(Zn(299));var t=!1,r="",s=Nte;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=u6(n,1,!1,null,null,t,!1,r,s),n[Zm]=e.current,QT(n.nodeType===8?n.parentNode:n),new d6(e)};Wu.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Zn(188)):(n=Object.keys(n).join(","),Error(Zn(268,n)));return n=see(e),n=n===null?null:n.stateNode,n};Wu.flushSync=function(n){return cx(n)};Wu.hydrate=function(n,e,t){if(!yD(e))throw Error(Zn(200));return xD(null,n,e,!0,t)};Wu.hydrateRoot=function(n,e,t){if(!f6(n))throw Error(Zn(405));var r=t!=null&&t.hydratedSources||null,s=!1,o="",l=Nte;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),e=Fte(e,null,n,1,t??null,s,!1,o,l),n[Zm]=e.current,QT(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new _D(e)};Wu.render=function(n,e,t){if(!yD(e))throw Error(Zn(200));return xD(null,n,e,!1,t)};Wu.unmountComponentAtNode=function(n){if(!yD(n))throw Error(Zn(40));return n._reactRootContainer?(cx(function(){xD(null,null,n,!1,function(){n._reactRootContainer=null,n[Zm]=null})}),!0):!1};Wu.unstable_batchedUpdates=o6;Wu.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!yD(t))throw Error(Zn(200));if(n==null||n._reactInternals===void 0)throw Error(Zn(38));return xD(n,e,t,!1,r)};Wu.version="18.2.0-next-9e3b772b8-20220608";function zte(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zte)}catch(n){console.error(n)}}zte(),FQ.exports=Wu;var Dh=FQ.exports,Ute,iW=Dh;Ute=e4.createRoot=iW.createRoot,e4.hydrateRoot=iW.hydrateRoot;const _ve=(n,e,t,r)=>{var o,l,c,a;const s=[t,{code:e,...r||{}}];if((l=(o=n==null?void 0:n.services)==null?void 0:o.logger)!=null&&l.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);$y(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(a=(c=n==null?void 0:n.services)==null?void 0:c.logger)!=null&&a.warn?n.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},sW={},X4=(n,e,t,r)=>{$y(t)&&sW[t]||($y(t)&&(sW[t]=new Date),_ve(n,e,t,r))},Gte=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},q4=(n,e,t)=>{n.loadNamespaces(e,Gte(n,t))},oW=(n,e,t,r)=>{if($y(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return q4(n,t,r);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,Gte(n,r))},yve=(n,e,t={})=>!e.languages||!e.languages.length?(X4(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,s)=>{var o;if(((o=t.bindI18n)==null?void 0:o.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,n))return!1}}),$y=n=>typeof n=="string",xve=n=>typeof n=="object"&&n!==null,bve=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,wve={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Sve=n=>wve[n],Ave=n=>n.replace(bve,Sve);let Tve={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Ave};const Mve=()=>Tve;let Cve;const Eve=()=>Cve,Vte=_e.createContext();class Ive{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Pve=(n,e)=>{const t=_e.useRef();return _e.useEffect(()=>{t.current=n},[n,e]),t.current},Hte=(n,e,t,r)=>n.getFixedT(e,t,r),Rve=(n,e,t,r)=>_e.useCallback(Hte(n,e,t,r),[n,e,t,r]),kw=(n,e={})=>{var H,q,Z,J;const{i18n:t}=e,{i18n:r,defaultNS:s}=_e.useContext(Vte)||{},o=t||r||Eve();if(o&&!o.reportNamespaces&&(o.reportNamespaces=new Ive),!o){X4(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const re=(ae,he)=>$y(he)?he:xve(he)&&$y(he.defaultValue)?he.defaultValue:Array.isArray(ae)?ae[ae.length-1]:ae,se=[re,{},!1];return se.t=re,se.i18n={},se.ready=!1,se}(H=o.options.react)!=null&&H.wait&&X4(o,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const l={...Mve(),...o.options.react,...e},{useSuspense:c,keyPrefix:a}=l;let d=s||((q=o.options)==null?void 0:q.defaultNS);d=$y(d)?[d]:d||["translation"],(J=(Z=o.reportNamespaces).addUsedNamespaces)==null||J.call(Z,d);const f=(o.isInitialized||o.initializedStoreOnce)&&d.every(re=>yve(re,o,l)),m=Rve(o,e.lng||null,l.nsMode==="fallback"?d:d[0],a),_=()=>m,x=()=>Hte(o,e.lng||null,l.nsMode==="fallback"?d:d[0],a),[A,I]=_e.useState(_);let E=d.join();e.lng&&(E=`${e.lng}${E}`);const C=Pve(E),L=_e.useRef(!0);_e.useEffect(()=>{const{bindI18n:re,bindI18nStore:se}=l;L.current=!0,!f&&!c&&(e.lng?oW(o,e.lng,d,()=>{L.current&&I(x)}):q4(o,d,()=>{L.current&&I(x)})),f&&C&&C!==E&&L.current&&I(x);const ae=()=>{L.current&&I(x)};return re&&(o==null||o.on(re,ae)),se&&(o==null||o.store.on(se,ae)),()=>{L.current=!1,o&&(re==null||re.split(" ").forEach(he=>o.off(he,ae))),se&&o&&se.split(" ").forEach(he=>o.store.off(he,ae))}},[o,E]),_e.useEffect(()=>{L.current&&f&&I(_)},[o,a,f]);const O=[A,o,f];if(O.t=A,O.i18n=o,O.ready=f,f||!f&&!c)return O;throw new Promise(re=>{e.lng?oW(o,e.lng,d,()=>re()):q4(o,d,()=>re())})};function Lve({i18n:n,defaultNS:e,children:t}){const r=_e.useMemo(()=>({i18n:n,defaultNS:e}),[n,e]);return _e.createElement(Vte.Provider,{value:r},t)}/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lM(){return lM=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lM.apply(this,arguments)}var Kv;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Kv||(Kv={}));const aW="popstate";function Dve(n){n===void 0&&(n={});function e(r,s){let{pathname:o,search:l,hash:c}=r.location;return Y4("",{pathname:o,search:l,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:mR(s)}return kve(e,t,null,n)}function oa(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function p6(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bve(){return Math.random().toString(36).substr(2,8)}function lW(n,e){return{usr:n.state,key:n.key,idx:e}}function Y4(n,e,t,r){return t===void 0&&(t=null),lM({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Ow(e):e,{state:t,key:e&&e.key||r||Bve()})}function mR(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ow(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function kve(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,l=s.history,c=Kv.Pop,a=null,d=f();d==null&&(d=0,l.replaceState(lM({},l.state,{idx:d}),""));function f(){return(l.state||{idx:null}).idx}function m(){c=Kv.Pop;let E=f(),C=E==null?null:E-d;d=E,a&&a({action:c,location:I.location,delta:C})}function _(E,C){c=Kv.Push;let L=Y4(I.location,E,C);d=f()+1;let O=lW(L,d),H=I.createHref(L);try{l.pushState(O,"",H)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;s.location.assign(H)}o&&a&&a({action:c,location:I.location,delta:1})}function x(E,C){c=Kv.Replace;let L=Y4(I.location,E,C);d=f();let O=lW(L,d),H=I.createHref(L);l.replaceState(O,"",H),o&&a&&a({action:c,location:I.location,delta:0})}function A(E){let C=s.location.origin!=="null"?s.location.origin:s.location.href,L=typeof E=="string"?E:mR(E);return oa(C,"No window.location.(origin|href) available to create URL for href: "+L),new URL(L,C)}let I={get action(){return c},get location(){return n(s,l)},listen(E){if(a)throw new Error("A history only accepts one active listener");return s.addEventListener(aW,m),a=E,()=>{s.removeEventListener(aW,m),a=null}},createHref(E){return e(s,E)},createURL:A,encodeLocation(E){let C=A(E);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:_,replace:x,go(E){return l.go(E)}};return I}var cW;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(cW||(cW={}));function Ove(n,e,t){t===void 0&&(t="/");let r=typeof e=="string"?Ow(e):e,s=cM(r.pathname||"/",t);if(s==null)return null;let o=jte(n);Fve(o);let l=null;for(let c=0;l==null&&c<o.length;++c)l=$ve(o[c],qve(s));return l}function jte(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(o,l,c)=>{let a={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};a.relativePath.startsWith("/")&&(oa(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let d=f0([r,a.relativePath]),f=t.concat(a);o.children&&o.children.length>0&&(oa(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),jte(o.children,e,f,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:jve(d,o.index),routesMeta:f})};return n.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let a of Wte(o.path))s(o,l,a)}),e}function Wte(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let l=Wte(r.join("/")),c=[];return c.push(...l.map(a=>a===""?o:[o,a].join("/"))),s&&c.push(...l),c.map(a=>n.startsWith("/")&&a===""?"/":a)}function Fve(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Wve(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Nve=/^:\w+$/,zve=3,Uve=2,Gve=1,Vve=10,Hve=-2,uW=n=>n==="*";function jve(n,e){let t=n.split("/"),r=t.length;return t.some(uW)&&(r+=Hve),e&&(r+=Uve),t.filter(s=>!uW(s)).reduce((s,o)=>s+(Nve.test(o)?zve:o===""?Gve:Vve),r)}function Wve(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function $ve(n,e){let{routesMeta:t}=n,r={},s="/",o=[];for(let l=0;l<t.length;++l){let c=t[l],a=l===t.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=Z4({path:c.relativePath,caseSensitive:c.caseSensitive,end:a},d);if(!f)return null;Object.assign(r,f.params);let m=c.route;o.push({params:r,pathname:f0([s,f.pathname]),pathnameBase:Qve(f0([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=f0([s,f.pathnameBase]))}return o}function Z4(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Xve(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,f,m)=>{let{paramName:_,isOptional:x}=f;if(_==="*"){let I=c[m]||"";l=o.slice(0,o.length-I.length).replace(/(.)\/+$/,"$1")}const A=c[m];return x&&!A?d[_]=void 0:d[_]=Yve(A||"",_),d},{}),pathname:o,pathnameBase:l,pattern:n}}function Xve(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),p6(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(l,c,a)=>(r.push({paramName:c,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function qve(n){try{return decodeURI(n)}catch(e){return p6(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Yve(n,e){try{return decodeURIComponent(n)}catch(t){return p6(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function cM(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Zve(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Ow(n):n;return{pathname:t?t.startsWith("/")?t:Kve(t,e):e,search:e0e(r),hash:t0e(s)}}function Kve(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function HO(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jve(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $te(n,e){let t=Jve(n);return e?t.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function Xte(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=Ow(n):(s=lM({},n),oa(!s.pathname||!s.pathname.includes("?"),HO("?","pathname","search",s)),oa(!s.pathname||!s.pathname.includes("#"),HO("#","pathname","hash",s)),oa(!s.search||!s.search.includes("#"),HO("#","search","hash",s)));let o=n===""||s.pathname==="",l=o?"/":s.pathname,c;if(l==null)c=t;else{let m=e.length-1;if(!r&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),m-=1;s.pathname=_.join("/")}c=m>=0?e[m]:"/"}let a=Zve(s,c),d=l&&l!=="/"&&l.endsWith("/"),f=(o||l===".")&&t.endsWith("/");return!a.pathname.endsWith("/")&&(d||f)&&(a.pathname+="/"),a}const f0=n=>n.join("/").replace(/\/\/+/g,"/"),Qve=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),e0e=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,t0e=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function n0e(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const qte=["post","put","patch","delete"];new Set(qte);const r0e=["get",...qte];new Set(r0e);/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uM(){return uM=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},uM.apply(this,arguments)}const bD=_e.createContext(null),Yte=_e.createContext(null),z0=_e.createContext(null),wD=_e.createContext(null),Rx=_e.createContext({outlet:null,matches:[],isDataRoute:!1}),Zte=_e.createContext(null);function i0e(n,e){let{relative:t}=e===void 0?{}:e;sC()||oa(!1);let{basename:r,navigator:s}=_e.useContext(z0),{hash:o,pathname:l,search:c}=SD(n,{relative:t}),a=l;return r!=="/"&&(a=l==="/"?r:f0([r,l])),s.createHref({pathname:a,search:c,hash:o})}function sC(){return _e.useContext(wD)!=null}function oC(){return sC()||oa(!1),_e.useContext(wD).location}function Kte(n){_e.useContext(z0).static||_e.useLayoutEffect(n)}function s0e(){let{isDataRoute:n}=_e.useContext(Rx);return n?_0e():o0e()}function o0e(){sC()||oa(!1);let n=_e.useContext(bD),{basename:e,future:t,navigator:r}=_e.useContext(z0),{matches:s}=_e.useContext(Rx),{pathname:o}=oC(),l=JSON.stringify($te(s,t.v7_relativeSplatPath)),c=_e.useRef(!1);return Kte(()=>{c.current=!0}),_e.useCallback(function(d,f){if(f===void 0&&(f={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let m=Xte(d,JSON.parse(l),o,f.relative==="path");n==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:f0([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,l,o,n])}function SD(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=_e.useContext(z0),{matches:s}=_e.useContext(Rx),{pathname:o}=oC(),l=JSON.stringify($te(s,r.v7_relativeSplatPath));return _e.useMemo(()=>Xte(n,JSON.parse(l),o,t==="path"),[n,l,o,t])}function a0e(n,e){return l0e(n,e)}function l0e(n,e,t,r){sC()||oa(!1);let{navigator:s}=_e.useContext(z0),{matches:o}=_e.useContext(Rx),l=o[o.length-1],c=l?l.params:{};l&&l.pathname;let a=l?l.pathnameBase:"/";l&&l.route;let d=oC(),f;if(e){var m;let E=typeof e=="string"?Ow(e):e;a==="/"||(m=E.pathname)!=null&&m.startsWith(a)||oa(!1),f=E}else f=d;let _=f.pathname||"/",x=a==="/"?_:_.slice(a.length)||"/",A=Ove(n,{pathname:x}),I=f0e(A&&A.map(E=>Object.assign({},E,{params:Object.assign({},c,E.params),pathname:f0([a,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?a:f0([a,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),o,t,r);return e&&I?_e.createElement(wD.Provider,{value:{location:uM({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Kv.Pop}},I):I}function c0e(){let n=v0e(),e=n0e(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _e.createElement(_e.Fragment,null,_e.createElement("h2",null,"Unexpected Application Error!"),_e.createElement("h3",{style:{fontStyle:"italic"}},e),t?_e.createElement("pre",{style:s},t):null,null)}const u0e=_e.createElement(c0e,null);class h0e extends _e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?_e.createElement(Rx.Provider,{value:this.props.routeContext},_e.createElement(Zte.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function d0e(n){let{routeContext:e,match:t,children:r}=n,s=_e.useContext(bD);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),_e.createElement(Rx.Provider,{value:e},r)}function f0e(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var o;if((o=t)!=null&&o.errors)n=t.matches;else return null}let l=n,c=(s=t)==null?void 0:s.errors;if(c!=null){let f=l.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id]));f>=0||oa(!1),l=l.slice(0,Math.min(l.length,f+1))}let a=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let f=0;f<l.length;f++){let m=l[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:_,errors:x}=t,A=m.route.loader&&_[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||A){a=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((f,m,_)=>{let x,A=!1,I=null,E=null;t&&(x=c&&m.route.id?c[m.route.id]:void 0,I=m.route.errorElement||u0e,a&&(d<0&&_===0?(A=!0,E=null):d===_&&(A=!0,E=m.route.hydrateFallbackElement||null)));let C=e.concat(l.slice(0,_+1)),L=()=>{let O;return x?O=I:A?O=E:m.route.Component?O=_e.createElement(m.route.Component,null):m.route.element?O=m.route.element:O=f,_e.createElement(d0e,{match:m,routeContext:{outlet:f,matches:C,isDataRoute:t!=null},children:O})};return t&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?_e.createElement(h0e,{location:t.location,revalidation:t.revalidation,component:I,error:x,children:L(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):L()},null)}var Jte=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Jte||{}),gR=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(gR||{});function p0e(n){let e=_e.useContext(bD);return e||oa(!1),e}function m0e(n){let e=_e.useContext(Yte);return e||oa(!1),e}function g0e(n){let e=_e.useContext(Rx);return e||oa(!1),e}function Qte(n){let e=g0e(),t=e.matches[e.matches.length-1];return t.route.id||oa(!1),t.route.id}function v0e(){var n;let e=_e.useContext(Zte),t=m0e(gR.UseRouteError),r=Qte(gR.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function _0e(){let{router:n}=p0e(Jte.UseNavigateStable),e=Qte(gR.UseNavigateStable),t=_e.useRef(!1);return Kte(()=>{t.current=!0}),_e.useCallback(function(s,o){o===void 0&&(o={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,uM({fromRouteId:e},o)))},[n,e])}function Od(n){oa(!1)}function y0e(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Kv.Pop,navigator:o,static:l=!1,future:c}=n;sC()&&oa(!1);let a=e.replace(/^\/*/,"/"),d=_e.useMemo(()=>({basename:a,navigator:o,static:l,future:uM({v7_relativeSplatPath:!1},c)}),[a,c,o,l]);typeof r=="string"&&(r=Ow(r));let{pathname:f="/",search:m="",hash:_="",state:x=null,key:A="default"}=r,I=_e.useMemo(()=>{let E=cM(f,a);return E==null?null:{location:{pathname:E,search:m,hash:_,state:x,key:A},navigationType:s}},[a,f,m,_,x,A,s]);return I==null?null:_e.createElement(z0.Provider,{value:d},_e.createElement(wD.Provider,{children:t,value:I}))}function x0e(n){let{children:e,location:t}=n;return a0e(K4(e),t)}new Promise(()=>{});function K4(n,e){e===void 0&&(e=[]);let t=[];return _e.Children.forEach(n,(r,s)=>{if(!_e.isValidElement(r))return;let o=[...e,s];if(r.type===_e.Fragment){t.push.apply(t,K4(r.props.children,o));return}r.type!==Od&&oa(!1),!r.props.index||!r.props.children||oa(!1);let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=K4(r.props.children,o)),t.push(l)}),t}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vR(){return vR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},vR.apply(this,arguments)}function ene(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function b0e(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function w0e(n,e){return n.button===0&&(!e||e==="_self")&&!b0e(n)}const S0e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],A0e=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],T0e=_e.createContext({isTransitioning:!1}),M0e="startTransition",hW=UP[M0e];function C0e(n){let{basename:e,children:t,future:r,window:s}=n,o=_e.useRef();o.current==null&&(o.current=Dve({window:s,v5Compat:!0}));let l=o.current,[c,a]=_e.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},f=_e.useCallback(m=>{d&&hW?hW(()=>a(m)):a(m)},[a,d]);return _e.useLayoutEffect(()=>l.listen(f),[l,f]),_e.createElement(y0e,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:l,future:r})}const E0e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",I0e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dm=_e.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:o,replace:l,state:c,target:a,to:d,preventScrollReset:f,unstable_viewTransition:m}=e,_=ene(e,S0e),{basename:x}=_e.useContext(z0),A,I=!1;if(typeof d=="string"&&I0e.test(d)&&(A=d,E0e))try{let O=new URL(window.location.href),H=d.startsWith("//")?new URL(O.protocol+d):new URL(d),q=cM(H.pathname,x);H.origin===O.origin&&q!=null?d=q+H.search+H.hash:I=!0}catch{}let E=i0e(d,{relative:s}),C=R0e(d,{replace:l,state:c,target:a,preventScrollReset:f,relative:s,unstable_viewTransition:m});function L(O){r&&r(O),O.defaultPrevented||C(O)}return _e.createElement("a",vR({},_,{href:A||E,onClick:I||o?r:L,ref:t,target:a}))}),QE=_e.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:o="",end:l=!1,style:c,to:a,unstable_viewTransition:d,children:f}=e,m=ene(e,A0e),_=SD(a,{relative:m.relative}),x=oC(),A=_e.useContext(Yte),{navigator:I}=_e.useContext(z0),E=A!=null&&L0e(_)&&d===!0,C=I.encodeLocation?I.encodeLocation(_).pathname:_.pathname,L=x.pathname,O=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;s||(L=L.toLowerCase(),O=O?O.toLowerCase():null,C=C.toLowerCase());const H=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let q=L===C||!l&&L.startsWith(C)&&L.charAt(H)==="/",Z=O!=null&&(O===C||!l&&O.startsWith(C)&&O.charAt(C.length)==="/"),J={isActive:q,isPending:Z,isTransitioning:E},re=q?r:void 0,se;typeof o=="function"?se=o(J):se=[o,q?"active":null,Z?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ae=typeof c=="function"?c(J):c;return _e.createElement(Dm,vR({},m,{"aria-current":re,className:se,ref:t,style:ae,to:a,unstable_viewTransition:d}),typeof f=="function"?f(J):f)});var J4;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(J4||(J4={}));var dW;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(dW||(dW={}));function P0e(n){let e=_e.useContext(bD);return e||oa(!1),e}function R0e(n,e){let{target:t,replace:r,state:s,preventScrollReset:o,relative:l,unstable_viewTransition:c}=e===void 0?{}:e,a=s0e(),d=oC(),f=SD(n,{relative:l});return _e.useCallback(m=>{if(w0e(m,t)){m.preventDefault();let _=r!==void 0?r:mR(d)===mR(f);a(n,{replace:_,state:s,preventScrollReset:o,relative:l,unstable_viewTransition:c})}},[d,a,f,r,s,t,n,o,l,c])}function L0e(n,e){e===void 0&&(e={});let t=_e.useContext(T0e);t==null&&oa(!1);let{basename:r}=P0e(J4.useViewTransitionState),s=SD(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=cM(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=cM(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Z4(s.pathname,l)!=null||Z4(s.pathname,o)!=null}function hM(){return hM=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hM.apply(null,arguments)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const aC="166",_y={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},yy={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tne=0,Q4=1,nne=2,D0e=3,rne=0,AD=1,fT=2,Gd=3,Uh=0,Rc=1,Mc=2,pp=0,Xy=1,gw=2,ez=3,tz=4,ine=5,Xv=100,sne=101,one=102,ane=103,lne=104,cne=200,une=201,hne=202,dne=203,_R=204,yR=205,fne=206,pne=207,mne=208,gne=209,vne=210,_ne=211,yne=212,xne=213,bne=214,wne=0,Sne=1,Ane=2,dM=3,Tne=4,Mne=5,Cne=6,Ene=7,lC=0,Ine=1,Pne=2,mp=0,Rne=1,Lne=2,TD=3,MD=4,Dne=5,Bne=6,kne=7,nz="attached",One="detached",CD=300,Qm=301,b0=302,fM=303,pM=304,Fw=306,Gh=1e3,uu=1001,ux=1002,Ma=1003,cC=1004,B0e=1004,Jv=1005,k0e=1005,Ro=1006,qy=1007,O0e=1007,hu=1008,F0e=1008,tf=1009,m6=1010,g6=1011,vw=1012,ED=1013,eg=1014,Ec=1015,Bh=1016,ID=1017,PD=1018,hx=1020,v6=35902,_6=1021,y6=1022,Zl=1023,x6=1024,b6=1025,Yy=1026,dx=1027,uC=1028,hC=1029,w6=1030,RD=1031,N0e=1032,LD=1033,pT=33776,mT=33777,gT=33778,vT=33779,xR=35840,bR=35841,wR=35842,SR=35843,AR=36196,TR=37492,MR=37496,CR=37808,ER=37809,IR=37810,PR=37811,RR=37812,LR=37813,DR=37814,BR=37815,kR=37816,OR=37817,FR=37818,NR=37819,zR=37820,UR=37821,_T=36492,GR=36494,VR=36495,S6=36283,HR=36284,jR=36285,WR=36286,Fne=2200,Nne=2201,zne=2202,fx=2300,w0=2301,_P=2302,Ly=2400,Dy=2401,mM=2402,DD=2500,A6=2501,T6=0,dC=1,px=2,Une=3200,Gne=3201,U0=0,Vne=1,Bm="",Eo="srgb",$a="srgb-linear",BD="display-p3",fC="display-p3-linear",gM="linear",io="srgb",vM="rec709",_M="p3",z0e=0,xy=7680,U0e=7681,G0e=7682,V0e=7683,H0e=34055,j0e=34056,W0e=5386,$0e=512,X0e=513,q0e=514,Y0e=515,Z0e=516,K0e=517,J0e=518,rz=519,Hne=512,jne=513,Wne=514,M6=515,$ne=516,Xne=517,qne=518,Yne=519,yM=35044,Q0e=35048,e_e=35040,t_e=35045,n_e=35049,r_e=35041,i_e=35046,s_e=35050,o_e=35042,a_e="100",iz="300 es",ap=2e3,xM=2001;class Tp{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const o=s.indexOf(t);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const s=r.slice(0);for(let o=0,l=s.length;o<l;o++)s[o].call(this,e);e.target=null}}}const zl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let fW=1234567;const Zy=Math.PI/180,_w=180/Math.PI;function Uu(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(zl[n&255]+zl[n>>8&255]+zl[n>>16&255]+zl[n>>24&255]+"-"+zl[e&255]+zl[e>>8&255]+"-"+zl[e>>16&15|64]+zl[e>>24&255]+"-"+zl[t&63|128]+zl[t>>8&255]+"-"+zl[t>>16&255]+zl[t>>24&255]+zl[r&255]+zl[r>>8&255]+zl[r>>16&255]+zl[r>>24&255]).toLowerCase()}function ia(n,e,t){return Math.max(e,Math.min(t,n))}function C6(n,e){return(n%e+e)%e}function l_e(n,e,t,r,s){return r+(n-e)*(s-r)/(t-e)}function c_e(n,e,t){return n!==e?(t-n)/(e-n):0}function yT(n,e,t){return(1-t)*n+t*e}function u_e(n,e,t,r){return yT(n,e,1-Math.exp(-t*r))}function h_e(n,e=1){return e-Math.abs(C6(n,e*2)-e)}function d_e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function f_e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function p_e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function m_e(n,e){return n+Math.random()*(e-n)}function g_e(n){return n*(.5-Math.random())}function v_e(n){n!==void 0&&(fW=n);let e=fW+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function __e(n){return n*Zy}function y_e(n){return n*_w}function x_e(n){return(n&n-1)===0&&n!==0}function b_e(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function w_e(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function S_e(n,e,t,r,s){const o=Math.cos,l=Math.sin,c=o(t/2),a=l(t/2),d=o((e+r)/2),f=l((e+r)/2),m=o((e-r)/2),_=l((e-r)/2),x=o((r-e)/2),A=l((r-e)/2);switch(s){case"XYX":n.set(c*f,a*m,a*_,c*d);break;case"YZY":n.set(a*_,c*f,a*m,c*d);break;case"ZXZ":n.set(a*m,a*_,c*f,c*d);break;case"XZX":n.set(c*f,a*A,a*x,c*d);break;case"YXY":n.set(a*x,c*f,a*A,c*d);break;case"ZYZ":n.set(a*A,a*x,c*f,c*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Cc(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ci(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const so={DEG2RAD:Zy,RAD2DEG:_w,generateUUID:Uu,clamp:ia,euclideanModulo:C6,mapLinear:l_e,inverseLerp:c_e,lerp:yT,damp:u_e,pingpong:h_e,smoothstep:d_e,smootherstep:f_e,randInt:p_e,randFloat:m_e,randFloatSpread:g_e,seededRandom:v_e,degToRad:__e,radToDeg:y_e,isPowerOfTwo:x_e,ceilPowerOfTwo:b_e,floorPowerOfTwo:w_e,setQuaternionFromProperEuler:S_e,normalize:Ci,denormalize:Cc};class sn{constructor(e=0,t=0){sn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6],this.y=s[1]*t+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ia(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),s=Math.sin(t),o=this.x-e.x,l=this.y-e.y;return this.x=o*r-l*s+e.x,this.y=o*s+l*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Mi{constructor(e,t,r,s,o,l,c,a,d){Mi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,s,o,l,c,a,d)}set(e,t,r,s,o,l,c,a,d){const f=this.elements;return f[0]=e,f[1]=s,f[2]=c,f[3]=t,f[4]=o,f[5]=a,f[6]=r,f[7]=l,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,o=this.elements,l=r[0],c=r[3],a=r[6],d=r[1],f=r[4],m=r[7],_=r[2],x=r[5],A=r[8],I=s[0],E=s[3],C=s[6],L=s[1],O=s[4],H=s[7],q=s[2],Z=s[5],J=s[8];return o[0]=l*I+c*L+a*q,o[3]=l*E+c*O+a*Z,o[6]=l*C+c*H+a*J,o[1]=d*I+f*L+m*q,o[4]=d*E+f*O+m*Z,o[7]=d*C+f*H+m*J,o[2]=_*I+x*L+A*q,o[5]=_*E+x*O+A*Z,o[8]=_*C+x*H+A*J,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],s=e[2],o=e[3],l=e[4],c=e[5],a=e[6],d=e[7],f=e[8];return t*l*f-t*c*d-r*o*f+r*c*a+s*o*d-s*l*a}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],o=e[3],l=e[4],c=e[5],a=e[6],d=e[7],f=e[8],m=f*l-c*d,_=c*a-f*o,x=d*o-l*a,A=t*m+r*_+s*x;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);const I=1/A;return e[0]=m*I,e[1]=(s*d-f*r)*I,e[2]=(c*r-s*l)*I,e[3]=_*I,e[4]=(f*t-s*a)*I,e[5]=(s*o-c*t)*I,e[6]=x*I,e[7]=(r*a-d*t)*I,e[8]=(l*t-r*o)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,s,o,l,c){const a=Math.cos(o),d=Math.sin(o);return this.set(r*a,r*d,-r*(a*l+d*c)+l+e,-s*d,s*a,-s*(-d*l+a*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(jO.makeScale(e,t)),this}rotate(e){return this.premultiply(jO.makeRotation(-e)),this}translate(e,t){return this.premultiply(jO.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<9;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const jO=new Mi;function Zne(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const A_e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Pb(n,e){return new A_e[n](e)}function bM(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Kne(){const n=bM("canvas");return n.style.display="block",n}const pW={};function E6(n){n in pW||(pW[n]=!0,console.warn(n))}function T_e(n,e,t){return new Promise(function(r,s){function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:s();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:r()}}setTimeout(o,t)})}const mW=new Mi().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gW=new Mi().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),e2={[$a]:{transfer:gM,primaries:vM,toReference:n=>n,fromReference:n=>n},[Eo]:{transfer:io,primaries:vM,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[fC]:{transfer:gM,primaries:_M,toReference:n=>n.applyMatrix3(gW),fromReference:n=>n.applyMatrix3(mW)},[BD]:{transfer:io,primaries:_M,toReference:n=>n.convertSRGBToLinear().applyMatrix3(gW),fromReference:n=>n.applyMatrix3(mW).convertLinearToSRGB()}},M_e=new Set([$a,fC]),_s={enabled:!0,_workingColorSpace:$a,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!M_e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=e2[e].toReference,s=e2[t].fromReference;return s(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return e2[n].primaries},getTransfer:function(n){return n===Bm?gM:e2[n].transfer}};function Yb(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function WO(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let b1;class Jne{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{b1===void 0&&(b1=bM("canvas")),b1.width=e.width,b1.height=e.height;const r=b1.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=b1}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=bM("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),o=s.data;for(let l=0;l<o.length;l++)o[l]=Yb(o[l]/255)*255;return r.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Yb(t[r]/255)*255):t[r]=Yb(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let C_e=0;class By{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:C_e++}),this.uuid=Uu(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let l=0,c=s.length;l<c;l++)s[l].isDataTexture?o.push($O(s[l].image)):o.push($O(s[l]))}else o=$O(s);r.url=o}return t||(e.images[this.uuid]=r),r}}function $O(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Jne.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let E_e=0;class Ys extends Tp{constructor(e=Ys.DEFAULT_IMAGE,t=Ys.DEFAULT_MAPPING,r=uu,s=uu,o=Ro,l=hu,c=Zl,a=tf,d=Ys.DEFAULT_ANISOTROPY,f=Bm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:E_e++}),this.uuid=Uu(),this.name="",this.source=new By(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=a,this.offset=new sn(0,0),this.repeat=new sn(1,1),this.center=new sn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==CD)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Gh:e.x=e.x-Math.floor(e.x);break;case uu:e.x=e.x<0?0:1;break;case ux:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Gh:e.y=e.y-Math.floor(e.y);break;case uu:e.y=e.y<0?0:1;break;case ux:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ys.DEFAULT_IMAGE=null;Ys.DEFAULT_MAPPING=CD;Ys.DEFAULT_ANISOTROPY=1;class Ls{constructor(e=0,t=0,r=0,s=1){Ls.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,s){return this.x=e,this.y=t,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*s+l[12]*o,this.y=l[1]*t+l[5]*r+l[9]*s+l[13]*o,this.z=l[2]*t+l[6]*r+l[10]*s+l[14]*o,this.w=l[3]*t+l[7]*r+l[11]*s+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,s,o;const a=e.elements,d=a[0],f=a[4],m=a[8],_=a[1],x=a[5],A=a[9],I=a[2],E=a[6],C=a[10];if(Math.abs(f-_)<.01&&Math.abs(m-I)<.01&&Math.abs(A-E)<.01){if(Math.abs(f+_)<.1&&Math.abs(m+I)<.1&&Math.abs(A+E)<.1&&Math.abs(d+x+C-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const O=(d+1)/2,H=(x+1)/2,q=(C+1)/2,Z=(f+_)/4,J=(m+I)/4,re=(A+E)/4;return O>H&&O>q?O<.01?(r=0,s=.707106781,o=.707106781):(r=Math.sqrt(O),s=Z/r,o=J/r):H>q?H<.01?(r=.707106781,s=0,o=.707106781):(s=Math.sqrt(H),r=Z/s,o=re/s):q<.01?(r=.707106781,s=.707106781,o=0):(o=Math.sqrt(q),r=J/o,s=re/o),this.set(r,s,o,t),this}let L=Math.sqrt((E-A)*(E-A)+(m-I)*(m-I)+(_-f)*(_-f));return Math.abs(L)<.001&&(L=1),this.x=(E-A)/L,this.y=(m-I)/L,this.z=(_-f)/L,this.w=Math.acos((d+x+C-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Qne extends Tp{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ls(0,0,e,t),this.scissorTest=!1,this.viewport=new Ls(0,0,e,t);const s={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ro,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const o=new Ys(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);o.flipY=!1,o.generateMipmaps=r.generateMipmaps,o.internalFormat=r.internalFormat,this.textures=[];const l=r.count;for(let c=0;c<l;c++)this.textures[c]=o.clone(),this.textures[c].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,s=e.textures.length;r<s;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new By(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ml extends Qne{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class kD extends Ys{constructor(e=null,t=1,r=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=Ma,this.minFilter=Ma,this.wrapR=uu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class I_e extends Ml{constructor(e=1,t=1,r=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new kD(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class I6 extends Ys{constructor(e=null,t=1,r=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=Ma,this.minFilter=Ma,this.wrapR=uu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class P_e extends Ml{constructor(e=1,t=1,r=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new I6(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class Ea{constructor(e=0,t=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=s}static slerpFlat(e,t,r,s,o,l,c){let a=r[s+0],d=r[s+1],f=r[s+2],m=r[s+3];const _=o[l+0],x=o[l+1],A=o[l+2],I=o[l+3];if(c===0){e[t+0]=a,e[t+1]=d,e[t+2]=f,e[t+3]=m;return}if(c===1){e[t+0]=_,e[t+1]=x,e[t+2]=A,e[t+3]=I;return}if(m!==I||a!==_||d!==x||f!==A){let E=1-c;const C=a*_+d*x+f*A+m*I,L=C>=0?1:-1,O=1-C*C;if(O>Number.EPSILON){const q=Math.sqrt(O),Z=Math.atan2(q,C*L);E=Math.sin(E*Z)/q,c=Math.sin(c*Z)/q}const H=c*L;if(a=a*E+_*H,d=d*E+x*H,f=f*E+A*H,m=m*E+I*H,E===1-c){const q=1/Math.sqrt(a*a+d*d+f*f+m*m);a*=q,d*=q,f*=q,m*=q}}e[t]=a,e[t+1]=d,e[t+2]=f,e[t+3]=m}static multiplyQuaternionsFlat(e,t,r,s,o,l){const c=r[s],a=r[s+1],d=r[s+2],f=r[s+3],m=o[l],_=o[l+1],x=o[l+2],A=o[l+3];return e[t]=c*A+f*m+a*x-d*_,e[t+1]=a*A+f*_+d*m-c*x,e[t+2]=d*A+f*x+c*_-a*m,e[t+3]=f*A-c*m-a*_-d*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,s){return this._x=e,this._y=t,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,s=e._y,o=e._z,l=e._order,c=Math.cos,a=Math.sin,d=c(r/2),f=c(s/2),m=c(o/2),_=a(r/2),x=a(s/2),A=a(o/2);switch(l){case"XYZ":this._x=_*f*m+d*x*A,this._y=d*x*m-_*f*A,this._z=d*f*A+_*x*m,this._w=d*f*m-_*x*A;break;case"YXZ":this._x=_*f*m+d*x*A,this._y=d*x*m-_*f*A,this._z=d*f*A-_*x*m,this._w=d*f*m+_*x*A;break;case"ZXY":this._x=_*f*m-d*x*A,this._y=d*x*m+_*f*A,this._z=d*f*A+_*x*m,this._w=d*f*m-_*x*A;break;case"ZYX":this._x=_*f*m-d*x*A,this._y=d*x*m+_*f*A,this._z=d*f*A-_*x*m,this._w=d*f*m+_*x*A;break;case"YZX":this._x=_*f*m+d*x*A,this._y=d*x*m+_*f*A,this._z=d*f*A-_*x*m,this._w=d*f*m-_*x*A;break;case"XZY":this._x=_*f*m-d*x*A,this._y=d*x*m-_*f*A,this._z=d*f*A+_*x*m,this._w=d*f*m+_*x*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],s=t[4],o=t[8],l=t[1],c=t[5],a=t[9],d=t[2],f=t[6],m=t[10],_=r+c+m;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(f-a)*x,this._y=(o-d)*x,this._z=(l-s)*x}else if(r>c&&r>m){const x=2*Math.sqrt(1+r-c-m);this._w=(f-a)/x,this._x=.25*x,this._y=(s+l)/x,this._z=(o+d)/x}else if(c>m){const x=2*Math.sqrt(1+c-r-m);this._w=(o-d)/x,this._x=(s+l)/x,this._y=.25*x,this._z=(a+f)/x}else{const x=2*Math.sqrt(1+m-r-c);this._w=(l-s)/x,this._x=(o+d)/x,this._y=(a+f)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ia(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const s=Math.min(1,t/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,s=e._y,o=e._z,l=e._w,c=t._x,a=t._y,d=t._z,f=t._w;return this._x=r*f+l*c+s*d-o*a,this._y=s*f+l*a+o*c-r*d,this._z=o*f+l*d+r*a-s*c,this._w=l*f-r*c-s*a-o*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,s=this._y,o=this._z,l=this._w;let c=l*e._w+r*e._x+s*e._y+o*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=l,this._x=r,this._y=s,this._z=o,this;const a=1-c*c;if(a<=Number.EPSILON){const x=1-t;return this._w=x*l+t*this._w,this._x=x*r+t*this._x,this._y=x*s+t*this._y,this._z=x*o+t*this._z,this.normalize(),this}const d=Math.sqrt(a),f=Math.atan2(d,c),m=Math.sin((1-t)*f)/d,_=Math.sin(t*f)/d;return this._w=l*m+this._w*_,this._x=r*m+this._x*_,this._y=s*m+this._y*_,this._z=o*m+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),s=Math.sqrt(1-r),o=Math.sqrt(r);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ze{constructor(e=0,t=0,r=0){Ze.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(vW.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vW.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6]*s,this.y=o[1]*t+o[4]*r+o[7]*s,this.z=o[2]*t+o[5]*r+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,o=e.elements,l=1/(o[3]*t+o[7]*r+o[11]*s+o[15]);return this.x=(o[0]*t+o[4]*r+o[8]*s+o[12])*l,this.y=(o[1]*t+o[5]*r+o[9]*s+o[13])*l,this.z=(o[2]*t+o[6]*r+o[10]*s+o[14])*l,this}applyQuaternion(e){const t=this.x,r=this.y,s=this.z,o=e.x,l=e.y,c=e.z,a=e.w,d=2*(l*s-c*r),f=2*(c*t-o*s),m=2*(o*r-l*t);return this.x=t+a*d+l*m-c*f,this.y=r+a*f+c*d-o*m,this.z=s+a*m+o*f-l*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*s,this.y=o[1]*t+o[5]*r+o[9]*s,this.z=o[2]*t+o[6]*r+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,s=e.y,o=e.z,l=t.x,c=t.y,a=t.z;return this.x=s*a-o*c,this.y=o*l-r*a,this.z=r*c-s*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return XO.copy(this).projectOnVector(e),this.sub(XO)}reflect(e){return this.sub(XO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ia(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return t*t+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const s=Math.sin(t)*e;return this.x=s*Math.sin(r),this.y=Math.cos(t)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const XO=new Ze,vW=new Ea;class Cl{constructor(e=new Ze(1/0,1/0,1/0),t=new Ze(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Rd.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Rd.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Rd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const o=r.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let l=0,c=o.count;l<c;l++)e.isMesh===!0?e.getVertexPosition(l,Rd):Rd.fromBufferAttribute(o,l),Rd.applyMatrix4(e.matrixWorld),this.expandByPoint(Rd);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),t2.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),t2.copy(r.boundingBox)),t2.applyMatrix4(e.matrixWorld),this.union(t2)}const s=e.children;for(let o=0,l=s.length;o<l;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Rd),Rd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(WS),n2.subVectors(this.max,WS),w1.subVectors(e.a,WS),S1.subVectors(e.b,WS),A1.subVectors(e.c,WS),vv.subVectors(S1,w1),_v.subVectors(A1,S1),R_.subVectors(w1,A1);let t=[0,-vv.z,vv.y,0,-_v.z,_v.y,0,-R_.z,R_.y,vv.z,0,-vv.x,_v.z,0,-_v.x,R_.z,0,-R_.x,-vv.y,vv.x,0,-_v.y,_v.x,0,-R_.y,R_.x,0];return!qO(t,w1,S1,A1,n2)||(t=[1,0,0,0,1,0,0,0,1],!qO(t,w1,S1,A1,n2))?!1:(r2.crossVectors(vv,_v),t=[r2.x,r2.y,r2.z],qO(t,w1,S1,A1,n2))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Rd).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Rd).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(vm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),vm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),vm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),vm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),vm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),vm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),vm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),vm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(vm),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const vm=[new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze],Rd=new Ze,t2=new Cl,w1=new Ze,S1=new Ze,A1=new Ze,vv=new Ze,_v=new Ze,R_=new Ze,WS=new Ze,n2=new Ze,r2=new Ze,L_=new Ze;function qO(n,e,t,r,s){for(let o=0,l=n.length-3;o<=l;o+=3){L_.fromArray(n,o);const c=s.x*Math.abs(L_.x)+s.y*Math.abs(L_.y)+s.z*Math.abs(L_.z),a=e.dot(L_),d=t.dot(L_),f=r.dot(L_);if(Math.max(-Math.max(a,d,f),Math.min(a,d,f))>c)return!1}return!0}const R_e=new Cl,$S=new Ze,YO=new Ze;class al{constructor(e=new Ze,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):R_e.setFromPoints(e).getCenter(r);let s=0;for(let o=0,l=e.length;o<l;o++)s=Math.max(s,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$S.subVectors(e,this.center);const t=$S.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),s=(r-this.radius)*.5;this.center.addScaledVector($S,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(YO.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($S.copy(e.center).add(YO)),this.expandByPoint($S.copy(e.center).sub(YO))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _m=new Ze,ZO=new Ze,i2=new Ze,yv=new Ze,KO=new Ze,s2=new Ze,JO=new Ze;class Lx{constructor(e=new Ze,t=new Ze(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_m)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=_m.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(_m.copy(this.origin).addScaledVector(this.direction,t),_m.distanceToSquared(e))}distanceSqToSegment(e,t,r,s){ZO.copy(e).add(t).multiplyScalar(.5),i2.copy(t).sub(e).normalize(),yv.copy(this.origin).sub(ZO);const o=e.distanceTo(t)*.5,l=-this.direction.dot(i2),c=yv.dot(this.direction),a=-yv.dot(i2),d=yv.lengthSq(),f=Math.abs(1-l*l);let m,_,x,A;if(f>0)if(m=l*a-c,_=l*c-a,A=o*f,m>=0)if(_>=-A)if(_<=A){const I=1/f;m*=I,_*=I,x=m*(m+l*_+2*c)+_*(l*m+_+2*a)+d}else _=o,m=Math.max(0,-(l*_+c)),x=-m*m+_*(_+2*a)+d;else _=-o,m=Math.max(0,-(l*_+c)),x=-m*m+_*(_+2*a)+d;else _<=-A?(m=Math.max(0,-(-l*o+c)),_=m>0?-o:Math.min(Math.max(-o,-a),o),x=-m*m+_*(_+2*a)+d):_<=A?(m=0,_=Math.min(Math.max(-o,-a),o),x=_*(_+2*a)+d):(m=Math.max(0,-(l*o+c)),_=m>0?o:Math.min(Math.max(-o,-a),o),x=-m*m+_*(_+2*a)+d);else _=l>0?-o:o,m=Math.max(0,-(l*_+c)),x=-m*m+_*(_+2*a)+d;return r&&r.copy(this.origin).addScaledVector(this.direction,m),s&&s.copy(ZO).addScaledVector(i2,_),x}intersectSphere(e,t){_m.subVectors(e.center,this.origin);const r=_m.dot(this.direction),s=_m.dot(_m)-r*r,o=e.radius*e.radius;if(s>o)return null;const l=Math.sqrt(o-s),c=r-l,a=r+l;return a<0?null:c<0?this.at(a,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,s,o,l,c,a;const d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,_=this.origin;return d>=0?(r=(e.min.x-_.x)*d,s=(e.max.x-_.x)*d):(r=(e.max.x-_.x)*d,s=(e.min.x-_.x)*d),f>=0?(o=(e.min.y-_.y)*f,l=(e.max.y-_.y)*f):(o=(e.max.y-_.y)*f,l=(e.min.y-_.y)*f),r>l||o>s||((o>r||isNaN(r))&&(r=o),(l<s||isNaN(s))&&(s=l),m>=0?(c=(e.min.z-_.z)*m,a=(e.max.z-_.z)*m):(c=(e.max.z-_.z)*m,a=(e.min.z-_.z)*m),r>a||c>s)||((c>r||r!==r)&&(r=c),(a<s||s!==s)&&(s=a),s<0)?null:this.at(r>=0?r:s,t)}intersectsBox(e){return this.intersectBox(e,_m)!==null}intersectTriangle(e,t,r,s,o){KO.subVectors(t,e),s2.subVectors(r,e),JO.crossVectors(KO,s2);let l=this.direction.dot(JO),c;if(l>0){if(s)return null;c=1}else if(l<0)c=-1,l=-l;else return null;yv.subVectors(this.origin,e);const a=c*this.direction.dot(s2.crossVectors(yv,s2));if(a<0)return null;const d=c*this.direction.dot(KO.cross(yv));if(d<0||a+d>l)return null;const f=-c*yv.dot(JO);return f<0?null:this.at(f/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Hr{constructor(e,t,r,s,o,l,c,a,d,f,m,_,x,A,I,E){Hr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,s,o,l,c,a,d,f,m,_,x,A,I,E)}set(e,t,r,s,o,l,c,a,d,f,m,_,x,A,I,E){const C=this.elements;return C[0]=e,C[4]=t,C[8]=r,C[12]=s,C[1]=o,C[5]=l,C[9]=c,C[13]=a,C[2]=d,C[6]=f,C[10]=m,C[14]=_,C[3]=x,C[7]=A,C[11]=I,C[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Hr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,s=1/T1.setFromMatrixColumn(e,0).length(),o=1/T1.setFromMatrixColumn(e,1).length(),l=1/T1.setFromMatrixColumn(e,2).length();return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=0,t[4]=r[4]*o,t[5]=r[5]*o,t[6]=r[6]*o,t[7]=0,t[8]=r[8]*l,t[9]=r[9]*l,t[10]=r[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,s=e.y,o=e.z,l=Math.cos(r),c=Math.sin(r),a=Math.cos(s),d=Math.sin(s),f=Math.cos(o),m=Math.sin(o);if(e.order==="XYZ"){const _=l*f,x=l*m,A=c*f,I=c*m;t[0]=a*f,t[4]=-a*m,t[8]=d,t[1]=x+A*d,t[5]=_-I*d,t[9]=-c*a,t[2]=I-_*d,t[6]=A+x*d,t[10]=l*a}else if(e.order==="YXZ"){const _=a*f,x=a*m,A=d*f,I=d*m;t[0]=_+I*c,t[4]=A*c-x,t[8]=l*d,t[1]=l*m,t[5]=l*f,t[9]=-c,t[2]=x*c-A,t[6]=I+_*c,t[10]=l*a}else if(e.order==="ZXY"){const _=a*f,x=a*m,A=d*f,I=d*m;t[0]=_-I*c,t[4]=-l*m,t[8]=A+x*c,t[1]=x+A*c,t[5]=l*f,t[9]=I-_*c,t[2]=-l*d,t[6]=c,t[10]=l*a}else if(e.order==="ZYX"){const _=l*f,x=l*m,A=c*f,I=c*m;t[0]=a*f,t[4]=A*d-x,t[8]=_*d+I,t[1]=a*m,t[5]=I*d+_,t[9]=x*d-A,t[2]=-d,t[6]=c*a,t[10]=l*a}else if(e.order==="YZX"){const _=l*a,x=l*d,A=c*a,I=c*d;t[0]=a*f,t[4]=I-_*m,t[8]=A*m+x,t[1]=m,t[5]=l*f,t[9]=-c*f,t[2]=-d*f,t[6]=x*m+A,t[10]=_-I*m}else if(e.order==="XZY"){const _=l*a,x=l*d,A=c*a,I=c*d;t[0]=a*f,t[4]=-m,t[8]=d*f,t[1]=_*m+I,t[5]=l*f,t[9]=x*m-A,t[2]=A*m-x,t[6]=c*f,t[10]=I*m+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(L_e,e,D_e)}lookAt(e,t,r){const s=this.elements;return Lu.subVectors(e,t),Lu.lengthSq()===0&&(Lu.z=1),Lu.normalize(),xv.crossVectors(r,Lu),xv.lengthSq()===0&&(Math.abs(r.z)===1?Lu.x+=1e-4:Lu.z+=1e-4,Lu.normalize(),xv.crossVectors(r,Lu)),xv.normalize(),o2.crossVectors(Lu,xv),s[0]=xv.x,s[4]=o2.x,s[8]=Lu.x,s[1]=xv.y,s[5]=o2.y,s[9]=Lu.y,s[2]=xv.z,s[6]=o2.z,s[10]=Lu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,o=this.elements,l=r[0],c=r[4],a=r[8],d=r[12],f=r[1],m=r[5],_=r[9],x=r[13],A=r[2],I=r[6],E=r[10],C=r[14],L=r[3],O=r[7],H=r[11],q=r[15],Z=s[0],J=s[4],re=s[8],se=s[12],ae=s[1],he=s[5],Ae=s[9],Ee=s[13],Pe=s[2],ze=s[6],Re=s[10],rt=s[14],ye=s[3],We=s[7],Ue=s[11],gt=s[15];return o[0]=l*Z+c*ae+a*Pe+d*ye,o[4]=l*J+c*he+a*ze+d*We,o[8]=l*re+c*Ae+a*Re+d*Ue,o[12]=l*se+c*Ee+a*rt+d*gt,o[1]=f*Z+m*ae+_*Pe+x*ye,o[5]=f*J+m*he+_*ze+x*We,o[9]=f*re+m*Ae+_*Re+x*Ue,o[13]=f*se+m*Ee+_*rt+x*gt,o[2]=A*Z+I*ae+E*Pe+C*ye,o[6]=A*J+I*he+E*ze+C*We,o[10]=A*re+I*Ae+E*Re+C*Ue,o[14]=A*se+I*Ee+E*rt+C*gt,o[3]=L*Z+O*ae+H*Pe+q*ye,o[7]=L*J+O*he+H*ze+q*We,o[11]=L*re+O*Ae+H*Re+q*Ue,o[15]=L*se+O*Ee+H*rt+q*gt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],s=e[8],o=e[12],l=e[1],c=e[5],a=e[9],d=e[13],f=e[2],m=e[6],_=e[10],x=e[14],A=e[3],I=e[7],E=e[11],C=e[15];return A*(+o*a*m-s*d*m-o*c*_+r*d*_+s*c*x-r*a*x)+I*(+t*a*x-t*d*_+o*l*_-s*l*x+s*d*f-o*a*f)+E*(+t*d*m-t*c*x-o*l*m+r*l*x+o*c*f-r*d*f)+C*(-s*c*f-t*a*m+t*c*_+s*l*m-r*l*_+r*a*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],o=e[3],l=e[4],c=e[5],a=e[6],d=e[7],f=e[8],m=e[9],_=e[10],x=e[11],A=e[12],I=e[13],E=e[14],C=e[15],L=m*E*d-I*_*d+I*a*x-c*E*x-m*a*C+c*_*C,O=A*_*d-f*E*d-A*a*x+l*E*x+f*a*C-l*_*C,H=f*I*d-A*m*d+A*c*x-l*I*x-f*c*C+l*m*C,q=A*m*a-f*I*a-A*c*_+l*I*_+f*c*E-l*m*E,Z=t*L+r*O+s*H+o*q;if(Z===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const J=1/Z;return e[0]=L*J,e[1]=(I*_*o-m*E*o-I*s*x+r*E*x+m*s*C-r*_*C)*J,e[2]=(c*E*o-I*a*o+I*s*d-r*E*d-c*s*C+r*a*C)*J,e[3]=(m*a*o-c*_*o-m*s*d+r*_*d+c*s*x-r*a*x)*J,e[4]=O*J,e[5]=(f*E*o-A*_*o+A*s*x-t*E*x-f*s*C+t*_*C)*J,e[6]=(A*a*o-l*E*o-A*s*d+t*E*d+l*s*C-t*a*C)*J,e[7]=(l*_*o-f*a*o+f*s*d-t*_*d-l*s*x+t*a*x)*J,e[8]=H*J,e[9]=(A*m*o-f*I*o-A*r*x+t*I*x+f*r*C-t*m*C)*J,e[10]=(l*I*o-A*c*o+A*r*d-t*I*d-l*r*C+t*c*C)*J,e[11]=(f*c*o-l*m*o-f*r*d+t*m*d+l*r*x-t*c*x)*J,e[12]=q*J,e[13]=(f*I*s-A*m*s+A*r*_-t*I*_-f*r*E+t*m*E)*J,e[14]=(A*c*s-l*I*s-A*r*a+t*I*a+l*r*E-t*c*E)*J,e[15]=(l*m*s-f*c*s+f*r*a-t*m*a-l*r*_+t*c*_)*J,this}scale(e){const t=this.elements,r=e.x,s=e.y,o=e.z;return t[0]*=r,t[4]*=s,t[8]*=o,t[1]*=r,t[5]*=s,t[9]*=o,t[2]*=r,t[6]*=s,t[10]*=o,t[3]*=r,t[7]*=s,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,s))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),s=Math.sin(t),o=1-r,l=e.x,c=e.y,a=e.z,d=o*l,f=o*c;return this.set(d*l+r,d*c-s*a,d*a+s*c,0,d*c+s*a,f*c+r,f*a-s*l,0,d*a-s*c,f*a+s*l,o*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,s,o,l){return this.set(1,r,o,0,e,1,l,0,t,s,1,0,0,0,0,1),this}compose(e,t,r){const s=this.elements,o=t._x,l=t._y,c=t._z,a=t._w,d=o+o,f=l+l,m=c+c,_=o*d,x=o*f,A=o*m,I=l*f,E=l*m,C=c*m,L=a*d,O=a*f,H=a*m,q=r.x,Z=r.y,J=r.z;return s[0]=(1-(I+C))*q,s[1]=(x+H)*q,s[2]=(A-O)*q,s[3]=0,s[4]=(x-H)*Z,s[5]=(1-(_+C))*Z,s[6]=(E+L)*Z,s[7]=0,s[8]=(A+O)*J,s[9]=(E-L)*J,s[10]=(1-(_+I))*J,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,r){const s=this.elements;let o=T1.set(s[0],s[1],s[2]).length();const l=T1.set(s[4],s[5],s[6]).length(),c=T1.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Ld.copy(this);const d=1/o,f=1/l,m=1/c;return Ld.elements[0]*=d,Ld.elements[1]*=d,Ld.elements[2]*=d,Ld.elements[4]*=f,Ld.elements[5]*=f,Ld.elements[6]*=f,Ld.elements[8]*=m,Ld.elements[9]*=m,Ld.elements[10]*=m,t.setFromRotationMatrix(Ld),r.x=o,r.y=l,r.z=c,this}makePerspective(e,t,r,s,o,l,c=ap){const a=this.elements,d=2*o/(t-e),f=2*o/(r-s),m=(t+e)/(t-e),_=(r+s)/(r-s);let x,A;if(c===ap)x=-(l+o)/(l-o),A=-2*l*o/(l-o);else if(c===xM)x=-l/(l-o),A=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return a[0]=d,a[4]=0,a[8]=m,a[12]=0,a[1]=0,a[5]=f,a[9]=_,a[13]=0,a[2]=0,a[6]=0,a[10]=x,a[14]=A,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,s,o,l,c=ap){const a=this.elements,d=1/(t-e),f=1/(r-s),m=1/(l-o),_=(t+e)*d,x=(r+s)*f;let A,I;if(c===ap)A=(l+o)*m,I=-2*m;else if(c===xM)A=o*m,I=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return a[0]=2*d,a[4]=0,a[8]=0,a[12]=-_,a[1]=0,a[5]=2*f,a[9]=0,a[13]=-x,a[2]=0,a[6]=0,a[10]=I,a[14]=-A,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<16;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const T1=new Ze,Ld=new Hr,L_e=new Ze(0,0,0),D_e=new Ze(1,1,1),xv=new Ze,o2=new Ze,Lu=new Ze,_W=new Hr,yW=new Ea;class ju{constructor(e=0,t=0,r=0,s=ju.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,s=this._order){return this._x=e,this._y=t,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const s=e.elements,o=s[0],l=s[4],c=s[8],a=s[1],d=s[5],f=s[9],m=s[2],_=s[6],x=s[10];switch(t){case"XYZ":this._y=Math.asin(ia(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,x),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(_,d),this._z=0);break;case"YXZ":this._x=Math.asin(-ia(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(c,x),this._z=Math.atan2(a,d)):(this._y=Math.atan2(-m,o),this._z=0);break;case"ZXY":this._x=Math.asin(ia(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-m,x),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(a,o));break;case"ZYX":this._y=Math.asin(-ia(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(a,o)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(ia(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,o)):(this._x=0,this._y=Math.atan2(c,x));break;case"XZY":this._z=Math.asin(-ia(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(_,d),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-f,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return _W.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_W,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return yW.setFromEuler(this),this.setFromQuaternion(yW,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ju.DEFAULT_ORDER="XYZ";class Ky{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let B_e=0;const xW=new Ze,M1=new Ea,ym=new Hr,a2=new Ze,XS=new Ze,k_e=new Ze,O_e=new Ea,bW=new Ze(1,0,0),wW=new Ze(0,1,0),SW=new Ze(0,0,1),AW={type:"added"},F_e={type:"removed"},C1={type:"childadded",child:null},QO={type:"childremoved",child:null};class Bi extends Tp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:B_e++}),this.uuid=Uu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Bi.DEFAULT_UP.clone();const e=new Ze,t=new ju,r=new Ea,s=new Ze(1,1,1);function o(){r.setFromEuler(t,!1)}function l(){t.setFromQuaternion(r,void 0,!1)}t._onChange(o),r._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Hr},normalMatrix:{value:new Mi}}),this.matrix=new Hr,this.matrixWorld=new Hr,this.matrixAutoUpdate=Bi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Bi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ky,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return M1.setFromAxisAngle(e,t),this.quaternion.multiply(M1),this}rotateOnWorldAxis(e,t){return M1.setFromAxisAngle(e,t),this.quaternion.premultiply(M1),this}rotateX(e){return this.rotateOnAxis(bW,e)}rotateY(e){return this.rotateOnAxis(wW,e)}rotateZ(e){return this.rotateOnAxis(SW,e)}translateOnAxis(e,t){return xW.copy(e).applyQuaternion(this.quaternion),this.position.add(xW.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(bW,e)}translateY(e){return this.translateOnAxis(wW,e)}translateZ(e){return this.translateOnAxis(SW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ym.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?a2.copy(e):a2.set(e,t,r);const s=this.parent;this.updateWorldMatrix(!0,!1),XS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ym.lookAt(XS,a2,this.up):ym.lookAt(a2,XS,this.up),this.quaternion.setFromRotationMatrix(ym),s&&(ym.extractRotation(s.matrixWorld),M1.setFromRotationMatrix(ym),this.quaternion.premultiply(M1.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(AW),C1.child=e,this.dispatchEvent(C1),C1.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(F_e),QO.child=e,this.dispatchEvent(QO),QO.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ym.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ym.multiply(e.parent.matrixWorld)),e.applyMatrix4(ym),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(AW),C1.child=e,this.dispatchEvent(C1),C1.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,s=this.children.length;r<s;r++){const l=this.children[r].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XS,e,k_e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XS,O_e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,s=t.length;r<s;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,s=t.length;r<s;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,s=t.length;r<s;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(c,a){return c[a.uuid]===void 0&&(c[a.uuid]=a.toJSON(e)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const a=c.shapes;if(Array.isArray(a))for(let d=0,f=a.length;d<f;d++){const m=a[d];o(e.shapes,m)}else o(e.shapes,a)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let a=0,d=this.material.length;a<d;a++)c.push(o(e.materials,this.material[a]));s.material=c}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){const a=this.animations[c];s.animations.push(o(e.animations,a))}}if(t){const c=l(e.geometries),a=l(e.materials),d=l(e.textures),f=l(e.images),m=l(e.shapes),_=l(e.skeletons),x=l(e.animations),A=l(e.nodes);c.length>0&&(r.geometries=c),a.length>0&&(r.materials=a),d.length>0&&(r.textures=d),f.length>0&&(r.images=f),m.length>0&&(r.shapes=m),_.length>0&&(r.skeletons=_),x.length>0&&(r.animations=x),A.length>0&&(r.nodes=A)}return r.object=s,r;function l(c){const a=[];for(const d in c){const f=c[d];delete f.metadata,a.push(f)}return a}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const s=e.children[r];this.add(s.clone())}return this}}Bi.DEFAULT_UP=new Ze(0,1,0);Bi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Bi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Dd=new Ze,xm=new Ze,eF=new Ze,bm=new Ze,E1=new Ze,I1=new Ze,TW=new Ze,tF=new Ze,nF=new Ze,rF=new Ze;let Qv=class cb{constructor(e=new Ze,t=new Ze,r=new Ze){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,s){s.subVectors(r,t),Dd.subVectors(e,t),s.cross(Dd);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,t,r,s,o){Dd.subVectors(s,t),xm.subVectors(r,t),eF.subVectors(e,t);const l=Dd.dot(Dd),c=Dd.dot(xm),a=Dd.dot(eF),d=xm.dot(xm),f=xm.dot(eF),m=l*d-c*c;if(m===0)return o.set(0,0,0),null;const _=1/m,x=(d*a-c*f)*_,A=(l*f-c*a)*_;return o.set(1-x-A,A,x)}static containsPoint(e,t,r,s){return this.getBarycoord(e,t,r,s,bm)===null?!1:bm.x>=0&&bm.y>=0&&bm.x+bm.y<=1}static getInterpolation(e,t,r,s,o,l,c,a){return this.getBarycoord(e,t,r,s,bm)===null?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(o,bm.x),a.addScaledVector(l,bm.y),a.addScaledVector(c,bm.z),a)}static isFrontFacing(e,t,r,s){return Dd.subVectors(r,t),xm.subVectors(e,t),Dd.cross(xm).dot(s)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,s){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,r,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Dd.subVectors(this.c,this.b),xm.subVectors(this.a,this.b),Dd.cross(xm).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return cb.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return cb.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,s,o){return cb.getInterpolation(e,this.a,this.b,this.c,t,r,s,o)}containsPoint(e){return cb.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return cb.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,s=this.b,o=this.c;let l,c;E1.subVectors(s,r),I1.subVectors(o,r),tF.subVectors(e,r);const a=E1.dot(tF),d=I1.dot(tF);if(a<=0&&d<=0)return t.copy(r);nF.subVectors(e,s);const f=E1.dot(nF),m=I1.dot(nF);if(f>=0&&m<=f)return t.copy(s);const _=a*m-f*d;if(_<=0&&a>=0&&f<=0)return l=a/(a-f),t.copy(r).addScaledVector(E1,l);rF.subVectors(e,o);const x=E1.dot(rF),A=I1.dot(rF);if(A>=0&&x<=A)return t.copy(o);const I=x*d-a*A;if(I<=0&&d>=0&&A<=0)return c=d/(d-A),t.copy(r).addScaledVector(I1,c);const E=f*A-x*m;if(E<=0&&m-f>=0&&x-A>=0)return TW.subVectors(o,s),c=(m-f)/(m-f+(x-A)),t.copy(s).addScaledVector(TW,c);const C=1/(E+I+_);return l=I*C,c=_*C,t.copy(r).addScaledVector(E1,l).addScaledVector(I1,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const ere={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bv={h:0,s:0,l:0},l2={h:0,s:0,l:0};function iF(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Hn=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Eo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,_s.toWorkingColorSpace(this,t),this}setRGB(e,t,r,s=_s.workingColorSpace){return this.r=e,this.g=t,this.b=r,_s.toWorkingColorSpace(this,s),this}setHSL(e,t,r,s=_s.workingColorSpace){if(e=C6(e,1),t=ia(t,0,1),r=ia(r,0,1),t===0)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+t):r+t-r*t,l=2*r-o;this.r=iF(l,o,e+1/3),this.g=iF(l,o,e),this.b=iF(l,o,e-1/3)}return _s.toWorkingColorSpace(this,s),this}setStyle(e,t=Eo){function r(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const l=s[1],c=s[2];switch(l){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],l=o.length;if(l===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(l===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Eo){const r=ere[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Yb(e.r),this.g=Yb(e.g),this.b=Yb(e.b),this}copyLinearToSRGB(e){return this.r=WO(e.r),this.g=WO(e.g),this.b=WO(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Eo){return _s.fromWorkingColorSpace(Ul.copy(this),e),Math.round(ia(Ul.r*255,0,255))*65536+Math.round(ia(Ul.g*255,0,255))*256+Math.round(ia(Ul.b*255,0,255))}getHexString(e=Eo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=_s.workingColorSpace){_s.fromWorkingColorSpace(Ul.copy(this),t);const r=Ul.r,s=Ul.g,o=Ul.b,l=Math.max(r,s,o),c=Math.min(r,s,o);let a,d;const f=(c+l)/2;if(c===l)a=0,d=0;else{const m=l-c;switch(d=f<=.5?m/(l+c):m/(2-l-c),l){case r:a=(s-o)/m+(s<o?6:0);break;case s:a=(o-r)/m+2;break;case o:a=(r-s)/m+4;break}a/=6}return e.h=a,e.s=d,e.l=f,e}getRGB(e,t=_s.workingColorSpace){return _s.fromWorkingColorSpace(Ul.copy(this),t),e.r=Ul.r,e.g=Ul.g,e.b=Ul.b,e}getStyle(e=Eo){_s.fromWorkingColorSpace(Ul.copy(this),e);const t=Ul.r,r=Ul.g,s=Ul.b;return e!==Eo?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(s*255)})`}offsetHSL(e,t,r){return this.getHSL(bv),this.setHSL(bv.h+e,bv.s+t,bv.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(bv),e.getHSL(l2);const r=yT(bv.h,l2.h,t),s=yT(bv.s,l2.s,t),o=yT(bv.l,l2.l,t);return this.setHSL(r,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,s=this.b,o=e.elements;return this.r=o[0]*t+o[3]*r+o[6]*s,this.g=o[1]*t+o[4]*r+o[7]*s,this.b=o[2]*t+o[5]*r+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ul=new Hn;Hn.NAMES=ere;let N_e=0;class wo extends Tp{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:N_e++}),this.uuid=Uu(),this.name="",this.type="Material",this.blending=Xy,this.side=Uh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=_R,this.blendDst=yR,this.blendEquation=Xv,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Hn(0,0,0),this.blendAlpha=0,this.depthFunc=dM,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=rz,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=xy,this.stencilZFail=xy,this.stencilZPass=xy,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Xy&&(r.blending=this.blending),this.side!==Uh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==_R&&(r.blendSrc=this.blendSrc),this.blendDst!==yR&&(r.blendDst=this.blendDst),this.blendEquation!==Xv&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==dM&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==rz&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==xy&&(r.stencilFail=this.stencilFail),this.stencilZFail!==xy&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==xy&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function s(o){const l=[];for(const c in o){const a=o[c];delete a.metadata,l.push(a)}return l}if(t){const o=s(e.textures),l=s(e.images);o.length>0&&(r.textures=o),l.length>0&&(r.images=l)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const s=t.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=t[o].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}}class bo extends wo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ju,this.combine=lC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const km=z_e();function z_e(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),s=new Uint32Array(512);for(let a=0;a<256;++a){const d=a-127;d<-27?(r[a]=0,r[a|256]=32768,s[a]=24,s[a|256]=24):d<-14?(r[a]=1024>>-d-14,r[a|256]=1024>>-d-14|32768,s[a]=-d-1,s[a|256]=-d-1):d<=15?(r[a]=d+15<<10,r[a|256]=d+15<<10|32768,s[a]=13,s[a|256]=13):d<128?(r[a]=31744,r[a|256]=64512,s[a]=24,s[a|256]=24):(r[a]=31744,r[a|256]=64512,s[a]=13,s[a|256]=13)}const o=new Uint32Array(2048),l=new Uint32Array(64),c=new Uint32Array(64);for(let a=1;a<1024;++a){let d=a<<13,f=0;for(;!(d&8388608);)d<<=1,f-=8388608;d&=-8388609,f+=947912704,o[a]=d|f}for(let a=1024;a<2048;++a)o[a]=939524096+(a-1024<<13);for(let a=1;a<31;++a)l[a]=a<<23;l[31]=1199570944,l[32]=2147483648;for(let a=33;a<63;++a)l[a]=2147483648+(a-32<<23);l[63]=3347054592;for(let a=1;a<64;++a)a!==32&&(c[a]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:s,mantissaTable:o,exponentTable:l,offsetTable:c}}function ru(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=ia(n,-65504,65504),km.floatView[0]=n;const e=km.uint32View[0],t=e>>23&511;return km.baseTable[t]+((e&8388607)>>km.shiftTable[t])}function VA(n){const e=n>>10;return km.uint32View[0]=km.mantissaTable[km.offsetTable[e]+(n&1023)]+km.exponentTable[e],km.floatView[0]}const U_e={toHalfFloat:ru,fromHalfFloat:VA},Aa=new Ze,c2=new sn;class Ni{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=yM,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ec,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return E6("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)c2.fromBufferAttribute(this,t),c2.applyMatrix3(e),this.setXY(t,c2.x,c2.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Aa.fromBufferAttribute(this,t),Aa.applyMatrix3(e),this.setXYZ(t,Aa.x,Aa.y,Aa.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Aa.fromBufferAttribute(this,t),Aa.applyMatrix4(e),this.setXYZ(t,Aa.x,Aa.y,Aa.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Aa.fromBufferAttribute(this,t),Aa.applyNormalMatrix(e),this.setXYZ(t,Aa.x,Aa.y,Aa.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Aa.fromBufferAttribute(this,t),Aa.transformDirection(e),this.setXYZ(t,Aa.x,Aa.y,Aa.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Cc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Ci(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Cc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Cc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Cc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Cc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,s){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,t,r,s,o){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array),o=Ci(o,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==yM&&(e.usage=this.usage),e}}class G_e extends Ni{constructor(e,t,r){super(new Int8Array(e),t,r)}}class V_e extends Ni{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class H_e extends Ni{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class j_e extends Ni{constructor(e,t,r){super(new Int16Array(e),t,r)}}class P6 extends Ni{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class W_e extends Ni{constructor(e,t,r){super(new Int32Array(e),t,r)}}class R6 extends Ni{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class $_e extends Ni{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=VA(this.array[e*this.itemSize]);return this.normalized&&(t=Cc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize]=ru(t),this}getY(e){let t=VA(this.array[e*this.itemSize+1]);return this.normalized&&(t=Cc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+1]=ru(t),this}getZ(e){let t=VA(this.array[e*this.itemSize+2]);return this.normalized&&(t=Cc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+2]=ru(t),this}getW(e){let t=VA(this.array[e*this.itemSize+3]);return this.normalized&&(t=Cc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ci(t,this.array)),this.array[e*this.itemSize+3]=ru(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array)),this.array[e+0]=ru(t),this.array[e+1]=ru(r),this}setXYZ(e,t,r,s){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array)),this.array[e+0]=ru(t),this.array[e+1]=ru(r),this.array[e+2]=ru(s),this}setXYZW(e,t,r,s,o){return e*=this.itemSize,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array),o=Ci(o,this.array)),this.array[e+0]=ru(t),this.array[e+1]=ru(r),this.array[e+2]=ru(s),this.array[e+3]=ru(o),this}}class lr extends Ni{constructor(e,t,r){super(new Float32Array(e),t,r)}}let X_e=0;const fh=new Hr,sF=new Bi,P1=new Ze,Du=new Cl,qS=new Cl,il=new Ze;class Yr extends Tp{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:X_e++}),this.uuid=Uu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Zne(e)?R6:P6)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const o=new Mi().getNormalMatrix(e);r.applyNormalMatrix(o),r.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return fh.makeRotationFromQuaternion(e),this.applyMatrix4(fh),this}rotateX(e){return fh.makeRotationX(e),this.applyMatrix4(fh),this}rotateY(e){return fh.makeRotationY(e),this.applyMatrix4(fh),this}rotateZ(e){return fh.makeRotationZ(e),this.applyMatrix4(fh),this}translate(e,t,r){return fh.makeTranslation(e,t,r),this.applyMatrix4(fh),this}scale(e,t,r){return fh.makeScale(e,t,r),this.applyMatrix4(fh),this}lookAt(e){return sF.lookAt(e),sF.updateMatrix(),this.applyMatrix4(sF.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(P1).negate(),this.translate(P1.x,P1.y,P1.z),this}setFromPoints(e){const t=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new lr(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ze(-1/0,-1/0,-1/0),new Ze(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++){const o=t[r];Du.setFromBufferAttribute(o),this.morphTargetsRelative?(il.addVectors(this.boundingBox.min,Du.min),this.boundingBox.expandByPoint(il),il.addVectors(this.boundingBox.max,Du.max),this.boundingBox.expandByPoint(il)):(this.boundingBox.expandByPoint(Du.min),this.boundingBox.expandByPoint(Du.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new al);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ze,1/0);return}if(e){const r=this.boundingSphere.center;if(Du.setFromBufferAttribute(e),t)for(let o=0,l=t.length;o<l;o++){const c=t[o];qS.setFromBufferAttribute(c),this.morphTargetsRelative?(il.addVectors(Du.min,qS.min),Du.expandByPoint(il),il.addVectors(Du.max,qS.max),Du.expandByPoint(il)):(Du.expandByPoint(qS.min),Du.expandByPoint(qS.max))}Du.getCenter(r);let s=0;for(let o=0,l=e.count;o<l;o++)il.fromBufferAttribute(e,o),s=Math.max(s,r.distanceToSquared(il));if(t)for(let o=0,l=t.length;o<l;o++){const c=t[o],a=this.morphTargetsRelative;for(let d=0,f=c.count;d<f;d++)il.fromBufferAttribute(c,d),a&&(P1.fromBufferAttribute(e,d),il.add(P1)),s=Math.max(s,r.distanceToSquared(il))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,s=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ni(new Float32Array(4*r.count),4));const l=this.getAttribute("tangent"),c=[],a=[];for(let re=0;re<r.count;re++)c[re]=new Ze,a[re]=new Ze;const d=new Ze,f=new Ze,m=new Ze,_=new sn,x=new sn,A=new sn,I=new Ze,E=new Ze;function C(re,se,ae){d.fromBufferAttribute(r,re),f.fromBufferAttribute(r,se),m.fromBufferAttribute(r,ae),_.fromBufferAttribute(o,re),x.fromBufferAttribute(o,se),A.fromBufferAttribute(o,ae),f.sub(d),m.sub(d),x.sub(_),A.sub(_);const he=1/(x.x*A.y-A.x*x.y);isFinite(he)&&(I.copy(f).multiplyScalar(A.y).addScaledVector(m,-x.y).multiplyScalar(he),E.copy(m).multiplyScalar(x.x).addScaledVector(f,-A.x).multiplyScalar(he),c[re].add(I),c[se].add(I),c[ae].add(I),a[re].add(E),a[se].add(E),a[ae].add(E))}let L=this.groups;L.length===0&&(L=[{start:0,count:e.count}]);for(let re=0,se=L.length;re<se;++re){const ae=L[re],he=ae.start,Ae=ae.count;for(let Ee=he,Pe=he+Ae;Ee<Pe;Ee+=3)C(e.getX(Ee+0),e.getX(Ee+1),e.getX(Ee+2))}const O=new Ze,H=new Ze,q=new Ze,Z=new Ze;function J(re){q.fromBufferAttribute(s,re),Z.copy(q);const se=c[re];O.copy(se),O.sub(q.multiplyScalar(q.dot(se))).normalize(),H.crossVectors(Z,se);const he=H.dot(a[re])<0?-1:1;l.setXYZW(re,O.x,O.y,O.z,he)}for(let re=0,se=L.length;re<se;++re){const ae=L[re],he=ae.start,Ae=ae.count;for(let Ee=he,Pe=he+Ae;Ee<Pe;Ee+=3)J(e.getX(Ee+0)),J(e.getX(Ee+1)),J(e.getX(Ee+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ni(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let _=0,x=r.count;_<x;_++)r.setXYZ(_,0,0,0);const s=new Ze,o=new Ze,l=new Ze,c=new Ze,a=new Ze,d=new Ze,f=new Ze,m=new Ze;if(e)for(let _=0,x=e.count;_<x;_+=3){const A=e.getX(_+0),I=e.getX(_+1),E=e.getX(_+2);s.fromBufferAttribute(t,A),o.fromBufferAttribute(t,I),l.fromBufferAttribute(t,E),f.subVectors(l,o),m.subVectors(s,o),f.cross(m),c.fromBufferAttribute(r,A),a.fromBufferAttribute(r,I),d.fromBufferAttribute(r,E),c.add(f),a.add(f),d.add(f),r.setXYZ(A,c.x,c.y,c.z),r.setXYZ(I,a.x,a.y,a.z),r.setXYZ(E,d.x,d.y,d.z)}else for(let _=0,x=t.count;_<x;_+=3)s.fromBufferAttribute(t,_+0),o.fromBufferAttribute(t,_+1),l.fromBufferAttribute(t,_+2),f.subVectors(l,o),m.subVectors(s,o),f.cross(m),r.setXYZ(_+0,f.x,f.y,f.z),r.setXYZ(_+1,f.x,f.y,f.z),r.setXYZ(_+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)il.fromBufferAttribute(e,t),il.normalize(),e.setXYZ(t,il.x,il.y,il.z)}toNonIndexed(){function e(c,a){const d=c.array,f=c.itemSize,m=c.normalized,_=new d.constructor(a.length*f);let x=0,A=0;for(let I=0,E=a.length;I<E;I++){c.isInterleavedBufferAttribute?x=a[I]*c.data.stride+c.offset:x=a[I]*f;for(let C=0;C<f;C++)_[A++]=d[x++]}return new Ni(_,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Yr,r=this.index.array,s=this.attributes;for(const c in s){const a=s[c],d=e(a,r);t.setAttribute(c,d)}const o=this.morphAttributes;for(const c in o){const a=[],d=o[c];for(let f=0,m=d.length;f<m;f++){const _=d[f],x=e(_,r);a.push(x)}t.morphAttributes[c]=a}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let c=0,a=l.length;c<a;c++){const d=l[c];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const a=this.parameters;for(const d in a)a[d]!==void 0&&(e[d]=a[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const a in r){const d=r[a];e.data.attributes[a]=d.toJSON(e.data)}const s={};let o=!1;for(const a in this.morphAttributes){const d=this.morphAttributes[a],f=[];for(let m=0,_=d.length;m<_;m++){const x=d[m];f.push(x.toJSON(e.data))}f.length>0&&(s[a]=f,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const s=e.attributes;for(const d in s){const f=s[d];this.setAttribute(d,f.clone(t))}const o=e.morphAttributes;for(const d in o){const f=[],m=o[d];for(let _=0,x=m.length;_<x;_++)f.push(m[_].clone(t));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let d=0,f=l.length;d<f;d++){const m=l[d];this.addGroup(m.start,m.count,m.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const a=e.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const MW=new Hr,D_=new Lx,u2=new al,CW=new Ze,R1=new Ze,L1=new Ze,D1=new Ze,oF=new Ze,h2=new Ze,d2=new sn,f2=new sn,p2=new sn,EW=new Ze,IW=new Ze,PW=new Ze,m2=new Ze,g2=new Ze;class Di extends Bi{constructor(e=new Yr,t=new bo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const s=t[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=s.length;o<l;o++){const c=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}getVertexPosition(e,t){const r=this.geometry,s=r.attributes.position,o=r.morphAttributes.position,l=r.morphTargetsRelative;t.fromBufferAttribute(s,e);const c=this.morphTargetInfluences;if(o&&c){h2.set(0,0,0);for(let a=0,d=o.length;a<d;a++){const f=c[a],m=o[a];f!==0&&(oF.fromBufferAttribute(m,e),l?h2.addScaledVector(oF,f):h2.addScaledVector(oF.sub(t),f))}t.add(h2)}return t}raycast(e,t){const r=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),u2.copy(r.boundingSphere),u2.applyMatrix4(o),D_.copy(e.ray).recast(e.near),!(u2.containsPoint(D_.origin)===!1&&(D_.intersectSphere(u2,CW)===null||D_.origin.distanceToSquared(CW)>(e.far-e.near)**2))&&(MW.copy(o).invert(),D_.copy(e.ray).applyMatrix4(MW),!(r.boundingBox!==null&&D_.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,D_)))}_computeIntersections(e,t,r){let s;const o=this.geometry,l=this.material,c=o.index,a=o.attributes.position,d=o.attributes.uv,f=o.attributes.uv1,m=o.attributes.normal,_=o.groups,x=o.drawRange;if(c!==null)if(Array.isArray(l))for(let A=0,I=_.length;A<I;A++){const E=_[A],C=l[E.materialIndex],L=Math.max(E.start,x.start),O=Math.min(c.count,Math.min(E.start+E.count,x.start+x.count));for(let H=L,q=O;H<q;H+=3){const Z=c.getX(H),J=c.getX(H+1),re=c.getX(H+2);s=v2(this,C,e,r,d,f,m,Z,J,re),s&&(s.faceIndex=Math.floor(H/3),s.face.materialIndex=E.materialIndex,t.push(s))}}else{const A=Math.max(0,x.start),I=Math.min(c.count,x.start+x.count);for(let E=A,C=I;E<C;E+=3){const L=c.getX(E),O=c.getX(E+1),H=c.getX(E+2);s=v2(this,l,e,r,d,f,m,L,O,H),s&&(s.faceIndex=Math.floor(E/3),t.push(s))}}else if(a!==void 0)if(Array.isArray(l))for(let A=0,I=_.length;A<I;A++){const E=_[A],C=l[E.materialIndex],L=Math.max(E.start,x.start),O=Math.min(a.count,Math.min(E.start+E.count,x.start+x.count));for(let H=L,q=O;H<q;H+=3){const Z=H,J=H+1,re=H+2;s=v2(this,C,e,r,d,f,m,Z,J,re),s&&(s.faceIndex=Math.floor(H/3),s.face.materialIndex=E.materialIndex,t.push(s))}}else{const A=Math.max(0,x.start),I=Math.min(a.count,x.start+x.count);for(let E=A,C=I;E<C;E+=3){const L=E,O=E+1,H=E+2;s=v2(this,l,e,r,d,f,m,L,O,H),s&&(s.faceIndex=Math.floor(E/3),t.push(s))}}}}function q_e(n,e,t,r,s,o,l,c){let a;if(e.side===Rc?a=r.intersectTriangle(l,o,s,!0,c):a=r.intersectTriangle(s,o,l,e.side===Uh,c),a===null)return null;g2.copy(c),g2.applyMatrix4(n.matrixWorld);const d=t.ray.origin.distanceTo(g2);return d<t.near||d>t.far?null:{distance:d,point:g2.clone(),object:n}}function v2(n,e,t,r,s,o,l,c,a,d){n.getVertexPosition(c,R1),n.getVertexPosition(a,L1),n.getVertexPosition(d,D1);const f=q_e(n,e,t,r,R1,L1,D1,m2);if(f){s&&(d2.fromBufferAttribute(s,c),f2.fromBufferAttribute(s,a),p2.fromBufferAttribute(s,d),f.uv=Qv.getInterpolation(m2,R1,L1,D1,d2,f2,p2,new sn)),o&&(d2.fromBufferAttribute(o,c),f2.fromBufferAttribute(o,a),p2.fromBufferAttribute(o,d),f.uv1=Qv.getInterpolation(m2,R1,L1,D1,d2,f2,p2,new sn)),l&&(EW.fromBufferAttribute(l,c),IW.fromBufferAttribute(l,a),PW.fromBufferAttribute(l,d),f.normal=Qv.getInterpolation(m2,R1,L1,D1,EW,IW,PW,new Ze),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));const m={a:c,b:a,c:d,normal:new Ze,materialIndex:0};Qv.getNormal(R1,L1,D1,m.normal),f.face=m}return f}class Mp extends Yr{constructor(e=1,t=1,r=1,s=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:s,heightSegments:o,depthSegments:l};const c=this;s=Math.floor(s),o=Math.floor(o),l=Math.floor(l);const a=[],d=[],f=[],m=[];let _=0,x=0;A("z","y","x",-1,-1,r,t,e,l,o,0),A("z","y","x",1,-1,r,t,-e,l,o,1),A("x","z","y",1,1,e,r,t,s,l,2),A("x","z","y",1,-1,e,r,-t,s,l,3),A("x","y","z",1,-1,e,t,r,s,o,4),A("x","y","z",-1,-1,e,t,-r,s,o,5),this.setIndex(a),this.setAttribute("position",new lr(d,3)),this.setAttribute("normal",new lr(f,3)),this.setAttribute("uv",new lr(m,2));function A(I,E,C,L,O,H,q,Z,J,re,se){const ae=H/J,he=q/re,Ae=H/2,Ee=q/2,Pe=Z/2,ze=J+1,Re=re+1;let rt=0,ye=0;const We=new Ze;for(let Ue=0;Ue<Re;Ue++){const gt=Ue*he-Ee;for(let vt=0;vt<ze;vt++){const Dt=vt*ae-Ae;We[I]=Dt*L,We[E]=gt*O,We[C]=Pe,d.push(We.x,We.y,We.z),We[I]=0,We[E]=0,We[C]=Z>0?1:-1,f.push(We.x,We.y,We.z),m.push(vt/J),m.push(1-Ue/re),rt+=1}}for(let Ue=0;Ue<re;Ue++)for(let gt=0;gt<J;gt++){const vt=_+gt+ze*Ue,Dt=_+gt+ze*(Ue+1),lt=_+(gt+1)+ze*(Ue+1),jt=_+(gt+1)+ze*Ue;a.push(vt,Dt,jt),a.push(Dt,lt,jt),ye+=6}c.addGroup(x,ye,se),x+=ye,_+=rt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function yw(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const s=n[t][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=s.clone():Array.isArray(s)?e[t][r]=s.slice():e[t][r]=s}}return e}function wc(n){const e={};for(let t=0;t<n.length;t++){const r=yw(n[t]);for(const s in r)e[s]=r[s]}return e}function Y_e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function tre(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:_s.workingColorSpace}const tg={clone:yw,merge:wc};var Z_e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,K_e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Lo extends wo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Z_e,this.fragmentShader=K_e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yw(e.uniforms),this.uniformsGroups=Y_e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const l=this.uniforms[s].value;l&&l.isTexture?t.uniforms[s]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[s]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[s]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[s]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[s]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[s]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[s]={type:"m4",value:l.toArray()}:t.uniforms[s]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const s in this.extensions)this.extensions[s]===!0&&(r[s]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class pC extends Bi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Hr,this.projectionMatrix=new Hr,this.projectionMatrixInverse=new Hr,this.coordinateSystem=ap}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const wv=new Ze,RW=new sn,LW=new sn;class is extends pC{constructor(e=50,t=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=_w*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Zy*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return _w*2*Math.atan(Math.tan(Zy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){wv.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(wv.x,wv.y).multiplyScalar(-e/wv.z),wv.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(wv.x,wv.y).multiplyScalar(-e/wv.z)}getViewSize(e,t){return this.getViewBounds(e,RW,LW),t.subVectors(LW,RW)}setViewOffset(e,t,r,s,o,l){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Zy*.5*this.fov)/this.zoom,r=2*t,s=this.aspect*r,o=-.5*s;const l=this.view;if(this.view!==null&&this.view.enabled){const a=l.fullWidth,d=l.fullHeight;o+=l.offsetX*s/a,t-=l.offsetY*r/d,s*=l.width/a,r*=l.height/d}const c=this.filmOffset;c!==0&&(o+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const B1=-90,k1=1;class nre extends Bi{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new is(B1,k1,e,t);s.layers=this.layers,this.add(s);const o=new is(B1,k1,e,t);o.layers=this.layers,this.add(o);const l=new is(B1,k1,e,t);l.layers=this.layers,this.add(l);const c=new is(B1,k1,e,t);c.layers=this.layers,this.add(c);const a=new is(B1,k1,e,t);a.layers=this.layers,this.add(a);const d=new is(B1,k1,e,t);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,s,o,l,c,a]=t;for(const d of t)this.remove(d);if(e===ap)r.up.set(0,1,0),r.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else if(e===xM)r.up.set(0,-1,0),r.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const d of t)this.add(d),d.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,l,c,a,d,f]=this.children,m=e.getRenderTarget(),_=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),A=e.xr.enabled;e.xr.enabled=!1;const I=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,s),e.render(t,o),e.setRenderTarget(r,1,s),e.render(t,l),e.setRenderTarget(r,2,s),e.render(t,c),e.setRenderTarget(r,3,s),e.render(t,a),e.setRenderTarget(r,4,s),e.render(t,d),r.texture.generateMipmaps=I,e.setRenderTarget(r,5,s),e.render(t,f),e.setRenderTarget(m,_,x),e.xr.enabled=A,r.texture.needsPMREMUpdate=!0}}class mC extends Ys{constructor(e,t,r,s,o,l,c,a,d,f){e=e!==void 0?e:[],t=t!==void 0?t:Qm,super(e,t,r,s,o,l,c,a,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class rre extends Ml{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},s=[r,r,r,r,r,r];this.texture=new mC(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ro}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Mp(5,5,5),o=new Lo({name:"CubemapFromEquirect",uniforms:yw(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Rc,blending:pp});o.uniforms.tEquirect.value=t;const l=new Di(s,o),c=t.minFilter;return t.minFilter===hu&&(t.minFilter=Ro),new nre(1,10,this).update(e,l),t.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(e,t,r,s){const o=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,r,s);e.setRenderTarget(o)}}const aF=new Ze,J_e=new Ze,Q_e=new Mi;let Lm=class{constructor(e=new Ze(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,s){return this.normal.set(e,t,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const s=aF.subVectors(r,t).cross(J_e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(aF),s=this.normal.dot(r);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:t.copy(e.start).addScaledVector(r,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Q_e.getNormalMatrix(e),s=this.coplanarPoint(aF).applyMatrix4(e),o=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const B_=new al,_2=new Ze;class gC{constructor(e=new Lm,t=new Lm,r=new Lm,s=new Lm,o=new Lm,l=new Lm){this.planes=[e,t,r,s,o,l]}set(e,t,r,s,o,l){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(r),c[3].copy(s),c[4].copy(o),c[5].copy(l),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=ap){const r=this.planes,s=e.elements,o=s[0],l=s[1],c=s[2],a=s[3],d=s[4],f=s[5],m=s[6],_=s[7],x=s[8],A=s[9],I=s[10],E=s[11],C=s[12],L=s[13],O=s[14],H=s[15];if(r[0].setComponents(a-o,_-d,E-x,H-C).normalize(),r[1].setComponents(a+o,_+d,E+x,H+C).normalize(),r[2].setComponents(a+l,_+f,E+A,H+L).normalize(),r[3].setComponents(a-l,_-f,E-A,H-L).normalize(),r[4].setComponents(a-c,_-m,E-I,H-O).normalize(),t===ap)r[5].setComponents(a+c,_+m,E+I,H+O).normalize();else if(t===xM)r[5].setComponents(c,m,I,O).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),B_.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),B_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(B_)}intersectsSprite(e){return B_.center.set(0,0,0),B_.radius=.7071067811865476,B_.applyMatrix4(e.matrixWorld),this.intersectsSphere(B_)}intersectsSphere(e){const t=this.planes,r=e.center,s=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const s=t[r];if(_2.x=s.normal.x>0?e.max.x:e.min.x,_2.y=s.normal.y>0?e.max.y:e.min.y,_2.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(_2)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function ire(){let n=null,e=!1,t=null,r=null;function s(o,l){t(o,l),r=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function eye(n){const e=new WeakMap;function t(c,a){const d=c.array,f=c.usage,m=d.byteLength,_=n.createBuffer();n.bindBuffer(a,_),n.bufferData(a,d,f),c.onUploadCallback();let x;if(d instanceof Float32Array)x=n.FLOAT;else if(d instanceof Uint16Array)c.isFloat16BufferAttribute?x=n.HALF_FLOAT:x=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)x=n.SHORT;else if(d instanceof Uint32Array)x=n.UNSIGNED_INT;else if(d instanceof Int32Array)x=n.INT;else if(d instanceof Int8Array)x=n.BYTE;else if(d instanceof Uint8Array)x=n.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)x=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:_,type:x,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version,size:m}}function r(c,a,d){const f=a.array,m=a._updateRange,_=a.updateRanges;if(n.bindBuffer(d,c),m.count===-1&&_.length===0&&n.bufferSubData(d,0,f),_.length!==0){for(let x=0,A=_.length;x<A;x++){const I=_[x];n.bufferSubData(d,I.start*f.BYTES_PER_ELEMENT,f,I.start,I.count)}a.clearUpdateRanges()}m.count!==-1&&(n.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f,m.offset,m.count),m.count=-1),a.onUploadCallback()}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const a=e.get(c);a&&(n.deleteBuffer(a.buffer),e.delete(c))}function l(c,a){if(c.isGLBufferAttribute){const f=e.get(c);(!f||f.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const d=e.get(c);if(d===void 0)e.set(c,t(c,a));else if(d.version<c.version){if(d.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(d.buffer,c,a),d.version=c.version}}return{get:s,remove:o,update:l}}class hg extends Yr{constructor(e=1,t=1,r=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:s};const o=e/2,l=t/2,c=Math.floor(r),a=Math.floor(s),d=c+1,f=a+1,m=e/c,_=t/a,x=[],A=[],I=[],E=[];for(let C=0;C<f;C++){const L=C*_-l;for(let O=0;O<d;O++){const H=O*m-o;A.push(H,-L,0),I.push(0,0,1),E.push(O/c),E.push(1-C/a)}}for(let C=0;C<a;C++)for(let L=0;L<c;L++){const O=L+d*C,H=L+d*(C+1),q=L+1+d*(C+1),Z=L+1+d*C;x.push(O,H,Z),x.push(H,q,Z)}this.setIndex(x),this.setAttribute("position",new lr(A,3)),this.setAttribute("normal",new lr(I,3)),this.setAttribute("uv",new lr(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hg(e.width,e.height,e.widthSegments,e.heightSegments)}}var tye=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,nye=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rye=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,iye=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sye=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,oye=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aye=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lye=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cye=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,uye=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,hye=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,dye=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,fye=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,pye=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mye=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gye=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,vye=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_ye=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,yye=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,xye=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bye=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,wye=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Sye=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Aye=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Tye=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Mye=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Cye=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Eye=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Iye=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Pye=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Rye="gl_FragColor = linearToOutputTexel( gl_FragColor );",Lye=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Dye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Bye=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,kye=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Oye=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Fye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Nye=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,zye=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Uye=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gye=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Vye=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Hye=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,jye=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Wye=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,$ye=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Xye=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,qye=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Yye=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Zye=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kye=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Jye=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Qye=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,exe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,txe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nxe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,rxe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ixe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sxe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,oxe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,axe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lxe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cxe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uxe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,hxe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dxe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,fxe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,pxe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,mxe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,gxe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,vxe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_xe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,yxe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,xxe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bxe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wxe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Sxe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Axe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Txe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Mxe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Cxe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Exe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Ixe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Pxe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Rxe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Lxe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Dxe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Bxe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,kxe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Oxe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Fxe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Nxe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,zxe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Uxe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Gxe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Vxe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Hxe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,jxe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Wxe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,$xe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Xxe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,qxe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Yxe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Zxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Kxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Jxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Qxe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const e1e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,t1e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,n1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,r1e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,i1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,s1e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,o1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,a1e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,l1e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,c1e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,u1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,h1e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,d1e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,f1e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,p1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,m1e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,g1e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v1e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_1e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,y1e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,x1e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,b1e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,w1e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,S1e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A1e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,T1e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,M1e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,C1e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E1e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,I1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,P1e=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,R1e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,L1e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,D1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pi={alphahash_fragment:tye,alphahash_pars_fragment:nye,alphamap_fragment:rye,alphamap_pars_fragment:iye,alphatest_fragment:sye,alphatest_pars_fragment:oye,aomap_fragment:aye,aomap_pars_fragment:lye,batching_pars_vertex:cye,batching_vertex:uye,begin_vertex:hye,beginnormal_vertex:dye,bsdfs:fye,iridescence_fragment:pye,bumpmap_pars_fragment:mye,clipping_planes_fragment:gye,clipping_planes_pars_fragment:vye,clipping_planes_pars_vertex:_ye,clipping_planes_vertex:yye,color_fragment:xye,color_pars_fragment:bye,color_pars_vertex:wye,color_vertex:Sye,common:Aye,cube_uv_reflection_fragment:Tye,defaultnormal_vertex:Mye,displacementmap_pars_vertex:Cye,displacementmap_vertex:Eye,emissivemap_fragment:Iye,emissivemap_pars_fragment:Pye,colorspace_fragment:Rye,colorspace_pars_fragment:Lye,envmap_fragment:Dye,envmap_common_pars_fragment:Bye,envmap_pars_fragment:kye,envmap_pars_vertex:Oye,envmap_physical_pars_fragment:Xye,envmap_vertex:Fye,fog_vertex:Nye,fog_pars_vertex:zye,fog_fragment:Uye,fog_pars_fragment:Gye,gradientmap_pars_fragment:Vye,lightmap_pars_fragment:Hye,lights_lambert_fragment:jye,lights_lambert_pars_fragment:Wye,lights_pars_begin:$ye,lights_toon_fragment:qye,lights_toon_pars_fragment:Yye,lights_phong_fragment:Zye,lights_phong_pars_fragment:Kye,lights_physical_fragment:Jye,lights_physical_pars_fragment:Qye,lights_fragment_begin:exe,lights_fragment_maps:txe,lights_fragment_end:nxe,logdepthbuf_fragment:rxe,logdepthbuf_pars_fragment:ixe,logdepthbuf_pars_vertex:sxe,logdepthbuf_vertex:oxe,map_fragment:axe,map_pars_fragment:lxe,map_particle_fragment:cxe,map_particle_pars_fragment:uxe,metalnessmap_fragment:hxe,metalnessmap_pars_fragment:dxe,morphinstance_vertex:fxe,morphcolor_vertex:pxe,morphnormal_vertex:mxe,morphtarget_pars_vertex:gxe,morphtarget_vertex:vxe,normal_fragment_begin:_xe,normal_fragment_maps:yxe,normal_pars_fragment:xxe,normal_pars_vertex:bxe,normal_vertex:wxe,normalmap_pars_fragment:Sxe,clearcoat_normal_fragment_begin:Axe,clearcoat_normal_fragment_maps:Txe,clearcoat_pars_fragment:Mxe,iridescence_pars_fragment:Cxe,opaque_fragment:Exe,packing:Ixe,premultiplied_alpha_fragment:Pxe,project_vertex:Rxe,dithering_fragment:Lxe,dithering_pars_fragment:Dxe,roughnessmap_fragment:Bxe,roughnessmap_pars_fragment:kxe,shadowmap_pars_fragment:Oxe,shadowmap_pars_vertex:Fxe,shadowmap_vertex:Nxe,shadowmask_pars_fragment:zxe,skinbase_vertex:Uxe,skinning_pars_vertex:Gxe,skinning_vertex:Vxe,skinnormal_vertex:Hxe,specularmap_fragment:jxe,specularmap_pars_fragment:Wxe,tonemapping_fragment:$xe,tonemapping_pars_fragment:Xxe,transmission_fragment:qxe,transmission_pars_fragment:Yxe,uv_pars_fragment:Zxe,uv_pars_vertex:Kxe,uv_vertex:Jxe,worldpos_vertex:Qxe,background_vert:e1e,background_frag:t1e,backgroundCube_vert:n1e,backgroundCube_frag:r1e,cube_vert:i1e,cube_frag:s1e,depth_vert:o1e,depth_frag:a1e,distanceRGBA_vert:l1e,distanceRGBA_frag:c1e,equirect_vert:u1e,equirect_frag:h1e,linedashed_vert:d1e,linedashed_frag:f1e,meshbasic_vert:p1e,meshbasic_frag:m1e,meshlambert_vert:g1e,meshlambert_frag:v1e,meshmatcap_vert:_1e,meshmatcap_frag:y1e,meshnormal_vert:x1e,meshnormal_frag:b1e,meshphong_vert:w1e,meshphong_frag:S1e,meshphysical_vert:A1e,meshphysical_frag:T1e,meshtoon_vert:M1e,meshtoon_frag:C1e,points_vert:E1e,points_frag:I1e,shadow_vert:P1e,shadow_frag:R1e,sprite_vert:L1e,sprite_frag:D1e},dr={common:{diffuse:{value:new Hn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Mi},alphaMap:{value:null},alphaMapTransform:{value:new Mi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Mi}},envmap:{envMap:{value:null},envMapRotation:{value:new Mi},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Mi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Mi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Mi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Mi},normalScale:{value:new sn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Mi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Mi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Mi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Mi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Hn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Hn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Mi},alphaTest:{value:0},uvTransform:{value:new Mi}},sprite:{diffuse:{value:new Hn(16777215)},opacity:{value:1},center:{value:new sn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Mi},alphaMap:{value:null},alphaMapTransform:{value:new Mi},alphaTest:{value:0}}},Wd={basic:{uniforms:wc([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.fog]),vertexShader:Pi.meshbasic_vert,fragmentShader:Pi.meshbasic_frag},lambert:{uniforms:wc([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.fog,dr.lights,{emissive:{value:new Hn(0)}}]),vertexShader:Pi.meshlambert_vert,fragmentShader:Pi.meshlambert_frag},phong:{uniforms:wc([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.fog,dr.lights,{emissive:{value:new Hn(0)},specular:{value:new Hn(1118481)},shininess:{value:30}}]),vertexShader:Pi.meshphong_vert,fragmentShader:Pi.meshphong_frag},standard:{uniforms:wc([dr.common,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.roughnessmap,dr.metalnessmap,dr.fog,dr.lights,{emissive:{value:new Hn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag},toon:{uniforms:wc([dr.common,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.gradientmap,dr.fog,dr.lights,{emissive:{value:new Hn(0)}}]),vertexShader:Pi.meshtoon_vert,fragmentShader:Pi.meshtoon_frag},matcap:{uniforms:wc([dr.common,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.fog,{matcap:{value:null}}]),vertexShader:Pi.meshmatcap_vert,fragmentShader:Pi.meshmatcap_frag},points:{uniforms:wc([dr.points,dr.fog]),vertexShader:Pi.points_vert,fragmentShader:Pi.points_frag},dashed:{uniforms:wc([dr.common,dr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pi.linedashed_vert,fragmentShader:Pi.linedashed_frag},depth:{uniforms:wc([dr.common,dr.displacementmap]),vertexShader:Pi.depth_vert,fragmentShader:Pi.depth_frag},normal:{uniforms:wc([dr.common,dr.bumpmap,dr.normalmap,dr.displacementmap,{opacity:{value:1}}]),vertexShader:Pi.meshnormal_vert,fragmentShader:Pi.meshnormal_frag},sprite:{uniforms:wc([dr.sprite,dr.fog]),vertexShader:Pi.sprite_vert,fragmentShader:Pi.sprite_frag},background:{uniforms:{uvTransform:{value:new Mi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pi.background_vert,fragmentShader:Pi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Mi}},vertexShader:Pi.backgroundCube_vert,fragmentShader:Pi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pi.cube_vert,fragmentShader:Pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pi.equirect_vert,fragmentShader:Pi.equirect_frag},distanceRGBA:{uniforms:wc([dr.common,dr.displacementmap,{referencePosition:{value:new Ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pi.distanceRGBA_vert,fragmentShader:Pi.distanceRGBA_frag},shadow:{uniforms:wc([dr.lights,dr.fog,{color:{value:new Hn(0)},opacity:{value:1}}]),vertexShader:Pi.shadow_vert,fragmentShader:Pi.shadow_frag}};Wd.physical={uniforms:wc([Wd.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Mi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Mi},clearcoatNormalScale:{value:new sn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Mi},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Mi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Mi},sheen:{value:0},sheenColor:{value:new Hn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Mi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Mi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Mi},transmissionSamplerSize:{value:new sn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Mi},attenuationDistance:{value:0},attenuationColor:{value:new Hn(0)},specularColor:{value:new Hn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Mi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Mi},anisotropyVector:{value:new sn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Mi}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag};const y2={r:0,b:0,g:0},k_=new ju,B1e=new Hr;function k1e(n,e,t,r,s,o,l){const c=new Hn(0);let a=o===!0?0:1,d,f,m=null,_=0,x=null;function A(L){let O=L.isScene===!0?L.background:null;return O&&O.isTexture&&(O=(L.backgroundBlurriness>0?t:e).get(O)),O}function I(L){let O=!1;const H=A(L);H===null?C(c,a):H&&H.isColor&&(C(H,1),O=!0);const q=n.xr.getEnvironmentBlendMode();q==="additive"?r.buffers.color.setClear(0,0,0,1,l):q==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,l),(n.autoClear||O)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function E(L,O){const H=A(O);H&&(H.isCubeTexture||H.mapping===Fw)?(f===void 0&&(f=new Di(new Mp(1,1,1),new Lo({name:"BackgroundCubeMaterial",uniforms:yw(Wd.backgroundCube.uniforms),vertexShader:Wd.backgroundCube.vertexShader,fragmentShader:Wd.backgroundCube.fragmentShader,side:Rc,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(q,Z,J){this.matrixWorld.copyPosition(J.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(f)),k_.copy(O.backgroundRotation),k_.x*=-1,k_.y*=-1,k_.z*=-1,H.isCubeTexture&&H.isRenderTargetTexture===!1&&(k_.y*=-1,k_.z*=-1),f.material.uniforms.envMap.value=H,f.material.uniforms.flipEnvMap.value=H.isCubeTexture&&H.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=O.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(B1e.makeRotationFromEuler(k_)),f.material.toneMapped=_s.getTransfer(H.colorSpace)!==io,(m!==H||_!==H.version||x!==n.toneMapping)&&(f.material.needsUpdate=!0,m=H,_=H.version,x=n.toneMapping),f.layers.enableAll(),L.unshift(f,f.geometry,f.material,0,0,null)):H&&H.isTexture&&(d===void 0&&(d=new Di(new hg(2,2),new Lo({name:"BackgroundMaterial",uniforms:yw(Wd.background.uniforms),vertexShader:Wd.background.vertexShader,fragmentShader:Wd.background.fragmentShader,side:Uh,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(d)),d.material.uniforms.t2D.value=H,d.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,d.material.toneMapped=_s.getTransfer(H.colorSpace)!==io,H.matrixAutoUpdate===!0&&H.updateMatrix(),d.material.uniforms.uvTransform.value.copy(H.matrix),(m!==H||_!==H.version||x!==n.toneMapping)&&(d.material.needsUpdate=!0,m=H,_=H.version,x=n.toneMapping),d.layers.enableAll(),L.unshift(d,d.geometry,d.material,0,0,null))}function C(L,O){L.getRGB(y2,tre(n)),r.buffers.color.setClear(y2.r,y2.g,y2.b,O,l)}return{getClearColor:function(){return c},setClearColor:function(L,O=1){c.set(L),a=O,C(c,a)},getClearAlpha:function(){return a},setClearAlpha:function(L){a=L,C(c,a)},render:I,addToRenderList:E}}function O1e(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},s=_(null);let o=s,l=!1;function c(ae,he,Ae,Ee,Pe){let ze=!1;const Re=m(Ee,Ae,he);o!==Re&&(o=Re,d(o.object)),ze=x(ae,Ee,Ae,Pe),ze&&A(ae,Ee,Ae,Pe),Pe!==null&&e.update(Pe,n.ELEMENT_ARRAY_BUFFER),(ze||l)&&(l=!1,H(ae,he,Ae,Ee),Pe!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(Pe).buffer))}function a(){return n.createVertexArray()}function d(ae){return n.bindVertexArray(ae)}function f(ae){return n.deleteVertexArray(ae)}function m(ae,he,Ae){const Ee=Ae.wireframe===!0;let Pe=r[ae.id];Pe===void 0&&(Pe={},r[ae.id]=Pe);let ze=Pe[he.id];ze===void 0&&(ze={},Pe[he.id]=ze);let Re=ze[Ee];return Re===void 0&&(Re=_(a()),ze[Ee]=Re),Re}function _(ae){const he=[],Ae=[],Ee=[];for(let Pe=0;Pe<t;Pe++)he[Pe]=0,Ae[Pe]=0,Ee[Pe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:he,enabledAttributes:Ae,attributeDivisors:Ee,object:ae,attributes:{},index:null}}function x(ae,he,Ae,Ee){const Pe=o.attributes,ze=he.attributes;let Re=0;const rt=Ae.getAttributes();for(const ye in rt)if(rt[ye].location>=0){const Ue=Pe[ye];let gt=ze[ye];if(gt===void 0&&(ye==="instanceMatrix"&&ae.instanceMatrix&&(gt=ae.instanceMatrix),ye==="instanceColor"&&ae.instanceColor&&(gt=ae.instanceColor)),Ue===void 0||Ue.attribute!==gt||gt&&Ue.data!==gt.data)return!0;Re++}return o.attributesNum!==Re||o.index!==Ee}function A(ae,he,Ae,Ee){const Pe={},ze=he.attributes;let Re=0;const rt=Ae.getAttributes();for(const ye in rt)if(rt[ye].location>=0){let Ue=ze[ye];Ue===void 0&&(ye==="instanceMatrix"&&ae.instanceMatrix&&(Ue=ae.instanceMatrix),ye==="instanceColor"&&ae.instanceColor&&(Ue=ae.instanceColor));const gt={};gt.attribute=Ue,Ue&&Ue.data&&(gt.data=Ue.data),Pe[ye]=gt,Re++}o.attributes=Pe,o.attributesNum=Re,o.index=Ee}function I(){const ae=o.newAttributes;for(let he=0,Ae=ae.length;he<Ae;he++)ae[he]=0}function E(ae){C(ae,0)}function C(ae,he){const Ae=o.newAttributes,Ee=o.enabledAttributes,Pe=o.attributeDivisors;Ae[ae]=1,Ee[ae]===0&&(n.enableVertexAttribArray(ae),Ee[ae]=1),Pe[ae]!==he&&(n.vertexAttribDivisor(ae,he),Pe[ae]=he)}function L(){const ae=o.newAttributes,he=o.enabledAttributes;for(let Ae=0,Ee=he.length;Ae<Ee;Ae++)he[Ae]!==ae[Ae]&&(n.disableVertexAttribArray(Ae),he[Ae]=0)}function O(ae,he,Ae,Ee,Pe,ze,Re){Re===!0?n.vertexAttribIPointer(ae,he,Ae,Pe,ze):n.vertexAttribPointer(ae,he,Ae,Ee,Pe,ze)}function H(ae,he,Ae,Ee){I();const Pe=Ee.attributes,ze=Ae.getAttributes(),Re=he.defaultAttributeValues;for(const rt in ze){const ye=ze[rt];if(ye.location>=0){let We=Pe[rt];if(We===void 0&&(rt==="instanceMatrix"&&ae.instanceMatrix&&(We=ae.instanceMatrix),rt==="instanceColor"&&ae.instanceColor&&(We=ae.instanceColor)),We!==void 0){const Ue=We.normalized,gt=We.itemSize,vt=e.get(We);if(vt===void 0)continue;const Dt=vt.buffer,lt=vt.type,jt=vt.bytesPerElement,Qt=lt===n.INT||lt===n.UNSIGNED_INT||We.gpuType===ED;if(We.isInterleavedBufferAttribute){const nn=We.data,Wn=nn.stride,kn=We.offset;if(nn.isInstancedInterleavedBuffer){for(let Mn=0;Mn<ye.locationSize;Mn++)C(ye.location+Mn,nn.meshPerAttribute);ae.isInstancedMesh!==!0&&Ee._maxInstanceCount===void 0&&(Ee._maxInstanceCount=nn.meshPerAttribute*nn.count)}else for(let Mn=0;Mn<ye.locationSize;Mn++)E(ye.location+Mn);n.bindBuffer(n.ARRAY_BUFFER,Dt);for(let Mn=0;Mn<ye.locationSize;Mn++)O(ye.location+Mn,gt/ye.locationSize,lt,Ue,Wn*jt,(kn+gt/ye.locationSize*Mn)*jt,Qt)}else{if(We.isInstancedBufferAttribute){for(let nn=0;nn<ye.locationSize;nn++)C(ye.location+nn,We.meshPerAttribute);ae.isInstancedMesh!==!0&&Ee._maxInstanceCount===void 0&&(Ee._maxInstanceCount=We.meshPerAttribute*We.count)}else for(let nn=0;nn<ye.locationSize;nn++)E(ye.location+nn);n.bindBuffer(n.ARRAY_BUFFER,Dt);for(let nn=0;nn<ye.locationSize;nn++)O(ye.location+nn,gt/ye.locationSize,lt,Ue,gt*jt,gt/ye.locationSize*nn*jt,Qt)}}else if(Re!==void 0){const Ue=Re[rt];if(Ue!==void 0)switch(Ue.length){case 2:n.vertexAttrib2fv(ye.location,Ue);break;case 3:n.vertexAttrib3fv(ye.location,Ue);break;case 4:n.vertexAttrib4fv(ye.location,Ue);break;default:n.vertexAttrib1fv(ye.location,Ue)}}}}L()}function q(){re();for(const ae in r){const he=r[ae];for(const Ae in he){const Ee=he[Ae];for(const Pe in Ee)f(Ee[Pe].object),delete Ee[Pe];delete he[Ae]}delete r[ae]}}function Z(ae){if(r[ae.id]===void 0)return;const he=r[ae.id];for(const Ae in he){const Ee=he[Ae];for(const Pe in Ee)f(Ee[Pe].object),delete Ee[Pe];delete he[Ae]}delete r[ae.id]}function J(ae){for(const he in r){const Ae=r[he];if(Ae[ae.id]===void 0)continue;const Ee=Ae[ae.id];for(const Pe in Ee)f(Ee[Pe].object),delete Ee[Pe];delete Ae[ae.id]}}function re(){se(),l=!0,o!==s&&(o=s,d(o.object))}function se(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:c,reset:re,resetDefaultState:se,dispose:q,releaseStatesOfGeometry:Z,releaseStatesOfProgram:J,initAttributes:I,enableAttribute:E,disableUnusedAttributes:L}}function F1e(n,e,t){let r;function s(d){r=d}function o(d,f){n.drawArrays(r,d,f),t.update(f,r,1)}function l(d,f,m){m!==0&&(n.drawArraysInstanced(r,d,f,m),t.update(f,r,m))}function c(d,f,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,d,0,f,0,m);let x=0;for(let A=0;A<m;A++)x+=f[A];t.update(x,r,1)}function a(d,f,m,_){if(m===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let A=0;A<d.length;A++)l(d[A],f[A],_[A]);else{x.multiDrawArraysInstancedWEBGL(r,d,0,f,0,_,0,m);let A=0;for(let I=0;I<m;I++)A+=f[I];for(let I=0;I<_.length;I++)t.update(A,r,_[I])}}this.setMode=s,this.render=o,this.renderInstances=l,this.renderMultiDraw=c,this.renderMultiDrawInstances=a}function N1e(n,e,t,r){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");s=n.getParameter(Z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function l(Z){return!(Z!==Zl&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(Z){const J=Z===Bh&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Z!==tf&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&Z!==Ec&&!J)}function a(Z){if(Z==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return Z==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let d=t.precision!==void 0?t.precision:"highp";const f=a(d);f!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",f,"instead."),d=f);const m=t.logarithmicDepthBuffer===!0,_=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),x=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_TEXTURE_SIZE),I=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),E=n.getParameter(n.MAX_VERTEX_ATTRIBS),C=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),O=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),H=x>0,q=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:a,textureFormatReadable:l,textureTypeReadable:c,precision:d,logarithmicDepthBuffer:m,maxTextures:_,maxVertexTextures:x,maxTextureSize:A,maxCubemapSize:I,maxAttributes:E,maxVertexUniforms:C,maxVaryings:L,maxFragmentUniforms:O,vertexTextures:H,maxSamples:q}}function z1e(n){const e=this;let t=null,r=0,s=!1,o=!1;const l=new Lm,c=new Mi,a={value:null,needsUpdate:!1};this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(m,_){const x=m.length!==0||_||r!==0||s;return s=_,r=m.length,x},this.beginShadows=function(){o=!0,f(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(m,_){t=f(m,_,0)},this.setState=function(m,_,x){const A=m.clippingPlanes,I=m.clipIntersection,E=m.clipShadows,C=n.get(m);if(!s||A===null||A.length===0||o&&!E)o?f(null):d();else{const L=o?0:r,O=L*4;let H=C.clippingState||null;a.value=H,H=f(A,_,O,x);for(let q=0;q!==O;++q)H[q]=t[q];C.clippingState=H,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=L}};function d(){a.value!==t&&(a.value=t,a.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(m,_,x,A){const I=m!==null?m.length:0;let E=null;if(I!==0){if(E=a.value,A!==!0||E===null){const C=x+I*4,L=_.matrixWorldInverse;c.getNormalMatrix(L),(E===null||E.length<C)&&(E=new Float32Array(C));for(let O=0,H=x;O!==I;++O,H+=4)l.copy(m[O]).applyMatrix4(L,c),l.normal.toArray(E,H),E[H+3]=l.constant}a.value=E,a.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,E}}function U1e(n){let e=new WeakMap;function t(l,c){return c===fM?l.mapping=Qm:c===pM&&(l.mapping=b0),l}function r(l){if(l&&l.isTexture){const c=l.mapping;if(c===fM||c===pM)if(e.has(l)){const a=e.get(l).texture;return t(a,l.mapping)}else{const a=l.image;if(a&&a.height>0){const d=new rre(a.height);return d.fromEquirectangularTexture(n,l),e.set(l,d),l.addEventListener("dispose",s),t(d.texture,l.mapping)}else return null}}return l}function s(l){const c=l.target;c.removeEventListener("dispose",s);const a=e.get(c);a!==void 0&&(e.delete(c),a.dispose())}function o(){e=new WeakMap}return{get:r,dispose:o}}class af extends pC{constructor(e=-1,t=1,r=1,s=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=s,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,s,o,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=r-e,l=r+e,c=s+t,a=s-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=d*this.view.offsetX,l=o+d*this.view.width,c-=f*this.view.offsetY,a=c-f*this.view.height}this.projectionMatrix.makeOrthographic(o,l,c,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Rb=4,DW=[.125,.215,.35,.446,.526,.582],Cy=20,lF=new af,BW=new Hn;let cF=null,uF=0,hF=0,dF=!1;const by=(1+Math.sqrt(5))/2,O1=1/by,kW=[new Ze(-by,O1,0),new Ze(by,O1,0),new Ze(-O1,0,by),new Ze(O1,0,by),new Ze(0,by,-O1),new Ze(0,by,O1),new Ze(-1,1,-1),new Ze(1,1,-1),new Ze(-1,1,1),new Ze(1,1,1)];class sz{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,s=100){cF=this._renderer.getRenderTarget(),uF=this._renderer.getActiveCubeFace(),hF=this._renderer.getActiveMipmapLevel(),dF=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,r,s,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=NW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=FW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(cF,uF,hF),this._renderer.xr.enabled=dF,e.scissorTest=!1,x2(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Qm||e.mapping===b0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),cF=this._renderer.getRenderTarget(),uF=this._renderer.getActiveCubeFace(),hF=this._renderer.getActiveMipmapLevel(),dF=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Ro,minFilter:Ro,generateMipmaps:!1,type:Bh,format:Zl,colorSpace:$a,depthBuffer:!1},s=OW(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=OW(e,t,r);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=G1e(o)),this._blurMaterial=V1e(o,e,t)}return s}_compileMaterial(e){const t=new Di(this._lodPlanes[0],e);this._renderer.compile(t,lF)}_sceneToCubeUV(e,t,r,s){const c=new is(90,1,t,r),a=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],f=this._renderer,m=f.autoClear,_=f.toneMapping;f.getClearColor(BW),f.toneMapping=mp,f.autoClear=!1;const x=new bo({name:"PMREM.Background",side:Rc,depthWrite:!1,depthTest:!1}),A=new Di(new Mp,x);let I=!1;const E=e.background;E?E.isColor&&(x.color.copy(E),e.background=null,I=!0):(x.color.copy(BW),I=!0);for(let C=0;C<6;C++){const L=C%3;L===0?(c.up.set(0,a[C],0),c.lookAt(d[C],0,0)):L===1?(c.up.set(0,0,a[C]),c.lookAt(0,d[C],0)):(c.up.set(0,a[C],0),c.lookAt(0,0,d[C]));const O=this._cubeSize;x2(s,L*O,C>2?O:0,O,O),f.setRenderTarget(s),I&&f.render(A,c),f.render(e,c)}A.geometry.dispose(),A.material.dispose(),f.toneMapping=_,f.autoClear=m,e.background=E}_textureToCubeUV(e,t){const r=this._renderer,s=e.mapping===Qm||e.mapping===b0;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=NW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=FW());const o=s?this._cubemapMaterial:this._equirectMaterial,l=new Di(this._lodPlanes[0],o),c=o.uniforms;c.envMap.value=e;const a=this._cubeSize;x2(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(l,lF)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const l=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),c=kW[(s-o-1)%kW.length];this._blur(e,o-1,o,l,c)}t.autoClear=r}_blur(e,t,r,s,o){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,r,s,"latitudinal",o),this._halfBlur(l,e,r,r,s,"longitudinal",o)}_halfBlur(e,t,r,s,o,l,c){const a=this._renderer,d=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,m=new Di(this._lodPlanes[s],d),_=d.uniforms,x=this._sizeLods[r]-1,A=isFinite(o)?Math.PI/(2*x):2*Math.PI/(2*Cy-1),I=o/A,E=isFinite(o)?1+Math.floor(f*I):Cy;E>Cy&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${Cy}`);const C=[];let L=0;for(let J=0;J<Cy;++J){const re=J/I,se=Math.exp(-re*re/2);C.push(se),J===0?L+=se:J<E&&(L+=2*se)}for(let J=0;J<C.length;J++)C[J]=C[J]/L;_.envMap.value=e.texture,_.samples.value=E,_.weights.value=C,_.latitudinal.value=l==="latitudinal",c&&(_.poleAxis.value=c);const{_lodMax:O}=this;_.dTheta.value=A,_.mipInt.value=O-r;const H=this._sizeLods[s],q=3*H*(s>O-Rb?s-O+Rb:0),Z=4*(this._cubeSize-H);x2(t,q,Z,3*H,2*H),a.setRenderTarget(t),a.render(m,lF)}}function G1e(n){const e=[],t=[],r=[];let s=n;const o=n-Rb+1+DW.length;for(let l=0;l<o;l++){const c=Math.pow(2,s);t.push(c);let a=1/c;l>n-Rb?a=DW[l-n+Rb-1]:l===0&&(a=0),r.push(a);const d=1/(c-2),f=-d,m=1+d,_=[f,f,m,f,m,m,f,f,m,m,f,m],x=6,A=6,I=3,E=2,C=1,L=new Float32Array(I*A*x),O=new Float32Array(E*A*x),H=new Float32Array(C*A*x);for(let Z=0;Z<x;Z++){const J=Z%3*2/3-1,re=Z>2?0:-1,se=[J,re,0,J+2/3,re,0,J+2/3,re+1,0,J,re,0,J+2/3,re+1,0,J,re+1,0];L.set(se,I*A*Z),O.set(_,E*A*Z);const ae=[Z,Z,Z,Z,Z,Z];H.set(ae,C*A*Z)}const q=new Yr;q.setAttribute("position",new Ni(L,I)),q.setAttribute("uv",new Ni(O,E)),q.setAttribute("faceIndex",new Ni(H,C)),e.push(q),s>Rb&&s--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function OW(n,e,t){const r=new Ml(n,e,t);return r.texture.mapping=Fw,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function x2(n,e,t,r,s){n.viewport.set(e,t,r,s),n.scissor.set(e,t,r,s)}function V1e(n,e,t){const r=new Float32Array(Cy),s=new Ze(0,1,0);return new Lo({name:"SphericalGaussianBlur",defines:{n:Cy,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:L6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:pp,depthTest:!1,depthWrite:!1})}function FW(){return new Lo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:L6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:pp,depthTest:!1,depthWrite:!1})}function NW(){return new Lo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:L6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:pp,depthTest:!1,depthWrite:!1})}function L6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function H1e(n){let e=new WeakMap,t=null;function r(c){if(c&&c.isTexture){const a=c.mapping,d=a===fM||a===pM,f=a===Qm||a===b0;if(d||f){let m=e.get(c);const _=m!==void 0?m.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==_)return t===null&&(t=new sz(n)),m=d?t.fromEquirectangular(c,m):t.fromCubemap(c,m),m.texture.pmremVersion=c.pmremVersion,e.set(c,m),m.texture;if(m!==void 0)return m.texture;{const x=c.image;return d&&x&&x.height>0||f&&x&&s(x)?(t===null&&(t=new sz(n)),m=d?t.fromEquirectangular(c):t.fromCubemap(c),m.texture.pmremVersion=c.pmremVersion,e.set(c,m),c.addEventListener("dispose",o),m.texture):null}}}return c}function s(c){let a=0;const d=6;for(let f=0;f<d;f++)c[f]!==void 0&&a++;return a===d}function o(c){const a=c.target;a.removeEventListener("dispose",o);const d=e.get(a);d!==void 0&&(e.delete(a),d.dispose())}function l(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:l}}function j1e(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let s;switch(r){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(r)}return e[r]=s,s}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const s=t(r);return s===null&&E6("THREE.WebGLRenderer: "+r+" extension not supported."),s}}}function W1e(n,e,t,r){const s={},o=new WeakMap;function l(m){const _=m.target;_.index!==null&&e.remove(_.index);for(const A in _.attributes)e.remove(_.attributes[A]);for(const A in _.morphAttributes){const I=_.morphAttributes[A];for(let E=0,C=I.length;E<C;E++)e.remove(I[E])}_.removeEventListener("dispose",l),delete s[_.id];const x=o.get(_);x&&(e.remove(x),o.delete(_)),r.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function c(m,_){return s[_.id]===!0||(_.addEventListener("dispose",l),s[_.id]=!0,t.memory.geometries++),_}function a(m){const _=m.attributes;for(const A in _)e.update(_[A],n.ARRAY_BUFFER);const x=m.morphAttributes;for(const A in x){const I=x[A];for(let E=0,C=I.length;E<C;E++)e.update(I[E],n.ARRAY_BUFFER)}}function d(m){const _=[],x=m.index,A=m.attributes.position;let I=0;if(x!==null){const L=x.array;I=x.version;for(let O=0,H=L.length;O<H;O+=3){const q=L[O+0],Z=L[O+1],J=L[O+2];_.push(q,Z,Z,J,J,q)}}else if(A!==void 0){const L=A.array;I=A.version;for(let O=0,H=L.length/3-1;O<H;O+=3){const q=O+0,Z=O+1,J=O+2;_.push(q,Z,Z,J,J,q)}}else return;const E=new(Zne(_)?R6:P6)(_,1);E.version=I;const C=o.get(m);C&&e.remove(C),o.set(m,E)}function f(m){const _=o.get(m);if(_){const x=m.index;x!==null&&_.version<x.version&&d(m)}else d(m);return o.get(m)}return{get:c,update:a,getWireframeAttribute:f}}function $1e(n,e,t){let r;function s(_){r=_}let o,l;function c(_){o=_.type,l=_.bytesPerElement}function a(_,x){n.drawElements(r,x,o,_*l),t.update(x,r,1)}function d(_,x,A){A!==0&&(n.drawElementsInstanced(r,x,o,_*l,A),t.update(x,r,A))}function f(_,x,A){if(A===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,x,0,o,_,0,A);let E=0;for(let C=0;C<A;C++)E+=x[C];t.update(E,r,1)}function m(_,x,A,I){if(A===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let C=0;C<_.length;C++)d(_[C]/l,x[C],I[C]);else{E.multiDrawElementsInstancedWEBGL(r,x,0,o,_,0,I,0,A);let C=0;for(let L=0;L<A;L++)C+=x[L];for(let L=0;L<I.length;L++)t.update(C,r,I[L])}}this.setMode=s,this.setIndex=c,this.render=a,this.renderInstances=d,this.renderMultiDraw=f,this.renderMultiDrawInstances=m}function X1e(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(o,l,c){switch(t.calls++,l){case n.TRIANGLES:t.triangles+=c*(o/3);break;case n.LINES:t.lines+=c*(o/2);break;case n.LINE_STRIP:t.lines+=c*(o-1);break;case n.LINE_LOOP:t.lines+=c*o;break;case n.POINTS:t.points+=c*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:r}}function q1e(n,e,t){const r=new WeakMap,s=new Ls;function o(l,c,a){const d=l.morphTargetInfluences,f=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,m=f!==void 0?f.length:0;let _=r.get(c);if(_===void 0||_.count!==m){let ae=function(){re.dispose(),r.delete(c),c.removeEventListener("dispose",ae)};var x=ae;_!==void 0&&_.texture.dispose();const A=c.morphAttributes.position!==void 0,I=c.morphAttributes.normal!==void 0,E=c.morphAttributes.color!==void 0,C=c.morphAttributes.position||[],L=c.morphAttributes.normal||[],O=c.morphAttributes.color||[];let H=0;A===!0&&(H=1),I===!0&&(H=2),E===!0&&(H=3);let q=c.attributes.position.count*H,Z=1;q>e.maxTextureSize&&(Z=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const J=new Float32Array(q*Z*4*m),re=new kD(J,q,Z,m);re.type=Ec,re.needsUpdate=!0;const se=H*4;for(let he=0;he<m;he++){const Ae=C[he],Ee=L[he],Pe=O[he],ze=q*Z*4*he;for(let Re=0;Re<Ae.count;Re++){const rt=Re*se;A===!0&&(s.fromBufferAttribute(Ae,Re),J[ze+rt+0]=s.x,J[ze+rt+1]=s.y,J[ze+rt+2]=s.z,J[ze+rt+3]=0),I===!0&&(s.fromBufferAttribute(Ee,Re),J[ze+rt+4]=s.x,J[ze+rt+5]=s.y,J[ze+rt+6]=s.z,J[ze+rt+7]=0),E===!0&&(s.fromBufferAttribute(Pe,Re),J[ze+rt+8]=s.x,J[ze+rt+9]=s.y,J[ze+rt+10]=s.z,J[ze+rt+11]=Pe.itemSize===4?s.w:1)}}_={count:m,texture:re,size:new sn(q,Z)},r.set(c,_),c.addEventListener("dispose",ae)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)a.getUniforms().setValue(n,"morphTexture",l.morphTexture,t);else{let A=0;for(let E=0;E<d.length;E++)A+=d[E];const I=c.morphTargetsRelative?1:1-A;a.getUniforms().setValue(n,"morphTargetBaseInfluence",I),a.getUniforms().setValue(n,"morphTargetInfluences",d)}a.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),a.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}return{update:o}}function Y1e(n,e,t,r){let s=new WeakMap;function o(a){const d=r.render.frame,f=a.geometry,m=e.get(a,f);if(s.get(m)!==d&&(e.update(m),s.set(m,d)),a.isInstancedMesh&&(a.hasEventListener("dispose",c)===!1&&a.addEventListener("dispose",c),s.get(a)!==d&&(t.update(a.instanceMatrix,n.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,n.ARRAY_BUFFER),s.set(a,d))),a.isSkinnedMesh){const _=a.skeleton;s.get(_)!==d&&(_.update(),s.set(_,d))}return m}function l(){s=new WeakMap}function c(a){const d=a.target;d.removeEventListener("dispose",c),t.remove(d.instanceMatrix),d.instanceColor!==null&&t.remove(d.instanceColor)}return{update:o,dispose:l}}class D6 extends Ys{constructor(e,t,r,s,o,l,c,a,d,f=Yy){if(f!==Yy&&f!==dx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&f===Yy&&(r=eg),r===void 0&&f===dx&&(r=hx),super(null,s,o,l,c,a,f,r,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Ma,this.minFilter=a!==void 0?a:Ma,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const sre=new Ys,zW=new D6(1,1),ore=new kD,are=new I6,lre=new mC,UW=[],GW=[],VW=new Float32Array(16),HW=new Float32Array(9),jW=new Float32Array(4);function Nw(n,e,t){const r=n[0];if(r<=0||r>0)return n;const s=e*t;let o=UW[s];if(o===void 0&&(o=new Float32Array(s),UW[s]=o),e!==0){r.toArray(o,0);for(let l=1,c=0;l!==e;++l)c+=t,n[l].toArray(o,c)}return o}function Xa(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function qa(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function OD(n,e){let t=GW[e];t===void 0&&(t=new Int32Array(e),GW[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function Z1e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function K1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xa(t,e))return;n.uniform2fv(this.addr,e),qa(t,e)}}function J1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Xa(t,e))return;n.uniform3fv(this.addr,e),qa(t,e)}}function Q1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xa(t,e))return;n.uniform4fv(this.addr,e),qa(t,e)}}function ebe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Xa(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),qa(t,e)}else{if(Xa(t,r))return;jW.set(r),n.uniformMatrix2fv(this.addr,!1,jW),qa(t,r)}}function tbe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Xa(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),qa(t,e)}else{if(Xa(t,r))return;HW.set(r),n.uniformMatrix3fv(this.addr,!1,HW),qa(t,r)}}function nbe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Xa(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),qa(t,e)}else{if(Xa(t,r))return;VW.set(r),n.uniformMatrix4fv(this.addr,!1,VW),qa(t,r)}}function rbe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function ibe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xa(t,e))return;n.uniform2iv(this.addr,e),qa(t,e)}}function sbe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Xa(t,e))return;n.uniform3iv(this.addr,e),qa(t,e)}}function obe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xa(t,e))return;n.uniform4iv(this.addr,e),qa(t,e)}}function abe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function lbe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xa(t,e))return;n.uniform2uiv(this.addr,e),qa(t,e)}}function cbe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Xa(t,e))return;n.uniform3uiv(this.addr,e),qa(t,e)}}function ube(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xa(t,e))return;n.uniform4uiv(this.addr,e),qa(t,e)}}function hbe(n,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(n.uniform1i(this.addr,s),r[0]=s);let o;this.type===n.SAMPLER_2D_SHADOW?(zW.compareFunction=M6,o=zW):o=sre,t.setTexture2D(e||o,s)}function dbe(n,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(n.uniform1i(this.addr,s),r[0]=s),t.setTexture3D(e||are,s)}function fbe(n,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(n.uniform1i(this.addr,s),r[0]=s),t.setTextureCube(e||lre,s)}function pbe(n,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(n.uniform1i(this.addr,s),r[0]=s),t.setTexture2DArray(e||ore,s)}function mbe(n){switch(n){case 5126:return Z1e;case 35664:return K1e;case 35665:return J1e;case 35666:return Q1e;case 35674:return ebe;case 35675:return tbe;case 35676:return nbe;case 5124:case 35670:return rbe;case 35667:case 35671:return ibe;case 35668:case 35672:return sbe;case 35669:case 35673:return obe;case 5125:return abe;case 36294:return lbe;case 36295:return cbe;case 36296:return ube;case 35678:case 36198:case 36298:case 36306:case 35682:return hbe;case 35679:case 36299:case 36307:return dbe;case 35680:case 36300:case 36308:case 36293:return fbe;case 36289:case 36303:case 36311:case 36292:return pbe}}function gbe(n,e){n.uniform1fv(this.addr,e)}function vbe(n,e){const t=Nw(e,this.size,2);n.uniform2fv(this.addr,t)}function _be(n,e){const t=Nw(e,this.size,3);n.uniform3fv(this.addr,t)}function ybe(n,e){const t=Nw(e,this.size,4);n.uniform4fv(this.addr,t)}function xbe(n,e){const t=Nw(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function bbe(n,e){const t=Nw(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function wbe(n,e){const t=Nw(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Sbe(n,e){n.uniform1iv(this.addr,e)}function Abe(n,e){n.uniform2iv(this.addr,e)}function Tbe(n,e){n.uniform3iv(this.addr,e)}function Mbe(n,e){n.uniform4iv(this.addr,e)}function Cbe(n,e){n.uniform1uiv(this.addr,e)}function Ebe(n,e){n.uniform2uiv(this.addr,e)}function Ibe(n,e){n.uniform3uiv(this.addr,e)}function Pbe(n,e){n.uniform4uiv(this.addr,e)}function Rbe(n,e,t){const r=this.cache,s=e.length,o=OD(t,s);Xa(r,o)||(n.uniform1iv(this.addr,o),qa(r,o));for(let l=0;l!==s;++l)t.setTexture2D(e[l]||sre,o[l])}function Lbe(n,e,t){const r=this.cache,s=e.length,o=OD(t,s);Xa(r,o)||(n.uniform1iv(this.addr,o),qa(r,o));for(let l=0;l!==s;++l)t.setTexture3D(e[l]||are,o[l])}function Dbe(n,e,t){const r=this.cache,s=e.length,o=OD(t,s);Xa(r,o)||(n.uniform1iv(this.addr,o),qa(r,o));for(let l=0;l!==s;++l)t.setTextureCube(e[l]||lre,o[l])}function Bbe(n,e,t){const r=this.cache,s=e.length,o=OD(t,s);Xa(r,o)||(n.uniform1iv(this.addr,o),qa(r,o));for(let l=0;l!==s;++l)t.setTexture2DArray(e[l]||ore,o[l])}function kbe(n){switch(n){case 5126:return gbe;case 35664:return vbe;case 35665:return _be;case 35666:return ybe;case 35674:return xbe;case 35675:return bbe;case 35676:return wbe;case 5124:case 35670:return Sbe;case 35667:case 35671:return Abe;case 35668:case 35672:return Tbe;case 35669:case 35673:return Mbe;case 5125:return Cbe;case 36294:return Ebe;case 36295:return Ibe;case 36296:return Pbe;case 35678:case 36198:case 36298:case 36306:case 35682:return Rbe;case 35679:case 36299:case 36307:return Lbe;case 35680:case 36300:case 36308:case 36293:return Dbe;case 36289:case 36303:case 36311:case 36292:return Bbe}}class Obe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=mbe(t.type)}}class Fbe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=kbe(t.type)}}class Nbe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const s=this.seq;for(let o=0,l=s.length;o!==l;++o){const c=s[o];c.setValue(e,t[c.id],r)}}}const fF=/(\w+)(\])?(\[|\.)?/g;function WW(n,e){n.seq.push(e),n.map[e.id]=e}function zbe(n,e,t){const r=n.name,s=r.length;for(fF.lastIndex=0;;){const o=fF.exec(r),l=fF.lastIndex;let c=o[1];const a=o[2]==="]",d=o[3];if(a&&(c=c|0),d===void 0||d==="["&&l+2===s){WW(t,d===void 0?new Obe(c,n,e):new Fbe(c,n,e));break}else{let m=t.map[c];m===void 0&&(m=new Nbe(c),WW(t,m)),t=m}}}class yP{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){const o=e.getActiveUniform(t,s),l=e.getUniformLocation(t,o.name);zbe(o,l,this)}}setValue(e,t,r,s){const o=this.map[t];o!==void 0&&o.setValue(e,r,s)}setOptional(e,t,r){const s=t[r];s!==void 0&&this.setValue(e,r,s)}static upload(e,t,r,s){for(let o=0,l=t.length;o!==l;++o){const c=t[o],a=r[c.id];a.needsUpdate!==!1&&c.setValue(e,a.value,s)}}static seqWithValue(e,t){const r=[];for(let s=0,o=e.length;s!==o;++s){const l=e[s];l.id in t&&r.push(l)}return r}}function $W(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const Ube=37297;let Gbe=0;function Vbe(n,e){const t=n.split(`
`),r=[],s=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let l=s;l<o;l++){const c=l+1;r.push(`${c===e?">":" "} ${c}: ${t[l]}`)}return r.join(`
`)}function Hbe(n){const e=_s.getPrimaries(_s.workingColorSpace),t=_s.getPrimaries(n);let r;switch(e===t?r="":e===_M&&t===vM?r="LinearDisplayP3ToLinearSRGB":e===vM&&t===_M&&(r="LinearSRGBToLinearDisplayP3"),n){case $a:case fC:return[r,"LinearTransferOETF"];case Eo:case BD:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function XW(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const l=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+Vbe(n.getShaderSource(e),l)}else return s}function jbe(n,e){const t=Hbe(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Wbe(n,e){let t;switch(e){case Rne:t="Linear";break;case Lne:t="Reinhard";break;case TD:t="OptimizedCineon";break;case MD:t="ACESFilmic";break;case Bne:t="AgX";break;case kne:t="Neutral";break;case Dne:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function $be(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(HA).join(`
`)}function Xbe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function qbe(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const o=n.getActiveAttrib(e,s),l=o.name;let c=1;o.type===n.FLOAT_MAT2&&(c=2),o.type===n.FLOAT_MAT3&&(c=3),o.type===n.FLOAT_MAT4&&(c=4),t[l]={type:o.type,location:n.getAttribLocation(e,l),locationSize:c}}return t}function HA(n){return n!==""}function qW(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function YW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ybe=/^[ \t]*#include +<([\w\d./]+)>/gm;function oz(n){return n.replace(Ybe,Kbe)}const Zbe=new Map;function Kbe(n,e){let t=Pi[e];if(t===void 0){const r=Zbe.get(e);if(r!==void 0)t=Pi[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return oz(t)}const Jbe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ZW(n){return n.replace(Jbe,Qbe)}function Qbe(n,e,t,r){let s="";for(let o=parseInt(e);o<parseInt(t);o++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function KW(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function ewe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===AD?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===fT?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Gd&&(e="SHADOWMAP_TYPE_VSM"),e}function twe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Qm:case b0:e="ENVMAP_TYPE_CUBE";break;case Fw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function nwe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case b0:e="ENVMAP_MODE_REFRACTION";break}return e}function rwe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case lC:e="ENVMAP_BLENDING_MULTIPLY";break;case Ine:e="ENVMAP_BLENDING_MIX";break;case Pne:e="ENVMAP_BLENDING_ADD";break}return e}function iwe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function swe(n,e,t,r){const s=n.getContext(),o=t.defines;let l=t.vertexShader,c=t.fragmentShader;const a=ewe(t),d=twe(t),f=nwe(t),m=rwe(t),_=iwe(t),x=$be(t),A=Xbe(o),I=s.createProgram();let E,C,L=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(HA).join(`
`),E.length>0&&(E+=`
`),C=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(HA).join(`
`),C.length>0&&(C+=`
`)):(E=[KW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(HA).join(`
`),C=[KW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==mp?"#define TONE_MAPPING":"",t.toneMapping!==mp?Pi.tonemapping_pars_fragment:"",t.toneMapping!==mp?Wbe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pi.colorspace_pars_fragment,jbe("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(HA).join(`
`)),l=oz(l),l=qW(l,t),l=YW(l,t),c=oz(c),c=qW(c,t),c=YW(c,t),l=ZW(l),c=ZW(c),t.isRawShaderMaterial!==!0&&(L=`#version 300 es
`,E=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,C=["#define varying in",t.glslVersion===iz?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===iz?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+C);const O=L+E+l,H=L+C+c,q=$W(s,s.VERTEX_SHADER,O),Z=$W(s,s.FRAGMENT_SHADER,H);s.attachShader(I,q),s.attachShader(I,Z),t.index0AttributeName!==void 0?s.bindAttribLocation(I,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(I,0,"position"),s.linkProgram(I);function J(he){if(n.debug.checkShaderErrors){const Ae=s.getProgramInfoLog(I).trim(),Ee=s.getShaderInfoLog(q).trim(),Pe=s.getShaderInfoLog(Z).trim();let ze=!0,Re=!0;if(s.getProgramParameter(I,s.LINK_STATUS)===!1)if(ze=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,I,q,Z);else{const rt=XW(s,q,"vertex"),ye=XW(s,Z,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(I,s.VALIDATE_STATUS)+`

Material Name: `+he.name+`
Material Type: `+he.type+`

Program Info Log: `+Ae+`
`+rt+`
`+ye)}else Ae!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ae):(Ee===""||Pe==="")&&(Re=!1);Re&&(he.diagnostics={runnable:ze,programLog:Ae,vertexShader:{log:Ee,prefix:E},fragmentShader:{log:Pe,prefix:C}})}s.deleteShader(q),s.deleteShader(Z),re=new yP(s,I),se=qbe(s,I)}let re;this.getUniforms=function(){return re===void 0&&J(this),re};let se;this.getAttributes=function(){return se===void 0&&J(this),se};let ae=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ae===!1&&(ae=s.getProgramParameter(I,Ube)),ae},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram(I),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Gbe++,this.cacheKey=e,this.usedTimes=1,this.program=I,this.vertexShader=q,this.fragmentShader=Z,this}let owe=0;class awe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,s=this._getShaderStage(t),o=this._getShaderStage(r),l=this._getShaderCacheForMaterial(e);return l.has(s)===!1&&(l.add(s),s.usedTimes++),l.has(o)===!1&&(l.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new lwe(e),t.set(e,r)),r}}class lwe{constructor(e){this.id=owe++,this.code=e,this.usedTimes=0}}function cwe(n,e,t,r,s,o,l){const c=new Ky,a=new awe,d=new Set,f=[],m=s.logarithmicDepthBuffer,_=s.vertexTextures;let x=s.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function I(se){return d.add(se),se===0?"uv":`uv${se}`}function E(se,ae,he,Ae,Ee){const Pe=Ae.fog,ze=Ee.geometry,Re=se.isMeshStandardMaterial?Ae.environment:null,rt=(se.isMeshStandardMaterial?t:e).get(se.envMap||Re),ye=rt&&rt.mapping===Fw?rt.image.height:null,We=A[se.type];se.precision!==null&&(x=s.getMaxPrecision(se.precision),x!==se.precision&&console.warn("THREE.WebGLProgram.getParameters:",se.precision,"not supported, using",x,"instead."));const Ue=ze.morphAttributes.position||ze.morphAttributes.normal||ze.morphAttributes.color,gt=Ue!==void 0?Ue.length:0;let vt=0;ze.morphAttributes.position!==void 0&&(vt=1),ze.morphAttributes.normal!==void 0&&(vt=2),ze.morphAttributes.color!==void 0&&(vt=3);let Dt,lt,jt,Qt;if(We){const fi=Wd[We];Dt=fi.vertexShader,lt=fi.fragmentShader}else Dt=se.vertexShader,lt=se.fragmentShader,a.update(se),jt=a.getVertexShaderID(se),Qt=a.getFragmentShaderID(se);const nn=n.getRenderTarget(),Wn=Ee.isInstancedMesh===!0,kn=Ee.isBatchedMesh===!0,Mn=!!se.map,De=!!se.matcap,Ye=!!rt,gn=!!se.aoMap,un=!!se.lightMap,At=!!se.bumpMap,en=!!se.normalMap,On=!!se.displacementMap,Vn=!!se.emissiveMap,on=!!se.metalnessMap,ct=!!se.roughnessMap,He=se.anisotropy>0,qt=se.clearcoat>0,Tn=se.dispersion>0,An=se.iridescence>0,Wt=se.sheen>0,gr=se.transmission>0,Gn=He&&!!se.anisotropyMap,nr=qt&&!!se.clearcoatMap,Ar=qt&&!!se.clearcoatNormalMap,Dn=qt&&!!se.clearcoatRoughnessMap,sr=An&&!!se.iridescenceMap,di=An&&!!se.iridescenceThicknessMap,zr=Wt&&!!se.sheenColorMap,ar=Wt&&!!se.sheenRoughnessMap,Ur=!!se.specularMap,Wr=!!se.specularColorMap,Si=!!se.specularIntensityMap,Ne=gr&&!!se.transmissionMap,Bt=gr&&!!se.thicknessMap,Jt=!!se.gradientMap,hn=!!se.alphaMap,In=se.alphaTest>0,Tr=!!se.alphaHash,jr=!!se.extensions;let ps=mp;se.toneMapped&&(nn===null||nn.isXRRenderTarget===!0)&&(ps=n.toneMapping);const Bs={shaderID:We,shaderType:se.type,shaderName:se.name,vertexShader:Dt,fragmentShader:lt,defines:se.defines,customVertexShaderID:jt,customFragmentShaderID:Qt,isRawShaderMaterial:se.isRawShaderMaterial===!0,glslVersion:se.glslVersion,precision:x,batching:kn,batchingColor:kn&&Ee._colorsTexture!==null,instancing:Wn,instancingColor:Wn&&Ee.instanceColor!==null,instancingMorph:Wn&&Ee.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:nn===null?n.outputColorSpace:nn.isXRRenderTarget===!0?nn.texture.colorSpace:$a,alphaToCoverage:!!se.alphaToCoverage,map:Mn,matcap:De,envMap:Ye,envMapMode:Ye&&rt.mapping,envMapCubeUVHeight:ye,aoMap:gn,lightMap:un,bumpMap:At,normalMap:en,displacementMap:_&&On,emissiveMap:Vn,normalMapObjectSpace:en&&se.normalMapType===Vne,normalMapTangentSpace:en&&se.normalMapType===U0,metalnessMap:on,roughnessMap:ct,anisotropy:He,anisotropyMap:Gn,clearcoat:qt,clearcoatMap:nr,clearcoatNormalMap:Ar,clearcoatRoughnessMap:Dn,dispersion:Tn,iridescence:An,iridescenceMap:sr,iridescenceThicknessMap:di,sheen:Wt,sheenColorMap:zr,sheenRoughnessMap:ar,specularMap:Ur,specularColorMap:Wr,specularIntensityMap:Si,transmission:gr,transmissionMap:Ne,thicknessMap:Bt,gradientMap:Jt,opaque:se.transparent===!1&&se.blending===Xy&&se.alphaToCoverage===!1,alphaMap:hn,alphaTest:In,alphaHash:Tr,combine:se.combine,mapUv:Mn&&I(se.map.channel),aoMapUv:gn&&I(se.aoMap.channel),lightMapUv:un&&I(se.lightMap.channel),bumpMapUv:At&&I(se.bumpMap.channel),normalMapUv:en&&I(se.normalMap.channel),displacementMapUv:On&&I(se.displacementMap.channel),emissiveMapUv:Vn&&I(se.emissiveMap.channel),metalnessMapUv:on&&I(se.metalnessMap.channel),roughnessMapUv:ct&&I(se.roughnessMap.channel),anisotropyMapUv:Gn&&I(se.anisotropyMap.channel),clearcoatMapUv:nr&&I(se.clearcoatMap.channel),clearcoatNormalMapUv:Ar&&I(se.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Dn&&I(se.clearcoatRoughnessMap.channel),iridescenceMapUv:sr&&I(se.iridescenceMap.channel),iridescenceThicknessMapUv:di&&I(se.iridescenceThicknessMap.channel),sheenColorMapUv:zr&&I(se.sheenColorMap.channel),sheenRoughnessMapUv:ar&&I(se.sheenRoughnessMap.channel),specularMapUv:Ur&&I(se.specularMap.channel),specularColorMapUv:Wr&&I(se.specularColorMap.channel),specularIntensityMapUv:Si&&I(se.specularIntensityMap.channel),transmissionMapUv:Ne&&I(se.transmissionMap.channel),thicknessMapUv:Bt&&I(se.thicknessMap.channel),alphaMapUv:hn&&I(se.alphaMap.channel),vertexTangents:!!ze.attributes.tangent&&(en||He),vertexColors:se.vertexColors,vertexAlphas:se.vertexColors===!0&&!!ze.attributes.color&&ze.attributes.color.itemSize===4,pointsUvs:Ee.isPoints===!0&&!!ze.attributes.uv&&(Mn||hn),fog:!!Pe,useFog:se.fog===!0,fogExp2:!!Pe&&Pe.isFogExp2,flatShading:se.flatShading===!0,sizeAttenuation:se.sizeAttenuation===!0,logarithmicDepthBuffer:m,skinning:Ee.isSkinnedMesh===!0,morphTargets:ze.morphAttributes.position!==void 0,morphNormals:ze.morphAttributes.normal!==void 0,morphColors:ze.morphAttributes.color!==void 0,morphTargetsCount:gt,morphTextureStride:vt,numDirLights:ae.directional.length,numPointLights:ae.point.length,numSpotLights:ae.spot.length,numSpotLightMaps:ae.spotLightMap.length,numRectAreaLights:ae.rectArea.length,numHemiLights:ae.hemi.length,numDirLightShadows:ae.directionalShadowMap.length,numPointLightShadows:ae.pointShadowMap.length,numSpotLightShadows:ae.spotShadowMap.length,numSpotLightShadowsWithMaps:ae.numSpotLightShadowsWithMaps,numLightProbes:ae.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:se.dithering,shadowMapEnabled:n.shadowMap.enabled&&he.length>0,shadowMapType:n.shadowMap.type,toneMapping:ps,decodeVideoTexture:Mn&&se.map.isVideoTexture===!0&&_s.getTransfer(se.map.colorSpace)===io,premultipliedAlpha:se.premultipliedAlpha,doubleSided:se.side===Mc,flipSided:se.side===Rc,useDepthPacking:se.depthPacking>=0,depthPacking:se.depthPacking||0,index0AttributeName:se.index0AttributeName,extensionClipCullDistance:jr&&se.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(jr&&se.extensions.multiDraw===!0||kn)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:se.customProgramCacheKey()};return Bs.vertexUv1s=d.has(1),Bs.vertexUv2s=d.has(2),Bs.vertexUv3s=d.has(3),d.clear(),Bs}function C(se){const ae=[];if(se.shaderID?ae.push(se.shaderID):(ae.push(se.customVertexShaderID),ae.push(se.customFragmentShaderID)),se.defines!==void 0)for(const he in se.defines)ae.push(he),ae.push(se.defines[he]);return se.isRawShaderMaterial===!1&&(L(ae,se),O(ae,se),ae.push(n.outputColorSpace)),ae.push(se.customProgramCacheKey),ae.join()}function L(se,ae){se.push(ae.precision),se.push(ae.outputColorSpace),se.push(ae.envMapMode),se.push(ae.envMapCubeUVHeight),se.push(ae.mapUv),se.push(ae.alphaMapUv),se.push(ae.lightMapUv),se.push(ae.aoMapUv),se.push(ae.bumpMapUv),se.push(ae.normalMapUv),se.push(ae.displacementMapUv),se.push(ae.emissiveMapUv),se.push(ae.metalnessMapUv),se.push(ae.roughnessMapUv),se.push(ae.anisotropyMapUv),se.push(ae.clearcoatMapUv),se.push(ae.clearcoatNormalMapUv),se.push(ae.clearcoatRoughnessMapUv),se.push(ae.iridescenceMapUv),se.push(ae.iridescenceThicknessMapUv),se.push(ae.sheenColorMapUv),se.push(ae.sheenRoughnessMapUv),se.push(ae.specularMapUv),se.push(ae.specularColorMapUv),se.push(ae.specularIntensityMapUv),se.push(ae.transmissionMapUv),se.push(ae.thicknessMapUv),se.push(ae.combine),se.push(ae.fogExp2),se.push(ae.sizeAttenuation),se.push(ae.morphTargetsCount),se.push(ae.morphAttributeCount),se.push(ae.numDirLights),se.push(ae.numPointLights),se.push(ae.numSpotLights),se.push(ae.numSpotLightMaps),se.push(ae.numHemiLights),se.push(ae.numRectAreaLights),se.push(ae.numDirLightShadows),se.push(ae.numPointLightShadows),se.push(ae.numSpotLightShadows),se.push(ae.numSpotLightShadowsWithMaps),se.push(ae.numLightProbes),se.push(ae.shadowMapType),se.push(ae.toneMapping),se.push(ae.numClippingPlanes),se.push(ae.numClipIntersection),se.push(ae.depthPacking)}function O(se,ae){c.disableAll(),ae.supportsVertexTextures&&c.enable(0),ae.instancing&&c.enable(1),ae.instancingColor&&c.enable(2),ae.instancingMorph&&c.enable(3),ae.matcap&&c.enable(4),ae.envMap&&c.enable(5),ae.normalMapObjectSpace&&c.enable(6),ae.normalMapTangentSpace&&c.enable(7),ae.clearcoat&&c.enable(8),ae.iridescence&&c.enable(9),ae.alphaTest&&c.enable(10),ae.vertexColors&&c.enable(11),ae.vertexAlphas&&c.enable(12),ae.vertexUv1s&&c.enable(13),ae.vertexUv2s&&c.enable(14),ae.vertexUv3s&&c.enable(15),ae.vertexTangents&&c.enable(16),ae.anisotropy&&c.enable(17),ae.alphaHash&&c.enable(18),ae.batching&&c.enable(19),ae.dispersion&&c.enable(20),ae.batchingColor&&c.enable(21),se.push(c.mask),c.disableAll(),ae.fog&&c.enable(0),ae.useFog&&c.enable(1),ae.flatShading&&c.enable(2),ae.logarithmicDepthBuffer&&c.enable(3),ae.skinning&&c.enable(4),ae.morphTargets&&c.enable(5),ae.morphNormals&&c.enable(6),ae.morphColors&&c.enable(7),ae.premultipliedAlpha&&c.enable(8),ae.shadowMapEnabled&&c.enable(9),ae.doubleSided&&c.enable(10),ae.flipSided&&c.enable(11),ae.useDepthPacking&&c.enable(12),ae.dithering&&c.enable(13),ae.transmission&&c.enable(14),ae.sheen&&c.enable(15),ae.opaque&&c.enable(16),ae.pointsUvs&&c.enable(17),ae.decodeVideoTexture&&c.enable(18),ae.alphaToCoverage&&c.enable(19),se.push(c.mask)}function H(se){const ae=A[se.type];let he;if(ae){const Ae=Wd[ae];he=tg.clone(Ae.uniforms)}else he=se.uniforms;return he}function q(se,ae){let he;for(let Ae=0,Ee=f.length;Ae<Ee;Ae++){const Pe=f[Ae];if(Pe.cacheKey===ae){he=Pe,++he.usedTimes;break}}return he===void 0&&(he=new swe(n,ae,se,o),f.push(he)),he}function Z(se){if(--se.usedTimes===0){const ae=f.indexOf(se);f[ae]=f[f.length-1],f.pop(),se.destroy()}}function J(se){a.remove(se)}function re(){a.dispose()}return{getParameters:E,getProgramCacheKey:C,getUniforms:H,acquireProgram:q,releaseProgram:Z,releaseShaderCache:J,programs:f,dispose:re}}function uwe(){let n=new WeakMap;function e(o){let l=n.get(o);return l===void 0&&(l={},n.set(o,l)),l}function t(o){n.delete(o)}function r(o,l,c){n.get(o)[l]=c}function s(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:s}}function hwe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function JW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function QW(){const n=[];let e=0;const t=[],r=[],s=[];function o(){e=0,t.length=0,r.length=0,s.length=0}function l(m,_,x,A,I,E){let C=n[e];return C===void 0?(C={id:m.id,object:m,geometry:_,material:x,groupOrder:A,renderOrder:m.renderOrder,z:I,group:E},n[e]=C):(C.id=m.id,C.object=m,C.geometry=_,C.material=x,C.groupOrder=A,C.renderOrder=m.renderOrder,C.z=I,C.group=E),e++,C}function c(m,_,x,A,I,E){const C=l(m,_,x,A,I,E);x.transmission>0?r.push(C):x.transparent===!0?s.push(C):t.push(C)}function a(m,_,x,A,I,E){const C=l(m,_,x,A,I,E);x.transmission>0?r.unshift(C):x.transparent===!0?s.unshift(C):t.unshift(C)}function d(m,_){t.length>1&&t.sort(m||hwe),r.length>1&&r.sort(_||JW),s.length>1&&s.sort(_||JW)}function f(){for(let m=e,_=n.length;m<_;m++){const x=n[m];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:r,transparent:s,init:o,push:c,unshift:a,finish:f,sort:d}}function dwe(){let n=new WeakMap;function e(r,s){const o=n.get(r);let l;return o===void 0?(l=new QW,n.set(r,[l])):s>=o.length?(l=new QW,o.push(l)):l=o[s],l}function t(){n=new WeakMap}return{get:e,dispose:t}}function fwe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ze,color:new Hn};break;case"SpotLight":t={position:new Ze,direction:new Ze,color:new Hn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ze,color:new Hn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ze,skyColor:new Hn,groundColor:new Hn};break;case"RectAreaLight":t={color:new Hn,position:new Ze,halfWidth:new Ze,halfHeight:new Ze};break}return n[e.id]=t,t}}}function pwe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let mwe=0;function gwe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function vwe(n){const e=new fwe,t=pwe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new Ze);const s=new Ze,o=new Hr,l=new Hr;function c(d){let f=0,m=0,_=0;for(let se=0;se<9;se++)r.probe[se].set(0,0,0);let x=0,A=0,I=0,E=0,C=0,L=0,O=0,H=0,q=0,Z=0,J=0;d.sort(gwe);for(let se=0,ae=d.length;se<ae;se++){const he=d[se],Ae=he.color,Ee=he.intensity,Pe=he.distance,ze=he.shadow&&he.shadow.map?he.shadow.map.texture:null;if(he.isAmbientLight)f+=Ae.r*Ee,m+=Ae.g*Ee,_+=Ae.b*Ee;else if(he.isLightProbe){for(let Re=0;Re<9;Re++)r.probe[Re].addScaledVector(he.sh.coefficients[Re],Ee);J++}else if(he.isDirectionalLight){const Re=e.get(he);if(Re.color.copy(he.color).multiplyScalar(he.intensity),he.castShadow){const rt=he.shadow,ye=t.get(he);ye.shadowIntensity=rt.intensity,ye.shadowBias=rt.bias,ye.shadowNormalBias=rt.normalBias,ye.shadowRadius=rt.radius,ye.shadowMapSize=rt.mapSize,r.directionalShadow[x]=ye,r.directionalShadowMap[x]=ze,r.directionalShadowMatrix[x]=he.shadow.matrix,L++}r.directional[x]=Re,x++}else if(he.isSpotLight){const Re=e.get(he);Re.position.setFromMatrixPosition(he.matrixWorld),Re.color.copy(Ae).multiplyScalar(Ee),Re.distance=Pe,Re.coneCos=Math.cos(he.angle),Re.penumbraCos=Math.cos(he.angle*(1-he.penumbra)),Re.decay=he.decay,r.spot[I]=Re;const rt=he.shadow;if(he.map&&(r.spotLightMap[q]=he.map,q++,rt.updateMatrices(he),he.castShadow&&Z++),r.spotLightMatrix[I]=rt.matrix,he.castShadow){const ye=t.get(he);ye.shadowIntensity=rt.intensity,ye.shadowBias=rt.bias,ye.shadowNormalBias=rt.normalBias,ye.shadowRadius=rt.radius,ye.shadowMapSize=rt.mapSize,r.spotShadow[I]=ye,r.spotShadowMap[I]=ze,H++}I++}else if(he.isRectAreaLight){const Re=e.get(he);Re.color.copy(Ae).multiplyScalar(Ee),Re.halfWidth.set(he.width*.5,0,0),Re.halfHeight.set(0,he.height*.5,0),r.rectArea[E]=Re,E++}else if(he.isPointLight){const Re=e.get(he);if(Re.color.copy(he.color).multiplyScalar(he.intensity),Re.distance=he.distance,Re.decay=he.decay,he.castShadow){const rt=he.shadow,ye=t.get(he);ye.shadowIntensity=rt.intensity,ye.shadowBias=rt.bias,ye.shadowNormalBias=rt.normalBias,ye.shadowRadius=rt.radius,ye.shadowMapSize=rt.mapSize,ye.shadowCameraNear=rt.camera.near,ye.shadowCameraFar=rt.camera.far,r.pointShadow[A]=ye,r.pointShadowMap[A]=ze,r.pointShadowMatrix[A]=he.shadow.matrix,O++}r.point[A]=Re,A++}else if(he.isHemisphereLight){const Re=e.get(he);Re.skyColor.copy(he.color).multiplyScalar(Ee),Re.groundColor.copy(he.groundColor).multiplyScalar(Ee),r.hemi[C]=Re,C++}}E>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=dr.LTC_FLOAT_1,r.rectAreaLTC2=dr.LTC_FLOAT_2):(r.rectAreaLTC1=dr.LTC_HALF_1,r.rectAreaLTC2=dr.LTC_HALF_2)),r.ambient[0]=f,r.ambient[1]=m,r.ambient[2]=_;const re=r.hash;(re.directionalLength!==x||re.pointLength!==A||re.spotLength!==I||re.rectAreaLength!==E||re.hemiLength!==C||re.numDirectionalShadows!==L||re.numPointShadows!==O||re.numSpotShadows!==H||re.numSpotMaps!==q||re.numLightProbes!==J)&&(r.directional.length=x,r.spot.length=I,r.rectArea.length=E,r.point.length=A,r.hemi.length=C,r.directionalShadow.length=L,r.directionalShadowMap.length=L,r.pointShadow.length=O,r.pointShadowMap.length=O,r.spotShadow.length=H,r.spotShadowMap.length=H,r.directionalShadowMatrix.length=L,r.pointShadowMatrix.length=O,r.spotLightMatrix.length=H+q-Z,r.spotLightMap.length=q,r.numSpotLightShadowsWithMaps=Z,r.numLightProbes=J,re.directionalLength=x,re.pointLength=A,re.spotLength=I,re.rectAreaLength=E,re.hemiLength=C,re.numDirectionalShadows=L,re.numPointShadows=O,re.numSpotShadows=H,re.numSpotMaps=q,re.numLightProbes=J,r.version=mwe++)}function a(d,f){let m=0,_=0,x=0,A=0,I=0;const E=f.matrixWorldInverse;for(let C=0,L=d.length;C<L;C++){const O=d[C];if(O.isDirectionalLight){const H=r.directional[m];H.direction.setFromMatrixPosition(O.matrixWorld),s.setFromMatrixPosition(O.target.matrixWorld),H.direction.sub(s),H.direction.transformDirection(E),m++}else if(O.isSpotLight){const H=r.spot[x];H.position.setFromMatrixPosition(O.matrixWorld),H.position.applyMatrix4(E),H.direction.setFromMatrixPosition(O.matrixWorld),s.setFromMatrixPosition(O.target.matrixWorld),H.direction.sub(s),H.direction.transformDirection(E),x++}else if(O.isRectAreaLight){const H=r.rectArea[A];H.position.setFromMatrixPosition(O.matrixWorld),H.position.applyMatrix4(E),l.identity(),o.copy(O.matrixWorld),o.premultiply(E),l.extractRotation(o),H.halfWidth.set(O.width*.5,0,0),H.halfHeight.set(0,O.height*.5,0),H.halfWidth.applyMatrix4(l),H.halfHeight.applyMatrix4(l),A++}else if(O.isPointLight){const H=r.point[_];H.position.setFromMatrixPosition(O.matrixWorld),H.position.applyMatrix4(E),_++}else if(O.isHemisphereLight){const H=r.hemi[I];H.direction.setFromMatrixPosition(O.matrixWorld),H.direction.transformDirection(E),I++}}}return{setup:c,setupView:a,state:r}}function e$(n){const e=new vwe(n),t=[],r=[];function s(f){d.camera=f,t.length=0,r.length=0}function o(f){t.push(f)}function l(f){r.push(f)}function c(){e.setup(t)}function a(f){e.setupView(t,f)}const d={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:d,setupLights:c,setupLightsView:a,pushLight:o,pushShadow:l}}function _we(n){let e=new WeakMap;function t(s,o=0){const l=e.get(s);let c;return l===void 0?(c=new e$(n),e.set(s,[c])):o>=l.length?(c=new e$(n),l.push(c)):c=l[o],c}function r(){e=new WeakMap}return{get:t,dispose:r}}class B6 extends wo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Une,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class k6 extends wo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const ywe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,xwe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function bwe(n,e,t){let r=new gC;const s=new sn,o=new sn,l=new Ls,c=new B6({depthPacking:Gne}),a=new k6,d={},f=t.maxTextureSize,m={[Uh]:Rc,[Rc]:Uh,[Mc]:Mc},_=new Lo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new sn},radius:{value:4}},vertexShader:ywe,fragmentShader:xwe}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const A=new Yr;A.setAttribute("position",new Ni(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Di(A,_),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=AD;let C=this.type;this.render=function(Z,J,re){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||Z.length===0)return;const se=n.getRenderTarget(),ae=n.getActiveCubeFace(),he=n.getActiveMipmapLevel(),Ae=n.state;Ae.setBlending(pp),Ae.buffers.color.setClear(1,1,1,1),Ae.buffers.depth.setTest(!0),Ae.setScissorTest(!1);const Ee=C!==Gd&&this.type===Gd,Pe=C===Gd&&this.type!==Gd;for(let ze=0,Re=Z.length;ze<Re;ze++){const rt=Z[ze],ye=rt.shadow;if(ye===void 0){console.warn("THREE.WebGLShadowMap:",rt,"has no shadow.");continue}if(ye.autoUpdate===!1&&ye.needsUpdate===!1)continue;s.copy(ye.mapSize);const We=ye.getFrameExtents();if(s.multiply(We),o.copy(ye.mapSize),(s.x>f||s.y>f)&&(s.x>f&&(o.x=Math.floor(f/We.x),s.x=o.x*We.x,ye.mapSize.x=o.x),s.y>f&&(o.y=Math.floor(f/We.y),s.y=o.y*We.y,ye.mapSize.y=o.y)),ye.map===null||Ee===!0||Pe===!0){const gt=this.type!==Gd?{minFilter:Ma,magFilter:Ma}:{};ye.map!==null&&ye.map.dispose(),ye.map=new Ml(s.x,s.y,gt),ye.map.texture.name=rt.name+".shadowMap",ye.camera.updateProjectionMatrix()}n.setRenderTarget(ye.map),n.clear();const Ue=ye.getViewportCount();for(let gt=0;gt<Ue;gt++){const vt=ye.getViewport(gt);l.set(o.x*vt.x,o.y*vt.y,o.x*vt.z,o.y*vt.w),Ae.viewport(l),ye.updateMatrices(rt,gt),r=ye.getFrustum(),H(J,re,ye.camera,rt,this.type)}ye.isPointLightShadow!==!0&&this.type===Gd&&L(ye,re),ye.needsUpdate=!1}C=this.type,E.needsUpdate=!1,n.setRenderTarget(se,ae,he)};function L(Z,J){const re=e.update(I);_.defines.VSM_SAMPLES!==Z.blurSamples&&(_.defines.VSM_SAMPLES=Z.blurSamples,x.defines.VSM_SAMPLES=Z.blurSamples,_.needsUpdate=!0,x.needsUpdate=!0),Z.mapPass===null&&(Z.mapPass=new Ml(s.x,s.y)),_.uniforms.shadow_pass.value=Z.map.texture,_.uniforms.resolution.value=Z.mapSize,_.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.mapPass),n.clear(),n.renderBufferDirect(J,null,re,_,I,null),x.uniforms.shadow_pass.value=Z.mapPass.texture,x.uniforms.resolution.value=Z.mapSize,x.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.map),n.clear(),n.renderBufferDirect(J,null,re,x,I,null)}function O(Z,J,re,se){let ae=null;const he=re.isPointLight===!0?Z.customDistanceMaterial:Z.customDepthMaterial;if(he!==void 0)ae=he;else if(ae=re.isPointLight===!0?a:c,n.localClippingEnabled&&J.clipShadows===!0&&Array.isArray(J.clippingPlanes)&&J.clippingPlanes.length!==0||J.displacementMap&&J.displacementScale!==0||J.alphaMap&&J.alphaTest>0||J.map&&J.alphaTest>0){const Ae=ae.uuid,Ee=J.uuid;let Pe=d[Ae];Pe===void 0&&(Pe={},d[Ae]=Pe);let ze=Pe[Ee];ze===void 0&&(ze=ae.clone(),Pe[Ee]=ze,J.addEventListener("dispose",q)),ae=ze}if(ae.visible=J.visible,ae.wireframe=J.wireframe,se===Gd?ae.side=J.shadowSide!==null?J.shadowSide:J.side:ae.side=J.shadowSide!==null?J.shadowSide:m[J.side],ae.alphaMap=J.alphaMap,ae.alphaTest=J.alphaTest,ae.map=J.map,ae.clipShadows=J.clipShadows,ae.clippingPlanes=J.clippingPlanes,ae.clipIntersection=J.clipIntersection,ae.displacementMap=J.displacementMap,ae.displacementScale=J.displacementScale,ae.displacementBias=J.displacementBias,ae.wireframeLinewidth=J.wireframeLinewidth,ae.linewidth=J.linewidth,re.isPointLight===!0&&ae.isMeshDistanceMaterial===!0){const Ae=n.properties.get(ae);Ae.light=re}return ae}function H(Z,J,re,se,ae){if(Z.visible===!1)return;if(Z.layers.test(J.layers)&&(Z.isMesh||Z.isLine||Z.isPoints)&&(Z.castShadow||Z.receiveShadow&&ae===Gd)&&(!Z.frustumCulled||r.intersectsObject(Z))){Z.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,Z.matrixWorld);const Ee=e.update(Z),Pe=Z.material;if(Array.isArray(Pe)){const ze=Ee.groups;for(let Re=0,rt=ze.length;Re<rt;Re++){const ye=ze[Re],We=Pe[ye.materialIndex];if(We&&We.visible){const Ue=O(Z,We,se,ae);Z.onBeforeShadow(n,Z,J,re,Ee,Ue,ye),n.renderBufferDirect(re,null,Ee,Ue,Z,ye),Z.onAfterShadow(n,Z,J,re,Ee,Ue,ye)}}}else if(Pe.visible){const ze=O(Z,Pe,se,ae);Z.onBeforeShadow(n,Z,J,re,Ee,ze,null),n.renderBufferDirect(re,null,Ee,ze,Z,null),Z.onAfterShadow(n,Z,J,re,Ee,ze,null)}}const Ae=Z.children;for(let Ee=0,Pe=Ae.length;Ee<Pe;Ee++)H(Ae[Ee],J,re,se,ae)}function q(Z){Z.target.removeEventListener("dispose",q);for(const re in d){const se=d[re],ae=Z.target.uuid;ae in se&&(se[ae].dispose(),delete se[ae])}}}function wwe(n){function e(){let Ne=!1;const Bt=new Ls;let Jt=null;const hn=new Ls(0,0,0,0);return{setMask:function(In){Jt!==In&&!Ne&&(n.colorMask(In,In,In,In),Jt=In)},setLocked:function(In){Ne=In},setClear:function(In,Tr,jr,ps,Bs){Bs===!0&&(In*=ps,Tr*=ps,jr*=ps),Bt.set(In,Tr,jr,ps),hn.equals(Bt)===!1&&(n.clearColor(In,Tr,jr,ps),hn.copy(Bt))},reset:function(){Ne=!1,Jt=null,hn.set(-1,0,0,0)}}}function t(){let Ne=!1,Bt=null,Jt=null,hn=null;return{setTest:function(In){In?Qt(n.DEPTH_TEST):nn(n.DEPTH_TEST)},setMask:function(In){Bt!==In&&!Ne&&(n.depthMask(In),Bt=In)},setFunc:function(In){if(Jt!==In){switch(In){case wne:n.depthFunc(n.NEVER);break;case Sne:n.depthFunc(n.ALWAYS);break;case Ane:n.depthFunc(n.LESS);break;case dM:n.depthFunc(n.LEQUAL);break;case Tne:n.depthFunc(n.EQUAL);break;case Mne:n.depthFunc(n.GEQUAL);break;case Cne:n.depthFunc(n.GREATER);break;case Ene:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Jt=In}},setLocked:function(In){Ne=In},setClear:function(In){hn!==In&&(n.clearDepth(In),hn=In)},reset:function(){Ne=!1,Bt=null,Jt=null,hn=null}}}function r(){let Ne=!1,Bt=null,Jt=null,hn=null,In=null,Tr=null,jr=null,ps=null,Bs=null;return{setTest:function(fi){Ne||(fi?Qt(n.STENCIL_TEST):nn(n.STENCIL_TEST))},setMask:function(fi){Bt!==fi&&!Ne&&(n.stencilMask(fi),Bt=fi)},setFunc:function(fi,Mt,we){(Jt!==fi||hn!==Mt||In!==we)&&(n.stencilFunc(fi,Mt,we),Jt=fi,hn=Mt,In=we)},setOp:function(fi,Mt,we){(Tr!==fi||jr!==Mt||ps!==we)&&(n.stencilOp(fi,Mt,we),Tr=fi,jr=Mt,ps=we)},setLocked:function(fi){Ne=fi},setClear:function(fi){Bs!==fi&&(n.clearStencil(fi),Bs=fi)},reset:function(){Ne=!1,Bt=null,Jt=null,hn=null,In=null,Tr=null,jr=null,ps=null,Bs=null}}}const s=new e,o=new t,l=new r,c=new WeakMap,a=new WeakMap;let d={},f={},m=new WeakMap,_=[],x=null,A=!1,I=null,E=null,C=null,L=null,O=null,H=null,q=null,Z=new Hn(0,0,0),J=0,re=!1,se=null,ae=null,he=null,Ae=null,Ee=null;const Pe=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ze=!1,Re=0;const rt=n.getParameter(n.VERSION);rt.indexOf("WebGL")!==-1?(Re=parseFloat(/^WebGL (\d)/.exec(rt)[1]),ze=Re>=1):rt.indexOf("OpenGL ES")!==-1&&(Re=parseFloat(/^OpenGL ES (\d)/.exec(rt)[1]),ze=Re>=2);let ye=null,We={};const Ue=n.getParameter(n.SCISSOR_BOX),gt=n.getParameter(n.VIEWPORT),vt=new Ls().fromArray(Ue),Dt=new Ls().fromArray(gt);function lt(Ne,Bt,Jt,hn){const In=new Uint8Array(4),Tr=n.createTexture();n.bindTexture(Ne,Tr),n.texParameteri(Ne,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Ne,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let jr=0;jr<Jt;jr++)Ne===n.TEXTURE_3D||Ne===n.TEXTURE_2D_ARRAY?n.texImage3D(Bt,0,n.RGBA,1,1,hn,0,n.RGBA,n.UNSIGNED_BYTE,In):n.texImage2D(Bt+jr,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,In);return Tr}const jt={};jt[n.TEXTURE_2D]=lt(n.TEXTURE_2D,n.TEXTURE_2D,1),jt[n.TEXTURE_CUBE_MAP]=lt(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),jt[n.TEXTURE_2D_ARRAY]=lt(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),jt[n.TEXTURE_3D]=lt(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),l.setClear(0),Qt(n.DEPTH_TEST),o.setFunc(dM),At(!1),en(Q4),Qt(n.CULL_FACE),gn(pp);function Qt(Ne){d[Ne]!==!0&&(n.enable(Ne),d[Ne]=!0)}function nn(Ne){d[Ne]!==!1&&(n.disable(Ne),d[Ne]=!1)}function Wn(Ne,Bt){return f[Ne]!==Bt?(n.bindFramebuffer(Ne,Bt),f[Ne]=Bt,Ne===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Bt),Ne===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Bt),!0):!1}function kn(Ne,Bt){let Jt=_,hn=!1;if(Ne){Jt=m.get(Bt),Jt===void 0&&(Jt=[],m.set(Bt,Jt));const In=Ne.textures;if(Jt.length!==In.length||Jt[0]!==n.COLOR_ATTACHMENT0){for(let Tr=0,jr=In.length;Tr<jr;Tr++)Jt[Tr]=n.COLOR_ATTACHMENT0+Tr;Jt.length=In.length,hn=!0}}else Jt[0]!==n.BACK&&(Jt[0]=n.BACK,hn=!0);hn&&n.drawBuffers(Jt)}function Mn(Ne){return x!==Ne?(n.useProgram(Ne),x=Ne,!0):!1}const De={[Xv]:n.FUNC_ADD,[sne]:n.FUNC_SUBTRACT,[one]:n.FUNC_REVERSE_SUBTRACT};De[ane]=n.MIN,De[lne]=n.MAX;const Ye={[cne]:n.ZERO,[une]:n.ONE,[hne]:n.SRC_COLOR,[_R]:n.SRC_ALPHA,[vne]:n.SRC_ALPHA_SATURATE,[mne]:n.DST_COLOR,[fne]:n.DST_ALPHA,[dne]:n.ONE_MINUS_SRC_COLOR,[yR]:n.ONE_MINUS_SRC_ALPHA,[gne]:n.ONE_MINUS_DST_COLOR,[pne]:n.ONE_MINUS_DST_ALPHA,[_ne]:n.CONSTANT_COLOR,[yne]:n.ONE_MINUS_CONSTANT_COLOR,[xne]:n.CONSTANT_ALPHA,[bne]:n.ONE_MINUS_CONSTANT_ALPHA};function gn(Ne,Bt,Jt,hn,In,Tr,jr,ps,Bs,fi){if(Ne===pp){A===!0&&(nn(n.BLEND),A=!1);return}if(A===!1&&(Qt(n.BLEND),A=!0),Ne!==ine){if(Ne!==I||fi!==re){if((E!==Xv||O!==Xv)&&(n.blendEquation(n.FUNC_ADD),E=Xv,O=Xv),fi)switch(Ne){case Xy:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case gw:n.blendFunc(n.ONE,n.ONE);break;case ez:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case tz:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ne);break}else switch(Ne){case Xy:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case gw:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case ez:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case tz:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ne);break}C=null,L=null,H=null,q=null,Z.set(0,0,0),J=0,I=Ne,re=fi}return}In=In||Bt,Tr=Tr||Jt,jr=jr||hn,(Bt!==E||In!==O)&&(n.blendEquationSeparate(De[Bt],De[In]),E=Bt,O=In),(Jt!==C||hn!==L||Tr!==H||jr!==q)&&(n.blendFuncSeparate(Ye[Jt],Ye[hn],Ye[Tr],Ye[jr]),C=Jt,L=hn,H=Tr,q=jr),(ps.equals(Z)===!1||Bs!==J)&&(n.blendColor(ps.r,ps.g,ps.b,Bs),Z.copy(ps),J=Bs),I=Ne,re=!1}function un(Ne,Bt){Ne.side===Mc?nn(n.CULL_FACE):Qt(n.CULL_FACE);let Jt=Ne.side===Rc;Bt&&(Jt=!Jt),At(Jt),Ne.blending===Xy&&Ne.transparent===!1?gn(pp):gn(Ne.blending,Ne.blendEquation,Ne.blendSrc,Ne.blendDst,Ne.blendEquationAlpha,Ne.blendSrcAlpha,Ne.blendDstAlpha,Ne.blendColor,Ne.blendAlpha,Ne.premultipliedAlpha),o.setFunc(Ne.depthFunc),o.setTest(Ne.depthTest),o.setMask(Ne.depthWrite),s.setMask(Ne.colorWrite);const hn=Ne.stencilWrite;l.setTest(hn),hn&&(l.setMask(Ne.stencilWriteMask),l.setFunc(Ne.stencilFunc,Ne.stencilRef,Ne.stencilFuncMask),l.setOp(Ne.stencilFail,Ne.stencilZFail,Ne.stencilZPass)),Vn(Ne.polygonOffset,Ne.polygonOffsetFactor,Ne.polygonOffsetUnits),Ne.alphaToCoverage===!0?Qt(n.SAMPLE_ALPHA_TO_COVERAGE):nn(n.SAMPLE_ALPHA_TO_COVERAGE)}function At(Ne){se!==Ne&&(Ne?n.frontFace(n.CW):n.frontFace(n.CCW),se=Ne)}function en(Ne){Ne!==tne?(Qt(n.CULL_FACE),Ne!==ae&&(Ne===Q4?n.cullFace(n.BACK):Ne===nne?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):nn(n.CULL_FACE),ae=Ne}function On(Ne){Ne!==he&&(ze&&n.lineWidth(Ne),he=Ne)}function Vn(Ne,Bt,Jt){Ne?(Qt(n.POLYGON_OFFSET_FILL),(Ae!==Bt||Ee!==Jt)&&(n.polygonOffset(Bt,Jt),Ae=Bt,Ee=Jt)):nn(n.POLYGON_OFFSET_FILL)}function on(Ne){Ne?Qt(n.SCISSOR_TEST):nn(n.SCISSOR_TEST)}function ct(Ne){Ne===void 0&&(Ne=n.TEXTURE0+Pe-1),ye!==Ne&&(n.activeTexture(Ne),ye=Ne)}function He(Ne,Bt,Jt){Jt===void 0&&(ye===null?Jt=n.TEXTURE0+Pe-1:Jt=ye);let hn=We[Jt];hn===void 0&&(hn={type:void 0,texture:void 0},We[Jt]=hn),(hn.type!==Ne||hn.texture!==Bt)&&(ye!==Jt&&(n.activeTexture(Jt),ye=Jt),n.bindTexture(Ne,Bt||jt[Ne]),hn.type=Ne,hn.texture=Bt)}function qt(){const Ne=We[ye];Ne!==void 0&&Ne.type!==void 0&&(n.bindTexture(Ne.type,null),Ne.type=void 0,Ne.texture=void 0)}function Tn(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function An(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Wt(){try{n.texSubImage2D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function gr(){try{n.texSubImage3D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Gn(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function nr(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Ar(){try{n.texStorage2D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Dn(){try{n.texStorage3D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function sr(){try{n.texImage2D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function di(){try{n.texImage3D.apply(n,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function zr(Ne){vt.equals(Ne)===!1&&(n.scissor(Ne.x,Ne.y,Ne.z,Ne.w),vt.copy(Ne))}function ar(Ne){Dt.equals(Ne)===!1&&(n.viewport(Ne.x,Ne.y,Ne.z,Ne.w),Dt.copy(Ne))}function Ur(Ne,Bt){let Jt=a.get(Bt);Jt===void 0&&(Jt=new WeakMap,a.set(Bt,Jt));let hn=Jt.get(Ne);hn===void 0&&(hn=n.getUniformBlockIndex(Bt,Ne.name),Jt.set(Ne,hn))}function Wr(Ne,Bt){const hn=a.get(Bt).get(Ne);c.get(Bt)!==hn&&(n.uniformBlockBinding(Bt,hn,Ne.__bindingPointIndex),c.set(Bt,hn))}function Si(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},ye=null,We={},f={},m=new WeakMap,_=[],x=null,A=!1,I=null,E=null,C=null,L=null,O=null,H=null,q=null,Z=new Hn(0,0,0),J=0,re=!1,se=null,ae=null,he=null,Ae=null,Ee=null,vt.set(0,0,n.canvas.width,n.canvas.height),Dt.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),l.reset()}return{buffers:{color:s,depth:o,stencil:l},enable:Qt,disable:nn,bindFramebuffer:Wn,drawBuffers:kn,useProgram:Mn,setBlending:gn,setMaterial:un,setFlipSided:At,setCullFace:en,setLineWidth:On,setPolygonOffset:Vn,setScissorTest:on,activeTexture:ct,bindTexture:He,unbindTexture:qt,compressedTexImage2D:Tn,compressedTexImage3D:An,texImage2D:sr,texImage3D:di,updateUBOMapping:Ur,uniformBlockBinding:Wr,texStorage2D:Ar,texStorage3D:Dn,texSubImage2D:Wt,texSubImage3D:gr,compressedTexSubImage2D:Gn,compressedTexSubImage3D:nr,scissor:zr,viewport:ar,reset:Si}}function Swe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function Awe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function Twe(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function az(n,e,t,r){const s=Mwe(r);switch(t){case _6:return n*e;case x6:return n*e;case b6:return n*e*2;case uC:return n*e/s.components*s.byteLength;case hC:return n*e/s.components*s.byteLength;case w6:return n*e*2/s.components*s.byteLength;case RD:return n*e*2/s.components*s.byteLength;case y6:return n*e*3/s.components*s.byteLength;case Zl:return n*e*4/s.components*s.byteLength;case LD:return n*e*4/s.components*s.byteLength;case pT:case mT:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case gT:case vT:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case bR:case SR:return Math.max(n,16)*Math.max(e,8)/4;case xR:case wR:return Math.max(n,8)*Math.max(e,8)/2;case AR:case TR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case MR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case CR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case ER:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case IR:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case PR:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case RR:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case LR:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case DR:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case BR:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case kR:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case OR:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case FR:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case NR:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case zR:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case UR:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case _T:case GR:case VR:return Math.ceil(n/4)*Math.ceil(e/4)*16;case S6:case HR:return Math.ceil(n/4)*Math.ceil(e/4)*8;case jR:case WR:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Mwe(n){switch(n){case tf:case m6:return{byteLength:1,components:1};case vw:case g6:case Bh:return{byteLength:2,components:1};case ID:case PD:return{byteLength:2,components:4};case eg:case ED:case Ec:return{byteLength:4,components:1};case v6:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}const Cwe={contain:Swe,cover:Awe,fill:Twe,getByteLength:az};function Ewe(n,e,t,r,s,o,l){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,a=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new sn,f=new WeakMap;let m;const _=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(ct,He){return x?new OffscreenCanvas(ct,He):bM("canvas")}function I(ct,He,qt){let Tn=1;const An=on(ct);if((An.width>qt||An.height>qt)&&(Tn=qt/Math.max(An.width,An.height)),Tn<1)if(typeof HTMLImageElement<"u"&&ct instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ct instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ct instanceof ImageBitmap||typeof VideoFrame<"u"&&ct instanceof VideoFrame){const Wt=Math.floor(Tn*An.width),gr=Math.floor(Tn*An.height);m===void 0&&(m=A(Wt,gr));const Gn=He?A(Wt,gr):m;return Gn.width=Wt,Gn.height=gr,Gn.getContext("2d").drawImage(ct,0,0,Wt,gr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+An.width+"x"+An.height+") to ("+Wt+"x"+gr+")."),Gn}else return"data"in ct&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+An.width+"x"+An.height+")."),ct;return ct}function E(ct){return ct.generateMipmaps&&ct.minFilter!==Ma&&ct.minFilter!==Ro}function C(ct){n.generateMipmap(ct)}function L(ct,He,qt,Tn,An=!1){if(ct!==null){if(n[ct]!==void 0)return n[ct];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ct+"'")}let Wt=He;if(He===n.RED&&(qt===n.FLOAT&&(Wt=n.R32F),qt===n.HALF_FLOAT&&(Wt=n.R16F),qt===n.UNSIGNED_BYTE&&(Wt=n.R8)),He===n.RED_INTEGER&&(qt===n.UNSIGNED_BYTE&&(Wt=n.R8UI),qt===n.UNSIGNED_SHORT&&(Wt=n.R16UI),qt===n.UNSIGNED_INT&&(Wt=n.R32UI),qt===n.BYTE&&(Wt=n.R8I),qt===n.SHORT&&(Wt=n.R16I),qt===n.INT&&(Wt=n.R32I)),He===n.RG&&(qt===n.FLOAT&&(Wt=n.RG32F),qt===n.HALF_FLOAT&&(Wt=n.RG16F),qt===n.UNSIGNED_BYTE&&(Wt=n.RG8)),He===n.RG_INTEGER&&(qt===n.UNSIGNED_BYTE&&(Wt=n.RG8UI),qt===n.UNSIGNED_SHORT&&(Wt=n.RG16UI),qt===n.UNSIGNED_INT&&(Wt=n.RG32UI),qt===n.BYTE&&(Wt=n.RG8I),qt===n.SHORT&&(Wt=n.RG16I),qt===n.INT&&(Wt=n.RG32I)),He===n.RGB&&qt===n.UNSIGNED_INT_5_9_9_9_REV&&(Wt=n.RGB9_E5),He===n.RGBA){const gr=An?gM:_s.getTransfer(Tn);qt===n.FLOAT&&(Wt=n.RGBA32F),qt===n.HALF_FLOAT&&(Wt=n.RGBA16F),qt===n.UNSIGNED_BYTE&&(Wt=gr===io?n.SRGB8_ALPHA8:n.RGBA8),qt===n.UNSIGNED_SHORT_4_4_4_4&&(Wt=n.RGBA4),qt===n.UNSIGNED_SHORT_5_5_5_1&&(Wt=n.RGB5_A1)}return(Wt===n.R16F||Wt===n.R32F||Wt===n.RG16F||Wt===n.RG32F||Wt===n.RGBA16F||Wt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Wt}function O(ct,He){let qt;return ct?He===null||He===eg||He===hx?qt=n.DEPTH24_STENCIL8:He===Ec?qt=n.DEPTH32F_STENCIL8:He===vw&&(qt=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):He===null||He===eg||He===hx?qt=n.DEPTH_COMPONENT24:He===Ec?qt=n.DEPTH_COMPONENT32F:He===vw&&(qt=n.DEPTH_COMPONENT16),qt}function H(ct,He){return E(ct)===!0||ct.isFramebufferTexture&&ct.minFilter!==Ma&&ct.minFilter!==Ro?Math.log2(Math.max(He.width,He.height))+1:ct.mipmaps!==void 0&&ct.mipmaps.length>0?ct.mipmaps.length:ct.isCompressedTexture&&Array.isArray(ct.image)?He.mipmaps.length:1}function q(ct){const He=ct.target;He.removeEventListener("dispose",q),J(He),He.isVideoTexture&&f.delete(He)}function Z(ct){const He=ct.target;He.removeEventListener("dispose",Z),se(He)}function J(ct){const He=r.get(ct);if(He.__webglInit===void 0)return;const qt=ct.source,Tn=_.get(qt);if(Tn){const An=Tn[He.__cacheKey];An.usedTimes--,An.usedTimes===0&&re(ct),Object.keys(Tn).length===0&&_.delete(qt)}r.remove(ct)}function re(ct){const He=r.get(ct);n.deleteTexture(He.__webglTexture);const qt=ct.source,Tn=_.get(qt);delete Tn[He.__cacheKey],l.memory.textures--}function se(ct){const He=r.get(ct);if(ct.depthTexture&&ct.depthTexture.dispose(),ct.isWebGLCubeRenderTarget)for(let Tn=0;Tn<6;Tn++){if(Array.isArray(He.__webglFramebuffer[Tn]))for(let An=0;An<He.__webglFramebuffer[Tn].length;An++)n.deleteFramebuffer(He.__webglFramebuffer[Tn][An]);else n.deleteFramebuffer(He.__webglFramebuffer[Tn]);He.__webglDepthbuffer&&n.deleteRenderbuffer(He.__webglDepthbuffer[Tn])}else{if(Array.isArray(He.__webglFramebuffer))for(let Tn=0;Tn<He.__webglFramebuffer.length;Tn++)n.deleteFramebuffer(He.__webglFramebuffer[Tn]);else n.deleteFramebuffer(He.__webglFramebuffer);if(He.__webglDepthbuffer&&n.deleteRenderbuffer(He.__webglDepthbuffer),He.__webglMultisampledFramebuffer&&n.deleteFramebuffer(He.__webglMultisampledFramebuffer),He.__webglColorRenderbuffer)for(let Tn=0;Tn<He.__webglColorRenderbuffer.length;Tn++)He.__webglColorRenderbuffer[Tn]&&n.deleteRenderbuffer(He.__webglColorRenderbuffer[Tn]);He.__webglDepthRenderbuffer&&n.deleteRenderbuffer(He.__webglDepthRenderbuffer)}const qt=ct.textures;for(let Tn=0,An=qt.length;Tn<An;Tn++){const Wt=r.get(qt[Tn]);Wt.__webglTexture&&(n.deleteTexture(Wt.__webglTexture),l.memory.textures--),r.remove(qt[Tn])}r.remove(ct)}let ae=0;function he(){ae=0}function Ae(){const ct=ae;return ct>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ct+" texture units while this GPU supports only "+s.maxTextures),ae+=1,ct}function Ee(ct){const He=[];return He.push(ct.wrapS),He.push(ct.wrapT),He.push(ct.wrapR||0),He.push(ct.magFilter),He.push(ct.minFilter),He.push(ct.anisotropy),He.push(ct.internalFormat),He.push(ct.format),He.push(ct.type),He.push(ct.generateMipmaps),He.push(ct.premultiplyAlpha),He.push(ct.flipY),He.push(ct.unpackAlignment),He.push(ct.colorSpace),He.join()}function Pe(ct,He){const qt=r.get(ct);if(ct.isVideoTexture&&On(ct),ct.isRenderTargetTexture===!1&&ct.version>0&&qt.__version!==ct.version){const Tn=ct.image;if(Tn===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Tn.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Dt(qt,ct,He);return}}t.bindTexture(n.TEXTURE_2D,qt.__webglTexture,n.TEXTURE0+He)}function ze(ct,He){const qt=r.get(ct);if(ct.version>0&&qt.__version!==ct.version){Dt(qt,ct,He);return}t.bindTexture(n.TEXTURE_2D_ARRAY,qt.__webglTexture,n.TEXTURE0+He)}function Re(ct,He){const qt=r.get(ct);if(ct.version>0&&qt.__version!==ct.version){Dt(qt,ct,He);return}t.bindTexture(n.TEXTURE_3D,qt.__webglTexture,n.TEXTURE0+He)}function rt(ct,He){const qt=r.get(ct);if(ct.version>0&&qt.__version!==ct.version){lt(qt,ct,He);return}t.bindTexture(n.TEXTURE_CUBE_MAP,qt.__webglTexture,n.TEXTURE0+He)}const ye={[Gh]:n.REPEAT,[uu]:n.CLAMP_TO_EDGE,[ux]:n.MIRRORED_REPEAT},We={[Ma]:n.NEAREST,[cC]:n.NEAREST_MIPMAP_NEAREST,[Jv]:n.NEAREST_MIPMAP_LINEAR,[Ro]:n.LINEAR,[qy]:n.LINEAR_MIPMAP_NEAREST,[hu]:n.LINEAR_MIPMAP_LINEAR},Ue={[Hne]:n.NEVER,[Yne]:n.ALWAYS,[jne]:n.LESS,[M6]:n.LEQUAL,[Wne]:n.EQUAL,[qne]:n.GEQUAL,[$ne]:n.GREATER,[Xne]:n.NOTEQUAL};function gt(ct,He){if(He.type===Ec&&e.has("OES_texture_float_linear")===!1&&(He.magFilter===Ro||He.magFilter===qy||He.magFilter===Jv||He.magFilter===hu||He.minFilter===Ro||He.minFilter===qy||He.minFilter===Jv||He.minFilter===hu)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(ct,n.TEXTURE_WRAP_S,ye[He.wrapS]),n.texParameteri(ct,n.TEXTURE_WRAP_T,ye[He.wrapT]),(ct===n.TEXTURE_3D||ct===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ct,n.TEXTURE_WRAP_R,ye[He.wrapR]),n.texParameteri(ct,n.TEXTURE_MAG_FILTER,We[He.magFilter]),n.texParameteri(ct,n.TEXTURE_MIN_FILTER,We[He.minFilter]),He.compareFunction&&(n.texParameteri(ct,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ct,n.TEXTURE_COMPARE_FUNC,Ue[He.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(He.magFilter===Ma||He.minFilter!==Jv&&He.minFilter!==hu||He.type===Ec&&e.has("OES_texture_float_linear")===!1)return;if(He.anisotropy>1||r.get(He).__currentAnisotropy){const qt=e.get("EXT_texture_filter_anisotropic");n.texParameterf(ct,qt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(He.anisotropy,s.getMaxAnisotropy())),r.get(He).__currentAnisotropy=He.anisotropy}}}function vt(ct,He){let qt=!1;ct.__webglInit===void 0&&(ct.__webglInit=!0,He.addEventListener("dispose",q));const Tn=He.source;let An=_.get(Tn);An===void 0&&(An={},_.set(Tn,An));const Wt=Ee(He);if(Wt!==ct.__cacheKey){An[Wt]===void 0&&(An[Wt]={texture:n.createTexture(),usedTimes:0},l.memory.textures++,qt=!0),An[Wt].usedTimes++;const gr=An[ct.__cacheKey];gr!==void 0&&(An[ct.__cacheKey].usedTimes--,gr.usedTimes===0&&re(He)),ct.__cacheKey=Wt,ct.__webglTexture=An[Wt].texture}return qt}function Dt(ct,He,qt){let Tn=n.TEXTURE_2D;(He.isDataArrayTexture||He.isCompressedArrayTexture)&&(Tn=n.TEXTURE_2D_ARRAY),He.isData3DTexture&&(Tn=n.TEXTURE_3D);const An=vt(ct,He),Wt=He.source;t.bindTexture(Tn,ct.__webglTexture,n.TEXTURE0+qt);const gr=r.get(Wt);if(Wt.version!==gr.__version||An===!0){t.activeTexture(n.TEXTURE0+qt);const Gn=_s.getPrimaries(_s.workingColorSpace),nr=He.colorSpace===Bm?null:_s.getPrimaries(He.colorSpace),Ar=He.colorSpace===Bm||Gn===nr?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,He.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,He.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,He.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ar);let Dn=I(He.image,!1,s.maxTextureSize);Dn=Vn(He,Dn);const sr=o.convert(He.format,He.colorSpace),di=o.convert(He.type);let zr=L(He.internalFormat,sr,di,He.colorSpace,He.isVideoTexture);gt(Tn,He);let ar;const Ur=He.mipmaps,Wr=He.isVideoTexture!==!0,Si=gr.__version===void 0||An===!0,Ne=Wt.dataReady,Bt=H(He,Dn);if(He.isDepthTexture)zr=O(He.format===dx,He.type),Si&&(Wr?t.texStorage2D(n.TEXTURE_2D,1,zr,Dn.width,Dn.height):t.texImage2D(n.TEXTURE_2D,0,zr,Dn.width,Dn.height,0,sr,di,null));else if(He.isDataTexture)if(Ur.length>0){Wr&&Si&&t.texStorage2D(n.TEXTURE_2D,Bt,zr,Ur[0].width,Ur[0].height);for(let Jt=0,hn=Ur.length;Jt<hn;Jt++)ar=Ur[Jt],Wr?Ne&&t.texSubImage2D(n.TEXTURE_2D,Jt,0,0,ar.width,ar.height,sr,di,ar.data):t.texImage2D(n.TEXTURE_2D,Jt,zr,ar.width,ar.height,0,sr,di,ar.data);He.generateMipmaps=!1}else Wr?(Si&&t.texStorage2D(n.TEXTURE_2D,Bt,zr,Dn.width,Dn.height),Ne&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Dn.width,Dn.height,sr,di,Dn.data)):t.texImage2D(n.TEXTURE_2D,0,zr,Dn.width,Dn.height,0,sr,di,Dn.data);else if(He.isCompressedTexture)if(He.isCompressedArrayTexture){Wr&&Si&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Bt,zr,Ur[0].width,Ur[0].height,Dn.depth);for(let Jt=0,hn=Ur.length;Jt<hn;Jt++)if(ar=Ur[Jt],He.format!==Zl)if(sr!==null)if(Wr){if(Ne)if(He.layerUpdates.size>0){const In=az(ar.width,ar.height,He.format,He.type);for(const Tr of He.layerUpdates){const jr=ar.data.subarray(Tr*In/ar.data.BYTES_PER_ELEMENT,(Tr+1)*In/ar.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Jt,0,0,Tr,ar.width,ar.height,1,sr,jr,0,0)}He.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Jt,0,0,0,ar.width,ar.height,Dn.depth,sr,ar.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Jt,zr,ar.width,ar.height,Dn.depth,0,ar.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Wr?Ne&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Jt,0,0,0,ar.width,ar.height,Dn.depth,sr,di,ar.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Jt,zr,ar.width,ar.height,Dn.depth,0,sr,di,ar.data)}else{Wr&&Si&&t.texStorage2D(n.TEXTURE_2D,Bt,zr,Ur[0].width,Ur[0].height);for(let Jt=0,hn=Ur.length;Jt<hn;Jt++)ar=Ur[Jt],He.format!==Zl?sr!==null?Wr?Ne&&t.compressedTexSubImage2D(n.TEXTURE_2D,Jt,0,0,ar.width,ar.height,sr,ar.data):t.compressedTexImage2D(n.TEXTURE_2D,Jt,zr,ar.width,ar.height,0,ar.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Wr?Ne&&t.texSubImage2D(n.TEXTURE_2D,Jt,0,0,ar.width,ar.height,sr,di,ar.data):t.texImage2D(n.TEXTURE_2D,Jt,zr,ar.width,ar.height,0,sr,di,ar.data)}else if(He.isDataArrayTexture)if(Wr){if(Si&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Bt,zr,Dn.width,Dn.height,Dn.depth),Ne)if(He.layerUpdates.size>0){const Jt=az(Dn.width,Dn.height,He.format,He.type);for(const hn of He.layerUpdates){const In=Dn.data.subarray(hn*Jt/Dn.data.BYTES_PER_ELEMENT,(hn+1)*Jt/Dn.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,hn,Dn.width,Dn.height,1,sr,di,In)}He.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Dn.width,Dn.height,Dn.depth,sr,di,Dn.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,zr,Dn.width,Dn.height,Dn.depth,0,sr,di,Dn.data);else if(He.isData3DTexture)Wr?(Si&&t.texStorage3D(n.TEXTURE_3D,Bt,zr,Dn.width,Dn.height,Dn.depth),Ne&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Dn.width,Dn.height,Dn.depth,sr,di,Dn.data)):t.texImage3D(n.TEXTURE_3D,0,zr,Dn.width,Dn.height,Dn.depth,0,sr,di,Dn.data);else if(He.isFramebufferTexture){if(Si)if(Wr)t.texStorage2D(n.TEXTURE_2D,Bt,zr,Dn.width,Dn.height);else{let Jt=Dn.width,hn=Dn.height;for(let In=0;In<Bt;In++)t.texImage2D(n.TEXTURE_2D,In,zr,Jt,hn,0,sr,di,null),Jt>>=1,hn>>=1}}else if(Ur.length>0){if(Wr&&Si){const Jt=on(Ur[0]);t.texStorage2D(n.TEXTURE_2D,Bt,zr,Jt.width,Jt.height)}for(let Jt=0,hn=Ur.length;Jt<hn;Jt++)ar=Ur[Jt],Wr?Ne&&t.texSubImage2D(n.TEXTURE_2D,Jt,0,0,sr,di,ar):t.texImage2D(n.TEXTURE_2D,Jt,zr,sr,di,ar);He.generateMipmaps=!1}else if(Wr){if(Si){const Jt=on(Dn);t.texStorage2D(n.TEXTURE_2D,Bt,zr,Jt.width,Jt.height)}Ne&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,sr,di,Dn)}else t.texImage2D(n.TEXTURE_2D,0,zr,sr,di,Dn);E(He)&&C(Tn),gr.__version=Wt.version,He.onUpdate&&He.onUpdate(He)}ct.__version=He.version}function lt(ct,He,qt){if(He.image.length!==6)return;const Tn=vt(ct,He),An=He.source;t.bindTexture(n.TEXTURE_CUBE_MAP,ct.__webglTexture,n.TEXTURE0+qt);const Wt=r.get(An);if(An.version!==Wt.__version||Tn===!0){t.activeTexture(n.TEXTURE0+qt);const gr=_s.getPrimaries(_s.workingColorSpace),Gn=He.colorSpace===Bm?null:_s.getPrimaries(He.colorSpace),nr=He.colorSpace===Bm||gr===Gn?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,He.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,He.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,He.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,nr);const Ar=He.isCompressedTexture||He.image[0].isCompressedTexture,Dn=He.image[0]&&He.image[0].isDataTexture,sr=[];for(let hn=0;hn<6;hn++)!Ar&&!Dn?sr[hn]=I(He.image[hn],!0,s.maxCubemapSize):sr[hn]=Dn?He.image[hn].image:He.image[hn],sr[hn]=Vn(He,sr[hn]);const di=sr[0],zr=o.convert(He.format,He.colorSpace),ar=o.convert(He.type),Ur=L(He.internalFormat,zr,ar,He.colorSpace),Wr=He.isVideoTexture!==!0,Si=Wt.__version===void 0||Tn===!0,Ne=An.dataReady;let Bt=H(He,di);gt(n.TEXTURE_CUBE_MAP,He);let Jt;if(Ar){Wr&&Si&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Bt,Ur,di.width,di.height);for(let hn=0;hn<6;hn++){Jt=sr[hn].mipmaps;for(let In=0;In<Jt.length;In++){const Tr=Jt[In];He.format!==Zl?zr!==null?Wr?Ne&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In,0,0,Tr.width,Tr.height,zr,Tr.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In,Ur,Tr.width,Tr.height,0,Tr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Wr?Ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In,0,0,Tr.width,Tr.height,zr,ar,Tr.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In,Ur,Tr.width,Tr.height,0,zr,ar,Tr.data)}}}else{if(Jt=He.mipmaps,Wr&&Si){Jt.length>0&&Bt++;const hn=on(sr[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Bt,Ur,hn.width,hn.height)}for(let hn=0;hn<6;hn++)if(Dn){Wr?Ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,0,0,sr[hn].width,sr[hn].height,zr,ar,sr[hn].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,Ur,sr[hn].width,sr[hn].height,0,zr,ar,sr[hn].data);for(let In=0;In<Jt.length;In++){const jr=Jt[In].image[hn].image;Wr?Ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In+1,0,0,jr.width,jr.height,zr,ar,jr.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In+1,Ur,jr.width,jr.height,0,zr,ar,jr.data)}}else{Wr?Ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,0,0,zr,ar,sr[hn]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,Ur,zr,ar,sr[hn]);for(let In=0;In<Jt.length;In++){const Tr=Jt[In];Wr?Ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In+1,0,0,zr,ar,Tr.image[hn]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,In+1,Ur,zr,ar,Tr.image[hn])}}}E(He)&&C(n.TEXTURE_CUBE_MAP),Wt.__version=An.version,He.onUpdate&&He.onUpdate(He)}ct.__version=He.version}function jt(ct,He,qt,Tn,An,Wt){const gr=o.convert(qt.format,qt.colorSpace),Gn=o.convert(qt.type),nr=L(qt.internalFormat,gr,Gn,qt.colorSpace);if(!r.get(He).__hasExternalTextures){const Dn=Math.max(1,He.width>>Wt),sr=Math.max(1,He.height>>Wt);An===n.TEXTURE_3D||An===n.TEXTURE_2D_ARRAY?t.texImage3D(An,Wt,nr,Dn,sr,He.depth,0,gr,Gn,null):t.texImage2D(An,Wt,nr,Dn,sr,0,gr,Gn,null)}t.bindFramebuffer(n.FRAMEBUFFER,ct),en(He)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Tn,An,r.get(qt).__webglTexture,0,At(He)):(An===n.TEXTURE_2D||An>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&An<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Tn,An,r.get(qt).__webglTexture,Wt),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qt(ct,He,qt){if(n.bindRenderbuffer(n.RENDERBUFFER,ct),He.depthBuffer){const Tn=He.depthTexture,An=Tn&&Tn.isDepthTexture?Tn.type:null,Wt=O(He.stencilBuffer,An),gr=He.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Gn=At(He);en(He)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Gn,Wt,He.width,He.height):qt?n.renderbufferStorageMultisample(n.RENDERBUFFER,Gn,Wt,He.width,He.height):n.renderbufferStorage(n.RENDERBUFFER,Wt,He.width,He.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,gr,n.RENDERBUFFER,ct)}else{const Tn=He.textures;for(let An=0;An<Tn.length;An++){const Wt=Tn[An],gr=o.convert(Wt.format,Wt.colorSpace),Gn=o.convert(Wt.type),nr=L(Wt.internalFormat,gr,Gn,Wt.colorSpace),Ar=At(He);qt&&en(He)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ar,nr,He.width,He.height):en(He)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ar,nr,He.width,He.height):n.renderbufferStorage(n.RENDERBUFFER,nr,He.width,He.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function nn(ct,He){if(He&&He.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,ct),!(He.depthTexture&&He.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(He.depthTexture).__webglTexture||He.depthTexture.image.width!==He.width||He.depthTexture.image.height!==He.height)&&(He.depthTexture.image.width=He.width,He.depthTexture.image.height=He.height,He.depthTexture.needsUpdate=!0),Pe(He.depthTexture,0);const Tn=r.get(He.depthTexture).__webglTexture,An=At(He);if(He.depthTexture.format===Yy)en(He)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Tn,0,An):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Tn,0);else if(He.depthTexture.format===dx)en(He)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Tn,0,An):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Tn,0);else throw new Error("Unknown depthTexture format")}function Wn(ct){const He=r.get(ct),qt=ct.isWebGLCubeRenderTarget===!0;if(ct.depthTexture&&!He.__autoAllocateDepthBuffer){if(qt)throw new Error("target.depthTexture not supported in Cube render targets");nn(He.__webglFramebuffer,ct)}else if(qt){He.__webglDepthbuffer=[];for(let Tn=0;Tn<6;Tn++)t.bindFramebuffer(n.FRAMEBUFFER,He.__webglFramebuffer[Tn]),He.__webglDepthbuffer[Tn]=n.createRenderbuffer(),Qt(He.__webglDepthbuffer[Tn],ct,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,He.__webglFramebuffer),He.__webglDepthbuffer=n.createRenderbuffer(),Qt(He.__webglDepthbuffer,ct,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function kn(ct,He,qt){const Tn=r.get(ct);He!==void 0&&jt(Tn.__webglFramebuffer,ct,ct.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),qt!==void 0&&Wn(ct)}function Mn(ct){const He=ct.texture,qt=r.get(ct),Tn=r.get(He);ct.addEventListener("dispose",Z);const An=ct.textures,Wt=ct.isWebGLCubeRenderTarget===!0,gr=An.length>1;if(gr||(Tn.__webglTexture===void 0&&(Tn.__webglTexture=n.createTexture()),Tn.__version=He.version,l.memory.textures++),Wt){qt.__webglFramebuffer=[];for(let Gn=0;Gn<6;Gn++)if(He.mipmaps&&He.mipmaps.length>0){qt.__webglFramebuffer[Gn]=[];for(let nr=0;nr<He.mipmaps.length;nr++)qt.__webglFramebuffer[Gn][nr]=n.createFramebuffer()}else qt.__webglFramebuffer[Gn]=n.createFramebuffer()}else{if(He.mipmaps&&He.mipmaps.length>0){qt.__webglFramebuffer=[];for(let Gn=0;Gn<He.mipmaps.length;Gn++)qt.__webglFramebuffer[Gn]=n.createFramebuffer()}else qt.__webglFramebuffer=n.createFramebuffer();if(gr)for(let Gn=0,nr=An.length;Gn<nr;Gn++){const Ar=r.get(An[Gn]);Ar.__webglTexture===void 0&&(Ar.__webglTexture=n.createTexture(),l.memory.textures++)}if(ct.samples>0&&en(ct)===!1){qt.__webglMultisampledFramebuffer=n.createFramebuffer(),qt.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,qt.__webglMultisampledFramebuffer);for(let Gn=0;Gn<An.length;Gn++){const nr=An[Gn];qt.__webglColorRenderbuffer[Gn]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,qt.__webglColorRenderbuffer[Gn]);const Ar=o.convert(nr.format,nr.colorSpace),Dn=o.convert(nr.type),sr=L(nr.internalFormat,Ar,Dn,nr.colorSpace,ct.isXRRenderTarget===!0),di=At(ct);n.renderbufferStorageMultisample(n.RENDERBUFFER,di,sr,ct.width,ct.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Gn,n.RENDERBUFFER,qt.__webglColorRenderbuffer[Gn])}n.bindRenderbuffer(n.RENDERBUFFER,null),ct.depthBuffer&&(qt.__webglDepthRenderbuffer=n.createRenderbuffer(),Qt(qt.__webglDepthRenderbuffer,ct,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Wt){t.bindTexture(n.TEXTURE_CUBE_MAP,Tn.__webglTexture),gt(n.TEXTURE_CUBE_MAP,He);for(let Gn=0;Gn<6;Gn++)if(He.mipmaps&&He.mipmaps.length>0)for(let nr=0;nr<He.mipmaps.length;nr++)jt(qt.__webglFramebuffer[Gn][nr],ct,He,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Gn,nr);else jt(qt.__webglFramebuffer[Gn],ct,He,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Gn,0);E(He)&&C(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(gr){for(let Gn=0,nr=An.length;Gn<nr;Gn++){const Ar=An[Gn],Dn=r.get(Ar);t.bindTexture(n.TEXTURE_2D,Dn.__webglTexture),gt(n.TEXTURE_2D,Ar),jt(qt.__webglFramebuffer,ct,Ar,n.COLOR_ATTACHMENT0+Gn,n.TEXTURE_2D,0),E(Ar)&&C(n.TEXTURE_2D)}t.unbindTexture()}else{let Gn=n.TEXTURE_2D;if((ct.isWebGL3DRenderTarget||ct.isWebGLArrayRenderTarget)&&(Gn=ct.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Gn,Tn.__webglTexture),gt(Gn,He),He.mipmaps&&He.mipmaps.length>0)for(let nr=0;nr<He.mipmaps.length;nr++)jt(qt.__webglFramebuffer[nr],ct,He,n.COLOR_ATTACHMENT0,Gn,nr);else jt(qt.__webglFramebuffer,ct,He,n.COLOR_ATTACHMENT0,Gn,0);E(He)&&C(Gn),t.unbindTexture()}ct.depthBuffer&&Wn(ct)}function De(ct){const He=ct.textures;for(let qt=0,Tn=He.length;qt<Tn;qt++){const An=He[qt];if(E(An)){const Wt=ct.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,gr=r.get(An).__webglTexture;t.bindTexture(Wt,gr),C(Wt),t.unbindTexture()}}}const Ye=[],gn=[];function un(ct){if(ct.samples>0){if(en(ct)===!1){const He=ct.textures,qt=ct.width,Tn=ct.height;let An=n.COLOR_BUFFER_BIT;const Wt=ct.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,gr=r.get(ct),Gn=He.length>1;if(Gn)for(let nr=0;nr<He.length;nr++)t.bindFramebuffer(n.FRAMEBUFFER,gr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nr,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,gr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nr,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,gr.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,gr.__webglFramebuffer);for(let nr=0;nr<He.length;nr++){if(ct.resolveDepthBuffer&&(ct.depthBuffer&&(An|=n.DEPTH_BUFFER_BIT),ct.stencilBuffer&&ct.resolveStencilBuffer&&(An|=n.STENCIL_BUFFER_BIT)),Gn){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,gr.__webglColorRenderbuffer[nr]);const Ar=r.get(He[nr]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ar,0)}n.blitFramebuffer(0,0,qt,Tn,0,0,qt,Tn,An,n.NEAREST),a===!0&&(Ye.length=0,gn.length=0,Ye.push(n.COLOR_ATTACHMENT0+nr),ct.depthBuffer&&ct.resolveDepthBuffer===!1&&(Ye.push(Wt),gn.push(Wt),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,gn)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ye))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Gn)for(let nr=0;nr<He.length;nr++){t.bindFramebuffer(n.FRAMEBUFFER,gr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nr,n.RENDERBUFFER,gr.__webglColorRenderbuffer[nr]);const Ar=r.get(He[nr]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,gr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nr,n.TEXTURE_2D,Ar,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,gr.__webglMultisampledFramebuffer)}else if(ct.depthBuffer&&ct.resolveDepthBuffer===!1&&a){const He=ct.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[He])}}}function At(ct){return Math.min(s.maxSamples,ct.samples)}function en(ct){const He=r.get(ct);return ct.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&He.__useRenderToTexture!==!1}function On(ct){const He=l.render.frame;f.get(ct)!==He&&(f.set(ct,He),ct.update())}function Vn(ct,He){const qt=ct.colorSpace,Tn=ct.format,An=ct.type;return ct.isCompressedTexture===!0||ct.isVideoTexture===!0||qt!==$a&&qt!==Bm&&(_s.getTransfer(qt)===io?(Tn!==Zl||An!==tf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",qt)),He}function on(ct){return typeof HTMLImageElement<"u"&&ct instanceof HTMLImageElement?(d.width=ct.naturalWidth||ct.width,d.height=ct.naturalHeight||ct.height):typeof VideoFrame<"u"&&ct instanceof VideoFrame?(d.width=ct.displayWidth,d.height=ct.displayHeight):(d.width=ct.width,d.height=ct.height),d}this.allocateTextureUnit=Ae,this.resetTextureUnits=he,this.setTexture2D=Pe,this.setTexture2DArray=ze,this.setTexture3D=Re,this.setTextureCube=rt,this.rebindTextures=kn,this.setupRenderTarget=Mn,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=un,this.setupDepthRenderbuffer=Wn,this.setupFrameBufferTexture=jt,this.useMultisampledRTT=en}function cre(n,e){function t(r,s=Bm){let o;const l=_s.getTransfer(s);if(r===tf)return n.UNSIGNED_BYTE;if(r===ID)return n.UNSIGNED_SHORT_4_4_4_4;if(r===PD)return n.UNSIGNED_SHORT_5_5_5_1;if(r===v6)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===m6)return n.BYTE;if(r===g6)return n.SHORT;if(r===vw)return n.UNSIGNED_SHORT;if(r===ED)return n.INT;if(r===eg)return n.UNSIGNED_INT;if(r===Ec)return n.FLOAT;if(r===Bh)return n.HALF_FLOAT;if(r===_6)return n.ALPHA;if(r===y6)return n.RGB;if(r===Zl)return n.RGBA;if(r===x6)return n.LUMINANCE;if(r===b6)return n.LUMINANCE_ALPHA;if(r===Yy)return n.DEPTH_COMPONENT;if(r===dx)return n.DEPTH_STENCIL;if(r===uC)return n.RED;if(r===hC)return n.RED_INTEGER;if(r===w6)return n.RG;if(r===RD)return n.RG_INTEGER;if(r===LD)return n.RGBA_INTEGER;if(r===pT||r===mT||r===gT||r===vT)if(l===io)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(r===pT)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===mT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===gT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===vT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(r===pT)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===mT)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===gT)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===vT)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===xR||r===bR||r===wR||r===SR)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(r===xR)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===bR)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===wR)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===SR)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===AR||r===TR||r===MR)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(r===AR||r===TR)return l===io?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(r===MR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===CR||r===ER||r===IR||r===PR||r===RR||r===LR||r===DR||r===BR||r===kR||r===OR||r===FR||r===NR||r===zR||r===UR)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(r===CR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===ER)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===IR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===PR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===RR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===LR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===DR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===BR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===kR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===OR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===FR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===NR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===zR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===UR)return l===io?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===_T||r===GR||r===VR)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(r===_T)return l===io?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===GR)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===VR)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===S6||r===HR||r===jR||r===WR)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(r===_T)return o.COMPRESSED_RED_RGTC1_EXT;if(r===HR)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===jR)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===WR)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===hx?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}class ure extends is{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Kl=class extends Bi{constructor(){super(),this.isGroup=!0,this.type="Group"}};const Iwe={type:"move"};class pF{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Kl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Kl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Kl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ze),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let s=null,o=null,l=null;const c=this._targetRay,a=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){l=!0;for(const I of e.hand.values()){const E=t.getJointPose(I,r),C=this._getHandJoint(d,I);E!==null&&(C.matrix.fromArray(E.transform.matrix),C.matrix.decompose(C.position,C.rotation,C.scale),C.matrixWorldNeedsUpdate=!0,C.jointRadius=E.radius),C.visible=E!==null}const f=d.joints["index-finger-tip"],m=d.joints["thumb-tip"],_=f.position.distanceTo(m.position),x=.02,A=.005;d.inputState.pinching&&_>x+A?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&_<=x-A&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,r),o!==null&&(a.matrix.fromArray(o.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,o.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(o.linearVelocity)):a.hasLinearVelocity=!1,o.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(o.angularVelocity)):a.hasAngularVelocity=!1));c!==null&&(s=t.getPose(e.targetRaySpace,r),s===null&&o!==null&&(s=o),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(Iwe)))}return c!==null&&(c.visible=s!==null),a!==null&&(a.visible=o!==null),d!==null&&(d.visible=l!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new Kl;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const Pwe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Rwe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Lwe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const s=new Ys,o=e.properties.get(s);o.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Lo({vertexShader:Pwe,fragmentShader:Rwe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Di(new hg(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Dwe extends Tp{constructor(e,t){super();const r=this;let s=null,o=1,l=null,c="local-floor",a=1,d=null,f=null,m=null,_=null,x=null,A=null;const I=new Lwe,E=t.getContextAttributes();let C=null,L=null;const O=[],H=[],q=new sn;let Z=null;const J=new is;J.layers.enable(1),J.viewport=new Ls;const re=new is;re.layers.enable(2),re.viewport=new Ls;const se=[J,re],ae=new ure;ae.layers.enable(1),ae.layers.enable(2);let he=null,Ae=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(lt){let jt=O[lt];return jt===void 0&&(jt=new pF,O[lt]=jt),jt.getTargetRaySpace()},this.getControllerGrip=function(lt){let jt=O[lt];return jt===void 0&&(jt=new pF,O[lt]=jt),jt.getGripSpace()},this.getHand=function(lt){let jt=O[lt];return jt===void 0&&(jt=new pF,O[lt]=jt),jt.getHandSpace()};function Ee(lt){const jt=H.indexOf(lt.inputSource);if(jt===-1)return;const Qt=O[jt];Qt!==void 0&&(Qt.update(lt.inputSource,lt.frame,d||l),Qt.dispatchEvent({type:lt.type,data:lt.inputSource}))}function Pe(){s.removeEventListener("select",Ee),s.removeEventListener("selectstart",Ee),s.removeEventListener("selectend",Ee),s.removeEventListener("squeeze",Ee),s.removeEventListener("squeezestart",Ee),s.removeEventListener("squeezeend",Ee),s.removeEventListener("end",Pe),s.removeEventListener("inputsourceschange",ze);for(let lt=0;lt<O.length;lt++){const jt=H[lt];jt!==null&&(H[lt]=null,O[lt].disconnect(jt))}he=null,Ae=null,I.reset(),e.setRenderTarget(C),x=null,_=null,m=null,s=null,L=null,Dt.stop(),r.isPresenting=!1,e.setPixelRatio(Z),e.setSize(q.width,q.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(lt){o=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(lt){c=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||l},this.setReferenceSpace=function(lt){d=lt},this.getBaseLayer=function(){return _!==null?_:x},this.getBinding=function(){return m},this.getFrame=function(){return A},this.getSession=function(){return s},this.setSession=async function(lt){if(s=lt,s!==null){if(C=e.getRenderTarget(),s.addEventListener("select",Ee),s.addEventListener("selectstart",Ee),s.addEventListener("selectend",Ee),s.addEventListener("squeeze",Ee),s.addEventListener("squeezestart",Ee),s.addEventListener("squeezeend",Ee),s.addEventListener("end",Pe),s.addEventListener("inputsourceschange",ze),E.xrCompatible!==!0&&await t.makeXRCompatible(),Z=e.getPixelRatio(),e.getSize(q),s.renderState.layers===void 0){const jt={antialias:E.antialias,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:o};x=new XRWebGLLayer(s,t,jt),s.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),L=new Ml(x.framebufferWidth,x.framebufferHeight,{format:Zl,type:tf,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil})}else{let jt=null,Qt=null,nn=null;E.depth&&(nn=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,jt=E.stencil?dx:Yy,Qt=E.stencil?hx:eg);const Wn={colorFormat:t.RGBA8,depthFormat:nn,scaleFactor:o};m=new XRWebGLBinding(s,t),_=m.createProjectionLayer(Wn),s.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),L=new Ml(_.textureWidth,_.textureHeight,{format:Zl,type:tf,depthTexture:new D6(_.textureWidth,_.textureHeight,Qt,void 0,void 0,void 0,void 0,void 0,void 0,jt),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1})}L.isXRRenderTarget=!0,this.setFoveation(a),d=null,l=await s.requestReferenceSpace(c),Dt.setContext(s),Dt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return I.getDepthTexture()};function ze(lt){for(let jt=0;jt<lt.removed.length;jt++){const Qt=lt.removed[jt],nn=H.indexOf(Qt);nn>=0&&(H[nn]=null,O[nn].disconnect(Qt))}for(let jt=0;jt<lt.added.length;jt++){const Qt=lt.added[jt];let nn=H.indexOf(Qt);if(nn===-1){for(let kn=0;kn<O.length;kn++)if(kn>=H.length){H.push(Qt),nn=kn;break}else if(H[kn]===null){H[kn]=Qt,nn=kn;break}if(nn===-1)break}const Wn=O[nn];Wn&&Wn.connect(Qt)}}const Re=new Ze,rt=new Ze;function ye(lt,jt,Qt){Re.setFromMatrixPosition(jt.matrixWorld),rt.setFromMatrixPosition(Qt.matrixWorld);const nn=Re.distanceTo(rt),Wn=jt.projectionMatrix.elements,kn=Qt.projectionMatrix.elements,Mn=Wn[14]/(Wn[10]-1),De=Wn[14]/(Wn[10]+1),Ye=(Wn[9]+1)/Wn[5],gn=(Wn[9]-1)/Wn[5],un=(Wn[8]-1)/Wn[0],At=(kn[8]+1)/kn[0],en=Mn*un,On=Mn*At,Vn=nn/(-un+At),on=Vn*-un;jt.matrixWorld.decompose(lt.position,lt.quaternion,lt.scale),lt.translateX(on),lt.translateZ(Vn),lt.matrixWorld.compose(lt.position,lt.quaternion,lt.scale),lt.matrixWorldInverse.copy(lt.matrixWorld).invert();const ct=Mn+Vn,He=De+Vn,qt=en-on,Tn=On+(nn-on),An=Ye*De/He*ct,Wt=gn*De/He*ct;lt.projectionMatrix.makePerspective(qt,Tn,An,Wt,ct,He),lt.projectionMatrixInverse.copy(lt.projectionMatrix).invert()}function We(lt,jt){jt===null?lt.matrixWorld.copy(lt.matrix):lt.matrixWorld.multiplyMatrices(jt.matrixWorld,lt.matrix),lt.matrixWorldInverse.copy(lt.matrixWorld).invert()}this.updateCamera=function(lt){if(s===null)return;I.texture!==null&&(lt.near=I.depthNear,lt.far=I.depthFar),ae.near=re.near=J.near=lt.near,ae.far=re.far=J.far=lt.far,(he!==ae.near||Ae!==ae.far)&&(s.updateRenderState({depthNear:ae.near,depthFar:ae.far}),he=ae.near,Ae=ae.far,J.near=he,J.far=Ae,re.near=he,re.far=Ae,J.updateProjectionMatrix(),re.updateProjectionMatrix(),lt.updateProjectionMatrix());const jt=lt.parent,Qt=ae.cameras;We(ae,jt);for(let nn=0;nn<Qt.length;nn++)We(Qt[nn],jt);Qt.length===2?ye(ae,J,re):ae.projectionMatrix.copy(J.projectionMatrix),Ue(lt,ae,jt)};function Ue(lt,jt,Qt){Qt===null?lt.matrix.copy(jt.matrixWorld):(lt.matrix.copy(Qt.matrixWorld),lt.matrix.invert(),lt.matrix.multiply(jt.matrixWorld)),lt.matrix.decompose(lt.position,lt.quaternion,lt.scale),lt.updateMatrixWorld(!0),lt.projectionMatrix.copy(jt.projectionMatrix),lt.projectionMatrixInverse.copy(jt.projectionMatrixInverse),lt.isPerspectiveCamera&&(lt.fov=_w*2*Math.atan(1/lt.projectionMatrix.elements[5]),lt.zoom=1)}this.getCamera=function(){return ae},this.getFoveation=function(){if(!(_===null&&x===null))return a},this.setFoveation=function(lt){a=lt,_!==null&&(_.fixedFoveation=lt),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=lt)},this.hasDepthSensing=function(){return I.texture!==null},this.getDepthSensingMesh=function(){return I.getMesh(ae)};let gt=null;function vt(lt,jt){if(f=jt.getViewerPose(d||l),A=jt,f!==null){const Qt=f.views;x!==null&&(e.setRenderTargetFramebuffer(L,x.framebuffer),e.setRenderTarget(L));let nn=!1;Qt.length!==ae.cameras.length&&(ae.cameras.length=0,nn=!0);for(let kn=0;kn<Qt.length;kn++){const Mn=Qt[kn];let De=null;if(x!==null)De=x.getViewport(Mn);else{const gn=m.getViewSubImage(_,Mn);De=gn.viewport,kn===0&&(e.setRenderTargetTextures(L,gn.colorTexture,_.ignoreDepthValues?void 0:gn.depthStencilTexture),e.setRenderTarget(L))}let Ye=se[kn];Ye===void 0&&(Ye=new is,Ye.layers.enable(kn),Ye.viewport=new Ls,se[kn]=Ye),Ye.matrix.fromArray(Mn.transform.matrix),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.projectionMatrix.fromArray(Mn.projectionMatrix),Ye.projectionMatrixInverse.copy(Ye.projectionMatrix).invert(),Ye.viewport.set(De.x,De.y,De.width,De.height),kn===0&&(ae.matrix.copy(Ye.matrix),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale)),nn===!0&&ae.cameras.push(Ye)}const Wn=s.enabledFeatures;if(Wn&&Wn.includes("depth-sensing")){const kn=m.getDepthInformation(Qt[0]);kn&&kn.isValid&&kn.texture&&I.init(e,kn,s.renderState)}}for(let Qt=0;Qt<O.length;Qt++){const nn=H[Qt],Wn=O[Qt];nn!==null&&Wn!==void 0&&Wn.update(nn,jt,d||l)}gt&&gt(lt,jt),jt.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:jt}),A=null}const Dt=new ire;Dt.setAnimationLoop(vt),this.setAnimationLoop=function(lt){gt=lt},this.dispose=function(){}}}const O_=new ju,Bwe=new Hr;function kwe(n,e){function t(E,C){E.matrixAutoUpdate===!0&&E.updateMatrix(),C.value.copy(E.matrix)}function r(E,C){C.color.getRGB(E.fogColor.value,tre(n)),C.isFog?(E.fogNear.value=C.near,E.fogFar.value=C.far):C.isFogExp2&&(E.fogDensity.value=C.density)}function s(E,C,L,O,H){C.isMeshBasicMaterial||C.isMeshLambertMaterial?o(E,C):C.isMeshToonMaterial?(o(E,C),m(E,C)):C.isMeshPhongMaterial?(o(E,C),f(E,C)):C.isMeshStandardMaterial?(o(E,C),_(E,C),C.isMeshPhysicalMaterial&&x(E,C,H)):C.isMeshMatcapMaterial?(o(E,C),A(E,C)):C.isMeshDepthMaterial?o(E,C):C.isMeshDistanceMaterial?(o(E,C),I(E,C)):C.isMeshNormalMaterial?o(E,C):C.isLineBasicMaterial?(l(E,C),C.isLineDashedMaterial&&c(E,C)):C.isPointsMaterial?a(E,C,L,O):C.isSpriteMaterial?d(E,C):C.isShadowMaterial?(E.color.value.copy(C.color),E.opacity.value=C.opacity):C.isShaderMaterial&&(C.uniformsNeedUpdate=!1)}function o(E,C){E.opacity.value=C.opacity,C.color&&E.diffuse.value.copy(C.color),C.emissive&&E.emissive.value.copy(C.emissive).multiplyScalar(C.emissiveIntensity),C.map&&(E.map.value=C.map,t(C.map,E.mapTransform)),C.alphaMap&&(E.alphaMap.value=C.alphaMap,t(C.alphaMap,E.alphaMapTransform)),C.bumpMap&&(E.bumpMap.value=C.bumpMap,t(C.bumpMap,E.bumpMapTransform),E.bumpScale.value=C.bumpScale,C.side===Rc&&(E.bumpScale.value*=-1)),C.normalMap&&(E.normalMap.value=C.normalMap,t(C.normalMap,E.normalMapTransform),E.normalScale.value.copy(C.normalScale),C.side===Rc&&E.normalScale.value.negate()),C.displacementMap&&(E.displacementMap.value=C.displacementMap,t(C.displacementMap,E.displacementMapTransform),E.displacementScale.value=C.displacementScale,E.displacementBias.value=C.displacementBias),C.emissiveMap&&(E.emissiveMap.value=C.emissiveMap,t(C.emissiveMap,E.emissiveMapTransform)),C.specularMap&&(E.specularMap.value=C.specularMap,t(C.specularMap,E.specularMapTransform)),C.alphaTest>0&&(E.alphaTest.value=C.alphaTest);const L=e.get(C),O=L.envMap,H=L.envMapRotation;O&&(E.envMap.value=O,O_.copy(H),O_.x*=-1,O_.y*=-1,O_.z*=-1,O.isCubeTexture&&O.isRenderTargetTexture===!1&&(O_.y*=-1,O_.z*=-1),E.envMapRotation.value.setFromMatrix4(Bwe.makeRotationFromEuler(O_)),E.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=C.reflectivity,E.ior.value=C.ior,E.refractionRatio.value=C.refractionRatio),C.lightMap&&(E.lightMap.value=C.lightMap,E.lightMapIntensity.value=C.lightMapIntensity,t(C.lightMap,E.lightMapTransform)),C.aoMap&&(E.aoMap.value=C.aoMap,E.aoMapIntensity.value=C.aoMapIntensity,t(C.aoMap,E.aoMapTransform))}function l(E,C){E.diffuse.value.copy(C.color),E.opacity.value=C.opacity,C.map&&(E.map.value=C.map,t(C.map,E.mapTransform))}function c(E,C){E.dashSize.value=C.dashSize,E.totalSize.value=C.dashSize+C.gapSize,E.scale.value=C.scale}function a(E,C,L,O){E.diffuse.value.copy(C.color),E.opacity.value=C.opacity,E.size.value=C.size*L,E.scale.value=O*.5,C.map&&(E.map.value=C.map,t(C.map,E.uvTransform)),C.alphaMap&&(E.alphaMap.value=C.alphaMap,t(C.alphaMap,E.alphaMapTransform)),C.alphaTest>0&&(E.alphaTest.value=C.alphaTest)}function d(E,C){E.diffuse.value.copy(C.color),E.opacity.value=C.opacity,E.rotation.value=C.rotation,C.map&&(E.map.value=C.map,t(C.map,E.mapTransform)),C.alphaMap&&(E.alphaMap.value=C.alphaMap,t(C.alphaMap,E.alphaMapTransform)),C.alphaTest>0&&(E.alphaTest.value=C.alphaTest)}function f(E,C){E.specular.value.copy(C.specular),E.shininess.value=Math.max(C.shininess,1e-4)}function m(E,C){C.gradientMap&&(E.gradientMap.value=C.gradientMap)}function _(E,C){E.metalness.value=C.metalness,C.metalnessMap&&(E.metalnessMap.value=C.metalnessMap,t(C.metalnessMap,E.metalnessMapTransform)),E.roughness.value=C.roughness,C.roughnessMap&&(E.roughnessMap.value=C.roughnessMap,t(C.roughnessMap,E.roughnessMapTransform)),C.envMap&&(E.envMapIntensity.value=C.envMapIntensity)}function x(E,C,L){E.ior.value=C.ior,C.sheen>0&&(E.sheenColor.value.copy(C.sheenColor).multiplyScalar(C.sheen),E.sheenRoughness.value=C.sheenRoughness,C.sheenColorMap&&(E.sheenColorMap.value=C.sheenColorMap,t(C.sheenColorMap,E.sheenColorMapTransform)),C.sheenRoughnessMap&&(E.sheenRoughnessMap.value=C.sheenRoughnessMap,t(C.sheenRoughnessMap,E.sheenRoughnessMapTransform))),C.clearcoat>0&&(E.clearcoat.value=C.clearcoat,E.clearcoatRoughness.value=C.clearcoatRoughness,C.clearcoatMap&&(E.clearcoatMap.value=C.clearcoatMap,t(C.clearcoatMap,E.clearcoatMapTransform)),C.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=C.clearcoatRoughnessMap,t(C.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),C.clearcoatNormalMap&&(E.clearcoatNormalMap.value=C.clearcoatNormalMap,t(C.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(C.clearcoatNormalScale),C.side===Rc&&E.clearcoatNormalScale.value.negate())),C.dispersion>0&&(E.dispersion.value=C.dispersion),C.iridescence>0&&(E.iridescence.value=C.iridescence,E.iridescenceIOR.value=C.iridescenceIOR,E.iridescenceThicknessMinimum.value=C.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=C.iridescenceThicknessRange[1],C.iridescenceMap&&(E.iridescenceMap.value=C.iridescenceMap,t(C.iridescenceMap,E.iridescenceMapTransform)),C.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=C.iridescenceThicknessMap,t(C.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),C.transmission>0&&(E.transmission.value=C.transmission,E.transmissionSamplerMap.value=L.texture,E.transmissionSamplerSize.value.set(L.width,L.height),C.transmissionMap&&(E.transmissionMap.value=C.transmissionMap,t(C.transmissionMap,E.transmissionMapTransform)),E.thickness.value=C.thickness,C.thicknessMap&&(E.thicknessMap.value=C.thicknessMap,t(C.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=C.attenuationDistance,E.attenuationColor.value.copy(C.attenuationColor)),C.anisotropy>0&&(E.anisotropyVector.value.set(C.anisotropy*Math.cos(C.anisotropyRotation),C.anisotropy*Math.sin(C.anisotropyRotation)),C.anisotropyMap&&(E.anisotropyMap.value=C.anisotropyMap,t(C.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=C.specularIntensity,E.specularColor.value.copy(C.specularColor),C.specularColorMap&&(E.specularColorMap.value=C.specularColorMap,t(C.specularColorMap,E.specularColorMapTransform)),C.specularIntensityMap&&(E.specularIntensityMap.value=C.specularIntensityMap,t(C.specularIntensityMap,E.specularIntensityMapTransform))}function A(E,C){C.matcap&&(E.matcap.value=C.matcap)}function I(E,C){const L=e.get(C).light;E.referencePosition.value.setFromMatrixPosition(L.matrixWorld),E.nearDistance.value=L.shadow.camera.near,E.farDistance.value=L.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:s}}function Owe(n,e,t,r){let s={},o={},l=[];const c=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function a(L,O){const H=O.program;r.uniformBlockBinding(L,H)}function d(L,O){let H=s[L.id];H===void 0&&(A(L),H=f(L),s[L.id]=H,L.addEventListener("dispose",E));const q=O.program;r.updateUBOMapping(L,q);const Z=e.render.frame;o[L.id]!==Z&&(_(L),o[L.id]=Z)}function f(L){const O=m();L.__bindingPointIndex=O;const H=n.createBuffer(),q=L.__size,Z=L.usage;return n.bindBuffer(n.UNIFORM_BUFFER,H),n.bufferData(n.UNIFORM_BUFFER,q,Z),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,O,H),H}function m(){for(let L=0;L<c;L++)if(l.indexOf(L)===-1)return l.push(L),L;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(L){const O=s[L.id],H=L.uniforms,q=L.__cache;n.bindBuffer(n.UNIFORM_BUFFER,O);for(let Z=0,J=H.length;Z<J;Z++){const re=Array.isArray(H[Z])?H[Z]:[H[Z]];for(let se=0,ae=re.length;se<ae;se++){const he=re[se];if(x(he,Z,se,q)===!0){const Ae=he.__offset,Ee=Array.isArray(he.value)?he.value:[he.value];let Pe=0;for(let ze=0;ze<Ee.length;ze++){const Re=Ee[ze],rt=I(Re);typeof Re=="number"||typeof Re=="boolean"?(he.__data[0]=Re,n.bufferSubData(n.UNIFORM_BUFFER,Ae+Pe,he.__data)):Re.isMatrix3?(he.__data[0]=Re.elements[0],he.__data[1]=Re.elements[1],he.__data[2]=Re.elements[2],he.__data[3]=0,he.__data[4]=Re.elements[3],he.__data[5]=Re.elements[4],he.__data[6]=Re.elements[5],he.__data[7]=0,he.__data[8]=Re.elements[6],he.__data[9]=Re.elements[7],he.__data[10]=Re.elements[8],he.__data[11]=0):(Re.toArray(he.__data,Pe),Pe+=rt.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Ae,he.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function x(L,O,H,q){const Z=L.value,J=O+"_"+H;if(q[J]===void 0)return typeof Z=="number"||typeof Z=="boolean"?q[J]=Z:q[J]=Z.clone(),!0;{const re=q[J];if(typeof Z=="number"||typeof Z=="boolean"){if(re!==Z)return q[J]=Z,!0}else if(re.equals(Z)===!1)return re.copy(Z),!0}return!1}function A(L){const O=L.uniforms;let H=0;const q=16;for(let J=0,re=O.length;J<re;J++){const se=Array.isArray(O[J])?O[J]:[O[J]];for(let ae=0,he=se.length;ae<he;ae++){const Ae=se[ae],Ee=Array.isArray(Ae.value)?Ae.value:[Ae.value];for(let Pe=0,ze=Ee.length;Pe<ze;Pe++){const Re=Ee[Pe],rt=I(Re),ye=H%q;ye!==0&&q-ye<rt.boundary&&(H+=q-ye),Ae.__data=new Float32Array(rt.storage/Float32Array.BYTES_PER_ELEMENT),Ae.__offset=H,H+=rt.storage}}}const Z=H%q;return Z>0&&(H+=q-Z),L.__size=H,L.__cache={},this}function I(L){const O={boundary:0,storage:0};return typeof L=="number"||typeof L=="boolean"?(O.boundary=4,O.storage=4):L.isVector2?(O.boundary=8,O.storage=8):L.isVector3||L.isColor?(O.boundary=16,O.storage=12):L.isVector4?(O.boundary=16,O.storage=16):L.isMatrix3?(O.boundary=48,O.storage=48):L.isMatrix4?(O.boundary=64,O.storage=64):L.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",L),O}function E(L){const O=L.target;O.removeEventListener("dispose",E);const H=l.indexOf(O.__bindingPointIndex);l.splice(H,1),n.deleteBuffer(s[O.id]),delete s[O.id],delete o[O.id]}function C(){for(const L in s)n.deleteBuffer(s[L]);l=[],s={},o={}}return{bind:a,update:d,dispose:C}}class ec{constructor(e={}){const{canvas:t=Kne(),context:r=null,depth:s=!0,stencil:o=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:d=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:m=!1}=e;this.isWebGLRenderer=!0;let _;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");_=r.getContextAttributes().alpha}else _=l;const x=new Uint32Array(4),A=new Int32Array(4);let I=null,E=null;const C=[],L=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Eo,this.toneMapping=mp,this.toneMappingExposure=1;const O=this;let H=!1,q=0,Z=0,J=null,re=-1,se=null;const ae=new Ls,he=new Ls;let Ae=null;const Ee=new Hn(0);let Pe=0,ze=t.width,Re=t.height,rt=1,ye=null,We=null;const Ue=new Ls(0,0,ze,Re),gt=new Ls(0,0,ze,Re);let vt=!1;const Dt=new gC;let lt=!1,jt=!1;const Qt=new Hr,nn=new Ze,Wn=new Ls,kn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Mn=!1;function De(){return J===null?rt:1}let Ye=r;function gn(je,bt){return t.getContext(je,bt)}try{const je={alpha:!0,depth:s,stencil:o,antialias:c,premultipliedAlpha:a,preserveDrawingBuffer:d,powerPreference:f,failIfMajorPerformanceCaveat:m};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${aC}`),t.addEventListener("webglcontextlost",Jt,!1),t.addEventListener("webglcontextrestored",hn,!1),t.addEventListener("webglcontextcreationerror",In,!1),Ye===null){const bt="webgl2";if(Ye=gn(bt,je),Ye===null)throw gn(bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(je){throw console.error("THREE.WebGLRenderer: "+je.message),je}let un,At,en,On,Vn,on,ct,He,qt,Tn,An,Wt,gr,Gn,nr,Ar,Dn,sr,di,zr,ar,Ur,Wr,Si;function Ne(){un=new j1e(Ye),un.init(),Ur=new cre(Ye,un),At=new N1e(Ye,un,e,Ur),en=new wwe(Ye),On=new X1e(Ye),Vn=new uwe,on=new Ewe(Ye,un,en,Vn,At,Ur,On),ct=new U1e(O),He=new H1e(O),qt=new eye(Ye),Wr=new O1e(Ye,qt),Tn=new W1e(Ye,qt,On,Wr),An=new Y1e(Ye,Tn,qt,On),di=new q1e(Ye,At,on),Ar=new z1e(Vn),Wt=new cwe(O,ct,He,un,At,Wr,Ar),gr=new kwe(O,Vn),Gn=new dwe,nr=new _we(un),sr=new k1e(O,ct,He,en,An,_,a),Dn=new bwe(O,An,At),Si=new Owe(Ye,On,At,en),zr=new F1e(Ye,un,On),ar=new $1e(Ye,un,On),On.programs=Wt.programs,O.capabilities=At,O.extensions=un,O.properties=Vn,O.renderLists=Gn,O.shadowMap=Dn,O.state=en,O.info=On}Ne();const Bt=new Dwe(O,Ye);this.xr=Bt,this.getContext=function(){return Ye},this.getContextAttributes=function(){return Ye.getContextAttributes()},this.forceContextLoss=function(){const je=un.get("WEBGL_lose_context");je&&je.loseContext()},this.forceContextRestore=function(){const je=un.get("WEBGL_lose_context");je&&je.restoreContext()},this.getPixelRatio=function(){return rt},this.setPixelRatio=function(je){je!==void 0&&(rt=je,this.setSize(ze,Re,!1))},this.getSize=function(je){return je.set(ze,Re)},this.setSize=function(je,bt,Ct=!0){if(Bt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ze=je,Re=bt,t.width=Math.floor(je*rt),t.height=Math.floor(bt*rt),Ct===!0&&(t.style.width=je+"px",t.style.height=bt+"px"),this.setViewport(0,0,je,bt)},this.getDrawingBufferSize=function(je){return je.set(ze*rt,Re*rt).floor()},this.setDrawingBufferSize=function(je,bt,Ct){ze=je,Re=bt,rt=Ct,t.width=Math.floor(je*Ct),t.height=Math.floor(bt*Ct),this.setViewport(0,0,je,bt)},this.getCurrentViewport=function(je){return je.copy(ae)},this.getViewport=function(je){return je.copy(Ue)},this.setViewport=function(je,bt,Ct,Et){je.isVector4?Ue.set(je.x,je.y,je.z,je.w):Ue.set(je,bt,Ct,Et),en.viewport(ae.copy(Ue).multiplyScalar(rt).round())},this.getScissor=function(je){return je.copy(gt)},this.setScissor=function(je,bt,Ct,Et){je.isVector4?gt.set(je.x,je.y,je.z,je.w):gt.set(je,bt,Ct,Et),en.scissor(he.copy(gt).multiplyScalar(rt).round())},this.getScissorTest=function(){return vt},this.setScissorTest=function(je){en.setScissorTest(vt=je)},this.setOpaqueSort=function(je){ye=je},this.setTransparentSort=function(je){We=je},this.getClearColor=function(je){return je.copy(sr.getClearColor())},this.setClearColor=function(){sr.setClearColor.apply(sr,arguments)},this.getClearAlpha=function(){return sr.getClearAlpha()},this.setClearAlpha=function(){sr.setClearAlpha.apply(sr,arguments)},this.clear=function(je=!0,bt=!0,Ct=!0){let Et=0;if(je){let Pt=!1;if(J!==null){const Sn=J.texture.format;Pt=Sn===LD||Sn===RD||Sn===hC}if(Pt){const Sn=J.texture.type,yn=Sn===tf||Sn===eg||Sn===vw||Sn===hx||Sn===ID||Sn===PD,Un=sr.getClearColor(),Xn=sr.getClearAlpha(),cr=Un.r,vr=Un.g,pr=Un.b;yn?(x[0]=cr,x[1]=vr,x[2]=pr,x[3]=Xn,Ye.clearBufferuiv(Ye.COLOR,0,x)):(A[0]=cr,A[1]=vr,A[2]=pr,A[3]=Xn,Ye.clearBufferiv(Ye.COLOR,0,A))}else Et|=Ye.COLOR_BUFFER_BIT}bt&&(Et|=Ye.DEPTH_BUFFER_BIT),Ct&&(Et|=Ye.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ye.clear(Et)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Jt,!1),t.removeEventListener("webglcontextrestored",hn,!1),t.removeEventListener("webglcontextcreationerror",In,!1),Gn.dispose(),nr.dispose(),Vn.dispose(),ct.dispose(),He.dispose(),An.dispose(),Wr.dispose(),Si.dispose(),Wt.dispose(),Bt.dispose(),Bt.removeEventListener("sessionstart",we),Bt.removeEventListener("sessionend",Ie),qe.stop()};function Jt(je){je.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function hn(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const je=On.autoReset,bt=Dn.enabled,Ct=Dn.autoUpdate,Et=Dn.needsUpdate,Pt=Dn.type;Ne(),On.autoReset=je,Dn.enabled=bt,Dn.autoUpdate=Ct,Dn.needsUpdate=Et,Dn.type=Pt}function In(je){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",je.statusMessage)}function Tr(je){const bt=je.target;bt.removeEventListener("dispose",Tr),jr(bt)}function jr(je){ps(je),Vn.remove(je)}function ps(je){const bt=Vn.get(je).programs;bt!==void 0&&(bt.forEach(function(Ct){Wt.releaseProgram(Ct)}),je.isShaderMaterial&&Wt.releaseShaderCache(je))}this.renderBufferDirect=function(je,bt,Ct,Et,Pt,Sn){bt===null&&(bt=kn);const yn=Pt.isMesh&&Pt.matrixWorld.determinant()<0,Un=cn(je,bt,Ct,Et,Pt);en.setMaterial(Et,yn);let Xn=Ct.index,cr=1;if(Et.wireframe===!0){if(Xn=Tn.getWireframeAttribute(Ct),Xn===void 0)return;cr=2}const vr=Ct.drawRange,pr=Ct.attributes.position;let pi=vr.start*cr,zi=(vr.start+vr.count)*cr;Sn!==null&&(pi=Math.max(pi,Sn.start*cr),zi=Math.min(zi,(Sn.start+Sn.count)*cr)),Xn!==null?(pi=Math.max(pi,0),zi=Math.min(zi,Xn.count)):pr!=null&&(pi=Math.max(pi,0),zi=Math.min(zi,pr.count));const Xi=zi-pi;if(Xi<0||Xi===1/0)return;Wr.setup(Pt,Et,Un,Ct,Xn);let Ms,Ir=zr;if(Xn!==null&&(Ms=qt.get(Xn),Ir=ar,Ir.setIndex(Ms)),Pt.isMesh)Et.wireframe===!0?(en.setLineWidth(Et.wireframeLinewidth*De()),Ir.setMode(Ye.LINES)):Ir.setMode(Ye.TRIANGLES);else if(Pt.isLine){let er=Et.linewidth;er===void 0&&(er=1),en.setLineWidth(er*De()),Pt.isLineSegments?Ir.setMode(Ye.LINES):Pt.isLineLoop?Ir.setMode(Ye.LINE_LOOP):Ir.setMode(Ye.LINE_STRIP)}else Pt.isPoints?Ir.setMode(Ye.POINTS):Pt.isSprite&&Ir.setMode(Ye.TRIANGLES);if(Pt.isBatchedMesh)if(Pt._multiDrawInstances!==null)Ir.renderMultiDrawInstances(Pt._multiDrawStarts,Pt._multiDrawCounts,Pt._multiDrawCount,Pt._multiDrawInstances);else if(un.get("WEBGL_multi_draw"))Ir.renderMultiDraw(Pt._multiDrawStarts,Pt._multiDrawCounts,Pt._multiDrawCount);else{const er=Pt._multiDrawStarts,Qi=Pt._multiDrawCounts,Zr=Pt._multiDrawCount,bs=Xn?qt.get(Xn).bytesPerElement:1,Yo=Vn.get(Et).currentProgram.getUniforms();for(let ks=0;ks<Zr;ks++)Yo.setValue(Ye,"_gl_DrawID",ks),Ir.render(er[ks]/bs,Qi[ks])}else if(Pt.isInstancedMesh)Ir.renderInstances(pi,Xi,Pt.count);else if(Ct.isInstancedBufferGeometry){const er=Ct._maxInstanceCount!==void 0?Ct._maxInstanceCount:1/0,Qi=Math.min(Ct.instanceCount,er);Ir.renderInstances(pi,Xi,Qi)}else Ir.render(pi,Xi)};function Bs(je,bt,Ct){je.transparent===!0&&je.side===Mc&&je.forceSinglePass===!1?(je.side=Rc,je.needsUpdate=!0,Lt(je,bt,Ct),je.side=Uh,je.needsUpdate=!0,Lt(je,bt,Ct),je.side=Mc):Lt(je,bt,Ct)}this.compile=function(je,bt,Ct=null){Ct===null&&(Ct=je),E=nr.get(Ct),E.init(bt),L.push(E),Ct.traverseVisible(function(Pt){Pt.isLight&&Pt.layers.test(bt.layers)&&(E.pushLight(Pt),Pt.castShadow&&E.pushShadow(Pt))}),je!==Ct&&je.traverseVisible(function(Pt){Pt.isLight&&Pt.layers.test(bt.layers)&&(E.pushLight(Pt),Pt.castShadow&&E.pushShadow(Pt))}),E.setupLights();const Et=new Set;return je.traverse(function(Pt){const Sn=Pt.material;if(Sn)if(Array.isArray(Sn))for(let yn=0;yn<Sn.length;yn++){const Un=Sn[yn];Bs(Un,Ct,Pt),Et.add(Un)}else Bs(Sn,Ct,Pt),Et.add(Sn)}),L.pop(),E=null,Et},this.compileAsync=function(je,bt,Ct=null){const Et=this.compile(je,bt,Ct);return new Promise(Pt=>{function Sn(){if(Et.forEach(function(yn){Vn.get(yn).currentProgram.isReady()&&Et.delete(yn)}),Et.size===0){Pt(je);return}setTimeout(Sn,10)}un.get("KHR_parallel_shader_compile")!==null?Sn():setTimeout(Sn,10)})};let fi=null;function Mt(je){fi&&fi(je)}function we(){qe.stop()}function Ie(){qe.start()}const qe=new ire;qe.setAnimationLoop(Mt),typeof self<"u"&&qe.setContext(self),this.setAnimationLoop=function(je){fi=je,Bt.setAnimationLoop(je),je===null?qe.stop():qe.start()},Bt.addEventListener("sessionstart",we),Bt.addEventListener("sessionend",Ie),this.render=function(je,bt){if(bt!==void 0&&bt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;if(je.matrixWorldAutoUpdate===!0&&je.updateMatrixWorld(),bt.parent===null&&bt.matrixWorldAutoUpdate===!0&&bt.updateMatrixWorld(),Bt.enabled===!0&&Bt.isPresenting===!0&&(Bt.cameraAutoUpdate===!0&&Bt.updateCamera(bt),bt=Bt.getCamera()),je.isScene===!0&&je.onBeforeRender(O,je,bt,J),E=nr.get(je,L.length),E.init(bt),L.push(E),Qt.multiplyMatrices(bt.projectionMatrix,bt.matrixWorldInverse),Dt.setFromProjectionMatrix(Qt),jt=this.localClippingEnabled,lt=Ar.init(this.clippingPlanes,jt),I=Gn.get(je,C.length),I.init(),C.push(I),Bt.enabled===!0&&Bt.isPresenting===!0){const Sn=O.xr.getDepthSensingMesh();Sn!==null&&it(Sn,bt,-1/0,O.sortObjects)}it(je,bt,0,O.sortObjects),I.finish(),O.sortObjects===!0&&I.sort(ye,We),Mn=Bt.enabled===!1||Bt.isPresenting===!1||Bt.hasDepthSensing()===!1,Mn&&sr.addToRenderList(I,je),this.info.render.frame++,lt===!0&&Ar.beginShadows();const Ct=E.state.shadowsArray;Dn.render(Ct,je,bt),lt===!0&&Ar.endShadows(),this.info.autoReset===!0&&this.info.reset();const Et=I.opaque,Pt=I.transmissive;if(E.setupLights(),bt.isArrayCamera){const Sn=bt.cameras;if(Pt.length>0)for(let yn=0,Un=Sn.length;yn<Un;yn++){const Xn=Sn[yn];mt(Et,Pt,je,Xn)}Mn&&sr.render(je);for(let yn=0,Un=Sn.length;yn<Un;yn++){const Xn=Sn[yn];Qe(I,je,Xn,Xn.viewport)}}else Pt.length>0&&mt(Et,Pt,je,bt),Mn&&sr.render(je),Qe(I,je,bt);J!==null&&(on.updateMultisampleRenderTarget(J),on.updateRenderTargetMipmap(J)),je.isScene===!0&&je.onAfterRender(O,je,bt),Wr.resetDefaultState(),re=-1,se=null,L.pop(),L.length>0?(E=L[L.length-1],lt===!0&&Ar.setGlobalState(O.clippingPlanes,E.state.camera)):E=null,C.pop(),C.length>0?I=C[C.length-1]:I=null};function it(je,bt,Ct,Et){if(je.visible===!1)return;if(je.layers.test(bt.layers)){if(je.isGroup)Ct=je.renderOrder;else if(je.isLOD)je.autoUpdate===!0&&je.update(bt);else if(je.isLight)E.pushLight(je),je.castShadow&&E.pushShadow(je);else if(je.isSprite){if(!je.frustumCulled||Dt.intersectsSprite(je)){Et&&Wn.setFromMatrixPosition(je.matrixWorld).applyMatrix4(Qt);const yn=An.update(je),Un=je.material;Un.visible&&I.push(je,yn,Un,Ct,Wn.z,null)}}else if((je.isMesh||je.isLine||je.isPoints)&&(!je.frustumCulled||Dt.intersectsObject(je))){const yn=An.update(je),Un=je.material;if(Et&&(je.boundingSphere!==void 0?(je.boundingSphere===null&&je.computeBoundingSphere(),Wn.copy(je.boundingSphere.center)):(yn.boundingSphere===null&&yn.computeBoundingSphere(),Wn.copy(yn.boundingSphere.center)),Wn.applyMatrix4(je.matrixWorld).applyMatrix4(Qt)),Array.isArray(Un)){const Xn=yn.groups;for(let cr=0,vr=Xn.length;cr<vr;cr++){const pr=Xn[cr],pi=Un[pr.materialIndex];pi&&pi.visible&&I.push(je,yn,pi,Ct,Wn.z,pr)}}else Un.visible&&I.push(je,yn,Un,Ct,Wn.z,null)}}const Sn=je.children;for(let yn=0,Un=Sn.length;yn<Un;yn++)it(Sn[yn],bt,Ct,Et)}function Qe(je,bt,Ct,Et){const Pt=je.opaque,Sn=je.transmissive,yn=je.transparent;E.setupLightsView(Ct),lt===!0&&Ar.setGlobalState(O.clippingPlanes,Ct),Et&&en.viewport(ae.copy(Et)),Pt.length>0&&Rt(Pt,bt,Ct),Sn.length>0&&Rt(Sn,bt,Ct),yn.length>0&&Rt(yn,bt,Ct),en.buffers.depth.setTest(!0),en.buffers.depth.setMask(!0),en.buffers.color.setMask(!0),en.setPolygonOffset(!1)}function mt(je,bt,Ct,Et){if((Ct.isScene===!0?Ct.overrideMaterial:null)!==null)return;E.state.transmissionRenderTarget[Et.id]===void 0&&(E.state.transmissionRenderTarget[Et.id]=new Ml(1,1,{generateMipmaps:!0,type:un.has("EXT_color_buffer_half_float")||un.has("EXT_color_buffer_float")?Bh:tf,minFilter:hu,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:_s.workingColorSpace}));const Sn=E.state.transmissionRenderTarget[Et.id],yn=Et.viewport||ae;Sn.setSize(yn.z,yn.w);const Un=O.getRenderTarget();O.setRenderTarget(Sn),O.getClearColor(Ee),Pe=O.getClearAlpha(),Pe<1&&O.setClearColor(16777215,.5),Mn?sr.render(Ct):O.clear();const Xn=O.toneMapping;O.toneMapping=mp;const cr=Et.viewport;if(Et.viewport!==void 0&&(Et.viewport=void 0),E.setupLightsView(Et),lt===!0&&Ar.setGlobalState(O.clippingPlanes,Et),Rt(je,Ct,Et),on.updateMultisampleRenderTarget(Sn),on.updateRenderTargetMipmap(Sn),un.has("WEBGL_multisampled_render_to_texture")===!1){let vr=!1;for(let pr=0,pi=bt.length;pr<pi;pr++){const zi=bt[pr],Xi=zi.object,Ms=zi.geometry,Ir=zi.material,er=zi.group;if(Ir.side===Mc&&Xi.layers.test(Et.layers)){const Qi=Ir.side;Ir.side=Rc,Ir.needsUpdate=!0,yt(Xi,Ct,Et,Ms,Ir,er),Ir.side=Qi,Ir.needsUpdate=!0,vr=!0}}vr===!0&&(on.updateMultisampleRenderTarget(Sn),on.updateRenderTargetMipmap(Sn))}O.setRenderTarget(Un),O.setClearColor(Ee,Pe),cr!==void 0&&(Et.viewport=cr),O.toneMapping=Xn}function Rt(je,bt,Ct){const Et=bt.isScene===!0?bt.overrideMaterial:null;for(let Pt=0,Sn=je.length;Pt<Sn;Pt++){const yn=je[Pt],Un=yn.object,Xn=yn.geometry,cr=Et===null?yn.material:Et,vr=yn.group;Un.layers.test(Ct.layers)&&yt(Un,bt,Ct,Xn,cr,vr)}}function yt(je,bt,Ct,Et,Pt,Sn){je.onBeforeRender(O,bt,Ct,Et,Pt,Sn),je.modelViewMatrix.multiplyMatrices(Ct.matrixWorldInverse,je.matrixWorld),je.normalMatrix.getNormalMatrix(je.modelViewMatrix),Pt.transparent===!0&&Pt.side===Mc&&Pt.forceSinglePass===!1?(Pt.side=Rc,Pt.needsUpdate=!0,O.renderBufferDirect(Ct,bt,Et,Pt,je,Sn),Pt.side=Uh,Pt.needsUpdate=!0,O.renderBufferDirect(Ct,bt,Et,Pt,je,Sn),Pt.side=Mc):O.renderBufferDirect(Ct,bt,Et,Pt,je,Sn),je.onAfterRender(O,bt,Ct,Et,Pt,Sn)}function Lt(je,bt,Ct){bt.isScene!==!0&&(bt=kn);const Et=Vn.get(je),Pt=E.state.lights,Sn=E.state.shadowsArray,yn=Pt.state.version,Un=Wt.getParameters(je,Pt.state,Sn,bt,Ct),Xn=Wt.getProgramCacheKey(Un);let cr=Et.programs;Et.environment=je.isMeshStandardMaterial?bt.environment:null,Et.fog=bt.fog,Et.envMap=(je.isMeshStandardMaterial?He:ct).get(je.envMap||Et.environment),Et.envMapRotation=Et.environment!==null&&je.envMap===null?bt.environmentRotation:je.envMapRotation,cr===void 0&&(je.addEventListener("dispose",Tr),cr=new Map,Et.programs=cr);let vr=cr.get(Xn);if(vr!==void 0){if(Et.currentProgram===vr&&Et.lightsStateVersion===yn)return Ot(je,Un),vr}else Un.uniforms=Wt.getUniforms(je),je.onBeforeCompile(Un,O),vr=Wt.acquireProgram(Un,Xn),cr.set(Xn,vr),Et.uniforms=Un.uniforms;const pr=Et.uniforms;return(!je.isShaderMaterial&&!je.isRawShaderMaterial||je.clipping===!0)&&(pr.clippingPlanes=Ar.uniform),Ot(je,Un),Et.needsLights=En(je),Et.lightsStateVersion=yn,Et.needsLights&&(pr.ambientLightColor.value=Pt.state.ambient,pr.lightProbe.value=Pt.state.probe,pr.directionalLights.value=Pt.state.directional,pr.directionalLightShadows.value=Pt.state.directionalShadow,pr.spotLights.value=Pt.state.spot,pr.spotLightShadows.value=Pt.state.spotShadow,pr.rectAreaLights.value=Pt.state.rectArea,pr.ltc_1.value=Pt.state.rectAreaLTC1,pr.ltc_2.value=Pt.state.rectAreaLTC2,pr.pointLights.value=Pt.state.point,pr.pointLightShadows.value=Pt.state.pointShadow,pr.hemisphereLights.value=Pt.state.hemi,pr.directionalShadowMap.value=Pt.state.directionalShadowMap,pr.directionalShadowMatrix.value=Pt.state.directionalShadowMatrix,pr.spotShadowMap.value=Pt.state.spotShadowMap,pr.spotLightMatrix.value=Pt.state.spotLightMatrix,pr.spotLightMap.value=Pt.state.spotLightMap,pr.pointShadowMap.value=Pt.state.pointShadowMap,pr.pointShadowMatrix.value=Pt.state.pointShadowMatrix),Et.currentProgram=vr,Et.uniformsList=null,vr}function Gt(je){if(je.uniformsList===null){const bt=je.currentProgram.getUniforms();je.uniformsList=yP.seqWithValue(bt.seq,je.uniforms)}return je.uniformsList}function Ot(je,bt){const Ct=Vn.get(je);Ct.outputColorSpace=bt.outputColorSpace,Ct.batching=bt.batching,Ct.batchingColor=bt.batchingColor,Ct.instancing=bt.instancing,Ct.instancingColor=bt.instancingColor,Ct.instancingMorph=bt.instancingMorph,Ct.skinning=bt.skinning,Ct.morphTargets=bt.morphTargets,Ct.morphNormals=bt.morphNormals,Ct.morphColors=bt.morphColors,Ct.morphTargetsCount=bt.morphTargetsCount,Ct.numClippingPlanes=bt.numClippingPlanes,Ct.numIntersection=bt.numClipIntersection,Ct.vertexAlphas=bt.vertexAlphas,Ct.vertexTangents=bt.vertexTangents,Ct.toneMapping=bt.toneMapping}function cn(je,bt,Ct,Et,Pt){bt.isScene!==!0&&(bt=kn),on.resetTextureUnits();const Sn=bt.fog,yn=Et.isMeshStandardMaterial?bt.environment:null,Un=J===null?O.outputColorSpace:J.isXRRenderTarget===!0?J.texture.colorSpace:$a,Xn=(Et.isMeshStandardMaterial?He:ct).get(Et.envMap||yn),cr=Et.vertexColors===!0&&!!Ct.attributes.color&&Ct.attributes.color.itemSize===4,vr=!!Ct.attributes.tangent&&(!!Et.normalMap||Et.anisotropy>0),pr=!!Ct.morphAttributes.position,pi=!!Ct.morphAttributes.normal,zi=!!Ct.morphAttributes.color;let Xi=mp;Et.toneMapped&&(J===null||J.isXRRenderTarget===!0)&&(Xi=O.toneMapping);const Ms=Ct.morphAttributes.position||Ct.morphAttributes.normal||Ct.morphAttributes.color,Ir=Ms!==void 0?Ms.length:0,er=Vn.get(Et),Qi=E.state.lights;if(lt===!0&&(jt===!0||je!==se)){const Cs=je===se&&Et.id===re;Ar.setState(Et,je,Cs)}let Zr=!1;Et.version===er.__version?(er.needsLights&&er.lightsStateVersion!==Qi.state.version||er.outputColorSpace!==Un||Pt.isBatchedMesh&&er.batching===!1||!Pt.isBatchedMesh&&er.batching===!0||Pt.isBatchedMesh&&er.batchingColor===!0&&Pt.colorTexture===null||Pt.isBatchedMesh&&er.batchingColor===!1&&Pt.colorTexture!==null||Pt.isInstancedMesh&&er.instancing===!1||!Pt.isInstancedMesh&&er.instancing===!0||Pt.isSkinnedMesh&&er.skinning===!1||!Pt.isSkinnedMesh&&er.skinning===!0||Pt.isInstancedMesh&&er.instancingColor===!0&&Pt.instanceColor===null||Pt.isInstancedMesh&&er.instancingColor===!1&&Pt.instanceColor!==null||Pt.isInstancedMesh&&er.instancingMorph===!0&&Pt.morphTexture===null||Pt.isInstancedMesh&&er.instancingMorph===!1&&Pt.morphTexture!==null||er.envMap!==Xn||Et.fog===!0&&er.fog!==Sn||er.numClippingPlanes!==void 0&&(er.numClippingPlanes!==Ar.numPlanes||er.numIntersection!==Ar.numIntersection)||er.vertexAlphas!==cr||er.vertexTangents!==vr||er.morphTargets!==pr||er.morphNormals!==pi||er.morphColors!==zi||er.toneMapping!==Xi||er.morphTargetsCount!==Ir)&&(Zr=!0):(Zr=!0,er.__version=Et.version);let bs=er.currentProgram;Zr===!0&&(bs=Lt(Et,bt,Pt));let Yo=!1,ks=!1,ms=!1;const ki=bs.getUniforms(),co=er.uniforms;if(en.useProgram(bs.program)&&(Yo=!0,ks=!0,ms=!0),Et.id!==re&&(re=Et.id,ks=!0),Yo||se!==je){ki.setValue(Ye,"projectionMatrix",je.projectionMatrix),ki.setValue(Ye,"viewMatrix",je.matrixWorldInverse);const Cs=ki.map.cameraPosition;Cs!==void 0&&Cs.setValue(Ye,nn.setFromMatrixPosition(je.matrixWorld)),At.logarithmicDepthBuffer&&ki.setValue(Ye,"logDepthBufFC",2/(Math.log(je.far+1)/Math.LN2)),(Et.isMeshPhongMaterial||Et.isMeshToonMaterial||Et.isMeshLambertMaterial||Et.isMeshBasicMaterial||Et.isMeshStandardMaterial||Et.isShaderMaterial)&&ki.setValue(Ye,"isOrthographic",je.isOrthographicCamera===!0),se!==je&&(se=je,ks=!0,ms=!0)}if(Pt.isSkinnedMesh){ki.setOptional(Ye,Pt,"bindMatrix"),ki.setOptional(Ye,Pt,"bindMatrixInverse");const Cs=Pt.skeleton;Cs&&(Cs.boneTexture===null&&Cs.computeBoneTexture(),ki.setValue(Ye,"boneTexture",Cs.boneTexture,on))}Pt.isBatchedMesh&&(ki.setOptional(Ye,Pt,"batchingTexture"),ki.setValue(Ye,"batchingTexture",Pt._matricesTexture,on),ki.setOptional(Ye,Pt,"batchingIdTexture"),ki.setValue(Ye,"batchingIdTexture",Pt._indirectTexture,on),ki.setOptional(Ye,Pt,"batchingColorTexture"),Pt._colorsTexture!==null&&ki.setValue(Ye,"batchingColorTexture",Pt._colorsTexture,on));const Bo=Ct.morphAttributes;if((Bo.position!==void 0||Bo.normal!==void 0||Bo.color!==void 0)&&di.update(Pt,Ct,bs),(ks||er.receiveShadow!==Pt.receiveShadow)&&(er.receiveShadow=Pt.receiveShadow,ki.setValue(Ye,"receiveShadow",Pt.receiveShadow)),Et.isMeshGouraudMaterial&&Et.envMap!==null&&(co.envMap.value=Xn,co.flipEnvMap.value=Xn.isCubeTexture&&Xn.isRenderTargetTexture===!1?-1:1),Et.isMeshStandardMaterial&&Et.envMap===null&&bt.environment!==null&&(co.envMapIntensity.value=bt.environmentIntensity),ks&&(ki.setValue(Ye,"toneMappingExposure",O.toneMappingExposure),er.needsLights&&Cn(co,ms),Sn&&Et.fog===!0&&gr.refreshFogUniforms(co,Sn),gr.refreshMaterialUniforms(co,Et,rt,Re,E.state.transmissionRenderTarget[je.id]),yP.upload(Ye,Gt(er),co,on)),Et.isShaderMaterial&&Et.uniformsNeedUpdate===!0&&(yP.upload(Ye,Gt(er),co,on),Et.uniformsNeedUpdate=!1),Et.isSpriteMaterial&&ki.setValue(Ye,"center",Pt.center),ki.setValue(Ye,"modelViewMatrix",Pt.modelViewMatrix),ki.setValue(Ye,"normalMatrix",Pt.normalMatrix),ki.setValue(Ye,"modelMatrix",Pt.matrixWorld),Et.isShaderMaterial||Et.isRawShaderMaterial){const Cs=Et.uniformsGroups;for(let Nc=0,Da=Cs.length;Nc<Da;Nc++){const gf=Cs[Nc];Si.update(gf,bs),Si.bind(gf,bs)}}return bs}function Cn(je,bt){je.ambientLightColor.needsUpdate=bt,je.lightProbe.needsUpdate=bt,je.directionalLights.needsUpdate=bt,je.directionalLightShadows.needsUpdate=bt,je.pointLights.needsUpdate=bt,je.pointLightShadows.needsUpdate=bt,je.spotLights.needsUpdate=bt,je.spotLightShadows.needsUpdate=bt,je.rectAreaLights.needsUpdate=bt,je.hemisphereLights.needsUpdate=bt}function En(je){return je.isMeshLambertMaterial||je.isMeshToonMaterial||je.isMeshPhongMaterial||je.isMeshStandardMaterial||je.isShadowMaterial||je.isShaderMaterial&&je.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return Z},this.getRenderTarget=function(){return J},this.setRenderTargetTextures=function(je,bt,Ct){Vn.get(je.texture).__webglTexture=bt,Vn.get(je.depthTexture).__webglTexture=Ct;const Et=Vn.get(je);Et.__hasExternalTextures=!0,Et.__autoAllocateDepthBuffer=Ct===void 0,Et.__autoAllocateDepthBuffer||un.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Et.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(je,bt){const Ct=Vn.get(je);Ct.__webglFramebuffer=bt,Ct.__useDefaultFramebuffer=bt===void 0},this.setRenderTarget=function(je,bt=0,Ct=0){J=je,q=bt,Z=Ct;let Et=!0,Pt=null,Sn=!1,yn=!1;if(je){const Xn=Vn.get(je);Xn.__useDefaultFramebuffer!==void 0?(en.bindFramebuffer(Ye.FRAMEBUFFER,null),Et=!1):Xn.__webglFramebuffer===void 0?on.setupRenderTarget(je):Xn.__hasExternalTextures&&on.rebindTextures(je,Vn.get(je.texture).__webglTexture,Vn.get(je.depthTexture).__webglTexture);const cr=je.texture;(cr.isData3DTexture||cr.isDataArrayTexture||cr.isCompressedArrayTexture)&&(yn=!0);const vr=Vn.get(je).__webglFramebuffer;je.isWebGLCubeRenderTarget?(Array.isArray(vr[bt])?Pt=vr[bt][Ct]:Pt=vr[bt],Sn=!0):je.samples>0&&on.useMultisampledRTT(je)===!1?Pt=Vn.get(je).__webglMultisampledFramebuffer:Array.isArray(vr)?Pt=vr[Ct]:Pt=vr,ae.copy(je.viewport),he.copy(je.scissor),Ae=je.scissorTest}else ae.copy(Ue).multiplyScalar(rt).floor(),he.copy(gt).multiplyScalar(rt).floor(),Ae=vt;if(en.bindFramebuffer(Ye.FRAMEBUFFER,Pt)&&Et&&en.drawBuffers(je,Pt),en.viewport(ae),en.scissor(he),en.setScissorTest(Ae),Sn){const Xn=Vn.get(je.texture);Ye.framebufferTexture2D(Ye.FRAMEBUFFER,Ye.COLOR_ATTACHMENT0,Ye.TEXTURE_CUBE_MAP_POSITIVE_X+bt,Xn.__webglTexture,Ct)}else if(yn){const Xn=Vn.get(je.texture),cr=bt||0;Ye.framebufferTextureLayer(Ye.FRAMEBUFFER,Ye.COLOR_ATTACHMENT0,Xn.__webglTexture,Ct||0,cr)}re=-1},this.readRenderTargetPixels=function(je,bt,Ct,Et,Pt,Sn,yn){if(!(je&&je.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Un=Vn.get(je).__webglFramebuffer;if(je.isWebGLCubeRenderTarget&&yn!==void 0&&(Un=Un[yn]),Un){en.bindFramebuffer(Ye.FRAMEBUFFER,Un);try{const Xn=je.texture,cr=Xn.format,vr=Xn.type;if(!At.textureFormatReadable(cr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!At.textureTypeReadable(vr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}bt>=0&&bt<=je.width-Et&&Ct>=0&&Ct<=je.height-Pt&&Ye.readPixels(bt,Ct,Et,Pt,Ur.convert(cr),Ur.convert(vr),Sn)}finally{const Xn=J!==null?Vn.get(J).__webglFramebuffer:null;en.bindFramebuffer(Ye.FRAMEBUFFER,Xn)}}},this.readRenderTargetPixelsAsync=async function(je,bt,Ct,Et,Pt,Sn,yn){if(!(je&&je.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Un=Vn.get(je).__webglFramebuffer;if(je.isWebGLCubeRenderTarget&&yn!==void 0&&(Un=Un[yn]),Un){en.bindFramebuffer(Ye.FRAMEBUFFER,Un);try{const Xn=je.texture,cr=Xn.format,vr=Xn.type;if(!At.textureFormatReadable(cr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!At.textureTypeReadable(vr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(bt>=0&&bt<=je.width-Et&&Ct>=0&&Ct<=je.height-Pt){const pr=Ye.createBuffer();Ye.bindBuffer(Ye.PIXEL_PACK_BUFFER,pr),Ye.bufferData(Ye.PIXEL_PACK_BUFFER,Sn.byteLength,Ye.STREAM_READ),Ye.readPixels(bt,Ct,Et,Pt,Ur.convert(cr),Ur.convert(vr),0),Ye.flush();const pi=Ye.fenceSync(Ye.SYNC_GPU_COMMANDS_COMPLETE,0);await T_e(Ye,pi,4);try{Ye.bindBuffer(Ye.PIXEL_PACK_BUFFER,pr),Ye.getBufferSubData(Ye.PIXEL_PACK_BUFFER,0,Sn)}finally{Ye.deleteBuffer(pr),Ye.deleteSync(pi)}return Sn}}finally{const Xn=J!==null?Vn.get(J).__webglFramebuffer:null;en.bindFramebuffer(Ye.FRAMEBUFFER,Xn)}}},this.copyFramebufferToTexture=function(je,bt=null,Ct=0){je.isTexture!==!0&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),bt=arguments[0]||null,je=arguments[1]);const Et=Math.pow(2,-Ct),Pt=Math.floor(je.image.width*Et),Sn=Math.floor(je.image.height*Et),yn=bt!==null?bt.x:0,Un=bt!==null?bt.y:0;on.setTexture2D(je,0),Ye.copyTexSubImage2D(Ye.TEXTURE_2D,Ct,0,0,yn,Un,Pt,Sn),en.unbindTexture()},this.copyTextureToTexture=function(je,bt,Ct=null,Et=null,Pt=0){je.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),Et=arguments[0]||null,je=arguments[1],bt=arguments[2],Pt=arguments[3]||0,Ct=null);let Sn,yn,Un,Xn,cr,vr;Ct!==null?(Sn=Ct.max.x-Ct.min.x,yn=Ct.max.y-Ct.min.y,Un=Ct.min.x,Xn=Ct.min.y):(Sn=je.image.width,yn=je.image.height,Un=0,Xn=0),Et!==null?(cr=Et.x,vr=Et.y):(cr=0,vr=0);const pr=Ur.convert(bt.format),pi=Ur.convert(bt.type);on.setTexture2D(bt,0),Ye.pixelStorei(Ye.UNPACK_FLIP_Y_WEBGL,bt.flipY),Ye.pixelStorei(Ye.UNPACK_PREMULTIPLY_ALPHA_WEBGL,bt.premultiplyAlpha),Ye.pixelStorei(Ye.UNPACK_ALIGNMENT,bt.unpackAlignment);const zi=Ye.getParameter(Ye.UNPACK_ROW_LENGTH),Xi=Ye.getParameter(Ye.UNPACK_IMAGE_HEIGHT),Ms=Ye.getParameter(Ye.UNPACK_SKIP_PIXELS),Ir=Ye.getParameter(Ye.UNPACK_SKIP_ROWS),er=Ye.getParameter(Ye.UNPACK_SKIP_IMAGES),Qi=je.isCompressedTexture?je.mipmaps[Pt]:je.image;Ye.pixelStorei(Ye.UNPACK_ROW_LENGTH,Qi.width),Ye.pixelStorei(Ye.UNPACK_IMAGE_HEIGHT,Qi.height),Ye.pixelStorei(Ye.UNPACK_SKIP_PIXELS,Un),Ye.pixelStorei(Ye.UNPACK_SKIP_ROWS,Xn),je.isDataTexture?Ye.texSubImage2D(Ye.TEXTURE_2D,Pt,cr,vr,Sn,yn,pr,pi,Qi.data):je.isCompressedTexture?Ye.compressedTexSubImage2D(Ye.TEXTURE_2D,Pt,cr,vr,Qi.width,Qi.height,pr,Qi.data):Ye.texSubImage2D(Ye.TEXTURE_2D,Pt,cr,vr,Sn,yn,pr,pi,Qi),Ye.pixelStorei(Ye.UNPACK_ROW_LENGTH,zi),Ye.pixelStorei(Ye.UNPACK_IMAGE_HEIGHT,Xi),Ye.pixelStorei(Ye.UNPACK_SKIP_PIXELS,Ms),Ye.pixelStorei(Ye.UNPACK_SKIP_ROWS,Ir),Ye.pixelStorei(Ye.UNPACK_SKIP_IMAGES,er),Pt===0&&bt.generateMipmaps&&Ye.generateMipmap(Ye.TEXTURE_2D),en.unbindTexture()},this.copyTextureToTexture3D=function(je,bt,Ct=null,Et=null,Pt=0){je.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Ct=arguments[0]||null,Et=arguments[1]||null,je=arguments[2],bt=arguments[3],Pt=arguments[4]||0);let Sn,yn,Un,Xn,cr,vr,pr,pi,zi;const Xi=je.isCompressedTexture?je.mipmaps[Pt]:je.image;Ct!==null?(Sn=Ct.max.x-Ct.min.x,yn=Ct.max.y-Ct.min.y,Un=Ct.max.z-Ct.min.z,Xn=Ct.min.x,cr=Ct.min.y,vr=Ct.min.z):(Sn=Xi.width,yn=Xi.height,Un=Xi.depth,Xn=0,cr=0,vr=0),Et!==null?(pr=Et.x,pi=Et.y,zi=Et.z):(pr=0,pi=0,zi=0);const Ms=Ur.convert(bt.format),Ir=Ur.convert(bt.type);let er;if(bt.isData3DTexture)on.setTexture3D(bt,0),er=Ye.TEXTURE_3D;else if(bt.isDataArrayTexture||bt.isCompressedArrayTexture)on.setTexture2DArray(bt,0),er=Ye.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ye.pixelStorei(Ye.UNPACK_FLIP_Y_WEBGL,bt.flipY),Ye.pixelStorei(Ye.UNPACK_PREMULTIPLY_ALPHA_WEBGL,bt.premultiplyAlpha),Ye.pixelStorei(Ye.UNPACK_ALIGNMENT,bt.unpackAlignment);const Qi=Ye.getParameter(Ye.UNPACK_ROW_LENGTH),Zr=Ye.getParameter(Ye.UNPACK_IMAGE_HEIGHT),bs=Ye.getParameter(Ye.UNPACK_SKIP_PIXELS),Yo=Ye.getParameter(Ye.UNPACK_SKIP_ROWS),ks=Ye.getParameter(Ye.UNPACK_SKIP_IMAGES);Ye.pixelStorei(Ye.UNPACK_ROW_LENGTH,Xi.width),Ye.pixelStorei(Ye.UNPACK_IMAGE_HEIGHT,Xi.height),Ye.pixelStorei(Ye.UNPACK_SKIP_PIXELS,Xn),Ye.pixelStorei(Ye.UNPACK_SKIP_ROWS,cr),Ye.pixelStorei(Ye.UNPACK_SKIP_IMAGES,vr),je.isDataTexture||je.isData3DTexture?Ye.texSubImage3D(er,Pt,pr,pi,zi,Sn,yn,Un,Ms,Ir,Xi.data):bt.isCompressedArrayTexture?Ye.compressedTexSubImage3D(er,Pt,pr,pi,zi,Sn,yn,Un,Ms,Xi.data):Ye.texSubImage3D(er,Pt,pr,pi,zi,Sn,yn,Un,Ms,Ir,Xi),Ye.pixelStorei(Ye.UNPACK_ROW_LENGTH,Qi),Ye.pixelStorei(Ye.UNPACK_IMAGE_HEIGHT,Zr),Ye.pixelStorei(Ye.UNPACK_SKIP_PIXELS,bs),Ye.pixelStorei(Ye.UNPACK_SKIP_ROWS,Yo),Ye.pixelStorei(Ye.UNPACK_SKIP_IMAGES,ks),Pt===0&&bt.generateMipmaps&&Ye.generateMipmap(er),en.unbindTexture()},this.initRenderTarget=function(je){Vn.get(je).__webglFramebuffer===void 0&&on.setupRenderTarget(je)},this.initTexture=function(je){je.isCubeTexture?on.setTextureCube(je,0):je.isData3DTexture?on.setTexture3D(je,0):je.isDataArrayTexture||je.isCompressedArrayTexture?on.setTexture2DArray(je,0):on.setTexture2D(je,0),en.unbindTexture()},this.resetState=function(){q=0,Z=0,J=null,en.reset(),Wr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ap}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===BD?"display-p3":"srgb",t.unpackColorSpace=_s.workingColorSpace===fC?"display-p3":"srgb"}}class vC{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Hn(e),this.density=t}clone(){return new vC(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class zw{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Hn(e),this.near=t,this.far=r}clone(){return new zw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Il extends Bi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ju,this.environmentIntensity=1,this.environmentRotation=new ju,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Uw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=yM,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Uu()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return E6("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=t.array[r+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const yc=new Ze;class ng{constructor(e,t,r,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)yc.fromBufferAttribute(this,t),yc.applyMatrix4(e),this.setXYZ(t,yc.x,yc.y,yc.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)yc.fromBufferAttribute(this,t),yc.applyNormalMatrix(e),this.setXYZ(t,yc.x,yc.y,yc.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)yc.fromBufferAttribute(this,t),yc.transformDirection(e),this.setXYZ(t,yc.x,yc.y,yc.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Cc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Ci(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Ci(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Cc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Cc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Cc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Cc(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=s,this}setXYZW(e,t,r,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ci(t,this.array),r=Ci(r,this.array),s=Ci(s,this.array),o=Ci(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return new Ni(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ng(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class FD extends wo{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Hn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let F1;const YS=new Ze,N1=new Ze,z1=new Ze,U1=new sn,ZS=new sn,hre=new Hr,b2=new Ze,KS=new Ze,w2=new Ze,t$=new sn,mF=new sn,n$=new sn;class O6 extends Bi{constructor(e=new FD){if(super(),this.isSprite=!0,this.type="Sprite",F1===void 0){F1=new Yr;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Uw(t,5);F1.setIndex([0,1,2,0,2,3]),F1.setAttribute("position",new ng(r,3,0,!1)),F1.setAttribute("uv",new ng(r,2,3,!1))}this.geometry=F1,this.material=e,this.center=new sn(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),N1.setFromMatrixScale(this.matrixWorld),hre.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),z1.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&N1.multiplyScalar(-z1.z);const r=this.material.rotation;let s,o;r!==0&&(o=Math.cos(r),s=Math.sin(r));const l=this.center;S2(b2.set(-.5,-.5,0),z1,l,N1,s,o),S2(KS.set(.5,-.5,0),z1,l,N1,s,o),S2(w2.set(.5,.5,0),z1,l,N1,s,o),t$.set(0,0),mF.set(1,0),n$.set(1,1);let c=e.ray.intersectTriangle(b2,KS,w2,!1,YS);if(c===null&&(S2(KS.set(-.5,.5,0),z1,l,N1,s,o),mF.set(0,1),c=e.ray.intersectTriangle(b2,w2,KS,!1,YS),c===null))return;const a=e.ray.origin.distanceTo(YS);a<e.near||a>e.far||t.push({distance:a,point:YS.clone(),uv:Qv.getInterpolation(YS,b2,KS,w2,t$,mF,n$,new sn),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function S2(n,e,t,r,s,o){U1.subVectors(n,t).addScalar(.5).multiply(r),s!==void 0?(ZS.x=o*U1.x-s*U1.y,ZS.y=s*U1.x+o*U1.y):ZS.copy(U1),n.copy(e),n.x+=ZS.x,n.y+=ZS.y,n.applyMatrix4(hre)}const A2=new Ze,r$=new Ze;class dre extends Bi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,s=t.length;r<s;r++){const o=t[r];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const s=this.levels;let o;for(o=0;o<s.length&&!(t<s[o].distance);o++);return s.splice(o,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),e<o)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){A2.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(A2);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){A2.setFromMatrixPosition(e.matrixWorld),r$.setFromMatrixPosition(this.matrixWorld);const r=A2.distanceTo(r$)/e.zoom;t[0].object.visible=!0;let s,o;for(s=1,o=t.length;s<o;s++){let l=t[s].distance;if(t[s].object.visible&&(l-=l*t[s].hysteresis),r>=l)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<o;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let s=0,o=r.length;s<o;s++){const l=r[s];t.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return t}}const i$=new Ze,s$=new Ls,o$=new Ls,Fwe=new Ze,a$=new Hr,T2=new Ze,gF=new al,l$=new Hr,vF=new Lx;class ND extends Di{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=nz,this.bindMatrix=new Hr,this.bindMatrixInverse=new Hr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Cl),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,T2),this.boundingBox.expandByPoint(T2)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new al),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,T2),this.boundingSphere.expandByPoint(T2)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,s=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),gF.copy(this.boundingSphere),gF.applyMatrix4(s),e.ray.intersectsSphere(gF)!==!1&&(l$.copy(s).invert(),vF.copy(e.ray).applyMatrix4(l$),!(this.boundingBox!==null&&vF.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,vF)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ls,t=this.geometry.attributes.skinWeight;for(let r=0,s=t.count;r<s;r++){e.fromBufferAttribute(t,r);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===nz?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===One?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,s=this.geometry;s$.fromBufferAttribute(s.attributes.skinIndex,e),o$.fromBufferAttribute(s.attributes.skinWeight,e),i$.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const l=o$.getComponent(o);if(l!==0){const c=s$.getComponent(o);a$.multiplyMatrices(r.bones[c].matrixWorld,r.boneInverses[c]),t.addScaledVector(Fwe.copy(i$).applyMatrix4(a$),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class _C extends Bi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Qd extends Ys{constructor(e=null,t=1,r=1,s,o,l,c,a,d=Ma,f=Ma,m,_){super(null,l,c,a,d,f,s,o,m,_),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const c$=new Hr,Nwe=new Hr;class Gw{constructor(e=[],t=[]){this.uuid=Uu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,s=this.bones.length;r<s;r++)this.boneInverses.push(new Hr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Hr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,s=this.boneTexture;for(let o=0,l=e.length;o<l;o++){const c=e[o]?e[o].matrixWorld:Nwe;c$.multiplyMatrices(c,t[o]),c$.toArray(r,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new Gw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Qd(t,e,e,Zl,Ec);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,s=e.bones.length;r<s;r++){const o=e.bones[r];let l=t[o];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),l=new _C),this.bones.push(l),this.boneInverses.push(new Hr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let s=0,o=t.length;s<o;s++){const l=t[s];e.bones.push(l.uuid);const c=r[s];e.boneInverses.push(c.toArray())}return e}}class S0 extends Ni{constructor(e,t,r,s=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const G1=new Hr,u$=new Hr,M2=[],h$=new Cl,zwe=new Hr,JS=new Di,QS=new al;class zD extends Di{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new S0(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<r;s++)this.setMatrixAt(s,zwe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Cl),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,G1),h$.copy(e.boundingBox).applyMatrix4(G1),this.boundingBox.union(h$)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new al),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,G1),QS.copy(e.boundingSphere).applyMatrix4(G1),this.boundingSphere.union(QS)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,s=this.morphTexture.source.data.data,o=r.length+1,l=e*o+1;for(let c=0;c<r.length;c++)r[c]=s[l+c]}raycast(e,t){const r=this.matrixWorld,s=this.count;if(JS.geometry=this.geometry,JS.material=this.material,JS.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),QS.copy(this.boundingSphere),QS.applyMatrix4(r),e.ray.intersectsSphere(QS)!==!1))for(let o=0;o<s;o++){this.getMatrixAt(o,G1),u$.multiplyMatrices(r,G1),JS.matrixWorld=u$,JS.raycast(e,M2);for(let l=0,c=M2.length;l<c;l++){const a=M2[l];a.instanceId=o,a.object=this,t.push(a)}M2.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new S0(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,s=r.length+1;this.morphTexture===null&&(this.morphTexture=new Qd(new Float32Array(s*this.count),s,this.count,uC,Ec));const o=this.morphTexture.source.data.data;let l=0;for(let d=0;d<r.length;d++)l+=r[d];const c=this.geometry.morphTargetsRelative?1:1-l,a=s*e;o[a]=c,o.set(r,a+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function Uwe(n,e){return n.z-e.z}function Gwe(n,e){return e.z-n.z}class Vwe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r){const s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const l=s[this.index];o.push(l),this.index++,l.start=e.start,l.count=e.count,l.z=t,l.index=r}reset(){this.list.length=0,this.index=0}}const Sv=new Hr,_F=new Hr,Hwe=new Hr,jwe=new Hn(1,1,1),d$=new Hr,yF=new gC,C2=new Cl,F_=new al,eA=new Ze,f$=new Ze,Wwe=new Ze,xF=new Vwe,Gl=new Di,E2=[];function $we(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const s=n.count;for(let o=0;o<s;o++)for(let l=0;l<r;l++)e.setComponent(o+t,l,n.getComponent(o,l))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class fre extends Di{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,r=t*2,s){super(new Yr,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Qd(t,e,e,Zl,Ec);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new Qd(t,e,e,hC,eg);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxIndexCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new Qd(t,e,e,Zl,Ec);r.colorSpace=_s.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const o in e.attributes){const l=e.getAttribute(o),{array:c,itemSize:a,normalized:d}=l,f=new c.constructor(r*a),m=new Ni(f,a,d);t.setAttribute(o,m)}if(e.getIndex()!==null){const o=r>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Ni(o,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const s=e.getAttribute(r),o=t.getAttribute(r);if(s.itemSize!==o.itemSize||s.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cl);const e=this._geometryCount,t=this.boundingBox,r=this._drawInfo;t.makeEmpty();for(let s=0;s<e;s++){if(r[s].active===!1)continue;const o=r[s].geometryIndex;this.getMatrixAt(s,Sv),this.getBoundingBoxAt(o,C2).applyMatrix4(Sv),t.union(C2)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new al);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let r=0,s=t.length;r<s;r++){if(t[r].active===!1)continue;const o=t[r].geometryIndex;this.getMatrixAt(r,Sv),this.getBoundingSphereAt(o,F_).applyMatrix4(Sv),e.union(F_)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,r=this._matricesTexture,s=r.image.data;Hwe.toArray(s,t*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(jwe.toArray(o.image.data,t*4),o.needsUpdate=!0),t}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const s={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const l=this._reservedRanges,c=this._drawRanges,a=this._bounds;this._geometryCount!==0&&(o=l[l.length-1]),t===-1?s.vertexCount=e.getAttribute("position").count:s.vertexCount=t,o===null?s.vertexStart=0:s.vertexStart=o.vertexStart+o.vertexCount;const d=e.getIndex(),f=d!==null;if(f&&(r===-1?s.indexCount=d.count:s.indexCount=r,o===null?s.indexStart=0:s.indexStart=o.indexStart+o.indexCount),s.indexStart!==-1&&s.indexStart+s.indexCount>this._maxIndexCount||s.vertexStart+s.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const m=this._geometryCount;return this._geometryCount++,l.push(s),c.push({start:f?s.indexStart:s.vertexStart,count:-1}),a.push({boxInitialized:!1,box:new Cl,sphereInitialized:!1,sphere:new al}),this.setGeometryAt(m,e),m}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,s=r.getIndex()!==null,o=r.getIndex(),l=t.getIndex(),c=this._reservedRanges[e];if(s&&l.count>c.indexCount||t.attributes.position.count>c.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const a=c.vertexStart,d=c.vertexCount;for(const x in r.attributes){const A=t.getAttribute(x),I=r.getAttribute(x);$we(A,I,a);const E=A.itemSize;for(let C=A.count,L=d;C<L;C++){const O=a+C;for(let H=0;H<E;H++)I.setComponent(O,H,0)}I.needsUpdate=!0,I.addUpdateRange(a*E,d*E)}if(s){const x=c.indexStart;for(let A=0;A<l.count;A++)o.setX(x+A,a+l.getX(A));for(let A=l.count,I=c.indexCount;A<I;A++)o.setX(x+A,a);o.needsUpdate=!0,o.addUpdateRange(x,c.indexCount)}const f=this._bounds[e];t.boundingBox!==null?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,t.boundingSphere!==null?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const m=this._drawRanges[e],_=t.getAttribute("position");return m.count=s?l.count:_.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],s=r.box,o=this.geometry;if(r.boxInitialized===!1){s.makeEmpty();const l=o.index,c=o.attributes.position,a=this._drawRanges[e];for(let d=a.start,f=a.start+a.count;d<f;d++){let m=d;l&&(m=l.getX(m)),s.expandByPoint(eA.fromBufferAttribute(c,m))}r.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],s=r.sphere,o=this.geometry;if(r.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,C2),C2.getCenter(s.center);const l=o.index,c=o.attributes.position,a=this._drawRanges[e];let d=0;for(let f=a.start,m=a.start+a.count;f<m;f++){let _=f;l&&(_=l.getX(_)),eA.fromBufferAttribute(c,_),d=Math.max(d,s.center.distanceToSquared(eA))}s.radius=Math.sqrt(d),r.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._drawInfo,s=this._matricesTexture,o=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?this:(t.toArray(o,e*16),s.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._drawInfo,s=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?null:t.fromArray(s,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const r=this._colorsTexture,s=this._colorsTexture.image.data,o=this._drawInfo;return e>=o.length||o[e].active===!1?this:(t.toArray(s,e*4),r.needsUpdate=!0,this)}getColorAt(e,t){const r=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?null:t.fromArray(r,e*4)}setVisibleAt(e,t){const r=this._drawInfo;return e>=r.length||r[e].active===!1||r[e].visible===t?this:(r[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}raycast(e,t){const r=this._drawInfo,s=this._drawRanges,o=this.matrixWorld,l=this.geometry;Gl.material=this.material,Gl.geometry.index=l.index,Gl.geometry.attributes=l.attributes,Gl.geometry.boundingBox===null&&(Gl.geometry.boundingBox=new Cl),Gl.geometry.boundingSphere===null&&(Gl.geometry.boundingSphere=new al);for(let c=0,a=r.length;c<a;c++){if(!r[c].visible||!r[c].active)continue;const d=r[c].geometryIndex,f=s[d];Gl.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(c,Gl.matrixWorld).premultiply(o),this.getBoundingBoxAt(d,Gl.geometry.boundingBox),this.getBoundingSphereAt(d,Gl.geometry.boundingSphere),Gl.raycast(e,E2);for(let m=0,_=E2.length;m<_;m++){const x=E2[m];x.object=this,x.batchId=c,t.push(x)}E2.length=0}Gl.material=null,Gl.geometry.index=null,Gl.geometry.attributes={},Gl.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,r,s,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const l=s.getIndex(),c=l===null?1:l.array.BYTES_PER_ELEMENT,a=this._drawInfo,d=this._multiDrawStarts,f=this._multiDrawCounts,m=this._drawRanges,_=this.perObjectFrustumCulled,x=this._indirectTexture,A=x.image.data;_&&(d$.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),yF.setFromProjectionMatrix(d$,e.coordinateSystem));let I=0;if(this.sortObjects){_F.copy(this.matrixWorld).invert(),eA.setFromMatrixPosition(r.matrixWorld).applyMatrix4(_F),f$.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(_F);for(let L=0,O=a.length;L<O;L++)if(a[L].visible&&a[L].active){const H=a[L].geometryIndex;this.getMatrixAt(L,Sv),this.getBoundingSphereAt(H,F_).applyMatrix4(Sv);let q=!1;if(_&&(q=!yF.intersectsSphere(F_)),!q){const Z=Wwe.subVectors(F_.center,eA).dot(f$);xF.push(m[H],Z,L)}}const E=xF.list,C=this.customSort;C===null?E.sort(o.transparent?Gwe:Uwe):C.call(this,E,r);for(let L=0,O=E.length;L<O;L++){const H=E[L];d[I]=H.start*c,f[I]=H.count,A[I]=H.index,I++}xF.reset()}else for(let E=0,C=a.length;E<C;E++)if(a[E].visible&&a[E].active){const L=a[E].geometryIndex;let O=!1;if(_&&(this.getMatrixAt(E,Sv),this.getBoundingSphereAt(L,F_).applyMatrix4(Sv),O=!yF.intersectsSphere(F_)),!O){const H=m[L];d[I]=H.start*c,f[I]=H.count,A[I]=E,I++}}x.needsUpdate=!0,this._multiDrawCount=I,this._visibilityChanged=!1}onBeforeShadow(e,t,r,s,o,l){this.onBeforeRender(e,null,s,o,l)}}class Ia extends wo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Hn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const $R=new Ze,XR=new Ze,p$=new Hr,tA=new Lx,I2=new al,bF=new Ze,m$=new Ze;let nf=class extends Bi{constructor(e=new Yr,t=new Ia){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let s=1,o=t.count;s<o;s++)$R.fromBufferAttribute(t,s-1),XR.fromBufferAttribute(t,s),r[s]=r[s-1],r[s]+=$R.distanceTo(XR);e.setAttribute("lineDistance",new lr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,l=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),I2.copy(r.boundingSphere),I2.applyMatrix4(s),I2.radius+=o,e.ray.intersectsSphere(I2)===!1)return;p$.copy(s).invert(),tA.copy(e.ray).applyMatrix4(p$);const c=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=c*c,d=this.isLineSegments?2:1,f=r.index,_=r.attributes.position;if(f!==null){const x=Math.max(0,l.start),A=Math.min(f.count,l.start+l.count);for(let I=x,E=A-1;I<E;I+=d){const C=f.getX(I),L=f.getX(I+1),O=P2(this,e,tA,a,C,L);O&&t.push(O)}if(this.isLineLoop){const I=f.getX(A-1),E=f.getX(x),C=P2(this,e,tA,a,I,E);C&&t.push(C)}}else{const x=Math.max(0,l.start),A=Math.min(_.count,l.start+l.count);for(let I=x,E=A-1;I<E;I+=d){const C=P2(this,e,tA,a,I,I+1);C&&t.push(C)}if(this.isLineLoop){const I=P2(this,e,tA,a,A-1,x);I&&t.push(I)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const s=t[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=s.length;o<l;o++){const c=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}};function P2(n,e,t,r,s,o){const l=n.geometry.attributes.position;if($R.fromBufferAttribute(l,s),XR.fromBufferAttribute(l,o),t.distanceSqToSegment($R,XR,bF,m$)>r)return;bF.applyMatrix4(n.matrixWorld);const a=e.ray.origin.distanceTo(bF);if(!(a<e.near||a>e.far))return{distance:a,point:m$.clone().applyMatrix4(n.matrixWorld),index:s,face:null,faceIndex:null,object:n}}const g$=new Ze,v$=new Ze;class vu extends nf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let s=0,o=t.count;s<o;s+=2)g$.fromBufferAttribute(t,s),v$.fromBufferAttribute(t,s+1),r[s]=s===0?0:r[s-1],r[s+1]=r[s]+g$.distanceTo(v$);e.setAttribute("lineDistance",new lr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class UD extends nf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class du extends wo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Hn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const _$=new Hr,lz=new Lx,R2=new al,L2=new Ze;class Rh extends Bi{constructor(e=new Yr,t=new du){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,s=this.matrixWorld,o=e.params.Points.threshold,l=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),R2.copy(r.boundingSphere),R2.applyMatrix4(s),R2.radius+=o,e.ray.intersectsSphere(R2)===!1)return;_$.copy(s).invert(),lz.copy(e.ray).applyMatrix4(_$);const c=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=c*c,d=r.index,m=r.attributes.position;if(d!==null){const _=Math.max(0,l.start),x=Math.min(d.count,l.start+l.count);for(let A=_,I=x;A<I;A++){const E=d.getX(A);L2.fromBufferAttribute(m,E),y$(L2,E,a,s,e,t,this)}}else{const _=Math.max(0,l.start),x=Math.min(m.count,l.start+l.count);for(let A=_,I=x;A<I;A++)L2.fromBufferAttribute(m,A),y$(L2,A,a,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const s=t[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=s.length;o<l;o++){const c=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}}function y$(n,e,t,r,s,o,l){const c=lz.distanceSqToPoint(n);if(c<t){const a=new Ze;lz.closestPointToPoint(n,a),a.applyMatrix4(r);const d=s.ray.origin.distanceTo(a);if(d<s.near||d>s.far)return;o.push({distance:d,distanceToRay:Math.sqrt(c),point:a,index:e,face:null,object:l})}}class pre extends Ys{constructor(e,t,r,s,o,l,c,a,d){super(e,t,r,s,o,l,c,a,d),this.isVideoTexture=!0,this.minFilter=l!==void 0?l:Ro,this.magFilter=o!==void 0?o:Ro,this.generateMipmaps=!1;const f=this;function m(){f.needsUpdate=!0,e.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(m)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Xwe extends Ys{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ma,this.minFilter=Ma,this.generateMipmaps=!1,this.needsUpdate=!0}}class GD extends Ys{constructor(e,t,r,s,o,l,c,a,d,f,m,_){super(null,l,c,a,d,f,s,o,m,_),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qwe extends GD{constructor(e,t,r,s,o,l){super(e,t,r,o,l),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=uu,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ywe extends GD{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,Qm),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class cz extends Ys{constructor(e,t,r,s,o,l,c,a,d){super(e,t,r,s,o,l,c,a,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class lf{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,s=this.getPoint(0),o=0;t.push(0);for(let l=1;l<=e;l++)r=this.getPoint(l/e),o+=r.distanceTo(s),t.push(o),s=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let s=0;const o=r.length;let l;t?l=t:l=e*r[o-1];let c=0,a=o-1,d;for(;c<=a;)if(s=Math.floor(c+(a-c)/2),d=r[s]-l,d<0)c=s+1;else if(d>0)a=s-1;else{a=s;break}if(s=a,r[s]===l)return s/(o-1);const f=r[s],_=r[s+1]-f,x=(l-f)/_;return(s+x)/(o-1)}getTangent(e,t){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const l=this.getPoint(s),c=this.getPoint(o),a=t||(l.isVector2?new sn:new Ze);return a.copy(c).sub(l).normalize(),a}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Ze,s=[],o=[],l=[],c=new Ze,a=new Hr;for(let x=0;x<=e;x++){const A=x/e;s[x]=this.getTangentAt(A,new Ze)}o[0]=new Ze,l[0]=new Ze;let d=Number.MAX_VALUE;const f=Math.abs(s[0].x),m=Math.abs(s[0].y),_=Math.abs(s[0].z);f<=d&&(d=f,r.set(1,0,0)),m<=d&&(d=m,r.set(0,1,0)),_<=d&&r.set(0,0,1),c.crossVectors(s[0],r).normalize(),o[0].crossVectors(s[0],c),l[0].crossVectors(s[0],o[0]);for(let x=1;x<=e;x++){if(o[x]=o[x-1].clone(),l[x]=l[x-1].clone(),c.crossVectors(s[x-1],s[x]),c.length()>Number.EPSILON){c.normalize();const A=Math.acos(ia(s[x-1].dot(s[x]),-1,1));o[x].applyMatrix4(a.makeRotationAxis(c,A))}l[x].crossVectors(s[x],o[x])}if(t===!0){let x=Math.acos(ia(o[0].dot(o[e]),-1,1));x/=e,s[0].dot(c.crossVectors(o[0],o[e]))>0&&(x=-x);for(let A=1;A<=e;A++)o[A].applyMatrix4(a.makeRotationAxis(s[A],x*A)),l[A].crossVectors(s[A],o[A])}return{tangents:s,normals:o,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class VD extends lf{constructor(e=0,t=0,r=1,s=1,o=0,l=Math.PI*2,c=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=l,this.aClockwise=c,this.aRotation=a}getPoint(e,t=new sn){const r=t,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const l=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(l?o=0:o=s),this.aClockwise===!0&&!l&&(o===s?o=-s:o=o-s);const c=this.aStartAngle+e*o;let a=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),_=a-this.aX,x=d-this.aY;a=_*f-x*m+this.aX,d=_*m+x*f+this.aY}return r.set(a,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class mre extends VD{constructor(e,t,r,s,o,l){super(e,t,r,r,s,o,l),this.isArcCurve=!0,this.type="ArcCurve"}}function F6(){let n=0,e=0,t=0,r=0;function s(o,l,c,a){n=o,e=c,t=-3*o+3*l-2*c-a,r=2*o-2*l+c+a}return{initCatmullRom:function(o,l,c,a,d){s(l,c,d*(c-o),d*(a-l))},initNonuniformCatmullRom:function(o,l,c,a,d,f,m){let _=(l-o)/d-(c-o)/(d+f)+(c-l)/f,x=(c-l)/f-(a-l)/(f+m)+(a-c)/m;_*=f,x*=f,s(l,c,_,x)},calc:function(o){const l=o*o,c=l*o;return n+e*o+t*l+r*c}}}const D2=new Ze,wF=new F6,SF=new F6,AF=new F6;class gre extends lf{constructor(e=[],t=!1,r="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=s}getPoint(e,t=new Ze){const r=t,s=this.points,o=s.length,l=(o-(this.closed?0:1))*e;let c=Math.floor(l),a=l-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/o)+1)*o:a===0&&c===o-1&&(c=o-2,a=1);let d,f;this.closed||c>0?d=s[(c-1)%o]:(D2.subVectors(s[0],s[1]).add(s[0]),d=D2);const m=s[c%o],_=s[(c+1)%o];if(this.closed||c+2<o?f=s[(c+2)%o]:(D2.subVectors(s[o-1],s[o-2]).add(s[o-1]),f=D2),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let A=Math.pow(d.distanceToSquared(m),x),I=Math.pow(m.distanceToSquared(_),x),E=Math.pow(_.distanceToSquared(f),x);I<1e-4&&(I=1),A<1e-4&&(A=I),E<1e-4&&(E=I),wF.initNonuniformCatmullRom(d.x,m.x,_.x,f.x,A,I,E),SF.initNonuniformCatmullRom(d.y,m.y,_.y,f.y,A,I,E),AF.initNonuniformCatmullRom(d.z,m.z,_.z,f.z,A,I,E)}else this.curveType==="catmullrom"&&(wF.initCatmullRom(d.x,m.x,_.x,f.x,this.tension),SF.initCatmullRom(d.y,m.y,_.y,f.y,this.tension),AF.initCatmullRom(d.z,m.z,_.z,f.z,this.tension));return r.set(wF.calc(a),SF.calc(a),AF.calc(a)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const s=e.points[t];this.points.push(new Ze().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function x$(n,e,t,r,s){const o=(r-e)*.5,l=(s-t)*.5,c=n*n,a=n*c;return(2*t-2*r+o+l)*a+(-3*t+3*r-2*o-l)*c+o*n+t}function Zwe(n,e){const t=1-n;return t*t*e}function Kwe(n,e){return 2*(1-n)*n*e}function Jwe(n,e){return n*n*e}function xT(n,e,t,r){return Zwe(n,e)+Kwe(n,t)+Jwe(n,r)}function Qwe(n,e){const t=1-n;return t*t*t*e}function eSe(n,e){const t=1-n;return 3*t*t*n*e}function tSe(n,e){return 3*(1-n)*n*n*e}function nSe(n,e){return n*n*n*e}function bT(n,e,t,r,s){return Qwe(n,e)+eSe(n,t)+tSe(n,r)+nSe(n,s)}class N6 extends lf{constructor(e=new sn,t=new sn,r=new sn,s=new sn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=s}getPoint(e,t=new sn){const r=t,s=this.v0,o=this.v1,l=this.v2,c=this.v3;return r.set(bT(e,s.x,o.x,l.x,c.x),bT(e,s.y,o.y,l.y,c.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vre extends lf{constructor(e=new Ze,t=new Ze,r=new Ze,s=new Ze){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=s}getPoint(e,t=new Ze){const r=t,s=this.v0,o=this.v1,l=this.v2,c=this.v3;return r.set(bT(e,s.x,o.x,l.x,c.x),bT(e,s.y,o.y,l.y,c.y),bT(e,s.z,o.z,l.z,c.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class z6 extends lf{constructor(e=new sn,t=new sn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new sn){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new sn){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _re extends lf{constructor(e=new Ze,t=new Ze){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Ze){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class U6 extends lf{constructor(e=new sn,t=new sn,r=new sn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new sn){const r=t,s=this.v0,o=this.v1,l=this.v2;return r.set(xT(e,s.x,o.x,l.x),xT(e,s.y,o.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class G6 extends lf{constructor(e=new Ze,t=new Ze,r=new Ze){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ze){const r=t,s=this.v0,o=this.v1,l=this.v2;return r.set(xT(e,s.x,o.x,l.x),xT(e,s.y,o.y,l.y),xT(e,s.z,o.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class V6 extends lf{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new sn){const r=t,s=this.points,o=(s.length-1)*e,l=Math.floor(o),c=o-l,a=s[l===0?l:l-1],d=s[l],f=s[l>s.length-2?s.length-1:l+1],m=s[l>s.length-3?s.length-1:l+2];return r.set(x$(c,a.x,d.x,f.x,m.x),x$(c,a.y,d.y,f.y,m.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const s=e.points[t];this.points.push(new sn().fromArray(s))}return this}}var qR=Object.freeze({__proto__:null,ArcCurve:mre,CatmullRomCurve3:gre,CubicBezierCurve:N6,CubicBezierCurve3:vre,EllipseCurve:VD,LineCurve:z6,LineCurve3:_re,QuadraticBezierCurve:U6,QuadraticBezierCurve3:G6,SplineCurve:V6});class yre extends lf{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new qR[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),s=this.getCurveLengths();let o=0;for(;o<s.length;){if(s[o]>=r){const l=s[o]-r,c=this.curves[o],a=c.getLength(),d=a===0?0:1-l/a;return c.getPointAt(d,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,s=this.curves.length;r<s;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let s=0,o=this.curves;s<o.length;s++){const l=o[s],c=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,a=l.getPoints(c);for(let d=0;d<a.length;d++){const f=a[d];r&&r.equals(f)||(t.push(f),r=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const s=e.curves[t];this.curves.push(new qR[s.type]().fromJSON(s))}return this}}let wM=class extends yre{constructor(e){super(),this.type="Path",this.currentPoint=new sn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new z6(this.currentPoint.clone(),new sn(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,s){const o=new U6(this.currentPoint.clone(),new sn(e,t),new sn(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}bezierCurveTo(e,t,r,s,o,l){const c=new N6(this.currentPoint.clone(),new sn(e,t),new sn(r,s),new sn(o,l));return this.curves.push(c),this.currentPoint.set(o,l),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new V6(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,s,o,l){const c=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+c,t+a,r,s,o,l),this}absarc(e,t,r,s,o,l){return this.absellipse(e,t,r,r,s,o,l),this}ellipse(e,t,r,s,o,l,c,a){const d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+d,t+f,r,s,o,l,c,a),this}absellipse(e,t,r,s,o,l,c,a){const d=new VD(e,t,r,s,o,l,c,a);if(this.curves.length>0){const m=d.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(d);const f=d.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class yC extends Yr{constructor(e=[new sn(0,-.5),new sn(.5,0),new sn(0,.5)],t=12,r=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:s},t=Math.floor(t),s=ia(s,0,Math.PI*2);const o=[],l=[],c=[],a=[],d=[],f=1/t,m=new Ze,_=new sn,x=new Ze,A=new Ze,I=new Ze;let E=0,C=0;for(let L=0;L<=e.length-1;L++)switch(L){case 0:E=e[L+1].x-e[L].x,C=e[L+1].y-e[L].y,x.x=C*1,x.y=-E,x.z=C*0,I.copy(x),x.normalize(),a.push(x.x,x.y,x.z);break;case e.length-1:a.push(I.x,I.y,I.z);break;default:E=e[L+1].x-e[L].x,C=e[L+1].y-e[L].y,x.x=C*1,x.y=-E,x.z=C*0,A.copy(x),x.x+=I.x,x.y+=I.y,x.z+=I.z,x.normalize(),a.push(x.x,x.y,x.z),I.copy(A)}for(let L=0;L<=t;L++){const O=r+L*f*s,H=Math.sin(O),q=Math.cos(O);for(let Z=0;Z<=e.length-1;Z++){m.x=e[Z].x*H,m.y=e[Z].y,m.z=e[Z].x*q,l.push(m.x,m.y,m.z),_.x=L/t,_.y=Z/(e.length-1),c.push(_.x,_.y);const J=a[3*Z+0]*H,re=a[3*Z+1],se=a[3*Z+0]*q;d.push(J,re,se)}}for(let L=0;L<t;L++)for(let O=0;O<e.length-1;O++){const H=O+L*e.length,q=H,Z=H+e.length,J=H+e.length+1,re=H+1;o.push(q,Z,re),o.push(J,re,Z)}this.setIndex(o),this.setAttribute("position",new lr(l,3)),this.setAttribute("uv",new lr(c,2)),this.setAttribute("normal",new lr(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yC(e.points,e.segments,e.phiStart,e.phiLength)}}class HD extends yC{constructor(e=1,t=1,r=4,s=8){const o=new wM;o.absarc(0,-t/2,e,Math.PI*1.5,0),o.absarc(0,t/2,e,0,Math.PI*.5),super(o.getPoints(r),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:s}}static fromJSON(e){return new HD(e.radius,e.length,e.capSegments,e.radialSegments)}}class jD extends Yr{constructor(e=1,t=32,r=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:s},t=Math.max(3,t);const o=[],l=[],c=[],a=[],d=new Ze,f=new sn;l.push(0,0,0),c.push(0,0,1),a.push(.5,.5);for(let m=0,_=3;m<=t;m++,_+=3){const x=r+m/t*s;d.x=e*Math.cos(x),d.y=e*Math.sin(x),l.push(d.x,d.y,d.z),c.push(0,0,1),f.x=(l[_]/e+1)/2,f.y=(l[_+1]/e+1)/2,a.push(f.x,f.y)}for(let m=1;m<=t;m++)o.push(m,m+1,0);this.setIndex(o),this.setAttribute("position",new lr(l,3)),this.setAttribute("normal",new lr(c,3)),this.setAttribute("uv",new lr(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jD(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Vw extends Yr{constructor(e=1,t=1,r=1,s=32,o=1,l=!1,c=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:s,heightSegments:o,openEnded:l,thetaStart:c,thetaLength:a};const d=this;s=Math.floor(s),o=Math.floor(o);const f=[],m=[],_=[],x=[];let A=0;const I=[],E=r/2;let C=0;L(),l===!1&&(e>0&&O(!0),t>0&&O(!1)),this.setIndex(f),this.setAttribute("position",new lr(m,3)),this.setAttribute("normal",new lr(_,3)),this.setAttribute("uv",new lr(x,2));function L(){const H=new Ze,q=new Ze;let Z=0;const J=(t-e)/r;for(let re=0;re<=o;re++){const se=[],ae=re/o,he=ae*(t-e)+e;for(let Ae=0;Ae<=s;Ae++){const Ee=Ae/s,Pe=Ee*a+c,ze=Math.sin(Pe),Re=Math.cos(Pe);q.x=he*ze,q.y=-ae*r+E,q.z=he*Re,m.push(q.x,q.y,q.z),H.set(ze,J,Re).normalize(),_.push(H.x,H.y,H.z),x.push(Ee,1-ae),se.push(A++)}I.push(se)}for(let re=0;re<s;re++)for(let se=0;se<o;se++){const ae=I[se][re],he=I[se+1][re],Ae=I[se+1][re+1],Ee=I[se][re+1];f.push(ae,he,Ee),f.push(he,Ae,Ee),Z+=6}d.addGroup(C,Z,0),C+=Z}function O(H){const q=A,Z=new sn,J=new Ze;let re=0;const se=H===!0?e:t,ae=H===!0?1:-1;for(let Ae=1;Ae<=s;Ae++)m.push(0,E*ae,0),_.push(0,ae,0),x.push(.5,.5),A++;const he=A;for(let Ae=0;Ae<=s;Ae++){const Pe=Ae/s*a+c,ze=Math.cos(Pe),Re=Math.sin(Pe);J.x=se*Re,J.y=E*ae,J.z=se*ze,m.push(J.x,J.y,J.z),_.push(0,ae,0),Z.x=ze*.5+.5,Z.y=Re*.5*ae+.5,x.push(Z.x,Z.y),A++}for(let Ae=0;Ae<s;Ae++){const Ee=q+Ae,Pe=he+Ae;H===!0?f.push(Pe,Pe+1,Ee):f.push(Pe+1,Pe,Ee),re+=3}d.addGroup(C,re,H===!0?1:2),C+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vw(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class WD extends Vw{constructor(e=1,t=1,r=32,s=1,o=!1,l=0,c=Math.PI*2){super(0,e,t,r,s,o,l,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:l,thetaLength:c}}static fromJSON(e){return new WD(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class G0 extends Yr{constructor(e=[],t=[],r=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:s};const o=[],l=[];c(s),d(r),f(),this.setAttribute("position",new lr(o,3)),this.setAttribute("normal",new lr(o.slice(),3)),this.setAttribute("uv",new lr(l,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function c(L){const O=new Ze,H=new Ze,q=new Ze;for(let Z=0;Z<t.length;Z+=3)x(t[Z+0],O),x(t[Z+1],H),x(t[Z+2],q),a(O,H,q,L)}function a(L,O,H,q){const Z=q+1,J=[];for(let re=0;re<=Z;re++){J[re]=[];const se=L.clone().lerp(H,re/Z),ae=O.clone().lerp(H,re/Z),he=Z-re;for(let Ae=0;Ae<=he;Ae++)Ae===0&&re===Z?J[re][Ae]=se:J[re][Ae]=se.clone().lerp(ae,Ae/he)}for(let re=0;re<Z;re++)for(let se=0;se<2*(Z-re)-1;se++){const ae=Math.floor(se/2);se%2===0?(_(J[re][ae+1]),_(J[re+1][ae]),_(J[re][ae])):(_(J[re][ae+1]),_(J[re+1][ae+1]),_(J[re+1][ae]))}}function d(L){const O=new Ze;for(let H=0;H<o.length;H+=3)O.x=o[H+0],O.y=o[H+1],O.z=o[H+2],O.normalize().multiplyScalar(L),o[H+0]=O.x,o[H+1]=O.y,o[H+2]=O.z}function f(){const L=new Ze;for(let O=0;O<o.length;O+=3){L.x=o[O+0],L.y=o[O+1],L.z=o[O+2];const H=E(L)/2/Math.PI+.5,q=C(L)/Math.PI+.5;l.push(H,1-q)}A(),m()}function m(){for(let L=0;L<l.length;L+=6){const O=l[L+0],H=l[L+2],q=l[L+4],Z=Math.max(O,H,q),J=Math.min(O,H,q);Z>.9&&J<.1&&(O<.2&&(l[L+0]+=1),H<.2&&(l[L+2]+=1),q<.2&&(l[L+4]+=1))}}function _(L){o.push(L.x,L.y,L.z)}function x(L,O){const H=L*3;O.x=e[H+0],O.y=e[H+1],O.z=e[H+2]}function A(){const L=new Ze,O=new Ze,H=new Ze,q=new Ze,Z=new sn,J=new sn,re=new sn;for(let se=0,ae=0;se<o.length;se+=9,ae+=6){L.set(o[se+0],o[se+1],o[se+2]),O.set(o[se+3],o[se+4],o[se+5]),H.set(o[se+6],o[se+7],o[se+8]),Z.set(l[ae+0],l[ae+1]),J.set(l[ae+2],l[ae+3]),re.set(l[ae+4],l[ae+5]),q.copy(L).add(O).add(H).divideScalar(3);const he=E(q);I(Z,ae+0,L,he),I(J,ae+2,O,he),I(re,ae+4,H,he)}}function I(L,O,H,q){q<0&&L.x===1&&(l[O]=L.x-1),H.x===0&&H.z===0&&(l[O]=q/2/Math.PI+.5)}function E(L){return Math.atan2(L.z,-L.x)}function C(L){return Math.atan2(-L.y,Math.sqrt(L.x*L.x+L.z*L.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new G0(e.vertices,e.indices,e.radius,e.details)}}class $D extends G0{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,s=1/r,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-r,0,-s,r,0,s,-r,0,s,r,-s,-r,0,-s,r,0,s,-r,0,s,r,0,-r,0,-s,r,0,-s,-r,0,s,r,0,s],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,l,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $D(e.radius,e.detail)}}const B2=new Ze,k2=new Ze,TF=new Ze,O2=new Qv;class xre extends Yr{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),o=Math.cos(Zy*t),l=e.getIndex(),c=e.getAttribute("position"),a=l?l.count:c.count,d=[0,0,0],f=["a","b","c"],m=new Array(3),_={},x=[];for(let A=0;A<a;A+=3){l?(d[0]=l.getX(A),d[1]=l.getX(A+1),d[2]=l.getX(A+2)):(d[0]=A,d[1]=A+1,d[2]=A+2);const{a:I,b:E,c:C}=O2;if(I.fromBufferAttribute(c,d[0]),E.fromBufferAttribute(c,d[1]),C.fromBufferAttribute(c,d[2]),O2.getNormal(TF),m[0]=`${Math.round(I.x*s)},${Math.round(I.y*s)},${Math.round(I.z*s)}`,m[1]=`${Math.round(E.x*s)},${Math.round(E.y*s)},${Math.round(E.z*s)}`,m[2]=`${Math.round(C.x*s)},${Math.round(C.y*s)},${Math.round(C.z*s)}`,!(m[0]===m[1]||m[1]===m[2]||m[2]===m[0]))for(let L=0;L<3;L++){const O=(L+1)%3,H=m[L],q=m[O],Z=O2[f[L]],J=O2[f[O]],re=`${H}_${q}`,se=`${q}_${H}`;se in _&&_[se]?(TF.dot(_[se].normal)<=o&&(x.push(Z.x,Z.y,Z.z),x.push(J.x,J.y,J.z)),_[se]=null):re in _||(_[re]={index0:d[L],index1:d[O],normal:TF.clone()})}}for(const A in _)if(_[A]){const{index0:I,index1:E}=_[A];B2.fromBufferAttribute(c,I),k2.fromBufferAttribute(c,E),x.push(B2.x,B2.y,B2.z),x.push(k2.x,k2.y,k2.z)}this.setAttribute("position",new lr(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Jy extends wM{constructor(e){super(e),this.uuid=Uu(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,s=this.holes.length;r<s;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const s=e.holes[t];this.holes.push(new wM().fromJSON(s))}return this}}const rSe={triangulate:function(n,e,t=2){const r=e&&e.length,s=r?e[0]*t:n.length;let o=bre(n,0,s,t,!0);const l=[];if(!o||o.next===o.prev)return l;let c,a,d,f,m,_,x;if(r&&(o=lSe(n,e,o,t)),n.length>80*t){c=d=n[0],a=f=n[1];for(let A=t;A<s;A+=t)m=n[A],_=n[A+1],m<c&&(c=m),_<a&&(a=_),m>d&&(d=m),_>f&&(f=_);x=Math.max(d-c,f-a),x=x!==0?32767/x:0}return SM(o,l,t,c,a,x,0),l}};function bre(n,e,t,r,s){let o,l;if(s===ySe(n,e,t,r)>0)for(o=e;o<t;o+=r)l=b$(o,n[o],n[o+1],l);else for(o=t-r;o>=e;o-=r)l=b$(o,n[o],n[o+1],l);return l&&XD(l,l.next)&&(TM(l),l=l.next),l}function mx(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(XD(t,t.next)||jo(t.prev,t,t.next)===0)){if(TM(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function SM(n,e,t,r,s,o,l){if(!n)return;!l&&o&&fSe(n,r,s,o);let c=n,a,d;for(;n.prev!==n.next;){if(a=n.prev,d=n.next,o?sSe(n,r,s,o):iSe(n)){e.push(a.i/t|0),e.push(n.i/t|0),e.push(d.i/t|0),TM(n),n=d.next,c=d.next;continue}if(n=d,n===c){l?l===1?(n=oSe(mx(n),e,t),SM(n,e,t,r,s,o,2)):l===2&&aSe(n,e,t,r,s,o):SM(mx(n),e,t,r,s,o,1);break}}}function iSe(n){const e=n.prev,t=n,r=n.next;if(jo(e,t,r)>=0)return!1;const s=e.x,o=t.x,l=r.x,c=e.y,a=t.y,d=r.y,f=s<o?s<l?s:l:o<l?o:l,m=c<a?c<d?c:d:a<d?a:d,_=s>o?s>l?s:l:o>l?o:l,x=c>a?c>d?c:d:a>d?a:d;let A=r.next;for(;A!==e;){if(A.x>=f&&A.x<=_&&A.y>=m&&A.y<=x&&Lb(s,c,o,a,l,d,A.x,A.y)&&jo(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function sSe(n,e,t,r){const s=n.prev,o=n,l=n.next;if(jo(s,o,l)>=0)return!1;const c=s.x,a=o.x,d=l.x,f=s.y,m=o.y,_=l.y,x=c<a?c<d?c:d:a<d?a:d,A=f<m?f<_?f:_:m<_?m:_,I=c>a?c>d?c:d:a>d?a:d,E=f>m?f>_?f:_:m>_?m:_,C=uz(x,A,e,t,r),L=uz(I,E,e,t,r);let O=n.prevZ,H=n.nextZ;for(;O&&O.z>=C&&H&&H.z<=L;){if(O.x>=x&&O.x<=I&&O.y>=A&&O.y<=E&&O!==s&&O!==l&&Lb(c,f,a,m,d,_,O.x,O.y)&&jo(O.prev,O,O.next)>=0||(O=O.prevZ,H.x>=x&&H.x<=I&&H.y>=A&&H.y<=E&&H!==s&&H!==l&&Lb(c,f,a,m,d,_,H.x,H.y)&&jo(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;O&&O.z>=C;){if(O.x>=x&&O.x<=I&&O.y>=A&&O.y<=E&&O!==s&&O!==l&&Lb(c,f,a,m,d,_,O.x,O.y)&&jo(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;H&&H.z<=L;){if(H.x>=x&&H.x<=I&&H.y>=A&&H.y<=E&&H!==s&&H!==l&&Lb(c,f,a,m,d,_,H.x,H.y)&&jo(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function oSe(n,e,t){let r=n;do{const s=r.prev,o=r.next.next;!XD(s,o)&&wre(s,r,r.next,o)&&AM(s,o)&&AM(o,s)&&(e.push(s.i/t|0),e.push(r.i/t|0),e.push(o.i/t|0),TM(r),TM(r.next),r=n=o),r=r.next}while(r!==n);return mx(r)}function aSe(n,e,t,r,s,o){let l=n;do{let c=l.next.next;for(;c!==l.prev;){if(l.i!==c.i&&gSe(l,c)){let a=Sre(l,c);l=mx(l,l.next),a=mx(a,a.next),SM(l,e,t,r,s,o,0),SM(a,e,t,r,s,o,0);return}c=c.next}l=l.next}while(l!==n)}function lSe(n,e,t,r){const s=[];let o,l,c,a,d;for(o=0,l=e.length;o<l;o++)c=e[o]*r,a=o<l-1?e[o+1]*r:n.length,d=bre(n,c,a,r,!1),d===d.next&&(d.steiner=!0),s.push(mSe(d));for(s.sort(cSe),o=0;o<s.length;o++)t=uSe(s[o],t);return t}function cSe(n,e){return n.x-e.x}function uSe(n,e){const t=hSe(n,e);if(!t)return e;const r=Sre(t,n);return mx(r,r.next),mx(t,t.next)}function hSe(n,e){let t=e,r=-1/0,s;const o=n.x,l=n.y;do{if(l<=t.y&&l>=t.next.y&&t.next.y!==t.y){const _=t.x+(l-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(_<=o&&_>r&&(r=_,s=t.x<t.next.x?t:t.next,_===o))return s}t=t.next}while(t!==e);if(!s)return null;const c=s,a=s.x,d=s.y;let f=1/0,m;t=s;do o>=t.x&&t.x>=a&&o!==t.x&&Lb(l<d?o:r,l,a,d,l<d?r:o,l,t.x,t.y)&&(m=Math.abs(l-t.y)/(o-t.x),AM(t,n)&&(m<f||m===f&&(t.x>s.x||t.x===s.x&&dSe(s,t)))&&(s=t,f=m)),t=t.next;while(t!==c);return s}function dSe(n,e){return jo(n.prev,n,e.prev)<0&&jo(e.next,n,n.next)<0}function fSe(n,e,t,r){let s=n;do s.z===0&&(s.z=uz(s.x,s.y,e,t,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,pSe(s)}function pSe(n){let e,t,r,s,o,l,c,a,d=1;do{for(t=n,n=null,o=null,l=0;t;){for(l++,r=t,c=0,e=0;e<d&&(c++,r=r.nextZ,!!r);e++);for(a=d;c>0||a>0&&r;)c!==0&&(a===0||!r||t.z<=r.z)?(s=t,t=t.nextZ,c--):(s=r,r=r.nextZ,a--),o?o.nextZ=s:n=s,s.prevZ=o,o=s;t=r}o.nextZ=null,d*=2}while(l>1);return n}function uz(n,e,t,r,s){return n=(n-t)*s|0,e=(e-r)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function mSe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Lb(n,e,t,r,s,o,l,c){return(s-l)*(e-c)>=(n-l)*(o-c)&&(n-l)*(r-c)>=(t-l)*(e-c)&&(t-l)*(o-c)>=(s-l)*(r-c)}function gSe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!vSe(n,e)&&(AM(n,e)&&AM(e,n)&&_Se(n,e)&&(jo(n.prev,n,e.prev)||jo(n,e.prev,e))||XD(n,e)&&jo(n.prev,n,n.next)>0&&jo(e.prev,e,e.next)>0)}function jo(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function XD(n,e){return n.x===e.x&&n.y===e.y}function wre(n,e,t,r){const s=N2(jo(n,e,t)),o=N2(jo(n,e,r)),l=N2(jo(t,r,n)),c=N2(jo(t,r,e));return!!(s!==o&&l!==c||s===0&&F2(n,t,e)||o===0&&F2(n,r,e)||l===0&&F2(t,n,r)||c===0&&F2(t,e,r))}function F2(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function N2(n){return n>0?1:n<0?-1:0}function vSe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&wre(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function AM(n,e){return jo(n.prev,n,n.next)<0?jo(n,e,n.next)>=0&&jo(n,n.prev,e)>=0:jo(n,e,n.prev)<0||jo(n,n.next,e)<0}function _Se(n,e){let t=n,r=!1;const s=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&s<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function Sre(n,e){const t=new hz(n.i,n.x,n.y),r=new hz(e.i,e.x,e.y),s=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=s,s.prev=t,r.next=t,t.prev=r,o.next=r,r.prev=o,r}function b$(n,e,t,r){const s=new hz(n,e,t);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function TM(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function hz(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ySe(n,e,t,r){let s=0;for(let o=e,l=t-r;o<t;o+=r)s+=(n[l]-n[o])*(n[o+1]+n[l+1]),l=o;return s}class gp{static area(e){const t=e.length;let r=0;for(let s=t-1,o=0;o<t;s=o++)r+=e[s].x*e[o].y-e[o].x*e[s].y;return r*.5}static isClockWise(e){return gp.area(e)<0}static triangulateShape(e,t){const r=[],s=[],o=[];w$(e),S$(r,e);let l=e.length;t.forEach(w$);for(let a=0;a<t.length;a++)s.push(l),l+=t[a].length,S$(r,t[a]);const c=rSe.triangulate(r,s);for(let a=0;a<c.length;a+=3)o.push(c.slice(a,a+3));return o}}function w$(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function S$(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class qD extends Yr{constructor(e=new Jy([new sn(.5,.5),new sn(-.5,.5),new sn(-.5,-.5),new sn(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,s=[],o=[];for(let c=0,a=e.length;c<a;c++){const d=e[c];l(d)}this.setAttribute("position",new lr(s,3)),this.setAttribute("uv",new lr(o,2)),this.computeVertexNormals();function l(c){const a=[],d=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,m=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,A=t.bevelSize!==void 0?t.bevelSize:x-.1,I=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3;const C=t.extrudePath,L=t.UVGenerator!==void 0?t.UVGenerator:xSe;let O,H=!1,q,Z,J,re;C&&(O=C.getSpacedPoints(f),H=!0,_=!1,q=C.computeFrenetFrames(f,!1),Z=new Ze,J=new Ze,re=new Ze),_||(E=0,x=0,A=0,I=0);const se=c.extractPoints(d);let ae=se.shape;const he=se.holes;if(!gp.isClockWise(ae)){ae=ae.reverse();for(let Ye=0,gn=he.length;Ye<gn;Ye++){const un=he[Ye];gp.isClockWise(un)&&(he[Ye]=un.reverse())}}const Ee=gp.triangulateShape(ae,he),Pe=ae;for(let Ye=0,gn=he.length;Ye<gn;Ye++){const un=he[Ye];ae=ae.concat(un)}function ze(Ye,gn,un){return gn||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ye.clone().addScaledVector(gn,un)}const Re=ae.length,rt=Ee.length;function ye(Ye,gn,un){let At,en,On;const Vn=Ye.x-gn.x,on=Ye.y-gn.y,ct=un.x-Ye.x,He=un.y-Ye.y,qt=Vn*Vn+on*on,Tn=Vn*He-on*ct;if(Math.abs(Tn)>Number.EPSILON){const An=Math.sqrt(qt),Wt=Math.sqrt(ct*ct+He*He),gr=gn.x-on/An,Gn=gn.y+Vn/An,nr=un.x-He/Wt,Ar=un.y+ct/Wt,Dn=((nr-gr)*He-(Ar-Gn)*ct)/(Vn*He-on*ct);At=gr+Vn*Dn-Ye.x,en=Gn+on*Dn-Ye.y;const sr=At*At+en*en;if(sr<=2)return new sn(At,en);On=Math.sqrt(sr/2)}else{let An=!1;Vn>Number.EPSILON?ct>Number.EPSILON&&(An=!0):Vn<-Number.EPSILON?ct<-Number.EPSILON&&(An=!0):Math.sign(on)===Math.sign(He)&&(An=!0),An?(At=-on,en=Vn,On=Math.sqrt(qt)):(At=Vn,en=on,On=Math.sqrt(qt/2))}return new sn(At/On,en/On)}const We=[];for(let Ye=0,gn=Pe.length,un=gn-1,At=Ye+1;Ye<gn;Ye++,un++,At++)un===gn&&(un=0),At===gn&&(At=0),We[Ye]=ye(Pe[Ye],Pe[un],Pe[At]);const Ue=[];let gt,vt=We.concat();for(let Ye=0,gn=he.length;Ye<gn;Ye++){const un=he[Ye];gt=[];for(let At=0,en=un.length,On=en-1,Vn=At+1;At<en;At++,On++,Vn++)On===en&&(On=0),Vn===en&&(Vn=0),gt[At]=ye(un[At],un[On],un[Vn]);Ue.push(gt),vt=vt.concat(gt)}for(let Ye=0;Ye<E;Ye++){const gn=Ye/E,un=x*Math.cos(gn*Math.PI/2),At=A*Math.sin(gn*Math.PI/2)+I;for(let en=0,On=Pe.length;en<On;en++){const Vn=ze(Pe[en],We[en],At);nn(Vn.x,Vn.y,-un)}for(let en=0,On=he.length;en<On;en++){const Vn=he[en];gt=Ue[en];for(let on=0,ct=Vn.length;on<ct;on++){const He=ze(Vn[on],gt[on],At);nn(He.x,He.y,-un)}}}const Dt=A+I;for(let Ye=0;Ye<Re;Ye++){const gn=_?ze(ae[Ye],vt[Ye],Dt):ae[Ye];H?(J.copy(q.normals[0]).multiplyScalar(gn.x),Z.copy(q.binormals[0]).multiplyScalar(gn.y),re.copy(O[0]).add(J).add(Z),nn(re.x,re.y,re.z)):nn(gn.x,gn.y,0)}for(let Ye=1;Ye<=f;Ye++)for(let gn=0;gn<Re;gn++){const un=_?ze(ae[gn],vt[gn],Dt):ae[gn];H?(J.copy(q.normals[Ye]).multiplyScalar(un.x),Z.copy(q.binormals[Ye]).multiplyScalar(un.y),re.copy(O[Ye]).add(J).add(Z),nn(re.x,re.y,re.z)):nn(un.x,un.y,m/f*Ye)}for(let Ye=E-1;Ye>=0;Ye--){const gn=Ye/E,un=x*Math.cos(gn*Math.PI/2),At=A*Math.sin(gn*Math.PI/2)+I;for(let en=0,On=Pe.length;en<On;en++){const Vn=ze(Pe[en],We[en],At);nn(Vn.x,Vn.y,m+un)}for(let en=0,On=he.length;en<On;en++){const Vn=he[en];gt=Ue[en];for(let on=0,ct=Vn.length;on<ct;on++){const He=ze(Vn[on],gt[on],At);H?nn(He.x,He.y+O[f-1].y,O[f-1].x+un):nn(He.x,He.y,m+un)}}}lt(),jt();function lt(){const Ye=s.length/3;if(_){let gn=0,un=Re*gn;for(let At=0;At<rt;At++){const en=Ee[At];Wn(en[2]+un,en[1]+un,en[0]+un)}gn=f+E*2,un=Re*gn;for(let At=0;At<rt;At++){const en=Ee[At];Wn(en[0]+un,en[1]+un,en[2]+un)}}else{for(let gn=0;gn<rt;gn++){const un=Ee[gn];Wn(un[2],un[1],un[0])}for(let gn=0;gn<rt;gn++){const un=Ee[gn];Wn(un[0]+Re*f,un[1]+Re*f,un[2]+Re*f)}}r.addGroup(Ye,s.length/3-Ye,0)}function jt(){const Ye=s.length/3;let gn=0;Qt(Pe,gn),gn+=Pe.length;for(let un=0,At=he.length;un<At;un++){const en=he[un];Qt(en,gn),gn+=en.length}r.addGroup(Ye,s.length/3-Ye,1)}function Qt(Ye,gn){let un=Ye.length;for(;--un>=0;){const At=un;let en=un-1;en<0&&(en=Ye.length-1);for(let On=0,Vn=f+E*2;On<Vn;On++){const on=Re*On,ct=Re*(On+1),He=gn+At+on,qt=gn+en+on,Tn=gn+en+ct,An=gn+At+ct;kn(He,qt,Tn,An)}}}function nn(Ye,gn,un){a.push(Ye),a.push(gn),a.push(un)}function Wn(Ye,gn,un){Mn(Ye),Mn(gn),Mn(un);const At=s.length/3,en=L.generateTopUV(r,s,At-3,At-2,At-1);De(en[0]),De(en[1]),De(en[2])}function kn(Ye,gn,un,At){Mn(Ye),Mn(gn),Mn(At),Mn(gn),Mn(un),Mn(At);const en=s.length/3,On=L.generateSideWallUV(r,s,en-6,en-3,en-2,en-1);De(On[0]),De(On[1]),De(On[3]),De(On[1]),De(On[2]),De(On[3])}function Mn(Ye){s.push(a[Ye*3+0]),s.push(a[Ye*3+1]),s.push(a[Ye*3+2])}function De(Ye){o.push(Ye.x),o.push(Ye.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return bSe(t,r,e)}static fromJSON(e,t){const r=[];for(let o=0,l=e.shapes.length;o<l;o++){const c=t[e.shapes[o]];r.push(c)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new qR[s.type]().fromJSON(s)),new qD(r,e.options)}}const xSe={generateTopUV:function(n,e,t,r,s){const o=e[t*3],l=e[t*3+1],c=e[r*3],a=e[r*3+1],d=e[s*3],f=e[s*3+1];return[new sn(o,l),new sn(c,a),new sn(d,f)]},generateSideWallUV:function(n,e,t,r,s,o){const l=e[t*3],c=e[t*3+1],a=e[t*3+2],d=e[r*3],f=e[r*3+1],m=e[r*3+2],_=e[s*3],x=e[s*3+1],A=e[s*3+2],I=e[o*3],E=e[o*3+1],C=e[o*3+2];return Math.abs(c-f)<Math.abs(l-d)?[new sn(l,1-a),new sn(d,1-m),new sn(_,1-A),new sn(I,1-C)]:[new sn(c,1-a),new sn(f,1-m),new sn(x,1-A),new sn(E,1-C)]}};function bSe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,s=n.length;r<s;r++){const o=n[r];t.shapes.push(o.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class gx extends G0{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,s=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new gx(e.radius,e.detail)}}class xC extends G0{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new xC(e.radius,e.detail)}}class YD extends Yr{constructor(e=.5,t=1,r=32,s=1,o=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:s,thetaStart:o,thetaLength:l},r=Math.max(3,r),s=Math.max(1,s);const c=[],a=[],d=[],f=[];let m=e;const _=(t-e)/s,x=new Ze,A=new sn;for(let I=0;I<=s;I++){for(let E=0;E<=r;E++){const C=o+E/r*l;x.x=m*Math.cos(C),x.y=m*Math.sin(C),a.push(x.x,x.y,x.z),d.push(0,0,1),A.x=(x.x/t+1)/2,A.y=(x.y/t+1)/2,f.push(A.x,A.y)}m+=_}for(let I=0;I<s;I++){const E=I*(r+1);for(let C=0;C<r;C++){const L=C+E,O=L,H=L+r+1,q=L+r+2,Z=L+1;c.push(O,H,Z),c.push(H,q,Z)}}this.setIndex(c),this.setAttribute("position",new lr(a,3)),this.setAttribute("normal",new lr(d,3)),this.setAttribute("uv",new lr(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new YD(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ZD extends Yr{constructor(e=new Jy([new sn(0,.5),new sn(-.5,-.5),new sn(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],s=[],o=[],l=[];let c=0,a=0;if(Array.isArray(e)===!1)d(e);else for(let f=0;f<e.length;f++)d(e[f]),this.addGroup(c,a,f),c+=a,a=0;this.setIndex(r),this.setAttribute("position",new lr(s,3)),this.setAttribute("normal",new lr(o,3)),this.setAttribute("uv",new lr(l,2));function d(f){const m=s.length/3,_=f.extractPoints(t);let x=_.shape;const A=_.holes;gp.isClockWise(x)===!1&&(x=x.reverse());for(let E=0,C=A.length;E<C;E++){const L=A[E];gp.isClockWise(L)===!0&&(A[E]=L.reverse())}const I=gp.triangulateShape(x,A);for(let E=0,C=A.length;E<C;E++){const L=A[E];x=x.concat(L)}for(let E=0,C=x.length;E<C;E++){const L=x[E];s.push(L.x,L.y,0),o.push(0,0,1),l.push(L.x,L.y)}for(let E=0,C=I.length;E<C;E++){const L=I[E],O=L[0]+m,H=L[1]+m,q=L[2]+m;r.push(O,H,q),a+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return wSe(t,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const l=t[e.shapes[s]];r.push(l)}return new ZD(r,e.curveSegments)}}function wSe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const s=n[t];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class Wm extends Yr{constructor(e=1,t=32,r=16,s=0,o=Math.PI*2,l=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:s,phiLength:o,thetaStart:l,thetaLength:c},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const a=Math.min(l+c,Math.PI);let d=0;const f=[],m=new Ze,_=new Ze,x=[],A=[],I=[],E=[];for(let C=0;C<=r;C++){const L=[],O=C/r;let H=0;C===0&&l===0?H=.5/t:C===r&&a===Math.PI&&(H=-.5/t);for(let q=0;q<=t;q++){const Z=q/t;m.x=-e*Math.cos(s+Z*o)*Math.sin(l+O*c),m.y=e*Math.cos(l+O*c),m.z=e*Math.sin(s+Z*o)*Math.sin(l+O*c),A.push(m.x,m.y,m.z),_.copy(m).normalize(),I.push(_.x,_.y,_.z),E.push(Z+H,1-O),L.push(d++)}f.push(L)}for(let C=0;C<r;C++)for(let L=0;L<t;L++){const O=f[C][L+1],H=f[C][L],q=f[C+1][L],Z=f[C+1][L+1];(C!==0||l>0)&&x.push(O,H,Z),(C!==r-1||a<Math.PI)&&x.push(H,q,Z)}this.setIndex(x),this.setAttribute("position",new lr(A,3)),this.setAttribute("normal",new lr(I,3)),this.setAttribute("uv",new lr(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class KD extends G0{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new KD(e.radius,e.detail)}}class bC extends Yr{constructor(e=1,t=.4,r=12,s=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:s,arc:o},r=Math.floor(r),s=Math.floor(s);const l=[],c=[],a=[],d=[],f=new Ze,m=new Ze,_=new Ze;for(let x=0;x<=r;x++)for(let A=0;A<=s;A++){const I=A/s*o,E=x/r*Math.PI*2;m.x=(e+t*Math.cos(E))*Math.cos(I),m.y=(e+t*Math.cos(E))*Math.sin(I),m.z=t*Math.sin(E),c.push(m.x,m.y,m.z),f.x=e*Math.cos(I),f.y=e*Math.sin(I),_.subVectors(m,f).normalize(),a.push(_.x,_.y,_.z),d.push(A/s),d.push(x/r)}for(let x=1;x<=r;x++)for(let A=1;A<=s;A++){const I=(s+1)*x+A-1,E=(s+1)*(x-1)+A-1,C=(s+1)*(x-1)+A,L=(s+1)*x+A;l.push(I,E,L),l.push(E,C,L)}this.setIndex(l),this.setAttribute("position",new lr(c,3)),this.setAttribute("normal",new lr(a,3)),this.setAttribute("uv",new lr(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class JD extends Yr{constructor(e=1,t=.4,r=64,s=8,o=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:s,p:o,q:l},r=Math.floor(r),s=Math.floor(s);const c=[],a=[],d=[],f=[],m=new Ze,_=new Ze,x=new Ze,A=new Ze,I=new Ze,E=new Ze,C=new Ze;for(let O=0;O<=r;++O){const H=O/r*o*Math.PI*2;L(H,o,l,e,x),L(H+.01,o,l,e,A),E.subVectors(A,x),C.addVectors(A,x),I.crossVectors(E,C),C.crossVectors(I,E),I.normalize(),C.normalize();for(let q=0;q<=s;++q){const Z=q/s*Math.PI*2,J=-t*Math.cos(Z),re=t*Math.sin(Z);m.x=x.x+(J*C.x+re*I.x),m.y=x.y+(J*C.y+re*I.y),m.z=x.z+(J*C.z+re*I.z),a.push(m.x,m.y,m.z),_.subVectors(m,x).normalize(),d.push(_.x,_.y,_.z),f.push(O/r),f.push(q/s)}}for(let O=1;O<=r;O++)for(let H=1;H<=s;H++){const q=(s+1)*(O-1)+(H-1),Z=(s+1)*O+(H-1),J=(s+1)*O+H,re=(s+1)*(O-1)+H;c.push(q,Z,re),c.push(Z,J,re)}this.setIndex(c),this.setAttribute("position",new lr(a,3)),this.setAttribute("normal",new lr(d,3)),this.setAttribute("uv",new lr(f,2));function L(O,H,q,Z,J){const re=Math.cos(O),se=Math.sin(O),ae=q/H*O,he=Math.cos(ae);J.x=Z*(2+he)*.5*re,J.y=Z*(2+he)*se*.5,J.z=Z*Math.sin(ae)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new JD(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class QD extends Yr{constructor(e=new G6(new Ze(-1,-1,0),new Ze(-1,1,0),new Ze(1,1,0)),t=64,r=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:s,closed:o};const l=e.computeFrenetFrames(t,o);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const c=new Ze,a=new Ze,d=new sn;let f=new Ze;const m=[],_=[],x=[],A=[];I(),this.setIndex(A),this.setAttribute("position",new lr(m,3)),this.setAttribute("normal",new lr(_,3)),this.setAttribute("uv",new lr(x,2));function I(){for(let O=0;O<t;O++)E(O);E(o===!1?t:0),L(),C()}function E(O){f=e.getPointAt(O/t,f);const H=l.normals[O],q=l.binormals[O];for(let Z=0;Z<=s;Z++){const J=Z/s*Math.PI*2,re=Math.sin(J),se=-Math.cos(J);a.x=se*H.x+re*q.x,a.y=se*H.y+re*q.y,a.z=se*H.z+re*q.z,a.normalize(),_.push(a.x,a.y,a.z),c.x=f.x+r*a.x,c.y=f.y+r*a.y,c.z=f.z+r*a.z,m.push(c.x,c.y,c.z)}}function C(){for(let O=1;O<=t;O++)for(let H=1;H<=s;H++){const q=(s+1)*(O-1)+(H-1),Z=(s+1)*O+(H-1),J=(s+1)*O+H,re=(s+1)*(O-1)+H;A.push(q,Z,re),A.push(Z,J,re)}}function L(){for(let O=0;O<=t;O++)for(let H=0;H<=s;H++)d.x=O/t,d.y=H/s,x.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new QD(new qR[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Are extends Yr{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,s=new Ze,o=new Ze;if(e.index!==null){const l=e.attributes.position,c=e.index;let a=e.groups;a.length===0&&(a=[{start:0,count:c.count,materialIndex:0}]);for(let d=0,f=a.length;d<f;++d){const m=a[d],_=m.start,x=m.count;for(let A=_,I=_+x;A<I;A+=3)for(let E=0;E<3;E++){const C=c.getX(A+E),L=c.getX(A+(E+1)%3);s.fromBufferAttribute(l,C),o.fromBufferAttribute(l,L),A$(s,o,r)===!0&&(t.push(s.x,s.y,s.z),t.push(o.x,o.y,o.z))}}}else{const l=e.attributes.position;for(let c=0,a=l.count/3;c<a;c++)for(let d=0;d<3;d++){const f=3*c+d,m=3*c+(d+1)%3;s.fromBufferAttribute(l,f),o.fromBufferAttribute(l,m),A$(s,o,r)===!0&&(t.push(s.x,s.y,s.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new lr(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function A$(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(s)===!0?!1:(t.add(r),t.add(s),!0)}var T$=Object.freeze({__proto__:null,BoxGeometry:Mp,CapsuleGeometry:HD,CircleGeometry:jD,ConeGeometry:WD,CylinderGeometry:Vw,DodecahedronGeometry:$D,EdgesGeometry:xre,ExtrudeGeometry:qD,IcosahedronGeometry:gx,LatheGeometry:yC,OctahedronGeometry:xC,PlaneGeometry:hg,PolyhedronGeometry:G0,RingGeometry:YD,ShapeGeometry:ZD,SphereGeometry:Wm,TetrahedronGeometry:KD,TorusGeometry:bC,TorusKnotGeometry:JD,TubeGeometry:QD,WireframeGeometry:Are});class Tre extends wo{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Hn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Mre extends Lo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class xp extends wo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Hn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ju,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class qo extends xp{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new sn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ia(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Hn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Hn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Hn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class wC extends wo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Hn(16777215),this.specular=new Hn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ju,this.combine=lC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Cre extends wo{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Hn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Ere extends wo{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class SC extends wo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ju,this.combine=lC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ire extends wo{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Hn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=U0,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class H6 extends Ia{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function ky(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Pre(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Rre(n){function e(s,o){return n[s]-n[o]}const t=n.length,r=new Array(t);for(let s=0;s!==t;++s)r[s]=s;return r.sort(e),r}function dz(n,e,t){const r=n.length,s=new n.constructor(r);for(let o=0,l=0;l!==r;++o){const c=t[o]*e;for(let a=0;a!==e;++a)s[l++]=n[c+a]}return s}function j6(n,e,t,r){let s=1,o=n[0];for(;o!==void 0&&o[r]===void 0;)o=n[s++];if(o===void 0)return;let l=o[r];if(l!==void 0)if(Array.isArray(l))do l=o[r],l!==void 0&&(e.push(o.time),t.push.apply(t,l)),o=n[s++];while(o!==void 0);else if(l.toArray!==void 0)do l=o[r],l!==void 0&&(e.push(o.time),l.toArray(t,t.length)),o=n[s++];while(o!==void 0);else do l=o[r],l!==void 0&&(e.push(o.time),t.push(l)),o=n[s++];while(o!==void 0)}function SSe(n,e,t,r,s=30){const o=n.clone();o.name=e;const l=[];for(let a=0;a<o.tracks.length;++a){const d=o.tracks[a],f=d.getValueSize(),m=[],_=[];for(let x=0;x<d.times.length;++x){const A=d.times[x]*s;if(!(A<t||A>=r)){m.push(d.times[x]);for(let I=0;I<f;++I)_.push(d.values[x*f+I])}}m.length!==0&&(d.times=ky(m,d.times.constructor),d.values=ky(_,d.values.constructor),l.push(d))}o.tracks=l;let c=1/0;for(let a=0;a<o.tracks.length;++a)c>o.tracks[a].times[0]&&(c=o.tracks[a].times[0]);for(let a=0;a<o.tracks.length;++a)o.tracks[a].shift(-1*c);return o.resetDuration(),o}function ASe(n,e=0,t=n,r=30){r<=0&&(r=30);const s=t.tracks.length,o=e/r;for(let l=0;l<s;++l){const c=t.tracks[l],a=c.ValueTypeName;if(a==="bool"||a==="string")continue;const d=n.tracks.find(function(C){return C.name===c.name&&C.ValueTypeName===a});if(d===void 0)continue;let f=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);let _=0;const x=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);const A=c.times.length-1;let I;if(o<=c.times[0]){const C=f,L=m-f;I=c.values.slice(C,L)}else if(o>=c.times[A]){const C=A*m+f,L=C+m-f;I=c.values.slice(C,L)}else{const C=c.createInterpolant(),L=f,O=m-f;C.evaluate(o),I=C.resultBuffer.slice(L,O)}a==="quaternion"&&new Ea().fromArray(I).normalize().conjugate().toArray(I);const E=d.times.length;for(let C=0;C<E;++C){const L=C*x+_;if(a==="quaternion")Ea.multiplyQuaternionsFlat(d.values,L,I,0,d.values,L);else{const O=x-_*2;for(let H=0;H<O;++H)d.values[L+H]-=I[H]}}}return n.blendMode=A6,n}const TSe={convertArray:ky,isTypedArray:Pre,getKeyframeOrder:Rre,sortedArray:dz,flattenJSON:j6,subclip:SSe,makeClipAdditive:ASe};class Dx{constructor(e,t,r,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,s=t[r],o=t[r-1];e:{t:{let l;n:{r:if(!(e<s)){for(let c=r+2;;){if(s===void 0){if(e<o)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===c)break;if(o=s,s=t[++r],e<s)break t}l=t.length;break n}if(!(e>=o)){const c=t[1];e<c&&(r=2,o=c);for(let a=r-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(s=o,o=t[--r-1],e>=o)break t}l=r,r=0;break n}break e}for(;r<l;){const c=r+l>>>1;e<t[c]?l=c:r=c+1}if(s=t[r],o=t[r-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,o,s)}return this.interpolate_(r,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=e*s;for(let l=0;l!==s;++l)t[l]=r[o+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Lre extends Dx{constructor(e,t,r,s){super(e,t,r,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ly,endingEnd:Ly}}intervalChanged_(e,t,r){const s=this.parameterPositions;let o=e-2,l=e+1,c=s[o],a=s[l];if(c===void 0)switch(this.getSettings_().endingStart){case Dy:o=e,c=2*t-r;break;case mM:o=s.length-2,c=t+s[o]-s[o+1];break;default:o=e,c=r}if(a===void 0)switch(this.getSettings_().endingEnd){case Dy:l=e,a=2*r-t;break;case mM:l=1,a=r+s[1]-s[0];break;default:l=e-1,a=t}const d=(r-t)*.5,f=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(a-r),this._offsetPrev=o*f,this._offsetNext=l*f}interpolate_(e,t,r,s){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,a=e*c,d=a-c,f=this._offsetPrev,m=this._offsetNext,_=this._weightPrev,x=this._weightNext,A=(r-t)/(s-t),I=A*A,E=I*A,C=-_*E+2*_*I-_*A,L=(1+_)*E+(-1.5-2*_)*I+(-.5+_)*A+1,O=(-1-x)*E+(1.5+x)*I+.5*A,H=x*E-x*I;for(let q=0;q!==c;++q)o[q]=C*l[f+q]+L*l[d+q]+O*l[a+q]+H*l[m+q];return o}}class W6 extends Dx{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,a=e*c,d=a-c,f=(r-t)/(s-t),m=1-f;for(let _=0;_!==c;++_)o[_]=l[d+_]*m+l[a+_]*f;return o}}class Dre extends Dx{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class cf{constructor(e,t,r,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ky(t,this.TimeBufferType),this.values=ky(r,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:ky(e.times,Array),values:ky(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(r.interpolation=s)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Dre(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new W6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Lre(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case fx:t=this.InterpolantFactoryMethodDiscrete;break;case w0:t=this.InterpolantFactoryMethodLinear;break;case _P:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fx;case this.InterpolantFactoryMethodLinear:return w0;case this.InterpolantFactoryMethodSmooth:return _P}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]*=e}return this}trim(e,t){const r=this.times,s=r.length;let o=0,l=s-1;for(;o!==s&&r[o]<e;)++o;for(;l!==-1&&r[l]>t;)--l;if(++l,o!==0||l!==s){o>=l&&(l=Math.max(l,1),o=l-1);const c=this.getValueSize();this.times=r.slice(o,l),this.values=this.values.slice(o*c,l*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,s=this.values,o=r.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let c=0;c!==o;c++){const a=r[c];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,a),e=!1;break}if(l!==null&&l>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,a,l),e=!1;break}l=a}if(s!==void 0&&Pre(s))for(let c=0,a=s.length;c!==a;++c){const d=s[c];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),s=this.getInterpolation()===_P,o=e.length-1;let l=1;for(let c=1;c<o;++c){let a=!1;const d=e[c],f=e[c+1];if(d!==f&&(c!==1||d!==e[0]))if(s)a=!0;else{const m=c*r,_=m-r,x=m+r;for(let A=0;A!==r;++A){const I=t[m+A];if(I!==t[_+A]||I!==t[x+A]){a=!0;break}}}if(a){if(c!==l){e[l]=e[c];const m=c*r,_=l*r;for(let x=0;x!==r;++x)t[_+x]=t[m+x]}++l}}if(o>0){e[l]=e[o];for(let c=o*r,a=l*r,d=0;d!==r;++d)t[a+d]=t[c+d];++l}return l!==e.length?(this.times=e.slice(0,l),this.values=t.slice(0,l*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,s=new r(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}cf.prototype.TimeBufferType=Float32Array;cf.prototype.ValueBufferType=Float32Array;cf.prototype.DefaultInterpolation=w0;class Bx extends cf{constructor(e,t,r){super(e,t,r)}}Bx.prototype.ValueTypeName="bool";Bx.prototype.ValueBufferType=Array;Bx.prototype.DefaultInterpolation=fx;Bx.prototype.InterpolantFactoryMethodLinear=void 0;Bx.prototype.InterpolantFactoryMethodSmooth=void 0;class $6 extends cf{}$6.prototype.ValueTypeName="color";class rg extends cf{}rg.prototype.ValueTypeName="number";class Bre extends Dx{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,a=(r-t)/(s-t);let d=e*c;for(let f=d+c;d!==f;d+=4)Ea.slerpFlat(o,0,l,d-c,l,d,a);return o}}class ig extends cf{InterpolantFactoryMethodLinear(e){return new Bre(this.times,this.values,this.getValueSize(),e)}}ig.prototype.ValueTypeName="quaternion";ig.prototype.InterpolantFactoryMethodSmooth=void 0;class kx extends cf{constructor(e,t,r){super(e,t,r)}}kx.prototype.ValueTypeName="string";kx.prototype.ValueBufferType=Array;kx.prototype.DefaultInterpolation=fx;kx.prototype.InterpolantFactoryMethodLinear=void 0;kx.prototype.InterpolantFactoryMethodSmooth=void 0;class sg extends cf{}sg.prototype.ValueTypeName="vector";class vx{constructor(e="",t=-1,r=[],s=DD){this.name=e,this.tracks=r,this.duration=t,this.blendMode=s,this.uuid=Uu(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,s=1/(e.fps||1);for(let l=0,c=r.length;l!==c;++l)t.push(CSe(r[l]).scale(s));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],r=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,l=r.length;o!==l;++o)t.push(cf.toJSON(r[o]));return s}static CreateFromMorphTargetSequence(e,t,r,s){const o=t.length,l=[];for(let c=0;c<o;c++){let a=[],d=[];a.push((c+o-1)%o,c,(c+1)%o),d.push(0,1,0);const f=Rre(a);a=dz(a,1,f),d=dz(d,1,f),!s&&a[0]===0&&(a.push(o),d.push(d[0])),l.push(new rg(".morphTargetInfluences["+t[c].name+"]",a,d).scale(1/r))}return new this(e,-1,l)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const s=e;r=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<r.length;s++)if(r[s].name===t)return r[s];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const s={},o=/^([\w-]*?)([\d]+)$/;for(let c=0,a=e.length;c<a;c++){const d=e[c],f=d.name.match(o);if(f&&f.length>1){const m=f[1];let _=s[m];_||(s[m]=_=[]),_.push(d)}}const l=[];for(const c in s)l.push(this.CreateFromMorphTargetSequence(c,s[c],t,r));return l}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(m,_,x,A,I){if(x.length!==0){const E=[],C=[];j6(x,E,C,A),E.length!==0&&I.push(new m(_,E,C))}},s=[],o=e.name||"default",l=e.fps||30,c=e.blendMode;let a=e.length||-1;const d=e.hierarchy||[];for(let m=0;m<d.length;m++){const _=d[m].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const x={};let A;for(A=0;A<_.length;A++)if(_[A].morphTargets)for(let I=0;I<_[A].morphTargets.length;I++)x[_[A].morphTargets[I]]=-1;for(const I in x){const E=[],C=[];for(let L=0;L!==_[A].morphTargets.length;++L){const O=_[A];E.push(O.time),C.push(O.morphTarget===I?1:0)}s.push(new rg(".morphTargetInfluence["+I+"]",E,C))}a=x.length*l}else{const x=".bones["+t[m].name+"]";r(sg,x+".position",_,"pos",s),r(ig,x+".quaternion",_,"rot",s),r(sg,x+".scale",_,"scl",s)}}return s.length===0?null:new this(o,a,s,c)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,s=e.length;r!==s;++r){const o=this.tracks[r];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function MSe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rg;case"vector":case"vector2":case"vector3":case"vector4":return sg;case"color":return $6;case"quaternion":return ig;case"bool":case"boolean":return Bx;case"string":return kx}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function CSe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=MSe(n.type);if(n.times===void 0){const t=[],r=[];j6(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const zm={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class AC{constructor(e,t,r){const s=this;let o=!1,l=0,c=0,a;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(f){c++,o===!1&&s.onStart!==void 0&&s.onStart(f,l,c),o=!0},this.itemEnd=function(f){l++,s.onProgress!==void 0&&s.onProgress(f,l,c),l===c&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(f){s.onError!==void 0&&s.onError(f)},this.resolveURL=function(f){return a?a(f):f},this.setURLModifier=function(f){return a=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){const m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,_=d.length;m<_;m+=2){const x=d[m],A=d[m+1];if(x.global&&(x.lastIndex=0),x.test(f))return A}return null}}}const X6=new AC;let La=class{constructor(e){this.manager=e!==void 0?e:X6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(s,o){r.load(e,s,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};La.DEFAULT_MATERIAL_NAME="__DEFAULT";const wm={};class ESe extends Error{constructor(e,t){super(e),this.response=t}}class Ya extends La{constructor(e){super(e)}load(e,t,r,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=zm.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(wm[e]!==void 0){wm[e].push({onLoad:t,onProgress:r,onError:s});return}wm[e]=[],wm[e].push({onLoad:t,onProgress:r,onError:s});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,a=this.responseType;fetch(l).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const f=wm[e],m=d.body.getReader(),_=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),x=_?parseInt(_):0,A=x!==0;let I=0;const E=new ReadableStream({start(C){L();function L(){m.read().then(({done:O,value:H})=>{if(O)C.close();else{I+=H.byteLength;const q=new ProgressEvent("progress",{lengthComputable:A,loaded:I,total:x});for(let Z=0,J=f.length;Z<J;Z++){const re=f[Z];re.onProgress&&re.onProgress(q)}C.enqueue(H),L()}},O=>{C.error(O)})}}});return new Response(E)}else throw new ESe(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(a){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,c));case"json":return d.json();default:if(c===void 0)return d.text();{const m=/charset="?([^;"\s]*)"?/i.exec(c),_=m&&m[1]?m[1].toLowerCase():void 0,x=new TextDecoder(_);return d.arrayBuffer().then(A=>x.decode(A))}}}).then(d=>{zm.add(e,d);const f=wm[e];delete wm[e];for(let m=0,_=f.length;m<_;m++){const x=f[m];x.onLoad&&x.onLoad(d)}}).catch(d=>{const f=wm[e];if(f===void 0)throw this.manager.itemError(e),d;delete wm[e];for(let m=0,_=f.length;m<_;m++){const x=f[m];x.onError&&x.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ISe extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=new Ya(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{t(o.parse(JSON.parse(c)))}catch(a){s?s(a):console.error(a),o.manager.itemError(e)}},r,s)}parse(e){const t=[];for(let r=0;r<e.length;r++){const s=vx.parse(e[r]);t.push(s)}return t}}class PSe extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=[],c=new GD,a=new Ya(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(o.withCredentials);let d=0;function f(m){a.load(e[m],function(_){const x=o.parse(_,!0);l[m]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},d+=1,d===6&&(x.mipmapCount===1&&(c.minFilter=Ro),c.image=l,c.format=x.format,c.needsUpdate=!0,t&&t(c))},r,s)}if(Array.isArray(e))for(let m=0,_=e.length;m<_;++m)f(m);else a.load(e,function(m){const _=o.parse(m,!0);if(_.isCubemap){const x=_.mipmaps.length/_.mipmapCount;for(let A=0;A<x;A++){l[A]={mipmaps:[]};for(let I=0;I<_.mipmapCount;I++)l[A].mipmaps.push(_.mipmaps[A*_.mipmapCount+I]),l[A].format=_.format,l[A].width=_.width,l[A].height=_.height}c.image=l}else c.image.width=_.width,c.image.height=_.height,c.mipmaps=_.mipmaps;_.mipmapCount===1&&(c.minFilter=Ro),c.format=_.format,c.needsUpdate=!0,t&&t(c)},r,s);return c}}class MM extends La{constructor(e){super(e)}load(e,t,r,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=zm.get(e);if(l!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l;const c=bM("img");function a(){f(),zm.add(e,this),t&&t(this),o.manager.itemEnd(e)}function d(m){f(),s&&s(m),o.manager.itemError(e),o.manager.itemEnd(e)}function f(){c.removeEventListener("load",a,!1),c.removeEventListener("error",d,!1)}return c.addEventListener("load",a,!1),c.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),o.manager.itemStart(e),c.src=e,c}}class kre extends La{constructor(e){super(e)}load(e,t,r,s){const o=new mC;o.colorSpace=Eo;const l=new MM(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let c=0;function a(d){l.load(e[d],function(f){o.images[d]=f,c++,c===6&&(o.needsUpdate=!0,t&&t(o))},void 0,s)}for(let d=0;d<e.length;++d)a(d);return o}}class RSe extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=new Qd,c=new Ya(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(o.withCredentials),c.load(e,function(a){let d;try{d=o.parse(a)}catch(f){if(s!==void 0)s(f);else{console.error(f);return}}d.image!==void 0?l.image=d.image:d.data!==void 0&&(l.image.width=d.width,l.image.height=d.height,l.image.data=d.data),l.wrapS=d.wrapS!==void 0?d.wrapS:uu,l.wrapT=d.wrapT!==void 0?d.wrapT:uu,l.magFilter=d.magFilter!==void 0?d.magFilter:Ro,l.minFilter=d.minFilter!==void 0?d.minFilter:Ro,l.anisotropy=d.anisotropy!==void 0?d.anisotropy:1,d.colorSpace!==void 0&&(l.colorSpace=d.colorSpace),d.flipY!==void 0&&(l.flipY=d.flipY),d.format!==void 0&&(l.format=d.format),d.type!==void 0&&(l.type=d.type),d.mipmaps!==void 0&&(l.mipmaps=d.mipmaps,l.minFilter=hu),d.mipmapCount===1&&(l.minFilter=Ro),d.generateMipmaps!==void 0&&(l.generateMipmaps=d.generateMipmaps),l.needsUpdate=!0,t&&t(l,d)},r,s),l}}class rf extends La{constructor(e){super(e)}load(e,t,r,s){const o=new Ys,l=new MM(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(c){o.image=c,o.needsUpdate=!0,t!==void 0&&t(o)},r,s),o}}class V0 extends Bi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Hn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class Ore extends V0{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Bi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Hn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const MF=new Hr,M$=new Ze,C$=new Ze;class q6{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new sn(512,512),this.map=null,this.mapPass=null,this.matrix=new Hr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new gC,this._frameExtents=new sn(1,1),this._viewportCount=1,this._viewports=[new Ls(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;M$.setFromMatrixPosition(e.matrixWorld),t.position.copy(M$),C$.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(C$),t.updateMatrixWorld(),MF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MF),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(MF)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class LSe extends q6{constructor(){super(new is(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=_w*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(r!==t.fov||s!==t.aspect||o!==t.far)&&(t.fov=r,t.aspect=s,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class eB extends V0{constructor(e,t,r=0,s=Math.PI/3,o=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Bi.DEFAULT_UP),this.updateMatrix(),this.target=new Bi,this.distance=r,this.angle=s,this.penumbra=o,this.decay=l,this.map=null,this.shadow=new LSe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const E$=new Hr,nA=new Ze,CF=new Ze;class DSe extends q6{constructor(){super(new is(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new sn(4,2),this._viewportCount=6,this._viewports=[new Ls(2,1,1,1),new Ls(0,1,1,1),new Ls(3,1,1,1),new Ls(1,1,1,1),new Ls(3,0,1,1),new Ls(1,0,1,1)],this._cubeDirections=[new Ze(1,0,0),new Ze(-1,0,0),new Ze(0,0,1),new Ze(0,0,-1),new Ze(0,1,0),new Ze(0,-1,0)],this._cubeUps=[new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,0,1),new Ze(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,s=this.matrix,o=e.distance||r.far;o!==r.far&&(r.far=o,r.updateProjectionMatrix()),nA.setFromMatrixPosition(e.matrixWorld),r.position.copy(nA),CF.copy(r.position),CF.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(CF),r.updateMatrixWorld(),s.makeTranslation(-nA.x,-nA.y,-nA.z),E$.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(E$)}}class p0 extends V0{constructor(e,t,r=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=s,this.shadow=new DSe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class BSe extends q6{constructor(){super(new af(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class H0 extends V0{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Bi.DEFAULT_UP),this.updateMatrix(),this.target=new Bi,this.shadow=new BSe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Ox extends V0{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Fre extends V0{constructor(e,t,r=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Nre{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ze)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,s=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*s),t.addScaledVector(l[2],.488603*o),t.addScaledVector(l[3],.488603*r),t.addScaledVector(l[4],1.092548*(r*s)),t.addScaledVector(l[5],1.092548*(s*o)),t.addScaledVector(l[6],.315392*(3*o*o-1)),t.addScaledVector(l[7],1.092548*(r*o)),t.addScaledVector(l[8],.546274*(r*r-s*s)),t}getIrradianceAt(e,t){const r=e.x,s=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],2*.511664*s),t.addScaledVector(l[2],2*.511664*o),t.addScaledVector(l[3],2*.511664*r),t.addScaledVector(l[4],2*.429043*r*s),t.addScaledVector(l[5],2*.429043*s*o),t.addScaledVector(l[6],.743125*o*o-.247708),t.addScaledVector(l[7],2*.429043*r*o),t.addScaledVector(l[8],.429043*(r*r-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const r=e.x,s=e.y,o=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*o,t[3]=.488603*r,t[4]=1.092548*r*s,t[5]=1.092548*s*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*r*o,t[8]=.546274*(r*r-s*s)}}class zre extends V0{constructor(e=new Nre,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class tB extends La{constructor(e){super(e),this.textures={}}load(e,t,r,s){const o=this,l=new Ya(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{t(o.parse(JSON.parse(c)))}catch(a){s?s(a):console.error(a),o.manager.itemError(e)}},r,s)}parse(e){const t=this.textures;function r(o){return t[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),t[o]}const s=tB.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Hn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const l=e.uniforms[o];switch(s.uniforms[o]={},l.type){case"t":s.uniforms[o].value=r(l.value);break;case"c":s.uniforms[o].value=new Hn().setHex(l.value);break;case"v2":s.uniforms[o].value=new sn().fromArray(l.value);break;case"v3":s.uniforms[o].value=new Ze().fromArray(l.value);break;case"v4":s.uniforms[o].value=new Ls().fromArray(l.value);break;case"m3":s.uniforms[o].value=new Mi().fromArray(l.value);break;case"m4":s.uniforms[o].value=new Hr().fromArray(l.value);break;default:s.uniforms[o].value=l.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)s.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=r(e.map)),e.matcap!==void 0&&(s.matcap=r(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),s.normalScale=new sn().fromArray(o)}return e.displacementMap!==void 0&&(s.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=r(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new sn().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=r(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:Tre,SpriteMaterial:FD,RawShaderMaterial:Mre,ShaderMaterial:Lo,PointsMaterial:du,MeshPhysicalMaterial:qo,MeshStandardMaterial:xp,MeshPhongMaterial:wC,MeshToonMaterial:Cre,MeshNormalMaterial:Ere,MeshLambertMaterial:SC,MeshDepthMaterial:B6,MeshDistanceMaterial:k6,MeshBasicMaterial:bo,MeshMatcapMaterial:Ire,LineDashedMaterial:H6,LineBasicMaterial:Ia,Material:wo};return new t[e]}}class gu{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Ure extends Yr{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Gre extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=new Ya(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{t(o.parse(JSON.parse(c)))}catch(a){s?s(a):console.error(a),o.manager.itemError(e)}},r,s)}parse(e){const t={},r={};function s(x,A){if(t[A]!==void 0)return t[A];const E=x.interleavedBuffers[A],C=o(x,E.buffer),L=Pb(E.type,C),O=new Uw(L,E.stride);return O.uuid=E.uuid,t[A]=O,O}function o(x,A){if(r[A]!==void 0)return r[A];const E=x.arrayBuffers[A],C=new Uint32Array(E).buffer;return r[A]=C,C}const l=e.isInstancedBufferGeometry?new Ure:new Yr,c=e.data.index;if(c!==void 0){const x=Pb(c.type,c.array);l.setIndex(new Ni(x,1))}const a=e.data.attributes;for(const x in a){const A=a[x];let I;if(A.isInterleavedBufferAttribute){const E=s(e.data,A.data);I=new ng(E,A.itemSize,A.offset,A.normalized)}else{const E=Pb(A.type,A.array),C=A.isInstancedBufferAttribute?S0:Ni;I=new C(E,A.itemSize,A.normalized)}A.name!==void 0&&(I.name=A.name),A.usage!==void 0&&I.setUsage(A.usage),l.setAttribute(x,I)}const d=e.data.morphAttributes;if(d)for(const x in d){const A=d[x],I=[];for(let E=0,C=A.length;E<C;E++){const L=A[E];let O;if(L.isInterleavedBufferAttribute){const H=s(e.data,L.data);O=new ng(H,L.itemSize,L.offset,L.normalized)}else{const H=Pb(L.type,L.array);O=new Ni(H,L.itemSize,L.normalized)}L.name!==void 0&&(O.name=L.name),I.push(O)}l.morphAttributes[x]=I}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const m=e.data.groups||e.data.drawcalls||e.data.offsets;if(m!==void 0)for(let x=0,A=m.length;x!==A;++x){const I=m[x];l.addGroup(I.start,I.count,I.materialIndex)}const _=e.data.boundingSphere;if(_!==void 0){const x=new Ze;_.center!==void 0&&x.fromArray(_.center),l.boundingSphere=new al(x,_.radius)}return e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class kSe extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=this.path===""?gu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const c=new Ya(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(a){let d=null;try{d=JSON.parse(a)}catch(m){s!==void 0&&s(m),console.error("THREE:ObjectLoader: Can't parse "+e+".",m.message);return}const f=d.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(d,t)},r,s)}async loadAsync(e,t){const r=this,s=this.path===""?gu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new Ya(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const l=await o.loadAsync(e,t),c=JSON.parse(l),a=c.metadata;if(a===void 0||a.type===void 0||a.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(c)}parse(e,t){const r=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,s),l=this.parseImages(e.images,function(){t!==void 0&&t(d)}),c=this.parseTextures(e.textures,l),a=this.parseMaterials(e.materials,c),d=this.parseObject(e.object,o,a,c,r),f=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,f),this.bindLightTargets(d),t!==void 0){let m=!1;for(const _ in l)if(l[_].data instanceof HTMLImageElement){m=!0;break}m===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,l),a=this.parseObject(e.object,s,c,l,t),d=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,d),this.bindLightTargets(a),a}parseShapes(e){const t={};if(e!==void 0)for(let r=0,s=e.length;r<s;r++){const o=new Jy().fromJSON(e[r]);t[o.uuid]=o}return t}parseSkeletons(e,t){const r={},s={};if(t.traverse(function(o){o.isBone&&(s[o.uuid]=o)}),e!==void 0)for(let o=0,l=e.length;o<l;o++){const c=new Gw().fromJSON(e[o],s);r[c.uuid]=c}return r}parseGeometries(e,t){const r={};if(e!==void 0){const s=new Gre;for(let o=0,l=e.length;o<l;o++){let c;const a=e[o];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":c=s.parse(a);break;default:a.type in T$?c=T$[a.type].fromJSON(a,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${a.type}"`)}c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.userData!==void 0&&(c.userData=a.userData),r[a.uuid]=c}}return r}parseMaterials(e,t){const r={},s={};if(e!==void 0){const o=new tB;o.setTextures(t);for(let l=0,c=e.length;l<c;l++){const a=e[l];r[a.uuid]===void 0&&(r[a.uuid]=o.parse(a)),s[a.uuid]=r[a.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const s=e[r],o=vx.parse(s);t[o.uuid]=o}return t}parseImages(e,t){const r=this,s={};let o;function l(a){return r.manager.itemStart(a),o.load(a,function(){r.manager.itemEnd(a)},void 0,function(){r.manager.itemError(a),r.manager.itemEnd(a)})}function c(a){if(typeof a=="string"){const d=a,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:r.resourcePath+d;return l(f)}else return a.data?{data:Pb(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){const a=new AC(t);o=new MM(a),o.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const m=e[d],_=m.url;if(Array.isArray(_)){const x=[];for(let A=0,I=_.length;A<I;A++){const E=_[A],C=c(E);C!==null&&(C instanceof HTMLImageElement?x.push(C):x.push(new Qd(C.data,C.width,C.height)))}s[m.uuid]=new By(x)}else{const x=c(m.url);s[m.uuid]=new By(x)}}}return s}async parseImagesAsync(e){const t=this,r={};let s;async function o(l){if(typeof l=="string"){const c=l,a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await s.loadAsync(a)}else return l.data?{data:Pb(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){s=new MM(this.manager),s.setCrossOrigin(this.crossOrigin);for(let l=0,c=e.length;l<c;l++){const a=e[l],d=a.url;if(Array.isArray(d)){const f=[];for(let m=0,_=d.length;m<_;m++){const x=d[m],A=await o(x);A!==null&&(A instanceof HTMLImageElement?f.push(A):f.push(new Qd(A.data,A.width,A.height)))}r[a.uuid]=new By(f)}else{const f=await o(a.url);r[a.uuid]=new By(f)}}}return r}parseTextures(e,t){function r(o,l){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),l[o])}const s={};if(e!==void 0)for(let o=0,l=e.length;o<l;o++){const c=e[o];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const a=t[c.image],d=a.data;let f;Array.isArray(d)?(f=new mC,d.length===6&&(f.needsUpdate=!0)):(d&&d.data?f=new Qd:f=new Ys,d&&(f.needsUpdate=!0)),f.source=a,f.uuid=c.uuid,c.name!==void 0&&(f.name=c.name),c.mapping!==void 0&&(f.mapping=r(c.mapping,OSe)),c.channel!==void 0&&(f.channel=c.channel),c.offset!==void 0&&f.offset.fromArray(c.offset),c.repeat!==void 0&&f.repeat.fromArray(c.repeat),c.center!==void 0&&f.center.fromArray(c.center),c.rotation!==void 0&&(f.rotation=c.rotation),c.wrap!==void 0&&(f.wrapS=r(c.wrap[0],I$),f.wrapT=r(c.wrap[1],I$)),c.format!==void 0&&(f.format=c.format),c.internalFormat!==void 0&&(f.internalFormat=c.internalFormat),c.type!==void 0&&(f.type=c.type),c.colorSpace!==void 0&&(f.colorSpace=c.colorSpace),c.minFilter!==void 0&&(f.minFilter=r(c.minFilter,P$)),c.magFilter!==void 0&&(f.magFilter=r(c.magFilter,P$)),c.anisotropy!==void 0&&(f.anisotropy=c.anisotropy),c.flipY!==void 0&&(f.flipY=c.flipY),c.generateMipmaps!==void 0&&(f.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(f.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(f.compareFunction=c.compareFunction),c.userData!==void 0&&(f.userData=c.userData),s[c.uuid]=f}return s}parseObject(e,t,r,s,o){let l;function c(_){return t[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",_),t[_]}function a(_){if(_!==void 0){if(Array.isArray(_)){const x=[];for(let A=0,I=_.length;A<I;A++){const E=_[A];r[E]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",E),x.push(r[E])}return x}return r[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),r[_]}}function d(_){return s[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",_),s[_]}let f,m;switch(e.type){case"Scene":l=new Il,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new Hn(e.background):l.background=d(e.background)),e.environment!==void 0&&(l.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new zw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new vC(e.fog.color,e.fog.density)),e.fog.name!==""&&(l.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&l.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(l.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&l.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":l=new is(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new af(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new Ox(e.color,e.intensity);break;case"DirectionalLight":l=new H0(e.color,e.intensity),l.target=e.target||"";break;case"PointLight":l=new p0(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new Fre(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new eB(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),l.target=e.target||"";break;case"HemisphereLight":l=new Ore(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new zre().fromJSON(e);break;case"SkinnedMesh":f=c(e.geometry),m=a(e.material),l=new ND(f,m),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":f=c(e.geometry),m=a(e.material),l=new Di(f,m);break;case"InstancedMesh":f=c(e.geometry),m=a(e.material);const _=e.count,x=e.instanceMatrix,A=e.instanceColor;l=new zD(f,m,_),l.instanceMatrix=new S0(new Float32Array(x.array),16),A!==void 0&&(l.instanceColor=new S0(new Float32Array(A.array),A.itemSize));break;case"BatchedMesh":f=c(e.geometry),m=a(e.material),l=new fre(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,m),l.geometry=f,l.perObjectFrustumCulled=e.perObjectFrustumCulled,l.sortObjects=e.sortObjects,l._drawRanges=e.drawRanges,l._reservedRanges=e.reservedRanges,l._visibility=e.visibility,l._active=e.active,l._bounds=e.bounds.map(I=>{const E=new Cl;E.min.fromArray(I.boxMin),E.max.fromArray(I.boxMax);const C=new al;return C.radius=I.sphereRadius,C.center.fromArray(I.sphereCenter),{boxInitialized:I.boxInitialized,box:E,sphereInitialized:I.sphereInitialized,sphere:C}}),l._maxInstanceCount=e.maxInstanceCount,l._maxVertexCount=e.maxVertexCount,l._maxIndexCount=e.maxIndexCount,l._geometryInitialized=e.geometryInitialized,l._geometryCount=e.geometryCount,l._matricesTexture=d(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(l._colorsTexture=d(e.colorsTexture.uuid));break;case"LOD":l=new dre;break;case"Line":l=new nf(c(e.geometry),a(e.material));break;case"LineLoop":l=new UD(c(e.geometry),a(e.material));break;case"LineSegments":l=new vu(c(e.geometry),a(e.material));break;case"PointCloud":case"Points":l=new Rh(c(e.geometry),a(e.material));break;case"Sprite":l=new O6(a(e.material));break;case"Group":l=new Kl;break;case"Bone":l=new _C;break;default:l=new Bi}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.up!==void 0&&l.up.fromArray(e.up),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(l.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let x=0;x<_.length;x++)l.add(this.parseObject(_[x],t,r,s,o))}if(e.animations!==void 0){const _=e.animations;for(let x=0;x<_.length;x++){const A=_[x];l.animations.push(o[A])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const _=e.levels;for(let x=0;x<_.length;x++){const A=_[x],I=l.getObjectByProperty("uuid",A.object);I!==void 0&&l.addLevel(I,A.distance,A.hysteresis)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const s=t[r.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(s,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,s=e.getObjectByProperty("uuid",r);s!==void 0?t.target=s:t.target=new Bi}})}}const OSe={UVMapping:CD,CubeReflectionMapping:Qm,CubeRefractionMapping:b0,EquirectangularReflectionMapping:fM,EquirectangularRefractionMapping:pM,CubeUVReflectionMapping:Fw},I$={RepeatWrapping:Gh,ClampToEdgeWrapping:uu,MirroredRepeatWrapping:ux},P$={NearestFilter:Ma,NearestMipmapNearestFilter:cC,NearestMipmapLinearFilter:Jv,LinearFilter:Ro,LinearMipmapNearestFilter:qy,LinearMipmapLinearFilter:hu};class Y6 extends La{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=zm.get(e);if(l!==void 0){if(o.manager.itemStart(e),l.then){l.then(d=>{t&&t(d),o.manager.itemEnd(e)}).catch(d=>{s&&s(d)});return}return setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader;const a=fetch(e,c).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(d){return zm.add(e,d),t&&t(d),o.manager.itemEnd(e),d}).catch(function(d){s&&s(d),zm.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});zm.add(e,a),o.manager.itemStart(e)}}let z2;class Z6{static getContext(){return z2===void 0&&(z2=new(window.AudioContext||window.webkitAudioContext)),z2}static setContext(e){z2=e}}class Vre extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=new Ya(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(a){try{const d=a.slice(0);Z6.getContext().decodeAudioData(d,function(m){t(m)}).catch(c)}catch(d){c(d)}},r,s);function c(a){s?s(a):console.error(a),o.manager.itemError(e)}}}const R$=new Hr,L$=new Hr,N_=new Hr;class FSe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new is,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new is,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,N_.copy(e.projectionMatrix);const s=t.eyeSep/2,o=s*t.near/t.focus,l=t.near*Math.tan(Zy*t.fov*.5)/t.zoom;let c,a;L$.elements[12]=-s,R$.elements[12]=s,c=-l*t.aspect+o,a=l*t.aspect+o,N_.elements[0]=2*t.near/(a-c),N_.elements[8]=(a+c)/(a-c),this.cameraL.projectionMatrix.copy(N_),c=-l*t.aspect-o,a=l*t.aspect-o,N_.elements[0]=2*t.near/(a-c),N_.elements[8]=(a+c)/(a-c),this.cameraR.projectionMatrix.copy(N_)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(L$),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(R$)}}class dg{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=D$(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=D$();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function D$(){return(typeof performance>"u"?Date:performance).now()}const z_=new Ze,B$=new Ea,NSe=new Ze,U_=new Ze;class Hre extends Bi{constructor(){super(),this.type="AudioListener",this.context=Z6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dg}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(z_,B$,NSe),U_.set(0,0,-1).applyQuaternion(B$),t.positionX){const s=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(z_.x,s),t.positionY.linearRampToValueAtTime(z_.y,s),t.positionZ.linearRampToValueAtTime(z_.z,s),t.forwardX.linearRampToValueAtTime(U_.x,s),t.forwardY.linearRampToValueAtTime(U_.y,s),t.forwardZ.linearRampToValueAtTime(U_.z,s),t.upX.linearRampToValueAtTime(r.x,s),t.upY.linearRampToValueAtTime(r.y,s),t.upZ.linearRampToValueAtTime(r.z,s)}else t.setPosition(z_.x,z_.y,z_.z),t.setOrientation(U_.x,U_.y,U_.z,r.x,r.y,r.z)}}let jre=class extends Bi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const G_=new Ze,k$=new Ea,zSe=new Ze,V_=new Ze;class Wre extends jre{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(G_,k$,zSe),V_.set(0,0,1).applyQuaternion(k$);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(G_.x,r),t.positionY.linearRampToValueAtTime(G_.y,r),t.positionZ.linearRampToValueAtTime(G_.z,r),t.orientationX.linearRampToValueAtTime(V_.x,r),t.orientationY.linearRampToValueAtTime(V_.y,r),t.orientationZ.linearRampToValueAtTime(V_.z,r)}else t.setPosition(G_.x,G_.y,G_.z),t.setOrientation(V_.x,V_.y,V_.z)}}class USe{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class $re{constructor(e,t,r){this.binding=e,this.valueSize=r;let s,o,l;switch(t){case"quaternion":s=this._slerp,o=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":s=this._select,o=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:s=this._lerp,o=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=o,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,s=this.valueSize,o=e*s+s;let l=this.cumulativeWeight;if(l===0){for(let c=0;c!==s;++c)r[o+c]=r[c];l=t}else{l+=t;const c=t/l;this._mixBufferRegion(r,o,0,c,s)}this.cumulativeWeight=l}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,s=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,s=e*t+t,o=this.cumulativeWeight,l=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const a=t*this._origIndex;this._mixBufferRegion(r,s,a,1-o,t)}l>0&&this._mixBufferRegionAdditive(r,s,this._addIndex*t,1,t);for(let a=t,d=t+t;a!==d;++a)if(r[a]!==r[a+t]){c.setValue(r,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,s=r*this._origIndex;e.getValue(t,s);for(let o=r,l=s;o!==l;++o)t[o]=t[s+o%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,s,o){if(s>=.5)for(let l=0;l!==o;++l)e[t+l]=e[r+l]}_slerp(e,t,r,s){Ea.slerpFlat(e,t,e,t,e,r,s)}_slerpAdditive(e,t,r,s,o){const l=this._workIndex*o;Ea.multiplyQuaternionsFlat(e,l,e,t,e,r),Ea.slerpFlat(e,t,e,t,e,l,s)}_lerp(e,t,r,s,o){const l=1-s;for(let c=0;c!==o;++c){const a=t+c;e[a]=e[a]*l+e[r+c]*s}}_lerpAdditive(e,t,r,s,o){for(let l=0;l!==o;++l){const c=t+l;e[c]=e[c]+e[r+l]*s}}}const K6="\\[\\]\\.:\\/",GSe=new RegExp("["+K6+"]","g"),J6="[^"+K6+"]",VSe="[^"+K6.replace("\\.","")+"]",HSe=/((?:WC+[\/:])*)/.source.replace("WC",J6),jSe=/(WCOD+)?/.source.replace("WCOD",VSe),WSe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",J6),$Se=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",J6),XSe=new RegExp("^"+HSe+jSe+WSe+$Se+"$"),qSe=["material","materials","bones","map"];class YSe{constructor(e,t,r){const s=r||rs.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,s=this._bindings[r];s!==void 0&&s.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=r.length;s!==o;++s)r[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class rs{constructor(e,t,r){this.path=t,this.parsedPath=r||rs.parseTrackName(t),this.node=rs.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new rs.Composite(e,t,r):new rs(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(GSe,"")}static parseTrackName(e){const t=XSe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=r.nodeName.substring(s+1);qSe.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(o){for(let l=0;l<o.length;l++){const c=o[l];if(c.name===t||c.uuid===t)return c;const a=r(c.children);if(a)return a}return null},s=r(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)e[t++]=r[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,s=t.propertyName;let o=t.propertyIndex;if(e||(e=rs.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let d=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===d){d=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(d!==void 0){if(e[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const l=e[s];if(l===void 0){const d=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+s+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}a=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else l.fromArray!==void 0&&l.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(a=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}rs.Composite=YSe;rs.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};rs.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};rs.prototype.GetterByBindingType=[rs.prototype._getValue_direct,rs.prototype._getValue_array,rs.prototype._getValue_arrayElement,rs.prototype._getValue_toArray];rs.prototype.SetterByBindingTypeAndVersioning=[[rs.prototype._setValue_direct,rs.prototype._setValue_direct_setNeedsUpdate,rs.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[rs.prototype._setValue_array,rs.prototype._setValue_array_setNeedsUpdate,rs.prototype._setValue_array_setMatrixWorldNeedsUpdate],[rs.prototype._setValue_arrayElement,rs.prototype._setValue_arrayElement_setNeedsUpdate,rs.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[rs.prototype._setValue_fromArray,rs.prototype._setValue_fromArray_setNeedsUpdate,rs.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class ZSe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Uu(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,s=arguments.length;r!==s;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,s=this._parsedPaths,o=this._bindings,l=o.length;let c,a=e.length,d=this.nCachedObjects_;for(let f=0,m=arguments.length;f!==m;++f){const _=arguments[f],x=_.uuid;let A=t[x];if(A===void 0){A=a++,t[x]=A,e.push(_);for(let I=0,E=l;I!==E;++I)o[I].push(new rs(_,r[I],s[I]))}else if(A<d){c=e[A];const I=--d,E=e[I];t[E.uuid]=A,e[A]=E,t[x]=I,e[I]=_;for(let C=0,L=l;C!==L;++C){const O=o[C],H=O[I];let q=O[A];O[A]=H,q===void 0&&(q=new rs(_,r[C],s[C])),O[I]=q}}else e[A]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,s=r.length;let o=this.nCachedObjects_;for(let l=0,c=arguments.length;l!==c;++l){const a=arguments[l],d=a.uuid,f=t[d];if(f!==void 0&&f>=o){const m=o++,_=e[m];t[_.uuid]=f,e[f]=_,t[d]=m,e[m]=a;for(let x=0,A=s;x!==A;++x){const I=r[x],E=I[m],C=I[f];I[f]=E,I[m]=C}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,s=r.length;let o=this.nCachedObjects_,l=e.length;for(let c=0,a=arguments.length;c!==a;++c){const d=arguments[c],f=d.uuid,m=t[f];if(m!==void 0)if(delete t[f],m<o){const _=--o,x=e[_],A=--l,I=e[A];t[x.uuid]=m,e[m]=x,t[I.uuid]=_,e[_]=I,e.pop();for(let E=0,C=s;E!==C;++E){const L=r[E],O=L[_],H=L[A];L[m]=O,L[_]=H,L.pop()}}else{const _=--l,x=e[_];_>0&&(t[x.uuid]=m),e[m]=x,e.pop();for(let A=0,I=s;A!==I;++A){const E=r[A];E[m]=E[_],E.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const r=this._bindingsIndicesByPath;let s=r[e];const o=this._bindings;if(s!==void 0)return o[s];const l=this._paths,c=this._parsedPaths,a=this._objects,d=a.length,f=this.nCachedObjects_,m=new Array(d);s=o.length,r[e]=s,l.push(e),c.push(t),o.push(m);for(let _=f,x=a.length;_!==x;++_){const A=a[_];m[_]=new rs(A,e,t)}return m}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const s=this._paths,o=this._parsedPaths,l=this._bindings,c=l.length-1,a=l[c],d=e[c];t[d]=r,l[r]=a,l.pop(),o[r]=o[c],o.pop(),s[r]=s[c],s.pop()}}}class Xre{constructor(e,t,r=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=s;const o=t.tracks,l=o.length,c=new Array(l),a={endingStart:Ly,endingEnd:Ly};for(let d=0;d!==l;++d){const f=o[d].createInterpolant(null);c[d]=f,f.settings=a}this._interpolantSettings=a,this._interpolants=c,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Nne,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const s=this._clip.duration,o=e._clip.duration,l=o/s,c=s/o;e.warp(1,l,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const s=this._mixer,o=s.time,l=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=s._lendControlInterpolant(),this._timeScaleInterpolant=c);const a=c.parameterPositions,d=c.sampleValues;return a[0]=o,a[1]=o+r,d[0]=e/l,d[1]=t/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,s){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const a=(e-o)*r;a<0||r===0?t=0:(this._startTime=null,t=r*a)}t*=this._updateTimeScale(e);const l=this._updateTime(t),c=this._updateWeight(e);if(c>0){const a=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case A6:for(let f=0,m=a.length;f!==m;++f)a[f].evaluate(l),d[f].accumulateAdditive(c);break;case DD:default:for(let f=0,m=a.length;f!==m;++f)a[f].evaluate(l),d[f].accumulate(s,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const s=r.evaluate(e)[0];t*=s,e>r.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const s=r.evaluate(e)[0];t*=s,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let s=this.time+e,o=this._loopCount;const l=r===zne;if(e===0)return o===-1?s:l&&(o&1)===1?t-s:s;if(r===Fne){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),s>=t||s<0){const c=Math.floor(s/t);s-=t*c,o+=Math.abs(c);const a=this.repetitions-o;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(a===1){const d=e<0;this._setEndings(d,!d,l)}else this._setEndings(!1,!1,l);this._loopCount=o,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=s;if(l&&(o&1)===1)return t-s}return s}_setEndings(e,t,r){const s=this._interpolantSettings;r?(s.endingStart=Dy,s.endingEnd=Dy):(e?s.endingStart=this.zeroSlopeAtStart?Dy:Ly:s.endingStart=mM,t?s.endingEnd=this.zeroSlopeAtEnd?Dy:Ly:s.endingEnd=mM)}_scheduleFading(e,t,r){const s=this._mixer,o=s.time;let l=this._weightInterpolant;l===null&&(l=s._lendControlInterpolant(),this._weightInterpolant=l);const c=l.parameterPositions,a=l.sampleValues;return c[0]=o,a[0]=t,c[1]=o+e,a[1]=r,this}}const KSe=new Float32Array(1);class qre extends Tp{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,s=e._clip.tracks,o=s.length,l=e._propertyBindings,c=e._interpolants,a=r.uuid,d=this._bindingsByRootAndName;let f=d[a];f===void 0&&(f={},d[a]=f);for(let m=0;m!==o;++m){const _=s[m],x=_.name;let A=f[x];if(A!==void 0)++A.referenceCount,l[m]=A;else{if(A=l[m],A!==void 0){A._cacheIndex===null&&(++A.referenceCount,this._addInactiveBinding(A,a,x));continue}const I=t&&t._propertyBindings[m].binding.parsedPath;A=new $re(rs.create(r,x,I),_.ValueTypeName,_.getValueSize()),++A.referenceCount,this._addInactiveBinding(A,a,x),l[m]=A}c[m].resultBuffer=A.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,s=e._clip.uuid,o=this._actionsByClip[s];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,s,r)}const t=e._propertyBindings;for(let r=0,s=t.length;r!==s;++r){const o=t[r];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,s=t.length;r!==s;++r){const o=t[r];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const s=this._actions,o=this._actionsByClip;let l=o[t];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=l;else{const c=l.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=s.length,s.push(e),l.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],s=e._cacheIndex;r._cacheIndex=s,t[s]=r,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,l=this._actionsByClip,c=l[o],a=c.knownActions,d=a[a.length-1],f=e._byClipCacheIndex;d._byClipCacheIndex=f,a[f]=d,a.pop(),e._byClipCacheIndex=null;const m=c.actionByRoot,_=(e._localRoot||this._root).uuid;delete m[_],a.length===0&&delete l[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,s=t.length;r!==s;++r){const o=t[r];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,s=this._nActiveActions++,o=t[s];e._cacheIndex=s,t[s]=e,o._cacheIndex=r,t[r]=o}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,s=--this._nActiveActions,o=t[s];e._cacheIndex=s,t[s]=e,o._cacheIndex=r,t[r]=o}_addInactiveBinding(e,t,r){const s=this._bindingsByRootAndName,o=this._bindings;let l=s[t];l===void 0&&(l={},s[t]=l),l[r]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,s=r.rootNode.uuid,o=r.path,l=this._bindingsByRootAndName,c=l[s],a=t[t.length-1],d=e._cacheIndex;a._cacheIndex=d,t[d]=a,t.pop(),delete c[o],Object.keys(c).length===0&&delete l[s]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,s=this._nActiveBindings++,o=t[s];e._cacheIndex=s,t[s]=e,o._cacheIndex=r,t[r]=o}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,s=--this._nActiveBindings,o=t[s];e._cacheIndex=s,t[s]=e,o._cacheIndex=r,t[r]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new W6(new Float32Array(2),new Float32Array(2),1,KSe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,s=--this._nActiveControlInterpolants,o=t[s];e.__cacheIndex=s,t[s]=e,o.__cacheIndex=r,t[r]=o}clipAction(e,t,r){const s=t||this._root,o=s.uuid;let l=typeof e=="string"?vx.findByName(s,e):e;const c=l!==null?l.uuid:e,a=this._actionsByClip[c];let d=null;if(r===void 0&&(l!==null?r=l.blendMode:r=DD),a!==void 0){const m=a.actionByRoot[o];if(m!==void 0&&m.blendMode===r)return m;d=a.knownActions[0],l===null&&(l=d._clip)}if(l===null)return null;const f=new Xre(this,l,t,r);return this._bindAction(f,d),this._addInactiveAction(f,c,o),f}existingAction(e,t){const r=t||this._root,s=r.uuid,o=typeof e=="string"?vx.findByName(r,e):e,l=o?o.uuid:e,c=this._actionsByClip[l];return c!==void 0&&c.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,s=this.time+=e,o=Math.sign(e),l=this._accuIndex^=1;for(let d=0;d!==r;++d)t[d]._update(s,e,o,l);const c=this._bindings,a=this._nActiveBindings;for(let d=0;d!==a;++d)c[d].apply(l);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,s=this._actionsByClip,o=s[r];if(o!==void 0){const l=o.knownActions;for(let c=0,a=l.length;c!==a;++c){const d=l[c];this._deactivateAction(d);const f=d._cacheIndex,m=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,t[f]=m,t.pop(),this._removeInactiveBindingsForAction(d)}delete s[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const l in r){const c=r[l].actionByRoot,a=c[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const s=this._bindingsByRootAndName,o=s[t];if(o!==void 0)for(const l in o){const c=o[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class Q6{constructor(e){this.value=e}clone(){return new Q6(this.value.clone===void 0?this.value:this.value.clone())}}let JSe=0;class QSe extends Tp{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:JSe++}),this.name="",this.usage=yM,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,s=t.length;r<s;r++){const o=Array.isArray(t[r])?t[r]:[t[r]];for(let l=0;l<o.length;l++)this.uniforms.push(o[l].clone())}return this}clone(){return new this.constructor().copy(this)}}class eAe extends Uw{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class tAe{constructor(e,t,r,s,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=s,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const O$=new Hr;class nB{constructor(e,t,r=0,s=1/0){this.ray=new Lx(e,t),this.near=r,this.far=s,this.camera=null,this.layers=new Ky,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return O$.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(O$),this}intersectObject(e,t=!0,r=[]){return fz(e,this,r,t),r.sort(F$),r}intersectObjects(e,t=!0,r=[]){for(let s=0,o=e.length;s<o;s++)fz(e[s],this,r,t);return r.sort(F$),r}}function F$(n,e){return n.distance-e.distance}function fz(n,e,t,r){let s=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(s=!1),s===!0&&r===!0){const o=n.children;for(let l=0,c=o.length;l<c;l++)fz(o[l],e,t,!0)}}class CM{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ia(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class nAe{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const N$=new sn;class rAe{constructor(e=new sn(1/0,1/0),t=new sn(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=N$.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,N$).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const z$=new Ze,U2=new Ze;class iAe{constructor(e=new Ze,t=new Ze){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){z$.subVectors(e,this.start),U2.subVectors(this.end,this.start);const r=U2.dot(U2);let o=U2.dot(z$)/r;return t&&(o=ia(o,0,1)),o}closestPointToPoint(e,t,r){const s=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const U$=new Ze;class sAe extends Bi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new Yr,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,c=1,a=32;l<a;l++,c++){const d=l/a*Math.PI*2,f=c/a*Math.PI*2;s.push(Math.cos(d),Math.sin(d),1,Math.cos(f),Math.sin(f),1)}r.setAttribute("position",new lr(s,3));const o=new Ia({fog:!1,toneMapped:!1});this.cone=new vu(r,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),U$.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(U$),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Av=new Ze,G2=new Hr,EF=new Hr;class oAe extends vu{constructor(e){const t=Yre(e),r=new Yr,s=[],o=[],l=new Hn(0,0,1),c=new Hn(0,1,0);for(let d=0;d<t.length;d++){const f=t[d];f.parent&&f.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),o.push(l.r,l.g,l.b),o.push(c.r,c.g,c.b))}r.setAttribute("position",new lr(s,3)),r.setAttribute("color",new lr(o,3));const a=new Ia({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,s=r.getAttribute("position");EF.copy(this.root.matrixWorld).invert();for(let o=0,l=0;o<t.length;o++){const c=t[o];c.parent&&c.parent.isBone&&(G2.multiplyMatrices(EF,c.matrixWorld),Av.setFromMatrixPosition(G2),s.setXYZ(l,Av.x,Av.y,Av.z),G2.multiplyMatrices(EF,c.parent.matrixWorld),Av.setFromMatrixPosition(G2),s.setXYZ(l+1,Av.x,Av.y,Av.z),l+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yre(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,Yre(n.children[t]));return e}class aAe extends Di{constructor(e,t,r){const s=new Wm(t,4,2),o=new bo({wireframe:!0,fog:!1,toneMapped:!1});super(s,o),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const lAe=new Ze,G$=new Hn,V$=new Hn;class cAe extends Bi{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const s=new xC(t);s.rotateY(Math.PI*.5),this.material=new bo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=s.getAttribute("position"),l=new Float32Array(o.count*3);s.setAttribute("color",new Ni(l,3)),this.add(new Di(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");G$.copy(this.light.color),V$.copy(this.light.groundColor);for(let r=0,s=t.count;r<s;r++){const o=r<s/2?G$:V$;t.setXYZ(r,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(lAe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class uAe extends vu{constructor(e=10,t=10,r=4473924,s=8947848){r=new Hn(r),s=new Hn(s);const o=t/2,l=e/t,c=e/2,a=[],d=[];for(let _=0,x=0,A=-c;_<=t;_++,A+=l){a.push(-c,0,A,c,0,A),a.push(A,0,-c,A,0,c);const I=_===o?r:s;I.toArray(d,x),x+=3,I.toArray(d,x),x+=3,I.toArray(d,x),x+=3,I.toArray(d,x),x+=3}const f=new Yr;f.setAttribute("position",new lr(a,3)),f.setAttribute("color",new lr(d,3));const m=new Ia({vertexColors:!0,toneMapped:!1});super(f,m),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class hAe extends vu{constructor(e=10,t=16,r=8,s=64,o=4473924,l=8947848){o=new Hn(o),l=new Hn(l);const c=[],a=[];if(t>1)for(let m=0;m<t;m++){const _=m/t*(Math.PI*2),x=Math.sin(_)*e,A=Math.cos(_)*e;c.push(0,0,0),c.push(x,0,A);const I=m&1?o:l;a.push(I.r,I.g,I.b),a.push(I.r,I.g,I.b)}for(let m=0;m<r;m++){const _=m&1?o:l,x=e-e/r*m;for(let A=0;A<s;A++){let I=A/s*(Math.PI*2),E=Math.sin(I)*x,C=Math.cos(I)*x;c.push(E,0,C),a.push(_.r,_.g,_.b),I=(A+1)/s*(Math.PI*2),E=Math.sin(I)*x,C=Math.cos(I)*x,c.push(E,0,C),a.push(_.r,_.g,_.b)}}const d=new Yr;d.setAttribute("position",new lr(c,3)),d.setAttribute("color",new lr(a,3));const f=new Ia({vertexColors:!0,toneMapped:!1});super(d,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const H$=new Ze,V2=new Ze,j$=new Ze;class dAe extends Bi{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new Yr;s.setAttribute("position",new lr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new Ia({fog:!1,toneMapped:!1});this.lightPlane=new nf(s,o),this.add(this.lightPlane),s=new Yr,s.setAttribute("position",new lr([0,0,0,0,0,1],3)),this.targetLine=new nf(s,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),H$.setFromMatrixPosition(this.light.matrixWorld),V2.setFromMatrixPosition(this.light.target.matrixWorld),j$.subVectors(V2,H$),this.lightPlane.lookAt(V2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(V2),this.targetLine.scale.z=j$.length()}}const H2=new Ze,ta=new pC;class fAe extends vu{constructor(e){const t=new Yr,r=new Ia({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],o=[],l={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(A,I){a(A),a(I)}function a(A){s.push(0,0,0),o.push(0,0,0),l[A]===void 0&&(l[A]=[]),l[A].push(s.length/3-1)}t.setAttribute("position",new lr(s,3)),t.setAttribute("color",new lr(o,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const d=new Hn(16755200),f=new Hn(16711680),m=new Hn(43775),_=new Hn(16777215),x=new Hn(3355443);this.setColors(d,f,m,_,x)}setColors(e,t,r,s,o){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,r.r,r.g,r.b),c.setXYZ(33,r.r,r.g,r.b),c.setXYZ(34,r.r,r.g,r.b),c.setXYZ(35,r.r,r.g,r.b),c.setXYZ(36,r.r,r.g,r.b),c.setXYZ(37,r.r,r.g,r.b),c.setXYZ(38,s.r,s.g,s.b),c.setXYZ(39,s.r,s.g,s.b),c.setXYZ(40,o.r,o.g,o.b),c.setXYZ(41,o.r,o.g,o.b),c.setXYZ(42,o.r,o.g,o.b),c.setXYZ(43,o.r,o.g,o.b),c.setXYZ(44,o.r,o.g,o.b),c.setXYZ(45,o.r,o.g,o.b),c.setXYZ(46,o.r,o.g,o.b),c.setXYZ(47,o.r,o.g,o.b),c.setXYZ(48,o.r,o.g,o.b),c.setXYZ(49,o.r,o.g,o.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,s=1;ta.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),pa("c",t,e,ta,0,0,-1),pa("t",t,e,ta,0,0,1),pa("n1",t,e,ta,-r,-s,-1),pa("n2",t,e,ta,r,-s,-1),pa("n3",t,e,ta,-r,s,-1),pa("n4",t,e,ta,r,s,-1),pa("f1",t,e,ta,-r,-s,1),pa("f2",t,e,ta,r,-s,1),pa("f3",t,e,ta,-r,s,1),pa("f4",t,e,ta,r,s,1),pa("u1",t,e,ta,r*.7,s*1.1,-1),pa("u2",t,e,ta,-r*.7,s*1.1,-1),pa("u3",t,e,ta,0,s*2,-1),pa("cf1",t,e,ta,-r,0,1),pa("cf2",t,e,ta,r,0,1),pa("cf3",t,e,ta,0,-s,1),pa("cf4",t,e,ta,0,s,1),pa("cn1",t,e,ta,-r,0,-1),pa("cn2",t,e,ta,r,0,-1),pa("cn3",t,e,ta,0,-s,-1),pa("cn4",t,e,ta,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function pa(n,e,t,r,s,o,l){H2.set(s,o,l).unproject(r);const c=e[n];if(c!==void 0){const a=t.getAttribute("position");for(let d=0,f=c.length;d<f;d++)a.setXYZ(c[d],H2.x,H2.y,H2.z)}}const j2=new Cl;class pAe extends vu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),o=new Yr;o.setIndex(new Ni(r,1)),o.setAttribute("position",new Ni(s,3)),super(o,new Ia({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&j2.setFromObject(this.object),j2.isEmpty())return;const t=j2.min,r=j2.max,s=this.geometry.attributes.position,o=s.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=t.x,o[4]=r.y,o[5]=r.z,o[6]=t.x,o[7]=t.y,o[8]=r.z,o[9]=r.x,o[10]=t.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=t.z,o[15]=t.x,o[16]=r.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=r.x,o[22]=t.y,o[23]=t.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mAe extends vu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Yr;o.setIndex(new Ni(r,1)),o.setAttribute("position",new lr(s,3)),super(o,new Ia({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class gAe extends nf{constructor(e,t=1,r=16776960){const s=r,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new Yr;l.setAttribute("position",new lr(o,3)),l.computeBoundingSphere(),super(l,new Ia({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new Yr;a.setAttribute("position",new lr(c,3)),a.computeBoundingSphere(),this.add(new Di(a,new bo({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const W$=new Ze;let W2,IF;class vAe extends Bi{constructor(e=new Ze(0,0,1),t=new Ze(0,0,0),r=1,s=16776960,o=r*.2,l=o*.2){super(),this.type="ArrowHelper",W2===void 0&&(W2=new Yr,W2.setAttribute("position",new lr([0,0,0,0,1,0],3)),IF=new Vw(0,.5,1,5,1),IF.translate(0,-.5,0)),this.position.copy(t),this.line=new nf(W2,new Ia({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Di(IF,new bo({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,o,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{W$.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(W$,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class _Ae extends vu{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new Yr;s.setAttribute("position",new lr(t,3)),s.setAttribute("color",new lr(r,3));const o=new Ia({vertexColors:!0,toneMapped:!1});super(s,o),this.type="AxesHelper"}setColors(e,t,r){const s=new Hn,o=this.geometry.attributes.color.array;return s.set(e),s.toArray(o,0),s.toArray(o,3),s.set(t),s.toArray(o,6),s.toArray(o,9),s.set(r),s.toArray(o,12),s.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yAe{constructor(){this.type="ShapePath",this.color=new Hn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new wM,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,s){return this.currentPath.quadraticCurveTo(e,t,r,s),this}bezierCurveTo(e,t,r,s,o,l){return this.currentPath.bezierCurveTo(e,t,r,s,o,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(C){const L=[];for(let O=0,H=C.length;O<H;O++){const q=C[O],Z=new Jy;Z.curves=q.curves,L.push(Z)}return L}function r(C,L){const O=L.length;let H=!1;for(let q=O-1,Z=0;Z<O;q=Z++){let J=L[q],re=L[Z],se=re.x-J.x,ae=re.y-J.y;if(Math.abs(ae)>Number.EPSILON){if(ae<0&&(J=L[Z],se=-se,re=L[q],ae=-ae),C.y<J.y||C.y>re.y)continue;if(C.y===J.y){if(C.x===J.x)return!0}else{const he=ae*(C.x-J.x)-se*(C.y-J.y);if(he===0)return!0;if(he<0)continue;H=!H}}else{if(C.y!==J.y)continue;if(re.x<=C.x&&C.x<=J.x||J.x<=C.x&&C.x<=re.x)return!0}}return H}const s=gp.isClockWise,o=this.subPaths;if(o.length===0)return[];let l,c,a;const d=[];if(o.length===1)return c=o[0],a=new Jy,a.curves=c.curves,d.push(a),d;let f=!s(o[0].getPoints());f=e?!f:f;const m=[],_=[];let x=[],A=0,I;_[A]=void 0,x[A]=[];for(let C=0,L=o.length;C<L;C++)c=o[C],I=c.getPoints(),l=s(I),l=e?!l:l,l?(!f&&_[A]&&A++,_[A]={s:new Jy,p:I},_[A].s.curves=c.curves,f&&A++,x[A]=[]):x[A].push({h:c,p:I[0]});if(!_[0])return t(o);if(_.length>1){let C=!1,L=0;for(let O=0,H=_.length;O<H;O++)m[O]=[];for(let O=0,H=_.length;O<H;O++){const q=x[O];for(let Z=0;Z<q.length;Z++){const J=q[Z];let re=!0;for(let se=0;se<_.length;se++)r(J.p,_[se].p)&&(O!==se&&L++,re?(re=!1,m[se].push(J)):C=!0);re&&m[O].push(J)}}L>0&&C===!1&&(x=m)}let E;for(let C=0,L=_.length;C<L;C++){a=_[C].s,d.push(a),E=x[C];for(let O=0,H=E.length;O<H;O++)a.holes.push(E[O].h)}return d}}class xAe extends Ml{constructor(e=1,t=1,r=1,s={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...s,count:r}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:aC}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=aC);const Zre=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:MD,AddEquation:Xv,AddOperation:Pne,AdditiveAnimationBlendMode:A6,AdditiveBlending:gw,AgXToneMapping:Bne,AlphaFormat:_6,AlwaysCompare:Yne,AlwaysDepth:Sne,AlwaysStencilFunc:rz,AmbientLight:Ox,AnimationAction:Xre,AnimationClip:vx,AnimationLoader:ISe,AnimationMixer:qre,AnimationObjectGroup:ZSe,AnimationUtils:TSe,ArcCurve:mre,ArrayCamera:ure,ArrowHelper:vAe,AttachedBindMode:nz,Audio:jre,AudioAnalyser:USe,AudioContext:Z6,AudioListener:Hre,AudioLoader:Vre,AxesHelper:_Ae,BackSide:Rc,BasicDepthPacking:Une,BasicShadowMap:rne,BatchedMesh:fre,Bone:_C,BooleanKeyframeTrack:Bx,Box2:rAe,Box3:Cl,Box3Helper:mAe,BoxGeometry:Mp,BoxHelper:pAe,BufferAttribute:Ni,BufferGeometry:Yr,BufferGeometryLoader:Gre,ByteType:m6,Cache:zm,Camera:pC,CameraHelper:fAe,CanvasTexture:cz,CapsuleGeometry:HD,CatmullRomCurve3:gre,CineonToneMapping:TD,CircleGeometry:jD,ClampToEdgeWrapping:uu,Clock:dg,Color:Hn,ColorKeyframeTrack:$6,ColorManagement:_s,CompressedArrayTexture:qwe,CompressedCubeTexture:Ywe,CompressedTexture:GD,CompressedTextureLoader:PSe,ConeGeometry:WD,ConstantAlphaFactor:xne,ConstantColorFactor:_ne,CubeCamera:nre,CubeReflectionMapping:Qm,CubeRefractionMapping:b0,CubeTexture:mC,CubeTextureLoader:kre,CubeUVReflectionMapping:Fw,CubicBezierCurve:N6,CubicBezierCurve3:vre,CubicInterpolant:Lre,CullFaceBack:Q4,CullFaceFront:nne,CullFaceFrontBack:D0e,CullFaceNone:tne,Curve:lf,CurvePath:yre,CustomBlending:ine,CustomToneMapping:Dne,CylinderGeometry:Vw,Cylindrical:nAe,Data3DTexture:I6,DataArrayTexture:kD,DataTexture:Qd,DataTextureLoader:RSe,DataUtils:U_e,DecrementStencilOp:V0e,DecrementWrapStencilOp:j0e,DefaultLoadingManager:X6,DepthFormat:Yy,DepthStencilFormat:dx,DepthTexture:D6,DetachedBindMode:One,DirectionalLight:H0,DirectionalLightHelper:dAe,DiscreteInterpolant:Dre,DisplayP3ColorSpace:BD,DodecahedronGeometry:$D,DoubleSide:Mc,DstAlphaFactor:fne,DstColorFactor:mne,DynamicCopyUsage:s_e,DynamicDrawUsage:Q0e,DynamicReadUsage:n_e,EdgesGeometry:xre,EllipseCurve:VD,EqualCompare:Wne,EqualDepth:Tne,EqualStencilFunc:q0e,EquirectangularReflectionMapping:fM,EquirectangularRefractionMapping:pM,Euler:ju,EventDispatcher:Tp,ExtrudeGeometry:qD,FileLoader:Ya,Float16BufferAttribute:$_e,Float32BufferAttribute:lr,FloatType:Ec,Fog:zw,FogExp2:vC,FramebufferTexture:Xwe,FrontSide:Uh,Frustum:gC,GLBufferAttribute:tAe,GLSL1:a_e,GLSL3:iz,GreaterCompare:$ne,GreaterDepth:Cne,GreaterEqualCompare:qne,GreaterEqualDepth:Mne,GreaterEqualStencilFunc:J0e,GreaterStencilFunc:Z0e,GridHelper:uAe,Group:Kl,HalfFloatType:Bh,HemisphereLight:Ore,HemisphereLightHelper:cAe,IcosahedronGeometry:gx,ImageBitmapLoader:Y6,ImageLoader:MM,ImageUtils:Jne,IncrementStencilOp:G0e,IncrementWrapStencilOp:H0e,InstancedBufferAttribute:S0,InstancedBufferGeometry:Ure,InstancedInterleavedBuffer:eAe,InstancedMesh:zD,Int16BufferAttribute:j_e,Int32BufferAttribute:W_e,Int8BufferAttribute:G_e,IntType:ED,InterleavedBuffer:Uw,InterleavedBufferAttribute:ng,Interpolant:Dx,InterpolateDiscrete:fx,InterpolateLinear:w0,InterpolateSmooth:_P,InvertStencilOp:W0e,KeepStencilOp:xy,KeyframeTrack:cf,LOD:dre,LatheGeometry:yC,Layers:Ky,LessCompare:jne,LessDepth:Ane,LessEqualCompare:M6,LessEqualDepth:dM,LessEqualStencilFunc:Y0e,LessStencilFunc:X0e,Light:V0,LightProbe:zre,Line:nf,Line3:iAe,LineBasicMaterial:Ia,LineCurve:z6,LineCurve3:_re,LineDashedMaterial:H6,LineLoop:UD,LineSegments:vu,LinearDisplayP3ColorSpace:fC,LinearFilter:Ro,LinearInterpolant:W6,LinearMipMapLinearFilter:F0e,LinearMipMapNearestFilter:O0e,LinearMipmapLinearFilter:hu,LinearMipmapNearestFilter:qy,LinearSRGBColorSpace:$a,LinearToneMapping:Rne,LinearTransfer:gM,Loader:La,LoaderUtils:gu,LoadingManager:AC,LoopOnce:Fne,LoopPingPong:zne,LoopRepeat:Nne,LuminanceAlphaFormat:b6,LuminanceFormat:x6,MOUSE:_y,Material:wo,MaterialLoader:tB,MathUtils:so,Matrix3:Mi,Matrix4:Hr,MaxEquation:lne,Mesh:Di,MeshBasicMaterial:bo,MeshDepthMaterial:B6,MeshDistanceMaterial:k6,MeshLambertMaterial:SC,MeshMatcapMaterial:Ire,MeshNormalMaterial:Ere,MeshPhongMaterial:wC,MeshPhysicalMaterial:qo,MeshStandardMaterial:xp,MeshToonMaterial:Cre,MinEquation:ane,MirroredRepeatWrapping:ux,MixOperation:Ine,MultiplyBlending:tz,MultiplyOperation:lC,NearestFilter:Ma,NearestMipMapLinearFilter:k0e,NearestMipMapNearestFilter:B0e,NearestMipmapLinearFilter:Jv,NearestMipmapNearestFilter:cC,NeutralToneMapping:kne,NeverCompare:Hne,NeverDepth:wne,NeverStencilFunc:$0e,NoBlending:pp,NoColorSpace:Bm,NoToneMapping:mp,NormalAnimationBlendMode:DD,NormalBlending:Xy,NotEqualCompare:Xne,NotEqualDepth:Ene,NotEqualStencilFunc:K0e,NumberKeyframeTrack:rg,Object3D:Bi,ObjectLoader:kSe,ObjectSpaceNormalMap:Vne,OctahedronGeometry:xC,OneFactor:une,OneMinusConstantAlphaFactor:bne,OneMinusConstantColorFactor:yne,OneMinusDstAlphaFactor:pne,OneMinusDstColorFactor:gne,OneMinusSrcAlphaFactor:yR,OneMinusSrcColorFactor:dne,OrthographicCamera:af,P3Primaries:_M,PCFShadowMap:AD,PCFSoftShadowMap:fT,PMREMGenerator:sz,Path:wM,PerspectiveCamera:is,Plane:Lm,PlaneGeometry:hg,PlaneHelper:gAe,PointLight:p0,PointLightHelper:aAe,Points:Rh,PointsMaterial:du,PolarGridHelper:hAe,PolyhedronGeometry:G0,PositionalAudio:Wre,PropertyBinding:rs,PropertyMixer:$re,QuadraticBezierCurve:U6,QuadraticBezierCurve3:G6,Quaternion:Ea,QuaternionKeyframeTrack:ig,QuaternionLinearInterpolant:Bre,RED_GREEN_RGTC2_Format:jR,RED_RGTC1_Format:S6,REVISION:aC,RGBADepthPacking:Gne,RGBAFormat:Zl,RGBAIntegerFormat:LD,RGBA_ASTC_10x10_Format:NR,RGBA_ASTC_10x5_Format:kR,RGBA_ASTC_10x6_Format:OR,RGBA_ASTC_10x8_Format:FR,RGBA_ASTC_12x10_Format:zR,RGBA_ASTC_12x12_Format:UR,RGBA_ASTC_4x4_Format:CR,RGBA_ASTC_5x4_Format:ER,RGBA_ASTC_5x5_Format:IR,RGBA_ASTC_6x5_Format:PR,RGBA_ASTC_6x6_Format:RR,RGBA_ASTC_8x5_Format:LR,RGBA_ASTC_8x6_Format:DR,RGBA_ASTC_8x8_Format:BR,RGBA_BPTC_Format:_T,RGBA_ETC2_EAC_Format:MR,RGBA_PVRTC_2BPPV1_Format:SR,RGBA_PVRTC_4BPPV1_Format:wR,RGBA_S3TC_DXT1_Format:mT,RGBA_S3TC_DXT3_Format:gT,RGBA_S3TC_DXT5_Format:vT,RGBFormat:y6,RGBIntegerFormat:N0e,RGB_BPTC_SIGNED_Format:GR,RGB_BPTC_UNSIGNED_Format:VR,RGB_ETC1_Format:AR,RGB_ETC2_Format:TR,RGB_PVRTC_2BPPV1_Format:bR,RGB_PVRTC_4BPPV1_Format:xR,RGB_S3TC_DXT1_Format:pT,RGFormat:w6,RGIntegerFormat:RD,RawShaderMaterial:Mre,Ray:Lx,Raycaster:nB,Rec709Primaries:vM,RectAreaLight:Fre,RedFormat:uC,RedIntegerFormat:hC,ReinhardToneMapping:Lne,RenderTarget:Qne,RepeatWrapping:Gh,ReplaceStencilOp:U0e,ReverseSubtractEquation:one,RingGeometry:YD,SIGNED_RED_GREEN_RGTC2_Format:WR,SIGNED_RED_RGTC1_Format:HR,SRGBColorSpace:Eo,SRGBTransfer:io,Scene:Il,ShaderChunk:Pi,ShaderLib:Wd,ShaderMaterial:Lo,ShadowMaterial:Tre,Shape:Jy,ShapeGeometry:ZD,ShapePath:yAe,ShapeUtils:gp,ShortType:g6,Skeleton:Gw,SkeletonHelper:oAe,SkinnedMesh:ND,Source:By,Sphere:al,SphereGeometry:Wm,Spherical:CM,SphericalHarmonics3:Nre,SplineCurve:V6,SpotLight:eB,SpotLightHelper:sAe,Sprite:O6,SpriteMaterial:FD,SrcAlphaFactor:_R,SrcAlphaSaturateFactor:vne,SrcColorFactor:hne,StaticCopyUsage:i_e,StaticDrawUsage:yM,StaticReadUsage:t_e,StereoCamera:FSe,StreamCopyUsage:o_e,StreamDrawUsage:e_e,StreamReadUsage:r_e,StringKeyframeTrack:kx,SubtractEquation:sne,SubtractiveBlending:ez,TOUCH:yy,TangentSpaceNormalMap:U0,TetrahedronGeometry:KD,Texture:Ys,TextureLoader:rf,TextureUtils:Cwe,TorusGeometry:bC,TorusKnotGeometry:JD,Triangle:Qv,TriangleFanDrawMode:px,TriangleStripDrawMode:dC,TrianglesDrawMode:T6,TubeGeometry:QD,UVMapping:CD,Uint16BufferAttribute:P6,Uint32BufferAttribute:R6,Uint8BufferAttribute:V_e,Uint8ClampedBufferAttribute:H_e,Uniform:Q6,UniformsGroup:QSe,UniformsLib:dr,UniformsUtils:tg,UnsignedByteType:tf,UnsignedInt248Type:hx,UnsignedInt5999Type:v6,UnsignedIntType:eg,UnsignedShort4444Type:ID,UnsignedShort5551Type:PD,UnsignedShortType:vw,VSMShadowMap:Gd,Vector2:sn,Vector3:Ze,Vector4:Ls,VectorKeyframeTrack:sg,VideoTexture:pre,WebGL3DRenderTarget:P_e,WebGLArrayRenderTarget:I_e,WebGLCoordinateSystem:ap,WebGLCubeRenderTarget:rre,WebGLMultipleRenderTargets:xAe,WebGLRenderTarget:Ml,WebGLRenderer:ec,WebGLUtils:cre,WebGPUCoordinateSystem:xM,WireframeGeometry:Are,WrapAroundEnding:mM,ZeroCurvatureEnding:Ly,ZeroFactor:cne,ZeroSlopeEnding:Dy,ZeroStencilOp:z0e,createCanvasElement:Kne},Symbol.toStringTag,{value:"Module"}));var Kre={exports:{}},Fx={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Fx.ConcurrentRoot=1;Fx.ContinuousEventPriority=4;Fx.DefaultEventPriority=16;Fx.DiscreteEventPriority=1;Fx.IdleEventPriority=536870912;Fx.LegacyRoot=0;Kre.exports=Fx;var Db=Kre.exports;function bAe(n){let e;const t=new Set,r=(d,f)=>{const m=typeof d=="function"?d(e):d;if(m!==e){const _=e;e=f?m:Object.assign({},e,m),t.forEach(x=>x(e,_))}},s=()=>e,o=(d,f=s,m=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let _=f(e);function x(){const A=f(e);if(!m(_,A)){const I=_;d(_=A,I)}}return t.add(x),()=>t.delete(x)},a={setState:r,getState:s,subscribe:(d,f,m)=>f||m?o(d,f,m):(t.add(d),()=>t.delete(d)),destroy:()=>t.clear()};return e=n(r,s,a),a}const wAe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),$$=wAe?_e.useEffect:_e.useLayoutEffect;function SAe(n){const e=typeof n=="function"?bAe(n):n,t=(r=e.getState,s=Object.is)=>{const[,o]=_e.useReducer(E=>E+1,0),l=e.getState(),c=_e.useRef(l),a=_e.useRef(r),d=_e.useRef(s),f=_e.useRef(!1),m=_e.useRef();m.current===void 0&&(m.current=r(l));let _,x=!1;(c.current!==l||a.current!==r||d.current!==s||f.current)&&(_=r(l),x=!s(m.current,_)),$$(()=>{x&&(m.current=_),c.current=l,a.current=r,d.current=s,f.current=!1});const A=_e.useRef(l);$$(()=>{const E=()=>{try{const L=e.getState(),O=a.current(L);d.current(m.current,O)||(c.current=L,m.current=O,o())}catch{f.current=!0,o()}},C=e.subscribe(E);return e.getState()!==A.current&&E(),C},[]);const I=x?_:m.current;return _e.useDebugValue(I),I};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const s=r.length<=0;return{value:r.shift(),done:s}}}},t}var Jre={exports:{}},PF={exports:{}},RF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X$;function AAe(){return X$||(X$=1,function(n){function e(ye,We){var Ue=ye.length;ye.push(We);e:for(;0<Ue;){var gt=Ue-1>>>1,vt=ye[gt];if(0<s(vt,We))ye[gt]=We,ye[Ue]=vt,Ue=gt;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var We=ye[0],Ue=ye.pop();if(Ue!==We){ye[0]=Ue;e:for(var gt=0,vt=ye.length,Dt=vt>>>1;gt<Dt;){var lt=2*(gt+1)-1,jt=ye[lt],Qt=lt+1,nn=ye[Qt];if(0>s(jt,Ue))Qt<vt&&0>s(nn,jt)?(ye[gt]=nn,ye[Qt]=Ue,gt=Qt):(ye[gt]=jt,ye[lt]=Ue,gt=lt);else if(Qt<vt&&0>s(nn,Ue))ye[gt]=nn,ye[Qt]=Ue,gt=Qt;else break e}}return We}function s(ye,We){var Ue=ye.sortIndex-We.sortIndex;return Ue!==0?Ue:ye.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var a=[],d=[],f=1,m=null,_=3,x=!1,A=!1,I=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(ye){for(var We=t(d);We!==null;){if(We.callback===null)r(d);else if(We.startTime<=ye)r(d),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(d)}}function H(ye){if(I=!1,O(ye),!A)if(t(a)!==null)A=!0,Re(q);else{var We=t(d);We!==null&&rt(H,We.startTime-ye)}}function q(ye,We){A=!1,I&&(I=!1,C(re),re=-1),x=!0;var Ue=_;try{for(O(We),m=t(a);m!==null&&(!(m.expirationTime>We)||ye&&!he());){var gt=m.callback;if(typeof gt=="function"){m.callback=null,_=m.priorityLevel;var vt=gt(m.expirationTime<=We);We=n.unstable_now(),typeof vt=="function"?m.callback=vt:m===t(a)&&r(a),O(We)}else r(a);m=t(a)}if(m!==null)var Dt=!0;else{var lt=t(d);lt!==null&&rt(H,lt.startTime-We),Dt=!1}return Dt}finally{m=null,_=Ue,x=!1}}var Z=!1,J=null,re=-1,se=5,ae=-1;function he(){return!(n.unstable_now()-ae<se)}function Ae(){if(J!==null){var ye=n.unstable_now();ae=ye;var We=!0;try{We=J(!0,ye)}finally{We?Ee():(Z=!1,J=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Ae)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,ze=Pe.port2;Pe.port1.onmessage=Ae,Ee=function(){ze.postMessage(null)}}else Ee=function(){E(Ae,0)};function Re(ye){J=ye,Z||(Z=!0,Ee())}function rt(ye,We){re=E(function(){ye(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){A||x||(A=!0,Re(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(ye){switch(_){case 1:case 2:case 3:var We=3;break;default:We=_}var Ue=_;_=We;try{return ye()}finally{_=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,We){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ue=_;_=ye;try{return We()}finally{_=Ue}},n.unstable_scheduleCallback=function(ye,We,Ue){var gt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?gt+Ue:gt):Ue=gt,ye){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=Ue+vt,ye={id:f++,callback:We,priorityLevel:ye,startTime:Ue,expirationTime:vt,sortIndex:-1},Ue>gt?(ye.sortIndex=Ue,e(d,ye),t(a)===null&&ye===t(d)&&(I?(C(re),re=-1):I=!0,rt(H,Ue-gt))):(ye.sortIndex=vt,e(a,ye),A||x||(A=!0,Re(q))),ye},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(ye){var We=_;return function(){var Ue=_;_=We;try{return ye.apply(this,arguments)}finally{_=Ue}}}}(RF)),RF}var q$;function TAe(){return q$||(q$=1,PF.exports=AAe()),PF.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MAe=function(e){var t={},r=_e,s=TAe(),o=Object.assign;function l(B){for(var F="https://reactjs.org/docs/error-decoder.html?invariant="+B,K=1;K<arguments.length;K++)F+="&args[]="+encodeURIComponent(arguments[K]);return"Minified React error #"+B+"; visit "+F+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),q=Symbol.iterator;function Z(B){return B===null||typeof B!="object"?null:(B=q&&B[q]||B["@@iterator"],typeof B=="function"?B:null)}function J(B){if(B==null)return null;if(typeof B=="function")return B.displayName||B.name||null;if(typeof B=="string")return B;switch(B){case f:return"Fragment";case d:return"Portal";case _:return"Profiler";case m:return"StrictMode";case E:return"Suspense";case C:return"SuspenseList"}if(typeof B=="object")switch(B.$$typeof){case A:return(B.displayName||"Context")+".Consumer";case x:return(B._context.displayName||"Context")+".Provider";case I:var F=B.render;return B=B.displayName,B||(B=F.displayName||F.name||"",B=B!==""?"ForwardRef("+B+")":"ForwardRef"),B;case L:return F=B.displayName||null,F!==null?F:J(B.type)||"Memo";case O:F=B._payload,B=B._init;try{return J(B(F))}catch{}}return null}function re(B){var F=B.type;switch(B.tag){case 24:return"Cache";case 9:return(F.displayName||"Context")+".Consumer";case 10:return(F._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return B=F.render,B=B.displayName||B.name||"",F.displayName||(B!==""?"ForwardRef("+B+")":"ForwardRef");case 7:return"Fragment";case 5:return F;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J(F);case 8:return F===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof F=="function")return F.displayName||F.name||null;if(typeof F=="string")return F}return null}function se(B){var F=B,K=B;if(B.alternate)for(;F.return;)F=F.return;else{B=F;do F=B,F.flags&4098&&(K=F.return),B=F.return;while(B)}return F.tag===3?K:null}function ae(B){if(se(B)!==B)throw Error(l(188))}function he(B){var F=B.alternate;if(!F){if(F=se(B),F===null)throw Error(l(188));return F!==B?null:B}for(var K=B,oe=F;;){var ge=K.return;if(ge===null)break;var Me=ge.alternate;if(Me===null){if(oe=ge.return,oe!==null){K=oe;continue}break}if(ge.child===Me.child){for(Me=ge.child;Me;){if(Me===K)return ae(ge),B;if(Me===oe)return ae(ge),F;Me=Me.sibling}throw Error(l(188))}if(K.return!==oe.return)K=ge,oe=Me;else{for(var pt=!1,Nt=ge.child;Nt;){if(Nt===K){pt=!0,K=ge,oe=Me;break}if(Nt===oe){pt=!0,oe=ge,K=Me;break}Nt=Nt.sibling}if(!pt){for(Nt=Me.child;Nt;){if(Nt===K){pt=!0,K=Me,oe=ge;break}if(Nt===oe){pt=!0,oe=Me,K=ge;break}Nt=Nt.sibling}if(!pt)throw Error(l(189))}}if(K.alternate!==oe)throw Error(l(190))}if(K.tag!==3)throw Error(l(188));return K.stateNode.current===K?B:F}function Ae(B){return B=he(B),B!==null?Ee(B):null}function Ee(B){if(B.tag===5||B.tag===6)return B;for(B=B.child;B!==null;){var F=Ee(B);if(F!==null)return F;B=B.sibling}return null}function Pe(B){if(B.tag===5||B.tag===6)return B;for(B=B.child;B!==null;){if(B.tag!==4){var F=Pe(B);if(F!==null)return F}B=B.sibling}return null}var ze=Array.isArray,Re=e.getPublicInstance,rt=e.getRootHostContext,ye=e.getChildHostContext,We=e.prepareForCommit,Ue=e.resetAfterCommit,gt=e.createInstance,vt=e.appendInitialChild,Dt=e.finalizeInitialChildren,lt=e.prepareUpdate,jt=e.shouldSetTextContent,Qt=e.createTextInstance,nn=e.scheduleTimeout,Wn=e.cancelTimeout,kn=e.noTimeout,Mn=e.isPrimaryRenderer,De=e.supportsMutation,Ye=e.supportsPersistence,gn=e.supportsHydration,un=e.getInstanceFromNode,At=e.preparePortalMount,en=e.getCurrentEventPriority,On=e.detachDeletedInstance,Vn=e.supportsMicrotasks,on=e.scheduleMicrotask,ct=e.supportsTestSelectors,He=e.findFiberRoot,qt=e.getBoundingRect,Tn=e.getTextContent,An=e.isHiddenSubtree,Wt=e.matchAccessibilityRole,gr=e.setFocusIfFocusable,Gn=e.setupIntersectionObserver,nr=e.appendChild,Ar=e.appendChildToContainer,Dn=e.commitTextUpdate,sr=e.commitMount,di=e.commitUpdate,zr=e.insertBefore,ar=e.insertInContainerBefore,Ur=e.removeChild,Wr=e.removeChildFromContainer,Si=e.resetTextContent,Ne=e.hideInstance,Bt=e.hideTextInstance,Jt=e.unhideInstance,hn=e.unhideTextInstance,In=e.clearContainer,Tr=e.cloneInstance,jr=e.createContainerChildSet,ps=e.appendChildToContainerChildSet,Bs=e.finalizeContainerChildren,fi=e.replaceContainerChildren,Mt=e.cloneHiddenInstance,we=e.cloneHiddenTextInstance,Ie=e.canHydrateInstance,qe=e.canHydrateTextInstance,it=e.canHydrateSuspenseInstance,Qe=e.isSuspenseInstancePending,mt=e.isSuspenseInstanceFallback,Rt=e.registerSuspenseInstanceRetry,yt=e.getNextHydratableSibling,Lt=e.getFirstHydratableChild,Gt=e.getFirstHydratableChildWithinContainer,Ot=e.getFirstHydratableChildWithinSuspenseInstance,cn=e.hydrateInstance,Cn=e.hydrateTextInstance,En=e.hydrateSuspenseInstance,je=e.getNextHydratableInstanceAfterSuspenseInstance,bt=e.commitHydratedContainer,Ct=e.commitHydratedSuspenseInstance,Et=e.clearSuspenseBoundary,Pt=e.clearSuspenseBoundaryFromContainer,Sn=e.shouldDeleteUnhydratedTailInstances,yn=e.didNotMatchHydratedContainerTextInstance,Un=e.didNotMatchHydratedTextInstance,Xn;function cr(B){if(Xn===void 0)try{throw Error()}catch(K){var F=K.stack.trim().match(/\n( *(at )?)/);Xn=F&&F[1]||""}return`
`+Xn+B}var vr=!1;function pr(B,F){if(!B||vr)return"";vr=!0;var K=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(F)if(F=function(){throw Error()},Object.defineProperty(F.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(F,[])}catch($n){var oe=$n}Reflect.construct(B,[],F)}else{try{F.call()}catch($n){oe=$n}B.call(F.prototype)}else{try{throw Error()}catch($n){oe=$n}B()}}catch($n){if($n&&oe&&typeof $n.stack=="string"){for(var ge=$n.stack.split(`
`),Me=oe.stack.split(`
`),pt=ge.length-1,Nt=Me.length-1;1<=pt&&0<=Nt&&ge[pt]!==Me[Nt];)Nt--;for(;1<=pt&&0<=Nt;pt--,Nt--)if(ge[pt]!==Me[Nt]){if(pt!==1||Nt!==1)do if(pt--,Nt--,0>Nt||ge[pt]!==Me[Nt]){var _n=`
`+ge[pt].replace(" at new "," at ");return B.displayName&&_n.includes("<anonymous>")&&(_n=_n.replace("<anonymous>",B.displayName)),_n}while(1<=pt&&0<=Nt);break}}}finally{vr=!1,Error.prepareStackTrace=K}return(B=B?B.displayName||B.name:"")?cr(B):""}var pi=Object.prototype.hasOwnProperty,zi=[],Xi=-1;function Ms(B){return{current:B}}function Ir(B){0>Xi||(B.current=zi[Xi],zi[Xi]=null,Xi--)}function er(B,F){Xi++,zi[Xi]=B.current,B.current=F}var Qi={},Zr=Ms(Qi),bs=Ms(!1),Yo=Qi;function ks(B,F){var K=B.type.contextTypes;if(!K)return Qi;var oe=B.stateNode;if(oe&&oe.__reactInternalMemoizedUnmaskedChildContext===F)return oe.__reactInternalMemoizedMaskedChildContext;var ge={},Me;for(Me in K)ge[Me]=F[Me];return oe&&(B=B.stateNode,B.__reactInternalMemoizedUnmaskedChildContext=F,B.__reactInternalMemoizedMaskedChildContext=ge),ge}function ms(B){return B=B.childContextTypes,B!=null}function ki(){Ir(bs),Ir(Zr)}function co(B,F,K){if(Zr.current!==Qi)throw Error(l(168));er(Zr,F),er(bs,K)}function Bo(B,F,K){var oe=B.stateNode;if(F=F.childContextTypes,typeof oe.getChildContext!="function")return K;oe=oe.getChildContext();for(var ge in oe)if(!(ge in F))throw Error(l(108,re(B)||"Unknown",ge));return o({},K,oe)}function Cs(B){return B=(B=B.stateNode)&&B.__reactInternalMemoizedMergedChildContext||Qi,Yo=Zr.current,er(Zr,B),er(bs,bs.current),!0}function Nc(B,F,K){var oe=B.stateNode;if(!oe)throw Error(l(169));K?(B=Bo(B,F,Yo),oe.__reactInternalMemoizedMergedChildContext=B,Ir(bs),Ir(Zr),er(Zr,B)):Ir(bs),er(bs,K)}var Da=Math.clz32?Math.clz32:gg,gf=Math.log,zc=Math.LN2;function gg(B){return B>>>=0,B===0?32:31-(gf(B)/zc|0)|0}var Dp=64,vg=4194304;function Zo(B){switch(B&-B){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return B&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return B&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return B}}function tc(B,F){var K=B.pendingLanes;if(K===0)return 0;var oe=0,ge=B.suspendedLanes,Me=B.pingedLanes,pt=K&268435455;if(pt!==0){var Nt=pt&~ge;Nt!==0?oe=Zo(Nt):(Me&=pt,Me!==0&&(oe=Zo(Me)))}else pt=K&~ge,pt!==0?oe=Zo(pt):Me!==0&&(oe=Zo(Me));if(oe===0)return 0;if(F!==0&&F!==oe&&!(F&ge)&&(ge=oe&-oe,Me=F&-F,ge>=Me||ge===16&&(Me&4194240)!==0))return F;if(oe&4&&(oe|=K&16),F=B.entangledLanes,F!==0)for(B=B.entanglements,F&=oe;0<F;)K=31-Da(F),ge=1<<K,oe|=B[K],F&=~ge;return oe}function Bp(B,F){switch(B){case 1:case 2:case 4:return F+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return F+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vf(B,F){for(var K=B.suspendedLanes,oe=B.pingedLanes,ge=B.expirationTimes,Me=B.pendingLanes;0<Me;){var pt=31-Da(Me),Nt=1<<pt,_n=ge[pt];_n===-1?(!(Nt&K)||Nt&oe)&&(ge[pt]=Bp(Nt,F)):_n<=F&&(B.expiredLanes|=Nt),Me&=~Nt}}function kp(B){return B=B.pendingLanes&-1073741825,B!==0?B:B&1073741824?1073741824:0}function Xu(B){for(var F=[],K=0;31>K;K++)F.push(B);return F}function qh(B,F,K){B.pendingLanes|=F,F!==536870912&&(B.suspendedLanes=0,B.pingedLanes=0),B=B.eventTimes,F=31-Da(F),B[F]=K}function ai(B,F){var K=B.pendingLanes&~F;B.pendingLanes=F,B.suspendedLanes=0,B.pingedLanes=0,B.expiredLanes&=F,B.mutableReadLanes&=F,B.entangledLanes&=F,F=B.entanglements;var oe=B.eventTimes;for(B=B.expirationTimes;0<K;){var ge=31-Da(K),Me=1<<ge;F[ge]=0,oe[ge]=-1,B[ge]=-1,K&=~Me}}function Op(B,F){var K=B.entangledLanes|=F;for(B=B.entanglements;K;){var oe=31-Da(K),ge=1<<oe;ge&F|B[oe]&F&&(B[oe]|=F),K&=~ge}}var _r=0;function Gx(B){return B&=-B,1<B?4<B?B&268435455?16:536870912:4:1}var ur=s.unstable_scheduleCallback,_f=s.unstable_cancelCallback,Yh=s.unstable_shouldYield,yf=s.unstable_requestPaint,Ss=s.unstable_now,xf=s.unstable_ImmediatePriority,nc=s.unstable_UserBlockingPriority,Fn=s.unstable_NormalPriority,ni=s.unstable_IdlePriority,Kr=null,Hs=null;function ya(B){if(Hs&&typeof Hs.onCommitFiberRoot=="function")try{Hs.onCommitFiberRoot(Kr,B,void 0,(B.current.flags&128)===128)}catch{}}function ii(B,F){return B===F&&(B!==0||1/B===1/F)||B!==B&&F!==F}var ul=typeof Object.is=="function"?Object.is:ii,Za=null,yu=!1,la=!1;function Es(B){Za===null?Za=[B]:Za.push(B)}function Vx(B){yu=!0,Es(B)}function Ba(){if(!la&&Za!==null){la=!0;var B=0,F=_r;try{var K=Za;for(_r=1;B<K.length;B++){var oe=K[B];do oe=oe(!0);while(oe!==null)}Za=null,yu=!1}catch(ge){throw Za!==null&&(Za=Za.slice(B+1)),ur(xf,Ba),ge}finally{_r=F,la=!1}}return null}var bf=c.ReactCurrentBatchConfig;function hl(B,F){if(ul(B,F))return!0;if(typeof B!="object"||B===null||typeof F!="object"||F===null)return!1;var K=Object.keys(B),oe=Object.keys(F);if(K.length!==oe.length)return!1;for(oe=0;oe<K.length;oe++){var ge=K[oe];if(!pi.call(F,ge)||!ul(B[ge],F[ge]))return!1}return!0}function _g(B){switch(B.tag){case 5:return cr(B.type);case 16:return cr("Lazy");case 13:return cr("Suspense");case 19:return cr("SuspenseList");case 0:case 2:case 15:return B=pr(B.type,!1),B;case 11:return B=pr(B.type.render,!1),B;case 1:return B=pr(B.type,!0),B;default:return""}}function js(B,F){if(B&&B.defaultProps){F=o({},F),B=B.defaultProps;for(var K in B)F[K]===void 0&&(F[K]=B[K]);return F}return F}var ko=Ms(null),Ko=null,Zh=null,Uc=null;function Os(){Uc=Zh=Ko=null}function xa(B,F,K){Mn?(er(ko,F._currentValue),F._currentValue=K):(er(ko,F._currentValue2),F._currentValue2=K)}function dl(B){var F=ko.current;Ir(ko),Mn?B._currentValue=F:B._currentValue2=F}function Ks(B,F,K){for(;B!==null;){var oe=B.alternate;if((B.childLanes&F)!==F?(B.childLanes|=F,oe!==null&&(oe.childLanes|=F)):oe!==null&&(oe.childLanes&F)!==F&&(oe.childLanes|=F),B===K)break;B=B.return}}function qu(B,F){Ko=B,Uc=Zh=null,B=B.dependencies,B!==null&&B.firstContext!==null&&(B.lanes&F&&(Ao=!0),B.firstContext=null)}function Js(B){var F=Mn?B._currentValue:B._currentValue2;if(Uc!==B)if(B={context:B,memoizedValue:F,next:null},Zh===null){if(Ko===null)throw Error(l(308));Zh=B,Ko.dependencies={lanes:0,firstContext:B}}else Zh=Zh.next=B;return F}var ka=null,Ka=!1;function xu(B){B.updateQueue={baseState:B.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fp(B,F){B=B.updateQueue,F.updateQueue===B&&(F.updateQueue={baseState:B.baseState,firstBaseUpdate:B.firstBaseUpdate,lastBaseUpdate:B.lastBaseUpdate,shared:B.shared,effects:B.effects})}function ca(B,F){return{eventTime:B,lane:F,tag:0,payload:null,callback:null,next:null}}function Yu(B,F){var K=B.updateQueue;K!==null&&(K=K.shared,eo!==null&&B.mode&1&&!(mi&2)?(B=K.interleaved,B===null?(F.next=F,ka===null?ka=[K]:ka.push(K)):(F.next=B.next,B.next=F),K.interleaved=F):(B=K.pending,B===null?F.next=F:(F.next=B.next,B.next=F),K.pending=F))}function Np(B,F,K){if(F=F.updateQueue,F!==null&&(F=F.shared,(K&4194240)!==0)){var oe=F.lanes;oe&=B.pendingLanes,K|=oe,F.lanes=K,Op(B,K)}}function Oa(B,F){var K=B.updateQueue,oe=B.alternate;if(oe!==null&&(oe=oe.updateQueue,K===oe)){var ge=null,Me=null;if(K=K.firstBaseUpdate,K!==null){do{var pt={eventTime:K.eventTime,lane:K.lane,tag:K.tag,payload:K.payload,callback:K.callback,next:null};Me===null?ge=Me=pt:Me=Me.next=pt,K=K.next}while(K!==null);Me===null?ge=Me=F:Me=Me.next=F}else ge=Me=F;K={baseState:oe.baseState,firstBaseUpdate:ge,lastBaseUpdate:Me,shared:oe.shared,effects:oe.effects},B.updateQueue=K;return}B=K.lastBaseUpdate,B===null?K.firstBaseUpdate=F:B.next=F,K.lastBaseUpdate=F}function yg(B,F,K,oe){var ge=B.updateQueue;Ka=!1;var Me=ge.firstBaseUpdate,pt=ge.lastBaseUpdate,Nt=ge.shared.pending;if(Nt!==null){ge.shared.pending=null;var _n=Nt,$n=_n.next;_n.next=null,pt===null?Me=$n:pt.next=$n,pt=_n;var wr=B.alternate;wr!==null&&(wr=wr.updateQueue,Nt=wr.lastBaseUpdate,Nt!==pt&&(Nt===null?wr.firstBaseUpdate=$n:Nt.next=$n,wr.lastBaseUpdate=_n))}if(Me!==null){var ci=ge.baseState;pt=0,wr=$n=_n=null,Nt=Me;do{var Gr=Nt.lane,vs=Nt.eventTime;if((oe&Gr)===Gr){wr!==null&&(wr=wr.next={eventTime:vs,lane:0,tag:Nt.tag,payload:Nt.payload,callback:Nt.callback,next:null});e:{var Pr=B,po=Nt;switch(Gr=F,vs=K,po.tag){case 1:if(Pr=po.payload,typeof Pr=="function"){ci=Pr.call(vs,ci,Gr);break e}ci=Pr;break e;case 3:Pr.flags=Pr.flags&-65537|128;case 0:if(Pr=po.payload,Gr=typeof Pr=="function"?Pr.call(vs,ci,Gr):Pr,Gr==null)break e;ci=o({},ci,Gr);break e;case 2:Ka=!0}}Nt.callback!==null&&Nt.lane!==0&&(B.flags|=64,Gr=ge.effects,Gr===null?ge.effects=[Nt]:Gr.push(Nt))}else vs={eventTime:vs,lane:Gr,tag:Nt.tag,payload:Nt.payload,callback:Nt.callback,next:null},wr===null?($n=wr=vs,_n=ci):wr=wr.next=vs,pt|=Gr;if(Nt=Nt.next,Nt===null){if(Nt=ge.shared.pending,Nt===null)break;Gr=Nt,Nt=Gr.next,Gr.next=null,ge.lastBaseUpdate=Gr,ge.shared.pending=null}}while(!0);if(wr===null&&(_n=ci),ge.baseState=_n,ge.firstBaseUpdate=$n,ge.lastBaseUpdate=wr,F=ge.shared.interleaved,F!==null){ge=F;do pt|=ge.lane,ge=ge.next;while(ge!==F)}else Me===null&&(ge.shared.lanes=0);gd|=pt,B.lanes=pt,B.memoizedState=ci}}function zp(B,F,K){if(B=F.effects,F.effects=null,B!==null)for(F=0;F<B.length;F++){var oe=B[F],ge=oe.callback;if(ge!==null){if(oe.callback=null,oe=K,typeof ge!="function")throw Error(l(191,ge));ge.call(oe)}}}var Y0=new r.Component().refs;function Zu(B,F,K,oe){F=B.memoizedState,K=K(oe,F),K=K==null?F:o({},F,K),B.memoizedState=K,B.lanes===0&&(B.updateQueue.baseState=K)}var bu={isMounted:function(B){return(B=B._reactInternals)?se(B)===B:!1},enqueueSetState:function(B,F,K){B=B._reactInternals;var oe=to(),ge=pc(B),Me=ca(oe,ge);Me.payload=F,K!=null&&(Me.callback=K),Yu(B,Me),F=nl(B,ge,oe),F!==null&&Np(F,B,ge)},enqueueReplaceState:function(B,F,K){B=B._reactInternals;var oe=to(),ge=pc(B),Me=ca(oe,ge);Me.tag=1,Me.payload=F,K!=null&&(Me.callback=K),Yu(B,Me),F=nl(B,ge,oe),F!==null&&Np(F,B,ge)},enqueueForceUpdate:function(B,F){B=B._reactInternals;var K=to(),oe=pc(B),ge=ca(K,oe);ge.tag=2,F!=null&&(ge.callback=F),Yu(B,ge),F=nl(B,oe,K),F!==null&&Np(F,B,oe)}};function Hx(B,F,K,oe,ge,Me,pt){return B=B.stateNode,typeof B.shouldComponentUpdate=="function"?B.shouldComponentUpdate(oe,Me,pt):F.prototype&&F.prototype.isPureReactComponent?!hl(K,oe)||!hl(ge,Me):!0}function wf(B,F,K){var oe=!1,ge=Qi,Me=F.contextType;return typeof Me=="object"&&Me!==null?Me=Js(Me):(ge=ms(F)?Yo:Zr.current,oe=F.contextTypes,Me=(oe=oe!=null)?ks(B,ge):Qi),F=new F(K,Me),B.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,F.updater=bu,B.stateNode=F,F._reactInternals=B,oe&&(B=B.stateNode,B.__reactInternalMemoizedUnmaskedChildContext=ge,B.__reactInternalMemoizedMaskedChildContext=Me),F}function Ku(B,F,K,oe){B=F.state,typeof F.componentWillReceiveProps=="function"&&F.componentWillReceiveProps(K,oe),typeof F.UNSAFE_componentWillReceiveProps=="function"&&F.UNSAFE_componentWillReceiveProps(K,oe),F.state!==B&&bu.enqueueReplaceState(F,F.state,null)}function Z0(B,F,K,oe){var ge=B.stateNode;ge.props=K,ge.state=B.memoizedState,ge.refs=Y0,xu(B);var Me=F.contextType;typeof Me=="object"&&Me!==null?ge.context=Js(Me):(Me=ms(F)?Yo:Zr.current,ge.context=ks(B,Me)),ge.state=B.memoizedState,Me=F.getDerivedStateFromProps,typeof Me=="function"&&(Zu(B,F,Me,K),ge.state=B.memoizedState),typeof F.getDerivedStateFromProps=="function"||typeof ge.getSnapshotBeforeUpdate=="function"||typeof ge.UNSAFE_componentWillMount!="function"&&typeof ge.componentWillMount!="function"||(F=ge.state,typeof ge.componentWillMount=="function"&&ge.componentWillMount(),typeof ge.UNSAFE_componentWillMount=="function"&&ge.UNSAFE_componentWillMount(),F!==ge.state&&bu.enqueueReplaceState(ge,ge.state,null),yg(B,K,ge,oe),ge.state=B.memoizedState),typeof ge.componentDidMount=="function"&&(B.flags|=4194308)}var rc=[],Kh=0,Jh=null,ba=0,Cr=[],qn=0,wu=null,mr=1,ic="";function sc(B,F){rc[Kh++]=ba,rc[Kh++]=Jh,Jh=B,ba=F}function yr(B,F,K){Cr[qn++]=mr,Cr[qn++]=ic,Cr[qn++]=wu,wu=B;var oe=mr;B=ic;var ge=32-Da(oe)-1;oe&=~(1<<ge),K+=1;var Me=32-Da(F)+ge;if(30<Me){var pt=ge-ge%5;Me=(oe&(1<<pt)-1).toString(32),oe>>=pt,ge-=pt,mr=1<<32-Da(F)+ge|K<<ge|oe,ic=Me+B}else mr=1<<Me|K<<ge|oe,ic=B}function Up(B){B.return!==null&&(sc(B,1),yr(B,1,0))}function Sf(B){for(;B===Jh;)Jh=rc[--Kh],rc[Kh]=null,ba=rc[--Kh],rc[Kh]=null;for(;B===wu;)wu=Cr[--qn],Cr[qn]=null,ic=Cr[--qn],Cr[qn]=null,mr=Cr[--qn],Cr[qn]=null}var Fa=null,So=null,ss=!1,uo=!1,Ja=null;function Qh(B,F){var K=rl(5,null,null,0);K.elementType="DELETED",K.stateNode=F,K.return=B,F=B.deletions,F===null?(B.deletions=[K],B.flags|=16):F.push(K)}function ed(B,F){switch(B.tag){case 5:return F=Ie(F,B.type,B.pendingProps),F!==null?(B.stateNode=F,Fa=B,So=Lt(F),!0):!1;case 6:return F=qe(F,B.pendingProps),F!==null?(B.stateNode=F,Fa=B,So=null,!0):!1;case 13:if(F=it(F),F!==null){var K=wu!==null?{id:mr,overflow:ic}:null;return B.memoizedState={dehydrated:F,treeContext:K,retryLane:1073741824},K=rl(18,null,null,0),K.stateNode=F,K.return=B,B.child=K,Fa=B,So=null,!0}return!1;default:return!1}}function Af(B){return(B.mode&1)!==0&&(B.flags&128)===0}function oc(B){if(ss){var F=So;if(F){var K=F;if(!ed(B,F)){if(Af(B))throw Error(l(418));F=yt(K);var oe=Fa;F&&ed(B,F)?Qh(oe,K):(B.flags=B.flags&-4097|2,ss=!1,Fa=B)}}else{if(Af(B))throw Error(l(418));B.flags=B.flags&-4097|2,ss=!1,Fa=B}}}function ws(B){for(B=B.return;B!==null&&B.tag!==5&&B.tag!==3&&B.tag!==13;)B=B.return;Fa=B}function td(B){if(!gn||B!==Fa)return!1;if(!ss)return ws(B),ss=!0,!1;if(B.tag!==3&&(B.tag!==5||Sn(B.type)&&!jt(B.type,B.memoizedProps))){var F=So;if(F){if(Af(B)){for(B=So;B;)B=yt(B);throw Error(l(418))}for(;F;)Qh(B,F),F=yt(F)}}if(ws(B),B.tag===13){if(!gn)throw Error(l(316));if(B=B.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(l(317));So=je(B)}else So=Fa?yt(B.stateNode):null;return!0}function xn(){gn&&(So=Fa=null,uo=ss=!1)}function xg(B){Ja===null?Ja=[B]:Ja.push(B)}function Gc(B,F,K){if(B=K.ref,B!==null&&typeof B!="function"&&typeof B!="object"){if(K._owner){if(K=K._owner,K){if(K.tag!==1)throw Error(l(309));var oe=K.stateNode}if(!oe)throw Error(l(147,B));var ge=oe,Me=""+B;return F!==null&&F.ref!==null&&typeof F.ref=="function"&&F.ref._stringRef===Me?F.ref:(F=function(pt){var Nt=ge.refs;Nt===Y0&&(Nt=ge.refs={}),pt===null?delete Nt[Me]:Nt[Me]=pt},F._stringRef=Me,F)}if(typeof B!="string")throw Error(l(284));if(!K._owner)throw Error(l(290,B))}return B}function nd(B,F){throw B=Object.prototype.toString.call(F),Error(l(31,B==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":B))}function Gp(B){var F=B._init;return F(B._payload)}function Vp(B){function F(Xt,Ut){if(B){var an=Xt.deletions;an===null?(Xt.deletions=[Ut],Xt.flags|=16):an.push(Ut)}}function K(Xt,Ut){if(!B)return null;for(;Ut!==null;)F(Xt,Ut),Ut=Ut.sibling;return null}function oe(Xt,Ut){for(Xt=new Map;Ut!==null;)Ut.key!==null?Xt.set(Ut.key,Ut):Xt.set(Ut.index,Ut),Ut=Ut.sibling;return Xt}function ge(Xt,Ut){return Xt=Iu(Xt,Ut),Xt.index=0,Xt.sibling=null,Xt}function Me(Xt,Ut,an){return Xt.index=an,B?(an=Xt.alternate,an!==null?(an=an.index,an<Ut?(Xt.flags|=2,Ut):an):(Xt.flags|=2,Ut)):(Xt.flags|=1048576,Ut)}function pt(Xt){return B&&Xt.alternate===null&&(Xt.flags|=2),Xt}function Nt(Xt,Ut,an,ir){return Ut===null||Ut.tag!==6?(Ut=fm(an,Xt.mode,ir),Ut.return=Xt,Ut):(Ut=ge(Ut,an),Ut.return=Xt,Ut)}function _n(Xt,Ut,an,ir){var Rr=an.type;return Rr===f?wr(Xt,Ut,an.props.children,ir,an.key):Ut!==null&&(Ut.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===O&&Gp(Rr)===Ut.type)?(ir=ge(Ut,an.props),ir.ref=Gc(Xt,Ut,an),ir.return=Xt,ir):(ir=hm(an.type,an.key,an.props,null,Xt.mode,ir),ir.ref=Gc(Xt,Ut,an),ir.return=Xt,ir)}function $n(Xt,Ut,an,ir){return Ut===null||Ut.tag!==4||Ut.stateNode.containerInfo!==an.containerInfo||Ut.stateNode.implementation!==an.implementation?(Ut=x_(an,Xt.mode,ir),Ut.return=Xt,Ut):(Ut=ge(Ut,an.children||[]),Ut.return=Xt,Ut)}function wr(Xt,Ut,an,ir,Rr){return Ut===null||Ut.tag!==7?(Ut=lh(an,Xt.mode,ir,Rr),Ut.return=Xt,Ut):(Ut=ge(Ut,an),Ut.return=Xt,Ut)}function ci(Xt,Ut,an){if(typeof Ut=="string"&&Ut!==""||typeof Ut=="number")return Ut=fm(""+Ut,Xt.mode,an),Ut.return=Xt,Ut;if(typeof Ut=="object"&&Ut!==null){switch(Ut.$$typeof){case a:return an=hm(Ut.type,Ut.key,Ut.props,null,Xt.mode,an),an.ref=Gc(Xt,null,Ut),an.return=Xt,an;case d:return Ut=x_(Ut,Xt.mode,an),Ut.return=Xt,Ut;case O:var ir=Ut._init;return ci(Xt,ir(Ut._payload),an)}if(ze(Ut)||Z(Ut))return Ut=lh(Ut,Xt.mode,an,null),Ut.return=Xt,Ut;nd(Xt,Ut)}return null}function Gr(Xt,Ut,an,ir){var Rr=Ut!==null?Ut.key:null;if(typeof an=="string"&&an!==""||typeof an=="number")return Rr!==null?null:Nt(Xt,Ut,""+an,ir);if(typeof an=="object"&&an!==null){switch(an.$$typeof){case a:return an.key===Rr?_n(Xt,Ut,an,ir):null;case d:return an.key===Rr?$n(Xt,Ut,an,ir):null;case O:return Rr=an._init,Gr(Xt,Ut,Rr(an._payload),ir)}if(ze(an)||Z(an))return Rr!==null?null:wr(Xt,Ut,an,ir,null);nd(Xt,an)}return null}function vs(Xt,Ut,an,ir,Rr){if(typeof ir=="string"&&ir!==""||typeof ir=="number")return Xt=Xt.get(an)||null,Nt(Ut,Xt,""+ir,Rr);if(typeof ir=="object"&&ir!==null){switch(ir.$$typeof){case a:return Xt=Xt.get(ir.key===null?an:ir.key)||null,_n(Ut,Xt,ir,Rr);case d:return Xt=Xt.get(ir.key===null?an:ir.key)||null,$n(Ut,Xt,ir,Rr);case O:var xi=ir._init;return vs(Xt,Ut,an,xi(ir._payload),Rr)}if(ze(ir)||Z(ir))return Xt=Xt.get(an)||null,wr(Ut,Xt,ir,Rr,null);nd(Ut,ir)}return null}function Pr(Xt,Ut,an,ir){for(var Rr=null,xi=null,ui=Ut,Vi=Ut=0,w=null;ui!==null&&Vi<an.length;Vi++){ui.index>Vi?(w=ui,ui=null):w=ui.sibling;var h=Gr(Xt,ui,an[Vi],ir);if(h===null){ui===null&&(ui=w);break}B&&ui&&h.alternate===null&&F(Xt,ui),Ut=Me(h,Ut,Vi),xi===null?Rr=h:xi.sibling=h,xi=h,ui=w}if(Vi===an.length)return K(Xt,ui),ss&&sc(Xt,Vi),Rr;if(ui===null){for(;Vi<an.length;Vi++)ui=ci(Xt,an[Vi],ir),ui!==null&&(Ut=Me(ui,Ut,Vi),xi===null?Rr=ui:xi.sibling=ui,xi=ui);return ss&&sc(Xt,Vi),Rr}for(ui=oe(Xt,ui);Vi<an.length;Vi++)w=vs(ui,Xt,Vi,an[Vi],ir),w!==null&&(B&&w.alternate!==null&&ui.delete(w.key===null?Vi:w.key),Ut=Me(w,Ut,Vi),xi===null?Rr=w:xi.sibling=w,xi=w);return B&&ui.forEach(function(g){return F(Xt,g)}),ss&&sc(Xt,Vi),Rr}function po(Xt,Ut,an,ir){var Rr=Z(an);if(typeof Rr!="function")throw Error(l(150));if(an=Rr.call(an),an==null)throw Error(l(151));for(var xi=Rr=null,ui=Ut,Vi=Ut=0,w=null,h=an.next();ui!==null&&!h.done;Vi++,h=an.next()){ui.index>Vi?(w=ui,ui=null):w=ui.sibling;var g=Gr(Xt,ui,h.value,ir);if(g===null){ui===null&&(ui=w);break}B&&ui&&g.alternate===null&&F(Xt,ui),Ut=Me(g,Ut,Vi),xi===null?Rr=g:xi.sibling=g,xi=g,ui=w}if(h.done)return K(Xt,ui),ss&&sc(Xt,Vi),Rr;if(ui===null){for(;!h.done;Vi++,h=an.next())h=ci(Xt,h.value,ir),h!==null&&(Ut=Me(h,Ut,Vi),xi===null?Rr=h:xi.sibling=h,xi=h);return ss&&sc(Xt,Vi),Rr}for(ui=oe(Xt,ui);!h.done;Vi++,h=an.next())h=vs(ui,Xt,Vi,h.value,ir),h!==null&&(B&&h.alternate!==null&&ui.delete(h.key===null?Vi:h.key),Ut=Me(h,Ut,Vi),xi===null?Rr=h:xi.sibling=h,xi=h);return B&&ui.forEach(function(S){return F(Xt,S)}),ss&&sc(Xt,Vi),Rr}function mo(Xt,Ut,an,ir){if(typeof an=="object"&&an!==null&&an.type===f&&an.key===null&&(an=an.props.children),typeof an=="object"&&an!==null){switch(an.$$typeof){case a:e:{for(var Rr=an.key,xi=Ut;xi!==null;){if(xi.key===Rr){if(Rr=an.type,Rr===f){if(xi.tag===7){K(Xt,xi.sibling),Ut=ge(xi,an.props.children),Ut.return=Xt,Xt=Ut;break e}}else if(xi.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===O&&Gp(Rr)===xi.type){K(Xt,xi.sibling),Ut=ge(xi,an.props),Ut.ref=Gc(Xt,xi,an),Ut.return=Xt,Xt=Ut;break e}K(Xt,xi);break}else F(Xt,xi);xi=xi.sibling}an.type===f?(Ut=lh(an.props.children,Xt.mode,ir,an.key),Ut.return=Xt,Xt=Ut):(ir=hm(an.type,an.key,an.props,null,Xt.mode,ir),ir.ref=Gc(Xt,Ut,an),ir.return=Xt,Xt=ir)}return pt(Xt);case d:e:{for(xi=an.key;Ut!==null;){if(Ut.key===xi)if(Ut.tag===4&&Ut.stateNode.containerInfo===an.containerInfo&&Ut.stateNode.implementation===an.implementation){K(Xt,Ut.sibling),Ut=ge(Ut,an.children||[]),Ut.return=Xt,Xt=Ut;break e}else{K(Xt,Ut);break}else F(Xt,Ut);Ut=Ut.sibling}Ut=x_(an,Xt.mode,ir),Ut.return=Xt,Xt=Ut}return pt(Xt);case O:return xi=an._init,mo(Xt,Ut,xi(an._payload),ir)}if(ze(an))return Pr(Xt,Ut,an,ir);if(Z(an))return po(Xt,Ut,an,ir);nd(Xt,an)}return typeof an=="string"&&an!==""||typeof an=="number"?(an=""+an,Ut!==null&&Ut.tag===6?(K(Xt,Ut.sibling),Ut=ge(Ut,an),Ut.return=Xt,Xt=Ut):(K(Xt,Ut),Ut=fm(an,Xt.mode,ir),Ut.return=Xt,Xt=Ut),pt(Xt)):K(Xt,Ut)}return mo}var Qa=Vp(!0),bg=Vp(!1),ua={},Na=Ms(ua),Vc=Ms(ua),rd=Ms(ua);function ac(B){if(B===ua)throw Error(l(174));return B}function za(B,F){er(rd,F),er(Vc,B),er(Na,ua),B=rt(F),Ir(Na),er(Na,B)}function id(){Ir(Na),Ir(Vc),Ir(rd)}function wg(B){var F=ac(rd.current),K=ac(Na.current);F=ye(K,B.type,F),K!==F&&(er(Vc,B),er(Na,F))}function Hp(B){Vc.current===B&&(Ir(Na),Ir(Vc))}var Is=Ms(0);function jp(B){for(var F=B;F!==null;){if(F.tag===13){var K=F.memoizedState;if(K!==null&&(K=K.dehydrated,K===null||Qe(K)||mt(K)))return F}else if(F.tag===19&&F.memoizedProps.revealOrder!==void 0){if(F.flags&128)return F}else if(F.child!==null){F.child.return=F,F=F.child;continue}if(F===B)break;for(;F.sibling===null;){if(F.return===null||F.return===B)return null;F=F.return}F.sibling.return=F.return,F=F.sibling}return null}var Sg=[];function Ag(){for(var B=0;B<Sg.length;B++){var F=Sg[B];Mn?F._workInProgressVersionPrimary=null:F._workInProgressVersionSecondary=null}Sg.length=0}var Wp=c.ReactCurrentDispatcher,el=c.ReactCurrentBatchConfig,sd=0,Ps=null,Oo=null,Qs=null,Su=!1,Au=!1,Ju=0,Qu=0;function Ws(){throw Error(l(321))}function Qr(B,F){if(F===null)return!1;for(var K=0;K<F.length&&K<B.length;K++)if(!ul(B[K],F[K]))return!1;return!0}function eh(B,F,K,oe,ge,Me){if(sd=Me,Ps=F,F.memoizedState=null,F.updateQueue=null,F.lanes=0,Wp.current=B===null||B.memoizedState===null?s_:Zp,B=K(oe,ge),Au){Me=0;do{if(Au=!1,Ju=0,25<=Me)throw Error(l(301));Me+=1,Qs=Oo=null,F.updateQueue=null,Wp.current=kg,B=K(oe,ge)}while(Au)}if(Wp.current=ld,F=Oo!==null&&Oo.next!==null,sd=0,Qs=Oo=Ps=null,Su=!1,F)throw Error(l(300));return B}function od(){var B=Ju!==0;return Ju=0,B}function Rl(){var B={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qs===null?Ps.memoizedState=Qs=B:Qs=Qs.next=B,Qs}function fl(){if(Oo===null){var B=Ps.alternate;B=B!==null?B.memoizedState:null}else B=Oo.next;var F=Qs===null?Ps.memoizedState:Qs.next;if(F!==null)Qs=F,Oo=B;else{if(B===null)throw Error(l(310));Oo=B,B={memoizedState:Oo.memoizedState,baseState:Oo.baseState,baseQueue:Oo.baseQueue,queue:Oo.queue,next:null},Qs===null?Ps.memoizedState=Qs=B:Qs=Qs.next=B}return Qs}function lc(B,F){return typeof F=="function"?F(B):F}function Ai(B){var F=fl(),K=F.queue;if(K===null)throw Error(l(311));K.lastRenderedReducer=B;var oe=Oo,ge=oe.baseQueue,Me=K.pending;if(Me!==null){if(ge!==null){var pt=ge.next;ge.next=Me.next,Me.next=pt}oe.baseQueue=ge=Me,K.pending=null}if(ge!==null){Me=ge.next,oe=oe.baseState;var Nt=pt=null,_n=null,$n=Me;do{var wr=$n.lane;if((sd&wr)===wr)_n!==null&&(_n=_n.next={lane:0,action:$n.action,hasEagerState:$n.hasEagerState,eagerState:$n.eagerState,next:null}),oe=$n.hasEagerState?$n.eagerState:B(oe,$n.action);else{var ci={lane:wr,action:$n.action,hasEagerState:$n.hasEagerState,eagerState:$n.eagerState,next:null};_n===null?(Nt=_n=ci,pt=oe):_n=_n.next=ci,Ps.lanes|=wr,gd|=wr}$n=$n.next}while($n!==null&&$n!==Me);_n===null?pt=oe:_n.next=Nt,ul(oe,F.memoizedState)||(Ao=!0),F.memoizedState=oe,F.baseState=pt,F.baseQueue=_n,K.lastRenderedState=oe}if(B=K.interleaved,B!==null){ge=B;do Me=ge.lane,Ps.lanes|=Me,gd|=Me,ge=ge.next;while(ge!==B)}else ge===null&&(K.lanes=0);return[F.memoizedState,K.dispatch]}function Tf(B){var F=fl(),K=F.queue;if(K===null)throw Error(l(311));K.lastRenderedReducer=B;var oe=K.dispatch,ge=K.pending,Me=F.memoizedState;if(ge!==null){K.pending=null;var pt=ge=ge.next;do Me=B(Me,pt.action),pt=pt.next;while(pt!==ge);ul(Me,F.memoizedState)||(Ao=!0),F.memoizedState=Me,F.baseQueue===null&&(F.baseState=Me),K.lastRenderedState=Me}return[Me,oe]}function K0(){}function Tg(B,F){var K=Ps,oe=fl(),ge=F(),Me=!ul(oe.memoizedState,ge);if(Me&&(oe.memoizedState=ge,Ao=!0),oe=oe.queue,ad(J0.bind(null,K,oe,B),[B]),oe.getSnapshot!==F||Me||Qs!==null&&Qs.memoizedState.tag&1){if(K.flags|=2048,Hc(9,Mf.bind(null,K,oe,ge,F),void 0,null),eo===null)throw Error(l(349));sd&30||$p(K,F,ge)}return ge}function $p(B,F,K){B.flags|=16384,B={getSnapshot:F,value:K},F=Ps.updateQueue,F===null?(F={lastEffect:null,stores:null},Ps.updateQueue=F,F.stores=[B]):(K=F.stores,K===null?F.stores=[B]:K.push(B))}function Mf(B,F,K,oe){F.value=K,F.getSnapshot=oe,Q0(F)&&nl(B,1,-1)}function J0(B,F,K){return K(function(){Q0(F)&&nl(B,1,-1)})}function Q0(B){var F=B.getSnapshot;B=B.value;try{var K=F();return!ul(B,K)}catch{return!0}}function Mg(B){var F=Rl();return typeof B=="function"&&(B=B()),F.memoizedState=F.baseState=B,B={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lc,lastRenderedState:B},F.queue=B,B=B.dispatch=i_.bind(null,Ps,B),[F.memoizedState,B]}function Hc(B,F,K,oe){return B={tag:B,create:F,destroy:K,deps:oe,next:null},F=Ps.updateQueue,F===null?(F={lastEffect:null,stores:null},Ps.updateQueue=F,F.lastEffect=B.next=B):(K=F.lastEffect,K===null?F.lastEffect=B.next=B:(oe=K.next,K.next=B,B.next=oe,F.lastEffect=B)),B}function e_(){return fl().memoizedState}function Cg(B,F,K,oe){var ge=Rl();Ps.flags|=B,ge.memoizedState=Hc(1|F,K,void 0,oe===void 0?null:oe)}function Eg(B,F,K,oe){var ge=fl();oe=oe===void 0?null:oe;var Me=void 0;if(Oo!==null){var pt=Oo.memoizedState;if(Me=pt.destroy,oe!==null&&Qr(oe,pt.deps)){ge.memoizedState=Hc(F,K,Me,oe);return}}Ps.flags|=B,ge.memoizedState=Hc(1|F,K,Me,oe)}function t_(B,F){return Cg(8390656,8,B,F)}function ad(B,F){return Eg(2048,8,B,F)}function Ig(B,F){return Eg(4,2,B,F)}function Pg(B,F){return Eg(4,4,B,F)}function Rg(B,F){if(typeof F=="function")return B=B(),F(B),function(){F(null)};if(F!=null)return B=B(),F.current=B,function(){F.current=null}}function n_(B,F,K){return K=K!=null?K.concat([B]):null,Eg(4,4,Rg.bind(null,F,B),K)}function Lg(){}function jx(B,F){var K=fl();F=F===void 0?null:F;var oe=K.memoizedState;return oe!==null&&F!==null&&Qr(F,oe[1])?oe[0]:(K.memoizedState=[B,F],B)}function Cf(B,F){var K=fl();F=F===void 0?null:F;var oe=K.memoizedState;return oe!==null&&F!==null&&Qr(F,oe[1])?oe[0]:(B=B(),K.memoizedState=[B,F],B)}function Xp(B,F){var K=_r;_r=K!==0&&4>K?K:4,B(!0);var oe=el.transition;el.transition={};try{B(!1),F()}finally{_r=K,el.transition=oe}}function r_(){return fl().memoizedState}function pl(B,F,K){var oe=pc(B);K={lane:oe,action:K,hasEagerState:!1,eagerState:null,next:null},qp(B)?Yp(F,K):(Dg(B,F,K),K=to(),B=nl(B,oe,K),B!==null&&Bg(B,F,oe))}function i_(B,F,K){var oe=pc(B),ge={lane:oe,action:K,hasEagerState:!1,eagerState:null,next:null};if(qp(B))Yp(F,ge);else{Dg(B,F,ge);var Me=B.alternate;if(B.lanes===0&&(Me===null||Me.lanes===0)&&(Me=F.lastRenderedReducer,Me!==null))try{var pt=F.lastRenderedState,Nt=Me(pt,K);if(ge.hasEagerState=!0,ge.eagerState=Nt,ul(Nt,pt))return}catch{}finally{}K=to(),B=nl(B,oe,K),B!==null&&Bg(B,F,oe)}}function qp(B){var F=B.alternate;return B===Ps||F!==null&&F===Ps}function Yp(B,F){Au=Su=!0;var K=B.pending;K===null?F.next=F:(F.next=K.next,K.next=F),B.pending=F}function Dg(B,F,K){eo!==null&&B.mode&1&&!(mi&2)?(B=F.interleaved,B===null?(K.next=K,ka===null?ka=[F]:ka.push(F)):(K.next=B.next,B.next=K),F.interleaved=K):(B=F.pending,B===null?K.next=K:(K.next=B.next,B.next=K),F.pending=K)}function Bg(B,F,K){if(K&4194240){var oe=F.lanes;oe&=B.pendingLanes,K|=oe,F.lanes=K,Op(B,K)}}var ld={readContext:Js,useCallback:Ws,useContext:Ws,useEffect:Ws,useImperativeHandle:Ws,useInsertionEffect:Ws,useLayoutEffect:Ws,useMemo:Ws,useReducer:Ws,useRef:Ws,useState:Ws,useDebugValue:Ws,useDeferredValue:Ws,useTransition:Ws,useMutableSource:Ws,useSyncExternalStore:Ws,useId:Ws,unstable_isNewReconciler:!1},s_={readContext:Js,useCallback:function(B,F){return Rl().memoizedState=[B,F===void 0?null:F],B},useContext:Js,useEffect:t_,useImperativeHandle:function(B,F,K){return K=K!=null?K.concat([B]):null,Cg(4194308,4,Rg.bind(null,F,B),K)},useLayoutEffect:function(B,F){return Cg(4194308,4,B,F)},useInsertionEffect:function(B,F){return Cg(4,2,B,F)},useMemo:function(B,F){var K=Rl();return F=F===void 0?null:F,B=B(),K.memoizedState=[B,F],B},useReducer:function(B,F,K){var oe=Rl();return F=K!==void 0?K(F):F,oe.memoizedState=oe.baseState=F,B={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:B,lastRenderedState:F},oe.queue=B,B=B.dispatch=pl.bind(null,Ps,B),[oe.memoizedState,B]},useRef:function(B){var F=Rl();return B={current:B},F.memoizedState=B},useState:Mg,useDebugValue:Lg,useDeferredValue:function(B){var F=Mg(B),K=F[0],oe=F[1];return t_(function(){var ge=el.transition;el.transition={};try{oe(B)}finally{el.transition=ge}},[B]),K},useTransition:function(){var B=Mg(!1),F=B[0];return B=Xp.bind(null,B[1]),Rl().memoizedState=B,[F,B]},useMutableSource:function(){},useSyncExternalStore:function(B,F,K){var oe=Ps,ge=Rl();if(ss){if(K===void 0)throw Error(l(407));K=K()}else{if(K=F(),eo===null)throw Error(l(349));sd&30||$p(oe,F,K)}ge.memoizedState=K;var Me={value:K,getSnapshot:F};return ge.queue=Me,t_(J0.bind(null,oe,Me,B),[B]),oe.flags|=2048,Hc(9,Mf.bind(null,oe,Me,K,F),void 0,null),K},useId:function(){var B=Rl(),F=eo.identifierPrefix;if(ss){var K=ic,oe=mr;K=(oe&~(1<<32-Da(oe)-1)).toString(32)+K,F=":"+F+"R"+K,K=Ju++,0<K&&(F+="H"+K.toString(32)),F+=":"}else K=Qu++,F=":"+F+"r"+K.toString(32)+":";return B.memoizedState=F},unstable_isNewReconciler:!1},Zp={readContext:Js,useCallback:jx,useContext:Js,useEffect:ad,useImperativeHandle:n_,useInsertionEffect:Ig,useLayoutEffect:Pg,useMemo:Cf,useReducer:Ai,useRef:e_,useState:function(){return Ai(lc)},useDebugValue:Lg,useDeferredValue:function(B){var F=Ai(lc),K=F[0],oe=F[1];return ad(function(){var ge=el.transition;el.transition={};try{oe(B)}finally{el.transition=ge}},[B]),K},useTransition:function(){var B=Ai(lc)[0],F=fl().memoizedState;return[B,F]},useMutableSource:K0,useSyncExternalStore:Tg,useId:r_,unstable_isNewReconciler:!1},kg={readContext:Js,useCallback:jx,useContext:Js,useEffect:ad,useImperativeHandle:n_,useInsertionEffect:Ig,useLayoutEffect:Pg,useMemo:Cf,useReducer:Tf,useRef:e_,useState:function(){return Tf(lc)},useDebugValue:Lg,useDeferredValue:function(B){var F=Tf(lc),K=F[0],oe=F[1];return ad(function(){var ge=el.transition;el.transition={};try{oe(B)}finally{el.transition=ge}},[B]),K},useTransition:function(){var B=Tf(lc)[0],F=fl().memoizedState;return[B,F]},useMutableSource:K0,useSyncExternalStore:Tg,useId:r_,unstable_isNewReconciler:!1};function Kp(B,F){try{var K="",oe=F;do K+=_g(oe),oe=oe.return;while(oe);var ge=K}catch(Me){ge=`
Error generating stack: `+Me.message+`
`+Me.stack}return{value:B,source:F,stack:ge}}function Og(B,F){try{console.error(F.value)}catch(K){setTimeout(function(){throw K})}}var Ef=typeof WeakMap=="function"?WeakMap:Map;function Wx(B,F,K){K=ca(-1,K),K.tag=3,K.payload={element:null};var oe=F.value;return K.callback=function(){tl||(tl=!0,g_=oe),Og(B,F)},K}function o_(B,F,K){K=ca(-1,K),K.tag=3;var oe=B.type.getDerivedStateFromError;if(typeof oe=="function"){var ge=F.value;K.payload=function(){return oe(ge)},K.callback=function(){Og(B,F)}}var Me=B.stateNode;return Me!==null&&typeof Me.componentDidCatch=="function"&&(K.callback=function(){Og(B,F),typeof oe!="function"&&($s===null?$s=new Set([this]):$s.add(this));var pt=F.stack;this.componentDidCatch(F.value,{componentStack:pt!==null?pt:""})}),K}function a_(B,F,K){var oe=B.pingCache;if(oe===null){oe=B.pingCache=new Ef;var ge=new Set;oe.set(F,ge)}else ge=oe.get(F),ge===void 0&&(ge=new Set,oe.set(F,ge));ge.has(K)||(ge.add(K),B=Jg.bind(null,B,F,K),F.then(B,B))}function cd(B){do{var F;if((F=B.tag===13)&&(F=B.memoizedState,F=F!==null?F.dehydrated!==null:!0),F)return B;B=B.return}while(B!==null);return null}function l_(B,F,K,oe,ge){return B.mode&1?(B.flags|=65536,B.lanes=ge,B):(B===F?B.flags|=65536:(B.flags|=128,K.flags|=131072,K.flags&=-52805,K.tag===1&&(K.alternate===null?K.tag=17:(F=ca(-1,1),F.tag=2,Yu(K,F))),K.lanes|=1),B)}function cc(B){B.flags|=4}function Fg(B,F){if(B!==null&&B.child===F.child)return!0;if(F.flags&16)return!1;for(B=F.child;B!==null;){if(B.flags&12854||B.subtreeFlags&12854)return!1;B=B.sibling}return!0}var Tu,th,Mu,Jp;if(De)Tu=function(B,F){for(var K=F.child;K!==null;){if(K.tag===5||K.tag===6)vt(B,K.stateNode);else if(K.tag!==4&&K.child!==null){K.child.return=K,K=K.child;continue}if(K===F)break;for(;K.sibling===null;){if(K.return===null||K.return===F)return;K=K.return}K.sibling.return=K.return,K=K.sibling}},th=function(){},Mu=function(B,F,K,oe,ge){if(B=B.memoizedProps,B!==oe){var Me=F.stateNode,pt=ac(Na.current);K=lt(Me,K,B,oe,ge,pt),(F.updateQueue=K)&&cc(F)}},Jp=function(B,F,K,oe){K!==oe&&cc(F)};else if(Ye){Tu=function(B,F,K,oe){for(var ge=F.child;ge!==null;){if(ge.tag===5){var Me=ge.stateNode;K&&oe&&(Me=Mt(Me,ge.type,ge.memoizedProps,ge)),vt(B,Me)}else if(ge.tag===6)Me=ge.stateNode,K&&oe&&(Me=we(Me,ge.memoizedProps,ge)),vt(B,Me);else if(ge.tag!==4){if(ge.tag===22&&ge.memoizedState!==null)Me=ge.child,Me!==null&&(Me.return=ge),Tu(B,ge,!0,!0);else if(ge.child!==null){ge.child.return=ge,ge=ge.child;continue}}if(ge===F)break;for(;ge.sibling===null;){if(ge.return===null||ge.return===F)return;ge=ge.return}ge.sibling.return=ge.return,ge=ge.sibling}};var Ng=function(B,F,K,oe){for(var ge=F.child;ge!==null;){if(ge.tag===5){var Me=ge.stateNode;K&&oe&&(Me=Mt(Me,ge.type,ge.memoizedProps,ge)),ps(B,Me)}else if(ge.tag===6)Me=ge.stateNode,K&&oe&&(Me=we(Me,ge.memoizedProps,ge)),ps(B,Me);else if(ge.tag!==4){if(ge.tag===22&&ge.memoizedState!==null)Me=ge.child,Me!==null&&(Me.return=ge),Ng(B,ge,!0,!0);else if(ge.child!==null){ge.child.return=ge,ge=ge.child;continue}}if(ge===F)break;for(;ge.sibling===null;){if(ge.return===null||ge.return===F)return;ge=ge.return}ge.sibling.return=ge.return,ge=ge.sibling}};th=function(B,F){var K=F.stateNode;if(!Fg(B,F)){B=K.containerInfo;var oe=jr(B);Ng(oe,F,!1,!1),K.pendingChildren=oe,cc(F),Bs(B,oe)}},Mu=function(B,F,K,oe,ge){var Me=B.stateNode,pt=B.memoizedProps;if((B=Fg(B,F))&&pt===oe)F.stateNode=Me;else{var Nt=F.stateNode,_n=ac(Na.current),$n=null;pt!==oe&&($n=lt(Nt,K,pt,oe,ge,_n)),B&&$n===null?F.stateNode=Me:(Me=Tr(Me,$n,K,pt,oe,F,B,Nt),Dt(Me,K,oe,ge,_n)&&cc(F),F.stateNode=Me,B?cc(F):Tu(Me,F,!1,!1))}},Jp=function(B,F,K,oe){K!==oe?(B=ac(rd.current),K=ac(Na.current),F.stateNode=Qt(oe,B,K,F),cc(F)):F.stateNode=B.stateNode}}else th=function(){},Mu=function(){},Jp=function(){};function ud(B,F){if(!ss)switch(B.tailMode){case"hidden":F=B.tail;for(var K=null;F!==null;)F.alternate!==null&&(K=F),F=F.sibling;K===null?B.tail=null:K.sibling=null;break;case"collapsed":K=B.tail;for(var oe=null;K!==null;)K.alternate!==null&&(oe=K),K=K.sibling;oe===null?F||B.tail===null?B.tail=null:B.tail.sibling=null:oe.sibling=null}}function Jo(B){var F=B.alternate!==null&&B.alternate.child===B.child,K=0,oe=0;if(F)for(var ge=B.child;ge!==null;)K|=ge.lanes|ge.childLanes,oe|=ge.subtreeFlags&14680064,oe|=ge.flags&14680064,ge.return=B,ge=ge.sibling;else for(ge=B.child;ge!==null;)K|=ge.lanes|ge.childLanes,oe|=ge.subtreeFlags,oe|=ge.flags,ge.return=B,ge=ge.sibling;return B.subtreeFlags|=oe,B.childLanes=K,F}function hd(B,F,K){var oe=F.pendingProps;switch(Sf(F),F.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jo(F),null;case 1:return ms(F.type)&&ki(),Jo(F),null;case 3:return oe=F.stateNode,id(),Ir(bs),Ir(Zr),Ag(),oe.pendingContext&&(oe.context=oe.pendingContext,oe.pendingContext=null),(B===null||B.child===null)&&(td(F)?cc(F):B===null||B.memoizedState.isDehydrated&&!(F.flags&256)||(F.flags|=1024,Ja!==null&&(zf(Ja),Ja=null))),th(B,F),Jo(F),null;case 5:Hp(F),K=ac(rd.current);var ge=F.type;if(B!==null&&F.stateNode!=null)Mu(B,F,ge,oe,K),B.ref!==F.ref&&(F.flags|=512,F.flags|=2097152);else{if(!oe){if(F.stateNode===null)throw Error(l(166));return Jo(F),null}if(B=ac(Na.current),td(F)){if(!gn)throw Error(l(175));B=cn(F.stateNode,F.type,F.memoizedProps,K,B,F,!uo),F.updateQueue=B,B!==null&&cc(F)}else{var Me=gt(ge,oe,K,B,F);Tu(Me,F,!1,!1),F.stateNode=Me,Dt(Me,ge,oe,K,B)&&cc(F)}F.ref!==null&&(F.flags|=512,F.flags|=2097152)}return Jo(F),null;case 6:if(B&&F.stateNode!=null)Jp(B,F,B.memoizedProps,oe);else{if(typeof oe!="string"&&F.stateNode===null)throw Error(l(166));if(B=ac(rd.current),K=ac(Na.current),td(F)){if(!gn)throw Error(l(176));if(B=F.stateNode,oe=F.memoizedProps,(K=Cn(B,oe,F,!uo))&&(ge=Fa,ge!==null))switch(Me=(ge.mode&1)!==0,ge.tag){case 3:yn(ge.stateNode.containerInfo,B,oe,Me);break;case 5:Un(ge.type,ge.memoizedProps,ge.stateNode,B,oe,Me)}K&&cc(F)}else F.stateNode=Qt(oe,B,K,F)}return Jo(F),null;case 13:if(Ir(Is),oe=F.memoizedState,ss&&So!==null&&F.mode&1&&!(F.flags&128)){for(B=So;B;)B=yt(B);return xn(),F.flags|=98560,F}if(oe!==null&&oe.dehydrated!==null){if(oe=td(F),B===null){if(!oe)throw Error(l(318));if(!gn)throw Error(l(344));if(B=F.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(l(317));En(B,F)}else xn(),!(F.flags&128)&&(F.memoizedState=null),F.flags|=4;return Jo(F),null}return Ja!==null&&(zf(Ja),Ja=null),F.flags&128?(F.lanes=K,F):(oe=oe!==null,K=!1,B===null?td(F):K=B.memoizedState!==null,oe&&!K&&(F.child.flags|=8192,F.mode&1&&(B===null||Is.current&1?zo===0&&(zo=3):To())),F.updateQueue!==null&&(F.flags|=4),Jo(F),null);case 4:return id(),th(B,F),B===null&&At(F.stateNode.containerInfo),Jo(F),null;case 10:return dl(F.type._context),Jo(F),null;case 17:return ms(F.type)&&ki(),Jo(F),null;case 19:if(Ir(Is),ge=F.memoizedState,ge===null)return Jo(F),null;if(oe=(F.flags&128)!==0,Me=ge.rendering,Me===null)if(oe)ud(ge,!1);else{if(zo!==0||B!==null&&B.flags&128)for(B=F.child;B!==null;){if(Me=jp(B),Me!==null){for(F.flags|=128,ud(ge,!1),B=Me.updateQueue,B!==null&&(F.updateQueue=B,F.flags|=4),F.subtreeFlags=0,B=K,oe=F.child;oe!==null;)K=oe,ge=B,K.flags&=14680066,Me=K.alternate,Me===null?(K.childLanes=0,K.lanes=ge,K.child=null,K.subtreeFlags=0,K.memoizedProps=null,K.memoizedState=null,K.updateQueue=null,K.dependencies=null,K.stateNode=null):(K.childLanes=Me.childLanes,K.lanes=Me.lanes,K.child=Me.child,K.subtreeFlags=0,K.deletions=null,K.memoizedProps=Me.memoizedProps,K.memoizedState=Me.memoizedState,K.updateQueue=Me.updateQueue,K.type=Me.type,ge=Me.dependencies,K.dependencies=ge===null?null:{lanes:ge.lanes,firstContext:ge.firstContext}),oe=oe.sibling;return er(Is,Is.current&1|2),F.child}B=B.sibling}ge.tail!==null&&Ss()>oh&&(F.flags|=128,oe=!0,ud(ge,!1),F.lanes=4194304)}else{if(!oe)if(B=jp(Me),B!==null){if(F.flags|=128,oe=!0,B=B.updateQueue,B!==null&&(F.updateQueue=B,F.flags|=4),ud(ge,!0),ge.tail===null&&ge.tailMode==="hidden"&&!Me.alternate&&!ss)return Jo(F),null}else 2*Ss()-ge.renderingStartTime>oh&&K!==1073741824&&(F.flags|=128,oe=!0,ud(ge,!1),F.lanes=4194304);ge.isBackwards?(Me.sibling=F.child,F.child=Me):(B=ge.last,B!==null?B.sibling=Me:F.child=Me,ge.last=Me)}return ge.tail!==null?(F=ge.tail,ge.rendering=F,ge.tail=F.sibling,ge.renderingStartTime=Ss(),F.sibling=null,B=Is.current,er(Is,oe?B&1|2:B&1),F):(Jo(F),null);case 22:case 23:return ah(),oe=F.memoizedState!==null,B!==null&&B.memoizedState!==null!==oe&&(F.flags|=8192),oe&&F.mode&1?No&1073741824&&(Jo(F),De&&F.subtreeFlags&6&&(F.flags|=8192)):Jo(F),null;case 24:return null;case 25:return null}throw Error(l(156,F.tag))}var $x=c.ReactCurrentOwner,Ao=!1;function ha(B,F,K,oe){F.child=B===null?bg(F,null,K,oe):Qa(F,B.child,K,oe)}function Qp(B,F,K,oe,ge){K=K.render;var Me=F.ref;return qu(F,ge),oe=eh(B,F,K,oe,Me,ge),K=od(),B!==null&&!Ao?(F.updateQueue=B.updateQueue,F.flags&=-2053,B.lanes&=~ge,Ll(B,F,ge)):(ss&&K&&Up(F),F.flags|=1,ha(B,F,oe,ge),F.child)}function zg(B,F,K,oe,ge){if(B===null){var Me=K.type;return typeof Me=="function"&&!tv(Me)&&Me.defaultProps===void 0&&K.compare===null&&K.defaultProps===void 0?(F.tag=15,F.type=Me,c_(B,F,Me,oe,ge)):(B=hm(K.type,null,oe,F,F.mode,ge),B.ref=F.ref,B.return=F,F.child=B)}if(Me=B.child,!(B.lanes&ge)){var pt=Me.memoizedProps;if(K=K.compare,K=K!==null?K:hl,K(pt,oe)&&B.ref===F.ref)return Ll(B,F,ge)}return F.flags|=1,B=Iu(Me,oe),B.ref=F.ref,B.return=F,F.child=B}function c_(B,F,K,oe,ge){if(B!==null&&hl(B.memoizedProps,oe)&&B.ref===F.ref)if(Ao=!1,(B.lanes&ge)!==0)B.flags&131072&&(Ao=!0);else return F.lanes=B.lanes,Ll(B,F,ge);return Gg(B,F,K,oe,ge)}function Ug(B,F,K){var oe=F.pendingProps,ge=oe.children,Me=B!==null?B.memoizedState:null;if(oe.mode==="hidden")if(!(F.mode&1))F.memoizedState={baseLanes:0,cachePool:null},er(dc,No),No|=K;else if(K&1073741824)F.memoizedState={baseLanes:0,cachePool:null},oe=Me!==null?Me.baseLanes:K,er(dc,No),No|=oe;else return B=Me!==null?Me.baseLanes|K:K,F.lanes=F.childLanes=1073741824,F.memoizedState={baseLanes:B,cachePool:null},F.updateQueue=null,er(dc,No),No|=B,null;else Me!==null?(oe=Me.baseLanes|K,F.memoizedState=null):oe=K,er(dc,No),No|=oe;return ha(B,F,ge,K),F.child}function em(B,F){var K=F.ref;(B===null&&K!==null||B!==null&&B.ref!==K)&&(F.flags|=512,F.flags|=2097152)}function Gg(B,F,K,oe,ge){var Me=ms(K)?Yo:Zr.current;return Me=ks(F,Me),qu(F,ge),K=eh(B,F,K,oe,Me,ge),oe=od(),B!==null&&!Ao?(F.updateQueue=B.updateQueue,F.flags&=-2053,B.lanes&=~ge,Ll(B,F,ge)):(ss&&oe&&Up(F),F.flags|=1,ha(B,F,K,ge),F.child)}function u_(B,F,K,oe,ge){if(ms(K)){var Me=!0;Cs(F)}else Me=!1;if(qu(F,ge),F.stateNode===null)B!==null&&(B.alternate=null,F.alternate=null,F.flags|=2),wf(F,K,oe),Z0(F,K,oe,ge),oe=!0;else if(B===null){var pt=F.stateNode,Nt=F.memoizedProps;pt.props=Nt;var _n=pt.context,$n=K.contextType;typeof $n=="object"&&$n!==null?$n=Js($n):($n=ms(K)?Yo:Zr.current,$n=ks(F,$n));var wr=K.getDerivedStateFromProps,ci=typeof wr=="function"||typeof pt.getSnapshotBeforeUpdate=="function";ci||typeof pt.UNSAFE_componentWillReceiveProps!="function"&&typeof pt.componentWillReceiveProps!="function"||(Nt!==oe||_n!==$n)&&Ku(F,pt,oe,$n),Ka=!1;var Gr=F.memoizedState;pt.state=Gr,yg(F,oe,pt,ge),_n=F.memoizedState,Nt!==oe||Gr!==_n||bs.current||Ka?(typeof wr=="function"&&(Zu(F,K,wr,oe),_n=F.memoizedState),(Nt=Ka||Hx(F,K,Nt,oe,Gr,_n,$n))?(ci||typeof pt.UNSAFE_componentWillMount!="function"&&typeof pt.componentWillMount!="function"||(typeof pt.componentWillMount=="function"&&pt.componentWillMount(),typeof pt.UNSAFE_componentWillMount=="function"&&pt.UNSAFE_componentWillMount()),typeof pt.componentDidMount=="function"&&(F.flags|=4194308)):(typeof pt.componentDidMount=="function"&&(F.flags|=4194308),F.memoizedProps=oe,F.memoizedState=_n),pt.props=oe,pt.state=_n,pt.context=$n,oe=Nt):(typeof pt.componentDidMount=="function"&&(F.flags|=4194308),oe=!1)}else{pt=F.stateNode,Fp(B,F),Nt=F.memoizedProps,$n=F.type===F.elementType?Nt:js(F.type,Nt),pt.props=$n,ci=F.pendingProps,Gr=pt.context,_n=K.contextType,typeof _n=="object"&&_n!==null?_n=Js(_n):(_n=ms(K)?Yo:Zr.current,_n=ks(F,_n));var vs=K.getDerivedStateFromProps;(wr=typeof vs=="function"||typeof pt.getSnapshotBeforeUpdate=="function")||typeof pt.UNSAFE_componentWillReceiveProps!="function"&&typeof pt.componentWillReceiveProps!="function"||(Nt!==ci||Gr!==_n)&&Ku(F,pt,oe,_n),Ka=!1,Gr=F.memoizedState,pt.state=Gr,yg(F,oe,pt,ge);var Pr=F.memoizedState;Nt!==ci||Gr!==Pr||bs.current||Ka?(typeof vs=="function"&&(Zu(F,K,vs,oe),Pr=F.memoizedState),($n=Ka||Hx(F,K,$n,oe,Gr,Pr,_n)||!1)?(wr||typeof pt.UNSAFE_componentWillUpdate!="function"&&typeof pt.componentWillUpdate!="function"||(typeof pt.componentWillUpdate=="function"&&pt.componentWillUpdate(oe,Pr,_n),typeof pt.UNSAFE_componentWillUpdate=="function"&&pt.UNSAFE_componentWillUpdate(oe,Pr,_n)),typeof pt.componentDidUpdate=="function"&&(F.flags|=4),typeof pt.getSnapshotBeforeUpdate=="function"&&(F.flags|=1024)):(typeof pt.componentDidUpdate!="function"||Nt===B.memoizedProps&&Gr===B.memoizedState||(F.flags|=4),typeof pt.getSnapshotBeforeUpdate!="function"||Nt===B.memoizedProps&&Gr===B.memoizedState||(F.flags|=1024),F.memoizedProps=oe,F.memoizedState=Pr),pt.props=oe,pt.state=Pr,pt.context=_n,oe=$n):(typeof pt.componentDidUpdate!="function"||Nt===B.memoizedProps&&Gr===B.memoizedState||(F.flags|=4),typeof pt.getSnapshotBeforeUpdate!="function"||Nt===B.memoizedProps&&Gr===B.memoizedState||(F.flags|=1024),oe=!1)}return dd(B,F,K,oe,Me,ge)}function dd(B,F,K,oe,ge,Me){em(B,F);var pt=(F.flags&128)!==0;if(!oe&&!pt)return ge&&Nc(F,K,!1),Ll(B,F,Me);oe=F.stateNode,$x.current=F;var Nt=pt&&typeof K.getDerivedStateFromError!="function"?null:oe.render();return F.flags|=1,B!==null&&pt?(F.child=Qa(F,B.child,null,Me),F.child=Qa(F,null,Nt,Me)):ha(B,F,Nt,Me),F.memoizedState=oe.state,ge&&Nc(F,K,!0),F.child}function Xx(B){var F=B.stateNode;F.pendingContext?co(B,F.pendingContext,F.pendingContext!==F.context):F.context&&co(B,F.context,!1),za(B,F.containerInfo)}function h_(B,F,K,oe,ge){return xn(),xg(ge),F.flags|=256,ha(B,F,K,oe),F.child}var tm={dehydrated:null,treeContext:null,retryLane:0};function Vg(B){return{baseLanes:B,cachePool:null}}function nm(B,F,K){var oe=F.pendingProps,ge=Is.current,Me=!1,pt=(F.flags&128)!==0,Nt;if((Nt=pt)||(Nt=B!==null&&B.memoizedState===null?!1:(ge&2)!==0),Nt?(Me=!0,F.flags&=-129):(B===null||B.memoizedState!==null)&&(ge|=1),er(Is,ge&1),B===null)return oc(F),B=F.memoizedState,B!==null&&(B=B.dehydrated,B!==null)?(F.mode&1?mt(B)?F.lanes=8:F.lanes=1073741824:F.lanes=1,null):(ge=oe.children,B=oe.fallback,Me?(oe=F.mode,Me=F.child,ge={mode:"hidden",children:ge},!(oe&1)&&Me!==null?(Me.childLanes=0,Me.pendingProps=ge):Me=dm(ge,oe,0,null),B=lh(B,oe,K,null),Me.return=F,B.return=F,Me.sibling=B,F.child=Me,F.child.memoizedState=Vg(K),F.memoizedState=tm,B):If(F,ge));if(ge=B.memoizedState,ge!==null){if(Nt=ge.dehydrated,Nt!==null){if(pt)return F.flags&256?(F.flags&=-257,ml(B,F,K,Error(l(422)))):F.memoizedState!==null?(F.child=B.child,F.flags|=128,null):(Me=oe.fallback,ge=F.mode,oe=dm({mode:"visible",children:oe.children},ge,0,null),Me=lh(Me,ge,K,null),Me.flags|=2,oe.return=F,Me.return=F,oe.sibling=Me,F.child=oe,F.mode&1&&Qa(F,B.child,null,K),F.child.memoizedState=Vg(K),F.memoizedState=tm,Me);if(!(F.mode&1))F=ml(B,F,K,null);else if(mt(Nt))F=ml(B,F,K,Error(l(419)));else if(oe=(K&B.childLanes)!==0,Ao||oe){if(oe=eo,oe!==null){switch(K&-K){case 4:Me=2;break;case 16:Me=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Me=32;break;case 536870912:Me=268435456;break;default:Me=0}oe=Me&(oe.suspendedLanes|K)?0:Me,oe!==0&&oe!==ge.retryLane&&(ge.retryLane=oe,nl(B,oe,-1))}To(),F=ml(B,F,K,Error(l(421)))}else Qe(Nt)?(F.flags|=128,F.child=B.child,F=Jx.bind(null,B),Rt(Nt,F),F=null):(K=ge.treeContext,gn&&(So=Ot(Nt),Fa=F,ss=!0,Ja=null,uo=!1,K!==null&&(Cr[qn++]=mr,Cr[qn++]=ic,Cr[qn++]=wu,mr=K.id,ic=K.overflow,wu=F)),F=If(F,F.pendingProps.children),F.flags|=4096);return F}return Me?(oe=Hg(B,F,oe.children,oe.fallback,K),Me=F.child,ge=B.child.memoizedState,Me.memoizedState=ge===null?Vg(K):{baseLanes:ge.baseLanes|K,cachePool:null},Me.childLanes=B.childLanes&~K,F.memoizedState=tm,oe):(K=Pf(B,F,oe.children,K),F.memoizedState=null,K)}return Me?(oe=Hg(B,F,oe.children,oe.fallback,K),Me=F.child,ge=B.child.memoizedState,Me.memoizedState=ge===null?Vg(K):{baseLanes:ge.baseLanes|K,cachePool:null},Me.childLanes=B.childLanes&~K,F.memoizedState=tm,oe):(K=Pf(B,F,oe.children,K),F.memoizedState=null,K)}function If(B,F){return F=dm({mode:"visible",children:F},B.mode,0,null),F.return=B,B.child=F}function Pf(B,F,K,oe){var ge=B.child;return B=ge.sibling,K=Iu(ge,{mode:"visible",children:K}),!(F.mode&1)&&(K.lanes=oe),K.return=F,K.sibling=null,B!==null&&(oe=F.deletions,oe===null?(F.deletions=[B],F.flags|=16):oe.push(B)),F.child=K}function Hg(B,F,K,oe,ge){var Me=F.mode;B=B.child;var pt=B.sibling,Nt={mode:"hidden",children:K};return!(Me&1)&&F.child!==B?(K=F.child,K.childLanes=0,K.pendingProps=Nt,F.deletions=null):(K=Iu(B,Nt),K.subtreeFlags=B.subtreeFlags&14680064),pt!==null?oe=Iu(pt,oe):(oe=lh(oe,Me,ge,null),oe.flags|=2),oe.return=F,K.return=F,K.sibling=oe,F.child=K,oe}function ml(B,F,K,oe){return oe!==null&&xg(oe),Qa(F,B.child,null,K),B=If(F,F.pendingProps.children),B.flags|=2,F.memoizedState=null,B}function d_(B,F,K){B.lanes|=F;var oe=B.alternate;oe!==null&&(oe.lanes|=F),Ks(B.return,F,K)}function Rf(B,F,K,oe,ge){var Me=B.memoizedState;Me===null?B.memoizedState={isBackwards:F,rendering:null,renderingStartTime:0,last:oe,tail:K,tailMode:ge}:(Me.isBackwards=F,Me.rendering=null,Me.renderingStartTime=0,Me.last=oe,Me.tail=K,Me.tailMode=ge)}function rm(B,F,K){var oe=F.pendingProps,ge=oe.revealOrder,Me=oe.tail;if(ha(B,F,oe.children,K),oe=Is.current,oe&2)oe=oe&1|2,F.flags|=128;else{if(B!==null&&B.flags&128)e:for(B=F.child;B!==null;){if(B.tag===13)B.memoizedState!==null&&d_(B,K,F);else if(B.tag===19)d_(B,K,F);else if(B.child!==null){B.child.return=B,B=B.child;continue}if(B===F)break e;for(;B.sibling===null;){if(B.return===null||B.return===F)break e;B=B.return}B.sibling.return=B.return,B=B.sibling}oe&=1}if(er(Is,oe),!(F.mode&1))F.memoizedState=null;else switch(ge){case"forwards":for(K=F.child,ge=null;K!==null;)B=K.alternate,B!==null&&jp(B)===null&&(ge=K),K=K.sibling;K=ge,K===null?(ge=F.child,F.child=null):(ge=K.sibling,K.sibling=null),Rf(F,!1,ge,K,Me);break;case"backwards":for(K=null,ge=F.child,F.child=null;ge!==null;){if(B=ge.alternate,B!==null&&jp(B)===null){F.child=ge;break}B=ge.sibling,ge.sibling=K,K=ge,ge=B}Rf(F,!0,K,null,Me);break;case"together":Rf(F,!1,null,null,void 0);break;default:F.memoizedState=null}return F.child}function Ll(B,F,K){if(B!==null&&(F.dependencies=B.dependencies),gd|=F.lanes,!(K&F.childLanes))return null;if(B!==null&&F.child!==B.child)throw Error(l(153));if(F.child!==null){for(B=F.child,K=Iu(B,B.pendingProps),F.child=K,K.return=F;B.sibling!==null;)B=B.sibling,K=K.sibling=Iu(B,B.pendingProps),K.return=F;K.sibling=null}return F.child}function f_(B,F,K){switch(F.tag){case 3:Xx(F),xn();break;case 5:wg(F);break;case 1:ms(F.type)&&Cs(F);break;case 4:za(F,F.stateNode.containerInfo);break;case 10:xa(F,F.type._context,F.memoizedProps.value);break;case 13:var oe=F.memoizedState;if(oe!==null)return oe.dehydrated!==null?(er(Is,Is.current&1),F.flags|=128,null):K&F.child.childLanes?nm(B,F,K):(er(Is,Is.current&1),B=Ll(B,F,K),B!==null?B.sibling:null);er(Is,Is.current&1);break;case 19:if(oe=(K&F.childLanes)!==0,B.flags&128){if(oe)return rm(B,F,K);F.flags|=128}var ge=F.memoizedState;if(ge!==null&&(ge.rendering=null,ge.tail=null,ge.lastEffect=null),er(Is,Is.current),oe)break;return null;case 22:case 23:return F.lanes=0,Ug(B,F,K)}return Ll(B,F,K)}function qx(B,F){switch(Sf(F),F.tag){case 1:return ms(F.type)&&ki(),B=F.flags,B&65536?(F.flags=B&-65537|128,F):null;case 3:return id(),Ir(bs),Ir(Zr),Ag(),B=F.flags,B&65536&&!(B&128)?(F.flags=B&-65537|128,F):null;case 5:return Hp(F),null;case 13:if(Ir(Is),B=F.memoizedState,B!==null&&B.dehydrated!==null){if(F.alternate===null)throw Error(l(340));xn()}return B=F.flags,B&65536?(F.flags=B&-65537|128,F):null;case 19:return Ir(Is),null;case 4:return id(),null;case 10:return dl(F.type._context),null;case 22:case 23:return ah(),null;case 24:return null;default:return null}}var jc=!1,Dl=!1,Nn=typeof WeakSet=="function"?WeakSet:Set,or=null;function im(B,F){var K=B.ref;if(K!==null)if(typeof K=="function")try{K(null)}catch(oe){da(B,F,oe)}else K.current=null}function wa(B,F,K){try{K()}catch(oe){da(B,F,oe)}}var nh=!1;function Kn(B,F){for(We(B.containerInfo),or=F;or!==null;)if(B=or,F=B.child,(B.subtreeFlags&1028)!==0&&F!==null)F.return=B,or=F;else for(;or!==null;){B=or;try{var K=B.alternate;if(B.flags&1024)switch(B.tag){case 0:case 11:case 15:break;case 1:if(K!==null){var oe=K.memoizedProps,ge=K.memoizedState,Me=B.stateNode,pt=Me.getSnapshotBeforeUpdate(B.elementType===B.type?oe:js(B.type,oe),ge);Me.__reactInternalSnapshotBeforeUpdate=pt}break;case 3:De&&In(B.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(Nt){da(B,B.return,Nt)}if(F=B.sibling,F!==null){F.return=B.return,or=F;break}or=B.return}return K=nh,nh=!1,K}function Wc(B,F,K){var oe=F.updateQueue;if(oe=oe!==null?oe.lastEffect:null,oe!==null){var ge=oe=oe.next;do{if((ge.tag&B)===B){var Me=ge.destroy;ge.destroy=void 0,Me!==void 0&&wa(F,K,Me)}ge=ge.next}while(ge!==oe)}}function sm(B,F){if(F=F.updateQueue,F=F!==null?F.lastEffect:null,F!==null){var K=F=F.next;do{if((K.tag&B)===B){var oe=K.create;K.destroy=oe()}K=K.next}while(K!==F)}}function Lf(B){var F=B.ref;if(F!==null){var K=B.stateNode;switch(B.tag){case 5:B=Re(K);break;default:B=K}typeof F=="function"?F(B):F.current=B}}function om(B,F,K){if(Hs&&typeof Hs.onCommitFiberUnmount=="function")try{Hs.onCommitFiberUnmount(Kr,F)}catch{}switch(F.tag){case 0:case 11:case 14:case 15:if(B=F.updateQueue,B!==null&&(B=B.lastEffect,B!==null)){var oe=B=B.next;do{var ge=oe,Me=ge.destroy;ge=ge.tag,Me!==void 0&&(ge&2||ge&4)&&wa(F,K,Me),oe=oe.next}while(oe!==B)}break;case 1:if(im(F,K),B=F.stateNode,typeof B.componentWillUnmount=="function")try{B.props=F.memoizedProps,B.state=F.memoizedState,B.componentWillUnmount()}catch(pt){da(F,K,pt)}break;case 5:im(F,K);break;case 4:De?pd(B,F,K):Ye&&Ye&&(F=F.stateNode.containerInfo,K=jr(F),fi(F,K))}}function Df(B,F,K){for(var oe=F;;)if(om(B,oe,K),oe.child===null||De&&oe.tag===4){if(oe===F)break;for(;oe.sibling===null;){if(oe.return===null||oe.return===F)return;oe=oe.return}oe.sibling.return=oe.return,oe=oe.sibling}else oe.child.return=oe,oe=oe.child}function jg(B){var F=B.alternate;F!==null&&(B.alternate=null,jg(F)),B.child=null,B.deletions=null,B.sibling=null,B.tag===5&&(F=B.stateNode,F!==null&&On(F)),B.stateNode=null,B.return=null,B.dependencies=null,B.memoizedProps=null,B.memoizedState=null,B.pendingProps=null,B.stateNode=null,B.updateQueue=null}function Yx(B){return B.tag===5||B.tag===3||B.tag===4}function Zx(B){e:for(;;){for(;B.sibling===null;){if(B.return===null||Yx(B.return))return null;B=B.return}for(B.sibling.return=B.return,B=B.sibling;B.tag!==5&&B.tag!==6&&B.tag!==18;){if(B.flags&2||B.child===null||B.tag===4)continue e;B.child.return=B,B=B.child}if(!(B.flags&2))return B.stateNode}}function Bf(B){if(De){e:{for(var F=B.return;F!==null;){if(Yx(F))break e;F=F.return}throw Error(l(160))}var K=F;switch(K.tag){case 5:F=K.stateNode,K.flags&32&&(Si(F),K.flags&=-33),K=Zx(B),kf(B,K,F);break;case 3:case 4:F=K.stateNode.containerInfo,K=Zx(B),fd(B,K,F);break;default:throw Error(l(161))}}}function fd(B,F,K){var oe=B.tag;if(oe===5||oe===6)B=B.stateNode,F?ar(K,B,F):Ar(K,B);else if(oe!==4&&(B=B.child,B!==null))for(fd(B,F,K),B=B.sibling;B!==null;)fd(B,F,K),B=B.sibling}function kf(B,F,K){var oe=B.tag;if(oe===5||oe===6)B=B.stateNode,F?zr(K,B,F):nr(K,B);else if(oe!==4&&(B=B.child,B!==null))for(kf(B,F,K),B=B.sibling;B!==null;)kf(B,F,K),B=B.sibling}function pd(B,F,K){for(var oe=F,ge=!1,Me,pt;;){if(!ge){ge=oe.return;e:for(;;){if(ge===null)throw Error(l(160));switch(Me=ge.stateNode,ge.tag){case 5:pt=!1;break e;case 3:Me=Me.containerInfo,pt=!0;break e;case 4:Me=Me.containerInfo,pt=!0;break e}ge=ge.return}ge=!0}if(oe.tag===5||oe.tag===6)Df(B,oe,K),pt?Wr(Me,oe.stateNode):Ur(Me,oe.stateNode);else if(oe.tag===18)pt?Pt(Me,oe.stateNode):Et(Me,oe.stateNode);else if(oe.tag===4){if(oe.child!==null){Me=oe.stateNode.containerInfo,pt=!0,oe.child.return=oe,oe=oe.child;continue}}else if(om(B,oe,K),oe.child!==null){oe.child.return=oe,oe=oe.child;continue}if(oe===F)break;for(;oe.sibling===null;){if(oe.return===null||oe.return===F)return;oe=oe.return,oe.tag===4&&(ge=!1)}oe.sibling.return=oe.return,oe=oe.sibling}}function ho(B,F){if(De){switch(F.tag){case 0:case 11:case 14:case 15:Wc(3,F,F.return),sm(3,F),Wc(5,F,F.return);return;case 1:return;case 5:var K=F.stateNode;if(K!=null){var oe=F.memoizedProps;B=B!==null?B.memoizedProps:oe;var ge=F.type,Me=F.updateQueue;F.updateQueue=null,Me!==null&&di(K,Me,ge,B,oe,F)}return;case 6:if(F.stateNode===null)throw Error(l(162));K=F.memoizedProps,Dn(F.stateNode,B!==null?B.memoizedProps:K,K);return;case 3:gn&&B!==null&&B.memoizedState.isDehydrated&&bt(F.stateNode.containerInfo);return;case 12:return;case 13:uc(F);return;case 19:uc(F);return;case 17:return}throw Error(l(163))}switch(F.tag){case 0:case 11:case 14:case 15:Wc(3,F,F.return),sm(3,F),Wc(5,F,F.return);return;case 12:return;case 13:uc(F);return;case 19:uc(F);return;case 3:gn&&B!==null&&B.memoizedState.isDehydrated&&bt(F.stateNode.containerInfo);break;case 22:case 23:return}e:if(Ye){switch(F.tag){case 1:case 5:case 6:break e;case 3:case 4:F=F.stateNode,fi(F.containerInfo,F.pendingChildren);break e}throw Error(l(163))}}function uc(B){var F=B.updateQueue;if(F!==null){B.updateQueue=null;var K=B.stateNode;K===null&&(K=B.stateNode=new Nn),F.forEach(function(oe){var ge=Qg.bind(null,B,oe);K.has(oe)||(K.add(oe),oe.then(ge,ge))})}}function Kx(B,F){for(or=F;or!==null;){F=or;var K=F.deletions;if(K!==null)for(var oe=0;oe<K.length;oe++){var ge=K[oe];try{var Me=B;De?pd(Me,ge,F):Df(Me,ge,F);var pt=ge.alternate;pt!==null&&(pt.return=null),ge.return=null}catch(Rr){da(ge,F,Rr)}}if(K=F.child,F.subtreeFlags&12854&&K!==null)K.return=F,or=K;else for(;or!==null;){F=or;try{var Nt=F.flags;if(Nt&32&&De&&Si(F.stateNode),Nt&512){var _n=F.alternate;if(_n!==null){var $n=_n.ref;$n!==null&&(typeof $n=="function"?$n(null):$n.current=null)}}if(Nt&8192)switch(F.tag){case 13:if(F.memoizedState!==null){var wr=F.alternate;(wr===null||wr.memoizedState===null)&&(_d=Ss())}break;case 22:var ci=F.memoizedState!==null,Gr=F.alternate,vs=Gr!==null&&Gr.memoizedState!==null;if(K=F,De){e:if(oe=K,ge=ci,Me=null,De)for(var Pr=oe;;){if(Pr.tag===5){if(Me===null){Me=Pr;var po=Pr.stateNode;ge?Ne(po):Jt(Pr.stateNode,Pr.memoizedProps)}}else if(Pr.tag===6){if(Me===null){var mo=Pr.stateNode;ge?Bt(mo):hn(mo,Pr.memoizedProps)}}else if((Pr.tag!==22&&Pr.tag!==23||Pr.memoizedState===null||Pr===oe)&&Pr.child!==null){Pr.child.return=Pr,Pr=Pr.child;continue}if(Pr===oe)break;for(;Pr.sibling===null;){if(Pr.return===null||Pr.return===oe)break e;Me===Pr&&(Me=null),Pr=Pr.return}Me===Pr&&(Me=null),Pr.sibling.return=Pr.return,Pr=Pr.sibling}}if(ci&&!vs&&K.mode&1){or=K;for(var Xt=K.child;Xt!==null;){for(K=or=Xt;or!==null;){oe=or;var Ut=oe.child;switch(oe.tag){case 0:case 11:case 14:case 15:Wc(4,oe,oe.return);break;case 1:im(oe,oe.return);var an=oe.stateNode;if(typeof an.componentWillUnmount=="function"){var ir=oe.return;try{an.props=oe.memoizedProps,an.state=oe.memoizedState,an.componentWillUnmount()}catch(Rr){da(oe,ir,Rr)}}break;case 5:im(oe,oe.return);break;case 22:if(oe.memoizedState!==null){Xg(K);continue}}Ut!==null?(Ut.return=oe,or=Ut):Xg(K)}Xt=Xt.sibling}}}switch(Nt&4102){case 2:Bf(F),F.flags&=-3;break;case 6:Bf(F),F.flags&=-3,ho(F.alternate,F);break;case 4096:F.flags&=-4097;break;case 4100:F.flags&=-4097,ho(F.alternate,F);break;case 4:ho(F.alternate,F)}}catch(Rr){da(F,F.return,Rr)}if(K=F.sibling,K!==null){K.return=F.return,or=K;break}or=F.return}}}function p_(B,F,K){or=B,Wg(B)}function Wg(B,F,K){for(var oe=(B.mode&1)!==0;or!==null;){var ge=or,Me=ge.child;if(ge.tag===22&&oe){var pt=ge.memoizedState!==null||jc;if(!pt){var Nt=ge.alternate,_n=Nt!==null&&Nt.memoizedState!==null||Dl;Nt=jc;var $n=Dl;if(jc=pt,(Dl=_n)&&!$n)for(or=ge;or!==null;)pt=or,_n=pt.child,pt.tag===22&&pt.memoizedState!==null?Ua(ge):_n!==null?(_n.return=pt,or=_n):Ua(ge);for(;Me!==null;)or=Me,Wg(Me),Me=Me.sibling;or=ge,jc=Nt,Dl=$n}$g(B)}else ge.subtreeFlags&8772&&Me!==null?(Me.return=ge,or=Me):$g(B)}}function $g(B){for(;or!==null;){var F=or;if(F.flags&8772){var K=F.alternate;try{if(F.flags&8772)switch(F.tag){case 0:case 11:case 15:Dl||sm(5,F);break;case 1:var oe=F.stateNode;if(F.flags&4&&!Dl)if(K===null)oe.componentDidMount();else{var ge=F.elementType===F.type?K.memoizedProps:js(F.type,K.memoizedProps);oe.componentDidUpdate(ge,K.memoizedState,oe.__reactInternalSnapshotBeforeUpdate)}var Me=F.updateQueue;Me!==null&&zp(F,Me,oe);break;case 3:var pt=F.updateQueue;if(pt!==null){if(K=null,F.child!==null)switch(F.child.tag){case 5:K=Re(F.child.stateNode);break;case 1:K=F.child.stateNode}zp(F,pt,K)}break;case 5:var Nt=F.stateNode;K===null&&F.flags&4&&sr(Nt,F.type,F.memoizedProps,F);break;case 6:break;case 4:break;case 12:break;case 13:if(gn&&F.memoizedState===null){var _n=F.alternate;if(_n!==null){var $n=_n.memoizedState;if($n!==null){var wr=$n.dehydrated;wr!==null&&Ct(wr)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(l(163))}Dl||F.flags&512&&Lf(F)}catch(ci){da(F,F.return,ci)}}if(F===B){or=null;break}if(K=F.sibling,K!==null){K.return=F.return,or=K;break}or=F.return}}function Xg(B){for(;or!==null;){var F=or;if(F===B){or=null;break}var K=F.sibling;if(K!==null){K.return=F.return,or=K;break}or=F.return}}function Ua(B){for(;or!==null;){var F=or;try{switch(F.tag){case 0:case 11:case 15:var K=F.return;try{sm(4,F)}catch(_n){da(F,K,_n)}break;case 1:var oe=F.stateNode;if(typeof oe.componentDidMount=="function"){var ge=F.return;try{oe.componentDidMount()}catch(_n){da(F,ge,_n)}}var Me=F.return;try{Lf(F)}catch(_n){da(F,Me,_n)}break;case 5:var pt=F.return;try{Lf(F)}catch(_n){da(F,pt,_n)}}}catch(_n){da(F,F.return,_n)}if(F===B){or=null;break}var Nt=F.sibling;if(Nt!==null){Nt.return=F.return,or=Nt;break}or=F.return}}var gs=0,md=1,Of=2,am=3,lm=4;if(typeof Symbol=="function"&&Symbol.for){var Ff=Symbol.for;gs=Ff("selector.component"),md=Ff("selector.has_pseudo_class"),Of=Ff("selector.role"),am=Ff("selector.test_id"),lm=Ff("selector.text")}function m_(B){var F=un(B);if(F!=null){if(typeof F.memoizedProps["data-testname"]!="string")throw Error(l(364));return F}if(B=He(B),B===null)throw Error(l(362));return B.stateNode.current}function rh(B,F){switch(F.$$typeof){case gs:if(B.type===F.value)return!0;break;case md:e:{F=F.value,B=[B,0];for(var K=0;K<B.length;){var oe=B[K++],ge=B[K++],Me=F[ge];if(oe.tag!==5||!An(oe)){for(;Me!=null&&rh(oe,Me);)ge++,Me=F[ge];if(ge===F.length){F=!0;break e}else for(oe=oe.child;oe!==null;)B.push(oe,ge),oe=oe.sibling}}F=!1}return F;case Of:if(B.tag===5&&Wt(B.stateNode,F.value))return!0;break;case lm:if((B.tag===5||B.tag===6)&&(B=Tn(B),B!==null&&0<=B.indexOf(F.value)))return!0;break;case am:if(B.tag===5&&(B=B.memoizedProps["data-testname"],typeof B=="string"&&B.toLowerCase()===F.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function ih(B){switch(B.$$typeof){case gs:return"<"+(J(B.value)||"Unknown")+">";case md:return":has("+(ih(B)||"")+")";case Of:return'[role="'+B.value+'"]';case lm:return'"'+B.value+'"';case am:return'[data-testname="'+B.value+'"]';default:throw Error(l(365))}}function vn(B,F){var K=[];B=[B,0];for(var oe=0;oe<B.length;){var ge=B[oe++],Me=B[oe++],pt=F[Me];if(ge.tag!==5||!An(ge)){for(;pt!=null&&rh(ge,pt);)Me++,pt=F[Me];if(Me===F.length)K.push(ge);else for(ge=ge.child;ge!==null;)B.push(ge,Me),ge=ge.sibling}}return K}function Jn(B,F){if(!ct)throw Error(l(363));B=m_(B),B=vn(B,F),F=[],B=Array.from(B);for(var K=0;K<B.length;){var oe=B[K++];if(oe.tag===5)An(oe)||F.push(oe.stateNode);else for(oe=oe.child;oe!==null;)B.push(oe),oe=oe.sibling}return F}var hc=Math.ceil,qi=c.ReactCurrentDispatcher,Tt=c.ReactCurrentOwner,Fs=c.ReactCurrentBatchConfig,mi=0,eo=null,os=null,Fo=0,No=0,dc=Ms(0),zo=0,cm=null,gd=0,vd=0,Nf=0,sh=null,Qo=null,_d=0,oh=1/0;function yd(){oh=Ss()+500}var tl=!1,g_=null,$s=null,qg=!1,Bl=null,Ui=0,ti=0,Yg=null,fc=-1,xd=0;function to(){return mi&6?Ss():fc!==-1?fc:fc=Ss()}function pc(B){return B.mode&1?mi&2&&Fo!==0?Fo&-Fo:bf.transition!==null?(xd===0&&(B=Dp,Dp<<=1,!(Dp&4194240)&&(Dp=64),xd=B),xd):(B=_r,B!==0?B:en()):1}function nl(B,F,K){if(50<ti)throw ti=0,Yg=null,Error(l(185));var oe=kl(B,F);return oe===null?null:(qh(oe,F,K),(!(mi&2)||oe!==eo)&&(oe===eo&&(!(mi&2)&&(vd|=F),zo===4&&Xc(oe,Fo)),fo(oe,K),F===1&&mi===0&&!(B.mode&1)&&(yd(),yu&&Ba())),oe)}function kl(B,F){B.lanes|=F;var K=B.alternate;for(K!==null&&(K.lanes|=F),K=B,B=B.return;B!==null;)B.childLanes|=F,K=B.alternate,K!==null&&(K.childLanes|=F),K=B,B=B.return;return K.tag===3?K.stateNode:null}function fo(B,F){var K=B.callbackNode;vf(B,F);var oe=tc(B,B===eo?Fo:0);if(oe===0)K!==null&&_f(K),B.callbackNode=null,B.callbackPriority=0;else if(F=oe&-oe,B.callbackPriority!==F){if(K!=null&&_f(K),F===1)B.tag===0?Vx(Zg.bind(null,B)):Es(Zg.bind(null,B)),Vn?on(function(){mi===0&&Ba()}):ur(xf,Ba),K=null;else{switch(Gx(oe)){case 1:K=xf;break;case 4:K=nc;break;case 16:K=Fn;break;case 536870912:K=ni;break;default:K=Fn}K=ev(K,$c.bind(null,B))}B.callbackPriority=F,B.callbackNode=K}}function $c(B,F){if(fc=-1,xd=0,mi&6)throw Error(l(327));var K=B.callbackNode;if(gc()&&B.callbackNode!==K)return null;var oe=tc(B,B===eo?Fo:0);if(oe===0)return null;if(oe&30||oe&B.expiredLanes||F)F=Uf(B,oe);else{F=oe;var ge=mi;mi|=2;var Me=bd();(eo!==B||Fo!==F)&&(yd(),gl(B,F));do try{Gf();break}catch(Nt){Sa(B,Nt)}while(!0);Os(),qi.current=Me,mi=ge,os!==null?F=0:(eo=null,Fo=0,F=zo)}if(F!==0){if(F===2&&(ge=kp(B),ge!==0&&(oe=ge,F=Cu(B,ge))),F===1)throw K=cm,gl(B,0),Xc(B,oe),fo(B,Ss()),K;if(F===6)Xc(B,oe);else{if(ge=B.current.alternate,!(oe&30)&&!v_(ge)&&(F=Uf(B,oe),F===2&&(Me=kp(B),Me!==0&&(oe=Me,F=Cu(B,Me))),F===1))throw K=cm,gl(B,0),Xc(B,oe),fo(B,Ss()),K;switch(B.finishedWork=ge,B.finishedLanes=oe,F){case 0:case 1:throw Error(l(345));case 2:mc(B,Qo);break;case 3:if(Xc(B,oe),(oe&130023424)===oe&&(F=_d+500-Ss(),10<F)){if(tc(B,0)!==0)break;if(ge=B.suspendedLanes,(ge&oe)!==oe){to(),B.pingedLanes|=B.suspendedLanes&ge;break}B.timeoutHandle=nn(mc.bind(null,B,Qo),F);break}mc(B,Qo);break;case 4:if(Xc(B,oe),(oe&4194240)===oe)break;for(F=B.eventTimes,ge=-1;0<oe;){var pt=31-Da(oe);Me=1<<pt,pt=F[pt],pt>ge&&(ge=pt),oe&=~Me}if(oe=ge,oe=Ss()-oe,oe=(120>oe?120:480>oe?480:1080>oe?1080:1920>oe?1920:3e3>oe?3e3:4320>oe?4320:1960*hc(oe/1960))-oe,10<oe){B.timeoutHandle=nn(mc.bind(null,B,Qo),oe);break}mc(B,Qo);break;case 5:mc(B,Qo);break;default:throw Error(l(329))}}}return fo(B,Ss()),B.callbackNode===K?$c.bind(null,B):null}function Cu(B,F){var K=sh;return B.current.memoizedState.isDehydrated&&(gl(B,F).flags|=256),B=Uf(B,F),B!==2&&(F=Qo,Qo=K,F!==null&&zf(F)),B}function zf(B){Qo===null?Qo=B:Qo.push.apply(Qo,B)}function v_(B){for(var F=B;;){if(F.flags&16384){var K=F.updateQueue;if(K!==null&&(K=K.stores,K!==null))for(var oe=0;oe<K.length;oe++){var ge=K[oe],Me=ge.getSnapshot;ge=ge.value;try{if(!ul(Me(),ge))return!1}catch{return!1}}}if(K=F.child,F.subtreeFlags&16384&&K!==null)K.return=F,F=K;else{if(F===B)break;for(;F.sibling===null;){if(F.return===null||F.return===B)return!0;F=F.return}F.sibling.return=F.return,F=F.sibling}}return!0}function Xc(B,F){for(F&=~Nf,F&=~vd,B.suspendedLanes|=F,B.pingedLanes&=~F,B=B.expirationTimes;0<F;){var K=31-Da(F),oe=1<<K;B[K]=-1,F&=~oe}}function Zg(B){if(mi&6)throw Error(l(327));gc();var F=tc(B,0);if(!(F&1))return fo(B,Ss()),null;var K=Uf(B,F);if(B.tag!==0&&K===2){var oe=kp(B);oe!==0&&(F=oe,K=Cu(B,oe))}if(K===1)throw K=cm,gl(B,0),Xc(B,F),fo(B,Ss()),K;if(K===6)throw Error(l(345));return B.finishedWork=B.current.alternate,B.finishedLanes=F,mc(B,Qo),fo(B,Ss()),null}function Eu(B){Bl!==null&&Bl.tag===0&&!(mi&6)&&gc();var F=mi;mi|=1;var K=Fs.transition,oe=_r;try{if(Fs.transition=null,_r=1,B)return B()}finally{_r=oe,Fs.transition=K,mi=F,!(mi&6)&&Ba()}}function ah(){No=dc.current,Ir(dc)}function gl(B,F){B.finishedWork=null,B.finishedLanes=0;var K=B.timeoutHandle;if(K!==kn&&(B.timeoutHandle=kn,Wn(K)),os!==null)for(K=os.return;K!==null;){var oe=K;switch(Sf(oe),oe.tag){case 1:oe=oe.type.childContextTypes,oe!=null&&ki();break;case 3:id(),Ir(bs),Ir(Zr),Ag();break;case 5:Hp(oe);break;case 4:id();break;case 13:Ir(Is);break;case 19:Ir(Is);break;case 10:dl(oe.type._context);break;case 22:case 23:ah()}K=K.return}if(eo=B,os=B=Iu(B.current,null),Fo=No=F,zo=0,cm=null,Nf=vd=gd=0,Qo=sh=null,ka!==null){for(F=0;F<ka.length;F++)if(K=ka[F],oe=K.interleaved,oe!==null){K.interleaved=null;var ge=oe.next,Me=K.pending;if(Me!==null){var pt=Me.next;Me.next=ge,oe.next=pt}K.pending=oe}ka=null}return B}function Sa(B,F){do{var K=os;try{if(Os(),Wp.current=ld,Su){for(var oe=Ps.memoizedState;oe!==null;){var ge=oe.queue;ge!==null&&(ge.pending=null),oe=oe.next}Su=!1}if(sd=0,Qs=Oo=Ps=null,Au=!1,Ju=0,Tt.current=null,K===null||K.return===null){zo=1,cm=F,os=null;break}e:{var Me=B,pt=K.return,Nt=K,_n=F;if(F=Fo,Nt.flags|=32768,_n!==null&&typeof _n=="object"&&typeof _n.then=="function"){var $n=_n,wr=Nt,ci=wr.tag;if(!(wr.mode&1)&&(ci===0||ci===11||ci===15)){var Gr=wr.alternate;Gr?(wr.updateQueue=Gr.updateQueue,wr.memoizedState=Gr.memoizedState,wr.lanes=Gr.lanes):(wr.updateQueue=null,wr.memoizedState=null)}var vs=cd(pt);if(vs!==null){vs.flags&=-257,l_(vs,pt,Nt,Me,F),vs.mode&1&&a_(Me,$n,F),F=vs,_n=$n;var Pr=F.updateQueue;if(Pr===null){var po=new Set;po.add(_n),F.updateQueue=po}else Pr.add(_n);break e}else{if(!(F&1)){a_(Me,$n,F),To();break e}_n=Error(l(426))}}else if(ss&&Nt.mode&1){var mo=cd(pt);if(mo!==null){!(mo.flags&65536)&&(mo.flags|=256),l_(mo,pt,Nt,Me,F),xg(_n);break e}}Me=_n,zo!==4&&(zo=2),sh===null?sh=[Me]:sh.push(Me),_n=Kp(_n,Nt),Nt=pt;do{switch(Nt.tag){case 3:Nt.flags|=65536,F&=-F,Nt.lanes|=F;var Xt=Wx(Nt,_n,F);Oa(Nt,Xt);break e;case 1:Me=_n;var Ut=Nt.type,an=Nt.stateNode;if(!(Nt.flags&128)&&(typeof Ut.getDerivedStateFromError=="function"||an!==null&&typeof an.componentDidCatch=="function"&&($s===null||!$s.has(an)))){Nt.flags|=65536,F&=-F,Nt.lanes|=F;var ir=o_(Nt,Me,F);Oa(Nt,ir);break e}}Nt=Nt.return}while(Nt!==null)}Kg(K)}catch(Rr){F=Rr,os===K&&K!==null&&(os=K=K.return);continue}break}while(!0)}function bd(){var B=qi.current;return qi.current=ld,B===null?ld:B}function To(){(zo===0||zo===3||zo===2)&&(zo=4),eo===null||!(gd&268435455)&&!(vd&268435455)||Xc(eo,Fo)}function Uf(B,F){var K=mi;mi|=2;var oe=bd();eo===B&&Fo===F||gl(B,F);do try{__();break}catch(ge){Sa(B,ge)}while(!0);if(Os(),mi=K,qi.current=oe,os!==null)throw Error(l(261));return eo=null,Fo=0,zo}function __(){for(;os!==null;)qc(os)}function Gf(){for(;os!==null&&!Yh();)qc(os)}function qc(B){var F=Hf(B.alternate,B,No);B.memoizedProps=B.pendingProps,F===null?Kg(B):os=F,Tt.current=null}function Kg(B){var F=B;do{var K=F.alternate;if(B=F.return,F.flags&32768){if(K=qx(K,F),K!==null){K.flags&=32767,os=K;return}if(B!==null)B.flags|=32768,B.subtreeFlags=0,B.deletions=null;else{zo=6,os=null;return}}else if(K=hd(K,F,No),K!==null){os=K;return}if(F=F.sibling,F!==null){os=F;return}os=F=B}while(F!==null);zo===0&&(zo=5)}function mc(B,F){var K=_r,oe=Fs.transition;try{Fs.transition=null,_r=1,y_(B,F,K)}finally{Fs.transition=oe,_r=K}return null}function y_(B,F,K){do gc();while(Bl!==null);if(mi&6)throw Error(l(327));var oe=B.finishedWork,ge=B.finishedLanes;if(oe===null)return null;if(B.finishedWork=null,B.finishedLanes=0,oe===B.current)throw Error(l(177));B.callbackNode=null,B.callbackPriority=0;var Me=oe.lanes|oe.childLanes;if(ai(B,Me),B===eo&&(os=eo=null,Fo=0),!(oe.subtreeFlags&2064)&&!(oe.flags&2064)||qg||(qg=!0,ev(Fn,function(){return gc(),null})),Me=(oe.flags&15990)!==0,oe.subtreeFlags&15990||Me){Me=Fs.transition,Fs.transition=null;var pt=_r;_r=1;var Nt=mi;mi|=4,Tt.current=null,Kn(B,oe),Kx(B,oe),Ue(B.containerInfo),B.current=oe,p_(oe),yf(),mi=Nt,_r=pt,Fs.transition=Me}else B.current=oe;if(qg&&(qg=!1,Bl=B,Ui=ge),Me=B.pendingLanes,Me===0&&($s=null),ya(oe.stateNode),fo(B,Ss()),F!==null)for(K=B.onRecoverableError,oe=0;oe<F.length;oe++)K(F[oe]);if(tl)throw tl=!1,B=g_,g_=null,B;return Ui&1&&B.tag!==0&&gc(),Me=B.pendingLanes,Me&1?B===Yg?ti++:(ti=0,Yg=B):ti=0,Ba(),null}function gc(){if(Bl!==null){var B=Gx(Ui),F=Fs.transition,K=_r;try{if(Fs.transition=null,_r=16>B?16:B,Bl===null)var oe=!1;else{if(B=Bl,Bl=null,Ui=0,mi&6)throw Error(l(331));var ge=mi;for(mi|=4,or=B.current;or!==null;){var Me=or,pt=Me.child;if(or.flags&16){var Nt=Me.deletions;if(Nt!==null){for(var _n=0;_n<Nt.length;_n++){var $n=Nt[_n];for(or=$n;or!==null;){var wr=or;switch(wr.tag){case 0:case 11:case 15:Wc(8,wr,Me)}var ci=wr.child;if(ci!==null)ci.return=wr,or=ci;else for(;or!==null;){wr=or;var Gr=wr.sibling,vs=wr.return;if(jg(wr),wr===$n){or=null;break}if(Gr!==null){Gr.return=vs,or=Gr;break}or=vs}}}var Pr=Me.alternate;if(Pr!==null){var po=Pr.child;if(po!==null){Pr.child=null;do{var mo=po.sibling;po.sibling=null,po=mo}while(po!==null)}}or=Me}}if(Me.subtreeFlags&2064&&pt!==null)pt.return=Me,or=pt;else e:for(;or!==null;){if(Me=or,Me.flags&2048)switch(Me.tag){case 0:case 11:case 15:Wc(9,Me,Me.return)}var Xt=Me.sibling;if(Xt!==null){Xt.return=Me.return,or=Xt;break e}or=Me.return}}var Ut=B.current;for(or=Ut;or!==null;){pt=or;var an=pt.child;if(pt.subtreeFlags&2064&&an!==null)an.return=pt,or=an;else e:for(pt=Ut;or!==null;){if(Nt=or,Nt.flags&2048)try{switch(Nt.tag){case 0:case 11:case 15:sm(9,Nt)}}catch(Rr){da(Nt,Nt.return,Rr)}if(Nt===pt){or=null;break e}var ir=Nt.sibling;if(ir!==null){ir.return=Nt.return,or=ir;break e}or=Nt.return}}if(mi=ge,Ba(),Hs&&typeof Hs.onPostCommitFiberRoot=="function")try{Hs.onPostCommitFiberRoot(Kr,B)}catch{}oe=!0}return oe}finally{_r=K,Fs.transition=F}}return!1}function Vf(B,F,K){F=Kp(K,F),F=Wx(B,F,1),Yu(B,F),F=to(),B=kl(B,1),B!==null&&(qh(B,1,F),fo(B,F))}function da(B,F,K){if(B.tag===3)Vf(B,B,K);else for(;F!==null;){if(F.tag===3){Vf(F,B,K);break}else if(F.tag===1){var oe=F.stateNode;if(typeof F.type.getDerivedStateFromError=="function"||typeof oe.componentDidCatch=="function"&&($s===null||!$s.has(oe))){B=Kp(K,B),B=o_(F,B,1),Yu(F,B),B=to(),F=kl(F,1),F!==null&&(qh(F,1,B),fo(F,B));break}}F=F.return}}function Jg(B,F,K){var oe=B.pingCache;oe!==null&&oe.delete(F),F=to(),B.pingedLanes|=B.suspendedLanes&K,eo===B&&(Fo&K)===K&&(zo===4||zo===3&&(Fo&130023424)===Fo&&500>Ss()-_d?gl(B,0):Nf|=K),fo(B,F)}function um(B,F){F===0&&(B.mode&1?(F=vg,vg<<=1,!(vg&130023424)&&(vg=4194304)):F=1);var K=to();B=kl(B,F),B!==null&&(qh(B,F,K),fo(B,K))}function Jx(B){var F=B.memoizedState,K=0;F!==null&&(K=F.retryLane),um(B,K)}function Qg(B,F){var K=0;switch(B.tag){case 13:var oe=B.stateNode,ge=B.memoizedState;ge!==null&&(K=ge.retryLane);break;case 19:oe=B.stateNode;break;default:throw Error(l(314))}oe!==null&&oe.delete(F),um(B,K)}var Hf;Hf=function(B,F,K){if(B!==null)if(B.memoizedProps!==F.pendingProps||bs.current)Ao=!0;else{if(!(B.lanes&K)&&!(F.flags&128))return Ao=!1,f_(B,F,K);Ao=!!(B.flags&131072)}else Ao=!1,ss&&F.flags&1048576&&yr(F,ba,F.index);switch(F.lanes=0,F.tag){case 2:var oe=F.type;B!==null&&(B.alternate=null,F.alternate=null,F.flags|=2),B=F.pendingProps;var ge=ks(F,Zr.current);qu(F,K),ge=eh(null,F,oe,B,ge,K);var Me=od();return F.flags|=1,typeof ge=="object"&&ge!==null&&typeof ge.render=="function"&&ge.$$typeof===void 0?(F.tag=1,F.memoizedState=null,F.updateQueue=null,ms(oe)?(Me=!0,Cs(F)):Me=!1,F.memoizedState=ge.state!==null&&ge.state!==void 0?ge.state:null,xu(F),ge.updater=bu,F.stateNode=ge,ge._reactInternals=F,Z0(F,oe,B,K),F=dd(null,F,oe,!0,Me,K)):(F.tag=0,ss&&Me&&Up(F),ha(null,F,ge,K),F=F.child),F;case 16:oe=F.elementType;e:{switch(B!==null&&(B.alternate=null,F.alternate=null,F.flags|=2),B=F.pendingProps,ge=oe._init,oe=ge(oe._payload),F.type=oe,ge=F.tag=nv(oe),B=js(oe,B),ge){case 0:F=Gg(null,F,oe,B,K);break e;case 1:F=u_(null,F,oe,B,K);break e;case 11:F=Qp(null,F,oe,B,K);break e;case 14:F=zg(null,F,oe,js(oe.type,B),K);break e}throw Error(l(306,oe,""))}return F;case 0:return oe=F.type,ge=F.pendingProps,ge=F.elementType===oe?ge:js(oe,ge),Gg(B,F,oe,ge,K);case 1:return oe=F.type,ge=F.pendingProps,ge=F.elementType===oe?ge:js(oe,ge),u_(B,F,oe,ge,K);case 3:e:{if(Xx(F),B===null)throw Error(l(387));oe=F.pendingProps,Me=F.memoizedState,ge=Me.element,Fp(B,F),yg(F,oe,null,K);var pt=F.memoizedState;if(oe=pt.element,gn&&Me.isDehydrated)if(Me={element:oe,isDehydrated:!1,cache:pt.cache,transitions:pt.transitions},F.updateQueue.baseState=Me,F.memoizedState=Me,F.flags&256){ge=Error(l(423)),F=h_(B,F,oe,K,ge);break e}else if(oe!==ge){ge=Error(l(424)),F=h_(B,F,oe,K,ge);break e}else for(gn&&(So=Gt(F.stateNode.containerInfo),Fa=F,ss=!0,Ja=null,uo=!1),K=bg(F,null,oe,K),F.child=K;K;)K.flags=K.flags&-3|4096,K=K.sibling;else{if(xn(),oe===ge){F=Ll(B,F,K);break e}ha(B,F,oe,K)}F=F.child}return F;case 5:return wg(F),B===null&&oc(F),oe=F.type,ge=F.pendingProps,Me=B!==null?B.memoizedProps:null,pt=ge.children,jt(oe,ge)?pt=null:Me!==null&&jt(oe,Me)&&(F.flags|=32),em(B,F),ha(B,F,pt,K),F.child;case 6:return B===null&&oc(F),null;case 13:return nm(B,F,K);case 4:return za(F,F.stateNode.containerInfo),oe=F.pendingProps,B===null?F.child=Qa(F,null,oe,K):ha(B,F,oe,K),F.child;case 11:return oe=F.type,ge=F.pendingProps,ge=F.elementType===oe?ge:js(oe,ge),Qp(B,F,oe,ge,K);case 7:return ha(B,F,F.pendingProps,K),F.child;case 8:return ha(B,F,F.pendingProps.children,K),F.child;case 12:return ha(B,F,F.pendingProps.children,K),F.child;case 10:e:{if(oe=F.type._context,ge=F.pendingProps,Me=F.memoizedProps,pt=ge.value,xa(F,oe,pt),Me!==null)if(ul(Me.value,pt)){if(Me.children===ge.children&&!bs.current){F=Ll(B,F,K);break e}}else for(Me=F.child,Me!==null&&(Me.return=F);Me!==null;){var Nt=Me.dependencies;if(Nt!==null){pt=Me.child;for(var _n=Nt.firstContext;_n!==null;){if(_n.context===oe){if(Me.tag===1){_n=ca(-1,K&-K),_n.tag=2;var $n=Me.updateQueue;if($n!==null){$n=$n.shared;var wr=$n.pending;wr===null?_n.next=_n:(_n.next=wr.next,wr.next=_n),$n.pending=_n}}Me.lanes|=K,_n=Me.alternate,_n!==null&&(_n.lanes|=K),Ks(Me.return,K,F),Nt.lanes|=K;break}_n=_n.next}}else if(Me.tag===10)pt=Me.type===F.type?null:Me.child;else if(Me.tag===18){if(pt=Me.return,pt===null)throw Error(l(341));pt.lanes|=K,Nt=pt.alternate,Nt!==null&&(Nt.lanes|=K),Ks(pt,K,F),pt=Me.sibling}else pt=Me.child;if(pt!==null)pt.return=Me;else for(pt=Me;pt!==null;){if(pt===F){pt=null;break}if(Me=pt.sibling,Me!==null){Me.return=pt.return,pt=Me;break}pt=pt.return}Me=pt}ha(B,F,ge.children,K),F=F.child}return F;case 9:return ge=F.type,oe=F.pendingProps.children,qu(F,K),ge=Js(ge),oe=oe(ge),F.flags|=1,ha(B,F,oe,K),F.child;case 14:return oe=F.type,ge=js(oe,F.pendingProps),ge=js(oe.type,ge),zg(B,F,oe,ge,K);case 15:return c_(B,F,F.type,F.pendingProps,K);case 17:return oe=F.type,ge=F.pendingProps,ge=F.elementType===oe?ge:js(oe,ge),B!==null&&(B.alternate=null,F.alternate=null,F.flags|=2),F.tag=1,ms(oe)?(B=!0,Cs(F)):B=!1,qu(F,K),wf(F,oe,ge),Z0(F,oe,ge,K),dd(null,F,oe,!0,B,K);case 19:return rm(B,F,K);case 22:return Ug(B,F,K)}throw Error(l(156,F.tag))};function ev(B,F){return ur(B,F)}function Qx(B,F,K,oe){this.tag=B,this.key=K,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=F,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=oe,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rl(B,F,K,oe){return new Qx(B,F,K,oe)}function tv(B){return B=B.prototype,!(!B||!B.isReactComponent)}function nv(B){if(typeof B=="function")return tv(B)?1:0;if(B!=null){if(B=B.$$typeof,B===I)return 11;if(B===L)return 14}return 2}function Iu(B,F){var K=B.alternate;return K===null?(K=rl(B.tag,F,B.key,B.mode),K.elementType=B.elementType,K.type=B.type,K.stateNode=B.stateNode,K.alternate=B,B.alternate=K):(K.pendingProps=F,K.type=B.type,K.flags=0,K.subtreeFlags=0,K.deletions=null),K.flags=B.flags&14680064,K.childLanes=B.childLanes,K.lanes=B.lanes,K.child=B.child,K.memoizedProps=B.memoizedProps,K.memoizedState=B.memoizedState,K.updateQueue=B.updateQueue,F=B.dependencies,K.dependencies=F===null?null:{lanes:F.lanes,firstContext:F.firstContext},K.sibling=B.sibling,K.index=B.index,K.ref=B.ref,K}function hm(B,F,K,oe,ge,Me){var pt=2;if(oe=B,typeof B=="function")tv(B)&&(pt=1);else if(typeof B=="string")pt=5;else e:switch(B){case f:return lh(K.children,ge,Me,F);case m:pt=8,ge|=8;break;case _:return B=rl(12,K,F,ge|2),B.elementType=_,B.lanes=Me,B;case E:return B=rl(13,K,F,ge),B.elementType=E,B.lanes=Me,B;case C:return B=rl(19,K,F,ge),B.elementType=C,B.lanes=Me,B;case H:return dm(K,ge,Me,F);default:if(typeof B=="object"&&B!==null)switch(B.$$typeof){case x:pt=10;break e;case A:pt=9;break e;case I:pt=11;break e;case L:pt=14;break e;case O:pt=16,oe=null;break e}throw Error(l(130,B==null?B:typeof B,""))}return F=rl(pt,K,F,ge),F.elementType=B,F.type=oe,F.lanes=Me,F}function lh(B,F,K,oe){return B=rl(7,B,oe,F),B.lanes=K,B}function dm(B,F,K,oe){return B=rl(22,B,oe,F),B.elementType=H,B.lanes=K,B.stateNode={},B}function fm(B,F,K){return B=rl(6,B,null,F),B.lanes=K,B}function x_(B,F,K){return F=rl(4,B.children!==null?B.children:[],B.key,F),F.lanes=K,F.stateNode={containerInfo:B.containerInfo,pendingChildren:null,implementation:B.implementation},F}function nS(B,F,K,oe,ge){this.tag=F,this.containerInfo=B,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=kn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=oe,this.onRecoverableError=ge,gn&&(this.mutableSourceEagerHydrationData=null)}function As(B,F,K,oe,ge,Me,pt,Nt,_n){return B=new nS(B,F,K,Nt,_n),F===1?(F=1,Me===!0&&(F|=8)):F=0,Me=rl(3,null,null,F),B.current=Me,Me.stateNode=B,Me.memoizedState={element:oe,isDehydrated:K,cache:null,transitions:null},xu(Me),B}function b_(B){if(!B)return Qi;B=B._reactInternals;e:{if(se(B)!==B||B.tag!==1)throw Error(l(170));var F=B;do{switch(F.tag){case 3:F=F.stateNode.context;break e;case 1:if(ms(F.type)){F=F.stateNode.__reactInternalMemoizedMergedChildContext;break e}}F=F.return}while(F!==null);throw Error(l(171))}if(B.tag===1){var K=B.type;if(ms(K))return Bo(B,K,F)}return F}function e1(B){var F=B._reactInternals;if(F===void 0)throw typeof B.render=="function"?Error(l(188)):(B=Object.keys(B).join(","),Error(l(268,B)));return B=Ae(F),B===null?null:B.stateNode}function t1(B,F){if(B=B.memoizedState,B!==null&&B.dehydrated!==null){var K=B.retryLane;B.retryLane=K!==0&&K<F?K:F}}function wd(B,F){t1(B,F),(B=B.alternate)&&t1(B,F)}function n1(B){return B=Ae(B),B===null?null:B.stateNode}function jf(){return null}return t.attemptContinuousHydration=function(B){if(B.tag===13){var F=to();nl(B,134217728,F),wd(B,134217728)}},t.attemptHydrationAtCurrentPriority=function(B){if(B.tag===13){var F=to(),K=pc(B);nl(B,K,F),wd(B,K)}},t.attemptSynchronousHydration=function(B){switch(B.tag){case 3:var F=B.stateNode;if(F.current.memoizedState.isDehydrated){var K=Zo(F.pendingLanes);K!==0&&(Op(F,K|1),fo(F,Ss()),!(mi&6)&&(yd(),Ba()))}break;case 13:var oe=to();Eu(function(){return nl(B,1,oe)}),wd(B,1)}},t.batchedUpdates=function(B,F){var K=mi;mi|=1;try{return B(F)}finally{mi=K,mi===0&&(yd(),yu&&Ba())}},t.createComponentSelector=function(B){return{$$typeof:gs,value:B}},t.createContainer=function(B,F,K,oe,ge,Me,pt){return As(B,F,!1,null,K,oe,ge,Me,pt)},t.createHasPseudoClassSelector=function(B){return{$$typeof:md,value:B}},t.createHydrationContainer=function(B,F,K,oe,ge,Me,pt,Nt,_n){return B=As(K,oe,!0,B,ge,Me,pt,Nt,_n),B.context=b_(null),K=B.current,oe=to(),ge=pc(K),Me=ca(oe,ge),Me.callback=F??null,Yu(K,Me),B.current.lanes=ge,qh(B,ge,oe),fo(B,oe),B},t.createPortal=function(B,F,K){var oe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:oe==null?null:""+oe,children:B,containerInfo:F,implementation:K}},t.createRoleSelector=function(B){return{$$typeof:Of,value:B}},t.createTestNameSelector=function(B){return{$$typeof:am,value:B}},t.createTextSelector=function(B){return{$$typeof:lm,value:B}},t.deferredUpdates=function(B){var F=_r,K=Fs.transition;try{return Fs.transition=null,_r=16,B()}finally{_r=F,Fs.transition=K}},t.discreteUpdates=function(B,F,K,oe,ge){var Me=_r,pt=Fs.transition;try{return Fs.transition=null,_r=1,B(F,K,oe,ge)}finally{_r=Me,Fs.transition=pt,mi===0&&yd()}},t.findAllNodes=Jn,t.findBoundingRects=function(B,F){if(!ct)throw Error(l(363));F=Jn(B,F),B=[];for(var K=0;K<F.length;K++)B.push(qt(F[K]));for(F=B.length-1;0<F;F--){K=B[F];for(var oe=K.x,ge=oe+K.width,Me=K.y,pt=Me+K.height,Nt=F-1;0<=Nt;Nt--)if(F!==Nt){var _n=B[Nt],$n=_n.x,wr=$n+_n.width,ci=_n.y,Gr=ci+_n.height;if(oe>=$n&&Me>=ci&&ge<=wr&&pt<=Gr){B.splice(F,1);break}else if(oe!==$n||K.width!==_n.width||Gr<Me||ci>pt){if(!(Me!==ci||K.height!==_n.height||wr<oe||$n>ge)){$n>oe&&(_n.width+=$n-oe,_n.x=oe),wr<ge&&(_n.width=ge-$n),B.splice(F,1);break}}else{ci>Me&&(_n.height+=ci-Me,_n.y=Me),Gr<pt&&(_n.height=pt-ci),B.splice(F,1);break}}}return B},t.findHostInstance=e1,t.findHostInstanceWithNoPortals=function(B){return B=he(B),B=B!==null?Pe(B):null,B===null?null:B.stateNode},t.findHostInstanceWithWarning=function(B){return e1(B)},t.flushControlled=function(B){var F=mi;mi|=1;var K=Fs.transition,oe=_r;try{Fs.transition=null,_r=1,B()}finally{_r=oe,Fs.transition=K,mi=F,mi===0&&(yd(),Ba())}},t.flushPassiveEffects=gc,t.flushSync=Eu,t.focusWithin=function(B,F){if(!ct)throw Error(l(363));for(B=m_(B),F=vn(B,F),F=Array.from(F),B=0;B<F.length;){var K=F[B++];if(!An(K)){if(K.tag===5&&gr(K.stateNode))return!0;for(K=K.child;K!==null;)F.push(K),K=K.sibling}}return!1},t.getCurrentUpdatePriority=function(){return _r},t.getFindAllNodesFailureDescription=function(B,F){if(!ct)throw Error(l(363));var K=0,oe=[];B=[m_(B),0];for(var ge=0;ge<B.length;){var Me=B[ge++],pt=B[ge++],Nt=F[pt];if((Me.tag!==5||!An(Me))&&(rh(Me,Nt)&&(oe.push(ih(Nt)),pt++,pt>K&&(K=pt)),pt<F.length))for(Me=Me.child;Me!==null;)B.push(Me,pt),Me=Me.sibling}if(K<F.length){for(B=[];K<F.length;K++)B.push(ih(F[K]));return`findAllNodes was able to match part of the selector:
  `+(oe.join(" > ")+`

No matching component was found for:
  `)+B.join(" > ")}return null},t.getPublicRootInstance=function(B){if(B=B.current,!B.child)return null;switch(B.child.tag){case 5:return Re(B.child.stateNode);default:return B.child.stateNode}},t.injectIntoDevTools=function(B){if(B={bundleType:B.bundleType,version:B.version,rendererPackageName:B.rendererPackageName,rendererConfig:B.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:n1,findFiberByHostInstance:B.findFiberByHostInstance||jf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")B=!1;else{var F=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(F.isDisabled||!F.supportsFiber)B=!0;else{try{Kr=F.inject(B),Hs=F}catch{}B=!!F.checkDCE}}return B},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(B,F,K,oe){if(!ct)throw Error(l(363));B=Jn(B,F);var ge=Gn(B,K,oe).disconnect;return{disconnect:function(){ge()}}},t.registerMutableSourceForHydration=function(B,F){var K=F._getVersion;K=K(F._source),B.mutableSourceEagerHydrationData==null?B.mutableSourceEagerHydrationData=[F,K]:B.mutableSourceEagerHydrationData.push(F,K)},t.runWithPriority=function(B,F){var K=_r;try{return _r=B,F()}finally{_r=K}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(B,F,K,oe){var ge=F.current,Me=to(),pt=pc(ge);return K=b_(K),F.context===null?F.context=K:F.pendingContext=K,F=ca(Me,pt),F.payload={element:B},oe=oe===void 0?null:oe,oe!==null&&(F.callback=oe),Yu(ge,F),B=nl(ge,pt,Me),B!==null&&Np(B,ge,pt),pt},t};Jre.exports=MAe;var CAe=Jre.exports;const EAe=rD(CAe);var Qre={exports:{}},eie={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ye,We){var Ue=ye.length;ye.push(We);e:for(;0<Ue;){var gt=Ue-1>>>1,vt=ye[gt];if(0<s(vt,We))ye[gt]=We,ye[Ue]=vt,Ue=gt;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var We=ye[0],Ue=ye.pop();if(Ue!==We){ye[0]=Ue;e:for(var gt=0,vt=ye.length,Dt=vt>>>1;gt<Dt;){var lt=2*(gt+1)-1,jt=ye[lt],Qt=lt+1,nn=ye[Qt];if(0>s(jt,Ue))Qt<vt&&0>s(nn,jt)?(ye[gt]=nn,ye[Qt]=Ue,gt=Qt):(ye[gt]=jt,ye[lt]=Ue,gt=lt);else if(Qt<vt&&0>s(nn,Ue))ye[gt]=nn,ye[Qt]=Ue,gt=Qt;else break e}}return We}function s(ye,We){var Ue=ye.sortIndex-We.sortIndex;return Ue!==0?Ue:ye.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var a=[],d=[],f=1,m=null,_=3,x=!1,A=!1,I=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(ye){for(var We=t(d);We!==null;){if(We.callback===null)r(d);else if(We.startTime<=ye)r(d),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(d)}}function H(ye){if(I=!1,O(ye),!A)if(t(a)!==null)A=!0,Re(q);else{var We=t(d);We!==null&&rt(H,We.startTime-ye)}}function q(ye,We){A=!1,I&&(I=!1,C(re),re=-1),x=!0;var Ue=_;try{for(O(We),m=t(a);m!==null&&(!(m.expirationTime>We)||ye&&!he());){var gt=m.callback;if(typeof gt=="function"){m.callback=null,_=m.priorityLevel;var vt=gt(m.expirationTime<=We);We=n.unstable_now(),typeof vt=="function"?m.callback=vt:m===t(a)&&r(a),O(We)}else r(a);m=t(a)}if(m!==null)var Dt=!0;else{var lt=t(d);lt!==null&&rt(H,lt.startTime-We),Dt=!1}return Dt}finally{m=null,_=Ue,x=!1}}var Z=!1,J=null,re=-1,se=5,ae=-1;function he(){return!(n.unstable_now()-ae<se)}function Ae(){if(J!==null){var ye=n.unstable_now();ae=ye;var We=!0;try{We=J(!0,ye)}finally{We?Ee():(Z=!1,J=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Ae)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,ze=Pe.port2;Pe.port1.onmessage=Ae,Ee=function(){ze.postMessage(null)}}else Ee=function(){E(Ae,0)};function Re(ye){J=ye,Z||(Z=!0,Ee())}function rt(ye,We){re=E(function(){ye(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){A||x||(A=!0,Re(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(ye){switch(_){case 1:case 2:case 3:var We=3;break;default:We=_}var Ue=_;_=We;try{return ye()}finally{_=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,We){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ue=_;_=ye;try{return We()}finally{_=Ue}},n.unstable_scheduleCallback=function(ye,We,Ue){var gt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?gt+Ue:gt):Ue=gt,ye){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=Ue+vt,ye={id:f++,callback:We,priorityLevel:ye,startTime:Ue,expirationTime:vt,sortIndex:-1},Ue>gt?(ye.sortIndex=Ue,e(d,ye),t(a)===null&&ye===t(d)&&(I?(C(re),re=-1):I=!0,rt(H,Ue-gt))):(ye.sortIndex=vt,e(a,ye),A||x||(A=!0,Re(q))),ye},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(ye){var We=_;return function(){var Ue=_;_=We;try{return ye.apply(this,arguments)}finally{_=Ue}}}})(eie);Qre.exports=eie;var Y$=Qre.exports;const IAe=n=>typeof n=="object"&&typeof n.then=="function",Oy=[];function tie(n,e,t=(r,s)=>r===s){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let s=0;s<r;s++)if(!t(n[s],e[s]))return!1;return!0}function nie(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const o of Oy)if(tie(e,o.keys,o.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return r.lifespan&&r.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,r.lifespan)),o.response;if(!t)throw o.promise}const s={keys:e,equal:r.equal,remove:()=>{const o=Oy.indexOf(s);o!==-1&&Oy.splice(o,1)},promise:(IAe(n)?n:n(...e)).then(o=>{s.response=o,r.lifespan&&r.lifespan>0&&(s.timeout=setTimeout(s.remove,r.lifespan))}).catch(o=>s.error=o)};if(Oy.push(s),!t)throw s.promise}const PAe=(n,e,t)=>nie(n,e,!1,t),RAe=(n,e,t)=>void nie(n,e,!0,t),LAe=n=>{if(n===void 0||n.length===0)Oy.splice(0,Oy.length);else{const e=Oy.find(t=>tie(n,t.keys,t.equal));e&&e.remove()}},eG={},DAe=n=>void Object.assign(eG,n);function BAe(n,e){function t(f,{args:m=[],attach:_,...x},A){let I=`${f[0].toUpperCase()}${f.slice(1)}`,E;if(f==="primitive"){if(x.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const C=x.object;E=ub(C,{type:f,root:A,attach:_,primitive:!0})}else{const C=eG[I];if(!C)throw new Error(`R3F: ${I} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(m))throw new Error("R3F: The args prop must be an array!");E=ub(new C(...m),{type:f,root:A,attach:_,memoizedProps:{args:m}})}return E.__r3f.attach===void 0&&(E instanceof Yr?E.__r3f.attach="geometry":E instanceof wo&&(E.__r3f.attach="material")),I!=="inject"&&BF(E,x),E}function r(f,m){let _=!1;if(m){var x,A;(x=m.__r3f)!=null&&x.attach?DF(f,m,m.__r3f.attach):m.isObject3D&&f.isObject3D&&(f.add(m),_=!0),_||(A=f.__r3f)==null||A.objects.push(m),m.__r3f||ub(m,{}),m.__r3f.parent=f,mz(m),hb(m)}}function s(f,m,_){let x=!1;if(m){var A,I;if((A=m.__r3f)!=null&&A.attach)DF(f,m,m.__r3f.attach);else if(m.isObject3D&&f.isObject3D){m.parent=f,m.dispatchEvent({type:"added"});const E=f.children.filter(L=>L!==m),C=E.indexOf(_);f.children=[...E.slice(0,C),m,...E.slice(C)],x=!0}x||(I=f.__r3f)==null||I.objects.push(m),m.__r3f||ub(m,{}),m.__r3f.parent=f,mz(m),hb(m)}}function o(f,m,_=!1){f&&[...f].forEach(x=>l(m,x,_))}function l(f,m,_){if(m){var x,A,I;if(m.__r3f&&(m.__r3f.parent=null),(x=f.__r3f)!=null&&x.objects&&(f.__r3f.objects=f.__r3f.objects.filter(H=>H!==m)),(A=m.__r3f)!=null&&A.attach)eX(f,m,m.__r3f.attach);else if(m.isObject3D&&f.isObject3D){var E;f.remove(m),(E=m.__r3f)!=null&&E.root&&HAe(m.__r3f.root,m)}const L=(I=m.__r3f)==null?void 0:I.primitive,O=!L&&(_===void 0?m.dispose!==null:_);if(!L){var C;o((C=m.__r3f)==null?void 0:C.objects,m,O),o(m.children,m,O)}if(delete m.__r3f,O&&m.dispose&&m.type!=="Scene"){const H=()=>{try{m.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Y$.unstable_scheduleCallback(Y$.unstable_IdlePriority,H):H()}hb(f)}}function c(f,m,_,x){var A;const I=(A=f.__r3f)==null?void 0:A.parent;if(!I)return;const E=t(m,_,f.__r3f.root);if(f.children){for(const C of f.children)C.__r3f&&r(E,C);f.children=f.children.filter(C=>!C.__r3f)}f.__r3f.objects.forEach(C=>r(E,C)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||l(I,f),E.parent&&(E.__r3f.autoRemovedBeforeAppend=!0),r(I,E),E.raycast&&E.__r3f.eventCount&&E.__r3f.root.getState().internal.interaction.push(E),[x,x.alternate].forEach(C=>{C!==null&&(C.stateNode=E,C.ref&&(typeof C.ref=="function"?C.ref(E):C.ref.current=E))})}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:EAe({createInstance:t,removeChild:l,appendChild:r,appendInitialChild:r,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,m)=>{if(!m)return;const _=f.getState().scene;_.__r3f&&(_.__r3f.root=f,r(_,m))},removeChildFromContainer:(f,m)=>{m&&l(f.getState().scene,m)},insertInContainerBefore:(f,m,_)=>{if(!m||!_)return;const x=f.getState().scene;x.__r3f&&s(x,m,_)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var m;return!!((m=f==null?void 0:f.__r3f)!=null?m:{}).handlers},prepareUpdate(f,m,_,x){var A;if(((A=f==null?void 0:f.__r3f)!=null?A:{}).primitive&&x.object&&x.object!==f)return[!0];{const{args:E=[],children:C,...L}=x,{args:O=[],children:H,...q}=_;if(!Array.isArray(E))throw new Error("R3F: the args prop must be an array!");if(E.some((J,re)=>J!==O[re]))return[!0];const Z=cie(f,L,q,!0);return Z.changes.length?[!1,Z]:null}},commitUpdate(f,[m,_],x,A,I,E){m?c(f,x,I,E):BF(f,_)},commitMount(f,m,_,x){var A;const I=(A=f.__r3f)!=null?A:{};f.raycast&&I.handlers&&I.eventCount&&f.__r3f.root.getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>ub(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var m;const{attach:_,parent:x}=(m=f.__r3f)!=null?m:{};_&&x&&eX(x,f,_),f.isObject3D&&(f.visible=!1),hb(f)},unhideInstance(f,m){var _;const{attach:x,parent:A}=(_=f.__r3f)!=null?_:{};x&&A&&DF(A,f,x),(f.isObject3D&&m.visible==null||m.visible)&&(f.visible=!0),hb(f)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>e?e():Db.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&yo.fun(performance.now)?performance.now:yo.fun(Date.now)?Date.now:()=>0,scheduleTimeout:yo.fun(setTimeout)?setTimeout:void 0,cancelTimeout:yo.fun(clearTimeout)?clearTimeout:void 0}),applyProps:BF}}var Z$,K$;const LF=n=>"colorSpace"in n||"outputColorSpace"in n,rie=()=>{var n;return(n=eG.ColorManagement)!=null?n:null},iie=n=>n&&n.isOrthographicCamera,kAe=n=>n&&n.hasOwnProperty("current"),TC=typeof window<"u"&&((Z$=window.document)!=null&&Z$.createElement||((K$=window.navigator)==null?void 0:K$.product)==="ReactNative")?_e.useLayoutEffect:_e.useEffect;function sie(n){const e=_e.useRef(n);return TC(()=>void(e.current=n),[n]),e}function OAe({set:n}){return TC(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class oie extends _e.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}oie.getDerivedStateFromError=()=>({error:!0});const aie="__default",J$=new Map,FAe=n=>n&&!!n.memoized&&!!n.changes;function lie(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const rA=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},yo={obj:n=>n===Object(n)&&!yo.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(yo.str(n)||yo.num(n))return n===e;const o=yo.obj(n);if(o&&r==="reference")return n===e;const l=yo.arr(n);if(l&&t==="reference")return n===e;if((l||o)&&n===e)return!0;let c;for(c in n)if(!(c in e))return!1;if(o&&t==="shallow"&&r==="shallow"){for(c in s?e:n)if(!yo.equ(n[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in s?e:n)if(n[c]!==e[c])return!1;if(yo.und(c)){if(l&&n.length===0&&e.length===0||o&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function NAe(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function zAe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function ub(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function pz(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),s=r.pop();return t=r.reduce((o,l)=>o[l],n),{target:t,key:s}}else return{target:t,key:e}}const Q$=/-\d+$/;function DF(n,e,t){if(yo.str(t)){if(Q$.test(t)){const o=t.replace(Q$,""),{target:l,key:c}=pz(n,o);Array.isArray(l[c])||(l[c]=[])}const{target:r,key:s}=pz(n,t);e.__r3f.previousAttach=r[s],r[s]=e}else e.__r3f.previousAttach=t(n,e)}function eX(n,e,t){var r,s;if(yo.str(t)){const{target:o,key:l}=pz(n,t),c=e.__r3f.previousAttach;c===void 0?delete o[l]:o[l]=c}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(s=e.__r3f)==null||delete s.previousAttach}function cie(n,{children:e,key:t,ref:r,...s},{children:o,key:l,ref:c,...a}={},d=!1){var f;const m=(f=n==null?void 0:n.__r3f)!=null?f:{},_=Object.entries(s),x=[];if(d){const I=Object.keys(a);for(let E=0;E<I.length;E++)s.hasOwnProperty(I[E])||_.unshift([I[E],aie+"remove"])}_.forEach(([I,E])=>{var C;if((C=n.__r3f)!=null&&C.primitive&&I==="object"||yo.equ(E,a[I]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(I))return x.push([I,E,!0,[]]);let L=[];I.includes("-")&&(L=I.split("-")),x.push([I,E,!1,L]);for(const O in s){const H=s[O];O.startsWith(`${I}-`)&&x.push([O,H,!1,O.split("-")])}});const A={...s};return m.memoizedProps&&m.memoizedProps.args&&(A.args=m.memoizedProps.args),m.memoizedProps&&m.memoizedProps.attach&&(A.attach=m.memoizedProps.attach),{memoized:A,changes:x}}const UAe=typeof process<"u"&&!1;function BF(n,e){var t,r,s;const o=(t=n.__r3f)!=null?t:{},l=o.root,c=(r=l==null||l.getState==null?void 0:l.getState())!=null?r:{},{memoized:a,changes:d}=FAe(e)?e:cie(n,e),f=o.eventCount;n.__r3f&&(n.__r3f.memoizedProps=a);for(let _=0;_<d.length;_++){let[x,A,I,E]=d[_];if(LF(n)){const H="srgb",q="srgb-linear";x==="encoding"?(x="colorSpace",A=A===3001?H:q):x==="outputEncoding"&&(x="outputColorSpace",A=A===3001?H:q)}let C=n,L=C[x];if(E.length&&(L=E.reduce((O,H)=>O[H],n),!(L&&L.set))){const[O,...H]=E.reverse();C=H.reverse().reduce((q,Z)=>q[Z],n),x=O}if(A===aie+"remove")if(C.constructor){let O=J$.get(C.constructor);O||(O=new C.constructor,J$.set(C.constructor,O)),A=O[x]}else A=0;if(I)A?o.handlers[x]=A:delete o.handlers[x],o.eventCount=Object.keys(o.handlers).length;else if(L&&L.set&&(L.copy||L instanceof Ky)){if(Array.isArray(A))L.fromArray?L.fromArray(A):L.set(...A);else if(L.copy&&A&&A.constructor&&(UAe?L.constructor.name===A.constructor.name:L.constructor===A.constructor))L.copy(A);else if(A!==void 0){const O=L instanceof Hn;!O&&L.setScalar?L.setScalar(A):L instanceof Ky&&A instanceof Ky?L.mask=A.mask:L.set(A),!rie()&&!c.linear&&O&&L.convertSRGBToLinear()}}else if(C[x]=A,C[x]instanceof Ys&&C[x].format===Zl&&C[x].type===tf){const O=C[x];LF(O)&&LF(c.gl)?O.colorSpace=c.gl.outputColorSpace:O.encoding=c.gl.outputEncoding}hb(n)}if(o.parent&&c.internal&&n.raycast&&f!==o.eventCount){const _=c.internal.interaction.indexOf(n);_>-1&&c.internal.interaction.splice(_,1),o.eventCount&&c.internal.interaction.push(n)}return!(d.length===1&&d[0][0]==="onUpdate")&&d.length&&(s=n.__r3f)!=null&&s.parent&&mz(n),n}function hb(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function mz(n){n.onUpdate==null||n.onUpdate(n)}function GAe(n,e){n.manual||(iie(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function $2(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function VAe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Db.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Db.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Db.ContinuousEventPriority;default:return Db.DefaultEventPriority}}function uie(n,e,t,r){const s=t.get(e);s&&(t.delete(e),t.size===0&&(n.delete(r),s.target.releasePointerCapture(r)))}function HAe(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,s)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((r,s)=>{uie(t.capturedMap,e,r,s)})}function jAe(n){function e(a){const{internal:d}=n.getState(),f=a.offsetX-d.initialClick[0],m=a.offsetY-d.initialClick[1];return Math.round(Math.sqrt(f*f+m*m))}function t(a){return a.filter(d=>["Move","Over","Enter","Out","Leave"].some(f=>{var m;return(m=d.__r3f)==null?void 0:m.handlers["onPointer"+f]}))}function r(a,d){const f=n.getState(),m=new Set,_=[],x=d?d(f.internal.interaction):f.internal.interaction;for(let C=0;C<x.length;C++){const L=rA(x[C]);L&&(L.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(a,f);function A(C){const L=rA(C);if(!L||!L.events.enabled||L.raycaster.camera===null)return[];if(L.raycaster.camera===void 0){var O;L.events.compute==null||L.events.compute(a,L,(O=L.previousRoot)==null?void 0:O.getState()),L.raycaster.camera===void 0&&(L.raycaster.camera=null)}return L.raycaster.camera?L.raycaster.intersectObject(C,!0):[]}let I=x.flatMap(A).sort((C,L)=>{const O=rA(C.object),H=rA(L.object);return!O||!H?C.distance-L.distance:H.events.priority-O.events.priority||C.distance-L.distance}).filter(C=>{const L=$2(C);return m.has(L)?!1:(m.add(L),!0)});f.events.filter&&(I=f.events.filter(I,f));for(const C of I){let L=C.object;for(;L;){var E;(E=L.__r3f)!=null&&E.eventCount&&_.push({...C,eventObject:L}),L=L.parent}}if("pointerId"in a&&f.internal.capturedMap.has(a.pointerId))for(let C of f.internal.capturedMap.get(a.pointerId).values())m.has($2(C.intersection))||_.push(C.intersection);return _}function s(a,d,f,m){const _=n.getState();if(a.length){const x={stopped:!1};for(const A of a){const I=rA(A.object)||_,{raycaster:E,pointer:C,camera:L,internal:O}=I,H=new Ze(C.x,C.y,0).unproject(L),q=ae=>{var he,Ae;return(he=(Ae=O.capturedMap.get(ae))==null?void 0:Ae.has(A.eventObject))!=null?he:!1},Z=ae=>{const he={intersection:A,target:d.target};O.capturedMap.has(ae)?O.capturedMap.get(ae).set(A.eventObject,he):O.capturedMap.set(ae,new Map([[A.eventObject,he]])),d.target.setPointerCapture(ae)},J=ae=>{const he=O.capturedMap.get(ae);he&&uie(O.capturedMap,A.eventObject,he,ae)};let re={};for(let ae in d){let he=d[ae];typeof he!="function"&&(re[ae]=he)}let se={...A,...re,pointer:C,intersections:a,stopped:x.stopped,delta:f,unprojectedPoint:H,ray:E.ray,camera:L,stopPropagation(){const ae="pointerId"in d&&O.capturedMap.get(d.pointerId);if((!ae||ae.has(A.eventObject))&&(se.stopped=x.stopped=!0,O.hovered.size&&Array.from(O.hovered.values()).find(he=>he.eventObject===A.eventObject))){const he=a.slice(0,a.indexOf(A));o([...he,A])}},target:{hasPointerCapture:q,setPointerCapture:Z,releasePointerCapture:J},currentTarget:{hasPointerCapture:q,setPointerCapture:Z,releasePointerCapture:J},nativeEvent:d};if(m(se),x.stopped===!0)break}}return a}function o(a){const{internal:d}=n.getState();for(const f of d.hovered.values())if(!a.length||!a.find(m=>m.object===f.object&&m.index===f.index&&m.instanceId===f.instanceId)){const _=f.eventObject.__r3f,x=_==null?void 0:_.handlers;if(d.hovered.delete($2(f)),_!=null&&_.eventCount){const A={...f,intersections:a};x.onPointerOut==null||x.onPointerOut(A),x.onPointerLeave==null||x.onPointerLeave(A)}}}function l(a,d){for(let f=0;f<d.length;f++){const m=d[f].__r3f;m==null||m.handlers.onPointerMissed==null||m.handlers.onPointerMissed(a)}}function c(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return d=>{const{internal:f}=n.getState();"pointerId"in d&&f.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(d.pointerId)&&(f.capturedMap.delete(d.pointerId),o([]))})}}return function(f){const{onPointerMissed:m,internal:_}=n.getState();_.lastEvent.current=f;const x=a==="onPointerMove",A=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",E=r(f,x?t:void 0),C=A?e(f):0;a==="onPointerDown"&&(_.initialClick=[f.offsetX,f.offsetY],_.initialHits=E.map(O=>O.eventObject)),A&&!E.length&&C<=2&&(l(f,_.interaction),m&&m(f)),x&&o(E);function L(O){const H=O.eventObject,q=H.__r3f,Z=q==null?void 0:q.handlers;if(q!=null&&q.eventCount)if(x){if(Z.onPointerOver||Z.onPointerEnter||Z.onPointerOut||Z.onPointerLeave){const J=$2(O),re=_.hovered.get(J);re?re.stopped&&O.stopPropagation():(_.hovered.set(J,O),Z.onPointerOver==null||Z.onPointerOver(O),Z.onPointerEnter==null||Z.onPointerEnter(O))}Z.onPointerMove==null||Z.onPointerMove(O)}else{const J=Z[a];J?(!A||_.initialHits.includes(H))&&(l(f,_.interaction.filter(re=>!_.initialHits.includes(re))),J(O)):A&&_.initialHits.includes(H)&&l(f,_.interaction.filter(re=>!_.initialHits.includes(re)))}}s(E,f,C,L)}}return{handlePointer:c}}const hie=n=>!!(n!=null&&n.render),die=_e.createContext(null),WAe=(n,e)=>{const t=SAe((c,a)=>{const d=new Ze,f=new Ze,m=new Ze;function _(C=a().camera,L=f,O=a().size){const{width:H,height:q,top:Z,left:J}=O,re=H/q;L instanceof Ze?m.copy(L):m.set(...L);const se=C.getWorldPosition(d).distanceTo(m);if(iie(C))return{width:H/C.zoom,height:q/C.zoom,top:Z,left:J,factor:1,distance:se,aspect:re};{const ae=C.fov*Math.PI/180,he=2*Math.tan(ae/2)*se,Ae=he*(H/q);return{width:Ae,height:he,top:Z,left:J,factor:H/Ae,distance:se,aspect:re}}}let x;const A=C=>c(L=>({performance:{...L.performance,current:C}})),I=new sn;return{set:c,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(C=1)=>n(a(),C),advance:(C,L)=>e(C,L,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new dg,pointer:I,mouse:I,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const C=a();x&&clearTimeout(x),C.performance.current!==C.performance.min&&A(C.performance.min),x=setTimeout(()=>A(a().performance.max),C.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:C=>c(L=>({...L,events:{...L.events,...C}})),setSize:(C,L,O,H,q)=>{const Z=a().camera,J={width:C,height:L,top:H||0,left:q||0,updateStyle:O};c(re=>({size:J,viewport:{...re.viewport,..._(Z,f,J)}}))},setDpr:C=>c(L=>{const O=lie(C);return{viewport:{...L.viewport,dpr:O,initialDpr:L.viewport.initialDpr||O}}}),setFrameloop:(C="always")=>{const L=a().clock;L.stop(),L.elapsedTime=0,C!=="never"&&(L.start(),L.elapsedTime=0),c(()=>({frameloop:C}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:_e.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(C,L,O)=>{const H=a().internal;return H.priority=H.priority+(L>0?1:0),H.subscribers.push({ref:C,priority:L,store:O}),H.subscribers=H.subscribers.sort((q,Z)=>q.priority-Z.priority),()=>{const q=a().internal;q!=null&&q.subscribers&&(q.priority=q.priority-(L>0?1:0),q.subscribers=q.subscribers.filter(Z=>Z.ref!==C))}}}}}),r=t.getState();let s=r.size,o=r.viewport.dpr,l=r.camera;return t.subscribe(()=>{const{camera:c,size:a,viewport:d,gl:f,set:m}=t.getState();if(a.width!==s.width||a.height!==s.height||d.dpr!==o){var _;s=a,o=d.dpr,GAe(c,a),f.setPixelRatio(d.dpr);const x=(_=a.updateStyle)!=null?_:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(a.width,a.height,x)}c!==l&&(l=c,m(x=>({viewport:{...x.viewport,...x.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>n(c)),t};function $Ae(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}let X2,fie=new Set,XAe=new Set,qAe=new Set;const YAe=n=>$Ae(n,fie);function kF(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function iA(n,e){switch(n){case"before":return kF(fie,e);case"after":return kF(XAe,e);case"tail":return kF(qAe,e)}}let OF,FF;function NF(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),OF=e.internal.subscribers,X2=0;X2<OF.length;X2++)FF=OF[X2],FF.ref.current(FF.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function ZAe(n){let e=!1,t,r,s;function o(a){r=requestAnimationFrame(o),e=!0,t=0,iA("before",a);for(const f of n.values()){var d;s=f.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((d=s.gl.xr)!=null&&d.isPresenting)&&(t+=NF(a,s))}if(iA("after",a),t===0)return iA("tail",a),e=!1,cancelAnimationFrame(r)}function l(a,d=1){var f;if(!a)return n.forEach(m=>l(m.store.getState()),d);(f=a.gl.xr)!=null&&f.isPresenting||!a.internal.active||a.frameloop==="never"||(a.internal.frames=Math.min(60,a.internal.frames+d),e||(e=!0,requestAnimationFrame(o)))}function c(a,d=!0,f,m){if(d&&iA("before",a),f)NF(a,f,m);else for(const _ of n.values())NF(a,_.store.getState());d&&iA("after",a)}return{loop:o,invalidate:l,advance:c}}function pie(){const n=_e.useContext(die);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function mie(n=t=>t,e){return pie()(n,e)}function MC(n,e=0){const t=pie(),r=t.getState().internal.subscribe,s=sie(n);return TC(()=>r(s,e,t),[e,r,t]),null}const tX=new WeakMap;function gie(n,e){return function(t,...r){let s=tX.get(t);return s||(s=new t,tX.set(t,s)),n&&n(s),Promise.all(r.map(o=>new Promise((l,c)=>s.load(o,a=>{a.scene&&Object.assign(a,NAe(a.scene)),l(a)},e,a=>c(new Error(`Could not load ${o}: ${a==null?void 0:a.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function CC(n,e,t,r){const s=Array.isArray(e)?e:[e],o=PAe(gie(t,r),[n,...s],{equal:yo.equ});return Array.isArray(e)?o:o[0]}CC.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return RAe(gie(t),[n,...r])};CC.clear=function(n,e){const t=Array.isArray(e)?e:[e];return LAe([n,...t])};const xw=new Map,{invalidate:nX,advance:rX}=ZAe(xw),{reconciler:YR,applyProps:wy}=BAe(xw,VAe),V1={objects:"shallow",strict:!1},KAe=(n,e)=>{const t=typeof n=="function"?n(e):n;return hie(t)?t:new ec({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function JAe(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:s,top:o,left:l,updateStyle:c=t}=e;return{width:r,height:s,top:o,left:l,updateStyle:c}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:s,top:o,left:l}=n.parentElement.getBoundingClientRect();return{width:r,height:s,top:o,left:l,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function QAe(n){const e=xw.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,o=r||WAe(nX,rX),l=t||YR.createContainer(o,Db.ConcurrentRoot,null,!1,null,"",s,null);e||xw.set(n,{fiber:l,store:o});let c,a=!1,d;return{configure(f={}){let{gl:m,size:_,scene:x,events:A,onCreated:I,shadows:E=!1,linear:C=!1,flat:L=!1,legacy:O=!1,orthographic:H=!1,frameloop:q="always",dpr:Z=[1,2],performance:J,raycaster:re,camera:se,onPointerMissed:ae}=f,he=o.getState(),Ae=he.gl;he.gl||he.set({gl:Ae=KAe(m,n)});let Ee=he.raycaster;Ee||he.set({raycaster:Ee=new nB});const{params:Pe,...ze}=re||{};if(yo.equ(ze,Ee,V1)||wy(Ee,{...ze}),yo.equ(Pe,Ee.params,V1)||wy(Ee,{params:{...Ee.params,...Pe}}),!he.camera||he.camera===d&&!yo.equ(d,se,V1)){d=se;const vt=se instanceof pC,Dt=vt?se:H?new af(0,0,0,0,.1,1e3):new is(75,0,.1,1e3);vt||(Dt.position.z=5,se&&wy(Dt,se),!he.camera&&!(se!=null&&se.rotation)&&Dt.lookAt(0,0,0)),he.set({camera:Dt}),Ee.camera=Dt}if(!he.scene){let vt;x instanceof Il?vt=x:(vt=new Il,x&&wy(vt,x)),he.set({scene:ub(vt)})}if(!he.xr){var Re;const vt=(jt,Qt)=>{const nn=o.getState();nn.frameloop!=="never"&&rX(jt,!0,nn,Qt)},Dt=()=>{const jt=o.getState();jt.gl.xr.enabled=jt.gl.xr.isPresenting,jt.gl.xr.setAnimationLoop(jt.gl.xr.isPresenting?vt:null),jt.gl.xr.isPresenting||nX(jt)},lt={connect(){const jt=o.getState().gl;jt.xr.addEventListener("sessionstart",Dt),jt.xr.addEventListener("sessionend",Dt)},disconnect(){const jt=o.getState().gl;jt.xr.removeEventListener("sessionstart",Dt),jt.xr.removeEventListener("sessionend",Dt)}};typeof((Re=Ae.xr)==null?void 0:Re.addEventListener)=="function"&&lt.connect(),he.set({xr:lt})}if(Ae.shadowMap){const vt=Ae.shadowMap.enabled,Dt=Ae.shadowMap.type;if(Ae.shadowMap.enabled=!!E,yo.boo(E))Ae.shadowMap.type=fT;else if(yo.str(E)){var rt;const lt={basic:rne,percentage:AD,soft:fT,variance:Gd};Ae.shadowMap.type=(rt=lt[E])!=null?rt:fT}else yo.obj(E)&&Object.assign(Ae.shadowMap,E);(vt!==Ae.shadowMap.enabled||Dt!==Ae.shadowMap.type)&&(Ae.shadowMap.needsUpdate=!0)}const ye=rie();ye&&("enabled"in ye?ye.enabled=!O:"legacyMode"in ye&&(ye.legacyMode=O)),wy(Ae,{outputEncoding:C?3e3:3001,toneMapping:L?mp:MD}),he.legacy!==O&&he.set(()=>({legacy:O})),he.linear!==C&&he.set(()=>({linear:C})),he.flat!==L&&he.set(()=>({flat:L})),m&&!yo.fun(m)&&!hie(m)&&!yo.equ(m,Ae,V1)&&wy(Ae,m),A&&!he.events.handlers&&he.set({events:A(o)});const gt=JAe(n,_);return yo.equ(gt,he.size,V1)||he.setSize(gt.width,gt.height,gt.updateStyle,gt.top,gt.left),Z&&he.viewport.dpr!==lie(Z)&&he.setDpr(Z),he.frameloop!==q&&he.setFrameloop(q),he.onPointerMissed||he.set({onPointerMissed:ae}),J&&!yo.equ(J,he.performance,V1)&&he.set(vt=>({performance:{...vt.performance,...J}})),c=I,a=!0,this},render(f){return a||this.configure(),YR.updateContainer(_e.createElement(eTe,{store:o,children:f,onCreated:c,rootElement:n}),l,null,()=>{}),o},unmount(){vie(n)}}}function eTe({store:n,children:e,onCreated:t,rootElement:r}){return TC(()=>{const s=n.getState();s.set(o=>({internal:{...o.internal,active:!0}})),t&&t(s),n.getState().events.connected||s.events.connect==null||s.events.connect(r)},[]),_e.createElement(die.Provider,{value:n},e)}function vie(n,e){const t=xw.get(n),r=t==null?void 0:t.fiber;if(r){const s=t==null?void 0:t.store.getState();s&&(s.internal.active=!1),YR.updateContainer(null,r,null,()=>{s&&setTimeout(()=>{try{var o,l,c,a;s.events.disconnect==null||s.events.disconnect(),(o=s.gl)==null||(l=o.renderLists)==null||l.dispose==null||l.dispose(),(c=s.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(a=s.gl)!=null&&a.xr&&s.xr.disconnect(),zAe(s),xw.delete(n)}catch{}},500)})}}YR.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:_e.version});function gz(n,e,t){var r,s,o,l,c;e==null&&(e=100);function a(){var f=Date.now()-l;f<e&&f>=0?r=setTimeout(a,e-f):(r=null,t||(c=n.apply(o,s),o=s=null))}var d=function(){o=this,s=arguments,l=Date.now();var f=t&&!r;return r||(r=setTimeout(a,e)),f&&(c=n.apply(o,s),o=s=null),c};return d.clear=function(){r&&(clearTimeout(r),r=null)},d.flush=function(){r&&(c=n.apply(o,s),o=s=null,clearTimeout(r),r=null)},d}gz.debounce=gz;var tTe=gz;const iX=rD(tTe);function nTe(n){let{debounce:e,scroll:t,polyfill:r,offsetSize:s}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const o=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[l,c]=_e.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=_e.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),d=e?typeof e=="number"?e:e.scroll:null,f=e?typeof e=="number"?e:e.resize:null,m=_e.useRef(!1);_e.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[_,x,A]=_e.useMemo(()=>{const L=()=>{if(!a.current.element)return;const{left:O,top:H,width:q,height:Z,bottom:J,right:re,x:se,y:ae}=a.current.element.getBoundingClientRect(),he={left:O,top:H,width:q,height:Z,bottom:J,right:re,x:se,y:ae};a.current.element instanceof HTMLElement&&s&&(he.height=a.current.element.offsetHeight,he.width=a.current.element.offsetWidth),Object.freeze(he),m.current&&!oTe(a.current.lastBounds,he)&&c(a.current.lastBounds=he)};return[L,f?iX(L,f):L,d?iX(L,d):L]},[c,s,d,f]);function I(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(L=>L.removeEventListener("scroll",A,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null)}function E(){a.current.element&&(a.current.resizeObserver=new o(A),a.current.resizeObserver.observe(a.current.element),t&&a.current.scrollContainers&&a.current.scrollContainers.forEach(L=>L.addEventListener("scroll",A,{capture:!0,passive:!0})))}const C=L=>{!L||L===a.current.element||(I(),a.current.element=L,a.current.scrollContainers=_ie(L),E())};return iTe(A,!!t),rTe(x),_e.useEffect(()=>{I(),E()},[t,A,x]),_e.useEffect(()=>I,[]),[C,l,_]}function rTe(n){_e.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function iTe(n,e){_e.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function _ie(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:s}=window.getComputedStyle(n);return[t,r,s].some(o=>o==="auto"||o==="scroll")&&e.push(n),[...e,..._ie(n.parentElement)]}const sTe=["x","y","top","bottom","left","right","width","height"],oTe=(n,e)=>sTe.every(t=>n[t]===e[t]);var aTe=Object.defineProperty,lTe=Object.defineProperties,cTe=Object.getOwnPropertyDescriptors,sX=Object.getOwnPropertySymbols,uTe=Object.prototype.hasOwnProperty,hTe=Object.prototype.propertyIsEnumerable,oX=(n,e,t)=>e in n?aTe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,aX=(n,e)=>{for(var t in e||(e={}))uTe.call(e,t)&&oX(n,t,e[t]);if(sX)for(var t of sX(e))hTe.call(e,t)&&oX(n,t,e[t]);return n},dTe=(n,e)=>lTe(n,cTe(e));function yie(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const s=yie(r,e,t);if(s)return s;r=r.sibling}}function xie(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const tG=xie(_e.createContext(null));class bie extends _e.Component{render(){return _e.createElement(tG.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:lX,ReactCurrentDispatcher:cX}=_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function fTe(){const n=_e.useContext(tG);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=_e.useId();return _e.useMemo(()=>{for(const r of[lX==null?void 0:lX.current,n,n==null?void 0:n.alternate]){if(!r)continue;const s=yie(r,!1,o=>{let l=o.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(s)return s}},[n,e])}function pTe(){var n,e;const t=fTe(),[r]=_e.useState(()=>new Map);r.clear();let s=t;for(;s;){const o=(n=s.type)==null?void 0:n._context;o&&o!==tG&&!r.has(o)&&r.set(o,(e=cX==null?void 0:cX.current)==null?void 0:e.readContext(xie(o))),s=s.return}return r}function mTe(){const n=pTe();return _e.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>_e.createElement(e,null,_e.createElement(t.Provider,dTe(aX({},r),{value:n.get(t)}))),e=>_e.createElement(bie,aX({},e))),[n])}const zF={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function gTe(n){const{handlePointer:e}=jAe(n);return{priority:1,enabled:!0,compute(t,r,s){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(zF).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:s}=n.getState();(t=s.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{var r;const{set:s,events:o}=n.getState();o.disconnect==null||o.disconnect(),s(l=>({events:{...l.events,connected:t}})),Object.entries((r=o.handlers)!=null?r:[]).forEach(([l,c])=>{const[a,d]=zF[l];t.addEventListener(a,c,{passive:d})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var s;Object.entries((s=r.handlers)!=null?s:[]).forEach(([o,l])=>{if(r&&r.connected instanceof HTMLElement){const[c]=zF[o];r.connected.removeEventListener(c,l)}}),t(o=>({events:{...o.events,connected:void 0}}))}}}}const vTe=_e.forwardRef(function({children:e,fallback:t,resize:r,style:s,gl:o,events:l=gTe,eventSource:c,eventPrefix:a,shadows:d,linear:f,flat:m,legacy:_,orthographic:x,frameloop:A,dpr:I,performance:E,raycaster:C,camera:L,scene:O,onPointerMissed:H,onCreated:q,...Z},J){_e.useMemo(()=>DAe(Zre),[]);const re=mTe(),[se,ae]=nTe({scroll:!0,debounce:{scroll:50,resize:0},...r}),he=_e.useRef(null),Ae=_e.useRef(null);_e.useImperativeHandle(J,()=>he.current);const Ee=sie(H),[Pe,ze]=_e.useState(!1),[Re,rt]=_e.useState(!1);if(Pe)throw Pe;if(Re)throw Re;const ye=_e.useRef(null);TC(()=>{const Ue=he.current;ae.width>0&&ae.height>0&&Ue&&(ye.current||(ye.current=QAe(Ue)),ye.current.configure({gl:o,events:l,shadows:d,linear:f,flat:m,legacy:_,orthographic:x,frameloop:A,dpr:I,performance:E,raycaster:C,camera:L,scene:O,size:ae,onPointerMissed:(...gt)=>Ee.current==null?void 0:Ee.current(...gt),onCreated:gt=>{gt.events.connect==null||gt.events.connect(c?kAe(c)?c.current:c:Ae.current),a&&gt.setEvents({compute:(vt,Dt)=>{const lt=vt[a+"X"],jt=vt[a+"Y"];Dt.pointer.set(lt/Dt.size.width*2-1,-(jt/Dt.size.height)*2+1),Dt.raycaster.setFromCamera(Dt.pointer,Dt.camera)}}),q==null||q(gt)}}),ye.current.render(_e.createElement(re,null,_e.createElement(oie,{set:rt},_e.createElement(_e.Suspense,{fallback:_e.createElement(OAe,{set:ze})},e)))))}),_e.useEffect(()=>{const Ue=he.current;if(Ue)return()=>vie(Ue)},[]);const We=c?"none":"auto";return _e.createElement("div",hM({ref:Ae,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:We,...s}},Z),_e.createElement("div",{ref:se,style:{width:"100%",height:"100%"}},_e.createElement("canvas",{ref:he,style:{display:"block"}},t)))}),wie=_e.forwardRef(function(e,t){return _e.createElement(bie,null,_e.createElement(vTe,hM({},e,{ref:t})))}),EC=new Ze,nG=new Ze,_Te=new Ze,uX=new sn;function yTe(n,e,t){const r=EC.setFromMatrixPosition(n.matrixWorld);r.project(e);const s=t.width/2,o=t.height/2;return[r.x*s+s,-(r.y*o)+o]}function xTe(n,e){const t=EC.setFromMatrixPosition(n.matrixWorld),r=nG.setFromMatrixPosition(e.matrixWorld),s=t.sub(r),o=e.getWorldDirection(_Te);return s.angleTo(o)>Math.PI/2}function bTe(n,e,t,r){const s=EC.setFromMatrixPosition(n.matrixWorld),o=s.clone();o.project(e),uX.set(o.x,o.y),t.setFromCamera(uX,e);const l=t.intersectObjects(r,!0);if(l.length){const c=l[0].distance;return s.distanceTo(t.ray.origin)<c}return!0}function wTe(n,e){if(e instanceof af)return e.zoom;if(e instanceof is){const t=EC.setFromMatrixPosition(n.matrixWorld),r=nG.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,o=t.distanceTo(r);return 1/(2*Math.tan(s/2)*o)}else return 1}function STe(n,e,t){if(e instanceof is||e instanceof af){const r=EC.setFromMatrixPosition(n.matrixWorld),s=nG.setFromMatrixPosition(e.matrixWorld),o=r.distanceTo(s),l=(t[1]-t[0])/(e.far-e.near),c=t[1]-l*e.far;return Math.round(l*o+c)}}const vz=n=>Math.abs(n)<1e-10?0:n;function Sie(n,e,t=""){let r="matrix3d(";for(let s=0;s!==16;s++)r+=vz(e[s]*n.elements[s])+(s!==15?",":")");return t+r}const ATe=(n=>e=>Sie(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),TTe=(n=>(e,t)=>Sie(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function MTe(n){return n&&typeof n=="object"&&"current"in n}const CTe=_e.forwardRef(({children:n,eps:e=.001,style:t,className:r,prepend:s,center:o,fullscreen:l,portal:c,distanceFactor:a,sprite:d=!1,transform:f=!1,occlude:m,onOcclude:_,castShadow:x,receiveShadow:A,material:I,geometry:E,zIndexRange:C=[16777271,0],calculatePosition:L=yTe,as:O="div",wrapperClass:H,pointerEvents:q="auto",...Z},J)=>{const{gl:re,camera:se,scene:ae,size:he,raycaster:Ae,events:Ee,viewport:Pe}=mie(),[ze]=_e.useState(()=>document.createElement(O)),Re=_e.useRef(),rt=_e.useRef(null),ye=_e.useRef(0),We=_e.useRef([0,0]),Ue=_e.useRef(null),gt=_e.useRef(null),vt=(c==null?void 0:c.current)||Ee.connected||re.domElement.parentNode,Dt=_e.useRef(null),lt=_e.useRef(!1),jt=_e.useMemo(()=>m&&m!=="blending"||Array.isArray(m)&&m.length&&MTe(m[0]),[m]);_e.useLayoutEffect(()=>{const Mn=re.domElement;m&&m==="blending"?(Mn.style.zIndex=`${Math.floor(C[0]/2)}`,Mn.style.position="absolute",Mn.style.pointerEvents="none"):(Mn.style.zIndex=null,Mn.style.position=null,Mn.style.pointerEvents=null)},[m]),_e.useLayoutEffect(()=>{if(rt.current){const Mn=Re.current=Ute(ze);if(ae.updateMatrixWorld(),f)ze.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const De=L(rt.current,se,he);ze.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${De[0]}px,${De[1]}px,0);transform-origin:0 0;`}return vt&&(s?vt.prepend(ze):vt.appendChild(ze)),()=>{vt&&vt.removeChild(ze),Mn.unmount()}}},[vt,f]),_e.useLayoutEffect(()=>{H&&(ze.className=H)},[H]);const Qt=_e.useMemo(()=>f?{position:"absolute",top:0,left:0,width:he.width,height:he.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...l&&{top:-he.height/2,left:-he.width/2,width:he.width,height:he.height},...t},[t,o,l,he,f]),nn=_e.useMemo(()=>({position:"absolute",pointerEvents:q}),[q]);_e.useLayoutEffect(()=>{if(lt.current=!1,f){var Mn;(Mn=Re.current)==null||Mn.render(_e.createElement("div",{ref:Ue,style:Qt},_e.createElement("div",{ref:gt,style:nn},_e.createElement("div",{ref:J,className:r,style:t,children:n}))))}else{var De;(De=Re.current)==null||De.render(_e.createElement("div",{ref:J,style:Qt,className:r,children:n}))}});const Wn=_e.useRef(!0);MC(Mn=>{if(rt.current){se.updateMatrixWorld(),rt.current.updateWorldMatrix(!0,!1);const De=f?We.current:L(rt.current,se,he);if(f||Math.abs(ye.current-se.zoom)>e||Math.abs(We.current[0]-De[0])>e||Math.abs(We.current[1]-De[1])>e){const Ye=xTe(rt.current,se);let gn=!1;jt&&(Array.isArray(m)?gn=m.map(On=>On.current):m!=="blending"&&(gn=[ae]));const un=Wn.current;if(gn){const On=bTe(rt.current,se,Ae,gn);Wn.current=On&&!Ye}else Wn.current=!Ye;un!==Wn.current&&(_?_(!Wn.current):ze.style.display=Wn.current?"block":"none");const At=Math.floor(C[0]/2),en=m?jt?[C[0],At]:[At-1,0]:C;if(ze.style.zIndex=`${STe(rt.current,se,en)}`,f){const[On,Vn]=[he.width/2,he.height/2],on=se.projectionMatrix.elements[5]*Vn,{isOrthographicCamera:ct,top:He,left:qt,bottom:Tn,right:An}=se,Wt=ATe(se.matrixWorldInverse),gr=ct?`scale(${on})translate(${vz(-(An+qt)/2)}px,${vz((He+Tn)/2)}px)`:`translateZ(${on}px)`;let Gn=rt.current.matrixWorld;d&&(Gn=se.matrixWorldInverse.clone().transpose().copyPosition(Gn).scale(rt.current.scale),Gn.elements[3]=Gn.elements[7]=Gn.elements[11]=0,Gn.elements[15]=1),ze.style.width=he.width+"px",ze.style.height=he.height+"px",ze.style.perspective=ct?"":`${on}px`,Ue.current&&gt.current&&(Ue.current.style.transform=`${gr}${Wt}translate(${On}px,${Vn}px)`,gt.current.style.transform=TTe(Gn,1/((a||10)/400)))}else{const On=a===void 0?1:wTe(rt.current,se)*a;ze.style.transform=`translate3d(${De[0]}px,${De[1]}px,0) scale(${On})`}We.current=De,ye.current=se.zoom}}if(!jt&&Dt.current&&!lt.current)if(f){if(Ue.current){const De=Ue.current.children[0];if(De!=null&&De.clientWidth&&De!=null&&De.clientHeight){const{isOrthographicCamera:Ye}=se;if(Ye||E)Z.scale&&(Array.isArray(Z.scale)?Z.scale instanceof Ze?Dt.current.scale.copy(Z.scale.clone().divideScalar(1)):Dt.current.scale.set(1/Z.scale[0],1/Z.scale[1],1/Z.scale[2]):Dt.current.scale.setScalar(1/Z.scale));else{const gn=(a||10)/400,un=De.clientWidth*gn,At=De.clientHeight*gn;Dt.current.scale.set(un,At,1)}lt.current=!0}}}else{const De=ze.children[0];if(De!=null&&De.clientWidth&&De!=null&&De.clientHeight){const Ye=1/Pe.factor,gn=De.clientWidth*Ye,un=De.clientHeight*Ye;Dt.current.scale.set(gn,un,1),lt.current=!0}Dt.current.lookAt(Mn.camera.position)}});const kn=_e.useMemo(()=>({vertexShader:f?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[f]);return _e.createElement("group",hM({},Z,{ref:rt}),m&&!jt&&_e.createElement("mesh",{castShadow:x,receiveShadow:A,ref:Dt},E||_e.createElement("planeGeometry",null),I||_e.createElement("shaderMaterial",{side:Mc,vertexShader:kn.vertexShader,fragmentShader:kn.fragmentShader})))});function hX(n,e){if(e===T6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===px||e===dC){let t=n.getIndex();if(t===null){const l=[],c=n.getAttribute("position");if(c!==void 0){for(let a=0;a<c.count;a++)l.push(a);n.setIndex(l),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,s=[];if(t)if(e===px)for(let l=1;l<=r;l++)s.push(t.getX(0)),s.push(t.getX(l)),s.push(t.getX(l+1));else for(let l=0;l<r;l++)l%2===0?(s.push(t.getX(l)),s.push(t.getX(l+1)),s.push(t.getX(l+2))):(s.push(t.getX(l+2)),s.push(t.getX(l+1)),s.push(t.getX(l)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const ETe=parseInt(aC.replace(/\D+/g,""));function ZR(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,r=n.length;t<r;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Fy="srgb",$m="srgb-linear",dX=3001,ITe=3e3;let rG=class extends La{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new BTe(t)}),this.register(function(t){return new kTe(t)}),this.register(function(t){return new jTe(t)}),this.register(function(t){return new WTe(t)}),this.register(function(t){return new $Te(t)}),this.register(function(t){return new FTe(t)}),this.register(function(t){return new NTe(t)}),this.register(function(t){return new zTe(t)}),this.register(function(t){return new UTe(t)}),this.register(function(t){return new DTe(t)}),this.register(function(t){return new GTe(t)}),this.register(function(t){return new OTe(t)}),this.register(function(t){return new HTe(t)}),this.register(function(t){return new VTe(t)}),this.register(function(t){return new RTe(t)}),this.register(function(t){return new XTe(t)}),this.register(function(t){return new qTe(t)})}load(e,t,r,s){const o=this;let l;if(this.resourcePath!=="")l=this.resourcePath;else if(this.path!==""){const d=gu.extractUrlBase(e);l=gu.resolveURL(d,this.path)}else l=gu.extractUrlBase(e);this.manager.itemStart(e);const c=function(d){s?s(d):console.error(d),o.manager.itemError(e),o.manager.itemEnd(e)},a=new Ya(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(d){try{o.parse(d,l,function(f){t(f),o.manager.itemEnd(e)},c)}catch(f){c(f)}},r,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,s){let o;const l={},c={};if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(ZR(new Uint8Array(e.slice(0,4)))===Aie){try{l[Wi.KHR_BINARY_GLTF]=new YTe(e)}catch(f){s&&s(f);return}o=JSON.parse(l[Wi.KHR_BINARY_GLTF].content)}else o=JSON.parse(ZR(new Uint8Array(e)));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const a=new lMe(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const f=this.pluginCallbacks[d](a);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[f.name]=f,l[f.name]=!0}if(o.extensionsUsed)for(let d=0;d<o.extensionsUsed.length;++d){const f=o.extensionsUsed[d],m=o.extensionsRequired||[];switch(f){case Wi.KHR_MATERIALS_UNLIT:l[f]=new LTe;break;case Wi.KHR_DRACO_MESH_COMPRESSION:l[f]=new ZTe(o,this.dracoLoader);break;case Wi.KHR_TEXTURE_TRANSFORM:l[f]=new KTe;break;case Wi.KHR_MESH_QUANTIZATION:l[f]=new JTe;break;default:m.indexOf(f)>=0&&c[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}a.setExtensions(l),a.setPlugins(c),a.parse(r,s)}parseAsync(e,t){const r=this;return new Promise(function(s,o){r.parse(e,t,s,o)})}};function PTe(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Wi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let RTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let s=t.cache.get(r);if(s)return s;const o=t.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let d;const f=new Hn(16777215);a.color!==void 0&&f.setRGB(a.color[0],a.color[1],a.color[2],$m);const m=a.range!==void 0?a.range:0;switch(a.type){case"directional":d=new H0(f),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new p0(f),d.distance=m;break;case"spot":d=new eB(f),d.distance=m,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,d.angle=a.spot.outerConeAngle,d.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return d.position.set(0,0,0),d.decay=2,Cm(d,a),a.intensity!==void 0&&(d.intensity=a.intensity),d.name=t.createUniqueName(a.name||"light_"+e),s=Promise.resolve(d),t.cache.add(r,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,o=r.json.nodes[e],c=(o.extensions&&o.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(a){return r._getNodeRef(t.cache,c,a)})}},LTe=class{constructor(){this.name=Wi.KHR_MATERIALS_UNLIT}getMaterialType(){return bo}extendParams(e,t,r){const s=[];e.color=new Hn(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const l=o.baseColorFactor;e.color.setRGB(l[0],l[1],l[2],$m),e.opacity=l[3]}o.baseColorTexture!==void 0&&s.push(r.assignTexture(e,"map",o.baseColorTexture,Fy))}return Promise.all(s)}},DTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}},BTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];if(l.clearcoatFactor!==void 0&&(t.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&o.push(r.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&o.push(r.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(o.push(r.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const c=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new sn(c,c)}return Promise.all(o)}},kTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}},OTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.iridescenceFactor!==void 0&&(t.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&o.push(r.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(t.iridescenceIOR=l.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&o.push(r.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(o)}},FTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new Hn(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=s.extensions[this.name];if(l.sheenColorFactor!==void 0){const c=l.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],$m)}return l.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&o.push(r.assignTexture(t,"sheenColorMap",l.sheenColorTexture,Fy)),l.sheenRoughnessTexture!==void 0&&o.push(r.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(o)}},NTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.transmissionFactor!==void 0&&(t.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&o.push(r.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(o)}},zTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];t.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&o.push(r.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const c=l.attenuationColor||[1,1,1];return t.attenuationColor=new Hn().setRGB(c[0],c[1],c[2],$m),Promise.all(o)}},UTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}},GTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];t.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&o.push(r.assignTexture(t,"specularIntensityMap",l.specularTexture));const c=l.specularColorFactor||[1,1,1];return t.specularColor=new Hn().setRGB(c[0],c[1],c[2],$m),l.specularColorTexture!==void 0&&o.push(r.assignTexture(t,"specularColorMap",l.specularColorTexture,Fy)),Promise.all(o)}},VTe=class{constructor(e){this.parser=e,this.name=Wi.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return t.bumpScale=l.bumpFactor!==void 0?l.bumpFactor:1,l.bumpTexture!==void 0&&o.push(r.assignTexture(t,"bumpMap",l.bumpTexture)),Promise.all(o)}},HTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.anisotropyStrength!==void 0&&(t.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(t.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&o.push(r.assignTexture(t,"anisotropyMap",l.anisotropyTexture)),Promise.all(o)}},jTe=class{constructor(e){this.parser=e,this.name=Wi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const o=s.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,l)}},WTe=class{constructor(e){this.parser=e,this.name=Wi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,s=r.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=s.images[l.source];let a=r.textureLoader;if(c.uri){const d=r.options.manager.getHandler(c.uri);d!==null&&(a=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,l.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},$Te=class{constructor(e){this.parser=e,this.name=Wi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,s=r.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=s.images[l.source];let a=r.textureLoader;if(c.uri){const d=r.options.manager.getHandler(c.uri);d!==null&&(a=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,l.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},XTe=class{constructor(e){this.name=Wi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const s=r.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(c){const a=s.byteOffset||0,d=s.byteLength||0,f=s.count,m=s.byteStride,_=new Uint8Array(c,a,d);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,m,_,s.mode,s.filter).then(function(x){return x.buffer}):l.ready.then(function(){const x=new ArrayBuffer(f*m);return l.decodeGltfBuffer(new Uint8Array(x),f,m,_,s.mode,s.filter),x})})}else return null}},qTe=class{constructor(e){this.name=Wi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const s=t.meshes[r.mesh];for(const d of s.primitives)if(d.mode!==_h.TRIANGLES&&d.mode!==_h.TRIANGLE_STRIP&&d.mode!==_h.TRIANGLE_FAN&&d.mode!==void 0)return null;const l=r.extensions[this.name].attributes,c=[],a={};for(const d in l)c.push(this.parser.getDependency("accessor",l[d]).then(f=>(a[d]=f,a[d])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(d=>{const f=d.pop(),m=f.isGroup?f.children:[f],_=d[0].count,x=[];for(const A of m){const I=new Hr,E=new Ze,C=new Ea,L=new Ze(1,1,1),O=new zD(A.geometry,A.material,_);for(let H=0;H<_;H++)a.TRANSLATION&&E.fromBufferAttribute(a.TRANSLATION,H),a.ROTATION&&C.fromBufferAttribute(a.ROTATION,H),a.SCALE&&L.fromBufferAttribute(a.SCALE,H),O.setMatrixAt(H,I.compose(E,C,L));for(const H in a)if(H==="_COLOR_0"){const q=a[H];O.instanceColor=new S0(q.array,q.itemSize,q.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&A.geometry.setAttribute(H,a[H]);Bi.prototype.copy.call(O,A),this.parser.assignFinalMaterial(O),x.push(O)}return f.isGroup?(f.clear(),f.add(...x),f):x[0]}))}};const Aie="glTF",sA=12,fX={JSON:1313821514,BIN:5130562};let YTe=class{constructor(e){this.name=Wi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,sA);if(this.header={magic:ZR(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Aie)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-sA,s=new DataView(e,sA);let o=0;for(;o<r;){const l=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);if(o+=4,c===fX.JSON){const a=new Uint8Array(e,sA+o,l);this.content=ZR(a)}else if(c===fX.BIN){const a=sA+o;this.body=e.slice(a,a+l)}o+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},ZTe=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Wi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},a={},d={};for(const f in l){const m=_z[f]||f.toLowerCase();c[m]=l[f]}for(const f in e.attributes){const m=_z[f]||f.toLowerCase();if(l[f]!==void 0){const _=r.accessors[e.attributes[f]],x=Zb[_.componentType];d[m]=x.name,a[m]=_.normalized===!0}}return t.getDependency("bufferView",o).then(function(f){return new Promise(function(m,_){s.decodeDracoFile(f,function(x){for(const A in x.attributes){const I=x.attributes[A],E=a[A];E!==void 0&&(I.normalized=E)}m(x)},c,d,$m,_)})})}},KTe=class{constructor(){this.name=Wi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},JTe=class{constructor(){this.name=Wi.KHR_MESH_QUANTIZATION}},Tie=class extends Dx{constructor(e,t,r,s){super(e,t,r,s)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let l=0;l!==s;l++)t[l]=r[o+l];return t}interpolate_(e,t,r,s){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,a=c*2,d=c*3,f=s-t,m=(r-t)/f,_=m*m,x=_*m,A=e*d,I=A-d,E=-2*x+3*_,C=x-_,L=1-E,O=C-_+m;for(let H=0;H!==c;H++){const q=l[I+H+c],Z=l[I+H+a]*f,J=l[A+H+c],re=l[A+H]*f;o[H]=L*q+O*Z+E*J+C*re}return o}};const QTe=new Ea;let eMe=class extends Tie{interpolate_(e,t,r,s){const o=super.interpolate_(e,t,r,s);return QTe.fromArray(o).normalize().toArray(o),o}};const _h={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Zb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},pX={9728:Ma,9729:Ro,9984:cC,9985:qy,9986:Jv,9987:hu},mX={33071:uu,33648:ux,10497:Gh},UF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_z={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...ETe>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Tv={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},tMe={CUBICSPLINE:void 0,LINEAR:w0,STEP:fx},GF={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function nMe(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new xp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Uh})),n.DefaultMaterial}function H_(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Cm(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function rMe(n,e,t){let r=!1,s=!1,o=!1;for(let d=0,f=e.length;d<f;d++){const m=e[d];if(m.POSITION!==void 0&&(r=!0),m.NORMAL!==void 0&&(s=!0),m.COLOR_0!==void 0&&(o=!0),r&&s&&o)break}if(!r&&!s&&!o)return Promise.resolve(n);const l=[],c=[],a=[];for(let d=0,f=e.length;d<f;d++){const m=e[d];if(r){const _=m.POSITION!==void 0?t.getDependency("accessor",m.POSITION):n.attributes.position;l.push(_)}if(s){const _=m.NORMAL!==void 0?t.getDependency("accessor",m.NORMAL):n.attributes.normal;c.push(_)}if(o){const _=m.COLOR_0!==void 0?t.getDependency("accessor",m.COLOR_0):n.attributes.color;a.push(_)}}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(a)]).then(function(d){const f=d[0],m=d[1],_=d[2];return r&&(n.morphAttributes.position=f),s&&(n.morphAttributes.normal=m),o&&(n.morphAttributes.color=_),n.morphTargetsRelative=!0,n})}function iMe(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,s=t.length;r<s;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function sMe(n){let e;const t=n.extensions&&n.extensions[Wi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+VF(t.attributes):e=n.indices+":"+VF(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,s=n.targets.length;r<s;r++)e+=":"+VF(n.targets[r]);return e}function VF(n){let e="";const t=Object.keys(n).sort();for(let r=0,s=t.length;r<s;r++)e+=t[r]+":"+n[t[r]]+";";return e}function yz(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function oMe(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const aMe=new Hr;let lMe=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new PTe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=!1,o=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,o=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||s&&o<98?this.textureLoader=new rf(this.options.manager):this.textureLoader=new Y6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ya(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(l){const c={scene:l[0][s.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:s.asset,parser:r,userData:{}};return H_(o,c,s),Cm(c,s),Promise.all(r._invokeAll(function(a){return a.afterRoot&&a.afterRoot(c)})).then(function(){for(const a of c.scenes)a.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let s=0,o=t.length;s<o;s++){const l=t[s].joints;for(let c=0,a=l.length;c<a;c++)e[l[c]].isBone=!0}for(let s=0,o=e.length;s<o;s++){const l=e[s];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(r[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const s=r.clone(),o=(l,c)=>{const a=this.associations.get(l);a!=null&&this.associations.set(c,a);for(const[d,f]of l.children.entries())o(f,c.children[d])};return o(r,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const s=e(t[r]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let s=0;s<t.length;s++){const o=e(t[s]);o&&r.push(o)}return r}getDependency(e,t){const r=e+":"+t;let s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(r,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(o,l){return r.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Wi.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(o,l){r.load(gu.resolveURL(t.uri,s.path),o,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const s=t.byteLength||0,o=t.byteOffset||0;return r.slice(o,o+s)})}loadAccessor(e){const t=this,r=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const l=UF[s.type],c=Zb[s.componentType],a=s.normalized===!0,d=new c(s.count*l);return Promise.resolve(new Ni(d,l,a))}const o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(l){const c=l[0],a=UF[s.type],d=Zb[s.componentType],f=d.BYTES_PER_ELEMENT,m=f*a,_=s.byteOffset||0,x=s.bufferView!==void 0?r.bufferViews[s.bufferView].byteStride:void 0,A=s.normalized===!0;let I,E;if(x&&x!==m){const C=Math.floor(_/x),L="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+C+":"+s.count;let O=t.cache.get(L);O||(I=new d(c,C*x,s.count*x/f),O=new Uw(I,x/f),t.cache.add(L,O)),E=new ng(O,a,_%x/f,A)}else c===null?I=new d(s.count*a):I=new d(c,_,s.count*a),E=new Ni(I,a,A);if(s.sparse!==void 0){const C=UF.SCALAR,L=Zb[s.sparse.indices.componentType],O=s.sparse.indices.byteOffset||0,H=s.sparse.values.byteOffset||0,q=new L(l[1],O,s.sparse.count*C),Z=new d(l[2],H,s.sparse.count*a);c!==null&&(E=new Ni(E.array.slice(),E.itemSize,E.normalized));for(let J=0,re=q.length;J<re;J++){const se=q[J];if(E.setX(se,Z[J*a]),a>=2&&E.setY(se,Z[J*a+1]),a>=3&&E.setZ(se,Z[J*a+2]),a>=4&&E.setW(se,Z[J*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(e){const t=this.json,r=this.options,o=t.textures[e].source,l=t.images[o];let c=this.textureLoader;if(l.uri){const a=r.manager.getHandler(l.uri);a!==null&&(c=a)}return this.loadTextureImage(e,o,c)}loadTextureImage(e,t,r){const s=this,o=this.json,l=o.textures[e],c=o.images[t],a=(c.uri||c.bufferView)+":"+l.sampler;if(this.textureCache[a])return this.textureCache[a];const d=this.loadImageSource(t,r).then(function(f){f.flipY=!1,f.name=l.name||c.name||"",f.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(f.name=c.uri);const _=(o.samplers||{})[l.sampler]||{};return f.magFilter=pX[_.magFilter]||Ro,f.minFilter=pX[_.minFilter]||hu,f.wrapS=mX[_.wrapS]||Gh,f.wrapT=mX[_.wrapT]||Gh,s.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[a]=d,d}loadImageSource(e,t){const r=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(m=>m.clone());const l=s.images[e],c=self.URL||self.webkitURL;let a=l.uri||"",d=!1;if(l.bufferView!==void 0)a=r.getDependency("bufferView",l.bufferView).then(function(m){d=!0;const _=new Blob([m],{type:l.mimeType});return a=c.createObjectURL(_),a});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(a).then(function(m){return new Promise(function(_,x){let A=_;t.isImageBitmapLoader===!0&&(A=function(I){const E=new Ys(I);E.needsUpdate=!0,_(E)}),t.load(gu.resolveURL(m,o.path),A,void 0,x)})}).then(function(m){return d===!0&&c.revokeObjectURL(a),Cm(m,l),m.userData.mimeType=l.mimeType||oMe(l.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),m});return this.sourceCache[e]=f,f}assignTexture(e,t,r,s){const o=this;return this.getDependency("texture",r.index).then(function(l){if(!l)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(l=l.clone(),l.channel=r.texCoord),o.extensions[Wi.KHR_TEXTURE_TRANSFORM]){const c=r.extensions!==void 0?r.extensions[Wi.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const a=o.associations.get(l);l=o.extensions[Wi.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),o.associations.set(l,a)}}return s!==void 0&&(typeof s=="number"&&(s=s===dX?Fy:$m),"colorSpace"in l?l.colorSpace=s:l.encoding=s===Fy?dX:ITe),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const s=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,l=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+r.uuid;let a=this.cache.get(c);a||(a=new du,wo.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,a.sizeAttenuation=!1,this.cache.add(c,a)),r=a}else if(e.isLine){const c="LineBasicMaterial:"+r.uuid;let a=this.cache.get(c);a||(a=new Ia,wo.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,this.cache.add(c,a)),r=a}if(s||o||l){let c="ClonedMaterial:"+r.uuid+":";s&&(c+="derivative-tangents:"),o&&(c+="vertex-colors:"),l&&(c+="flat-shading:");let a=this.cache.get(c);a||(a=r.clone(),o&&(a.vertexColors=!0),l&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(c,a),this.associations.set(a,this.associations.get(r))),r=a}e.material=r}getMaterialType(){return xp}loadMaterial(e){const t=this,r=this.json,s=this.extensions,o=r.materials[e];let l;const c={},a=o.extensions||{},d=[];if(a[Wi.KHR_MATERIALS_UNLIT]){const m=s[Wi.KHR_MATERIALS_UNLIT];l=m.getMaterialType(),d.push(m.extendParams(c,o,t))}else{const m=o.pbrMetallicRoughness||{};if(c.color=new Hn(1,1,1),c.opacity=1,Array.isArray(m.baseColorFactor)){const _=m.baseColorFactor;c.color.setRGB(_[0],_[1],_[2],$m),c.opacity=_[3]}m.baseColorTexture!==void 0&&d.push(t.assignTexture(c,"map",m.baseColorTexture,Fy)),c.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,c.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(d.push(t.assignTexture(c,"metalnessMap",m.metallicRoughnessTexture)),d.push(t.assignTexture(c,"roughnessMap",m.metallicRoughnessTexture))),l=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,c)})))}o.doubleSided===!0&&(c.side=Mc);const f=o.alphaMode||GF.OPAQUE;if(f===GF.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,f===GF.MASK&&(c.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&l!==bo&&(d.push(t.assignTexture(c,"normalMap",o.normalTexture)),c.normalScale=new sn(1,1),o.normalTexture.scale!==void 0)){const m=o.normalTexture.scale;c.normalScale.set(m,m)}if(o.occlusionTexture!==void 0&&l!==bo&&(d.push(t.assignTexture(c,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&l!==bo){const m=o.emissiveFactor;c.emissive=new Hn().setRGB(m[0],m[1],m[2],$m)}return o.emissiveTexture!==void 0&&l!==bo&&d.push(t.assignTexture(c,"emissiveMap",o.emissiveTexture,Fy)),Promise.all(d).then(function(){const m=new l(c);return o.name&&(m.name=o.name),Cm(m,o),t.associations.set(m,{materials:e}),o.extensions&&H_(s,m,o),m})}createUniqueName(e){const t=rs.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,s=this.primitiveCache;function o(c){return r[Wi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(a){return gX(a,c,t)})}const l=[];for(let c=0,a=e.length;c<a;c++){const d=e[c],f=sMe(d),m=s[f];if(m)l.push(m.promise);else{let _;d.extensions&&d.extensions[Wi.KHR_DRACO_MESH_COMPRESSION]?_=o(d):_=gX(new Yr,d,t),s[f]={primitive:d,promise:_},l.push(_)}}return Promise.all(l)}loadMesh(e){const t=this,r=this.json,s=this.extensions,o=r.meshes[e],l=o.primitives,c=[];for(let a=0,d=l.length;a<d;a++){const f=l[a].material===void 0?nMe(this.cache):this.getDependency("material",l[a].material);c.push(f)}return c.push(t.loadGeometries(l)),Promise.all(c).then(function(a){const d=a.slice(0,a.length-1),f=a[a.length-1],m=[];for(let x=0,A=f.length;x<A;x++){const I=f[x],E=l[x];let C;const L=d[x];if(E.mode===_h.TRIANGLES||E.mode===_h.TRIANGLE_STRIP||E.mode===_h.TRIANGLE_FAN||E.mode===void 0)C=o.isSkinnedMesh===!0?new ND(I,L):new Di(I,L),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),E.mode===_h.TRIANGLE_STRIP?C.geometry=hX(C.geometry,dC):E.mode===_h.TRIANGLE_FAN&&(C.geometry=hX(C.geometry,px));else if(E.mode===_h.LINES)C=new vu(I,L);else if(E.mode===_h.LINE_STRIP)C=new nf(I,L);else if(E.mode===_h.LINE_LOOP)C=new UD(I,L);else if(E.mode===_h.POINTS)C=new Rh(I,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(C.geometry.morphAttributes).length>0&&iMe(C,o),C.name=t.createUniqueName(o.name||"mesh_"+e),Cm(C,o),E.extensions&&H_(s,C,E),t.assignFinalMaterial(C),m.push(C)}for(let x=0,A=m.length;x<A;x++)t.associations.set(m[x],{meshes:e,primitives:x});if(m.length===1)return o.extensions&&H_(s,m[0],o),m[0];const _=new Kl;o.extensions&&H_(s,_,o),t.associations.set(_,{meshes:e});for(let x=0,A=m.length;x<A;x++)_.add(m[x]);return _})}loadCamera(e){let t;const r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new is(so.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):r.type==="orthographic"&&(t=new af(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Cm(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let s=0,o=t.joints.length;s<o;s++)r.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(s){const o=s.pop(),l=s,c=[],a=[];for(let d=0,f=l.length;d<f;d++){const m=l[d];if(m){c.push(m);const _=new Hr;o!==null&&_.fromArray(o.array,d*16),a.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new Gw(c,a)})}loadAnimation(e){const t=this.json,r=this,s=t.animations[e],o=s.name?s.name:"animation_"+e,l=[],c=[],a=[],d=[],f=[];for(let m=0,_=s.channels.length;m<_;m++){const x=s.channels[m],A=s.samplers[x.sampler],I=x.target,E=I.node,C=s.parameters!==void 0?s.parameters[A.input]:A.input,L=s.parameters!==void 0?s.parameters[A.output]:A.output;I.node!==void 0&&(l.push(this.getDependency("node",E)),c.push(this.getDependency("accessor",C)),a.push(this.getDependency("accessor",L)),d.push(A),f.push(I))}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(a),Promise.all(d),Promise.all(f)]).then(function(m){const _=m[0],x=m[1],A=m[2],I=m[3],E=m[4],C=[];for(let L=0,O=_.length;L<O;L++){const H=_[L],q=x[L],Z=A[L],J=I[L],re=E[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const se=r._createAnimationTracks(H,q,Z,J,re);if(se)for(let ae=0;ae<se.length;ae++)C.push(se[ae])}return new vx(o,void 0,C)})}createNodeMesh(e){const t=this.json,r=this,s=t.nodes[e];return s.mesh===void 0?null:r.getDependency("mesh",s.mesh).then(function(o){const l=r._getNodeRef(r.meshCache,s.mesh,o);return s.weights!==void 0&&l.traverse(function(c){if(c.isMesh)for(let a=0,d=s.weights.length;a<d;a++)c.morphTargetInfluences[a]=s.weights[a]}),l})}loadNode(e){const t=this.json,r=this,s=t.nodes[e],o=r._loadNodeShallow(e),l=[],c=s.children||[];for(let d=0,f=c.length;d<f;d++)l.push(r.getDependency("node",c[d]));const a=s.skin===void 0?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([o,Promise.all(l),a]).then(function(d){const f=d[0],m=d[1],_=d[2];_!==null&&f.traverse(function(x){x.isSkinnedMesh&&x.bind(_,aMe)});for(let x=0,A=m.length;x<A;x++)f.add(m[x]);return f})}_loadNodeShallow(e){const t=this.json,r=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=t.nodes[e],l=o.name?s.createUniqueName(o.name):"",c=[],a=s._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return a&&c.push(a),o.camera!==void 0&&c.push(s.getDependency("camera",o.camera).then(function(d){return s._getNodeRef(s.cameraCache,o.camera,d)})),s._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){c.push(d)}),this.nodeCache[e]=Promise.all(c).then(function(d){let f;if(o.isBone===!0?f=new _C:d.length>1?f=new Kl:d.length===1?f=d[0]:f=new Bi,f!==d[0])for(let m=0,_=d.length;m<_;m++)f.add(d[m]);if(o.name&&(f.userData.name=o.name,f.name=l),Cm(f,o),o.extensions&&H_(r,f,o),o.matrix!==void 0){const m=new Hr;m.fromArray(o.matrix),f.applyMatrix4(m)}else o.translation!==void 0&&f.position.fromArray(o.translation),o.rotation!==void 0&&f.quaternion.fromArray(o.rotation),o.scale!==void 0&&f.scale.fromArray(o.scale);return s.associations.has(f)||s.associations.set(f,{}),s.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],s=this,o=new Kl;r.name&&(o.name=s.createUniqueName(r.name)),Cm(o,r),r.extensions&&H_(t,o,r);const l=r.nodes||[],c=[];for(let a=0,d=l.length;a<d;a++)c.push(s.getDependency("node",l[a]));return Promise.all(c).then(function(a){for(let f=0,m=a.length;f<m;f++)o.add(a[f]);const d=f=>{const m=new Map;for(const[_,x]of s.associations)(_ instanceof wo||_ instanceof Ys)&&m.set(_,x);return f.traverse(_=>{const x=s.associations.get(_);x!=null&&m.set(_,x)}),m};return s.associations=d(o),o})}_createAnimationTracks(e,t,r,s,o){const l=[],c=e.name?e.name:e.uuid,a=[];Tv[o.path]===Tv.weights?e.traverse(function(_){_.morphTargetInfluences&&a.push(_.name?_.name:_.uuid)}):a.push(c);let d;switch(Tv[o.path]){case Tv.weights:d=rg;break;case Tv.rotation:d=ig;break;case Tv.position:case Tv.scale:d=sg;break;default:switch(r.itemSize){case 1:d=rg;break;case 2:case 3:default:d=sg;break}break}const f=s.interpolation!==void 0?tMe[s.interpolation]:w0,m=this._getArrayFromAccessor(r);for(let _=0,x=a.length;_<x;_++){const A=new d(a[_]+"."+Tv[o.path],t.array,m,f);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(A),l.push(A)}return l}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=yz(t.constructor),s=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o++)s[o]=t[o]*r;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const s=this instanceof ig?eMe:Tie;return new s(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function cMe(n,e,t){const r=e.attributes,s=new Cl;if(r.POSITION!==void 0){const c=t.json.accessors[r.POSITION],a=c.min,d=c.max;if(a!==void 0&&d!==void 0){if(s.set(new Ze(a[0],a[1],a[2]),new Ze(d[0],d[1],d[2])),c.normalized){const f=yz(Zb[c.componentType]);s.min.multiplyScalar(f),s.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const c=new Ze,a=new Ze;for(let d=0,f=o.length;d<f;d++){const m=o[d];if(m.POSITION!==void 0){const _=t.json.accessors[m.POSITION],x=_.min,A=_.max;if(x!==void 0&&A!==void 0){if(a.setX(Math.max(Math.abs(x[0]),Math.abs(A[0]))),a.setY(Math.max(Math.abs(x[1]),Math.abs(A[1]))),a.setZ(Math.max(Math.abs(x[2]),Math.abs(A[2]))),_.normalized){const I=yz(Zb[_.componentType]);a.multiplyScalar(I)}c.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}n.boundingBox=s;const l=new al;s.getCenter(l.center),l.radius=s.min.distanceTo(s.max)/2,n.boundingSphere=l}function gX(n,e,t){const r=e.attributes,s=[];function o(l,c){return t.getDependency("accessor",l).then(function(a){n.setAttribute(c,a)})}for(const l in r){const c=_z[l]||l.toLowerCase();c in n.attributes||s.push(o(r[l],c))}if(e.indices!==void 0&&!n.index){const l=t.getDependency("accessor",e.indices).then(function(c){n.setIndex(c)});s.push(l)}return Cm(n,e),cMe(n,e,t),Promise.all(s).then(function(){return e.targets!==void 0?rMe(n,e.targets,t):n})}const HF=new WeakMap;let uMe=class extends La{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,s){const o=new Ya(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,l=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(l,c).then(t).catch(s)},r,s)}decodeDracoFile(e,t,r,s){const o={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,o).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const d=t.attributeTypes[a];d.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[a]=d.name)}const r=JSON.stringify(t);if(HF.has(e)){const a=HF.get(e);if(a.key===r)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const o=this.workerNextTaskID++,l=e.byteLength,c=this._getWorker(o,l).then(a=>(s=a,new Promise((d,f)=>{s._callbacks[o]={resolve:d,reject:f},s.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return c.catch(()=>!0).then(()=>{s&&o&&this._releaseTask(s,o)}),HF.set(e,{key:r,promise:c}),c}_createGeometry(e){const t=new Yr;e.index&&t.setIndex(new Ni(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const s=e.attributes[r],o=s.name,l=s.array,c=s.itemSize;t.setAttribute(o,new Ni(l,c))}return t}_loadLibrary(e,t){const r=new Ya(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((s,o)=>{r.load(e,s,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const s=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const o=hMe.toString(),l=["/* draco decoder */",s,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(o){const l=o.data;switch(l.type){case"decode":s._callbacks[l.id].resolve(l);break;case"error":s._callbacks[l.id].reject(l);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+l.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,o){return s._taskLoad>o._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function hMe(){let n,e;onmessage=function(l){const c=l.data;switch(c.type){case"init":n=c.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(m){f({draco:m})},DracoDecoderModule(n)});break;case"decode":const a=c.buffer,d=c.taskConfig;e.then(f=>{const m=f.draco,_=new m.Decoder,x=new m.DecoderBuffer;x.Init(new Int8Array(a),a.byteLength);try{const A=t(m,_,x,d),I=A.attributes.map(E=>E.array.buffer);A.index&&I.push(A.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:A},I)}catch(A){console.error(A),self.postMessage({type:"error",id:c.id,error:A.message})}finally{m.destroy(x),m.destroy(_)}});break}};function t(l,c,a,d){const f=d.attributeIDs,m=d.attributeTypes;let _,x;const A=c.GetEncodedGeometryType(a);if(A===l.TRIANGULAR_MESH)_=new l.Mesh,x=c.DecodeBufferToMesh(a,_);else if(A===l.POINT_CLOUD)_=new l.PointCloud,x=c.DecodeBufferToPointCloud(a,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!x.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+x.error_msg());const I={index:null,attributes:[]};for(const E in f){const C=self[m[E]];let L,O;if(d.useUniqueIDs)O=f[E],L=c.GetAttributeByUniqueId(_,O);else{if(O=c.GetAttributeId(_,l[f[E]]),O===-1)continue;L=c.GetAttribute(_,O)}I.attributes.push(s(l,c,_,E,C,L))}return A===l.TRIANGULAR_MESH&&(I.index=r(l,c,_)),l.destroy(_),I}function r(l,c,a){const f=a.num_faces()*3,m=f*4,_=l._malloc(m);c.GetTrianglesUInt32Array(a,m,_);const x=new Uint32Array(l.HEAPF32.buffer,_,f).slice();return l._free(_),{array:x,itemSize:1}}function s(l,c,a,d,f,m){const _=m.num_components(),A=a.num_points()*_,I=A*f.BYTES_PER_ELEMENT,E=o(l,f),C=l._malloc(I);c.GetAttributeDataArrayForAllPoints(a,m,E,I,C);const L=new f(l.HEAPF32.buffer,C,A).slice();return l._free(C),{name:d,array:L,itemSize:_}}function o(l,c){switch(c){case Float32Array:return l.DT_FLOAT32;case Int8Array:return l.DT_INT8;case Int16Array:return l.DT_INT16;case Int32Array:return l.DT_INT32;case Uint8Array:return l.DT_UINT8;case Uint16Array:return l.DT_UINT16;case Uint32Array:return l.DT_UINT32}}}let q2;const jF=()=>{if(q2)return q2;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=n;WebAssembly.validate(t)&&(s=e);let o;const l=WebAssembly.instantiate(c(s),{}).then(m=>{o=m.instance,o.exports.__wasm_call_ctors()});function c(m){const _=new Uint8Array(m.length);for(let A=0;A<m.length;++A){const I=m.charCodeAt(A);_[A]=I>96?I-71:I>64?I-65:I>47?I+4:I>46?63:62}let x=0;for(let A=0;A<m.length;++A)_[x++]=_[A]<60?r[_[A]]:(_[A]-60)*64+_[++A];return _.buffer.slice(0,x)}function a(m,_,x,A,I,E){const C=o.exports.sbrk,L=x+3&-4,O=C(L*A),H=C(I.length),q=new Uint8Array(o.exports.memory.buffer);q.set(I,H);const Z=m(O,x,A,H,I.length);if(Z===0&&E&&E(O,L,A),_.set(q.subarray(O,O+x*A)),C(O-C(0)),Z!==0)throw new Error(`Malformed buffer data: ${Z}`)}const d={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},f={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return q2={ready:l,supported:!0,decodeVertexBuffer(m,_,x,A,I){a(o.exports.meshopt_decodeVertexBuffer,m,_,x,A,o.exports[d[I]])},decodeIndexBuffer(m,_,x,A){a(o.exports.meshopt_decodeIndexBuffer,m,_,x,A)},decodeIndexSequence(m,_,x,A){a(o.exports.meshopt_decodeIndexSequence,m,_,x,A)},decodeGltfBuffer(m,_,x,A,I,E){a(o.exports[f[I]],m,_,x,A,o.exports[d[E]])}},q2};let Y2=null,Mie="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Cie(n,e,t){return r=>{t&&t(r),n&&(Y2||(Y2=new uMe),Y2.setDecoderPath(typeof n=="string"?n:Mie),r.setDRACOLoader(Y2)),e&&r.setMeshoptDecoder(typeof jF=="function"?jF():jF)}}function fg(n,e=!0,t=!0,r){return CC(rG,n,Cie(e,t,r))}fg.preload=(n,e=!0,t=!0,r)=>CC.preload(rG,n,Cie(e,t,r));fg.clear=n=>CC.clear(rG,n);fg.setDecoderPath=n=>{Mie=n};function iG(n,e){const t=_e.useRef(),[r]=_e.useState(()=>e?e instanceof Bi?{current:e}:e:t),[s]=_e.useState(()=>new qre(void 0));_e.useLayoutEffect(()=>{e&&(r.current=e instanceof Bi?e:e.current),s._root=r.current});const o=_e.useRef({}),l=_e.useMemo(()=>{const c={};return n.forEach(a=>Object.defineProperty(c,a.name,{enumerable:!0,get(){if(r.current)return o.current[a.name]||(o.current[a.name]=s.clipAction(a,r.current))},configurable:!0})),{ref:r,clips:n,actions:c,names:n.map(a=>a.name),mixer:s}},[n]);return MC((c,a)=>s.update(a)),_e.useEffect(()=>{const c=r.current;return()=>{o.current={},s.stopAllAction(),Object.values(l.actions).forEach(a=>{c&&s.uncacheAction(a,c)})}},[n]),l}var Eie={exports:{}},dMe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",fMe=dMe,pMe=fMe;function Iie(){}function Pie(){}Pie.resetWarningCache=Iie;var mMe=function(){function n(r,s,o,l,c,a){if(a!==pMe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Pie,resetWarningCache:Iie};return t.PropTypes=t,t};Eie.exports=mMe();var Rie=Eie.exports;const sG=()=>pe.jsx(CTe,{children:pe.jsx("div",{className:"flex justify-center items-center ",children:pe.jsx("div",{className:"w-20 h-20 border-4 border-opacity-20 border-blue-500 border-t-indigo-800 rounded-full animate-spin"})})}),gMe=()=>{const{t:n}=kw();return pe.jsxs("header",{className:"header",children:[pe.jsx(QE,{to:"/",className:"w-10 h-10 rounded-lg bg-white items-center justify-center flex font-bold shadow-md",children:pe.jsx("p",{className:"blue-gradient_text",children:"AH"})}),pe.jsxs("nav",{className:"flex text-xl gap-10 font-medium shadow-text",children:[pe.jsx(QE,{to:"/about",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("aboutMe.title")}),pe.jsx(QE,{to:"/projects",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("projects.title")}),pe.jsx(QE,{to:"/arts",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("gallery.title")})]})]})},Lie="data:image/svg+xml,%3csvg%20width='14'%20height='15'%20viewBox='0%200%2014%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.16602%207.49984H12.8327M12.8327%207.49984L6.99935%201.6665M12.8327%207.49984L6.99935%2013.3332'%20stroke='%23406AFF'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",vMe="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='%23E53F31'%20class='size-6'%3e%3cpath%20d='m11.645%2020.91-.007-.003-.022-.012a15.247%2015.247%200%200%201-.383-.218%2025.18%2025.18%200%200%201-4.244-3.17C4.688%2015.36%202.25%2012.174%202.25%208.25%202.25%205.322%204.714%203%207.688%203A5.5%205.5%200%200%201%2012%205.052%205.5%205.5%200%200%201%2016.313%203c2.973%200%205.437%202.322%205.437%205.25%200%203.925-2.438%207.111-4.739%209.256a25.175%2025.175%200%200%201-4.244%203.17%2015.247%2015.247%200%200%201-.383.219l-.022.012-.007.004-.003.001a.752.752%200%200%201-.704%200l-.003-.001Z'%20/%3e%3c/svg%3e",Die="data:image/svg+xml,%3csvg%20width='30'%20height='26'%20viewBox='0%200%2030%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.43398%200.519531C7.04842%200.519531%204.97388%202.15491%204.41692%204.47454L3.82415%206.94336C3.61485%207.81502%202.8353%208.42956%201.93886%208.42956H1.1432C0.511828%208.42956%200%208.94138%200%209.57276V10.1213C0%2010.4497%200.26624%2010.716%200.594663%2010.716C0.923086%2010.716%201.18933%2010.9822%201.18933%2011.3106V23.7748C1.18933%2024.7176%201.95362%2025.4819%202.89644%2025.4819H3.39499C4.06246%2025.4819%204.60355%2024.9408%204.60355%2024.2734C4.60355%2023.6059%205.14464%2023.0648%205.81211%2023.0648H24.1879C24.8554%2023.0648%2025.3965%2023.6059%2025.3965%2024.2734C25.3965%2024.9408%2025.9375%2025.4819%2026.605%2025.4819H27.1026C28.045%2025.4819%2028.8089%2024.718%2028.8089%2023.7757V11.3115C28.8089%2010.9826%2029.0755%2010.716%2029.4044%2010.716C29.7334%2010.716%2030%2010.4493%2030%2010.1204V9.57276C30%208.94138%2029.4882%208.42956%2028.8568%208.42956H28.0611C27.1647%208.42956%2026.3851%207.81502%2026.1758%206.94336L25.5831%204.47455C25.0261%202.15491%2022.9516%200.519531%2020.566%200.519531H9.43398ZM6.3784%202.05753H21.1095C22.5826%202.05753%2023.8637%203.06746%2024.2075%204.49991C24.6885%206.50344%2023.1699%208.42971%2021.1095%208.42971H8.88978C6.82933%208.42971%205.31075%206.50345%205.7917%204.49992L6.37791%202.05792C6.37796%202.05769%206.37817%202.05753%206.3784%202.05753ZM2.1772%2014.1881C2.1772%2013.4422%202.92028%2012.9244%203.61999%2013.1828L6.23786%2014.1496C6.65872%2014.305%206.9382%2014.7062%206.9382%2015.1548C6.9382%2015.9007%206.19512%2016.4184%205.49542%2016.16L2.87754%2015.1933C2.45668%2015.0378%202.1772%2014.6367%202.1772%2014.1881ZM26.3776%2013.1825C27.0774%2012.9243%2027.8204%2013.4421%2027.8204%2014.188C27.8204%2014.6367%2027.541%2015.0379%2027.1201%2015.1934L24.5052%2016.1594C23.8051%2016.4181%2023.0614%2015.9001%2023.0614%2015.1537C23.0614%2014.7047%2023.3412%2014.3032%2023.7624%2014.1477L26.3776%2013.1825ZM10.3958%2019.7689C10.3958%2019.1381%2010.9073%2018.6266%2011.5381%2018.6266H18.4584C19.0892%2018.6266%2019.6007%2019.1381%2019.6007%2019.7689C19.6007%2020.3998%2019.0892%2020.9112%2018.4584%2020.9112H11.5381C10.9072%2020.9112%2010.3958%2020.3998%2010.3958%2019.7689Z'%20fill='url(%23paint0_linear_1478_17766)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_17766'%20x1='10.6108'%20y1='3.85718'%20x2='14.2717'%20y2='25.6045'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0001'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",_Me="data:image/svg+xml,%3csvg%20width='30'%20height='27'%20viewBox='0%200%2030%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M23.1209%2012.7698C23.2693%2013.028%2023.3474%2013.3207%2023.3474%2013.6186C23.3474%2013.9165%2023.2693%2014.2092%2023.1209%2014.4675L19.7823%2020.2271C19.6331%2020.4842%2019.4191%2020.6977%2019.1615%2020.8461C18.904%2020.9946%2018.612%2021.0728%2018.3147%2021.073L11.6733%2021.073C11.3781%2021.0707%2011.0886%2020.9915%2010.8333%2020.8432C10.578%2020.6948%2010.3659%2020.4825%2010.2177%2020.2271L6.87911%2014.4675C6.73069%2014.2092%206.65258%2013.9165%206.65258%2013.6186C6.65258%2013.3207%206.73069%2013.028%206.87911%2012.7698L8.72327%209.58956L12.8271%2016.6075C12.8946%2016.7277%2012.9933%2016.8274%2013.1126%2016.8963C13.232%2016.9652%2013.3677%2017.0007%2013.5055%2016.9991L16.4945%2016.9991C16.6323%2017.0007%2016.768%2016.9652%2016.8874%2016.8963C17.0067%2016.8274%2017.1054%2016.7277%2017.1729%2016.6075L18.6674%2013.9982C18.7351%2013.881%2018.7707%2013.748%2018.7707%2013.6126C18.7707%2013.4773%2018.7351%2013.3443%2018.6674%2013.2271L11.9304%201.5703C11.6966%201.16601%2011.3606%200.830295%2010.9562%200.596843C10.5517%200.363393%2010.0929%200.240408%209.62593%200.24023L9.02217%200.24023C8.48786%200.240028%207.96292%200.380525%207.50015%200.647588C7.03738%200.914653%206.65309%201.29887%206.38594%201.76159L0.408109%2012.1003C0.140762%2012.5627%20-6.08137e-07%2013.0874%20-5.84788e-07%2013.6216C-5.61439e-07%2014.1558%200.140762%2014.6805%200.408109%2015.143L6.38594%2025.4816C6.65347%2025.9438%207.03793%2026.3274%207.50067%2026.5939C7.96342%2026.8605%208.48816%2027.0005%209.02217%2027L20.9778%2027C21.5121%2027.0002%2022.0371%2026.8597%2022.4998%2026.5926C22.9626%2026.3256%2023.3469%2025.9414%2023.6141%2025.4786L29.5919%2015.14C29.8592%2014.6775%2030%2014.1528%2030%2013.6186C30%2013.0845%2029.8592%2012.5597%2029.5919%2012.0973L23.6141%201.7586C23.3469%201.29588%2022.9626%200.911664%2022.4998%200.644599C22.0371%200.377534%2021.5121%200.237039%2020.9778%200.237243L15.8967%200.237243L23.1209%2012.7698Z'%20fill='%23fff'/%3e%3c/svg%3e",yMe="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20opacity='0.4'%20d='M20.4578%206.19733L18.1703%203.90983C16.2391%201.97858%2015.2741%201.01233%2014.0203%200.653583C12.7666%200.293583%2011.4353%200.601083%208.77406%201.21608L7.23906%201.56983C4.99906%202.08608%203.87906%202.34483%203.11156%203.11108C2.34531%203.87858%202.08656%204.99858%201.57031%207.23858L1.21531%208.77358C0.601557%2011.4361%200.294057%2012.7661%200.652807%2014.0198C1.01281%2015.2736%201.97906%2016.2386%203.91031%2018.1698L6.19781%2020.4573C9.56031%2023.8211%2011.2403%2025.4998%2013.3278%2025.4998C15.4166%2025.4998%2017.0966%2023.8186%2020.4578%2020.4573C23.8216%2017.0961%2025.5003%2015.4161%2025.5003%2013.3273C25.5003%2011.2398%2023.8191%209.55858%2020.4578%206.19733Z'%20fill='%23fff'/%3e%3cpath%20d='M11.9333%2015.9103C11.0921%2015.0703%2011.0996%2013.8628%2011.6021%2012.9066C11.4774%2012.7264%2011.4197%2012.5083%2011.4391%2012.2901C11.4584%2012.0719%2011.5536%2011.8673%2011.7081%2011.7119C11.8625%2011.5566%2012.0666%2011.4602%2012.2847%2011.4396C12.5028%2011.419%2012.7212%2011.4754%2012.9021%2011.5991C13.3271%2011.3741%2013.7933%2011.2541%2014.2583%2011.2591C14.507%2011.2614%2014.7445%2011.3624%2014.9187%2011.5399C15.0929%2011.7173%2015.1894%2011.9567%2015.1871%2012.2053C15.1848%2012.454%2015.0838%2012.6915%2014.9063%2012.8657C14.7289%2013.0399%2014.4895%2013.1364%2014.2408%2013.1341C13.9514%2013.1448%2013.6779%2013.2692%2013.4796%2013.4803C12.9958%2013.9641%2013.1233%2014.4491%2013.2583%2014.5853C13.3958%2014.7216%2013.8796%2014.8478%2014.3633%2014.3641C15.3433%2013.3841%2017.0358%2013.0591%2018.1208%2014.1428C18.9621%2014.9841%2018.9546%2016.1916%2018.4508%2017.1478C18.5748%2017.328%2018.6318%2017.5458%2018.6121%2017.7636C18.5924%2017.9814%2018.4972%2018.1854%2018.3429%2018.3404C18.1887%2018.4954%2017.9851%2018.5916%2017.7674%2018.6124C17.5497%2018.6331%2017.3316%2018.5771%2017.1508%2018.4541C16.5899%2018.7617%2015.9392%2018.8643%2015.3108%2018.7441C15.1902%2018.7193%2015.0756%2018.671%2014.9736%2018.6019C14.8716%2018.5328%2014.7843%2018.4444%2014.7165%2018.3415C14.6487%2018.2387%2014.6018%2018.1235%2014.5785%2018.0025C14.5553%2017.8816%2014.5561%2017.7572%2014.5808%2017.6366C14.6056%2017.5159%2014.6539%2017.4013%2014.723%2017.2994C14.7921%2017.1974%2014.8806%2017.11%2014.9834%2017.0422C15.0862%2016.9744%2015.2014%2016.9276%2015.3224%2016.9043C15.4433%2016.881%2015.5677%2016.8818%2015.6883%2016.9066C15.9096%2016.9528%2016.2671%2016.8803%2016.5733%2016.5741C17.0583%2016.0891%2016.9308%2015.6053%2016.7946%2015.4691C16.6583%2015.3328%2016.1746%2015.2066%2015.6896%2015.6903C14.7096%2016.6703%2013.0171%2016.9953%2011.9333%2015.9103ZM10.5258%2010.8666C10.7646%2010.636%2010.9551%2010.3601%2011.0861%2010.0551C11.2171%209.75008%2011.2861%209.42203%2011.289%209.09008C11.2919%208.75813%2011.2286%208.42894%2011.1029%208.12169C10.9772%207.81445%2010.7916%207.53532%2010.5568%207.30059C10.3221%207.06586%2010.043%206.88023%209.73573%206.75453C9.42849%206.62882%209.09929%206.56557%208.76734%206.56845C8.43539%206.57134%208.10734%206.6403%207.80233%206.77133C7.49732%206.90235%207.22146%207.0928%206.99084%207.33158C6.53545%207.80309%206.28346%208.43459%206.28916%209.09008C6.29485%209.74558%206.55778%2010.3726%207.0213%2010.8361C7.48482%2011.2996%208.11185%2011.5626%208.76734%2011.5683C9.42283%2011.574%2010.0543%2011.322%2010.5258%2010.8666Z'%20fill='%23fff'/%3e%3c/svg%3e",xMe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM10.4879%2016.2086C11.1556%2018.7005%2013.717%2020.1793%2016.2089%2019.5116C18.7008%2018.8439%2020.1796%2016.2825%2019.5119%2013.7906C18.8442%2011.2987%2016.2828%209.81989%2013.7909%2010.4876C11.299%2011.1553%209.82015%2013.7167%2010.4879%2016.2086ZM8.39503%2016.7694C9.37244%2020.4171%2013.1219%2022.5819%2016.7696%2021.6045C20.4174%2020.627%2022.5821%2016.8776%2021.6047%2013.2298C20.6273%209.58209%2016.8779%207.41735%2013.2301%208.39476C9.58236%209.37218%207.41762%2013.1216%208.39503%2016.7694Z'%20fill='url(%23paint0_linear_1478_19845)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_19845'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23fff'/%3e%3cstop%20offset='0.461458'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",bMe="/about_portfolio/assets/soundoff-B_dVLsfG.png",wMe="/about_portfolio/assets/soundon-4GJHmOjh.png",SMe="/about_portfolio/assets/summiz-B_i5HBJv.svg",AMe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM15.164%2012.8405L15.354%2010.3432L15.5183%208.18279C14.78%208.12663%2014.0416%208.19103%2013.3312%208.36978C12.7441%208.5175%2012.1761%208.74331%2011.643%209.0437C10.4647%209.7076%209.50982%2010.706%208.899%2011.9126C8.28818%2013.1192%208.04887%2014.4798%208.21134%2015.8224C8.37381%2017.165%208.93076%2018.4293%209.81176%2019.4553C10.6928%2020.4814%2011.8582%2021.2232%2013.1608%2021.5869C14.4634%2021.9506%2015.8446%2021.9198%2017.1297%2021.4986C18.4148%2021.0773%2019.5461%2020.2844%2020.3806%2019.2201C20.7582%2018.7386%2021.0673%2018.2113%2021.3021%2017.6533C21.5862%2016.9784%2021.7615%2016.2585%2021.8177%2015.5205L21.8178%2015.5196L19.6574%2015.3553L17.1601%2015.1653L14.9997%2015.0009L15.164%2012.8405ZM18.9617%2017.4752L14.8353%2017.1614L12.6749%2016.997L12.8392%2014.8366L13.1531%2010.7102C13.0009%2010.7757%2012.8519%2010.8495%2012.7066%2010.9313C11.9017%2011.3849%2011.2494%2012.0669%2010.8321%2012.8912C10.4148%2013.7154%2010.2513%2014.6449%2010.3623%2015.5621C10.4733%2016.4793%2010.8538%2017.343%2011.4556%2018.0439C12.0575%2018.7449%2012.8536%2019.2516%2013.7435%2019.5C14.6333%2019.7485%2015.5768%2019.7275%2016.4547%2019.4397C17.3327%2019.1519%2018.1055%2018.6103%2018.6756%2017.8832C18.7785%2017.752%2018.8739%2017.6158%2018.9617%2017.4752Z'%20fill='url(%23paint0_linear_1478_16881)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_16881'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFF'/%3e%3cstop%20offset='0.461458'%20stop-color='%23FFF'/%3e%3cstop%20offset='1'%20stop-color='%23FFF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",TMe="/about_portfolio/assets/lllw1-Bb4i6zS6.png",MMe="/about_portfolio/assets/jssh-wN1B_wBU.png",CMe="/about_portfolio/assets/swm-BA91m20b.png",EMe="/about_portfolio/assets/ar-Cn-GxoY6.png",vX={type:"change"},WF={type:"start"},_X={type:"end"},Z2=new Lx,yX=new Lm,IMe=Math.cos(70*so.DEG2RAD);class j0 extends Tp{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ze,this.cursor=new Ze,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:_y.ROTATE,MIDDLE:_y.DOLLY,RIGHT:_y.PAN},this.touches={ONE:yy.ROTATE,TWO:yy.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Ne){Ne.addEventListener("keydown",nr),this._domElementKeyEvents=Ne},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",nr),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(vX),r.update(),o=s.NONE},this.update=function(){const Ne=new Ze,Bt=new Ea().setFromUnitVectors(e.up,new Ze(0,1,0)),Jt=Bt.clone().invert(),hn=new Ze,In=new Ea,Tr=new Ze,jr=2*Math.PI;return function(Bs=null){const fi=r.object.position;Ne.copy(fi).sub(r.target),Ne.applyQuaternion(Bt),c.setFromVector3(Ne),r.autoRotate&&o===s.NONE&&Ae(ae(Bs)),r.enableDamping?(c.theta+=a.theta*r.dampingFactor,c.phi+=a.phi*r.dampingFactor):(c.theta+=a.theta,c.phi+=a.phi);let Mt=r.minAzimuthAngle,we=r.maxAzimuthAngle;isFinite(Mt)&&isFinite(we)&&(Mt<-Math.PI?Mt+=jr:Mt>Math.PI&&(Mt-=jr),we<-Math.PI?we+=jr:we>Math.PI&&(we-=jr),Mt<=we?c.theta=Math.max(Mt,Math.min(we,c.theta)):c.theta=c.theta>(Mt+we)/2?Math.max(Mt,c.theta):Math.min(we,c.theta)),c.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,c.phi)),c.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(f,r.dampingFactor):r.target.add(f),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor);let Ie=!1;if(r.zoomToCursor&&Z||r.object.isOrthographicCamera)c.radius=Ue(c.radius);else{const qe=c.radius;c.radius=Ue(c.radius*d),Ie=qe!=c.radius}if(Ne.setFromSpherical(c),Ne.applyQuaternion(Jt),fi.copy(r.target).add(Ne),r.object.lookAt(r.target),r.enableDamping===!0?(a.theta*=1-r.dampingFactor,a.phi*=1-r.dampingFactor,f.multiplyScalar(1-r.dampingFactor)):(a.set(0,0,0),f.set(0,0,0)),r.zoomToCursor&&Z){let qe=null;if(r.object.isPerspectiveCamera){const it=Ne.length();qe=Ue(it*d);const Qe=it-qe;r.object.position.addScaledVector(H,Qe),r.object.updateMatrixWorld(),Ie=!!Qe}else if(r.object.isOrthographicCamera){const it=new Ze(q.x,q.y,0);it.unproject(r.object);const Qe=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix(),Ie=Qe!==r.object.zoom;const mt=new Ze(q.x,q.y,0);mt.unproject(r.object),r.object.position.sub(mt).add(it),r.object.updateMatrixWorld(),qe=Ne.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;qe!==null&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(qe).add(r.object.position):(Z2.origin.copy(r.object.position),Z2.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(Z2.direction))<IMe?e.lookAt(r.target):(yX.setFromNormalAndCoplanarPoint(r.object.up,r.target),Z2.intersectPlane(yX,r.target))))}else if(r.object.isOrthographicCamera){const qe=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),qe!==r.object.zoom&&(r.object.updateProjectionMatrix(),Ie=!0)}return d=1,Z=!1,Ie||hn.distanceToSquared(r.object.position)>l||8*(1-In.dot(r.object.quaternion))>l||Tr.distanceToSquared(r.target)>l?(r.dispatchEvent(vX),hn.copy(r.object.position),In.copy(r.object.quaternion),Tr.copy(r.target),!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",sr),r.domElement.removeEventListener("pointerdown",on),r.domElement.removeEventListener("pointercancel",He),r.domElement.removeEventListener("wheel",An),r.domElement.removeEventListener("pointermove",ct),r.domElement.removeEventListener("pointerup",He),r.domElement.getRootNode().removeEventListener("keydown",gr,{capture:!0}),r._domElementKeyEvents!==null&&(r._domElementKeyEvents.removeEventListener("keydown",nr),r._domElementKeyEvents=null)};const r=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=s.NONE;const l=1e-6,c=new CM,a=new CM;let d=1;const f=new Ze,m=new sn,_=new sn,x=new sn,A=new sn,I=new sn,E=new sn,C=new sn,L=new sn,O=new sn,H=new Ze,q=new sn;let Z=!1;const J=[],re={};let se=!1;function ae(Ne){return Ne!==null?2*Math.PI/60*r.autoRotateSpeed*Ne:2*Math.PI/60/60*r.autoRotateSpeed}function he(Ne){const Bt=Math.abs(Ne*.01);return Math.pow(.95,r.zoomSpeed*Bt)}function Ae(Ne){a.theta-=Ne}function Ee(Ne){a.phi-=Ne}const Pe=function(){const Ne=new Ze;return function(Jt,hn){Ne.setFromMatrixColumn(hn,0),Ne.multiplyScalar(-Jt),f.add(Ne)}}(),ze=function(){const Ne=new Ze;return function(Jt,hn){r.screenSpacePanning===!0?Ne.setFromMatrixColumn(hn,1):(Ne.setFromMatrixColumn(hn,0),Ne.crossVectors(r.object.up,Ne)),Ne.multiplyScalar(Jt),f.add(Ne)}}(),Re=function(){const Ne=new Ze;return function(Jt,hn){const In=r.domElement;if(r.object.isPerspectiveCamera){const Tr=r.object.position;Ne.copy(Tr).sub(r.target);let jr=Ne.length();jr*=Math.tan(r.object.fov/2*Math.PI/180),Pe(2*Jt*jr/In.clientHeight,r.object.matrix),ze(2*hn*jr/In.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(Pe(Jt*(r.object.right-r.object.left)/r.object.zoom/In.clientWidth,r.object.matrix),ze(hn*(r.object.top-r.object.bottom)/r.object.zoom/In.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function rt(Ne){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?d/=Ne:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ye(Ne){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?d*=Ne:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function We(Ne,Bt){if(!r.zoomToCursor)return;Z=!0;const Jt=r.domElement.getBoundingClientRect(),hn=Ne-Jt.left,In=Bt-Jt.top,Tr=Jt.width,jr=Jt.height;q.x=hn/Tr*2-1,q.y=-(In/jr)*2+1,H.set(q.x,q.y,1).unproject(r.object).sub(r.object.position).normalize()}function Ue(Ne){return Math.max(r.minDistance,Math.min(r.maxDistance,Ne))}function gt(Ne){m.set(Ne.clientX,Ne.clientY)}function vt(Ne){We(Ne.clientX,Ne.clientX),C.set(Ne.clientX,Ne.clientY)}function Dt(Ne){A.set(Ne.clientX,Ne.clientY)}function lt(Ne){_.set(Ne.clientX,Ne.clientY),x.subVectors(_,m).multiplyScalar(r.rotateSpeed);const Bt=r.domElement;Ae(2*Math.PI*x.x/Bt.clientHeight),Ee(2*Math.PI*x.y/Bt.clientHeight),m.copy(_),r.update()}function jt(Ne){L.set(Ne.clientX,Ne.clientY),O.subVectors(L,C),O.y>0?rt(he(O.y)):O.y<0&&ye(he(O.y)),C.copy(L),r.update()}function Qt(Ne){I.set(Ne.clientX,Ne.clientY),E.subVectors(I,A).multiplyScalar(r.panSpeed),Re(E.x,E.y),A.copy(I),r.update()}function nn(Ne){We(Ne.clientX,Ne.clientY),Ne.deltaY<0?ye(he(Ne.deltaY)):Ne.deltaY>0&&rt(he(Ne.deltaY)),r.update()}function Wn(Ne){let Bt=!1;switch(Ne.code){case r.keys.UP:Ne.ctrlKey||Ne.metaKey||Ne.shiftKey?Ee(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(0,r.keyPanSpeed),Bt=!0;break;case r.keys.BOTTOM:Ne.ctrlKey||Ne.metaKey||Ne.shiftKey?Ee(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(0,-r.keyPanSpeed),Bt=!0;break;case r.keys.LEFT:Ne.ctrlKey||Ne.metaKey||Ne.shiftKey?Ae(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(r.keyPanSpeed,0),Bt=!0;break;case r.keys.RIGHT:Ne.ctrlKey||Ne.metaKey||Ne.shiftKey?Ae(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(-r.keyPanSpeed,0),Bt=!0;break}Bt&&(Ne.preventDefault(),r.update())}function kn(Ne){if(J.length===1)m.set(Ne.pageX,Ne.pageY);else{const Bt=Wr(Ne),Jt=.5*(Ne.pageX+Bt.x),hn=.5*(Ne.pageY+Bt.y);m.set(Jt,hn)}}function Mn(Ne){if(J.length===1)A.set(Ne.pageX,Ne.pageY);else{const Bt=Wr(Ne),Jt=.5*(Ne.pageX+Bt.x),hn=.5*(Ne.pageY+Bt.y);A.set(Jt,hn)}}function De(Ne){const Bt=Wr(Ne),Jt=Ne.pageX-Bt.x,hn=Ne.pageY-Bt.y,In=Math.sqrt(Jt*Jt+hn*hn);C.set(0,In)}function Ye(Ne){r.enableZoom&&De(Ne),r.enablePan&&Mn(Ne)}function gn(Ne){r.enableZoom&&De(Ne),r.enableRotate&&kn(Ne)}function un(Ne){if(J.length==1)_.set(Ne.pageX,Ne.pageY);else{const Jt=Wr(Ne),hn=.5*(Ne.pageX+Jt.x),In=.5*(Ne.pageY+Jt.y);_.set(hn,In)}x.subVectors(_,m).multiplyScalar(r.rotateSpeed);const Bt=r.domElement;Ae(2*Math.PI*x.x/Bt.clientHeight),Ee(2*Math.PI*x.y/Bt.clientHeight),m.copy(_)}function At(Ne){if(J.length===1)I.set(Ne.pageX,Ne.pageY);else{const Bt=Wr(Ne),Jt=.5*(Ne.pageX+Bt.x),hn=.5*(Ne.pageY+Bt.y);I.set(Jt,hn)}E.subVectors(I,A).multiplyScalar(r.panSpeed),Re(E.x,E.y),A.copy(I)}function en(Ne){const Bt=Wr(Ne),Jt=Ne.pageX-Bt.x,hn=Ne.pageY-Bt.y,In=Math.sqrt(Jt*Jt+hn*hn);L.set(0,In),O.set(0,Math.pow(L.y/C.y,r.zoomSpeed)),rt(O.y),C.copy(L);const Tr=(Ne.pageX+Bt.x)*.5,jr=(Ne.pageY+Bt.y)*.5;We(Tr,jr)}function On(Ne){r.enableZoom&&en(Ne),r.enablePan&&At(Ne)}function Vn(Ne){r.enableZoom&&en(Ne),r.enableRotate&&un(Ne)}function on(Ne){r.enabled!==!1&&(J.length===0&&(r.domElement.setPointerCapture(Ne.pointerId),r.domElement.addEventListener("pointermove",ct),r.domElement.addEventListener("pointerup",He)),!ar(Ne)&&(di(Ne),Ne.pointerType==="touch"?Ar(Ne):qt(Ne)))}function ct(Ne){r.enabled!==!1&&(Ne.pointerType==="touch"?Dn(Ne):Tn(Ne))}function He(Ne){switch(zr(Ne),J.length){case 0:r.domElement.releasePointerCapture(Ne.pointerId),r.domElement.removeEventListener("pointermove",ct),r.domElement.removeEventListener("pointerup",He),r.dispatchEvent(_X),o=s.NONE;break;case 1:const Bt=J[0],Jt=re[Bt];Ar({pointerId:Bt,pageX:Jt.x,pageY:Jt.y});break}}function qt(Ne){let Bt;switch(Ne.button){case 0:Bt=r.mouseButtons.LEFT;break;case 1:Bt=r.mouseButtons.MIDDLE;break;case 2:Bt=r.mouseButtons.RIGHT;break;default:Bt=-1}switch(Bt){case _y.DOLLY:if(r.enableZoom===!1)return;vt(Ne),o=s.DOLLY;break;case _y.ROTATE:if(Ne.ctrlKey||Ne.metaKey||Ne.shiftKey){if(r.enablePan===!1)return;Dt(Ne),o=s.PAN}else{if(r.enableRotate===!1)return;gt(Ne),o=s.ROTATE}break;case _y.PAN:if(Ne.ctrlKey||Ne.metaKey||Ne.shiftKey){if(r.enableRotate===!1)return;gt(Ne),o=s.ROTATE}else{if(r.enablePan===!1)return;Dt(Ne),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&r.dispatchEvent(WF)}function Tn(Ne){switch(o){case s.ROTATE:if(r.enableRotate===!1)return;lt(Ne);break;case s.DOLLY:if(r.enableZoom===!1)return;jt(Ne);break;case s.PAN:if(r.enablePan===!1)return;Qt(Ne);break}}function An(Ne){r.enabled===!1||r.enableZoom===!1||o!==s.NONE||(Ne.preventDefault(),r.dispatchEvent(WF),nn(Wt(Ne)),r.dispatchEvent(_X))}function Wt(Ne){const Bt=Ne.deltaMode,Jt={clientX:Ne.clientX,clientY:Ne.clientY,deltaY:Ne.deltaY};switch(Bt){case 1:Jt.deltaY*=16;break;case 2:Jt.deltaY*=100;break}return Ne.ctrlKey&&!se&&(Jt.deltaY*=10),Jt}function gr(Ne){Ne.key==="Control"&&(se=!0,r.domElement.getRootNode().addEventListener("keyup",Gn,{passive:!0,capture:!0}))}function Gn(Ne){Ne.key==="Control"&&(se=!1,r.domElement.getRootNode().removeEventListener("keyup",Gn,{passive:!0,capture:!0}))}function nr(Ne){r.enabled===!1||r.enablePan===!1||Wn(Ne)}function Ar(Ne){switch(Ur(Ne),J.length){case 1:switch(r.touches.ONE){case yy.ROTATE:if(r.enableRotate===!1)return;kn(Ne),o=s.TOUCH_ROTATE;break;case yy.PAN:if(r.enablePan===!1)return;Mn(Ne),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(r.touches.TWO){case yy.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Ye(Ne),o=s.TOUCH_DOLLY_PAN;break;case yy.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;gn(Ne),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&r.dispatchEvent(WF)}function Dn(Ne){switch(Ur(Ne),o){case s.TOUCH_ROTATE:if(r.enableRotate===!1)return;un(Ne),r.update();break;case s.TOUCH_PAN:if(r.enablePan===!1)return;At(Ne),r.update();break;case s.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;On(Ne),r.update();break;case s.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Vn(Ne),r.update();break;default:o=s.NONE}}function sr(Ne){r.enabled!==!1&&Ne.preventDefault()}function di(Ne){J.push(Ne.pointerId)}function zr(Ne){delete re[Ne.pointerId];for(let Bt=0;Bt<J.length;Bt++)if(J[Bt]==Ne.pointerId){J.splice(Bt,1);return}}function ar(Ne){for(let Bt=0;Bt<J.length;Bt++)if(J[Bt]==Ne.pointerId)return!0;return!1}function Ur(Ne){let Bt=re[Ne.pointerId];Bt===void 0&&(Bt=new sn,re[Ne.pointerId]=Bt),Bt.set(Ne.pageX,Ne.pageY)}function Wr(Ne){const Bt=Ne.pointerId===J[0]?J[1]:J[0];return re[Bt]}r.domElement.addEventListener("contextmenu",sr),r.domElement.addEventListener("pointerdown",on),r.domElement.addEventListener("pointercancel",He),r.domElement.addEventListener("wheel",An,{passive:!1}),r.domElement.getRootNode().addEventListener("keydown",gr,{passive:!0,capture:!0}),this.update()}}const PMe="/about_portfolio/assets/clouds-IEtJOhG3.jpeg",RMe="/about_portfolio/assets/earth_basic-BA2kNn0Z.jpeg",LMe="/about_portfolio/assets/earth_normal-BhhqUxiB.jpeg",DMe="/about_portfolio/assets/earth_rough-BHPkAlB2.jpeg",BMe="/about_portfolio/assets/moon_basic-B595DPb7.jpeg",kMe="/about_portfolio/assets/moon_normal-BoJTEBW0.jpeg",OMe="/about_portfolio/assets/moon_roughness-BDXd91JJ.jpeg";var wT=function(){var n=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(f){f.preventDefault(),r(++n%e.children.length)},!1);function t(f){return e.appendChild(f.dom),f}function r(f){for(var m=0;m<e.children.length;m++)e.children[m].style.display=m===f?"block":"none";n=f}var s=(performance||Date).now(),o=s,l=0,c=t(new wT.Panel("FPS","#0ff","#002")),a=t(new wT.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new wT.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:e,addPanel:t,showPanel:r,begin:function(){s=(performance||Date).now()},end:function(){l++;var f=(performance||Date).now();if(a.update(f-s,200),f>=o+1e3&&(c.update(l*1e3/(f-o),100),o=f,l=0,d)){var m=performance.memory;d.update(m.usedJSHeapSize/1048576,m.jsHeapSizeLimit/1048576)}return f},update:function(){s=this.end()},domElement:e,setMode:r}};wT.Panel=function(n,e,t){var r=1/0,s=0,o=Math.round,l=o(window.devicePixelRatio||1),c=80*l,a=48*l,d=3*l,f=2*l,m=3*l,_=15*l,x=74*l,A=30*l,I=document.createElement("canvas");I.width=c,I.height=a,I.style.cssText="width:80px;height:48px";var E=I.getContext("2d");return E.font="bold "+9*l+"px Helvetica,Arial,sans-serif",E.textBaseline="top",E.fillStyle=t,E.fillRect(0,0,c,a),E.fillStyle=e,E.fillText(n,d,f),E.fillRect(m,_,x,A),E.fillStyle=t,E.globalAlpha=.9,E.fillRect(m,_,x,A),{dom:I,update:function(C,L){r=Math.min(r,C),s=Math.max(s,C),E.fillStyle=t,E.globalAlpha=1,E.fillRect(0,0,c,_),E.fillStyle=e,E.fillText(o(C)+" "+n+" ("+o(r)+"-"+o(s)+")",d,f),E.drawImage(I,m+l,_,x-l,A,m,_,x-l,A),E.fillRect(m+x-l,_,l,A),E.fillStyle=t,E.globalAlpha=.9,E.fillRect(m+x-l,_,l,o((1-C/L)*A))}}};const FMe=()=>{const n=_e.useRef(null),e=_e.useRef(null),t=_e.useRef(null),r=_e.useRef(null),s=_e.useRef(null),o=_e.useRef(null),l=_e.useRef(null),c=_e.useRef(null);let a=null,d=null,f=null,m=null,_=new rf;_e.useEffect(()=>(A(),a=new wT,a.showPanel(0),document.body.appendChild(a.dom),window.addEventListener("resize",x),()=>{document.body.removeChild(a.dom),window.removeEventListener("resize",x)}),[]);const x=()=>{r.current&&e.current&&(r.current.aspect=window.innerWidth/window.innerHeight,r.current.updateProjectionMatrix(),e.current.setSize(window.innerWidth,window.innerHeight))},A=()=>{const H=new ec({canvas:n.current,antialias:!0});H.setPixelRatio(window.devicePixelRatio),H.setSize(window.innerWidth,window.innerHeight),H.setPixelRatio(Math.min(window.devicePixelRatio,2)),H.shadowMap.enabled=!0,H.toneMapping=TD,e.current=H;const q=new Il;t.current=q;const Z=96,J=window.innerWidth/window.innerHeight,re=new af(-Z*J,Z*J,Z,-Z,1,1e3);re.position.set(0,20,200),re.lookAt(new Ze(0,0,0)),r.current=re;const se=new j0(re,H.domElement);se.enableDamping=!0,s.current=se,I(q),E(q),C(q),O()},I=H=>{const q=new H0(16777215,1.2);q.position.set(-10,10,5),q.castShadow=!0,q.shadow.mapSize.width=512,q.shadow.mapSize.height=512,q.shadow.camera.top=10,q.shadow.camera.bottom=-5,q.shadow.camera.left=-5,q.shadow.camera.right=10,H.add(q);const Z=new Ox(16777215,.8);H.add(Z)},E=H=>{d=new Kl;const q=new Di(new Wm(10,64,64),new xp({map:_.load(RMe),normalMap:_.load(LMe),roughnessMap:_.load(DMe),normalScale:new sn(10,10),metalness:.1}));q.rotation.y=-Math.PI,m=new Di(new Wm(10.6,64,64),new SC({alphaMap:_.load(PMe),transparent:!0,opacity:.4,depthTest:!0})),d.add(q),c.current=m,d.add(m),d.scale.set(6,6,6),l.current=d,H.add(d)},C=H=>{f=new Di(new Wm(2,32,32),new xp({map:_.load(BMe),normalMap:_.load(kMe),roughnessMap:_.load(OMe),normalScale:new sn(10,10),metalness:.1})),f.position.set(-120,0,-120),f.scale.set(6,6,6),o.current=f,H.add(f)},L=new dg,O=()=>{if(!e.current||!t.current||!r.current)return;const H=L.getElapsedTime();d&&(d.rotation.y+=.002),m&&(m.rotation.y+=.004),m&&(m.rotation.x+=.002),a&&a.update(),s.current&&s.current.update(),f&&(f.position.x=Math.sin(H*.5)*-120),f&&(f.position.z=Math.cos(H*.5)*-120),e.current.render(t.current,r.current),requestAnimationFrame(O)};return pe.jsx("div",{className:"earth_page",children:pe.jsx("canvas",{ref:n,className:"webgl"})})};function NMe(n){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function Bb(n,e){var t=n.__state.conversionName.toString(),r=Math.round(n.r),s=Math.round(n.g),o=Math.round(n.b),l=n.a,c=Math.round(n.h),a=n.s.toFixed(1),d=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var f=n.hex.toString(16);f.length<6;)f="0"+f;return"#"+f}else{if(t==="CSS_RGB")return"rgb("+r+","+s+","+o+")";if(t==="CSS_RGBA")return"rgba("+r+","+s+","+o+","+l+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+r+","+s+","+o+"]";if(t==="RGBA_ARRAY")return"["+r+","+s+","+o+","+l+"]";if(t==="RGB_OBJ")return"{r:"+r+",g:"+s+",b:"+o+"}";if(t==="RGBA_OBJ")return"{r:"+r+",g:"+s+",b:"+o+",a:"+l+"}";if(t==="HSV_OBJ")return"{h:"+c+",s:"+a+",v:"+d+"}";if(t==="HSVA_OBJ")return"{h:"+c+",s:"+a+",v:"+d+",a:"+l+"}"}return"unknown format"}var xX=Array.prototype.forEach,oA=Array.prototype.slice,Ln={BREAK:{},extend:function(e){return this.each(oA.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(s){this.isUndefined(t[s])||(e[s]=t[s])}).bind(this))},this),e},defaults:function(e){return this.each(oA.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(s){this.isUndefined(e[s])&&(e[s]=t[s])}).bind(this))},this),e},compose:function(){var e=oA.call(arguments);return function(){for(var t=oA.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e){if(xX&&e.forEach&&e.forEach===xX)e.forEach(t,r);else if(e.length===e.length+0){var s=void 0,o=void 0;for(s=0,o=e.length;s<o;s++)if(s in e&&t.call(r,e[s],s)===this.BREAK)return}else for(var l in e)if(t.call(r,e[l],l)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var s=void 0;return function(){var o=this,l=arguments;function c(){s=null,r||e.apply(o,l)}var a=r||!s;clearTimeout(s),s=setTimeout(c,t),a&&e.apply(o,l)}},toArray:function(e){return e.toArray?e.toArray():oA.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},zMe=[{litmus:Ln.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Bb},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Bb},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Bb},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Bb}}},{litmus:Ln.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Ln.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Ln.isObject,conversions:{RGBA_OBJ:{read:function(e){return Ln.isNumber(e.r)&&Ln.isNumber(e.g)&&Ln.isNumber(e.b)&&Ln.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return Ln.isNumber(e.r)&&Ln.isNumber(e.g)&&Ln.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return Ln.isNumber(e.h)&&Ln.isNumber(e.s)&&Ln.isNumber(e.v)&&Ln.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return Ln.isNumber(e.h)&&Ln.isNumber(e.s)&&Ln.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],aA=void 0,K2=void 0,xz=function(){K2=!1;var e=arguments.length>1?Ln.toArray(arguments):arguments[0];return Ln.each(zMe,function(t){if(t.litmus(e))return Ln.each(t.conversions,function(r,s){if(aA=r.read(e),K2===!1&&aA!==!1)return K2=aA,aA.conversionName=s,aA.conversion=r,Ln.BREAK}),Ln.BREAK}),K2},bX=void 0,KR={hsv_to_rgb:function(e,t,r){var s=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),l=r*(1-t),c=r*(1-o*t),a=r*(1-(1-o)*t),d=[[r,a,l],[c,r,l],[l,r,a],[l,c,r],[a,l,r],[r,l,c]][s];return{r:d[0]*255,g:d[1]*255,b:d[2]*255}},rgb_to_hsv:function(e,t,r){var s=Math.min(e,t,r),o=Math.max(e,t,r),l=o-s,c=void 0,a=void 0;if(o!==0)a=l/o;else return{h:NaN,s:0,v:0};return e===o?c=(t-r)/l:t===o?c=2+(r-e)/l:c=4+(e-t)/l,c/=6,c<0&&(c+=1),{h:c*360,s:a,v:o/255}},rgb_to_hex:function(e,t,r){var s=this.hex_with_component(0,2,e);return s=this.hex_with_component(s,1,t),s=this.hex_with_component(s,0,r),s},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,r){return r<<(bX=t*8)|e&~(255<<bX)}},UMe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},uf=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},hf=function(){function n(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),A0=function n(e,t,r){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:n(o,t,r)}else{if("value"in s)return s.value;var l=s.get;return l===void 0?void 0:l.call(r)}},W0=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},$0=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},ll=function(){function n(){if(uf(this,n),this.__state=xz.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return hf(n,[{key:"toString",value:function(){return Bb(this)}},{key:"toHexString",value:function(){return Bb(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function oG(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(ll.recalculateRGB(this,e,t),this.__state[e])},set:function(s){this.__state.space!=="RGB"&&(ll.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=s}})}function aG(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(ll.recalculateHSV(this),this.__state[e])},set:function(r){this.__state.space!=="HSV"&&(ll.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=r}})}ll.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=KR.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")Ln.extend(n.__state,KR.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};ll.recalculateHSV=function(n){var e=KR.rgb_to_hsv(n.r,n.g,n.b);Ln.extend(n.__state,{s:e.s,v:e.v}),Ln.isNaN(e.h)?Ln.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};ll.COMPONENTS=["r","g","b","h","s","v","hex","a"];oG(ll.prototype,"r",2);oG(ll.prototype,"g",1);oG(ll.prototype,"b",0);aG(ll.prototype,"h");aG(ll.prototype,"s");aG(ll.prototype,"v");Object.defineProperty(ll.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(ll.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=KR.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Nx=function(){function n(e,t){uf(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return hf(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),GMe={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},Bie={};Ln.each(GMe,function(n,e){Ln.each(n,function(t){Bie[t]=e})});var VMe=/(\d+(\.\d+)?)px/;function Zf(n){if(n==="0"||Ln.isUndefined(n))return 0;var e=n.match(VMe);return Ln.isNull(e)?0:parseFloat(e[1])}var ln={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var s=r,o=t;Ln.isUndefined(o)&&(o=!0),Ln.isUndefined(s)&&(s=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),s&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,s){var o=r||{},l=Bie[t];if(!l)throw new Error("Event type "+t+" not supported.");var c=document.createEvent(l);switch(l){case"MouseEvents":{var a=o.x||o.clientX||0,d=o.y||o.clientY||0;c.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,a,d,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var f=c.initKeyboardEvent||c.initKeyEvent;Ln.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{c.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}}Ln.defaults(c,s),e.dispatchEvent(c)},bind:function(e,t,r,s){var o=s||!1;return e.addEventListener?e.addEventListener(t,r,o):e.attachEvent&&e.attachEvent("on"+t,r),ln},unbind:function(e,t,r,s){var o=s||!1;return e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent&&e.detachEvent("on"+t,r),ln},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);r.indexOf(t)===-1&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return ln},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),s=r.indexOf(t);s!==-1&&(r.splice(s,1),e.className=r.join(" "))}else e.className=void 0;return ln},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return Zf(t["border-left-width"])+Zf(t["border-right-width"])+Zf(t["padding-left"])+Zf(t["padding-right"])+Zf(t.width)},getHeight:function(e){var t=getComputedStyle(e);return Zf(t["border-top-width"])+Zf(t["border-bottom-width"])+Zf(t["padding-top"])+Zf(t["padding-bottom"])+Zf(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent;while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},kie=function(n){W0(e,n);function e(t,r){uf(this,e);var s=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=s;s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox");function l(){o.setValue(!o.__prev)}return ln.bind(s.__checkbox,"change",l,!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return hf(e,[{key:"setValue",value:function(r){var s=A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),s}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Nx),HMe=function(n){W0(e,n);function e(t,r,s){uf(this,e);var o=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),l=s,c=o;if(o.__select=document.createElement("select"),Ln.isArray(l)){var a={};Ln.each(l,function(d){a[d]=d}),l=a}return Ln.each(l,function(d,f){var m=document.createElement("option");m.innerHTML=f,m.setAttribute("value",d),c.__select.appendChild(m)}),o.updateDisplay(),ln.bind(o.__select,"change",function(){var d=this.options[this.selectedIndex].value;c.setValue(d)}),o.domElement.appendChild(o.__select),o}return hf(e,[{key:"setValue",value:function(r){var s=A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),s}},{key:"updateDisplay",value:function(){return ln.isActive(this.__select)?this:(this.__select.value=this.getValue(),A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Nx),jMe=function(n){W0(e,n);function e(t,r){uf(this,e);var s=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=s;function l(){o.setValue(o.__input.value)}function c(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),ln.bind(s.__input,"keyup",l),ln.bind(s.__input,"change",l),ln.bind(s.__input,"blur",c),ln.bind(s.__input,"keydown",function(a){a.keyCode===13&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return hf(e,[{key:"updateDisplay",value:function(){return ln.isActive(this.__input)||(this.__input.value=this.getValue()),A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Nx);function wX(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var Oie=function(n){W0(e,n);function e(t,r,s){uf(this,e);var o=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),l=s||{};return o.__min=l.min,o.__max=l.max,o.__step=l.step,Ln.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=wX(o.__impliedStep),o}return hf(e,[{key:"setValue",value:function(r){var s=r;return this.__min!==void 0&&s<this.__min?s=this.__min:this.__max!==void 0&&s>this.__max&&(s=this.__max),this.__step!==void 0&&s%this.__step!==0&&(s=Math.round(s/this.__step)*this.__step),A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,s)}},{key:"min",value:function(r){return this.__min=r,this}},{key:"max",value:function(r){return this.__max=r,this}},{key:"step",value:function(r){return this.__step=r,this.__impliedStep=r,this.__precision=wX(r),this}}]),e}(Nx);function WMe(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var JR=function(n){W0(e,n);function e(t,r,s){uf(this,e);var o=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,s));o.__truncationSuspended=!1;var l=o,c=void 0;function a(){var A=parseFloat(l.__input.value);Ln.isNaN(A)||l.setValue(A)}function d(){l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function f(){d()}function m(A){var I=c-A.clientY;l.setValue(l.getValue()+I*l.__impliedStep),c=A.clientY}function _(){ln.unbind(window,"mousemove",m),ln.unbind(window,"mouseup",_),d()}function x(A){ln.bind(window,"mousemove",m),ln.bind(window,"mouseup",_),c=A.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),ln.bind(o.__input,"change",a),ln.bind(o.__input,"blur",f),ln.bind(o.__input,"mousedown",x),ln.bind(o.__input,"keydown",function(A){A.keyCode===13&&(l.__truncationSuspended=!0,this.blur(),l.__truncationSuspended=!1,d())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return hf(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():WMe(this.getValue(),this.__precision),A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Oie);function SX(n,e,t,r,s){return r+(s-r)*((n-e)/(t-e))}var bz=function(n){W0(e,n);function e(t,r,s,o,l){uf(this,e);var c=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:s,max:o,step:l})),a=c;c.__background=document.createElement("div"),c.__foreground=document.createElement("div"),ln.bind(c.__background,"mousedown",d),ln.bind(c.__background,"touchstart",_),ln.addClass(c.__background,"slider"),ln.addClass(c.__foreground,"slider-fg");function d(I){document.activeElement.blur(),ln.bind(window,"mousemove",f),ln.bind(window,"mouseup",m),f(I)}function f(I){I.preventDefault();var E=a.__background.getBoundingClientRect();return a.setValue(SX(I.clientX,E.left,E.right,a.__min,a.__max)),!1}function m(){ln.unbind(window,"mousemove",f),ln.unbind(window,"mouseup",m),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function _(I){I.touches.length===1&&(ln.bind(window,"touchmove",x),ln.bind(window,"touchend",A),x(I))}function x(I){var E=I.touches[0].clientX,C=a.__background.getBoundingClientRect();a.setValue(SX(E,C.left,C.right,a.__min,a.__max))}function A(){ln.unbind(window,"touchmove",x),ln.unbind(window,"touchend",A),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return c.updateDisplay(),c.__background.appendChild(c.__foreground),c.domElement.appendChild(c.__background),c}return hf(e,[{key:"updateDisplay",value:function(){var r=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=r*100+"%",A0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Oie),Fie=function(n){W0(e,n);function e(t,r,s){uf(this,e);var o=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),l=o;return o.__button=document.createElement("div"),o.__button.innerHTML=s===void 0?"Fire":s,ln.bind(o.__button,"click",function(c){return c.preventDefault(),l.fire(),!1}),ln.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return hf(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Nx),wz=function(n){W0(e,n);function e(t,r){uf(this,e);var s=$0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));s.__color=new ll(s.getValue()),s.__temp=new ll(0);var o=s;s.domElement=document.createElement("div"),ln.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",ln.bind(s.__input,"keydown",function(I){I.keyCode===13&&m.call(this)}),ln.bind(s.__input,"blur",m),ln.bind(s.__selector,"mousedown",function(){ln.addClass(this,"drag").bind(window,"mouseup",function(){ln.removeClass(o.__selector,"drag")})}),ln.bind(s.__selector,"touchstart",function(){ln.addClass(this,"drag").bind(window,"touchend",function(){ln.removeClass(o.__selector,"drag")})});var l=document.createElement("div");Ln.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Ln.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Ln.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Ln.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Ln.extend(l.style,{width:"100%",height:"100%",background:"none"}),AX(l,"top","rgba(0,0,0,0)","#000"),Ln.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),XMe(s.__hue_field),Ln.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),ln.bind(s.__saturation_field,"mousedown",c),ln.bind(s.__saturation_field,"touchstart",c),ln.bind(s.__field_knob,"mousedown",c),ln.bind(s.__field_knob,"touchstart",c),ln.bind(s.__hue_field,"mousedown",a),ln.bind(s.__hue_field,"touchstart",a);function c(I){x(I),ln.bind(window,"mousemove",x),ln.bind(window,"touchmove",x),ln.bind(window,"mouseup",d),ln.bind(window,"touchend",d)}function a(I){A(I),ln.bind(window,"mousemove",A),ln.bind(window,"touchmove",A),ln.bind(window,"mouseup",f),ln.bind(window,"touchend",f)}function d(){ln.unbind(window,"mousemove",x),ln.unbind(window,"touchmove",x),ln.unbind(window,"mouseup",d),ln.unbind(window,"touchend",d),_()}function f(){ln.unbind(window,"mousemove",A),ln.unbind(window,"touchmove",A),ln.unbind(window,"mouseup",f),ln.unbind(window,"touchend",f),_()}function m(){var I=xz(this.value);I!==!1?(o.__color.__state=I,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function _(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}s.__saturation_field.appendChild(l),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay();function x(I){I.type.indexOf("touch")===-1&&I.preventDefault();var E=o.__saturation_field.getBoundingClientRect(),C=I.touches&&I.touches[0]||I,L=C.clientX,O=C.clientY,H=(L-E.left)/(E.right-E.left),q=1-(O-E.top)/(E.bottom-E.top);return q>1?q=1:q<0&&(q=0),H>1?H=1:H<0&&(H=0),o.__color.v=q,o.__color.s=H,o.setValue(o.__color.toOriginal()),!1}function A(I){I.type.indexOf("touch")===-1&&I.preventDefault();var E=o.__hue_field.getBoundingClientRect(),C=I.touches&&I.touches[0]||I,L=C.clientY,O=1-(L-E.top)/(E.bottom-E.top);return O>1?O=1:O<0&&(O=0),o.__color.h=O*360,o.setValue(o.__color.toOriginal()),!1}return s}return hf(e,[{key:"updateDisplay",value:function(){var r=xz(this.getValue());if(r!==!1){var s=!1;Ln.each(ll.COMPONENTS,function(c){if(!Ln.isUndefined(r[c])&&!Ln.isUndefined(this.__color.__state[c])&&r[c]!==this.__color.__state[c])return s=!0,{}},this),s&&Ln.extend(this.__color.__state,r)}Ln.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,l=255-o;Ln.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,AX(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Ln.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+l+","+l+","+l+",.7)"})}}]),e}(Nx),$Me=["-moz-","-o-","-webkit-","-ms-",""];function AX(n,e,t,r){n.style.background="",Ln.each($Me,function(s){n.style.cssText+="background: "+s+"linear-gradient("+e+", "+t+" 0%, "+r+" 100%); "})}function XMe(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var qMe={load:function(e,t){var r=t||document,s=r.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,r.getElementsByTagName("head")[0].appendChild(s)},inject:function(e,t){var r=t||document,s=document.createElement("style");s.type="text/css",s.innerHTML=e;var o=r.getElementsByTagName("head")[0];try{o.appendChild(s)}catch{}}},YMe=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,ZMe=function(e,t){var r=e[t];return Ln.isArray(arguments[2])||Ln.isObject(arguments[2])?new HMe(e,t,arguments[2]):Ln.isNumber(r)?Ln.isNumber(arguments[2])&&Ln.isNumber(arguments[3])?Ln.isNumber(arguments[4])?new bz(e,t,arguments[2],arguments[3],arguments[4]):new bz(e,t,arguments[2],arguments[3]):Ln.isNumber(arguments[4])?new JR(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new JR(e,t,{min:arguments[2],max:arguments[3]}):Ln.isString(r)?new jMe(e,t):Ln.isFunction(r)?new Fie(e,t,""):Ln.isBoolean(r)?new kie(e,t):null};function KMe(n){setTimeout(n,1e3/60)}var JMe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||KMe,QMe=function(){function n(){uf(this,n),this.backgroundElement=document.createElement("div"),Ln.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),ln.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Ln.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;ln.bind(this.backgroundElement,"click",function(){e.hide()})}return hf(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Ln.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,r=function s(){t.domElement.style.display="none",t.backgroundElement.style.display="none",ln.unbind(t.domElement,"webkitTransitionEnd",s),ln.unbind(t.domElement,"transitionend",s),ln.unbind(t.domElement,"oTransitionEnd",s)};ln.bind(this.domElement,"webkitTransitionEnd",r),ln.bind(this.domElement,"transitionend",r),ln.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-ln.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-ln.getHeight(this.domElement)/2+"px"}}]),n}(),eCe=NMe(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);qMe.inject(eCe);var TX="dg",MX=72,CX=20,EM="Default",jA=function(){try{return!!window.localStorage}catch{return!1}}(),ST=void 0,EX=!0,db=void 0,$F=!1,Nie=[],ao=function n(e){var t=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),ln.addClass(this.domElement,TX),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Ln.defaults(r,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),r=Ln.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Ln.isUndefined(r.load)?r.load={preset:EM}:r.preset&&(r.load.preset=r.preset),Ln.isUndefined(r.parent)&&r.hideable&&Nie.push(this),r.resizable=Ln.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Ln.isUndefined(r.scrollable)&&(r.scrollable=!0);var s=jA&&localStorage.getItem(fb(this,"isLocal"))==="true",o=void 0,l=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:r.load.preset},set:function(_){t.parent?t.getRoot().preset=_:r.load.preset=_,iCe(this),t.revert()}},width:{get:function(){return r.width},set:function(_){r.width=_,Tz(t,_)}},name:{get:function(){return r.name},set:function(_){r.name=_,l&&(l.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(_){r.closed=_,r.closed?ln.addClass(t.__ul,n.CLASS_CLOSED):ln.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=_?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return s},set:function(_){jA&&(s=_,_?ln.bind(window,"unload",o):ln.unbind(window,"unload",o),localStorage.setItem(fb(t,"isLocal"),_))}}}),Ln.isUndefined(r.parent)){if(this.closed=r.closed||!1,ln.addClass(this.domElement,n.CLASS_MAIN),ln.makeSelectable(this.domElement,!1),jA&&s){t.useLocalStorage=!0;var c=localStorage.getItem(fb(this,"gui"));c&&(r.load=JSON.parse(c))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,ln.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),r.closeOnTop?(ln.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(ln.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),ln.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{r.closed===void 0&&(r.closed=!0);var a=document.createTextNode(r.name);ln.addClass(a,"controller-name"),l=lG(t,a);var d=function(_){return _.preventDefault(),t.closed=!t.closed,!1};ln.addClass(this.__ul,n.CLASS_CLOSED),ln.addClass(l,"title"),ln.bind(l,"click",d),r.closed||(this.closed=!1)}r.autoPlace&&(Ln.isUndefined(r.parent)&&(EX&&(db=document.createElement("div"),ln.addClass(db,TX),ln.addClass(db,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(db),EX=!1),db.appendChild(this.domElement),ln.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||Tz(t,r.width)),this.__resizeHandler=function(){t.onResizeDebounced()},ln.bind(window,"resize",this.__resizeHandler),ln.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),ln.bind(this.__ul,"transitionend",this.__resizeHandler),ln.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&rCe(this),o=function(){jA&&localStorage.getItem(fb(t,"isLocal"))==="true"&&localStorage.setItem(fb(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function f(){var m=t.getRoot();m.width+=1,Ln.defer(function(){m.width-=1})}r.parent||f()};ao.toggleHide=function(){$F=!$F,Ln.each(Nie,function(n){n.domElement.style.display=$F?"none":""})};ao.CLASS_AUTO_PLACE="a";ao.CLASS_AUTO_PLACE_CONTAINER="ac";ao.CLASS_MAIN="main";ao.CLASS_CONTROLLER_ROW="cr";ao.CLASS_TOO_TALL="taller-than-window";ao.CLASS_CLOSED="closed";ao.CLASS_CLOSE_BUTTON="close-button";ao.CLASS_CLOSE_TOP="close-top";ao.CLASS_CLOSE_BOTTOM="close-bottom";ao.CLASS_DRAG="drag";ao.DEFAULT_WIDTH=245;ao.TEXT_CLOSED="Close Controls";ao.TEXT_OPEN="Open Controls";ao._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===MX||n.keyCode===MX)&&ao.toggleHide()};ln.bind(window,"keydown",ao._keydownHandler,!1);Ln.extend(ao.prototype,{add:function(e,t){return AT(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return AT(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Ln.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&db.removeChild(this.domElement);var e=this;Ln.each(this.__folders,function(t){e.removeFolder(t)}),ln.unbind(window,"keydown",ao._keydownHandler,!1),IX(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new ao(t);this.__folders[e]=r;var s=lG(this,r.domElement);return ln.addClass(s,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],IX(e);var t=this;Ln.each(e.__folders,function(r){e.removeFolder(r)}),Ln.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=ln.getOffset(e.__ul).top,r=0;Ln.each(e.__ul.childNodes,function(s){e.autoPlace&&s===e.__save_row||(r+=ln.getHeight(s))}),window.innerHeight-t-CX<r?(ln.addClass(e.domElement,ao.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-CX+"px"):(ln.removeClass(e.domElement,ao.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Ln.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Ln.debounce(function(){this.onResize()},50),remember:function(){if(Ln.isUndefined(ST)&&(ST=new QMe,ST.domElement.innerHTML=YMe),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Ln.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&nCe(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&Tz(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=J2(this)),e.folders={},Ln.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=J2(this),Sz(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[EM]=J2(this,!0)),this.load.remembered[e]=J2(this),this.preset=e,Az(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Ln.each(this.__controllers,function(t){this.getRoot().load.remembered?zie(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Ln.each(this.__folders,function(t){t.revert(t)}),e||Sz(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&Uie(this.__listening)},updateDisplay:function(){Ln.each(this.__controllers,function(e){e.updateDisplay()}),Ln.each(this.__folders,function(e){e.updateDisplay()})}});function lG(n,e,t){var r=document.createElement("li");return e&&r.appendChild(e),t?n.__ul.insertBefore(r,t):n.__ul.appendChild(r),n.onResize(),r}function IX(n){ln.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&ln.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function Sz(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function tCe(n,e,t){if(t.__li=e,t.__gui=n,Ln.extend(t,{options:function(l){if(arguments.length>1){var c=t.__li.nextElementSibling;return t.remove(),AT(n,t.object,t.property,{before:c,factoryArgs:[Ln.toArray(arguments)]})}if(Ln.isArray(l)||Ln.isObject(l)){var a=t.__li.nextElementSibling;return t.remove(),AT(n,t.object,t.property,{before:a,factoryArgs:[l]})}},name:function(l){return t.__li.firstElementChild.firstElementChild.innerHTML=l,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof bz){var r=new JR(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Ln.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var l=t[o],c=r[o];t[o]=r[o]=function(){var a=Array.prototype.slice.call(arguments);return c.apply(r,a),l.apply(t,a)}}),ln.addClass(e,"has-slider"),t.domElement.insertBefore(r.domElement,t.domElement.firstElementChild)}else if(t instanceof JR){var s=function(l){if(Ln.isNumber(t.__min)&&Ln.isNumber(t.__max)){var c=t.__li.firstElementChild.firstElementChild.innerHTML,a=t.__gui.__listening.indexOf(t)>-1;t.remove();var d=AT(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return d.name(c),a&&d.listen(),d}return l};t.min=Ln.compose(s,t.min),t.max=Ln.compose(s,t.max)}else t instanceof kie?(ln.bind(e,"click",function(){ln.fakeEvent(t.__checkbox,"click")}),ln.bind(t.__checkbox,"click",function(o){o.stopPropagation()})):t instanceof Fie?(ln.bind(e,"click",function(){ln.fakeEvent(t.__button,"click")}),ln.bind(e,"mouseover",function(){ln.addClass(t.__button,"hover")}),ln.bind(e,"mouseout",function(){ln.removeClass(t.__button,"hover")})):t instanceof wz&&(ln.addClass(e,"color"),t.updateDisplay=Ln.compose(function(o){return e.style.borderLeftColor=t.__color.toString(),o},t.updateDisplay),t.updateDisplay());t.setValue=Ln.compose(function(o){return n.getRoot().__preset_select&&t.isModified()&&Sz(n.getRoot(),!0),o},t.setValue)}function zie(n,e){var t=n.getRoot(),r=t.__rememberedObjects.indexOf(e.object);if(r!==-1){var s=t.__rememberedObjectIndecesToControllers[r];if(s===void 0&&(s={},t.__rememberedObjectIndecesToControllers[r]=s),s[e.property]=e,t.load&&t.load.remembered){var o=t.load.remembered,l=void 0;if(o[n.preset])l=o[n.preset];else if(o[EM])l=o[EM];else return;if(l[r]&&l[r][e.property]!==void 0){var c=l[r][e.property];e.initialValue=c,e.setValue(c)}}}}function AT(n,e,t,r){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var s=void 0;if(r.color)s=new wz(e,t);else{var o=[e,t].concat(r.factoryArgs);s=ZMe.apply(n,o)}r.before instanceof Nx&&(r.before=r.before.__li),zie(n,s),ln.addClass(s.domElement,"c");var l=document.createElement("span");ln.addClass(l,"property-name"),l.innerHTML=s.property;var c=document.createElement("div");c.appendChild(l),c.appendChild(s.domElement);var a=lG(n,c,r.before);return ln.addClass(a,ao.CLASS_CONTROLLER_ROW),s instanceof wz?ln.addClass(a,"color"):ln.addClass(a,UMe(s.getValue())),tCe(n,a,s),n.__controllers.push(s),s}function fb(n,e){return document.location.href+"."+e}function Az(n,e,t){var r=document.createElement("option");r.innerHTML=e,r.value=e,n.__preset_select.appendChild(r),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function PX(n,e){e.style.display=n.useLocalStorage?"block":"none"}function nCe(n){var e=n.__save_row=document.createElement("li");ln.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),ln.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",ln.addClass(t,"button gears");var r=document.createElement("span");r.innerHTML="Save",ln.addClass(r,"button"),ln.addClass(r,"save");var s=document.createElement("span");s.innerHTML="New",ln.addClass(s,"button"),ln.addClass(s,"save-as");var o=document.createElement("span");o.innerHTML="Revert",ln.addClass(o,"button"),ln.addClass(o,"revert");var l=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?Ln.each(n.load.remembered,function(m,_){Az(n,_,_===n.preset)}):Az(n,EM,!1),ln.bind(l,"change",function(){for(var m=0;m<n.__preset_select.length;m++)n.__preset_select[m].innerHTML=n.__preset_select[m].value;n.preset=this.value}),e.appendChild(l),e.appendChild(t),e.appendChild(r),e.appendChild(s),e.appendChild(o),jA){var c=document.getElementById("dg-local-explain"),a=document.getElementById("dg-local-storage"),d=document.getElementById("dg-save-locally");d.style.display="block",localStorage.getItem(fb(n,"isLocal"))==="true"&&a.setAttribute("checked","checked"),PX(n,c),ln.bind(a,"change",function(){n.useLocalStorage=!n.useLocalStorage,PX(n,c)})}var f=document.getElementById("dg-new-constructor");ln.bind(f,"keydown",function(m){m.metaKey&&(m.which===67||m.keyCode===67)&&ST.hide()}),ln.bind(t,"click",function(){f.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),ST.show(),f.focus(),f.select()}),ln.bind(r,"click",function(){n.save()}),ln.bind(s,"click",function(){var m=prompt("Enter a new preset name.");m&&n.saveAs(m)}),ln.bind(o,"click",function(){n.revert()})}function rCe(n){var e=void 0;n.__resize_handle=document.createElement("div"),Ln.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(o){return o.preventDefault(),n.width+=e-o.clientX,n.onResize(),e=o.clientX,!1}function r(){ln.removeClass(n.__closeButton,ao.CLASS_DRAG),ln.unbind(window,"mousemove",t),ln.unbind(window,"mouseup",r)}function s(o){return o.preventDefault(),e=o.clientX,ln.addClass(n.__closeButton,ao.CLASS_DRAG),ln.bind(window,"mousemove",t),ln.bind(window,"mouseup",r),!1}ln.bind(n.__resize_handle,"mousedown",s),ln.bind(n.__closeButton,"mousedown",s),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function Tz(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function J2(n,e){var t={};return Ln.each(n.__rememberedObjects,function(r,s){var o={},l=n.__rememberedObjectIndecesToControllers[s];Ln.each(l,function(c,a){o[a]=e?c.initialValue:c.getValue()}),t[s]=o}),t}function iCe(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function Uie(n){n.length!==0&&JMe.call(window,function(){Uie(n)}),Ln.each(n,function(e){e.updateDisplay()})}var Gie=ao,lp=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-lp.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?lp.Bounce.In(n*2)*.5:lp.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),kb=function(){return performance.now()},Vie=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){e===void 0&&(e=kb()),t===void 0&&(t=!1);var r=Object.keys(this._tweens);if(r.length===0)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<r.length;s++){var o=this._tweens[r[s]],l=!t;o&&o.update(e,l)===!1&&!t&&delete this._tweens[r[s]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Ny={Linear:function(n,e){var t=n.length-1,r=t*e,s=Math.floor(r),o=Ny.Utils.Linear;return e<0?o(n[0],n[1],r):e>1?o(n[t],n[t-1],t-r):o(n[s],n[s+1>t?t:s+1],r-s)},Bezier:function(n,e){for(var t=0,r=n.length-1,s=Math.pow,o=Ny.Utils.Bernstein,l=0;l<=r;l++)t+=s(1-e,r-l)*s(e,l)*n[l]*o(r,l);return t},CatmullRom:function(n,e){var t=n.length-1,r=t*e,s=Math.floor(r),o=Ny.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(s=Math.floor(r=t*(1+e))),o(n[(s-1+t)%t],n[s],n[(s+1)%t],n[(s+2)%t],r-s)):e<0?n[0]-(o(n[0],n[0],n[1],n[1],-r)-n[0]):e>1?n[t]-(o(n[t],n[t],n[t-1],n[t-1],r-t)-n[t]):o(n[s?s-1:0],n[s],n[t<s+1?t:s+1],n[t<s+2?t:s+2],r-s)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Ny.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var r=e;r>1;r--)t*=r;return n[e]=t,t}}(),CatmullRom:function(n,e,t,r,s){var o=(t-n)*.5,l=(r-e)*.5,c=s*s,a=s*c;return(2*e-2*t+o+l)*a+(-3*e+3*t-2*o-l)*c+o*s+e}}},cG=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),Mz=new Vie,WA=function(){function n(e,t){t===void 0&&(t=Mz),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=lp.Linear.None,this._interpolationFunction=Ny.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=cG.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=kb()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,r,s,o){for(var l in r){var c=e[l],a=Array.isArray(c),d=a?"array":typeof c,f=!a&&Array.isArray(r[l]);if(!(d==="undefined"||d==="function")){if(f){var m=r[l];if(m.length===0)continue;for(var _=[c],x=0,A=m.length;x<A;x+=1){var I=this._handleRelativeValue(c,m[x]);if(isNaN(I)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}_.push(I)}f&&(r[l]=_)}if((d==="object"||a)&&c&&!f){t[l]=a?[]:{};var E=c;for(var C in E)t[l][C]=E[C];s[l]=a?[]:{};var m=r[l];if(!this._isDynamic){var L={};for(var C in m)L[C]=m[C];r[l]=m=L}this._setupProperties(E,t[l],m,s[l],o)}else(typeof t[l]>"u"||o)&&(t[l]=c),a||(t[l]*=1),f?s[l]=r[l].slice().reverse():s[l]=t[l]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return e===void 0&&(e=kb()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},n.prototype.resume=function(e){return e===void 0&&(e=kb()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e===void 0&&(e=Mz),this._group=e,this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=lp.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Ny.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r=this,s;if(e===void 0&&(e=kb()),t===void 0&&(t=!0),this._isPaused)return!0;var o,l=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>l)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var c=e-this._startTime,a=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),d=this._duration+this._repeat*a,f=function(){if(r._duration===0||c>d)return 1;var E=Math.trunc(c/a),C=c-E*a,L=Math.min(C/r._duration,1);return L===0&&c===r._duration?1:L},m=f(),_=this._easingFunction(m);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,_),this._onUpdateCallback&&this._onUpdateCallback(this._object,m),this._duration===0||c>=this._duration)if(this._repeat>0){var x=Math.min(Math.trunc((c-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=x);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*x,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var A=0,I=this._chainedTweens.length;A<I;A++)this._chainedTweens[A].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,r,s){for(var o in r)if(t[o]!==void 0){var l=t[o]||0,c=r[o],a=Array.isArray(e[o]),d=Array.isArray(c),f=!a&&d;f?e[o]=this._interpolationFunction(c,s):typeof c=="object"&&c?this._updateProperties(e[o],l,c,s):(c=this._handleRelativeValue(l,c),typeof c=="number"&&(e[o]=l+(c-l)*s))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];typeof r=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n}(),sCe="23.1.1",oCe=cG.nextId,bp=Mz,aCe=bp.getAll.bind(bp),lCe=bp.removeAll.bind(bp),cCe=bp.add.bind(bp),$A=bp.remove.bind(bp),Hie=bp.update.bind(bp),TT={Easing:lp,Group:Vie,Interpolation:Ny,now:kb,Sequence:cG,nextId:oCe,Tween:WA,VERSION:sCe,getAll:aCe,removeAll:lCe,add:cCe,remove:$A,update:Hie};const jie={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class X0{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const uCe=new af(-1,1,1,-1,0,1);class hCe extends Yr{constructor(){super(),this.setAttribute("position",new lr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new lr([0,2,0,0,2,0],2))}}const dCe=new hCe;class IC{constructor(e){this._mesh=new Di(dCe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,uCe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class fCe extends X0{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Lo?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=tg.clone(e.uniforms),this.material=new Lo({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new IC(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class RX extends X0{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const s=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let l,c;this.inverse?(l=0,c=1):(l=1,c=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,l,4294967295),o.buffers.stencil.setClear(c),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class pCe extends X0{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class rB{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const r=e.getSize(new sn);this._width=r.width,this._height=r.height,t=new Ml(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Bh}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new fCe(jie),this.copyPass.material.blending=pp,this.clock=new dg}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let s=0,o=this.passes.length;s<o;s++){const l=this.passes[s];if(l.enabled!==!1){if(l.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),l.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),l.needsSwap){if(r){const c=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(c.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.setFunc(c.EQUAL,1,4294967295)}this.swapBuffers()}RX!==void 0&&(l instanceof RX?r=!0:l instanceof pCe&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new sn);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(r,s),this.renderTarget2.setSize(r,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(r,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}const mCe={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};class gCe extends X0{constructor(e=64){super();const t=mCe;this.uniforms=tg.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Lo({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new IC(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=so.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=so.randFloat(-1,1),this.uniforms.seed_y.value=so.randFloat(-1,1),this.uniforms.distortion_x.value=so.randFloat(0,1),this.uniforms.distortion_y.value=so.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=so.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=so.randFloat(0,1),this.uniforms.distortion_y.value=so.randFloat(0,1),this.uniforms.seed_x.value=so.randFloat(-.3,.3),this.uniforms.seed_y.value=so.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=so.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),r=e*e;for(let o=0;o<r;o++){const l=so.randFloat(0,1);t[o]=l}const s=new Qd(t,e,e,uC,Ec);return s.needsUpdate=!0,s}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class iB extends X0{constructor(e,t,r=null,s=null,o=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=s,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Hn}render(e,t,r){const s=e.autoClear;e.autoClear=!1;let o,l;this.overrideMaterial!==null&&(l=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=l),e.autoClear=s}}function vCe(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),s=new Set(Object.keys(n[0].morphAttributes)),o={},l={},c=n[0].morphTargetsRelative,a=new Yr;let d=0;for(let f=0;f<n.length;++f){const m=n[f];let _=0;if(t!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const x in m.attributes){if(!r.has(x))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+x+'" attribute exists among all geometries, or in none of them.'),null;o[x]===void 0&&(o[x]=[]),o[x].push(m.attributes[x]),_++}if(_!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(c!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const x in m.morphAttributes){if(!s.has(x))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;l[x]===void 0&&(l[x]=[]),l[x].push(m.morphAttributes[x])}if(e){let x;if(t)x=m.index.count;else if(m.attributes.position!==void 0)x=m.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;a.addGroup(d,x,f),d+=x}}if(t){let f=0;const m=[];for(let _=0;_<n.length;++_){const x=n[_].index;for(let A=0;A<x.count;++A)m.push(x.getX(A)+f);f+=n[_].attributes.position.count}a.setIndex(m)}for(const f in o){const m=LX(o[f]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" attribute."),null;a.setAttribute(f,m)}for(const f in l){const m=l[f][0].length;if(m===0)break;a.morphAttributes=a.morphAttributes||{},a.morphAttributes[f]=[];for(let _=0;_<m;++_){const x=[];for(let I=0;I<l[f].length;++I)x.push(l[f][I][_]);const A=LX(x);if(!A)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" morphAttribute."),null;a.morphAttributes[f].push(A)}}return a}function LX(n){let e,t,r,s=-1,o=0;for(let d=0;d<n.length;++d){const f=n[d];if(e===void 0&&(e=f.array.constructor),e!==f.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=f.itemSize),t!==f.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=f.normalized),r!==f.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(s===-1&&(s=f.gpuType),s!==f.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;o+=f.count*t}const l=new e(o),c=new Ni(l,t,r);let a=0;for(let d=0;d<n.length;++d){const f=n[d];if(f.isInterleavedBufferAttribute){const m=a/t;for(let _=0,x=f.count;_<x;_++)for(let A=0;A<t;A++){const I=f.getComponent(_,A);c.setComponent(_+m,A,I)}}else l.set(f.array,a);a+=f.count*t}return s!==void 0&&(c.gpuType=s),c}function DX(n,e){if(e===T6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===px||e===dC){let t=n.getIndex();if(t===null){const l=[],c=n.getAttribute("position");if(c!==void 0){for(let a=0;a<c.count;a++)l.push(a);n.setIndex(l),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,s=[];if(e===px)for(let l=1;l<=r;l++)s.push(t.getX(0)),s.push(t.getX(l)),s.push(t.getX(l+1));else for(let l=0;l<r;l++)l%2===0?(s.push(t.getX(l)),s.push(t.getX(l+1)),s.push(t.getX(l+2))):(s.push(t.getX(l+2)),s.push(t.getX(l+1)),s.push(t.getX(l)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const _Ce={1:"",2:"",3:"",4:"",5:"",6:"",7:""},XF=["37.5","","","","","","","","","","","","Yeah","hard"],yCe=[{value:5024.33,desc:"Distance"},{value:"0.22245%",desc:"oxygen level"},{value:205.24,desc:"Temperature"}],xCe={backgroundColor:"transparent",color:["#03c03c","#00e6f6","#8ae66e","#ff013c","#f9f002"],textStyle:{color:"#f9f002"},title:{text:"Kepler-90 Planetary System",textStyle:{color:"#f9f002",fontWeight:"normal"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0,borderColor:"#f9f002",show:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"],color:"#f9f002"}],yAxis:[{type:"value",color:"#f9f002"}],series:[{name:"Email",type:"line",stack:"Total",emphasis:{focus:"series"},data:[120,132,101,134,90,230,210],showSymbol:!1},{name:"Union Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[220,182,191,234,290,330,310]},{name:"Video Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[150,232,201,154,190,330,410]},{name:"Direct",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[320,332,301,334,390,330,320]},{name:"Search Engine",type:"line",stack:"Total",label:{show:!0,position:"top"},areaStyle:{},emphasis:{focus:"series"},data:[820,932,901,934,1290,1330,2400]}]},bCe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#000000"},series:[{name:"Kepler-90 Planetary system",type:"pie",radius:[25,100],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:4},data:[{value:40,name:"Kepler-90a"},{value:38,name:"Kepler-90b"},{value:32,name:"Kepler-90c"},{value:30,name:"Kepler-90i"},{value:28,name:"Kepler-90m"},{value:26,name:"Kepler-90s"},{value:22,name:"Kepler-90t"},{value:18,name:"Kepler-90z"}],label:{color:"#000000"}}]},wCe={backgroundColor:"transparent",color:["#f9f002","#00e6f6","#8ae66e","#ff013c"],dataset:{source:[["product","2012","2013","2014","2015","2016","2017"],["90a",86.5,92.1,85.7,83.1,73.4,55.1],["90i",41.1,30.4,65.1,53.3,83.8,98.7],["90t",24.1,67.2,79.5,86.4,65.2,82.5],["90z",55.2,67.1,69.2,72.4,53.9,39.1]]},series:[{type:"pie",radius:"20%",center:["25%","30%"],encode:{itemName:"product",value:"2012"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","30%"],encode:{itemName:"product",value:"2013"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["25%","75%"],encode:{itemName:"product",value:"2014"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","75%"],encode:{itemName:"product",value:"2015"},label:{color:"#f9f002"}}]},SCe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#f9f002"},radiusAxis:{type:"category",data:["v","w","x","y","z"],z:10},angleAxis:{max:2,startAngle:30,splitLine:{show:!1}},polar:{},series:[{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"Without Round Cap",itemStyle:{borderColor:"red",opacity:.8,borderWidth:1}},{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"With Round Cap",roundCap:!0,itemStyle:{borderColor:"green",opacity:.8,borderWidth:1}}]},ACe={backgroundColor:"transparent",textStyle:{color:"#000000"},title:{text:"Cyberpunk 2077 Fantastic",textStyle:{color:"#000000"}},color:["#80FFA5","#00DDFF","#37A2FF","#FF0087","#FFBF00"],tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"]}],yAxis:[{type:"value"}],series:[{name:"Line 1",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(128, 255, 165)"},{offset:1,color:"rgb(1, 191, 236)"}]}},emphasis:{focus:"series"},data:[140,232,101,264,90,340,250]},{name:"Line 2",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(77, 119, 255)"}]}},emphasis:{focus:"series"},data:[120,282,111,234,220,340,310]},{name:"Line 3",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(55, 162, 255)"},{offset:1,color:"rgb(116, 21, 219)"}]}},emphasis:{focus:"series"},data:[320,132,201,334,190,130,220]},{name:"Line 4",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 0, 135)"},{offset:1,color:"rgb(135, 0, 157)"}]}},emphasis:{focus:"series"},data:[220,402,231,134,190,230,120]},{name:"Line 5",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,label:{show:!0,position:"top"},areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 191, 0)"},{offset:1,color:"rgb(224, 62, 76)"}]}},emphasis:{focus:"series"},data:[220,302,181,234,210,290,150]}]},TCe="/about_portfolio/assets/earth-BrwlGRgR.jpg";var MCe=`precision mediump float;\r
uniform float actionRatio;\r
uniform float lineLength;\r
uniform vec3 diffuse;\r
uniform float opacity;\r
uniform float dashSize;\r
uniform float totalSize;\r
varying float vLineDistance;

#include <clipping_planes_pars_fragment>\r
#include <color_pars_fragment>\r
#include <common>\r
#include <fog_pars_fragment>\r
#include <logdepthbuf_pars_fragment>

vec3 linearTosRGB(vec3 color) { return pow(color, vec3(1.0 / 2.2)); }

vec3 gammaCorrect(vec3 color) {\r
  const float gamma = 2.2;\r
  return pow(color, vec3(1.0 / gamma));\r
}

void main() {\r
#include <clipping_planes_fragment>

  float halfDash = dashSize * 0.5;\r
  float currPos = (lineLength + dashSize) * actionRatio;\r
  float d = (vLineDistance + halfDash) - currPos;\r
  if (abs(d) > halfDash)\r
    discard; 

  float grad = ((vLineDistance + halfDash) - (currPos - halfDash)) / halfDash;\r
  vec3 outgoingLight = vec3(0.0);\r
  vec4 diffuseColor = vec4(diffuse, grad);\r
  
  
  
  gl_FragColor = diffuseColor;

#include <color_fragment>

#include <fog_fragment>\r
#include <logdepthbuf_fragment>

#include <premultiplied_alpha_fragment>\r
#include <tonemapping_fragment>\r
}`;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Cz=function(n,e){return Cz=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},Cz(n,e)};function jn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Cz(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var CCe=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),ECe=function(){function n(){this.browser=new CCe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),yi=new ECe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(yi.wxa=!0,yi.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?yi.worker=!0:typeof navigator>"u"||navigator.userAgent.indexOf("Node.js")===0?(yi.node=!0,yi.svgSupported=!0):ICe(navigator.userAgent,yi);function ICe(n,e){var t=e.browser,r=n.match(/Firefox\/([\d.]+)/),s=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),o=n.match(/Edge?\/([\d.]+)/),l=/micromessenger/i.test(n);r&&(t.firefox=!0,t.version=r[1]),s&&(t.ie=!0,t.version=s[1]),o&&(t.edge=!0,t.version=o[1],t.newEdge=+o[1].split(".")[0]>18),l&&(t.weChat=!0),e.svgSupported=typeof SVGRect<"u",e.touchEventsSupported="ontouchstart"in window&&!t.ie&&!t.edge,e.pointerEventsSupported="onpointerdown"in window&&(t.edge||t.ie&&+t.version>=11),e.domSupported=typeof document<"u";var c=document.documentElement.style;e.transform3dSupported=(t.ie&&"transition"in c||t.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in c)&&!("OTransition"in c),e.transformSupported=e.transform3dSupported||t.ie&&+t.version>=9}var uG=12,PCe="sans-serif",_x=uG+"px "+PCe,RCe=20,LCe=100,DCe="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function BCe(n){var e={};if(typeof JSON>"u")return e;for(var t=0;t<n.length;t++){var r=String.fromCharCode(t+32),s=(n.charCodeAt(t)-RCe)/LCe;e[r]=s}return e}var kCe=BCe(DCe),Hw={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,e;return function(t,r){if(!n){var s=Hw.createCanvas();n=s&&s.getContext("2d")}if(n)return e!==r&&(e=n.font=r||_x),n.measureText(t);t=t||"",r=r||_x;var o=/((?:\d+)?\.?\d*)px/.exec(r),l=o&&+o[1]||uG,c=0;if(r.indexOf("mono")>=0)c=l*t.length;else for(var a=0;a<t.length;a++){var d=kCe[t[a]];c+=d==null?l:d*l}return{width:c}}}(),loadImage:function(n,e,t){var r=new Image;return r.onload=e,r.onerror=t,r.src=n,r}},Wie=T0(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,e){return n["[object "+e+"]"]=!0,n},{}),$ie=T0(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,e){return n["[object "+e+"Array]"]=!0,n},{}),jw=Object.prototype.toString,sB=Array.prototype,OCe=sB.forEach,FCe=sB.filter,hG=sB.slice,NCe=sB.map,BX=(function(){}).constructor,Q2=BX?BX.prototype:null,dG="__proto__",zCe=2311;function Xie(){return zCe++}function fG(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];typeof console<"u"&&console.error.apply(console,n)}function wi(n){if(n==null||typeof n!="object")return n;var e=n,t=jw.call(n);if(t==="[object Array]"){if(!CT(n)){e=[];for(var r=0,s=n.length;r<s;r++)e[r]=wi(n[r])}}else if($ie[t]){if(!CT(n)){var o=n.constructor;if(o.from)e=o.from(n);else{e=new o(n.length);for(var r=0,s=n.length;r<s;r++)e[r]=n[r]}}}else if(!Wie[t]&&!CT(n)&&!bw(n)){e={};for(var l in n)n.hasOwnProperty(l)&&l!==dG&&(e[l]=wi(n[l]))}return e}function Fi(n,e,t){if(!qr(e)||!qr(n))return t?wi(e):n;for(var r in e)if(e.hasOwnProperty(r)&&r!==dG){var s=n[r],o=e[r];qr(o)&&qr(s)&&!fr(o)&&!fr(s)&&!bw(o)&&!bw(s)&&!kX(o)&&!kX(s)&&!CT(o)&&!CT(s)?Fi(s,o,t):(t||!(r in n))&&(n[r]=wi(e[r]))}return n}function Qn(n,e){if(Object.assign)Object.assign(n,e);else for(var t in e)e.hasOwnProperty(t)&&t!==dG&&(n[t]=e[t]);return n}function ri(n,e,t){for(var r=lo(e),s=0;s<r.length;s++){var o=r[s];n[o]==null&&(n[o]=e[o])}return n}function Zi(n,e){if(n){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t}return-1}function UCe(n,e){var t=n.prototype;function r(){}r.prototype=e.prototype,n.prototype=new r;for(var s in t)t.hasOwnProperty(s)&&(n.prototype[s]=t[s]);n.prototype.constructor=n,n.superClass=e}function df(n,e,t){if(n="prototype"in n?n.prototype:n,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var r=Object.getOwnPropertyNames(e),s=0;s<r.length;s++){var o=r[s];o!=="constructor"&&n[o]==null&&(n[o]=e[o])}else ri(n,e)}function Dc(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function ot(n,e,t){if(n&&e)if(n.forEach&&n.forEach===OCe)n.forEach(e,t);else if(n.length===+n.length)for(var r=0,s=n.length;r<s;r++)e.call(t,n[r],r,n);else for(var o in n)n.hasOwnProperty(o)&&e.call(t,n[o],o,n)}function br(n,e,t){if(!n)return[];if(!e)return pG(n);if(n.map&&n.map===NCe)return n.map(e,t);for(var r=[],s=0,o=n.length;s<o;s++)r.push(e.call(t,n[s],s,n));return r}function T0(n,e,t,r){if(n&&e){for(var s=0,o=n.length;s<o;s++)t=e.call(r,t,n[s],s,n);return t}}function sa(n,e,t){if(!n)return[];if(!e)return pG(n);if(n.filter&&n.filter===FCe)return n.filter(e,t);for(var r=[],s=0,o=n.length;s<o;s++)e.call(t,n[s],s,n)&&r.push(n[s]);return r}function lo(n){if(!n)return[];if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e}function GCe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return function(){return n.apply(e,t.concat(hG.call(arguments)))}}var Vs=Q2&&hi(Q2.bind)?Q2.call.bind(Q2.bind):GCe;function xs(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){return n.apply(this,e.concat(hG.call(arguments)))}}function fr(n){return Array.isArray?Array.isArray(n):jw.call(n)==="[object Array]"}function hi(n){return typeof n=="function"}function Br(n){return typeof n=="string"}function Ez(n){return jw.call(n)==="[object String]"}function Ds(n){return typeof n=="number"}function qr(n){var e=typeof n;return e==="function"||!!n&&e==="object"}function kX(n){return!!Wie[jw.call(n)]}function _u(n){return!!$ie[jw.call(n)]}function bw(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function oB(n){return n.colorStops!=null}function VCe(n){return n.image!=null}function HCe(n){return jw.call(n)==="[object RegExp]"}function QR(n){return n!==n}function IM(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=0,r=n.length;t<r;t++)if(n[t]!=null)return n[t]}function Li(n,e){return n??e}function MT(n,e,t){return n??e??t}function pG(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return hG.apply(n,e)}function qie(n){if(typeof n=="number")return[n,n,n,n];var e=n.length;return e===2?[n[0],n[1],n[0],n[1]]:e===3?[n[0],n[1],n[2],n[1]]:n}function wp(n,e){if(!n)throw new Error(e)}function cp(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var Yie="__ec_primitive__";function eL(n){n[Yie]=!0}function CT(n){return n[Yie]}var jCe=function(){function n(){this.data={}}return n.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.get=function(e){return this.data[e]},n.prototype.set=function(e,t){return this.data[e]=t,this},n.prototype.keys=function(){return lo(this.data)},n.prototype.forEach=function(e){var t=this.data;for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},n}(),Zie=typeof Map=="function";function WCe(){return Zie?new Map:new jCe}var $Ce=function(){function n(e){var t=fr(e);this.data=WCe();var r=this;e instanceof n?e.each(s):e&&ot(e,s);function s(o,l){t?r.set(o,l):r.set(l,o)}}return n.prototype.hasKey=function(e){return this.data.has(e)},n.prototype.get=function(e){return this.data.get(e)},n.prototype.set=function(e,t){return this.data.set(e,t),t},n.prototype.each=function(e,t){this.data.forEach(function(r,s){e.call(t,r,s)})},n.prototype.keys=function(){var e=this.data.keys();return Zie?Array.from(e):e},n.prototype.removeKey=function(e){this.data.delete(e)},n}();function oi(n){return new $Ce(n)}function XCe(n,e){for(var t=new n.constructor(n.length+e.length),r=0;r<n.length;r++)t[r]=n[r];for(var s=n.length,r=0;r<e.length;r++)t[r+s]=e[r];return t}function aB(n,e){var t;if(Object.create)t=Object.create(n);else{var r=function(){};r.prototype=n,t=new r}return e&&Qn(t,e),t}function Kie(n){var e=n.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function og(n,e){return n.hasOwnProperty(e)}function Lc(){}var qCe=180/Math.PI;function Ww(n,e){return n==null&&(n=0),e==null&&(e=0),[n,e]}function YCe(n){return[n[0],n[1]]}function OX(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function ZCe(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function KCe(n){return Math.sqrt(JCe(n))}function JCe(n){return n[0]*n[0]+n[1]*n[1]}function qF(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function QCe(n,e){var t=KCe(e);return t===0?(n[0]=0,n[1]=0):(n[0]=e[0]/t,n[1]=e[1]/t),n}function Iz(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var Pz=Iz;function eEe(n,e){return(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])}var Kb=eEe;function xP(n,e,t,r){return n[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n}function kh(n,e,t){var r=e[0],s=e[1];return n[0]=t[0]*r+t[2]*s+t[4],n[1]=t[1]*r+t[3]*s+t[5],n}function Ob(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function Fb(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}var H1=function(){function n(e,t){this.target=e,this.topTarget=t&&t.topTarget}return n}(),tEe=function(){function n(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new H1(t,e),"dragstart",e.event))},n.prototype._drag=function(e){var t=this._draggingTarget;if(t){var r=e.offsetX,s=e.offsetY,o=r-this._x,l=s-this._y;this._x=r,this._y=s,t.drift(o,l,e),this.handler.dispatchToElement(new H1(t,e),"drag",e.event);var c=this.handler.findHover(r,s,t).target,a=this._dropTarget;this._dropTarget=c,t!==c&&(a&&c!==a&&this.handler.dispatchToElement(new H1(a,e),"dragleave",e.event),c&&c!==a&&this.handler.dispatchToElement(new H1(c,e),"dragenter",e.event))}},n.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new H1(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new H1(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},n}(),ff=function(){function n(e){e&&(this._$eventProcessor=e)}return n.prototype.on=function(e,t,r,s){this._$handlers||(this._$handlers={});var o=this._$handlers;if(typeof t=="function"&&(s=r,r=t,t=null),!r||!e)return this;var l=this._$eventProcessor;t!=null&&l&&l.normalizeQuery&&(t=l.normalizeQuery(t)),o[e]||(o[e]=[]);for(var c=0;c<o[e].length;c++)if(o[e][c].h===r)return this;var a={h:r,query:t,ctx:s||this,callAtLast:r.zrEventfulCallAtLast},d=o[e].length-1,f=o[e][d];return f&&f.callAtLast?o[e].splice(d,0,a):o[e].push(a),this},n.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},n.prototype.off=function(e,t){var r=this._$handlers;if(!r)return this;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var s=[],o=0,l=r[e].length;o<l;o++)r[e][o].h!==t&&s.push(r[e][o]);r[e]=s}r[e]&&r[e].length===0&&delete r[e]}else delete r[e];return this},n.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var s=this._$handlers[e],o=this._$eventProcessor;if(s)for(var l=t.length,c=s.length,a=0;a<c;a++){var d=s[a];if(!(o&&o.filter&&d.query!=null&&!o.filter(e,d.query)))switch(l){case 0:d.h.call(d.ctx);break;case 1:d.h.call(d.ctx,t[0]);break;case 2:d.h.call(d.ctx,t[0],t[1]);break;default:d.h.apply(d.ctx,t);break}}return o&&o.afterTrigger&&o.afterTrigger(e),this},n.prototype.triggerWithContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var s=this._$handlers[e],o=this._$eventProcessor;if(s)for(var l=t.length,c=t[l-1],a=s.length,d=0;d<a;d++){var f=s[d];if(!(o&&o.filter&&f.query!=null&&!o.filter(e,f.query)))switch(l){case 0:f.h.call(c);break;case 1:f.h.call(c,t[0]);break;case 2:f.h.call(c,t[0],t[1]);break;default:f.h.apply(c,t.slice(1,l-1));break}}return o&&o.afterTrigger&&o.afterTrigger(e),this},n}(),nEe=Math.log(2);function Rz(n,e,t,r,s,o){var l=r+"-"+s,c=n.length;if(o.hasOwnProperty(l))return o[l];if(e===1){var a=Math.round(Math.log((1<<c)-1&~s)/nEe);return n[t][a]}for(var d=r|1<<t,f=t+1;r&1<<f;)f++;for(var m=0,_=0,x=0;_<c;_++){var A=1<<_;A&s||(m+=(x%2?-1:1)*n[t][_]*Rz(n,e-1,f,d,s|A,o),x++)}return o[l]=m,m}function FX(n,e){var t=[[n[0],n[1],1,0,0,0,-e[0]*n[0],-e[0]*n[1]],[0,0,0,n[0],n[1],1,-e[1]*n[0],-e[1]*n[1]],[n[2],n[3],1,0,0,0,-e[2]*n[2],-e[2]*n[3]],[0,0,0,n[2],n[3],1,-e[3]*n[2],-e[3]*n[3]],[n[4],n[5],1,0,0,0,-e[4]*n[4],-e[4]*n[5]],[0,0,0,n[4],n[5],1,-e[5]*n[4],-e[5]*n[5]],[n[6],n[7],1,0,0,0,-e[6]*n[6],-e[6]*n[7]],[0,0,0,n[6],n[7],1,-e[7]*n[6],-e[7]*n[7]]],r={},s=Rz(t,8,0,0,0,r);if(s!==0){for(var o=[],l=0;l<8;l++)for(var c=0;c<8;c++)o[c]==null&&(o[c]=0),o[c]+=((l+c)%2?-1:1)*Rz(t,7,l===0?1:0,1<<l,1<<c,r)/s*e[l];return function(a,d,f){var m=d*o[6]+f*o[7]+1;a[0]=(d*o[0]+f*o[1]+o[2])/m,a[1]=(d*o[3]+f*o[4]+o[5])/m}}}var NX="___zrEVENTSAVED",YF=[];function rEe(n,e,t,r,s){return Lz(YF,e,r,s,!0)&&Lz(n,t,YF[0],YF[1])}function Lz(n,e,t,r,s){if(e.getBoundingClientRect&&yi.domSupported&&!Jie(e)){var o=e[NX]||(e[NX]={}),l=iEe(e,o),c=sEe(l,o,s);if(c)return c(n,t,r),!0}return!1}function iEe(n,e){var t=e.markers;if(t)return t;t=e.markers=[];for(var r=["left","right"],s=["top","bottom"],o=0;o<4;o++){var l=document.createElement("div"),c=l.style,a=o%2,d=(o>>1)%2;c.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[a]+":0",s[d]+":0",r[1-a]+":auto",s[1-d]+":auto",""].join("!important;"),n.appendChild(l),t.push(l)}return t}function sEe(n,e,t){for(var r=t?"invTrans":"trans",s=e[r],o=e.srcCoords,l=[],c=[],a=!0,d=0;d<4;d++){var f=n[d].getBoundingClientRect(),m=2*d,_=f.left,x=f.top;l.push(_,x),a=a&&o&&_===o[m]&&x===o[m+1],c.push(n[d].offsetLeft,n[d].offsetTop)}return a&&s?s:(e.srcCoords=l,e[r]=t?FX(c,l):FX(l,c))}function Jie(n){return n.nodeName.toUpperCase()==="CANVAS"}var oEe=/([&<>"'])/g,aEe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ou(n){return n==null?"":(n+"").replace(oEe,function(e,t){return aEe[t]})}var lEe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ZF=[],cEe=yi.browser.firefox&&+yi.browser.version.split(".")[0]<39;function Dz(n,e,t,r){return t=t||{},r?zX(n,e,t):cEe&&e.layerX!=null&&e.layerX!==e.offsetX?(t.zrX=e.layerX,t.zrY=e.layerY):e.offsetX!=null?(t.zrX=e.offsetX,t.zrY=e.offsetY):zX(n,e,t),t}function zX(n,e,t){if(yi.domSupported&&n.getBoundingClientRect){var r=e.clientX,s=e.clientY;if(Jie(n)){var o=n.getBoundingClientRect();t.zrX=r-o.left,t.zrY=s-o.top;return}else if(Lz(ZF,n,r,s)){t.zrX=ZF[0],t.zrY=ZF[1];return}}t.zrX=t.zrY=0}function mG(n){return n||window.event}function yh(n,e,t){if(e=mG(e),e.zrX!=null)return e;var r=e.type,s=r&&r.indexOf("touch")>=0;if(s){var l=r!=="touchend"?e.targetTouches[0]:e.changedTouches[0];l&&Dz(n,l,e,t)}else{Dz(n,e,e,t);var o=uEe(e);e.zrDelta=o?o/120:-(e.detail||0)/3}var c=e.button;return e.which==null&&c!==void 0&&lEe.test(e.type)&&(e.which=c&1?1:c&2?3:c&4?2:0),e}function uEe(n){var e=n.wheelDelta;if(e)return e;var t=n.deltaX,r=n.deltaY;if(t==null||r==null)return e;var s=Math.abs(r!==0?r:t),o=r>0?-1:r<0?1:t>0?-1:1;return 3*s*o}function Bz(n,e,t,r){n.addEventListener(e,t,r)}function hEe(n,e,t,r){n.removeEventListener(e,t,r)}var Qie=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0},dEe=function(){function n(){this._track=[]}return n.prototype.recognize=function(e,t,r){return this._doTrack(e,t,r),this._recognize(e)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(e,t,r){var s=e.touches;if(s){for(var o={points:[],touches:[],target:t,event:e},l=0,c=s.length;l<c;l++){var a=s[l],d=Dz(r,a,{});o.points.push([d.zrX,d.zrY]),o.touches.push(a)}this._track.push(o)}},n.prototype._recognize=function(e){for(var t in KF)if(KF.hasOwnProperty(t)){var r=KF[t](this._track,e);if(r)return r}},n}();function UX(n){var e=n[1][0]-n[0][0],t=n[1][1]-n[0][1];return Math.sqrt(e*e+t*t)}function fEe(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var KF={pinch:function(n,e){var t=n.length;if(t){var r=(n[t-1]||{}).points,s=(n[t-2]||{}).points||r;if(s&&s.length>1&&r&&r.length>1){var o=UX(r)/UX(s);!isFinite(o)&&(o=1),e.pinchScale=o;var l=fEe(r);return e.pinchX=l[0],e.pinchY=l[1],{type:"pinch",target:n[0].target,event:e}}}}};function Qy(){return[1,0,0,1,0,0]}function gG(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function pEe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Jb(n,e,t){var r=e[0]*t[0]+e[2]*t[1],s=e[1]*t[0]+e[3]*t[1],o=e[0]*t[2]+e[2]*t[3],l=e[1]*t[2]+e[3]*t[3],c=e[0]*t[4]+e[2]*t[5]+e[4],a=e[1]*t[4]+e[3]*t[5]+e[5];return n[0]=r,n[1]=s,n[2]=o,n[3]=l,n[4]=c,n[5]=a,n}function tL(n,e,t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4]+t[0],n[5]=e[5]+t[1],n}function lB(n,e,t,r){r===void 0&&(r=[0,0]);var s=e[0],o=e[2],l=e[4],c=e[1],a=e[3],d=e[5],f=Math.sin(t),m=Math.cos(t);return n[0]=s*m+c*f,n[1]=-s*f+c*m,n[2]=o*m+a*f,n[3]=-o*f+m*a,n[4]=m*(l-r[0])+f*(d-r[1])+r[0],n[5]=m*(d-r[1])-f*(l-r[0])+r[1],n}function mEe(n,e,t){var r=t[0],s=t[1];return n[0]=e[0]*r,n[1]=e[1]*s,n[2]=e[2]*r,n[3]=e[3]*s,n[4]=e[4]*r,n[5]=e[5]*s,n}function cB(n,e){var t=e[0],r=e[2],s=e[4],o=e[1],l=e[3],c=e[5],a=t*l-o*r;return a?(a=1/a,n[0]=l*a,n[1]=-o*a,n[2]=-r*a,n[3]=t*a,n[4]=(r*c-l*s)*a,n[5]=(o*s-t*c)*a,n):null}var ei=function(){function n(e,t){this.x=e||0,this.y=t||0}return n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(e,t){return this.x=e,this.y=t,this},n.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},n.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},n.prototype.scale=function(e){this.x*=e,this.y*=e},n.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},n.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},n.prototype.dot=function(e){return this.x*e.x+this.y*e.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},n.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},n.prototype.distanceSquare=function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(e){if(e){var t=this.x,r=this.y;return this.x=e[0]*t+e[2]*r+e[4],this.y=e[1]*t+e[3]*r+e[5],this}},n.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},n.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},n.set=function(e,t,r){e.x=t,e.y=r},n.copy=function(e,t){e.x=t.x,e.y=t.y},n.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.lenSquare=function(e){return e.x*e.x+e.y*e.y},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.add=function(e,t,r){e.x=t.x+r.x,e.y=t.y+r.y},n.sub=function(e,t,r){e.x=t.x-r.x,e.y=t.y-r.y},n.scale=function(e,t,r){e.x=t.x*r,e.y=t.y*r},n.scaleAndAdd=function(e,t,r,s){e.x=t.x+r.x*s,e.y=t.y+r.y*s},n.lerp=function(e,t,r,s){var o=1-s;e.x=o*t.x+s*r.x,e.y=o*t.y+s*r.y},n}(),eI=Math.min,tI=Math.max,j_=new ei,W_=new ei,$_=new ei,X_=new ei,lA=new ei,cA=new ei,gEe=function(){function n(e,t,r,s){r<0&&(e=e+r,r=-r),s<0&&(t=t+s,s=-s),this.x=e,this.y=t,this.width=r,this.height=s}return n.prototype.union=function(e){var t=eI(e.x,this.x),r=eI(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=tI(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=tI(e.y+e.height,this.y+this.height)-r:this.height=e.height,this.x=t,this.y=r},n.prototype.applyTransform=function(e){n.applyTransform(this,this,e)},n.prototype.calculateTransform=function(e){var t=this,r=e.width/t.width,s=e.height/t.height,o=Qy();return tL(o,o,[-t.x,-t.y]),mEe(o,o,[r,s]),tL(o,o,[e.x,e.y]),o},n.prototype.intersect=function(e,t){if(!e)return!1;e instanceof n||(e=n.create(e));var r=this,s=r.x,o=r.x+r.width,l=r.y,c=r.y+r.height,a=e.x,d=e.x+e.width,f=e.y,m=e.y+e.height,_=!(o<a||d<s||c<f||m<l);if(t){var x=1/0,A=0,I=Math.abs(o-a),E=Math.abs(d-s),C=Math.abs(c-f),L=Math.abs(m-l),O=Math.min(I,E),H=Math.min(C,L);o<a||d<s?O>A&&(A=O,I<E?ei.set(cA,-I,0):ei.set(cA,E,0)):O<x&&(x=O,I<E?ei.set(lA,I,0):ei.set(lA,-E,0)),c<f||m<l?H>A&&(A=H,C<L?ei.set(cA,0,-C):ei.set(cA,0,L)):O<x&&(x=O,C<L?ei.set(lA,0,C):ei.set(lA,0,-L))}return t&&ei.copy(t,_?lA:cA),_},n.prototype.contain=function(e,t){var r=this;return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(e){n.copy(this,e)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(e){return new n(e.x,e.y,e.width,e.height)},n.copy=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},n.applyTransform=function(e,t,r){if(!r){e!==t&&n.copy(e,t);return}if(r[1]<1e-5&&r[1]>-1e-5&&r[2]<1e-5&&r[2]>-1e-5){var s=r[0],o=r[3],l=r[4],c=r[5];e.x=t.x*s+l,e.y=t.y*o+c,e.width=t.width*s,e.height=t.height*o,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}j_.x=$_.x=t.x,j_.y=X_.y=t.y,W_.x=X_.x=t.x+t.width,W_.y=$_.y=t.y+t.height,j_.transform(r),X_.transform(r),W_.transform(r),$_.transform(r),e.x=eI(j_.x,W_.x,$_.x,X_.x),e.y=eI(j_.y,W_.y,$_.y,X_.y);var a=tI(j_.x,W_.x,$_.x,X_.x),d=tI(j_.y,W_.y,$_.y,X_.y);e.width=a-e.x,e.height=d-e.y},n}();const ds=gEe;var ese="silent";function vEe(n,e,t){return{type:n,event:t,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:t.zrX,offsetY:t.zrY,gestureEvent:t.gestureEvent,pinchX:t.pinchX,pinchY:t.pinchY,pinchScale:t.pinchScale,wheelDelta:t.zrDelta,zrByTouch:t.zrByTouch,which:t.which,stop:_Ee}}function _Ee(){Qie(this.event)}var yEe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.handler=null,t}return e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(ff),uA=function(){function n(e,t){this.x=e,this.y=t}return n}(),xEe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],JF=new ds(0,0,0,0),tse=function(n){jn(e,n);function e(t,r,s,o,l){var c=n.call(this)||this;return c._hovered=new uA(0,0),c.storage=t,c.painter=r,c.painterRoot=o,c._pointerSize=l,s=s||new yEe,c.proxy=null,c.setHandlerProxy(s),c._draggingMgr=new tEe(c),c}return e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(ot(xEe,function(r){t.on&&t.on(r,this[r],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var r=t.zrX,s=t.zrY,o=nse(this,r,s),l=this._hovered,c=l.target;c&&!c.__zr&&(l=this.findHover(l.x,l.y),c=l.target);var a=this._hovered=o?new uA(r,s):this.findHover(r,s),d=a.target,f=this.proxy;f.setCursor&&f.setCursor(d?d.cursor:"default"),c&&d!==c&&this.dispatchToElement(l,"mouseout",t),this.dispatchToElement(a,"mousemove",t),d&&d!==c&&this.dispatchToElement(a,"mouseover",t)},e.prototype.mouseout=function(t){var r=t.zrEventControl;r!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",t),r!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this._hovered=new uA(0,0)},e.prototype.dispatch=function(t,r){var s=this[t];s&&s.call(this,r)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var r=this.proxy;r.setCursor&&r.setCursor(t)},e.prototype.dispatchToElement=function(t,r,s){t=t||{};var o=t.target;if(!(o&&o.silent)){for(var l="on"+r,c=vEe(r,t,s);o&&(o[l]&&(c.cancelBubble=!!o[l].call(o,c)),o.trigger(r,c),o=o.__hostTarget?o.__hostTarget:o.parent,!c.cancelBubble););c.cancelBubble||(this.trigger(r,c),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(a){typeof a[l]=="function"&&a[l].call(a,c),a.trigger&&a.trigger(r,c)}))}},e.prototype.findHover=function(t,r,s){var o=this.storage.getDisplayList(),l=new uA(t,r);if(GX(o,l,t,r,s),this._pointerSize&&!l.target){for(var c=[],a=this._pointerSize,d=a/2,f=new ds(t-d,r-d,a,a),m=o.length-1;m>=0;m--){var _=o[m];_!==s&&!_.ignore&&!_.ignoreCoarsePointer&&(!_.parent||!_.parent.ignoreCoarsePointer)&&(JF.copy(_.getBoundingRect()),_.transform&&JF.applyTransform(_.transform),JF.intersect(f)&&c.push(_))}if(c.length)for(var x=4,A=Math.PI/12,I=Math.PI*2,E=0;E<d;E+=x)for(var C=0;C<I;C+=A){var L=t+E*Math.cos(C),O=r+E*Math.sin(C);if(GX(c,l,L,O,s),l.target)return l}}return l},e.prototype.processGesture=function(t,r){this._gestureMgr||(this._gestureMgr=new dEe);var s=this._gestureMgr;r==="start"&&s.clear();var o=s.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if(r==="end"&&s.clear(),o){var l=o.type;t.gestureEvent=l;var c=new uA;c.target=o.target,this.dispatchToElement(c,l,o.event)}},e}(ff);ot(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){tse.prototype[n]=function(e){var t=e.zrX,r=e.zrY,s=nse(this,t,r),o,l;if((n!=="mouseup"||!s)&&(o=this.findHover(t,r),l=o.target),n==="mousedown")this._downEl=l,this._downPoint=[e.zrX,e.zrY],this._upEl=l;else if(n==="mouseup")this._upEl=l;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||Pz(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(o,n,e)}});function bEe(n,e,t){if(n[n.rectHover?"rectContain":"contain"](e,t)){for(var r=n,s=void 0,o=!1;r;){if(r.ignoreClip&&(o=!0),!o){var l=r.getClipPath();if(l&&!l.contain(e,t))return!1}r.silent&&(s=!0);var c=r.__hostTarget;r=c||r.parent}return s?ese:!0}return!1}function GX(n,e,t,r,s){for(var o=n.length-1;o>=0;o--){var l=n[o],c=void 0;if(l!==s&&!l.ignore&&(c=bEe(l,t,r))&&(!e.topTarget&&(e.topTarget=l),c!==ese)){e.target=l;break}}}function nse(n,e,t){var r=n.painter;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var rse=32,hA=7;function wEe(n){for(var e=0;n>=rse;)e|=n&1,n>>=1;return n+e}function VX(n,e,t,r){var s=e+1;if(s===t)return 1;if(r(n[s++],n[e])<0){for(;s<t&&r(n[s],n[s-1])<0;)s++;SEe(n,e,s)}else for(;s<t&&r(n[s],n[s-1])>=0;)s++;return s-e}function SEe(n,e,t){for(t--;e<t;){var r=n[e];n[e++]=n[t],n[t--]=r}}function HX(n,e,t,r,s){for(r===e&&r++;r<t;r++){for(var o=n[r],l=e,c=r,a;l<c;)a=l+c>>>1,s(o,n[a])<0?c=a:l=a+1;var d=r-l;switch(d){case 3:n[l+3]=n[l+2];case 2:n[l+2]=n[l+1];case 1:n[l+1]=n[l];break;default:for(;d>0;)n[l+d]=n[l+d-1],d--}n[l]=o}}function QF(n,e,t,r,s,o){var l=0,c=0,a=1;if(o(n,e[t+s])>0){for(c=r-s;a<c&&o(n,e[t+s+a])>0;)l=a,a=(a<<1)+1,a<=0&&(a=c);a>c&&(a=c),l+=s,a+=s}else{for(c=s+1;a<c&&o(n,e[t+s-a])<=0;)l=a,a=(a<<1)+1,a<=0&&(a=c);a>c&&(a=c);var d=l;l=s-a,a=s-d}for(l++;l<a;){var f=l+(a-l>>>1);o(n,e[t+f])>0?l=f+1:a=f}return a}function e3(n,e,t,r,s,o){var l=0,c=0,a=1;if(o(n,e[t+s])<0){for(c=s+1;a<c&&o(n,e[t+s-a])<0;)l=a,a=(a<<1)+1,a<=0&&(a=c);a>c&&(a=c);var d=l;l=s-a,a=s-d}else{for(c=r-s;a<c&&o(n,e[t+s+a])>=0;)l=a,a=(a<<1)+1,a<=0&&(a=c);a>c&&(a=c),l+=s,a+=s}for(l++;l<a;){var f=l+(a-l>>>1);o(n,e[t+f])<0?a=f:l=f+1}return a}function AEe(n,e){var t=hA,r,s,o=0,l=[];r=[],s=[];function c(x,A){r[o]=x,s[o]=A,o+=1}function a(){for(;o>1;){var x=o-2;if(x>=1&&s[x-1]<=s[x]+s[x+1]||x>=2&&s[x-2]<=s[x]+s[x-1])s[x-1]<s[x+1]&&x--;else if(s[x]>s[x+1])break;f(x)}}function d(){for(;o>1;){var x=o-2;x>0&&s[x-1]<s[x+1]&&x--,f(x)}}function f(x){var A=r[x],I=s[x],E=r[x+1],C=s[x+1];s[x]=I+C,x===o-3&&(r[x+1]=r[x+2],s[x+1]=s[x+2]),o--;var L=e3(n[E],n,A,I,0,e);A+=L,I-=L,I!==0&&(C=QF(n[A+I-1],n,E,C,C-1,e),C!==0&&(I<=C?m(A,I,E,C):_(A,I,E,C)))}function m(x,A,I,E){var C=0;for(C=0;C<A;C++)l[C]=n[x+C];var L=0,O=I,H=x;if(n[H++]=n[O++],--E===0){for(C=0;C<A;C++)n[H+C]=l[L+C];return}if(A===1){for(C=0;C<E;C++)n[H+C]=n[O+C];n[H+E]=l[L];return}for(var q=t,Z,J,re;;){Z=0,J=0,re=!1;do if(e(n[O],l[L])<0){if(n[H++]=n[O++],J++,Z=0,--E===0){re=!0;break}}else if(n[H++]=l[L++],Z++,J=0,--A===1){re=!0;break}while((Z|J)<q);if(re)break;do{if(Z=e3(n[O],l,L,A,0,e),Z!==0){for(C=0;C<Z;C++)n[H+C]=l[L+C];if(H+=Z,L+=Z,A-=Z,A<=1){re=!0;break}}if(n[H++]=n[O++],--E===0){re=!0;break}if(J=QF(l[L],n,O,E,0,e),J!==0){for(C=0;C<J;C++)n[H+C]=n[O+C];if(H+=J,O+=J,E-=J,E===0){re=!0;break}}if(n[H++]=l[L++],--A===1){re=!0;break}q--}while(Z>=hA||J>=hA);if(re)break;q<0&&(q=0),q+=2}if(t=q,t<1&&(t=1),A===1){for(C=0;C<E;C++)n[H+C]=n[O+C];n[H+E]=l[L]}else{if(A===0)throw new Error;for(C=0;C<A;C++)n[H+C]=l[L+C]}}function _(x,A,I,E){var C=0;for(C=0;C<E;C++)l[C]=n[I+C];var L=x+A-1,O=E-1,H=I+E-1,q=0,Z=0;if(n[H--]=n[L--],--A===0){for(q=H-(E-1),C=0;C<E;C++)n[q+C]=l[C];return}if(E===1){for(H-=A,L-=A,Z=H+1,q=L+1,C=A-1;C>=0;C--)n[Z+C]=n[q+C];n[H]=l[O];return}for(var J=t;;){var re=0,se=0,ae=!1;do if(e(l[O],n[L])<0){if(n[H--]=n[L--],re++,se=0,--A===0){ae=!0;break}}else if(n[H--]=l[O--],se++,re=0,--E===1){ae=!0;break}while((re|se)<J);if(ae)break;do{if(re=A-e3(l[O],n,x,A,A-1,e),re!==0){for(H-=re,L-=re,A-=re,Z=H+1,q=L+1,C=re-1;C>=0;C--)n[Z+C]=n[q+C];if(A===0){ae=!0;break}}if(n[H--]=l[O--],--E===1){ae=!0;break}if(se=E-QF(n[L],l,0,E,E-1,e),se!==0){for(H-=se,O-=se,E-=se,Z=H+1,q=O+1,C=0;C<se;C++)n[Z+C]=l[q+C];if(E<=1){ae=!0;break}}if(n[H--]=n[L--],--A===0){ae=!0;break}J--}while(re>=hA||se>=hA);if(ae)break;J<0&&(J=0),J+=2}if(t=J,t<1&&(t=1),E===1){for(H-=A,L-=A,Z=H+1,q=L+1,C=A-1;C>=0;C--)n[Z+C]=n[q+C];n[H]=l[O]}else{if(E===0)throw new Error;for(q=H-(E-1),C=0;C<E;C++)n[q+C]=l[C]}}return{mergeRuns:a,forceMergeRuns:d,pushRun:c}}function bP(n,e,t,r){t||(t=0),r||(r=n.length);var s=r-t;if(!(s<2)){var o=0;if(s<rse){o=VX(n,t,r,e),HX(n,t,r,t+o,e);return}var l=AEe(n,e),c=wEe(s);do{if(o=VX(n,t,r,e),o<c){var a=s;a>c&&(a=c),HX(n,t,t+a,t+o,e),o=a}l.pushRun(t,o),l.mergeRuns(),s-=o,t+=o}while(s!==0);l.forceMergeRuns()}}var Fu=1,XA=2,pb=4,jX=!1;function t3(){jX||(jX=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function WX(n,e){return n.zlevel===e.zlevel?n.z===e.z?n.z2-e.z2:n.z-e.z:n.zlevel-e.zlevel}var TEe=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=WX}return n.prototype.traverse=function(e,t){for(var r=0;r<this._roots.length;r++)this._roots[r].traverse(e,t)},n.prototype.getDisplayList=function(e,t){t=t||!1;var r=this._displayList;return(e||!r.length)&&this.updateDisplayList(t),r},n.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,r=this._displayList,s=0,o=t.length;s<o;s++)this._updateAndAddDisplayable(t[s],null,e);r.length=this._displayListLen,bP(r,WX)},n.prototype._updateAndAddDisplayable=function(e,t,r){if(!(e.ignore&&!r)){e.beforeUpdate(),e.update(),e.afterUpdate();var s=e.getClipPath();if(e.ignoreClip)t=null;else if(s){t?t=t.slice():t=[];for(var o=s,l=e;o;)o.parent=l,o.updateTransform(),t.push(o),l=o,o=o.getClipPath()}if(e.childrenRef){for(var c=e.childrenRef(),a=0;a<c.length;a++){var d=c[a];e.__dirty&&(d.__dirty|=Fu),this._updateAndAddDisplayable(d,t,r)}e.__dirty=0}else{var f=e;t&&t.length?f.__clipPaths=t:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(t3(),f.z=0),isNaN(f.z2)&&(t3(),f.z2=0),isNaN(f.zlevel)&&(t3(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var m=e.getDecalElement&&e.getDecalElement();m&&this._updateAndAddDisplayable(m,t,r);var _=e.getTextGuideLine();_&&this._updateAndAddDisplayable(_,t,r);var x=e.getTextContent();x&&this._updateAndAddDisplayable(x,t,r)}},n.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},n.prototype.delRoot=function(e){if(e instanceof Array){for(var t=0,r=e.length;t<r;t++)this.delRoot(e[t]);return}var s=Zi(this._roots,e);s>=0&&this._roots.splice(s,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}(),nL;nL=yi.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};var ET={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)))},elasticOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*n)*Math.sin((n-e)*(2*Math.PI)/r)+1)},elasticInOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),(n*=2)<1?-.5*(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)):t*Math.pow(2,-10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)*.5+1)},backIn:function(n){var e=1.70158;return n*n*((e+1)*n-e)},backOut:function(n){var e=1.70158;return--n*n*((e+1)*n+e)+1},backInOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)},bounceIn:function(n){return 1-ET.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?ET.bounceIn(n*2)*.5:ET.bounceOut(n*2-1)*.5+.5}},nI=Math.pow,m0=Math.sqrt,rL=1e-8,ise=1e-4,$X=m0(3),rI=1/3,ip=Ww(),Th=Ww(),Qb=Ww();function e0(n){return n>-rL&&n<rL}function sse(n){return n>rL||n<-rL}function ja(n,e,t,r,s){var o=1-s;return o*o*(o*n+3*s*e)+s*s*(s*r+3*o*t)}function XX(n,e,t,r,s){var o=1-s;return 3*(((e-n)*o+2*(t-e)*s)*o+(r-t)*s*s)}function iL(n,e,t,r,s,o){var l=r+3*(e-t)-n,c=3*(t-e*2+n),a=3*(e-n),d=n-s,f=c*c-3*l*a,m=c*a-9*l*d,_=a*a-3*c*d,x=0;if(e0(f)&&e0(m))if(e0(c))o[0]=0;else{var A=-a/c;A>=0&&A<=1&&(o[x++]=A)}else{var I=m*m-4*f*_;if(e0(I)){var E=m/f,A=-c/l+E,C=-E/2;A>=0&&A<=1&&(o[x++]=A),C>=0&&C<=1&&(o[x++]=C)}else if(I>0){var L=m0(I),O=f*c+1.5*l*(-m+L),H=f*c+1.5*l*(-m-L);O<0?O=-nI(-O,rI):O=nI(O,rI),H<0?H=-nI(-H,rI):H=nI(H,rI);var A=(-c-(O+H))/(3*l);A>=0&&A<=1&&(o[x++]=A)}else{var q=(2*f*c-3*l*m)/(2*m0(f*f*f)),Z=Math.acos(q)/3,J=m0(f),re=Math.cos(Z),A=(-c-2*J*re)/(3*l),C=(-c+J*(re+$X*Math.sin(Z)))/(3*l),se=(-c+J*(re-$X*Math.sin(Z)))/(3*l);A>=0&&A<=1&&(o[x++]=A),C>=0&&C<=1&&(o[x++]=C),se>=0&&se<=1&&(o[x++]=se)}}return x}function ose(n,e,t,r,s){var o=6*t-12*e+6*n,l=9*e+3*r-3*n-9*t,c=3*e-3*n,a=0;if(e0(l)){if(sse(o)){var d=-c/o;d>=0&&d<=1&&(s[a++]=d)}}else{var f=o*o-4*l*c;if(e0(f))s[0]=-o/(2*l);else if(f>0){var m=m0(f),d=(-o+m)/(2*l),_=(-o-m)/(2*l);d>=0&&d<=1&&(s[a++]=d),_>=0&&_<=1&&(s[a++]=_)}}return a}function M0(n,e,t,r,s,o){var l=(e-n)*s+n,c=(t-e)*s+e,a=(r-t)*s+t,d=(c-l)*s+l,f=(a-c)*s+c,m=(f-d)*s+d;o[0]=n,o[1]=l,o[2]=d,o[3]=m,o[4]=m,o[5]=f,o[6]=a,o[7]=r}function ase(n,e,t,r,s,o,l,c,a,d,f){var m,_=.005,x=1/0,A,I,E,C;ip[0]=a,ip[1]=d;for(var L=0;L<1;L+=.05)Th[0]=ja(n,t,s,l,L),Th[1]=ja(e,r,o,c,L),E=Kb(ip,Th),E<x&&(m=L,x=E);x=1/0;for(var O=0;O<32&&!(_<ise);O++)A=m-_,I=m+_,Th[0]=ja(n,t,s,l,A),Th[1]=ja(e,r,o,c,A),E=Kb(Th,ip),A>=0&&E<x?(m=A,x=E):(Qb[0]=ja(n,t,s,l,I),Qb[1]=ja(e,r,o,c,I),C=Kb(Qb,ip),I<=1&&C<x?(m=I,x=C):_*=.5);return f&&(f[0]=ja(n,t,s,l,m),f[1]=ja(e,r,o,c,m)),m0(x)}function MEe(n,e,t,r,s,o,l,c,a){for(var d=n,f=e,m=0,_=1/a,x=1;x<=a;x++){var A=x*_,I=ja(n,t,s,l,A),E=ja(e,r,o,c,A),C=I-d,L=E-f;m+=Math.sqrt(C*C+L*L),d=I,f=E}return m}function Wl(n,e,t,r){var s=1-r;return s*(s*n+2*r*e)+r*r*t}function qX(n,e,t,r){return 2*((1-r)*(e-n)+r*(t-e))}function CEe(n,e,t,r,s){var o=n-2*e+t,l=2*(e-n),c=n-r,a=0;if(e0(o)){if(sse(l)){var d=-c/l;d>=0&&d<=1&&(s[a++]=d)}}else{var f=l*l-4*o*c;if(e0(f)){var d=-l/(2*o);d>=0&&d<=1&&(s[a++]=d)}else if(f>0){var m=m0(f),d=(-l+m)/(2*o),_=(-l-m)/(2*o);d>=0&&d<=1&&(s[a++]=d),_>=0&&_<=1&&(s[a++]=_)}}return a}function lse(n,e,t){var r=n+t-2*e;return r===0?.5:(n-e)/r}function sL(n,e,t,r,s){var o=(e-n)*r+n,l=(t-e)*r+e,c=(l-o)*r+o;s[0]=n,s[1]=o,s[2]=c,s[3]=c,s[4]=l,s[5]=t}function cse(n,e,t,r,s,o,l,c,a){var d,f=.005,m=1/0;ip[0]=l,ip[1]=c;for(var _=0;_<1;_+=.05){Th[0]=Wl(n,t,s,_),Th[1]=Wl(e,r,o,_);var x=Kb(ip,Th);x<m&&(d=_,m=x)}m=1/0;for(var A=0;A<32&&!(f<ise);A++){var I=d-f,E=d+f;Th[0]=Wl(n,t,s,I),Th[1]=Wl(e,r,o,I);var x=Kb(Th,ip);if(I>=0&&x<m)d=I,m=x;else{Qb[0]=Wl(n,t,s,E),Qb[1]=Wl(e,r,o,E);var C=Kb(Qb,ip);E<=1&&C<m?(d=E,m=C):f*=.5}}return a&&(a[0]=Wl(n,t,s,d),a[1]=Wl(e,r,o,d)),m0(m)}function EEe(n,e,t,r,s,o,l){for(var c=n,a=e,d=0,f=1/l,m=1;m<=l;m++){var _=m*f,x=Wl(n,t,s,_),A=Wl(e,r,o,_),I=x-c,E=A-a;d+=Math.sqrt(I*I+E*E),c=x,a=A}return d}var IEe=/cubic-bezier\(([0-9,\.e ]+)\)/;function use(n){var e=n&&IEe.exec(n);if(e){var t=e[1].split(","),r=+cp(t[0]),s=+cp(t[1]),o=+cp(t[2]),l=+cp(t[3]);if(isNaN(r+s+o+l))return;var c=[];return function(a){return a<=0?0:a>=1?1:iL(0,r,o,1,a,c)&&ja(0,s,l,1,c[0])}}}var PEe=function(){function n(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||Lc,this.ondestroy=e.ondestroy||Lc,this.onrestart=e.onrestart||Lc,e.easing&&this.setEasing(e.easing)}return n.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),this._paused){this._pausedTime+=t;return}var r=this._life,s=e-this._startTime-this._pausedTime,o=s/r;o<0&&(o=0),o=Math.min(o,1);var l=this.easingFunc,c=l?l(o):o;if(this.onframe(c),o===1)if(this.loop){var a=s%r;this._startTime=e-a,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(e){this.easing=e,this.easingFunc=hi(e)?e:ET[e]||use(e)},n}(),hse=function(){function n(e){this.value=e}return n}(),REe=function(){function n(){this._len=0}return n.prototype.insert=function(e){var t=new hse(e);return this.insertEntry(t),t},n.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},n.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),PC=function(){function n(e){this._list=new REe,this._maxSize=10,this._map={},this._maxSize=e}return n.prototype.put=function(e,t){var r=this._list,s=this._map,o=null;if(s[e]==null){var l=r.len(),c=this._lastRemovedEntry;if(l>=this._maxSize&&l>0){var a=r.head;r.remove(a),delete s[a.key],o=a.value,this._lastRemovedEntry=a}c?c.value=t:c=new hse(t),c.key=e,r.insertEntry(c),s[e]=c}return o},n.prototype.get=function(e){var t=this._map[e],r=this._list;if(t!=null)return t!==r.tail&&(r.remove(t),r.insertEntry(t)),t.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}(),YX={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g0(n){return n=Math.round(n),n<0?0:n>255?255:n}function kz(n){return n<0?0:n>1?1:n}function n3(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?g0(parseFloat(e)/100*255):g0(parseInt(e,10))}function IT(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?kz(parseFloat(e)/100):kz(parseFloat(e))}function r3(n,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?n+(e-n)*t*6:t*2<1?e:t*3<2?n+(e-n)*(2/3-t)*6:n}function iI(n,e,t){return n+(e-n)*t}function vh(n,e,t,r,s){return n[0]=e,n[1]=t,n[2]=r,n[3]=s,n}function Oz(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}var dse=new PC(20),sI=null;function j1(n,e){sI&&Oz(sI,e),sI=dse.put(n,sI||e.slice())}function Xm(n,e){if(n){e=e||[];var t=dse.get(n);if(t)return Oz(e,t);n=n+"";var r=n.replace(/ /g,"").toLowerCase();if(r in YX)return Oz(e,YX[r]),j1(n,e),e;var s=r.length;if(r.charAt(0)==="#"){if(s===4||s===5){var o=parseInt(r.slice(1,4),16);if(!(o>=0&&o<=4095)){vh(e,0,0,0,1);return}return vh(e,(o&3840)>>4|(o&3840)>>8,o&240|(o&240)>>4,o&15|(o&15)<<4,s===5?parseInt(r.slice(4),16)/15:1),j1(n,e),e}else if(s===7||s===9){var o=parseInt(r.slice(1,7),16);if(!(o>=0&&o<=16777215)){vh(e,0,0,0,1);return}return vh(e,(o&16711680)>>16,(o&65280)>>8,o&255,s===9?parseInt(r.slice(7),16)/255:1),j1(n,e),e}return}var l=r.indexOf("("),c=r.indexOf(")");if(l!==-1&&c+1===s){var a=r.substr(0,l),d=r.substr(l+1,c-(l+1)).split(","),f=1;switch(a){case"rgba":if(d.length!==4)return d.length===3?vh(e,+d[0],+d[1],+d[2],1):vh(e,0,0,0,1);f=IT(d.pop());case"rgb":if(d.length>=3)return vh(e,n3(d[0]),n3(d[1]),n3(d[2]),d.length===3?f:IT(d[3])),j1(n,e),e;vh(e,0,0,0,1);return;case"hsla":if(d.length!==4){vh(e,0,0,0,1);return}return d[3]=IT(d[3]),ZX(d,e),j1(n,e),e;case"hsl":if(d.length!==3){vh(e,0,0,0,1);return}return ZX(d,e),j1(n,e),e;default:return}}vh(e,0,0,0,1)}}function ZX(n,e){var t=(parseFloat(n[0])%360+360)%360/360,r=IT(n[1]),s=IT(n[2]),o=s<=.5?s*(r+1):s+r-s*r,l=s*2-o;return e=e||[],vh(e,g0(r3(l,o,t+1/3)*255),g0(r3(l,o,t)*255),g0(r3(l,o,t-1/3)*255),1),n.length===4&&(e[3]=n[3]),e}function KX(n,e){var t=Xm(n);if(t){for(var r=0;r<3;r++)t[r]=t[r]*(1-e)|0,t[r]>255?t[r]=255:t[r]<0&&(t[r]=0);return uB(t,t.length===4?"rgba":"rgb")}}function LEe(n,e,t){if(!(!(e&&e.length)||!(n>=0&&n<=1))){var r=n*(e.length-1),s=Math.floor(r),o=Math.ceil(r),l=Xm(e[s]),c=Xm(e[o]),a=r-s,d=uB([g0(iI(l[0],c[0],a)),g0(iI(l[1],c[1],a)),g0(iI(l[2],c[2],a)),kz(iI(l[3],c[3],a))],"rgba");return t?{color:d,leftIndex:s,rightIndex:o,value:r}:d}}function uB(n,e){if(!(!n||!n.length)){var t=n[0]+","+n[1]+","+n[2];return(e==="rgba"||e==="hsva"||e==="hsla")&&(t+=","+n[3]),e+"("+t+")"}}function oL(n,e){var t=Xm(n);return t?(.299*t[0]+.587*t[1]+.114*t[2])*t[3]/255+(1-t[3])*e:0}var JX=new PC(100);function QX(n){if(Br(n)){var e=JX.get(n);return e||(e=KX(n,-.1),JX.put(n,e)),e}else if(oB(n)){var t=Qn({},n);return t.colorStops=br(n.colorStops,function(r){return{offset:r.offset,color:KX(r.color,-.1)}}),t}return n}function DEe(n){return n.type==="linear"}function BEe(n){return n.type==="radial"}(function(){return yi.hasGlobalWindow&&hi(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}})();var Fz=Array.prototype.slice;function Em(n,e,t){return(e-n)*t+n}function i3(n,e,t,r){for(var s=e.length,o=0;o<s;o++)n[o]=Em(e[o],t[o],r);return n}function kEe(n,e,t,r){for(var s=e.length,o=s&&e[0].length,l=0;l<s;l++){n[l]||(n[l]=[]);for(var c=0;c<o;c++)n[l][c]=Em(e[l][c],t[l][c],r)}return n}function oI(n,e,t,r){for(var s=e.length,o=0;o<s;o++)n[o]=e[o]+t[o]*r;return n}function eq(n,e,t,r){for(var s=e.length,o=s&&e[0].length,l=0;l<s;l++){n[l]||(n[l]=[]);for(var c=0;c<o;c++)n[l][c]=e[l][c]+t[l][c]*r}return n}function OEe(n,e){for(var t=n.length,r=e.length,s=t>r?e:n,o=Math.min(t,r),l=s[o-1]||{color:[0,0,0,0],offset:0},c=o;c<Math.max(t,r);c++)s.push({offset:l.offset,color:l.color.slice()})}function FEe(n,e,t){var r=n,s=e;if(!(!r.push||!s.push)){var o=r.length,l=s.length;if(o!==l){var c=o>l;if(c)r.length=l;else for(var a=o;a<l;a++)r.push(t===1?s[a]:Fz.call(s[a]))}for(var d=r[0]&&r[0].length,a=0;a<r.length;a++)if(t===1)isNaN(r[a])&&(r[a]=s[a]);else for(var f=0;f<d;f++)isNaN(r[a][f])&&(r[a][f]=s[a][f])}}function wP(n){if(Dc(n)){var e=n.length;if(Dc(n[0])){for(var t=[],r=0;r<e;r++)t.push(Fz.call(n[r]));return t}return Fz.call(n)}return n}function SP(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function NEe(n){return Dc(n&&n[0])?2:1}var aI=0,AP=1,fse=2,qA=3,Nz=4,zz=5,tq=6;function nq(n){return n===Nz||n===zz}function lI(n){return n===AP||n===fse}var dA=[0,0,0,0],zEe=function(){function n(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(e,t,r){this._needsSort=!0;var s=this.keyframes,o=s.length,l=!1,c=tq,a=t;if(Dc(t)){var d=NEe(t);c=d,(d===1&&!Ds(t[0])||d===2&&!Ds(t[0][0]))&&(l=!0)}else if(Ds(t)&&!QR(t))c=aI;else if(Br(t))if(!isNaN(+t))c=aI;else{var f=Xm(t);f&&(a=f,c=qA)}else if(oB(t)){var m=Qn({},a);m.colorStops=br(t.colorStops,function(x){return{offset:x.offset,color:Xm(x.color)}}),DEe(t)?c=Nz:BEe(t)&&(c=zz),a=m}o===0?this.valType=c:(c!==this.valType||c===tq)&&(l=!0),this.discrete=this.discrete||l;var _={time:e,value:a,rawValue:t,percent:0};return r&&(_.easing=r,_.easingFunc=hi(r)?r:ET[r]||use(r)),s.push(_),_},n.prototype.prepare=function(e,t){var r=this.keyframes;this._needsSort&&r.sort(function(I,E){return I.time-E.time});for(var s=this.valType,o=r.length,l=r[o-1],c=this.discrete,a=lI(s),d=nq(s),f=0;f<o;f++){var m=r[f],_=m.value,x=l.value;m.percent=m.time/e,c||(a&&f!==o-1?FEe(_,x,s):d&&OEe(_.colorStops,x.colorStops))}if(!c&&s!==zz&&t&&this.needsAnimate()&&t.needsAnimate()&&s===t.valType&&!t._finished){this._additiveTrack=t;for(var A=r[0].value,f=0;f<o;f++)s===aI?r[f].additiveValue=r[f].value-A:s===qA?r[f].additiveValue=oI([],r[f].value,A,-1):lI(s)&&(r[f].additiveValue=s===AP?oI([],r[f].value,A,-1):eq([],r[f].value,A,-1))}},n.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,s=r?"additiveValue":"value",o=this.valType,l=this.keyframes,c=l.length,a=this.propName,d=o===qA,f,m=this._lastFr,_=Math.min,x,A;if(c===1)x=A=l[0];else{if(t<0)f=0;else if(t<this._lastFrP){var I=_(m+1,c-1);for(f=I;f>=0&&!(l[f].percent<=t);f--);f=_(f,c-2)}else{for(f=m;f<c&&!(l[f].percent>t);f++);f=_(f-1,c-2)}A=l[f+1],x=l[f]}if(x&&A){this._lastFr=f,this._lastFrP=t;var E=A.percent-x.percent,C=E===0?1:_((t-x.percent)/E,1);A.easingFunc&&(C=A.easingFunc(C));var L=r?this._additiveValue:d?dA:e[a];if((lI(o)||d)&&!L&&(L=this._additiveValue=[]),this.discrete)e[a]=C<1?x.rawValue:A.rawValue;else if(lI(o))o===AP?i3(L,x[s],A[s],C):kEe(L,x[s],A[s],C);else if(nq(o)){var O=x[s],H=A[s],q=o===Nz;e[a]={type:q?"linear":"radial",x:Em(O.x,H.x,C),y:Em(O.y,H.y,C),colorStops:br(O.colorStops,function(J,re){var se=H.colorStops[re];return{offset:Em(J.offset,se.offset,C),color:SP(i3([],J.color,se.color,C))}}),global:H.global},q?(e[a].x2=Em(O.x2,H.x2,C),e[a].y2=Em(O.y2,H.y2,C)):e[a].r=Em(O.r,H.r,C)}else if(d)i3(L,x[s],A[s],C),r||(e[a]=SP(L));else{var Z=Em(x[s],A[s],C);r?this._additiveValue=Z:e[a]=Z}r&&this._addToTarget(e)}}},n.prototype._addToTarget=function(e){var t=this.valType,r=this.propName,s=this._additiveValue;t===aI?e[r]=e[r]+s:t===qA?(Xm(e[r],dA),oI(dA,dA,s,1),e[r]=SP(dA)):t===AP?oI(e[r],e[r],s,1):t===fse&&eq(e[r],e[r],s,1)},n}(),vG=function(){function n(e,t,r,s){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&s){fG("Can' use additive animation on looped animation.");return}this._additiveAnimators=s,this._allowDiscrete=r}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(e){this._target=e},n.prototype.when=function(e,t,r){return this.whenWithKeys(e,t,lo(t),r)},n.prototype.whenWithKeys=function(e,t,r,s){for(var o=this._tracks,l=0;l<r.length;l++){var c=r[l],a=o[c];if(!a){a=o[c]=new zEe(c);var d=void 0,f=this._getAdditiveTrack(c);if(f){var m=f.keyframes,_=m[m.length-1];d=_&&_.value,f.valType===qA&&d&&(d=SP(d))}else d=this._target[c];if(d==null)continue;e>0&&a.addKeyframe(0,wP(d),s),this._trackKeys.push(c)}a.addKeyframe(e,wP(t[c]),s)}return this._maxTime=Math.max(this._maxTime,e),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,r=0;r<t;r++)e[r].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var r=0;r<t.length;r++)t[r].call(this)},n.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,r=0;r<t.length;r++)e[t[r]].setFinished()},n.prototype._getAdditiveTrack=function(e){var t,r=this._additiveAnimators;if(r)for(var s=0;s<r.length;s++){var o=r[s].getTrack(e);o&&(t=o)}return t},n.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,r=[],s=this._maxTime||0,o=0;o<this._trackKeys.length;o++){var l=this._trackKeys[o],c=this._tracks[l],a=this._getAdditiveTrack(l),d=c.keyframes,f=d.length;if(c.prepare(s,a),c.needsAnimate())if(!this._allowDiscrete&&c.discrete){var m=d[f-1];m&&(t._target[c.propName]=m.rawValue),c.setFinished()}else r.push(c)}if(r.length||this._force){var _=new PEe({life:s,loop:this._loop,delay:this._delay||0,onframe:function(x){t._started=2;var A=t._additiveAnimators;if(A){for(var I=!1,E=0;E<A.length;E++)if(A[E]._clip){I=!0;break}I||(t._additiveAnimators=null)}for(var E=0;E<r.length;E++)r[E].step(t._target,x);var C=t._onframeCbs;if(C)for(var E=0;E<C.length;E++)C[E](t._target,x)},ondestroy:function(){t._doneCallback()}});this._clip=_,this.animation&&this.animation.addClip(_),e&&_.setEasing(e)}else this._doneCallback();return this}},n.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},n.prototype.delay=function(e){return this._delay=e,this},n.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},n.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},n.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(e){return this._tracks[e]},n.prototype.getTracks=function(){var e=this;return br(this._trackKeys,function(t){return e._tracks[t]})},n.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var r=this._tracks,s=this._trackKeys,o=0;o<e.length;o++){var l=r[e[o]];l&&!l.isFinished()&&(t?l.step(this._target,1):this._started===1&&l.step(this._target,0),l.setFinished())}for(var c=!0,o=0;o<s.length;o++)if(!r[s[o]].isFinished()){c=!1;break}return c&&this._abortedCallback(),c},n.prototype.saveTo=function(e,t,r){if(e){t=t||this._trackKeys;for(var s=0;s<t.length;s++){var o=t[s],l=this._tracks[o];if(!(!l||l.isFinished())){var c=l.keyframes,a=c[r?0:c.length-1];a&&(e[o]=wP(a.rawValue))}}}},n.prototype.__changeFinalValue=function(e,t){t=t||lo(e);for(var r=0;r<t.length;r++){var s=t[r],o=this._tracks[s];if(o){var l=o.keyframes;if(l.length>1){var c=l.pop();o.addKeyframe(c.time,e[s]),o.prepare(this._maxTime,o.getAdditiveTrack())}}}},n}();function Nb(){return new Date().getTime()}var UEe=function(n){jn(e,n);function e(t){var r=n.call(this)||this;return r._running=!1,r._time=0,r._pausedTime=0,r._pauseStart=0,r._paused=!1,t=t||{},r.stage=t.stage||{},r}return e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._head?(this._tail.next=t,t.prev=this._tail,t.next=null,this._tail=t):this._head=this._tail=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var r=t.getClip();r&&this.addClip(r)},e.prototype.removeClip=function(t){if(t.animation){var r=t.prev,s=t.next;r?r.next=s:this._head=s,s?s.prev=r:this._tail=r,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var r=t.getClip();r&&this.removeClip(r),t.animation=null},e.prototype.update=function(t){for(var r=Nb()-this._pausedTime,s=r-this._time,o=this._head;o;){var l=o.next,c=o.step(r,s);c&&(o.ondestroy(),this.removeClip(o)),o=l}this._time=r,t||(this.trigger("frame",s),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var t=this;this._running=!0;function r(){t._running&&(nL(r),!t._paused&&t.update())}nL(r)},e.prototype.start=function(){this._running||(this._time=Nb(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=Nb(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=Nb()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var t=this._head;t;){var r=t.next;t.prev=t.next=t.animation=null,t=r}this._head=this._tail=null},e.prototype.isFinished=function(){return this._head==null},e.prototype.animate=function(t,r){r=r||{},this.start();var s=new vG(t,r.loop);return this.addAnimator(s),s},e}(ff),GEe=300,s3=yi.domSupported,o3=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e=["touchstart","touchend","touchmove"],t={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},r=br(n,function(s){var o=s.replace("mouse","pointer");return t.hasOwnProperty(o)?o:s});return{mouse:n,touch:e,pointer:r}}(),rq={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},iq=!1;function Uz(n){var e=n.pointerType;return e==="pen"||e==="touch"}function VEe(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function a3(n){n&&(n.zrByTouch=!0)}function HEe(n,e){return yh(n.dom,new jEe(n,e),!0)}function pse(n,e){for(var t=e,r=!1;t&&t.nodeType!==9&&!(r=t.domBelongToZr||t!==e&&t===n.painterRoot);)t=t.parentNode;return r}var jEe=function(){function n(e,t){this.stopPropagation=Lc,this.stopImmediatePropagation=Lc,this.preventDefault=Lc,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}return n}(),Nd={mousedown:function(n){n=yh(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=yh(this.dom,n);var e=this.__mayPointerCapture;e&&(n.zrX!==e[0]||n.zrY!==e[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=yh(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=yh(this.dom,n);var e=n.toElement||n.relatedTarget;pse(this,e)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){iq=!0,n=yh(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){iq||(n=yh(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=yh(this.dom,n),a3(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),Nd.mousemove.call(this,n),Nd.mousedown.call(this,n)},touchmove:function(n){n=yh(this.dom,n),a3(n),this.handler.processGesture(n,"change"),Nd.mousemove.call(this,n)},touchend:function(n){n=yh(this.dom,n),a3(n),this.handler.processGesture(n,"end"),Nd.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<GEe&&Nd.click.call(this,n)},pointerdown:function(n){Nd.mousedown.call(this,n)},pointermove:function(n){Uz(n)||Nd.mousemove.call(this,n)},pointerup:function(n){Nd.mouseup.call(this,n)},pointerout:function(n){Uz(n)||Nd.mouseout.call(this,n)}};ot(["click","dblclick","contextmenu"],function(n){Nd[n]=function(e){e=yh(this.dom,e),this.trigger(n,e)}});var Gz={pointermove:function(n){Uz(n)||Gz.mousemove.call(this,n)},pointerup:function(n){Gz.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),e&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function WEe(n,e){var t=e.domHandlers;yi.pointerEventsSupported?ot(o3.pointer,function(r){TP(e,r,function(s){t[r].call(n,s)})}):(yi.touchEventsSupported&&ot(o3.touch,function(r){TP(e,r,function(s){t[r].call(n,s),VEe(e)})}),ot(o3.mouse,function(r){TP(e,r,function(s){s=mG(s),e.touching||t[r].call(n,s)})}))}function $Ee(n,e){yi.pointerEventsSupported?ot(rq.pointer,t):yi.touchEventsSupported||ot(rq.mouse,t);function t(r){function s(o){o=mG(o),pse(n,o.target)||(o=HEe(n,o),e.domHandlers[r].call(n,o))}TP(e,r,s,{capture:!0})}}function TP(n,e,t,r){n.mounted[e]=t,n.listenerOpts[e]=r,Bz(n.domTarget,e,t,r)}function l3(n){var e=n.mounted;for(var t in e)e.hasOwnProperty(t)&&hEe(n.domTarget,t,e[t],n.listenerOpts[t]);n.mounted={}}var sq=function(){function n(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t}return n}(),XEe=function(n){jn(e,n);function e(t,r){var s=n.call(this)||this;return s.__pointerCapturing=!1,s.dom=t,s.painterRoot=r,s._localHandlerScope=new sq(t,Nd),s3&&(s._globalHandlerScope=new sq(document,Gz)),WEe(s,s._localHandlerScope),s}return e.prototype.dispose=function(){l3(this._localHandlerScope),s3&&l3(this._globalHandlerScope)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,s3&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var r=this._globalHandlerScope;t?$Ee(this,r):l3(r)}},e}(ff),mse=1;yi.hasGlobalWindow&&(mse=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var aL=mse,Vz=.4,Hz="#333",jz="#ccc",qEe="#eee",oq=gG,aq=5e-5;function q_(n){return n>aq||n<-aq}var Y_=[],W1=[],c3=Qy(),u3=Math.abs,RC=function(){function n(){}return n.prototype.getLocalTransform=function(e){return n.getLocalTransform(this,e)},n.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},n.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},n.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},n.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},n.prototype.needLocalTransform=function(){return q_(this.rotation)||q_(this.x)||q_(this.y)||q_(this.scaleX-1)||q_(this.scaleY-1)||q_(this.skewX)||q_(this.skewY)},n.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),r=this.transform;if(!(t||e)){r&&(oq(r),this.invTransform=null);return}r=r||Qy(),t?this.getLocalTransform(r):oq(r),e&&(t?Jb(r,e,r):pEe(r,e)),this.transform=r,this._resolveGlobalScaleRatio(r)},n.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(t!=null&&t!==1){this.getGlobalScale(Y_);var r=Y_[0]<0?-1:1,s=Y_[1]<0?-1:1,o=((Y_[0]-r)*t+r)/Y_[0]||0,l=((Y_[1]-s)*t+s)/Y_[1]||0;e[0]*=o,e[1]*=o,e[2]*=l,e[3]*=l}this.invTransform=this.invTransform||Qy(),cB(this.invTransform,e)},n.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},n.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],s=Math.atan2(e[1],e[0]),o=Math.PI/2+s-Math.atan2(e[3],e[2]);r=Math.sqrt(r)*Math.cos(o),t=Math.sqrt(t),this.skewX=o,this.skewY=0,this.rotation=-s,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=r,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||Qy(),Jb(W1,e.invTransform,t),t=W1);var r=this.originX,s=this.originY;(r||s)&&(c3[4]=r,c3[5]=s,Jb(W1,t,c3),W1[4]-=r,W1[5]-=s,t=W1),this.setLocalTransform(t)}},n.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},n.prototype.transformCoordToLocal=function(e,t){var r=[e,t],s=this.invTransform;return s&&kh(r,r,s),r},n.prototype.transformCoordToGlobal=function(e,t){var r=[e,t],s=this.transform;return s&&kh(r,r,s),r},n.prototype.getLineScale=function(){var e=this.transform;return e&&u3(e[0]-1)>1e-10&&u3(e[3]-1)>1e-10?Math.sqrt(u3(e[0]*e[3]-e[2]*e[1])):1},n.prototype.copyTransform=function(e){YEe(this,e)},n.getLocalTransform=function(e,t){t=t||[];var r=e.originX||0,s=e.originY||0,o=e.scaleX,l=e.scaleY,c=e.anchorX,a=e.anchorY,d=e.rotation||0,f=e.x,m=e.y,_=e.skewX?Math.tan(e.skewX):0,x=e.skewY?Math.tan(-e.skewY):0;if(r||s||c||a){var A=r+c,I=s+a;t[4]=-A*o-_*I*l,t[5]=-I*l-x*A*o}else t[4]=t[5]=0;return t[0]=o,t[3]=l,t[1]=x*o,t[2]=_*l,d&&lB(t,t,d),t[4]+=r+f,t[5]+=s+m,t},n.initDefaultProps=function(){var e=n.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),n}(),PM=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function YEe(n,e){for(var t=0;t<PM.length;t++){var r=PM[t];n[r]=e[r]}}var lq={};function Gu(n,e){e=e||_x;var t=lq[e];t||(t=lq[e]=new PC(500));var r=t.get(n);return r==null&&(r=Hw.measureText(n,e).width,t.put(n,r)),r}function cq(n,e,t,r){var s=Gu(n,e),o=_G(e),l=YA(0,s,t),c=mb(0,o,r),a=new ds(l,c,s,o);return a}function LC(n,e,t,r){var s=((n||"")+"").split(`
`),o=s.length;if(o===1)return cq(s[0],e,t,r);for(var l=new ds(0,0,0,0),c=0;c<s.length;c++){var a=cq(s[c],e,t,r);c===0?l.copy(a):l.union(a)}return l}function YA(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function mb(n,e,t){return t==="middle"?n-=e/2:t==="bottom"&&(n-=e),n}function _G(n){return Gu("",n)}function C0(n,e){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*e:parseFloat(n):n}function lL(n,e,t){var r=e.position||"inside",s=e.distance!=null?e.distance:5,o=t.height,l=t.width,c=o/2,a=t.x,d=t.y,f="left",m="top";if(r instanceof Array)a+=C0(r[0],t.width),d+=C0(r[1],t.height),f=null,m=null;else switch(r){case"left":a-=s,d+=c,f="right",m="middle";break;case"right":a+=s+l,d+=c,m="middle";break;case"top":a+=l/2,d-=s,f="center",m="bottom";break;case"bottom":a+=l/2,d+=o+s,f="center";break;case"inside":a+=l/2,d+=c,f="center",m="middle";break;case"insideLeft":a+=s,d+=c,m="middle";break;case"insideRight":a+=l-s,d+=c,f="right",m="middle";break;case"insideTop":a+=l/2,d+=s,f="center";break;case"insideBottom":a+=l/2,d+=o-s,f="center",m="bottom";break;case"insideTopLeft":a+=s,d+=s;break;case"insideTopRight":a+=l-s,d+=s,f="right";break;case"insideBottomLeft":a+=s,d+=o-s,m="bottom";break;case"insideBottomRight":a+=l-s,d+=o-s,f="right",m="bottom";break}return n=n||{},n.x=a,n.y=d,n.align=f,n.verticalAlign=m,n}var h3="__zr_normal__",d3=PM.concat(["ignore"]),ZEe=T0(PM,function(n,e){return n[e]=!0,n},{ignore:!1}),$1={},KEe=new ds(0,0,0,0),hB=function(){function n(e){this.id=Xie(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return n.prototype._init=function(e){this.attr(e)},n.prototype.drift=function(e,t,r){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0;break}var s=this.transform;s||(s=this.transform=[1,0,0,1,0,0]),s[4]+=e,s[5]+=t,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var r=this.textConfig,s=r.local,o=t.innerTransformable,l=void 0,c=void 0,a=!1;o.parent=s?this:null;var d=!1;if(o.copyTransform(t),r.position!=null){var f=KEe;r.layoutRect?f.copy(r.layoutRect):f.copy(this.getBoundingRect()),s||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition($1,r,f):lL($1,r,f),o.x=$1.x,o.y=$1.y,l=$1.align,c=$1.verticalAlign;var m=r.origin;if(m&&r.rotation!=null){var _=void 0,x=void 0;m==="center"?(_=f.width*.5,x=f.height*.5):(_=C0(m[0],f.width),x=C0(m[1],f.height)),d=!0,o.originX=-o.x+_+(s?0:f.x),o.originY=-o.y+x+(s?0:f.y)}}r.rotation!=null&&(o.rotation=r.rotation);var A=r.offset;A&&(o.x+=A[0],o.y+=A[1],d||(o.originX=-A[0],o.originY=-A[1]));var I=r.inside==null?typeof r.position=="string"&&r.position.indexOf("inside")>=0:r.inside,E=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),C=void 0,L=void 0,O=void 0;I&&this.canBeInsideText()?(C=r.insideFill,L=r.insideStroke,(C==null||C==="auto")&&(C=this.getInsideTextFill()),(L==null||L==="auto")&&(L=this.getInsideTextStroke(C),O=!0)):(C=r.outsideFill,L=r.outsideStroke,(C==null||C==="auto")&&(C=this.getOutsideFill()),(L==null||L==="auto")&&(L=this.getOutsideStroke(C),O=!0)),C=C||"#000",(C!==E.fill||L!==E.stroke||O!==E.autoStroke||l!==E.align||c!==E.verticalAlign)&&(a=!0,E.fill=C,E.stroke=L,E.autoStroke=O,E.align=l,E.verticalAlign=c,t.setDefaultTextStyle(E)),t.__dirty|=Fu,a&&t.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(e){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?jz:Hz},n.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),r=typeof t=="string"&&Xm(t);r||(r=[255,255,255,1]);for(var s=r[3],o=this.__zr.isDarkMode(),l=0;l<3;l++)r[l]=r[l]*s+(o?0:255)*(1-s);return r[3]=1,uB(r,"rgba")},n.prototype.traverse=function(e,t){},n.prototype.attrKV=function(e,t){e==="textConfig"?this.setTextConfig(t):e==="textContent"?this.setTextContent(t):e==="clipPath"?this.setClipPath(t):e==="extra"?(this.extra=this.extra||{},Qn(this.extra,t)):this[e]=t},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(e,t){if(typeof e=="string")this.attrKV(e,t);else if(qr(e))for(var r=e,s=lo(r),o=0;o<s.length;o++){var l=s[o];this.attrKV(l,e[l])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,r=0;r<this.animators.length;r++){var s=this.animators[r],o=s.__fromStateTransition;if(!(s.getLoop()||o&&o!==h3)){var l=s.targetName,c=l?t[l]:t;s.saveTo(c)}}},n.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,d3)},n.prototype._savePrimaryToNormal=function(e,t,r){for(var s=0;s<r.length;s++){var o=r[s];e[o]!=null&&!(o in t)&&(t[o]=this[o])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(e){return this.states[e]},n.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},n.prototype.clearStates=function(e){this.useState(h3,!1,e)},n.prototype.useState=function(e,t,r,s){var o=e===h3,l=this.hasState();if(!(!l&&o)){var c=this.currentStates,a=this.stateTransition;if(!(Zi(c,e)>=0&&(t||c.length===1))){var d;if(this.stateProxy&&!o&&(d=this.stateProxy(e)),d||(d=this.states&&this.states[e]),!d&&!o){fG("State "+e+" not exists.");return}o||this.saveCurrentToNormalState(d);var f=!!(d&&d.hoverLayer||s);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,d,this._normalState,t,!r&&!this.__inHover&&a&&a.duration>0,a);var m=this._textContent,_=this._textGuide;return m&&m.useState(e,t,r,f),_&&_.useState(e,t,r,f),o?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Fu),d}}},n.prototype.useStates=function(e,t,r){if(!e.length)this.clearStates();else{var s=[],o=this.currentStates,l=e.length,c=l===o.length;if(c){for(var a=0;a<l;a++)if(e[a]!==o[a]){c=!1;break}}if(c)return;for(var a=0;a<l;a++){var d=e[a],f=void 0;this.stateProxy&&(f=this.stateProxy(d,e)),f||(f=this.states[d]),f&&s.push(f)}var m=s[l-1],_=!!(m&&m.hoverLayer||r);_&&this._toggleHoverLayerFlag(!0);var x=this._mergeStates(s),A=this.stateTransition;this.saveCurrentToNormalState(x),this._applyStateObj(e.join(","),x,this._normalState,!1,!t&&!this.__inHover&&A&&A.duration>0,A);var I=this._textContent,E=this._textGuide;I&&I.useStates(e,t,_),E&&E.useStates(e,t,_),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!_&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Fu)}},n.prototype.isSilent=function(){for(var e=this.silent,t=this.parent;!e&&t;){if(t.silent){e=!0;break}t=t.parent}return e},n.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},n.prototype.removeState=function(e){var t=Zi(this.currentStates,e);if(t>=0){var r=this.currentStates.slice();r.splice(t,1),this.useStates(r)}},n.prototype.replaceState=function(e,t,r){var s=this.currentStates.slice(),o=Zi(s,e),l=Zi(s,t)>=0;o>=0?l?s.splice(o,1):s[o]=t:r&&!l&&s.push(t),this.useStates(s)},n.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},n.prototype._mergeStates=function(e){for(var t={},r,s=0;s<e.length;s++){var o=e[s];Qn(t,o),o.textConfig&&(r=r||{},Qn(r,o.textConfig))}return r&&(t.textConfig=r),t},n.prototype._applyStateObj=function(e,t,r,s,o,l){var c=!(t&&s);t&&t.textConfig?(this.textConfig=Qn({},s?this.textConfig:r.textConfig),Qn(this.textConfig,t.textConfig)):c&&r.textConfig&&(this.textConfig=r.textConfig);for(var a={},d=!1,f=0;f<d3.length;f++){var m=d3[f],_=o&&ZEe[m];t&&t[m]!=null?_?(d=!0,a[m]=t[m]):this[m]=t[m]:c&&r[m]!=null&&(_?(d=!0,a[m]=r[m]):this[m]=r[m])}if(!o)for(var f=0;f<this.animators.length;f++){var x=this.animators[f],A=x.targetName;x.getLoop()||x.__changeFinalValue(A?(t||r)[A]:t||r)}d&&this._transitionState(e,a,l)},n.prototype._attachComponent=function(e){if(!(e.__zr&&!e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},n.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},n.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new RC,this._attachComponent(e),this._textContent=e,this.markRedraw())},n.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),Qn(this.textConfig,e),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=Fu;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,r=this._textGuide;t&&(t.__inHover=e),r&&(r.__inHover=e)},n.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.addAnimator(t[r]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},n.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.removeAnimator(t[r]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},n.prototype.animate=function(e,t,r){var s=e?this[e]:this,o=new vG(s,t,r);return e&&(o.targetName=e),this.addAnimator(o,e),o},n.prototype.addAnimator=function(e,t){var r=this.__zr,s=this;e.during(function(){s.updateDuringAnimation(t)}).done(function(){var o=s.animators,l=Zi(o,e);l>=0&&o.splice(l,1)}),this.animators.push(e),r&&r.animation.addAnimator(e),r&&r.wakeUp()},n.prototype.updateDuringAnimation=function(e){this.markRedraw()},n.prototype.stopAnimation=function(e,t){for(var r=this.animators,s=r.length,o=[],l=0;l<s;l++){var c=r[l];!e||e===c.scope?c.stop(t):o.push(c)}return this.animators=o,this},n.prototype.animateTo=function(e,t,r){f3(this,e,t,r)},n.prototype.animateFrom=function(e,t,r){f3(this,e,t,r,!0)},n.prototype._transitionState=function(e,t,r,s){for(var o=f3(this,t,r,s),l=0;l<o.length;l++)o[l].__fromStateTransition=e},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var e=n.prototype;e.type="element",e.name="",e.ignore=e.silent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=Fu;function t(r,s,o,l){Object.defineProperty(e,r,{get:function(){if(!this[s]){var a=this[s]=[];c(this,a)}return this[s]},set:function(a){this[o]=a[0],this[l]=a[1],this[s]=a,c(this,a)}});function c(a,d){Object.defineProperty(d,0,{get:function(){return a[o]},set:function(f){a[o]=f}}),Object.defineProperty(d,1,{get:function(){return a[l]},set:function(f){a[l]=f}})}}Object.defineProperty&&(t("position","_legacyPos","x","y"),t("scale","_legacyScale","scaleX","scaleY"),t("origin","_legacyOrigin","originX","originY"))}(),n}();df(hB,ff);df(hB,RC);function f3(n,e,t,r,s){t=t||{};var o=[];gse(n,"",n,e,t,r,o,s);var l=o.length,c=!1,a=t.done,d=t.aborted,f=function(){c=!0,l--,l<=0&&(c?a&&a():d&&d())},m=function(){l--,l<=0&&(c?a&&a():d&&d())};l||a&&a(),o.length>0&&t.during&&o[0].during(function(A,I){t.during(I)});for(var _=0;_<o.length;_++){var x=o[_];f&&x.done(f),m&&x.aborted(m),t.force&&x.duration(t.duration),x.start(t.easing)}return o}function p3(n,e,t){for(var r=0;r<t;r++)n[r]=e[r]}function JEe(n){return Dc(n[0])}function QEe(n,e,t){if(Dc(e[t]))if(Dc(n[t])||(n[t]=[]),_u(e[t])){var r=e[t].length;n[t].length!==r&&(n[t]=new e[t].constructor(r),p3(n[t],e[t],r))}else{var s=e[t],o=n[t],l=s.length;if(JEe(s))for(var c=s[0].length,a=0;a<l;a++)o[a]?p3(o[a],s[a],c):o[a]=Array.prototype.slice.call(s[a]);else p3(o,s,l);o.length=s.length}else n[t]=e[t]}function e2e(n,e){return n===e||Dc(n)&&Dc(e)&&t2e(n,e)}function t2e(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function gse(n,e,t,r,s,o,l,c){for(var a=lo(r),d=s.duration,f=s.delay,m=s.additive,_=s.setToFinal,x=!qr(o),A=n.animators,I=[],E=0;E<a.length;E++){var C=a[E],L=r[C];if(L!=null&&t[C]!=null&&(x||o[C]))if(qr(L)&&!Dc(L)&&!oB(L)){if(e){c||(t[C]=L,n.updateDuringAnimation(e));continue}gse(n,C,t[C],L,s,o&&o[C],l,c)}else I.push(C);else c||(t[C]=L,n.updateDuringAnimation(e),I.push(C))}var O=I.length;if(!m&&O)for(var H=0;H<A.length;H++){var q=A[H];if(q.targetName===e){var Z=q.stopTracks(I);if(Z){var J=Zi(A,q);A.splice(J,1)}}}if(s.force||(I=sa(I,function(he){return!e2e(r[he],t[he])}),O=I.length),O>0||s.force&&!l.length){var re=void 0,se=void 0,ae=void 0;if(c){se={},_&&(re={});for(var H=0;H<O;H++){var C=I[H];se[C]=t[C],_?re[C]=r[C]:t[C]=r[C]}}else if(_){ae={};for(var H=0;H<O;H++){var C=I[H];ae[C]=wP(t[C]),QEe(t,r,C)}}var q=new vG(t,!1,!1,m?sa(A,function(Ae){return Ae.targetName===e}):null);q.targetName=e,s.scope&&(q.scope=s.scope),_&&re&&q.whenWithKeys(0,re,I),ae&&q.whenWithKeys(0,ae,I),q.whenWithKeys(d??500,c?se:r,I).delay(f||0),n.addAnimator(q,e),l.push(q)}}var _a=function(n){jn(e,n);function e(t){var r=n.call(this)||this;return r.isGroup=!0,r._children=[],r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(t){return this._children[t]},e.prototype.childOfName=function(t){for(var r=this._children,s=0;s<r.length;s++)if(r[s].name===t)return r[s]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},e.prototype.addBefore=function(t,r){if(t&&t!==this&&t.parent!==this&&r&&r.parent===this){var s=this._children,o=s.indexOf(r);o>=0&&(s.splice(o,0,t),this._doAdd(t))}return this},e.prototype.replace=function(t,r){var s=Zi(this._children,t);return s>=0&&this.replaceAt(r,s),this},e.prototype.replaceAt=function(t,r){var s=this._children,o=s[r];if(t&&t!==this&&t.parent!==this&&t!==o){s[r]=t,o.parent=null;var l=this.__zr;l&&o.removeSelfFromZr(l),this._doAdd(t)}return this},e.prototype._doAdd=function(t){t.parent&&t.parent.remove(t),t.parent=this;var r=this.__zr;r&&r!==t.__zr&&t.addSelfToZr(r),r&&r.refresh()},e.prototype.remove=function(t){var r=this.__zr,s=this._children,o=Zi(s,t);return o<0?this:(s.splice(o,1),t.parent=null,r&&t.removeSelfFromZr(r),r&&r.refresh(),this)},e.prototype.removeAll=function(){for(var t=this._children,r=this.__zr,s=0;s<t.length;s++){var o=t[s];r&&o.removeSelfFromZr(r),o.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,r){for(var s=this._children,o=0;o<s.length;o++){var l=s[o];t.call(r,l,o)}return this},e.prototype.traverse=function(t,r){for(var s=0;s<this._children.length;s++){var o=this._children[s],l=t.call(r,o);o.isGroup&&!l&&o.traverse(t,r)}return this},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++){var s=this._children[r];s.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++){var s=this._children[r];s.removeSelfFromZr(t)}},e.prototype.getBoundingRect=function(t){for(var r=new ds(0,0,0,0),s=t||this._children,o=[],l=null,c=0;c<s.length;c++){var a=s[c];if(!(a.ignore||a.invisible)){var d=a.getBoundingRect(),f=a.getLocalTransform(o);f?(ds.applyTransform(r,d,f),l=l||r.clone(),l.union(r)):(l=l||d.clone(),l.union(d))}}return l||r},e}(hB);_a.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var MP={},vse={};function n2e(n){delete vse[n]}function r2e(n){if(!n)return!1;if(typeof n=="string")return oL(n,1)<Vz;if(n.colorStops){for(var e=n.colorStops,t=0,r=e.length,s=0;s<r;s++)t+=oL(e[s].color,1);return t/=r,t<Vz}return!1}var i2e=function(){function n(e,t,r){var s=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,r=r||{},this.dom=t,this.id=e;var o=new TEe,l=r.renderer||"canvas";MP[l]||(l=lo(MP)[0]),r.useDirtyRect=r.useDirtyRect==null?!1:r.useDirtyRect;var c=new MP[l](t,o,r,e),a=r.ssr||c.ssrOnly;this.storage=o,this.painter=c;var d=!yi.node&&!yi.worker&&!a?new XEe(c.getViewportRoot(),c.root):null,f=r.useCoarsePointer,m=f==null||f==="auto"?yi.touchEventsSupported:!!f,_=44,x;m&&(x=Li(r.pointerSize,_)),this.handler=new tse(o,c,d,c.root,x),this.animation=new UEe({stage:{update:a?null:function(){return s._flush(!0)}}}),a||this.animation.start()}return n.prototype.add=function(e){this._disposed||!e||(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},n.prototype.remove=function(e){this._disposed||!e||(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(e,t){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh())},n.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=r2e(e))},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(e){this._darkMode=e},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},n.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},n.prototype.flush=function(){this._disposed||this._flush(!1)},n.prototype._flush=function(e){var t,r=Nb();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var s=Nb();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:s-r})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},n.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},n.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},n.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},n.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},n.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},n.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},n.prototype.findHover=function(e,t){if(!this._disposed)return this.handler.findHover(e,t)},n.prototype.on=function(e,t,r){return this._disposed||this.handler.on(e,t,r),this},n.prototype.off=function(e,t){this._disposed||this.handler.off(e,t)},n.prototype.trigger=function(e,t){this._disposed||this.handler.trigger(e,t)},n.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof _a&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},n.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,n2e(this.id))},n}();function uq(n,e){var t=new i2e(Xie(),n,e);return vse[t.id]=t,t}function s2e(n,e){MP[n]=e}var hq=1e-4,_se=20;function o2e(n){return n.replace(/^\s+|\s+$/g,"")}function qv(n,e,t,r){var s=e[0],o=e[1],l=t[0],c=t[1],a=o-s,d=c-l;if(a===0)return d===0?l:(l+c)/2;if(r)if(a>0){if(n<=s)return l;if(n>=o)return c}else{if(n>=s)return l;if(n<=o)return c}else{if(n===s)return l;if(n===o)return c}return(n-s)/a*d+l}function hs(n,e){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return Br(n)?o2e(n).match(/%$/)?parseFloat(n)/100*e:parseFloat(n):n==null?NaN:+n}function Ca(n,e,t){return e==null&&(e=10),e=Math.min(Math.max(0,e),_se),n=(+n).toFixed(e),t?n:+n}function a2e(n){return n.sort(function(e,t){return e-t}),n}function Um(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var e=1,t=0;t<15;t++,e*=10)if(Math.round(n*e)/e===n)return t}return l2e(n)}function l2e(n){var e=n.toString().toLowerCase(),t=e.indexOf("e"),r=t>0?+e.slice(t+1):0,s=t>0?t:e.length,o=e.indexOf("."),l=o<0?0:s-1-o;return Math.max(0,l-r)}function yse(n,e){var t=Math.log,r=Math.LN10,s=Math.floor(t(n[1]-n[0])/r),o=Math.round(t(Math.abs(e[1]-e[0]))/r),l=Math.min(Math.max(-s+o,0),20);return isFinite(l)?l:20}function c2e(n,e){var t=T0(n,function(x,A){return x+(isNaN(A)?0:A)},0);if(t===0)return[];for(var r=Math.pow(10,e),s=br(n,function(x){return(isNaN(x)?0:x)/t*r*100}),o=r*100,l=br(s,function(x){return Math.floor(x)}),c=T0(l,function(x,A){return x+A},0),a=br(s,function(x,A){return x-l[A]});c<o;){for(var d=Number.NEGATIVE_INFINITY,f=null,m=0,_=a.length;m<_;++m)a[m]>d&&(d=a[m],f=m);++l[f],a[f]=0,++c}return br(l,function(x){return x/r})}function u2e(n,e){var t=Math.max(Um(n),Um(e)),r=n+e;return t>_se?r:Ca(r,t)}function xse(n){var e=Math.PI*2;return(n%e+e)%e}function cL(n){return n>-hq&&n<hq}var h2e=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function ag(n){if(n instanceof Date)return n;if(Br(n)){var e=h2e.exec(n);if(!e)return new Date(NaN);if(e[8]){var t=+e[4]||0;return e[8].toUpperCase()!=="Z"&&(t-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,t,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}else return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function d2e(n){return Math.pow(10,yG(n))}function yG(n){if(n===0)return 0;var e=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,e)>=10&&e++,e}function bse(n,e){var t=yG(n),r=Math.pow(10,t),s=n/r,o;return s<1.5?o=1:s<2.5?o=2:s<4?o=3:s<7?o=5:o=10,n=o*r,t>=-20?+n.toFixed(t<0?-t:0):n}function E0(n){var e=parseFloat(n);return e==n&&(e!==0||!Br(n)||n.indexOf("x")<=0)?e:NaN}function f2e(n){return!isNaN(E0(n))}function wse(){return Math.round(Math.random()*9)}function Sse(n,e){return e===0?n:Sse(e,n%e)}function dq(n,e){return n==null?e:e==null?n:n*e/Sse(n,e)}function us(n){throw new Error(n)}function fq(n,e,t){return(e-n)*t+n}var Ase="series\0",Tse="\0_ec_\0";function va(n){return n instanceof Array?n:n==null?[]:[n]}function Wz(n,e,t){if(n){n[e]=n[e]||{},n.emphasis=n.emphasis||{},n.emphasis[e]=n.emphasis[e]||{};for(var r=0,s=t.length;r<s;r++){var o=t[r];!n.emphasis[e].hasOwnProperty(o)&&n[e].hasOwnProperty(o)&&(n.emphasis[e][o]=n[e][o])}}}var pq=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function DC(n){return qr(n)&&!fr(n)&&!(n instanceof Date)?n.value:n}function p2e(n){return qr(n)&&!(n instanceof Array)}function m2e(n,e,t){var r=t==="normalMerge",s=t==="replaceMerge",o=t==="replaceAll";n=n||[],e=(e||[]).slice();var l=oi();ot(e,function(a,d){if(!qr(a)){e[d]=null;return}});var c=g2e(n,l,t);return(r||s)&&v2e(c,n,l,e),r&&_2e(c,e),r||s?y2e(c,e,s):o&&x2e(c,e),b2e(c),c}function g2e(n,e,t){var r=[];if(t==="replaceAll")return r;for(var s=0;s<n.length;s++){var o=n[s];o&&o.id!=null&&e.set(o.id,s),r.push({existing:t==="replaceMerge"||RM(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return r}function v2e(n,e,t,r){ot(r,function(s,o){if(!(!s||s.id==null)){var l=PT(s.id),c=t.get(l);if(c!=null){var a=n[c];wp(!a.newOption,'Duplicated option on id "'+l+'".'),a.newOption=s,a.existing=e[c],r[o]=null}}})}function _2e(n,e){ot(e,function(t,r){if(!(!t||t.name==null))for(var s=0;s<n.length;s++){var o=n[s].existing;if(!n[s].newOption&&o&&(o.id==null||t.id==null)&&!RM(t)&&!RM(o)&&Mse("name",o,t)){n[s].newOption=t,e[r]=null;return}}})}function y2e(n,e,t){ot(e,function(r){if(r){for(var s,o=0;(s=n[o])&&(s.newOption||RM(s.existing)||s.existing&&r.id!=null&&!Mse("id",r,s.existing));)o++;s?(s.newOption=r,s.brandNew=t):n.push({newOption:r,brandNew:t,existing:null,keyInfo:null}),o++}})}function x2e(n,e){ot(e,function(t){n.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})})}function b2e(n){var e=oi();ot(n,function(t){var r=t.existing;r&&e.set(r.id,t)}),ot(n,function(t){var r=t.newOption;wp(!r||r.id==null||!e.get(r.id)||e.get(r.id)===t,"id duplicates: "+(r&&r.id)),r&&r.id!=null&&e.set(r.id,t),!t.keyInfo&&(t.keyInfo={})}),ot(n,function(t,r){var s=t.existing,o=t.newOption,l=t.keyInfo;if(qr(o)){if(l.name=o.name!=null?PT(o.name):s?s.name:Ase+r,s)l.id=PT(s.id);else if(o.id!=null)l.id=PT(o.id);else{var c=0;do l.id="\0"+l.name+"\0"+c++;while(e.get(l.id))}e.set(l.id,t)}})}function Mse(n,e,t){var r=vp(e[n],null),s=vp(t[n],null);return r!=null&&s!=null&&r===s}function PT(n){return vp(n,"")}function vp(n,e){return n==null?e:Br(n)?n:Ds(n)||Ez(n)?n+"":e}function xG(n){var e=n.name;return!!(e&&e.indexOf(Ase))}function RM(n){return n&&n.id!=null&&PT(n.id).indexOf(Tse)===0}function w2e(n){return Tse+n}function S2e(n,e,t){ot(n,function(r){var s=r.newOption;qr(s)&&(r.keyInfo.mainType=e,r.keyInfo.subType=A2e(e,s,r.existing,t))})}function A2e(n,e,t,r){var s=e.type?e.type:t?t.subType:r.determineSubType(n,e);return s}function yx(n,e){if(e.dataIndexInside!=null)return e.dataIndexInside;if(e.dataIndex!=null)return fr(e.dataIndex)?br(e.dataIndex,function(t){return n.indexOfRawIndex(t)}):n.indexOfRawIndex(e.dataIndex);if(e.name!=null)return fr(e.name)?br(e.name,function(t){return n.indexOfName(t)}):n.indexOfName(e.name)}function Zs(){var n="__ec_inner_"+T2e++;return function(e){return e[n]||(e[n]={})}}var T2e=wse();function RT(n,e,t){var r=bG(e,t),s=r.mainTypeSpecified,o=r.queryOptionMap,l=r.others,c=l,a=t?t.defaultMainType:null;return!s&&a&&o.set(a,{}),o.each(function(d,f){var m=BC(n,f,d,{useDefault:a===f,enableAll:t&&t.enableAll!=null?t.enableAll:!0,enableNone:t&&t.enableNone!=null?t.enableNone:!0});c[f+"Models"]=m.models,c[f+"Model"]=m.models[0]}),c}function bG(n,e){var t;if(Br(n)){var r={};r[n+"Index"]=0,t=r}else t=n;var s=oi(),o={},l=!1;return ot(t,function(c,a){if(a==="dataIndex"||a==="dataIndexInside"){o[a]=c;return}var d=a.match(/^(\w+)(Index|Id|Name)$/)||[],f=d[1],m=(d[2]||"").toLowerCase();if(!(!f||!m||e&&e.includeMainTypes&&Zi(e.includeMainTypes,f)<0)){l=l||!!f;var _=s.get(f)||s.set(f,{});_[m]=c}}),{mainTypeSpecified:l,queryOptionMap:s,others:o}}var Sl={useDefault:!0,enableAll:!1,enableNone:!1},M2e={useDefault:!1,enableAll:!0,enableNone:!0};function BC(n,e,t,r){r=r||Sl;var s=t.index,o=t.id,l=t.name,c={models:null,specified:s!=null||o!=null||l!=null};if(!c.specified){var a=void 0;return c.models=r.useDefault&&(a=n.getComponent(e))?[a]:[],c}return s==="none"||s===!1?(wp(r.enableNone,'`"none"` or `false` is not a valid value on index option.'),c.models=[],c):(s==="all"&&(wp(r.enableAll,'`"all"` is not a valid value on index option.'),s=o=l=null),c.models=n.queryComponents({mainType:e,index:s,id:o,name:l}),c)}function Cse(n,e,t){n.setAttribute?n.setAttribute(e,t):n[e]=t}function C2e(n,e){return n.getAttribute?n.getAttribute(e):n[e]}function E2e(n){return n==="auto"?yi.domSupported?"html":"richText":n||"html"}function Ese(n,e,t,r,s){var o=e==null||e==="auto";if(r==null)return r;if(Ds(r)){var l=fq(t||0,r,s);return Ca(l,o?Math.max(Um(t||0),Um(r)):e)}else{if(Br(r))return s<1?t:r;for(var c=[],a=t,d=r,f=Math.max(a?a.length:0,d.length),m=0;m<f;++m){var _=n.getDimensionInfo(m);if(_&&_.type==="ordinal")c[m]=(s<1&&a?a:d)[m];else{var x=a&&a[m]?a[m]:0,A=d[m],l=fq(x,A,s);c[m]=Ca(l,o?Math.max(Um(x),Um(A)):e)}}return c}}var I2e=".",Z_="___EC__COMPONENT__CONTAINER___",Ise="___EC__EXTENDED_CLASS___";function up(n){var e={main:"",sub:""};if(n){var t=n.split(I2e);e.main=t[0]||"",e.sub=t[1]||""}return e}function P2e(n){wp(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function R2e(n){return!!(n&&n[Ise])}function wG(n,e){n.$constructor=n,n.extend=function(t){var r=this,s;return L2e(r)?s=function(o){jn(l,o);function l(){return o.apply(this,arguments)||this}return l}(r):(s=function(){(t.$constructor||r).apply(this,arguments)},UCe(s,this)),Qn(s.prototype,t),s[Ise]=!0,s.extend=this.extend,s.superCall=k2e,s.superApply=O2e,s.superClass=r,s}}function L2e(n){return hi(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function Pse(n,e){n.extend=e.extend}var D2e=Math.round(Math.random()*10);function B2e(n){var e=["__\0is_clz",D2e++].join("_");n.prototype[e]=!0,n.isInstance=function(t){return!!(t&&t[e])}}function k2e(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return this.superClass.prototype[e].apply(n,t)}function O2e(n,e,t){return this.superClass.prototype[e].apply(n,t)}function dB(n){var e={};n.registerClass=function(r){var s=r.type||r.prototype.type;if(s){P2e(s),r.prototype.type=s;var o=up(s);if(!o.sub)e[o.main]=r;else if(o.sub!==Z_){var l=t(o);l[o.sub]=r}}return r},n.getClass=function(r,s,o){var l=e[r];if(l&&l[Z_]&&(l=s?l[s]:null),o&&!l)throw new Error(s?"Component "+r+"."+(s||"")+" is used but not imported.":r+".type should be specified.");return l},n.getClassesByMainType=function(r){var s=up(r),o=[],l=e[s.main];return l&&l[Z_]?ot(l,function(c,a){a!==Z_&&o.push(c)}):o.push(l),o},n.hasClass=function(r){var s=up(r);return!!e[s.main]},n.getAllClassMainTypes=function(){var r=[];return ot(e,function(s,o){r.push(o)}),r},n.hasSubTypes=function(r){var s=up(r),o=e[s.main];return o&&o[Z_]};function t(r){var s=e[r.main];return(!s||!s[Z_])&&(s=e[r.main]={},s[Z_]=!0),s}}function LM(n,e){for(var t=0;t<n.length;t++)n[t][1]||(n[t][1]=n[t][0]);return e=e||!1,function(r,s,o){for(var l={},c=0;c<n.length;c++){var a=n[c][1];if(!(s&&Zi(s,a)>=0||o&&Zi(o,a)<0)){var d=r.getShallow(a,e);d!=null&&(l[n[c][0]]=d)}}return l}}var F2e=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],N2e=LM(F2e),z2e=function(){function n(){}return n.prototype.getAreaStyle=function(e,t){return N2e(this,e,t)},n}(),$z=new PC(50);function U2e(n){if(typeof n=="string"){var e=$z.get(n);return e&&e.image}else return n}function Rse(n,e,t,r,s){if(n)if(typeof n=="string"){if(e&&e.__zrImageSrc===n||!t)return e;var o=$z.get(n),l={hostEl:t,cb:r,cbPayload:s};return o?(e=o.image,!fB(e)&&o.pending.push(l)):(e=Hw.loadImage(n,mq,mq),e.__zrImageSrc=n,$z.put(n,e.__cachedImgObj={image:e,pending:[l]})),e}else return n;else return e}function mq(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<n.pending.length;e++){var t=n.pending[e],r=t.cb;r&&r(this,t.cbPayload),t.hostEl.dirty()}n.pending.length=0}function fB(n){return n&&n.width&&n.height}var m3=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function G2e(n,e,t,r,s){if(!e)return"";var o=(n+"").split(`
`);s=Lse(e,t,r,s);for(var l=0,c=o.length;l<c;l++)o[l]=Dse(o[l],s);return o.join(`
`)}function Lse(n,e,t,r){r=r||{};var s=Qn({},r);s.font=e,t=Li(t,"..."),s.maxIterations=Li(r.maxIterations,2);var o=s.minChar=Li(r.minChar,0);s.cnCharWidth=Gu("",e);var l=s.ascCharWidth=Gu("a",e);s.placeholder=Li(r.placeholder,"");for(var c=n=Math.max(0,n-1),a=0;a<o&&c>=l;a++)c-=l;var d=Gu(t,e);return d>c&&(t="",d=0),c=n-d,s.ellipsis=t,s.ellipsisWidth=d,s.contentWidth=c,s.containerWidth=n,s}function Dse(n,e){var t=e.containerWidth,r=e.font,s=e.contentWidth;if(!t)return"";var o=Gu(n,r);if(o<=t)return n;for(var l=0;;l++){if(o<=s||l>=e.maxIterations){n+=e.ellipsis;break}var c=l===0?V2e(n,s,e.ascCharWidth,e.cnCharWidth):o>0?Math.floor(n.length*s/o):0;n=n.substr(0,c),o=Gu(n,r)}return n===""&&(n=e.placeholder),n}function V2e(n,e,t,r){for(var s=0,o=0,l=n.length;o<l&&s<e;o++){var c=n.charCodeAt(o);s+=0<=c&&c<=127?t:r}return o}function H2e(n,e){n!=null&&(n+="");var t=e.overflow,r=e.padding,s=e.font,o=t==="truncate",l=_G(s),c=Li(e.lineHeight,l),a=!!e.backgroundColor,d=e.lineOverflow==="truncate",f=e.width,m;f!=null&&(t==="break"||t==="breakAll")?m=n?Bse(n,e.font,f,t==="breakAll",0).lines:[]:m=n?n.split(`
`):[];var _=m.length*c,x=Li(e.height,_);if(_>x&&d){var A=Math.floor(x/c);m=m.slice(0,A)}if(n&&o&&f!=null)for(var I=Lse(f,s,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),E=0;E<m.length;E++)m[E]=Dse(m[E],I);for(var C=x,L=0,E=0;E<m.length;E++)L=Math.max(Gu(m[E],s),L);f==null&&(f=L);var O=L;return r&&(C+=r[0]+r[2],O+=r[1]+r[3],f+=r[1]+r[3]),a&&(O=f),{lines:m,height:x,outerWidth:O,outerHeight:C,lineHeight:c,calculatedLineHeight:l,contentWidth:L,contentHeight:_,width:f}}var j2e=function(){function n(){}return n}(),gq=function(){function n(e){this.tokens=[],e&&(this.tokens=e)}return n}(),W2e=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return n}();function $2e(n,e){var t=new W2e;if(n!=null&&(n+=""),!n)return t;for(var r=e.width,s=e.height,o=e.overflow,l=(o==="break"||o==="breakAll")&&r!=null?{width:r,accumWidth:0,breakAll:o==="breakAll"}:null,c=m3.lastIndex=0,a;(a=m3.exec(n))!=null;){var d=a.index;d>c&&g3(t,n.substring(c,d),e,l),g3(t,a[2],e,l,a[1]),c=m3.lastIndex}c<n.length&&g3(t,n.substring(c,n.length),e,l);var f=[],m=0,_=0,x=e.padding,A=o==="truncate",I=e.lineOverflow==="truncate";function E(ye,We,Ue){ye.width=We,ye.lineHeight=Ue,m+=Ue,_=Math.max(_,We)}e:for(var C=0;C<t.lines.length;C++){for(var L=t.lines[C],O=0,H=0,q=0;q<L.tokens.length;q++){var Z=L.tokens[q],J=Z.styleName&&e.rich[Z.styleName]||{},re=Z.textPadding=J.padding,se=re?re[1]+re[3]:0,ae=Z.font=J.font||e.font;Z.contentHeight=_G(ae);var he=Li(J.height,Z.contentHeight);if(Z.innerHeight=he,re&&(he+=re[0]+re[2]),Z.height=he,Z.lineHeight=MT(J.lineHeight,e.lineHeight,he),Z.align=J&&J.align||e.align,Z.verticalAlign=J&&J.verticalAlign||"middle",I&&s!=null&&m+Z.lineHeight>s){q>0?(L.tokens=L.tokens.slice(0,q),E(L,H,O),t.lines=t.lines.slice(0,C+1)):t.lines=t.lines.slice(0,C);break e}var Ae=J.width,Ee=Ae==null||Ae==="auto";if(typeof Ae=="string"&&Ae.charAt(Ae.length-1)==="%")Z.percentWidth=Ae,f.push(Z),Z.contentWidth=Gu(Z.text,ae);else{if(Ee){var Pe=J.backgroundColor,ze=Pe&&Pe.image;ze&&(ze=U2e(ze),fB(ze)&&(Z.width=Math.max(Z.width,ze.width*he/ze.height)))}var Re=A&&r!=null?r-H:null;Re!=null&&Re<Z.width?!Ee||Re<se?(Z.text="",Z.width=Z.contentWidth=0):(Z.text=G2e(Z.text,Re-se,ae,e.ellipsis,{minChar:e.truncateMinChar}),Z.width=Z.contentWidth=Gu(Z.text,ae)):Z.contentWidth=Gu(Z.text,ae)}Z.width+=se,H+=Z.width,J&&(O=Math.max(O,Z.lineHeight))}E(L,H,O)}t.outerWidth=t.width=Li(r,_),t.outerHeight=t.height=Li(s,m),t.contentHeight=m,t.contentWidth=_,x&&(t.outerWidth+=x[1]+x[3],t.outerHeight+=x[0]+x[2]);for(var C=0;C<f.length;C++){var Z=f[C],rt=Z.percentWidth;Z.width=parseInt(rt,10)/100*t.width}return t}function g3(n,e,t,r,s){var o=e==="",l=s&&t.rich[s]||{},c=n.lines,a=l.font||t.font,d=!1,f,m;if(r){var _=l.padding,x=_?_[1]+_[3]:0;if(l.width!=null&&l.width!=="auto"){var A=C0(l.width,r.width)+x;c.length>0&&A+r.accumWidth>r.width&&(f=e.split(`
`),d=!0),r.accumWidth=A}else{var I=Bse(e,a,r.width,r.breakAll,r.accumWidth);r.accumWidth=I.accumWidth+x,m=I.linesWidths,f=I.lines}}else f=e.split(`
`);for(var E=0;E<f.length;E++){var C=f[E],L=new j2e;if(L.styleName=s,L.text=C,L.isLineHolder=!C&&!o,typeof l.width=="number"?L.width=l.width:L.width=m?m[E]:Gu(C,a),!E&&!d){var O=(c[c.length-1]||(c[0]=new gq)).tokens,H=O.length;H===1&&O[0].isLineHolder?O[0]=L:(C||!H||o)&&O.push(L)}else c.push(new gq([L]))}}function X2e(n){var e=n.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}var q2e=T0(",&?/;] ".split(""),function(n,e){return n[e]=!0,n},{});function Y2e(n){return X2e(n)?!!q2e[n]:!0}function Bse(n,e,t,r,s){for(var o=[],l=[],c="",a="",d=0,f=0,m=0;m<n.length;m++){var _=n.charAt(m);if(_===`
`){a&&(c+=a,f+=d),o.push(c),l.push(f),c="",a="",d=0,f=0;continue}var x=Gu(_,e),A=r?!1:!Y2e(_);if(o.length?f+x>t:s+f+x>t){f?(c||a)&&(A?(c||(c=a,a="",d=0,f=d),o.push(c),l.push(f-d),a+=_,d+=x,c="",f=d):(a&&(c+=a,a="",d=0),o.push(c),l.push(f),c=_,f=x)):A?(o.push(a),l.push(d),a=_,d=x):(o.push(_),l.push(x));continue}f+=x,A?(a+=_,d+=x):(a&&(c+=a,a="",d=0),c+=_)}return!o.length&&!c&&(c=n,a="",d=0),a&&(c+=a),c&&(o.push(c),l.push(f)),o.length===1&&(f+=s),{accumWidth:f,lines:o,linesWidths:l}}var Xz="__zr_style_"+Math.round(Math.random()*10),ex={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},pB={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};ex[Xz]=!0;var vq=["z","z2","invisible"],Z2e=["invisible"],K2e=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype._init=function(t){for(var r=lo(t),s=0;s<r.length;s++){var o=r[s];o==="style"?this.useStyle(t[o]):n.prototype.attrKV.call(this,o,t[o])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,r,s,o){var l=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&J2e(this,t,r)||l&&!l[0]&&!l[3])return!1;if(s&&this.__clipPaths){for(var c=0;c<this.__clipPaths.length;++c)if(this.__clipPaths[c].isZeroArea())return!1}if(o&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},e.prototype.contain=function(t,r){return this.rectContain(t,r)},e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.rectContain=function(t,r){var s=this.transformCoordToLocal(t,r),o=this.getBoundingRect();return o.contain(s[0],s[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var r=this.transform,s=this.getBoundingRect(),o=this.style,l=o.shadowBlur||0,c=o.shadowOffsetX||0,a=o.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new ds(0,0,0,0)),r?ds.applyTransform(t,s,r):t.copy(s),(l||c||a)&&(t.width+=l*2+Math.abs(c),t.height+=l*2+Math.abs(a),t.x=Math.min(t.x,t.x+c-l),t.y=Math.min(t.y,t.y+a-l));var d=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-d),t.y=Math.floor(t.y-d),t.width=Math.ceil(t.width+1+d*2),t.height=Math.ceil(t.height+1+d*2))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new ds(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(t,r){t!=="style"?n.prototype.attrKV.call(this,t,r):this.style?this.setStyle(r):this.useStyle(r)},e.prototype.setStyle=function(t,r){return typeof t=="string"?this.style[t]=r:Qn(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=XA,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(this.__dirty&XA)},e.prototype.styleUpdated=function(){this.__dirty&=~XA},e.prototype.createStyle=function(t){return aB(ex,t)},e.prototype.useStyle=function(t){t[Xz]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[Xz]},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.style&&!r.style&&(r.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,r,vq)},e.prototype._applyStateObj=function(t,r,s,o,l,c){n.prototype._applyStateObj.call(this,t,r,s,o,l,c);var a=!(r&&o),d;if(r&&r.style?l?o?d=r.style:(d=this._mergeStyle(this.createStyle(),s.style),this._mergeStyle(d,r.style)):(d=this._mergeStyle(this.createStyle(),o?this.style:s.style),this._mergeStyle(d,r.style)):a&&(d=s.style),d)if(l){var f=this.style;if(this.style=this.createStyle(a?{}:f),a)for(var m=lo(f),_=0;_<m.length;_++){var x=m[_];x in d&&(d[x]=d[x],this.style[x]=f[x])}for(var A=lo(d),_=0;_<A.length;_++){var x=A[_];this.style[x]=this.style[x]}this._transitionState(t,{style:d},c,this.getAnimationStyleProps())}else this.useStyle(d);for(var I=this.__inHover?Z2e:vq,_=0;_<I.length;_++){var x=I[_];r&&r[x]!=null?this[x]=r[x]:a&&s[x]!=null&&(this[x]=s[x])}},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),s,o=0;o<t.length;o++){var l=t[o];l.style&&(s=s||{},this._mergeStyle(s,l.style))}return s&&(r.style=s),r},e.prototype._mergeStyle=function(t,r){return Qn(t,r),t},e.prototype.getAnimationStyleProps=function(){return pB},e.initDefaultProps=function(){var t=e.prototype;t.type="displayable",t.invisible=!1,t.z=0,t.z2=0,t.zlevel=0,t.culling=!1,t.cursor="pointer",t.rectHover=!1,t.incremental=!1,t._rect=null,t.dirtyRectTolerance=0,t.__dirty=Fu|XA}(),e}(hB),v3=new ds(0,0,0,0),_3=new ds(0,0,0,0);function J2e(n,e,t){return v3.copy(n.getBoundingRect()),n.transform&&v3.applyTransform(n.transform),_3.width=e,_3.height=t,!v3.intersect(_3)}const $w=K2e;var ou=Math.min,au=Math.max,y3=Math.sin,x3=Math.cos,K_=Math.PI*2,cI=Ww(),uI=Ww(),hI=Ww();function kse(n,e,t){if(n.length!==0){for(var r=n[0],s=r[0],o=r[0],l=r[1],c=r[1],a=1;a<n.length;a++)r=n[a],s=ou(s,r[0]),o=au(o,r[0]),l=ou(l,r[1]),c=au(c,r[1]);e[0]=s,e[1]=l,t[0]=o,t[1]=c}}function _q(n,e,t,r,s,o){s[0]=ou(n,t),s[1]=ou(e,r),o[0]=au(n,t),o[1]=au(e,r)}var yq=[],xq=[];function Q2e(n,e,t,r,s,o,l,c,a,d){var f=ose,m=ja,_=f(n,t,s,l,yq);a[0]=1/0,a[1]=1/0,d[0]=-1/0,d[1]=-1/0;for(var x=0;x<_;x++){var A=m(n,t,s,l,yq[x]);a[0]=ou(A,a[0]),d[0]=au(A,d[0])}_=f(e,r,o,c,xq);for(var x=0;x<_;x++){var I=m(e,r,o,c,xq[x]);a[1]=ou(I,a[1]),d[1]=au(I,d[1])}a[0]=ou(n,a[0]),d[0]=au(n,d[0]),a[0]=ou(l,a[0]),d[0]=au(l,d[0]),a[1]=ou(e,a[1]),d[1]=au(e,d[1]),a[1]=ou(c,a[1]),d[1]=au(c,d[1])}function eIe(n,e,t,r,s,o,l,c){var a=lse,d=Wl,f=au(ou(a(n,t,s),1),0),m=au(ou(a(e,r,o),1),0),_=d(n,t,s,f),x=d(e,r,o,m);l[0]=ou(n,s,_),l[1]=ou(e,o,x),c[0]=au(n,s,_),c[1]=au(e,o,x)}function tIe(n,e,t,r,s,o,l,c,a){var d=Ob,f=Fb,m=Math.abs(s-o);if(m%K_<1e-4&&m>1e-4){c[0]=n-t,c[1]=e-r,a[0]=n+t,a[1]=e+r;return}if(cI[0]=x3(s)*t+n,cI[1]=y3(s)*r+e,uI[0]=x3(o)*t+n,uI[1]=y3(o)*r+e,d(c,cI,uI),f(a,cI,uI),s=s%K_,s<0&&(s=s+K_),o=o%K_,o<0&&(o=o+K_),s>o&&!l?o+=K_:s<o&&l&&(s+=K_),l){var _=o;o=s,s=_}for(var x=0;x<o;x+=Math.PI/2)x>s&&(hI[0]=x3(x)*t+n,hI[1]=y3(x)*r+e,d(c,hI,c),f(a,hI,a))}var Rs={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},J_=[],Q_=[],Kf=[],Mv=[],Jf=[],Qf=[],b3=Math.min,w3=Math.max,ey=Math.cos,ty=Math.sin,Sm=Math.abs,qz=Math.PI,zv=qz*2,S3=typeof Float32Array<"u",fA=[];function A3(n){var e=Math.round(n/qz*1e8)/1e8;return e%2*qz}function Ose(n,e){var t=A3(n[0]);t<0&&(t+=zv);var r=t-n[0],s=n[1];s+=r,!e&&s-t>=zv?s=t+zv:e&&t-s>=zv?s=t-zv:!e&&t>s?s=t+(zv-A3(t-s)):e&&t<s&&(s=t-(zv-A3(s-t))),n[0]=t,n[1]=s}var lg=function(){function n(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(e,t,r){r=r||0,r>0&&(this._ux=Sm(r/aL/e)||0,this._uy=Sm(r/aL/t)||0)},n.prototype.setDPR=function(e){this.dpr=e},n.prototype.setContext=function(e){this._ctx=e},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(Rs.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},n.prototype.lineTo=function(e,t){var r=Sm(e-this._xi),s=Sm(t-this._yi),o=r>this._ux||s>this._uy;if(this.addData(Rs.L,e,t),this._ctx&&o&&this._ctx.lineTo(e,t),o)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var l=r*r+s*s;l>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=l)}return this},n.prototype.bezierCurveTo=function(e,t,r,s,o,l){return this._drawPendingPt(),this.addData(Rs.C,e,t,r,s,o,l),this._ctx&&this._ctx.bezierCurveTo(e,t,r,s,o,l),this._xi=o,this._yi=l,this},n.prototype.quadraticCurveTo=function(e,t,r,s){return this._drawPendingPt(),this.addData(Rs.Q,e,t,r,s),this._ctx&&this._ctx.quadraticCurveTo(e,t,r,s),this._xi=r,this._yi=s,this},n.prototype.arc=function(e,t,r,s,o,l){this._drawPendingPt(),fA[0]=s,fA[1]=o,Ose(fA,l),s=fA[0],o=fA[1];var c=o-s;return this.addData(Rs.A,e,t,r,r,s,c,0,l?0:1),this._ctx&&this._ctx.arc(e,t,r,s,o,l),this._xi=ey(o)*r+e,this._yi=ty(o)*r+t,this},n.prototype.arcTo=function(e,t,r,s,o){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,r,s,o),this},n.prototype.rect=function(e,t,r,s){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,r,s),this.addData(Rs.R,e,t,r,s),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(Rs.Z);var e=this._ctx,t=this._x0,r=this._y0;return e&&e.closePath(),this._xi=t,this._yi=r,this},n.prototype.fill=function(e){e&&e.fill(),this.toStatic()},n.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(e){var t=e.length;!(this.data&&this.data.length===t)&&S3&&(this.data=new Float32Array(t));for(var r=0;r<t;r++)this.data[r]=e[r];this._len=t},n.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var t=e.length,r=0,s=this._len,o=0;o<t;o++)r+=e[o].len();S3&&this.data instanceof Float32Array&&(this.data=new Float32Array(s+r));for(var o=0;o<t;o++)for(var l=e[o].data,c=0;c<l.length;c++)this.data[s++]=l[c];this._len=s},n.prototype.addData=function(e,t,r,s,o,l,c,a,d){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var m=0;m<arguments.length;m++)f[this._len++]=arguments[m]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,S3&&this._len>11&&(this.data=new Float32Array(e)))}},n.prototype.getBoundingRect=function(){Kf[0]=Kf[1]=Jf[0]=Jf[1]=Number.MAX_VALUE,Mv[0]=Mv[1]=Qf[0]=Qf[1]=-Number.MAX_VALUE;var e=this.data,t=0,r=0,s=0,o=0,l;for(l=0;l<this._len;){var c=e[l++],a=l===1;switch(a&&(t=e[l],r=e[l+1],s=t,o=r),c){case Rs.M:t=s=e[l++],r=o=e[l++],Jf[0]=s,Jf[1]=o,Qf[0]=s,Qf[1]=o;break;case Rs.L:_q(t,r,e[l],e[l+1],Jf,Qf),t=e[l++],r=e[l++];break;case Rs.C:Q2e(t,r,e[l++],e[l++],e[l++],e[l++],e[l],e[l+1],Jf,Qf),t=e[l++],r=e[l++];break;case Rs.Q:eIe(t,r,e[l++],e[l++],e[l],e[l+1],Jf,Qf),t=e[l++],r=e[l++];break;case Rs.A:var d=e[l++],f=e[l++],m=e[l++],_=e[l++],x=e[l++],A=e[l++]+x;l+=1;var I=!e[l++];a&&(s=ey(x)*m+d,o=ty(x)*_+f),tIe(d,f,m,_,x,A,I,Jf,Qf),t=ey(A)*m+d,r=ty(A)*_+f;break;case Rs.R:s=t=e[l++],o=r=e[l++];var E=e[l++],C=e[l++];_q(s,o,s+E,o+C,Jf,Qf);break;case Rs.Z:t=s,r=o;break}Ob(Kf,Kf,Jf),Fb(Mv,Mv,Qf)}return l===0&&(Kf[0]=Kf[1]=Mv[0]=Mv[1]=0),new ds(Kf[0],Kf[1],Mv[0]-Kf[0],Mv[1]-Kf[1])},n.prototype._calculateLength=function(){var e=this.data,t=this._len,r=this._ux,s=this._uy,o=0,l=0,c=0,a=0;this._pathSegLen||(this._pathSegLen=[]);for(var d=this._pathSegLen,f=0,m=0,_=0;_<t;){var x=e[_++],A=_===1;A&&(o=e[_],l=e[_+1],c=o,a=l);var I=-1;switch(x){case Rs.M:o=c=e[_++],l=a=e[_++];break;case Rs.L:{var E=e[_++],C=e[_++],L=E-o,O=C-l;(Sm(L)>r||Sm(O)>s||_===t-1)&&(I=Math.sqrt(L*L+O*O),o=E,l=C);break}case Rs.C:{var H=e[_++],q=e[_++],E=e[_++],C=e[_++],Z=e[_++],J=e[_++];I=MEe(o,l,H,q,E,C,Z,J,10),o=Z,l=J;break}case Rs.Q:{var H=e[_++],q=e[_++],E=e[_++],C=e[_++];I=EEe(o,l,H,q,E,C,10),o=E,l=C;break}case Rs.A:var re=e[_++],se=e[_++],ae=e[_++],he=e[_++],Ae=e[_++],Ee=e[_++],Pe=Ee+Ae;_+=1,A&&(c=ey(Ae)*ae+re,a=ty(Ae)*he+se),I=w3(ae,he)*b3(zv,Math.abs(Ee)),o=ey(Pe)*ae+re,l=ty(Pe)*he+se;break;case Rs.R:{c=o=e[_++],a=l=e[_++];var ze=e[_++],Re=e[_++];I=ze*2+Re*2;break}case Rs.Z:{var L=c-o,O=a-l;I=Math.sqrt(L*L+O*O),o=c,l=a;break}}I>=0&&(d[m++]=I,f+=I)}return this._pathLen=f,f},n.prototype.rebuildPath=function(e,t){var r=this.data,s=this._ux,o=this._uy,l=this._len,c,a,d,f,m,_,x=t<1,A,I,E=0,C=0,L,O=0,H,q;if(!(x&&(this._pathSegLen||this._calculateLength(),A=this._pathSegLen,I=this._pathLen,L=t*I,!L)))e:for(var Z=0;Z<l;){var J=r[Z++],re=Z===1;switch(re&&(d=r[Z],f=r[Z+1],c=d,a=f),J!==Rs.L&&O>0&&(e.lineTo(H,q),O=0),J){case Rs.M:c=d=r[Z++],a=f=r[Z++],e.moveTo(d,f);break;case Rs.L:{m=r[Z++],_=r[Z++];var se=Sm(m-d),ae=Sm(_-f);if(se>s||ae>o){if(x){var he=A[C++];if(E+he>L){var Ae=(L-E)/he;e.lineTo(d*(1-Ae)+m*Ae,f*(1-Ae)+_*Ae);break e}E+=he}e.lineTo(m,_),d=m,f=_,O=0}else{var Ee=se*se+ae*ae;Ee>O&&(H=m,q=_,O=Ee)}break}case Rs.C:{var Pe=r[Z++],ze=r[Z++],Re=r[Z++],rt=r[Z++],ye=r[Z++],We=r[Z++];if(x){var he=A[C++];if(E+he>L){var Ae=(L-E)/he;M0(d,Pe,Re,ye,Ae,J_),M0(f,ze,rt,We,Ae,Q_),e.bezierCurveTo(J_[1],Q_[1],J_[2],Q_[2],J_[3],Q_[3]);break e}E+=he}e.bezierCurveTo(Pe,ze,Re,rt,ye,We),d=ye,f=We;break}case Rs.Q:{var Pe=r[Z++],ze=r[Z++],Re=r[Z++],rt=r[Z++];if(x){var he=A[C++];if(E+he>L){var Ae=(L-E)/he;sL(d,Pe,Re,Ae,J_),sL(f,ze,rt,Ae,Q_),e.quadraticCurveTo(J_[1],Q_[1],J_[2],Q_[2]);break e}E+=he}e.quadraticCurveTo(Pe,ze,Re,rt),d=Re,f=rt;break}case Rs.A:var Ue=r[Z++],gt=r[Z++],vt=r[Z++],Dt=r[Z++],lt=r[Z++],jt=r[Z++],Qt=r[Z++],nn=!r[Z++],Wn=vt>Dt?vt:Dt,kn=Sm(vt-Dt)>.001,Mn=lt+jt,De=!1;if(x){var he=A[C++];E+he>L&&(Mn=lt+jt*(L-E)/he,De=!0),E+=he}if(kn&&e.ellipse?e.ellipse(Ue,gt,vt,Dt,Qt,lt,Mn,nn):e.arc(Ue,gt,Wn,lt,Mn,nn),De)break e;re&&(c=ey(lt)*vt+Ue,a=ty(lt)*Dt+gt),d=ey(Mn)*vt+Ue,f=ty(Mn)*Dt+gt;break;case Rs.R:c=d=r[Z],a=f=r[Z+1],m=r[Z++],_=r[Z++];var Ye=r[Z++],gn=r[Z++];if(x){var he=A[C++];if(E+he>L){var un=L-E;e.moveTo(m,_),e.lineTo(m+b3(un,Ye),_),un-=Ye,un>0&&e.lineTo(m+Ye,_+b3(un,gn)),un-=gn,un>0&&e.lineTo(m+w3(Ye-un,0),_+gn),un-=Ye,un>0&&e.lineTo(m,_+w3(gn-un,0));break e}E+=he}e.rect(m,_,Ye,gn);break;case Rs.Z:if(x){var he=A[C++];if(E+he>L){var Ae=(L-E)/he;e.lineTo(d*(1-Ae)+c*Ae,f*(1-Ae)+a*Ae);break e}E+=he}e.closePath(),d=c,f=a}}},n.prototype.clone=function(){var e=new n,t=this.data;return e.data=t.slice?t.slice():Array.prototype.slice.call(t),e._len=this._len,e},n.CMD=Rs,n.initDefaultProps=function(){var e=n.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}(),n}();function X1(n,e,t,r,s,o,l){if(s===0)return!1;var c=s,a=0,d=n;if(l>e+c&&l>r+c||l<e-c&&l<r-c||o>n+c&&o>t+c||o<n-c&&o<t-c)return!1;if(n!==t)a=(e-r)/(n-t),d=(n*r-t*e)/(n-t);else return Math.abs(o-n)<=c/2;var f=a*o-l+d,m=f*f/(a*a+1);return m<=c/2*c/2}function nIe(n,e,t,r,s,o,l,c,a,d,f){if(a===0)return!1;var m=a;if(f>e+m&&f>r+m&&f>o+m&&f>c+m||f<e-m&&f<r-m&&f<o-m&&f<c-m||d>n+m&&d>t+m&&d>s+m&&d>l+m||d<n-m&&d<t-m&&d<s-m&&d<l-m)return!1;var _=ase(n,e,t,r,s,o,l,c,d,f,null);return _<=m/2}function rIe(n,e,t,r,s,o,l,c,a){if(l===0)return!1;var d=l;if(a>e+d&&a>r+d&&a>o+d||a<e-d&&a<r-d&&a<o-d||c>n+d&&c>t+d&&c>s+d||c<n-d&&c<t-d&&c<s-d)return!1;var f=cse(n,e,t,r,s,o,c,a,null);return f<=d/2}var bq=Math.PI*2;function Gm(n){return n%=bq,n<0&&(n+=bq),n}var pA=Math.PI*2;function iIe(n,e,t,r,s,o,l,c,a){if(l===0)return!1;var d=l;c-=n,a-=e;var f=Math.sqrt(c*c+a*a);if(f-d>t||f+d<t)return!1;if(Math.abs(r-s)%pA<1e-4)return!0;if(o){var m=r;r=Gm(s),s=Gm(m)}else r=Gm(r),s=Gm(s);r>s&&(s+=pA);var _=Math.atan2(a,c);return _<0&&(_+=pA),_>=r&&_<=s||_+pA>=r&&_+pA<=s}function ny(n,e,t,r,s,o){if(o>e&&o>r||o<e&&o<r||r===e)return 0;var l=(o-e)/(r-e),c=r<e?1:-1;(l===1||l===0)&&(c=r<e?.5:-.5);var a=l*(t-n)+n;return a===s?1/0:a>s?c:0}var Cv=lg.CMD,ry=Math.PI*2,sIe=1e-4;function oIe(n,e){return Math.abs(n-e)<sIe}var Ac=[-1,-1,-1],wh=[-1,-1];function aIe(){var n=wh[0];wh[0]=wh[1],wh[1]=n}function lIe(n,e,t,r,s,o,l,c,a,d){if(d>e&&d>r&&d>o&&d>c||d<e&&d<r&&d<o&&d<c)return 0;var f=iL(e,r,o,c,d,Ac);if(f===0)return 0;for(var m=0,_=-1,x=void 0,A=void 0,I=0;I<f;I++){var E=Ac[I],C=E===0||E===1?.5:1,L=ja(n,t,s,l,E);L<a||(_<0&&(_=ose(e,r,o,c,wh),wh[1]<wh[0]&&_>1&&aIe(),x=ja(e,r,o,c,wh[0]),_>1&&(A=ja(e,r,o,c,wh[1]))),_===2?E<wh[0]?m+=x<e?C:-C:E<wh[1]?m+=A<x?C:-C:m+=c<A?C:-C:E<wh[0]?m+=x<e?C:-C:m+=c<x?C:-C)}return m}function cIe(n,e,t,r,s,o,l,c){if(c>e&&c>r&&c>o||c<e&&c<r&&c<o)return 0;var a=CEe(e,r,o,c,Ac);if(a===0)return 0;var d=lse(e,r,o);if(d>=0&&d<=1){for(var f=0,m=Wl(e,r,o,d),_=0;_<a;_++){var x=Ac[_]===0||Ac[_]===1?.5:1,A=Wl(n,t,s,Ac[_]);A<l||(Ac[_]<d?f+=m<e?x:-x:f+=o<m?x:-x)}return f}else{var x=Ac[0]===0||Ac[0]===1?.5:1,A=Wl(n,t,s,Ac[0]);return A<l?0:o<e?x:-x}}function uIe(n,e,t,r,s,o,l,c){if(c-=e,c>t||c<-t)return 0;var a=Math.sqrt(t*t-c*c);Ac[0]=-a,Ac[1]=a;var d=Math.abs(r-s);if(d<1e-4)return 0;if(d>=ry-1e-4){r=0,s=ry;var f=o?1:-1;return l>=Ac[0]+n&&l<=Ac[1]+n?f:0}if(r>s){var m=r;r=s,s=m}r<0&&(r+=ry,s+=ry);for(var _=0,x=0;x<2;x++){var A=Ac[x];if(A+n>l){var I=Math.atan2(c,A),f=o?1:-1;I<0&&(I=ry+I),(I>=r&&I<=s||I+ry>=r&&I+ry<=s)&&(I>Math.PI/2&&I<Math.PI*1.5&&(f=-f),_+=f)}}return _}function Fse(n,e,t,r,s){for(var o=n.data,l=n.len(),c=0,a=0,d=0,f=0,m=0,_,x,A=0;A<l;){var I=o[A++],E=A===1;switch(I===Cv.M&&A>1&&(t||(c+=ny(a,d,f,m,r,s))),E&&(a=o[A],d=o[A+1],f=a,m=d),I){case Cv.M:f=o[A++],m=o[A++],a=f,d=m;break;case Cv.L:if(t){if(X1(a,d,o[A],o[A+1],e,r,s))return!0}else c+=ny(a,d,o[A],o[A+1],r,s)||0;a=o[A++],d=o[A++];break;case Cv.C:if(t){if(nIe(a,d,o[A++],o[A++],o[A++],o[A++],o[A],o[A+1],e,r,s))return!0}else c+=lIe(a,d,o[A++],o[A++],o[A++],o[A++],o[A],o[A+1],r,s)||0;a=o[A++],d=o[A++];break;case Cv.Q:if(t){if(rIe(a,d,o[A++],o[A++],o[A],o[A+1],e,r,s))return!0}else c+=cIe(a,d,o[A++],o[A++],o[A],o[A+1],r,s)||0;a=o[A++],d=o[A++];break;case Cv.A:var C=o[A++],L=o[A++],O=o[A++],H=o[A++],q=o[A++],Z=o[A++];A+=1;var J=!!(1-o[A++]);_=Math.cos(q)*O+C,x=Math.sin(q)*H+L,E?(f=_,m=x):c+=ny(a,d,_,x,r,s);var re=(r-C)*H/O+C;if(t){if(iIe(C,L,H,q,q+Z,J,e,re,s))return!0}else c+=uIe(C,L,H,q,q+Z,J,re,s);a=Math.cos(q+Z)*O+C,d=Math.sin(q+Z)*H+L;break;case Cv.R:f=a=o[A++],m=d=o[A++];var se=o[A++],ae=o[A++];if(_=f+se,x=m+ae,t){if(X1(f,m,_,m,e,r,s)||X1(_,m,_,x,e,r,s)||X1(_,x,f,x,e,r,s)||X1(f,x,f,m,e,r,s))return!0}else c+=ny(_,m,_,x,r,s),c+=ny(f,x,f,m,r,s);break;case Cv.Z:if(t){if(X1(a,d,f,m,e,r,s))return!0}else c+=ny(a,d,f,m,r,s);a=f,d=m;break}}return!t&&!oIe(d,m)&&(c+=ny(a,d,f,m,r,s)||0),c!==0}function hIe(n,e,t){return Fse(n,0,!1,e,t)}function dIe(n,e,t,r){return Fse(n,e,!0,t,r)}var Nse=ri({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},ex),fIe={style:ri({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},pB.style)},T3=PM.concat(["invisible","culling","z","z2","zlevel","parent"]),Ki=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.update=function(){var t=this;n.prototype.update.call(this);var r=this.style;if(r.decal){var s=this._decalEl=this._decalEl||new e;s.buildPath===e.prototype.buildPath&&(s.buildPath=function(a){t.buildPath(a,t.shape)}),s.silent=!0;var o=s.style;for(var l in r)o[l]!==r[l]&&(o[l]=r[l]);o.fill=r.fill?r.decal:null,o.decal=null,o.shadowColor=null,r.strokeFirst&&(o.stroke=null);for(var c=0;c<T3.length;++c)s[T3[c]]=this[T3[c]];s.__dirty|=Fu}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(t){var r=lo(t);this.shape=this.getDefaultShape();var s=this.getDefaultStyle();s&&this.useStyle(s);for(var o=0;o<r.length;o++){var l=r[o],c=t[l];l==="style"?this.style?Qn(this.style,c):this.useStyle(c):l==="shape"?Qn(this.shape,c):n.prototype.attrKV.call(this,l,c)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if(t!=="none"){if(Br(t)){var r=oL(t,0);return r>.5?Hz:r>.2?qEe:jz}else if(t)return jz}return Hz},e.prototype.getInsideTextStroke=function(t){var r=this.style.fill;if(Br(r)){var s=this.__zr,o=!!(s&&s.isDarkMode()),l=oL(t,0)<Vz;if(o===l)return r}},e.prototype.buildPath=function(t,r,s){},e.prototype.pathUpdated=function(){this.__dirty&=~pb},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new lg(!1)},e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return!(r==null||r==="none"||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.getBoundingRect=function(){var t=this._rect,r=this.style,s=!t;if(s){var o=!1;this.path||(o=!0,this.createPathProxy());var l=this.path;(o||this.__dirty&pb)&&(l.beginPath(),this.buildPath(l,this.shape,!1),this.pathUpdated()),t=l.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var c=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||s){c.copy(t);var a=r.strokeNoScale?this.getLineScale():1,d=r.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;d=Math.max(d,f??4)}a>1e-10&&(c.width+=d/a,c.height+=d/a,c.x-=d/a/2,c.y-=d/a/2)}return c}return t},e.prototype.contain=function(t,r){var s=this.transformCoordToLocal(t,r),o=this.getBoundingRect(),l=this.style;if(t=s[0],r=s[1],o.contain(t,r)){var c=this.path;if(this.hasStroke()){var a=l.lineWidth,d=l.strokeNoScale?this.getLineScale():1;if(d>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),dIe(c,a/d,t,r)))return!0}if(this.hasFill())return hIe(c,t,r)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=pb,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():t==="shape"?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(t,r){t==="shape"?this.setShape(r):n.prototype.attrKV.call(this,t,r)},e.prototype.setShape=function(t,r){var s=this.shape;return s||(s=this.shape={}),typeof t=="string"?s[t]=r:Qn(s,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(this.__dirty&pb)},e.prototype.createStyle=function(t){return aB(Nse,t)},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.shape&&!r.shape&&(r.shape=Qn({},this.shape))},e.prototype._applyStateObj=function(t,r,s,o,l,c){n.prototype._applyStateObj.call(this,t,r,s,o,l,c);var a=!(r&&o),d;if(r&&r.shape?l?o?d=r.shape:(d=Qn({},s.shape),Qn(d,r.shape)):(d=Qn({},o?this.shape:s.shape),Qn(d,r.shape)):a&&(d=s.shape),d)if(l){this.shape=Qn({},this.shape);for(var f={},m=lo(d),_=0;_<m.length;_++){var x=m[_];typeof d[x]=="object"?this.shape[x]=d[x]:f[x]=d[x]}this._transitionState(t,{shape:f},c)}else this.shape=d,this.dirtyShape()},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),s,o=0;o<t.length;o++){var l=t[o];l.shape&&(s=s||{},this._mergeStyle(s,l.shape))}return s&&(r.shape=s),r},e.prototype.getAnimationStyleProps=function(){return fIe},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var r=function(o){jn(l,o);function l(c){var a=o.call(this,c)||this;return t.init&&t.init.call(a,c),a}return l.prototype.getDefaultStyle=function(){return wi(t.style)},l.prototype.getDefaultShape=function(){return wi(t.shape)},l}(e);for(var s in t)typeof t[s]=="function"&&(r.prototype[s]=t[s]);return r},e.initDefaultProps=function(){var t=e.prototype;t.type="path",t.strokeContainThreshold=5,t.segmentIgnoreThreshold=0,t.subPixelOptimize=!1,t.autoBatch=!1,t.__dirty=Fu|XA|pb}(),e}($w),pIe=ri({strokeFirst:!0,font:_x,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Nse),uL=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return r!=null&&r!=="none"&&t.lineWidth>0},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.createStyle=function(t){return aB(pIe,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t=this.style;if(!this._rect){var r=t.text;r!=null?r+="":r="";var s=LC(r,t.font,t.textAlign,t.textBaseline);if(s.x+=t.x||0,s.y+=t.y||0,this.hasStroke()){var o=t.lineWidth;s.x-=o/2,s.y-=o/2,s.width+=o,s.height+=o}this._rect=s}return this._rect},e.initDefaultProps=function(){var t=e.prototype;t.dirtyRectTolerance=10}(),e}($w);uL.prototype.type="tspan";var mIe=ri({x:0,y:0},ex),gIe={style:ri({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},pB.style)};function vIe(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var q0=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.createStyle=function(t){return aB(mIe,t)},e.prototype._getSize=function(t){var r=this.style,s=r[t];if(s!=null)return s;var o=vIe(r.image)?r.image:this.__image;if(!o)return 0;var l=t==="width"?"height":"width",c=r[l];return c==null?o[t]:o[t]/o[l]*c},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return gIe},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new ds(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}($w);q0.prototype.type="image";function _Ie(n,e){var t=e.x,r=e.y,s=e.width,o=e.height,l=e.r,c,a,d,f;s<0&&(t=t+s,s=-s),o<0&&(r=r+o,o=-o),typeof l=="number"?c=a=d=f=l:l instanceof Array?l.length===1?c=a=d=f=l[0]:l.length===2?(c=d=l[0],a=f=l[1]):l.length===3?(c=l[0],a=f=l[1],d=l[2]):(c=l[0],a=l[1],d=l[2],f=l[3]):c=a=d=f=0;var m;c+a>s&&(m=c+a,c*=s/m,a*=s/m),d+f>s&&(m=d+f,d*=s/m,f*=s/m),a+d>o&&(m=a+d,a*=o/m,d*=o/m),c+f>o&&(m=c+f,c*=o/m,f*=o/m),n.moveTo(t+c,r),n.lineTo(t+s-a,r),a!==0&&n.arc(t+s-a,r+a,a,-Math.PI/2,0),n.lineTo(t+s,r+o-d),d!==0&&n.arc(t+s-d,r+o-d,d,0,Math.PI/2),n.lineTo(t+f,r+o),f!==0&&n.arc(t+f,r+o-f,f,Math.PI/2,Math.PI),n.lineTo(t,r+c),c!==0&&n.arc(t+c,r+c,c,Math.PI,Math.PI*1.5)}var zb=Math.round;function zse(n,e,t){if(e){var r=e.x1,s=e.x2,o=e.y1,l=e.y2;n.x1=r,n.x2=s,n.y1=o,n.y2=l;var c=t&&t.lineWidth;return c&&(zb(r*2)===zb(s*2)&&(n.x1=n.x2=zy(r,c,!0)),zb(o*2)===zb(l*2)&&(n.y1=n.y2=zy(o,c,!0))),n}}function Use(n,e,t){if(e){var r=e.x,s=e.y,o=e.width,l=e.height;n.x=r,n.y=s,n.width=o,n.height=l;var c=t&&t.lineWidth;return c&&(n.x=zy(r,c,!0),n.y=zy(s,c,!0),n.width=Math.max(zy(r+o,c,!1)-n.x,o===0?0:1),n.height=Math.max(zy(s+l,c,!1)-n.y,l===0?0:1)),n}}function zy(n,e,t){if(!e)return n;var r=zb(n*2);return(r+zb(e))%2===0?r/2:(r+(t?1:-1))/2}var yIe=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),xIe={},$o=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new yIe},e.prototype.buildPath=function(t,r){var s,o,l,c;if(this.subPixelOptimize){var a=Use(xIe,r,this.style);s=a.x,o=a.y,l=a.width,c=a.height,a.r=r.r,r=a}else s=r.x,o=r.y,l=r.width,c=r.height;r.r?_Ie(t,r):t.rect(s,o,l,c)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(Ki);$o.prototype.type="rect";var wq={fill:"#000"},Sq=2,bIe={style:ri({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},pB.style)},Ra=function(n){jn(e,n);function e(t){var r=n.call(this)||this;return r.type="text",r._children=[],r._defaultStyle=wq,r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var r=this._children[t];r.zlevel=this.zlevel,r.z=this.z,r.z2=this.z2,r.culling=this.culling,r.cursor=this.cursor,r.invisible=this.invisible}},e.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):n.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(t){var r=this.innerTransformable;return r?r.getLocalTransform(t):n.prototype.getLocalTransform.call(this,t)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){this._childCursor=0,MIe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=t},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new ds(0,0,0,0),r=this._children,s=[],o=null,l=0;l<r.length;l++){var c=r[l],a=c.getBoundingRect(),d=c.getLocalTransform(s);d?(t.copy(a),t.applyTransform(d),o=o||t.clone(),o.union(t)):(o=o||a.clone(),o.union(a))}this._rect=o||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||wq},e.prototype.setTextContent=function(t){},e.prototype._mergeStyle=function(t,r){if(!r)return t;var s=r.rich,o=t.rich||s&&{};return Qn(t,r),s&&o?(this._mergeRich(o,s),t.rich=o):o&&(t.rich=o),t},e.prototype._mergeRich=function(t,r){for(var s=lo(r),o=0;o<s.length;o++){var l=s[o];t[l]=t[l]||{},Qn(t[l],r[l])}},e.prototype.getAnimationStyleProps=function(){return bIe},e.prototype._getOrCreateChild=function(t){var r=this._children[this._childCursor];return(!r||!(r instanceof t))&&(r=new t),this._children[this._childCursor++]=r,r.__zr=this.__zr,r.parent=this,r},e.prototype._updatePlainTexts=function(){var t=this.style,r=t.font||_x,s=t.padding,o=Pq(t),l=H2e(o,t),c=M3(t),a=!!t.backgroundColor,d=l.outerHeight,f=l.outerWidth,m=l.contentWidth,_=l.lines,x=l.lineHeight,A=this._defaultStyle,I=t.x||0,E=t.y||0,C=t.align||A.align||"left",L=t.verticalAlign||A.verticalAlign||"top",O=I,H=mb(E,l.contentHeight,L);if(c||s){var q=YA(I,f,C),Z=mb(E,d,L);c&&this._renderBackground(t,t,q,Z,f,d)}H+=x/2,s&&(O=Iq(I,C,s),L==="top"?H+=s[0]:L==="bottom"&&(H-=s[2]));for(var J=0,re=!1,se=Eq("fill"in t?t.fill:(re=!0,A.fill)),ae=Cq("stroke"in t?t.stroke:!a&&(!A.autoStroke||re)?(J=Sq,A.stroke):null),he=t.textShadowBlur>0,Ae=t.width!=null&&(t.overflow==="truncate"||t.overflow==="break"||t.overflow==="breakAll"),Ee=l.calculatedLineHeight,Pe=0;Pe<_.length;Pe++){var ze=this._getOrCreateChild(uL),Re=ze.createStyle();ze.useStyle(Re),Re.text=_[Pe],Re.x=O,Re.y=H,C&&(Re.textAlign=C),Re.textBaseline="middle",Re.opacity=t.opacity,Re.strokeFirst=!0,he&&(Re.shadowBlur=t.textShadowBlur||0,Re.shadowColor=t.textShadowColor||"transparent",Re.shadowOffsetX=t.textShadowOffsetX||0,Re.shadowOffsetY=t.textShadowOffsetY||0),Re.stroke=ae,Re.fill=se,ae&&(Re.lineWidth=t.lineWidth||J,Re.lineDash=t.lineDash,Re.lineDashOffset=t.lineDashOffset||0),Re.font=r,Tq(Re,t),H+=x,Ae&&ze.setBoundingRect(new ds(YA(Re.x,t.width,Re.textAlign),mb(Re.y,Ee,Re.textBaseline),m,Ee))}},e.prototype._updateRichTexts=function(){var t=this.style,r=Pq(t),s=$2e(r,t),o=s.width,l=s.outerWidth,c=s.outerHeight,a=t.padding,d=t.x||0,f=t.y||0,m=this._defaultStyle,_=t.align||m.align,x=t.verticalAlign||m.verticalAlign,A=YA(d,l,_),I=mb(f,c,x),E=A,C=I;a&&(E+=a[3],C+=a[0]);var L=E+o;M3(t)&&this._renderBackground(t,t,A,I,l,c);for(var O=!!t.backgroundColor,H=0;H<s.lines.length;H++){for(var q=s.lines[H],Z=q.tokens,J=Z.length,re=q.lineHeight,se=q.width,ae=0,he=E,Ae=L,Ee=J-1,Pe=void 0;ae<J&&(Pe=Z[ae],!Pe.align||Pe.align==="left");)this._placeToken(Pe,t,re,C,he,"left",O),se-=Pe.width,he+=Pe.width,ae++;for(;Ee>=0&&(Pe=Z[Ee],Pe.align==="right");)this._placeToken(Pe,t,re,C,Ae,"right",O),se-=Pe.width,Ae-=Pe.width,Ee--;for(he+=(o-(he-E)-(L-Ae)-se)/2;ae<=Ee;)Pe=Z[ae],this._placeToken(Pe,t,re,C,he+Pe.width/2,"center",O),he+=Pe.width,ae++;C+=re}},e.prototype._placeToken=function(t,r,s,o,l,c,a){var d=r.rich[t.styleName]||{};d.text=t.text;var f=t.verticalAlign,m=o+s/2;f==="top"?m=o+t.height/2:f==="bottom"&&(m=o+s-t.height/2);var _=!t.isLineHolder&&M3(d);_&&this._renderBackground(d,r,c==="right"?l-t.width:c==="center"?l-t.width/2:l,m-t.height/2,t.width,t.height);var x=!!d.backgroundColor,A=t.textPadding;A&&(l=Iq(l,c,A),m-=t.height/2-A[0]-t.innerHeight/2);var I=this._getOrCreateChild(uL),E=I.createStyle();I.useStyle(E);var C=this._defaultStyle,L=!1,O=0,H=Eq("fill"in d?d.fill:"fill"in r?r.fill:(L=!0,C.fill)),q=Cq("stroke"in d?d.stroke:"stroke"in r?r.stroke:!x&&!a&&(!C.autoStroke||L)?(O=Sq,C.stroke):null),Z=d.textShadowBlur>0||r.textShadowBlur>0;E.text=t.text,E.x=l,E.y=m,Z&&(E.shadowBlur=d.textShadowBlur||r.textShadowBlur||0,E.shadowColor=d.textShadowColor||r.textShadowColor||"transparent",E.shadowOffsetX=d.textShadowOffsetX||r.textShadowOffsetX||0,E.shadowOffsetY=d.textShadowOffsetY||r.textShadowOffsetY||0),E.textAlign=c,E.textBaseline="middle",E.font=t.font||_x,E.opacity=MT(d.opacity,r.opacity,1),Tq(E,d),q&&(E.lineWidth=MT(d.lineWidth,r.lineWidth,O),E.lineDash=Li(d.lineDash,r.lineDash),E.lineDashOffset=r.lineDashOffset||0,E.stroke=q),H&&(E.fill=H);var J=t.contentWidth,re=t.contentHeight;I.setBoundingRect(new ds(YA(E.x,J,E.textAlign),mb(E.y,re,E.textBaseline),J,re))},e.prototype._renderBackground=function(t,r,s,o,l,c){var a=t.backgroundColor,d=t.borderWidth,f=t.borderColor,m=a&&a.image,_=a&&!m,x=t.borderRadius,A=this,I,E;if(_||t.lineHeight||d&&f){I=this._getOrCreateChild($o),I.useStyle(I.createStyle()),I.style.fill=null;var C=I.shape;C.x=s,C.y=o,C.width=l,C.height=c,C.r=x,I.dirtyShape()}if(_){var L=I.style;L.fill=a||null,L.fillOpacity=Li(t.fillOpacity,1)}else if(m){E=this._getOrCreateChild(q0),E.onload=function(){A.dirtyStyle()};var O=E.style;O.image=a.image,O.x=s,O.y=o,O.width=l,O.height=c}if(d&&f){var L=I.style;L.lineWidth=d,L.stroke=f,L.strokeOpacity=Li(t.strokeOpacity,1),L.lineDash=t.borderDash,L.lineDashOffset=t.borderDashOffset||0,I.strokeContainThreshold=0,I.hasFill()&&I.hasStroke()&&(L.strokeFirst=!0,L.lineWidth*=2)}var H=(I||E).style;H.shadowBlur=t.shadowBlur||0,H.shadowColor=t.shadowColor||"transparent",H.shadowOffsetX=t.shadowOffsetX||0,H.shadowOffsetY=t.shadowOffsetY||0,H.opacity=MT(t.opacity,r.opacity,1)},e.makeFont=function(t){var r="";return TIe(t)&&(r=[t.fontStyle,t.fontWeight,AIe(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),r&&cp(r)||t.textFont||t.font},e}($w),wIe={left:!0,right:1,center:1},SIe={top:1,bottom:1,middle:1},Aq=["fontStyle","fontWeight","fontSize","fontFamily"];function AIe(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?uG+"px":n+"px"}function Tq(n,e){for(var t=0;t<Aq.length;t++){var r=Aq[t],s=e[r];s!=null&&(n[r]=s)}}function TIe(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function MIe(n){return Mq(n),ot(n.rich,Mq),n}function Mq(n){if(n){n.font=Ra.makeFont(n);var e=n.align;e==="middle"&&(e="center"),n.align=e==null||wIe[e]?e:"left";var t=n.verticalAlign;t==="center"&&(t="middle"),n.verticalAlign=t==null||SIe[t]?t:"top";var r=n.padding;r&&(n.padding=qie(n.padding))}}function Cq(n,e){return n==null||e<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function Eq(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function Iq(n,e,t){return e==="right"?n-t[1]:e==="center"?n+t[3]/2-t[1]/2:n+t[3]}function Pq(n){var e=n.text;return e!=null&&(e+=""),e}function M3(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}var Yi=Zs(),CIe=function(n,e,t,r){if(r){var s=Yi(r);s.dataIndex=t,s.dataType=e,s.seriesIndex=n,s.ssrType="chart",r.type==="group"&&r.traverse(function(o){var l=Yi(o);l.seriesIndex=n,l.dataIndex=t,l.dataType=e,l.ssrType="chart"})}},Rq=1,Lq={},Gse=Zs(),SG=Zs(),AG=0,mB=1,gB=2,Vh=["emphasis","blur","select"],hL=["normal","emphasis","blur","select"],EIe=10,IIe=9,tx="highlight",CP="downplay",LT="select",EP="unselect",DT="toggleSelect";function q1(n){return n!=null&&n!=="none"}function vB(n,e,t){n.onHoverStateChange&&(n.hoverState||0)!==t&&n.onHoverStateChange(e),n.hoverState=t}function Vse(n){vB(n,"emphasis",gB)}function Hse(n){n.hoverState===gB&&vB(n,"normal",AG)}function TG(n){vB(n,"blur",mB)}function jse(n){n.hoverState===mB&&vB(n,"normal",AG)}function PIe(n){n.selected=!0}function RIe(n){n.selected=!1}function Dq(n,e,t){e(n,t)}function pg(n,e,t){Dq(n,e,t),n.isGroup&&n.traverse(function(r){Dq(r,e,t)})}function Bq(n,e){switch(e){case"emphasis":n.hoverState=gB;break;case"normal":n.hoverState=AG;break;case"blur":n.hoverState=mB;break;case"select":n.selected=!0}}function LIe(n,e,t,r){for(var s=n.style,o={},l=0;l<e.length;l++){var c=e[l],a=s[c];o[c]=a??(r&&r[c])}for(var l=0;l<n.animators.length;l++){var d=n.animators[l];d.__fromStateTransition&&d.__fromStateTransition.indexOf(t)<0&&d.targetName==="style"&&d.saveTo(o,e)}return o}function DIe(n,e,t,r){var s=t&&Zi(t,"select")>=0,o=!1;if(n instanceof Ki){var l=Gse(n),c=s&&l.selectFill||l.normalFill,a=s&&l.selectStroke||l.normalStroke;if(q1(c)||q1(a)){r=r||{};var d=r.style||{};d.fill==="inherit"?(o=!0,r=Qn({},r),d=Qn({},d),d.fill=c):!q1(d.fill)&&q1(c)?(o=!0,r=Qn({},r),d=Qn({},d),d.fill=QX(c)):!q1(d.stroke)&&q1(a)&&(o||(r=Qn({},r),d=Qn({},d)),d.stroke=QX(a)),r.style=d}}if(r&&r.z2==null){o||(r=Qn({},r));var f=n.z2EmphasisLift;r.z2=n.z2+(f??EIe)}return r}function BIe(n,e,t){if(t&&t.z2==null){t=Qn({},t);var r=n.z2SelectLift;t.z2=n.z2+(r??IIe)}return t}function kIe(n,e,t){var r=Zi(n.currentStates,e)>=0,s=n.style.opacity,o=r?null:LIe(n,["opacity"],e,{opacity:1});t=t||{};var l=t.style||{};return l.opacity==null&&(t=Qn({},t),l=Qn({opacity:r?s:o.opacity*.1},l),t.style=l),t}function C3(n,e){var t=this.states[n];if(this.style){if(n==="emphasis")return DIe(this,n,e,t);if(n==="blur")return kIe(this,n,t);if(n==="select")return BIe(this,n,t)}return t}function OIe(n){n.stateProxy=C3;var e=n.getTextContent(),t=n.getTextGuideLine();e&&(e.stateProxy=C3),t&&(t.stateProxy=C3)}function kq(n,e){!qse(n,e)&&!n.__highByOuter&&pg(n,Vse)}function Oq(n,e){!qse(n,e)&&!n.__highByOuter&&pg(n,Hse)}function ww(n,e){n.__highByOuter|=1<<(e||0),pg(n,Vse)}function Sw(n,e){!(n.__highByOuter&=~(1<<(e||0)))&&pg(n,Hse)}function FIe(n){pg(n,TG)}function Wse(n){pg(n,jse)}function $se(n){pg(n,PIe)}function Xse(n){pg(n,RIe)}function qse(n,e){return n.__highDownSilentOnTouch&&e.zrByTouch}function Yse(n){var e=n.getModel(),t=[],r=[];e.eachComponent(function(s,o){var l=SG(o),c=s==="series",a=c?n.getViewOfSeriesModel(o):n.getViewOfComponentModel(o);!c&&r.push(a),l.isBlured&&(a.group.traverse(function(d){jse(d)}),c&&t.push(o)),l.isBlured=!1}),ot(r,function(s){s&&s.toggleBlurSeries&&s.toggleBlurSeries(t,!1,e)})}function Yz(n,e,t,r){var s=r.getModel();t=t||"coordinateSystem";function o(d,f){for(var m=0;m<f.length;m++){var _=d.getItemGraphicEl(f[m]);_&&Wse(_)}}if(n!=null&&!(!e||e==="none")){var l=s.getSeriesByIndex(n),c=l.coordinateSystem;c&&c.master&&(c=c.master);var a=[];s.eachSeries(function(d){var f=l===d,m=d.coordinateSystem;m&&m.master&&(m=m.master);var _=m&&c?m===c:f;if(!(t==="series"&&!f||t==="coordinateSystem"&&!_||e==="series"&&f)){var x=r.getViewOfSeriesModel(d);if(x.group.traverse(function(E){E.__highByOuter&&f&&e==="self"||TG(E)}),Dc(e))o(d.getData(),e);else if(qr(e))for(var A=lo(e),I=0;I<A.length;I++)o(d.getData(A[I]),e[A[I]]);a.push(d),SG(d).isBlured=!0}}),s.eachComponent(function(d,f){if(d!=="series"){var m=r.getViewOfComponentModel(f);m&&m.toggleBlurSeries&&m.toggleBlurSeries(a,!0,s)}})}}function Zz(n,e,t){if(!(n==null||e==null)){var r=t.getModel().getComponent(n,e);if(r){SG(r).isBlured=!0;var s=t.getViewOfComponentModel(r);!s||!s.focusBlurEnabled||s.group.traverse(function(o){TG(o)})}}}function NIe(n,e,t){var r=n.seriesIndex,s=n.getData(e.dataType);if(s){var o=yx(s,e);o=(fr(o)?o[0]:o)||0;var l=s.getItemGraphicEl(o);if(!l)for(var c=s.count(),a=0;!l&&a<c;)l=s.getItemGraphicEl(a++);if(l){var d=Yi(l);Yz(r,d.focus,d.blurScope,t)}else{var f=n.get(["emphasis","focus"]),m=n.get(["emphasis","blurScope"]);f!=null&&Yz(r,f,m,t)}}}function MG(n,e,t,r){var s={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||e==null||t==null)return s;var o=r.getModel().getComponent(n,e);if(!o)return s;var l=r.getViewOfComponentModel(o);if(!l||!l.findHighDownDispatchers)return s;for(var c=l.findHighDownDispatchers(t),a,d=0;d<c.length;d++)if(Yi(c[d]).focus==="self"){a=!0;break}return{focusSelf:a,dispatchers:c}}function zIe(n,e,t){var r=Yi(n),s=MG(r.componentMainType,r.componentIndex,r.componentHighDownName,t),o=s.dispatchers,l=s.focusSelf;o?(l&&Zz(r.componentMainType,r.componentIndex,t),ot(o,function(c){return kq(c,e)})):(Yz(r.seriesIndex,r.focus,r.blurScope,t),r.focus==="self"&&Zz(r.componentMainType,r.componentIndex,t),kq(n,e))}function UIe(n,e,t){Yse(t);var r=Yi(n),s=MG(r.componentMainType,r.componentIndex,r.componentHighDownName,t).dispatchers;s?ot(s,function(o){return Oq(o,e)}):Oq(n,e)}function GIe(n,e,t){if(Qz(e)){var r=e.dataType,s=n.getData(r),o=yx(s,e);fr(o)||(o=[o]),n[e.type===DT?"toggleSelect":e.type===LT?"select":"unselect"](o,r)}}function Fq(n){var e=n.getAllData();ot(e,function(t){var r=t.data,s=t.type;r.eachItemGraphicEl(function(o,l){n.isSelected(l,s)?$se(o):Xse(o)})})}function VIe(n){var e=[];return n.eachSeries(function(t){var r=t.getAllData();ot(r,function(s){s.data;var o=s.type,l=t.getSelectedDataIndices();if(l.length>0){var c={dataIndex:l,seriesIndex:t.seriesIndex};o!=null&&(c.dataType=o),e.push(c)}})}),e}function Kz(n,e,t){Zse(n,!0),pg(n,OIe),jIe(n,e,t)}function HIe(n){Zse(n,!1)}function DM(n,e,t,r){r?HIe(n):Kz(n,e,t)}function jIe(n,e,t){var r=Yi(n);e!=null?(r.focus=e,r.blurScope=t):r.focus&&(r.focus=null)}var Nq=["emphasis","blur","select"],WIe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function dL(n,e,t,r){t=t||"itemStyle";for(var s=0;s<Nq.length;s++){var o=Nq[s],l=e.getModel([o,t]),c=n.ensureState(o);c.style=l[WIe[t]]()}}function Zse(n,e){var t=e===!1,r=n;n.highDownSilentOnTouch&&(r.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!t||r.__highDownDispatcher)&&(r.__highByOuter=r.__highByOuter||0,r.__highDownDispatcher=!t)}function Jz(n){return!!(n&&n.__highDownDispatcher)}function $Ie(n){var e=Lq[n];return e==null&&Rq<=32&&(e=Lq[n]=Rq++),e}function Qz(n){var e=n.type;return e===LT||e===EP||e===DT}function zq(n){var e=n.type;return e===tx||e===CP}function XIe(n){var e=Gse(n);e.normalFill=n.style.fill,e.normalStroke=n.style.stroke;var t=n.states.select||{};e.selectFill=t.style&&t.style.fill||null,e.selectStroke=t.style&&t.style.stroke||null}var Y1=lg.CMD,qIe=[[],[],[]],Uq=Math.sqrt,YIe=Math.atan2;function Kse(n,e){if(e){var t=n.data,r=n.len(),s,o,l,c,a,d,f=Y1.M,m=Y1.C,_=Y1.L,x=Y1.R,A=Y1.A,I=Y1.Q;for(l=0,c=0;l<r;){switch(s=t[l++],c=l,o=0,s){case f:o=1;break;case _:o=1;break;case m:o=3;break;case I:o=2;break;case A:var E=e[4],C=e[5],L=Uq(e[0]*e[0]+e[1]*e[1]),O=Uq(e[2]*e[2]+e[3]*e[3]),H=YIe(-e[1]/O,e[0]/L);t[l]*=L,t[l++]+=E,t[l]*=O,t[l++]+=C,t[l++]*=L,t[l++]*=O,t[l++]+=H,t[l++]+=H,l+=2,c=l;break;case x:d[0]=t[l++],d[1]=t[l++],kh(d,d,e),t[c++]=d[0],t[c++]=d[1],d[0]+=t[l++],d[1]+=t[l++],kh(d,d,e),t[c++]=d[0],t[c++]=d[1]}for(a=0;a<o;a++){var q=qIe[a];q[0]=t[l++],q[1]=t[l++],kh(q,q,e),t[c++]=q[0],t[c++]=q[1]}}n.increaseVersion()}}var E3=Math.sqrt,dI=Math.sin,fI=Math.cos,mA=Math.PI;function Gq(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function e5(n,e){return(n[0]*e[0]+n[1]*e[1])/(Gq(n)*Gq(e))}function Vq(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(e5(n,e))}function Hq(n,e,t,r,s,o,l,c,a,d,f){var m=a*(mA/180),_=fI(m)*(n-t)/2+dI(m)*(e-r)/2,x=-1*dI(m)*(n-t)/2+fI(m)*(e-r)/2,A=_*_/(l*l)+x*x/(c*c);A>1&&(l*=E3(A),c*=E3(A));var I=(s===o?-1:1)*E3((l*l*(c*c)-l*l*(x*x)-c*c*(_*_))/(l*l*(x*x)+c*c*(_*_)))||0,E=I*l*x/c,C=I*-c*_/l,L=(n+t)/2+fI(m)*E-dI(m)*C,O=(e+r)/2+dI(m)*E+fI(m)*C,H=Vq([1,0],[(_-E)/l,(x-C)/c]),q=[(_-E)/l,(x-C)/c],Z=[(-1*_-E)/l,(-1*x-C)/c],J=Vq(q,Z);if(e5(q,Z)<=-1&&(J=mA),e5(q,Z)>=1&&(J=0),J<0){var re=Math.round(J/mA*1e6)/1e6;J=mA*2+re%2*mA}f.addData(d,L,O,l,c,H,J,m,o)}var ZIe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,KIe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function JIe(n){var e=new lg;if(!n)return e;var t=0,r=0,s=t,o=r,l,c=lg.CMD,a=n.match(ZIe);if(!a)return e;for(var d=0;d<a.length;d++){for(var f=a[d],m=f.charAt(0),_=void 0,x=f.match(KIe)||[],A=x.length,I=0;I<A;I++)x[I]=parseFloat(x[I]);for(var E=0;E<A;){var C=void 0,L=void 0,O=void 0,H=void 0,q=void 0,Z=void 0,J=void 0,re=t,se=r,ae=void 0,he=void 0;switch(m){case"l":t+=x[E++],r+=x[E++],_=c.L,e.addData(_,t,r);break;case"L":t=x[E++],r=x[E++],_=c.L,e.addData(_,t,r);break;case"m":t+=x[E++],r+=x[E++],_=c.M,e.addData(_,t,r),s=t,o=r,m="l";break;case"M":t=x[E++],r=x[E++],_=c.M,e.addData(_,t,r),s=t,o=r,m="L";break;case"h":t+=x[E++],_=c.L,e.addData(_,t,r);break;case"H":t=x[E++],_=c.L,e.addData(_,t,r);break;case"v":r+=x[E++],_=c.L,e.addData(_,t,r);break;case"V":r=x[E++],_=c.L,e.addData(_,t,r);break;case"C":_=c.C,e.addData(_,x[E++],x[E++],x[E++],x[E++],x[E++],x[E++]),t=x[E-2],r=x[E-1];break;case"c":_=c.C,e.addData(_,x[E++]+t,x[E++]+r,x[E++]+t,x[E++]+r,x[E++]+t,x[E++]+r),t+=x[E-2],r+=x[E-1];break;case"S":C=t,L=r,ae=e.len(),he=e.data,l===c.C&&(C+=t-he[ae-4],L+=r-he[ae-3]),_=c.C,re=x[E++],se=x[E++],t=x[E++],r=x[E++],e.addData(_,C,L,re,se,t,r);break;case"s":C=t,L=r,ae=e.len(),he=e.data,l===c.C&&(C+=t-he[ae-4],L+=r-he[ae-3]),_=c.C,re=t+x[E++],se=r+x[E++],t+=x[E++],r+=x[E++],e.addData(_,C,L,re,se,t,r);break;case"Q":re=x[E++],se=x[E++],t=x[E++],r=x[E++],_=c.Q,e.addData(_,re,se,t,r);break;case"q":re=x[E++]+t,se=x[E++]+r,t+=x[E++],r+=x[E++],_=c.Q,e.addData(_,re,se,t,r);break;case"T":C=t,L=r,ae=e.len(),he=e.data,l===c.Q&&(C+=t-he[ae-4],L+=r-he[ae-3]),t=x[E++],r=x[E++],_=c.Q,e.addData(_,C,L,t,r);break;case"t":C=t,L=r,ae=e.len(),he=e.data,l===c.Q&&(C+=t-he[ae-4],L+=r-he[ae-3]),t+=x[E++],r+=x[E++],_=c.Q,e.addData(_,C,L,t,r);break;case"A":O=x[E++],H=x[E++],q=x[E++],Z=x[E++],J=x[E++],re=t,se=r,t=x[E++],r=x[E++],_=c.A,Hq(re,se,t,r,Z,J,O,H,q,_,e);break;case"a":O=x[E++],H=x[E++],q=x[E++],Z=x[E++],J=x[E++],re=t,se=r,t+=x[E++],r+=x[E++],_=c.A,Hq(re,se,t,r,Z,J,O,H,q,_,e);break}}(m==="z"||m==="Z")&&(_=c.Z,e.addData(_),t=s,r=o),l=_}return e.toStatic(),e}var Jse=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.applyTransform=function(t){},e}(Ki);function Qse(n){return n.setData!=null}function eoe(n,e){var t=JIe(n),r=Qn({},e);return r.buildPath=function(s){if(Qse(s)){s.setData(t.data);var o=s.getContext();o&&s.rebuildPath(o,1)}else{var o=s;t.rebuildPath(o,1)}},r.applyTransform=function(s){Kse(t,s),this.dirtyShape()},r}function QIe(n,e){return new Jse(eoe(n,e))}function ePe(n,e){var t=eoe(n,e),r=function(s){jn(o,s);function o(l){var c=s.call(this,l)||this;return c.applyTransform=t.applyTransform,c.buildPath=t.buildPath,c}return o}(Jse);return r}function tPe(n,e){for(var t=[],r=n.length,s=0;s<r;s++){var o=n[s];t.push(o.getUpdatedPathProxy(!0))}var l=new Ki(e);return l.createPathProxy(),l.buildPath=function(c){if(Qse(c)){c.appendPath(t);var a=c.getContext();a&&c.rebuildPath(a,1)}},l}function CG(n,e){e=e||{};var t=new Ki;return n.shape&&t.setShape(n.shape),t.setStyle(n.style),e.bakeTransform?Kse(t.path,n.getComputedTransform()):e.toLocal?t.setLocalTransform(n.getComputedTransform()):t.copyTransform(n),t.buildPath=n.buildPath,t.applyTransform=t.applyTransform,t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel,t}var nPe=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),toe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new nPe},e.prototype.buildPath=function(t,r){t.moveTo(r.cx+r.r,r.cy),t.arc(r.cx,r.cy,r.r,0,Math.PI*2)},e}(Ki);toe.prototype.type="circle";const _B=toe;var rPe=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),noe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new rPe},e.prototype.buildPath=function(t,r){var s=.5522848,o=r.cx,l=r.cy,c=r.rx,a=r.ry,d=c*s,f=a*s;t.moveTo(o-c,l),t.bezierCurveTo(o-c,l-f,o-d,l-a,o,l-a),t.bezierCurveTo(o+d,l-a,o+c,l-f,o+c,l),t.bezierCurveTo(o+c,l+f,o+d,l+a,o,l+a),t.bezierCurveTo(o-d,l+a,o-c,l+f,o-c,l),t.closePath()},e}(Ki);noe.prototype.type="ellipse";const roe=noe;var ioe=Math.PI,I3=ioe*2,iy=Math.sin,Z1=Math.cos,iPe=Math.acos,Vl=Math.atan2,jq=Math.abs,BT=Math.sqrt,ZA=Math.max,ep=Math.min,Fd=1e-4;function sPe(n,e,t,r,s,o,l,c){var a=t-n,d=r-e,f=l-s,m=c-o,_=m*a-f*d;if(!(_*_<Fd))return _=(f*(e-o)-m*(n-s))/_,[n+_*a,e+_*d]}function pI(n,e,t,r,s,o,l){var c=n-t,a=e-r,d=(l?o:-o)/BT(c*c+a*a),f=d*a,m=-d*c,_=n+f,x=e+m,A=t+f,I=r+m,E=(_+A)/2,C=(x+I)/2,L=A-_,O=I-x,H=L*L+O*O,q=s-o,Z=_*I-A*x,J=(O<0?-1:1)*BT(ZA(0,q*q*H-Z*Z)),re=(Z*O-L*J)/H,se=(-Z*L-O*J)/H,ae=(Z*O+L*J)/H,he=(-Z*L+O*J)/H,Ae=re-E,Ee=se-C,Pe=ae-E,ze=he-C;return Ae*Ae+Ee*Ee>Pe*Pe+ze*ze&&(re=ae,se=he),{cx:re,cy:se,x0:-f,y0:-m,x1:re*(s/q-1),y1:se*(s/q-1)}}function oPe(n){var e;if(fr(n)){var t=n.length;if(!t)return n;t===1?e=[n[0],n[0],0,0]:t===2?e=[n[0],n[0],n[1],n[1]]:t===3?e=n.concat(n[2]):e=n}else e=[n,n,n,n];return e}function aPe(n,e){var t,r=ZA(e.r,0),s=ZA(e.r0||0,0),o=r>0,l=s>0;if(!(!o&&!l)){if(o||(r=s,s=0),s>r){var c=r;r=s,s=c}var a=e.startAngle,d=e.endAngle;if(!(isNaN(a)||isNaN(d))){var f=e.cx,m=e.cy,_=!!e.clockwise,x=jq(d-a),A=x>I3&&x%I3;if(A>Fd&&(x=A),!(r>Fd))n.moveTo(f,m);else if(x>I3-Fd)n.moveTo(f+r*Z1(a),m+r*iy(a)),n.arc(f,m,r,a,d,!_),s>Fd&&(n.moveTo(f+s*Z1(d),m+s*iy(d)),n.arc(f,m,s,d,a,_));else{var I=void 0,E=void 0,C=void 0,L=void 0,O=void 0,H=void 0,q=void 0,Z=void 0,J=void 0,re=void 0,se=void 0,ae=void 0,he=void 0,Ae=void 0,Ee=void 0,Pe=void 0,ze=r*Z1(a),Re=r*iy(a),rt=s*Z1(d),ye=s*iy(d),We=x>Fd;if(We){var Ue=e.cornerRadius;Ue&&(t=oPe(Ue),I=t[0],E=t[1],C=t[2],L=t[3]);var gt=jq(r-s)/2;if(O=ep(gt,C),H=ep(gt,L),q=ep(gt,I),Z=ep(gt,E),se=J=ZA(O,H),ae=re=ZA(q,Z),(J>Fd||re>Fd)&&(he=r*Z1(d),Ae=r*iy(d),Ee=s*Z1(a),Pe=s*iy(a),x<ioe)){var vt=sPe(ze,Re,Ee,Pe,he,Ae,rt,ye);if(vt){var Dt=ze-vt[0],lt=Re-vt[1],jt=he-vt[0],Qt=Ae-vt[1],nn=1/iy(iPe((Dt*jt+lt*Qt)/(BT(Dt*Dt+lt*lt)*BT(jt*jt+Qt*Qt)))/2),Wn=BT(vt[0]*vt[0]+vt[1]*vt[1]);se=ep(J,(r-Wn)/(nn+1)),ae=ep(re,(s-Wn)/(nn-1))}}}if(!We)n.moveTo(f+ze,m+Re);else if(se>Fd){var kn=ep(C,se),Mn=ep(L,se),De=pI(Ee,Pe,ze,Re,r,kn,_),Ye=pI(he,Ae,rt,ye,r,Mn,_);n.moveTo(f+De.cx+De.x0,m+De.cy+De.y0),se<J&&kn===Mn?n.arc(f+De.cx,m+De.cy,se,Vl(De.y0,De.x0),Vl(Ye.y0,Ye.x0),!_):(kn>0&&n.arc(f+De.cx,m+De.cy,kn,Vl(De.y0,De.x0),Vl(De.y1,De.x1),!_),n.arc(f,m,r,Vl(De.cy+De.y1,De.cx+De.x1),Vl(Ye.cy+Ye.y1,Ye.cx+Ye.x1),!_),Mn>0&&n.arc(f+Ye.cx,m+Ye.cy,Mn,Vl(Ye.y1,Ye.x1),Vl(Ye.y0,Ye.x0),!_))}else n.moveTo(f+ze,m+Re),n.arc(f,m,r,a,d,!_);if(!(s>Fd)||!We)n.lineTo(f+rt,m+ye);else if(ae>Fd){var kn=ep(I,ae),Mn=ep(E,ae),De=pI(rt,ye,he,Ae,s,-Mn,_),Ye=pI(ze,Re,Ee,Pe,s,-kn,_);n.lineTo(f+De.cx+De.x0,m+De.cy+De.y0),ae<re&&kn===Mn?n.arc(f+De.cx,m+De.cy,ae,Vl(De.y0,De.x0),Vl(Ye.y0,Ye.x0),!_):(Mn>0&&n.arc(f+De.cx,m+De.cy,Mn,Vl(De.y0,De.x0),Vl(De.y1,De.x1),!_),n.arc(f,m,s,Vl(De.cy+De.y1,De.cx+De.x1),Vl(Ye.cy+Ye.y1,Ye.cx+Ye.x1),_),kn>0&&n.arc(f+Ye.cx,m+Ye.cy,kn,Vl(Ye.y1,Ye.x1),Vl(Ye.y0,Ye.x0),!_))}else n.lineTo(f+rt,m+ye),n.arc(f,m,s,d,a,_)}n.closePath()}}}var lPe=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),Hh=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new lPe},e.prototype.buildPath=function(t,r){aPe(t,r)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(Ki);Hh.prototype.type="sector";var cPe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),soe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new cPe},e.prototype.buildPath=function(t,r){var s=r.cx,o=r.cy,l=Math.PI*2;t.moveTo(s+r.r,o),t.arc(s,o,r.r,0,l,!1),t.moveTo(s+r.r0,o),t.arc(s,o,r.r0,0,l,!0)},e}(Ki);soe.prototype.type="ring";const EG=soe;function uPe(n,e,t,r){var s=[],o=[],l=[],c=[],a,d,f,m;if(r){f=[1/0,1/0],m=[-1/0,-1/0];for(var _=0,x=n.length;_<x;_++)Ob(f,f,n[_]),Fb(m,m,n[_]);Ob(f,f,r[0]),Fb(m,m,r[1])}for(var _=0,x=n.length;_<x;_++){var A=n[_];if(t)a=n[_?_-1:x-1],d=n[(_+1)%x];else if(_===0||_===x-1){s.push(YCe(n[_]));continue}else a=n[_-1],d=n[_+1];ZCe(o,d,a),qF(o,o,e);var I=Iz(A,a),E=Iz(A,d),C=I+E;C!==0&&(I/=C,E/=C),qF(l,o,-I),qF(c,o,E);var L=OX([],A,l),O=OX([],A,c);r&&(Fb(L,L,f),Ob(L,L,m),Fb(O,O,f),Ob(O,O,m)),s.push(L),s.push(O)}return t&&s.push(s.shift()),s}function ooe(n,e,t){var r=e.smooth,s=e.points;if(s&&s.length>=2){if(r){var o=uPe(s,r,t,e.smoothConstraint);n.moveTo(s[0][0],s[0][1]);for(var l=s.length,c=0;c<(t?l:l-1);c++){var a=o[c*2],d=o[c*2+1],f=s[(c+1)%l];n.bezierCurveTo(a[0],a[1],d[0],d[1],f[0],f[1])}}else{n.moveTo(s[0][0],s[0][1]);for(var c=1,m=s.length;c<m;c++)n.lineTo(s[c][0],s[c][1])}t&&n.closePath()}}var hPe=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),aoe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new hPe},e.prototype.buildPath=function(t,r){ooe(t,r,!0)},e}(Ki);aoe.prototype.type="polygon";const yB=aoe;var dPe=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),Xw=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new dPe},e.prototype.buildPath=function(t,r){ooe(t,r,!1)},e}(Ki);Xw.prototype.type="polyline";var fPe={},pPe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),loe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new pPe},e.prototype.buildPath=function(t,r){var s,o,l,c;if(this.subPixelOptimize){var a=zse(fPe,r,this.style);s=a.x1,o=a.y1,l=a.x2,c=a.y2}else s=r.x1,o=r.y1,l=r.x2,c=r.y2;var d=r.percent;d!==0&&(t.moveTo(s,o),d<1&&(l=s*(1-d)+l*d,c=o*(1-d)+c*d),t.lineTo(l,c))},e.prototype.pointAt=function(t){var r=this.shape;return[r.x1*(1-t)+r.x2*t,r.y1*(1-t)+r.y2*t]},e}(Ki);loe.prototype.type="line";const qd=loe;var eu=[],mPe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function Wq(n,e,t){var r=n.cpx2,s=n.cpy2;return r!=null||s!=null?[(t?XX:ja)(n.x1,n.cpx1,n.cpx2,n.x2,e),(t?XX:ja)(n.y1,n.cpy1,n.cpy2,n.y2,e)]:[(t?qX:Wl)(n.x1,n.cpx1,n.x2,e),(t?qX:Wl)(n.y1,n.cpy1,n.y2,e)]}var coe=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new mPe},e.prototype.buildPath=function(t,r){var s=r.x1,o=r.y1,l=r.x2,c=r.y2,a=r.cpx1,d=r.cpy1,f=r.cpx2,m=r.cpy2,_=r.percent;_!==0&&(t.moveTo(s,o),f==null||m==null?(_<1&&(sL(s,a,l,_,eu),a=eu[1],l=eu[2],sL(o,d,c,_,eu),d=eu[1],c=eu[2]),t.quadraticCurveTo(a,d,l,c)):(_<1&&(M0(s,a,f,l,_,eu),a=eu[1],f=eu[2],l=eu[3],M0(o,d,m,c,_,eu),d=eu[1],m=eu[2],c=eu[3]),t.bezierCurveTo(a,d,f,m,l,c)))},e.prototype.pointAt=function(t){return Wq(this.shape,t,!1)},e.prototype.tangentAt=function(t){var r=Wq(this.shape,t,!0);return QCe(r,r)},e}(Ki);coe.prototype.type="bezier-curve";const uoe=coe;var gPe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),xB=function(n){jn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new gPe},e.prototype.buildPath=function(t,r){var s=r.cx,o=r.cy,l=Math.max(r.r,0),c=r.startAngle,a=r.endAngle,d=r.clockwise,f=Math.cos(c),m=Math.sin(c);t.moveTo(f*l+s,m*l+o),t.arc(s,o,l,c,a,!d)},e}(Ki);xB.prototype.type="arc";var vPe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="compound",t}return e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,r=this.shapeChanged(),s=0;s<t.length;s++)r=r||t[s].shapeChanged();r&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],r=this.getGlobalScale(),s=0;s<t.length;s++)t[s].path||t[s].createPathProxy(),t[s].path.setScale(r[0],r[1],t[s].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,r){for(var s=r.paths||[],o=0;o<s.length;o++)s[o].buildPath(t,s[o].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],r=0;r<t.length;r++)t[r].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Ki.prototype.getBoundingRect.call(this)},e}(Ki);const _Pe=vPe;var hoe=function(){function n(e){this.colorStops=e||[]}return n.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},n}(),yPe=function(n){jn(e,n);function e(t,r,s,o,l,c){var a=n.call(this,l)||this;return a.x=t??0,a.y=r??0,a.x2=s??1,a.y2=o??0,a.type="linear",a.global=c||!1,a}return e}(hoe);const doe=yPe;var xPe=function(n){jn(e,n);function e(t,r,s,o,l){var c=n.call(this,o)||this;return c.x=t??.5,c.y=r??.5,c.r=s??.5,c.type="radial",c.global=l||!1,c}return e}(hoe);const bPe=xPe;var sy=[0,0],oy=[0,0],mI=new ei,gI=new ei,wPe=function(){function n(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var r=0;r<4;r++)this._corners[r]=new ei;for(var r=0;r<2;r++)this._axes[r]=new ei;e&&this.fromBoundingRect(e,t)}return n.prototype.fromBoundingRect=function(e,t){var r=this._corners,s=this._axes,o=e.x,l=e.y,c=o+e.width,a=l+e.height;if(r[0].set(o,l),r[1].set(c,l),r[2].set(c,a),r[3].set(o,a),t)for(var d=0;d<4;d++)r[d].transform(t);ei.sub(s[0],r[1],r[0]),ei.sub(s[1],r[3],r[0]),s[0].normalize(),s[1].normalize();for(var d=0;d<2;d++)this._origin[d]=s[d].dot(r[0])},n.prototype.intersect=function(e,t){var r=!0,s=!t;return mI.set(1/0,1/0),gI.set(0,0),!this._intersectCheckOneSide(this,e,mI,gI,s,1)&&(r=!1,s)||!this._intersectCheckOneSide(e,this,mI,gI,s,-1)&&(r=!1,s)||s||ei.copy(t,r?mI:gI),r},n.prototype._intersectCheckOneSide=function(e,t,r,s,o,l){for(var c=!0,a=0;a<2;a++){var d=this._axes[a];if(this._getProjMinMaxOnAxis(a,e._corners,sy),this._getProjMinMaxOnAxis(a,t._corners,oy),sy[1]<oy[0]||sy[0]>oy[1]){if(c=!1,o)return c;var f=Math.abs(oy[0]-sy[1]),m=Math.abs(sy[0]-oy[1]);Math.min(f,m)>s.len()&&(f<m?ei.scale(s,d,-f*l):ei.scale(s,d,m*l))}else if(r){var f=Math.abs(oy[0]-sy[1]),m=Math.abs(sy[0]-oy[1]);Math.min(f,m)<r.len()&&(f<m?ei.scale(r,d,f*l):ei.scale(r,d,-m*l))}}return c},n.prototype._getProjMinMaxOnAxis=function(e,t,r){for(var s=this._axes[e],o=this._origin,l=t[0].dot(s)+o[e],c=l,a=l,d=1;d<t.length;d++){var f=t[d].dot(s)+o[e];c=Math.min(f,c),a=Math.max(f,a)}r[0]=c,r[1]=a},n}();const fL=wPe;var SPe=[],APe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,r){r?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,r){r=r||!1;for(var s=0;s<t.length;s++)this.addDisplayable(t[s],r)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var r=this._cursor;r<this._displayables.length;r++)t&&t(this._displayables[r]);for(var r=0;r<this._temporaryDisplayables.length;r++)t&&t(this._temporaryDisplayables[r])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){var r=this._displayables[t];r.parent=this,r.update(),r.parent=null}for(var t=0;t<this._temporaryDisplayables.length;t++){var r=this._temporaryDisplayables[t];r.parent=this,r.update(),r.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new ds(1/0,1/0,-1/0,-1/0),r=0;r<this._displayables.length;r++){var s=this._displayables[r],o=s.getBoundingRect().clone();s.needLocalTransform()&&o.applyTransform(s.getLocalTransform(SPe)),t.union(o)}this._rect=t}return this._rect},e.prototype.contain=function(t,r){var s=this.transformCoordToLocal(t,r),o=this.getBoundingRect();if(o.contain(s[0],s[1]))for(var l=0;l<this._displayables.length;l++){var c=this._displayables[l];if(c.contain(t,r))return!0}return!1},e}($w);const TPe=APe;var foe=Zs();function bB(n,e,t,r,s){var o;if(e&&e.ecModel){var l=e.ecModel.getUpdatePayload();o=l&&l.animation}var c=e&&e.isAnimationEnabled(),a=n==="update";if(c){var d=void 0,f=void 0,m=void 0;r?(d=Li(r.duration,200),f=Li(r.easing,"cubicOut"),m=0):(d=e.getShallow(a?"animationDurationUpdate":"animationDuration"),f=e.getShallow(a?"animationEasingUpdate":"animationEasing"),m=e.getShallow(a?"animationDelayUpdate":"animationDelay")),o&&(o.duration!=null&&(d=o.duration),o.easing!=null&&(f=o.easing),o.delay!=null&&(m=o.delay)),hi(m)&&(m=m(t,s)),hi(d)&&(d=d(t));var _={duration:d||0,delay:m,easing:f};return _}else return null}function IG(n,e,t,r,s,o,l){var c=!1,a;hi(s)?(l=o,o=s,s=null):qr(s)&&(o=s.cb,l=s.during,c=s.isFrom,a=s.removeOpt,s=s.dataIndex);var d=n==="leave";d||e.stopAnimation("leave");var f=bB(n,r,s,d?a||{}:null,r&&r.getAnimationDelayParams?r.getAnimationDelayParams(e,s):null);if(f&&f.duration>0){var m=f.duration,_=f.delay,x=f.easing,A={duration:m,delay:_||0,easing:x,done:o,force:!!o||!!l,setToFinal:!d,scope:n,during:l};c?e.animateFrom(t,A):e.animateTo(t,A)}else e.stopAnimation(),!c&&e.attr(t),l&&l(1),o&&o()}function cl(n,e,t,r,s,o){IG("update",n,e,t,r,s,o)}function Jl(n,e,t,r,s,o){IG("enter",n,e,t,r,s,o)}function ew(n){if(!n.__zr)return!0;for(var e=0;e<n.animators.length;e++){var t=n.animators[e];if(t.scope==="leave")return!0}return!1}function pL(n,e,t,r,s,o){ew(n)||IG("leave",n,e,t,r,s,o)}function $q(n,e,t,r){n.removeTextContent(),n.removeTextGuideLine(),pL(n,{style:{opacity:0}},e,t,r)}function mL(n,e,t){function r(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(s){s.isGroup||$q(s,e,t,r)}):$q(n,e,t,r)}function PG(n){foe(n).oldStyle=n.style}function MPe(n){return foe(n).oldStyle}var gL=Math.max,vL=Math.min,t5={};function CPe(n){return Ki.extend(n)}var EPe=ePe;function IPe(n,e){return EPe(n,e)}function pf(n,e){t5[n]=e}function PPe(n){if(t5.hasOwnProperty(n))return t5[n]}function RG(n,e,t,r){var s=QIe(n,e);return t&&(r==="center"&&(t=moe(t,s.getBoundingRect())),goe(s,t)),s}function poe(n,e,t){var r=new q0({style:{image:n,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(s){if(t==="center"){var o={width:s.width,height:s.height};r.setStyle(moe(e,o))}}});return r}function moe(n,e){var t=e.width/e.height,r=n.height*t,s;r<=n.width?s=n.height:(r=n.width,s=r/t);var o=n.x+n.width/2,l=n.y+n.height/2;return{x:o-r/2,y:l-s/2,width:r,height:s}}var Om=tPe;function goe(n,e){if(n.applyTransform){var t=n.getBoundingRect(),r=t.calculateTransform(e);n.applyTransform(r)}}function BM(n,e){return zse(n,n,{lineWidth:e}),n}function RPe(n){return Use(n.shape,n.shape,n.style),n}var LPe=zy;function LG(n,e){for(var t=gG([]);n&&n!==e;)Jb(t,n.getLocalTransform(),t),n=n.parent;return t}function wB(n,e,t){return e&&!Dc(e)&&(e=RC.getLocalTransform(e)),t&&(e=cB([],e)),kh([],n,e)}function voe(n,e,t){var r=e[4]===0||e[5]===0||e[0]===0?1:Math.abs(2*e[4]/e[0]),s=e[4]===0||e[5]===0||e[2]===0?1:Math.abs(2*e[4]/e[2]),o=[n==="left"?-r:n==="right"?r:0,n==="top"?-s:n==="bottom"?s:0];return o=wB(o,e,t),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function Xq(n){return!n.isGroup}function DPe(n){return n.shape!=null}function DG(n,e,t){if(!n||!e)return;function r(l){var c={};return l.traverse(function(a){Xq(a)&&a.anid&&(c[a.anid]=a)}),c}function s(l){var c={x:l.x,y:l.y,rotation:l.rotation};return DPe(l)&&(c.shape=Qn({},l.shape)),c}var o=r(n);e.traverse(function(l){if(Xq(l)&&l.anid){var c=o[l.anid];if(c){var a=s(l);l.attr(s(c)),cl(l,a,t,Yi(l).dataIndex)}}})}function _oe(n,e){return br(n,function(t){var r=t[0];r=gL(r,e.x),r=vL(r,e.x+e.width);var s=t[1];return s=gL(s,e.y),s=vL(s,e.y+e.height),[r,s]})}function BPe(n,e){var t=gL(n.x,e.x),r=vL(n.x+n.width,e.x+e.width),s=gL(n.y,e.y),o=vL(n.y+n.height,e.y+e.height);if(r>=t&&o>=s)return{x:t,y:s,width:r-t,height:o-s}}function SB(n,e,t){var r=Qn({rectHover:!0},e),s=r.style={strokeNoScale:!0};if(t=t||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(s.image=n.slice(8),ri(s,t),new q0(r)):RG(n.replace("path://",""),r,t,"center")}function kPe(n,e,t,r,s){for(var o=0,l=s[s.length-1];o<s.length;o++){var c=s[o];if(yoe(n,e,t,r,c[0],c[1],l[0],l[1]))return!0;l=c}}function yoe(n,e,t,r,s,o,l,c){var a=t-n,d=r-e,f=l-s,m=c-o,_=P3(f,m,a,d);if(OPe(_))return!1;var x=n-s,A=e-o,I=P3(x,A,a,d)/_;if(I<0||I>1)return!1;var E=P3(x,A,f,m)/_;return!(E<0||E>1)}function P3(n,e,t,r){return n*r-t*e}function OPe(n){return n<=1e-6&&n>=-1e-6}function AB(n){var e=n.itemTooltipOption,t=n.componentModel,r=n.itemName,s=Br(e)?{formatter:e}:e,o=t.mainType,l=t.componentIndex,c={componentType:o,name:r,$vars:["name"]};c[o+"Index"]=l;var a=n.formatterParamsExtra;a&&ot(lo(a),function(f){og(c,f)||(c[f]=a[f],c.$vars.push(f))});var d=Yi(n.el);d.componentMainType=o,d.componentIndex=l,d.tooltipConfig={name:r,option:ri({content:r,encodeHTMLContent:!0,formatterParams:c},s)}}function qq(n,e){var t;n.isGroup&&(t=e(n)),t||n.traverse(e)}function TB(n,e){if(n)if(fr(n))for(var t=0;t<n.length;t++)qq(n[t],e);else qq(n,e)}pf("circle",_B);pf("ellipse",roe);pf("sector",Hh);pf("ring",EG);pf("polygon",yB);pf("polyline",Xw);pf("rect",$o);pf("line",qd);pf("bezierCurve",uoe);pf("arc",xB);const BG=Object.freeze(Object.defineProperty({__proto__:null,Arc:xB,BezierCurve:uoe,BoundingRect:ds,Circle:_B,CompoundPath:_Pe,Ellipse:roe,Group:_a,Image:q0,IncrementalDisplayable:TPe,Line:qd,LinearGradient:doe,OrientedBoundingRect:fL,Path:Ki,Point:ei,Polygon:yB,Polyline:Xw,RadialGradient:bPe,Rect:$o,Ring:EG,Sector:Hh,Text:Ra,applyTransform:wB,clipPointsByRect:_oe,clipRectByRect:BPe,createIcon:SB,extendPath:IPe,extendShape:CPe,getShapeClass:PPe,getTransform:LG,groupTransition:DG,initProps:Jl,isElementRemoved:ew,lineLineIntersect:yoe,linePolygonIntersect:kPe,makeImage:poe,makePath:RG,mergePath:Om,registerShape:pf,removeElement:pL,removeElementWithFadeOut:mL,resizePath:goe,setTooltipConfig:AB,subPixelOptimize:LPe,subPixelOptimizeLine:BM,subPixelOptimizeRect:RPe,transformDirection:voe,traverseElements:TB,updateProps:cl},Symbol.toStringTag,{value:"Module"}));var MB={};function xoe(n,e){for(var t=0;t<Vh.length;t++){var r=Vh[t],s=e[r],o=n.ensureState(r);o.style=o.style||{},o.style.text=s}var l=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:e.normal}),n.useStates(l,!0)}function n5(n,e,t){var r=n.labelFetcher,s=n.labelDataIndex,o=n.labelDimIndex,l=e.normal,c;r&&(c=r.getFormattedLabel(s,"normal",null,o,l&&l.get("formatter"),t!=null?{interpolatedValue:t}:null)),c==null&&(c=hi(n.defaultText)?n.defaultText(s,n,t):n.defaultText);for(var a={normal:c},d=0;d<Vh.length;d++){var f=Vh[d],m=e[f];a[f]=Li(r?r.getFormattedLabel(s,f,null,o,m&&m.get("formatter")):null,c)}return a}function kC(n,e,t,r){t=t||MB;for(var s=n instanceof Ra,o=!1,l=0;l<hL.length;l++){var c=e[hL[l]];if(c&&c.getShallow("show")){o=!0;break}}var a=s?n:n.getTextContent();if(o){s||(a||(a=new Ra,n.setTextContent(a)),n.stateProxy&&(a.stateProxy=n.stateProxy));var d=n5(t,e),f=e.normal,m=!!f.getShallow("show"),_=cg(f,r&&r.normal,t,!1,!s);_.text=d.normal,s||n.setTextConfig(Yq(f,t,!1));for(var l=0;l<Vh.length;l++){var x=Vh[l],c=e[x];if(c){var A=a.ensureState(x),I=!!Li(c.getShallow("show"),m);if(I!==m&&(A.ignore=!I),A.style=cg(c,r&&r[x],t,!0,!s),A.style.text=d[x],!s){var E=n.ensureState(x);E.textConfig=Yq(c,t,!0)}}}a.silent=!!f.getShallow("silent"),a.style.x!=null&&(_.x=a.style.x),a.style.y!=null&&(_.y=a.style.y),a.ignore=!m,a.useStyle(_),a.dirty(),t.enableTextSetter&&(qw(a).setLabelText=function(C){var L=n5(t,e,C);xoe(a,L)})}else a&&(a.ignore=!0);n.dirty()}function OC(n,e){e=e||"label";for(var t={normal:n.getModel(e)},r=0;r<Vh.length;r++){var s=Vh[r];t[s]=n.getModel([s,e])}return t}function cg(n,e,t,r,s){var o={};return FPe(o,n,t,r,s),e&&Qn(o,e),o}function Yq(n,e,t){e=e||{};var r={},s,o=n.getShallow("rotate"),l=Li(n.getShallow("distance"),t?null:5),c=n.getShallow("offset");return s=n.getShallow("position")||(t?null:"inside"),s==="outside"&&(s=e.defaultOutsidePosition||"top"),s!=null&&(r.position=s),c!=null&&(r.offset=c),o!=null&&(o*=Math.PI/180,r.rotation=o),l!=null&&(r.distance=l),r.outsideFill=n.get("color")==="inherit"?e.inheritColor||null:"auto",r}function FPe(n,e,t,r,s){t=t||MB;var o=e.ecModel,l=o&&o.option.textStyle,c=NPe(e),a;if(c){a={};for(var d in c)if(c.hasOwnProperty(d)){var f=e.getModel(["rich",d]);Qq(a[d]={},f,l,t,r,s,!1,!0)}}a&&(n.rich=a);var m=e.get("overflow");m&&(n.overflow=m);var _=e.get("minMargin");_!=null&&(n.margin=_),Qq(n,e,l,t,r,s,!0,!1)}function NPe(n){for(var e;n&&n!==n.ecModel;){var t=(n.option||MB).rich;if(t){e=e||{};for(var r=lo(t),s=0;s<r.length;s++){var o=r[s];e[o]=1}}n=n.parentModel}return e}var Zq=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Kq=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],Jq=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function Qq(n,e,t,r,s,o,l,c){t=!s&&t||MB;var a=r&&r.inheritColor,d=e.getShallow("color"),f=e.getShallow("textBorderColor"),m=Li(e.getShallow("opacity"),t.opacity);(d==="inherit"||d==="auto")&&(a?d=a:d=null),(f==="inherit"||f==="auto")&&(a?f=a:f=null),o||(d=d||t.color,f=f||t.textBorderColor),d!=null&&(n.fill=d),f!=null&&(n.stroke=f);var _=Li(e.getShallow("textBorderWidth"),t.textBorderWidth);_!=null&&(n.lineWidth=_);var x=Li(e.getShallow("textBorderType"),t.textBorderType);x!=null&&(n.lineDash=x);var A=Li(e.getShallow("textBorderDashOffset"),t.textBorderDashOffset);A!=null&&(n.lineDashOffset=A),!s&&m==null&&!c&&(m=r&&r.defaultOpacity),m!=null&&(n.opacity=m),!s&&!o&&n.fill==null&&r.inheritColor&&(n.fill=r.inheritColor);for(var I=0;I<Zq.length;I++){var E=Zq[I],C=Li(e.getShallow(E),t[E]);C!=null&&(n[E]=C)}for(var I=0;I<Kq.length;I++){var E=Kq[I],C=e.getShallow(E);C!=null&&(n[E]=C)}if(n.verticalAlign==null){var L=e.getShallow("baseline");L!=null&&(n.verticalAlign=L)}if(!l||!r.disableBox){for(var I=0;I<Jq.length;I++){var E=Jq[I],C=e.getShallow(E);C!=null&&(n[E]=C)}var O=e.getShallow("borderType");O!=null&&(n.borderDash=O),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&a&&(n.backgroundColor=a),(n.borderColor==="auto"||n.borderColor==="inherit")&&a&&(n.borderColor=a)}}function boe(n,e){var t=e&&e.getModel("textStyle");return cp([n.fontStyle||t&&t.getShallow("fontStyle")||"",n.fontWeight||t&&t.getShallow("fontWeight")||"",(n.fontSize||t&&t.getShallow("fontSize")||12)+"px",n.fontFamily||t&&t.getShallow("fontFamily")||"sans-serif"].join(" "))}var qw=Zs();function zPe(n,e,t,r){if(n){var s=qw(n);s.prevValue=s.value,s.value=t;var o=e.normal;s.valueAnimation=o.get("valueAnimation"),s.valueAnimation&&(s.precision=o.get("precision"),s.defaultInterpolatedText=r,s.statesModels=e)}}function UPe(n,e,t,r,s){var o=qw(n);if(!o.valueAnimation||o.prevValue===o.value)return;var l=o.defaultInterpolatedText,c=Li(o.interpolatedValue,o.prevValue),a=o.value;function d(f){var m=Ese(t,o.precision,c,a,f);o.interpolatedValue=f===1?null:m;var _=n5({labelDataIndex:e,labelFetcher:s,defaultText:l?l(m):m+""},o.statesModels,m);xoe(n,_)}n.percent=0,(o.prevValue==null?Jl:cl)(n,{percent:1},r,e,null,d)}var GPe=["textStyle","color"],R3=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],L3=new Ra,VPe=function(){function n(){}return n.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(GPe):null)},n.prototype.getFont=function(){return boe({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},r=0;r<R3.length;r++)t[R3[r]]=this.getShallow(R3[r]);return L3.useStyle(t),L3.update(),L3.getBoundingRect()},n}(),woe=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],HPe=LM(woe),jPe=function(){function n(){}return n.prototype.getLineStyle=function(e){return HPe(this,e)},n}(),Soe=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],WPe=LM(Soe),$Pe=function(){function n(){}return n.prototype.getItemStyle=function(e,t){return WPe(this,e,t)},n}(),Do=function(){function n(e,t,r){this.parentModel=t,this.ecModel=r,this.option=e}return n.prototype.init=function(e,t,r){},n.prototype.mergeOption=function(e,t){Fi(this.option,e,!0)},n.prototype.get=function(e,t){return e==null?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},n.prototype.getShallow=function(e,t){var r=this.option,s=r==null?r:r[e];if(s==null&&!t){var o=this.parentModel;o&&(s=o.getShallow(e))}return s},n.prototype.getModel=function(e,t){var r=e!=null,s=r?this.parsePath(e):null,o=r?this._doGet(s):this.option;return t=t||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(s)),new n(o,t,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var e=this.constructor;return new e(wi(this.option))},n.prototype.parsePath=function(e){return typeof e=="string"?e.split("."):e},n.prototype.resolveParentPath=function(e){return e},n.prototype.isAnimationEnabled=function(){if(!yi.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(e,t){var r=this.option;if(!e)return r;for(var s=0;s<e.length&&!(e[s]&&(r=r&&typeof r=="object"?r[e[s]]:null,r==null));s++);return r==null&&t&&(r=t._doGet(this.resolveParentPath(e),t.parentModel)),r},n}();wG(Do);B2e(Do);df(Do,jPe);df(Do,$Pe);df(Do,z2e);df(Do,VPe);var XPe=Math.round(Math.random()*10);function FC(n){return[n||"",XPe++].join("_")}function qPe(n){var e={};n.registerSubTypeDefaulter=function(t,r){var s=up(t);e[s.main]=r},n.determineSubType=function(t,r){var s=r.type;if(!s){var o=up(t).main;n.hasSubTypes(t)&&e[o]&&(s=e[o](r))}return s}}function YPe(n,e){n.topologicalTravel=function(o,l,c,a){if(!o.length)return;var d=t(l),f=d.graph,m=d.noEntryList,_={};for(ot(o,function(L){_[L]=!0});m.length;){var x=m.pop(),A=f[x],I=!!_[x];I&&(c.call(a,x,A.originalDeps.slice()),delete _[x]),ot(A.successor,I?C:E)}ot(_,function(){var L="";throw new Error(L)});function E(L){f[L].entryCount--,f[L].entryCount===0&&m.push(L)}function C(L){_[L]=!0,E(L)}};function t(o){var l={},c=[];return ot(o,function(a){var d=r(l,a),f=d.originalDeps=e(a),m=s(f,o);d.entryCount=m.length,d.entryCount===0&&c.push(a),ot(m,function(_){Zi(d.predecessor,_)<0&&d.predecessor.push(_);var x=r(l,_);Zi(x.successor,_)<0&&x.successor.push(a)})}),{graph:l,noEntryList:c}}function r(o,l){return o[l]||(o[l]={predecessor:[],successor:[]}),o[l]}function s(o,l){var c=[];return ot(o,function(a){Zi(l,a)>=0&&c.push(a)}),c}}function Aoe(n,e){return Fi(Fi({},n,!0),e,!0)}const ZPe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},KPe={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var _L="ZH",kG="EN",tw=kG,IP={},OG={},Toe=yi.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage||tw).toUpperCase();return n.indexOf(_L)>-1?_L:tw}():tw;function Moe(n,e){n=n.toUpperCase(),OG[n]=new Do(e),IP[n]=e}function JPe(n){if(Br(n)){var e=IP[n.toUpperCase()]||{};return n===_L||n===kG?wi(e):Fi(wi(e),wi(IP[tw]),!1)}else return Fi(wi(n),wi(IP[tw]),!1)}function QPe(n){return OG[n]}function eRe(){return OG[tw]}Moe(kG,ZPe);Moe(_L,KPe);var FG=1e3,NG=FG*60,kT=NG*60,Eh=kT*24,eY=Eh*365,KA={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},vI="{yyyy}-{MM}-{dd}",tY={year:"{yyyy}",month:"{yyyy}-{MM}",day:vI,hour:vI+" "+KA.hour,minute:vI+" "+KA.minute,second:vI+" "+KA.second,millisecond:KA.none},D3=["year","month","day","hour","minute","second","millisecond"],Coe=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Ev(n,e){return n+="","0000".substr(0,e-n.length)+n}function nw(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function tRe(n){return n===nw(n)}function nRe(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function CB(n,e,t,r){var s=ag(n),o=s[zG(t)](),l=s[rw(t)]()+1,c=Math.floor((l-1)/3)+1,a=s[EB(t)](),d=s["get"+(t?"UTC":"")+"Day"](),f=s[kM(t)](),m=(f-1)%12+1,_=s[IB(t)](),x=s[PB(t)](),A=s[RB(t)](),I=f>=12?"pm":"am",E=I.toUpperCase(),C=r instanceof Do?r:QPe(r||Toe)||eRe(),L=C.getModel("time"),O=L.get("month"),H=L.get("monthAbbr"),q=L.get("dayOfWeek"),Z=L.get("dayOfWeekAbbr");return(e||"").replace(/{a}/g,I+"").replace(/{A}/g,E+"").replace(/{yyyy}/g,o+"").replace(/{yy}/g,Ev(o%100+"",2)).replace(/{Q}/g,c+"").replace(/{MMMM}/g,O[l-1]).replace(/{MMM}/g,H[l-1]).replace(/{MM}/g,Ev(l,2)).replace(/{M}/g,l+"").replace(/{dd}/g,Ev(a,2)).replace(/{d}/g,a+"").replace(/{eeee}/g,q[d]).replace(/{ee}/g,Z[d]).replace(/{e}/g,d+"").replace(/{HH}/g,Ev(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,Ev(m+"",2)).replace(/{h}/g,m+"").replace(/{mm}/g,Ev(_,2)).replace(/{m}/g,_+"").replace(/{ss}/g,Ev(x,2)).replace(/{s}/g,x+"").replace(/{SSS}/g,Ev(A,3)).replace(/{S}/g,A+"")}function rRe(n,e,t,r,s){var o=null;if(Br(t))o=t;else if(hi(t))o=t(n.value,e,{level:n.level});else{var l=Qn({},KA);if(n.level>0)for(var c=0;c<D3.length;++c)l[D3[c]]="{primary|"+l[D3[c]]+"}";var a=t?t.inherit===!1?t:ri(t,l):l,d=Eoe(n.value,s);if(a[d])o=a[d];else if(a.inherit){for(var f=Coe.indexOf(d),c=f-1;c>=0;--c)if(a[d]){o=a[d];break}o=o||l.none}if(fr(o)){var m=n.level==null?0:n.level>=0?n.level:o.length+n.level;m=Math.min(m,o.length-1),o=o[m]}}return CB(new Date(n.value),o,s,r)}function Eoe(n,e){var t=ag(n),r=t[rw(e)]()+1,s=t[EB(e)](),o=t[kM(e)](),l=t[IB(e)](),c=t[PB(e)](),a=t[RB(e)](),d=a===0,f=d&&c===0,m=f&&l===0,_=m&&o===0,x=_&&s===1,A=x&&r===1;return A?"year":x?"month":_?"day":m?"hour":f?"minute":d?"second":"millisecond"}function nY(n,e,t){var r=Ds(n)?ag(n):n;switch(e=e||Eoe(n,t),e){case"year":return r[zG(t)]();case"half-year":return r[rw(t)]()>=6?1:0;case"quarter":return Math.floor((r[rw(t)]()+1)/4);case"month":return r[rw(t)]();case"day":return r[EB(t)]();case"half-day":return r[kM(t)]()/24;case"hour":return r[kM(t)]();case"minute":return r[IB(t)]();case"second":return r[PB(t)]();case"millisecond":return r[RB(t)]()}}function zG(n){return n?"getUTCFullYear":"getFullYear"}function rw(n){return n?"getUTCMonth":"getMonth"}function EB(n){return n?"getUTCDate":"getDate"}function kM(n){return n?"getUTCHours":"getHours"}function IB(n){return n?"getUTCMinutes":"getMinutes"}function PB(n){return n?"getUTCSeconds":"getSeconds"}function RB(n){return n?"getUTCMilliseconds":"getMilliseconds"}function iRe(n){return n?"setUTCFullYear":"setFullYear"}function Ioe(n){return n?"setUTCMonth":"setMonth"}function Poe(n){return n?"setUTCDate":"setDate"}function Roe(n){return n?"setUTCHours":"setHours"}function Loe(n){return n?"setUTCMinutes":"setMinutes"}function Doe(n){return n?"setUTCSeconds":"setSeconds"}function Boe(n){return n?"setUTCMilliseconds":"setMilliseconds"}function koe(n){if(!f2e(n))return Br(n)?n:"-";var e=(n+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function Ooe(n,e){return n=(n||"").toLowerCase().replace(/-(.)/g,function(t,r){return r.toUpperCase()}),e&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var LB=qie;function r5(n,e,t){var r="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function s(f){return f&&cp(f)?f:"-"}function o(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var l=e==="time",c=n instanceof Date;if(l||c){var a=l?ag(n):n;if(isNaN(+a)){if(c)return"-"}else return CB(a,r,t)}if(e==="ordinal")return Ez(n)?s(n):Ds(n)&&o(n)?n+"":"-";var d=E0(n);return o(d)?koe(d):Ez(n)?s(n):typeof n=="boolean"?n+"":"-"}var rY=["a","b","c","d","e","f","g"],B3=function(n,e){return"{"+n+(e??"")+"}"};function Foe(n,e,t){fr(e)||(e=[e]);var r=e.length;if(!r)return"";for(var s=e[0].$vars||[],o=0;o<s.length;o++){var l=rY[o];n=n.replace(B3(l),B3(l,0))}for(var c=0;c<r;c++)for(var a=0;a<s.length;a++){var d=e[c][s[a]];n=n.replace(B3(rY[a],c),t?Ou(d):d)}return n}function sRe(n,e){var t=Br(n)?{color:n,extraCssText:e}:n||{},r=t.color,s=t.type;e=t.extraCssText;var o=t.renderMode||"html";if(!r)return"";if(o==="html")return s==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Ou(r)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Ou(r)+";"+(e||"")+'"></span>';var l=t.markerId||"markerX";return{renderMode:o,content:"{"+l+"|}  ",style:s==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:r}:{width:10,height:10,borderRadius:5,backgroundColor:r}}}function xx(n,e){return e=e||"transparent",Br(n)?n:qr(n)&&n.colorStops&&(n.colorStops[0]||{}).color||e}function iY(n,e){if(e==="_blank"||e==="blank"){var t=window.open();t.opener=null,t.location.href=n}else window.open(n,e)}var PP=ot,oRe=["left","right","top","bottom","width","height"],_I=[["width","left","right"],["height","top","bottom"]];function UG(n,e,t,r,s){var o=0,l=0;r==null&&(r=1/0),s==null&&(s=1/0);var c=0;e.eachChild(function(a,d){var f=a.getBoundingRect(),m=e.childAt(d+1),_=m&&m.getBoundingRect(),x,A;if(n==="horizontal"){var I=f.width+(_?-_.x+f.x:0);x=o+I,x>r||a.newline?(o=0,x=I,l+=c+t,c=f.height):c=Math.max(c,f.height)}else{var E=f.height+(_?-_.y+f.y:0);A=l+E,A>s||a.newline?(o+=c+t,l=0,A=E,c=f.width):c=Math.max(c,f.width)}a.newline||(a.x=o,a.y=l,a.markRedraw(),n==="horizontal"?o=x+t:l=A+t)})}var iw=UG;xs(UG,"vertical");xs(UG,"horizontal");function I0(n,e,t){t=LB(t||0);var r=e.width,s=e.height,o=hs(n.left,r),l=hs(n.top,s),c=hs(n.right,r),a=hs(n.bottom,s),d=hs(n.width,r),f=hs(n.height,s),m=t[2]+t[0],_=t[1]+t[3],x=n.aspect;switch(isNaN(d)&&(d=r-c-_-o),isNaN(f)&&(f=s-a-m-l),x!=null&&(isNaN(d)&&isNaN(f)&&(x>r/s?d=r*.8:f=s*.8),isNaN(d)&&(d=x*f),isNaN(f)&&(f=d/x)),isNaN(o)&&(o=r-c-d-_),isNaN(l)&&(l=s-a-f-m),n.left||n.right){case"center":o=r/2-d/2-t[3];break;case"right":o=r-d-_;break}switch(n.top||n.bottom){case"middle":case"center":l=s/2-f/2-t[0];break;case"bottom":l=s-f-m;break}o=o||0,l=l||0,isNaN(d)&&(d=r-_-o-(c||0)),isNaN(f)&&(f=s-m-l-(a||0));var A=new ds(o+t[3],l+t[0],d,f);return A.margin=t,A}function aRe(n,e,t,r,s,o){o=o||n,o.x=n.x,o.y=n.y;var l;if(l=n.getBoundingRect(),n.needLocalTransform()){var c=n.getLocalTransform();l=l.clone(),l.applyTransform(c)}var a=I0(ri({width:l.width,height:l.height},e),t,r),d=a.x-l.x,f=a.y-l.y;return o.x+=d,o.y+=f,o===n&&n.markRedraw(),!0}function OM(n){var e=n.layoutMode||n.constructor.layoutMode;return qr(e)?e:e?{type:e}:null}function Aw(n,e,t){var r=t&&t.ignoreSize;!fr(r)&&(r=[r,r]);var s=l(_I[0],0),o=l(_I[1],1);d(_I[0],n,s),d(_I[1],n,o);function l(f,m){var _={},x=0,A={},I=0,E=2;if(PP(f,function(O){A[O]=n[O]}),PP(f,function(O){c(e,O)&&(_[O]=A[O]=e[O]),a(_,O)&&x++,a(A,O)&&I++}),r[m])return a(e,f[1])?A[f[2]]=null:a(e,f[2])&&(A[f[1]]=null),A;if(I===E||!x)return A;if(x>=E)return _;for(var C=0;C<f.length;C++){var L=f[C];if(!c(_,L)&&c(n,L)){_[L]=n[L];break}}return _}function c(f,m){return f.hasOwnProperty(m)}function a(f,m){return f[m]!=null&&f[m]!=="auto"}function d(f,m,_){PP(f,function(x){m[x]=_[x]})}}function DB(n){return lRe({},n)}function lRe(n,e){return e&&n&&PP(oRe,function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n}var cRe=Zs(),cs=function(n){jn(e,n);function e(t,r,s){var o=n.call(this,t,r,s)||this;return o.uid=FC("ec_cpt_model"),o}return e.prototype.init=function(t,r,s){this.mergeDefaultAndTheme(t,s)},e.prototype.mergeDefaultAndTheme=function(t,r){var s=OM(this),o=s?DB(t):{},l=r.getTheme();Fi(t,l.get(this.mainType)),Fi(t,this.getDefaultOption()),s&&Aw(t,o,s)},e.prototype.mergeOption=function(t,r){Fi(this.option,t,!0);var s=OM(this);s&&Aw(this.option,t,s)},e.prototype.optionUpdated=function(t,r){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!R2e(t))return t.defaultOption;var r=cRe(this);if(!r.defaultOption){for(var s=[],o=t;o;){var l=o.prototype.defaultOption;l&&s.push(l),o=o.superClass}for(var c={},a=s.length-1;a>=0;a--)c=Fi(c,s[a],!0);r.defaultOption=c}return r.defaultOption},e.prototype.getReferringComponents=function(t,r){var s=t+"Index",o=t+"Id";return BC(this.ecModel,t,{index:this.get(s,!0),id:this.get(o,!0)},r)},e.prototype.getBoxLayoutParams=function(){var t=this;return{left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")}},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(t){this.option.zlevel=t},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}(Do);Pse(cs,Do);dB(cs);qPe(cs);YPe(cs,uRe);function uRe(n){var e=[];return ot(cs.getClassesByMainType(n),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=br(e,function(t){return up(t).main}),n!=="dataset"&&Zi(e,"dataset")<=0&&e.unshift("dataset"),e}var Noe="";typeof navigator<"u"&&(Noe=navigator.platform||"");var K1="rgba(0, 0, 0, 0.2)";const hRe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:K1,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:K1,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:K1,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:K1,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:K1,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:K1,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:Noe.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var zoe=oi(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),jh="original",Bc="arrayRows",Wh="objectRows",Cp="keyedColumns",v0="typedArray",Uoe="unknown",_p="column",Yw="row",bl={Must:1,Might:2,Not:3},Goe=Zs();function dRe(n){Goe(n).datasetMap=oi()}function fRe(n,e,t){var r={},s=GG(e);if(!s||!n)return r;var o=[],l=[],c=e.ecModel,a=Goe(c).datasetMap,d=s.uid+"_"+t.seriesLayoutBy,f,m;n=n.slice(),ot(n,function(I,E){var C=qr(I)?I:n[E]={name:I};C.type==="ordinal"&&f==null&&(f=E,m=A(C)),r[C.name]=[]});var _=a.get(d)||a.set(d,{categoryWayDim:m,valueWayDim:0});ot(n,function(I,E){var C=I.name,L=A(I);if(f==null){var O=_.valueWayDim;x(r[C],O,L),x(l,O,L),_.valueWayDim+=L}else if(f===E)x(r[C],0,L),x(o,0,L);else{var O=_.categoryWayDim;x(r[C],O,L),x(l,O,L),_.categoryWayDim+=L}});function x(I,E,C){for(var L=0;L<C;L++)I.push(E+L)}function A(I){var E=I.dimsDef;return E?E.length:1}return o.length&&(r.itemName=o),l.length&&(r.seriesName=l),r}function pRe(n,e,t){var r={},s=GG(n);if(!s)return r;var o=e.sourceFormat,l=e.dimensionsDefine,c;(o===Wh||o===Cp)&&ot(l,function(f,m){(qr(f)?f.name:f)==="name"&&(c=m)});var a=function(){for(var f={},m={},_=[],x=0,A=Math.min(5,t);x<A;x++){var I=Hoe(e.data,o,e.seriesLayoutBy,l,e.startIndex,x);_.push(I);var E=I===bl.Not;if(E&&f.v==null&&x!==c&&(f.v=x),(f.n==null||f.n===f.v||!E&&_[f.n]===bl.Not)&&(f.n=x),C(f)&&_[f.n]!==bl.Not)return f;E||(I===bl.Might&&m.v==null&&x!==c&&(m.v=x),(m.n==null||m.n===m.v)&&(m.n=x))}function C(L){return L.v!=null&&L.n!=null}return C(f)?f:C(m)?m:null}();if(a){r.value=[a.v];var d=c??a.n;r.itemName=[d],r.seriesName=[d]}return r}function GG(n){var e=n.get("data",!0);if(!e)return BC(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},Sl).models[0]}function mRe(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:BC(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},Sl).models}function Voe(n,e){return Hoe(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,e)}function Hoe(n,e,t,r,s,o){var l,c=5;if(_u(n))return bl.Not;var a,d;if(r){var f=r[o];qr(f)?(a=f.name,d=f.type):Br(f)&&(a=f)}if(d!=null)return d==="ordinal"?bl.Must:bl.Not;if(e===Bc){var m=n;if(t===Yw){for(var _=m[o],x=0;x<(_||[]).length&&x<c;x++)if((l=H(_[s+x]))!=null)return l}else for(var x=0;x<m.length&&x<c;x++){var A=m[s+x];if(A&&(l=H(A[o]))!=null)return l}}else if(e===Wh){var I=n;if(!a)return bl.Not;for(var x=0;x<I.length&&x<c;x++){var E=I[x];if(E&&(l=H(E[a]))!=null)return l}}else if(e===Cp){var C=n;if(!a)return bl.Not;var _=C[a];if(!_||_u(_))return bl.Not;for(var x=0;x<_.length&&x<c;x++)if((l=H(_[x]))!=null)return l}else if(e===jh)for(var L=n,x=0;x<L.length&&x<c;x++){var E=L[x],O=DC(E);if(!fr(O))return bl.Not;if((l=H(O[o]))!=null)return l}function H(q){var Z=Br(q);if(q!=null&&Number.isFinite(Number(q))&&q!=="")return Z?bl.Might:bl.Not;if(Z&&q!=="-")return bl.Must}return bl.Not}var i5=oi();function gRe(n,e){wp(i5.get(n)==null&&e),i5.set(n,e)}function vRe(n,e,t){var r=i5.get(e);if(!r)return t;var s=r(n);return s?t.concat(s):t}var sY=Zs();Zs();var VG=function(){function n(){}return n.prototype.getColorFromPalette=function(e,t,r){var s=va(this.get("color",!0)),o=this.get("colorLayer",!0);return yRe(this,sY,s,o,e,t,r)},n.prototype.clearColorPalette=function(){xRe(this,sY)},n}();function _Re(n,e){for(var t=n.length,r=0;r<t;r++)if(n[r].length>e)return n[r];return n[t-1]}function yRe(n,e,t,r,s,o,l){o=o||n;var c=e(o),a=c.paletteIdx||0,d=c.paletteNameMap=c.paletteNameMap||{};if(d.hasOwnProperty(s))return d[s];var f=l==null||!r?t:_Re(r,l);if(f=f||t,!(!f||!f.length)){var m=f[a];return s&&(d[s]=m),c.paletteIdx=(a+1)%f.length,m}}function xRe(n,e){e(n).paletteIdx=0,e(n).paletteNameMap={}}var yI,gA,oY,aY="\0_ec_inner",bRe=1,HG=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t,r,s,o,l,c){o=o||{},this.option=null,this._theme=new Do(o),this._locale=new Do(l),this._optionManager=c},e.prototype.setOption=function(t,r,s){var o=uY(r);this._optionManager.setOption(t,s,o),this._resetOption(null,o)},e.prototype.resetOption=function(t,r){return this._resetOption(t,uY(r))},e.prototype._resetOption=function(t,r){var s=!1,o=this._optionManager;if(!t||t==="recreate"){var l=o.mountOption(t==="recreate");!this.option||t==="recreate"?oY(this,l):(this.restoreData(),this._mergeOption(l,r)),s=!0}if((t==="timeline"||t==="media")&&this.restoreData(),!t||t==="recreate"||t==="timeline"){var c=o.getTimelineOption(this);c&&(s=!0,this._mergeOption(c,r))}if(!t||t==="recreate"||t==="media"){var a=o.getMediaOption(this);a.length&&ot(a,function(d){s=!0,this._mergeOption(d,r)},this)}return s},e.prototype.mergeOption=function(t){this._mergeOption(t,null)},e.prototype._mergeOption=function(t,r){var s=this.option,o=this._componentsMap,l=this._componentsCount,c=[],a=oi(),d=r&&r.replaceMergeMainTypeMap;dRe(this),ot(t,function(m,_){m!=null&&(cs.hasClass(_)?_&&(c.push(_),a.set(_,!0)):s[_]=s[_]==null?wi(m):Fi(s[_],m,!0))}),d&&d.each(function(m,_){cs.hasClass(_)&&!a.get(_)&&(c.push(_),a.set(_,!0))}),cs.topologicalTravel(c,cs.getAllClassMainTypes(),f,this);function f(m){var _=vRe(this,m,va(t[m])),x=o.get(m),A=x?d&&d.get(m)?"replaceMerge":"normalMerge":"replaceAll",I=m2e(x,_,A);S2e(I,m,cs),s[m]=null,o.set(m,null),l.set(m,0);var E=[],C=[],L=0,O;ot(I,function(H,q){var Z=H.existing,J=H.newOption;if(!J)Z&&(Z.mergeOption({},this),Z.optionUpdated({},!1));else{var re=m==="series",se=cs.getClass(m,H.keyInfo.subType,!re);if(!se)return;if(m==="tooltip"){if(O)return;O=!0}if(Z&&Z.constructor===se)Z.name=H.keyInfo.name,Z.mergeOption(J,this),Z.optionUpdated(J,!1);else{var ae=Qn({componentIndex:q},H.keyInfo);Z=new se(J,this,this,ae),Qn(Z,ae),H.brandNew&&(Z.__requireNewView=!0),Z.init(J,this,this),Z.optionUpdated(null,!0)}}Z?(E.push(Z.option),C.push(Z),L++):(E.push(void 0),C.push(void 0))},this),s[m]=E,o.set(m,C),l.set(m,L),m==="series"&&yI(this)}this._seriesIndices||yI(this)},e.prototype.getOption=function(){var t=wi(this.option);return ot(t,function(r,s){if(cs.hasClass(s)){for(var o=va(r),l=o.length,c=!1,a=l-1;a>=0;a--)o[a]&&!RM(o[a])?c=!0:(o[a]=null,!c&&l--);o.length=l,t[s]=o}}),delete t[aY],t},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(t){this._payload=t},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(t,r){var s=this._componentsMap.get(t);if(s){var o=s[r||0];if(o)return o;if(r==null){for(var l=0;l<s.length;l++)if(s[l])return s[l]}}},e.prototype.queryComponents=function(t){var r=t.mainType;if(!r)return[];var s=t.index,o=t.id,l=t.name,c=this._componentsMap.get(r);if(!c||!c.length)return[];var a;return s!=null?(a=[],ot(va(s),function(d){c[d]&&a.push(c[d])})):o!=null?a=lY("id",o,c):l!=null?a=lY("name",l,c):a=sa(c,function(d){return!!d}),cY(a,t)},e.prototype.findComponents=function(t){var r=t.query,s=t.mainType,o=c(r),l=o?this.queryComponents(o):sa(this._componentsMap.get(s),function(d){return!!d});return a(cY(l,t));function c(d){var f=s+"Index",m=s+"Id",_=s+"Name";return d&&(d[f]!=null||d[m]!=null||d[_]!=null)?{mainType:s,index:d[f],id:d[m],name:d[_]}:null}function a(d){return t.filter?sa(d,t.filter):d}},e.prototype.eachComponent=function(t,r,s){var o=this._componentsMap;if(hi(t)){var l=r,c=t;o.each(function(m,_){for(var x=0;m&&x<m.length;x++){var A=m[x];A&&c.call(l,_,A,A.componentIndex)}})}else for(var a=Br(t)?o.get(t):qr(t)?this.findComponents(t):null,d=0;a&&d<a.length;d++){var f=a[d];f&&r.call(s,f,f.componentIndex)}},e.prototype.getSeriesByName=function(t){var r=vp(t,null);return sa(this._componentsMap.get("series"),function(s){return!!s&&r!=null&&s.name===r})},e.prototype.getSeriesByIndex=function(t){return this._componentsMap.get("series")[t]},e.prototype.getSeriesByType=function(t){return sa(this._componentsMap.get("series"),function(r){return!!r&&r.subType===t})},e.prototype.getSeries=function(){return sa(this._componentsMap.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(t,r){gA(this),ot(this._seriesIndices,function(s){var o=this._componentsMap.get("series")[s];t.call(r,o,s)},this)},e.prototype.eachRawSeries=function(t,r){ot(this._componentsMap.get("series"),function(s){s&&t.call(r,s,s.componentIndex)})},e.prototype.eachSeriesByType=function(t,r,s){gA(this),ot(this._seriesIndices,function(o){var l=this._componentsMap.get("series")[o];l.subType===t&&r.call(s,l,o)},this)},e.prototype.eachRawSeriesByType=function(t,r,s){return ot(this.getSeriesByType(t),r,s)},e.prototype.isSeriesFiltered=function(t){return gA(this),this._seriesIndicesMap.get(t.componentIndex)==null},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(t,r){gA(this);var s=[];ot(this._seriesIndices,function(o){var l=this._componentsMap.get("series")[o];t.call(r,l,o)&&s.push(o)},this),this._seriesIndices=s,this._seriesIndicesMap=oi(s)},e.prototype.restoreData=function(t){yI(this);var r=this._componentsMap,s=[];r.each(function(o,l){cs.hasClass(l)&&s.push(l)}),cs.topologicalTravel(s,cs.getAllClassMainTypes(),function(o){ot(r.get(o),function(l){l&&(o!=="series"||!wRe(l,t))&&l.restoreData()})})},e.internalField=function(){yI=function(t){var r=t._seriesIndices=[];ot(t._componentsMap.get("series"),function(s){s&&r.push(s.componentIndex)}),t._seriesIndicesMap=oi(r)},gA=function(t){},oY=function(t,r){t.option={},t.option[aY]=bRe,t._componentsMap=oi({series:[]}),t._componentsCount=oi();var s=r.aria;qr(s)&&s.enabled==null&&(s.enabled=!0),SRe(r,t._theme.option),Fi(r,hRe,!1),t._mergeOption(r,null)}}(),e}(Do);function wRe(n,e){if(e){var t=e.seriesIndex,r=e.seriesId,s=e.seriesName;return t!=null&&n.componentIndex!==t||r!=null&&n.id!==r||s!=null&&n.name!==s}}function SRe(n,e){var t=n.color&&!n.colorLayer;ot(e,function(r,s){s==="colorLayer"&&t||cs.hasClass(s)||(typeof r=="object"?n[s]=n[s]?Fi(n[s],r,!1):wi(r):n[s]==null&&(n[s]=r))})}function lY(n,e,t){if(fr(e)){var r=oi();return ot(e,function(o){if(o!=null){var l=vp(o,null);l!=null&&r.set(o,!0)}}),sa(t,function(o){return o&&r.get(o[n])})}else{var s=vp(e,null);return sa(t,function(o){return o&&s!=null&&o[n]===s})}}function cY(n,e){return e.hasOwnProperty("subType")?sa(n,function(t){return t&&t.subType===e.subType}):n}function uY(n){var e=oi();return n&&ot(va(n.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}df(HG,VG);var ARe=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],joe=function(){function n(e){ot(ARe,function(t){this[t]=Vs(e[t],e)},this)}return n}(),k3={},jG=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(e,t){var r=[];ot(k3,function(s,o){var l=s.create(e,t);r=r.concat(l||[])}),this._coordinateSystems=r},n.prototype.update=function(e,t){ot(this._coordinateSystems,function(r){r.update&&r.update(e,t)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(e,t){k3[e]=t},n.get=function(e){return k3[e]},n}(),TRe=/^(min|max)?(.+)$/,MRe=function(){function n(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return n.prototype.setOption=function(e,t,r){e&&(ot(va(e.series),function(l){l&&l.data&&_u(l.data)&&eL(l.data)}),ot(va(e.dataset),function(l){l&&l.source&&_u(l.source)&&eL(l.source)})),e=wi(e);var s=this._optionBackup,o=CRe(e,t,!s);this._newBaseOption=o.baseOption,s?(o.timelineOptions.length&&(s.timelineOptions=o.timelineOptions),o.mediaList.length&&(s.mediaList=o.mediaList),o.mediaDefault&&(s.mediaDefault=o.mediaDefault)):this._optionBackup=o},n.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],wi(e?t.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(e){var t,r=this._timelineOptions;if(r.length){var s=e.getComponent("timeline");s&&(t=wi(r[s.getCurrentIndex()]))}return t},n.prototype.getMediaOption=function(e){var t=this._api.getWidth(),r=this._api.getHeight(),s=this._mediaList,o=this._mediaDefault,l=[],c=[];if(!s.length&&!o)return c;for(var a=0,d=s.length;a<d;a++)ERe(s[a].query,t,r)&&l.push(a);return!l.length&&o&&(l=[-1]),l.length&&!PRe(l,this._currentMediaIndices)&&(c=br(l,function(f){return wi(f===-1?o.option:s[f].option)})),this._currentMediaIndices=l,c},n}();function CRe(n,e,t){var r=[],s,o,l=n.baseOption,c=n.timeline,a=n.options,d=n.media,f=!!n.media,m=!!(a||c||l&&l.timeline);l?(o=l,o.timeline||(o.timeline=c)):((m||f)&&(n.options=n.media=null),o=n),f&&fr(d)&&ot(d,function(x){x&&x.option&&(x.query?r.push(x):s||(s=x))}),_(o),ot(a,function(x){return _(x)}),ot(r,function(x){return _(x.option)});function _(x){ot(e,function(A){A(x,t)})}return{baseOption:o,timelineOptions:a||[],mediaDefault:s,mediaList:r}}function ERe(n,e,t){var r={width:e,height:t,aspectratio:e/t},s=!0;return ot(n,function(o,l){var c=l.match(TRe);if(!(!c||!c[1]||!c[2])){var a=c[1],d=c[2].toLowerCase();IRe(r[d],o,a)||(s=!1)}}),s}function IRe(n,e,t){return t==="min"?n>=e:t==="max"?n<=e:n===e}function PRe(n,e){return n.join(",")===e.join(",")}var Bd=ot,FM=qr,hY=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function O3(n){var e=n&&n.itemStyle;if(e)for(var t=0,r=hY.length;t<r;t++){var s=hY[t],o=e.normal,l=e.emphasis;o&&o[s]&&(n[s]=n[s]||{},n[s].normal?Fi(n[s].normal,o[s]):n[s].normal=o[s],o[s]=null),l&&l[s]&&(n[s]=n[s]||{},n[s].emphasis?Fi(n[s].emphasis,l[s]):n[s].emphasis=l[s],l[s]=null)}}function $l(n,e,t){if(n&&n[e]&&(n[e].normal||n[e].emphasis)){var r=n[e].normal,s=n[e].emphasis;r&&(t?(n[e].normal=n[e].emphasis=null,ri(n[e],r)):n[e]=r),s&&(n.emphasis=n.emphasis||{},n.emphasis[e]=s,s.focus&&(n.emphasis.focus=s.focus),s.blurScope&&(n.emphasis.blurScope=s.blurScope))}}function JA(n){$l(n,"itemStyle"),$l(n,"lineStyle"),$l(n,"areaStyle"),$l(n,"label"),$l(n,"labelLine"),$l(n,"upperLabel"),$l(n,"edgeLabel")}function ma(n,e){var t=FM(n)&&n[e],r=FM(t)&&t.textStyle;if(r)for(var s=0,o=pq.length;s<o;s++){var l=pq[s];r.hasOwnProperty(l)&&(t[l]=r[l])}}function xh(n){n&&(JA(n),ma(n,"label"),n.emphasis&&ma(n.emphasis,"label"))}function RRe(n){if(FM(n)){O3(n),JA(n),ma(n,"label"),ma(n,"upperLabel"),ma(n,"edgeLabel"),n.emphasis&&(ma(n.emphasis,"label"),ma(n.emphasis,"upperLabel"),ma(n.emphasis,"edgeLabel"));var e=n.markPoint;e&&(O3(e),xh(e));var t=n.markLine;t&&(O3(t),xh(t));var r=n.markArea;r&&xh(r);var s=n.data;if(n.type==="graph"){s=s||n.nodes;var o=n.links||n.edges;if(o&&!_u(o))for(var l=0;l<o.length;l++)xh(o[l]);ot(n.categories,function(d){JA(d)})}if(s&&!_u(s))for(var l=0;l<s.length;l++)xh(s[l]);if(e=n.markPoint,e&&e.data)for(var c=e.data,l=0;l<c.length;l++)xh(c[l]);if(t=n.markLine,t&&t.data)for(var a=t.data,l=0;l<a.length;l++)fr(a[l])?(xh(a[l][0]),xh(a[l][1])):xh(a[l]);n.type==="gauge"?(ma(n,"axisLabel"),ma(n,"title"),ma(n,"detail")):n.type==="treemap"?($l(n.breadcrumb,"itemStyle"),ot(n.levels,function(d){JA(d)})):n.type==="tree"&&JA(n.leaves)}}function Am(n){return fr(n)?n:n?[n]:[]}function dY(n){return(fr(n)?n[0]:n)||{}}function LRe(n,e){Bd(Am(n.series),function(r){FM(r)&&RRe(r)});var t=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&t.push("valueAxis","categoryAxis","logAxis","timeAxis"),Bd(t,function(r){Bd(Am(n[r]),function(s){s&&(ma(s,"axisLabel"),ma(s.axisPointer,"label"))})}),Bd(Am(n.parallel),function(r){var s=r&&r.parallelAxisDefault;ma(s,"axisLabel"),ma(s&&s.axisPointer,"label")}),Bd(Am(n.calendar),function(r){$l(r,"itemStyle"),ma(r,"dayLabel"),ma(r,"monthLabel"),ma(r,"yearLabel")}),Bd(Am(n.radar),function(r){ma(r,"name"),r.name&&r.axisName==null&&(r.axisName=r.name,delete r.name),r.nameGap!=null&&r.axisNameGap==null&&(r.axisNameGap=r.nameGap,delete r.nameGap)}),Bd(Am(n.geo),function(r){FM(r)&&(xh(r),Bd(Am(r.regions),function(s){xh(s)}))}),Bd(Am(n.timeline),function(r){xh(r),$l(r,"label"),$l(r,"itemStyle"),$l(r,"controlStyle",!0);var s=r.data;fr(s)&&ot(s,function(o){qr(o)&&($l(o,"label"),$l(o,"itemStyle"))})}),Bd(Am(n.toolbox),function(r){$l(r,"iconStyle"),Bd(r.feature,function(s){$l(s,"iconStyle")})}),ma(dY(n.axisPointer),"label"),ma(dY(n.tooltip).axisPointer,"label")}function DRe(n,e){for(var t=e.split(","),r=n,s=0;s<t.length&&(r=r&&r[t[s]],r!=null);s++);return r}function BRe(n,e,t,r){for(var s=e.split(","),o=n,l,c=0;c<s.length-1;c++)l=s[c],o[l]==null&&(o[l]={}),o=o[l];o[s[c]]==null&&(o[s[c]]=t)}function fY(n){n&&ot(kRe,function(e){e[0]in n&&!(e[1]in n)&&(n[e[1]]=n[e[0]])})}var kRe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],ORe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],F3=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function vA(n){var e=n&&n.itemStyle;if(e)for(var t=0;t<F3.length;t++){var r=F3[t][1],s=F3[t][0];e[r]!=null&&(e[s]=e[r])}}function pY(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function mY(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function FRe(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function Woe(n,e){if(n)for(var t=0;t<n.length;t++)e(n[t]),n[t]&&Woe(n[t].children,e)}function $oe(n,e){LRe(n,e),n.series=va(n.series),ot(n.series,function(t){if(qr(t)){var r=t.type;if(r==="line")t.clipOverflow!=null&&(t.clip=t.clipOverflow);else if(r==="pie"||r==="gauge"){t.clockWise!=null&&(t.clockwise=t.clockWise),pY(t.label);var s=t.data;if(s&&!_u(s))for(var o=0;o<s.length;o++)pY(s[o]);t.hoverOffset!=null&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if(r==="gauge"){var l=DRe(t,"pointer.color");l!=null&&BRe(t,"itemStyle.color",l)}else if(r==="bar"){vA(t),vA(t.backgroundStyle),vA(t.emphasis);var s=t.data;if(s&&!_u(s))for(var o=0;o<s.length;o++)typeof s[o]=="object"&&(vA(s[o]),vA(s[o]&&s[o].emphasis))}else if(r==="sunburst"){var c=t.highlightPolicy;c&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=c)),mY(t),Woe(t.data,mY)}else r==="graph"||r==="sankey"?FRe(t):r==="map"&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&ri(t,t.mapLocation));t.hoverAnimation!=null&&(t.emphasis=t.emphasis||{},t.emphasis&&t.emphasis.scale==null&&(t.emphasis.scale=t.hoverAnimation)),fY(t)}}),n.dataRange&&(n.visualMap=n.dataRange),ot(ORe,function(t){var r=n[t];r&&(fr(r)||(r=[r]),ot(r,function(s){fY(s)}))})}function NRe(n){var e=oi();n.eachSeries(function(t){var r=t.get("stack");if(r){var s=e.get(r)||e.set(r,[]),o=t.getData(),l={stackResultDimension:o.getCalculationInfo("stackResultDimension"),stackedOverDimension:o.getCalculationInfo("stackedOverDimension"),stackedDimension:o.getCalculationInfo("stackedDimension"),stackedByDimension:o.getCalculationInfo("stackedByDimension"),isStackedByIndex:o.getCalculationInfo("isStackedByIndex"),data:o,seriesModel:t};if(!l.stackedDimension||!(l.isStackedByIndex||l.stackedByDimension))return;s.length&&o.setCalculationInfo("stackedOnSeries",s[s.length-1].seriesModel),s.push(l)}}),e.each(zRe)}function zRe(n){ot(n,function(e,t){var r=[],s=[NaN,NaN],o=[e.stackResultDimension,e.stackedOverDimension],l=e.data,c=e.isStackedByIndex,a=e.seriesModel.get("stackStrategy")||"samesign";l.modify(o,function(d,f,m){var _=l.get(e.stackedDimension,m);if(isNaN(_))return s;var x,A;c?A=l.getRawIndex(m):x=l.get(e.stackedByDimension,m);for(var I=NaN,E=t-1;E>=0;E--){var C=n[E];if(c||(A=C.data.rawIndexOf(C.stackedByDimension,x)),A>=0){var L=C.data.getByRawIndex(C.stackResultDimension,A);if(a==="all"||a==="positive"&&L>0||a==="negative"&&L<0||a==="samesign"&&_>=0&&L>0||a==="samesign"&&_<=0&&L<0){_=u2e(_,L),I=L;break}}}return r[0]=_,r[1]=I,r})})}var BB=function(){function n(e){this.data=e.data||(e.sourceFormat===Cp?{}:[]),this.sourceFormat=e.sourceFormat||Uoe,this.seriesLayoutBy=e.seriesLayoutBy||_p,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var r=0;r<t.length;r++){var s=t[r];s.type==null&&Voe(this,r)===bl.Must&&(s.type="ordinal")}}return n}();function WG(n){return n instanceof BB}function s5(n,e,t){t=t||qoe(n);var r=e.seriesLayoutBy,s=GRe(n,t,r,e.sourceHeader,e.dimensions),o=new BB({data:n,sourceFormat:t,seriesLayoutBy:r,dimensionsDefine:s.dimensionsDefine,startIndex:s.startIndex,dimensionsDetectedCount:s.dimensionsDetectedCount,metaRawOption:wi(e)});return o}function Xoe(n){return new BB({data:n,sourceFormat:_u(n)?v0:jh})}function URe(n){return new BB({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:wi(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function qoe(n){var e=Uoe;if(_u(n))e=v0;else if(fr(n)){n.length===0&&(e=Bc);for(var t=0,r=n.length;t<r;t++){var s=n[t];if(s!=null){if(fr(s)||_u(s)){e=Bc;break}else if(qr(s)){e=Wh;break}}}}else if(qr(n)){for(var o in n)if(og(n,o)&&Dc(n[o])){e=Cp;break}}return e}function GRe(n,e,t,r,s){var o,l;if(!n)return{dimensionsDefine:gY(s),startIndex:l,dimensionsDetectedCount:o};if(e===Bc){var c=n;r==="auto"||r==null?vY(function(d){d!=null&&d!=="-"&&(Br(d)?l==null&&(l=1):l=0)},t,c,10):l=Ds(r)?r:r?1:0,!s&&l===1&&(s=[],vY(function(d,f){s[f]=d!=null?d+"":""},t,c,1/0)),o=s?s.length:t===Yw?c.length:c[0]?c[0].length:null}else if(e===Wh)s||(s=VRe(n));else if(e===Cp)s||(s=[],ot(n,function(d,f){s.push(f)}));else if(e===jh){var a=DC(n[0]);o=fr(a)&&a.length||1}return{startIndex:l,dimensionsDefine:gY(s),dimensionsDetectedCount:o}}function VRe(n){for(var e=0,t;e<n.length&&!(t=n[e++]););if(t)return lo(t)}function gY(n){if(n){var e=oi();return br(n,function(t,r){t=qr(t)?t:{name:t};var s={name:t.name,displayName:t.displayName,type:t.type};if(s.name==null)return s;s.name+="",s.displayName==null&&(s.displayName=s.name);var o=e.get(s.name);return o?s.name+="-"+o.count++:e.set(s.name,{count:1}),s})}}function vY(n,e,t,r){if(e===Yw)for(var s=0;s<t.length&&s<r;s++)n(t[s]?t[s][0]:null,s);else for(var o=t[0]||[],s=0;s<o.length&&s<r;s++)n(o[s],s)}function Yoe(n){var e=n.sourceFormat;return e===Wh||e===Cp}var ay,ly,cy,_Y,yY,Zoe=function(){function n(e,t){var r=WG(e)?e:Xoe(e);this._source=r;var s=this._data=r.data;r.sourceFormat===v0&&(this._offset=0,this._dimSize=t,this._data=s),yY(this,s,r)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(e,t){},n.prototype.appendData=function(e){},n.prototype.clean=function(){},n.protoInitialize=function(){var e=n.prototype;e.pure=!1,e.persistent=!0}(),n.internalField=function(){var e;yY=function(l,c,a){var d=a.sourceFormat,f=a.seriesLayoutBy,m=a.startIndex,_=a.dimensionsDefine,x=_Y[$G(d,f)];if(Qn(l,x),d===v0)l.getItem=t,l.count=s,l.fillStorage=r;else{var A=Koe(d,f);l.getItem=Vs(A,null,c,m,_);var I=Joe(d,f);l.count=Vs(I,null,c,m,_)}};var t=function(l,c){l=l-this._offset,c=c||[];for(var a=this._data,d=this._dimSize,f=d*l,m=0;m<d;m++)c[m]=a[f+m];return c},r=function(l,c,a,d){for(var f=this._data,m=this._dimSize,_=0;_<m;_++){for(var x=d[_],A=x[0]==null?1/0:x[0],I=x[1]==null?-1/0:x[1],E=c-l,C=a[_],L=0;L<E;L++){var O=f[L*m+_];C[l+L]=O,O<A&&(A=O),O>I&&(I=O)}x[0]=A,x[1]=I}},s=function(){return this._data?this._data.length/this._dimSize:0};_Y=(e={},e[Bc+"_"+_p]={pure:!0,appendData:o},e[Bc+"_"+Yw]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[Wh]={pure:!0,appendData:o},e[Cp]={pure:!0,appendData:function(l){var c=this._data;ot(l,function(a,d){for(var f=c[d]||(c[d]=[]),m=0;m<(a||[]).length;m++)f.push(a[m])})}},e[jh]={appendData:o},e[v0]={persistent:!1,pure:!0,appendData:function(l){this._data=l},clean:function(){this._offset+=this.count(),this._data=null}},e);function o(l){for(var c=0;c<l.length;c++)this._data.push(l[c])}}(),n}(),xY=function(n,e,t,r){return n[r]},HRe=(ay={},ay[Bc+"_"+_p]=function(n,e,t,r){return n[r+e]},ay[Bc+"_"+Yw]=function(n,e,t,r,s){r+=e;for(var o=s||[],l=n,c=0;c<l.length;c++){var a=l[c];o[c]=a?a[r]:null}return o},ay[Wh]=xY,ay[Cp]=function(n,e,t,r,s){for(var o=s||[],l=0;l<t.length;l++){var c=t[l].name,a=n[c];o[l]=a?a[r]:null}return o},ay[jh]=xY,ay);function Koe(n,e){var t=HRe[$G(n,e)];return t}var bY=function(n,e,t){return n.length},jRe=(ly={},ly[Bc+"_"+_p]=function(n,e,t){return Math.max(0,n.length-e)},ly[Bc+"_"+Yw]=function(n,e,t){var r=n[0];return r?Math.max(0,r.length-e):0},ly[Wh]=bY,ly[Cp]=function(n,e,t){var r=t[0].name,s=n[r];return s?s.length:0},ly[jh]=bY,ly);function Joe(n,e){var t=jRe[$G(n,e)];return t}var N3=function(n,e,t){return n[e]},WRe=(cy={},cy[Bc]=N3,cy[Wh]=function(n,e,t){return n[t]},cy[Cp]=N3,cy[jh]=function(n,e,t){var r=DC(n);return r instanceof Array?r[e]:r},cy[v0]=N3,cy);function Qoe(n){var e=WRe[n];return e}function $G(n,e){return n===Bc?n+"_"+e:n}function Tw(n,e,t){if(n){var r=n.getRawDataItem(e);if(r!=null){var s=n.getStore(),o=s.getSource().sourceFormat;if(t!=null){var l=n.getDimensionIndex(t),c=s.getDimensionProperty(l);return Qoe(o)(r,l,c)}else{var a=r;return o===jh&&(a=DC(r)),a}}}}var $Re=/\{@(.+?)\}/g,XRe=function(){function n(){}return n.prototype.getDataParams=function(e,t){var r=this.getData(t),s=this.getRawValue(e,t),o=r.getRawIndex(e),l=r.getName(e),c=r.getRawDataItem(e),a=r.getItemVisual(e,"style"),d=a&&a[r.getItemVisual(e,"drawType")||"fill"],f=a&&a.stroke,m=this.mainType,_=m==="series",x=r.userOutput&&r.userOutput.get();return{componentType:m,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:_?this.subType:null,seriesIndex:this.seriesIndex,seriesId:_?this.id:null,seriesName:_?this.name:null,name:l,dataIndex:o,data:c,dataType:t,value:s,color:d,borderColor:f,dimensionNames:x?x.fullDimensions:null,encode:x?x.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(e,t,r,s,o,l){t=t||"normal";var c=this.getData(r),a=this.getDataParams(e,r);if(l&&(a.value=l.interpolatedValue),s!=null&&fr(a.value)&&(a.value=a.value[s]),!o){var d=c.getItemModel(e);o=d.get(t==="normal"?["label","formatter"]:[t,"label","formatter"])}if(hi(o))return a.status=t,a.dimensionIndex=s,o(a);if(Br(o)){var f=Foe(o,a);return f.replace($Re,function(m,_){var x=_.length,A=_;A.charAt(0)==="["&&A.charAt(x-1)==="]"&&(A=+A.slice(1,x-1));var I=Tw(c,e,A);if(l&&fr(l.interpolatedValue)){var E=c.getDimensionIndex(A);E>=0&&(I=l.interpolatedValue[E])}return I!=null?I+"":""})}},n.prototype.getRawValue=function(e,t){return Tw(this.getData(t),e)},n.prototype.formatTooltip=function(e,t,r){},n}();function wY(n){var e,t;return qr(n)?n.type&&(t=n):e=n,{text:e,frag:t}}function OT(n){return new qRe(n)}var qRe=function(){function n(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return n.prototype.perform=function(e){var t=this._upstream,r=e&&e.skip;if(this._dirty&&t){var s=this.context;s.data=s.outputData=t.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var o;this._plan&&!r&&(o=this._plan(this.context));var l=f(this._modBy),c=this._modDataCount||0,a=f(e&&e.modBy),d=e&&e.modDataCount||0;(l!==a||c!==d)&&(o="reset");function f(L){return!(L>=1)&&(L=1),L}var m;(this._dirty||o==="reset")&&(this._dirty=!1,m=this._doReset(r)),this._modBy=a,this._modDataCount=d;var _=e&&e.step;if(t?this._dueEnd=t._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var x=this._dueIndex,A=Math.min(_!=null?this._dueIndex+_:1/0,this._dueEnd);if(!r&&(m||x<A)){var I=this._progress;if(fr(I))for(var E=0;E<I.length;E++)this._doProgress(I[E],x,A,a,d);else this._doProgress(I,x,A,a,d)}this._dueIndex=A;var C=this._settedOutputEnd!=null?this._settedOutputEnd:A;this._outputDueEnd=C}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(e,t,r,s,o){SY.reset(t,r,s,o),this._callingProgress=e,this._callingProgress({start:t,end:r,count:r-t,next:SY.next},this.context)},n.prototype._doReset=function(e){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var t,r;!e&&this._reset&&(t=this._reset(this.context),t&&t.progress&&(r=t.forceFirstProgress,t=t.progress),fr(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var s=this._downstream;return s&&s.dirty(),r},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},n}(),SY=function(){var n,e,t,r,s,o={reset:function(a,d,f,m){e=a,n=d,t=f,r=m,s=Math.ceil(r/t),o.next=t>1&&r>0?c:l}};return o;function l(){return e<n?e++:null}function c(){var a=e%s*t+Math.ceil(e/s),d=e>=n?null:a<r?a:e;return e++,d}}();function RP(n,e){var t=e&&e.type;return t==="ordinal"?n:(t==="time"&&!Ds(n)&&n!=null&&n!=="-"&&(n=+ag(n)),n==null||n===""?NaN:Number(n))}var YRe=oi({number:function(n){return parseFloat(n)},time:function(n){return+ag(n)},trim:function(n){return Br(n)?cp(n):n}});function eae(n){return YRe.get(n)}var tae={lt:function(n,e){return n<e},lte:function(n,e){return n<=e},gt:function(n,e){return n>e},gte:function(n,e){return n>=e}},ZRe=function(){function n(e,t){if(!Ds(t)){var r="";us(r)}this._opFn=tae[e],this._rvalFloat=E0(t)}return n.prototype.evaluate=function(e){return Ds(e)?this._opFn(e,this._rvalFloat):this._opFn(E0(e),this._rvalFloat)},n}(),nae=function(){function n(e,t){var r=e==="desc";this._resultLT=r?1:-1,t==null&&(t=r?"min":"max"),this._incomparable=t==="min"?-1/0:1/0}return n.prototype.evaluate=function(e,t){var r=Ds(e)?e:E0(e),s=Ds(t)?t:E0(t),o=isNaN(r),l=isNaN(s);if(o&&(r=this._incomparable),l&&(s=this._incomparable),o&&l){var c=Br(e),a=Br(t);c&&(r=a?e:0),a&&(s=c?t:0)}return r<s?this._resultLT:r>s?-this._resultLT:0},n}(),KRe=function(){function n(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=E0(t)}return n.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var r=typeof e;r!==this._rvalTypeof&&(r==="number"||this._rvalTypeof==="number")&&(t=E0(e)===this._rvalFloat)}return this._isEQ?t:!t},n}();function JRe(n,e){return n==="eq"||n==="ne"?new KRe(n==="eq",e):og(tae,n)?new ZRe(n,e):null}var QRe=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(e){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(e){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(e,t){},n.prototype.retrieveValueFromItem=function(e,t){},n.prototype.convertValue=function(e,t){return RP(e,t)},n}();function eLe(n,e){var t=new QRe,r=n.data,s=t.sourceFormat=n.sourceFormat,o=n.startIndex,l="";n.seriesLayoutBy!==_p&&us(l);var c=[],a={},d=n.dimensionsDefine;if(d)ot(d,function(I,E){var C=I.name,L={index:E,name:C,displayName:I.displayName};if(c.push(L),C!=null){var O="";og(a,C)&&us(O),a[C]=L}});else for(var f=0;f<n.dimensionsDetectedCount;f++)c.push({index:f});var m=Koe(s,_p);e.__isBuiltIn&&(t.getRawDataItem=function(I){return m(r,o,c,I)},t.getRawData=Vs(tLe,null,n)),t.cloneRawData=Vs(nLe,null,n);var _=Joe(s,_p);t.count=Vs(_,null,r,o,c);var x=Qoe(s);t.retrieveValue=function(I,E){var C=m(r,o,c,I);return A(C,E)};var A=t.retrieveValueFromItem=function(I,E){if(I!=null){var C=c[E];if(C)return x(I,E,C.name)}};return t.getDimensionInfo=Vs(rLe,null,c,a),t.cloneAllDimensionInfo=Vs(iLe,null,c),t}function tLe(n){var e=n.sourceFormat;if(!XG(e)){var t="";us(t)}return n.data}function nLe(n){var e=n.sourceFormat,t=n.data;if(!XG(e)){var r="";us(r)}if(e===Bc){for(var s=[],o=0,l=t.length;o<l;o++)s.push(t[o].slice());return s}else if(e===Wh){for(var s=[],o=0,l=t.length;o<l;o++)s.push(Qn({},t[o]));return s}}function rLe(n,e,t){if(t!=null){if(Ds(t)||!isNaN(t)&&!og(e,t))return n[t];if(og(e,t))return e[t]}}function iLe(n){return wi(n)}var rae=oi();function sLe(n){n=wi(n);var e=n.type,t="";e||us(t);var r=e.split(":");r.length!==2&&us(t);var s=!1;r[0]==="echarts"&&(e=r[1],s=!0),n.__isBuiltIn=s,rae.set(e,n)}function oLe(n,e,t){var r=va(n),s=r.length,o="";s||us(o);for(var l=0,c=s;l<c;l++){var a=r[l];e=aLe(a,e),l!==c-1&&(e.length=Math.max(e.length,1))}return e}function aLe(n,e,t,r){var s="";e.length||us(s),qr(n)||us(s);var o=n.type,l=rae.get(o);l||us(s);var c=br(e,function(d){return eLe(d,l)}),a=va(l.transform({upstream:c[0],upstreamList:c,config:wi(n.config)}));return br(a,function(d,f){var m="";qr(d)||us(m),d.data||us(m);var _=qoe(d.data);XG(_)||us(m);var x,A=e[0];if(A&&f===0&&!d.dimensions){var I=A.startIndex;I&&(d.data=A.data.slice(0,I).concat(d.data)),x={seriesLayoutBy:_p,sourceHeader:I,dimensions:A.metaRawOption.dimensions}}else x={seriesLayoutBy:_p,sourceHeader:0,dimensions:d.dimensions};return s5(d.data,x,null)})}function XG(n){return n===Bc||n===Wh}var kB="undefined",lLe=typeof Uint32Array===kB?Array:Uint32Array,cLe=typeof Uint16Array===kB?Array:Uint16Array,iae=typeof Int32Array===kB?Array:Int32Array,AY=typeof Float64Array===kB?Array:Float64Array,sae={float:AY,int:iae,ordinal:Array,number:Array,time:AY},z3;function _A(n){return n>65535?lLe:cLe}function J1(){return[1/0,-1/0]}function uLe(n){var e=n.constructor;return e===Array?n.slice():new e(n)}function TY(n,e,t,r,s){var o=sae[t||"float"];if(s){var l=n[e],c=l&&l.length;if(c!==r){for(var a=new o(r),d=0;d<c;d++)a[d]=l[d];n[e]=a}}else n[e]=new o(r)}var o5=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=oi()}return n.prototype.initData=function(e,t,r){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var s=e.getSource(),o=this.defaultDimValueGetter=z3[s.sourceFormat];this._dimValueGetter=r||o,this._rawExtent=[],Yoe(s),this._dimensions=br(t,function(l){return{type:l.type,property:l.property}}),this._initDataFromProvider(0,e.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(e,t){var r=this._calcDimNameToIdx,s=this._dimensions,o=r.get(e);if(o!=null){if(s[o].type===t)return o}else o=s.length;return s[o]={type:t},r.set(e,o),this._chunks[o]=new sae[t||"float"](this._rawCount),this._rawExtent[o]=J1(),o},n.prototype.collectOrdinalMeta=function(e,t){var r=this._chunks[e],s=this._dimensions[e],o=this._rawExtent,l=s.ordinalOffset||0,c=r.length;l===0&&(o[e]=J1());for(var a=o[e],d=l;d<c;d++){var f=r[d]=t.parseAndCollect(r[d]);isNaN(f)||(a[0]=Math.min(f,a[0]),a[1]=Math.max(f,a[1]))}s.ordinalMeta=t,s.ordinalOffset=c,s.type="ordinal"},n.prototype.getOrdinalMeta=function(e){var t=this._dimensions[e],r=t.ordinalMeta;return r},n.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},n.prototype.appendData=function(e){var t=this._provider,r=this.count();t.appendData(e);var s=t.count();return t.persistent||(s+=r),r<s&&this._initDataFromProvider(r,s,!0),[r,s]},n.prototype.appendValues=function(e,t){for(var r=this._chunks,s=this._dimensions,o=s.length,l=this._rawExtent,c=this.count(),a=c+Math.max(e.length,t||0),d=0;d<o;d++){var f=s[d];TY(r,d,f.type,a,!0)}for(var m=[],_=c;_<a;_++)for(var x=_-c,A=0;A<o;A++){var f=s[A],I=z3.arrayRows.call(this,e[x]||m,f.property,x,A);r[A][_]=I;var E=l[A];I<E[0]&&(E[0]=I),I>E[1]&&(E[1]=I)}return this._rawCount=this._count=a,{start:c,end:a}},n.prototype._initDataFromProvider=function(e,t,r){for(var s=this._provider,o=this._chunks,l=this._dimensions,c=l.length,a=this._rawExtent,d=br(l,function(L){return L.property}),f=0;f<c;f++){var m=l[f];a[f]||(a[f]=J1()),TY(o,f,m.type,t,r)}if(s.fillStorage)s.fillStorage(e,t,o,a);else for(var _=[],x=e;x<t;x++){_=s.getItem(x,_);for(var A=0;A<c;A++){var I=o[A],E=this._dimValueGetter(_,d[A],x,A);I[x]=E;var C=a[A];E<C[0]&&(C[0]=E),E>C[1]&&(C[1]=E)}}!s.persistent&&s.clean&&s.clean(),this._rawCount=this._count=t,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var r=this._chunks[e];return r?r[this.getRawIndex(t)]:NaN},n.prototype.getValues=function(e,t){var r=[],s=[];if(t==null){t=e,e=[];for(var o=0;o<this._dimensions.length;o++)s.push(o)}else s=e;for(var o=0,l=s.length;o<l;o++)r.push(this.get(s[o],t));return r},n.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var r=this._chunks[e];return r?r[t]:NaN},n.prototype.getSum=function(e){var t=this._chunks[e],r=0;if(t)for(var s=0,o=this.count();s<o;s++){var l=this.get(e,s);isNaN(l)||(r+=l)}return r},n.prototype.getMedian=function(e){var t=[];this.each([e],function(o){isNaN(o)||t.push(o)});var r=t.sort(function(o,l){return o-l}),s=this.count();return s===0?0:s%2===1?r[(s-1)/2]:(r[s/2]+r[s/2-1])/2},n.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,r=t[e];if(r!=null&&r<this._count&&r===e)return e;for(var s=0,o=this._count-1;s<=o;){var l=(s+o)/2|0;if(t[l]<e)s=l+1;else if(t[l]>e)o=l-1;else return l}return-1},n.prototype.indicesOfNearest=function(e,t,r){var s=this._chunks,o=s[e],l=[];if(!o)return l;r==null&&(r=1/0);for(var c=1/0,a=-1,d=0,f=0,m=this.count();f<m;f++){var _=this.getRawIndex(f),x=t-o[_],A=Math.abs(x);A<=r&&((A<c||A===c&&x>=0&&a<0)&&(c=A,a=x,d=0),x===a&&(l[d++]=f))}return l.length=d,l},n.prototype.getIndices=function(){var e,t=this._indices;if(t){var r=t.constructor,s=this._count;if(r===Array){e=new r(s);for(var o=0;o<s;o++)e[o]=t[o]}else e=new r(t.buffer,0,s)}else{var r=_A(this._rawCount);e=new r(this.count());for(var o=0;o<e.length;o++)e[o]=o}return e},n.prototype.filter=function(e,t){if(!this._count)return this;for(var r=this.clone(),s=r.count(),o=_A(r._rawCount),l=new o(s),c=[],a=e.length,d=0,f=e[0],m=r._chunks,_=0;_<s;_++){var x=void 0,A=r.getRawIndex(_);if(a===0)x=t(_);else if(a===1){var I=m[f][A];x=t(I,_)}else{for(var E=0;E<a;E++)c[E]=m[e[E]][A];c[E]=_,x=t.apply(null,c)}x&&(l[d++]=A)}return d<s&&(r._indices=l),r._count=d,r._extent=[],r._updateGetRawIdx(),r},n.prototype.selectRange=function(e){var t=this.clone(),r=t._count;if(!r)return this;var s=lo(e),o=s.length;if(!o)return this;var l=t.count(),c=_A(t._rawCount),a=new c(l),d=0,f=s[0],m=e[f][0],_=e[f][1],x=t._chunks,A=!1;if(!t._indices){var I=0;if(o===1){for(var E=x[s[0]],C=0;C<r;C++){var L=E[C];(L>=m&&L<=_||isNaN(L))&&(a[d++]=I),I++}A=!0}else if(o===2){for(var E=x[s[0]],O=x[s[1]],H=e[s[1]][0],q=e[s[1]][1],C=0;C<r;C++){var L=E[C],Z=O[C];(L>=m&&L<=_||isNaN(L))&&(Z>=H&&Z<=q||isNaN(Z))&&(a[d++]=I),I++}A=!0}}if(!A)if(o===1)for(var C=0;C<l;C++){var J=t.getRawIndex(C),L=x[s[0]][J];(L>=m&&L<=_||isNaN(L))&&(a[d++]=J)}else for(var C=0;C<l;C++){for(var re=!0,J=t.getRawIndex(C),se=0;se<o;se++){var ae=s[se],L=x[ae][J];(L<e[ae][0]||L>e[ae][1])&&(re=!1)}re&&(a[d++]=t.getRawIndex(C))}return d<l&&(t._indices=a),t._count=d,t._extent=[],t._updateGetRawIdx(),t},n.prototype.map=function(e,t){var r=this.clone(e);return this._updateDims(r,e,t),r},n.prototype.modify=function(e,t){this._updateDims(this,e,t)},n.prototype._updateDims=function(e,t,r){for(var s=e._chunks,o=[],l=t.length,c=e.count(),a=[],d=e._rawExtent,f=0;f<t.length;f++)d[t[f]]=J1();for(var m=0;m<c;m++){for(var _=e.getRawIndex(m),x=0;x<l;x++)a[x]=s[t[x]][_];a[l]=m;var A=r&&r.apply(null,a);if(A!=null){typeof A!="object"&&(o[0]=A,A=o);for(var f=0;f<A.length;f++){var I=t[f],E=A[f],C=d[I],L=s[I];L&&(L[_]=E),E<C[0]&&(C[0]=E),E>C[1]&&(C[1]=E)}}}},n.prototype.lttbDownSample=function(e,t){var r=this.clone([e],!0),s=r._chunks,o=s[e],l=this.count(),c=0,a=Math.floor(1/t),d=this.getRawIndex(0),f,m,_,x=new(_A(this._rawCount))(Math.min((Math.ceil(l/a)+2)*2,l));x[c++]=d;for(var A=1;A<l-1;A+=a){for(var I=Math.min(A+a,l-1),E=Math.min(A+a*2,l),C=(E+I)/2,L=0,O=I;O<E;O++){var H=this.getRawIndex(O),q=o[H];isNaN(q)||(L+=q)}L/=E-I;var Z=A,J=Math.min(A+a,l),re=A-1,se=o[d];f=-1,_=Z;for(var ae=-1,he=0,O=Z;O<J;O++){var H=this.getRawIndex(O),q=o[H];if(isNaN(q)){he++,ae<0&&(ae=H);continue}m=Math.abs((re-C)*(q-se)-(re-O)*(L-se)),m>f&&(f=m,_=H)}he>0&&he<J-Z&&(x[c++]=Math.min(ae,_),_=Math.max(ae,_)),x[c++]=_,d=_}return x[c++]=this.getRawIndex(l-1),r._count=c,r._indices=x,r.getRawIndex=this._getRawIdx,r},n.prototype.downSample=function(e,t,r,s){for(var o=this.clone([e],!0),l=o._chunks,c=[],a=Math.floor(1/t),d=l[e],f=this.count(),m=o._rawExtent[e]=J1(),_=new(_A(this._rawCount))(Math.ceil(f/a)),x=0,A=0;A<f;A+=a){a>f-A&&(a=f-A,c.length=a);for(var I=0;I<a;I++){var E=this.getRawIndex(A+I);c[I]=d[E]}var C=r(c),L=this.getRawIndex(Math.min(A+s(c,C)||0,f-1));d[L]=C,C<m[0]&&(m[0]=C),C>m[1]&&(m[1]=C),_[x++]=L}return o._count=x,o._indices=_,o._updateGetRawIdx(),o},n.prototype.each=function(e,t){if(this._count)for(var r=e.length,s=this._chunks,o=0,l=this.count();o<l;o++){var c=this.getRawIndex(o);switch(r){case 0:t(o);break;case 1:t(s[e[0]][c],o);break;case 2:t(s[e[0]][c],s[e[1]][c],o);break;default:for(var a=0,d=[];a<r;a++)d[a]=s[e[a]][c];d[a]=o,t.apply(null,d)}}},n.prototype.getDataExtent=function(e){var t=this._chunks[e],r=J1();if(!t)return r;var s=this.count(),o=!this._indices,l;if(o)return this._rawExtent[e].slice();if(l=this._extent[e],l)return l.slice();l=r;for(var c=l[0],a=l[1],d=0;d<s;d++){var f=this.getRawIndex(d),m=t[f];m<c&&(c=m),m>a&&(a=m)}return l=[c,a],this._extent[e]=l,l},n.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var r=[],s=this._chunks,o=0;o<s.length;o++)r.push(s[o][t]);return r},n.prototype.clone=function(e,t){var r=new n,s=this._chunks,o=e&&T0(e,function(c,a){return c[a]=!0,c},{});if(o)for(var l=0;l<s.length;l++)r._chunks[l]=o[l]?uLe(s[l]):s[l];else r._chunks=s;return this._copyCommonProps(r),t||(r._indices=this._cloneIndices()),r._updateGetRawIdx(),r},n.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=wi(this._extent),e._rawExtent=wi(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var r=this._indices.length;t=new e(r);for(var s=0;s<r;s++)t[s]=this._indices[s]}else t=new e(this._indices);return t}return null},n.prototype._getRawIdxIdentity=function(e){return e},n.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function e(t,r,s,o){return RP(t[o],this._dimensions[o])}z3={arrayRows:e,objectRows:function(t,r,s,o){return RP(t[r],this._dimensions[o])},keyedColumns:e,original:function(t,r,s,o){var l=t&&(t.value==null?t:t.value);return RP(l instanceof Array?l[o]:l,this._dimensions[o])},typedArray:function(t,r,s,o){return t[o]}}}(),n}(),oae=function(){function n(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var e=this._sourceHost,t=this._getUpstreamSourceManagers(),r=!!t.length,s,o;if(xI(e)){var l=e,c=void 0,a=void 0,d=void 0;if(r){var f=t[0];f.prepareSource(),d=f.getSource(),c=d.data,a=d.sourceFormat,o=[f._getVersionSign()]}else c=l.get("data",!0),a=_u(c)?v0:jh,o=[];var m=this._getSourceMetaRawOption()||{},_=d&&d.metaRawOption||{},x=Li(m.seriesLayoutBy,_.seriesLayoutBy)||null,A=Li(m.sourceHeader,_.sourceHeader),I=Li(m.dimensions,_.dimensions),E=x!==_.seriesLayoutBy||!!A!=!!_.sourceHeader||I;s=E?[s5(c,{seriesLayoutBy:x,sourceHeader:A,dimensions:I},a)]:[]}else{var C=e;if(r){var L=this._applyTransform(t);s=L.sourceList,o=L.upstreamSignList}else{var O=C.get("source",!0);s=[s5(O,this._getSourceMetaRawOption(),null)],o=[]}}this._setLocalSource(s,o)},n.prototype._applyTransform=function(e){var t=this._sourceHost,r=t.get("transform",!0),s=t.get("fromTransformResult",!0);if(s!=null){var o="";e.length!==1&&CY(o)}var l,c=[],a=[];return ot(e,function(d){d.prepareSource();var f=d.getSource(s||0),m="";s!=null&&!f&&CY(m),c.push(f),a.push(d._getVersionSign())}),r?l=oLe(r,c,{datasetIndex:t.componentIndex}):s!=null&&(l=[URe(c[0])]),{sourceList:l,upstreamSignList:a}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var r=e[t];if(r._isDirty()||this._upstreamSignList[t]!==r._getVersionSign())return!0}},n.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var r=this._getUpstreamSourceManagers();return r[0]&&r[0].getSource(e)}return t},n.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},n.prototype._innerGetDataStore=function(e,t,r){var s=0,o=this._storeList,l=o[s];l||(l=o[s]={});var c=l[r];if(!c){var a=this._getUpstreamSourceManagers()[0];xI(this._sourceHost)&&a?c=a._innerGetDataStore(e,t,r):(c=new o5,c.initData(new Zoe(t,e.length),e)),l[r]=c}return c},n.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(xI(e)){var t=GG(e);return t?[t.getSourceManager()]:[]}else return br(mRe(e),function(r){return r.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var e=this._sourceHost,t,r,s;if(xI(e))t=e.get("seriesLayoutBy",!0),r=e.get("sourceHeader",!0),s=e.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var o=e;t=o.get("seriesLayoutBy",!0),r=o.get("sourceHeader",!0),s=o.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:r,dimensions:s}},n}();function MY(n){var e=n.option.transform;e&&eL(n.option.transform)}function xI(n){return n.mainType==="series"}function CY(n){throw new Error(n)}var aae="line-height:1";function lae(n,e){var t=n.color||"#6e7079",r=n.fontSize||12,s=n.fontWeight||"400",o=n.color||"#464646",l=n.fontSize||14,c=n.fontWeight||"900";return e==="html"?{nameStyle:"font-size:"+Ou(r+"")+"px;color:"+Ou(t)+";font-weight:"+Ou(s+""),valueStyle:"font-size:"+Ou(l+"")+"px;color:"+Ou(o)+";font-weight:"+Ou(c+"")}:{nameStyle:{fontSize:r,fill:t,fontWeight:s},valueStyle:{fontSize:l,fill:o,fontWeight:c}}}var hLe=[0,10,20,30],dLe=["",`
`,`

`,`


`];function NM(n,e){return e.type=n,e}function a5(n){return n.type==="section"}function cae(n){return a5(n)?fLe:pLe}function uae(n){if(a5(n)){var e=0,t=n.blocks.length,r=t>1||t>0&&!n.noHeader;return ot(n.blocks,function(s){var o=uae(s);o>=e&&(e=o+ +(r&&(!o||a5(s)&&!s.noHeader)))}),e}return 0}function fLe(n,e,t,r){var s=e.noHeader,o=mLe(uae(e)),l=[],c=e.blocks||[];wp(!c||fr(c)),c=c||[];var a=n.orderMode;if(e.sortBlocks&&a){c=c.slice();var d={valueAsc:"asc",valueDesc:"desc"};if(og(d,a)){var f=new nae(d[a],null);c.sort(function(A,I){return f.evaluate(A.sortParam,I.sortParam)})}else a==="seriesDesc"&&c.reverse()}ot(c,function(A,I){var E=e.valueFormatter,C=cae(A)(E?Qn(Qn({},n),{valueFormatter:E}):n,A,I>0?o.html:0,r);C!=null&&l.push(C)});var m=n.renderMode==="richText"?l.join(o.richText):l5(l.join(""),s?t:o.html);if(s)return m;var _=r5(e.header,"ordinal",n.useUTC),x=lae(r,n.renderMode).nameStyle;return n.renderMode==="richText"?hae(n,_,x)+o.richText+m:l5('<div style="'+x+";"+aae+';">'+Ou(_)+"</div>"+m,t)}function pLe(n,e,t,r){var s=n.renderMode,o=e.noName,l=e.noValue,c=!e.markerType,a=e.name,d=n.useUTC,f=e.valueFormatter||n.valueFormatter||function(H){return H=fr(H)?H:[H],br(H,function(q,Z){return r5(q,fr(x)?x[Z]:x,d)})};if(!(o&&l)){var m=c?"":n.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",s),_=o?"":r5(a,"ordinal",d),x=e.valueType,A=l?[]:f(e.value,e.dataIndex),I=!c||!o,E=!c&&o,C=lae(r,s),L=C.nameStyle,O=C.valueStyle;return s==="richText"?(c?"":m)+(o?"":hae(n,_,L))+(l?"":_Le(n,A,I,E,O)):l5((c?"":m)+(o?"":gLe(_,!c,L))+(l?"":vLe(A,I,E,O)),t)}}function EY(n,e,t,r,s,o){if(n){var l=cae(n),c={useUTC:s,renderMode:t,orderMode:r,markupStyleCreator:e,valueFormatter:n.valueFormatter};return l(c,n,0,o)}}function mLe(n){return{html:hLe[n],richText:dLe[n]}}function l5(n,e){var t='<div style="clear:both"></div>',r="margin: "+e+"px 0 0";return'<div style="'+r+";"+aae+';">'+n+t+"</div>"}function gLe(n,e,t){var r=e?"margin-left:2px":"";return'<span style="'+t+";"+r+'">'+Ou(n)+"</span>"}function vLe(n,e,t,r){var s=t?"10px":"20px",o=e?"float:right;margin-left:"+s:"";return n=fr(n)?n:[n],'<span style="'+o+";"+r+'">'+br(n,function(l){return Ou(l)}).join("&nbsp;&nbsp;")+"</span>"}function hae(n,e,t){return n.markupStyleCreator.wrapRichTextStyle(e,t)}function _Le(n,e,t,r,s){var o=[s],l=r?10:20;return t&&o.push({padding:[0,0,0,l],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(fr(e)?e.join("  "):e,o)}function yLe(n,e){var t=n.getData().getItemVisual(e,"style"),r=t[n.visualDrawType];return xx(r)}function dae(n,e){var t=n.get("padding");return t??(e==="richText"?[8,10]:10)}var U3=function(){function n(){this.richTextStyles={},this._nextStyleNameId=wse()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(e,t,r){var s=r==="richText"?this._generateStyleName():null,o=sRe({color:t,type:e,renderMode:r,markerId:s});return Br(o)?o:(this.richTextStyles[s]=o.style,o.content)},n.prototype.wrapRichTextStyle=function(e,t){var r={};fr(t)?ot(t,function(o){return Qn(r,o)}):Qn(r,t);var s=this._generateStyleName();return this.richTextStyles[s]=r,"{"+s+"|"+e+"}"},n}();function xLe(n){var e=n.series,t=n.dataIndex,r=n.multipleSeries,s=e.getData(),o=s.mapDimensionsAll("defaultedTooltip"),l=o.length,c=e.getRawValue(t),a=fr(c),d=yLe(e,t),f,m,_,x;if(l>1||a&&!l){var A=bLe(c,e,t,o,d);f=A.inlineValues,m=A.inlineValueTypes,_=A.blocks,x=A.inlineValues[0]}else if(l){var I=s.getDimensionInfo(o[0]);x=f=Tw(s,t,o[0]),m=I.type}else x=f=a?c[0]:c;var E=xG(e),C=E&&e.name||"",L=s.getName(t),O=r?C:L;return NM("section",{header:C,noHeader:r||!E,sortParam:x,blocks:[NM("nameValue",{markerType:"item",markerColor:d,name:O,noName:!cp(O),value:f,valueType:m,dataIndex:t})].concat(_||[])})}function bLe(n,e,t,r,s){var o=e.getData(),l=T0(n,function(m,_,x){var A=o.getDimensionInfo(x);return m=m||A&&A.tooltip!==!1&&A.displayName!=null},!1),c=[],a=[],d=[];r.length?ot(r,function(m){f(Tw(o,t,m),m)}):ot(n,f);function f(m,_){var x=o.getDimensionInfo(_);!x||x.otherDims.tooltip===!1||(l?d.push(NM("nameValue",{markerType:"subItem",markerColor:s,name:x.displayName,value:m,valueType:x.type})):(c.push(m),a.push(x.type)))}return{inlineValues:c,inlineValueTypes:a,blocks:d}}var Iv=Zs();function bI(n,e){return n.getName(e)||n.getId(e)}var LP="__universalTransitionEnabled",sf=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}return e.prototype.init=function(t,r,s){this.seriesIndex=this.componentIndex,this.dataTask=OT({count:SLe,reset:ALe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,s);var o=Iv(this).sourceManager=new oae(this);o.prepareSource();var l=this.getInitialData(t,s);PY(l,this),this.dataTask.context.data=l,Iv(this).dataBeforeProcessed=l,IY(this),this._initSelectedMapFromData(l)},e.prototype.mergeDefaultAndTheme=function(t,r){var s=OM(this),o=s?DB(t):{},l=this.subType;cs.hasClass(l)&&(l+="Series"),Fi(t,r.getTheme().get(this.subType)),Fi(t,this.getDefaultOption()),Wz(t,"label",["show"]),this.fillDataTextStyle(t.data),s&&Aw(t,o,s)},e.prototype.mergeOption=function(t,r){t=Fi(this.option,t,!0),this.fillDataTextStyle(t.data);var s=OM(this);s&&Aw(this.option,t,s);var o=Iv(this).sourceManager;o.dirty(),o.prepareSource();var l=this.getInitialData(t,r);PY(l,this),this.dataTask.dirty(),this.dataTask.context.data=l,Iv(this).dataBeforeProcessed=l,IY(this),this._initSelectedMapFromData(l)},e.prototype.fillDataTextStyle=function(t){if(t&&!_u(t))for(var r=["show"],s=0;s<t.length;s++)t[s]&&t[s].label&&Wz(t[s],"label",r)},e.prototype.getInitialData=function(t,r){},e.prototype.appendData=function(t){var r=this.getRawData();r.appendData(t.data)},e.prototype.getData=function(t){var r=c5(this);if(r){var s=r.context.data;return t==null||!s.getLinkedData?s:s.getLinkedData(t)}else return Iv(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var r=c5(this);if(r){var s=r.context;s.outputData=t,r!==this.dataTask&&(s.data=t)}Iv(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return oi(t)},e.prototype.getSourceManager=function(){return Iv(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return Iv(this).dataBeforeProcessed},e.prototype.getColorBy=function(){var t=this.get("colorBy");return t||"series"},e.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.formatTooltip=function(t,r,s){return xLe({series:this,dataIndex:t,multipleSeries:r})},e.prototype.isAnimationEnabled=function(){var t=this.ecModel;if(yi.node&&!(t&&t.ssr))return!1;var r=this.getShallow("animation");return r&&this.getData().count()>this.getShallow("animationThreshold")&&(r=!1),!!r},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,r,s){var o=this.ecModel,l=VG.prototype.getColorFromPalette.call(this,t,r,s);return l||(l=o.getColorFromPalette(t,r,s)),l},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,r){this._innerSelect(this.getData(r),t)},e.prototype.unselect=function(t,r){var s=this.option.selectedMap;if(s){var o=this.option.selectedMode,l=this.getData(r);if(o==="series"||s==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var c=0;c<t.length;c++){var a=t[c],d=bI(l,a);s[d]=!1,this._selectedDataIndicesMap[d]=-1}}},e.prototype.toggleSelect=function(t,r){for(var s=[],o=0;o<t.length;o++)s[0]=t[o],this.isSelected(t[o],r)?this.unselect(s,r):this.select(s,r)},e.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var t=this._selectedDataIndicesMap,r=lo(t),s=[],o=0;o<r.length;o++){var l=t[r[o]];l>=0&&s.push(l)}return s},e.prototype.isSelected=function(t,r){var s=this.option.selectedMap;if(!s)return!1;var o=this.getData(r);return(s==="all"||s[bI(o,t)])&&!o.getItemModel(t).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this[LP])return!0;var t=this.option.universalTransition;return t?t===!0?!0:t&&t.enabled:!1},e.prototype._innerSelect=function(t,r){var s,o,l=this.option,c=l.selectedMode,a=r.length;if(!(!c||!a)){if(c==="series")l.selectedMap="all";else if(c==="multiple"){qr(l.selectedMap)||(l.selectedMap={});for(var d=l.selectedMap,f=0;f<a;f++){var m=r[f],_=bI(t,m);d[_]=!0,this._selectedDataIndicesMap[_]=t.getRawIndex(m)}}else if(c==="single"||c===!0){var x=r[a-1],_=bI(t,x);l.selectedMap=(s={},s[_]=!0,s),this._selectedDataIndicesMap=(o={},o[_]=t.getRawIndex(x),o)}}},e.prototype._initSelectedMapFromData=function(t){if(!this.option.selectedMap){var r=[];t.hasItemOption&&t.each(function(s){var o=t.getRawDataItem(s);o&&o.selected&&r.push(s)}),r.length>0&&this._innerSelect(t,r)}},e.registerClass=function(t){return cs.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(cs);df(sf,XRe);df(sf,VG);Pse(sf,cs);function IY(n){var e=n.name;xG(n)||(n.name=wLe(n)||e)}function wLe(n){var e=n.getRawData(),t=e.mapDimensionsAll("seriesName"),r=[];return ot(t,function(s){var o=e.getDimensionInfo(s);o.displayName&&r.push(o.displayName)}),r.join(" ")}function SLe(n){return n.model.getRawData().count()}function ALe(n){var e=n.model;return e.setData(e.getRawData().cloneShallow()),TLe}function TLe(n,e){e.outputData&&n.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function PY(n,e){ot(XCe(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(t){n.wrapMethod(t,xs(MLe,e))})}function MLe(n,e){var t=c5(n);return t&&t.setOutputEnd((e||this).count()),e}function c5(n){var e=(n.ecModel||{}).scheduler,t=e&&e.getPipeline(n.uid);if(t){var r=t.currentTask;if(r){var s=r.agentStubMap;s&&(r=s.get(n.uid))}return r}}var kc=function(){function n(){this.group=new _a,this.uid=FC("viewComponent")}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,s){},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,s){},n.prototype.updateLayout=function(e,t,r,s){},n.prototype.updateVisual=function(e,t,r,s){},n.prototype.toggleBlurSeries=function(e,t,r){},n.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},n}();wG(kc);dB(kc);function qG(){var n=Zs();return function(e){var t=n(e),r=e.pipelineContext,s=!!t.large,o=!!t.progressiveRender,l=t.large=!!(r&&r.large),c=t.progressiveRender=!!(r&&r.progressiveRender);return(s!==l||o!==c)&&"reset"}}var fae=Zs(),CLe=qG(),Oh=function(){function n(){this.group=new _a,this.uid=FC("viewChart"),this.renderTask=OT({plan:ELe,reset:ILe}),this.renderTask.context={view:this}}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,s){},n.prototype.highlight=function(e,t,r,s){var o=e.getData(s&&s.dataType);o&&LY(o,s,"emphasis")},n.prototype.downplay=function(e,t,r,s){var o=e.getData(s&&s.dataType);o&&LY(o,s,"normal")},n.prototype.remove=function(e,t){this.group.removeAll()},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,s){this.render(e,t,r,s)},n.prototype.updateLayout=function(e,t,r,s){this.render(e,t,r,s)},n.prototype.updateVisual=function(e,t,r,s){this.render(e,t,r,s)},n.prototype.eachRendered=function(e){TB(this.group,e)},n.markUpdateMethod=function(e,t){fae(e).updateMethod=t},n.protoInitialize=function(){var e=n.prototype;e.type="chart"}(),n}();function RY(n,e,t){n&&Jz(n)&&(e==="emphasis"?ww:Sw)(n,t)}function LY(n,e,t){var r=yx(n,e),s=e&&e.highlightKey!=null?$Ie(e.highlightKey):null;r!=null?ot(va(r),function(o){RY(n.getItemGraphicEl(o),t,s)}):n.eachItemGraphicEl(function(o){RY(o,t,s)})}wG(Oh);dB(Oh);function ELe(n){return CLe(n.model)}function ILe(n){var e=n.model,t=n.ecModel,r=n.api,s=n.payload,o=e.pipelineContext.progressiveRender,l=n.view,c=s&&fae(s).updateMethod,a=o?"incrementalPrepareRender":c&&l[c]?c:"render";return a!=="render"&&l[a](e,t,r,s),PLe[a]}var PLe={incrementalPrepareRender:{progress:function(n,e){e.view.incrementalRender(n,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(n,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},yL="\0__throttleOriginMethod",DY="\0__throttleRate",BY="\0__throttleType";function YG(n,e,t){var r,s=0,o=0,l=null,c,a,d,f;e=e||0;function m(){o=new Date().getTime(),l=null,n.apply(a,d||[])}var _=function(){for(var x=[],A=0;A<arguments.length;A++)x[A]=arguments[A];r=new Date().getTime(),a=this,d=x;var I=f||e,E=f||t;f=null,c=r-(E?s:o)-I,clearTimeout(l),E?l=setTimeout(m,I):c>=0?m():l=setTimeout(m,-c),s=r};return _.clear=function(){l&&(clearTimeout(l),l=null)},_.debounceNextCall=function(x){f=x},_}function pae(n,e,t,r){var s=n[e];if(s){var o=s[yL]||s,l=s[BY],c=s[DY];if(c!==t||l!==r){if(t==null||!r)return n[e]=o;s=n[e]=YG(o,t,r==="debounce"),s[yL]=o,s[BY]=r,s[DY]=t}return s}}function u5(n,e){var t=n[e];t&&t[yL]&&(t.clear&&t.clear(),n[e]=t[yL])}var kY=Zs(),OY={itemStyle:LM(Soe,!0),lineStyle:LM(woe,!0)},RLe={lineStyle:"stroke",itemStyle:"fill"};function mae(n,e){var t=n.visualStyleMapper||OY[e];return t||(console.warn("Unknown style type '"+e+"'."),OY.itemStyle)}function gae(n,e){var t=n.visualDrawType||RLe[e];return t||(console.warn("Unknown style type '"+e+"'."),"fill")}var LLe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",s=n.getModel(r),o=mae(n,r),l=o(s),c=s.getShallow("decal");c&&(t.setVisual("decal",c),c.dirty=!0);var a=gae(n,r),d=l[a],f=hi(d)?d:null,m=l.fill==="auto"||l.stroke==="auto";if(!l[a]||f||m){var _=n.getColorFromPalette(n.name,null,e.getSeriesCount());l[a]||(l[a]=_,t.setVisual("colorFromPalette",!0)),l.fill=l.fill==="auto"||hi(l.fill)?_:l.fill,l.stroke=l.stroke==="auto"||hi(l.stroke)?_:l.stroke}if(t.setVisual("style",l),t.setVisual("drawType",a),!e.isSeriesFiltered(n)&&f)return t.setVisual("colorFromPalette",!1),{dataEach:function(x,A){var I=n.getDataParams(A),E=Qn({},l);E[a]=f(I),x.setItemVisual(A,"style",E)}}}},yA=new Do,DLe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!(n.ignoreStyleOnData||e.isSeriesFiltered(n))){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",s=mae(n,r),o=t.getVisual("drawType");return{dataEach:t.hasItemOption?function(l,c){var a=l.getRawDataItem(c);if(a&&a[r]){yA.option=a[r];var d=s(yA),f=l.ensureUniqueItemVisual(c,"style");Qn(f,d),yA.option.decal&&(l.setItemVisual(c,"decal",yA.option.decal),yA.option.decal.dirty=!0),o in d&&l.setItemVisual(c,"colorFromPalette",!1)}}:null}}}},BLe={performRawSeries:!0,overallReset:function(n){var e=oi();n.eachSeries(function(t){var r=t.getColorBy();if(!t.isColorBySeries()){var s=t.type+"-"+r,o=e.get(s);o||(o={},e.set(s,o)),kY(t).scope=o}}),n.eachSeries(function(t){if(!(t.isColorBySeries()||n.isSeriesFiltered(t))){var r=t.getRawData(),s={},o=t.getData(),l=kY(t).scope,c=t.visualStyleAccessPath||"itemStyle",a=gae(t,c);o.each(function(d){var f=o.getRawIndex(d);s[f]=d}),r.each(function(d){var f=s[d],m=o.getItemVisual(f,"colorFromPalette");if(m){var _=o.ensureUniqueItemVisual(f,"style"),x=r.getName(d)||d+"",A=r.count();_[a]=t.getColorFromPalette(x,l,A)}})}})}},wI=Math.PI;function kLe(n,e){e=e||{},ri(e,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var t=new _a,r=new $o({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});t.add(r);var s=new Ra({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),o=new $o({style:{fill:"none"},textContent:s,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});t.add(o);var l;return e.showSpinner&&(l=new xB({shape:{startAngle:-wI/2,endAngle:-wI/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001}),l.animateShape(!0).when(1e3,{endAngle:wI*3/2}).start("circularInOut"),l.animateShape(!0).when(1e3,{startAngle:wI*3/2}).delay(300).start("circularInOut"),t.add(l)),t.resize=function(){var c=s.getBoundingRect().width,a=e.showSpinner?e.spinnerRadius:0,d=(n.getWidth()-a*2-(e.showSpinner&&c?10:0)-c)/2-(e.showSpinner&&c?0:5+c/2)+(e.showSpinner?0:c/2)+(c?0:a),f=n.getHeight()/2;e.showSpinner&&l.setShape({cx:d,cy:f}),o.setShape({x:d-a,y:f-a,width:a*2,height:a*2}),r.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},t.resize(),t}var vae=function(){function n(e,t,r,s){this._stageTaskMap=oi(),this.ecInstance=e,this.api=t,r=this._dataProcessorHandlers=r.slice(),s=this._visualHandlers=s.slice(),this._allHandlers=r.concat(s)}return n.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(r){var s=r.overallTask;s&&s.dirty()})},n.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var r=this._pipelineMap.get(e.__pipeline.id),s=r.context,o=!t&&r.progressiveEnabled&&(!s||s.progressiveRender)&&e.__idxInPipeline>r.blockIndex,l=o?r.step:null,c=s&&s.modDataCount,a=c!=null?Math.ceil(c/l):null;return{step:l,modBy:a,modDataCount:c}}},n.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},n.prototype.updateStreamModes=function(e,t){var r=this._pipelineMap.get(e.uid),s=e.getData(),o=s.count(),l=r.progressiveEnabled&&t.incrementalPrepareRender&&o>=r.threshold,c=e.get("large")&&o>=e.get("largeThreshold"),a=e.get("progressiveChunkMode")==="mod"?o:null;e.pipelineContext=r.context={progressiveRender:l,modDataCount:a,large:c}},n.prototype.restorePipelines=function(e){var t=this,r=t._pipelineMap=oi();e.eachSeries(function(s){var o=s.getProgressive(),l=s.uid;r.set(l,{id:l,head:null,tail:null,threshold:s.getProgressiveThreshold(),progressiveEnabled:o&&!(s.preventIncremental&&s.preventIncremental()),blockIndex:-1,step:Math.round(o||700),count:0}),t._pipe(s,s.dataTask)})},n.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),r=this.api;ot(this._allHandlers,function(s){var o=e.get(s.uid)||e.set(s.uid,{}),l="";wp(!(s.reset&&s.overallReset),l),s.reset&&this._createSeriesStageTask(s,o,t,r),s.overallReset&&this._createOverallStageTask(s,o,t,r)},this)},n.prototype.prepareView=function(e,t,r,s){var o=e.renderTask,l=o.context;l.model=t,l.ecModel=r,l.api=s,o.__block=!e.incrementalPrepareRender,this._pipe(t,o)},n.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},n.prototype.performVisualTasks=function(e,t,r){this._performStageTasks(this._visualHandlers,e,t,r)},n.prototype._performStageTasks=function(e,t,r,s){s=s||{};var o=!1,l=this;ot(e,function(a,d){if(!(s.visualType&&s.visualType!==a.visualType)){var f=l._stageTaskMap.get(a.uid),m=f.seriesTaskMap,_=f.overallTask;if(_){var x,A=_.agentStubMap;A.each(function(E){c(s,E)&&(E.dirty(),x=!0)}),x&&_.dirty(),l.updatePayload(_,r);var I=l.getPerformArgs(_,s.block);A.each(function(E){E.perform(I)}),_.perform(I)&&(o=!0)}else m&&m.each(function(E,C){c(s,E)&&E.dirty();var L=l.getPerformArgs(E,s.block);L.skip=!a.performRawSeries&&t.isSeriesFiltered(E.context.model),l.updatePayload(E,r),E.perform(L)&&(o=!0)})}});function c(a,d){return a.setDirty&&(!a.dirtyMap||a.dirtyMap.get(d.__pipeline.id))}this.unfinished=o||this.unfinished},n.prototype.performSeriesTasks=function(e){var t;e.eachSeries(function(r){t=r.dataTask.perform()||t}),this.unfinished=t||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})},n.prototype.updatePayload=function(e,t){t!=="remain"&&(e.context.payload=t)},n.prototype._createSeriesStageTask=function(e,t,r,s){var o=this,l=t.seriesTaskMap,c=t.seriesTaskMap=oi(),a=e.seriesType,d=e.getTargetSeries;e.createOnAllSeries?r.eachRawSeries(f):a?r.eachRawSeriesByType(a,f):d&&d(r,s).each(f);function f(m){var _=m.uid,x=c.set(_,l&&l.get(_)||OT({plan:ULe,reset:GLe,count:HLe}));x.context={model:m,ecModel:r,api:s,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:o},o._pipe(m,x)}},n.prototype._createOverallStageTask=function(e,t,r,s){var o=this,l=t.overallTask=t.overallTask||OT({reset:OLe});l.context={ecModel:r,api:s,overallReset:e.overallReset,scheduler:o};var c=l.agentStubMap,a=l.agentStubMap=oi(),d=e.seriesType,f=e.getTargetSeries,m=!0,_=!1,x="";wp(!e.createOnAllSeries,x),d?r.eachRawSeriesByType(d,A):f?f(r,s).each(A):(m=!1,ot(r.getSeries(),A));function A(I){var E=I.uid,C=a.set(E,c&&c.get(E)||(_=!0,OT({reset:FLe,onDirty:zLe})));C.context={model:I,overallProgress:m},C.agent=l,C.__block=m,o._pipe(I,C)}_&&l.dirty()},n.prototype._pipe=function(e,t){var r=e.uid,s=this._pipelineMap.get(r);!s.head&&(s.head=t),s.tail&&s.tail.pipe(t),s.tail=t,t.__idxInPipeline=s.count++,t.__pipeline=s},n.wrapStageHandler=function(e,t){return hi(e)&&(e={overallReset:e,seriesType:jLe(e)}),e.uid=FC("stageHandler"),t&&(e.visualType=t),e},n}();function OLe(n){n.overallReset(n.ecModel,n.api,n.payload)}function FLe(n){return n.overallProgress&&NLe}function NLe(){this.agent.dirty(),this.getDownstream().dirty()}function zLe(){this.agent&&this.agent.dirty()}function ULe(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function GLe(n){n.useClearVisual&&n.data.clearAllVisual();var e=n.resetDefines=va(n.reset(n.model,n.ecModel,n.api,n.payload));return e.length>1?br(e,function(t,r){return _ae(r)}):VLe}var VLe=_ae(0);function _ae(n){return function(e,t){var r=t.data,s=t.resetDefines[n];if(s&&s.dataEach)for(var o=e.start;o<e.end;o++)s.dataEach(r,o);else s&&s.progress&&s.progress(e,r)}}function HLe(n){return n.data.count()}function jLe(n){xL=null;try{n(zM,yae)}catch{}return xL}var zM={},yae={},xL;xae(zM,HG);xae(yae,joe);zM.eachSeriesByType=zM.eachRawSeriesByType=function(n){xL=n};zM.eachComponent=function(n){n.mainType==="series"&&n.subType&&(xL=n.subType)};function xae(n,e){for(var t in e.prototype)n[t]=Lc}var FY=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const WLe={color:FY,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],FY]};var bc="#B9B8CE",NY="#100C2A",SI=function(){return{axisLine:{lineStyle:{color:bc}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},zY=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],bae={darkMode:!0,color:zY,backgroundColor:NY,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:bc}},textStyle:{color:bc},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:bc}},dataZoom:{borderColor:"#71708A",textStyle:{color:bc},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:bc}},timeline:{lineStyle:{color:bc},label:{color:bc},controlStyle:{color:bc,borderColor:bc}},calendar:{itemStyle:{color:NY},dayLabel:{color:bc},monthLabel:{color:bc},yearLabel:{color:bc}},timeAxis:SI(),logAxis:SI(),valueAxis:SI(),categoryAxis:SI(),line:{symbol:"circle"},graph:{color:zY},gauge:{title:{color:bc},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:bc},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};bae.categoryAxis.splitLine.show=!1;var $Le=function(){function n(){}return n.prototype.normalizeQuery=function(e){var t={},r={},s={};if(Br(e)){var o=up(e);t.mainType=o.main||null,t.subType=o.sub||null}else{var l=["Index","Name","Id"],c={name:1,dataIndex:1,dataType:1};ot(e,function(a,d){for(var f=!1,m=0;m<l.length;m++){var _=l[m],x=d.lastIndexOf(_);if(x>0&&x===d.length-_.length){var A=d.slice(0,x);A!=="data"&&(t.mainType=A,t[_.toLowerCase()]=a,f=!0)}}c.hasOwnProperty(d)&&(r[d]=a,f=!0),f||(s[d]=a)})}return{cptQuery:t,dataQuery:r,otherQuery:s}},n.prototype.filter=function(e,t){var r=this.eventInfo;if(!r)return!0;var s=r.targetEl,o=r.packedEvent,l=r.model,c=r.view;if(!l||!c)return!0;var a=t.cptQuery,d=t.dataQuery;return f(a,l,"mainType")&&f(a,l,"subType")&&f(a,l,"index","componentIndex")&&f(a,l,"name")&&f(a,l,"id")&&f(d,o,"name")&&f(d,o,"dataIndex")&&f(d,o,"dataType")&&(!c.filterForExposedEvent||c.filterForExposedEvent(e,t.otherQuery,s,o));function f(m,_,x,A){return m[x]==null||_[A||x]===m[x]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),h5=["symbol","symbolSize","symbolRotate","symbolOffset"],UY=h5.concat(["symbolKeepAspect"]),XLe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData();if(n.legendIcon&&t.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var r={},s={},o=!1,l=0;l<h5.length;l++){var c=h5[l],a=n.get(c);hi(a)?(o=!0,s[c]=a):r[c]=a}if(r.symbol=r.symbol||n.defaultSymbol,t.setVisual(Qn({legendIcon:n.legendIcon||r.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},r)),e.isSeriesFiltered(n))return;var d=lo(s);function f(m,_){for(var x=n.getRawValue(_),A=n.getDataParams(_),I=0;I<d.length;I++){var E=d[I];m.setItemVisual(_,E,s[E](x,A))}}return{dataEach:o?f:null}}},qLe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!n.hasSymbolVisual||e.isSeriesFiltered(n))return;var t=n.getData();function r(s,o){for(var l=s.getItemModel(o),c=0;c<UY.length;c++){var a=UY[c],d=l.getShallow(a,!0);d!=null&&s.setItemVisual(o,a,d)}}return{dataEach:t.hasItemOption?r:null}}};function YLe(n,e,t){switch(t){case"color":var r=n.getItemVisual(e,"style");return r[n.getVisual("drawType")];case"opacity":return n.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(e,t)}}function ZLe(n,e){switch(e){case"color":var t=n.getVisual("style");return t[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(e)}}function KLe(n,e){function t(r,s){var o=[];return r.eachComponent({mainType:"series",subType:n,query:s},function(l){o.push(l.seriesIndex)}),o}ot([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(r){e(r[0],function(s,o,l){s=Qn({},s),l.dispatchAction(Qn(s,{type:r[1],seriesIndex:t(o,s)}))})})}function Q1(n,e,t,r,s){var o=n+e;t.isSilent(o)||r.eachComponent({mainType:"series",subType:"pie"},function(l){for(var c=l.seriesIndex,a=l.option.selectedMap,d=s.selected,f=0;f<d.length;f++)if(d[f].seriesIndex===c){var m=l.getData(),_=yx(m,s.fromActionPayload);t.trigger(o,{type:o,seriesId:l.id,name:fr(_)?m.getName(_[0]):m.getName(_),selected:Br(a)?a:Qn({},a)})}})}function JLe(n,e,t){n.on("selectchanged",function(r){var s=t.getModel();r.isFromClick?(Q1("map","selectchanged",e,s,r),Q1("pie","selectchanged",e,s,r)):r.fromAction==="select"?(Q1("map","selected",e,s,r),Q1("pie","selected",e,s,r)):r.fromAction==="unselect"&&(Q1("map","unselected",e,s,r),Q1("pie","unselected",e,s,r))})}function QA(n,e,t){for(var r;n&&!(e(n)&&(r=n,t));)n=n.__hostTarget||n.parent;return r}var QLe=Math.round(Math.random()*9),eDe=typeof Object.defineProperty=="function",tDe=function(){function n(){this._id="__ec_inner_"+QLe++}return n.prototype.get=function(e){return this._guard(e)[this._id]},n.prototype.set=function(e,t){var r=this._guard(e);return eDe?Object.defineProperty(r,this._id,{value:t,enumerable:!1,configurable:!0}):r[this._id]=t,this},n.prototype.delete=function(e){return this.has(e)?(delete this._guard(e)[this._id],!0):!1},n.prototype.has=function(e){return!!this._guard(e)[this._id]},n.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},n}(),nDe=Ki.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,s=e.width/2,o=e.height/2;n.moveTo(t,r-o),n.lineTo(t+s,r+o),n.lineTo(t-s,r+o),n.closePath()}}),rDe=Ki.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,s=e.width/2,o=e.height/2;n.moveTo(t,r-o),n.lineTo(t+s,r),n.lineTo(t,r+o),n.lineTo(t-s,r),n.closePath()}}),iDe=Ki.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.x,r=e.y,s=e.width/5*3,o=Math.max(s,e.height),l=s/2,c=l*l/(o-l),a=r-o+l+c,d=Math.asin(c/l),f=Math.cos(d)*l,m=Math.sin(d),_=Math.cos(d),x=l*.6,A=l*.7;n.moveTo(t-f,a+c),n.arc(t,a,l,Math.PI-d,Math.PI*2+d),n.bezierCurveTo(t+f-m*x,a+c+_*x,t,r-A,t,r),n.bezierCurveTo(t,r-A,t-f+m*x,a+c+_*x,t-f,a+c),n.closePath()}}),sDe=Ki.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.height,r=e.width,s=e.x,o=e.y,l=r/3*2;n.moveTo(s,o),n.lineTo(s+l,o+t),n.lineTo(s,o+t/4*3),n.lineTo(s-l,o+t),n.lineTo(s,o),n.closePath()}}),oDe={line:qd,rect:$o,roundRect:$o,square:$o,circle:_B,diamond:rDe,pin:iDe,arrow:sDe,triangle:nDe},aDe={line:function(n,e,t,r,s){s.x1=n,s.y1=e+r/2,s.x2=n+t,s.y2=e+r/2},rect:function(n,e,t,r,s){s.x=n,s.y=e,s.width=t,s.height=r},roundRect:function(n,e,t,r,s){s.x=n,s.y=e,s.width=t,s.height=r,s.r=Math.min(t,r)/4},square:function(n,e,t,r,s){var o=Math.min(t,r);s.x=n,s.y=e,s.width=o,s.height=o},circle:function(n,e,t,r,s){s.cx=n+t/2,s.cy=e+r/2,s.r=Math.min(t,r)/2},diamond:function(n,e,t,r,s){s.cx=n+t/2,s.cy=e+r/2,s.width=t,s.height=r},pin:function(n,e,t,r,s){s.x=n+t/2,s.y=e+r/2,s.width=t,s.height=r},arrow:function(n,e,t,r,s){s.x=n+t/2,s.y=e+r/2,s.width=t,s.height=r},triangle:function(n,e,t,r,s){s.cx=n+t/2,s.cy=e+r/2,s.width=t,s.height=r}},d5={};ot(oDe,function(n,e){d5[e]=new n});var lDe=Ki.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,e,t){var r=lL(n,e,t),s=this.shape;return s&&s.symbolType==="pin"&&e.position==="inside"&&(r.y=t.y+t.height*.4),r},buildPath:function(n,e,t){var r=e.symbolType;if(r!=="none"){var s=d5[r];s||(r="rect",s=d5[r]),aDe[r](e.x,e.y,e.width,e.height,s.shape),s.buildPath(n,s.shape,t)}}});function cDe(n,e){if(this.type!=="image"){var t=this.style;this.__isEmptyBrush?(t.stroke=n,t.fill=e||"#fff",t.lineWidth=2):this.shape.symbolType==="line"?t.stroke=n:t.fill=n,this.markRedraw()}}function Mw(n,e,t,r,s,o,l){var c=n.indexOf("empty")===0;c&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var a;return n.indexOf("image://")===0?a=poe(n.slice(8),new ds(e,t,r,s),l?"center":"cover"):n.indexOf("path://")===0?a=RG(n.slice(7),{},new ds(e,t,r,s),l?"center":"cover"):a=new lDe({shape:{symbolType:n,x:e,y:t,width:r,height:s}}),a.__isEmptyBrush=c,a.setColor=cDe,o&&a.setColor(o),a}function uDe(n){return fr(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function wae(n,e){if(n!=null)return fr(n)||(n=[n,n]),[hs(n[0],e[0])||0,hs(Li(n[1],n[0]),e[1])||0]}function Uy(n){return isFinite(n)}function hDe(n,e,t){var r=e.x==null?0:e.x,s=e.x2==null?1:e.x2,o=e.y==null?0:e.y,l=e.y2==null?0:e.y2;e.global||(r=r*t.width+t.x,s=s*t.width+t.x,o=o*t.height+t.y,l=l*t.height+t.y),r=Uy(r)?r:0,s=Uy(s)?s:1,o=Uy(o)?o:0,l=Uy(l)?l:0;var c=n.createLinearGradient(r,o,s,l);return c}function dDe(n,e,t){var r=t.width,s=t.height,o=Math.min(r,s),l=e.x==null?.5:e.x,c=e.y==null?.5:e.y,a=e.r==null?.5:e.r;e.global||(l=l*r+t.x,c=c*s+t.y,a=a*o),l=Uy(l)?l:.5,c=Uy(c)?c:.5,a=a>=0&&Uy(a)?a:.5;var d=n.createRadialGradient(l,c,0,l,c,a);return d}function f5(n,e,t){for(var r=e.type==="radial"?dDe(n,e,t):hDe(n,e,t),s=e.colorStops,o=0;o<s.length;o++)r.addColorStop(s[o].offset,s[o].color);return r}function fDe(n,e){if(n===e||!n&&!e)return!1;if(!n||!e||n.length!==e.length)return!0;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!0;return!1}function AI(n){return parseInt(n,10)}function TI(n,e,t){var r=["width","height"][e],s=["clientWidth","clientHeight"][e],o=["paddingLeft","paddingTop"][e],l=["paddingRight","paddingBottom"][e];if(t[r]!=null&&t[r]!=="auto")return parseFloat(t[r]);var c=document.defaultView.getComputedStyle(n);return(n[s]||AI(c[r])||AI(n.style[r]))-(AI(c[o])||0)-(AI(c[l])||0)|0}function pDe(n,e){return!n||n==="solid"||!(e>0)?null:n==="dashed"?[4*e,2*e]:n==="dotted"?[e]:Ds(n)?[n]:fr(n)?n:null}function Sae(n){var e=n.style,t=e.lineDash&&e.lineWidth>0&&pDe(e.lineDash,e.lineWidth),r=e.lineDashOffset;if(t){var s=e.strokeNoScale&&n.getLineScale?n.getLineScale():1;s&&s!==1&&(t=br(t,function(o){return o/s}),r/=s)}return[t,r]}var mDe=new lg(!0);function bL(n){var e=n.stroke;return!(e==null||e==="none"||!(n.lineWidth>0))}function GY(n){return typeof n=="string"&&n!=="none"}function wL(n){var e=n.fill;return e!=null&&e!=="none"}function VY(n,e){if(e.fillOpacity!=null&&e.fillOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.fillOpacity*e.opacity,n.fill(),n.globalAlpha=t}else n.fill()}function HY(n,e){if(e.strokeOpacity!=null&&e.strokeOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.strokeOpacity*e.opacity,n.stroke(),n.globalAlpha=t}else n.stroke()}function p5(n,e,t){var r=Rse(e.image,e.__image,t);if(fB(r)){var s=n.createPattern(r,e.repeat||"repeat");if(typeof DOMMatrix=="function"&&s&&s.setTransform){var o=new DOMMatrix;o.translateSelf(e.x||0,e.y||0),o.rotateSelf(0,0,(e.rotation||0)*qCe),o.scaleSelf(e.scaleX||1,e.scaleY||1),s.setTransform(o)}return s}}function gDe(n,e,t,r){var s,o=bL(t),l=wL(t),c=t.strokePercent,a=c<1,d=!e.path;(!e.silent||a)&&d&&e.createPathProxy();var f=e.path||mDe,m=e.__dirty;if(!r){var _=t.fill,x=t.stroke,A=l&&!!_.colorStops,I=o&&!!x.colorStops,E=l&&!!_.image,C=o&&!!x.image,L=void 0,O=void 0,H=void 0,q=void 0,Z=void 0;(A||I)&&(Z=e.getBoundingRect()),A&&(L=m?f5(n,_,Z):e.__canvasFillGradient,e.__canvasFillGradient=L),I&&(O=m?f5(n,x,Z):e.__canvasStrokeGradient,e.__canvasStrokeGradient=O),E&&(H=m||!e.__canvasFillPattern?p5(n,_,e):e.__canvasFillPattern,e.__canvasFillPattern=H),C&&(q=m||!e.__canvasStrokePattern?p5(n,x,e):e.__canvasStrokePattern,e.__canvasStrokePattern=H),A?n.fillStyle=L:E&&(H?n.fillStyle=H:l=!1),I?n.strokeStyle=O:C&&(q?n.strokeStyle=q:o=!1)}var J=e.getGlobalScale();f.setScale(J[0],J[1],e.segmentIgnoreThreshold);var re,se;n.setLineDash&&t.lineDash&&(s=Sae(e),re=s[0],se=s[1]);var ae=!0;(d||m&pb)&&(f.setDPR(n.dpr),a?f.setContext(null):(f.setContext(n),ae=!1),f.reset(),e.buildPath(f,e.shape,r),f.toStatic(),e.pathUpdated()),ae&&f.rebuildPath(n,a?c:1),re&&(n.setLineDash(re),n.lineDashOffset=se),r||(t.strokeFirst?(o&&HY(n,t),l&&VY(n,t)):(l&&VY(n,t),o&&HY(n,t))),re&&n.setLineDash([])}function vDe(n,e,t){var r=e.__image=Rse(t.image,e.__image,e,e.onload);if(!(!r||!fB(r))){var s=t.x||0,o=t.y||0,l=e.getWidth(),c=e.getHeight(),a=r.width/r.height;if(l==null&&c!=null?l=c*a:c==null&&l!=null?c=l/a:l==null&&c==null&&(l=r.width,c=r.height),t.sWidth&&t.sHeight){var d=t.sx||0,f=t.sy||0;n.drawImage(r,d,f,t.sWidth,t.sHeight,s,o,l,c)}else if(t.sx&&t.sy){var d=t.sx,f=t.sy,m=l-d,_=c-f;n.drawImage(r,d,f,m,_,s,o,l,c)}else n.drawImage(r,s,o,l,c)}}function _De(n,e,t){var r,s=t.text;if(s!=null&&(s+=""),s){n.font=t.font||_x,n.textAlign=t.textAlign,n.textBaseline=t.textBaseline;var o=void 0,l=void 0;n.setLineDash&&t.lineDash&&(r=Sae(e),o=r[0],l=r[1]),o&&(n.setLineDash(o),n.lineDashOffset=l),t.strokeFirst?(bL(t)&&n.strokeText(s,t.x,t.y),wL(t)&&n.fillText(s,t.x,t.y)):(wL(t)&&n.fillText(s,t.x,t.y),bL(t)&&n.strokeText(s,t.x,t.y)),o&&n.setLineDash([])}}var jY=["shadowBlur","shadowOffsetX","shadowOffsetY"],WY=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function Aae(n,e,t,r,s){var o=!1;if(!r&&(t=t||{},e===t))return!1;if(r||e.opacity!==t.opacity){lu(n,s),o=!0;var l=Math.max(Math.min(e.opacity,1),0);n.globalAlpha=isNaN(l)?ex.opacity:l}(r||e.blend!==t.blend)&&(o||(lu(n,s),o=!0),n.globalCompositeOperation=e.blend||ex.blend);for(var c=0;c<jY.length;c++){var a=jY[c];(r||e[a]!==t[a])&&(o||(lu(n,s),o=!0),n[a]=n.dpr*(e[a]||0))}return(r||e.shadowColor!==t.shadowColor)&&(o||(lu(n,s),o=!0),n.shadowColor=e.shadowColor||ex.shadowColor),o}function $Y(n,e,t,r,s){var o=UM(e,s.inHover),l=r?null:t&&UM(t,s.inHover)||{};if(o===l)return!1;var c=Aae(n,o,l,r,s);if((r||o.fill!==l.fill)&&(c||(lu(n,s),c=!0),GY(o.fill)&&(n.fillStyle=o.fill)),(r||o.stroke!==l.stroke)&&(c||(lu(n,s),c=!0),GY(o.stroke)&&(n.strokeStyle=o.stroke)),(r||o.opacity!==l.opacity)&&(c||(lu(n,s),c=!0),n.globalAlpha=o.opacity==null?1:o.opacity),e.hasStroke()){var a=o.lineWidth,d=a/(o.strokeNoScale&&e.getLineScale?e.getLineScale():1);n.lineWidth!==d&&(c||(lu(n,s),c=!0),n.lineWidth=d)}for(var f=0;f<WY.length;f++){var m=WY[f],_=m[0];(r||o[_]!==l[_])&&(c||(lu(n,s),c=!0),n[_]=o[_]||m[1])}return c}function yDe(n,e,t,r,s){return Aae(n,UM(e,s.inHover),t&&UM(t,s.inHover),r,s)}function Tae(n,e){var t=e.transform,r=n.dpr||1;t?n.setTransform(r*t[0],r*t[1],r*t[2],r*t[3],r*t[4],r*t[5]):n.setTransform(r,0,0,r,0,0)}function xDe(n,e,t){for(var r=!1,s=0;s<n.length;s++){var o=n[s];r=r||o.isZeroArea(),Tae(e,o),e.beginPath(),o.buildPath(e,o.shape),e.clip()}t.allClipped=r}function bDe(n,e){return n&&e?n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]||n[4]!==e[4]||n[5]!==e[5]:!(!n&&!e)}var XY=1,qY=2,YY=3,ZY=4;function wDe(n){var e=wL(n),t=bL(n);return!(n.lineDash||!(+e^+t)||e&&typeof n.fill!="string"||t&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function lu(n,e){e.batchFill&&n.fill(),e.batchStroke&&n.stroke(),e.batchFill="",e.batchStroke=""}function UM(n,e){return e&&n.__hoverStyle||n.style}function Mae(n,e){Gy(n,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Gy(n,e,t,r){var s=e.transform;if(!e.shouldBePainted(t.viewWidth,t.viewHeight,!1,!1)){e.__dirty&=~Fu,e.__isRendered=!1;return}var o=e.__clipPaths,l=t.prevElClipPaths,c=!1,a=!1;if((!l||fDe(o,l))&&(l&&l.length&&(lu(n,t),n.restore(),a=c=!0,t.prevElClipPaths=null,t.allClipped=!1,t.prevEl=null),o&&o.length&&(lu(n,t),n.save(),xDe(o,n,t),c=!0),t.prevElClipPaths=o),t.allClipped){e.__isRendered=!1;return}e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var d=t.prevEl;d||(a=c=!0);var f=e instanceof Ki&&e.autoBatch&&wDe(e.style);c||bDe(s,d.transform)?(lu(n,t),Tae(n,e)):f||lu(n,t);var m=UM(e,t.inHover);e instanceof Ki?(t.lastDrawType!==XY&&(a=!0,t.lastDrawType=XY),$Y(n,e,d,a,t),(!f||!t.batchFill&&!t.batchStroke)&&n.beginPath(),gDe(n,e,m,f),f&&(t.batchFill=m.fill||"",t.batchStroke=m.stroke||"")):e instanceof uL?(t.lastDrawType!==YY&&(a=!0,t.lastDrawType=YY),$Y(n,e,d,a,t),_De(n,e,m)):e instanceof q0?(t.lastDrawType!==qY&&(a=!0,t.lastDrawType=qY),yDe(n,e,d,a,t),vDe(n,e,m)):e.getTemporalDisplayables&&(t.lastDrawType!==ZY&&(a=!0,t.lastDrawType=ZY),SDe(n,e,t)),f&&r&&lu(n,t),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),t.prevEl=e,e.__dirty=0,e.__isRendered=!0}function SDe(n,e,t){var r=e.getDisplayables(),s=e.getTemporalDisplayables();n.save();var o={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:t.viewWidth,viewHeight:t.viewHeight,inHover:t.inHover},l,c;for(l=e.getCursor(),c=r.length;l<c;l++){var a=r[l];a.beforeBrush&&a.beforeBrush(),a.innerBeforeBrush(),Gy(n,a,o,l===c-1),a.innerAfterBrush(),a.afterBrush&&a.afterBrush(),o.prevEl=a}for(var d=0,f=s.length;d<f;d++){var a=s[d];a.beforeBrush&&a.beforeBrush(),a.innerBeforeBrush(),Gy(n,a,o,d===f-1),a.innerAfterBrush(),a.afterBrush&&a.afterBrush(),o.prevEl=a}e.clearTemporalDisplayables(),e.notClear=!0,n.restore()}var G3=new tDe,KY=new PC(100),JY=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function m5(n,e){if(n==="none")return null;var t=e.getDevicePixelRatio(),r=e.getZr(),s=r.painter.type==="svg";n.dirty&&G3.delete(n);var o=G3.get(n);if(o)return o;var l=ri(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});l.backgroundColor==="none"&&(l.backgroundColor=null);var c={repeat:"repeat"};return a(c),c.rotation=l.rotation,c.scaleX=c.scaleY=s?1:1/t,G3.set(n,c),n.dirty=!1,c;function a(d){for(var f=[t],m=!0,_=0;_<JY.length;++_){var x=l[JY[_]];if(x!=null&&!fr(x)&&!Br(x)&&!Ds(x)&&typeof x!="boolean"){m=!1;break}f.push(x)}var A;if(m){A=f.join(",")+(s?"-svg":"");var I=KY.get(A);I&&(s?d.svgElement=I:d.image=I)}var E=Eae(l.dashArrayX),C=ADe(l.dashArrayY),L=Cae(l.symbol),O=TDe(E),H=Iae(C),q=!s&&Hw.createCanvas(),Z=s&&{tag:"g",attrs:{},key:"dcl",children:[]},J=se(),re;q&&(q.width=J.width*t,q.height=J.height*t,re=q.getContext("2d")),ae(),m&&KY.put(A,q||Z),d.image=q,d.svgElement=Z,d.svgWidth=J.width,d.svgHeight=J.height;function se(){for(var he=1,Ae=0,Ee=O.length;Ae<Ee;++Ae)he=dq(he,O[Ae]);for(var Pe=1,Ae=0,Ee=L.length;Ae<Ee;++Ae)Pe=dq(Pe,L[Ae].length);he*=Pe;var ze=H*O.length*L.length;return{width:Math.max(1,Math.min(he,l.maxTileWidth)),height:Math.max(1,Math.min(ze,l.maxTileHeight))}}function ae(){re&&(re.clearRect(0,0,q.width,q.height),l.backgroundColor&&(re.fillStyle=l.backgroundColor,re.fillRect(0,0,q.width,q.height)));for(var he=0,Ae=0;Ae<C.length;++Ae)he+=C[Ae];if(he<=0)return;for(var Ee=-H,Pe=0,ze=0,Re=0;Ee<J.height;){if(Pe%2===0){for(var rt=ze/2%L.length,ye=0,We=0,Ue=0;ye<J.width*2;){for(var gt=0,Ae=0;Ae<E[Re].length;++Ae)gt+=E[Re][Ae];if(gt<=0)break;if(We%2===0){var vt=(1-l.symbolSize)*.5,Dt=ye+E[Re][We]*vt,lt=Ee+C[Pe]*vt,jt=E[Re][We]*l.symbolSize,Qt=C[Pe]*l.symbolSize,nn=Ue/2%L[rt].length;Wn(Dt,lt,jt,Qt,L[rt][nn])}ye+=E[Re][We],++Ue,++We,We===E[Re].length&&(We=0)}++Re,Re===E.length&&(Re=0)}Ee+=C[Pe],++ze,++Pe,Pe===C.length&&(Pe=0)}function Wn(kn,Mn,De,Ye,gn){var un=s?1:t,At=Mw(gn,kn*un,Mn*un,De*un,Ye*un,l.color,l.symbolKeepAspect);if(s){var en=r.painter.renderOneToVNode(At);en&&Z.children.push(en)}else Mae(re,At)}}}}function Cae(n){if(!n||n.length===0)return[["rect"]];if(Br(n))return[[n]];for(var e=!0,t=0;t<n.length;++t)if(!Br(n[t])){e=!1;break}if(e)return Cae([n]);for(var r=[],t=0;t<n.length;++t)Br(n[t])?r.push([n[t]]):r.push(n[t]);return r}function Eae(n){if(!n||n.length===0)return[[0,0]];if(Ds(n)){var e=Math.ceil(n);return[[e,e]]}for(var t=!0,r=0;r<n.length;++r)if(!Ds(n[r])){t=!1;break}if(t)return Eae([n]);for(var s=[],r=0;r<n.length;++r)if(Ds(n[r])){var e=Math.ceil(n[r]);s.push([e,e])}else{var e=br(n[r],function(c){return Math.ceil(c)});e.length%2===1?s.push(e.concat(e)):s.push(e)}return s}function ADe(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(Ds(n)){var e=Math.ceil(n);return[e,e]}var t=br(n,function(r){return Math.ceil(r)});return n.length%2?t.concat(t):t}function TDe(n){return br(n,function(e){return Iae(e)})}function Iae(n){for(var e=0,t=0;t<n.length;++t)e+=n[t];return n.length%2===1?e*2:e}function MDe(n,e){n.eachRawSeries(function(t){if(!n.isSeriesFiltered(t)){var r=t.getData();r.hasItemVisual()&&r.each(function(l){var c=r.getItemVisual(l,"decal");if(c){var a=r.ensureUniqueItemVisual(l,"style");a.decal=m5(c,e)}});var s=r.getVisual("decal");if(s){var o=r.getVisual("style");o.decal=m5(s,e)}}})}var zd=new ff,Pae={};function CDe(n,e){Pae[n]=e}function EDe(n){return Pae[n]}var IDe=1,PDe=800,RDe=900,LDe=1e3,DDe=2e3,BDe=5e3,Rae=1e3,kDe=1100,ZG=2e3,Lae=3e3,ODe=4e3,OB=4500,FDe=4600,NDe=5e3,zDe=6e3,Dae=7e3,UDe={PROCESSOR:{FILTER:LDe,SERIES_FILTER:PDe,STATISTIC:BDe},VISUAL:{LAYOUT:Rae,PROGRESSIVE_LAYOUT:kDe,GLOBAL:ZG,CHART:Lae,POST_CHART_LAYOUT:FDe,COMPONENT:ODe,BRUSH:NDe,CHART_ITEM:OB,ARIA:zDe,DECAL:Dae}},Hl="__flagInMainProcess",tu="__pendingUpdate",V3="__needsUpdateStatus",QY=/^[a-zA-Z0-9_]+$/,H3="__connectUpdateStatus",eZ=0,GDe=1,VDe=2;function Bae(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.isDisposed()){this.id;return}return Oae(this,n,e)}}function kae(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Oae(this,n,e)}}function Oae(n,e,t){return t[0]=t[0]&&t[0].toLowerCase(),ff.prototype[e].apply(n,t)}var Fae=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(ff),Nae=Fae.prototype;Nae.on=kae("on");Nae.off=kae("off");var eb,j3,MI,Pv,W3,$3,X3,xA,bA,tZ,nZ,q3,rZ,CI,iZ,zae,ph,sZ,Uae=function(n){jn(e,n);function e(t,r,s){var o=n.call(this,new $Le)||this;o._chartsViews=[],o._chartsMap={},o._componentsViews=[],o._componentsMap={},o._pendingActions=[],s=s||{},Br(r)&&(r=Gae[r]),o._dom=t;var l="canvas",c="auto",a=!1;s.ssr;var d=o._zr=uq(t,{renderer:s.renderer||l,devicePixelRatio:s.devicePixelRatio,width:s.width,height:s.height,ssr:s.ssr,useDirtyRect:Li(s.useDirtyRect,a),useCoarsePointer:Li(s.useCoarsePointer,c),pointerSize:s.pointerSize});o._ssr=s.ssr,o._throttledZrFlush=YG(Vs(d.flush,d),17),r=wi(r),r&&$oe(r,!0),o._theme=r,o._locale=JPe(s.locale||Toe),o._coordSysMgr=new jG;var f=o._api=iZ(o);function m(_,x){return _.__prio-x.__prio}return bP(AL,m),bP(g5,m),o._scheduler=new vae(o,f,g5,AL),o._messageCenter=new Fae,o._initEvents(),o.resize=Vs(o.resize,o),d.animation.on("frame",o._onframe,o),tZ(d,o),nZ(d,o),eL(o),o}return e.prototype._onframe=function(){if(!this._disposed){sZ(this);var t=this._scheduler;if(this[tu]){var r=this[tu].silent;this[Hl]=!0;try{eb(this),Pv.update.call(this,null,this[tu].updateParams)}catch(a){throw this[Hl]=!1,this[tu]=null,a}this._zr.flush(),this[Hl]=!1,this[tu]=null,xA.call(this,r),bA.call(this,r)}else if(t.unfinished){var s=IDe,o=this._model,l=this._api;t.unfinished=!1;do{var c=+new Date;t.performSeriesTasks(o),t.performDataProcessorTasks(o),$3(this,o),t.performVisualTasks(o),CI(this,this._model,l,"remain",{}),s-=+new Date-c}while(s>0&&t.unfinished);t.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.isSSR=function(){return this._ssr},e.prototype.setOption=function(t,r,s){if(!this[Hl]){if(this._disposed){this.id;return}var o,l,c;if(qr(r)&&(s=r.lazyUpdate,o=r.silent,l=r.replaceMerge,c=r.transition,r=r.notMerge),this[Hl]=!0,!this._model||r){var a=new MRe(this._api),d=this._theme,f=this._model=new HG;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,d,this._locale,a)}this._model.setOption(t,{replaceMerge:l},v5);var m={seriesTransition:c,optionChanged:!0};if(s)this[tu]={silent:o,updateParams:m},this[Hl]=!1,this.getZr().wakeUp();else{try{eb(this),Pv.update.call(this,null,m)}catch(_){throw this[tu]=null,this[Hl]=!1,_}this._ssr||this._zr.flush(),this[tu]=null,this[Hl]=!1,xA.call(this,o),bA.call(this,o)}}},e.prototype.setTheme=function(){},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||yi.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){return this.renderToCanvas(t)},e.prototype.renderToCanvas=function(t){t=t||{};var r=this._zr.painter;return r.getRenderedCanvas({backgroundColor:t.backgroundColor||this._model.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(t){t=t||{};var r=this._zr.painter;return r.renderToString({useViewBox:t.useViewBox})},e.prototype.getSvgDataURL=function(){if(yi.svgSupported){var t=this._zr,r=t.storage.getDisplayList();return ot(r,function(s){s.stopAnimation(null,!0)}),t.painter.toDataURL()}},e.prototype.getDataURL=function(t){if(this._disposed){this.id;return}t=t||{};var r=t.excludeComponents,s=this._model,o=[],l=this;ot(r,function(a){s.eachComponent({mainType:a},function(d){var f=l._componentsMap[d.__viewId];f.group.ignore||(o.push(f),f.group.ignore=!0)})});var c=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return ot(o,function(a){a.group.ignore=!1}),c},e.prototype.getConnectedDataURL=function(t){if(this._disposed){this.id;return}var r=t.type==="svg",s=this.group,o=Math.min,l=Math.max,c=1/0;if(oZ[s]){var a=c,d=c,f=-c,m=-c,_=[],x=t&&t.pixelRatio||this.getDevicePixelRatio();ot(NT,function(O,H){if(O.group===s){var q=r?O.getZr().painter.getSvgDom().innerHTML:O.renderToCanvas(wi(t)),Z=O.getDom().getBoundingClientRect();a=o(Z.left,a),d=o(Z.top,d),f=l(Z.right,f),m=l(Z.bottom,m),_.push({dom:q,left:Z.left,top:Z.top})}}),a*=x,d*=x,f*=x,m*=x;var A=f-a,I=m-d,E=Hw.createCanvas(),C=uq(E,{renderer:r?"svg":"canvas"});if(C.resize({width:A,height:I}),r){var L="";return ot(_,function(O){var H=O.left-a,q=O.top-d;L+='<g transform="translate('+H+","+q+')">'+O.dom+"</g>"}),C.painter.getSvgRoot().innerHTML=L,t.connectedBackgroundColor&&C.painter.setBackgroundColor(t.connectedBackgroundColor),C.refreshImmediately(),C.painter.toDataURL()}else return t.connectedBackgroundColor&&C.add(new $o({shape:{x:0,y:0,width:A,height:I},style:{fill:t.connectedBackgroundColor}})),ot(_,function(O){var H=new q0({style:{x:O.left*x-a,y:O.top*x-d,image:O.dom}});C.add(H)}),C.refreshImmediately(),E.toDataURL("image/"+(t&&t.type||"png"))}else return this.getDataURL(t)},e.prototype.convertToPixel=function(t,r){return W3(this,"convertToPixel",t,r)},e.prototype.convertFromPixel=function(t,r){return W3(this,"convertFromPixel",t,r)},e.prototype.containPixel=function(t,r){if(this._disposed){this.id;return}var s=this._model,o,l=RT(s,t);return ot(l,function(c,a){a.indexOf("Models")>=0&&ot(c,function(d){var f=d.coordinateSystem;if(f&&f.containPoint)o=o||!!f.containPoint(r);else if(a==="seriesModels"){var m=this._chartsMap[d.__viewId];m&&m.containPoint&&(o=o||m.containPoint(r,d))}},this)},this),!!o},e.prototype.getVisual=function(t,r){var s=this._model,o=RT(s,t,{defaultMainType:"series"}),l=o.seriesModel,c=l.getData(),a=o.hasOwnProperty("dataIndexInside")?o.dataIndexInside:o.hasOwnProperty("dataIndex")?c.indexOfRawIndex(o.dataIndex):null;return a!=null?YLe(c,a,r):ZLe(c,r)},e.prototype.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]},e.prototype._initEvents=function(){var t=this;ot(HDe,function(r){var s=function(o){var l=t.getModel(),c=o.target,a,d=r==="globalout";if(d?a={}:c&&QA(c,function(A){var I=Yi(A);if(I&&I.dataIndex!=null){var E=I.dataModel||l.getSeriesByIndex(I.seriesIndex);return a=E&&E.getDataParams(I.dataIndex,I.dataType,c)||{},!0}else if(I.eventData)return a=Qn({},I.eventData),!0},!0),a){var f=a.componentType,m=a.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",m=a.seriesIndex);var _=f&&m!=null&&l.getComponent(f,m),x=_&&t[_.mainType==="series"?"_chartsMap":"_componentsMap"][_.__viewId];a.event=o,a.type=r,t._$eventProcessor.eventInfo={targetEl:c,packedEvent:a,model:_,view:x},t.trigger(r,a)}};s.zrEventfulCallAtLast=!0,t._zr.on(r,s,t)}),ot(FT,function(r,s){t._messageCenter.on(s,function(o){this.trigger(s,o)},t)}),ot(["selectchanged"],function(r){t._messageCenter.on(r,function(s){this.trigger(r,s)},t)}),JLe(this._messageCenter,this,this._api)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var t=this.getDom();t&&Cse(this.getDom(),JG,"");var r=this,s=r._api,o=r._model;ot(r._componentsViews,function(l){l.dispose(o,s)}),ot(r._chartsViews,function(l){l.dispose(o,s)}),r._zr.dispose(),r._dom=r._model=r._chartsMap=r._componentsMap=r._chartsViews=r._componentsViews=r._scheduler=r._api=r._zr=r._throttledZrFlush=r._theme=r._coordSysMgr=r._messageCenter=null,delete NT[r.id]},e.prototype.resize=function(t){if(!this[Hl]){if(this._disposed){this.id;return}this._zr.resize(t);var r=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!r){var s=r.resetOption("media"),o=t&&t.silent;this[tu]&&(o==null&&(o=this[tu].silent),s=!0,this[tu]=null),this[Hl]=!0;try{s&&eb(this),Pv.update.call(this,{type:"resize",animation:Qn({duration:0},t&&t.animation)})}catch(l){throw this[Hl]=!1,l}this[Hl]=!1,xA.call(this,o),bA.call(this,o)}}},e.prototype.showLoading=function(t,r){if(this._disposed){this.id;return}if(qr(t)&&(r=t,t=""),t=t||"default",this.hideLoading(),!!_5[t]){var s=_5[t](this._api,r),o=this._zr;this._loadingFX=s,o.add(s)}},e.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},e.prototype.makeActionFromEvent=function(t){var r=Qn({},t);return r.type=FT[t.type],r},e.prototype.dispatchAction=function(t,r){if(this._disposed){this.id;return}if(qr(r)||(r={silent:!!r}),!!SL[t.type]&&this._model){if(this[Hl]){this._pendingActions.push(t);return}var s=r.silent;X3.call(this,t,s);var o=r.flush;o?this._zr.flush():o!==!1&&yi.browser.weChat&&this._throttledZrFlush(),xA.call(this,s),bA.call(this,s)}},e.prototype.updateLabelLayout=function(){zd.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this._disposed){this.id;return}var r=t.seriesIndex,s=this.getModel(),o=s.getSeriesByIndex(r);o.appendData(t),this._scheduler.unfinished=!0,this.getZr().wakeUp()},e.internalField=function(){eb=function(m){var _=m._scheduler;_.restorePipelines(m._model),_.prepareStageTasks(),j3(m,!0),j3(m,!1),_.plan()},j3=function(m,_){for(var x=m._model,A=m._scheduler,I=_?m._componentsViews:m._chartsViews,E=_?m._componentsMap:m._chartsMap,C=m._zr,L=m._api,O=0;O<I.length;O++)I[O].__alive=!1;_?x.eachComponent(function(Z,J){Z!=="series"&&H(J)}):x.eachSeries(H);function H(Z){var J=Z.__requireNewView;Z.__requireNewView=!1;var re="_ec_"+Z.id+"_"+Z.type,se=!J&&E[re];if(!se){var ae=up(Z.type),he=_?kc.getClass(ae.main,ae.sub):Oh.getClass(ae.sub);se=new he,se.init(x,L),E[re]=se,I.push(se),C.add(se.group)}Z.__viewId=se.__id=re,se.__alive=!0,se.__model=Z,se.group.__ecComponentInfo={mainType:Z.mainType,index:Z.componentIndex},!_&&A.prepareView(se,Z,x,L)}for(var O=0;O<I.length;){var q=I[O];q.__alive?O++:(!_&&q.renderTask.dispose(),C.remove(q.group),q.dispose(x,L),I.splice(O,1),E[q.__id]===q&&delete E[q.__id],q.__id=q.group.__ecComponentInfo=null)}},MI=function(m,_,x,A,I){var E=m._model;if(E.setUpdatePayload(x),!A){ot([].concat(m._componentsViews).concat(m._chartsViews),q);return}var C={};C[A+"Id"]=x[A+"Id"],C[A+"Index"]=x[A+"Index"],C[A+"Name"]=x[A+"Name"];var L={mainType:A,query:C};I&&(L.subType=I);var O=x.excludeSeriesId,H;O!=null&&(H=oi(),ot(va(O),function(Z){var J=vp(Z,null);J!=null&&H.set(J,!0)})),E&&E.eachComponent(L,function(Z){var J=H&&H.get(Z.id)!=null;if(!J)if(zq(x))if(Z instanceof sf)x.type===tx&&!x.notBlur&&!Z.get(["emphasis","disabled"])&&NIe(Z,x,m._api);else{var re=MG(Z.mainType,Z.componentIndex,x.name,m._api),se=re.focusSelf,ae=re.dispatchers;x.type===tx&&se&&!x.notBlur&&Zz(Z.mainType,Z.componentIndex,m._api),ae&&ot(ae,function(he){x.type===tx?ww(he):Sw(he)})}else Qz(x)&&Z instanceof sf&&(GIe(Z,x,m._api),Fq(Z),ph(m))},m),E&&E.eachComponent(L,function(Z){var J=H&&H.get(Z.id)!=null;J||q(m[A==="series"?"_chartsMap":"_componentsMap"][Z.__viewId])},m);function q(Z){Z&&Z.__alive&&Z[_]&&Z[_](Z.__model,E,m._api,x)}},Pv={prepareAndUpdate:function(m){eb(this),Pv.update.call(this,m,{optionChanged:m.newOption!=null})},update:function(m,_){var x=this._model,A=this._api,I=this._zr,E=this._coordSysMgr,C=this._scheduler;if(x){x.setUpdatePayload(m),C.restoreData(x,m),C.performSeriesTasks(x),E.create(x,A),C.performDataProcessorTasks(x,m),$3(this,x),E.update(x,A),t(x),C.performVisualTasks(x,m),q3(this,x,A,m,_);var L=x.get("backgroundColor")||"transparent",O=x.get("darkMode");I.setBackgroundColor(L),O!=null&&O!=="auto"&&I.setDarkMode(O),zd.trigger("afterupdate",x,A)}},updateTransform:function(m){var _=this,x=this._model,A=this._api;if(x){x.setUpdatePayload(m);var I=[];x.eachComponent(function(C,L){if(C!=="series"){var O=_.getViewOfComponentModel(L);if(O&&O.__alive)if(O.updateTransform){var H=O.updateTransform(L,x,A,m);H&&H.update&&I.push(O)}else I.push(O)}});var E=oi();x.eachSeries(function(C){var L=_._chartsMap[C.__viewId];if(L.updateTransform){var O=L.updateTransform(C,x,A,m);O&&O.update&&E.set(C.uid,1)}else E.set(C.uid,1)}),t(x),this._scheduler.performVisualTasks(x,m,{setDirty:!0,dirtyMap:E}),CI(this,x,A,m,{},E),zd.trigger("afterupdate",x,A)}},updateView:function(m){var _=this._model;_&&(_.setUpdatePayload(m),Oh.markUpdateMethod(m,"updateView"),t(_),this._scheduler.performVisualTasks(_,m,{setDirty:!0}),q3(this,_,this._api,m,{}),zd.trigger("afterupdate",_,this._api))},updateVisual:function(m){var _=this,x=this._model;x&&(x.setUpdatePayload(m),x.eachSeries(function(A){A.getData().clearAllVisual()}),Oh.markUpdateMethod(m,"updateVisual"),t(x),this._scheduler.performVisualTasks(x,m,{visualType:"visual",setDirty:!0}),x.eachComponent(function(A,I){if(A!=="series"){var E=_.getViewOfComponentModel(I);E&&E.__alive&&E.updateVisual(I,x,_._api,m)}}),x.eachSeries(function(A){var I=_._chartsMap[A.__viewId];I.updateVisual(A,x,_._api,m)}),zd.trigger("afterupdate",x,this._api))},updateLayout:function(m){Pv.update.call(this,m)}},W3=function(m,_,x,A){if(m._disposed){m.id;return}for(var I=m._model,E=m._coordSysMgr.getCoordinateSystems(),C,L=RT(I,x),O=0;O<E.length;O++){var H=E[O];if(H[_]&&(C=H[_](I,L,A))!=null)return C}},$3=function(m,_){var x=m._chartsMap,A=m._scheduler;_.eachSeries(function(I){A.updateStreamModes(I,x[I.__viewId])})},X3=function(m,_){var x=this,A=this.getModel(),I=m.type,E=m.escapeConnect,C=SL[I],L=C.actionInfo,O=(L.update||"update").split(":"),H=O.pop(),q=O[0]!=null&&up(O[0]);this[Hl]=!0;var Z=[m],J=!1;m.batch&&(J=!0,Z=br(m.batch,function(Pe){return Pe=ri(Qn({},Pe),m),Pe.batch=null,Pe}));var re=[],se,ae=Qz(m),he=zq(m);if(he&&Yse(this._api),ot(Z,function(Pe){if(se=C.action(Pe,x._model,x._api),se=se||Qn({},Pe),se.type=L.event||se.type,re.push(se),he){var ze=bG(m),Re=ze.queryOptionMap,rt=ze.mainTypeSpecified,ye=rt?Re.keys()[0]:"series";MI(x,H,Pe,ye),ph(x)}else ae?(MI(x,H,Pe,"series"),ph(x)):q&&MI(x,H,Pe,q.main,q.sub)}),H!=="none"&&!he&&!ae&&!q)try{this[tu]?(eb(this),Pv.update.call(this,m),this[tu]=null):Pv[H].call(this,m)}catch(Pe){throw this[Hl]=!1,Pe}if(J?se={type:L.event||I,escapeConnect:E,batch:re}:se=re[0],this[Hl]=!1,!_){var Ae=this._messageCenter;if(Ae.trigger(se.type,se),ae){var Ee={type:"selectchanged",escapeConnect:E,selected:VIe(A),isFromClick:m.isFromClick||!1,fromAction:m.type,fromActionPayload:m};Ae.trigger(Ee.type,Ee)}}},xA=function(m){for(var _=this._pendingActions;_.length;){var x=_.shift();X3.call(this,x,m)}},bA=function(m){!m&&this.trigger("updated")},tZ=function(m,_){m.on("rendered",function(x){_.trigger("rendered",x),m.animation.isFinished()&&!_[tu]&&!_._scheduler.unfinished&&!_._pendingActions.length&&_.trigger("finished")})},nZ=function(m,_){m.on("mouseover",function(x){var A=x.target,I=QA(A,Jz);I&&(zIe(I,x,_._api),ph(_))}).on("mouseout",function(x){var A=x.target,I=QA(A,Jz);I&&(UIe(I,x,_._api),ph(_))}).on("click",function(x){var A=x.target,I=QA(A,function(L){return Yi(L).dataIndex!=null},!0);if(I){var E=I.selected?"unselect":"select",C=Yi(I);_._api.dispatchAction({type:E,dataType:C.dataType,dataIndexInside:C.dataIndex,seriesIndex:C.seriesIndex,isFromClick:!0})}})};function t(m){m.clearColorPalette(),m.eachSeries(function(_){_.clearColorPalette()})}function r(m){var _=[],x=[],A=!1;if(m.eachComponent(function(L,O){var H=O.get("zlevel")||0,q=O.get("z")||0,Z=O.getZLevelKey();A=A||!!Z,(L==="series"?x:_).push({zlevel:H,z:q,idx:O.componentIndex,type:L,key:Z})}),A){var I=_.concat(x),E,C;bP(I,function(L,O){return L.zlevel===O.zlevel?L.z-O.z:L.zlevel-O.zlevel}),ot(I,function(L){var O=m.getComponent(L.type,L.idx),H=L.zlevel,q=L.key;E!=null&&(H=Math.max(E,H)),q?(H===E&&q!==C&&H++,C=q):C&&(H===E&&H++,C=""),E=H,O.setZLevel(H)})}}q3=function(m,_,x,A,I){r(_),rZ(m,_,x,A,I),ot(m._chartsViews,function(E){E.__alive=!1}),CI(m,_,x,A,I),ot(m._chartsViews,function(E){E.__alive||E.remove(_,x)})},rZ=function(m,_,x,A,I,E){ot(E||m._componentsViews,function(C){var L=C.__model;d(L,C),C.render(L,_,x,A),c(L,C),f(L,C)})},CI=function(m,_,x,A,I,E){var C=m._scheduler;I=Qn(I||{},{updatedSeries:_.getSeries()}),zd.trigger("series:beforeupdate",_,x,I);var L=!1;_.eachSeries(function(O){var H=m._chartsMap[O.__viewId];H.__alive=!0;var q=H.renderTask;C.updatePayload(q,A),d(O,H),E&&E.get(O.uid)&&q.dirty(),q.perform(C.getPerformArgs(q))&&(L=!0),H.group.silent=!!O.get("silent"),l(O,H),Fq(O)}),C.unfinished=L||C.unfinished,zd.trigger("series:layoutlabels",_,x,I),zd.trigger("series:transition",_,x,I),_.eachSeries(function(O){var H=m._chartsMap[O.__viewId];c(O,H),f(O,H)}),o(m,_),zd.trigger("series:afterupdate",_,x,I)},ph=function(m){m[V3]=!0,m.getZr().wakeUp()},sZ=function(m){m[V3]&&(m.getZr().storage.traverse(function(_){ew(_)||s(_)}),m[V3]=!1)};function s(m){for(var _=[],x=m.currentStates,A=0;A<x.length;A++){var I=x[A];I==="emphasis"||I==="blur"||I==="select"||_.push(I)}m.selected&&m.states.select&&_.push("select"),m.hoverState===gB&&m.states.emphasis?_.push("emphasis"):m.hoverState===mB&&m.states.blur&&_.push("blur"),m.useStates(_)}function o(m,_){var x=m._zr,A=x.storage,I=0;A.traverse(function(E){E.isGroup||I++}),I>_.get("hoverLayerThreshold")&&!yi.node&&!yi.worker&&_.eachSeries(function(E){if(!E.preventUsingHoverLayer){var C=m._chartsMap[E.__viewId];C.__alive&&C.eachRendered(function(L){L.states.emphasis&&(L.states.emphasis.hoverLayer=!0)})}})}function l(m,_){var x=m.get("blendMode")||null;_.eachRendered(function(A){A.isGroup||(A.style.blend=x)})}function c(m,_){if(!m.preventAutoZ){var x=m.get("z")||0,A=m.get("zlevel")||0;_.eachRendered(function(I){return a(I,x,A,-1/0),!0})}}function a(m,_,x,A){var I=m.getTextContent(),E=m.getTextGuideLine(),C=m.isGroup;if(C)for(var L=m.childrenRef(),O=0;O<L.length;O++)A=Math.max(a(L[O],_,x,A),A);else m.z=_,m.zlevel=x,A=Math.max(m.z2,A);if(I&&(I.z=_,I.zlevel=x,isFinite(A)&&(I.z2=A+2)),E){var H=m.textGuideLineConfig;E.z=_,E.zlevel=x,isFinite(A)&&(E.z2=A+(H&&H.showAbove?1:-1))}return A}function d(m,_){_.eachRendered(function(x){if(!ew(x)){var A=x.getTextContent(),I=x.getTextGuideLine();x.stateTransition&&(x.stateTransition=null),A&&A.stateTransition&&(A.stateTransition=null),I&&I.stateTransition&&(I.stateTransition=null),x.hasState()?(x.prevStates=x.currentStates,x.clearStates()):x.prevStates&&(x.prevStates=null)}})}function f(m,_){var x=m.getModel("stateAnimation"),A=m.isAnimationEnabled(),I=x.get("duration"),E=I>0?{duration:I,delay:x.get("delay"),easing:x.get("easing")}:null;_.eachRendered(function(C){if(C.states&&C.states.emphasis){if(ew(C))return;if(C instanceof Ki&&XIe(C),C.__dirty){var L=C.prevStates;L&&C.useStates(L)}if(A){C.stateTransition=E;var O=C.getTextContent(),H=C.getTextGuideLine();O&&(O.stateTransition=E),H&&(H.stateTransition=E)}C.__dirty&&s(C)}})}iZ=function(m){return new(function(_){jn(x,_);function x(){return _!==null&&_.apply(this,arguments)||this}return x.prototype.getCoordinateSystems=function(){return m._coordSysMgr.getCoordinateSystems()},x.prototype.getComponentByElement=function(A){for(;A;){var I=A.__ecComponentInfo;if(I!=null)return m._model.getComponent(I.mainType,I.index);A=A.parent}},x.prototype.enterEmphasis=function(A,I){ww(A,I),ph(m)},x.prototype.leaveEmphasis=function(A,I){Sw(A,I),ph(m)},x.prototype.enterBlur=function(A){FIe(A),ph(m)},x.prototype.leaveBlur=function(A){Wse(A),ph(m)},x.prototype.enterSelect=function(A){$se(A),ph(m)},x.prototype.leaveSelect=function(A){Xse(A),ph(m)},x.prototype.getModel=function(){return m.getModel()},x.prototype.getViewOfComponentModel=function(A){return m.getViewOfComponentModel(A)},x.prototype.getViewOfSeriesModel=function(A){return m.getViewOfSeriesModel(A)},x}(joe))(m)},zae=function(m){function _(x,A){for(var I=0;I<x.length;I++){var E=x[I];E[H3]=A}}ot(FT,function(x,A){m._messageCenter.on(A,function(I){if(oZ[m.group]&&m[H3]!==eZ){if(I&&I.escapeConnect)return;var E=m.makeActionFromEvent(I),C=[];ot(NT,function(L){L!==m&&L.group===m.group&&C.push(L)}),_(C,eZ),ot(C,function(L){L[H3]!==GDe&&L.dispatchAction(E)}),_(C,VDe)}})})}}(),e}(ff),KG=Uae.prototype;KG.on=Bae("on");KG.off=Bae("off");KG.one=function(n,e,t){var r=this;function s(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];e&&e.apply&&e.apply(this,o),r.off(n,s)}this.on.call(this,n,s,t)};var HDe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],SL={},FT={},g5=[],v5=[],AL=[],Gae={},_5={},NT={},oZ={},jDe=+new Date-0,JG="_echarts_instance_";function WDe(n,e,t){{var r=$De(n);if(r)return r}var s=new Uae(n,e,t);return s.id="ec_"+jDe++,NT[s.id]=s,Cse(n,JG,s.id),zae(s),zd.trigger("afterinit",s),s}function $De(n){return NT[C2e(n,JG)]}function Vae(n,e){Gae[n]=e}function Hae(n){Zi(v5,n)<0&&v5.push(n)}function jae(n,e){e8(g5,n,e,DDe)}function XDe(n){QG("afterinit",n)}function qDe(n){QG("afterupdate",n)}function QG(n,e){zd.on(n,e)}function Ep(n,e,t){hi(e)&&(t=e,e="");var r=qr(n)?n.type:[n,n={event:e}][0];n.event=(n.event||r).toLowerCase(),e=n.event,!FT[e]&&(wp(QY.test(r)&&QY.test(e)),SL[r]||(SL[r]={action:t,actionInfo:n}),FT[e]=r)}function YDe(n,e){jG.register(n,e)}function ZDe(n,e){e8(AL,n,e,Rae,"layout")}function zx(n,e){e8(AL,n,e,Lae,"visual")}var aZ=[];function e8(n,e,t,r,s){if((hi(e)||qr(e))&&(t=e,e=r),!(Zi(aZ,t)>=0)){aZ.push(t);var o=vae.wrapStageHandler(t,s);o.__prio=e,o.__raw=t,n.push(o)}}function Wae(n,e){_5[n]=e}function KDe(n,e,t){var r=EDe("registerMap");r&&r(n,e,t)}var JDe=sLe;zx(ZG,LLe);zx(OB,DLe);zx(OB,BLe);zx(ZG,XLe);zx(OB,qLe);zx(Dae,MDe);Hae($oe);jae(RDe,NRe);Wae("default",kLe);Ep({type:tx,event:tx,update:tx},Lc);Ep({type:CP,event:CP,update:CP},Lc);Ep({type:LT,event:LT,update:LT},Lc);Ep({type:EP,event:EP,update:EP},Lc);Ep({type:DT,event:DT,update:DT},Lc);Vae("light",WLe);Vae("dark",bae);function wA(n){return n==null?0:n.length||1}function lZ(n){return n}var GM=function(){function n(e,t,r,s,o,l){this._old=e,this._new=t,this._oldKeyGetter=r||lZ,this._newKeyGetter=s||lZ,this.context=o,this._diffModeMultiple=l==="multiple"}return n.prototype.add=function(e){return this._add=e,this},n.prototype.update=function(e){return this._update=e,this},n.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},n.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},n.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},n.prototype.remove=function(e){return this._remove=e,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var e=this._old,t=this._new,r={},s=new Array(e.length),o=new Array(t.length);this._initIndexMap(e,null,s,"_oldKeyGetter"),this._initIndexMap(t,r,o,"_newKeyGetter");for(var l=0;l<e.length;l++){var c=s[l],a=r[c],d=wA(a);if(d>1){var f=a.shift();a.length===1&&(r[c]=a[0]),this._update&&this._update(f,l)}else d===1?(r[c]=null,this._update&&this._update(a,l)):this._remove&&this._remove(l)}this._performRestAdd(o,r)},n.prototype._executeMultiple=function(){var e=this._old,t=this._new,r={},s={},o=[],l=[];this._initIndexMap(e,r,o,"_oldKeyGetter"),this._initIndexMap(t,s,l,"_newKeyGetter");for(var c=0;c<o.length;c++){var a=o[c],d=r[a],f=s[a],m=wA(d),_=wA(f);if(m>1&&_===1)this._updateManyToOne&&this._updateManyToOne(f,d),s[a]=null;else if(m===1&&_>1)this._updateOneToMany&&this._updateOneToMany(f,d),s[a]=null;else if(m===1&&_===1)this._update&&this._update(f,d),s[a]=null;else if(m>1&&_>1)this._updateManyToMany&&this._updateManyToMany(f,d),s[a]=null;else if(m>1)for(var x=0;x<m;x++)this._remove&&this._remove(d[x]);else this._remove&&this._remove(d)}this._performRestAdd(l,s)},n.prototype._performRestAdd=function(e,t){for(var r=0;r<e.length;r++){var s=e[r],o=t[s],l=wA(o);if(l>1)for(var c=0;c<l;c++)this._add&&this._add(o[c]);else l===1&&this._add&&this._add(o);t[s]=null}},n.prototype._initIndexMap=function(e,t,r,s){for(var o=this._diffModeMultiple,l=0;l<e.length;l++){var c="_ec_"+this[s](e[l],l);if(o||(r[l]=c),!!t){var a=t[c],d=wA(a);d===0?(t[c]=l,o&&r.push(c)):d===1?t[c]=[a,l]:a.push(l)}}},n}(),QDe=function(){function n(e,t){this._encode=e,this._schema=t}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function eBe(n,e){var t={},r=t.encode={},s=oi(),o=[],l=[],c={};ot(n.dimensions,function(_){var x=n.getDimensionInfo(_),A=x.coordDim;if(A){var I=x.coordDimIndex;Y3(r,A)[I]=_,x.isExtraCoord||(s.set(A,1),nBe(x.type)&&(o[0]=_),Y3(c,A)[I]=n.getDimensionIndex(x.name)),x.defaultTooltip&&l.push(_)}zoe.each(function(E,C){var L=Y3(r,C),O=x.otherDims[C];O!=null&&O!==!1&&(L[O]=x.name)})});var a=[],d={};s.each(function(_,x){var A=r[x];d[x]=A[0],a=a.concat(A)}),t.dataDimsOnCoord=a,t.dataDimIndicesOnCoord=br(a,function(_){return n.getDimensionInfo(_).storeDimIndex}),t.encodeFirstDimNotExtra=d;var f=r.label;f&&f.length&&(o=f.slice());var m=r.tooltip;return m&&m.length?l=m.slice():l.length||(l=o.slice()),r.defaultedLabel=o,r.defaultedTooltip=l,t.userOutput=new QDe(c,e),t}function Y3(n,e){return n.hasOwnProperty(e)||(n[e]=[]),n[e]}function tBe(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function nBe(n){return!(n==="ordinal"||n==="time")}var DP=function(){function n(e){this.otherDims={},e!=null&&Qn(this,e)}return n}(),rBe=Zs(),iBe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},$ae=function(){function n(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=Yae(this.source)))},n.prototype.getSourceDimensionIndex=function(e){return Li(this._dimNameMap.get(e),-1)},n.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},n.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=Yoe(this.source),r=!Zae(e),s="",o=[],l=0,c=0;l<e;l++){var a=void 0,d=void 0,f=void 0,m=this.dimensions[c];if(m&&m.storeDimIndex===l)a=t?m.name:null,d=m.type,f=m.ordinalMeta,c++;else{var _=this.getSourceDimension(l);_&&(a=t?_.name:null,d=_.type)}o.push({property:a,type:d,ordinalMeta:f}),t&&a!=null&&(!m||!m.isCalculationCoord)&&(s+=r?a.replace(/\`/g,"`1").replace(/\$/g,"`2"):a),s+="$",s+=iBe[d]||"f",f&&(s+=f.uid),s+="$"}var x=this.source,A=[x.seriesLayoutBy,x.startIndex,s].join("$$");return{dimensions:o,hash:A}},n.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,r=0;t<this._fullDimCount;t++){var s=void 0,o=this.dimensions[r];if(o&&o.storeDimIndex===t)o.isCalculationCoord||(s=o.name),r++;else{var l=this.getSourceDimension(t);l&&(s=l.name)}e.push(s)}return e},n.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function Xae(n){return n instanceof $ae}function qae(n){for(var e=oi(),t=0;t<(n||[]).length;t++){var r=n[t],s=qr(r)?r.name:r;s!=null&&e.get(s)==null&&e.set(s,t)}return e}function Yae(n){var e=rBe(n);return e.dimNameMap||(e.dimNameMap=qae(n.dimensionsDefine))}function Zae(n){return n>30}var SA=qr,Rv=br,sBe=typeof Int32Array>"u"?Array:Int32Array,oBe="e\0\0",cZ=-1,aBe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],lBe=["_approximateExtent"],uZ,EI,AA,TA,Z3,II,K3,Kae=function(){function n(e,t){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var r,s=!1;Xae(e)?(r=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(s=!0,r=e),r=r||["x","y"];for(var o={},l=[],c={},a=!1,d={},f=0;f<r.length;f++){var m=r[f],_=Br(m)?new DP({name:m}):m instanceof DP?m:new DP(m),x=_.name;_.type=_.type||"float",_.coordDim||(_.coordDim=x,_.coordDimIndex=0);var A=_.otherDims=_.otherDims||{};l.push(x),o[x]=_,d[x]!=null&&(a=!0),_.createInvertedIndices&&(c[x]=[]),A.itemName===0&&(this._nameDimIdx=f),A.itemId===0&&(this._idDimIdx=f),s&&(_.storeDimIndex=f)}if(this.dimensions=l,this._dimInfos=o,this._initGetDimensionInfo(a),this.hostModel=t,this._invertedIndicesMap=c,this._dimOmitted){var I=this._dimIdxToName=oi();ot(l,function(E){I.set(o[E].storeDimIndex,E)})}}return n.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(t==null)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var r=this._dimIdxToName.get(t);if(r!=null)return r;var s=this._schema.getSourceDimension(t);if(s)return s.name},n.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(t!=null)return t;if(e==null)return-1;var r=this._getDimInfo(e);return r?r.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},n.prototype._recognizeDimIndex=function(e){if(Ds(e)||e!=null&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},n.prototype._getStoreDimIndex=function(e){var t=this.getDimensionIndex(e);return t},n.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},n.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(r){return t.hasOwnProperty(r)?t[r]:void 0}:function(r){return t[r]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(e,t){var r=this._dimSummary;if(t==null)return r.encodeFirstDimNotExtra[e];var s=r.encode[e];return s?s[t]:null},n.prototype.mapDimensionsAll=function(e){var t=this._dimSummary,r=t.encode[e];return(r||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(e,t,r){var s=this,o;if(e instanceof o5&&(o=e),!o){var l=this.dimensions,c=WG(e)||Dc(e)?new Zoe(e,l.length):e;o=new o5;var a=Rv(l,function(d){return{type:s._dimInfos[d].type,property:d}});o.initData(c,a,r)}this._store=o,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,o.count()),this._dimSummary=eBe(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},n.prototype.appendValues=function(e,t){var r=this._store.appendValues(e,t.length),s=r.start,o=r.end,l=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var c=s;c<o;c++){var a=c-s;this._nameList[c]=t[a],l&&K3(this,c)}},n.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,r=0;r<t.length;r++){var s=this._dimInfos[t[r]];s.ordinalMeta&&e.collectOrdinalMeta(s.storeDimIndex,s.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return this._idDimIdx==null&&e.getSource().sourceFormat!==v0&&!e.fillStorage},n.prototype._doInit=function(e,t){if(!(e>=t)){var r=this._store,s=r.getProvider();this._updateOrdinalMeta();var o=this._nameList,l=this._idList,c=s.getSource().sourceFormat,a=c===jh;if(a&&!s.pure)for(var d=[],f=e;f<t;f++){var m=s.getItem(f,d);if(!this.hasItemOption&&p2e(m)&&(this.hasItemOption=!0),m){var _=m.name;o[f]==null&&_!=null&&(o[f]=vp(_,null));var x=m.id;l[f]==null&&x!=null&&(l[f]=vp(x,null))}}if(this._shouldMakeIdFromName())for(var f=e;f<t;f++)K3(this,f);uZ(this)}},n.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},n.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},n.prototype.setCalculationInfo=function(e,t){SA(e)?Qn(this._calculationInfo,e):this._calculationInfo[e]=t},n.prototype.getName=function(e){var t=this.getRawIndex(e),r=this._nameList[t];return r==null&&this._nameDimIdx!=null&&(r=AA(this,this._nameDimIdx,t)),r==null&&(r=""),r},n.prototype._getCategory=function(e,t){var r=this._store.get(e,t),s=this._store.getOrdinalMeta(e);return s?s.categories[r]:r},n.prototype.getId=function(e){return EI(this,this.getRawIndex(e))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(e,t){var r=this._store,s=this._dimInfos[e];if(s)return r.get(s.storeDimIndex,t)},n.prototype.getByRawIndex=function(e,t){var r=this._store,s=this._dimInfos[e];if(s)return r.getByRawIndex(s.storeDimIndex,t)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},n.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},n.prototype.getValues=function(e,t){var r=this,s=this._store;return fr(e)?s.getValues(Rv(e,function(o){return r._getStoreDimIndex(o)}),t):s.getValues(e)},n.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,r=0,s=t.length;r<s;r++)if(isNaN(this._store.get(t[r],e)))return!1;return!0},n.prototype.indexOfName=function(e){for(var t=0,r=this._store.count();t<r;t++)if(this.getName(t)===e)return t;return-1},n.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},n.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},n.prototype.rawIndexOf=function(e,t){var r=e&&this._invertedIndicesMap[e],s=r[t];return s==null||isNaN(s)?cZ:s},n.prototype.indicesOfNearest=function(e,t,r){return this._store.indicesOfNearest(this._getStoreDimIndex(e),t,r)},n.prototype.each=function(e,t,r){hi(e)&&(r=t,t=e,e=[]);var s=r||this,o=Rv(TA(e),this._getStoreDimIndex,this);this._store.each(o,s?Vs(t,s):t)},n.prototype.filterSelf=function(e,t,r){hi(e)&&(r=t,t=e,e=[]);var s=r||this,o=Rv(TA(e),this._getStoreDimIndex,this);return this._store=this._store.filter(o,s?Vs(t,s):t),this},n.prototype.selectRange=function(e){var t=this,r={},s=lo(e);return ot(s,function(o){var l=t._getStoreDimIndex(o);r[l]=e[o]}),this._store=this._store.selectRange(r),this},n.prototype.mapArray=function(e,t,r){hi(e)&&(r=t,t=e,e=[]),r=r||this;var s=[];return this.each(e,function(){s.push(t&&t.apply(this,arguments))},r),s},n.prototype.map=function(e,t,r,s){var o=r||s||this,l=Rv(TA(e),this._getStoreDimIndex,this),c=II(this);return c._store=this._store.map(l,o?Vs(t,o):t),c},n.prototype.modify=function(e,t,r,s){var o=r||s||this,l=Rv(TA(e),this._getStoreDimIndex,this);this._store.modify(l,o?Vs(t,o):t)},n.prototype.downSample=function(e,t,r,s){var o=II(this);return o._store=this._store.downSample(this._getStoreDimIndex(e),t,r,s),o},n.prototype.lttbDownSample=function(e,t){var r=II(this);return r._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),r},n.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},n.prototype.getItemModel=function(e){var t=this.hostModel,r=this.getRawDataItem(e);return new Do(r,t,t&&t.ecModel)},n.prototype.diff=function(e){var t=this;return new GM(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(r){return EI(e,r)},function(r){return EI(t,r)})},n.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},n.prototype.setVisual=function(e,t){this._visual=this._visual||{},SA(e)?Qn(this._visual,e):this._visual[e]=t},n.prototype.getItemVisual=function(e,t){var r=this._itemVisuals[e],s=r&&r[t];return s??this.getVisual(t)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(e,t){var r=this._itemVisuals,s=r[e];s||(s=r[e]={});var o=s[t];return o==null&&(o=this.getVisual(t),fr(o)?o=o.slice():SA(o)&&(o=Qn({},o)),s[t]=o),o},n.prototype.setItemVisual=function(e,t,r){var s=this._itemVisuals[e]||{};this._itemVisuals[e]=s,SA(t)?Qn(s,t):s[t]=r},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(e,t){SA(e)?Qn(this._layout,e):this._layout[e]=t},n.prototype.getLayout=function(e){return this._layout[e]},n.prototype.getItemLayout=function(e){return this._itemLayouts[e]},n.prototype.setItemLayout=function(e,t,r){this._itemLayouts[e]=r?Qn(this._itemLayouts[e]||{},t):t},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(e,t){var r=this.hostModel&&this.hostModel.seriesIndex;CIe(r,this.dataType,e,t),this._graphicEls[e]=t},n.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},n.prototype.eachItemGraphicEl=function(e,t){ot(this._graphicEls,function(r,s){r&&e&&e.call(t,r,s)})},n.prototype.cloneShallow=function(e){return e||(e=new n(this._schema?this._schema:Rv(this.dimensions,this._getDimInfo,this),this.hostModel)),Z3(e,this),e._store=this._store,e},n.prototype.wrapMethod=function(e,t){var r=this[e];hi(r)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var s=r.apply(this,arguments);return t.apply(this,[s].concat(pG(arguments)))})},n.internalField=function(){uZ=function(e){var t=e._invertedIndicesMap;ot(t,function(r,s){var o=e._dimInfos[s],l=o.ordinalMeta,c=e._store;if(l){r=t[s]=new sBe(l.categories.length);for(var a=0;a<r.length;a++)r[a]=cZ;for(var a=0;a<c.count();a++)r[c.get(o.storeDimIndex,a)]=a}})},AA=function(e,t,r){return vp(e._getCategory(t,r),null)},EI=function(e,t){var r=e._idList[t];return r==null&&e._idDimIdx!=null&&(r=AA(e,e._idDimIdx,t)),r==null&&(r=oBe+t),r},TA=function(e){return fr(e)||(e=e!=null?[e]:[]),e},II=function(e){var t=new n(e._schema?e._schema:Rv(e.dimensions,e._getDimInfo,e),e.hostModel);return Z3(t,e),t},Z3=function(e,t){ot(aBe.concat(t.__wrappedMethods||[]),function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e.__wrappedMethods=t.__wrappedMethods,ot(lBe,function(r){e[r]=wi(t[r])}),e._calculationInfo=Qn({},t._calculationInfo)},K3=function(e,t){var r=e._nameList,s=e._idList,o=e._nameDimIdx,l=e._idDimIdx,c=r[t],a=s[t];if(c==null&&o!=null&&(r[t]=c=AA(e,o,t)),a==null&&l!=null&&(s[t]=a=AA(e,l,t)),a==null&&c!=null){var d=e._nameRepeatCount,f=d[c]=(d[c]||0)+1;a=c,f>1&&(a+="__ec__"+f),s[t]=a}}}(),n}();function Jae(n,e){WG(n)||(n=Xoe(n)),e=e||{};var t=e.coordDimensions||[],r=e.dimensionsDefine||n.dimensionsDefine||[],s=oi(),o=[],l=uBe(n,t,r,e.dimensionsCount),c=e.canOmitUnusedDimensions&&Zae(l),a=r===n.dimensionsDefine,d=a?Yae(n):qae(r),f=e.encodeDefine;!f&&e.encodeDefaulter&&(f=e.encodeDefaulter(n,l));for(var m=oi(f),_=new iae(l),x=0;x<_.length;x++)_[x]=-1;function A(se){var ae=_[se];if(ae<0){var he=r[se],Ae=qr(he)?he:{name:he},Ee=new DP,Pe=Ae.name;Pe!=null&&d.get(Pe)!=null&&(Ee.name=Ee.displayName=Pe),Ae.type!=null&&(Ee.type=Ae.type),Ae.displayName!=null&&(Ee.displayName=Ae.displayName);var ze=o.length;return _[se]=ze,Ee.storeDimIndex=se,o.push(Ee),Ee}return o[ae]}if(!c)for(var x=0;x<l;x++)A(x);m.each(function(se,ae){var he=va(se).slice();if(he.length===1&&!Br(he[0])&&he[0]<0){m.set(ae,!1);return}var Ae=m.set(ae,[]);ot(he,function(Ee,Pe){var ze=Br(Ee)?d.get(Ee):Ee;ze!=null&&ze<l&&(Ae[Pe]=ze,E(A(ze),ae,Pe))})});var I=0;ot(t,function(se){var ae,he,Ae,Ee;if(Br(se))ae=se,Ee={};else{Ee=se,ae=Ee.name;var Pe=Ee.ordinalMeta;Ee.ordinalMeta=null,Ee=Qn({},Ee),Ee.ordinalMeta=Pe,he=Ee.dimsDef,Ae=Ee.otherDims,Ee.name=Ee.coordDim=Ee.coordDimIndex=Ee.dimsDef=Ee.otherDims=null}var ze=m.get(ae);if(ze!==!1){if(ze=va(ze),!ze.length)for(var Re=0;Re<(he&&he.length||1);Re++){for(;I<l&&A(I).coordDim!=null;)I++;I<l&&ze.push(I++)}ot(ze,function(rt,ye){var We=A(rt);if(a&&Ee.type!=null&&(We.type=Ee.type),E(ri(We,Ee),ae,ye),We.name==null&&he){var Ue=he[ye];!qr(Ue)&&(Ue={name:Ue}),We.name=We.displayName=Ue.name,We.defaultTooltip=Ue.defaultTooltip}Ae&&ri(We.otherDims,Ae)})}});function E(se,ae,he){zoe.get(ae)!=null?se.otherDims[ae]=he:(se.coordDim=ae,se.coordDimIndex=he,s.set(ae,!0))}var C=e.generateCoord,L=e.generateCoordCount,O=L!=null;L=C?L||1:0;var H=C||"value";function q(se){se.name==null&&(se.name=se.coordDim)}if(c)ot(o,function(se){q(se)}),o.sort(function(se,ae){return se.storeDimIndex-ae.storeDimIndex});else for(var Z=0;Z<l;Z++){var J=A(Z),re=J.coordDim;re==null&&(J.coordDim=hBe(H,s,O),J.coordDimIndex=0,(!C||L<=0)&&(J.isExtraCoord=!0),L--),q(J),J.type==null&&(Voe(n,Z)===bl.Must||J.isExtraCoord&&(J.otherDims.itemName!=null||J.otherDims.seriesName!=null))&&(J.type="ordinal")}return cBe(o),new $ae({source:n,dimensions:o,fullDimensionCount:l,dimensionOmitted:c})}function cBe(n){for(var e=oi(),t=0;t<n.length;t++){var r=n[t],s=r.name,o=e.get(s)||0;o>0&&(r.name=s+(o-1)),o++,e.set(s,o)}}function uBe(n,e,t,r){var s=Math.max(n.dimensionsDetectedCount||1,e.length,t.length,r||0);return ot(e,function(o){var l;qr(o)&&(l=o.dimsDef)&&(s=Math.max(s,l.length))}),s}function hBe(n,e,t){if(t||e.hasKey(n)){for(var r=0;e.hasKey(n+r);)r++;n+=r}return e.set(n,!0),n}var dBe=function(){function n(e){this.coordSysDims=[],this.axisMap=oi(),this.categoryAxisMap=oi(),this.coordSysName=e}return n}();function fBe(n){var e=n.get("coordinateSystem"),t=new dBe(e),r=pBe[e];if(r)return r(n,t,t.axisMap,t.categoryAxisMap),t}var pBe={cartesian2d:function(n,e,t,r){var s=n.getReferringComponents("xAxis",Sl).models[0],o=n.getReferringComponents("yAxis",Sl).models[0];e.coordSysDims=["x","y"],t.set("x",s),t.set("y",o),tb(s)&&(r.set("x",s),e.firstCategoryDimIndex=0),tb(o)&&(r.set("y",o),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(n,e,t,r){var s=n.getReferringComponents("singleAxis",Sl).models[0];e.coordSysDims=["single"],t.set("single",s),tb(s)&&(r.set("single",s),e.firstCategoryDimIndex=0)},polar:function(n,e,t,r){var s=n.getReferringComponents("polar",Sl).models[0],o=s.findAxisModel("radiusAxis"),l=s.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",o),t.set("angle",l),tb(o)&&(r.set("radius",o),e.firstCategoryDimIndex=0),tb(l)&&(r.set("angle",l),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(n,e,t,r){e.coordSysDims=["lng","lat"]},parallel:function(n,e,t,r){var s=n.ecModel,o=s.getComponent("parallel",n.get("parallelIndex")),l=e.coordSysDims=o.dimensions.slice();ot(o.parallelAxisIndex,function(c,a){var d=s.getComponent("parallelAxis",c),f=l[a];t.set(f,d),tb(d)&&(r.set(f,d),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=a))})}};function tb(n){return n.get("type")==="category"}function mBe(n,e,t){t=t||{};var r=t.byIndex,s=t.stackedCoordDimension,o,l,c;gBe(e)?o=e:(l=e.schema,o=l.dimensions,c=e.store);var a=!!(n&&n.get("stack")),d,f,m,_;if(ot(o,function(L,O){Br(L)&&(o[O]=L={name:L}),a&&!L.isExtraCoord&&(!r&&!d&&L.ordinalMeta&&(d=L),!f&&L.type!=="ordinal"&&L.type!=="time"&&(!s||s===L.coordDim)&&(f=L))}),f&&!r&&!d&&(r=!0),f){m="__\0ecstackresult_"+n.id,_="__\0ecstackedover_"+n.id,d&&(d.createInvertedIndices=!0);var x=f.coordDim,A=f.type,I=0;ot(o,function(L){L.coordDim===x&&I++});var E={name:m,coordDim:x,coordDimIndex:I,type:A,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length},C={name:_,coordDim:_,coordDimIndex:I+1,type:A,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length+1};l?(c&&(E.storeDimIndex=c.ensureCalculationDimension(_,A),C.storeDimIndex=c.ensureCalculationDimension(m,A)),l.appendCalculationDimension(E),l.appendCalculationDimension(C)):(o.push(E),o.push(C))}return{stackedDimension:f&&f.name,stackedByDimension:d&&d.name,isStackedByIndex:r,stackedOverDimension:_,stackResultDimension:m}}function gBe(n){return!Xae(n.schema)}function bx(n,e){return!!e&&e===n.getCalculationInfo("stackedDimension")}function vBe(n,e){return bx(n,e)?n.getCalculationInfo("stackResultDimension"):e}function _Be(n,e){var t=n.get("coordinateSystem"),r=jG.get(t),s;return e&&e.coordSysDims&&(s=br(e.coordSysDims,function(o){var l={name:o},c=e.axisMap.get(o);if(c){var a=c.get("type");l.type=tBe(a)}return l})),s||(s=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),s}function yBe(n,e,t){var r,s;return t&&ot(n,function(o,l){var c=o.coordDim,a=t.categoryAxisMap.get(c);a&&(r==null&&(r=l),o.ordinalMeta=a.getOrdinalMeta(),e&&(o.createInvertedIndices=!0)),o.otherDims.itemName!=null&&(s=!0)}),!s&&r!=null&&(n[r].otherDims.itemName=0),r}function t8(n,e,t){t=t||{};var r=e.getSourceManager(),s,o=!1;s=r.getSource(),o=s.sourceFormat===jh;var l=fBe(e),c=_Be(e,l),a=t.useEncodeDefaulter,d=hi(a)?a:a?xs(fRe,c,e):null,f={coordDimensions:c,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:d,canOmitUnusedDimensions:!o},m=Jae(s,f),_=yBe(m.dimensions,t.createInvertedIndices,l),x=o?null:r.getSharedDataStore(m),A=mBe(e,{schema:m,store:x}),I=new Kae(m,e);I.setCalculationInfo(A);var E=_!=null&&xBe(s)?function(C,L,O,H){return H===_?O:this.defaultDimValueGetter(C,L,O,H)}:null;return I.hasItemOption=!1,I.initData(o?s:x,null,E),I}function xBe(n){if(n.sourceFormat===jh){var e=bBe(n.data||[]);return!fr(DC(e))}}function bBe(n){for(var e=0;e<n.length&&n[e]==null;)e++;return n[e]}var Ip=function(){function n(e){this._setting=e||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(e){return this._setting[e]},n.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},n.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(e,t){var r=this._extent;isNaN(e)||(r[0]=e),isNaN(t)||(r[1]=t)},n.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(e){this._isBlank=e},n}();dB(Ip);var wBe=0,y5=function(){function n(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++wBe}return n.createByAxisModel=function(e){var t=e.option,r=t.data,s=r&&br(r,SBe);return new n({categories:s,needCollect:!s,deduplication:t.dedplication!==!1})},n.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},n.prototype.parseAndCollect=function(e){var t,r=this._needCollect;if(!Br(e)&&!r)return e;if(r&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var s=this._getOrCreateMap();return t=s.get(e),t==null&&(r?(t=this.categories.length,this.categories[t]=e,s.set(e,t)):t=NaN),t},n.prototype._getOrCreateMap=function(){return this._map||(this._map=oi(this.categories))},n}();function SBe(n){return qr(n)&&n.value!=null?n.value:n+""}function x5(n){return n.type==="interval"||n.type==="log"}function ABe(n,e,t,r){var s={},o=n[1]-n[0],l=s.interval=bse(o/e);t!=null&&l<t&&(l=s.interval=t),r!=null&&l>r&&(l=s.interval=r);var c=s.intervalPrecision=Qae(l),a=s.niceTickExtent=[Ca(Math.ceil(n[0]/l)*l,c),Ca(Math.floor(n[1]/l)*l,c)];return TBe(a,n),s}function J3(n){var e=Math.pow(10,yG(n)),t=n/e;return t?t===2?t=3:t===3?t=5:t*=2:t=1,Ca(t*e)}function Qae(n){return Um(n)+2}function hZ(n,e,t){n[e]=Math.max(Math.min(n[e],t[1]),t[0])}function TBe(n,e){!isFinite(n[0])&&(n[0]=e[0]),!isFinite(n[1])&&(n[1]=e[1]),hZ(n,0,e),hZ(n,1,e),n[0]>n[1]&&(n[0]=n[1])}function FB(n,e){return n>=e[0]&&n<=e[1]}function NB(n,e){return e[1]===e[0]?.5:(n-e[0])/(e[1]-e[0])}function zB(n,e){return n*(e[1]-e[0])+e[0]}var n8=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;r.type="ordinal";var s=r.getSetting("ordinalMeta");return s||(s=new y5({})),fr(s)&&(s=new y5({categories:br(s,function(o){return qr(o)?o.value:o})})),r._ordinalMeta=s,r._extent=r.getSetting("extent")||[0,s.categories.length-1],r}return e.prototype.parse=function(t){return t==null?NaN:Br(t)?this._ordinalMeta.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return t=this.parse(t),FB(t,this._extent)&&this._ordinalMeta.categories[t]!=null},e.prototype.normalize=function(t){return t=this._getTickNumber(this.parse(t)),NB(t,this._extent)},e.prototype.scale=function(t){return t=Math.round(zB(t,this._extent)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],r=this._extent,s=r[0];s<=r[1];)t.push({value:s}),s++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(t==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var r=t.ordinalNumbers,s=this._ordinalNumbersByTick=[],o=this._ticksByOrdinalNumber=[],l=0,c=this._ordinalMeta.categories.length,a=Math.min(c,r.length);l<a;++l){var d=r[l];s[l]=d,o[d]=l}for(var f=0;l<c;++l){for(;o[f]!=null;)f++;s.push(f),o[f]=l}},e.prototype._getTickNumber=function(t){var r=this._ticksByOrdinalNumber;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getRawOrdinalNumber=function(t){var r=this._ordinalNumbersByTick;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var r=this.getRawOrdinalNumber(t.value),s=this._ordinalMeta.categories[r];return s==null?"":s+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.isInExtentRange=function(t){return t=this._getTickNumber(t),this._extent[0]<=t&&this._extent[1]>=t},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(Ip);Ip.registerClass(n8);var uy=Ca,Zw=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return FB(t,this._extent)},e.prototype.normalize=function(t){return NB(t,this._extent)},e.prototype.scale=function(t){return zB(t,this._extent)},e.prototype.setExtent=function(t,r){var s=this._extent;isNaN(t)||(s[0]=parseFloat(t)),isNaN(r)||(s[1]=parseFloat(r))},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1]),this.setExtent(r[0],r[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=Qae(t)},e.prototype.getTicks=function(t){var r=this._interval,s=this._extent,o=this._niceExtent,l=this._intervalPrecision,c=[];if(!r)return c;var a=1e4;s[0]<o[0]&&(t?c.push({value:uy(o[0]-r,l)}):c.push({value:s[0]}));for(var d=o[0];d<=o[1]&&(c.push({value:d}),d=uy(d+r,l),d!==c[c.length-1].value);)if(c.length>a)return[];var f=c.length?c[c.length-1].value:o[1];return s[1]>f&&(t?c.push({value:uy(f+r,l)}):c.push({value:s[1]})),c},e.prototype.getMinorTicks=function(t){for(var r=this.getTicks(!0),s=[],o=this.getExtent(),l=1;l<r.length;l++){for(var c=r[l],a=r[l-1],d=0,f=[],m=c.value-a.value,_=m/t;d<t-1;){var x=uy(a.value+(d+1)*_);x>o[0]&&x<o[1]&&f.push(x),d++}s.push(f)}return s},e.prototype.getLabel=function(t,r){if(t==null)return"";var s=r&&r.precision;s==null?s=Um(t.value)||0:s==="auto"&&(s=this._intervalPrecision);var o=uy(t.value,s,!0);return koe(o)},e.prototype.calcNiceTicks=function(t,r,s){t=t||5;var o=this._extent,l=o[1]-o[0];if(isFinite(l)){l<0&&(l=-l,o.reverse());var c=ABe(o,t,r,s);this._intervalPrecision=c.intervalPrecision,this._interval=c.interval,this._niceExtent=c.niceTickExtent}},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1])if(r[0]!==0){var s=Math.abs(r[0]);t.fixMax||(r[1]+=s/2),r[0]-=s/2}else r[1]=1;var o=r[1]-r[0];isFinite(o)||(r[0]=0,r[1]=1),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval);var l=this._interval;t.fixMin||(r[0]=uy(Math.floor(r[0]/l)*l)),t.fixMax||(r[1]=uy(Math.ceil(r[1]/l)*l))},e.prototype.setNiceExtent=function(t,r){this._niceExtent=[t,r]},e.type="interval",e}(Ip);Ip.registerClass(Zw);var ele=typeof Float32Array<"u",MBe=ele?Float32Array:Array;function Vm(n){return fr(n)?ele?new Float32Array(n):n:new MBe(n)}var CBe="__ec_stack_";function r8(n){return n.get("stack")||CBe+n.seriesIndex}function i8(n){return n.dim+n.index}function tle(n,e){var t=[];return e.eachSeriesByType(n,function(r){rle(r)&&t.push(r)}),t}function EBe(n){var e={};ot(n,function(a){var d=a.coordinateSystem,f=d.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var m=a.getData(),_=f.dim+"_"+f.index,x=m.getDimensionIndex(m.mapDimension(f.dim)),A=m.getStore(),I=0,E=A.count();I<E;++I){var C=A.get(x,I);e[_]?e[_].push(C):e[_]=[C]}});var t={};for(var r in e)if(e.hasOwnProperty(r)){var s=e[r];if(s){s.sort(function(a,d){return a-d});for(var o=null,l=1;l<s.length;++l){var c=s[l]-s[l-1];c>0&&(o=o===null?c:Math.min(o,c))}t[r]=o}}return t}function nle(n){var e=EBe(n),t=[];return ot(n,function(r){var s=r.coordinateSystem,o=s.getBaseAxis(),l=o.getExtent(),c;if(o.type==="category")c=o.getBandWidth();else if(o.type==="value"||o.type==="time"){var a=o.dim+"_"+o.index,d=e[a],f=Math.abs(l[1]-l[0]),m=o.scale.getExtent(),_=Math.abs(m[1]-m[0]);c=d?f/_*d:f}else{var x=r.getData();c=Math.abs(l[1]-l[0])/x.count()}var A=hs(r.get("barWidth"),c),I=hs(r.get("barMaxWidth"),c),E=hs(r.get("barMinWidth")||(ile(r)?.5:1),c),C=r.get("barGap"),L=r.get("barCategoryGap");t.push({bandWidth:c,barWidth:A,barMaxWidth:I,barMinWidth:E,barGap:C,barCategoryGap:L,axisKey:i8(o),stackId:r8(r)})}),IBe(t)}function IBe(n){var e={};ot(n,function(r,s){var o=r.axisKey,l=r.bandWidth,c=e[o]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},a=c.stacks;e[o]=c;var d=r.stackId;a[d]||c.autoWidthCount++,a[d]=a[d]||{width:0,maxWidth:0};var f=r.barWidth;f&&!a[d].width&&(a[d].width=f,f=Math.min(c.remainedWidth,f),c.remainedWidth-=f);var m=r.barMaxWidth;m&&(a[d].maxWidth=m);var _=r.barMinWidth;_&&(a[d].minWidth=_);var x=r.barGap;x!=null&&(c.gap=x);var A=r.barCategoryGap;A!=null&&(c.categoryGap=A)});var t={};return ot(e,function(r,s){t[s]={};var o=r.stacks,l=r.bandWidth,c=r.categoryGap;if(c==null){var a=lo(o).length;c=Math.max(35-a*4,15)+"%"}var d=hs(c,l),f=hs(r.gap,1),m=r.remainedWidth,_=r.autoWidthCount,x=(m-d)/(_+(_-1)*f);x=Math.max(x,0),ot(o,function(C){var L=C.maxWidth,O=C.minWidth;if(C.width){var H=C.width;L&&(H=Math.min(H,L)),O&&(H=Math.max(H,O)),C.width=H,m-=H+f*H,_--}else{var H=x;L&&L<H&&(H=Math.min(L,m)),O&&O>H&&(H=O),H!==x&&(C.width=H,m-=H+f*H,_--)}}),x=(m-d)/(_+(_-1)*f),x=Math.max(x,0);var A=0,I;ot(o,function(C,L){C.width||(C.width=x),I=C,A+=C.width*(1+f)}),I&&(A-=I.width*f);var E=-A/2;ot(o,function(C,L){t[s][L]=t[s][L]||{bandWidth:l,offset:E,width:C.width},E+=C.width*(1+f)})}),t}function PBe(n,e,t){if(n&&e){var r=n[i8(e)];return r!=null&&t!=null?r[r8(t)]:r}}function RBe(n,e){var t=tle(n,e),r=nle(t);ot(t,function(s){var o=s.getData(),l=s.coordinateSystem,c=l.getBaseAxis(),a=r8(s),d=r[i8(c)][a],f=d.offset,m=d.width;o.setLayout({bandWidth:d.bandWidth,offset:f,size:m})})}function LBe(n){return{seriesType:n,plan:qG(),reset:function(e){if(rle(e)){var t=e.getData(),r=e.coordinateSystem,s=r.getBaseAxis(),o=r.getOtherAxis(s),l=t.getDimensionIndex(t.mapDimension(o.dim)),c=t.getDimensionIndex(t.mapDimension(s.dim)),a=e.get("showBackground",!0),d=t.mapDimension(o.dim),f=t.getCalculationInfo("stackResultDimension"),m=bx(t,d)&&!!t.getCalculationInfo("stackedOnSeries"),_=o.isHorizontal(),x=DBe(s,o),A=ile(e),I=e.get("barMinHeight")||0,E=f&&t.getDimensionIndex(f),C=t.getLayout("size"),L=t.getLayout("offset");return{progress:function(O,H){for(var q=O.count,Z=A&&Vm(q*3),J=A&&a&&Vm(q*3),re=A&&Vm(q),se=r.master.getRect(),ae=_?se.width:se.height,he,Ae=H.getStore(),Ee=0;(he=O.next())!=null;){var Pe=Ae.get(m?E:l,he),ze=Ae.get(c,he),Re=x,rt=void 0;m&&(rt=+Pe-Ae.get(l,he));var ye=void 0,We=void 0,Ue=void 0,gt=void 0;if(_){var vt=r.dataToPoint([Pe,ze]);if(m){var Dt=r.dataToPoint([rt,ze]);Re=Dt[0]}ye=Re,We=vt[1]+L,Ue=vt[0]-Re,gt=C,Math.abs(Ue)<I&&(Ue=(Ue<0?-1:1)*I)}else{var vt=r.dataToPoint([ze,Pe]);if(m){var Dt=r.dataToPoint([ze,rt]);Re=Dt[1]}ye=vt[0]+L,We=Re,Ue=C,gt=vt[1]-Re,Math.abs(gt)<I&&(gt=(gt<=0?-1:1)*I)}A?(Z[Ee]=ye,Z[Ee+1]=We,Z[Ee+2]=_?Ue:gt,J&&(J[Ee]=_?se.x:ye,J[Ee+1]=_?We:se.y,J[Ee+2]=ae),re[he]=he):H.setItemLayout(he,{x:ye,y:We,width:Ue,height:gt}),Ee+=3}A&&H.setLayout({largePoints:Z,largeDataIndices:re,largeBackgroundPoints:J,valueAxisHorizontal:_})}}}}}}function rle(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function ile(n){return n.pipelineContext&&n.pipelineContext.large}function DBe(n,e){var t=e.model.get("startValue");return t||(t=0),e.toGlobalCoord(e.dataToCoord(e.type==="log"?t>0?t:1:t))}var BBe=function(n,e,t,r){for(;t<r;){var s=t+r>>>1;n[s][1]<e?t=s+1:r=s}return t},sle=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="time",r}return e.prototype.getLabel=function(t){var r=this.getSetting("useUTC");return CB(t.value,tY[nRe(nw(this._minLevelUnit))]||tY.second,r,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,r,s){var o=this.getSetting("useUTC"),l=this.getSetting("locale");return rRe(t,r,s,l,o)},e.prototype.getTicks=function(){var t=this._interval,r=this._extent,s=[];if(!t)return s;s.push({value:r[0],level:0});var o=this.getSetting("useUTC"),l=GBe(this._minLevelUnit,this._approxInterval,o,r);return s=s.concat(l),s.push({value:r[1],level:0}),s},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1]&&(r[0]-=Eh,r[1]+=Eh),r[1]===-1/0&&r[0]===1/0){var s=new Date;r[1]=+new Date(s.getFullYear(),s.getMonth(),s.getDate()),r[0]=r[1]-Eh}this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.calcNiceTicks=function(t,r,s){t=t||10;var o=this._extent,l=o[1]-o[0];this._approxInterval=l/t,r!=null&&this._approxInterval<r&&(this._approxInterval=r),s!=null&&this._approxInterval>s&&(this._approxInterval=s);var c=PI.length,a=Math.min(BBe(PI,this._approxInterval,0,c),c-1);this._interval=PI[a][1],this._minLevelUnit=PI[Math.max(a-1,0)][0]},e.prototype.parse=function(t){return Ds(t)?t:+ag(t)},e.prototype.contain=function(t){return FB(this.parse(t),this._extent)},e.prototype.normalize=function(t){return NB(this.parse(t),this._extent)},e.prototype.scale=function(t){return zB(t,this._extent)},e.type="time",e}(Zw),PI=[["second",FG],["minute",NG],["hour",kT],["quarter-day",kT*6],["half-day",kT*12],["day",Eh*1.2],["half-week",Eh*3.5],["week",Eh*7],["month",Eh*31],["quarter",Eh*95],["half-year",eY/2],["year",eY]];function kBe(n,e,t,r){var s=ag(e),o=ag(t),l=function(A){return nY(s,A,r)===nY(o,A,r)},c=function(){return l("year")},a=function(){return c()&&l("month")},d=function(){return a()&&l("day")},f=function(){return d()&&l("hour")},m=function(){return f()&&l("minute")},_=function(){return m()&&l("second")},x=function(){return _()&&l("millisecond")};switch(n){case"year":return c();case"month":return a();case"day":return d();case"hour":return f();case"minute":return m();case"second":return _();case"millisecond":return x()}}function OBe(n,e){return n/=Eh,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function FBe(n){var e=30*Eh;return n/=e,n>6?6:n>3?3:n>2?2:1}function NBe(n){return n/=kT,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function dZ(n,e){return n/=e?NG:FG,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function zBe(n){return bse(n)}function UBe(n,e,t){var r=new Date(n);switch(nw(e)){case"year":case"month":r[Ioe(t)](0);case"day":r[Poe(t)](1);case"hour":r[Roe(t)](0);case"minute":r[Loe(t)](0);case"second":r[Doe(t)](0),r[Boe(t)](0)}return r.getTime()}function GBe(n,e,t,r){var s=1e4,o=Coe,l=0;function c(ae,he,Ae,Ee,Pe,ze,Re){for(var rt=new Date(he),ye=he,We=rt[Ee]();ye<Ae&&ye<=r[1];)Re.push({value:ye}),We+=ae,rt[Pe](We),ye=rt.getTime();Re.push({value:ye,notAdd:!0})}function a(ae,he,Ae){var Ee=[],Pe=!he.length;if(!kBe(nw(ae),r[0],r[1],t)){Pe&&(he=[{value:UBe(new Date(r[0]),ae,t)},{value:r[1]}]);for(var ze=0;ze<he.length-1;ze++){var Re=he[ze].value,rt=he[ze+1].value;if(Re!==rt){var ye=void 0,We=void 0,Ue=void 0,gt=!1;switch(ae){case"year":ye=Math.max(1,Math.round(e/Eh/365)),We=zG(t),Ue=iRe(t);break;case"half-year":case"quarter":case"month":ye=FBe(e),We=rw(t),Ue=Ioe(t);break;case"week":case"half-week":case"day":ye=OBe(e),We=EB(t),Ue=Poe(t),gt=!0;break;case"half-day":case"quarter-day":case"hour":ye=NBe(e),We=kM(t),Ue=Roe(t);break;case"minute":ye=dZ(e,!0),We=IB(t),Ue=Loe(t);break;case"second":ye=dZ(e,!1),We=PB(t),Ue=Doe(t);break;case"millisecond":ye=zBe(e),We=RB(t),Ue=Boe(t);break}c(ye,Re,rt,We,Ue,gt,Ee),ae==="year"&&Ae.length>1&&ze===0&&Ae.unshift({value:Ae[0].value-ye})}}for(var ze=0;ze<Ee.length;ze++)Ae.push(Ee[ze]);return Ee}}for(var d=[],f=[],m=0,_=0,x=0;x<o.length&&l++<s;++x){var A=nw(o[x]);if(tRe(o[x])){a(o[x],d[d.length-1]||[],f);var I=o[x+1]?nw(o[x+1]):null;if(A!==I){if(f.length){_=m,f.sort(function(ae,he){return ae.value-he.value});for(var E=[],C=0;C<f.length;++C){var L=f[C].value;(C===0||f[C-1].value!==L)&&(E.push(f[C]),L>=r[0]&&L<=r[1]&&m++)}var O=(r[1]-r[0])/e;if(m>O*1.5&&_>O/1.5||(d.push(E),m>O||n===o[x]))break}f=[]}}}for(var H=sa(br(d,function(ae){return sa(ae,function(he){return he.value>=r[0]&&he.value<=r[1]&&!he.notAdd})}),function(ae){return ae.length>0}),q=[],Z=H.length-1,x=0;x<H.length;++x)for(var J=H[x],re=0;re<J.length;++re)q.push({value:J[re].value,level:Z-x});q.sort(function(ae,he){return ae.value-he.value});for(var se=[],x=0;x<q.length;++x)(x===0||q[x].value!==q[x-1].value)&&se.push(q[x]);return se}Ip.registerClass(sle);var fZ=Ip.prototype,zT=Zw.prototype,VBe=Ca,HBe=Math.floor,jBe=Math.ceil,RI=Math.pow,kd=Math.log,s8=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new Zw,t._interval=0,t}return e.prototype.getTicks=function(t){var r=this._originalScale,s=this._extent,o=r.getExtent(),l=zT.getTicks.call(this,t);return br(l,function(c){var a=c.value,d=Ca(RI(this.base,a));return d=a===s[0]&&this._fixMin?LI(d,o[0]):d,d=a===s[1]&&this._fixMax?LI(d,o[1]):d,{value:d}},this)},e.prototype.setExtent=function(t,r){var s=kd(this.base);t=kd(Math.max(0,t))/s,r=kd(Math.max(0,r))/s,zT.setExtent.call(this,t,r)},e.prototype.getExtent=function(){var t=this.base,r=fZ.getExtent.call(this);r[0]=RI(t,r[0]),r[1]=RI(t,r[1]);var s=this._originalScale,o=s.getExtent();return this._fixMin&&(r[0]=LI(r[0],o[0])),this._fixMax&&(r[1]=LI(r[1],o[1])),r},e.prototype.unionExtent=function(t){this._originalScale.unionExtent(t);var r=this.base;t[0]=kd(t[0])/kd(r),t[1]=kd(t[1])/kd(r),fZ.unionExtent.call(this,t)},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.calcNiceTicks=function(t){t=t||10;var r=this._extent,s=r[1]-r[0];if(!(s===1/0||s<=0)){var o=d2e(s),l=t/s*o;for(l<=.5&&(o*=10);!isNaN(o)&&Math.abs(o)<1&&Math.abs(o)>0;)o*=10;var c=[Ca(jBe(r[0]/o)*o),Ca(HBe(r[1]/o)*o)];this._interval=o,this._niceExtent=c}},e.prototype.calcNiceExtent=function(t){zT.calcNiceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return t=kd(t)/kd(this.base),FB(t,this._extent)},e.prototype.normalize=function(t){return t=kd(t)/kd(this.base),NB(t,this._extent)},e.prototype.scale=function(t){return t=zB(t,this._extent),RI(this.base,t)},e.type="log",e}(Ip),ole=s8.prototype;ole.getMinorTicks=zT.getMinorTicks;ole.getLabel=zT.getLabel;function LI(n,e){return VBe(n,Um(e))}Ip.registerClass(s8);var WBe=function(){function n(e,t,r){this._prepareParams(e,t,r)}return n.prototype._prepareParams=function(e,t,r){r[1]<r[0]&&(r=[NaN,NaN]),this._dataMin=r[0],this._dataMax=r[1];var s=this._isOrdinal=e.type==="ordinal";this._needCrossZero=e.type==="interval"&&t.getNeedCrossZero&&t.getNeedCrossZero();var o=t.get("min",!0);o==null&&(o=t.get("startValue",!0));var l=this._modelMinRaw=o;hi(l)?this._modelMinNum=DI(e,l({min:r[0],max:r[1]})):l!=="dataMin"&&(this._modelMinNum=DI(e,l));var c=this._modelMaxRaw=t.get("max",!0);if(hi(c)?this._modelMaxNum=DI(e,c({min:r[0],max:r[1]})):c!=="dataMax"&&(this._modelMaxNum=DI(e,c)),s)this._axisDataLen=t.getCategories().length;else{var a=t.get("boundaryGap"),d=fr(a)?a:[a||0,a||0];typeof d[0]=="boolean"||typeof d[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[C0(d[0],1),C0(d[1],1)]}},n.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,r=this._dataMax,s=this._axisDataLen,o=this._boundaryGapInner,l=e?null:r-t||Math.abs(t),c=this._modelMinRaw==="dataMin"?t:this._modelMinNum,a=this._modelMaxRaw==="dataMax"?r:this._modelMaxNum,d=c!=null,f=a!=null;c==null&&(c=e?s?0:NaN:t-o[0]*l),a==null&&(a=e?s?s-1:NaN:r+o[1]*l),(c==null||!isFinite(c))&&(c=NaN),(a==null||!isFinite(a))&&(a=NaN);var m=QR(c)||QR(a)||e&&!s;this._needCrossZero&&(c>0&&a>0&&!d&&(c=0),c<0&&a<0&&!f&&(a=0));var _=this._determinedMin,x=this._determinedMax;return _!=null&&(c=_,d=!0),x!=null&&(a=x,f=!0),{min:c,max:a,minFixed:d,maxFixed:f,isBlank:m}},n.prototype.modifyDataMinMax=function(e,t){this[XBe[e]]=t},n.prototype.setDeterminedMinMax=function(e,t){var r=$Be[e];this[r]=t},n.prototype.freeze=function(){this.frozen=!0},n}(),$Be={min:"_determinedMin",max:"_determinedMax"},XBe={min:"_dataMin",max:"_dataMax"};function ale(n,e,t){var r=n.rawExtentInfo;return r||(r=new WBe(n,e,t),n.rawExtentInfo=r,r)}function DI(n,e){return e==null?null:QR(e)?NaN:n.parse(e)}function lle(n,e){var t=n.type,r=ale(n,e,n.getExtent()).calculate();n.setBlank(r.isBlank);var s=r.min,o=r.max,l=e.ecModel;if(l&&t==="time"){var c=tle("bar",l),a=!1;if(ot(c,function(m){a=a||m.getBaseAxis()===e.axis}),a){var d=nle(c),f=qBe(s,o,e,d);s=f.min,o=f.max}}return{extent:[s,o],fixMin:r.minFixed,fixMax:r.maxFixed}}function qBe(n,e,t,r){var s=t.axis.getExtent(),o=s[1]-s[0],l=PBe(r,t.axis);if(l===void 0)return{min:n,max:e};var c=1/0;ot(l,function(x){c=Math.min(x.offset,c)});var a=-1/0;ot(l,function(x){a=Math.max(x.offset+x.width,a)}),c=Math.abs(c),a=Math.abs(a);var d=c+a,f=e-n,m=1-(c+a)/o,_=f/m-f;return e+=_*(a/d),n-=_*(c/d),{min:n,max:e}}function TL(n,e){var t=e,r=lle(n,t),s=r.extent,o=t.get("splitNumber");n instanceof s8&&(n.base=t.get("logBase"));var l=n.type,c=t.get("interval"),a=l==="interval"||l==="time";n.setExtent(s[0],s[1]),n.calcNiceExtent({splitNumber:o,fixMin:r.fixMin,fixMax:r.fixMax,minInterval:a?t.get("minInterval"):null,maxInterval:a?t.get("maxInterval"):null}),c!=null&&n.setInterval&&n.setInterval(c)}function cle(n,e){if(e=e||n.get("type"),e)switch(e){case"category":return new n8({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new sle({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(Ip.getClass(e)||Zw)}}function YBe(n){var e=n.scale.getExtent(),t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function Kw(n){var e=n.getLabelModel().get("formatter"),t=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(r){return function(s,o){return n.scale.getFormattedLabel(s,o,r)}}(e):Br(e)?function(r){return function(s){var o=n.scale.getLabel(s),l=r.replace("{value}",o??"");return l}}(e):hi(e)?function(r){return function(s,o){return t!=null&&(o=s.value-t),r(o8(n,s),o,s.level!=null?{level:s.level}:null)}}(e):function(r){return n.scale.getLabel(r)}}function o8(n,e){return n.type==="category"?n.scale.getLabel(e):e.value}function ZBe(n){var e=n.model,t=n.scale;if(!(!e.get(["axisLabel","show"])||t.isBlank())){var r,s,o=t.getExtent();t instanceof n8?s=t.count():(r=t.getTicks(),s=r.length);var l=n.getLabelModel(),c=Kw(n),a,d=1;s>40&&(d=Math.ceil(s/40));for(var f=0;f<s;f+=d){var m=r?r[f]:{value:o[0]+f},_=c(m,f),x=l.getTextRect(_),A=KBe(x,l.get("rotate")||0);a?a.union(A):a=A}return a}}function KBe(n,e){var t=e*Math.PI/180,r=n.width,s=n.height,o=r*Math.abs(Math.cos(t))+Math.abs(s*Math.sin(t)),l=r*Math.abs(Math.sin(t))+Math.abs(s*Math.cos(t)),c=new ds(n.x,n.y,o,l);return c}function a8(n){var e=n.get("interval");return e??"auto"}function ule(n){return n.type==="category"&&a8(n.getLabelModel())===0}function ML(n,e){var t={};return ot(n.mapDimensionsAll(e),function(r){t[vBe(n,r)]=!0}),lo(t)}function JBe(n,e,t){e&&ot(ML(e,t),function(r){var s=e.getApproximateExtent(r);s[0]<n[0]&&(n[0]=s[0]),s[1]>n[1]&&(n[1]=s[1])})}var hle=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var e=this.option;return!e.scale},n.prototype.getCoordSysModel=function(){},n}(),pZ=[],QBe={registerPreprocessor:Hae,registerProcessor:jae,registerPostInit:XDe,registerPostUpdate:qDe,registerUpdateLifecycle:QG,registerAction:Ep,registerCoordinateSystem:YDe,registerLayout:ZDe,registerVisual:zx,registerTransform:JDe,registerLoading:Wae,registerMap:KDe,registerImpl:CDe,PRIORITY:UDe,ComponentModel:cs,ComponentView:kc,SeriesModel:sf,ChartView:Oh,registerComponentModel:function(n){cs.registerClass(n)},registerComponentView:function(n){kc.registerClass(n)},registerSeriesModel:function(n){sf.registerClass(n)},registerChartView:function(n){Oh.registerClass(n)},registerSubTypeDefaulter:function(n,e){cs.registerSubTypeDefaulter(n,e)},registerPainter:function(n,e){s2e(n,e)}};function Sp(n){if(fr(n)){ot(n,function(e){Sp(e)});return}Zi(pZ,n)>=0||(pZ.push(n),hi(n)&&(n={install:n}),n.install(QBe))}var VM=Zs();function dle(n,e){var t=br(e,function(r){return n.scale.parse(r)});return n.type==="time"&&t.length>0&&(t.sort(),t.unshift(t[0]),t.push(t[t.length-1])),t}function eke(n){var e=n.getLabelModel().get("customValues");if(e){var t=Kw(n);return{labels:dle(n,e).map(function(r){var s={value:r};return{formattedLabel:t(s),rawLabel:n.scale.getLabel(s),tickValue:r}})}}return n.type==="category"?nke(n):ike(n)}function tke(n,e){var t=n.getTickModel().get("customValues");return t?{ticks:dle(n,t)}:n.type==="category"?rke(n,e):{ticks:br(n.scale.getTicks(),function(r){return r.value})}}function nke(n){var e=n.getLabelModel(),t=fle(n,e);return!e.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:t.labelCategoryInterval}:t}function fle(n,e){var t=ple(n,"labels"),r=a8(e),s=mle(t,r);if(s)return s;var o,l;return hi(r)?o=_le(n,r):(l=r==="auto"?ske(n):r,o=vle(n,l)),gle(t,r,{labels:o,labelCategoryInterval:l})}function rke(n,e){var t=ple(n,"ticks"),r=a8(e),s=mle(t,r);if(s)return s;var o,l;if((!e.get("show")||n.scale.isBlank())&&(o=[]),hi(r))o=_le(n,r,!0);else if(r==="auto"){var c=fle(n,n.getLabelModel());l=c.labelCategoryInterval,o=br(c.labels,function(a){return a.tickValue})}else l=r,o=vle(n,l,!0);return gle(t,r,{ticks:o,tickCategoryInterval:l})}function ike(n){var e=n.scale.getTicks(),t=Kw(n);return{labels:br(e,function(r,s){return{level:r.level,formattedLabel:t(r,s),rawLabel:n.scale.getLabel(r),tickValue:r.value}})}}function ple(n,e){return VM(n)[e]||(VM(n)[e]=[])}function mle(n,e){for(var t=0;t<n.length;t++)if(n[t].key===e)return n[t].value}function gle(n,e,t){return n.push({key:e,value:t}),t}function ske(n){var e=VM(n).autoInterval;return e??(VM(n).autoInterval=n.calculateCategoryInterval())}function oke(n){var e=ake(n),t=Kw(n),r=(e.axisRotate-e.labelRotate)/180*Math.PI,s=n.scale,o=s.getExtent(),l=s.count();if(o[1]-o[0]<1)return 0;var c=1;l>40&&(c=Math.max(1,Math.floor(l/40)));for(var a=o[0],d=n.dataToCoord(a+1)-n.dataToCoord(a),f=Math.abs(d*Math.cos(r)),m=Math.abs(d*Math.sin(r)),_=0,x=0;a<=o[1];a+=c){var A=0,I=0,E=LC(t({value:a}),e.font,"center","top");A=E.width*1.3,I=E.height*1.3,_=Math.max(_,A,7),x=Math.max(x,I,7)}var C=_/f,L=x/m;isNaN(C)&&(C=1/0),isNaN(L)&&(L=1/0);var O=Math.max(0,Math.floor(Math.min(C,L))),H=VM(n.model),q=n.getExtent(),Z=H.lastAutoInterval,J=H.lastTickCount;return Z!=null&&J!=null&&Math.abs(Z-O)<=1&&Math.abs(J-l)<=1&&Z>O&&H.axisExtent0===q[0]&&H.axisExtent1===q[1]?O=Z:(H.lastTickCount=l,H.lastAutoInterval=O,H.axisExtent0=q[0],H.axisExtent1=q[1]),O}function ake(n){var e=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}function vle(n,e,t){var r=Kw(n),s=n.scale,o=s.getExtent(),l=n.getLabelModel(),c=[],a=Math.max((e||0)+1,1),d=o[0],f=s.count();d!==0&&a>1&&f/a>2&&(d=Math.round(Math.ceil(d/a)*a));var m=ule(n),_=l.get("showMinLabel")||m,x=l.get("showMaxLabel")||m;_&&d!==o[0]&&I(o[0]);for(var A=d;A<=o[1];A+=a)I(A);x&&A-a!==o[1]&&I(o[1]);function I(E){var C={value:E};c.push(t?E:{formattedLabel:r(C),rawLabel:s.getLabel(C),tickValue:E})}return c}function _le(n,e,t){var r=n.scale,s=Kw(n),o=[];return ot(r.getTicks(),function(l){var c=r.getLabel(l),a=l.value;e(l.value,c)&&o.push(t?a:{formattedLabel:s(l),rawLabel:c,tickValue:a})}),o}var mZ=[0,1],Ux=function(){function n(e,t,r){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=r||[0,0]}return n.prototype.contain=function(e){var t=this._extent,r=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]);return e>=r&&e<=s},n.prototype.containData=function(e){return this.scale.contain(e)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(e){return yse(e||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(e,t){var r=this._extent;r[0]=e,r[1]=t},n.prototype.dataToCoord=function(e,t){var r=this._extent,s=this.scale;return e=s.normalize(e),this.onBand&&s.type==="ordinal"&&(r=r.slice(),gZ(r,s.count())),qv(e,mZ,r,t)},n.prototype.coordToData=function(e,t){var r=this._extent,s=this.scale;this.onBand&&s.type==="ordinal"&&(r=r.slice(),gZ(r,s.count()));var o=qv(e,r,mZ,t);return this.scale.scale(o)},n.prototype.pointToData=function(e,t){},n.prototype.getTicksCoords=function(e){e=e||{};var t=e.tickModel||this.getTickModel(),r=tke(this,t),s=r.ticks,o=br(s,function(c){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(c):c),tickValue:c}},this),l=t.get("alignWithLabel");return lke(this,o,l,e.clamp),o},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var e=this.model.getModel("minorTick"),t=e.get("splitNumber");t>0&&t<100||(t=5);var r=this.scale.getMinorTicks(t),s=br(r,function(o){return br(o,function(l){return{coord:this.dataToCoord(l),tickValue:l}},this)},this);return s},n.prototype.getViewLabels=function(){return eke(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),r=t[1]-t[0]+(this.onBand?1:0);r===0&&(r=1);var s=Math.abs(e[1]-e[0]);return Math.abs(s)/r},n.prototype.calculateCategoryInterval=function(){return oke(this)},n}();function gZ(n,e){var t=n[1]-n[0],r=e,s=t/r/2;n[0]+=s,n[1]-=s}function lke(n,e,t,r){var s=e.length;if(!n.onBand||t||!s)return;var o=n.getExtent(),l,c;if(s===1)e[0].coord=o[0],l=e[1]={coord:o[1]};else{var a=e[s-1].tickValue-e[0].tickValue,d=(e[s-1].coord-e[0].coord)/a;ot(e,function(x){x.coord-=d/2});var f=n.scale.getExtent();c=1+f[1]-e[s-1].tickValue,l={coord:e[s-1].coord+d*c},e.push(l)}var m=o[0]>o[1];_(e[0].coord,o[0])&&(r?e[0].coord=o[0]:e.shift()),r&&_(o[0],e[0].coord)&&e.unshift({coord:o[0]}),_(o[1],l.coord)&&(r?l.coord=o[1]:e.pop()),r&&_(l.coord,o[1])&&e.push({coord:o[1]});function _(x,A){return x=Ca(x),A=Ca(A),m?x>A:x<A}}var MA=Math.PI*2,hy=lg.CMD,cke=["top","right","bottom","left"];function uke(n,e,t,r,s){var o=t.width,l=t.height;switch(n){case"top":r.set(t.x+o/2,t.y-e),s.set(0,-1);break;case"bottom":r.set(t.x+o/2,t.y+l+e),s.set(0,1);break;case"left":r.set(t.x-e,t.y+l/2),s.set(-1,0);break;case"right":r.set(t.x+o+e,t.y+l/2),s.set(1,0);break}}function hke(n,e,t,r,s,o,l,c,a){l-=n,c-=e;var d=Math.sqrt(l*l+c*c);l/=d,c/=d;var f=l*t+n,m=c*t+e;if(Math.abs(r-s)%MA<1e-4)return a[0]=f,a[1]=m,d-t;if(o){var _=r;r=Gm(s),s=Gm(_)}else r=Gm(r),s=Gm(s);r>s&&(s+=MA);var x=Math.atan2(c,l);if(x<0&&(x+=MA),x>=r&&x<=s||x+MA>=r&&x+MA<=s)return a[0]=f,a[1]=m,d-t;var A=t*Math.cos(r)+n,I=t*Math.sin(r)+e,E=t*Math.cos(s)+n,C=t*Math.sin(s)+e,L=(A-l)*(A-l)+(I-c)*(I-c),O=(E-l)*(E-l)+(C-c)*(C-c);return L<O?(a[0]=A,a[1]=I,Math.sqrt(L)):(a[0]=E,a[1]=C,Math.sqrt(O))}function CL(n,e,t,r,s,o,l,c){var a=s-n,d=o-e,f=t-n,m=r-e,_=Math.sqrt(f*f+m*m);f/=_,m/=_;var x=a*f+d*m,A=x/_;c&&(A=Math.min(Math.max(A,0),1)),A*=_;var I=l[0]=n+A*f,E=l[1]=e+A*m;return Math.sqrt((I-s)*(I-s)+(E-o)*(E-o))}function yle(n,e,t,r,s,o,l){t<0&&(n=n+t,t=-t),r<0&&(e=e+r,r=-r);var c=n+t,a=e+r,d=l[0]=Math.min(Math.max(s,n),c),f=l[1]=Math.min(Math.max(o,e),a);return Math.sqrt((d-s)*(d-s)+(f-o)*(f-o))}var Vd=[];function dke(n,e,t){var r=yle(e.x,e.y,e.width,e.height,n.x,n.y,Vd);return t.set(Vd[0],Vd[1]),r}function fke(n,e,t){for(var r=0,s=0,o=0,l=0,c,a,d=1/0,f=e.data,m=n.x,_=n.y,x=0;x<f.length;){var A=f[x++];x===1&&(r=f[x],s=f[x+1],o=r,l=s);var I=d;switch(A){case hy.M:o=f[x++],l=f[x++],r=o,s=l;break;case hy.L:I=CL(r,s,f[x],f[x+1],m,_,Vd,!0),r=f[x++],s=f[x++];break;case hy.C:I=ase(r,s,f[x++],f[x++],f[x++],f[x++],f[x],f[x+1],m,_,Vd),r=f[x++],s=f[x++];break;case hy.Q:I=cse(r,s,f[x++],f[x++],f[x],f[x+1],m,_,Vd),r=f[x++],s=f[x++];break;case hy.A:var E=f[x++],C=f[x++],L=f[x++],O=f[x++],H=f[x++],q=f[x++];x+=1;var Z=!!(1-f[x++]);c=Math.cos(H)*L+E,a=Math.sin(H)*O+C,x<=1&&(o=c,l=a);var J=(m-E)*O/L+E;I=hke(E,C,O,H,H+q,Z,J,_,Vd),r=Math.cos(H+q)*L+E,s=Math.sin(H+q)*O+C;break;case hy.R:o=r=f[x++],l=s=f[x++];var re=f[x++],se=f[x++];I=yle(o,l,re,se,m,_,Vd);break;case hy.Z:I=CL(r,s,o,l,m,_,Vd,!0),r=o,s=l;break}I<d&&(d=I,t.set(Vd[0],Vd[1]))}return d}var Yd=new ei,zs=new ei,ra=new ei,hp=new ei,sp=new ei;function vZ(n,e){if(n){var t=n.getTextGuideLine(),r=n.getTextContent();if(r&&t){var s=n.textGuideLineConfig||{},o=[[0,0],[0,0],[0,0]],l=s.candidates||cke,c=r.getBoundingRect().clone();c.applyTransform(r.getComputedTransform());var a=1/0,d=s.anchor,f=n.getComputedTransform(),m=f&&cB([],f),_=e.get("length2")||0;d&&ra.copy(d);for(var x=0;x<l.length;x++){var A=l[x];uke(A,0,c,Yd,hp),ei.scaleAndAdd(zs,Yd,hp,_),zs.transform(m);var I=n.getBoundingRect(),E=d?d.distance(zs):n instanceof Ki?fke(zs,n.path,ra):dke(zs,I,ra);E<a&&(a=E,zs.transform(f),ra.transform(f),ra.toArray(o[0]),zs.toArray(o[1]),Yd.toArray(o[2]))}xle(o,e.get("minTurnAngle")),t.setShape({points:o})}}}var EL=[],Tc=new ei;function xle(n,e){if(e<=180&&e>0){e=e/180*Math.PI,Yd.fromArray(n[0]),zs.fromArray(n[1]),ra.fromArray(n[2]),ei.sub(hp,Yd,zs),ei.sub(sp,ra,zs);var t=hp.len(),r=sp.len();if(!(t<.001||r<.001)){hp.scale(1/t),sp.scale(1/r);var s=hp.dot(sp),o=Math.cos(e);if(o<s){var l=CL(zs.x,zs.y,ra.x,ra.y,Yd.x,Yd.y,EL,!1);Tc.fromArray(EL),Tc.scaleAndAdd(sp,l/Math.tan(Math.PI-e));var c=ra.x!==zs.x?(Tc.x-zs.x)/(ra.x-zs.x):(Tc.y-zs.y)/(ra.y-zs.y);if(isNaN(c))return;c<0?ei.copy(Tc,zs):c>1&&ei.copy(Tc,ra),Tc.toArray(n[1])}}}}function pke(n,e,t){if(t<=180&&t>0){t=t/180*Math.PI,Yd.fromArray(n[0]),zs.fromArray(n[1]),ra.fromArray(n[2]),ei.sub(hp,zs,Yd),ei.sub(sp,ra,zs);var r=hp.len(),s=sp.len();if(!(r<.001||s<.001)){hp.scale(1/r),sp.scale(1/s);var o=hp.dot(e),l=Math.cos(t);if(o<l){var c=CL(zs.x,zs.y,ra.x,ra.y,Yd.x,Yd.y,EL,!1);Tc.fromArray(EL);var a=Math.PI/2,d=Math.acos(sp.dot(e)),f=a+d-t;if(f>=a)ei.copy(Tc,ra);else{Tc.scaleAndAdd(sp,c/Math.tan(Math.PI/2-f));var m=ra.x!==zs.x?(Tc.x-zs.x)/(ra.x-zs.x):(Tc.y-zs.y)/(ra.y-zs.y);if(isNaN(m))return;m<0?ei.copy(Tc,zs):m>1&&ei.copy(Tc,ra)}Tc.toArray(n[1])}}}}function Q3(n,e,t,r){var s=t==="normal",o=s?n:n.ensureState(t);o.ignore=e;var l=r.get("smooth");l&&l===!0&&(l=.3),o.shape=o.shape||{},l>0&&(o.shape.smooth=l);var c=r.getModel("lineStyle").getLineStyle();s?n.useStyle(c):o.style=c}function mke(n,e){var t=e.smooth,r=e.points;if(r)if(n.moveTo(r[0][0],r[0][1]),t>0&&r.length>=3){var s=Pz(r[0],r[1]),o=Pz(r[1],r[2]);if(!s||!o){n.lineTo(r[1][0],r[1][1]),n.lineTo(r[2][0],r[2][1]);return}var l=Math.min(s,o)*t,c=xP([],r[1],r[0],l/s),a=xP([],r[1],r[2],l/o),d=xP([],c,a,.5);n.bezierCurveTo(c[0],c[1],c[0],c[1],d[0],d[1]),n.bezierCurveTo(a[0],a[1],a[0],a[1],r[2][0],r[2][1])}else for(var f=1;f<r.length;f++)n.lineTo(r[f][0],r[f][1])}function ble(n,e,t){var r=n.getTextGuideLine(),s=n.getTextContent();if(!s){r&&n.removeTextGuideLine();return}for(var o=e.normal,l=o.get("show"),c=s.ignore,a=0;a<hL.length;a++){var d=hL[a],f=e[d],m=d==="normal";if(f){var _=f.get("show"),x=m?c:Li(s.states[d]&&s.states[d].ignore,c);if(x||!Li(_,l)){var A=m?r:r&&r.states[d];A&&(A.ignore=!0),r&&Q3(r,!0,d,f);continue}r||(r=new Xw,n.setTextGuideLine(r),!m&&(c||!l)&&Q3(r,!0,"normal",e.normal),n.stateProxy&&(r.stateProxy=n.stateProxy)),Q3(r,!1,d,f)}}if(r){ri(r.style,t),r.style.fill=null;var I=o.get("showAbove"),E=n.textGuideLineConfig=n.textGuideLineConfig||{};E.showAbove=I||!1,r.buildPath=mke}}function wle(n,e){e=e||"labelLine";for(var t={normal:n.getModel(e)},r=0;r<Vh.length;r++){var s=Vh[r];t[s]=n.getModel([s,e])}return t}function Sle(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.defaultAttr.ignore){var s=r.label,o=s.getComputedTransform(),l=s.getBoundingRect(),c=!o||o[1]<1e-5&&o[2]<1e-5,a=s.style.margin||0,d=l.clone();d.applyTransform(o),d.x-=a/2,d.y-=a/2,d.width+=a,d.height+=a;var f=c?new fL(l,o):null;e.push({label:s,labelLine:r.labelLine,rect:d,localRect:l,obb:f,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:c,transform:o})}}return e}function Ale(n,e,t,r,s,o){var l=n.length;if(l<2)return;n.sort(function(re,se){return re.rect[e]-se.rect[e]});for(var c=0,a,d=!1,f=0,m=0;m<l;m++){var _=n[m],x=_.rect;a=x[e]-c,a<0&&(x[e]-=a,_.label[e]-=a,d=!0);var A=Math.max(-a,0);f+=A,c=x[e]+x[t]}f>0&&o&&q(-f/l,0,l);var I=n[0],E=n[l-1],C,L;O(),C<0&&Z(-C,.8),L<0&&Z(L,.8),O(),H(C,L,1),H(L,C,-1),O(),C<0&&J(-C),L<0&&J(L);function O(){C=I.rect[e]-r,L=s-E.rect[e]-E.rect[t]}function H(re,se,ae){if(re<0){var he=Math.min(se,-re);if(he>0){q(he*ae,0,l);var Ae=he+re;Ae<0&&Z(-Ae*ae,1)}else Z(-re*ae,1)}}function q(re,se,ae){re!==0&&(d=!0);for(var he=se;he<ae;he++){var Ae=n[he],Ee=Ae.rect;Ee[e]+=re,Ae.label[e]+=re}}function Z(re,se){for(var ae=[],he=0,Ae=1;Ae<l;Ae++){var Ee=n[Ae-1].rect,Pe=Math.max(n[Ae].rect[e]-Ee[e]-Ee[t],0);ae.push(Pe),he+=Pe}if(he){var ze=Math.min(Math.abs(re)/he,se);if(re>0)for(var Ae=0;Ae<l-1;Ae++){var Re=ae[Ae]*ze;q(Re,0,Ae+1)}else for(var Ae=l-1;Ae>0;Ae--){var Re=ae[Ae-1]*ze;q(-Re,Ae,l)}}}function J(re){var se=re<0?-1:1;re=Math.abs(re);for(var ae=Math.ceil(re/(l-1)),he=0;he<l-1;he++)if(se>0?q(ae,0,he+1):q(-ae,l-he-1,l),re-=ae,re<=0)return}return d}function gke(n,e,t,r){return Ale(n,"x","width",e,t,r)}function Tle(n,e,t,r){return Ale(n,"y","height",e,t,r)}function Mle(n){var e=[];n.sort(function(I,E){return E.priority-I.priority});var t=new ds(0,0,0,0);function r(I){if(!I.ignore){var E=I.ensureState("emphasis");E.ignore==null&&(E.ignore=!1)}I.ignore=!0}for(var s=0;s<n.length;s++){var o=n[s],l=o.axisAligned,c=o.localRect,a=o.transform,d=o.label,f=o.labelLine;t.copy(o.rect),t.width-=.1,t.height-=.1,t.x+=.05,t.y+=.05;for(var m=o.obb,_=!1,x=0;x<e.length;x++){var A=e[x];if(t.intersect(A.rect)){if(l&&A.axisAligned){_=!0;break}if(A.obb||(A.obb=new fL(A.localRect,A.transform)),m||(m=new fL(c,a)),m.intersect(A.obb)){_=!0;break}}}_?(r(d),f&&r(f)):(d.attr("ignore",o.defaultAttr.ignore),f&&f.attr("ignore",o.defaultAttr.labelGuideIgnore),e.push(o))}}function vke(n){if(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t].slice());return e}}function _ke(n,e){var t=n.label,r=e&&e.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:t.style.align,verticalAlign:t.style.verticalAlign,labelLinePoints:vke(r&&r.shape.points)}}var _Z=["align","verticalAlign","width","height","fontSize"],xc=new RC,eN=Zs(),yke=Zs();function BI(n,e,t){for(var r=0;r<t.length;r++){var s=t[r];e[s]!=null&&(n[s]=e[s])}}var kI=["x","y","rotation"],xke=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(e,t,r,s,o){var l=s.style,c=s.__hostTarget,a=c.textConfig||{},d=s.getComputedTransform(),f=s.getBoundingRect().plain();ds.applyTransform(f,f,d),d?xc.setLocalTransform(d):(xc.x=xc.y=xc.rotation=xc.originX=xc.originY=0,xc.scaleX=xc.scaleY=1),xc.rotation=Gm(xc.rotation);var m=s.__hostTarget,_;if(m){_=m.getBoundingRect().plain();var x=m.getComputedTransform();ds.applyTransform(_,_,x)}var A=_&&m.getTextGuideLine();this._labelList.push({label:s,labelLine:A,seriesModel:r,dataIndex:e,dataType:t,layoutOption:o,computedLayoutOption:null,rect:f,hostRect:_,priority:_?_.width*_.height:0,defaultAttr:{ignore:s.ignore,labelGuideIgnore:A&&A.ignore,x:xc.x,y:xc.y,scaleX:xc.scaleX,scaleY:xc.scaleY,rotation:xc.rotation,style:{x:l.x,y:l.y,align:l.align,verticalAlign:l.verticalAlign,width:l.width,height:l.height,fontSize:l.fontSize},cursor:s.cursor,attachedPos:a.position,attachedRot:a.rotation}})},n.prototype.addLabelsOfSeries=function(e){var t=this;this._chartViewList.push(e);var r=e.__model,s=r.get("labelLayout");(hi(s)||lo(s).length)&&e.group.traverse(function(o){if(o.ignore)return!0;var l=o.getTextContent(),c=Yi(o);l&&!l.disableLabelLayout&&t._addLabel(c.dataIndex,c.dataType,r,l,s)})},n.prototype.updateLayoutConfig=function(e){var t=e.getWidth(),r=e.getHeight();function s(O,H){return function(){vZ(O,H)}}for(var o=0;o<this._labelList.length;o++){var l=this._labelList[o],c=l.label,a=c.__hostTarget,d=l.defaultAttr,f=void 0;hi(l.layoutOption)?f=l.layoutOption(_ke(l,a)):f=l.layoutOption,f=f||{},l.computedLayoutOption=f;var m=Math.PI/180;a&&a.setTextConfig({local:!1,position:f.x!=null||f.y!=null?null:d.attachedPos,rotation:f.rotate!=null?f.rotate*m:d.attachedRot,offset:[f.dx||0,f.dy||0]});var _=!1;if(f.x!=null?(c.x=hs(f.x,t),c.setStyle("x",0),_=!0):(c.x=d.x,c.setStyle("x",d.style.x)),f.y!=null?(c.y=hs(f.y,r),c.setStyle("y",0),_=!0):(c.y=d.y,c.setStyle("y",d.style.y)),f.labelLinePoints){var x=a.getTextGuideLine();x&&(x.setShape({points:f.labelLinePoints}),_=!1)}var A=eN(c);A.needsUpdateLabelLine=_,c.rotation=f.rotate!=null?f.rotate*m:d.rotation,c.scaleX=d.scaleX,c.scaleY=d.scaleY;for(var I=0;I<_Z.length;I++){var E=_Z[I];c.setStyle(E,f[E]!=null?f[E]:d.style[E])}if(f.draggable){if(c.draggable=!0,c.cursor="move",a){var C=l.seriesModel;if(l.dataIndex!=null){var L=l.seriesModel.getData(l.dataType);C=L.getItemModel(l.dataIndex)}c.on("drag",s(a,C.getModel("labelLine")))}}else c.off("drag"),c.cursor=d.cursor}},n.prototype.layout=function(e){var t=e.getWidth(),r=e.getHeight(),s=Sle(this._labelList),o=sa(s,function(a){return a.layoutOption.moveOverlap==="shiftX"}),l=sa(s,function(a){return a.layoutOption.moveOverlap==="shiftY"});gke(o,0,t),Tle(l,0,r);var c=sa(s,function(a){return a.layoutOption.hideOverlap});Mle(c)},n.prototype.processLabelsOverall=function(){var e=this;ot(this._chartViewList,function(t){var r=t.__model,s=t.ignoreLabelLineUpdate,o=r.isAnimationEnabled();t.group.traverse(function(l){if(l.ignore&&!l.forceLabelAnimation)return!0;var c=!s,a=l.getTextContent();!c&&a&&(c=eN(a).needsUpdateLabelLine),c&&e._updateLabelLine(l,r),o&&e._animateLabels(l,r)})})},n.prototype._updateLabelLine=function(e,t){var r=e.getTextContent(),s=Yi(e),o=s.dataIndex;if(r&&o!=null){var l=t.getData(s.dataType),c=l.getItemModel(o),a={},d=l.getItemVisual(o,"style");if(d){var f=l.getVisual("drawType");a.stroke=d[f]}var m=c.getModel("labelLine");ble(e,wle(c),a),vZ(e,m)}},n.prototype._animateLabels=function(e,t){var r=e.getTextContent(),s=e.getTextGuideLine();if(r&&(e.forceLabelAnimation||!r.ignore&&!r.invisible&&!e.disableLabelAnimation&&!ew(e))){var o=eN(r),l=o.oldLayout,c=Yi(e),a=c.dataIndex,d={x:r.x,y:r.y,rotation:r.rotation},f=t.getData(c.dataType);if(l){r.attr(l);var _=e.prevStates;_&&(Zi(_,"select")>=0&&r.attr(o.oldLayoutSelect),Zi(_,"emphasis")>=0&&r.attr(o.oldLayoutEmphasis)),cl(r,d,t,a)}else if(r.attr(d),!qw(r).valueAnimation){var m=Li(r.style.opacity,1);r.style.opacity=0,Jl(r,{style:{opacity:m}},t,a)}if(o.oldLayout=d,r.states.select){var x=o.oldLayoutSelect={};BI(x,d,kI),BI(x,r.states.select,kI)}if(r.states.emphasis){var A=o.oldLayoutEmphasis={};BI(A,d,kI),BI(A,r.states.emphasis,kI)}UPe(r,a,f,t,t)}if(s&&!s.ignore&&!s.invisible){var o=yke(s),l=o.oldLayout,I={points:s.shape.points};l?(s.attr({shape:l}),cl(s,{shape:I},t)):(s.setShape(I),s.style.strokePercent=0,Jl(s,{style:{strokePercent:1}},t)),o.oldLayout=I}},n}(),tN=Zs();function bke(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){var s=tN(t).labelManager;s||(s=tN(t).labelManager=new xke),s.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(e,t,r){var s=tN(t).labelManager;r.updatedSeries.forEach(function(o){s.addLabelsOfSeries(t.getViewOfSeriesModel(o))}),s.updateLayoutConfig(t),s.layout(t),s.processLabelsOverall()})}var wke=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.hasSymbolVisual=!0,t}return e.prototype.getInitialData=function(t){return t8(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var r=new _a,s=Mw("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);r.add(s),s.setStyle(t.lineStyle);var o=this.getData().getVisual("symbol"),l=this.getData().getVisual("symbolRotate"),c=o==="none"?"circle":o,a=t.itemHeight*.8,d=Mw(c,(t.itemWidth-a)/2,(t.itemHeight-a)/2,a,a,t.itemStyle.fill);r.add(d),d.setStyle(t.itemStyle);var f=t.iconRotate==="inherit"?l:t.iconRotate||0;return d.rotation=f*Math.PI/180,d.setOrigin([t.itemWidth/2,t.itemHeight/2]),c.indexOf("empty")>-1&&(d.style.stroke=d.style.fill,d.style.fill="#fff",d.style.lineWidth=2),r},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(sf);function l8(n,e){var t=n.mapDimensionsAll("defaultedLabel"),r=t.length;if(r===1){var s=Tw(n,e,t[0]);return s!=null?s+"":null}else if(r){for(var o=[],l=0;l<t.length;l++)o.push(Tw(n,e,t[l]));return o.join(" ")}}function Cle(n,e){var t=n.mapDimensionsAll("defaultedLabel");if(!fr(e))return e+"";for(var r=[],s=0;s<t.length;s++){var o=n.getDimensionIndex(t[s]);o>=0&&r.push(e[o])}return r.join(" ")}var c8=function(n){jn(e,n);function e(t,r,s,o){var l=n.call(this)||this;return l.updateData(t,r,s,o),l}return e.prototype._createSymbol=function(t,r,s,o,l){this.removeAll();var c=Mw(t,-1,-1,2,2,null,l);c.attr({z2:100,culling:!0,scaleX:o[0]/2,scaleY:o[1]/2}),c.drift=Ske,this._symbolType=t,this.add(c)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){ww(this.childAt(0))},e.prototype.downplay=function(){Sw(this.childAt(0))},e.prototype.setZ=function(t,r){var s=this.childAt(0);s.zlevel=t,s.z=r},e.prototype.setDraggable=function(t,r){var s=this.childAt(0);s.draggable=t,s.cursor=!r&&t?"move":s.cursor},e.prototype.updateData=function(t,r,s,o){this.silent=!1;var l=t.getItemVisual(r,"symbol")||"circle",c=t.hostModel,a=e.getSymbolSize(t,r),d=l!==this._symbolType,f=o&&o.disableAnimation;if(d){var m=t.getItemVisual(r,"symbolKeepAspect");this._createSymbol(l,t,r,a,m)}else{var _=this.childAt(0);_.silent=!1;var x={scaleX:a[0]/2,scaleY:a[1]/2};f?_.attr(x):cl(_,x,c,r),PG(_)}if(this._updateCommon(t,r,a,s,o),d){var _=this.childAt(0);if(!f){var x={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:_.style.opacity}};_.scaleX=_.scaleY=0,_.style.opacity=0,Jl(_,x,c,r)}}f&&this.childAt(0).stopAnimation("leave")},e.prototype._updateCommon=function(t,r,s,o,l){var c=this.childAt(0),a=t.hostModel,d,f,m,_,x,A,I,E,C;if(o&&(d=o.emphasisItemStyle,f=o.blurItemStyle,m=o.selectItemStyle,_=o.focus,x=o.blurScope,I=o.labelStatesModels,E=o.hoverScale,C=o.cursorStyle,A=o.emphasisDisabled),!o||t.hasItemOption){var L=o&&o.itemModel?o.itemModel:t.getItemModel(r),O=L.getModel("emphasis");d=O.getModel("itemStyle").getItemStyle(),m=L.getModel(["select","itemStyle"]).getItemStyle(),f=L.getModel(["blur","itemStyle"]).getItemStyle(),_=O.get("focus"),x=O.get("blurScope"),A=O.get("disabled"),I=OC(L),E=O.getShallow("scale"),C=L.getShallow("cursor")}var H=t.getItemVisual(r,"symbolRotate");c.attr("rotation",(H||0)*Math.PI/180||0);var q=wae(t.getItemVisual(r,"symbolOffset"),s);q&&(c.x=q[0],c.y=q[1]),C&&c.attr("cursor",C);var Z=t.getItemVisual(r,"style"),J=Z.fill;if(c instanceof q0){var re=c.style;c.useStyle(Qn({image:re.image,x:re.x,y:re.y,width:re.width,height:re.height},Z))}else c.__isEmptyBrush?c.useStyle(Qn({},Z)):c.useStyle(Z),c.style.decal=null,c.setColor(J,l&&l.symbolInnerColor),c.style.strokeNoScale=!0;var se=t.getItemVisual(r,"liftZ"),ae=this._z2;se!=null?ae==null&&(this._z2=c.z2,c.z2+=se):ae!=null&&(c.z2=ae,this._z2=null);var he=l&&l.useNameLabel;kC(c,I,{labelFetcher:a,labelDataIndex:r,defaultText:Ae,inheritColor:J,defaultOpacity:Z.opacity});function Ae(ze){return he?t.getName(ze):l8(t,ze)}this._sizeX=s[0]/2,this._sizeY=s[1]/2;var Ee=c.ensureState("emphasis");Ee.style=d,c.ensureState("select").style=m,c.ensureState("blur").style=f;var Pe=E==null||E===!0?Math.max(1.1,3/this._sizeY):isFinite(E)&&E>0?+E:1;Ee.scaleX=this._sizeX*Pe,Ee.scaleY=this._sizeY*Pe,this.setSymbolScale(1),DM(this,_,x,A)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,r,s){var o=this.childAt(0),l=Yi(this).dataIndex,c=s&&s.animation;if(this.silent=o.silent=!0,s&&s.fadeLabel){var a=o.getTextContent();a&&pL(a,{style:{opacity:0}},r,{dataIndex:l,removeOpt:c,cb:function(){o.removeTextContent()}})}else o.removeTextContent();pL(o,{style:{opacity:0},scaleX:0,scaleY:0},r,{dataIndex:l,cb:t,removeOpt:c})},e.getSymbolSize=function(t,r){return uDe(t.getItemVisual(r,"symbolSize"))},e}(_a);function Ske(n,e){this.parent.drift(n,e)}function nN(n,e,t,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(t))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&n.getItemVisual(t,"symbol")!=="none"}function yZ(n){return n!=null&&!qr(n)&&(n={isIgnore:n}),n||{}}function xZ(n){var e=n.hostModel,t=e.getModel("emphasis");return{emphasisItemStyle:t.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:t.get("focus"),blurScope:t.get("blurScope"),emphasisDisabled:t.get("disabled"),hoverScale:t.get("scale"),labelStatesModels:OC(e),cursorStyle:e.get("cursor")}}var Ake=function(){function n(e){this.group=new _a,this._SymbolCtor=e||c8}return n.prototype.updateData=function(e,t){this._progressiveEls=null,t=yZ(t);var r=this.group,s=e.hostModel,o=this._data,l=this._SymbolCtor,c=t.disableAnimation,a=xZ(e),d={disableAnimation:c},f=t.getSymbolPoint||function(m){return e.getItemLayout(m)};o||r.removeAll(),e.diff(o).add(function(m){var _=f(m);if(nN(e,_,m,t)){var x=new l(e,m,a,d);x.setPosition(_),e.setItemGraphicEl(m,x),r.add(x)}}).update(function(m,_){var x=o.getItemGraphicEl(_),A=f(m);if(!nN(e,A,m,t)){r.remove(x);return}var I=e.getItemVisual(m,"symbol")||"circle",E=x&&x.getSymbolType&&x.getSymbolType();if(!x||E&&E!==I)r.remove(x),x=new l(e,m,a,d),x.setPosition(A);else{x.updateData(e,m,a,d);var C={x:A[0],y:A[1]};c?x.attr(C):cl(x,C,s)}r.add(x),e.setItemGraphicEl(m,x)}).remove(function(m){var _=o.getItemGraphicEl(m);_&&_.fadeOut(function(){r.remove(_)},s)}).execute(),this._getSymbolPoint=f,this._data=e},n.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(r,s){var o=e._getSymbolPoint(s);r.setPosition(o),r.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=xZ(e),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(e,t,r){this._progressiveEls=[],r=yZ(r);function s(a){a.isGroup||(a.incremental=!0,a.ensureState("emphasis").hoverLayer=!0)}for(var o=e.start;o<e.end;o++){var l=t.getItemLayout(o);if(nN(t,l,o,r)){var c=new this._SymbolCtor(t,o,this._seriesScope);c.traverse(s),c.setPosition(l),this.group.add(c),t.setItemGraphicEl(o,c),this._progressiveEls.push(c)}}},n.prototype.eachRendered=function(e){TB(this._progressiveEls||this.group,e)},n.prototype.remove=function(e){var t=this.group,r=this._data;r&&e?r.eachItemGraphicEl(function(s){s.fadeOut(function(){t.remove(s)},r.hostModel)}):t.removeAll()},n}();function Ele(n,e,t){var r=n.getBaseAxis(),s=n.getOtherAxis(r),o=Tke(s,t),l=r.dim,c=s.dim,a=e.mapDimension(c),d=e.mapDimension(l),f=c==="x"||c==="radius"?1:0,m=br(n.dimensions,function(A){return e.mapDimension(A)}),_=!1,x=e.getCalculationInfo("stackResultDimension");return bx(e,m[0])&&(_=!0,m[0]=x),bx(e,m[1])&&(_=!0,m[1]=x),{dataDimsForPoint:m,valueStart:o,valueAxisDim:c,baseAxisDim:l,stacked:!!_,valueDim:a,baseDim:d,baseDataOffset:f,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function Tke(n,e){var t=0,r=n.scale.getExtent();return e==="start"?t=r[0]:e==="end"?t=r[1]:Ds(e)&&!isNaN(e)?t=e:r[0]>0?t=r[0]:r[1]<0&&(t=r[1]),t}function Ile(n,e,t,r){var s=NaN;n.stacked&&(s=t.get(t.getCalculationInfo("stackedOverDimension"),r)),isNaN(s)&&(s=n.valueStart);var o=n.baseDataOffset,l=[];return l[o]=t.get(n.baseDim,r),l[1-o]=s,e.dataToPoint(l)}function Mke(n,e){var t=[];return e.diff(n).add(function(r){t.push({cmd:"+",idx:r})}).update(function(r,s){t.push({cmd:"=",idx:s,idx1:r})}).remove(function(r){t.push({cmd:"-",idx:r})}).execute(),t}function Cke(n,e,t,r,s,o,l,c){for(var a=Mke(n,e),d=[],f=[],m=[],_=[],x=[],A=[],I=[],E=Ele(s,e,l),C=n.getLayout("points")||[],L=e.getLayout("points")||[],O=0;O<a.length;O++){var H=a[O],q=!0,Z=void 0,J=void 0;switch(H.cmd){case"=":Z=H.idx*2,J=H.idx1*2;var re=C[Z],se=C[Z+1],ae=L[J],he=L[J+1];(isNaN(re)||isNaN(se))&&(re=ae,se=he),d.push(re,se),f.push(ae,he),m.push(t[Z],t[Z+1]),_.push(r[J],r[J+1]),I.push(e.getRawIndex(H.idx1));break;case"+":var Ae=H.idx,Ee=E.dataDimsForPoint,Pe=s.dataToPoint([e.get(Ee[0],Ae),e.get(Ee[1],Ae)]);J=Ae*2,d.push(Pe[0],Pe[1]),f.push(L[J],L[J+1]);var ze=Ile(E,s,e,Ae);m.push(ze[0],ze[1]),_.push(r[J],r[J+1]),I.push(e.getRawIndex(Ae));break;case"-":q=!1}q&&(x.push(H),A.push(A.length))}A.sort(function(jt,Qt){return I[jt]-I[Qt]});for(var Re=d.length,rt=Vm(Re),ye=Vm(Re),We=Vm(Re),Ue=Vm(Re),gt=[],O=0;O<A.length;O++){var vt=A[O],Dt=O*2,lt=vt*2;rt[Dt]=d[lt],rt[Dt+1]=d[lt+1],ye[Dt]=f[lt],ye[Dt+1]=f[lt+1],We[Dt]=m[lt],We[Dt+1]=m[lt+1],Ue[Dt]=_[lt],Ue[Dt+1]=_[lt+1],gt[O]=x[vt]}return{current:rt,next:ye,stackedOnCurrent:We,stackedOnNext:Ue,status:gt}}var Lv=Math.min,Dv=Math.max;function nx(n,e){return isNaN(n)||isNaN(e)}function b5(n,e,t,r,s,o,l,c,a){for(var d,f,m,_,x,A,I=t,E=0;E<r;E++){var C=e[I*2],L=e[I*2+1];if(I>=s||I<0)break;if(nx(C,L)){if(a){I+=o;continue}break}if(I===t)n[o>0?"moveTo":"lineTo"](C,L),m=C,_=L;else{var O=C-d,H=L-f;if(O*O+H*H<.5){I+=o;continue}if(l>0){for(var q=I+o,Z=e[q*2],J=e[q*2+1];Z===C&&J===L&&E<r;)E++,q+=o,I+=o,Z=e[q*2],J=e[q*2+1],C=e[I*2],L=e[I*2+1],O=C-d,H=L-f;var re=E+1;if(a)for(;nx(Z,J)&&re<r;)re++,q+=o,Z=e[q*2],J=e[q*2+1];var se=.5,ae=0,he=0,Ae=void 0,Ee=void 0;if(re>=r||nx(Z,J))x=C,A=L;else{ae=Z-d,he=J-f;var Pe=C-d,ze=Z-C,Re=L-f,rt=J-L,ye=void 0,We=void 0;if(c==="x"){ye=Math.abs(Pe),We=Math.abs(ze);var Ue=ae>0?1:-1;x=C-Ue*ye*l,A=L,Ae=C+Ue*We*l,Ee=L}else if(c==="y"){ye=Math.abs(Re),We=Math.abs(rt);var gt=he>0?1:-1;x=C,A=L-gt*ye*l,Ae=C,Ee=L+gt*We*l}else ye=Math.sqrt(Pe*Pe+Re*Re),We=Math.sqrt(ze*ze+rt*rt),se=We/(We+ye),x=C-ae*l*(1-se),A=L-he*l*(1-se),Ae=C+ae*l*se,Ee=L+he*l*se,Ae=Lv(Ae,Dv(Z,C)),Ee=Lv(Ee,Dv(J,L)),Ae=Dv(Ae,Lv(Z,C)),Ee=Dv(Ee,Lv(J,L)),ae=Ae-C,he=Ee-L,x=C-ae*ye/We,A=L-he*ye/We,x=Lv(x,Dv(d,C)),A=Lv(A,Dv(f,L)),x=Dv(x,Lv(d,C)),A=Dv(A,Lv(f,L)),ae=C-x,he=L-A,Ae=C+ae*We/ye,Ee=L+he*We/ye}n.bezierCurveTo(m,_,x,A,C,L),m=Ae,_=Ee}else n.lineTo(C,L)}d=C,f=L,I+=o}return E}var Ple=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),Eke=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polyline",r}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Ple},e.prototype.buildPath=function(t,r){var s=r.points,o=0,l=s.length/2;if(r.connectNulls){for(;l>0&&nx(s[l*2-2],s[l*2-1]);l--);for(;o<l&&nx(s[o*2],s[o*2+1]);o++);}for(;o<l;)o+=b5(t,s,o,l,l,1,r.smooth,r.smoothMonotone,r.connectNulls)+1},e.prototype.getPointOn=function(t,r){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var s=this.path,o=s.data,l=lg.CMD,c,a,d=r==="x",f=[],m=0;m<o.length;){var _=o[m++],x=void 0,A=void 0,I=void 0,E=void 0,C=void 0,L=void 0,O=void 0;switch(_){case l.M:c=o[m++],a=o[m++];break;case l.L:if(x=o[m++],A=o[m++],O=d?(t-c)/(x-c):(t-a)/(A-a),O<=1&&O>=0){var H=d?(A-a)*O+a:(x-c)*O+c;return d?[t,H]:[H,t]}c=x,a=A;break;case l.C:x=o[m++],A=o[m++],I=o[m++],E=o[m++],C=o[m++],L=o[m++];var q=d?iL(c,x,I,C,t,f):iL(a,A,E,L,t,f);if(q>0)for(var Z=0;Z<q;Z++){var J=f[Z];if(J<=1&&J>=0){var H=d?ja(a,A,E,L,J):ja(c,x,I,C,J);return d?[t,H]:[H,t]}}c=C,a=L;break}}},e}(Ki),Ike=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ple),Pke=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polygon",r}return e.prototype.getDefaultShape=function(){return new Ike},e.prototype.buildPath=function(t,r){var s=r.points,o=r.stackedOnPoints,l=0,c=s.length/2,a=r.smoothMonotone;if(r.connectNulls){for(;c>0&&nx(s[c*2-2],s[c*2-1]);c--);for(;l<c&&nx(s[l*2],s[l*2+1]);l++);}for(;l<c;){var d=b5(t,s,l,c,c,1,r.smooth,a,r.connectNulls);b5(t,o,l+d-1,d,c,-1,r.stackedOnSmooth,a,r.connectNulls),l+=d+1,t.closePath()}},e}(Ki);function Rle(n,e,t,r,s){var o=n.getArea(),l=o.x,c=o.y,a=o.width,d=o.height,f=t.get(["lineStyle","width"])||2;l-=f/2,c-=f/2,a+=f,d+=f,a=Math.ceil(a),l!==Math.floor(l)&&(l=Math.floor(l),a++);var m=new $o({shape:{x:l,y:c,width:a,height:d}});if(e){var _=n.getBaseAxis(),x=_.isHorizontal(),A=_.inverse;x?(A&&(m.shape.x+=a),m.shape.width=0):(A||(m.shape.y+=d),m.shape.height=0);var I=hi(s)?function(E){s(E,m)}:null;Jl(m,{shape:{width:a,height:d,x:l,y:c}},t,null,r,I)}return m}function Lle(n,e,t){var r=n.getArea(),s=Ca(r.r0,1),o=Ca(r.r,1),l=new Hh({shape:{cx:Ca(n.cx,1),cy:Ca(n.cy,1),r0:s,r:o,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});if(e){var c=n.getBaseAxis().dim==="angle";c?l.shape.endAngle=r.startAngle:l.shape.r=s,Jl(l,{shape:{endAngle:r.endAngle,r:o}},t)}return l}function Rke(n,e,t,r,s){if(n){if(n.type==="polar")return Lle(n,e,t);if(n.type==="cartesian2d")return Rle(n,e,t,r,s)}else return null;return null}function u8(n,e){return n.type===e}function bZ(n,e){if(n.length===e.length){for(var t=0;t<n.length;t++)if(n[t]!==e[t])return;return!0}}function wZ(n){for(var e=1/0,t=1/0,r=-1/0,s=-1/0,o=0;o<n.length;){var l=n[o++],c=n[o++];isNaN(l)||(e=Math.min(l,e),r=Math.max(l,r)),isNaN(c)||(t=Math.min(c,t),s=Math.max(c,s))}return[[e,t],[r,s]]}function SZ(n,e){var t=wZ(n),r=t[0],s=t[1],o=wZ(e),l=o[0],c=o[1];return Math.max(Math.abs(r[0]-l[0]),Math.abs(r[1]-l[1]),Math.abs(s[0]-c[0]),Math.abs(s[1]-c[1]))}function AZ(n){return Ds(n)?n:n?.5:0}function Lke(n,e,t){if(!t.valueDim)return[];for(var r=e.count(),s=Vm(r*2),o=0;o<r;o++){var l=Ile(t,n,e,o);s[o*2]=l[0],s[o*2+1]=l[1]}return s}function Bv(n,e,t,r){var s=e.getBaseAxis(),o=s.dim==="x"||s.dim==="radius"?0:1,l=[],c=0,a=[],d=[],f=[],m=[];if(r){for(c=0;c<n.length;c+=2)!isNaN(n[c])&&!isNaN(n[c+1])&&m.push(n[c],n[c+1]);n=m}for(c=0;c<n.length-2;c+=2)switch(f[0]=n[c+2],f[1]=n[c+3],d[0]=n[c],d[1]=n[c+1],l.push(d[0],d[1]),t){case"end":a[o]=f[o],a[1-o]=d[1-o],l.push(a[0],a[1]);break;case"middle":var _=(d[o]+f[o])/2,x=[];a[o]=x[o]=_,a[1-o]=d[1-o],x[1-o]=f[1-o],l.push(a[0],a[1]),l.push(x[0],x[1]);break;default:a[o]=d[o],a[1-o]=f[1-o],l.push(a[0],a[1])}return l.push(n[c++],n[c++]),l}function Dke(n,e){var t=[],r=n.length,s,o;function l(f,m,_){var x=f.coord,A=(_-x)/(m.coord-x),I=LEe(A,[f.color,m.color]);return{coord:_,color:I}}for(var c=0;c<r;c++){var a=n[c],d=a.coord;if(d<0)s=a;else if(d>e){o?t.push(l(o,a,e)):s&&t.push(l(s,a,0),l(s,a,e));break}else s&&(t.push(l(s,a,0)),s=null),t.push(a),o=a}return t}function Bke(n,e,t){var r=n.getVisual("visualMeta");if(!(!r||!r.length||!n.count())&&e.type==="cartesian2d"){for(var s,o,l=r.length-1;l>=0;l--){var c=n.getDimensionInfo(r[l].dimension);if(s=c&&c.coordDim,s==="x"||s==="y"){o=r[l];break}}if(o){var a=e.getAxis(s),d=br(o.stops,function(O){return{coord:a.toGlobalCoord(a.dataToCoord(O.value)),color:O.color}}),f=d.length,m=o.outerColors.slice();f&&d[0].coord>d[f-1].coord&&(d.reverse(),m.reverse());var _=Dke(d,s==="x"?t.getWidth():t.getHeight()),x=_.length;if(!x&&f)return d[0].coord<0?m[1]?m[1]:d[f-1].color:m[0]?m[0]:d[0].color;var A=10,I=_[0].coord-A,E=_[x-1].coord+A,C=E-I;if(C<.001)return"transparent";ot(_,function(O){O.offset=(O.coord-I)/C}),_.push({offset:x?_[x-1].offset:.5,color:m[1]||"transparent"}),_.unshift({offset:x?_[0].offset:.5,color:m[0]||"transparent"});var L=new doe(0,0,0,0,_,!0);return L[s]=I,L[s+"2"]=E,L}}}function kke(n,e,t){var r=n.get("showAllSymbol"),s=r==="auto";if(!(r&&!s)){var o=t.getAxesByScale("ordinal")[0];if(o&&!(s&&Oke(o,e))){var l=e.mapDimension(o.dim),c={};return ot(o.getViewLabels(),function(a){var d=o.scale.getRawOrdinalNumber(a.tickValue);c[d]=1}),function(a){return!c.hasOwnProperty(e.get(l,a))}}}}function Oke(n,e){var t=n.getExtent(),r=Math.abs(t[1]-t[0])/n.scale.count();isNaN(r)&&(r=0);for(var s=e.count(),o=Math.max(1,Math.round(s/5)),l=0;l<s;l+=o)if(c8.getSymbolSize(e,l)[n.isHorizontal()?1:0]*1.5>r)return!1;return!0}function Fke(n,e){return isNaN(n)||isNaN(e)}function Nke(n){for(var e=n.length/2;e>0&&Fke(n[e*2-2],n[e*2-1]);e--);return e-1}function TZ(n,e){return[n[e*2],n[e*2+1]]}function zke(n,e,t){for(var r=n.length/2,s=t==="x"?0:1,o,l,c=0,a=-1,d=0;d<r;d++)if(l=n[d*2+s],!(isNaN(l)||isNaN(n[d*2+1-s]))){if(d===0){o=l;continue}if(o<=e&&l>=e||o>=e&&l<=e){a=d;break}c=d,o=l}return{range:[c,a],t:(e-o)/(l-o)}}function Dle(n){if(n.get(["endLabel","show"]))return!0;for(var e=0;e<Vh.length;e++)if(n.get([Vh[e],"endLabel","show"]))return!0;return!1}function rN(n,e,t,r){if(u8(e,"cartesian2d")){var s=r.getModel("endLabel"),o=s.get("valueAnimation"),l=r.getData(),c={lastFrameIndex:0},a=Dle(r)?function(x,A){n._endLabelOnDuring(x,A,l,c,o,s,e)}:null,d=e.getBaseAxis().isHorizontal(),f=Rle(e,t,r,function(){var x=n._endLabel;x&&t&&c.originalX!=null&&x.attr({x:c.originalX,y:c.originalY})},a);if(!r.get("clip",!0)){var m=f.shape,_=Math.max(m.width,m.height);d?(m.y-=_,m.height+=_*2):(m.x-=_,m.width+=_*2)}return a&&a(1,f),f}else return Lle(e,t,r)}function Uke(n,e){var t=e.getBaseAxis(),r=t.isHorizontal(),s=t.inverse,o=r?s?"right":"left":"center",l=r?"middle":s?"top":"bottom";return{normal:{align:n.get("align")||o,verticalAlign:n.get("verticalAlign")||l}}}var Gke=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(){var t=new _a,r=new Ake;this.group.add(r.group),this._symbolDraw=r,this._lineGroup=t},e.prototype.render=function(t,r,s){var o=this,l=t.coordinateSystem,c=this.group,a=t.getData(),d=t.getModel("lineStyle"),f=t.getModel("areaStyle"),m=a.getLayout("points")||[],_=l.type==="polar",x=this._coordSys,A=this._symbolDraw,I=this._polyline,E=this._polygon,C=this._lineGroup,L=!r.ssr&&t.get("animation"),O=!f.isEmpty(),H=f.get("origin"),q=Ele(l,a,H),Z=O&&Lke(l,a,q),J=t.get("showSymbol"),re=t.get("connectNulls"),se=J&&!_&&kke(t,a,l),ae=this._data;ae&&ae.eachItemGraphicEl(function(Qt,nn){Qt.__temp&&(c.remove(Qt),ae.setItemGraphicEl(nn,null))}),J||A.remove(),c.add(C);var he=_?!1:t.get("step"),Ae;l&&l.getArea&&t.get("clip",!0)&&(Ae=l.getArea(),Ae.width!=null?(Ae.x-=.1,Ae.y-=.1,Ae.width+=.2,Ae.height+=.2):Ae.r0&&(Ae.r0-=.5,Ae.r+=.5)),this._clipShapeForSymbol=Ae;var Ee=Bke(a,l,s)||a.getVisual("style")[a.getVisual("drawType")];if(!(I&&x.type===l.type&&he===this._step))J&&A.updateData(a,{isIgnore:se,clipShape:Ae,disableAnimation:!0,getSymbolPoint:function(Qt){return[m[Qt*2],m[Qt*2+1]]}}),L&&this._initSymbolLabelAnimation(a,l,Ae),he&&(m=Bv(m,l,he,re),Z&&(Z=Bv(Z,l,he,re))),I=this._newPolyline(m),O?E=this._newPolygon(m,Z):E&&(C.remove(E),E=this._polygon=null),_||this._initOrUpdateEndLabel(t,l,xx(Ee)),C.setClipPath(rN(this,l,!0,t));else{O&&!E?E=this._newPolygon(m,Z):E&&!O&&(C.remove(E),E=this._polygon=null),_||this._initOrUpdateEndLabel(t,l,xx(Ee));var Pe=C.getClipPath();if(Pe){var ze=rN(this,l,!1,t);Jl(Pe,{shape:ze.shape},t)}else C.setClipPath(rN(this,l,!0,t));J&&A.updateData(a,{isIgnore:se,clipShape:Ae,disableAnimation:!0,getSymbolPoint:function(Qt){return[m[Qt*2],m[Qt*2+1]]}}),(!bZ(this._stackedOnPoints,Z)||!bZ(this._points,m))&&(L?this._doUpdateAnimation(a,Z,l,s,he,H,re):(he&&(m=Bv(m,l,he,re),Z&&(Z=Bv(Z,l,he,re))),I.setShape({points:m}),E&&E.setShape({points:m,stackedOnPoints:Z})))}var Re=t.getModel("emphasis"),rt=Re.get("focus"),ye=Re.get("blurScope"),We=Re.get("disabled");if(I.useStyle(ri(d.getLineStyle(),{fill:"none",stroke:Ee,lineJoin:"bevel"})),dL(I,t,"lineStyle"),I.style.lineWidth>0&&t.get(["emphasis","lineStyle","width"])==="bolder"){var Ue=I.getState("emphasis").style;Ue.lineWidth=+I.style.lineWidth+1}Yi(I).seriesIndex=t.seriesIndex,DM(I,rt,ye,We);var gt=AZ(t.get("smooth")),vt=t.get("smoothMonotone");if(I.setShape({smooth:gt,smoothMonotone:vt,connectNulls:re}),E){var Dt=a.getCalculationInfo("stackedOnSeries"),lt=0;E.useStyle(ri(f.getAreaStyle(),{fill:Ee,opacity:.7,lineJoin:"bevel",decal:a.getVisual("style").decal})),Dt&&(lt=AZ(Dt.get("smooth"))),E.setShape({smooth:gt,stackedOnSmooth:lt,smoothMonotone:vt,connectNulls:re}),dL(E,t,"areaStyle"),Yi(E).seriesIndex=t.seriesIndex,DM(E,rt,ye,We)}var jt=function(Qt){o._changePolyState(Qt)};a.eachItemGraphicEl(function(Qt){Qt&&(Qt.onHoverStateChange=jt)}),this._polyline.onHoverStateChange=jt,this._data=a,this._coordSys=l,this._stackedOnPoints=Z,this._points=m,this._step=he,this._valueOrigin=H,t.get("triggerLineEvent")&&(this.packEventData(t,I),E&&this.packEventData(t,E))},e.prototype.packEventData=function(t,r){Yi(r).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,r,s,o){var l=t.getData(),c=yx(l,o);if(this._changePolyState("emphasis"),!(c instanceof Array)&&c!=null&&c>=0){var a=l.getLayout("points"),d=l.getItemGraphicEl(c);if(!d){var f=a[c*2],m=a[c*2+1];if(isNaN(f)||isNaN(m)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,m))return;var _=t.get("zlevel")||0,x=t.get("z")||0;d=new c8(l,c),d.x=f,d.y=m,d.setZ(_,x);var A=d.getSymbolPath().getTextContent();A&&(A.zlevel=_,A.z=x,A.z2=this._polyline.z2+1),d.__temp=!0,l.setItemGraphicEl(c,d),d.stopSymbolAnimation(!0),this.group.add(d)}d.highlight()}else Oh.prototype.highlight.call(this,t,r,s,o)},e.prototype.downplay=function(t,r,s,o){var l=t.getData(),c=yx(l,o);if(this._changePolyState("normal"),c!=null&&c>=0){var a=l.getItemGraphicEl(c);a&&(a.__temp?(l.setItemGraphicEl(c,null),this.group.remove(a)):a.downplay())}else Oh.prototype.downplay.call(this,t,r,s,o)},e.prototype._changePolyState=function(t){var r=this._polygon;Bq(this._polyline,t),r&&Bq(r,t)},e.prototype._newPolyline=function(t){var r=this._polyline;return r&&this._lineGroup.remove(r),r=new Eke({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(r),this._polyline=r,r},e.prototype._newPolygon=function(t,r){var s=this._polygon;return s&&this._lineGroup.remove(s),s=new Pke({shape:{points:t,stackedOnPoints:r},segmentIgnoreThreshold:2}),this._lineGroup.add(s),this._polygon=s,s},e.prototype._initSymbolLabelAnimation=function(t,r,s){var o,l,c=r.getBaseAxis(),a=c.inverse;r.type==="cartesian2d"?(o=c.isHorizontal(),l=!1):r.type==="polar"&&(o=c.dim==="angle",l=!0);var d=t.hostModel,f=d.get("animationDuration");hi(f)&&(f=f(null));var m=d.get("animationDelay")||0,_=hi(m)?m(null):m;t.eachItemGraphicEl(function(x,A){var I=x;if(I){var E=[x.x,x.y],C=void 0,L=void 0,O=void 0;if(s)if(l){var H=s,q=r.pointToCoord(E);o?(C=H.startAngle,L=H.endAngle,O=-q[1]/180*Math.PI):(C=H.r0,L=H.r,O=q[0])}else{var Z=s;o?(C=Z.x,L=Z.x+Z.width,O=x.x):(C=Z.y+Z.height,L=Z.y,O=x.y)}var J=L===C?0:(O-C)/(L-C);a&&(J=1-J);var re=hi(m)?m(A):f*J+_,se=I.getSymbolPath(),ae=se.getTextContent();I.attr({scaleX:0,scaleY:0}),I.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:re}),ae&&ae.animateFrom({style:{opacity:0}},{duration:300,delay:re}),se.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(t,r,s){var o=t.getModel("endLabel");if(Dle(t)){var l=t.getData(),c=this._polyline,a=l.getLayout("points");if(!a){c.removeTextContent(),this._endLabel=null;return}var d=this._endLabel;d||(d=this._endLabel=new Ra({z2:200}),d.ignoreClip=!0,c.setTextContent(this._endLabel),c.disableLabelAnimation=!0);var f=Nke(a);f>=0&&(kC(c,OC(t,"endLabel"),{inheritColor:s,labelFetcher:t,labelDataIndex:f,defaultText:function(m,_,x){return x!=null?Cle(l,x):l8(l,m)},enableTextSetter:!0},Uke(o,r)),c.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(t,r,s,o,l,c,a){var d=this._endLabel,f=this._polyline;if(d){t<1&&o.originalX==null&&(o.originalX=d.x,o.originalY=d.y);var m=s.getLayout("points"),_=s.hostModel,x=_.get("connectNulls"),A=c.get("precision"),I=c.get("distance")||0,E=a.getBaseAxis(),C=E.isHorizontal(),L=E.inverse,O=r.shape,H=L?C?O.x:O.y+O.height:C?O.x+O.width:O.y,q=(C?I:0)*(L?-1:1),Z=(C?0:-I)*(L?-1:1),J=C?"x":"y",re=zke(m,H,J),se=re.range,ae=se[1]-se[0],he=void 0;if(ae>=1){if(ae>1&&!x){var Ae=TZ(m,se[0]);d.attr({x:Ae[0]+q,y:Ae[1]+Z}),l&&(he=_.getRawValue(se[0]))}else{var Ae=f.getPointOn(H,J);Ae&&d.attr({x:Ae[0]+q,y:Ae[1]+Z});var Ee=_.getRawValue(se[0]),Pe=_.getRawValue(se[1]);l&&(he=Ese(s,A,Ee,Pe,re.t))}o.lastFrameIndex=se[0]}else{var ze=t===1||o.lastFrameIndex>0?se[0]:0,Ae=TZ(m,ze);l&&(he=_.getRawValue(ze)),d.attr({x:Ae[0]+q,y:Ae[1]+Z})}if(l){var Re=qw(d);typeof Re.setLabelText=="function"&&Re.setLabelText(he)}}},e.prototype._doUpdateAnimation=function(t,r,s,o,l,c,a){var d=this._polyline,f=this._polygon,m=t.hostModel,_=Cke(this._data,t,this._stackedOnPoints,r,this._coordSys,s,this._valueOrigin),x=_.current,A=_.stackedOnCurrent,I=_.next,E=_.stackedOnNext;if(l&&(x=Bv(_.current,s,l,a),A=Bv(_.stackedOnCurrent,s,l,a),I=Bv(_.next,s,l,a),E=Bv(_.stackedOnNext,s,l,a)),SZ(x,I)>3e3||f&&SZ(A,E)>3e3){d.stopAnimation(),d.setShape({points:I}),f&&(f.stopAnimation(),f.setShape({points:I,stackedOnPoints:E}));return}d.shape.__points=_.current,d.shape.points=x;var C={shape:{points:I}};_.current!==x&&(C.shape.__points=_.next),d.stopAnimation(),cl(d,C,m),f&&(f.setShape({points:x,stackedOnPoints:A}),f.stopAnimation(),cl(f,{shape:{stackedOnPoints:E}},m),d.shape.points!==f.shape.points&&(f.shape.points=d.shape.points));for(var L=[],O=_.status,H=0;H<O.length;H++){var q=O[H].cmd;if(q==="="){var Z=t.getItemGraphicEl(O[H].idx1);Z&&L.push({el:Z,ptIdx:H})}}d.animators&&d.animators.length&&d.animators[0].during(function(){f&&f.dirtyShape();for(var J=d.shape.__points,re=0;re<L.length;re++){var se=L[re].el,ae=L[re].ptIdx*2;se.x=J[ae],se.y=J[ae+1],se.markRedraw()}})},e.prototype.remove=function(t){var r=this.group,s=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),s&&s.eachItemGraphicEl(function(o,l){o.__temp&&(r.remove(o),s.setItemGraphicEl(l,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Oh);function Vke(n,e){return{seriesType:n,plan:qG(),reset:function(t){var r=t.getData(),s=t.coordinateSystem;if(t.pipelineContext,!!s){var o=br(s.dimensions,function(m){return r.mapDimension(m)}).slice(0,2),l=o.length,c=r.getCalculationInfo("stackResultDimension");bx(r,o[0])&&(o[0]=c),bx(r,o[1])&&(o[1]=c);var a=r.getStore(),d=r.getDimensionIndex(o[0]),f=r.getDimensionIndex(o[1]);return l&&{progress:function(m,_){for(var x=m.end-m.start,A=Vm(x*l),I=[],E=[],C=m.start,L=0;C<m.end;C++){var O=void 0;if(l===1){var H=a.get(d,C);O=s.dataToPoint(H,null,E)}else I[0]=a.get(d,C),I[1]=a.get(f,C),O=s.dataToPoint(I,null,E);A[L++]=O[0],A[L++]=O[1]}_.setLayout("points",A)}}}}}}var Hke={average:function(n){for(var e=0,t=0,r=0;r<n.length;r++)isNaN(n[r])||(e+=n[r],t++);return t===0?NaN:e/t},sum:function(n){for(var e=0,t=0;t<n.length;t++)e+=n[t]||0;return e},max:function(n){for(var e=-1/0,t=0;t<n.length;t++)n[t]>e&&(e=n[t]);return isFinite(e)?e:NaN},min:function(n){for(var e=1/0,t=0;t<n.length;t++)n[t]<e&&(e=n[t]);return isFinite(e)?e:NaN},minmax:function(n){for(var e=-1/0,t=-1/0,r=0;r<n.length;r++){var s=n[r],o=Math.abs(s);o>e&&(e=o,t=s)}return isFinite(t)?t:NaN},nearest:function(n){return n[0]}},jke=function(n){return Math.round(n.length/2)};function Ble(n){return{seriesType:n,reset:function(e,t,r){var s=e.getData(),o=e.get("sampling"),l=e.coordinateSystem,c=s.count();if(c>10&&l.type==="cartesian2d"&&o){var a=l.getBaseAxis(),d=l.getOtherAxis(a),f=a.getExtent(),m=r.getDevicePixelRatio(),_=Math.abs(f[1]-f[0])*(m||1),x=Math.round(c/_);if(isFinite(x)&&x>1){o==="lttb"&&e.setData(s.lttbDownSample(s.mapDimension(d.dim),1/x));var A=void 0;Br(o)?A=Hke[o]:hi(o)&&(A=o),A&&e.setData(s.downSample(s.mapDimension(d.dim),1/x,A,jke))}}}}}function Wke(n){n.registerChartView(Gke),n.registerSeriesModel(wke),n.registerLayout(Vke("line")),n.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),r=e.getModel("lineStyle").getLineStyle();r&&!r.stroke&&(r.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",r)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,Ble("line"))}var w5=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(t,r){return t8(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t,r,s){var o=this.coordinateSystem;if(o&&o.clampData){var l=o.clampData(t),c=o.dataToPoint(l);if(s)ot(o.getAxes(),function(_,x){if(_.type==="category"&&r!=null){var A=_.getTicksCoords(),I=_.getTickModel().get("alignWithLabel"),E=l[x],C=r[x]==="x1"||r[x]==="y1";if(C&&!I&&(E+=1),A.length<2)return;if(A.length===2){c[x]=_.toGlobalCoord(_.getExtent()[C?1:0]);return}for(var L=void 0,O=void 0,H=1,q=0;q<A.length;q++){var Z=A[q].coord,J=q===A.length-1?A[q-1].tickValue+H:A[q].tickValue;if(J===E){O=Z;break}else if(J<E)L=Z;else if(L!=null&&J>E){O=(Z+L)/2;break}q===1&&(H=J-A[0].tickValue)}O==null&&(L?L&&(O=A[A.length-1].coord):O=A[0].coord),c[x]=_.toGlobalCoord(O)}});else{var a=this.getData(),d=a.getLayout("offset"),f=a.getLayout("size"),m=o.getBaseAxis().isHorizontal()?0:1;c[m]+=d+f/2}return c}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(sf);sf.registerClass(w5);var $ke=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(){return t8(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),r=this.get("largeThreshold");return r>t&&(t=r),t},e.prototype.brushSelector=function(t,r,s){return s.rect(r.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=Aoe(w5.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(w5),Xke=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),MZ=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="sausage",r}return e.prototype.getDefaultShape=function(){return new Xke},e.prototype.buildPath=function(t,r){var s=r.cx,o=r.cy,l=Math.max(r.r0||0,0),c=Math.max(r.r,0),a=(c-l)*.5,d=l+a,f=r.startAngle,m=r.endAngle,_=r.clockwise,x=Math.PI*2,A=_?m-f<x:f-m<x;A||(f=m-(_?x:-x));var I=Math.cos(f),E=Math.sin(f),C=Math.cos(m),L=Math.sin(m);A?(t.moveTo(I*l+s,E*l+o),t.arc(I*d+s,E*d+o,a,-Math.PI+f,f,!_)):t.moveTo(I*c+s,E*c+o),t.arc(s,o,c,f,m,!_),t.arc(C*d+s,L*d+o,a,m-Math.PI*2,m-Math.PI,!_),l!==0&&t.arc(s,o,l,m,f,_)},e}(Ki);function qke(n,e){e=e||{};var t=e.isRoundCap;return function(r,s,o){var l=s.position;if(!l||l instanceof Array)return lL(r,s,o);var c=n(l),a=s.distance!=null?s.distance:5,d=this.shape,f=d.cx,m=d.cy,_=d.r,x=d.r0,A=(_+x)/2,I=d.startAngle,E=d.endAngle,C=(I+E)/2,L=t?Math.abs(_-x)/2:0,O=Math.cos,H=Math.sin,q=f+_*O(I),Z=m+_*H(I),J="left",re="top";switch(c){case"startArc":q=f+(x-a)*O(C),Z=m+(x-a)*H(C),J="center",re="top";break;case"insideStartArc":q=f+(x+a)*O(C),Z=m+(x+a)*H(C),J="center",re="bottom";break;case"startAngle":q=f+A*O(I)+OI(I,a+L,!1),Z=m+A*H(I)+FI(I,a+L,!1),J="right",re="middle";break;case"insideStartAngle":q=f+A*O(I)+OI(I,-a+L,!1),Z=m+A*H(I)+FI(I,-a+L,!1),J="left",re="middle";break;case"middle":q=f+A*O(C),Z=m+A*H(C),J="center",re="middle";break;case"endArc":q=f+(_+a)*O(C),Z=m+(_+a)*H(C),J="center",re="bottom";break;case"insideEndArc":q=f+(_-a)*O(C),Z=m+(_-a)*H(C),J="center",re="top";break;case"endAngle":q=f+A*O(E)+OI(E,a+L,!0),Z=m+A*H(E)+FI(E,a+L,!0),J="left",re="middle";break;case"insideEndAngle":q=f+A*O(E)+OI(E,-a+L,!0),Z=m+A*H(E)+FI(E,-a+L,!0),J="right",re="middle";break;default:return lL(r,s,o)}return r=r||{},r.x=q,r.y=Z,r.align=J,r.verticalAlign=re,r}}function Yke(n,e,t,r){if(Ds(r)){n.setTextConfig({rotation:r});return}else if(fr(e)){n.setTextConfig({rotation:0});return}var s=n.shape,o=s.clockwise?s.startAngle:s.endAngle,l=s.clockwise?s.endAngle:s.startAngle,c=(o+l)/2,a,d=t(e);switch(d){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":a=c;break;case"startAngle":case"insideStartAngle":a=o;break;case"endAngle":case"insideEndAngle":a=l;break;default:n.setTextConfig({rotation:0});return}var f=Math.PI*1.5-a;d==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),n.setTextConfig({rotation:f})}function OI(n,e,t){return e*Math.sin(n)*(t?-1:1)}function FI(n,e,t){return e*Math.cos(n)*(t?1:-1)}function eT(n,e,t){var r=n.get("borderRadius");if(r==null)return t?{cornerRadius:0}:null;fr(r)||(r=[r,r,r,r]);var s=Math.abs(e.r||0-e.r0||0);return{cornerRadius:br(r,function(o){return C0(o,s)})}}var iN=Math.max,sN=Math.min;function Zke(n,e){var t=n.getArea&&n.getArea();if(u8(n,"cartesian2d")){var r=n.getBaseAxis();if(r.type!=="category"||!r.onBand){var s=e.getLayout("bandWidth");r.isHorizontal()?(t.x-=s,t.width+=s*2):(t.y-=s,t.height+=s*2)}}return t}var Kke=function(n){jn(e,n);function e(){var t=n.call(this)||this;return t.type=e.type,t._isFirstFrame=!0,t}return e.prototype.render=function(t,r,s,o){this._model=t,this._removeOnRenderedListener(s),this._updateDrawMode(t);var l=t.get("coordinateSystem");(l==="cartesian2d"||l==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(t,r,s):this._renderNormal(t,r,s,o))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,r){this._progressiveEls=[],this._incrementalRenderLarge(t,r)},e.prototype.eachRendered=function(t){TB(this._progressiveEls||this.group,t)},e.prototype._updateDrawMode=function(t){var r=t.pipelineContext.large;(this._isLargeDraw==null||r!==this._isLargeDraw)&&(this._isLargeDraw=r,this._clear())},e.prototype._renderNormal=function(t,r,s,o){var l=this.group,c=t.getData(),a=this._data,d=t.coordinateSystem,f=d.getBaseAxis(),m;d.type==="cartesian2d"?m=f.isHorizontal():d.type==="polar"&&(m=f.dim==="angle");var _=t.isAnimationEnabled()?t:null,x=Jke(t,d);x&&this._enableRealtimeSort(x,c,s);var A=t.get("clip",!0)||x,I=Zke(d,c);l.removeClipPath();var E=t.get("roundCap",!0),C=t.get("showBackground",!0),L=t.getModel("backgroundStyle"),O=L.get("borderRadius")||0,H=[],q=this._backgroundEls,Z=o&&o.isInitSort,J=o&&o.type==="changeAxisOrder";function re(he){var Ae=NI[d.type](c,he),Ee=sOe(d,m,Ae);return Ee.useStyle(L.getItemStyle()),d.type==="cartesian2d"?Ee.setShape("r",O):Ee.setShape("cornerRadius",O),H[he]=Ee,Ee}c.diff(a).add(function(he){var Ae=c.getItemModel(he),Ee=NI[d.type](c,he,Ae);if(C&&re(he),!(!c.hasValue(he)||!RZ[d.type](Ee))){var Pe=!1;A&&(Pe=CZ[d.type](I,Ee));var ze=EZ[d.type](t,c,he,Ee,m,_,f.model,!1,E);x&&(ze.forceLabelAnimation=!0),LZ(ze,c,he,Ae,Ee,t,m,d.type==="polar"),Z?ze.attr({shape:Ee}):x?IZ(x,_,ze,Ee,he,m,!1,!1):Jl(ze,{shape:Ee},t,he),c.setItemGraphicEl(he,ze),l.add(ze),ze.ignore=Pe}}).update(function(he,Ae){var Ee=c.getItemModel(he),Pe=NI[d.type](c,he,Ee);if(C){var ze=void 0;q.length===0?ze=re(Ae):(ze=q[Ae],ze.useStyle(L.getItemStyle()),d.type==="cartesian2d"?ze.setShape("r",O):ze.setShape("cornerRadius",O),H[he]=ze);var Re=NI[d.type](c,he),rt=Ole(m,Re,d);cl(ze,{shape:rt},_,he)}var ye=a.getItemGraphicEl(Ae);if(!c.hasValue(he)||!RZ[d.type](Pe)){l.remove(ye);return}var We=!1;if(A&&(We=CZ[d.type](I,Pe),We&&l.remove(ye)),ye?PG(ye):ye=EZ[d.type](t,c,he,Pe,m,_,f.model,!!ye,E),x&&(ye.forceLabelAnimation=!0),J){var Ue=ye.getTextContent();if(Ue){var gt=qw(Ue);gt.prevValue!=null&&(gt.prevValue=gt.value)}}else LZ(ye,c,he,Ee,Pe,t,m,d.type==="polar");Z?ye.attr({shape:Pe}):x?IZ(x,_,ye,Pe,he,m,!0,J):cl(ye,{shape:Pe},t,he,null),c.setItemGraphicEl(he,ye),ye.ignore=We,l.add(ye)}).remove(function(he){var Ae=a.getItemGraphicEl(he);Ae&&mL(Ae,t,he)}).execute();var se=this._backgroundGroup||(this._backgroundGroup=new _a);se.removeAll();for(var ae=0;ae<H.length;++ae)se.add(H[ae]);l.add(se),this._backgroundEls=H,this._data=c},e.prototype._renderLarge=function(t,r,s){this._clear(),BZ(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,r){this._removeBackground(),BZ(r,this.group,this._progressiveEls,!0)},e.prototype._updateLargeClip=function(t){var r=t.get("clip",!0)&&Rke(t.coordinateSystem,!1,t),s=this.group;r?s.setClipPath(r):s.removeClipPath()},e.prototype._enableRealtimeSort=function(t,r,s){var o=this;if(r.count()){var l=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(r,t,s),this._isFirstFrame=!1;else{var c=function(a){var d=r.getItemGraphicEl(a),f=d&&d.shape;return f&&Math.abs(l.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){o._updateSortWithinSameData(r,c,l,s)},s.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,r,s){var o=[];return t.each(t.mapDimension(r.dim),function(l,c){var a=s(c);a=a??NaN,o.push({dataIndex:c,mappedValue:a,ordinalNumber:l})}),o.sort(function(l,c){return c.mappedValue-l.mappedValue}),{ordinalNumbers:br(o,function(l){return l.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(t,r,s){for(var o=s.scale,l=t.mapDimension(s.dim),c=Number.MAX_VALUE,a=0,d=o.getOrdinalMeta().categories.length;a<d;++a){var f=t.rawIndexOf(l,o.getRawOrdinalNumber(a)),m=f<0?Number.MIN_VALUE:r(t.indexOfRawIndex(f));if(m>c)return!0;c=m}return!1},e.prototype._isOrderDifferentInView=function(t,r){for(var s=r.scale,o=s.getExtent(),l=Math.max(0,o[0]),c=Math.min(o[1],s.getOrdinalMeta().categories.length-1);l<=c;++l)if(t.ordinalNumbers[l]!==s.getRawOrdinalNumber(l))return!0},e.prototype._updateSortWithinSameData=function(t,r,s,o){if(this._isOrderChangedWithinSameData(t,r,s)){var l=this._dataSort(t,s,r);this._isOrderDifferentInView(l,s)&&(this._removeOnRenderedListener(o),o.dispatchAction({type:"changeAxisOrder",componentType:s.dim+"Axis",axisId:s.index,sortInfo:l}))}},e.prototype._dispatchInitSort=function(t,r,s){var o=r.baseAxis,l=this._dataSort(t,o,function(c){return t.get(t.mapDimension(r.otherAxis.dim),c)});s.dispatchAction({type:"changeAxisOrder",componentType:o.dim+"Axis",isInitSort:!0,axisId:o.index,sortInfo:l})},e.prototype.remove=function(t,r){this._clear(this._model),this._removeOnRenderedListener(r)},e.prototype.dispose=function(t,r){this._removeOnRenderedListener(r)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var r=this.group,s=this._data;t&&t.isAnimationEnabled()&&s&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],s.eachItemGraphicEl(function(o){mL(o,t,Yi(o).dataIndex)})):r.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Oh),CZ={cartesian2d:function(n,e){var t=e.width<0?-1:1,r=e.height<0?-1:1;t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height);var s=n.x+n.width,o=n.y+n.height,l=iN(e.x,n.x),c=sN(e.x+e.width,s),a=iN(e.y,n.y),d=sN(e.y+e.height,o),f=c<l,m=d<a;return e.x=f&&l>s?c:l,e.y=m&&a>o?d:a,e.width=f?0:c-l,e.height=m?0:d-a,t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height),f||m},polar:function(n,e){var t=e.r0<=e.r?1:-1;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}var s=sN(e.r,n.r),o=iN(e.r0,n.r0);e.r=s,e.r0=o;var l=s-o<0;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}return l}},EZ={cartesian2d:function(n,e,t,r,s,o,l,c,a){var d=new $o({shape:Qn({},r),z2:1});if(d.__dataIndex=t,d.name="item",o){var f=d.shape,m=s?"height":"width";f[m]=0}return d},polar:function(n,e,t,r,s,o,l,c,a){var d=!s&&a?MZ:Hh,f=new d({shape:r,z2:1});f.name="item";var m=kle(s);if(f.calculateTextPosition=qke(m,{isRoundCap:d===MZ}),o){var _=f.shape,x=s?"r":"endAngle",A={};_[x]=s?r.r0:r.startAngle,A[x]=r[x],(c?cl:Jl)(f,{shape:A},o)}return f}};function Jke(n,e){var t=n.get("realtimeSort",!0),r=e.getBaseAxis();if(t&&r.type==="category"&&e.type==="cartesian2d")return{baseAxis:r,otherAxis:e.getOtherAxis(r)}}function IZ(n,e,t,r,s,o,l,c){var a,d;o?(d={x:r.x,width:r.width},a={y:r.y,height:r.height}):(d={y:r.y,height:r.height},a={x:r.x,width:r.width}),c||(l?cl:Jl)(t,{shape:a},e,s,null);var f=e?n.baseAxis.model:null;(l?cl:Jl)(t,{shape:d},f,s)}function PZ(n,e){for(var t=0;t<e.length;t++)if(!isFinite(n[e[t]]))return!0;return!1}var Qke=["x","y","width","height"],eOe=["cx","cy","r","startAngle","endAngle"],RZ={cartesian2d:function(n){return!PZ(n,Qke)},polar:function(n){return!PZ(n,eOe)}},NI={cartesian2d:function(n,e,t){var r=n.getItemLayout(e),s=t?nOe(t,r):0,o=r.width>0?1:-1,l=r.height>0?1:-1;return{x:r.x+o*s/2,y:r.y+l*s/2,width:r.width-o*s,height:r.height-l*s}},polar:function(n,e,t){var r=n.getItemLayout(e);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}}};function tOe(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function kle(n){return function(e){var t=e?"Arc":"Angle";return function(r){switch(r){case"start":case"insideStart":case"end":case"insideEnd":return r+t;default:return r}}}(n)}function LZ(n,e,t,r,s,o,l,c){var a=e.getItemVisual(t,"style");if(c){if(!o.get("roundCap")){var f=n.shape,m=eT(r.getModel("itemStyle"),f,!0);Qn(f,m),n.setShape(f)}}else{var d=r.get(["itemStyle","borderRadius"])||0;n.setShape("r",d)}n.useStyle(a);var _=r.getShallow("cursor");_&&n.attr("cursor",_);var x=c?l?s.r>=s.r0?"endArc":"startArc":s.endAngle>=s.startAngle?"endAngle":"startAngle":l?s.height>=0?"bottom":"top":s.width>=0?"right":"left",A=OC(r);kC(n,A,{labelFetcher:o,labelDataIndex:t,defaultText:l8(o.getData(),t),inheritColor:a.fill,defaultOpacity:a.opacity,defaultOutsidePosition:x});var I=n.getTextContent();if(c&&I){var E=r.get(["label","position"]);n.textConfig.inside=E==="middle"?!0:null,Yke(n,E==="outside"?x:E,kle(l),r.get(["label","rotate"]))}zPe(I,A,o.getRawValue(t),function(L){return Cle(e,L)});var C=r.getModel(["emphasis"]);DM(n,C.get("focus"),C.get("blurScope"),C.get("disabled")),dL(n,r),tOe(s)&&(n.style.fill="none",n.style.stroke="none",ot(n.states,function(L){L.style&&(L.style.fill=L.style.stroke="none")}))}function nOe(n,e){var t=n.get(["itemStyle","borderColor"]);if(!t||t==="none")return 0;var r=n.get(["itemStyle","borderWidth"])||0,s=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),o=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(r,s,o)}var rOe=function(){function n(){}return n}(),DZ=function(n){jn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="largeBar",r}return e.prototype.getDefaultShape=function(){return new rOe},e.prototype.buildPath=function(t,r){for(var s=r.points,o=this.baseDimIdx,l=1-this.baseDimIdx,c=[],a=[],d=this.barWidth,f=0;f<s.length;f+=3)a[o]=d,a[l]=s[f+2],c[o]=s[f+o],c[l]=s[f+l],t.rect(c[0],c[1],a[0],a[1])},e}(Ki);function BZ(n,e,t,r){var s=n.getData(),o=s.getLayout("valueAxisHorizontal")?1:0,l=s.getLayout("largeDataIndices"),c=s.getLayout("size"),a=n.getModel("backgroundStyle"),d=s.getLayout("largeBackgroundPoints");if(d){var f=new DZ({shape:{points:d},incremental:!!r,silent:!0,z2:0});f.baseDimIdx=o,f.largeDataIndices=l,f.barWidth=c,f.useStyle(a.getItemStyle()),e.add(f),t&&t.push(f)}var m=new DZ({shape:{points:s.getLayout("largePoints")},incremental:!!r,ignoreCoarsePointer:!0,z2:1});m.baseDimIdx=o,m.largeDataIndices=l,m.barWidth=c,e.add(m),m.useStyle(s.getVisual("style")),Yi(m).seriesIndex=n.seriesIndex,n.get("silent")||(m.on("mousedown",kZ),m.on("mousemove",kZ)),t&&t.push(m)}var kZ=YG(function(n){var e=this,t=iOe(e,n.offsetX,n.offsetY);Yi(e).dataIndex=t>=0?t:null},30,!1);function iOe(n,e,t){for(var r=n.baseDimIdx,s=1-r,o=n.shape.points,l=n.largeDataIndices,c=[],a=[],d=n.barWidth,f=0,m=o.length/3;f<m;f++){var _=f*3;if(a[r]=d,a[s]=o[_+2],c[r]=o[_+r],c[s]=o[_+s],a[s]<0&&(c[s]+=a[s],a[s]=-a[s]),e>=c[0]&&e<=c[0]+a[0]&&t>=c[1]&&t<=c[1]+a[1])return l[f]}return-1}function Ole(n,e,t){if(u8(t,"cartesian2d")){var r=e,s=t.getArea();return{x:n?r.x:s.x,y:n?s.y:r.y,width:n?r.width:s.width,height:n?s.height:r.height}}else{var s=t.getArea(),o=e;return{cx:s.cx,cy:s.cy,r0:n?s.r0:o.r0,r:n?s.r:o.r,startAngle:n?o.startAngle:0,endAngle:n?o.endAngle:Math.PI*2}}}function sOe(n,e,t){var r=n.type==="polar"?Hh:$o;return new r({shape:Ole(e,t,n),silent:!0,z2:0})}function oOe(n){n.registerChartView(Kke),n.registerSeriesModel($ke),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,xs(RBe,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,LBe("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,Ble("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,t){var r=e.componentType||"series";t.eachComponent({mainType:r,query:e},function(s){e.sortInfo&&s.axis.setCategorySortInfo(e.sortInfo)})})}var OZ=Math.PI*2,zI=Math.PI/180;function Fle(n,e){return I0(n.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function Nle(n,e){var t=Fle(n,e),r=n.get("center"),s=n.get("radius");fr(s)||(s=[0,s]);var o=hs(t.width,e.getWidth()),l=hs(t.height,e.getHeight()),c=Math.min(o,l),a=hs(s[0],c/2),d=hs(s[1],c/2),f,m,_=n.coordinateSystem;if(_){var x=_.dataToPoint(r);f=x[0]||0,m=x[1]||0}else fr(r)||(r=[r,r]),f=hs(r[0],o)+t.x,m=hs(r[1],l)+t.y;return{cx:f,cy:m,r0:a,r:d}}function aOe(n,e,t){e.eachSeriesByType(n,function(r){var s=r.getData(),o=s.mapDimension("value"),l=Fle(r,t),c=Nle(r,t),a=c.cx,d=c.cy,f=c.r,m=c.r0,_=-r.get("startAngle")*zI,x=r.get("endAngle"),A=r.get("padAngle")*zI;x=x==="auto"?_-OZ:-x*zI;var I=r.get("minAngle")*zI,E=I+A,C=0;s.each(o,function(rt){!isNaN(rt)&&C++});var L=s.getSum(o),O=Math.PI/(L||C)*2,H=r.get("clockwise"),q=r.get("roseType"),Z=r.get("stillShowZeroSum"),J=s.getDataExtent(o);J[0]=0;var re=H?1:-1,se=[_,x],ae=re*A/2;Ose(se,!H),_=se[0],x=se[1];var he=zle(r);he.startAngle=_,he.endAngle=x,he.clockwise=H;var Ae=Math.abs(x-_),Ee=Ae,Pe=0,ze=_;if(s.setLayout({viewRect:l,r:f}),s.each(o,function(rt,ye){var We;if(isNaN(rt)){s.setItemLayout(ye,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:H,cx:a,cy:d,r0:m,r:q?NaN:f});return}q!=="area"?We=L===0&&Z?O:rt*O:We=Ae/C,We<E?(We=E,Ee-=E):Pe+=rt;var Ue=ze+re*We,gt=0,vt=0;A>We?(gt=ze+re*We/2,vt=gt):(gt=ze+ae,vt=Ue-ae),s.setItemLayout(ye,{angle:We,startAngle:gt,endAngle:vt,clockwise:H,cx:a,cy:d,r0:m,r:q?qv(rt,J,[m,f]):f}),ze=Ue}),Ee<OZ&&C)if(Ee<=.001){var Re=Ae/C;s.each(o,function(rt,ye){if(!isNaN(rt)){var We=s.getItemLayout(ye);We.angle=Re;var Ue=0,gt=0;Re<A?(Ue=_+re*(ye+1/2)*Re,gt=Ue):(Ue=_+re*ye*Re+ae,gt=_+re*(ye+1)*Re-ae),We.startAngle=Ue,We.endAngle=gt}})}else O=Ee/Pe,ze=_,s.each(o,function(rt,ye){if(!isNaN(rt)){var We=s.getItemLayout(ye),Ue=We.angle===E?E:rt*O,gt=0,vt=0;Ue<A?(gt=ze+re*Ue/2,vt=gt):(gt=ze+ae,vt=ze+re*Ue-ae),We.startAngle=gt,We.endAngle=vt,ze+=re*Ue}})})}var zle=Zs();function lOe(n){return{seriesType:n,reset:function(e,t){var r=t.findComponents({mainType:"legend"});if(!(!r||!r.length)){var s=e.getData();s.filterSelf(function(o){for(var l=s.getName(o),c=0;c<r.length;c++)if(!r[c].isSelected(l))return!1;return!0})}}}}var cOe=Math.PI/180;function FZ(n,e,t,r,s,o,l,c,a,d){if(n.length<2)return;function f(I){for(var E=I.rB,C=E*E,L=0;L<I.list.length;L++){var O=I.list[L],H=Math.abs(O.label.y-t),q=r+O.len,Z=q*q,J=Math.sqrt((1-Math.abs(H*H/C))*Z),re=e+(J+O.len2)*s,se=re-O.label.x,ae=O.targetTextWidth-se*s;Ule(O,ae,!0),O.label.x=re}}function m(I){for(var E={list:[],maxY:0},C={list:[],maxY:0},L=0;L<I.length;L++)if(I[L].labelAlignTo==="none"){var O=I[L],H=O.label.y>t?C:E,q=Math.abs(O.label.y-t);if(q>=H.maxY){var Z=O.label.x-e-O.len2*s,J=r+O.len,re=Math.abs(Z)<J?Math.sqrt(q*q/(1-Z*Z/J/J)):J;H.rB=re,H.maxY=q}H.list.push(O)}f(E),f(C)}for(var _=n.length,x=0;x<_;x++)if(n[x].position==="outer"&&n[x].labelAlignTo==="labelLine"){var A=n[x].label.x-d;n[x].linePoints[1][0]+=A,n[x].label.x=d}Tle(n,a,a+l)&&m(n)}function uOe(n,e,t,r,s,o,l,c){for(var a=[],d=[],f=Number.MAX_VALUE,m=-Number.MAX_VALUE,_=0;_<n.length;_++){var x=n[_].label;oN(n[_])||(x.x<e?(f=Math.min(f,x.x),a.push(n[_])):(m=Math.max(m,x.x),d.push(n[_])))}for(var _=0;_<n.length;_++){var A=n[_];if(!oN(A)&&A.linePoints){if(A.labelStyleWidth!=null)continue;var x=A.label,I=A.linePoints,E=void 0;A.labelAlignTo==="edge"?x.x<e?E=I[2][0]-A.labelDistance-l-A.edgeDistance:E=l+s-A.edgeDistance-I[2][0]-A.labelDistance:A.labelAlignTo==="labelLine"?x.x<e?E=f-l-A.bleedMargin:E=l+s-m-A.bleedMargin:x.x<e?E=x.x-l-A.bleedMargin:E=l+s-x.x-A.bleedMargin,A.targetTextWidth=E,Ule(A,E)}}FZ(d,e,t,r,1,s,o,l,c,m),FZ(a,e,t,r,-1,s,o,l,c,f);for(var _=0;_<n.length;_++){var A=n[_];if(!oN(A)&&A.linePoints){var x=A.label,I=A.linePoints,C=A.labelAlignTo==="edge",L=x.style.padding,O=L?L[1]+L[3]:0,H=x.style.backgroundColor?0:O,q=A.rect.width+H,Z=I[1][0]-I[2][0];C?x.x<e?I[2][0]=l+A.edgeDistance+q+A.labelDistance:I[2][0]=l+s-A.edgeDistance-q-A.labelDistance:(x.x<e?I[2][0]=x.x+A.labelDistance:I[2][0]=x.x-A.labelDistance,I[1][0]=I[2][0]+Z),I[1][1]=I[2][1]=x.y}}}function Ule(n,e,t){if(t===void 0&&(t=!1),n.labelStyleWidth==null){var r=n.label,s=r.style,o=n.rect,l=s.backgroundColor,c=s.padding,a=c?c[1]+c[3]:0,d=s.overflow,f=o.width+(l?0:a);if(e<f||t){var m=o.height;if(d&&d.match("break")){r.setStyle("backgroundColor",null),r.setStyle("width",e-a);var _=r.getBoundingRect();r.setStyle("width",Math.ceil(_.width)),r.setStyle("backgroundColor",l)}else{var x=e-a,A=e<f?x:t?x>n.unconstrainedWidth?null:x:null;r.setStyle("width",A)}var I=r.getBoundingRect();o.width=I.width;var E=(r.style.margin||0)+2.1;o.height=I.height+E,o.y-=(o.height-m)/2}}}function oN(n){return n.position==="center"}function hOe(n){var e=n.getData(),t=[],r,s,o=!1,l=(n.get("minShowLabelAngle")||0)*cOe,c=e.getLayout("viewRect"),a=e.getLayout("r"),d=c.width,f=c.x,m=c.y,_=c.height;function x(Z){Z.ignore=!0}function A(Z){if(!Z.ignore)return!0;for(var J in Z.states)if(Z.states[J].ignore===!1)return!0;return!1}e.each(function(Z){var J=e.getItemGraphicEl(Z),re=J.shape,se=J.getTextContent(),ae=J.getTextGuideLine(),he=e.getItemModel(Z),Ae=he.getModel("label"),Ee=Ae.get("position")||he.get(["emphasis","label","position"]),Pe=Ae.get("distanceToLabelLine"),ze=Ae.get("alignTo"),Re=hs(Ae.get("edgeDistance"),d),rt=Ae.get("bleedMargin"),ye=he.getModel("labelLine"),We=ye.get("length");We=hs(We,d);var Ue=ye.get("length2");if(Ue=hs(Ue,d),Math.abs(re.endAngle-re.startAngle)<l){ot(se.states,x),se.ignore=!0,ae&&(ot(ae.states,x),ae.ignore=!0);return}if(A(se)){var gt=(re.startAngle+re.endAngle)/2,vt=Math.cos(gt),Dt=Math.sin(gt),lt,jt,Qt,nn;r=re.cx,s=re.cy;var Wn=Ee==="inside"||Ee==="inner";if(Ee==="center")lt=re.cx,jt=re.cy,nn="center";else{var kn=(Wn?(re.r+re.r0)/2*vt:re.r*vt)+r,Mn=(Wn?(re.r+re.r0)/2*Dt:re.r*Dt)+s;if(lt=kn+vt*3,jt=Mn+Dt*3,!Wn){var De=kn+vt*(We+a-re.r),Ye=Mn+Dt*(We+a-re.r),gn=De+(vt<0?-1:1)*Ue,un=Ye;ze==="edge"?lt=vt<0?f+Re:f+d-Re:lt=gn+(vt<0?-Pe:Pe),jt=un,Qt=[[kn,Mn],[De,Ye],[gn,un]]}nn=Wn?"center":ze==="edge"?vt>0?"right":"left":vt>0?"left":"right"}var At=Math.PI,en=0,On=Ae.get("rotate");if(Ds(On))en=On*(At/180);else if(Ee==="center")en=0;else if(On==="radial"||On===!0){var Vn=vt<0?-gt+At:-gt;en=Vn}else if(On==="tangential"&&Ee!=="outside"&&Ee!=="outer"){var on=Math.atan2(vt,Dt);on<0&&(on=At*2+on);var ct=Dt>0;ct&&(on=At+on),en=on-At}if(o=!!en,se.x=lt,se.y=jt,se.rotation=en,se.setStyle({verticalAlign:"middle"}),Wn){se.setStyle({align:nn});var Tn=se.states.select;Tn&&(Tn.x+=se.x,Tn.y+=se.y)}else{var He=se.getBoundingRect().clone();He.applyTransform(se.getComputedTransform());var qt=(se.style.margin||0)+2.1;He.y-=qt/2,He.height+=qt,t.push({label:se,labelLine:ae,position:Ee,len:We,len2:Ue,minTurnAngle:ye.get("minTurnAngle"),maxSurfaceAngle:ye.get("maxSurfaceAngle"),surfaceNormal:new ei(vt,Dt),linePoints:Qt,textAlign:nn,labelDistance:Pe,labelAlignTo:ze,edgeDistance:Re,bleedMargin:rt,rect:He,unconstrainedWidth:He.width,labelStyleWidth:se.style.width})}J.setTextConfig({inside:Wn})}}),!o&&n.get("avoidLabelOverlap")&&uOe(t,r,s,a,d,_,f,m);for(var I=0;I<t.length;I++){var E=t[I],C=E.label,L=E.labelLine,O=isNaN(C.x)||isNaN(C.y);if(C){C.setStyle({align:E.textAlign}),O&&(ot(C.states,x),C.ignore=!0);var H=C.states.select;H&&(H.x+=C.x,H.y+=C.y)}if(L){var q=E.linePoints;O||!q?(ot(L.states,x),L.ignore=!0):(xle(q,E.minTurnAngle),pke(q,E.surfaceNormal,E.maxSurfaceAngle),L.setShape({points:q}),C.__hostTarget.textGuideLineConfig={anchor:new ei(q[0][0],q[0][1])})}}}var dOe=function(n){jn(e,n);function e(t,r,s){var o=n.call(this)||this;o.z2=2;var l=new Ra;return o.setTextContent(l),o.updateData(t,r,s,!0),o}return e.prototype.updateData=function(t,r,s,o){var l=this,c=t.hostModel,a=t.getItemModel(r),d=a.getModel("emphasis"),f=t.getItemLayout(r),m=Qn(eT(a.getModel("itemStyle"),f,!0),f);if(isNaN(m.startAngle)){l.setShape(m);return}if(o){l.setShape(m);var _=c.getShallow("animationType");c.ecModel.ssr?(Jl(l,{scaleX:0,scaleY:0},c,{dataIndex:r,isFrom:!0}),l.originX=m.cx,l.originY=m.cy):_==="scale"?(l.shape.r=f.r0,Jl(l,{shape:{r:f.r}},c,r)):s!=null?(l.setShape({startAngle:s,endAngle:s}),Jl(l,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},c,r)):(l.shape.endAngle=f.startAngle,cl(l,{shape:{endAngle:f.endAngle}},c,r))}else PG(l),cl(l,{shape:m},c,r);l.useStyle(t.getItemVisual(r,"style")),dL(l,a);var x=(f.startAngle+f.endAngle)/2,A=c.get("selectedOffset"),I=Math.cos(x)*A,E=Math.sin(x)*A,C=a.getShallow("cursor");C&&l.attr("cursor",C),this._updateLabel(c,t,r),l.ensureState("emphasis").shape=Qn({r:f.r+(d.get("scale")&&d.get("scaleSize")||0)},eT(d.getModel("itemStyle"),f)),Qn(l.ensureState("select"),{x:I,y:E,shape:eT(a.getModel(["select","itemStyle"]),f)}),Qn(l.ensureState("blur"),{shape:eT(a.getModel(["blur","itemStyle"]),f)});var L=l.getTextGuideLine(),O=l.getTextContent();L&&Qn(L.ensureState("select"),{x:I,y:E}),Qn(O.ensureState("select"),{x:I,y:E}),DM(this,d.get("focus"),d.get("blurScope"),d.get("disabled"))},e.prototype._updateLabel=function(t,r,s){var o=this,l=r.getItemModel(s),c=l.getModel("labelLine"),a=r.getItemVisual(s,"style"),d=a&&a.fill,f=a&&a.opacity;kC(o,OC(l),{labelFetcher:r.hostModel,labelDataIndex:s,inheritColor:d,defaultOpacity:f,defaultText:t.getFormattedLabel(s,"normal")||r.getName(s)});var m=o.getTextContent();o.setTextConfig({position:null,rotation:null}),m.attr({z2:10});var _=t.get(["label","position"]);if(_!=="outside"&&_!=="outer")o.removeTextGuideLine();else{var x=this.getTextGuideLine();x||(x=new Xw,this.setTextGuideLine(x)),ble(this,wle(l),{stroke:d,opacity:MT(c.get(["lineStyle","opacity"]),f,1)})}},e}(Hh),fOe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return e.prototype.render=function(t,r,s,o){var l=t.getData(),c=this._data,a=this.group,d;if(!c&&l.count()>0){for(var f=l.getItemLayout(0),m=1;isNaN(f&&f.startAngle)&&m<l.count();++m)f=l.getItemLayout(m);f&&(d=f.startAngle)}if(this._emptyCircleSector&&a.remove(this._emptyCircleSector),l.count()===0&&t.get("showEmptyCircle")){var _=zle(t),x=new Hh({shape:Qn(Nle(t,s),_)});x.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=x,a.add(x)}l.diff(c).add(function(A){var I=new dOe(l,A,d);l.setItemGraphicEl(A,I),a.add(I)}).update(function(A,I){var E=c.getItemGraphicEl(I);E.updateData(l,A,d),E.off("click"),a.add(E),l.setItemGraphicEl(A,E)}).remove(function(A){var I=c.getItemGraphicEl(A);mL(I,t,A)}).execute(),hOe(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=l)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,r){var s=r.getData(),o=s.getItemLayout(0);if(o){var l=t[0]-o.cx,c=t[1]-o.cy,a=Math.sqrt(l*l+c*c);return a<=o.r&&a>=o.r0}},e.type="pie",e}(Oh);function pOe(n,e,t){e=fr(e)&&{coordDimensions:e}||Qn({encodeDefine:n.getEncode()},e);var r=n.getSource(),s=Jae(r,e).dimensions,o=new Kae(s,n);return o.initData(r,t),o}var mOe=function(){function n(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return n.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},n.prototype.containName=function(e){var t=this._getRawData();return t.indexOfName(e)>=0},n.prototype.indexOfName=function(e){var t=this._getDataWithEncodedVisual();return t.indexOfName(e)},n.prototype.getItemVisual=function(e,t){var r=this._getDataWithEncodedVisual();return r.getItemVisual(e,t)},n}(),gOe=Zs(),vOe=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new mOe(Vs(this.getData,this),Vs(this.getRawData,this)),this._defaultLabelLine(t)},e.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return pOe(this,{coordDimensions:["value"],encodeDefaulter:xs(pRe,this)})},e.prototype.getDataParams=function(t){var r=this.getData(),s=gOe(r),o=s.seats;if(!o){var l=[];r.each(r.mapDimension("value"),function(a){l.push(a)}),o=s.seats=c2e(l,r.hostModel.get("percentPrecision"))}var c=n.prototype.getDataParams.call(this,t);return c.percent=o[t]||0,c.$vars.push("percent"),c},e.prototype._defaultLabelLine=function(t){Wz(t,"labelLine",["show"]);var r=t.labelLine,s=t.emphasis.labelLine;r.show=r.show&&t.label.show,s.show=s.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(sf);function _Oe(n){return{seriesType:n,reset:function(e,t){var r=e.getData();r.filterSelf(function(s){var o=r.mapDimension("value"),l=r.get(o,s);return!(Ds(l)&&!isNaN(l)&&l<0)})}}}function yOe(n){n.registerChartView(fOe),n.registerSeriesModel(vOe),KLe("pie",n.registerAction),n.registerLayout(xs(aOe,"pie")),n.registerProcessor(lOe("pie")),n.registerProcessor(_Oe("pie"))}var xOe=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(cs),S5=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Sl).models[0]},e.type="cartesian2dAxis",e}(cs);df(S5,hle);var Gle={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},bOe=Fi({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},Gle),h8=Fi({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},Gle),wOe=Fi({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},h8),SOe=ri({logBase:10},h8);const AOe={category:bOe,value:h8,time:wOe,log:SOe};var TOe={value:1,category:1,time:1,log:1};function IL(n,e,t,r){ot(TOe,function(s,o){var l=Fi(Fi({},AOe[o],!0),r,!0),c=function(a){jn(d,a);function d(){var f=a!==null&&a.apply(this,arguments)||this;return f.type=e+"Axis."+o,f}return d.prototype.mergeDefaultAndTheme=function(f,m){var _=OM(this),x=_?DB(f):{},A=m.getTheme();Fi(f,A.get(o+"Axis")),Fi(f,this.getDefaultOption()),f.type=NZ(f),_&&Aw(f,x,_)},d.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=y5.createByAxisModel(this))},d.prototype.getCategories=function(f){var m=this.option;if(m.type==="category")return f?m.data:this.__ordinalMeta.categories},d.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},d.type=e+"Axis."+o,d.defaultOption=l,d}(t);n.registerComponentModel(c)}),n.registerSubTypeDefaulter(e+"Axis",NZ)}function NZ(n){return n.type||(n.data?"category":"value")}var MOe=function(){function n(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return n.prototype.getAxis=function(e){return this._axes[e]},n.prototype.getAxes=function(){return br(this._dimList,function(e){return this._axes[e]},this)},n.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),sa(this.getAxes(),function(t){return t.scale.type===e})},n.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},n}(),A5=["x","y"];function zZ(n){return n.type==="interval"||n.type==="time"}var COe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=A5,t}return e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,r=this.getAxis("y").scale;if(!(!zZ(t)||!zZ(r))){var s=t.getExtent(),o=r.getExtent(),l=this.dataToPoint([s[0],o[0]]),c=this.dataToPoint([s[1],o[1]]),a=s[1]-s[0],d=o[1]-o[0];if(!(!a||!d)){var f=(c[0]-l[0])/a,m=(c[1]-l[1])/d,_=l[0]-s[0]*f,x=l[1]-o[0]*m,A=this._transform=[f,0,0,m,_,x];this._invTransform=cB([],A)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var r=this.getAxis("x"),s=this.getAxis("y");return r.contain(r.toLocalCoord(t[0]))&&s.contain(s.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,r){var s=this.dataToPoint(t),o=this.dataToPoint(r),l=this.getArea(),c=new ds(s[0],s[1],o[0]-s[0],o[1]-s[1]);return l.intersect(c)},e.prototype.dataToPoint=function(t,r,s){s=s||[];var o=t[0],l=t[1];if(this._transform&&o!=null&&isFinite(o)&&l!=null&&isFinite(l))return kh(s,t,this._transform);var c=this.getAxis("x"),a=this.getAxis("y");return s[0]=c.toGlobalCoord(c.dataToCoord(o,r)),s[1]=a.toGlobalCoord(a.dataToCoord(l,r)),s},e.prototype.clampData=function(t,r){var s=this.getAxis("x").scale,o=this.getAxis("y").scale,l=s.getExtent(),c=o.getExtent(),a=s.parse(t[0]),d=o.parse(t[1]);return r=r||[],r[0]=Math.min(Math.max(Math.min(l[0],l[1]),a),Math.max(l[0],l[1])),r[1]=Math.min(Math.max(Math.min(c[0],c[1]),d),Math.max(c[0],c[1])),r},e.prototype.pointToData=function(t,r){var s=[];if(this._invTransform)return kh(s,t,this._invTransform);var o=this.getAxis("x"),l=this.getAxis("y");return s[0]=o.coordToData(o.toLocalCoord(t[0]),r),s[1]=l.coordToData(l.toLocalCoord(t[1]),r),s},e.prototype.getOtherAxis=function(t){return this.getAxis(t.dim==="x"?"y":"x")},e.prototype.getArea=function(t){t=t||0;var r=this.getAxis("x").getGlobalExtent(),s=this.getAxis("y").getGlobalExtent(),o=Math.min(r[0],r[1])-t,l=Math.min(s[0],s[1])-t,c=Math.max(r[0],r[1])-o+t,a=Math.max(s[0],s[1])-l+t;return new ds(o,l,c,a)},e}(MOe),EOe=function(n){jn(e,n);function e(t,r,s,o,l){var c=n.call(this,t,r,s)||this;return c.index=0,c.type=o||"value",c.position=l||"bottom",c}return e.prototype.isHorizontal=function(){var t=this.position;return t==="top"||t==="bottom"},e.prototype.getGlobalExtent=function(t){var r=this.getExtent();return r[0]=this.toGlobalCoord(r[0]),r[1]=this.toGlobalCoord(r[1]),t&&r[0]>r[1]&&r.reverse(),r},e.prototype.pointToData=function(t,r){return this.coordToData(this.toLocalCoord(t[this.dim==="x"?0:1]),r)},e.prototype.setCategorySortInfo=function(t){if(this.type!=="category")return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(Ux);function T5(n,e,t){t=t||{};var r=n.coordinateSystem,s=e.axis,o={},l=s.getAxesOnZeroOf()[0],c=s.position,a=l?"onZero":c,d=s.dim,f=r.getRect(),m=[f.x,f.x+f.width,f.y,f.y+f.height],_={left:0,right:1,top:0,bottom:1,onZero:2},x=e.get("offset")||0,A=d==="x"?[m[2]-x,m[3]+x]:[m[0]-x,m[1]+x];if(l){var I=l.toGlobalCoord(l.dataToCoord(0));A[_.onZero]=Math.max(Math.min(I,A[1]),A[0])}o.position=[d==="y"?A[_[a]]:m[0],d==="x"?A[_[a]]:m[3]],o.rotation=Math.PI/2*(d==="x"?0:1);var E={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=E[c],o.labelOffset=l?A[_[c]]-A[_.onZero]:0,e.get(["axisTick","inside"])&&(o.tickDirection=-o.tickDirection),IM(t.labelInside,e.get(["axisLabel","inside"]))&&(o.labelDirection=-o.labelDirection);var C=e.get(["axisLabel","rotate"]);return o.labelRotate=a==="top"?-C:C,o.z2=1,o}function UZ(n){return n.get("coordinateSystem")==="cartesian2d"}function GZ(n){var e={xAxisModel:null,yAxisModel:null};return ot(e,function(t,r){var s=r.replace(/Model$/,""),o=n.getReferringComponents(s,Sl).models[0];e[r]=o}),e}var aN=Math.log;function IOe(n,e,t){var r=Zw.prototype,s=r.getTicks.call(t),o=r.getTicks.call(t,!0),l=s.length-1,c=r.getInterval.call(t),a=lle(n,e),d=a.extent,f=a.fixMin,m=a.fixMax;if(n.type==="log"){var _=aN(n.base);d=[aN(d[0])/_,aN(d[1])/_]}n.setExtent(d[0],d[1]),n.calcNiceExtent({splitNumber:l,fixMin:f,fixMax:m});var x=r.getExtent.call(n);f&&(d[0]=x[0]),m&&(d[1]=x[1]);var A=r.getInterval.call(n),I=d[0],E=d[1];if(f&&m)A=(E-I)/l;else if(f)for(E=d[0]+A*l;E<d[1]&&isFinite(E)&&isFinite(d[1]);)A=J3(A),E=d[0]+A*l;else if(m)for(I=d[1]-A*l;I>d[0]&&isFinite(I)&&isFinite(d[0]);)A=J3(A),I=d[1]-A*l;else{var C=n.getTicks().length-1;C>l&&(A=J3(A));var L=A*l;E=Math.ceil(d[1]/A)*A,I=Ca(E-L),I<0&&d[0]>=0?(I=0,E=Ca(L)):E>0&&d[1]<=0&&(E=0,I=-Ca(L))}var O=(s[0].value-o[0].value)/c,H=(s[l].value-o[l].value)/c;r.setExtent.call(n,I+A*O,E+A*H),r.setInterval.call(n,A),(O||H)&&r.setNiceExtent.call(n,I+A,E-A)}var POe=function(){function n(e,t,r){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=A5,this._initCartesian(e,t,r),this.model=e}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(e,t){var r=this._axesMap;this._updateScale(e,this.model);function s(l){var c,a=lo(l),d=a.length;if(d){for(var f=[],m=d-1;m>=0;m--){var _=+a[m],x=l[_],A=x.model,I=x.scale;x5(I)&&A.get("alignTicks")&&A.get("interval")==null?f.push(x):(TL(I,A),x5(I)&&(c=x))}f.length&&(c||(c=f.pop(),TL(c.scale,c.model)),ot(f,function(E){IOe(E.scale,E.model,c.scale)}))}}s(r.x),s(r.y);var o={};ot(r.x,function(l){VZ(r,"y",l,o)}),ot(r.y,function(l){VZ(r,"x",l,o)}),this.resize(this.model,t)},n.prototype.resize=function(e,t,r){var s=e.getBoxLayoutParams(),o=!r&&e.get("containLabel"),l=I0(s,{width:t.getWidth(),height:t.getHeight()});this._rect=l;var c=this._axesList;a(),o&&(ot(c,function(d){if(!d.model.get(["axisLabel","inside"])){var f=ZBe(d);if(f){var m=d.isHorizontal()?"height":"width",_=d.model.get(["axisLabel","margin"]);l[m]-=f[m]+_,d.position==="top"?l.y+=f.height+_:d.position==="left"&&(l.x+=f.width+_)}}}),a()),ot(this._coordsList,function(d){d.calcAffineTransform()});function a(){ot(c,function(d){var f=d.isHorizontal(),m=f?[0,l.width]:[0,l.height],_=d.inverse?1:0;d.setExtent(m[_],m[1-_]),ROe(d,f?l.x:l.y)})}},n.prototype.getAxis=function(e,t){var r=this._axesMap[e];if(r!=null)return r[t||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(e,t){if(e!=null&&t!=null){var r="x"+e+"y"+t;return this._coordsMap[r]}qr(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var s=0,o=this._coordsList;s<o.length;s++)if(o[s].getAxis("x").index===e||o[s].getAxis("y").index===t)return o[s]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(e,t,r){var s=this._findConvertTarget(t);return s.cartesian?s.cartesian.dataToPoint(r):s.axis?s.axis.toGlobalCoord(s.axis.dataToCoord(r)):null},n.prototype.convertFromPixel=function(e,t,r){var s=this._findConvertTarget(t);return s.cartesian?s.cartesian.pointToData(r):s.axis?s.axis.coordToData(s.axis.toLocalCoord(r)):null},n.prototype._findConvertTarget=function(e){var t=e.seriesModel,r=e.xAxisModel||t&&t.getReferringComponents("xAxis",Sl).models[0],s=e.yAxisModel||t&&t.getReferringComponents("yAxis",Sl).models[0],o=e.gridModel,l=this._coordsList,c,a;if(t)c=t.coordinateSystem,Zi(l,c)<0&&(c=null);else if(r&&s)c=this.getCartesian(r.componentIndex,s.componentIndex);else if(r)a=this.getAxis("x",r.componentIndex);else if(s)a=this.getAxis("y",s.componentIndex);else if(o){var d=o.coordinateSystem;d===this&&(c=this._coordsList[0])}return{cartesian:c,axis:a}},n.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},n.prototype._initCartesian=function(e,t,r){var s=this,o=this,l={left:!1,right:!1,top:!1,bottom:!1},c={x:{},y:{}},a={x:0,y:0};if(t.eachComponent("xAxis",d("x"),this),t.eachComponent("yAxis",d("y"),this),!a.x||!a.y){this._axesMap={},this._axesList=[];return}this._axesMap=c,ot(c.x,function(f,m){ot(c.y,function(_,x){var A="x"+m+"y"+x,I=new COe(A);I.master=s,I.model=e,s._coordsMap[A]=I,s._coordsList.push(I),I.addAxis(f),I.addAxis(_)})});function d(f){return function(m,_){if(lN(m,e)){var x=m.get("position");f==="x"?x!=="top"&&x!=="bottom"&&(x=l.bottom?"top":"bottom"):x!=="left"&&x!=="right"&&(x=l.left?"right":"left"),l[x]=!0;var A=new EOe(f,cle(m),[0,0],m.get("type"),x),I=A.type==="category";A.onBand=I&&m.get("boundaryGap"),A.inverse=m.get("inverse"),m.axis=A,A.model=m,A.grid=o,A.index=_,o._axesList.push(A),c[f][_]=A,a[f]++}}}},n.prototype._updateScale=function(e,t){ot(this._axesList,function(s){if(s.scale.setExtent(1/0,-1/0),s.type==="category"){var o=s.model.get("categorySortInfo");s.scale.setSortInfo(o)}}),e.eachSeries(function(s){if(UZ(s)){var o=GZ(s),l=o.xAxisModel,c=o.yAxisModel;if(!lN(l,t)||!lN(c,t))return;var a=this.getCartesian(l.componentIndex,c.componentIndex),d=s.getData(),f=a.getAxis("x"),m=a.getAxis("y");r(d,f),r(d,m)}},this);function r(s,o){ot(ML(s,o.dim),function(l){o.scale.unionExtentFromData(s,l)})}},n.prototype.getTooltipAxes=function(e){var t=[],r=[];return ot(this.getCartesians(),function(s){var o=e!=null&&e!=="auto"?s.getAxis(e):s.getBaseAxis(),l=s.getOtherAxis(o);Zi(t,o)<0&&t.push(o),Zi(r,l)<0&&r.push(l)}),{baseAxes:t,otherAxes:r}},n.create=function(e,t){var r=[];return e.eachComponent("grid",function(s,o){var l=new n(s,e,t);l.name="grid_"+o,l.resize(s,t,!0),s.coordinateSystem=l,r.push(l)}),e.eachSeries(function(s){if(UZ(s)){var o=GZ(s),l=o.xAxisModel,c=o.yAxisModel,a=l.getCoordSysModel(),d=a.coordinateSystem;s.coordinateSystem=d.getCartesian(l.componentIndex,c.componentIndex)}}),r},n.dimensions=A5,n}();function lN(n,e){return n.getCoordSysModel()===e}function VZ(n,e,t,r){t.getAxesOnZeroOf=function(){return o?[o]:[]};var s=n[e],o,l=t.model,c=l.get(["axisLine","onZero"]),a=l.get(["axisLine","onZeroAxisIndex"]);if(!c)return;if(a!=null)HZ(s[a])&&(o=s[a]);else for(var d in s)if(s.hasOwnProperty(d)&&HZ(s[d])&&!r[f(s[d])]){o=s[d];break}o&&(r[f(o)]=!0);function f(m){return m.dim+"_"+m.index}}function HZ(n){return n&&n.type!=="category"&&n.type!=="time"&&YBe(n)}function ROe(n,e){var t=n.getExtent(),r=t[0]+t[1];n.toGlobalCoord=n.dim==="x"?function(s){return s+e}:function(s){return r-s+e},n.toLocalCoord=n.dim==="x"?function(s){return s-e}:function(s){return r-s+e}}var t0=Math.PI,Fh=function(){function n(e,t){this.group=new _a,this.opt=t,this.axisModel=e,ri(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var r=new _a({x:t.position[0],y:t.position[1],rotation:t.rotation});r.updateTransform(),this._transformGroup=r}return n.prototype.hasBuilder=function(e){return!!jZ[e]},n.prototype.add=function(e){jZ[e](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(e,t,r){var s=xse(t-e),o,l;return cL(s)?(l=r>0?"top":"bottom",o="center"):cL(s-t0)?(l=r>0?"bottom":"top",o="center"):(l="middle",s>0&&s<t0?o=r>0?"right":"left":o=r>0?"left":"right"),{rotation:s,textAlign:o,textVerticalAlign:l}},n.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},n.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},n}(),jZ={axisLine:function(n,e,t,r){var s=e.get(["axisLine","show"]);if(s==="auto"&&n.handleAutoShown&&(s=n.handleAutoShown("axisLine")),!!s){var o=e.axis.getExtent(),l=r.transform,c=[o[0],0],a=[o[1],0],d=c[0]>a[0];l&&(kh(c,c,l),kh(a,a,l));var f=Qn({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),m=new qd({shape:{x1:c[0],y1:c[1],x2:a[0],y2:a[1]},style:f,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});BM(m.shape,m.style.lineWidth),m.anid="line",t.add(m);var _=e.get(["axisLine","symbol"]);if(_!=null){var x=e.get(["axisLine","symbolSize"]);Br(_)&&(_=[_,_]),(Br(x)||Ds(x))&&(x=[x,x]);var A=wae(e.get(["axisLine","symbolOffset"])||0,x),I=x[0],E=x[1];ot([{rotate:n.rotation+Math.PI/2,offset:A[0],r:0},{rotate:n.rotation-Math.PI/2,offset:A[1],r:Math.sqrt((c[0]-a[0])*(c[0]-a[0])+(c[1]-a[1])*(c[1]-a[1]))}],function(C,L){if(_[L]!=="none"&&_[L]!=null){var O=Mw(_[L],-I/2,-E/2,I,E,f.stroke,!0),H=C.r+C.offset,q=d?a:c;O.attr({rotation:C.rotate,x:q[0]+H*Math.cos(n.rotation),y:q[1]-H*Math.sin(n.rotation),silent:!0,z2:11}),t.add(O)}})}}},axisTickLabel:function(n,e,t,r){var s=BOe(t,r,e,n),o=OOe(t,r,e,n);if(DOe(e,o,s),kOe(t,r,e,n.tickDirection),e.get(["axisLabel","hideOverlap"])){var l=Sle(br(o,function(c){return{label:c,priority:c.z2,defaultAttr:{ignore:c.ignore}}}));Mle(l)}},axisName:function(n,e,t,r){var s=IM(n.axisName,e.get("name"));if(s){var o=e.get("nameLocation"),l=n.nameDirection,c=e.getModel("nameTextStyle"),a=e.get("nameGap")||0,d=e.axis.getExtent(),f=d[0]>d[1]?-1:1,m=[o==="start"?d[0]-f*a:o==="end"?d[1]+f*a:(d[0]+d[1])/2,$Z(o)?n.labelOffset+l*a:0],_,x=e.get("nameRotate");x!=null&&(x=x*t0/180);var A;$Z(o)?_=Fh.innerTextLayout(n.rotation,x??n.rotation,l):(_=LOe(n.rotation,o,x||0,d),A=n.axisNameAvailableWidth,A!=null&&(A=Math.abs(A/Math.sin(_.rotation)),!isFinite(A)&&(A=null)));var I=c.getFont(),E=e.get("nameTruncate",!0)||{},C=E.ellipsis,L=IM(n.nameTruncateMaxWidth,E.maxWidth,A),O=new Ra({x:m[0],y:m[1],rotation:_.rotation,silent:Fh.isLabelSilent(e),style:cg(c,{text:s,font:I,overflow:"truncate",width:L,ellipsis:C,fill:c.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:c.get("align")||_.textAlign,verticalAlign:c.get("verticalAlign")||_.textVerticalAlign}),z2:1});if(AB({el:O,componentModel:e,itemName:s}),O.__fullText=s,O.anid="name",e.get("triggerEvent")){var H=Fh.makeAxisEventDataBase(e);H.targetType="axisName",H.name=s,Yi(O).eventData=H}r.add(O),O.updateTransform(),t.add(O),O.decomposeTransform()}}};function LOe(n,e,t,r){var s=xse(t-n),o,l,c=r[0]>r[1],a=e==="start"&&!c||e!=="start"&&c;return cL(s-t0/2)?(l=a?"bottom":"top",o="center"):cL(s-t0*1.5)?(l=a?"top":"bottom",o="center"):(l="middle",s<t0*1.5&&s>t0/2?o=a?"left":"right":o=a?"right":"left"),{rotation:s,textAlign:o,textVerticalAlign:l}}function DOe(n,e,t){if(!ule(n.axis)){var r=n.get(["axisLabel","showMinLabel"]),s=n.get(["axisLabel","showMaxLabel"]);e=e||[],t=t||[];var o=e[0],l=e[1],c=e[e.length-1],a=e[e.length-2],d=t[0],f=t[1],m=t[t.length-1],_=t[t.length-2];r===!1?(mh(o),mh(d)):WZ(o,l)&&(r?(mh(l),mh(f)):(mh(o),mh(d))),s===!1?(mh(c),mh(m)):WZ(a,c)&&(s?(mh(a),mh(_)):(mh(c),mh(m)))}}function mh(n){n&&(n.ignore=!0)}function WZ(n,e){var t=n&&n.getBoundingRect().clone(),r=e&&e.getBoundingRect().clone();if(!(!t||!r)){var s=gG([]);return lB(s,s,-n.rotation),t.applyTransform(Jb([],s,n.getLocalTransform())),r.applyTransform(Jb([],s,e.getLocalTransform())),t.intersect(r)}}function $Z(n){return n==="middle"||n==="center"}function Vle(n,e,t,r,s){for(var o=[],l=[],c=[],a=0;a<n.length;a++){var d=n[a].coord;l[0]=d,l[1]=0,c[0]=d,c[1]=t,e&&(kh(l,l,e),kh(c,c,e));var f=new qd({shape:{x1:l[0],y1:l[1],x2:c[0],y2:c[1]},style:r,z2:2,autoBatch:!0,silent:!0});BM(f.shape,f.style.lineWidth),f.anid=s+"_"+n[a].tickValue,o.push(f)}return o}function BOe(n,e,t,r){var s=t.axis,o=t.getModel("axisTick"),l=o.get("show");if(l==="auto"&&r.handleAutoShown&&(l=r.handleAutoShown("axisTick")),!(!l||s.scale.isBlank())){for(var c=o.getModel("lineStyle"),a=r.tickDirection*o.get("length"),d=s.getTicksCoords(),f=Vle(d,e.transform,a,ri(c.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}),"ticks"),m=0;m<f.length;m++)n.add(f[m]);return f}}function kOe(n,e,t,r){var s=t.axis,o=t.getModel("minorTick");if(!(!o.get("show")||s.scale.isBlank())){var l=s.getMinorTicksCoords();if(l.length)for(var c=o.getModel("lineStyle"),a=r*o.get("length"),d=ri(c.getLineStyle(),ri(t.getModel("axisTick").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})),f=0;f<l.length;f++)for(var m=Vle(l[f],e.transform,a,d,"minorticks_"+f),_=0;_<m.length;_++)n.add(m[_])}}function OOe(n,e,t,r){var s=t.axis,o=IM(r.axisLabelShow,t.get(["axisLabel","show"]));if(!(!o||s.scale.isBlank())){var l=t.getModel("axisLabel"),c=l.get("margin"),a=s.getViewLabels(),d=(IM(r.labelRotate,l.get("rotate"))||0)*t0/180,f=Fh.innerTextLayout(r.rotation,d,r.labelDirection),m=t.getCategories&&t.getCategories(!0),_=[],x=Fh.isLabelSilent(t),A=t.get("triggerEvent");return ot(a,function(I,E){var C=s.scale.type==="ordinal"?s.scale.getRawOrdinalNumber(I.tickValue):I.tickValue,L=I.formattedLabel,O=I.rawLabel,H=l;if(m&&m[C]){var q=m[C];qr(q)&&q.textStyle&&(H=new Do(q.textStyle,l,t.ecModel))}var Z=H.getTextColor()||t.get(["axisLine","lineStyle","color"]),J=s.dataToCoord(C),re=H.getShallow("align",!0)||f.textAlign,se=Li(H.getShallow("alignMinLabel",!0),re),ae=Li(H.getShallow("alignMaxLabel",!0),re),he=H.getShallow("verticalAlign",!0)||H.getShallow("baseline",!0)||f.textVerticalAlign,Ae=Li(H.getShallow("verticalAlignMinLabel",!0),he),Ee=Li(H.getShallow("verticalAlignMaxLabel",!0),he),Pe=new Ra({x:J,y:r.labelOffset+r.labelDirection*c,rotation:f.rotation,silent:x,z2:10+(I.level||0),style:cg(H,{text:L,align:E===0?se:E===a.length-1?ae:re,verticalAlign:E===0?Ae:E===a.length-1?Ee:he,fill:hi(Z)?Z(s.type==="category"?O:s.type==="value"?C+"":C,E):Z})});if(Pe.anid="label_"+C,A){var ze=Fh.makeAxisEventDataBase(t);ze.targetType="axisLabel",ze.value=O,ze.tickIndex=E,s.type==="category"&&(ze.dataIndex=C),Yi(Pe).eventData=ze}e.add(Pe),Pe.updateTransform(),_.push(Pe),n.add(Pe),Pe.decomposeTransform()}),_}}function FOe(n,e){var t={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return NOe(t,n,e),t.seriesInvolved&&UOe(t,n),t}function NOe(n,e,t){var r=e.getComponent("tooltip"),s=e.getComponent("axisPointer"),o=s.get("link",!0)||[],l=[];ot(t.getCoordinateSystems(),function(c){if(!c.axisPointerEnabled)return;var a=HM(c.model),d=n.coordSysAxesInfo[a]={};n.coordSysMap[a]=c;var f=c.model,m=f.getModel("tooltip",r);if(ot(c.getAxes(),xs(I,!1,null)),c.getTooltipAxes&&r&&m.get("show")){var _=m.get("trigger")==="axis",x=m.get(["axisPointer","type"])==="cross",A=c.getTooltipAxes(m.get(["axisPointer","axis"]));(_||x)&&ot(A.baseAxes,xs(I,x?"cross":!0,_)),x&&ot(A.otherAxes,xs(I,"cross",!1))}function I(E,C,L){var O=L.model.getModel("axisPointer",s),H=O.get("show");if(!(!H||H==="auto"&&!E&&!M5(O))){C==null&&(C=O.get("triggerTooltip")),O=E?zOe(L,m,s,e,E,C):O;var q=O.get("snap"),Z=O.get("triggerEmphasis"),J=HM(L.model),re=C||q||L.type==="category",se=n.axesInfo[J]={key:J,axis:L,coordSys:c,axisPointerModel:O,triggerTooltip:C,triggerEmphasis:Z,involveSeries:re,snap:q,useHandle:M5(O),seriesModels:[],linkGroup:null};d[J]=se,n.seriesInvolved=n.seriesInvolved||re;var ae=GOe(o,L);if(ae!=null){var he=l[ae]||(l[ae]={axesInfo:{}});he.axesInfo[J]=se,he.mapper=o[ae].mapper,se.linkGroup=he}}}})}function zOe(n,e,t,r,s,o){var l=e.getModel("axisPointer"),c=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],a={};ot(c,function(_){a[_]=wi(l.get(_))}),a.snap=n.type!=="category"&&!!o,l.get("type")==="cross"&&(a.type="line");var d=a.label||(a.label={});if(d.show==null&&(d.show=!1),s==="cross"){var f=l.get(["label","show"]);if(d.show=f??!0,!o){var m=a.lineStyle=l.get("crossStyle");m&&ri(d,m.textStyle)}}return n.model.getModel("axisPointer",new Do(a,t,r))}function UOe(n,e){e.eachSeries(function(t){var r=t.coordinateSystem,s=t.get(["tooltip","trigger"],!0),o=t.get(["tooltip","show"],!0);!r||s==="none"||s===!1||s==="item"||o===!1||t.get(["axisPointer","show"],!0)===!1||ot(n.coordSysAxesInfo[HM(r.model)],function(l){var c=l.axis;r.getAxis(c.dim)===c&&(l.seriesModels.push(t),l.seriesDataCount==null&&(l.seriesDataCount=0),l.seriesDataCount+=t.getData().count())})})}function GOe(n,e){for(var t=e.model,r=e.dim,s=0;s<n.length;s++){var o=n[s]||{};if(cN(o[r+"AxisId"],t.id)||cN(o[r+"AxisIndex"],t.componentIndex)||cN(o[r+"AxisName"],t.name))return s}}function cN(n,e){return n==="all"||fr(n)&&Zi(n,e)>=0||n===e}function VOe(n){var e=d8(n);if(e){var t=e.axisPointerModel,r=e.axis.scale,s=t.option,o=t.get("status"),l=t.get("value");l!=null&&(l=r.parse(l));var c=M5(t);o==null&&(s.status=c?"show":"hide");var a=r.getExtent().slice();a[0]>a[1]&&a.reverse(),(l==null||l>a[1])&&(l=a[1]),l<a[0]&&(l=a[0]),s.value=l,c&&(s.status=e.axis.scale.isBlank()?"hide":"show")}}function d8(n){var e=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[HM(n)]}function HOe(n){var e=d8(n);return e&&e.axisPointerModel}function M5(n){return!!n.get(["handle","show"])}function HM(n){return n.type+"||"+n.id}var XZ={},NC=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,s,o){this.axisPointerClass&&VOe(t),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,s,!0)},e.prototype.updateAxisPointer=function(t,r,s,o){this._doUpdateAxisPointerClass(t,s,!1)},e.prototype.remove=function(t,r){var s=this._axisPointer;s&&s.remove(r)},e.prototype.dispose=function(t,r){this._disposeAxisPointer(r),n.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(t,r,s){var o=e.getAxisPointerClass(this.axisPointerClass);if(o){var l=HOe(t);l?(this._axisPointer||(this._axisPointer=new o)).render(t,l,r,s):this._disposeAxisPointer(r)}},e.prototype._disposeAxisPointer=function(t){this._axisPointer&&this._axisPointer.dispose(t),this._axisPointer=null},e.registerAxisPointerClass=function(t,r){XZ[t]=r},e.getAxisPointerClass=function(t){return t&&XZ[t]},e.type="axis",e}(kc),C5=Zs();function jOe(n,e,t,r){var s=t.axis;if(!s.scale.isBlank()){var o=t.getModel("splitArea"),l=o.getModel("areaStyle"),c=l.get("color"),a=r.coordinateSystem.getRect(),d=s.getTicksCoords({tickModel:o,clamp:!0});if(d.length){var f=c.length,m=C5(n).splitAreaColors,_=oi(),x=0;if(m)for(var A=0;A<d.length;A++){var I=m.get(d[A].tickValue);if(I!=null){x=(I+(f-1)*A)%f;break}}var E=s.toGlobalCoord(d[0].coord),C=l.getAreaStyle();c=fr(c)?c:[c];for(var A=1;A<d.length;A++){var L=s.toGlobalCoord(d[A].coord),O=void 0,H=void 0,q=void 0,Z=void 0;s.isHorizontal()?(O=E,H=a.y,q=L-O,Z=a.height,E=O+q):(O=a.x,H=E,q=a.width,Z=L-H,E=H+Z);var J=d[A-1].tickValue;J!=null&&_.set(J,x),e.add(new $o({anid:J!=null?"area_"+J:null,shape:{x:O,y:H,width:q,height:Z},style:ri({fill:c[x]},C),autoBatch:!0,silent:!0})),x=(x+1)%f}C5(n).splitAreaColors=_}}}function WOe(n){C5(n).splitAreaColors=null}var $Oe=["axisLine","axisTickLabel","axisName"],XOe=["splitArea","splitLine","minorSplitLine"],Hle=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="CartesianAxisPointer",t}return e.prototype.render=function(t,r,s,o){this.group.removeAll();var l=this._axisGroup;if(this._axisGroup=new _a,this.group.add(this._axisGroup),!!t.get("show")){var c=t.getCoordSysModel(),a=T5(c,t),d=new Fh(t,Qn({handleAutoShown:function(m){for(var _=c.coordinateSystem.getCartesians(),x=0;x<_.length;x++)if(x5(_[x].getOtherAxis(t.axis).scale))return!0;return!1}},a));ot($Oe,d.add,d),this._axisGroup.add(d.getGroup()),ot(XOe,function(m){t.get([m,"show"])&&qOe[m](this,this._axisGroup,t,c)},this);var f=o&&o.type==="changeAxisOrder"&&o.isInitSort;f||DG(l,this._axisGroup,t),n.prototype.render.call(this,t,r,s,o)}},e.prototype.remove=function(){WOe(this)},e.type="cartesianAxis",e}(NC),qOe={splitLine:function(n,e,t,r){var s=t.axis;if(!s.scale.isBlank()){var o=t.getModel("splitLine"),l=o.getModel("lineStyle"),c=l.get("color");c=fr(c)?c:[c];for(var a=r.coordinateSystem.getRect(),d=s.isHorizontal(),f=0,m=s.getTicksCoords({tickModel:o}),_=[],x=[],A=l.getLineStyle(),I=0;I<m.length;I++){var E=s.toGlobalCoord(m[I].coord);d?(_[0]=E,_[1]=a.y,x[0]=E,x[1]=a.y+a.height):(_[0]=a.x,_[1]=E,x[0]=a.x+a.width,x[1]=E);var C=f++%c.length,L=m[I].tickValue,O=new qd({anid:L!=null?"line_"+m[I].tickValue:null,autoBatch:!0,shape:{x1:_[0],y1:_[1],x2:x[0],y2:x[1]},style:ri({stroke:c[C]},A),silent:!0});BM(O.shape,A.lineWidth),e.add(O)}}},minorSplitLine:function(n,e,t,r){var s=t.axis,o=t.getModel("minorSplitLine"),l=o.getModel("lineStyle"),c=r.coordinateSystem.getRect(),a=s.isHorizontal(),d=s.getMinorTicksCoords();if(d.length)for(var f=[],m=[],_=l.getLineStyle(),x=0;x<d.length;x++)for(var A=0;A<d[x].length;A++){var I=s.toGlobalCoord(d[x][A].coord);a?(f[0]=I,f[1]=c.y,m[0]=I,m[1]=c.y+c.height):(f[0]=c.x,f[1]=I,m[0]=c.x+c.width,m[1]=I);var E=new qd({anid:"minor_line_"+d[x][A].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:m[0],y2:m[1]},style:_,silent:!0});BM(E.shape,_.lineWidth),e.add(E)}},splitArea:function(n,e,t,r){jOe(n,e,t,r)}},jle=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="xAxis",e}(Hle),YOe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=jle.type,t}return e.type="yAxis",e}(Hle),ZOe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="grid",t}return e.prototype.render=function(t,r){this.group.removeAll(),t.get("show")&&this.group.add(new $o({shape:t.coordinateSystem.getRect(),style:ri({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(kc),qZ={offset:0};function KOe(n){n.registerComponentView(ZOe),n.registerComponentModel(xOe),n.registerCoordinateSystem("cartesian2d",POe),IL(n,"x",S5,qZ),IL(n,"y",S5,qZ),n.registerComponentView(jle),n.registerComponentView(YOe),n.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}var YZ="\0_ec_interaction_mutex";function JOe(n,e,t){var r=Wle(n);r[e]=t}function QOe(n,e,t){var r=Wle(n),s=r[e];s===t&&(r[e]=null)}function Wle(n){return n[YZ]||(n[YZ]={})}Ep({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Lc);var eFe={axisPointer:1,tooltip:1,brush:1};function tFe(n,e,t){var r=e.getComponentByElement(n.topTarget),s=r&&r.coordinateSystem;return r&&r!==t&&!eFe.hasOwnProperty(r.mainType)&&s&&s.model!==t}function $le(n,e,t,r,s,o){n=n||0;var l=t[1]-t[0];if(s!=null&&(s=nb(s,[0,l])),o!=null&&(o=Math.max(o,s??0)),r==="all"){var c=Math.abs(e[1]-e[0]);c=nb(c,[0,l]),s=o=nb(c,[s,o]),r=0}e[0]=nb(e[0],t),e[1]=nb(e[1],t);var a=uN(e,r);e[r]+=n;var d=s||0,f=t.slice();a.sign<0?f[0]+=d:f[1]-=d,e[r]=nb(e[r],f);var m;return m=uN(e,r),s!=null&&(m.sign!==a.sign||m.span<s)&&(e[1-r]=e[r]+a.sign*s),m=uN(e,r),o!=null&&m.span>o&&(e[1-r]=e[r]+m.sign*o),e}function uN(n,e){var t=n[e]-n[1-e];return{span:Math.abs(t),sign:t>0?-1:t<0?1:e?-1:1}}function nb(n,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,n))}var Sx=!0,jM=Math.min,Cw=Math.max,nFe=Math.pow,rFe=1e4,iFe=6,sFe=6,ZZ="globalPan",oFe={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},aFe={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},KZ={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},lFe=0,cFe=function(n){jn(e,n);function e(t){var r=n.call(this)||this;return r._track=[],r._covers=[],r._handlers={},r._zr=t,r.group=new _a,r._uid="brushController_"+lFe++,ot(gFe,function(s,o){this._handlers[o]=Vs(s,this)},r),r}return e.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},e.prototype._doEnableBrush=function(t){var r=this._zr;this._enableGlobalPan||JOe(r,ZZ,this._uid),ot(this._handlers,function(s,o){r.on(o,s)}),this._brushType=t.brushType,this._brushOption=Fi(wi(KZ),t,!0)},e.prototype._doDisableBrush=function(){var t=this._zr;QOe(t,ZZ,this._uid),ot(this._handlers,function(r,s){t.off(s,r)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(t){if(t&&t.length){var r=this._panels={};ot(t,function(s){r[s.panelId]=wi(s)})}else this._panels=null;return this},e.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var r=this.group;return this._zr.add(r),r.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=r.getLocalTransform(),this},e.prototype.updateCovers=function(t){t=br(t,function(_){return Fi(wi(KZ),_,!0)});var r="\0-brush-index-",s=this._covers,o=this._covers=[],l=this,c=this._creatingCover;return new GM(s,t,d,a).add(f).update(f).remove(m).execute(),this;function a(_,x){return(_.id!=null?_.id:r+x)+"-"+_.brushType}function d(_,x){return a(_.__brushOption,x)}function f(_,x){var A=t[_];if(x!=null&&s[x]===c)o[_]=s[x];else{var I=o[_]=x!=null?(s[x].__brushOption=A,s[x]):qle(l,Xle(l,A));f8(l,I)}}function m(_){s[_]!==c&&l.group.remove(s[_])}},e.prototype.unmount=function(){return this.enableBrush(!1),E5(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(ff);function Xle(n,e){var t=UB[e.brushType].createCover(n,e);return t.__brushOption=e,Zle(t,e),n.group.add(t),t}function qle(n,e){var t=p8(e);return t.endCreating&&(t.endCreating(n,e),Zle(e,e.__brushOption)),e}function Yle(n,e){var t=e.__brushOption;p8(e).updateCoverShape(n,e,t.range,t)}function Zle(n,e){var t=e.z;t==null&&(t=rFe),n.traverse(function(r){r.z=t,r.z2=t})}function f8(n,e){p8(e).updateCommon(n,e),Yle(n,e)}function p8(n){return UB[n.__brushOption.brushType]}function m8(n,e,t){var r=n._panels;if(!r)return Sx;var s,o=n._transform;return ot(r,function(l){l.isTargetByCursor(e,t,o)&&(s=l)}),s}function Kle(n,e){var t=n._panels;if(!t)return Sx;var r=e.__brushOption.panelId;return r!=null?t[r]:Sx}function E5(n){var e=n._covers,t=e.length;return ot(e,function(r){n.group.remove(r)},n),e.length=0,!!t}function Ax(n,e){var t=br(n._covers,function(r){var s=r.__brushOption,o=wi(s.range);return{brushType:s.brushType,panelId:s.panelId,range:o}});n.trigger("brush",{areas:t,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function uFe(n){var e=n._track;if(!e.length)return!1;var t=e[e.length-1],r=e[0],s=t[0]-r[0],o=t[1]-r[1],l=nFe(s*s+o*o,.5);return l>iFe}function Jle(n){var e=n.length-1;return e<0&&(e=0),[n[0],n[e]]}function Qle(n,e,t,r){var s=new _a;return s.add(new $o({name:"main",style:g8(t),silent:!0,draggable:!0,cursor:"move",drift:xs(JZ,n,e,s,["n","s","w","e"]),ondragend:xs(Ax,e,{isEnd:!0})})),ot(r,function(o){s.add(new $o({name:o.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:xs(JZ,n,e,s,o),ondragend:xs(Ax,e,{isEnd:!0})}))}),s}function ece(n,e,t,r){var s=r.brushStyle.lineWidth||0,o=Cw(s,sFe),l=t[0][0],c=t[1][0],a=l-s/2,d=c-s/2,f=t[0][1],m=t[1][1],_=f-o+s/2,x=m-o+s/2,A=f-l,I=m-c,E=A+s,C=I+s;Tm(n,e,"main",l,c,A,I),r.transformable&&(Tm(n,e,"w",a,d,o,C),Tm(n,e,"e",_,d,o,C),Tm(n,e,"n",a,d,E,o),Tm(n,e,"s",a,x,E,o),Tm(n,e,"nw",a,d,o,o),Tm(n,e,"ne",_,d,o,o),Tm(n,e,"sw",a,x,o,o),Tm(n,e,"se",_,x,o,o))}function I5(n,e){var t=e.__brushOption,r=t.transformable,s=e.childAt(0);s.useStyle(g8(t)),s.attr({silent:!r,cursor:r?"move":"default"}),ot([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(o){var l=e.childOfName(o.join("")),c=o.length===1?P5(n,o[0]):dFe(n,o);l&&l.attr({silent:!r,invisible:!r,cursor:r?aFe[c]+"-resize":null})})}function Tm(n,e,t,r,s,o,l){var c=e.childOfName(t);c&&c.setShape(pFe(v8(n,e,[[r,s],[r+o,s+l]])))}function g8(n){return ri({strokeNoScale:!0},n.brushStyle)}function tce(n,e,t,r){var s=[jM(n,t),jM(e,r)],o=[Cw(n,t),Cw(e,r)];return[[s[0],o[0]],[s[1],o[1]]]}function hFe(n){return LG(n.group)}function P5(n,e){var t={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},s=voe(t[e],hFe(n));return r[s]}function dFe(n,e){var t=[P5(n,e[0]),P5(n,e[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function JZ(n,e,t,r,s,o){var l=t.__brushOption,c=n.toRectRange(l.range),a=nce(e,s,o);ot(r,function(d){var f=oFe[d];c[f[0]][f[1]]+=a[f[0]]}),l.range=n.fromRectRange(tce(c[0][0],c[1][0],c[0][1],c[1][1])),f8(e,t),Ax(e,{isEnd:!1})}function fFe(n,e,t,r){var s=e.__brushOption.range,o=nce(n,t,r);ot(s,function(l){l[0]+=o[0],l[1]+=o[1]}),f8(n,e),Ax(n,{isEnd:!1})}function nce(n,e,t){var r=n.group,s=r.transformCoordToLocal(e,t),o=r.transformCoordToLocal(0,0);return[s[0]-o[0],s[1]-o[1]]}function v8(n,e,t){var r=Kle(n,e);return r&&r!==Sx?r.clipPath(t,n._transform):wi(t)}function pFe(n){var e=jM(n[0][0],n[1][0]),t=jM(n[0][1],n[1][1]),r=Cw(n[0][0],n[1][0]),s=Cw(n[0][1],n[1][1]);return{x:e,y:t,width:r-e,height:s-t}}function mFe(n,e,t){if(!(!n._brushType||vFe(n,e.offsetX,e.offsetY))){var r=n._zr,s=n._covers,o=m8(n,e,t);if(!n._dragging)for(var l=0;l<s.length;l++){var c=s[l].__brushOption;if(o&&(o===Sx||c.panelId===o.panelId)&&UB[c.brushType].contain(s[l],t[0],t[1]))return}o&&r.setCursorStyle("crosshair")}}function R5(n){var e=n.event;e.preventDefault&&e.preventDefault()}function L5(n,e,t){return n.childOfName("main").contain(e,t)}function rce(n,e,t,r){var s=n._creatingCover,o=n._creatingPanel,l=n._brushOption,c;if(n._track.push(t.slice()),uFe(n)||s){if(o&&!s){l.brushMode==="single"&&E5(n);var a=wi(l);a.brushType=QZ(a.brushType,o),a.panelId=o===Sx?null:o.panelId,s=n._creatingCover=Xle(n,a),n._covers.push(s)}if(s){var d=UB[QZ(n._brushType,o)],f=s.__brushOption;f.range=d.getCreatingRange(v8(n,s,n._track)),r&&(qle(n,s),d.updateCommon(n,s)),Yle(n,s),c={isEnd:r}}}else r&&l.brushMode==="single"&&l.removeOnClick&&m8(n,e,t)&&E5(n)&&(c={isEnd:r,removeOnClick:!0});return c}function QZ(n,e){return n==="auto"?e.defaultBrushType:n}var gFe={mousedown:function(n){if(this._dragging)eK(this,n);else if(!n.target||!n.target.draggable){R5(n);var e=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var t=this._creatingPanel=m8(this,n,e);t&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(n){var e=n.offsetX,t=n.offsetY,r=this.group.transformCoordToLocal(e,t);if(mFe(this,n,r),this._dragging){R5(n);var s=rce(this,n,r,!1);s&&Ax(this,s)}},mouseup:function(n){eK(this,n)}};function eK(n,e){if(n._dragging){R5(e);var t=e.offsetX,r=e.offsetY,s=n.group.transformCoordToLocal(t,r),o=rce(n,e,s,!0);n._dragging=!1,n._track=[],n._creatingCover=null,o&&Ax(n,o)}}function vFe(n,e,t){var r=n._zr;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var UB={lineX:tK(0),lineY:tK(1),rect:{createCover:function(n,e){function t(r){return r}return Qle({toRectRange:t,fromRectRange:t},n,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var e=Jle(n);return tce(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(n,e,t,r){ece(n,e,t,r)},updateCommon:I5,contain:L5},polygon:{createCover:function(n,e){var t=new _a;return t.add(new Xw({name:"main",style:g8(e),silent:!0})),t},getCreatingRange:function(n){return n},endCreating:function(n,e){e.remove(e.childAt(0)),e.add(new yB({name:"main",draggable:!0,drift:xs(fFe,n,e),ondragend:xs(Ax,n,{isEnd:!0})}))},updateCoverShape:function(n,e,t,r){e.childAt(0).setShape({points:v8(n,e,t)})},updateCommon:I5,contain:L5}};function tK(n){return{createCover:function(e,t){return Qle({toRectRange:function(r){var s=[r,[0,100]];return n&&s.reverse(),s},fromRectRange:function(r){return r[n]}},e,t,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(e){var t=Jle(e),r=jM(t[0][n],t[1][n]),s=Cw(t[0][n],t[1][n]);return[r,s]},updateCoverShape:function(e,t,r,s){var o,l=Kle(e,t);if(l!==Sx&&l.getLinearBrushOtherExtent)o=l.getLinearBrushOtherExtent(n);else{var c=e._zr;o=[0,[c.getWidth(),c.getHeight()][1-n]]}var a=[r,o];n&&a.reverse(),ece(e,t,a,s)},updateCommon:I5,contain:L5}}function _Fe(n){return n=_8(n),function(e){return _oe(e,n)}}function yFe(n,e){return n=_8(n),function(t){var r=e??t,s=r?n.width:n.height,o=r?n.x:n.y;return[o,o+(s||0)]}}function xFe(n,e,t){var r=_8(n);return function(s,o){return r.contain(o[0],o[1])&&!tFe(s,e,t)}}function _8(n){return ds.create(n)}var Ey=Zs(),nK=wi,hN=Vs,ice=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(e,t,r,s){var o=t.get("value"),l=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=r,!(!s&&this._lastValue===o&&this._lastStatus===l)){this._lastValue=o,this._lastStatus=l;var c=this._group,a=this._handle;if(!l||l==="hide"){c&&c.hide(),a&&a.hide();return}c&&c.show(),a&&a.show();var d={};this.makeElOption(d,o,e,t,r);var f=d.graphicKey;f!==this._lastGraphicKey&&this.clear(r),this._lastGraphicKey=f;var m=this._moveAnimation=this.determineAnimation(e,t);if(!c)c=this._group=new _a,this.createPointerEl(c,d,e,t),this.createLabelEl(c,d,e,t),r.getZr().add(c);else{var _=xs(rK,t,m);this.updatePointerEl(c,d,_),this.updateLabelEl(c,d,_,t)}sK(c,t,!0),this._renderHandle(o)}},n.prototype.remove=function(e){this.clear(e)},n.prototype.dispose=function(e){this.clear(e)},n.prototype.determineAnimation=function(e,t){var r=t.get("animation"),s=e.axis,o=s.type==="category",l=t.get("snap");if(!l&&!o)return!1;if(r==="auto"||r==null){var c=this.animationThreshold;if(o&&s.getBandWidth()>c)return!0;if(l){var a=d8(e).seriesDataCount,d=s.getExtent();return Math.abs(d[0]-d[1])/a>c}return!1}return r===!0},n.prototype.makeElOption=function(e,t,r,s,o){},n.prototype.createPointerEl=function(e,t,r,s){var o=t.pointer;if(o){var l=Ey(e).pointerEl=new BG[o.type](nK(t.pointer));e.add(l)}},n.prototype.createLabelEl=function(e,t,r,s){if(t.label){var o=Ey(e).labelEl=new Ra(nK(t.label));e.add(o),iK(o,s)}},n.prototype.updatePointerEl=function(e,t,r){var s=Ey(e).pointerEl;s&&t.pointer&&(s.setStyle(t.pointer.style),r(s,{shape:t.pointer.shape}))},n.prototype.updateLabelEl=function(e,t,r,s){var o=Ey(e).labelEl;o&&(o.setStyle(t.label.style),r(o,{x:t.label.x,y:t.label.y}),iK(o,s))},n.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var t=this._axisPointerModel,r=this._api.getZr(),s=this._handle,o=t.getModel("handle"),l=t.get("status");if(!o.get("show")||!l||l==="hide"){s&&r.remove(s),this._handle=null;return}var c;this._handle||(c=!0,s=this._handle=SB(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(d){Qie(d.event)},onmousedown:hN(this._onHandleDragMove,this,0,0),drift:hN(this._onHandleDragMove,this),ondragend:hN(this._onHandleDragEnd,this)}),r.add(s)),sK(s,t,!1),s.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var a=o.get("size");fr(a)||(a=[a,a]),s.scaleX=a[0]/2,s.scaleY=a[1]/2,pae(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,c)}},n.prototype._moveHandleToValue=function(e,t){rK(this._axisPointerModel,!t&&this._moveAnimation,this._handle,dN(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(e,t){var r=this._handle;if(r){this._dragging=!0;var s=this.updateHandleTransform(dN(r),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=s,r.stopAnimation(),r.attr(dN(s)),Ey(r).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var t=this._payloadInfo,r=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:r.axis.dim,axisIndex:r.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),r=this._group,s=this._handle;t&&r&&(this._lastGraphicKey=null,r&&t.remove(r),s&&t.remove(s),this._group=null,this._handle=null,this._payloadInfo=null),u5(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}},n}();function rK(n,e,t,r){sce(Ey(t).lastProp,r)||(Ey(t).lastProp=r,e?cl(t,r,n):(t.stopAnimation(),t.attr(r)))}function sce(n,e){if(qr(n)&&qr(e)){var t=!0;return ot(e,function(r,s){t=t&&sce(n[s],r)}),!!t}else return n===e}function iK(n,e){n[e.get(["label","show"])?"show":"hide"]()}function dN(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function sK(n,e,t){var r=e.get("z"),s=e.get("zlevel");n&&n.traverse(function(o){o.type!=="group"&&(r!=null&&(o.z=r),s!=null&&(o.zlevel=s),o.silent=t)})}function oce(n){var e=n.get("type"),t=n.getModel(e+"Style"),r;return e==="line"?(r=t.getLineStyle(),r.fill=null):e==="shadow"&&(r=t.getAreaStyle(),r.stroke=null),r}function ace(n,e,t,r,s){var o=t.get("value"),l=lce(o,e.axis,e.ecModel,t.get("seriesDataIndices"),{precision:t.get(["label","precision"]),formatter:t.get(["label","formatter"])}),c=t.getModel("label"),a=LB(c.get("padding")||0),d=c.getFont(),f=LC(l,d),m=s.position,_=f.width+a[1]+a[3],x=f.height+a[0]+a[2],A=s.align;A==="right"&&(m[0]-=_),A==="center"&&(m[0]-=_/2);var I=s.verticalAlign;I==="bottom"&&(m[1]-=x),I==="middle"&&(m[1]-=x/2),bFe(m,_,x,r);var E=c.get("backgroundColor");(!E||E==="auto")&&(E=e.get(["axisLine","lineStyle","color"])),n.label={x:m[0],y:m[1],style:cg(c,{text:l,font:d,fill:c.getTextColor(),padding:a,backgroundColor:E}),z2:10}}function bFe(n,e,t,r){var s=r.getWidth(),o=r.getHeight();n[0]=Math.min(n[0]+e,s)-e,n[1]=Math.min(n[1]+t,o)-t,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function lce(n,e,t,r,s){n=e.scale.parse(n);var o=e.scale.getLabel({value:n},{precision:s.precision}),l=s.formatter;if(l){var c={value:o8(e,{value:n}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};ot(r,function(a){var d=t.getSeriesByIndex(a.seriesIndex),f=a.dataIndexInside,m=d&&d.getDataParams(f);m&&c.seriesData.push(m)}),Br(l)?o=l.replace("{value}",o):hi(l)&&(o=l(c))}return o}function cce(n,e,t){var r=Qy();return lB(r,r,t.rotation),tL(r,r,t.position),wB([n.dataToCoord(e),(t.labelOffset||0)+(t.labelDirection||1)*(t.labelMargin||0)],r)}function wFe(n,e,t,r,s,o){var l=Fh.innerTextLayout(t.rotation,0,t.labelDirection);t.labelMargin=s.get(["label","margin"]),ace(e,r,s,o,{position:cce(r.axis,n,t),align:l.textAlign,verticalAlign:l.textVerticalAlign})}function uce(n,e,t){return t=t||0,{x1:n[t],y1:n[1-t],x2:e[t],y2:e[1-t]}}function SFe(n,e,t){return t=t||0,{x:n[t],y:n[1-t],width:e[t],height:e[1-t]}}function oK(n,e,t,r,s,o){return{cx:n,cy:e,r0:t,r,startAngle:s,endAngle:o,clockwise:!0}}var AFe=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,s,o,l){var c=s.axis,a=c.grid,d=o.get("type"),f=aK(a,c).getOtherAxis(c).getGlobalExtent(),m=c.toGlobalCoord(c.dataToCoord(r,!0));if(d&&d!=="none"){var _=oce(o),x=TFe[d](c,m,f);x.style=_,t.graphicKey=x.type,t.pointer=x}var A=T5(a.model,s);wFe(r,t,A,s,o,l)},e.prototype.getHandleTransform=function(t,r,s){var o=T5(r.axis.grid.model,r,{labelInside:!1});o.labelMargin=s.get(["handle","margin"]);var l=cce(r.axis,t,o);return{x:l[0],y:l[1],rotation:o.rotation+(o.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,r,s,o){var l=s.axis,c=l.grid,a=l.getGlobalExtent(!0),d=aK(c,l).getOtherAxis(l).getGlobalExtent(),f=l.dim==="x"?0:1,m=[t.x,t.y];m[f]+=r[f],m[f]=Math.min(a[1],m[f]),m[f]=Math.max(a[0],m[f]);var _=(d[1]+d[0])/2,x=[_,_];x[f]=m[f];var A=[{verticalAlign:"middle"},{align:"center"}];return{x:m[0],y:m[1],rotation:t.rotation,cursorPoint:x,tooltipOption:A[f]}},e}(ice);function aK(n,e){var t={};return t[e.dim+"AxisIndex"]=e.index,n.getCartesian(t)}var TFe={line:function(n,e,t){var r=uce([e,t[0]],[e,t[1]],lK(n));return{type:"Line",subPixelOptimize:!0,shape:r}},shadow:function(n,e,t){var r=Math.max(1,n.getBandWidth()),s=t[1]-t[0];return{type:"Rect",shape:SFe([e-r/2,t[0]],[r,s],lK(n))}}};function lK(n){return n.dim==="x"?0:1}var MFe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}(cs),Hm=Zs(),CFe=ot;function hce(n,e,t){if(!yi.node){var r=e.getZr();Hm(r).records||(Hm(r).records={}),EFe(r,e);var s=Hm(r).records[n]||(Hm(r).records[n]={});s.handler=t}}function EFe(n,e){if(Hm(n).initialized)return;Hm(n).initialized=!0,t("click",xs(cK,"click")),t("mousemove",xs(cK,"mousemove")),t("globalout",PFe);function t(r,s){n.on(r,function(o){var l=RFe(e);CFe(Hm(n).records,function(c){c&&s(c,o,l.dispatchAction)}),IFe(l.pendings,e)})}}function IFe(n,e){var t=n.showTip.length,r=n.hideTip.length,s;t?s=n.showTip[t-1]:r&&(s=n.hideTip[r-1]),s&&(s.dispatchAction=null,e.dispatchAction(s))}function PFe(n,e,t){n.handler("leave",null,t)}function cK(n,e,t,r){e.handler(n,t,r)}function RFe(n){var e={showTip:[],hideTip:[]},t=function(r){var s=e[r.type];s?s.push(r):(r.dispatchAction=t,n.dispatchAction(r))};return{dispatchAction:t,pendings:e}}function D5(n,e){if(!yi.node){var t=e.getZr(),r=(Hm(t).records||{})[n];r&&(Hm(t).records[n]=null)}}var LFe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,s){var o=r.getComponent("tooltip"),l=t.get("triggerOn")||o&&o.get("triggerOn")||"mousemove|click";hce("axisPointer",s,function(c,a,d){l!=="none"&&(c==="leave"||l.indexOf(c)>=0)&&d({type:"updateAxisPointer",currTrigger:c,x:a&&a.offsetX,y:a&&a.offsetY})})},e.prototype.remove=function(t,r){D5("axisPointer",r)},e.prototype.dispose=function(t,r){D5("axisPointer",r)},e.type="axisPointer",e}(kc);function dce(n,e){var t=[],r=n.seriesIndex,s;if(r==null||!(s=e.getSeriesByIndex(r)))return{point:[]};var o=s.getData(),l=yx(o,n);if(l==null||l<0||fr(l))return{point:[]};var c=o.getItemGraphicEl(l),a=s.coordinateSystem;if(s.getTooltipPosition)t=s.getTooltipPosition(l)||[];else if(a&&a.dataToPoint)if(n.isStacked){var d=a.getBaseAxis(),f=a.getOtherAxis(d),m=f.dim,_=d.dim,x=m==="x"||m==="radius"?1:0,A=o.mapDimension(_),I=[];I[x]=o.get(A,l),I[1-x]=o.get(o.getCalculationInfo("stackResultDimension"),l),t=a.dataToPoint(I)||[]}else t=a.dataToPoint(o.getValues(br(a.dimensions,function(C){return o.mapDimension(C)}),l))||[];else if(c){var E=c.getBoundingRect().clone();E.applyTransform(c.transform),t=[E.x+E.width/2,E.y+E.height/2]}return{point:t,el:c}}var uK=Zs();function DFe(n,e,t){var r=n.currTrigger,s=[n.x,n.y],o=n,l=n.dispatchAction||Vs(t.dispatchAction,t),c=e.getComponent("axisPointer").coordSysAxesInfo;if(c){BP(s)&&(s=dce({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},e).point);var a=BP(s),d=o.axesInfo,f=c.axesInfo,m=r==="leave"||BP(s),_={},x={},A={list:[],map:{}},I={showPointer:xs(kFe,x),showTooltip:xs(OFe,A)};ot(c.coordSysMap,function(C,L){var O=a||C.containPoint(s);ot(c.coordSysAxesInfo[L],function(H,q){var Z=H.axis,J=UFe(d,H);if(!m&&O&&(!d||J)){var re=J&&J.value;re==null&&!a&&(re=Z.pointToData(s)),re!=null&&hK(H,re,I,!1,_)}})});var E={};return ot(f,function(C,L){var O=C.linkGroup;O&&!x[L]&&ot(O.axesInfo,function(H,q){var Z=x[q];if(H!==C&&Z){var J=Z.value;O.mapper&&(J=C.axis.scale.parse(O.mapper(J,dK(H),dK(C)))),E[C.key]=J}})}),ot(E,function(C,L){hK(f[L],C,I,!0,_)}),FFe(x,f,_),NFe(A,s,n,l),zFe(f,l,t),_}}function hK(n,e,t,r,s){var o=n.axis;if(!(o.scale.isBlank()||!o.containData(e))){if(!n.involveSeries){t.showPointer(n,e);return}var l=BFe(e,n),c=l.payloadBatch,a=l.snapToValue;c[0]&&s.seriesIndex==null&&Qn(s,c[0]),!r&&n.snap&&o.containData(a)&&a!=null&&(e=a),t.showPointer(n,e,c),t.showTooltip(n,l,a)}}function BFe(n,e){var t=e.axis,r=t.dim,s=n,o=[],l=Number.MAX_VALUE,c=-1;return ot(e.seriesModels,function(a,d){var f=a.getData().mapDimensionsAll(r),m,_;if(a.getAxisTooltipData){var x=a.getAxisTooltipData(f,n,t);_=x.dataIndices,m=x.nestestValue}else{if(_=a.getData().indicesOfNearest(f[0],n,t.type==="category"?.5:null),!_.length)return;m=a.getData().get(f[0],_[0])}if(!(m==null||!isFinite(m))){var A=n-m,I=Math.abs(A);I<=l&&((I<l||A>=0&&c<0)&&(l=I,c=A,s=m,o.length=0),ot(_,function(E){o.push({seriesIndex:a.seriesIndex,dataIndexInside:E,dataIndex:a.getData().getRawIndex(E)})}))}}),{payloadBatch:o,snapToValue:s}}function kFe(n,e,t,r){n[e.key]={value:t,payloadBatch:r}}function OFe(n,e,t,r){var s=t.payloadBatch,o=e.axis,l=o.model,c=e.axisPointerModel;if(!(!e.triggerTooltip||!s.length)){var a=e.coordSys.model,d=HM(a),f=n.map[d];f||(f=n.map[d]={coordSysId:a.id,coordSysIndex:a.componentIndex,coordSysType:a.type,coordSysMainType:a.mainType,dataByAxis:[]},n.list.push(f)),f.dataByAxis.push({axisDim:o.dim,axisIndex:l.componentIndex,axisType:l.type,axisId:l.id,value:r,valueLabelOpt:{precision:c.get(["label","precision"]),formatter:c.get(["label","formatter"])},seriesDataIndices:s.slice()})}}function FFe(n,e,t){var r=t.axesInfo=[];ot(e,function(s,o){var l=s.axisPointerModel.option,c=n[o];c?(!s.useHandle&&(l.status="show"),l.value=c.value,l.seriesDataIndices=(c.payloadBatch||[]).slice()):!s.useHandle&&(l.status="hide"),l.status==="show"&&r.push({axisDim:s.axis.dim,axisIndex:s.axis.model.componentIndex,value:l.value})})}function NFe(n,e,t,r){if(BP(e)||!n.list.length){r({type:"hideTip"});return}var s=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:t.tooltipOption,position:t.position,dataIndexInside:s.dataIndexInside,dataIndex:s.dataIndex,seriesIndex:s.seriesIndex,dataByCoordSys:n.list})}function zFe(n,e,t){var r=t.getZr(),s="axisPointerLastHighlights",o=uK(r)[s]||{},l=uK(r)[s]={};ot(n,function(d,f){var m=d.axisPointerModel.option;m.status==="show"&&d.triggerEmphasis&&ot(m.seriesDataIndices,function(_){var x=_.seriesIndex+" | "+_.dataIndex;l[x]=_})});var c=[],a=[];ot(o,function(d,f){!l[f]&&a.push(d)}),ot(l,function(d,f){!o[f]&&c.push(d)}),a.length&&t.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:a}),c.length&&t.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:c})}function UFe(n,e){for(var t=0;t<(n||[]).length;t++){var r=n[t];if(e.axis.dim===r.axisDim&&e.axis.model.componentIndex===r.axisIndex)return r}}function dK(n){var e=n.axis.model,t={},r=t.axisDim=n.axis.dim;return t.axisIndex=t[r+"AxisIndex"]=e.componentIndex,t.axisName=t[r+"AxisName"]=e.name,t.axisId=t[r+"AxisId"]=e.id,t}function BP(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function y8(n){NC.registerAxisPointerClass("CartesianAxisPointer",AFe),n.registerComponentModel(MFe),n.registerComponentView(LFe),n.registerPreprocessor(function(e){if(e){(!e.axisPointer||e.axisPointer.length===0)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!fr(t)&&(e.axisPointer.link=[t])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=FOe(e,t)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},DFe)}function GFe(n){Sp(KOe),Sp(y8)}var VFe=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,s,o,l){var c=s.axis;c.dim==="angle"&&(this.animationThreshold=Math.PI/18);var a=c.polar,d=a.getOtherAxis(c),f=d.getExtent(),m=c.dataToCoord(r),_=o.get("type");if(_&&_!=="none"){var x=oce(o),A=jFe[_](c,a,m,f);A.style=x,t.graphicKey=A.type,t.pointer=A}var I=o.get(["label","margin"]),E=HFe(r,s,o,a,I);ace(t,s,o,l,E)},e}(ice);function HFe(n,e,t,r,s){var o=e.axis,l=o.dataToCoord(n),c=r.getAngleAxis().getExtent()[0];c=c/180*Math.PI;var a=r.getRadiusAxis().getExtent(),d,f,m;if(o.dim==="radius"){var _=Qy();lB(_,_,c),tL(_,_,[r.cx,r.cy]),d=wB([l,-s],_);var x=e.getModel("axisLabel").get("rotate")||0,A=Fh.innerTextLayout(c,x*Math.PI/180,-1);f=A.textAlign,m=A.textVerticalAlign}else{var I=a[1];d=r.coordToPoint([I+s,l]);var E=r.cx,C=r.cy;f=Math.abs(d[0]-E)/I<.3?"center":d[0]>E?"left":"right",m=Math.abs(d[1]-C)/I<.3?"middle":d[1]>C?"top":"bottom"}return{position:d,align:f,verticalAlign:m}}var jFe={line:function(n,e,t,r){return n.dim==="angle"?{type:"Line",shape:uce(e.coordToPoint([r[0],t]),e.coordToPoint([r[1],t]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:t}}},shadow:function(n,e,t,r){var s=Math.max(1,n.getBandWidth()),o=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:oK(e.cx,e.cy,r[0],r[1],(-t-s/2)*o,(-t+s/2)*o)}:{type:"Sector",shape:oK(e.cx,e.cy,t-s/2,t+s/2,0,Math.PI*2)}}},WFe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.findAxisModel=function(t){var r,s=this.ecModel;return s.eachComponent(t,function(o){o.getCoordSysModel()===this&&(r=o)},this),r},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={z:0,center:["50%","50%"],radius:"80%"},e}(cs),x8=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",Sl).models[0]},e.type="polarAxis",e}(cs);df(x8,hle);var $Fe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="angleAxis",e}(x8),XFe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="radiusAxis",e}(x8),b8=function(n){jn(e,n);function e(t,r){return n.call(this,"radius",t,r)||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e}(Ux);b8.prototype.dataToRadius=Ux.prototype.dataToCoord;b8.prototype.radiusToData=Ux.prototype.coordToData;var qFe=Zs(),w8=function(n){jn(e,n);function e(t,r){return n.call(this,"angle",t,r||[0,360])||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e.prototype.calculateCategoryInterval=function(){var t=this,r=t.getLabelModel(),s=t.scale,o=s.getExtent(),l=s.count();if(o[1]-o[0]<1)return 0;var c=o[0],a=t.dataToCoord(c+1)-t.dataToCoord(c),d=Math.abs(a),f=LC(c==null?"":c+"",r.getFont(),"center","top"),m=Math.max(f.height,7),_=m/d;isNaN(_)&&(_=1/0);var x=Math.max(0,Math.floor(_)),A=qFe(t.model),I=A.lastAutoInterval,E=A.lastTickCount;return I!=null&&E!=null&&Math.abs(I-x)<=1&&Math.abs(E-l)<=1&&I>x?x=I:(A.lastTickCount=l,A.lastAutoInterval=x),x},e}(Ux);w8.prototype.dataToAngle=Ux.prototype.dataToCoord;w8.prototype.angleToData=Ux.prototype.coordToData;var fce=["radius","angle"],YFe=function(){function n(e){this.dimensions=fce,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new b8,this._angleAxis=new w8,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},n.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},n.prototype.getAxis=function(e){var t="_"+e+"Axis";return this[t]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(e){var t=[],r=this._angleAxis,s=this._radiusAxis;return r.scale.type===e&&t.push(r),s.scale.type===e&&t.push(s),t},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(e){var t=e!=null&&e!=="auto"?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},n.prototype.dataToPoint=function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},n.prototype.pointToData=function(e,t){var r=this.pointToCoord(e);return[this._radiusAxis.radiusToData(r[0],t),this._angleAxis.angleToData(r[1],t)]},n.prototype.pointToCoord=function(e){var t=e[0]-this.cx,r=e[1]-this.cy,s=this.getAngleAxis(),o=s.getExtent(),l=Math.min(o[0],o[1]),c=Math.max(o[0],o[1]);s.inverse?l=c-360:c=l+360;var a=Math.sqrt(t*t+r*r);t/=a,r/=a;for(var d=Math.atan2(-r,t)/Math.PI*180,f=d<l?1:-1;d<l||d>c;)d+=f*360;return[a,d]},n.prototype.coordToPoint=function(e){var t=e[0],r=e[1]/180*Math.PI,s=Math.cos(r)*t+this.cx,o=-Math.sin(r)*t+this.cy;return[s,o]},n.prototype.getArea=function(){var e=this.getAngleAxis(),t=this.getRadiusAxis(),r=t.getExtent().slice();r[0]>r[1]&&r.reverse();var s=e.getExtent(),o=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:r[0],r:r[1],startAngle:-s[0]*o,endAngle:-s[1]*o,clockwise:e.inverse,contain:function(l,c){var a=l-this.cx,d=c-this.cy,f=a*a+d*d-1e-4,m=this.r,_=this.r0;return f<=m*m&&f>=_*_}}},n.prototype.convertToPixel=function(e,t,r){var s=fK(t);return s===this?this.dataToPoint(r):null},n.prototype.convertFromPixel=function(e,t,r){var s=fK(t);return s===this?this.pointToData(r):null},n}();function fK(n){var e=n.seriesModel,t=n.polarModel;return t&&t.coordinateSystem||e&&e.coordinateSystem}const ZFe=YFe;function KFe(n,e,t){var r=e.get("center"),s=t.getWidth(),o=t.getHeight();n.cx=hs(r[0],s),n.cy=hs(r[1],o);var l=n.getRadiusAxis(),c=Math.min(s,o)/2,a=e.get("radius");a==null?a=[0,"100%"]:fr(a)||(a=[0,a]);var d=[hs(a[0],c),hs(a[1],c)];l.inverse?l.setExtent(d[1],d[0]):l.setExtent(d[0],d[1])}function JFe(n,e){var t=this,r=t.getAngleAxis(),s=t.getRadiusAxis();if(r.scale.setExtent(1/0,-1/0),s.scale.setExtent(1/0,-1/0),n.eachSeries(function(c){if(c.coordinateSystem===t){var a=c.getData();ot(ML(a,"radius"),function(d){s.scale.unionExtentFromData(a,d)}),ot(ML(a,"angle"),function(d){r.scale.unionExtentFromData(a,d)})}}),TL(r.scale,r.model),TL(s.scale,s.model),r.type==="category"&&!r.onBand){var o=r.getExtent(),l=360/r.scale.count();r.inverse?o[1]+=l:o[1]-=l,r.setExtent(o[0],o[1])}}function QFe(n){return n.mainType==="angleAxis"}function pK(n,e){var t;if(n.type=e.get("type"),n.scale=cle(e),n.onBand=e.get("boundaryGap")&&n.type==="category",n.inverse=e.get("inverse"),QFe(e)){n.inverse=n.inverse!==e.get("clockwise");var r=e.get("startAngle"),s=(t=e.get("endAngle"))!==null&&t!==void 0?t:r+(n.inverse?-360:360);n.setExtent(r,s)}e.axis=n,n.model=e}var e3e={dimensions:fce,create:function(n,e){var t=[];return n.eachComponent("polar",function(r,s){var o=new ZFe(s+"");o.update=JFe;var l=o.getRadiusAxis(),c=o.getAngleAxis(),a=r.findAxisModel("radiusAxis"),d=r.findAxisModel("angleAxis");pK(l,a),pK(c,d),KFe(o,r,e),t.push(o),r.coordinateSystem=o,o.model=r}),n.eachSeries(function(r){if(r.get("coordinateSystem")==="polar"){var s=r.getReferringComponents("polar",Sl).models[0];r.coordinateSystem=s.coordinateSystem}}),t}},t3e=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function UI(n,e,t){e[1]>e[0]&&(e=e.slice().reverse());var r=n.coordToPoint([e[0],t]),s=n.coordToPoint([e[1],t]);return{x1:r[0],y1:r[1],x2:s[0],y2:s[1]}}function GI(n){var e=n.getRadiusAxis();return e.inverse?0:1}function mK(n){var e=n[0],t=n[n.length-1];e&&t&&Math.abs(Math.abs(e.coord-t.coord)-360)<1e-4&&n.pop()}var n3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var s=t.axis,o=s.polar,l=o.getRadiusAxis().getExtent(),c=s.getTicksCoords(),a=s.getMinorTicksCoords(),d=br(s.getViewLabels(),function(f){f=wi(f);var m=s.scale,_=m.type==="ordinal"?m.getRawOrdinalNumber(f.tickValue):f.tickValue;return f.coord=s.dataToCoord(_),f});mK(d),mK(c),ot(t3e,function(f){t.get([f,"show"])&&(!s.scale.isBlank()||f==="axisLine")&&r3e[f](this.group,t,o,c,a,l,d)},this)}},e.type="angleAxis",e}(NC),r3e={axisLine:function(n,e,t,r,s,o){var l=e.getModel(["axisLine","lineStyle"]),c=t.getAngleAxis(),a=Math.PI/180,d=c.getExtent(),f=GI(t),m=f?0:1,_,x=Math.abs(d[1]-d[0])===360?"Circle":"Arc";o[m]===0?_=new BG[x]({shape:{cx:t.cx,cy:t.cy,r:o[f],startAngle:-d[0]*a,endAngle:-d[1]*a,clockwise:c.inverse},style:l.getLineStyle(),z2:1,silent:!0}):_=new EG({shape:{cx:t.cx,cy:t.cy,r:o[f],r0:o[m]},style:l.getLineStyle(),z2:1,silent:!0}),_.style.fill=null,n.add(_)},axisTick:function(n,e,t,r,s,o){var l=e.getModel("axisTick"),c=(l.get("inside")?-1:1)*l.get("length"),a=o[GI(t)],d=br(r,function(f){return new qd({shape:UI(t,[a,a+c],f.coord)})});n.add(Om(d,{style:ri(l.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,e,t,r,s,o){if(s.length){for(var l=e.getModel("axisTick"),c=e.getModel("minorTick"),a=(l.get("inside")?-1:1)*c.get("length"),d=o[GI(t)],f=[],m=0;m<s.length;m++)for(var _=0;_<s[m].length;_++)f.push(new qd({shape:UI(t,[d,d+a],s[m][_].coord)}));n.add(Om(f,{style:ri(c.getModel("lineStyle").getLineStyle(),ri(l.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,e,t,r,s,o,l){var c=e.getCategories(!0),a=e.getModel("axisLabel"),d=a.get("margin"),f=e.get("triggerEvent");ot(l,function(m,_){var x=a,A=m.tickValue,I=o[GI(t)],E=t.coordToPoint([I+d,m.coord]),C=t.cx,L=t.cy,O=Math.abs(E[0]-C)/I<.3?"center":E[0]>C?"left":"right",H=Math.abs(E[1]-L)/I<.3?"middle":E[1]>L?"top":"bottom";if(c&&c[A]){var q=c[A];qr(q)&&q.textStyle&&(x=new Do(q.textStyle,a,a.ecModel))}var Z=new Ra({silent:Fh.isLabelSilent(e),style:cg(x,{x:E[0],y:E[1],fill:x.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:m.formattedLabel,align:O,verticalAlign:H})});if(n.add(Z),f){var J=Fh.makeAxisEventDataBase(e);J.targetType="axisLabel",J.value=m.rawLabel,Yi(Z).eventData=J}},this)},splitLine:function(n,e,t,r,s,o){var l=e.getModel("splitLine"),c=l.getModel("lineStyle"),a=c.get("color"),d=0;a=a instanceof Array?a:[a];for(var f=[],m=0;m<r.length;m++){var _=d++%a.length;f[_]=f[_]||[],f[_].push(new qd({shape:UI(t,o,r[m].coord)}))}for(var m=0;m<f.length;m++)n.add(Om(f[m],{style:ri({stroke:a[m%a.length]},c.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(n,e,t,r,s,o){if(s.length){for(var l=e.getModel("minorSplitLine"),c=l.getModel("lineStyle"),a=[],d=0;d<s.length;d++)for(var f=0;f<s[d].length;f++)a.push(new qd({shape:UI(t,o,s[d][f].coord)}));n.add(Om(a,{style:c.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(n,e,t,r,s,o){if(r.length){var l=e.getModel("splitArea"),c=l.getModel("areaStyle"),a=c.get("color"),d=0;a=a instanceof Array?a:[a];for(var f=[],m=Math.PI/180,_=-r[0].coord*m,x=Math.min(o[0],o[1]),A=Math.max(o[0],o[1]),I=e.get("clockwise"),E=1,C=r.length;E<=C;E++){var L=E===C?r[0].coord:r[E].coord,O=d++%a.length;f[O]=f[O]||[],f[O].push(new Hh({shape:{cx:t.cx,cy:t.cy,r0:x,r:A,startAngle:_,endAngle:-L*m,clockwise:I},silent:!0})),_=-L*m}for(var E=0;E<f.length;E++)n.add(Om(f[E],{style:ri({fill:a[E%a.length]},c.getAreaStyle()),silent:!0}))}}},i3e=["axisLine","axisTickLabel","axisName"],s3e=["splitLine","splitArea","minorSplitLine"],o3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var s=this._axisGroup,o=this._axisGroup=new _a;this.group.add(o);var l=t.axis,c=l.polar,a=c.getAngleAxis(),d=l.getTicksCoords(),f=l.getMinorTicksCoords(),m=a.getExtent()[0],_=l.getExtent(),x=l3e(c,t,m),A=new Fh(t,x);ot(i3e,A.add,A),o.add(A.getGroup()),DG(s,o,t),ot(s3e,function(I){t.get([I,"show"])&&!l.scale.isBlank()&&a3e[I](this.group,t,c,m,_,d,f)},this)}},e.type="radiusAxis",e}(NC),a3e={splitLine:function(n,e,t,r,s,o){var l=e.getModel("splitLine"),c=l.getModel("lineStyle"),a=c.get("color"),d=0,f=t.getAngleAxis(),m=Math.PI/180,_=f.getExtent(),x=Math.abs(_[1]-_[0])===360?"Circle":"Arc";a=a instanceof Array?a:[a];for(var A=[],I=0;I<o.length;I++){var E=d++%a.length;A[E]=A[E]||[],A[E].push(new BG[x]({shape:{cx:t.cx,cy:t.cy,r:Math.max(o[I].coord,0),startAngle:-_[0]*m,endAngle:-_[1]*m,clockwise:f.inverse}}))}for(var I=0;I<A.length;I++)n.add(Om(A[I],{style:ri({stroke:a[I%a.length],fill:null},c.getLineStyle()),silent:!0}))},minorSplitLine:function(n,e,t,r,s,o,l){if(l.length){for(var c=e.getModel("minorSplitLine"),a=c.getModel("lineStyle"),d=[],f=0;f<l.length;f++)for(var m=0;m<l[f].length;m++)d.push(new _B({shape:{cx:t.cx,cy:t.cy,r:l[f][m].coord}}));n.add(Om(d,{style:ri({fill:null},a.getLineStyle()),silent:!0}))}},splitArea:function(n,e,t,r,s,o){if(o.length){var l=e.getModel("splitArea"),c=l.getModel("areaStyle"),a=c.get("color"),d=0;a=a instanceof Array?a:[a];for(var f=[],m=o[0].coord,_=1;_<o.length;_++){var x=d++%a.length;f[x]=f[x]||[],f[x].push(new Hh({shape:{cx:t.cx,cy:t.cy,r0:m,r:o[_].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),m=o[_].coord}for(var _=0;_<f.length;_++)n.add(Om(f[_],{style:ri({fill:a[_%a.length]},c.getAreaStyle()),silent:!0}))}}};function l3e(n,e,t){return{position:[n.cx,n.cy],rotation:t/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}function pce(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function mce(n,e){return e.dim+n.model.componentIndex}function c3e(n,e,t){var r={},s=u3e(sa(e.getSeriesByType(n),function(o){return!e.isSeriesFiltered(o)&&o.coordinateSystem&&o.coordinateSystem.type==="polar"}));e.eachSeriesByType(n,function(o){if(o.coordinateSystem.type==="polar"){var l=o.getData(),c=o.coordinateSystem,a=c.getBaseAxis(),d=mce(c,a),f=pce(o),m=s[d][f],_=m.offset,x=m.width,A=c.getOtherAxis(a),I=o.coordinateSystem.cx,E=o.coordinateSystem.cy,C=o.get("barMinHeight")||0,L=o.get("barMinAngle")||0;r[f]=r[f]||[];for(var O=l.mapDimension(A.dim),H=l.mapDimension(a.dim),q=bx(l,O),Z=a.dim!=="radius"||!o.get("roundCap",!0),J=A.model,re=J.get("startValue"),se=A.dataToCoord(re||0),ae=0,he=l.count();ae<he;ae++){var Ae=l.get(O,ae),Ee=l.get(H,ae),Pe=Ae>=0?"p":"n",ze=se;q&&(r[f][Ee]||(r[f][Ee]={p:se,n:se}),ze=r[f][Ee][Pe]);var Re=void 0,rt=void 0,ye=void 0,We=void 0;if(A.dim==="radius"){var Ue=A.dataToCoord(Ae)-se,gt=a.dataToCoord(Ee);Math.abs(Ue)<C&&(Ue=(Ue<0?-1:1)*C),Re=ze,rt=ze+Ue,ye=gt-_,We=ye-x,q&&(r[f][Ee][Pe]=rt)}else{var vt=A.dataToCoord(Ae,Z)-se,Dt=a.dataToCoord(Ee);Math.abs(vt)<L&&(vt=(vt<0?-1:1)*L),Re=Dt+_,rt=Re+x,ye=ze,We=ze+vt,q&&(r[f][Ee][Pe]=We)}l.setItemLayout(ae,{cx:I,cy:E,r0:Re,r:rt,startAngle:-ye*Math.PI/180,endAngle:-We*Math.PI/180,clockwise:ye>=We})}}})}function u3e(n){var e={};ot(n,function(r,s){var o=r.getData(),l=r.coordinateSystem,c=l.getBaseAxis(),a=mce(l,c),d=c.getExtent(),f=c.type==="category"?c.getBandWidth():Math.abs(d[1]-d[0])/o.count(),m=e[a]||{bandWidth:f,remainedWidth:f,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},_=m.stacks;e[a]=m;var x=pce(r);_[x]||m.autoWidthCount++,_[x]=_[x]||{width:0,maxWidth:0};var A=hs(r.get("barWidth"),f),I=hs(r.get("barMaxWidth"),f),E=r.get("barGap"),C=r.get("barCategoryGap");A&&!_[x].width&&(A=Math.min(m.remainedWidth,A),_[x].width=A,m.remainedWidth-=A),I&&(_[x].maxWidth=I),E!=null&&(m.gap=E),C!=null&&(m.categoryGap=C)});var t={};return ot(e,function(r,s){t[s]={};var o=r.stacks,l=r.bandWidth,c=hs(r.categoryGap,l),a=hs(r.gap,1),d=r.remainedWidth,f=r.autoWidthCount,m=(d-c)/(f+(f-1)*a);m=Math.max(m,0),ot(o,function(I,E){var C=I.maxWidth;C&&C<m&&(C=Math.min(C,d),I.width&&(C=Math.min(C,I.width)),d-=C,I.width=C,f--)}),m=(d-c)/(f+(f-1)*a),m=Math.max(m,0);var _=0,x;ot(o,function(I,E){I.width||(I.width=m),x=I,_+=I.width*(1+a)}),x&&(_-=x.width*a);var A=-_/2;ot(o,function(I,E){t[s][E]=t[s][E]||{offset:A,width:I.width},A+=I.width*(1+a)})}),t}var h3e={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},d3e={splitNumber:5},f3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="polar",e}(kc);function p3e(n){Sp(y8),NC.registerAxisPointerClass("PolarAxisPointer",VFe),n.registerCoordinateSystem("polar",e3e),n.registerComponentModel(WFe),n.registerComponentView(f3e),IL(n,"angle",$Fe,h3e),IL(n,"radius",XFe,d3e),n.registerComponentView(n3e),n.registerComponentView(o3e),n.registerLayout(xs(c3e,"bar"))}var gK=["x","y","radius","angle","single"],m3e=["cartesian2d","polar","singleAxis"];function g3e(n){var e=n.get("coordinateSystem");return Zi(m3e,e)>=0}function Ub(n){return n+"Axis"}function v3e(n,e){var t=oi(),r=[],s=oi();n.eachComponent({mainType:"dataZoom",query:e},function(f){s.get(f.uid)||c(f)});var o;do o=!1,n.eachComponent("dataZoom",l);while(o);function l(f){!s.get(f.uid)&&a(f)&&(c(f),o=!0)}function c(f){s.set(f.uid,!0),r.push(f),d(f)}function a(f){var m=!1;return f.eachTargetAxis(function(_,x){var A=t.get(_);A&&A[x]&&(m=!0)}),m}function d(f){f.eachTargetAxis(function(m,_){(t.get(m)||t.set(m,[]))[_]=!0})}return r}var fN=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},n}(),_3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._autoThrottle=!0,t._noTarget=!0,t._rangePropMode=["percent","percent"],t}return e.prototype.init=function(t,r,s){var o=vK(t);this.settledOption=o,this.mergeDefaultAndTheme(t,s),this._doInit(o)},e.prototype.mergeOption=function(t){var r=vK(t);Fi(this.option,t,!0),Fi(this.settledOption,r,!0),this._doInit(r)},e.prototype._doInit=function(t){var r=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var s=this.settledOption;ot([["start","startValue"],["end","endValue"]],function(o,l){this._rangePropMode[l]==="value"&&(r[o[0]]=s[o[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),r=this._targetAxisInfoMap=oi(),s=this._fillSpecifiedTargetAxis(r);s?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(r,this._orient)),this._noTarget=!0,r.each(function(o){o.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(t){var r=!1;return ot(gK,function(s){var o=this.getReferringComponents(Ub(s),M2e);if(o.specified){r=!0;var l=new fN;ot(o.models,function(c){l.add(c.componentIndex)}),t.set(s,l)}},this),r},e.prototype._fillAutoTargetAxisByOrient=function(t,r){var s=this.ecModel,o=!0;if(o){var l=r==="vertical"?"y":"x",c=s.findComponents({mainType:l+"Axis"});a(c,l)}if(o){var c=s.findComponents({mainType:"singleAxis",filter:function(f){return f.get("orient",!0)===r}});a(c,"single")}function a(d,f){var m=d[0];if(m){var _=new fN;if(_.add(m.componentIndex),t.set(f,_),o=!1,f==="x"||f==="y"){var x=m.getReferringComponents("grid",Sl).models[0];x&&ot(d,function(A){m.componentIndex!==A.componentIndex&&x===A.getReferringComponents("grid",Sl).models[0]&&_.add(A.componentIndex)})}}}o&&ot(gK,function(d){if(o){var f=s.findComponents({mainType:Ub(d),filter:function(_){return _.get("type",!0)==="category"}});if(f[0]){var m=new fN;m.add(f[0].componentIndex),t.set(d,m),o=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis(function(r){!t&&(t=r)},this),t==="y"?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var r=this.ecModel.option;this.option.throttle=r.animation&&r.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var r=this._rangePropMode,s=this.get("rangeMode");ot([["start","startValue"],["end","endValue"]],function(o,l){var c=t[o[0]]!=null,a=t[o[1]]!=null;c&&!a?r[l]="percent":!c&&a?r[l]="value":s?r[l]=s[l]:c&&(r[l]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis(function(r,s){t==null&&(t=this.ecModel.getComponent(Ub(r),s))},this),t},e.prototype.eachTargetAxis=function(t,r){this._targetAxisInfoMap.each(function(s,o){ot(s.indexList,function(l){t.call(r,o,l)})})},e.prototype.getAxisProxy=function(t,r){var s=this.getAxisModel(t,r);if(s)return s.__dzAxisProxy},e.prototype.getAxisModel=function(t,r){var s=this._targetAxisInfoMap.get(t);if(s&&s.indexMap[r])return this.ecModel.getComponent(Ub(t),r)},e.prototype.setRawRange=function(t){var r=this.option,s=this.settledOption;ot([["start","startValue"],["end","endValue"]],function(o){(t[o[0]]!=null||t[o[1]]!=null)&&(r[o[0]]=s[o[0]]=t[o[0]],r[o[1]]=s[o[1]]=t[o[1]])},this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var r=this.option;ot(["start","startValue","end","endValue"],function(s){r[s]=t[s]})},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,r){if(t==null&&r==null){var s=this.findRepresentativeAxisProxy();if(s)return s.getDataValueWindow()}else return this.getAxisProxy(t,r).getDataValueWindow()},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var r,s=this._targetAxisInfoMap.keys(),o=0;o<s.length;o++)for(var l=s[o],c=this._targetAxisInfoMap.get(l),a=0;a<c.indexList.length;a++){var d=this.getAxisProxy(l,c.indexList[a]);if(d.hostedBy(this))return d;r||(r=d)}return r},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={z:4,filterMode:"filter",start:0,end:100},e}(cs);function vK(n){var e={};return ot(["start","end","startValue","endValue","throttle"],function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e}var y3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(_3e),x3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,s,o){this.dataZoomModel=t,this.ecModel=r,this.api=s},e.type="dataZoom",e}(kc),b3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(x3e),gb=ot,_K=a2e,w3e=function(){function n(e,t,r,s){this._dimName=e,this._axisIndex=t,this.ecModel=s,this._dataZoomModel=r}return n.prototype.hostedBy=function(e){return this._dataZoomModel===e},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(t){if(g3e(t)){var r=Ub(this._dimName),s=t.getReferringComponents(r,Sl).models[0];s&&this._axisIndex===s.componentIndex&&e.push(t)}},this),e},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return wi(this._minMaxSpan)},n.prototype.calculateDataWindow=function(e){var t=this._dataExtent,r=this.getAxisModel(),s=r.axis.scale,o=this._dataZoomModel.getRangePropMode(),l=[0,100],c=[],a=[],d;gb(["start","end"],function(_,x){var A=e[_],I=e[_+"Value"];o[x]==="percent"?(A==null&&(A=l[x]),I=s.parse(qv(A,l,t))):(d=!0,I=I==null?t[x]:s.parse(I),A=qv(I,t,l)),a[x]=I==null||isNaN(I)?t[x]:I,c[x]=A==null||isNaN(A)?l[x]:A}),_K(a),_K(c);var f=this._minMaxSpan;d?m(a,c,t,l,!1):m(c,a,l,t,!0);function m(_,x,A,I,E){var C=E?"Span":"ValueSpan";$le(0,_,A,"all",f["min"+C],f["max"+C]);for(var L=0;L<2;L++)x[L]=qv(_[L],A,I,!0),E&&(x[L]=s.parse(x[L]))}return{valueWindow:a,percentWindow:c}},n.prototype.reset=function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=S3e(this,this._dimName,t),this._updateMinMaxSpan();var r=this.calculateDataWindow(e.settledOption);this._valueWindow=r.valueWindow,this._percentWindow=r.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(e,t){if(e!==this._dataZoomModel)return;var r=this._dimName,s=this.getTargetSeriesModels(),o=e.get("filterMode"),l=this._valueWindow;if(o==="none")return;gb(s,function(a){var d=a.getData(),f=d.mapDimensionsAll(r);if(f.length){if(o==="weakFilter"){var m=d.getStore(),_=br(f,function(x){return d.getDimensionIndex(x)},d);d.filterSelf(function(x){for(var A,I,E,C=0;C<f.length;C++){var L=m.get(_[C],x),O=!isNaN(L),H=L<l[0],q=L>l[1];if(O&&!H&&!q)return!0;O&&(E=!0),H&&(A=!0),q&&(I=!0)}return E&&A&&I})}else gb(f,function(x){if(o==="empty")a.setData(d=d.map(x,function(I){return c(I)?I:NaN}));else{var A={};A[x]=l,d.selectRange(A)}});gb(f,function(x){d.setApproximateExtent(l,x)})}});function c(a){return a>=l[0]&&a<=l[1]}},n.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},t=this._dataZoomModel,r=this._dataExtent;gb(["min","max"],function(s){var o=t.get(s+"Span"),l=t.get(s+"ValueSpan");l!=null&&(l=this.getAxisModel().axis.scale.parse(l)),l!=null?o=qv(r[0]+l,r,[0,100],!0):o!=null&&(l=qv(o,[0,100],r,!0)-r[0]),e[s+"Span"]=o,e[s+"ValueSpan"]=l},this)},n.prototype._setAxisModel=function(){var e=this.getAxisModel(),t=this._percentWindow,r=this._valueWindow;if(t){var s=yse(r,[0,500]);s=Math.min(s,20);var o=e.axis.scale.rawExtentInfo;t[0]!==0&&o.setDeterminedMinMax("min",+r[0].toFixed(s)),t[1]!==100&&o.setDeterminedMinMax("max",+r[1].toFixed(s)),o.freeze()}},n}();function S3e(n,e,t){var r=[1/0,-1/0];gb(t,function(l){JBe(r,l.getData(),e)});var s=n.getAxisModel(),o=ale(s.axis.scale,s,r).calculate();return[o.min,o.max]}var A3e={getTargetSeries:function(n){function e(s){n.eachComponent("dataZoom",function(o){o.eachTargetAxis(function(l,c){var a=n.getComponent(Ub(l),c);s(l,c,a,o)})})}e(function(s,o,l,c){l.__dzAxisProxy=null});var t=[];e(function(s,o,l,c){l.__dzAxisProxy||(l.__dzAxisProxy=new w3e(s,o,c,n),t.push(l.__dzAxisProxy))});var r=oi();return ot(t,function(s){ot(s.getTargetSeriesModels(),function(o){r.set(o.uid,o)})}),r},overallReset:function(n,e){n.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(r,s){t.getAxisProxy(r,s).reset(t)}),t.eachTargetAxis(function(r,s){t.getAxisProxy(r,s).filterData(t,e)})}),n.eachComponent("dataZoom",function(t){var r=t.findRepresentativeAxisProxy();if(r){var s=r.getDataPercentWindow(),o=r.getDataValueWindow();t.setCalculatedRange({start:s[0],end:s[1],startValue:o[0],endValue:o[1]})}})}};function T3e(n){n.registerAction("dataZoom",function(e,t){var r=v3e(t,e);ot(r,function(s){s.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}var yK=!1;function M3e(n){yK||(yK=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,A3e),T3e(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function C3e(n){n.registerComponentModel(y3e),n.registerComponentView(b3e),M3e(n)}var $d=function(){function n(){}return n}(),gce={};function CA(n,e){gce[n]=e}function vce(n){return gce[n]}var E3e=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;ot(this.option.feature,function(r,s){var o=vce(s);o&&(o.getDefaultOption&&(o.defaultOption=o.getDefaultOption(t)),Fi(r,o.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}(cs);function I3e(n,e,t){var r=e.getBoxLayoutParams(),s=e.get("padding"),o={width:t.getWidth(),height:t.getHeight()},l=I0(r,o,s);iw(e.get("orient"),n,e.get("itemGap"),l.width,l.height),aRe(n,r,o,s)}function _ce(n,e){var t=LB(e.get("padding")),r=e.getItemStyle(["color","opacity"]);return r.fill=e.get("backgroundColor"),n=new $o({shape:{x:n.x-t[3],y:n.y-t[0],width:n.width+t[1]+t[3],height:n.height+t[0]+t[2],r:e.get("borderRadius")},style:r,silent:!0,z2:-1}),n}var P3e=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,s,o){var l=this.group;if(l.removeAll(),!t.get("show"))return;var c=+t.get("itemSize"),a=t.get("orient")==="vertical",d=t.get("feature")||{},f=this._features||(this._features={}),m=[];ot(d,function(A,I){m.push(I)}),new GM(this._featureNames||[],m).add(_).update(_).remove(xs(_,null)).execute(),this._featureNames=m;function _(A,I){var E=m[A],C=m[I],L=d[E],O=new Do(L,t,t.ecModel),H;if(o&&o.newTitle!=null&&o.featureName===E&&(L.title=o.newTitle),E&&!C){if(R3e(E))H={onclick:O.option.onclick,featureName:E};else{var q=vce(E);if(!q)return;H=new q}f[E]=H}else if(H=f[C],!H)return;H.uid=FC("toolbox-feature"),H.model=O,H.ecModel=r,H.api=s;var Z=H instanceof $d;if(!E&&C){Z&&H.dispose&&H.dispose(r,s);return}if(!O.get("show")||Z&&H.unusable){Z&&H.remove&&H.remove(r,s);return}x(O,H,E),O.setIconStatus=function(J,re){var se=this.option,ae=this.iconPaths;se.iconStatus=se.iconStatus||{},se.iconStatus[J]=re,ae[J]&&(re==="emphasis"?ww:Sw)(ae[J])},H instanceof $d&&H.render&&H.render(O,r,s,o)}function x(A,I,E){var C=A.getModel("iconStyle"),L=A.getModel(["emphasis","iconStyle"]),O=I instanceof $d&&I.getIcons?I.getIcons():A.get("icon"),H=A.get("title")||{},q,Z;Br(O)?(q={},q[E]=O):q=O,Br(H)?(Z={},Z[E]=H):Z=H;var J=A.iconPaths={};ot(q,function(re,se){var ae=SB(re,{},{x:-c/2,y:-c/2,width:c,height:c});ae.setStyle(C.getItemStyle());var he=ae.ensureState("emphasis");he.style=L.getItemStyle();var Ae=new Ra({style:{text:Z[se],align:L.get("textAlign"),borderRadius:L.get("textBorderRadius"),padding:L.get("textPadding"),fill:null,font:boe({fontStyle:L.get("textFontStyle"),fontFamily:L.get("textFontFamily"),fontSize:L.get("textFontSize"),fontWeight:L.get("textFontWeight")},r)},ignore:!0});ae.setTextContent(Ae),AB({el:ae,componentModel:t,itemName:se,formatterParamsExtra:{title:Z[se]}}),ae.__title=Z[se],ae.on("mouseover",function(){var Ee=L.getItemStyle(),Pe=a?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";Ae.setStyle({fill:L.get("textFill")||Ee.fill||Ee.stroke||"#000",backgroundColor:L.get("textBackgroundColor")}),ae.setTextConfig({position:L.get("textPosition")||Pe}),Ae.ignore=!t.get("showTitle"),s.enterEmphasis(this)}).on("mouseout",function(){A.get(["iconStatus",se])!=="emphasis"&&s.leaveEmphasis(this),Ae.hide()}),(A.get(["iconStatus",se])==="emphasis"?ww:Sw)(ae),l.add(ae),ae.on("click",Vs(I.onclick,I,r,s,se)),J[se]=ae})}I3e(l,t,s),l.add(_ce(l.getBoundingRect(),t)),a||l.eachChild(function(A){var I=A.__title,E=A.ensureState("emphasis"),C=E.textConfig||(E.textConfig={}),L=A.getTextContent(),O=L&&L.ensureState("emphasis");if(O&&!hi(O)&&I){var H=O.style||(O.style={}),q=LC(I,Ra.makeFont(H)),Z=A.x+l.x,J=A.y+l.y+c,re=!1;J+q.height>s.getHeight()&&(C.position="top",re=!0);var se=re?-5-q.height:c+10;Z+q.width/2>s.getWidth()?(C.position=["100%",se],H.align="right"):Z-q.width/2<0&&(C.position=[0,se],H.align="left")}})},e.prototype.updateView=function(t,r,s,o){ot(this._features,function(l){l instanceof $d&&l.updateView&&l.updateView(l.model,r,s,o)})},e.prototype.remove=function(t,r){ot(this._features,function(s){s instanceof $d&&s.remove&&s.remove(t,r)}),this.group.removeAll()},e.prototype.dispose=function(t,r){ot(this._features,function(s){s instanceof $d&&s.dispose&&s.dispose(t,r)})},e.type="toolbox",e}(kc);function R3e(n){return n.indexOf("my")===0}var L3e=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){var s=this.model,o=s.get("name")||t.get("title.0.text")||"echarts",l=r.getZr().painter.getType()==="svg",c=l?"svg":s.get("type",!0)||"png",a=r.getConnectedDataURL({type:c,backgroundColor:s.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:s.get("connectedBackgroundColor"),excludeComponents:s.get("excludeComponents"),pixelRatio:s.get("pixelRatio")}),d=yi.browser;if(typeof MouseEvent=="function"&&(d.newEdge||!d.ie&&!d.edge)){var f=document.createElement("a");f.download=o+"."+c,f.target="_blank",f.href=a;var m=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});f.dispatchEvent(m)}else if(window.navigator.msSaveOrOpenBlob||l){var _=a.split(","),x=_[0].indexOf("base64")>-1,A=l?decodeURIComponent(_[1]):_[1];x&&(A=window.atob(A));var I=o+"."+c;if(window.navigator.msSaveOrOpenBlob){for(var E=A.length,C=new Uint8Array(E);E--;)C[E]=A.charCodeAt(E);var L=new Blob([C]);window.navigator.msSaveOrOpenBlob(L,I)}else{var O=document.createElement("iframe");document.body.appendChild(O);var H=O.contentWindow,q=H.document;q.open("image/svg+xml","replace"),q.write(A),q.close(),H.focus(),q.execCommand("SaveAs",!0,I),document.body.removeChild(O)}}else{var Z=s.get("lang"),J='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(Z&&Z[0]||"")+'" /></body>',re=window.open();re.document.write(J),re.document.title=o}},e.getDefaultOption=function(t){var r={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return r},e}($d),xK="__ec_magicType_stack__",D3e=[["line","bar"],["stack"]],B3e=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getIcons=function(){var t=this.model,r=t.get("icon"),s={};return ot(t.get("type"),function(o){r[o]&&(s[o]=r[o])}),s},e.getDefaultOption=function(t){var r={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return r},e.prototype.onclick=function(t,r,s){var o=this.model,l=o.get(["seriesIndex",s]);if(bK[s]){var c={series:[]},a=function(m){var _=m.subType,x=m.id,A=bK[s](_,x,m,o);A&&(ri(A,m.option),c.series.push(A));var I=m.coordinateSystem;if(I&&I.type==="cartesian2d"&&(s==="line"||s==="bar")){var E=I.getAxesByScale("ordinal")[0];if(E){var C=E.dim,L=C+"Axis",O=m.getReferringComponents(L,Sl).models[0],H=O.componentIndex;c[L]=c[L]||[];for(var q=0;q<=H;q++)c[L][H]=c[L][H]||{};c[L][H].boundaryGap=s==="bar"}}};ot(D3e,function(m){Zi(m,s)>=0&&ot(m,function(_){o.setIconStatus(_,"normal")})}),o.setIconStatus(s,"emphasis"),t.eachComponent({mainType:"series",query:l==null?null:{seriesIndex:l}},a);var d,f=s;s==="stack"&&(d=Fi({stack:o.option.title.tiled,tiled:o.option.title.stack},o.option.title),o.get(["iconStatus",s])!=="emphasis"&&(f="tiled")),r.dispatchAction({type:"changeMagicType",currentType:f,newOption:c,newTitle:d,featureName:"magicType"})}},e}($d),bK={line:function(n,e,t,r){if(n==="bar")return Fi({id:e,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","line"])||{},!0)},bar:function(n,e,t,r){if(n==="line")return Fi({id:e,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","bar"])||{},!0)},stack:function(n,e,t,r){var s=t.get("stack")===xK;if(n==="line"||n==="bar")return r.setIconStatus("stack",s?"normal":"emphasis"),Fi({id:e,stack:s?"":xK},r.get(["option","stack"])||{},!0)}};Ep({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,e){e.mergeOption(n.newOption)});var GB=new Array(60).join("-"),Ew="	";function k3e(n){var e={},t=[],r=[];return n.eachRawSeries(function(s){var o=s.coordinateSystem;if(o&&(o.type==="cartesian2d"||o.type==="polar")){var l=o.getBaseAxis();if(l.type==="category"){var c=l.dim+"_"+l.index;e[c]||(e[c]={categoryAxis:l,valueAxis:o.getOtherAxis(l),series:[]},r.push({axisDim:l.dim,axisIndex:l.index})),e[c].series.push(s)}else t.push(s)}else t.push(s)}),{seriesGroupByCategoryAxis:e,other:t,meta:r}}function O3e(n){var e=[];return ot(n,function(t,r){var s=t.categoryAxis,o=t.valueAxis,l=o.dim,c=[" "].concat(br(t.series,function(x){return x.name})),a=[s.model.getCategories()];ot(t.series,function(x){var A=x.getRawData();a.push(x.getRawData().mapArray(A.mapDimension(l),function(I){return I}))});for(var d=[c.join(Ew)],f=0;f<a[0].length;f++){for(var m=[],_=0;_<a.length;_++)m.push(a[_][f]);d.push(m.join(Ew))}e.push(d.join(`
`))}),e.join(`

`+GB+`

`)}function F3e(n){return br(n,function(e){var t=e.getRawData(),r=[e.name],s=[];return t.each(t.dimensions,function(){for(var o=arguments.length,l=arguments[o-1],c=t.getName(l),a=0;a<o-1;a++)s[a]=arguments[a];r.push((c?c+Ew:"")+s.join(Ew))}),r.join(`
`)}).join(`

`+GB+`

`)}function N3e(n){var e=k3e(n);return{value:sa([O3e(e.seriesGroupByCategoryAxis),F3e(e.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+GB+`

`),meta:e.meta}}function PL(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function z3e(n){var e=n.slice(0,n.indexOf(`
`));if(e.indexOf(Ew)>=0)return!0}var B5=new RegExp("["+Ew+"]+","g");function U3e(n){for(var e=n.split(/\n+/g),t=PL(e.shift()).split(B5),r=[],s=br(t,function(a){return{name:a,data:[]}}),o=0;o<e.length;o++){var l=PL(e[o]).split(B5);r.push(l.shift());for(var c=0;c<l.length;c++)s[c]&&(s[c].data[o]=l[c])}return{series:s,categories:r}}function G3e(n){for(var e=n.split(/\n+/g),t=PL(e.shift()),r=[],s=0;s<e.length;s++){var o=PL(e[s]);if(o){var l=o.split(B5),c="",a=void 0,d=!1;isNaN(l[0])?(d=!0,c=l[0],l=l.slice(1),r[s]={name:c,value:[]},a=r[s].value):a=r[s]=[];for(var f=0;f<l.length;f++)a.push(+l[f]);a.length===1&&(d?r[s].value=a[0]:r[s]=a[0])}}return{name:t,data:r}}function V3e(n,e){var t=n.split(new RegExp(`
*`+GB+`
*`,"g")),r={series:[]};return ot(t,function(s,o){if(z3e(s)){var l=U3e(s),c=e[o],a=c.axisDim+"Axis";c&&(r[a]=r[a]||[],r[a][c.axisIndex]={data:l.categories},r.series=r.series.concat(l.series))}else{var l=G3e(s);r.series.push(l)}}),r}var H3e=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){setTimeout(function(){r.dispatchAction({type:"hideTip"})});var s=r.getDom(),o=this.model;this._dom&&s.removeChild(this._dom);var l=document.createElement("div");l.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",l.style.backgroundColor=o.get("backgroundColor")||"#fff";var c=document.createElement("h4"),a=o.get("lang")||[];c.innerHTML=a[0]||o.get("title"),c.style.cssText="margin:10px 20px",c.style.color=o.get("textColor");var d=document.createElement("div"),f=document.createElement("textarea");d.style.cssText="overflow:auto";var m=o.get("optionToContent"),_=o.get("contentToOption"),x=N3e(t);if(hi(m)){var A=m(r.getOption());Br(A)?d.innerHTML=A:bw(A)&&d.appendChild(A)}else{f.readOnly=o.get("readOnly");var I=f.style;I.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",I.color=o.get("textColor"),I.borderColor=o.get("textareaBorderColor"),I.backgroundColor=o.get("textareaColor"),f.value=x.value,d.appendChild(f)}var E=x.meta,C=document.createElement("div");C.style.cssText="position:absolute;bottom:5px;left:0;right:0";var L="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",O=document.createElement("div"),H=document.createElement("div");L+=";background-color:"+o.get("buttonColor"),L+=";color:"+o.get("buttonTextColor");var q=this;function Z(){s.removeChild(l),q._dom=null}Bz(O,"click",Z),Bz(H,"click",function(){if(_==null&&m!=null||_!=null&&m==null){Z();return}var J;try{hi(_)?J=_(d,r.getOption()):J=V3e(f.value,E)}catch(re){throw Z(),new Error("Data view format error "+re)}J&&r.dispatchAction({type:"changeDataView",newOption:J}),Z()}),O.innerHTML=a[1],H.innerHTML=a[2],H.style.cssText=O.style.cssText=L,!o.get("readOnly")&&C.appendChild(H),C.appendChild(O),l.appendChild(c),l.appendChild(d),l.appendChild(C),d.style.height=s.clientHeight-80+"px",s.appendChild(l),this._dom=l},e.prototype.remove=function(t,r){this._dom&&r.getDom().removeChild(this._dom)},e.prototype.dispose=function(t,r){this.remove(t,r)},e.getDefaultOption=function(t){var r={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return r},e}($d);function j3e(n,e){return br(n,function(t,r){var s=e&&e[r];if(qr(s)&&!fr(s)){var o=qr(t)&&!fr(t);o||(t={value:t});var l=s.name!=null&&t.name==null;return t=ri(t,s),l&&delete t.name,t}else return t})}Ep({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,e){var t=[];ot(n.newOption.series,function(r){var s=e.getSeriesByName(r.name)[0];if(!s)t.push(Qn({type:"scatter"},r));else{var o=s.get("data");t.push({name:r.name,data:j3e(r.data,o)})}}),e.mergeOption(ri({series:t},n.newOption))});var yce=ot,xce=Zs();function W3e(n,e){var t=S8(n);yce(e,function(r,s){for(var o=t.length-1;o>=0;o--){var l=t[o];if(l[s])break}if(o<0){var c=n.queryComponents({mainType:"dataZoom",subType:"select",id:s})[0];if(c){var a=c.getPercentRange();t[0][s]={dataZoomId:s,start:a[0],end:a[1]}}}}),t.push(e)}function $3e(n){var e=S8(n),t=e[e.length-1];e.length>1&&e.pop();var r={};return yce(t,function(s,o){for(var l=e.length-1;l>=0;l--)if(s=e[l][o],s){r[o]=s;break}}),r}function X3e(n){xce(n).snapshots=null}function q3e(n){return S8(n).length}function S8(n){var e=xce(n);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var Y3e=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){X3e(t),r.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(t){var r={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return r},e}($d);Ep({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,e){e.resetOption("recreate")});var Z3e=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],bce=function(){function n(e,t,r){var s=this;this._targetInfoList=[];var o=wK(t,e);ot(K3e,function(l,c){(!r||!r.include||Zi(r.include,c)>=0)&&l(o,s._targetInfoList)})}return n.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,function(r,s,o){if((r.coordRanges||(r.coordRanges=[])).push(s),!r.coordRange){r.coordRange=s;var l=pN[r.brushType](0,o,s);r.__rangeOffset={offset:MK[r.brushType](l.values,r.range,[1,1]),xyMinMax:l.xyMinMax}}}),e},n.prototype.matchOutputRanges=function(e,t,r){ot(e,function(s){var o=this.findTargetInfo(s,t);o&&o!==!0&&ot(o.coordSyses,function(l){var c=pN[s.brushType](1,l,s.range,!0);r(s,c.values,l,t)})},this)},n.prototype.setInputRanges=function(e,t){ot(e,function(r){var s=this.findTargetInfo(r,t);if(r.range=r.range||[],s&&s!==!0){r.panelId=s.panelId;var o=pN[r.brushType](0,s.coordSys,r.coordRange),l=r.__rangeOffset;r.range=l?MK[r.brushType](o.values,l.offset,J3e(o.xyMinMax,l.xyMinMax)):o.values}},this)},n.prototype.makePanelOpts=function(e,t){return br(this._targetInfoList,function(r){var s=r.getPanelRect();return{panelId:r.panelId,defaultBrushType:t?t(r):null,clipPath:_Fe(s),isTargetByCursor:xFe(s,e,r.coordSysModel),getLinearBrushOtherExtent:yFe(s)}})},n.prototype.controlSeries=function(e,t,r){var s=this.findTargetInfo(e,r);return s===!0||s&&Zi(s.coordSyses,t.coordinateSystem)>=0},n.prototype.findTargetInfo=function(e,t){for(var r=this._targetInfoList,s=wK(t,e),o=0;o<r.length;o++){var l=r[o],c=e.panelId;if(c){if(l.panelId===c)return l}else for(var a=0;a<SK.length;a++)if(SK[a](s,l))return l}return!0},n}();function k5(n){return n[0]>n[1]&&n.reverse(),n}function wK(n,e){return RT(n,e,{includeMainTypes:Z3e})}var K3e={grid:function(n,e){var t=n.xAxisModels,r=n.yAxisModels,s=n.gridModels,o=oi(),l={},c={};!t&&!r&&!s||(ot(t,function(a){var d=a.axis.grid.model;o.set(d.id,d),l[d.id]=!0}),ot(r,function(a){var d=a.axis.grid.model;o.set(d.id,d),c[d.id]=!0}),ot(s,function(a){o.set(a.id,a),l[a.id]=!0,c[a.id]=!0}),o.each(function(a){var d=a.coordinateSystem,f=[];ot(d.getCartesians(),function(m,_){(Zi(t,m.getAxis("x").model)>=0||Zi(r,m.getAxis("y").model)>=0)&&f.push(m)}),e.push({panelId:"grid--"+a.id,gridModel:a,coordSysModel:a,coordSys:f[0],coordSyses:f,getPanelRect:AK.grid,xAxisDeclared:l[a.id],yAxisDeclared:c[a.id]})}))},geo:function(n,e){ot(n.geoModels,function(t){var r=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:r,coordSyses:[r],getPanelRect:AK.geo})})}},SK=[function(n,e){var t=n.xAxisModel,r=n.yAxisModel,s=n.gridModel;return!s&&t&&(s=t.axis.grid.model),!s&&r&&(s=r.axis.grid.model),s&&s===e.gridModel},function(n,e){var t=n.geoModel;return t&&t===e.geoModel}],AK={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,e=n.getBoundingRect().clone();return e.applyTransform(LG(n)),e}},pN={lineX:xs(TK,0),lineY:xs(TK,1),rect:function(n,e,t,r){var s=n?e.pointToData([t[0][0],t[1][0]],r):e.dataToPoint([t[0][0],t[1][0]],r),o=n?e.pointToData([t[0][1],t[1][1]],r):e.dataToPoint([t[0][1],t[1][1]],r),l=[k5([s[0],o[0]]),k5([s[1],o[1]])];return{values:l,xyMinMax:l}},polygon:function(n,e,t,r){var s=[[1/0,-1/0],[1/0,-1/0]],o=br(t,function(l){var c=n?e.pointToData(l,r):e.dataToPoint(l,r);return s[0][0]=Math.min(s[0][0],c[0]),s[1][0]=Math.min(s[1][0],c[1]),s[0][1]=Math.max(s[0][1],c[0]),s[1][1]=Math.max(s[1][1],c[1]),c});return{values:o,xyMinMax:s}}};function TK(n,e,t,r){var s=t.getAxis(["x","y"][n]),o=k5(br([0,1],function(c){return e?s.coordToData(s.toLocalCoord(r[c]),!0):s.toGlobalCoord(s.dataToCoord(r[c]))})),l=[];return l[n]=o,l[1-n]=[NaN,NaN],{values:o,xyMinMax:l}}var MK={lineX:xs(CK,0),lineY:xs(CK,1),rect:function(n,e,t){return[[n[0][0]-t[0]*e[0][0],n[0][1]-t[0]*e[0][1]],[n[1][0]-t[1]*e[1][0],n[1][1]-t[1]*e[1][1]]]},polygon:function(n,e,t){return br(n,function(r,s){return[r[0]-t[0]*e[s][0],r[1]-t[1]*e[s][1]]})}};function CK(n,e,t,r){return[e[0]-r[n]*t[0],e[1]-r[n]*t[1]]}function J3e(n,e){var t=EK(n),r=EK(e),s=[t[0]/r[0],t[1]/r[1]];return isNaN(s[0])&&(s[0]=1),isNaN(s[1])&&(s[1]=1),s}function EK(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var O5=ot,Q3e=w2e("toolbox-dataZoom_"),eNe=function(n){jn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,s,o){this._brushController||(this._brushController=new cFe(s.getZr()),this._brushController.on("brush",Vs(this._onBrush,this)).mount()),rNe(t,r,this,o,s),nNe(t,r)},e.prototype.onclick=function(t,r,s){tNe[s].call(this)},e.prototype.remove=function(t,r){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(t,r){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(t){var r=t.areas;if(!t.isEnd||!r.length)return;var s={},o=this.ecModel;this._brushController.updateCovers([]);var l=new bce(A8(this.model),o,{include:["grid"]});l.matchOutputRanges(r,o,function(d,f,m){if(m.type==="cartesian2d"){var _=d.brushType;_==="rect"?(c("x",m,f[0]),c("y",m,f[1])):c({lineX:"x",lineY:"y"}[_],m,f)}}),W3e(o,s),this._dispatchZoomAction(s);function c(d,f,m){var _=f.getAxis(d),x=_.model,A=a(d,x,o),I=A.findRepresentativeAxisProxy(x).getMinMaxSpan();(I.minValueSpan!=null||I.maxValueSpan!=null)&&(m=$le(0,m.slice(),_.scale.getExtent(),0,I.minValueSpan,I.maxValueSpan)),A&&(s[A.id]={dataZoomId:A.id,startValue:m[0],endValue:m[1]})}function a(d,f,m){var _;return m.eachComponent({mainType:"dataZoom",subType:"select"},function(x){var A=x.getAxisModel(d,f.componentIndex);A&&(_=x)}),_}},e.prototype._dispatchZoomAction=function(t){var r=[];O5(t,function(s,o){r.push(wi(s))}),r.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:r})},e.getDefaultOption=function(t){var r={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return r},e}($d),tNe={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction($3e(this.ecModel))}};function A8(n){var e={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}function nNe(n,e){n.setIconStatus("back",q3e(e)>1?"emphasis":"normal")}function rNe(n,e,t,r,s){var o=t._isZoomActive;r&&r.type==="takeGlobalCursor"&&(o=r.key==="dataZoomSelect"?r.dataZoomSelectActive:!1),t._isZoomActive=o,n.setIconStatus("zoom",o?"emphasis":"normal");var l=new bce(A8(n),e,{include:["grid"]}),c=l.makePanelOpts(s,function(a){return a.xAxisDeclared&&!a.yAxisDeclared?"lineX":!a.xAxisDeclared&&a.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(c).enableBrush(o&&c.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}gRe("dataZoom",function(n){var e=n.getComponent("toolbox",0),t=["feature","dataZoom"];if(!e||e.get(t)==null)return;var r=e.getModel(t),s=[],o=A8(r),l=RT(n,o);O5(l.xAxisModels,function(a){return c(a,"xAxis","xAxisIndex")}),O5(l.yAxisModels,function(a){return c(a,"yAxis","yAxisIndex")});function c(a,d,f){var m=a.componentIndex,_={type:"select",$fromToolbox:!0,filterMode:r.get("filterMode",!0)||"filter",id:Q3e+d+m};_[f]=m,s.push(_)}return s});function iNe(n){n.registerComponentModel(E3e),n.registerComponentView(P3e),CA("saveAsImage",L3e),CA("magicType",B3e),CA("dataView",H3e),CA("dataZoom",eNe),CA("restore",Y3e),Sp(C3e)}var sNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(cs);function wce(n){var e=n.get("confine");return e!=null?!!e:n.get("renderMode")==="richText"}function Sce(n){if(yi.domSupported){for(var e=document.documentElement.style,t=0,r=n.length;t<r;t++)if(n[t]in e)return n[t]}}var Ace=Sce(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),oNe=Sce(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function Tce(n,e){if(!n)return e;e=Ooe(e,!0);var t=n.indexOf(e);return n=t===-1?e:"-"+n.slice(0,t)+"-"+e,n.toLowerCase()}function aNe(n,e){var t=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return t?t[e]:null}var lNe=Tce(oNe,"transition"),T8=Tce(Ace,"transform"),cNe="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(yi.transform3dSupported?"will-change:transform;":"");function uNe(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function hNe(n,e,t){if(!Br(t)||t==="inside")return"";var r=n.get("backgroundColor"),s=n.get("borderWidth");e=xx(e);var o=uNe(t),l=Math.max(Math.round(s)*1.5,6),c="",a=T8+":",d;Zi(["left","right"],o)>-1?(c+="top:50%",a+="translateY(-50%) rotate("+(d=o==="left"?-225:-45)+"deg)"):(c+="left:50%",a+="translateX(-50%) rotate("+(d=o==="top"?225:45)+"deg)");var f=d*Math.PI/180,m=l+s,_=m*Math.abs(Math.cos(f))+m*Math.abs(Math.sin(f)),x=Math.round(((_-Math.SQRT2*s)/2+Math.SQRT2*s-(_-m)/2)*100)/100;c+=";"+o+":-"+x+"px";var A=e+" solid "+s+"px;",I=["position:absolute;width:"+l+"px;height:"+l+"px;z-index:-1;",c+";"+a+";","border-bottom:"+A,"border-right:"+A,"background-color:"+r+";"];return'<div style="'+I.join("")+'"></div>'}function dNe(n,e){var t="cubic-bezier(0.23,1,0.32,1)",r=" "+n/2+"s "+t,s="opacity"+r+",visibility"+r;return e||(r=" "+n+"s "+t,s+=yi.transformSupported?","+T8+r:",left"+r+",top"+r),lNe+":"+s}function IK(n,e,t){var r=n.toFixed(0)+"px",s=e.toFixed(0)+"px";if(!yi.transformSupported)return t?"top:"+s+";left:"+r+";":[["top",s],["left",r]];var o=yi.transform3dSupported,l="translate"+(o?"3d":"")+"("+r+","+s+(o?",0":"")+")";return t?"top:0;left:0;"+T8+":"+l+";":[["top",0],["left",0],[Ace,l]]}function fNe(n){var e=[],t=n.get("fontSize"),r=n.getTextColor();r&&e.push("color:"+r),e.push("font:"+n.getFont()),t&&e.push("line-height:"+Math.round(t*3/2)+"px");var s=n.get("textShadowColor"),o=n.get("textShadowBlur")||0,l=n.get("textShadowOffsetX")||0,c=n.get("textShadowOffsetY")||0;return s&&o&&e.push("text-shadow:"+l+"px "+c+"px "+o+"px "+s),ot(["decoration","align"],function(a){var d=n.get(a);d&&e.push("text-"+a+":"+d)}),e.join(";")}function pNe(n,e,t){var r=[],s=n.get("transitionDuration"),o=n.get("backgroundColor"),l=n.get("shadowBlur"),c=n.get("shadowColor"),a=n.get("shadowOffsetX"),d=n.get("shadowOffsetY"),f=n.getModel("textStyle"),m=dae(n,"html"),_=a+"px "+d+"px "+l+"px "+c;return r.push("box-shadow:"+_),e&&s&&r.push(dNe(s,t)),o&&r.push("background-color:"+o),ot(["width","color","radius"],function(x){var A="border-"+x,I=Ooe(A),E=n.get(I);E!=null&&r.push(A+":"+E+(x==="color"?"":"px"))}),r.push(fNe(f)),m!=null&&r.push("padding:"+LB(m).join("px ")+"px"),r.join(";")+";"}function PK(n,e,t,r,s){var o=e&&e.painter;if(t){var l=o&&o.getViewportRoot();l&&rEe(n,l,t,r,s)}else{n[0]=r,n[1]=s;var c=o&&o.getViewportRootOffset();c&&(n[0]+=c.offsetLeft,n[1]+=c.offsetTop)}n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var mNe=function(){function n(e,t){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,yi.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var s=this._zr=e.getZr(),o=t.appendTo,l=o&&(Br(o)?document.querySelector(o):bw(o)?o:hi(o)&&o(e.getDom()));PK(this._styleCoord,s,l,e.getWidth()/2,e.getHeight()/2),(l||e.getDom()).appendChild(r),this._api=e,this._container=l;var c=this;r.onmouseenter=function(){c._enterable&&(clearTimeout(c._hideTimeout),c._show=!0),c._inContent=!0},r.onmousemove=function(a){if(a=a||window.event,!c._enterable){var d=s.handler,f=s.painter.getViewportRoot();yh(f,a,!0),d.dispatch("mousemove",a)}},r.onmouseleave=function(){c._inContent=!1,c._enterable&&c._show&&c.hideLater(c._hideDelay)}}return n.prototype.update=function(e){if(!this._container){var t=this._api.getDom(),r=aNe(t,"position"),s=t.style;s.position!=="absolute"&&r!=="absolute"&&(s.position="relative")}var o=e.get("alwaysShowContent");o&&this._moveIfResized(),this._alwaysShowContent=o,this.el.className=e.get("className")||""},n.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var r=this.el,s=r.style,o=this._styleCoord;r.innerHTML?s.cssText=cNe+pNe(e,!this._firstShow,this._longHide)+IK(o[0],o[1],!0)+("border-color:"+xx(t)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):s.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(e,t,r,s,o){var l=this.el;if(e==null){l.innerHTML="";return}var c="";if(Br(o)&&r.get("trigger")==="item"&&!wce(r)&&(c=hNe(r,s,o)),Br(e))l.innerHTML=e+c;else if(e){l.innerHTML="",fr(e)||(e=[e]);for(var a=0;a<e.length;a++)bw(e[a])&&e[a].parentNode!==l&&l.appendChild(e[a]);if(c&&l.childNodes.length){var d=document.createElement("div");d.innerHTML=c,l.appendChild(d)}}},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},n.prototype.moveTo=function(e,t){var r=this._styleCoord;if(PK(r,this._zr,this._container,e,t),r[0]!=null&&r[1]!=null){var s=this.el.style,o=IK(r[0],r[1]);ot(o,function(l){s[l[0]]=l[1]})}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",yi.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Vs(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var e=this.el.parentNode;e&&e.removeChild(this.el),this.el=this._container=null},n}(),gNe=function(){function n(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),LK(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return n.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(e,t,r,s,o){var l=this;qr(e)&&us(""),this.el&&this._zr.remove(this.el);var c=r.getModel("textStyle");this.el=new Ra({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:s,textShadowColor:c.get("textShadowColor"),fill:r.get(["textStyle","color"]),padding:dae(r,"richText"),verticalAlign:"top",align:"left"},z:r.get("z")}),ot(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(d){l.el.style[d]=r.get(d)}),ot(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(d){l.el.style[d]=c.get(d)||0}),this._zr.add(this.el);var a=this;this.el.on("mouseover",function(){a._enterable&&(clearTimeout(a._hideTimeout),a._show=!0),a._inContent=!0}),this.el.on("mouseout",function(){a._enterable&&a._show&&a.hideLater(a._hideDelay),a._inContent=!1})},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),r=RK(e.style);return[t.width+r.left+r.right,t.height+r.top+r.bottom]},n.prototype.moveTo=function(e,t){var r=this.el;if(r){var s=this._styleCoord;LK(s,this._zr,e,t),e=s[0],t=s[1];var o=r.style,l=Uv(o.borderWidth||0),c=RK(o);r.x=e+l+c.left,r.y=t+l+c.top,r.markRedraw()}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Vs(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function Uv(n){return Math.max(0,n)}function RK(n){var e=Uv(n.shadowBlur||0),t=Uv(n.shadowOffsetX||0),r=Uv(n.shadowOffsetY||0);return{left:Uv(e-t),right:Uv(e+t),top:Uv(e-r),bottom:Uv(e+r)}}function LK(n,e,t,r){n[0]=t,n[1]=r,n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var vNe=new $o({shape:{x:-1,y:-1,width:2,height:2}}),_Ne=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,r){if(!(yi.node||!r.getDom())){var s=t.getComponent("tooltip"),o=this._renderMode=E2e(s.get("renderMode"));this._tooltipContent=o==="richText"?new gNe(r):new mNe(r,{appendTo:s.get("appendToBody",!0)?"body":s.get("appendTo",!0)})}},e.prototype.render=function(t,r,s){if(!(yi.node||!s.getDom())){this.group.removeAll(),this._tooltipModel=t,this._ecModel=r,this._api=s;var o=this._tooltipContent;o.update(t),o.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&t.get("transitionDuration")?pae(this,"_updatePosition",50,"fixRate"):u5(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel,r=t.get("triggerOn");hce("itemTooltip",this._api,Vs(function(s,o,l){r!=="none"&&(r.indexOf(s)>=0?this._tryShow(o,l):s==="leave"&&this._hide(l))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,r=this._ecModel,s=this._api,o=t.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&o!=="none"&&o!=="click"){var l=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!s.isDisposed()&&l.manuallyShowTip(t,r,s,{x:l._lastX,y:l._lastY,dataByCoordSys:l._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,r,s,o){if(!(o.from===this.uid||yi.node||!s.getDom())){var l=DK(o,s);this._ticket="";var c=o.dataByCoordSys,a=wNe(o,r,s);if(a){var d=a.el.getBoundingRect().clone();d.applyTransform(a.el.transform),this._tryShow({offsetX:d.x+d.width/2,offsetY:d.y+d.height/2,target:a.el,position:o.position,positionDefault:"bottom"},l)}else if(o.tooltip&&o.x!=null&&o.y!=null){var f=vNe;f.x=o.x,f.y=o.y,f.update(),Yi(f).tooltipConfig={name:null,option:o.tooltip},this._tryShow({offsetX:o.x,offsetY:o.y,target:f},l)}else if(c)this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,dataByCoordSys:c,tooltipOption:o.tooltipOption},l);else if(o.seriesIndex!=null){if(this._manuallyAxisShowTip(t,r,s,o))return;var m=dce(o,r),_=m.point[0],x=m.point[1];_!=null&&x!=null&&this._tryShow({offsetX:_,offsetY:x,target:m.el,position:o.position,positionDefault:"bottom"},l)}else o.x!=null&&o.y!=null&&(s.dispatchAction({type:"updateAxisPointer",x:o.x,y:o.y}),this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,target:s.getZr().findHover(o.x,o.y).target},l))}},e.prototype.manuallyHideTip=function(t,r,s,o){var l=this._tooltipContent;this._tooltipModel&&l.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,o.from!==this.uid&&this._hide(DK(o,s))},e.prototype._manuallyAxisShowTip=function(t,r,s,o){var l=o.seriesIndex,c=o.dataIndex,a=r.getComponent("axisPointer").coordSysAxesInfo;if(!(l==null||c==null||a==null)){var d=r.getSeriesByIndex(l);if(d){var f=d.getData(),m=EA([f.getItemModel(c),d,(d.coordinateSystem||{}).model],this._tooltipModel);if(m.get("trigger")==="axis")return s.dispatchAction({type:"updateAxisPointer",seriesIndex:l,dataIndex:c,position:o.position}),!0}}},e.prototype._tryShow=function(t,r){var s=t.target,o=this._tooltipModel;if(o){this._lastX=t.offsetX,this._lastY=t.offsetY;var l=t.dataByCoordSys;if(l&&l.length)this._showAxisTooltip(l,t);else if(s){var c=Yi(s);if(c.ssrType==="legend")return;this._lastDataByCoordSys=null;var a,d;QA(s,function(f){if(Yi(f).dataIndex!=null)return a=f,!0;if(Yi(f).tooltipConfig!=null)return d=f,!0},!0),a?this._showSeriesItemTooltip(t,a,r):d?this._showComponentItemTooltip(t,d,r):this._hide(r)}else this._lastDataByCoordSys=null,this._hide(r)}},e.prototype._showOrMove=function(t,r){var s=t.get("showDelay");r=Vs(r,this),clearTimeout(this._showTimout),s>0?this._showTimout=setTimeout(r,s):r()},e.prototype._showAxisTooltip=function(t,r){var s=this._ecModel,o=this._tooltipModel,l=[r.offsetX,r.offsetY],c=EA([r.tooltipOption],o),a=this._renderMode,d=[],f=NM("section",{blocks:[],noHeader:!0}),m=[],_=new U3;ot(t,function(L){ot(L.dataByAxis,function(O){var H=s.getComponent(O.axisDim+"Axis",O.axisIndex),q=O.value;if(!(!H||q==null)){var Z=lce(q,H.axis,s,O.seriesDataIndices,O.valueLabelOpt),J=NM("section",{header:Z,noHeader:!cp(Z),sortBlocks:!0,blocks:[]});f.blocks.push(J),ot(O.seriesDataIndices,function(re){var se=s.getSeriesByIndex(re.seriesIndex),ae=re.dataIndexInside,he=se.getDataParams(ae);if(!(he.dataIndex<0)){he.axisDim=O.axisDim,he.axisIndex=O.axisIndex,he.axisType=O.axisType,he.axisId=O.axisId,he.axisValue=o8(H.axis,{value:q}),he.axisValueLabel=Z,he.marker=_.makeTooltipMarker("item",xx(he.color),a);var Ae=wY(se.formatTooltip(ae,!0,null)),Ee=Ae.frag;if(Ee){var Pe=EA([se],o).get("valueFormatter");J.blocks.push(Pe?Qn({valueFormatter:Pe},Ee):Ee)}Ae.text&&m.push(Ae.text),d.push(he)}})}})}),f.blocks.reverse(),m.reverse();var x=r.position,A=c.get("order"),I=EY(f,_,a,A,s.get("useUTC"),c.get("textStyle"));I&&m.unshift(I);var E=a==="richText"?`

`:"<br/>",C=m.join(E);this._showOrMove(c,function(){this._updateContentNotChangedOnAxis(t,d)?this._updatePosition(c,x,l[0],l[1],this._tooltipContent,d):this._showTooltipContent(c,C,d,Math.random()+"",l[0],l[1],x,null,_)})},e.prototype._showSeriesItemTooltip=function(t,r,s){var o=this._ecModel,l=Yi(r),c=l.seriesIndex,a=o.getSeriesByIndex(c),d=l.dataModel||a,f=l.dataIndex,m=l.dataType,_=d.getData(m),x=this._renderMode,A=t.positionDefault,I=EA([_.getItemModel(f),d,a&&(a.coordinateSystem||{}).model],this._tooltipModel,A?{position:A}:null),E=I.get("trigger");if(!(E!=null&&E!=="item")){var C=d.getDataParams(f,m),L=new U3;C.marker=L.makeTooltipMarker("item",xx(C.color),x);var O=wY(d.formatTooltip(f,!1,m)),H=I.get("order"),q=I.get("valueFormatter"),Z=O.frag,J=Z?EY(q?Qn({valueFormatter:q},Z):Z,L,x,H,o.get("useUTC"),I.get("textStyle")):O.text,re="item_"+d.name+"_"+f;this._showOrMove(I,function(){this._showTooltipContent(I,J,C,re,t.offsetX,t.offsetY,t.position,t.target,L)}),s({type:"showTip",dataIndexInside:f,dataIndex:_.getRawIndex(f),seriesIndex:c,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,r,s){var o=this._renderMode==="html",l=Yi(r),c=l.tooltipConfig,a=c.option||{},d=a.encodeHTMLContent;if(Br(a)){var f=a;a={content:f,formatter:f},d=!0}d&&o&&a.content&&(a=wi(a),a.content=Ou(a.content));var m=[a],_=this._ecModel.getComponent(l.componentMainType,l.componentIndex);_&&m.push(_),m.push({formatter:a.content});var x=t.positionDefault,A=EA(m,this._tooltipModel,x?{position:x}:null),I=A.get("content"),E=Math.random()+"",C=new U3;this._showOrMove(A,function(){var L=wi(A.get("formatterParams")||{});this._showTooltipContent(A,I,L,E,t.offsetX,t.offsetY,t.position,r,C)}),s({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,r,s,o,l,c,a,d,f){if(this._ticket="",!(!t.get("showContent")||!t.get("show"))){var m=this._tooltipContent;m.setEnterable(t.get("enterable"));var _=t.get("formatter");a=a||t.get("position");var x=r,A=this._getNearestPoint([l,c],s,t.get("trigger"),t.get("borderColor")),I=A.color;if(_)if(Br(_)){var E=t.ecModel.get("useUTC"),C=fr(s)?s[0]:s,L=C&&C.axisType&&C.axisType.indexOf("time")>=0;x=_,L&&(x=CB(C.axisValue,x,E)),x=Foe(x,s,!0)}else if(hi(_)){var O=Vs(function(H,q){H===this._ticket&&(m.setContent(q,f,t,I,a),this._updatePosition(t,a,l,c,m,s,d))},this);this._ticket=o,x=_(s,o,O)}else x=_;m.setContent(x,f,t,I,a),m.show(t,I),this._updatePosition(t,a,l,c,m,s,d)}},e.prototype._getNearestPoint=function(t,r,s,o){if(s==="axis"||fr(r))return{color:o||(this._renderMode==="html"?"#fff":"none")};if(!fr(r))return{color:o||r.color||r.borderColor}},e.prototype._updatePosition=function(t,r,s,o,l,c,a){var d=this._api.getWidth(),f=this._api.getHeight();r=r||t.get("position");var m=l.getSize(),_=t.get("align"),x=t.get("verticalAlign"),A=a&&a.getBoundingRect().clone();if(a&&A.applyTransform(a.transform),hi(r)&&(r=r([s,o],c,l.el,A,{viewSize:[d,f],contentSize:m.slice()})),fr(r))s=hs(r[0],d),o=hs(r[1],f);else if(qr(r)){var I=r;I.width=m[0],I.height=m[1];var E=I0(I,{width:d,height:f});s=E.x,o=E.y,_=null,x=null}else if(Br(r)&&a){var C=bNe(r,A,m,t.get("borderWidth"));s=C[0],o=C[1]}else{var C=yNe(s,o,l,d,f,_?null:20,x?null:20);s=C[0],o=C[1]}if(_&&(s-=BK(_)?m[0]/2:_==="right"?m[0]:0),x&&(o-=BK(x)?m[1]/2:x==="bottom"?m[1]:0),wce(t)){var C=xNe(s,o,l,d,f);s=C[0],o=C[1]}l.moveTo(s,o)},e.prototype._updateContentNotChangedOnAxis=function(t,r){var s=this._lastDataByCoordSys,o=this._cbParamsList,l=!!s&&s.length===t.length;return l&&ot(s,function(c,a){var d=c.dataByAxis||[],f=t[a]||{},m=f.dataByAxis||[];l=l&&d.length===m.length,l&&ot(d,function(_,x){var A=m[x]||{},I=_.seriesDataIndices||[],E=A.seriesDataIndices||[];l=l&&_.value===A.value&&_.axisType===A.axisType&&_.axisId===A.axisId&&I.length===E.length,l&&ot(I,function(C,L){var O=E[L];l=l&&C.seriesIndex===O.seriesIndex&&C.dataIndex===O.dataIndex}),o&&ot(_.seriesDataIndices,function(C){var L=C.seriesIndex,O=r[L],H=o[L];O&&H&&H.data!==O.data&&(l=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=r,!!l},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,r){yi.node||!r.getDom()||(u5(this,"_updatePosition"),this._tooltipContent.dispose(),D5("itemTooltip",r))},e.type="tooltip",e}(kc);function EA(n,e,t){var r=e.ecModel,s;t?(s=new Do(t,r,r),s=new Do(e.option,s,r)):s=e;for(var o=n.length-1;o>=0;o--){var l=n[o];l&&(l instanceof Do&&(l=l.get("tooltip",!0)),Br(l)&&(l={formatter:l}),l&&(s=new Do(l,s,r)))}return s}function DK(n,e){return n.dispatchAction||Vs(e.dispatchAction,e)}function yNe(n,e,t,r,s,o,l){var c=t.getSize(),a=c[0],d=c[1];return o!=null&&(n+a+o+2>r?n-=a+o:n+=o),l!=null&&(e+d+l>s?e-=d+l:e+=l),[n,e]}function xNe(n,e,t,r,s){var o=t.getSize(),l=o[0],c=o[1];return n=Math.min(n+l,r)-l,e=Math.min(e+c,s)-c,n=Math.max(n,0),e=Math.max(e,0),[n,e]}function bNe(n,e,t,r){var s=t[0],o=t[1],l=Math.ceil(Math.SQRT2*r)+8,c=0,a=0,d=e.width,f=e.height;switch(n){case"inside":c=e.x+d/2-s/2,a=e.y+f/2-o/2;break;case"top":c=e.x+d/2-s/2,a=e.y-o-l;break;case"bottom":c=e.x+d/2-s/2,a=e.y+f+l;break;case"left":c=e.x-s-l,a=e.y+f/2-o/2;break;case"right":c=e.x+d+l,a=e.y+f/2-o/2}return[c,a]}function BK(n){return n==="center"||n==="middle"}function wNe(n,e,t){var r=bG(n).queryOptionMap,s=r.keys()[0];if(!(!s||s==="series")){var o=BC(e,s,r.get(s),{useDefault:!1,enableAll:!1,enableNone:!1}),l=o.models[0];if(l){var c=t.getViewOfComponentModel(l),a;if(c.group.traverse(function(d){var f=Yi(d).tooltipConfig;if(f&&f.name===n.name)return a=d,!0}),a)return{componentMainType:s,componentIndex:l.componentIndex,el:a}}}}function SNe(n){Sp(y8),n.registerComponentModel(sNe),n.registerComponentView(_Ne),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Lc),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Lc)}var ANe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}(cs),TNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,s){if(this.group.removeAll(),!!t.get("show")){var o=this.group,l=t.getModel("textStyle"),c=t.getModel("subtextStyle"),a=t.get("textAlign"),d=Li(t.get("textBaseline"),t.get("textVerticalAlign")),f=new Ra({style:cg(l,{text:t.get("text"),fill:l.getTextColor()},{disableBox:!0}),z2:10}),m=f.getBoundingRect(),_=t.get("subtext"),x=new Ra({style:cg(c,{text:_,fill:c.getTextColor(),y:m.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),A=t.get("link"),I=t.get("sublink"),E=t.get("triggerEvent",!0);f.silent=!A&&!E,x.silent=!I&&!E,A&&f.on("click",function(){iY(A,"_"+t.get("target"))}),I&&x.on("click",function(){iY(I,"_"+t.get("subtarget"))}),Yi(f).eventData=Yi(x).eventData=E?{componentType:"title",componentIndex:t.componentIndex}:null,o.add(f),_&&o.add(x);var C=o.getBoundingRect(),L=t.getBoxLayoutParams();L.width=C.width,L.height=C.height;var O=I0(L,{width:s.getWidth(),height:s.getHeight()},t.get("padding"));a||(a=t.get("left")||t.get("right"),a==="middle"&&(a="center"),a==="right"?O.x+=O.width:a==="center"&&(O.x+=O.width/2)),d||(d=t.get("top")||t.get("bottom"),d==="center"&&(d="middle"),d==="bottom"?O.y+=O.height:d==="middle"&&(O.y+=O.height/2),d=d||"top"),o.x=O.x,o.y=O.y,o.markRedraw();var H={align:a,verticalAlign:d};f.setStyle(H),x.setStyle(H),C=o.getBoundingRect();var q=O.margin,Z=t.getItemStyle(["color","opacity"]);Z.fill=t.get("backgroundColor");var J=new $o({shape:{x:C.x-q[3],y:C.y-q[0],width:C.width+q[1]+q[3],height:C.height+q[0]+q[2],r:t.get("borderRadius")},style:Z,subPixelOptimize:!0,silent:!0});o.add(J)}},e.type="title",e}(kc);function MNe(n){n.registerComponentModel(ANe),n.registerComponentView(TNe)}var CNe=function(n,e){if(e==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(e==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},F5=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.prototype.init=function(t,r,s){this.mergeDefaultAndTheme(t,s),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),this._updateSelector(t)},e.prototype._updateSelector=function(t){var r=t.selector,s=this.ecModel;r===!0&&(r=t.selector=["all","inverse"]),fr(r)&&ot(r,function(o,l){Br(o)&&(o={type:o}),r[l]=Fi(o,CNe(s,o.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var r=!1,s=0;s<t.length;s++){var o=t[s].get("name");if(this.isSelected(o)){this.select(o),r=!0;break}}!r&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var r=[],s=[];t.eachRawSeries(function(a){var d=a.name;s.push(d);var f;if(a.legendVisualProvider){var m=a.legendVisualProvider,_=m.getAllNames();t.isSeriesFiltered(a)||(s=s.concat(_)),_.length?r=r.concat(_):f=!0}else f=!0;f&&xG(a)&&r.push(a.name)}),this._availableNames=s;var o=this.get("data")||r,l=oi(),c=br(o,function(a){return(Br(a)||Ds(a))&&(a={name:a}),l.get(a.name)?null:(l.set(a.name,!0),new Do(a,this,this.ecModel))},this);this._data=sa(c,function(a){return!!a})},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var r=this.option.selected,s=this.get("selectedMode");if(s==="single"){var o=this._data;ot(o,function(l){r[l.get("name")]=!1})}r[t]=!0},e.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var r=this.option.selected;r.hasOwnProperty(t)||(r[t]=!0),this[r[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,r=this.option.selected;ot(t,function(s){r[s.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this._data,r=this.option.selected;ot(t,function(s){var o=s.get("name",!0);r.hasOwnProperty(o)||(r[o]=!0),r[o]=!r[o]})},e.prototype.isSelected=function(t){var r=this.option.selected;return!(r.hasOwnProperty(t)&&!r[t])&&Zi(this._availableNames,t)>=0},e.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(cs),rb=xs,N5=ot,VI=_a,Mce=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!1,t}return e.prototype.init=function(){this.group.add(this._contentGroup=new VI),this.group.add(this._selectorGroup=new VI),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,r,s){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var l=t.get("align"),c=t.get("orient");(!l||l==="auto")&&(l=t.get("left")==="right"&&c==="vertical"?"right":"left");var a=t.get("selector",!0),d=t.get("selectorPosition",!0);a&&(!d||d==="auto")&&(d=c==="horizontal"?"end":"start"),this.renderInner(l,t,r,s,a,c,d);var f=t.getBoxLayoutParams(),m={width:s.getWidth(),height:s.getHeight()},_=t.get("padding"),x=I0(f,m,_),A=this.layoutInner(t,l,x,o,a,d),I=I0(ri({width:A.width,height:A.height},f),m,_);this.group.x=I.x-A.x,this.group.y=I.y-A.y,this.group.markRedraw(),this.group.add(this._backgroundEl=_ce(A,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,r,s,o,l,c,a){var d=this.getContentGroup(),f=oi(),m=r.get("selectedMode"),_=[];s.eachRawSeries(function(x){!x.get("legendHoverLink")&&_.push(x.id)}),N5(r.getData(),function(x,A){var I=x.get("name");if(!this.newlineDisabled&&(I===""||I===`
`)){var E=new VI;E.newline=!0,d.add(E);return}var C=s.getSeriesByName(I)[0];if(!f.get(I))if(C){var L=C.getData(),O=L.getVisual("legendLineStyle")||{},H=L.getVisual("legendIcon"),q=L.getVisual("style"),Z=this._createItem(C,I,A,x,r,t,O,q,H,m,o);Z.on("click",rb(kK,I,null,o,_)).on("mouseover",rb(z5,C.name,null,o,_)).on("mouseout",rb(U5,C.name,null,o,_)),s.ssr&&Z.eachChild(function(J){var re=Yi(J);re.seriesIndex=C.seriesIndex,re.dataIndex=A,re.ssrType="legend"}),f.set(I,!0)}else s.eachRawSeries(function(J){if(!f.get(I)&&J.legendVisualProvider){var re=J.legendVisualProvider;if(!re.containName(I))return;var se=re.indexOfName(I),ae=re.getItemVisual(se,"style"),he=re.getItemVisual(se,"legendIcon"),Ae=Xm(ae.fill);Ae&&Ae[3]===0&&(Ae[3]=.2,ae=Qn(Qn({},ae),{fill:uB(Ae,"rgba")}));var Ee=this._createItem(J,I,A,x,r,t,{},ae,he,m,o);Ee.on("click",rb(kK,null,I,o,_)).on("mouseover",rb(z5,null,I,o,_)).on("mouseout",rb(U5,null,I,o,_)),s.ssr&&Ee.eachChild(function(Pe){var ze=Yi(Pe);ze.seriesIndex=J.seriesIndex,ze.dataIndex=A,ze.ssrType="legend"}),f.set(I,!0)}},this)},this),l&&this._createSelector(l,r,o,c,a)},e.prototype._createSelector=function(t,r,s,o,l){var c=this.getSelectorGroup();N5(t,function(d){var f=d.type,m=new Ra({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){s.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});c.add(m);var _=r.getModel("selectorLabel"),x=r.getModel(["emphasis","selectorLabel"]);kC(m,{normal:_,emphasis:x},{defaultText:d.title}),Kz(m)})},e.prototype._createItem=function(t,r,s,o,l,c,a,d,f,m,_){var x=t.visualDrawType,A=l.get("itemWidth"),I=l.get("itemHeight"),E=l.isSelected(r),C=o.get("symbolRotate"),L=o.get("symbolKeepAspect"),O=o.get("icon");f=O||f||"roundRect";var H=ENe(f,o,a,d,x,E,_),q=new VI,Z=o.getModel("textStyle");if(hi(t.getLegendIcon)&&(!O||O==="inherit"))q.add(t.getLegendIcon({itemWidth:A,itemHeight:I,icon:f,iconRotate:C,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}));else{var J=O==="inherit"&&t.getData().getVisual("symbol")?C==="inherit"?t.getData().getVisual("symbolRotate"):C:0;q.add(INe({itemWidth:A,itemHeight:I,icon:f,iconRotate:J,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}))}var re=c==="left"?A+5:-5,se=c,ae=l.get("formatter"),he=r;Br(ae)&&ae?he=ae.replace("{name}",r??""):hi(ae)&&(he=ae(r));var Ae=E?Z.getTextColor():o.get("inactiveColor");q.add(new Ra({style:cg(Z,{text:he,x:re,y:I/2,fill:Ae,align:se,verticalAlign:"middle"},{inheritColor:Ae})}));var Ee=new $o({shape:q.getBoundingRect(),style:{fill:"transparent"}}),Pe=o.getModel("tooltip");return Pe.get("show")&&AB({el:Ee,componentModel:l,itemName:r,itemTooltipOption:Pe.option}),q.add(Ee),q.eachChild(function(ze){ze.silent=!0}),Ee.silent=!m,this.getContentGroup().add(q),Kz(q),q.__legendDataIndex=s,q},e.prototype.layoutInner=function(t,r,s,o,l,c){var a=this.getContentGroup(),d=this.getSelectorGroup();iw(t.get("orient"),a,t.get("itemGap"),s.width,s.height);var f=a.getBoundingRect(),m=[-f.x,-f.y];if(d.markRedraw(),a.markRedraw(),l){iw("horizontal",d,t.get("selectorItemGap",!0));var _=d.getBoundingRect(),x=[-_.x,-_.y],A=t.get("selectorButtonGap",!0),I=t.getOrient().index,E=I===0?"width":"height",C=I===0?"height":"width",L=I===0?"y":"x";c==="end"?x[I]+=f[E]+A:m[I]+=_[E]+A,x[1-I]+=f[C]/2-_[C]/2,d.x=x[0],d.y=x[1],a.x=m[0],a.y=m[1];var O={x:0,y:0};return O[E]=f[E]+A+_[E],O[C]=Math.max(f[C],_[C]),O[L]=Math.min(0,_[L]+x[1-I]),O}else return a.x=m[0],a.y=m[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(kc);function ENe(n,e,t,r,s,o,l){function c(E,C){E.lineWidth==="auto"&&(E.lineWidth=C.lineWidth>0?2:0),N5(E,function(L,O){E[O]==="inherit"&&(E[O]=C[O])})}var a=e.getModel("itemStyle"),d=a.getItemStyle(),f=n.lastIndexOf("empty",0)===0?"fill":"stroke",m=a.getShallow("decal");d.decal=!m||m==="inherit"?r.decal:m5(m,l),d.fill==="inherit"&&(d.fill=r[s]),d.stroke==="inherit"&&(d.stroke=r[f]),d.opacity==="inherit"&&(d.opacity=(s==="fill"?r:t).opacity),c(d,r);var _=e.getModel("lineStyle"),x=_.getLineStyle();if(c(x,t),d.fill==="auto"&&(d.fill=r.fill),d.stroke==="auto"&&(d.stroke=r.fill),x.stroke==="auto"&&(x.stroke=r.fill),!o){var A=e.get("inactiveBorderWidth"),I=d[f];d.lineWidth=A==="auto"?r.lineWidth>0&&I?2:0:d.lineWidth,d.fill=e.get("inactiveColor"),d.stroke=e.get("inactiveBorderColor"),x.stroke=_.get("inactiveColor"),x.lineWidth=_.get("inactiveWidth")}return{itemStyle:d,lineStyle:x}}function INe(n){var e=n.icon||"roundRect",t=Mw(e,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),e.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill="#fff",t.style.lineWidth=2),t}function kK(n,e,t,r){U5(n,e,t,r),t.dispatchAction({type:"legendToggleSelect",name:n??e}),z5(n,e,t,r)}function Cce(n){for(var e=n.getZr().storage.getDisplayList(),t,r=0,s=e.length;r<s&&!(t=e[r].states.emphasis);)r++;return t&&t.hoverLayer}function z5(n,e,t,r){Cce(t)||t.dispatchAction({type:"highlight",seriesName:n,name:e,excludeSeriesId:r})}function U5(n,e,t,r){Cce(t)||t.dispatchAction({type:"downplay",seriesName:n,name:e,excludeSeriesId:r})}function PNe(n){var e=n.findComponents({mainType:"legend"});e&&e.length&&n.filterSeries(function(t){for(var r=0;r<e.length;r++)if(!e[r].isSelected(t.name))return!1;return!0})}function IA(n,e,t){var r={},s=n==="toggleSelected",o;return t.eachComponent("legend",function(l){s&&o!=null?l[o?"select":"unSelect"](e.name):n==="allSelect"||n==="inverseSelect"?l[n]():(l[n](e.name),o=l.isSelected(e.name));var c=l.getData();ot(c,function(a){var d=a.get("name");if(!(d===`
`||d==="")){var f=l.isSelected(d);r.hasOwnProperty(d)?r[d]=r[d]&&f:r[d]=f}})}),n==="allSelect"||n==="inverseSelect"?{selected:r}:{name:e.name,selected:r}}function RNe(n){n.registerAction("legendToggleSelect","legendselectchanged",xs(IA,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",xs(IA,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",xs(IA,"inverseSelect")),n.registerAction("legendSelect","legendselected",xs(IA,"select")),n.registerAction("legendUnSelect","legendunselected",xs(IA,"unSelect"))}function Ece(n){n.registerComponentModel(F5),n.registerComponentView(Mce),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,PNe),n.registerSubTypeDefaulter("legend",function(){return"plain"}),RNe(n)}var LNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(t,r,s){var o=DB(t);n.prototype.init.call(this,t,r,s),OK(this,t,o)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),OK(this,this.option,t)},e.type="legend.scroll",e.defaultOption=Aoe(F5.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(F5);function OK(n,e,t){var r=n.getOrient(),s=[1,1];s[r.index]=0,Aw(e,t,{type:"box",ignoreSize:!!s})}var FK=_a,mN=["width","height"],gN=["x","y"],DNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!0,t._currentIndex=0,t}return e.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new FK),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new FK)},e.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(t,r,s,o,l,c,a){var d=this;n.prototype.renderInner.call(this,t,r,s,o,l,c,a);var f=this._controllerGroup,m=r.get("pageIconSize",!0),_=fr(m)?m:[m,m];A("pagePrev",0);var x=r.getModel("pageTextStyle");f.add(new Ra({name:"pageText",style:{text:"xx/xx",fill:x.getTextColor(),font:x.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),A("pageNext",1);function A(I,E){var C=I+"DataIndex",L=SB(r.get("pageIcons",!0)[r.getOrient().name][E],{onclick:Vs(d._pageGo,d,C,r,o)},{x:-_[0]/2,y:-_[1]/2,width:_[0],height:_[1]});L.name=I,f.add(L)}},e.prototype.layoutInner=function(t,r,s,o,l,c){var a=this.getSelectorGroup(),d=t.getOrient().index,f=mN[d],m=gN[d],_=mN[1-d],x=gN[1-d];l&&iw("horizontal",a,t.get("selectorItemGap",!0));var A=t.get("selectorButtonGap",!0),I=a.getBoundingRect(),E=[-I.x,-I.y],C=wi(s);l&&(C[f]=s[f]-I[f]-A);var L=this._layoutContentAndController(t,o,C,d,f,_,x,m);if(l){if(c==="end")E[d]+=L[f]+A;else{var O=I[f]+A;E[d]-=O,L[m]-=O}L[f]+=I[f]+A,E[1-d]+=L[x]+L[_]/2-I[_]/2,L[_]=Math.max(L[_],I[_]),L[x]=Math.min(L[x],I[x]+E[1-d]),a.x=E[0],a.y=E[1],a.markRedraw()}return L},e.prototype._layoutContentAndController=function(t,r,s,o,l,c,a,d){var f=this.getContentGroup(),m=this._containerGroup,_=this._controllerGroup;iw(t.get("orient"),f,t.get("itemGap"),o?s.width:null,o?null:s.height),iw("horizontal",_,t.get("pageButtonItemGap",!0));var x=f.getBoundingRect(),A=_.getBoundingRect(),I=this._showController=x[l]>s[l],E=[-x.x,-x.y];r||(E[o]=f[d]);var C=[0,0],L=[-A.x,-A.y],O=Li(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(I){var H=t.get("pageButtonPosition",!0);H==="end"?L[o]+=s[l]-A[l]:C[o]+=A[l]+O}L[1-o]+=x[c]/2-A[c]/2,f.setPosition(E),m.setPosition(C),_.setPosition(L);var q={x:0,y:0};if(q[l]=I?s[l]:x[l],q[c]=Math.max(x[c],A[c]),q[a]=Math.min(0,A[a]+L[1-o]),m.__rectSize=s[l],I){var Z={x:0,y:0};Z[l]=Math.max(s[l]-A[l]-O,0),Z[c]=q[c],m.setClipPath(new $o({shape:Z})),m.__rectSize=Z[l]}else _.eachChild(function(re){re.attr({invisible:!0,silent:!0})});var J=this._getPageInfo(t);return J.pageIndex!=null&&cl(f,{x:J.contentPosition[0],y:J.contentPosition[1]},I?t:null),this._updatePageInfoView(t,J),q},e.prototype._pageGo=function(t,r,s){var o=this._getPageInfo(r)[t];o!=null&&s.dispatchAction({type:"legendScroll",scrollDataIndex:o,legendId:r.id})},e.prototype._updatePageInfoView=function(t,r){var s=this._controllerGroup;ot(["pagePrev","pageNext"],function(f){var m=f+"DataIndex",_=r[m]!=null,x=s.childOfName(f);x&&(x.setStyle("fill",_?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),x.cursor=_?"pointer":"default")});var o=s.childOfName("pageText"),l=t.get("pageFormatter"),c=r.pageIndex,a=c!=null?c+1:0,d=r.pageCount;o&&l&&o.setStyle("text",Br(l)?l.replace("{current}",a==null?"":a+"").replace("{total}",d==null?"":d+""):l({current:a,total:d}))},e.prototype._getPageInfo=function(t){var r=t.get("scrollDataIndex",!0),s=this.getContentGroup(),o=this._containerGroup.__rectSize,l=t.getOrient().index,c=mN[l],a=gN[l],d=this._findTargetItemIndex(r),f=s.children(),m=f[d],_=f.length,x=_?1:0,A={contentPosition:[s.x,s.y],pageCount:x,pageIndex:x-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!m)return A;var I=H(m);A.contentPosition[l]=-I.s;for(var E=d+1,C=I,L=I,O=null;E<=_;++E)O=H(f[E]),(!O&&L.e>C.s+o||O&&!q(O,C.s))&&(L.i>C.i?C=L:C=O,C&&(A.pageNextDataIndex==null&&(A.pageNextDataIndex=C.i),++A.pageCount)),L=O;for(var E=d-1,C=I,L=I,O=null;E>=-1;--E)O=H(f[E]),(!O||!q(L,O.s))&&C.i<L.i&&(L=C,A.pagePrevDataIndex==null&&(A.pagePrevDataIndex=C.i),++A.pageCount,++A.pageIndex),C=O;return A;function H(Z){if(Z){var J=Z.getBoundingRect(),re=J[a]+Z[a];return{s:re,e:re+J[c],i:Z.__legendDataIndex}}}function q(Z,J){return Z.e>=J&&Z.s<=J+o}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var r,s=this.getContentGroup(),o;return s.eachChild(function(l,c){var a=l.__legendDataIndex;o==null&&a!=null&&(o=c),a===t&&(r=c)}),r??o},e.type="legend.scroll",e}(Mce);function BNe(n){n.registerAction("legendScroll","legendscroll",function(e,t){var r=e.scrollDataIndex;r!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(s){s.setScrollDataIndex(r)})})}function kNe(n){Sp(Ece),n.registerComponentModel(LNe),n.registerComponentView(DNe),BNe(n)}function ONe(n){Sp(Ece),Sp(kNe)}var NK={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},FNe=function(){function n(e){var t=this._condVal=Br(e)?new RegExp(e):HCe(e)?e:null;if(t==null){var r="";us(r)}}return n.prototype.evaluate=function(e){var t=typeof e;return Br(t)?this._condVal.test(e):Ds(t)?this._condVal.test(e+""):!1},n}(),NNe=function(){function n(){}return n.prototype.evaluate=function(){return this.value},n}(),zNe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(!e[t].evaluate())return!1;return!0},n}(),UNe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(e[t].evaluate())return!0;return!1},n}(),GNe=function(){function n(){}return n.prototype.evaluate=function(){return!this.child.evaluate()},n}(),VNe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=!!this.valueParser,t=this.getValue,r=t(this.valueGetterParam),s=e?this.valueParser(r):null,o=0;o<this.subCondList.length;o++)if(!this.subCondList[o].evaluate(e?s:r))return!1;return!0},n}();function M8(n,e){if(n===!0||n===!1){var t=new NNe;return t.value=n,t}var r="";return Ice(n)||us(r),n.and?zK("and",n,e):n.or?zK("or",n,e):n.not?HNe(n,e):jNe(n,e)}function zK(n,e,t){var r=e[n],s="";fr(r)||us(s),r.length||us(s);var o=n==="and"?new zNe:new UNe;return o.children=br(r,function(l){return M8(l,t)}),o.children.length||us(s),o}function HNe(n,e){var t=n.not,r="";Ice(t)||us(r);var s=new GNe;return s.child=M8(t,e),s.child||us(r),s}function jNe(n,e){for(var t="",r=e.prepareGetValue(n),s=[],o=lo(n),l=n.parser,c=l?eae(l):null,a=0;a<o.length;a++){var d=o[a];if(!(d==="parser"||e.valueGetterAttrMap.get(d))){var f=og(NK,d)?NK[d]:d,m=n[d],_=c?c(m):m,x=JRe(f,_)||f==="reg"&&new FNe(_);x||us(t),s.push(x)}}s.length||us(t);var A=new VNe;return A.valueGetterParam=r,A.valueParser=c,A.getValue=e.getValue,A.subCondList=s,A}function Ice(n){return qr(n)&&!Dc(n)}var WNe=function(){function n(e,t){this._cond=M8(e,t)}return n.prototype.evaluate=function(){return this._cond.evaluate()},n}();function $Ne(n,e){return new WNe(n,e)}var XNe={type:"echarts:filter",transform:function(n){for(var e=n.upstream,t,r=$Ne(n.config,{valueGetterAttrMap:oi({dimension:!0}),prepareGetValue:function(c){var a="",d=c.dimension;og(c,"dimension")||us(a);var f=e.getDimensionInfo(d);return f||us(a),{dimIdx:f.index}},getValue:function(c){return e.retrieveValueFromItem(t,c.dimIdx)}}),s=[],o=0,l=e.count();o<l;o++)t=e.getRawDataItem(o),r.evaluate()&&s.push(t);return{data:s}}},qNe={type:"echarts:sort",transform:function(n){var e=n.upstream,t=n.config,r="",s=va(t);s.length||us(r);var o=[];ot(s,function(f){var m=f.dimension,_=f.order,x=f.parser,A=f.incomparable;if(m==null&&us(r),_!=="asc"&&_!=="desc"&&us(r),A&&A!=="min"&&A!=="max"){var I="";us(I)}if(_!=="asc"&&_!=="desc"){var E="";us(E)}var C=e.getDimensionInfo(m);C||us(r);var L=x?eae(x):null;x&&!L&&us(r),o.push({dimIdx:C.index,parser:L,comparator:new nae(_,A)})});var l=e.sourceFormat;l!==Bc&&l!==Wh&&us(r);for(var c=[],a=0,d=e.count();a<d;a++)c.push(e.getRawDataItem(a));return c.sort(function(f,m){for(var _=0;_<o.length;_++){var x=o[_],A=e.retrieveValueFromItem(f,x.dimIdx),I=e.retrieveValueFromItem(m,x.dimIdx);x.parser&&(A=x.parser(A),I=x.parser(I));var E=x.comparator.evaluate(A,I);if(E!==0)return E}return 0}),{data:c}}};function YNe(n){n.registerTransform(XNe),n.registerTransform(qNe)}var ZNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.prototype.init=function(t,r,s){n.prototype.init.call(this,t,r,s),this._sourceManager=new oae(this),MY(this)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),MY(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:_p},e}(cs),KNe=function(n){jn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.type="dataset",e}(kc);function JNe(n){n.registerComponentModel(ZNe),n.registerComponentView(KNe)}var tp=lg.CMD;function Gb(n,e){return Math.abs(n-e)<1e-5}function G5(n){var e=n.data,t=n.len(),r=[],s,o=0,l=0,c=0,a=0;function d(Ee,Pe){s&&s.length>2&&r.push(s),s=[Ee,Pe]}function f(Ee,Pe,ze,Re){Gb(Ee,ze)&&Gb(Pe,Re)||s.push(Ee,Pe,ze,Re,ze,Re)}function m(Ee,Pe,ze,Re,rt,ye){var We=Math.abs(Pe-Ee),Ue=Math.tan(We/4)*4/3,gt=Pe<Ee?-1:1,vt=Math.cos(Ee),Dt=Math.sin(Ee),lt=Math.cos(Pe),jt=Math.sin(Pe),Qt=vt*rt+ze,nn=Dt*ye+Re,Wn=lt*rt+ze,kn=jt*ye+Re,Mn=rt*Ue*gt,De=ye*Ue*gt;s.push(Qt-Mn*Dt,nn+De*vt,Wn+Mn*jt,kn-De*lt,Wn,kn)}for(var _,x,A,I,E=0;E<t;){var C=e[E++],L=E===1;switch(L&&(o=e[E],l=e[E+1],c=o,a=l,(C===tp.L||C===tp.C||C===tp.Q)&&(s=[c,a])),C){case tp.M:o=c=e[E++],l=a=e[E++],d(c,a);break;case tp.L:_=e[E++],x=e[E++],f(o,l,_,x),o=_,l=x;break;case tp.C:s.push(e[E++],e[E++],e[E++],e[E++],o=e[E++],l=e[E++]);break;case tp.Q:_=e[E++],x=e[E++],A=e[E++],I=e[E++],s.push(o+2/3*(_-o),l+2/3*(x-l),A+2/3*(_-A),I+2/3*(x-I),A,I),o=A,l=I;break;case tp.A:var O=e[E++],H=e[E++],q=e[E++],Z=e[E++],J=e[E++],re=e[E++]+J;E+=1;var se=!e[E++];_=Math.cos(J)*q+O,x=Math.sin(J)*Z+H,L?(c=_,a=x,d(c,a)):f(o,l,_,x),o=Math.cos(re)*q+O,l=Math.sin(re)*Z+H;for(var ae=(se?-1:1)*Math.PI/2,he=J;se?he>re:he<re;he+=ae){var Ae=se?Math.max(he+ae,re):Math.min(he+ae,re);m(he,Ae,O,H,q,Z)}break;case tp.R:c=o=e[E++],a=l=e[E++],_=c+e[E++],x=a+e[E++],d(_,a),f(_,a,_,x),f(_,x,c,x),f(c,x,c,a),f(c,a,_,a);break;case tp.Z:s&&f(o,l,c,a),o=c,l=a;break}}return s&&s.length>2&&r.push(s),r}function V5(n,e,t,r,s,o,l,c,a,d){if(Gb(n,t)&&Gb(e,r)&&Gb(s,l)&&Gb(o,c)){a.push(l,c);return}var f=2/d,m=f*f,_=l-n,x=c-e,A=Math.sqrt(_*_+x*x);_/=A,x/=A;var I=t-n,E=r-e,C=s-l,L=o-c,O=I*I+E*E,H=C*C+L*L;if(O<m&&H<m){a.push(l,c);return}var q=_*I+x*E,Z=-_*C-x*L,J=O-q*q,re=H-Z*Z;if(J<m&&q>=0&&re<m&&Z>=0){a.push(l,c);return}var se=[],ae=[];M0(n,t,s,l,.5,se),M0(e,r,o,c,.5,ae),V5(se[0],ae[0],se[1],ae[1],se[2],ae[2],se[3],ae[3],a,d),V5(se[4],ae[4],se[5],ae[5],se[6],ae[6],se[7],ae[7],a,d)}function QNe(n,e){var t=G5(n),r=[];e=e||1;for(var s=0;s<t.length;s++){var o=t[s],l=[],c=o[0],a=o[1];l.push(c,a);for(var d=2;d<o.length;){var f=o[d++],m=o[d++],_=o[d++],x=o[d++],A=o[d++],I=o[d++];V5(c,a,f,m,_,x,A,I,l,e),c=A,a=I}r.push(l)}return r}function Pce(n,e,t){var r=n[e],s=n[1-e],o=Math.abs(r/s),l=Math.ceil(Math.sqrt(o*t)),c=Math.floor(t/l);c===0&&(c=1,l=t);for(var a=[],d=0;d<l;d++)a.push(c);var f=l*c,m=t-f;if(m>0)for(var d=0;d<m;d++)a[d%l]+=1;return a}function UK(n,e,t){for(var r=n.r0,s=n.r,o=n.startAngle,l=n.endAngle,c=Math.abs(l-o),a=c*s,d=s-r,f=a>Math.abs(d),m=Pce([a,d],f?0:1,e),_=(f?c:d)/m.length,x=0;x<m.length;x++)for(var A=(f?d:c)/m[x],I=0;I<m[x];I++){var E={};f?(E.startAngle=o+_*x,E.endAngle=o+_*(x+1),E.r0=r+A*I,E.r=r+A*(I+1)):(E.startAngle=o+A*I,E.endAngle=o+A*(I+1),E.r0=r+_*x,E.r=r+_*(x+1)),E.clockwise=n.clockwise,E.cx=n.cx,E.cy=n.cy,t.push(E)}}function e4e(n,e,t){for(var r=n.width,s=n.height,o=r>s,l=Pce([r,s],o?0:1,e),c=o?"width":"height",a=o?"height":"width",d=o?"x":"y",f=o?"y":"x",m=n[c]/l.length,_=0;_<l.length;_++)for(var x=n[a]/l[_],A=0;A<l[_];A++){var I={};I[d]=_*m,I[f]=A*x,I[c]=m,I[a]=x,I.x+=n.x,I.y+=n.y,t.push(I)}}function GK(n,e,t,r){return n*r-t*e}function t4e(n,e,t,r,s,o,l,c){var a=t-n,d=r-e,f=l-s,m=c-o,_=GK(f,m,a,d);if(Math.abs(_)<1e-6)return null;var x=n-s,A=e-o,I=GK(x,A,f,m)/_;return I<0||I>1?null:new ei(I*a+n,I*d+e)}function n4e(n,e,t){var r=new ei;ei.sub(r,t,e),r.normalize();var s=new ei;ei.sub(s,n,e);var o=s.dot(r);return o}function ib(n,e){var t=n[n.length-1];t&&t[0]===e[0]&&t[1]===e[1]||n.push(e)}function r4e(n,e,t){for(var r=n.length,s=[],o=0;o<r;o++){var l=n[o],c=n[(o+1)%r],a=t4e(l[0],l[1],c[0],c[1],e.x,e.y,t.x,t.y);a&&s.push({projPt:n4e(a,e,t),pt:a,idx:o})}if(s.length<2)return[{points:n},{points:n}];s.sort(function(E,C){return E.projPt-C.projPt});var d=s[0],f=s[s.length-1];if(f.idx<d.idx){var m=d;d=f,f=m}for(var _=[d.pt.x,d.pt.y],x=[f.pt.x,f.pt.y],A=[_],I=[x],o=d.idx+1;o<=f.idx;o++)ib(A,n[o].slice());ib(A,x),ib(A,_);for(var o=f.idx+1;o<=d.idx+r;o++)ib(I,n[o%r].slice());return ib(I,_),ib(I,x),[{points:A},{points:I}]}function VK(n){var e=n.points,t=[],r=[];kse(e,t,r);var s=new ds(t[0],t[1],r[0]-t[0],r[1]-t[1]),o=s.width,l=s.height,c=s.x,a=s.y,d=new ei,f=new ei;return o>l?(d.x=f.x=c+o/2,d.y=a,f.y=a+l):(d.y=f.y=a+l/2,d.x=c,f.x=c+o),r4e(e,d,f)}function RL(n,e,t,r){if(t===1)r.push(e);else{var s=Math.floor(t/2),o=n(e);RL(n,o[0],s,r),RL(n,o[1],t-s,r)}return r}function i4e(n,e){for(var t=[],r=0;r<e;r++)t.push(CG(n));return t}function s4e(n,e){e.setStyle(n.style),e.z=n.z,e.z2=n.z2,e.zlevel=n.zlevel}function o4e(n){for(var e=[],t=0;t<n.length;)e.push([n[t++],n[t++]]);return e}function a4e(n,e){var t=[],r=n.shape,s;switch(n.type){case"rect":e4e(r,e,t),s=$o;break;case"sector":UK(r,e,t),s=Hh;break;case"circle":UK({r0:0,r:r.r,startAngle:0,endAngle:Math.PI*2,cx:r.cx,cy:r.cy},e,t),s=Hh;break;default:var o=n.getComputedTransform(),l=o?Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1],o[2]*o[2]+o[3]*o[3])):1,c=br(QNe(n.getUpdatedPathProxy(),l),function(C){return o4e(C)}),a=c.length;if(a===0)RL(VK,{points:c[0]},e,t);else if(a===e)for(var d=0;d<a;d++)t.push({points:c[d]});else{var f=0,m=br(c,function(C){var L=[],O=[];kse(C,L,O);var H=(O[1]-L[1])*(O[0]-L[0]);return f+=H,{poly:C,area:H}});m.sort(function(C,L){return L.area-C.area});for(var _=e,d=0;d<a;d++){var x=m[d];if(_<=0)break;var A=d===a-1?_:Math.ceil(x.area/f*e);A<0||(RL(VK,{points:x.poly},A,t),_-=A)}}s=yB;break}if(!s)return i4e(n,e);for(var I=[],d=0;d<t.length;d++){var E=new s;E.setShape(t[d]),s4e(n,E),I.push(E)}return I}function l4e(n,e){var t=n.length,r=e.length;if(t===r)return[n,e];for(var s=[],o=[],l=t<r?n:e,c=Math.min(t,r),a=Math.abs(r-t)/6,d=(c-2)/6,f=Math.ceil(a/d)+1,m=[l[0],l[1]],_=a,x=2;x<c;){var A=l[x-2],I=l[x-1],E=l[x++],C=l[x++],L=l[x++],O=l[x++],H=l[x++],q=l[x++];if(_<=0){m.push(E,C,L,O,H,q);continue}for(var Z=Math.min(_,f-1)+1,J=1;J<=Z;J++){var re=J/Z;M0(A,E,L,H,re,s),M0(I,C,O,q,re,o),A=s[3],I=o[3],m.push(s[1],o[1],s[2],o[2],A,I),E=s[5],C=o[5],L=s[6],O=o[6]}_-=Z-1}return l===n?[m,e]:[n,m]}function HK(n,e){for(var t=n.length,r=n[t-2],s=n[t-1],o=[],l=0;l<e.length;)o[l++]=r,o[l++]=s;return o}function c4e(n,e){for(var t,r,s,o=[],l=[],c=0;c<Math.max(n.length,e.length);c++){var a=n[c],d=e[c],f=void 0,m=void 0;a?d?(t=l4e(a,d),f=t[0],m=t[1],r=f,s=m):(m=HK(s||a,a),f=a):(f=HK(r||d,d),m=d),o.push(f),l.push(m)}return[o,l]}function jK(n){for(var e=0,t=0,r=0,s=n.length,o=0,l=s-2;o<s;l=o,o+=2){var c=n[l],a=n[l+1],d=n[o],f=n[o+1],m=c*f-d*a;e+=m,t+=(c+d)*m,r+=(a+f)*m}return e===0?[n[0]||0,n[1]||0]:[t/e/3,r/e/3,e]}function u4e(n,e,t,r){for(var s=(n.length-2)/6,o=1/0,l=0,c=n.length,a=c-2,d=0;d<s;d++){for(var f=d*6,m=0,_=0;_<c;_+=2){var x=_===0?f:(f+_-2)%a+2,A=n[x]-t[0],I=n[x+1]-t[1],E=e[_]-r[0],C=e[_+1]-r[1],L=E-A,O=C-I;m+=L*L+O*O}m<o&&(o=m,l=d)}return l}function h4e(n){for(var e=[],t=n.length,r=0;r<t;r+=2)e[r]=n[t-r-2],e[r+1]=n[t-r-1];return e}function d4e(n,e,t,r){for(var s=[],o,l=0;l<n.length;l++){var c=n[l],a=e[l],d=jK(c),f=jK(a);o==null&&(o=d[2]<0!=f[2]<0);var m=[],_=[],x=0,A=1/0,I=[],E=c.length;o&&(c=h4e(c));for(var C=u4e(c,a,d,f)*6,L=E-2,O=0;O<L;O+=2){var H=(C+O)%L+2;m[O+2]=c[H]-d[0],m[O+3]=c[H+1]-d[1]}m[0]=c[C]-d[0],m[1]=c[C+1]-d[1];for(var q=r/t,Z=-r/2;Z<=r/2;Z+=q){for(var J=Math.sin(Z),re=Math.cos(Z),se=0,O=0;O<c.length;O+=2){var ae=m[O],he=m[O+1],Ae=a[O]-f[0],Ee=a[O+1]-f[1],Pe=Ae*re-Ee*J,ze=Ae*J+Ee*re;I[O]=Pe,I[O+1]=ze;var Re=Pe-ae,rt=ze-he;se+=Re*Re+rt*rt}if(se<A){A=se,x=Z;for(var ye=0;ye<I.length;ye++)_[ye]=I[ye]}}s.push({from:m,to:_,fromCp:d,toCp:f,rotation:-x})}return s}function LL(n){return n.__isCombineMorphing}var Rce="__mOriginal_";function DL(n,e,t){var r=Rce+e,s=n[r]||n[e];n[r]||(n[r]=n[e]);var o=t.replace,l=t.after,c=t.before;n[e]=function(){var a=arguments,d;return c&&c.apply(this,a),o?d=o.apply(this,a):d=s.apply(this,a),l&&l.apply(this,a),d}}function UT(n,e){var t=Rce+e;n[t]&&(n[e]=n[t],n[t]=null)}function WK(n,e){for(var t=0;t<n.length;t++)for(var r=n[t],s=0;s<r.length;){var o=r[s],l=r[s+1];r[s++]=e[0]*o+e[2]*l+e[4],r[s++]=e[1]*o+e[3]*l+e[5]}}function Lce(n,e){var t=n.getUpdatedPathProxy(),r=e.getUpdatedPathProxy(),s=c4e(G5(t),G5(r)),o=s[0],l=s[1],c=n.getComputedTransform(),a=e.getComputedTransform();function d(){this.transform=null}c&&WK(o,c),a&&WK(l,a),DL(e,"updateTransform",{replace:d}),e.transform=null;var f=d4e(o,l,10,Math.PI),m=[];DL(e,"buildPath",{replace:function(_){for(var x=e.__morphT,A=1-x,I=[],E=0;E<f.length;E++){var C=f[E],L=C.from,O=C.to,H=C.rotation*x,q=C.fromCp,Z=C.toCp,J=Math.sin(H),re=Math.cos(H);xP(I,q,Z,x);for(var se=0;se<L.length;se+=2){var ae=L[se],he=L[se+1],Ae=O[se],Ee=O[se+1],Pe=ae*A+Ae*x,ze=he*A+Ee*x;m[se]=Pe*re-ze*J+I[0],m[se+1]=Pe*J+ze*re+I[1]}var Re=m[0],rt=m[1];_.moveTo(Re,rt);for(var se=2;se<L.length;){var Ae=m[se++],Ee=m[se++],ye=m[se++],We=m[se++],Ue=m[se++],gt=m[se++];Re===Ae&&rt===Ee&&ye===Ue&&We===gt?_.lineTo(Ue,gt):_.bezierCurveTo(Ae,Ee,ye,We,Ue,gt),Re=Ue,rt=gt}}}})}function C8(n,e,t){if(!n||!e)return e;var r=t.done,s=t.during;Lce(n,e),e.__morphT=0;function o(){UT(e,"buildPath"),UT(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape()}return e.animateTo({__morphT:1},ri({during:function(l){e.dirtyShape(),s&&s(l)},done:function(){o(),r&&r()}},t)),e}function f4e(n,e,t,r,s,o){var l=16;n=s===t?0:Math.round(32767*(n-t)/(s-t)),e=o===r?0:Math.round(32767*(e-r)/(o-r));for(var c=0,a,d=(1<<l)/2;d>0;d/=2){var f=0,m=0;(n&d)>0&&(f=1),(e&d)>0&&(m=1),c+=d*d*(3*f^m),m===0&&(f===1&&(n=d-1-n,e=d-1-e),a=n,n=e,e=a)}return c}function BL(n){var e=1/0,t=1/0,r=-1/0,s=-1/0,o=br(n,function(c){var a=c.getBoundingRect(),d=c.getComputedTransform(),f=a.x+a.width/2+(d?d[4]:0),m=a.y+a.height/2+(d?d[5]:0);return e=Math.min(f,e),t=Math.min(m,t),r=Math.max(f,r),s=Math.max(m,s),[f,m]}),l=br(o,function(c,a){return{cp:c,z:f4e(c[0],c[1],e,t,r,s),path:n[a]}});return l.sort(function(c,a){return c.z-a.z}).map(function(c){return c.path})}function Dce(n){return a4e(n.path,n.count)}function H5(){return{fromIndividuals:[],toIndividuals:[],count:0}}function p4e(n,e,t){var r=[];function s(q){for(var Z=0;Z<q.length;Z++){var J=q[Z];LL(J)?s(J.childrenRef()):J instanceof Ki&&r.push(J)}}s(n);var o=r.length;if(!o)return H5();var l=t.dividePath||Dce,c=l({path:e,count:o});if(c.length!==o)return console.error("Invalid morphing: unmatched splitted path"),H5();r=BL(r),c=BL(c);for(var a=t.done,d=t.during,f=t.individualDelay,m=new RC,_=0;_<o;_++){var x=r[_],A=c[_];A.parent=e,A.copyTransform(m),f||Lce(x,A)}e.__isCombineMorphing=!0,e.childrenRef=function(){return c};function I(q){for(var Z=0;Z<c.length;Z++)c[Z].addSelfToZr(q)}DL(e,"addSelfToZr",{after:function(q){I(q)}}),DL(e,"removeSelfFromZr",{after:function(q){for(var Z=0;Z<c.length;Z++)c[Z].removeSelfFromZr(q)}});function E(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,UT(e,"addSelfToZr"),UT(e,"removeSelfFromZr")}var C=c.length;if(f)for(var L=C,O=function(){L--,L===0&&(E(),a&&a())},_=0;_<C;_++){var H=f?ri({delay:(t.delay||0)+f(_,C,r[_],c[_]),done:O},t):t;C8(r[_],c[_],H)}else e.__morphT=0,e.animateTo({__morphT:1},ri({during:function(q){for(var Z=0;Z<C;Z++){var J=c[Z];J.__morphT=e.__morphT,J.dirtyShape()}d&&d(q)},done:function(){E();for(var q=0;q<n.length;q++)UT(n[q],"updateTransform");a&&a()}},t));return e.__zr&&I(e.__zr),{fromIndividuals:r,toIndividuals:c,count:C}}function m4e(n,e,t){var r=e.length,s=[],o=t.dividePath||Dce;function l(x){for(var A=0;A<x.length;A++){var I=x[A];LL(I)?l(I.childrenRef()):I instanceof Ki&&s.push(I)}}if(LL(n)){l(n.childrenRef());var c=s.length;if(c<r)for(var a=0,d=c;d<r;d++)s.push(CG(s[a++%c]));s.length=r}else{s=o({path:n,count:r});for(var f=n.getComputedTransform(),d=0;d<s.length;d++)s[d].setLocalTransform(f);if(s.length!==r)return console.error("Invalid morphing: unmatched splitted path"),H5()}s=BL(s),e=BL(e);for(var m=t.individualDelay,d=0;d<r;d++){var _=m?ri({delay:(t.delay||0)+m(d,r,s[d],e[d])},t):t;C8(s[d],e[d],_)}return{fromIndividuals:s,toIndividuals:e,count:e.length}}function $K(n){return fr(n[0])}function XK(n,e){for(var t=[],r=n.length,s=0;s<r;s++)t.push({one:n[s],many:[]});for(var s=0;s<e.length;s++){var o=e[s].length,l=void 0;for(l=0;l<o;l++)t[l%r].many.push(e[s][l])}for(var c=0,s=r-1;s>=0;s--)if(!t[s].many.length){var a=t[c].many;if(a.length<=1)if(c)c=0;else return t;var o=a.length,d=Math.ceil(o/2);t[s].many=a.slice(d,o),t[c].many=a.slice(0,d),c++}return t}var g4e={clone:function(n){for(var e=[],t=1-Math.pow(1-n.path.style.opacity,1/n.count),r=0;r<n.count;r++){var s=CG(n.path);s.setStyle("opacity",t),e.push(s)}return e},split:null};function vN(n,e,t,r,s,o){if(!n.length||!e.length)return;var l=bB("update",r,s);if(!(l&&l.duration>0))return;var c=r.getModel("universalTransition").get("delay"),a=Object.assign({setToFinal:!0},l),d,f;$K(n)&&(d=n,f=e),$K(e)&&(d=e,f=n);function m(C,L,O,H,q){var Z=C.many,J=C.one;if(Z.length===1&&!q){var re=L?Z[0]:J,se=L?J:Z[0];if(LL(re))m({many:[re],one:se},!0,O,H,!0);else{var ae=c?ri({delay:c(O,H)},a):a;C8(re,se,ae),o(re,se,re,se,ae)}}else for(var he=ri({dividePath:g4e[t],individualDelay:c&&function(rt,ye,We,Ue){return c(rt+O,H)}},a),Ae=L?p4e(Z,J,he):m4e(J,Z,he),Ee=Ae.fromIndividuals,Pe=Ae.toIndividuals,ze=Ee.length,Re=0;Re<ze;Re++){var ae=c?ri({delay:c(Re,ze)},a):a;o(Ee[Re],Pe[Re],L?Z[Re]:C.one,L?C.one:Z[Re],ae)}}for(var _=d?d===n:n.length>e.length,x=d?XK(f,d):XK(_?e:n,[_?n:e]),A=0,I=0;I<x.length;I++)A+=x[I].many.length;for(var E=0,I=0;I<x.length;I++)m(x[I],_,E,A),E+=x[I].many.length}function Sy(n){if(!n)return[];if(fr(n)){for(var e=[],t=0;t<n.length;t++)e.push(Sy(n[t]));return e}var r=[];return n.traverse(function(s){s instanceof Ki&&!s.disableMorphing&&!s.invisible&&!s.ignore&&r.push(s)}),r}var Bce=1e4,v4e=0,qK=1,YK=2,_4e=Zs();function y4e(n,e){for(var t=n.dimensions,r=0;r<t.length;r++){var s=n.getDimensionInfo(t[r]);if(s&&s.otherDims[e]===0)return t[r]}}function x4e(n,e,t){var r=n.getDimensionInfo(t),s=r&&r.ordinalMeta;if(r){var o=n.get(r.name,e);return s&&s.categories[o]||o+""}}function ZK(n,e,t,r){var s=r?"itemChildGroupId":"itemGroupId",o=y4e(n,s);if(o){var l=x4e(n,e,o);return l}var c=n.getRawDataItem(e),a=r?"childGroupId":"groupId";if(c&&c[a])return c[a]+"";if(!r)return t||n.getId(e)}function KK(n){var e=[];return ot(n,function(t){var r=t.data,s=t.dataGroupId;if(!(r.count()>Bce))for(var o=r.getIndices(),l=0;l<o.length;l++)e.push({data:r,groupId:ZK(r,l,s,!1),childGroupId:ZK(r,l,s,!0),divide:t.divide,dataIndex:l})}),e}function _N(n,e,t){n.traverse(function(r){r instanceof Ki&&Jl(r,{style:{opacity:0}},e,{dataIndex:t,isFrom:!0})})}function yN(n){if(n.parent){var e=n.getComputedTransform();n.setLocalTransform(e),n.parent.remove(n)}}function sb(n){n.stopAnimation(),n.isGroup&&n.traverse(function(e){e.stopAnimation()})}function b4e(n,e,t){var r=bB("update",t,e);r&&n.traverse(function(s){if(s instanceof $w){var o=MPe(s);o&&s.animateFrom({style:o},r)}})}function w4e(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++){var s=n[r],o=e[r];if(s.data.getId(s.dataIndex)!==o.data.getId(o.dataIndex))return!1}return!0}function kce(n,e,t){var r=KK(n),s=KK(e);function o(O,H,q,Z,J){(q||O)&&H.animateFrom({style:q&&q!==O?Qn(Qn({},q.style),O.style):O.style},J)}var l=!1,c=v4e,a=oi(),d=oi();r.forEach(function(O){O.groupId&&a.set(O.groupId,!0),O.childGroupId&&d.set(O.childGroupId,!0)});for(var f=0;f<s.length;f++){var m=s[f].groupId;if(d.get(m)){c=qK;break}var _=s[f].childGroupId;if(_&&a.get(_)){c=YK;break}}function x(O,H){return function(q){var Z=q.data,J=q.dataIndex;return H?Z.getId(J):O?c===qK?q.childGroupId:q.groupId:c===YK?q.childGroupId:q.groupId}}var A=w4e(r,s),I={};if(!A)for(var f=0;f<s.length;f++){var E=s[f],C=E.data.getItemGraphicEl(E.dataIndex);C&&(I[C.id]=!0)}function L(O,H){var q=r[H],Z=s[O],J=Z.data.hostModel,re=q.data.getItemGraphicEl(q.dataIndex),se=Z.data.getItemGraphicEl(Z.dataIndex);if(re===se){se&&b4e(se,Z.dataIndex,J);return}re&&I[re.id]||se&&(sb(se),re?(sb(re),yN(re),l=!0,vN(Sy(re),Sy(se),Z.divide,J,O,o)):_N(se,J,O))}new GM(r,s,x(!0,A),x(!1,A),null,"multiple").update(L).updateManyToOne(function(O,H){var q=s[O],Z=q.data,J=Z.hostModel,re=Z.getItemGraphicEl(q.dataIndex),se=sa(br(H,function(ae){return r[ae].data.getItemGraphicEl(r[ae].dataIndex)}),function(ae){return ae&&ae!==re&&!I[ae.id]});re&&(sb(re),se.length?(ot(se,function(ae){sb(ae),yN(ae)}),l=!0,vN(Sy(se),Sy(re),q.divide,J,O,o)):_N(re,J,q.dataIndex))}).updateOneToMany(function(O,H){var q=r[H],Z=q.data.getItemGraphicEl(q.dataIndex);if(!(Z&&I[Z.id])){var J=sa(br(O,function(se){return s[se].data.getItemGraphicEl(s[se].dataIndex)}),function(se){return se&&se!==Z}),re=s[O[0]].data.hostModel;J.length&&(ot(J,function(se){return sb(se)}),Z?(sb(Z),yN(Z),l=!0,vN(Sy(Z),Sy(J),q.divide,re,O[0],o)):ot(J,function(se){return _N(se,re,O[0])}))}}).updateManyToMany(function(O,H){new GM(H,O,function(q){return r[q].data.getId(r[q].dataIndex)},function(q){return s[q].data.getId(s[q].dataIndex)}).update(function(q,Z){L(O[q],H[Z])}).execute()}).execute(),l&&ot(e,function(O){var H=O.data,q=H.hostModel,Z=q&&t.getViewOfSeriesModel(q),J=bB("update",q,0);Z&&q.isAnimationEnabled()&&J&&J.duration>0&&Z.group.traverse(function(re){re instanceof Ki&&!re.animators.length&&re.animateFrom({style:{opacity:0}},J)})})}function JK(n){var e=n.getModel("universalTransition").get("seriesKey");return e||n.id}function QK(n){return fr(n)?n.sort().join(","):n}function Hv(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function S4e(n,e){var t=oi(),r=oi(),s=oi();return ot(n.oldSeries,function(o,l){var c=n.oldDataGroupIds[l],a=n.oldData[l],d=JK(o),f=QK(d);r.set(f,{dataGroupId:c,data:a}),fr(d)&&ot(d,function(m){s.set(m,{key:f,dataGroupId:c,data:a})})}),ot(e.updatedSeries,function(o){if(o.isUniversalTransitionEnabled()&&o.isAnimationEnabled()){var l=o.get("dataGroupId"),c=o.getData(),a=JK(o),d=QK(a),f=r.get(d);if(f)t.set(d,{oldSeries:[{dataGroupId:f.dataGroupId,divide:Hv(f.data),data:f.data}],newSeries:[{dataGroupId:l,divide:Hv(c),data:c}]});else if(fr(a)){var m=[];ot(a,function(A){var I=r.get(A);I.data&&m.push({dataGroupId:I.dataGroupId,divide:Hv(I.data),data:I.data})}),m.length&&t.set(d,{oldSeries:m,newSeries:[{dataGroupId:l,data:c,divide:Hv(c)}]})}else{var _=s.get(a);if(_){var x=t.get(_.key);x||(x={oldSeries:[{dataGroupId:_.dataGroupId,data:_.data,divide:Hv(_.data)}],newSeries:[]},t.set(_.key,x)),x.newSeries.push({dataGroupId:l,data:c,divide:Hv(c)})}}}}),t}function eJ(n,e){for(var t=0;t<n.length;t++){var r=e.seriesIndex!=null&&e.seriesIndex===n[t].seriesIndex||e.seriesId!=null&&e.seriesId===n[t].id;if(r)return t}}function A4e(n,e,t,r){var s=[],o=[];ot(va(n.from),function(l){var c=eJ(e.oldSeries,l);c>=0&&s.push({dataGroupId:e.oldDataGroupIds[c],data:e.oldData[c],divide:Hv(e.oldData[c]),groupIdDim:l.dimension})}),ot(va(n.to),function(l){var c=eJ(t.updatedSeries,l);if(c>=0){var a=t.updatedSeries[c].getData();o.push({dataGroupId:e.oldDataGroupIds[c],data:a,divide:Hv(a),groupIdDim:l.dimension})}}),s.length>0&&o.length>0&&kce(s,o,r)}function T4e(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){ot(va(r.seriesTransition),function(s){ot(va(s.to),function(o){for(var l=r.updatedSeries,c=0;c<l.length;c++)(o.seriesIndex!=null&&o.seriesIndex===l[c].seriesIndex||o.seriesId!=null&&o.seriesId===l[c].id)&&(l[c][LP]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(e,t,r){var s=_4e(t);if(s.oldSeries&&r.updatedSeries&&r.optionChanged){var o=r.seriesTransition;if(o)ot(va(o),function(x){A4e(x,s,r,t)});else{var l=S4e(s,r);ot(l.keys(),function(x){var A=l.get(x);kce(A.oldSeries,A.newSeries,t)})}ot(r.updatedSeries,function(x){x[LP]&&(x[LP]=!1)})}for(var c=e.getSeries(),a=s.oldSeries=[],d=s.oldDataGroupIds=[],f=s.oldData=[],m=0;m<c.length;m++){var _=c[m].getData();_.count()<Bce&&(a.push(c[m]),d.push(c[m].get("dataGroupId")),f.push(_))}})}function tJ(n,e,t){var r=Hw.createCanvas(),s=e.getWidth(),o=e.getHeight(),l=r.style;return l&&(l.position="absolute",l.left="0",l.top="0",l.width=s+"px",l.height=o+"px",r.setAttribute("data-zr-dom-id",n)),r.width=s*t,r.height=o*t,r}var xN=function(n){jn(e,n);function e(t,r,s){var o=n.call(this)||this;o.motionBlur=!1,o.lastFrameAlpha=.7,o.dpr=1,o.virtual=!1,o.config={},o.incremental=!1,o.zlevel=0,o.maxRepaintRectCount=5,o.__dirty=!0,o.__firstTimePaint=!0,o.__used=!1,o.__drawIndex=0,o.__startIndex=0,o.__endIndex=0,o.__prevStartIndex=null,o.__prevEndIndex=null;var l;s=s||aL,typeof t=="string"?l=tJ(t,r,s):qr(t)&&(l=t,t=l.id),o.id=t,o.dom=l;var c=l.style;return c&&(Kie(l),l.onselectstart=function(){return!1},c.padding="0",c.margin="0",c.borderWidth="0"),o.painter=r,o.dpr=s,o}return e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=tJ("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),t!==1&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,r,s,o){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var l=[],c=this.maxRepaintRectCount,a=!1,d=new ds(0,0,0,0);function f(L){if(!(!L.isFinite()||L.isZero()))if(l.length===0){var O=new ds(0,0,0,0);O.copy(L),l.push(O)}else{for(var H=!1,q=1/0,Z=0,J=0;J<l.length;++J){var re=l[J];if(re.intersect(L)){var se=new ds(0,0,0,0);se.copy(re),se.union(L),l[J]=se,H=!0;break}else if(a){d.copy(L),d.union(re);var ae=L.width*L.height,he=re.width*re.height,Ae=d.width*d.height,Ee=Ae-ae-he;Ee<q&&(q=Ee,Z=J)}}if(a&&(l[Z].union(L),H=!0),!H){var O=new ds(0,0,0,0);O.copy(L),l.push(O)}a||(a=l.length>=c)}}for(var m=this.__startIndex;m<this.__endIndex;++m){var _=t[m];if(_){var x=_.shouldBePainted(s,o,!0,!0),A=_.__isRendered&&(_.__dirty&Fu||!x)?_.getPrevPaintRect():null;A&&f(A);var I=x&&(_.__dirty&Fu||!_.__isRendered)?_.getPaintRect():null;I&&f(I)}}for(var m=this.__prevStartIndex;m<this.__prevEndIndex;++m){var _=r[m],x=_&&_.shouldBePainted(s,o,!0,!0);if(_&&(!x||!_.__zr)&&_.__isRendered){var A=_.getPrevPaintRect();A&&f(A)}}var E;do{E=!1;for(var m=0;m<l.length;){if(l[m].isZero()){l.splice(m,1);continue}for(var C=m+1;C<l.length;)l[m].intersect(l[C])?(E=!0,l[m].union(l[C]),l.splice(C,1)):C++;m++}}while(E);return this._paintRects=l,l},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(t,r){var s=this.dpr,o=this.dom,l=o.style,c=this.domBack;l&&(l.width=t+"px",l.height=r+"px"),o.width=t*s,o.height=r*s,c&&(c.width=t*s,c.height=r*s,s!==1&&this.ctxBack.scale(s,s))},e.prototype.clear=function(t,r,s){var o=this.dom,l=this.ctx,c=o.width,a=o.height;r=r||this.clearColor;var d=this.motionBlur&&!t,f=this.lastFrameAlpha,m=this.dpr,_=this;d&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(o,0,0,c/m,a/m));var x=this.domBack;function A(I,E,C,L){if(l.clearRect(I,E,C,L),r&&r!=="transparent"){var O=void 0;if(oB(r)){var H=r.global||r.__width===C&&r.__height===L;O=H&&r.__canvasGradient||f5(l,r,{x:0,y:0,width:C,height:L}),r.__canvasGradient=O,r.__width=C,r.__height=L}else VCe(r)&&(r.scaleX=r.scaleX||m,r.scaleY=r.scaleY||m,O=p5(l,r,{dirty:function(){_.setUnpainted(),_.painter.refresh()}}));l.save(),l.fillStyle=O||r,l.fillRect(I,E,C,L),l.restore()}d&&(l.save(),l.globalAlpha=f,l.drawImage(x,I,E,C,L),l.restore())}!s||d?A(0,0,c,a):s.length&&ot(s,function(I){A(I.x*m,I.y*m,I.width*m,I.height*m)})},e}(ff),nJ=1e5,dy=314159,HI=.01,M4e=.001;function C4e(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function E4e(n,e){var t=document.createElement("div");return t.style.cssText=["position:relative","width:"+n+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",t}var I4e=function(){function n(e,t,r,s){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var o=!e.nodeName||e.nodeName.toUpperCase()==="CANVAS";this._opts=r=Qn({},r||{}),this.dpr=r.devicePixelRatio||aL,this._singleCanvas=o,this.root=e;var l=e.style;l&&(Kie(e),e.innerHTML=""),this.storage=t;var c=this._zlevelList;this._prevDisplayList=[];var a=this._layers;if(o){var f=e,m=f.width,_=f.height;r.width!=null&&(m=r.width),r.height!=null&&(_=r.height),this.dpr=r.devicePixelRatio||1,f.width=m*this.dpr,f.height=_*this.dpr,this._width=m,this._height=_;var x=new xN(f,this,this.dpr);x.__builtin__=!0,x.initContext(),a[dy]=x,x.zlevel=dy,c.push(dy),this._domRoot=e}else{this._width=TI(e,0,r),this._height=TI(e,1,r);var d=this._domRoot=E4e(this._width,this._height);e.appendChild(d)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},n.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),r=this._prevDisplayList,s=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,r,e,this._redrawId);for(var o=0;o<s.length;o++){var l=s[o],c=this._layers[l];if(!c.__builtin__&&c.refresh){var a=o===0?this._backgroundColor:null;c.refresh(a)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(e){var t=e.length,r=this._hoverlayer;if(r&&r.clear(),!!t){for(var s={inHover:!0,viewWidth:this._width,viewHeight:this._height},o,l=0;l<t;l++){var c=e[l];c.__inHover&&(r||(r=this._hoverlayer=this.getLayer(nJ)),o||(o=r.ctx,o.save()),Gy(o,c,s,l===t-1))}o&&o.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(nJ)},n.prototype.paintOne=function(e,t){Mae(e,t)},n.prototype._paintList=function(e,t,r,s){if(this._redrawId===s){r=r||!1,this._updateLayerStatus(e);var o=this._doPaintList(e,t,r),l=o.finished,c=o.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),c&&this._paintHoverList(e),l)this.eachLayer(function(d){d.afterBrush&&d.afterBrush()});else{var a=this;nL(function(){a._paintList(e,t,r,s)})}}},n.prototype._compositeManually=function(){var e=this.getLayer(dy).ctx,t=this._domRoot.width,r=this._domRoot.height;e.clearRect(0,0,t,r),this.eachBuiltinLayer(function(s){s.virtual&&e.drawImage(s.dom,0,0,t,r)})},n.prototype._doPaintList=function(e,t,r){for(var s=this,o=[],l=this._opts.useDirtyRect,c=0;c<this._zlevelList.length;c++){var a=this._zlevelList[c],d=this._layers[a];d.__builtin__&&d!==this._hoverlayer&&(d.__dirty||r)&&o.push(d)}for(var f=!0,m=!1,_=function(I){var E=o[I],C=E.ctx,L=l&&E.createRepaintRects(e,t,x._width,x._height),O=r?E.__startIndex:E.__drawIndex,H=!r&&E.incremental&&Date.now,q=H&&Date.now(),Z=E.zlevel===x._zlevelList[0]?x._backgroundColor:null;if(E.__startIndex===E.__endIndex)E.clear(!1,Z,L);else if(O===E.__startIndex){var J=e[O];(!J.incremental||!J.notClear||r)&&E.clear(!1,Z,L)}O===-1&&(console.error("For some unknown reason. drawIndex is -1"),O=E.__startIndex);var re,se=function(Ee){var Pe={inHover:!1,allClipped:!1,prevEl:null,viewWidth:s._width,viewHeight:s._height};for(re=O;re<E.__endIndex;re++){var ze=e[re];if(ze.__inHover&&(m=!0),s._doPaintEl(ze,E,l,Ee,Pe,re===E.__endIndex-1),H){var Re=Date.now()-q;if(Re>15)break}}Pe.prevElClipPaths&&C.restore()};if(L)if(L.length===0)re=E.__endIndex;else for(var ae=x.dpr,he=0;he<L.length;++he){var Ae=L[he];C.save(),C.beginPath(),C.rect(Ae.x*ae,Ae.y*ae,Ae.width*ae,Ae.height*ae),C.clip(),se(Ae),C.restore()}else C.save(),se(),C.restore();E.__drawIndex=re,E.__drawIndex<E.__endIndex&&(f=!1)},x=this,A=0;A<o.length;A++)_(A);return yi.wxa&&ot(this._layers,function(I){I&&I.ctx&&I.ctx.draw&&I.ctx.draw()}),{finished:f,needsRefreshHover:m}},n.prototype._doPaintEl=function(e,t,r,s,o,l){var c=t.ctx;if(r){var a=e.getPaintRect();(!s||a&&a.intersect(s))&&(Gy(c,e,o,l),e.setPrevPaintRect(a))}else Gy(c,e,o,l)},n.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=dy);var r=this._layers[e];return r||(r=new xN("zr_"+e,this,this.dpr),r.zlevel=e,r.__builtin__=!0,this._layerConfig[e]?Fi(r,this._layerConfig[e],!0):this._layerConfig[e-HI]&&Fi(r,this._layerConfig[e-HI],!0),t&&(r.virtual=t),this.insertLayer(e,r),r.initContext()),r},n.prototype.insertLayer=function(e,t){var r=this._layers,s=this._zlevelList,o=s.length,l=this._domRoot,c=null,a=-1;if(!r[e]&&C4e(t)){if(o>0&&e>s[0]){for(a=0;a<o-1&&!(s[a]<e&&s[a+1]>e);a++);c=r[s[a]]}if(s.splice(a+1,0,e),r[e]=t,!t.virtual)if(c){var d=c.dom;d.nextSibling?l.insertBefore(t.dom,d.nextSibling):l.appendChild(t.dom)}else l.firstChild?l.insertBefore(t.dom,l.firstChild):l.appendChild(t.dom);t.painter||(t.painter=this)}},n.prototype.eachLayer=function(e,t){for(var r=this._zlevelList,s=0;s<r.length;s++){var o=r[s];e.call(t,this._layers[o],o)}},n.prototype.eachBuiltinLayer=function(e,t){for(var r=this._zlevelList,s=0;s<r.length;s++){var o=r[s],l=this._layers[o];l.__builtin__&&e.call(t,l,o)}},n.prototype.eachOtherLayer=function(e,t){for(var r=this._zlevelList,s=0;s<r.length;s++){var o=r[s],l=this._layers[o];l.__builtin__||e.call(t,l,o)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(e){this.eachBuiltinLayer(function(m,_){m.__dirty=m.__used=!1});function t(m){o&&(o.__endIndex!==m&&(o.__dirty=!0),o.__endIndex=m)}if(this._singleCanvas)for(var r=1;r<e.length;r++){var s=e[r];if(s.zlevel!==e[r-1].zlevel||s.incremental){this._needsManuallyCompositing=!0;break}}var o=null,l=0,c,a;for(a=0;a<e.length;a++){var s=e[a],d=s.zlevel,f=void 0;c!==d&&(c=d,l=0),s.incremental?(f=this.getLayer(d+M4e,this._needsManuallyCompositing),f.incremental=!0,l=1):f=this.getLayer(d+(l>0?HI:0),this._needsManuallyCompositing),f.__builtin__||fG("ZLevel "+d+" has been used by unkown layer "+f.id),f!==o&&(f.__used=!0,f.__startIndex!==a&&(f.__dirty=!0),f.__startIndex=a,f.incremental?f.__drawIndex=-1:f.__drawIndex=a,t(a),o=f),s.__dirty&Fu&&!s.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=a))}t(a),this.eachBuiltinLayer(function(m,_){!m.__used&&m.getElementCount()>0&&(m.__dirty=!0,m.__startIndex=m.__endIndex=m.__drawIndex=0),m.__dirty&&m.__drawIndex<0&&(m.__drawIndex=m.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(e){e.clear()},n.prototype.setBackgroundColor=function(e){this._backgroundColor=e,ot(this._layers,function(t){t.setUnpainted()})},n.prototype.configLayer=function(e,t){if(t){var r=this._layerConfig;r[e]?Fi(r[e],t,!0):r[e]=t;for(var s=0;s<this._zlevelList.length;s++){var o=this._zlevelList[s];if(o===e||o===e+HI){var l=this._layers[o];Fi(l,r[e],!0)}}}},n.prototype.delLayer=function(e){var t=this._layers,r=this._zlevelList,s=t[e];s&&(s.dom.parentNode.removeChild(s.dom),delete t[e],r.splice(Zi(r,e),1))},n.prototype.resize=function(e,t){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var s=this._opts,o=this.root;if(e!=null&&(s.width=e),t!=null&&(s.height=t),e=TI(o,0,s),t=TI(o,1,s),r.style.display="",this._width!==e||t!==this._height){r.style.width=e+"px",r.style.height=t+"px";for(var l in this._layers)this._layers.hasOwnProperty(l)&&this._layers[l].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(e==null||t==null)return;this._width=e,this._height=t,this.getLayer(dy).resize(e,t)}return this},n.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[dy].dom;var t=new xN("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var r=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var s=t.dom.width,o=t.dom.height;this.eachLayer(function(m){m.__builtin__?r.drawImage(m.dom,0,0,s,o):m.renderToCanvas&&(r.save(),m.renderToCanvas(r),r.restore())})}else for(var l={inHover:!1,viewWidth:this._width,viewHeight:this._height},c=this.storage.getDisplayList(!0),a=0,d=c.length;a<d;a++){var f=c[a];Gy(r,f,l,a===d-1)}return t.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();function P4e(n){n.registerPainter("canvas",I4e)}Sp([MNe,SNe,GFe,JNe,YNe,p3e,ONe,iNe,Wke,yOe,oOe,bke,T4e,P4e]);const R4e=()=>{let n=null,e=null,t=null,r=null,s=null,o=null,l=_e.useRef(null),c=[],a=[],d={colors:{base:"#f9f002",gradInner:"#8ae66e",gradOuter:"#03c03c"},reset:()=>{r.reset()}},f={impacts:{value:c},maxSize:{value:.04},minSize:{value:.025},waveHeight:{value:.1},scaling:{value:1},gradInner:{value:new Hn(d.colors.gradInner)},gradOuter:{value:new Hn(d.colors.gradOuter)}},m=10,_=null;const[x,A]=_e.useState(_Ce[new Date().getDay()]),[I,E]=_e.useState(new Date().toLocaleTimeString()),[C,L]=_e.useState(!1),[O,H]=_e.useState(XF[0]),[q,Z]=_e.useState(!1),J=_e.useRef(q),re=new nB,se=new sn;_e.useEffect(()=>{ae(),Re();for(let vt=0;vt<m;vt++)c.push({impactPosition:new Ze().random().subScalar(.5).setLength(5),impactMaxRadius:5*so.randFloat(.5,.75),impactRatio:0,prevPosition:new Ze().random().subScalar(.5).setLength(5),trailRatio:{value:0},trailLength:{value:0}}),Ae(vt);return Pe(),rt(),ye(),window.addEventListener("resize",We),window.addEventListener("dblclick",Ue,!1),()=>{window.removeEventListener("resize",We),window.removeEventListener("dblclick",Ue,!1),_&&clearInterval(_)}},[]),_e.useEffect(()=>{J.current=q},[q]);const ae=()=>{n=new Il,e=new is(45,window.innerWidth/window.innerHeight,.1,50),e.position.set(0,0,15.5),n.add(e),t=new ec({canvas:l.current,antialias:!0,alpha:!0}),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.render(n,e),r=new j0(e,t.domElement),r.enableDamping=!0,r.enablePan=!1,o=new rB(t),o.addPass(new iB(n,e)),o.addPass(new gCe)},he=()=>{let vt=5,Dt=75e3,lt=Math.PI*(3-Math.sqrt(5)),jt=2/Dt,Qt=1-jt/2,nn=0,Wn=0,kn=new Ze,Mn=new CM,De=new Bi,Ye=[],gn=new rf().load(TCe);for(let en=0;en<Dt;en++){Wn=Math.sqrt(1-Qt*Qt),kn.set(Wn*Math.cos(nn),Qt,-Wn*Math.sin(nn)).multiplyScalar(vt),Mn.setFromVector3(kn),nn=nn+lt,Qt=Qt-jt,De.lookAt(kn),De.updateMatrix();let On=new hg(1,1);On.applyMatrix4(De.matrix),On.translate(kn.x,kn.y,kn.z);let Vn=[kn.x,kn.y,kn.z,kn.x,kn.y,kn.z,kn.x,kn.y,kn.z,kn.x,kn.y,kn.z];On.setAttribute("center",new lr(Vn,3));let on=new sn((Mn.theta+Math.PI)/(2*Math.PI),1-Mn.phi/Math.PI),ct=[on.x,on.y,on.x,on.y,on.x,on.y,on.x,on.y];On.setAttribute("baseUv",new lr(ct,2)),Ye.push(On)}let un=vCe(Ye),At=new bo({color:new Hn(d.colors.base),onBeforeCompile:en=>{en.uniforms.impacts=f.impacts,en.uniforms.maxSize=f.maxSize,en.uniforms.minSize=f.minSize,en.uniforms.waveHeight=f.waveHeight,en.uniforms.scaling=f.scaling,en.uniforms.gradInner=f.gradInner,en.uniforms.gradOuter=f.gradOuter,en.uniforms.tex={value:gn},en.vertexShader=`
            struct impact {
              vec3 impactPosition;
              float impactMaxRadius;
              float impactRatio;
            };
            uniform impact impacts[${m}];
            uniform sampler2D tex;
            uniform float maxSize;
            uniform float minSize;
            uniform float waveHeight;
            uniform float scaling;

            attribute vec3 center;
            attribute vec2 baseUv;

            varying float vFinalStep;
            varying float vMap;

            ${en.vertexShader}
          `.replace("#include <begin_vertex>",`#include <begin_vertex>
            float finalStep = 0.0;
            for (int i = 0; i < ${m};i++){
              float dist = distance(center, impacts[i].impactPosition);
              float curRadius = impacts[i].impactMaxRadius * impacts[i].impactRatio;
              float sstep = smoothstep(0., curRadius, dist) - smoothstep(curRadius - ( 0.25 * impacts[i].impactRatio ), curRadius, dist);
              sstep *= 1. - impacts[i].impactRatio;
              finalStep += sstep;
            }
            finalStep = clamp(finalStep, 0., 1.);
            vFinalStep = finalStep;

            float map = texture(tex, baseUv).g;
            vMap = map;
            float pSize = map < 0.5 ? maxSize : minSize;
            float scale = scaling;

            transformed = (position - center) * pSize * mix(1., scale * 1.25, finalStep) + center; // scale on wave
            transformed += normal * finalStep * waveHeight; // lift on wave
            `),en.fragmentShader=`
            uniform vec3 gradInner;
            uniform vec3 gradOuter;
            varying float vFinalStep;
            varying float vMap;
            ${en.fragmentShader}
            `.replace("vec4 diffuseColor = vec4( diffuse, opacity );",`
            // shaping the point, pretty much from The Book of Shaders
            vec2 hUv = (vUv - 0.5);
            int N = 8;
            float a = atan(hUv.x,hUv.y); 
            float r = PI2/float(N);
            float d = cos(floor(.5+a/r)*r-a)*length(hUv);
            float f = cos(PI / float(N)) * 0.5;
            if (d > f) discard;

            vec3 grad = mix(gradInner, gradOuter, clamp( d / f, 0., 1.)); // gradient
            vec3 diffuseMap = diffuse * ((vMap > 0.5) ? 0.5 : 1.);
            vec3 col = mix(diffuseMap, grad, vFinalStep); // color on wave
            if (!gl_FrontFacing) col *= 0.25; // moderate the color on backside
            vec4 diffuseColor = vec4( col , opacity );
            `)}});At.defines={USE_UV:""},s=new Di(un,At),s.rotation.y=Math.PI,a.forEach(en=>s.add(en)),s.position.set(0,-.4,0),n.add(s)};function Ae(vt){let Dt=new Array(300).fill(0),lt=new Yr;lt.setAttribute("position",new lr(Dt,3));let jt=new H6({color:d.colors.gradOuter,transparent:!0,onBeforeCompile:nn=>{nn.uniforms.actionRatio=c[vt].trailRatio,nn.uniforms.lineLength=c[vt].trailLength,nn.fragmentShader=MCe}}),Qt=new nf(lt,jt);Qt.userData.idx=vt,Ee(Qt,c[vt].prevPosition,c[vt].impactPosition),a.push(Qt)}const Ee=(vt,Dt,lt,jt,Qt)=>{let nn=vt.geometry.attributes.position,Wn=nn.count-1,kn=1,Mn=1,De=Dt.length(),Ye=Dt.angleTo(lt),un=De*Ye/Math.PI,At=un/2/kn,en=Mn/un,On=De+At,Vn=new Ze().copy(Dt).setLength(On),on=new Ze().copy(Dt).negate().setLength(At),ct=new Qv(Dt,lt,new Ze),He=new Ze;ct.getNormal(He);let qt=new Ze,Tn=new Ze,An=new Ze,Wt=new Ze;for(let gr=0;gr<=Wn;gr++){let Gn=gr/Wn,nr=Gn*Ye;qt.copy(Vn).applyAxisAngle(He,nr),Tn.copy(on).applyAxisAngle(He,nr+Math.PI*2*Gn*kn),An.addVectors(qt,Tn);let Ar=(An.length()-De)*en+De;Wt.copy(An).setLength(Ar),nn.setXYZ(gr,Wt.x,Wt.y,Wt.z)}nn.needsUpdate=!0,vt.computeLineDistances(),vt.geometry.attributes.lineDistance.needsUpdate=!0,c[vt.userData.idx].trailLength.value=vt.geometry.attributes.lineDistance.array[99],vt.material.dashSize=3},Pe=()=>{let vt=[];for(let Dt=0;Dt<m;Dt++)vt.push({runTween:()=>{let lt=a[Dt],nn=lt.geometry.attributes.lineDistance.array[99]/3,Wn=new TT.Tween({value:0}).to({value:1},nn*1e3).onUpdate(Mn=>{c[Dt].trailRatio.value=Mn.value});var kn=new TT.Tween({value:0}).to({value:1},so.randInt(2500,5e3)).onUpdate(Mn=>{f.impacts.value[Dt].impactRatio=Mn.value}).onComplete(Mn=>{c[Dt].prevPosition.copy(c[Dt].impactPosition),c[Dt].impactPosition.random().subScalar(.5).setLength(5),Ee(lt,c[Dt].prevPosition,c[Dt].impactPosition),f.impacts.value[Dt].impactMaxRadius=5*so.randFloat(.5,.75),vt[Dt].runTween()});Wn.chain(kn),Wn.start()}});vt.forEach(Dt=>Dt.runTween()),he()};let ze=Array.from({length:5}).map(()=>_e.useRef(null));const Re=()=>{const vt=[xCe,bCe,wCe,SCe,ACe];ze.map(lt=>lt.current&&WDe(lt.current,"dark")).forEach((lt,jt)=>{lt&&lt.setOption(vt[jt])})},rt=()=>{TT.update(),s.rotation.y+=.001,t&&n&&e&&t.render(n,e),requestAnimationFrame(rt),J.current&&o.render()},ye=()=>{_=setInterval(()=>{let vt=new Date,Dt=vt.getHours(),lt=vt.getMinutes(),jt=vt.getSeconds();E(`${Dt<10?"0"+Dt:Dt}:${lt<10?"0"+lt:lt}:${jt<10?"0"+jt:jt}`)},1e3)},We=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),o.setSize(window.innerWidth,window.innerHeight)},Ue=vt=>{se.x=vt.clientX/window.innerWidth*2-1,se.y=-vt.clientY/window.innerHeight*2+1,re.setFromCamera(se,e),re.intersectObjects(s.children).length>0&&(L(!0),H(XF[so.randInt(0,XF.length-1)]))},gt=()=>{Z(!q)};return pe.jsx("div",{className:"earth-digital bg-black h-screen w-full overflow-hidden select-none",children:pe.jsxs("div",{className:"p-0 m-0 box-border",children:[pe.jsx("canvas",{ref:l,className:"relative z-1 cursor-pointer"}),pe.jsxs("div",{className:"fixed h-40 w-48 z-10 left-1/2 top-1/2 tips-modal",style:{display:C?"block":"none"},children:[pe.jsx("div",{className:"tips",children:pe.jsx("p",{className:"w-full",children:O})}),pe.jsx("i",{className:"close",onClick:()=>L(!1),children:"CLOSE"})]}),pe.jsxs("header",{className:"hud header w-full left-0 top-0",children:[pe.jsx("div",{className:"left",children:pe.jsxs("p",{className:"date",children:[pe.jsx("span",{className:"text",children:`${x} `}),pe.jsx("span",{className:"text",children:I})]})}),pe.jsx("div",{className:"middle"}),pe.jsx("div",{className:"right",children:pe.jsx("p",{className:"date",children:pe.jsx("span",{className:"text",children:"Kepler-90 +491818.58"})})})]}),pe.jsx("div",{className:"logo-pic",title:"Cyberpunk 2077"}),pe.jsxs("aside",{className:"hud aside left",children:[pe.jsxs("div",{className:"box box_0 inverse",children:[pe.jsx("div",{className:"cover"}),pe.jsxs("div",{className:"info",children:[pe.jsxs("p",{className:"text",children:[pe.jsx("b",{children:"Cyberpunk"}),' is a subgenre of science fiction in a dystopian futuristic setting that tends to focus on a "combination of lowlife and high tech", featuring futuristic technological and scientific achievements, such as artificial intelligence and cybernetics, juxtaposed with societal collapse or decay.'," "]}),pe.jsx("button",{className:"startBtn",onClick:gt,children:"START"})]})]}),pe.jsx("div",{className:"box",children:pe.jsx("div",{className:"chart",ref:ze[0]})}),pe.jsx("div",{className:"box inverse dotted",children:pe.jsx("div",{className:"chart",ref:ze[1]})})]}),pe.jsxs("aside",{className:"hud aside right",children:[pe.jsx("div",{className:"box",children:pe.jsx("div",{className:"chart",ref:ze[2]})}),pe.jsx("div",{className:"box",children:pe.jsx("div",{className:"chart",ref:ze[3]})}),pe.jsx("div",{className:"box inverse dotted",children:pe.jsx("div",{className:"chart",ref:ze[4]})})]}),pe.jsx("footer",{className:"hud footer",children:yCe.map(vt=>pe.jsxs("div",{className:"square",children:[pe.jsx("div",{className:"radar"}),pe.jsxs("div",{className:"text",children:[pe.jsx("p",{className:"title",children:vt.value}),pe.jsx("p",{className:"desc",children:vt.desc})]})]}))}),pe.jsx("section",{className:"background",children:"section"})]})})},L4e="/about_portfolio/assets/bird-D9YInZSw.glb",D4e=()=>{const n=_e.useRef(),{scene:e,animations:t}=fg(L4e),{actions:r}=iG(t,n);return _e.useEffect(()=>{r["Take 001"].play()},[]),MC(({clock:s,camera:o})=>{n.current.position.y=Math.sin(s.elapsedTime)*.2+2,n.current.position.x>o.position.x+10?n.current.rotation.y=Math.PI:n.current.position.x<o.position.x-10&&(n.current.rotation.y=0),n.current.rotation.y===0?(n.current.position.x+=.01,n.current.position.z-=.01):(n.current.position.x-=.01,n.current.position.z+=.01)}),pe.jsx("mesh",{ref:n,position:[-5,2,1],scale:[.003,.003,.003],children:pe.jsx("primitive",{object:e})})},B4e="/about_portfolio/assets/fox-W5Giziuq.glb",k4e=({currentAnimation:n,...e})=>{const t=_e.useRef(),{nodes:r,materials:s,animations:o}=fg(B4e),{actions:l}=iG(o,t);return _e.useEffect(()=>{console.log(l),Object.values(l).forEach(c=>{c.stop()}),l[n]&&l[n].play()},[l,n]),pe.jsx("group",{ref:t,...e,dispose:null,children:pe.jsxs("group",{name:"Sketchfab_Scene",children:[pe.jsx("primitive",{object:r.GLTF_created_0_rootJoint}),pe.jsx("skinnedMesh",{name:"Object_7",geometry:r.Object_7.geometry,material:s.PaletteMaterial001,skeleton:r.Object_7.skeleton}),pe.jsx("skinnedMesh",{name:"Object_8",geometry:r.Object_8.geometry,material:s.PaletteMaterial001,skeleton:r.Object_8.skeleton}),pe.jsx("skinnedMesh",{name:"Object_9",geometry:r.Object_9.geometry,material:s.PaletteMaterial001,skeleton:r.Object_9.skeleton}),pe.jsx("skinnedMesh",{name:"Object_10",geometry:r.Object_10.geometry,material:s.PaletteMaterial001,skeleton:r.Object_10.skeleton}),pe.jsx("skinnedMesh",{name:"Object_11",geometry:r.Object_11.geometry,material:s.PaletteMaterial001,skeleton:r.Object_11.skeleton})]})})},O4e="/about_portfolio/gltf-models/world_2d/world_2d.gltf",F4e=({...n})=>{const t=fg(O4e).scene;return pe.jsx("mesh",{...n,children:pe.jsx("primitive",{object:t})})};class N4e extends La{constructor(e){super(e)}load(e,t,r,s){const o=this,l=this.path===""?gu.extractUrlBase(e):this.path,c=new Ya(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(a){try{t(o.parse(a,l))}catch(d){s?s(d):console.error(d),o.manager.itemError(e)}},r,s)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const r=e.split(`
`);let s={};const o=/\s+/,l={};for(let a=0;a<r.length;a++){let d=r[a];if(d=d.trim(),d.length===0||d.charAt(0)==="#")continue;const f=d.indexOf(" ");let m=f>=0?d.substring(0,f):d;m=m.toLowerCase();let _=f>=0?d.substring(f+1):"";if(_=_.trim(),m==="newmtl")s={name:_},l[_]=s;else if(m==="ka"||m==="kd"||m==="ks"||m==="ke"){const x=_.split(o,3);s[m]=[parseFloat(x[0]),parseFloat(x[1]),parseFloat(x[2])]}else s[m]=_}const c=new z4e(this.resourcePath||t,this.materialOptions);return c.setCrossOrigin(this.crossOrigin),c.setManager(this.manager),c.setMaterials(l),c}}class z4e{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:Uh,this.wrap=this.options.wrap!==void 0?this.options.wrap:Gh}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const r in e){const s=e[r],o={};t[r]=o;for(const l in s){let c=!0,a=s[l];const d=l.toLowerCase();switch(d){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&a[0]===0&&a[1]===0&&a[2]===0&&(c=!1);break}c&&(o[d]=a)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,r=this.materialsInfo[e],s={name:e,side:this.side};function o(c,a){return typeof a!="string"||a===""?"":/^https?:\/\//i.test(a)?a:c+a}function l(c,a){if(s[c])return;const d=t.getTextureParams(a,s),f=t.loadTexture(o(t.baseUrl,d.url));f.repeat.copy(d.scale),f.offset.copy(d.offset),f.wrapS=t.wrap,f.wrapT=t.wrap,(c==="map"||c==="emissiveMap")&&(f.colorSpace=Eo),s[c]=f}for(const c in r){const a=r[c];let d;if(a!=="")switch(c.toLowerCase()){case"kd":s.color=new Hn().fromArray(a).convertSRGBToLinear();break;case"ks":s.specular=new Hn().fromArray(a).convertSRGBToLinear();break;case"ke":s.emissive=new Hn().fromArray(a).convertSRGBToLinear();break;case"map_kd":l("map",a);break;case"map_ks":l("specularMap",a);break;case"map_ke":l("emissiveMap",a);break;case"norm":l("normalMap",a);break;case"map_bump":case"bump":l("bumpMap",a);break;case"map_d":l("alphaMap",a),s.transparent=!0;break;case"ns":s.shininess=parseFloat(a);break;case"d":d=parseFloat(a),d<1&&(s.opacity=d,s.transparent=!0);break;case"tr":d=parseFloat(a),this.options&&this.options.invertTrProperty&&(d=1-d),d>0&&(s.opacity=1-d,s.transparent=!0);break}}return this.materials[e]=new wC(s),this.materials[e]}getTextureParams(e,t){const r={scale:new sn(1,1),offset:new sn(0,0)},s=e.split(/\s+/);let o;return o=s.indexOf("-bm"),o>=0&&(t.bumpScale=parseFloat(s[o+1]),s.splice(o,2)),o=s.indexOf("-s"),o>=0&&(r.scale.set(parseFloat(s[o+1]),parseFloat(s[o+2])),s.splice(o,4)),o=s.indexOf("-o"),o>=0&&(r.offset.set(parseFloat(s[o+1]),parseFloat(s[o+2])),s.splice(o,4)),r.url=s.join(" ").trim(),r}loadTexture(e,t,r,s,o){const l=this.manager!==void 0?this.manager:X6;let c=l.getHandler(e);c===null&&(c=new rf(l)),c.setCrossOrigin&&c.setCrossOrigin(this.crossOrigin);const a=c.load(e,r,s,o);return t!==void 0&&(a.mapping=t),a}}const U4e=/^[og]\s*(.+)?/,G4e=/^mtllib /,V4e=/^usemtl /,H4e=/^usemap /,rJ=/\s+/,iJ=new Ze,bN=new Ze,sJ=new Ze,oJ=new Ze,gh=new Ze,jI=new Hn;function j4e(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(s,o){const l=this._finalize(!1);l&&(l.inherited||l.groupCount<=0)&&this.materials.splice(l.index,1);const c={index:this.materials.length,name:s||"",mtllib:Array.isArray(o)&&o.length>0?o[o.length-1]:"",smooth:l!==void 0?l.smooth:this.smooth,groupStart:l!==void 0?l.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){const d={index:typeof a=="number"?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return d.clone=this.clone.bind(d),d}};return this.materials.push(c),c},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(s){const o=this.currentMaterial();if(o&&o.groupEnd===-1&&(o.groupEnd=this.geometry.vertices.length/3,o.groupCount=o.groupEnd-o.groupStart,o.inherited=!1),s&&this.materials.length>1)for(let l=this.materials.length-1;l>=0;l--)this.materials[l].groupCount<=0&&this.materials.splice(l,1);return s&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),o}},r&&r.name&&typeof r.clone=="function"){const s=r.clone(0);s.inherited=!0,this.object.materials.push(s)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseNormalIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseUVIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/2)*2},addVertex:function(e,t,r){const s=this.vertices,o=this.object.geometry.vertices;o.push(s[e+0],s[e+1],s[e+2]),o.push(s[t+0],s[t+1],s[t+2]),o.push(s[r+0],s[r+1],s[r+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){const s=this.normals,o=this.object.geometry.normals;o.push(s[e+0],s[e+1],s[e+2]),o.push(s[t+0],s[t+1],s[t+2]),o.push(s[r+0],s[r+1],s[r+2])},addFaceNormal:function(e,t,r){const s=this.vertices,o=this.object.geometry.normals;iJ.fromArray(s,e),bN.fromArray(s,t),sJ.fromArray(s,r),gh.subVectors(sJ,bN),oJ.subVectors(iJ,bN),gh.cross(oJ),gh.normalize(),o.push(gh.x,gh.y,gh.z),o.push(gh.x,gh.y,gh.z),o.push(gh.x,gh.y,gh.z)},addColor:function(e,t,r){const s=this.colors,o=this.object.geometry.colors;s[e]!==void 0&&o.push(s[e+0],s[e+1],s[e+2]),s[t]!==void 0&&o.push(s[t+0],s[t+1],s[t+2]),s[r]!==void 0&&o.push(s[r+0],s[r+1],s[r+2])},addUV:function(e,t,r){const s=this.uvs,o=this.object.geometry.uvs;o.push(s[e+0],s[e+1]),o.push(s[t+0],s[t+1]),o.push(s[r+0],s[r+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,s,o,l,c,a,d){const f=this.vertices.length;let m=this.parseVertexIndex(e,f),_=this.parseVertexIndex(t,f),x=this.parseVertexIndex(r,f);if(this.addVertex(m,_,x),this.addColor(m,_,x),c!==void 0&&c!==""){const A=this.normals.length;m=this.parseNormalIndex(c,A),_=this.parseNormalIndex(a,A),x=this.parseNormalIndex(d,A),this.addNormal(m,_,x)}else this.addFaceNormal(m,_,x);if(s!==void 0&&s!==""){const A=this.uvs.length;m=this.parseUVIndex(s,A),_=this.parseUVIndex(o,A),x=this.parseUVIndex(l,A),this.addUV(m,_,x),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let r=0,s=e.length;r<s;r++){const o=this.parseVertexIndex(e[r],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const r=this.vertices.length,s=this.uvs.length;for(let o=0,l=e.length;o<l;o++)this.addVertexLine(this.parseVertexIndex(e[o],r));for(let o=0,l=t.length;o<l;o++)this.addUVLine(this.parseUVIndex(t[o],s))}};return n.startObject("",!1),n}class W4e extends La{constructor(e){super(e),this.materials=null}load(e,t,r,s){const o=this,l=new Ya(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{t(o.parse(c))}catch(a){s?s(a):console.error(a),o.manager.itemError(e)}},r,s)}setMaterials(e){return this.materials=e,this}parse(e){const t=new j4e;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const r=e.split(`
`);let s=[];for(let c=0,a=r.length;c<a;c++){const d=r[c].trimStart();if(d.length===0)continue;const f=d.charAt(0);if(f!=="#")if(f==="v"){const m=d.split(rJ);switch(m[0]){case"v":t.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7?(jI.setRGB(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])).convertSRGBToLinear(),t.colors.push(jI.r,jI.g,jI.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":t.uvs.push(parseFloat(m[1]),parseFloat(m[2]));break}}else if(f==="f"){const _=d.slice(1).trim().split(rJ),x=[];for(let I=0,E=_.length;I<E;I++){const C=_[I];if(C.length>0){const L=C.split("/");x.push(L)}}const A=x[0];for(let I=1,E=x.length-1;I<E;I++){const C=x[I],L=x[I+1];t.addFace(A[0],C[0],L[0],A[1],C[1],L[1],A[2],C[2],L[2])}}else if(f==="l"){const m=d.substring(1).trim().split(" ");let _=[];const x=[];if(d.indexOf("/")===-1)_=m;else for(let A=0,I=m.length;A<I;A++){const E=m[A].split("/");E[0]!==""&&_.push(E[0]),E[1]!==""&&x.push(E[1])}t.addLineGeometry(_,x)}else if(f==="p"){const _=d.slice(1).trim().split(" ");t.addPointGeometry(_)}else if((s=U4e.exec(d))!==null){const m=(" "+s[0].slice(1).trim()).slice(1);t.startObject(m)}else if(V4e.test(d))t.object.startMaterial(d.substring(7).trim(),t.materialLibraries);else if(G4e.test(d))t.materialLibraries.push(d.substring(7).trim());else if(H4e.test(d))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(f==="s"){if(s=d.split(" "),s.length>1){const _=s[1].trim().toLowerCase();t.object.smooth=_!=="0"&&_!=="off"}else t.object.smooth=!0;const m=t.object.currentMaterial();m&&(m.smooth=t.object.smooth)}else{if(d==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+d+'"')}}t.finalize();const o=new Kl;if(o.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let c=0,a=t.objects.length;c<a;c++){const d=t.objects[c],f=d.geometry,m=d.materials,_=f.type==="Line",x=f.type==="Points";let A=!1;if(f.vertices.length===0)continue;const I=new Yr;I.setAttribute("position",new lr(f.vertices,3)),f.normals.length>0&&I.setAttribute("normal",new lr(f.normals,3)),f.colors.length>0&&(A=!0,I.setAttribute("color",new lr(f.colors,3))),f.hasUVIndices===!0&&I.setAttribute("uv",new lr(f.uvs,2));const E=[];for(let L=0,O=m.length;L<O;L++){const H=m[L],q=H.name+"_"+H.smooth+"_"+A;let Z=t.materials[q];if(this.materials!==null){if(Z=this.materials.create(H.name),_&&Z&&!(Z instanceof Ia)){const J=new Ia;wo.prototype.copy.call(J,Z),J.color.copy(Z.color),Z=J}else if(x&&Z&&!(Z instanceof du)){const J=new du({size:10,sizeAttenuation:!1});wo.prototype.copy.call(J,Z),J.color.copy(Z.color),J.map=Z.map,Z=J}}Z===void 0&&(_?Z=new Ia:x?Z=new du({size:1,sizeAttenuation:!1}):Z=new wC,Z.name=H.name,Z.flatShading=!H.smooth,Z.vertexColors=A,t.materials[q]=Z),E.push(Z)}let C;if(E.length>1){for(let L=0,O=m.length;L<O;L++){const H=m[L];I.addGroup(H.groupStart,H.groupCount,L)}_?C=new vu(I,E):x?C=new Rh(I,E):C=new Di(I,E)}else _?C=new vu(I,E[0]):x?C=new Rh(I,E[0]):C=new Di(I,E[0]);C.name=d.name,o.add(C)}else if(t.vertices.length>0){const c=new du({size:1,sizeAttenuation:!1}),a=new Yr;a.setAttribute("position",new lr(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(a.setAttribute("color",new lr(t.colors,3)),c.vertexColors=!0);const d=new Rh(a,c);o.add(d)}return o}}const $4e="/about_portfolio/gltf-models/earth_star/earth.mtl",X4e="/about_portfolio/gltf-models/earth_star/earth.obj",q4e=()=>{let n=null,e=null,t=null,r=null,s,o,l=null,c=0,a=_e.useRef(null),d=()=>{let m={width:a.current.clientWidth,height:a.current.clientHeight};e=new is(70,m.width/m.height,.01,1e3),e.position.set(50,20,200),e.lookAt(0,0,0),n=new Il,n.fog=new zw(1710618,1,1e3),n.background=new Hn(1710618),t=new Ox(14609919,3),r=new ec({canvas:a.current,alpha:!0,antialias:!0}),r.setSize(m.width,m.height);let _=new j0(e,r.domElement);_.enableDamping=!0;let x=new bC(100,4,2,120),A=new bo({color:4237823,wireframe:!0});l=new Di(x,A),l.rotation.x=Math.PI/2,l.rotation.y=-.1*(Math.PI/2);let I=new gx(12,0),E=new SC({color:16776192});o=new Di(I,E),s=new Kl;for(let O=0;O<500;O++){let H=new gx(Math.random()*3,0),q=new bo({color:16777215}),Z=new Di(H,q);Z.position.set((Math.random()-.5)*800,(Math.random()-.5)*800,(Math.random()-.5)*800),Z.rotation.set(Math.random()*2*Math.PI,Math.random()*2*Math.PI,Math.random()*2*Math.PI),s.add(Z)}let C=new N4e,L=new W4e;C.load($4e,O=>{O.preload(),O.side=Mc,L.setMaterials(O),L.load(X4e,H=>{H.scale.set(80,80,80),H.children.map((q,Z)=>{const J=q.material.name;q.material=O.materials[J],q.name==="Earth_Sphere"?(q.visible=!0,H.add(new Di(q.geometry,q.material))):q.material.opacity=.1}),n.add(H)})}),n.add(t),n.add(l),n.add(o),n.add(s),r.render(n,e)},f=()=>{let m=new Ze(0,0,1);c+=Math.random()*.8;let _=Math.PI*c/180;l&&l.rotateOnAxis(m,Math.PI/400),o.position.set(140*Math.cos(_),100*Math.sin(_),80*Math.sin(_)),o.rotation.x+=.01,o.rotation.y+=.01,o.rotation.z-=.01,s.rotation.y+=9e-4,s.rotation.z-=9e-4,requestAnimationFrame(f),r.render(n,e)};return _e.useEffect(()=>{d(),f()},[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{ref:a,className:"w-full h-full"})})},Y4e="/about_portfolio/assets/statue-C3oCcb_2.glb",wN=new WeakMap;class E8 extends La{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,s){const o=new Ya(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,l=>{this.parse(l,t,s)},r,s)}parse(e,t,r=()=>{}){this.decodeDracoFile(e,t,null,null,Eo,r).catch(r)}decodeDracoFile(e,t,r,s,o=$a,l=()=>{}){const c={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:o};return this.decodeGeometry(e,c).then(t).catch(l)}decodeGeometry(e,t){const r=JSON.stringify(t);if(wN.has(e)){const a=wN.get(e);if(a.key===r)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const o=this.workerNextTaskID++,l=e.byteLength,c=this._getWorker(o,l).then(a=>(s=a,new Promise((d,f)=>{s._callbacks[o]={resolve:d,reject:f},s.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return c.catch(()=>!0).then(()=>{s&&o&&this._releaseTask(s,o)}),wN.set(e,{key:r,promise:c}),c}_createGeometry(e){const t=new Yr;e.index&&t.setIndex(new Ni(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const s=e.attributes[r],o=s.name,l=s.array,c=s.itemSize,a=new Ni(l,c);o==="color"&&(this._assignVertexColorSpace(a,s.vertexColorSpace),a.normalized=!(l instanceof Float32Array)),t.setAttribute(o,a)}return t}_assignVertexColorSpace(e,t){if(t!==Eo)return;const r=new Hn;for(let s=0,o=e.count;s<o;s++)r.fromBufferAttribute(e,s).convertSRGBToLinear(),e.setXYZ(s,r.r,r.g,r.b)}_loadLibrary(e,t){const r=new Ya(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((s,o)=>{r.load(e,s,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const s=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const o=Z4e.toString(),l=["/* draco decoder */",s,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(o){const l=o.data;switch(l.type){case"decode":s._callbacks[l.id].resolve(l);break;case"error":s._callbacks[l.id].reject(l);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+l.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,o){return s._taskLoad>o._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Z4e(){let n,e;onmessage=function(l){const c=l.data;switch(c.type){case"init":n=c.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(m){f({draco:m})},DracoDecoderModule(n)});break;case"decode":const a=c.buffer,d=c.taskConfig;e.then(f=>{const m=f.draco,_=new m.Decoder;try{const x=t(m,_,new Int8Array(a),d),A=x.attributes.map(I=>I.array.buffer);x.index&&A.push(x.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:x},A)}catch(x){console.error(x),self.postMessage({type:"error",id:c.id,error:x.message})}finally{m.destroy(_)}});break}};function t(l,c,a,d){const f=d.attributeIDs,m=d.attributeTypes;let _,x;const A=c.GetEncodedGeometryType(a);if(A===l.TRIANGULAR_MESH)_=new l.Mesh,x=c.DecodeArrayToMesh(a,a.byteLength,_);else if(A===l.POINT_CLOUD)_=new l.PointCloud,x=c.DecodeArrayToPointCloud(a,a.byteLength,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!x.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+x.error_msg());const I={index:null,attributes:[]};for(const E in f){const C=self[m[E]];let L,O;if(d.useUniqueIDs)O=f[E],L=c.GetAttributeByUniqueId(_,O);else{if(O=c.GetAttributeId(_,l[f[E]]),O===-1)continue;L=c.GetAttribute(_,O)}const H=s(l,c,_,E,C,L);E==="color"&&(H.vertexColorSpace=d.vertexColorSpace),I.attributes.push(H)}return A===l.TRIANGULAR_MESH&&(I.index=r(l,c,_)),l.destroy(_),I}function r(l,c,a){const f=a.num_faces()*3,m=f*4,_=l._malloc(m);c.GetTrianglesUInt32Array(a,m,_);const x=new Uint32Array(l.HEAPF32.buffer,_,f).slice();return l._free(_),{array:x,itemSize:1}}function s(l,c,a,d,f,m){const _=m.num_components(),A=a.num_points()*_,I=A*f.BYTES_PER_ELEMENT,E=o(l,f),C=l._malloc(I);c.GetAttributeDataArrayForAllPoints(a,m,E,I,C);const L=new f(l.HEAPF32.buffer,C,A).slice();return l._free(C),{name:d,array:L,itemSize:_}}function o(l,c){switch(c){case Float32Array:return l.DT_FLOAT32;case Int8Array:return l.DT_INT8;case Int16Array:return l.DT_INT16;case Int32Array:return l.DT_INT32;case Uint8Array:return l.DT_UINT8;case Uint16Array:return l.DT_UINT16;case Uint32Array:return l.DT_UINT32}}}class VB extends La{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new tze(t)}),this.register(function(t){return new nze(t)}),this.register(function(t){return new hze(t)}),this.register(function(t){return new dze(t)}),this.register(function(t){return new fze(t)}),this.register(function(t){return new ize(t)}),this.register(function(t){return new sze(t)}),this.register(function(t){return new oze(t)}),this.register(function(t){return new aze(t)}),this.register(function(t){return new eze(t)}),this.register(function(t){return new lze(t)}),this.register(function(t){return new rze(t)}),this.register(function(t){return new uze(t)}),this.register(function(t){return new cze(t)}),this.register(function(t){return new J4e(t)}),this.register(function(t){return new pze(t)}),this.register(function(t){return new mze(t)})}load(e,t,r,s){const o=this;let l;if(this.resourcePath!=="")l=this.resourcePath;else if(this.path!==""){const d=gu.extractUrlBase(e);l=gu.resolveURL(d,this.path)}else l=gu.extractUrlBase(e);this.manager.itemStart(e);const c=function(d){s?s(d):console.error(d),o.manager.itemError(e),o.manager.itemEnd(e)},a=new Ya(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(d){try{o.parse(d,l,function(f){t(f),o.manager.itemEnd(e)},c)}catch(f){c(f)}},r,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,s){let o;const l={},c={},a=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===Oce){try{l[$i.KHR_BINARY_GLTF]=new gze(e)}catch(m){s&&s(m);return}o=JSON.parse(l[$i.KHR_BINARY_GLTF].content)}else o=JSON.parse(a.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new Ize(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const m=this.pluginCallbacks[f](d);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[m.name]=m,l[m.name]=!0}if(o.extensionsUsed)for(let f=0;f<o.extensionsUsed.length;++f){const m=o.extensionsUsed[f],_=o.extensionsRequired||[];switch(m){case $i.KHR_MATERIALS_UNLIT:l[m]=new Q4e;break;case $i.KHR_DRACO_MESH_COMPRESSION:l[m]=new vze(o,this.dracoLoader);break;case $i.KHR_TEXTURE_TRANSFORM:l[m]=new _ze;break;case $i.KHR_MESH_QUANTIZATION:l[m]=new yze;break;default:_.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}d.setExtensions(l),d.setPlugins(c),d.parse(r,s)}parseAsync(e,t){const r=this;return new Promise(function(s,o){r.parse(e,t,s,o)})}}function K4e(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const $i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class J4e{constructor(e){this.parser=e,this.name=$i.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let s=t.cache.get(r);if(s)return s;const o=t.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let d;const f=new Hn(16777215);a.color!==void 0&&f.setRGB(a.color[0],a.color[1],a.color[2],$a);const m=a.range!==void 0?a.range:0;switch(a.type){case"directional":d=new H0(f),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new p0(f),d.distance=m;break;case"spot":d=new eB(f),d.distance=m,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,d.angle=a.spot.outerConeAngle,d.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return d.position.set(0,0,0),d.decay=2,Im(d,a),a.intensity!==void 0&&(d.intensity=a.intensity),d.name=t.createUniqueName(a.name||"light_"+e),s=Promise.resolve(d),t.cache.add(r,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,o=r.json.nodes[e],c=(o.extensions&&o.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(a){return r._getNodeRef(t.cache,c,a)})}}class Q4e{constructor(){this.name=$i.KHR_MATERIALS_UNLIT}getMaterialType(){return bo}extendParams(e,t,r){const s=[];e.color=new Hn(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const l=o.baseColorFactor;e.color.setRGB(l[0],l[1],l[2],$a),e.opacity=l[3]}o.baseColorTexture!==void 0&&s.push(r.assignTexture(e,"map",o.baseColorTexture,Eo))}return Promise.all(s)}}class eze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}}class tze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];if(l.clearcoatFactor!==void 0&&(t.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&o.push(r.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&o.push(r.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(o.push(r.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const c=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new sn(c,c)}return Promise.all(o)}}class nze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}}class rze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.iridescenceFactor!==void 0&&(t.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&o.push(r.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(t.iridescenceIOR=l.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&o.push(r.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(o)}}class ize{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new Hn(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=s.extensions[this.name];if(l.sheenColorFactor!==void 0){const c=l.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],$a)}return l.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&o.push(r.assignTexture(t,"sheenColorMap",l.sheenColorTexture,Eo)),l.sheenRoughnessTexture!==void 0&&o.push(r.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(o)}}class sze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.transmissionFactor!==void 0&&(t.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&o.push(r.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(o)}}class oze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];t.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&o.push(r.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const c=l.attenuationColor||[1,1,1];return t.attenuationColor=new Hn().setRGB(c[0],c[1],c[2],$a),Promise.all(o)}}class aze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class lze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];t.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&o.push(r.assignTexture(t,"specularIntensityMap",l.specularTexture));const c=l.specularColorFactor||[1,1,1];return t.specularColor=new Hn().setRGB(c[0],c[1],c[2],$a),l.specularColorTexture!==void 0&&o.push(r.assignTexture(t,"specularColorMap",l.specularColorTexture,Eo)),Promise.all(o)}}class cze{constructor(e){this.parser=e,this.name=$i.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return t.bumpScale=l.bumpFactor!==void 0?l.bumpFactor:1,l.bumpTexture!==void 0&&o.push(r.assignTexture(t,"bumpMap",l.bumpTexture)),Promise.all(o)}}class uze{constructor(e){this.parser=e,this.name=$i.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:qo}extendMaterialParams(e,t){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],l=s.extensions[this.name];return l.anisotropyStrength!==void 0&&(t.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(t.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&o.push(r.assignTexture(t,"anisotropyMap",l.anisotropyTexture)),Promise.all(o)}}class hze{constructor(e){this.parser=e,this.name=$i.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const o=s.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,l)}}class dze{constructor(e){this.parser=e,this.name=$i.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,s=r.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=s.images[l.source];let a=r.textureLoader;if(c.uri){const d=r.options.manager.getHandler(c.uri);d!==null&&(a=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,l.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class fze{constructor(e){this.parser=e,this.name=$i.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,s=r.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=s.images[l.source];let a=r.textureLoader;if(c.uri){const d=r.options.manager.getHandler(c.uri);d!==null&&(a=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,l.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class pze{constructor(e){this.name=$i.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const s=r.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(c){const a=s.byteOffset||0,d=s.byteLength||0,f=s.count,m=s.byteStride,_=new Uint8Array(c,a,d);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,m,_,s.mode,s.filter).then(function(x){return x.buffer}):l.ready.then(function(){const x=new ArrayBuffer(f*m);return l.decodeGltfBuffer(new Uint8Array(x),f,m,_,s.mode,s.filter),x})})}else return null}}class mze{constructor(e){this.name=$i.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const s=t.meshes[r.mesh];for(const d of s.primitives)if(d.mode!==bh.TRIANGLES&&d.mode!==bh.TRIANGLE_STRIP&&d.mode!==bh.TRIANGLE_FAN&&d.mode!==void 0)return null;const l=r.extensions[this.name].attributes,c=[],a={};for(const d in l)c.push(this.parser.getDependency("accessor",l[d]).then(f=>(a[d]=f,a[d])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(d=>{const f=d.pop(),m=f.isGroup?f.children:[f],_=d[0].count,x=[];for(const A of m){const I=new Hr,E=new Ze,C=new Ea,L=new Ze(1,1,1),O=new zD(A.geometry,A.material,_);for(let H=0;H<_;H++)a.TRANSLATION&&E.fromBufferAttribute(a.TRANSLATION,H),a.ROTATION&&C.fromBufferAttribute(a.ROTATION,H),a.SCALE&&L.fromBufferAttribute(a.SCALE,H),O.setMatrixAt(H,I.compose(E,C,L));for(const H in a)if(H==="_COLOR_0"){const q=a[H];O.instanceColor=new S0(q.array,q.itemSize,q.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&A.geometry.setAttribute(H,a[H]);Bi.prototype.copy.call(O,A),this.parser.assignFinalMaterial(O),x.push(O)}return f.isGroup?(f.clear(),f.add(...x),f):x[0]}))}}const Oce="glTF",PA=12,aJ={JSON:1313821514,BIN:5130562};class gze{constructor(e){this.name=$i.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,PA),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Oce)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-PA,o=new DataView(e,PA);let l=0;for(;l<s;){const c=o.getUint32(l,!0);l+=4;const a=o.getUint32(l,!0);if(l+=4,a===aJ.JSON){const d=new Uint8Array(e,PA+l,c);this.content=r.decode(d)}else if(a===aJ.BIN){const d=PA+l;this.body=e.slice(d,d+c)}l+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class vze{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=$i.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},a={},d={};for(const f in l){const m=j5[f]||f.toLowerCase();c[m]=l[f]}for(const f in e.attributes){const m=j5[f]||f.toLowerCase();if(l[f]!==void 0){const _=r.accessors[e.attributes[f]],x=sw[_.componentType];d[m]=x.name,a[m]=_.normalized===!0}}return t.getDependency("bufferView",o).then(function(f){return new Promise(function(m,_){s.decodeDracoFile(f,function(x){for(const A in x.attributes){const I=x.attributes[A],E=a[A];E!==void 0&&(I.normalized=E)}m(x)},c,d,$a,_)})})}}class _ze{constructor(){this.name=$i.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class yze{constructor(){this.name=$i.KHR_MESH_QUANTIZATION}}class Fce extends Dx{constructor(e,t,r,s){super(e,t,r,s)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let l=0;l!==s;l++)t[l]=r[o+l];return t}interpolate_(e,t,r,s){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,a=c*2,d=c*3,f=s-t,m=(r-t)/f,_=m*m,x=_*m,A=e*d,I=A-d,E=-2*x+3*_,C=x-_,L=1-E,O=C-_+m;for(let H=0;H!==c;H++){const q=l[I+H+c],Z=l[I+H+a]*f,J=l[A+H+c],re=l[A+H]*f;o[H]=L*q+O*Z+E*J+C*re}return o}}const xze=new Ea;class bze extends Fce{interpolate_(e,t,r,s){const o=super.interpolate_(e,t,r,s);return xze.fromArray(o).normalize().toArray(o),o}}const bh={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},sw={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},lJ={9728:Ma,9729:Ro,9984:cC,9985:qy,9986:Jv,9987:hu},cJ={33071:uu,33648:ux,10497:Gh},SN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},j5={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},kv={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},wze={CUBICSPLINE:void 0,LINEAR:w0,STEP:fx},AN={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Sze(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new xp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Uh})),n.DefaultMaterial}function fy(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Im(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Aze(n,e,t){let r=!1,s=!1,o=!1;for(let d=0,f=e.length;d<f;d++){const m=e[d];if(m.POSITION!==void 0&&(r=!0),m.NORMAL!==void 0&&(s=!0),m.COLOR_0!==void 0&&(o=!0),r&&s&&o)break}if(!r&&!s&&!o)return Promise.resolve(n);const l=[],c=[],a=[];for(let d=0,f=e.length;d<f;d++){const m=e[d];if(r){const _=m.POSITION!==void 0?t.getDependency("accessor",m.POSITION):n.attributes.position;l.push(_)}if(s){const _=m.NORMAL!==void 0?t.getDependency("accessor",m.NORMAL):n.attributes.normal;c.push(_)}if(o){const _=m.COLOR_0!==void 0?t.getDependency("accessor",m.COLOR_0):n.attributes.color;a.push(_)}}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(a)]).then(function(d){const f=d[0],m=d[1],_=d[2];return r&&(n.morphAttributes.position=f),s&&(n.morphAttributes.normal=m),o&&(n.morphAttributes.color=_),n.morphTargetsRelative=!0,n})}function Tze(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,s=t.length;r<s;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Mze(n){let e;const t=n.extensions&&n.extensions[$i.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+TN(t.attributes):e=n.indices+":"+TN(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,s=n.targets.length;r<s;r++)e+=":"+TN(n.targets[r]);return e}function TN(n){let e="";const t=Object.keys(n).sort();for(let r=0,s=t.length;r<s;r++)e+=t[r]+":"+n[t[r]]+";";return e}function W5(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Cze(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Eze=new Hr;class Ize{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new K4e,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=-1,o=!1,l=-1;if(typeof navigator<"u"){const c=navigator.userAgent;r=/^((?!chrome|android).)*safari/i.test(c)===!0;const a=c.match(/Version\/(\d+)/);s=r&&a?parseInt(a[1],10):-1,o=c.indexOf("Firefox")>-1,l=o?c.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||r&&s<17||o&&l<98?this.textureLoader=new rf(this.options.manager):this.textureLoader=new Y6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ya(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(l){const c={scene:l[0][s.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:s.asset,parser:r,userData:{}};return fy(o,c,s),Im(c,s),Promise.all(r._invokeAll(function(a){return a.afterRoot&&a.afterRoot(c)})).then(function(){for(const a of c.scenes)a.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let s=0,o=t.length;s<o;s++){const l=t[s].joints;for(let c=0,a=l.length;c<a;c++)e[l[c]].isBone=!0}for(let s=0,o=e.length;s<o;s++){const l=e[s];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(r[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const s=r.clone(),o=(l,c)=>{const a=this.associations.get(l);a!=null&&this.associations.set(c,a);for(const[d,f]of l.children.entries())o(f,c.children[d])};return o(r,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const s=e(t[r]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let s=0;s<t.length;s++){const o=e(t[s]);o&&r.push(o)}return r}getDependency(e,t){const r=e+":"+t;let s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(r,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(o,l){return r.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[$i.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(o,l){r.load(gu.resolveURL(t.uri,s.path),o,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const s=t.byteLength||0,o=t.byteOffset||0;return r.slice(o,o+s)})}loadAccessor(e){const t=this,r=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const l=SN[s.type],c=sw[s.componentType],a=s.normalized===!0,d=new c(s.count*l);return Promise.resolve(new Ni(d,l,a))}const o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(l){const c=l[0],a=SN[s.type],d=sw[s.componentType],f=d.BYTES_PER_ELEMENT,m=f*a,_=s.byteOffset||0,x=s.bufferView!==void 0?r.bufferViews[s.bufferView].byteStride:void 0,A=s.normalized===!0;let I,E;if(x&&x!==m){const C=Math.floor(_/x),L="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+C+":"+s.count;let O=t.cache.get(L);O||(I=new d(c,C*x,s.count*x/f),O=new Uw(I,x/f),t.cache.add(L,O)),E=new ng(O,a,_%x/f,A)}else c===null?I=new d(s.count*a):I=new d(c,_,s.count*a),E=new Ni(I,a,A);if(s.sparse!==void 0){const C=SN.SCALAR,L=sw[s.sparse.indices.componentType],O=s.sparse.indices.byteOffset||0,H=s.sparse.values.byteOffset||0,q=new L(l[1],O,s.sparse.count*C),Z=new d(l[2],H,s.sparse.count*a);c!==null&&(E=new Ni(E.array.slice(),E.itemSize,E.normalized));for(let J=0,re=q.length;J<re;J++){const se=q[J];if(E.setX(se,Z[J*a]),a>=2&&E.setY(se,Z[J*a+1]),a>=3&&E.setZ(se,Z[J*a+2]),a>=4&&E.setW(se,Z[J*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(e){const t=this.json,r=this.options,o=t.textures[e].source,l=t.images[o];let c=this.textureLoader;if(l.uri){const a=r.manager.getHandler(l.uri);a!==null&&(c=a)}return this.loadTextureImage(e,o,c)}loadTextureImage(e,t,r){const s=this,o=this.json,l=o.textures[e],c=o.images[t],a=(c.uri||c.bufferView)+":"+l.sampler;if(this.textureCache[a])return this.textureCache[a];const d=this.loadImageSource(t,r).then(function(f){f.flipY=!1,f.name=l.name||c.name||"",f.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(f.name=c.uri);const _=(o.samplers||{})[l.sampler]||{};return f.magFilter=lJ[_.magFilter]||Ro,f.minFilter=lJ[_.minFilter]||hu,f.wrapS=cJ[_.wrapS]||Gh,f.wrapT=cJ[_.wrapT]||Gh,s.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[a]=d,d}loadImageSource(e,t){const r=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(m=>m.clone());const l=s.images[e],c=self.URL||self.webkitURL;let a=l.uri||"",d=!1;if(l.bufferView!==void 0)a=r.getDependency("bufferView",l.bufferView).then(function(m){d=!0;const _=new Blob([m],{type:l.mimeType});return a=c.createObjectURL(_),a});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(a).then(function(m){return new Promise(function(_,x){let A=_;t.isImageBitmapLoader===!0&&(A=function(I){const E=new Ys(I);E.needsUpdate=!0,_(E)}),t.load(gu.resolveURL(m,o.path),A,void 0,x)})}).then(function(m){return d===!0&&c.revokeObjectURL(a),Im(m,l),m.userData.mimeType=l.mimeType||Cze(l.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),m});return this.sourceCache[e]=f,f}assignTexture(e,t,r,s){const o=this;return this.getDependency("texture",r.index).then(function(l){if(!l)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(l=l.clone(),l.channel=r.texCoord),o.extensions[$i.KHR_TEXTURE_TRANSFORM]){const c=r.extensions!==void 0?r.extensions[$i.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const a=o.associations.get(l);l=o.extensions[$i.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),o.associations.set(l,a)}}return s!==void 0&&(l.colorSpace=s),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const s=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,l=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+r.uuid;let a=this.cache.get(c);a||(a=new du,wo.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,a.sizeAttenuation=!1,this.cache.add(c,a)),r=a}else if(e.isLine){const c="LineBasicMaterial:"+r.uuid;let a=this.cache.get(c);a||(a=new Ia,wo.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,this.cache.add(c,a)),r=a}if(s||o||l){let c="ClonedMaterial:"+r.uuid+":";s&&(c+="derivative-tangents:"),o&&(c+="vertex-colors:"),l&&(c+="flat-shading:");let a=this.cache.get(c);a||(a=r.clone(),o&&(a.vertexColors=!0),l&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(c,a),this.associations.set(a,this.associations.get(r))),r=a}e.material=r}getMaterialType(){return xp}loadMaterial(e){const t=this,r=this.json,s=this.extensions,o=r.materials[e];let l;const c={},a=o.extensions||{},d=[];if(a[$i.KHR_MATERIALS_UNLIT]){const m=s[$i.KHR_MATERIALS_UNLIT];l=m.getMaterialType(),d.push(m.extendParams(c,o,t))}else{const m=o.pbrMetallicRoughness||{};if(c.color=new Hn(1,1,1),c.opacity=1,Array.isArray(m.baseColorFactor)){const _=m.baseColorFactor;c.color.setRGB(_[0],_[1],_[2],$a),c.opacity=_[3]}m.baseColorTexture!==void 0&&d.push(t.assignTexture(c,"map",m.baseColorTexture,Eo)),c.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,c.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(d.push(t.assignTexture(c,"metalnessMap",m.metallicRoughnessTexture)),d.push(t.assignTexture(c,"roughnessMap",m.metallicRoughnessTexture))),l=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,c)})))}o.doubleSided===!0&&(c.side=Mc);const f=o.alphaMode||AN.OPAQUE;if(f===AN.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,f===AN.MASK&&(c.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&l!==bo&&(d.push(t.assignTexture(c,"normalMap",o.normalTexture)),c.normalScale=new sn(1,1),o.normalTexture.scale!==void 0)){const m=o.normalTexture.scale;c.normalScale.set(m,m)}if(o.occlusionTexture!==void 0&&l!==bo&&(d.push(t.assignTexture(c,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&l!==bo){const m=o.emissiveFactor;c.emissive=new Hn().setRGB(m[0],m[1],m[2],$a)}return o.emissiveTexture!==void 0&&l!==bo&&d.push(t.assignTexture(c,"emissiveMap",o.emissiveTexture,Eo)),Promise.all(d).then(function(){const m=new l(c);return o.name&&(m.name=o.name),Im(m,o),t.associations.set(m,{materials:e}),o.extensions&&fy(s,m,o),m})}createUniqueName(e){const t=rs.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,s=this.primitiveCache;function o(c){return r[$i.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(a){return uJ(a,c,t)})}const l=[];for(let c=0,a=e.length;c<a;c++){const d=e[c],f=Mze(d),m=s[f];if(m)l.push(m.promise);else{let _;d.extensions&&d.extensions[$i.KHR_DRACO_MESH_COMPRESSION]?_=o(d):_=uJ(new Yr,d,t),s[f]={primitive:d,promise:_},l.push(_)}}return Promise.all(l)}loadMesh(e){const t=this,r=this.json,s=this.extensions,o=r.meshes[e],l=o.primitives,c=[];for(let a=0,d=l.length;a<d;a++){const f=l[a].material===void 0?Sze(this.cache):this.getDependency("material",l[a].material);c.push(f)}return c.push(t.loadGeometries(l)),Promise.all(c).then(function(a){const d=a.slice(0,a.length-1),f=a[a.length-1],m=[];for(let x=0,A=f.length;x<A;x++){const I=f[x],E=l[x];let C;const L=d[x];if(E.mode===bh.TRIANGLES||E.mode===bh.TRIANGLE_STRIP||E.mode===bh.TRIANGLE_FAN||E.mode===void 0)C=o.isSkinnedMesh===!0?new ND(I,L):new Di(I,L),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),E.mode===bh.TRIANGLE_STRIP?C.geometry=DX(C.geometry,dC):E.mode===bh.TRIANGLE_FAN&&(C.geometry=DX(C.geometry,px));else if(E.mode===bh.LINES)C=new vu(I,L);else if(E.mode===bh.LINE_STRIP)C=new nf(I,L);else if(E.mode===bh.LINE_LOOP)C=new UD(I,L);else if(E.mode===bh.POINTS)C=new Rh(I,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(C.geometry.morphAttributes).length>0&&Tze(C,o),C.name=t.createUniqueName(o.name||"mesh_"+e),Im(C,o),E.extensions&&fy(s,C,E),t.assignFinalMaterial(C),m.push(C)}for(let x=0,A=m.length;x<A;x++)t.associations.set(m[x],{meshes:e,primitives:x});if(m.length===1)return o.extensions&&fy(s,m[0],o),m[0];const _=new Kl;o.extensions&&fy(s,_,o),t.associations.set(_,{meshes:e});for(let x=0,A=m.length;x<A;x++)_.add(m[x]);return _})}loadCamera(e){let t;const r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new is(so.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):r.type==="orthographic"&&(t=new af(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Im(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let s=0,o=t.joints.length;s<o;s++)r.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(s){const o=s.pop(),l=s,c=[],a=[];for(let d=0,f=l.length;d<f;d++){const m=l[d];if(m){c.push(m);const _=new Hr;o!==null&&_.fromArray(o.array,d*16),a.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new Gw(c,a)})}loadAnimation(e){const t=this.json,r=this,s=t.animations[e],o=s.name?s.name:"animation_"+e,l=[],c=[],a=[],d=[],f=[];for(let m=0,_=s.channels.length;m<_;m++){const x=s.channels[m],A=s.samplers[x.sampler],I=x.target,E=I.node,C=s.parameters!==void 0?s.parameters[A.input]:A.input,L=s.parameters!==void 0?s.parameters[A.output]:A.output;I.node!==void 0&&(l.push(this.getDependency("node",E)),c.push(this.getDependency("accessor",C)),a.push(this.getDependency("accessor",L)),d.push(A),f.push(I))}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(a),Promise.all(d),Promise.all(f)]).then(function(m){const _=m[0],x=m[1],A=m[2],I=m[3],E=m[4],C=[];for(let L=0,O=_.length;L<O;L++){const H=_[L],q=x[L],Z=A[L],J=I[L],re=E[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const se=r._createAnimationTracks(H,q,Z,J,re);if(se)for(let ae=0;ae<se.length;ae++)C.push(se[ae])}return new vx(o,void 0,C)})}createNodeMesh(e){const t=this.json,r=this,s=t.nodes[e];return s.mesh===void 0?null:r.getDependency("mesh",s.mesh).then(function(o){const l=r._getNodeRef(r.meshCache,s.mesh,o);return s.weights!==void 0&&l.traverse(function(c){if(c.isMesh)for(let a=0,d=s.weights.length;a<d;a++)c.morphTargetInfluences[a]=s.weights[a]}),l})}loadNode(e){const t=this.json,r=this,s=t.nodes[e],o=r._loadNodeShallow(e),l=[],c=s.children||[];for(let d=0,f=c.length;d<f;d++)l.push(r.getDependency("node",c[d]));const a=s.skin===void 0?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([o,Promise.all(l),a]).then(function(d){const f=d[0],m=d[1],_=d[2];_!==null&&f.traverse(function(x){x.isSkinnedMesh&&x.bind(_,Eze)});for(let x=0,A=m.length;x<A;x++)f.add(m[x]);return f})}_loadNodeShallow(e){const t=this.json,r=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=t.nodes[e],l=o.name?s.createUniqueName(o.name):"",c=[],a=s._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return a&&c.push(a),o.camera!==void 0&&c.push(s.getDependency("camera",o.camera).then(function(d){return s._getNodeRef(s.cameraCache,o.camera,d)})),s._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){c.push(d)}),this.nodeCache[e]=Promise.all(c).then(function(d){let f;if(o.isBone===!0?f=new _C:d.length>1?f=new Kl:d.length===1?f=d[0]:f=new Bi,f!==d[0])for(let m=0,_=d.length;m<_;m++)f.add(d[m]);if(o.name&&(f.userData.name=o.name,f.name=l),Im(f,o),o.extensions&&fy(r,f,o),o.matrix!==void 0){const m=new Hr;m.fromArray(o.matrix),f.applyMatrix4(m)}else o.translation!==void 0&&f.position.fromArray(o.translation),o.rotation!==void 0&&f.quaternion.fromArray(o.rotation),o.scale!==void 0&&f.scale.fromArray(o.scale);return s.associations.has(f)||s.associations.set(f,{}),s.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],s=this,o=new Kl;r.name&&(o.name=s.createUniqueName(r.name)),Im(o,r),r.extensions&&fy(t,o,r);const l=r.nodes||[],c=[];for(let a=0,d=l.length;a<d;a++)c.push(s.getDependency("node",l[a]));return Promise.all(c).then(function(a){for(let f=0,m=a.length;f<m;f++)o.add(a[f]);const d=f=>{const m=new Map;for(const[_,x]of s.associations)(_ instanceof wo||_ instanceof Ys)&&m.set(_,x);return f.traverse(_=>{const x=s.associations.get(_);x!=null&&m.set(_,x)}),m};return s.associations=d(o),o})}_createAnimationTracks(e,t,r,s,o){const l=[],c=e.name?e.name:e.uuid,a=[];kv[o.path]===kv.weights?e.traverse(function(_){_.morphTargetInfluences&&a.push(_.name?_.name:_.uuid)}):a.push(c);let d;switch(kv[o.path]){case kv.weights:d=rg;break;case kv.rotation:d=ig;break;case kv.position:case kv.scale:d=sg;break;default:switch(r.itemSize){case 1:d=rg;break;case 2:case 3:default:d=sg;break}break}const f=s.interpolation!==void 0?wze[s.interpolation]:w0,m=this._getArrayFromAccessor(r);for(let _=0,x=a.length;_<x;_++){const A=new d(a[_]+"."+kv[o.path],t.array,m,f);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(A),l.push(A)}return l}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=W5(t.constructor),s=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o++)s[o]=t[o]*r;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const s=this instanceof ig?bze:Fce;return new s(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Pze(n,e,t){const r=e.attributes,s=new Cl;if(r.POSITION!==void 0){const c=t.json.accessors[r.POSITION],a=c.min,d=c.max;if(a!==void 0&&d!==void 0){if(s.set(new Ze(a[0],a[1],a[2]),new Ze(d[0],d[1],d[2])),c.normalized){const f=W5(sw[c.componentType]);s.min.multiplyScalar(f),s.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const c=new Ze,a=new Ze;for(let d=0,f=o.length;d<f;d++){const m=o[d];if(m.POSITION!==void 0){const _=t.json.accessors[m.POSITION],x=_.min,A=_.max;if(x!==void 0&&A!==void 0){if(a.setX(Math.max(Math.abs(x[0]),Math.abs(A[0]))),a.setY(Math.max(Math.abs(x[1]),Math.abs(A[1]))),a.setZ(Math.max(Math.abs(x[2]),Math.abs(A[2]))),_.normalized){const I=W5(sw[_.componentType]);a.multiplyScalar(I)}c.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}n.boundingBox=s;const l=new al;s.getCenter(l.center),l.radius=s.min.distanceTo(s.max)/2,n.boundingSphere=l}function uJ(n,e,t){const r=e.attributes,s=[];function o(l,c){return t.getDependency("accessor",l).then(function(a){n.setAttribute(c,a)})}for(const l in r){const c=j5[l]||l.toLowerCase();c in n.attributes||s.push(o(r[l],c))}if(e.indices!==void 0&&!n.index){const l=t.getDependency("accessor",e.indices).then(function(c){n.setIndex(c)});s.push(l)}return _s.workingColorSpace!==$a&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${_s.workingColorSpace}" not supported.`),Im(n,e),Pze(n,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Aze(n,e.targets,t):n})}const Rze=()=>{let n=_e.useRef(null),e=_e.useRef(null),t,r,s,o,l,c,a=null;const d=new dg;let f=0,m=!1;const _={x:0,y:0};let x=()=>{t=new ec({canvas:n.current,antialias:!0,alpha:!0,powerPreference:"high-performance"}),r=new ec({canvas:e.current,antialias:!1});const L={width:n.current.clientWidth,height:n.current.clientHeight};t.autoClear=!0,t.outputColorSpace=Eo,t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.outputColorSpace=Eo,r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),s=new Il,o=new Kl,l=new is(35,1,1,100),c=new is(35,1,1,100),s.add(o),l.aspect=L.width/L.height,l.position.set(19,1.54,-.1),o.add(l),c.aspect=L.width/L.height,c.position.set(3,3,3),c.rotation.set(0,1,0),s.add(c);const O=new H0(16777215,.8);O.position.set(-100,0,-100),s.add(O),a=new p0(8978414,2.7,4,3),a.position.set(30,3,1.8),s.add(a);const H=new AC;H.onLoad=()=>{document.querySelector(".content").style.visibility="visible";let ae={y:0};const he=document.querySelector(".lds-roller"),Ae=document.getElementById("loading-text-intro"),Ee=new WA(ae).to({y:100},900).easing(lp.Quadratic.InOut).start().onUpdate(()=>{Ae.style.setProperty("transform",`translate(0,${ae.y}%)`)}).onComplete(()=>{Ae.parentNode.removeChild(document.getElementById("loading-text-intro")),$A(Ee)}),Pe=new WA(l.position.set(0,4,2)).to({x:0,y:2.4,z:5.8},3500).easing(lp.Quadratic.InOut).start().onComplete(()=>{$A(Pe),document.querySelector(".nav-head").classList.add("ended"),document.querySelector(".description").classList.add("ended")});he.parentNode.removeChild(he),window.scroll(0,0)},H.onError=ae=>{console.log("There was an error loading "+ae)};const q="/about_portfolio/",Z=new E8;Z.setDecoderPath(`${q}/draco/`),Z.setDecoderConfig({type:"js"});const J=new VB(H);J.setDRACOLoader(Z);let re;J.load(Y4e,ae=>{ae.scene.traverse(he=>{he.isMesh&&(re=he.material,he.material=new wC({shininess:100}))}),s.add(ae.scene),re.dispose(),t.renderLists.dispose()}),new IntersectionObserver(ae=>{m=ae[0].intersectionRatio>.05},{threshold:.05}).observe(document.querySelector(".second"))};const A=function(L){const O=document.querySelector("span");if(L.type==="mouseleave")O.style.cssText="";else{const{offsetX:H,offsetY:q}=L,{offsetWidth:Z,offsetHeight:J}=this,re=20,se=H/Z*(re*2)-re,ae=q/J*(re*2)-re;O.style.cssText=`transform: translate(${se}px, ${ae}px);`}},I=()=>{const L=d.getElapsedTime(),O=L-f;f=L;const H=_.y,q=_.x;a.position.y-=(H*9+a.position.y-2)*O,a.position.x+=(q*8-a.position.x)*2*O,o.position.z-=(H/3+o.position.z)*2*O,o.position.x+=(q/3-o.position.x)*2*O,Hie(),m?r.render(s,c):t.render(s,l),requestAnimationFrame(I)},E=(L,O)=>{const H=new WA(c.position).to(L,3500).easing(lp.Quadratic.InOut).start().onComplete(()=>{$A(H)}),q=new WA(c.rotation).to(O,3500).easing(lp.Quadratic.InOut).start().onComplete(()=>{$A(q)})},C=()=>{let L={width:n.current.clientWidth,height:n.current.clientHeight};t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),l.aspect=L.width/L.height,l.updateProjectionMatrix(),c.aspect=L.width/L.height,c.updateProjectionMatrix()};return _e.useEffect(()=>{x(),I(),document.addEventListener("mousemove",O=>{O.preventDefault(),_.x=O.clientX/window.innerWidth-.5,_.y=O.clientY/window.innerHeight-.5,document.querySelector(".cursor").style.cssText=`left: ${O.clientX}px; top: ${O.clientY}px;`},!1);const L=document.querySelectorAll(".nav-head > .a");return L.forEach(O=>O.addEventListener("mousemove",A)),L.forEach(O=>O.addEventListener("mouseleave",A)),document.getElementById("one").addEventListener("click",()=>{document.getElementById("one").classList.add("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.remove("active"),E({x:3,y:3,z:3},{x:0,y:1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("two").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.add("active"),document.getElementById("three").classList.remove("active"),E({x:-1.4,y:2.8,z:4.4},{x:0,y:-.1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("three").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.add("active"),E({x:-4.8,y:2.9,z:3.2},{x:0,y:-.75,z:0}),document.getElementById("content").innerText=""}),window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C)}},[]),pe.jsxs("div",{className:"shadow_page",children:[pe.jsxs("div",{className:"lds-roller",children:[pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{})]}),pe.jsx("div",{id:"loading-text-intro",children:pe.jsx("p",{children:"Loading"})}),pe.jsxs("div",{className:"content",style:{visibility:"hidden"},children:[pe.jsxs("div",{className:"nav-head",children:[pe.jsx("a",{href:"#",className:"a active",children:pe.jsx("span",{children:"Main"})}),pe.jsx("a",{href:"#",className:"a",children:pe.jsx("span",{children:"About"})}),pe.jsx("a",{href:"#",className:"a",children:pe.jsx("span",{children:"Gallery"})}),pe.jsx("a",{href:"#",className:"a",children:pe.jsx("span",{children:"Contact"})}),pe.jsx("a",{href:"#",className:"a",children:pe.jsx("span",{children:"More"})}),pe.jsx("div",{className:"cursor"})]}),pe.jsxs("section",{className:"section first",children:[pe.jsx("canvas",{ref:n,id:"container",className:"webgl"}),pe.jsxs("div",{className:"info",children:[pe.jsx("h2",{className:"name",children:"DEAGONIR"}),pe.jsx("h1",{className:"title",children:"THREEJS"}),pe.jsx("p",{className:"description",children:""})]})]}),pe.jsxs("section",{className:"section second",children:[pe.jsxs("div",{className:"second-container",children:[pe.jsxs("ul",{children:[pe.jsx("li",{id:"one",className:"active",children:"start"}),pe.jsx("li",{id:"two",children:"running"}),pe.jsx("li",{id:"three",children:"finished"})]}),pe.jsx("p",{className:"text",id:"content",children:""})]}),pe.jsx("canvas",{ref:e,id:"containerDetails",className:"webgl"})]})]})]})};var Lze=`uniform vec3 iResolution; 
uniform float iTime;      \r

varying vec2 vUv;\r

#ifdef FAST_DESCENT\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -4.0));\r
const float cameraDist = 5.0;\r
const float speed = 3.0;\r
const float zoom = 2.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 2.5;\r
const float fogDensity = 0.6;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.5;\r
const float lightSpeed = 0.2;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#else\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -2.0));\r
const float cameraDist = 9.0;\r
const float speed = 1.0;\r
const float zoom = 3.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 7.0;\r
const float fogDensity = 0.7;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.0;\r
const float lightSpeed = 0.15;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#endif

const float tau = 6.283185;

float hash1(float p) {\r
  vec3 p3 = fract(p * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

float hash1(vec2 p2) {\r
  p2 = fract(p2 * vec2(5.3983, 5.4427));\r
  p2 += dot(p2.yx, p2.xy + vec2(21.5351, 14.3137));\r
  return fract(p2.x * p2.y * 95.4337);\r
}

float hash1(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

vec2 hash2(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.xx + p3.yz) * p3.zy);\r
}

vec3 hash3(vec2 p2) {\r
  vec3 p3 = fract(vec3(p2.xyx) * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yxz + 19.19);\r
  return fract((p3.xxy + p3.yzz) * p3.zyx);\r
}

vec4 hash4(vec2 p2) {\r
  vec4 p4 = fract(p2.xyxy * vec4(5.3983, 5.4427, 6.9371, 7.1283));\r
  p4 += dot(p4, p4.yxwz + 19.19);\r
  return fract((p4.xxxy + p4.yyzz + p4.zwww) * p4.wzyx);\r
}

float noise(vec2 p) {\r
  vec2 i = floor(p);\r
  vec2 f = fract(p);\r
  vec2 u = f * f * (3.0 - 2.0 * f);\r
  return mix(mix(hash1(i + vec2(0.0, 0.0)), hash1(i + vec2(1.0, 0.0)), u.x),\r
             mix(hash1(i + vec2(0.0, 1.0)), hash1(i + vec2(1.0, 1.0)), u.x),\r
             u.y);\r
}

vec4 castRay(vec3 eye, vec3 ray, vec2 center) {\r
  vec2 block = floor(eye.xy);\r
  vec3 ri = 1.0 / ray;\r
  vec3 rs = sign(ray);\r
  vec3 side = 0.5 + 0.5 * rs;\r
  vec2 ris = ri.xy * rs.xy;\r
  vec2 dis = (block - eye.xy + 0.5 + rs.xy * 0.5) * ri.xy;

  for (int i = 0; i < 16; ++i) {\r
    float d = dot(block - center, cameraDir.xy);\r
    float height = 3.0 * hash1(block) - 1.0 + 1.5 * d - 0.1 * d * d;

    vec2 lo0 = vec2(block);\r
    vec2 loX = vec2(0.45, 0.45);\r
    vec2 hi0 = vec2(block + 0.55);\r
    vec2 hiX = vec2(0.45, 0.45);

    float dist = 500.0;\r
    float face = 0.0;

    {\r
      vec4 signHash = hash4(block);\r
      vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
      float width = 0.06 + 0.1 * signHash.w;

      vec3 lo = vec3(center.x - width, 0.55, -100.0);\r
      vec3 hi = vec3(center.x + width, 0.99, center.y + width + height);

      float s = step(0.5, signHash.z);\r
      lo = vec3(block, 0.0) + mix(lo, lo.yxz, s);\r
      hi = vec3(block, 0.0) + mix(hi, hi.yxz, s);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    for (int j = 0; j < 5; ++j) {\r
      float top = height - 0.4 * float(j);\r
      vec3 lo = vec3(lo0 + loX * hash2(block, float(j)), -100.0);\r
      vec3 hi = vec3(hi0 + hiX * hash2(block, float(j) + 0.5), top);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5 && maxT < dist) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    if (dist < 400.0) {\r
      return vec4(dist, height, face, 1.0);\r
    }

    float t = eye.z * ri.z;\r
    vec3 p = eye - t * ray;\r
    vec2 g = p.xy - block;

    vec2 dim = step(dis.xy, dis.yx);\r
    dis += dim * ris;\r
    block += dim * rs.xy;\r
  }

  return vec4(100.0, 0.0, 0.0, 1.0);\r
}

vec3 window(float z, vec2 pos, vec2 id) {\r
  float windowSize = 0.03 + 0.12 * hash1(id + 0.1);\r
  float windowProb = 0.3 + 0.8 * hash1(id + 0.2);\r
  float depth = z / windowSize;\r
  float level = floor(depth);\r
  vec3 colorA = mix(windowColorA, windowColorB, hash3(id));\r
  vec3 colorB = mix(windowColorA, windowColorB, hash3(id + 0.1));\r
  vec3 color = mix(colorA, colorB, hash1(id, level));\r
  color *= 0.3 +\r
           0.7 * smoothstep(0.1, 0.5, noise(20.0 * pos + 100.0 * hash1(level)));\r
  color *=\r
      smoothstep(windowProb - 0.2, windowProb + 0.2, hash1(id, level + 0.1));\r
  return color * (0.5 - 0.5 * cos(tau * depth));\r
}

vec3 addLight(vec3 eye, vec3 ray, float res, float time, float height) {\r
  vec2 q = eye.xy + ((height - eye.z) / ray.z) * ray.xy;

  float row = floor(q.x + 0.5);\r
  time += hash1(row);\r
  float col = floor(0.125 * q.y - time);

  float pos = 0.4 + 0.4 * cos(time + tau * hash1(vec2(row, col)));\r
  vec3 lightPos = vec3(row, 8.0 * (col + time + pos), height);\r
  vec3 lightDir = vec3(0.0, 1.0, 0.0);

  
  vec3 w = eye - lightPos;\r
  float a = dot(ray, ray);\r
  float b = dot(ray, lightDir);\r
  float c = dot(lightDir, lightDir);\r
  float d = dot(ray, w);\r
  float e = dot(lightDir, w);\r
  float D = a * c - b * b;\r
  float s = (b * e - c * d) / D;\r
  float t = (a * e - b * d) / D;

  t = max(t, 0.0);\r
  float dist = distance(eye + s * ray, lightPos + t * lightDir);

  float mask = smoothstep(res + 0.1, res, s);\r
  float light =\r
      min(1.0 / pow(200.0 * dist * dist / t + 20.0 * t * t, 0.8), 2.0);\r
  float fog = exp(-fogDensity * max(s - fogOffset, 0.0));\r
  vec3 color = mix(lightColorA, lightColorB, hash3(vec2(row, col)));\r
  return mask * light * fog * color;\r
}

vec3 addSign(vec3 color, vec3 pos, float side, vec2 id) {\r
  vec4 signHash = hash4(id);\r
  float s = step(0.5, signHash.z);\r
  if ((s - 0.5) * side < 0.1)\r
    return color;

  vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
  vec2 p = mix(pos.xz, pos.yz, s);\r
  float halfWidth = 0.04 + 0.06 * signHash.w;

  float charCount = floor(1.0 + 8.0 * hash1(id + 0.5));\r
  if (center.y - p.y > 2.0 * halfWidth * (charCount + 1.0)) {\r
    center.y -= 2.0 * halfWidth * (charCount + 1.5 + 5.0 * hash1(id + 0.6));\r
    charCount = floor(2.0 + 12.0 * hash1(id + 0.7));\r
    id += 0.05;\r
  }

  vec3 signColor = mix(signColorA, signColorB, hash3(id + 0.5));\r
  vec3 outlineColor = mix(signColorA, signColorB, hash3(id + 0.6));\r
  float flash = 6.0 - 24.0 * hash1(id + 0.8);\r
  flash *= step(3.0, flash);\r
  flash = smoothstep(0.1, 0.5, 0.5 + 0.5 * cos(flash * iTime));

  vec2 halfSize = vec2(halfWidth, halfWidth * charCount);\r
  center.y -= halfSize.y;\r
  float outline = length(max(abs(p - center) - halfSize, 0.0)) / halfWidth;\r
  color *= smoothstep(0.1, 0.4, outline);

  vec2 charPos = 0.5 * (p - center + halfSize) / halfWidth;\r
  vec2 charId = id + 0.05 + 0.1 * floor(charPos);\r
  float flicker = hash1(charId);\r
  flicker = step(0.93, flicker);\r
  flicker = 1.0 - flicker * step(0.96, hash1(charId, iTime));

  float char = -3.5 + 8.0 * noise(id + 6.0 * charPos);\r
  charPos = fract(charPos);\r
  char *= smoothstep(0.0, 0.4, charPos.x) * smoothstep(1.0, 0.6, charPos.x);\r
  char *= smoothstep(0.0, 0.4, charPos.y) * smoothstep(1.0, 0.6, charPos.y);\r
  color = mix(color, signColor,\r
              flash * flicker * step(outline, 0.01) * clamp(char, 0.0, 1.0));

  outline = smoothstep(0.0, 0.2, outline) * smoothstep(0.5, 0.3, outline);\r
  return mix(color, outlineColor, flash * outline);\r
}

void main() {\r
  vec2 center = -speed * iTime * cameraDir.xy;\r
  vec3 eye = vec3(center, 0.0) - cameraDist * cameraDir;

  vec3 forward = normalize(cameraDir);\r
  vec3 right = normalize(cross(forward, vec3(0.0, 0.0, 1.0)));\r
  vec3 up = cross(right, forward);\r
  
  vec2 xy = vUv - 0.5;\r
  
  
  vec3 ray = normalize(xy.x * right + xy.y * up + zoom * forward * 0.4);

  vec4 res = castRay(eye, ray, center);\r
  vec3 p = eye + res.x * ray;

  vec2 block = floor(p.xy);\r
  vec3 color = window(p.z - res.y, p.xy, block);

  color = addSign(color, vec3(p.xy - block, p.z - res.y), res.z, block);\r
  color = mix(vec3(0.0), color, abs(res.z));

  float fog = exp(-fogDensity * max(res.x - fogOffset, 0.0));\r
  color = mix(fogColor, color, fog);

  float time = lightSpeed * iTime;\r
  color += addLight(eye.xyz, ray.xyz, res.x, time, lightHeight - 0.6);\r
  color += addLight(eye.yxz, ray.yxz, res.x, time, lightHeight - 0.4);\r
  color += addLight(vec3(-eye.xy, eye.z), vec3(-ray.xy, ray.z), res.x, time,\r
                    lightHeight - 0.2);\r
  color += addLight(vec3(-eye.yx, eye.z), vec3(-ray.yx, ray.z), res.x, time,\r
                    lightHeight);

#ifdef BLACK_AND_WHITE\r
  float c = clamp(dot(vec3(0.4, 0.3, 0.4), color), 0.0, 1.0);\r
  c = 1.0 - pow(1.0 - pow(c, 2.0), 4.0);\r
  color = vec3(c);\r
#endif

  gl_FragColor = vec4(color, 1.0);\r
}`;const Dze=()=>{let n=null,e=null,t=null,r=null,s=null,o=_e.useRef(null);const l=()=>{r={width:o.current.clientWidth,height:o.current.clientHeight},n=new Il,n.fog=new zw(1710618,1,1e3),n.background=new Hn(1710618),e=new is(70,r.width/r.height,.01,1e3),e.position.set(0,0,5),n.add(e),t=new Ox(14609919,3),n.add(t),s=new ec({canvas:o.current,alpha:!0,antialias:!0}),s.setSize(r.width,r.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2));const d=new j0(e,s.domElement);d.enableDamping=!0,n.add(d)},c=()=>{const{x:d,y:f}=s.getDrawingBufferSize(new sn),m=new Lo({vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:Lze,uniforms:{iResolution:{value:new Ze(d,f)},iTime:{value:0}}}),_=new Di(new hg(5,5),m);_.onBeforeRender=()=>{m.uniforms.iTime.value+=.01},n.add(_)},a=()=>{s.render(n,e),requestAnimationFrame(a)};return _e.useEffect(()=>{l(),c(),a()},[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{className:"w-full h-full",ref:o})})},Bze=()=>{let n=null,e=null,t=null,r=_e.useRef(null),s,o,l;const c=()=>{s=new Mp(5,5,5),o=new bo({color:16711680}),l=new Di(s,o);let d={width:r.current.clientWidth,height:r.current.clientHeight};n=new Il,n.add(l),e=new is(70,d.width/d.height,.01,1e3),e.position.z=10,t=new ec({canvas:r.current,antialias:!0}),t.setSize(d.width,d.height)},a=()=>{l&&(l.rotation.y+=.02),l&&(l.rotation.x+=.02),t.render(n,e),requestAnimationFrame(a)};return _e.useEffect(()=>{c(),a()},[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{className:"w-full h-full",ref:r})})},kze="/about_portfolio/assets/cat-DI6FY0oP.mp3",Oze="/about_portfolio/assets/cow-D6Dskg5A.mp3",Fze="/about_portfolio/assets/bg-BEcaSD04.png",Nce="/about_portfolio/assets/perlinnoise-D9vz38ra.png",zce="/about_portfolio/assets/sparknoise-C0zIzS_R.png",hJ=new Ze,MN=new CM,CN=new Ze;class Uce{constructor(e,t){this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let r=0,s=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(m){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(m.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0},this.onPointerUp=function(m){if(this.activeLook)switch(m.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1},this.onPointerMove=function(m){this.domElement===document?(this.pointerX=m.pageX-this.viewHalfX,this.pointerY=m.pageY-this.viewHalfY):(this.pointerX=m.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=m.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(m){switch(m.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}},this.onKeyUp=function(m){switch(m.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}},this.lookAt=function(m,_,x){return m.isVector3?CN.copy(m):CN.set(m,_,x),this.object.lookAt(CN),f(this),this},this.update=function(){const m=new Ze;return function(x){if(this.enabled===!1)return;if(this.heightSpeed){const q=so.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=x*(q*this.heightCoef)}else this.autoSpeedFactor=0;const A=x*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(A+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(A),this.moveLeft&&this.object.translateX(-A),this.moveRight&&this.object.translateX(A),this.moveUp&&this.object.translateY(A),this.moveDown&&this.object.translateY(-A);let I=x*this.lookSpeed;this.activeLook||(I=0);let E=1;this.constrainVertical&&(E=Math.PI/(this.verticalMax-this.verticalMin)),s-=this.pointerX*I,this.lookVertical&&(r-=this.pointerY*I*E),r=Math.max(-85,Math.min(85,r));let C=so.degToRad(90-r);const L=so.degToRad(s);this.constrainVertical&&(C=so.mapLinear(C,0,Math.PI,this.verticalMin,this.verticalMax));const O=this.object.position;m.setFromSphericalCoords(1,C,L).add(O),this.object.lookAt(m)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",dJ),this.domElement.removeEventListener("pointerdown",l),this.domElement.removeEventListener("pointermove",o),this.domElement.removeEventListener("pointerup",c),window.removeEventListener("keydown",a),window.removeEventListener("keyup",d)};const o=this.onPointerMove.bind(this),l=this.onPointerDown.bind(this),c=this.onPointerUp.bind(this),a=this.onKeyDown.bind(this),d=this.onKeyUp.bind(this);this.domElement.addEventListener("contextmenu",dJ),this.domElement.addEventListener("pointerdown",l),this.domElement.addEventListener("pointermove",o),this.domElement.addEventListener("pointerup",c),window.addEventListener("keydown",a),window.addEventListener("keyup",d);function f(m){const _=m.object.quaternion;hJ.set(0,0,-1).applyQuaternion(_),MN.setFromVector3(hJ),r=90-so.radToDeg(MN.phi),s=so.radToDeg(MN.theta)}this.handleResize(),f(this)}}function dJ(n){n.preventDefault()}const Nze=()=>{const n=_e.useRef(null);let e,t,r,s=null,o={width:0,height:0};const l=()=>{o.width=window.innerWidth,o.height=window.innerHeight,t.aspect=o.width/o.height,t.updateProjectionMatrix(),r.setSize(o.width,o.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2))},c=()=>{o.width=window.innerWidth,o.height=window.innerHeight,e=new Il,t=new is(50,o.width/o.height,1,1e5),t.position.set(-200,25,0),t.lookAt(.1,.1,.1),e.add(t),r=new ec({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(o.width,o.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.render(e,t);const _=new H0(16777215,1);_.position.set(0,.5,1).normalize(),e.add(_),s=new Uce(t,r.domElement),s.movementSpeed=50,s.lookSpeed=.1,s.noFly=!0,s.lookVertical=!1},a=()=>{e.background=new rf().load(Fze),d(Oze,Nce,0,20,-50),d(kze,zce,0,20,50)},d=(_,x,A,I,E)=>{let C=new Hre;t.add(C);let L=new Di(new Mp(40,40,40),new bo({map:new rf().load(x)}));L.position.set(A,I,E),e.add(L);var O=new Wre(C),H=new Vre;H.load(_,q=>{O.setBuffer(q),O.setRefDistance(30),O.play(),O.setRolloffFactor(10),O.setLoop(!0)})},f=new dg,m=()=>{r.render(e,t),s.update(f.getDelta()),requestAnimationFrame(m)};return _e.useEffect(()=>(c(),a(),m(),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}),[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{className:"w-screen h-screen",ref:n})})},zze="/about_portfolio/assets/px-DZeywvNe.jpg",Uze="/about_portfolio/assets/nx-gXUpNenc.jpg",Gze="/about_portfolio/assets/py-DXf_Q1NF.jpg",Vze="/about_portfolio/assets/ny-Bo9il99d.jpg",Hze="/about_portfolio/assets/pz-BKu-NtuL.jpg",jze="/about_portfolio/assets/nz-D5GMLchw.jpg",Wze="/about_portfolio/assets/iphone-D4eE8fd6.glb",$ze="/about_portfolio/assets/demo-C_eqECfK.mp4",Xze=()=>{const n=_e.useRef(null),e=_e.useRef(null);let t,r,s,o=null,l={width:0,height:0};const c=()=>{t=new Il,l.width=window.innerWidth,l.height=window.innerHeight,r=new is(75,l.width/l.height,.1,1e3),r.position.set(0,0,20),r.lookAt(new Ze(0,0,0)),t.add(r),s=new ec({canvas:n.current,antialias:!0,alpha:!0}),s.setSize(l.width,l.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.physicallyCorrectLights=!0,s.toneMapping=MD,s.toneMappingExposure=2,s.outputColorSpace=Eo,o=new Uce(r,s.domElement),o.movementSpeed=30,o.lookSpeed=.1,o.noFly=!0};let a=null;const d=()=>{a=new kre().load([zze,Uze,Gze,Vze,Hze,jze]),a.colorSpace=Eo,t.background=a,t.environment=a};let f=null,m={mesh:null,material:null,videoMaterial:null};const _=()=>{const C=new pre(e.current),L=new qo({map:C,envMap:a});m.videoMaterial=L;const O="/about_portfolio/",H=new E8;H.setDecoderPath(`${O}/draco/`),H.setDecoderConfig({type:"js"});const q=new VB;q.setDRACOLoader(H),q.load(Wze,Z=>{Z.scene&&(Z.scene.traverse(J=>{J instanceof Di&&J.material instanceof xp&&(J.material.envMap=a,J.material.envMapIntensity=2,J.name===""&&(m.mesh=J,m.material=J.material),J.name.includes("logo")&&(J.material.metalness=1))}),f=Z.scene,f.scale.set(60,60,60),f.position.y=-5,f.rotation.y=-Math.PI,t.add(f))})},x=()=>{const C=new nB,L=new sn;window.addEventListener("click",O=>{L.x=O.clientX/l.width*2-1,L.y=-(O.clientY/l.height)*2+1,C.setFromCamera(L,r);const H=C.intersectObjects([m.mesh]);if(H.length>0){const q=H[0].object;q.material.type==="MeshStandardMaterial"?q.material=m.videoMaterial:q.material=m.material}})},A=()=>{l.width=window.innerWidth,l.height=window.innerHeight,r.aspect=l.width/l.height,r.updateProjectionMatrix(),s.setSize(l.width,l.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2))},I=new dg,E=()=>{s.render(t,r),o.update(I.getDelta()),requestAnimationFrame(E)};return _e.useEffect(()=>(c(),d(),_(),x(),E(),window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A)}),[]),pe.jsxs("div",{className:"w-screen h-screen",children:[pe.jsx("canvas",{ref:n}),pe.jsx("video",{className:"invisible fixed t-0 l-0",ref:e,src:$ze,muted:!0,autoPlay:!0,type:"mp4",loop:!0}),pe.jsxs("div",{className:"w-64 h-12 bg-black-500 fixed top-0 left-1/2 -ml-32 rounded-b-md flex items-center py-3",children:[pe.jsxs("svg",{className:"ml-4",width:"26",height:"26",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[pe.jsx("path",{d:"M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z",fill:"none",stroke:"#FFF",strokeWidth:"4"}),pe.jsx("path",{d:"M24 19H12V29H24V19Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"}),pe.jsx("path",{d:"M35 18L30 22V26L35 30V18Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"})]}),pe.jsx("span",{className:"text-white text-lg align-middle pl-2",children:""})]})]})},Gce=typeof document<"u"?Al.useLayoutEffect:()=>{};function qze(n){const e=_e.useRef(null);return Gce(()=>{e.current=n},[n]),_e.useCallback((...t)=>{const r=e.current;return r==null?void 0:r(...t)},[])}const zC=n=>{var e;return(e=n==null?void 0:n.ownerDocument)!==null&&e!==void 0?e:document},Vy=n=>n&&"window"in n&&n.window===n?n:zC(n).defaultView||window;function Yze(n){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(t=>n.test(t.brand)))||n.test(window.navigator.userAgent)}function Zze(n){var e;return typeof window<"u"&&window.navigator!=null?n.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Vce(n){let e=null;return()=>(e==null&&(e=n()),e)}const Kze=Vce(function(){return Zze(/^Mac/i)}),Jze=Vce(function(){return Yze(/Android/i)});function Qze(n){return n.mozInputSource===0&&n.isTrusted?!0:Jze()&&n.pointerType?n.type==="click"&&n.buttons===1:n.detail===0&&!n.pointerType}class e5e{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=e}}function Hce(n){let e=_e.useRef({isFocused:!1,observer:null});Gce(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=qze(r=>{n==null||n(r)});return _e.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=l=>{e.current.isFocused=!1,s.disabled&&t(new e5e("blur",l)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var l;(l=e.current.observer)===null||l===void 0||l.disconnect();let c=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:c})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:c}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function t5e(n){let{isDisabled:e,onFocus:t,onBlur:r,onFocusChange:s}=n;const o=_e.useCallback(a=>{if(a.target===a.currentTarget)return r&&r(a),s&&s(!1),!0},[r,s]),l=Hce(o),c=_e.useCallback(a=>{const d=zC(a.target);a.target===a.currentTarget&&d.activeElement===a.target&&(t&&t(a),s&&s(!0),l(a))},[s,t,l]);return{focusProps:{onFocus:!e&&(t||s||r)?c:void 0,onBlur:!e&&(r||s)?o:void 0}}}let UC=null,$5=new Set,GT=new Map,Tx=!1,X5=!1;const n5e={Tab:!0,Escape:!0};function I8(n,e){for(let t of $5)t(n,e)}function r5e(n){return!(n.metaKey||!Kze()&&n.altKey||n.ctrlKey||n.key==="Control"||n.key==="Shift"||n.key==="Meta")}function kL(n){Tx=!0,r5e(n)&&(UC="keyboard",I8("keyboard",n))}function Mh(n){UC="pointer",(n.type==="mousedown"||n.type==="pointerdown")&&(Tx=!0,I8("pointer",n))}function jce(n){Qze(n)&&(Tx=!0,UC="virtual")}function Wce(n){n.target===window||n.target===document||(!Tx&&!X5&&(UC="virtual",I8("virtual",n)),Tx=!1,X5=!1)}function $ce(){Tx=!1,X5=!0}function q5(n){if(typeof window>"u"||GT.get(Vy(n)))return;const e=Vy(n),t=zC(n);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Tx=!0,r.apply(this,arguments)},t.addEventListener("keydown",kL,!0),t.addEventListener("keyup",kL,!0),t.addEventListener("click",jce,!0),e.addEventListener("focus",Wce,!0),e.addEventListener("blur",$ce,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",Mh,!0),t.addEventListener("pointermove",Mh,!0),t.addEventListener("pointerup",Mh,!0)):(t.addEventListener("mousedown",Mh,!0),t.addEventListener("mousemove",Mh,!0),t.addEventListener("mouseup",Mh,!0)),e.addEventListener("beforeunload",()=>{Xce(n)},{once:!0}),GT.set(e,{focus:r})}const Xce=(n,e)=>{const t=Vy(n),r=zC(n);e&&r.removeEventListener("DOMContentLoaded",e),GT.has(t)&&(t.HTMLElement.prototype.focus=GT.get(t).focus,r.removeEventListener("keydown",kL,!0),r.removeEventListener("keyup",kL,!0),r.removeEventListener("click",jce,!0),t.removeEventListener("focus",Wce,!0),t.removeEventListener("blur",$ce,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Mh,!0),r.removeEventListener("pointermove",Mh,!0),r.removeEventListener("pointerup",Mh,!0)):(r.removeEventListener("mousedown",Mh,!0),r.removeEventListener("mousemove",Mh,!0),r.removeEventListener("mouseup",Mh,!0)),GT.delete(t))};function i5e(n){const e=zC(n);let t;return e.readyState!=="loading"?q5(n):(t=()=>{q5(n)},e.addEventListener("DOMContentLoaded",t)),()=>Xce(n,t)}typeof document<"u"&&i5e();function qce(){return UC!=="pointer"}const s5e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function o5e(n,e,t){var r;const s=typeof window<"u"?Vy(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,o=typeof window<"u"?Vy(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,l=typeof window<"u"?Vy(t==null?void 0:t.target).HTMLElement:HTMLElement,c=typeof window<"u"?Vy(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return n=n||(t==null?void 0:t.target)instanceof s&&!s5e.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof o||(t==null?void 0:t.target)instanceof l&&(t==null?void 0:t.target.isContentEditable),!(n&&e==="keyboard"&&t instanceof c&&!n5e[t.key])}function a5e(n,e,t){q5(),_e.useEffect(()=>{let r=(s,o)=>{o5e(!!(t!=null&&t.isTextInput),s,o)&&n(qce())};return $5.add(r),()=>{$5.delete(r)}},e)}function l5e(n){let{isDisabled:e,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:s}=n,o=_e.useRef({isFocusWithin:!1}),l=_e.useCallback(d=>{o.current.isFocusWithin&&!d.currentTarget.contains(d.relatedTarget)&&(o.current.isFocusWithin=!1,t&&t(d),s&&s(!1))},[t,s,o]),c=Hce(l),a=_e.useCallback(d=>{!o.current.isFocusWithin&&document.activeElement===d.target&&(r&&r(d),s&&s(!0),o.current.isFocusWithin=!0,c(d))},[r,s,c]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:a,onBlur:l}}}let OL=!1,EN=0;function Y5(){OL=!0,setTimeout(()=>{OL=!1},50)}function fJ(n){n.pointerType==="touch"&&Y5()}function c5e(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",fJ):document.addEventListener("touchend",Y5),EN++,()=>{EN--,!(EN>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",fJ):document.removeEventListener("touchend",Y5))}}function u5e(n){let{onHoverStart:e,onHoverChange:t,onHoverEnd:r,isDisabled:s}=n,[o,l]=_e.useState(!1),c=_e.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;_e.useEffect(c5e,[]);let{hoverProps:a,triggerHoverEnd:d}=_e.useMemo(()=>{let f=(x,A)=>{if(c.pointerType=A,s||A==="touch"||c.isHovered||!x.currentTarget.contains(x.target))return;c.isHovered=!0;let I=x.currentTarget;c.target=I,e&&e({type:"hoverstart",target:I,pointerType:A}),t&&t(!0),l(!0)},m=(x,A)=>{if(c.pointerType="",c.target=null,A==="touch"||!c.isHovered)return;c.isHovered=!1;let I=x.currentTarget;r&&r({type:"hoverend",target:I,pointerType:A}),t&&t(!1),l(!1)},_={};return typeof PointerEvent<"u"?(_.onPointerEnter=x=>{OL&&x.pointerType==="mouse"||f(x,x.pointerType)},_.onPointerLeave=x=>{!s&&x.currentTarget.contains(x.target)&&m(x,x.pointerType)}):(_.onTouchStart=()=>{c.ignoreEmulatedMouseEvents=!0},_.onMouseEnter=x=>{!c.ignoreEmulatedMouseEvents&&!OL&&f(x,"mouse"),c.ignoreEmulatedMouseEvents=!1},_.onMouseLeave=x=>{!s&&x.currentTarget.contains(x.target)&&m(x,"mouse")}),{hoverProps:_,triggerHoverEnd:m}},[e,t,r,s,c]);return _e.useEffect(()=>{s&&d({currentTarget:c.target},c.pointerType)},[s]),{hoverProps:a,isHovered:o}}function h5e(n={}){let{autoFocus:e=!1,isTextInput:t,within:r}=n,s=_e.useRef({isFocused:!1,isFocusVisible:e||qce()}),[o,l]=_e.useState(!1),[c,a]=_e.useState(()=>s.current.isFocused&&s.current.isFocusVisible),d=_e.useCallback(()=>a(s.current.isFocused&&s.current.isFocusVisible),[]),f=_e.useCallback(x=>{s.current.isFocused=x,l(x),d()},[d]);a5e(x=>{s.current.isFocusVisible=x,d()},[],{isTextInput:t});let{focusProps:m}=t5e({isDisabled:r,onFocusChange:f}),{focusWithinProps:_}=l5e({isDisabled:!r,onFocusWithinChange:f});return{isFocused:o,isFocusVisible:c,focusProps:r?_:m}}var d5e=Object.defineProperty,f5e=(n,e,t)=>e in n?d5e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,IN=(n,e,t)=>(f5e(n,typeof e!="symbol"?e+"":e,t),t);let p5e=class{constructor(){IN(this,"current",this.detect()),IN(this,"handoffState","pending"),IN(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},rx=new p5e;function Jw(n){return rx.isServer?null:n instanceof Node?n.ownerDocument:n!=null&&n.hasOwnProperty("current")&&n.current instanceof Node?n.current.ownerDocument:document}function Yce(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}function Pp(){let n=[],e={addEventListener(t,r,s,o){return t.addEventListener(r,s,o),e.add(()=>t.removeEventListener(r,s,o))},requestAnimationFrame(...t){let r=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let r=setTimeout(...t);return e.add(()=>clearTimeout(r))},microTask(...t){let r={current:!0};return Yce(()=>{r.current&&t[0]()}),e.add(()=>{r.current=!1})},style(t,r,s){let o=t.style.getPropertyValue(r);return Object.assign(t.style,{[r]:s}),this.add(()=>{Object.assign(t.style,{[r]:o})})},group(t){let r=Pp();return t(r),this.add(()=>r.dispose())},add(t){return n.includes(t)||n.push(t),()=>{let r=n.indexOf(t);if(r>=0)for(let s of n.splice(r,1))s()}},dispose(){for(let t of n.splice(0))t()}};return e}function HB(){let[n]=_e.useState(Pp);return _e.useEffect(()=>()=>n.dispose(),[n]),n}let Pa=(n,e)=>{rx.isServer?_e.useEffect(n,e):_e.useLayoutEffect(n,e)};function GC(n){let e=_e.useRef(n);return Pa(()=>{e.current=n},[n]),e}let Po=function(n){let e=GC(n);return Al.useCallback((...t)=>e.current(...t),[e])};function m5e(n){let e=n.width/2,t=n.height/2;return{top:n.clientY-t,right:n.clientX+e,bottom:n.clientY+t,left:n.clientX-e}}function g5e(n,e){return!(!n||!e||n.right<e.left||n.left>e.right||n.bottom<e.top||n.top>e.bottom)}function v5e({disabled:n=!1}={}){let e=_e.useRef(null),[t,r]=_e.useState(!1),s=HB(),o=Po(()=>{e.current=null,r(!1),s.dispose()}),l=Po(c=>{if(s.dispose(),e.current===null){e.current=c.currentTarget,r(!0);{let a=Jw(c.currentTarget);s.addEventListener(a,"pointerup",o,!1),s.addEventListener(a,"pointermove",d=>{if(e.current){let f=m5e(d);r(g5e(f,e.current.getBoundingClientRect()))}},!1),s.addEventListener(a,"pointercancel",o,!1)}}});return{pressed:t,pressProps:n?{}:{onPointerDown:l,onPointerUp:o,onClick:o}}}let _5e=_e.createContext(void 0);function Zce(){return _e.useContext(_5e)}function pJ(...n){return Array.from(new Set(n.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function VC(n,e,...t){if(n in e){let s=e[n];return typeof s=="function"?s(...t):s}let r=new Error(`Tried to handle "${n}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,VC),r}var Z5=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(Z5||{}),y5e=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(y5e||{});function $h(){let n=b5e();return _e.useCallback(e=>x5e({mergeRefs:n,...e}),[n])}function x5e({ourProps:n,theirProps:e,slot:t,defaultTag:r,features:s,visible:o=!0,name:l,mergeRefs:c}){c=c??w5e;let a=Kce(e,n);if(o)return WI(a,t,r,l,c);let d=s??0;if(d&2){let{static:f=!1,...m}=a;if(f)return WI(m,t,r,l,c)}if(d&1){let{unmount:f=!0,...m}=a;return VC(f?0:1,{0(){return null},1(){return WI({...m,hidden:!0,style:{display:"none"}},t,r,l,c)}})}return WI(a,t,r,l,c)}function WI(n,e={},t,r,s){let{as:o=t,children:l,refName:c="ref",...a}=PN(n,["unmount","static"]),d=n.ref!==void 0?{[c]:n.ref}:{},f=typeof l=="function"?l(e):l;"className"in a&&a.className&&typeof a.className=="function"&&(a.className=a.className(e)),a["aria-labelledby"]&&a["aria-labelledby"]===a.id&&(a["aria-labelledby"]=void 0);let m={};if(e){let _=!1,x=[];for(let[A,I]of Object.entries(e))typeof I=="boolean"&&(_=!0),I===!0&&x.push(A.replace(/([A-Z])/g,E=>`-${E.toLowerCase()}`));if(_){m["data-headlessui-state"]=x.join(" ");for(let A of x)m[`data-${A}`]=""}}if(o===_e.Fragment&&(Object.keys(ob(a)).length>0||Object.keys(ob(m)).length>0))if(!_e.isValidElement(f)||Array.isArray(f)&&f.length>1){if(Object.keys(ob(a)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(ob(a)).concat(Object.keys(ob(m))).map(_=>`  - ${_}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(_=>`  - ${_}`).join(`
`)].join(`
`))}else{let _=f.props,x=_==null?void 0:_.className,A=typeof x=="function"?(...C)=>pJ(x(...C),a.className):pJ(x,a.className),I=A?{className:A}:{},E=Kce(f.props,ob(PN(a,["ref"])));for(let C in m)C in E&&delete m[C];return _e.cloneElement(f,Object.assign({},E,m,d,{ref:s(S5e(f),d.ref)},I))}return _e.createElement(o,Object.assign({},PN(a,["ref"]),o!==_e.Fragment&&d,o!==_e.Fragment&&m),f)}function b5e(){let n=_e.useRef([]),e=_e.useCallback(t=>{for(let r of n.current)r!=null&&(typeof r=="function"?r(t):r.current=t)},[]);return(...t)=>{if(!t.every(r=>r==null))return n.current=t,e}}function w5e(...n){return n.every(e=>e==null)?void 0:e=>{for(let t of n)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function Kce(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(t[s]!=null||(t[s]=[]),t[s].push(r[s])):e[s]=r[s];if(e.disabled||e["aria-disabled"])for(let r in t)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(t[r]=[s=>{var o;return(o=s==null?void 0:s.preventDefault)==null?void 0:o.call(s)}]);for(let r in t)Object.assign(e,{[r](s,...o){let l=t[r];for(let c of l){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;c(s,...o)}}});return e}function Jce(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(t[s]!=null||(t[s]=[]),t[s].push(r[s])):e[s]=r[s];for(let r in t)Object.assign(e,{[r](...s){let o=t[r];for(let l of o)l==null||l(...s)}});return e}function Xh(n){var e;return Object.assign(_e.forwardRef(n),{displayName:(e=n.displayName)!=null?e:n.name})}function ob(n){let e=Object.assign({},n);for(let t in e)e[t]===void 0&&delete e[t];return e}function PN(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function S5e(n){return Al.version.split(".")[0]>="19"?n.props.ref:n.ref}let A5e=_e.createContext(void 0);function T5e(){return _e.useContext(A5e)}function M5e(n){let e=n.parentElement,t=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(t=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&C5e(t)?!1:r}function C5e(n){if(!n)return!1;let e=n.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}let Qce=Symbol();function E5e(n,e=!0){return Object.assign(n,{[Qce]:e})}function mg(...n){let e=_e.useRef(n);_e.useEffect(()=>{e.current=n},[n]);let t=Po(r=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(r):s.current=r)});return n.every(r=>r==null||(r==null?void 0:r[Qce]))?void 0:t}let P8=_e.createContext(null);P8.displayName="DescriptionContext";function eue(){let n=_e.useContext(P8);if(n===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,eue),e}return n}function I5e(){let[n,e]=_e.useState([]);return[n.length>0?n.join(" "):void 0,_e.useMemo(()=>function(t){let r=Po(o=>(e(l=>[...l,o]),()=>e(l=>{let c=l.slice(),a=c.indexOf(o);return a!==-1&&c.splice(a,1),c}))),s=_e.useMemo(()=>({register:r,slot:t.slot,name:t.name,props:t.props,value:t.value}),[r,t.slot,t.name,t.props,t.value]);return Al.createElement(P8.Provider,{value:s},t.children)},[e])]}let P5e="p";function R5e(n,e){let t=_e.useId(),r=Zce(),{id:s=`headlessui-description-${t}`,...o}=n,l=eue(),c=mg(e);Pa(()=>l.register(s),[s,l.register]);let a=r||!1,d=_e.useMemo(()=>({...l.slot,disabled:a}),[l.slot,a]),f={ref:c,...l.props,id:s};return $h()({ourProps:f,theirProps:o,slot:d,defaultTag:P5e,name:l.name||"Description"})}let L5e=Xh(R5e);Object.assign(L5e,{});var wl=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(wl||{});let jB=_e.createContext(null);jB.displayName="LabelContext";function R8(){let n=_e.useContext(jB);if(n===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,R8),e}return n}function D5e(n){var e,t,r;let s=(t=(e=_e.useContext(jB))==null?void 0:e.value)!=null?t:void 0;return((r=void 0)!=null?r:0)>0?[s,...n].filter(Boolean).join(" "):s}function tue({inherit:n=!1}={}){let e=D5e(),[t,r]=_e.useState([]),s=n?[e,...t].filter(Boolean):t;return[s.length>0?s.join(" "):void 0,_e.useMemo(()=>function(o){let l=Po(a=>(r(d=>[...d,a]),()=>r(d=>{let f=d.slice(),m=f.indexOf(a);return m!==-1&&f.splice(m,1),f}))),c=_e.useMemo(()=>({register:l,slot:o.slot,name:o.name,props:o.props,value:o.value}),[l,o.slot,o.name,o.props,o.value]);return Al.createElement(jB.Provider,{value:c},o.children)},[r])]}let B5e="label";function k5e(n,e){var t;let r=_e.useId(),s=R8(),o=T5e(),l=Zce(),{id:c=`headlessui-label-${r}`,htmlFor:a=o??((t=s.props)==null?void 0:t.htmlFor),passive:d=!1,...f}=n,m=mg(e);Pa(()=>s.register(c),[c,s.register]);let _=Po(E=>{let C=E.currentTarget;if(C instanceof HTMLLabelElement&&E.preventDefault(),s.props&&"onClick"in s.props&&typeof s.props.onClick=="function"&&s.props.onClick(E),C instanceof HTMLLabelElement){let L=document.getElementById(C.htmlFor);if(L){let O=L.getAttribute("disabled");if(O==="true"||O==="")return;let H=L.getAttribute("aria-disabled");if(H==="true"||H==="")return;(L instanceof HTMLInputElement&&(L.type==="radio"||L.type==="checkbox")||L.role==="radio"||L.role==="checkbox"||L.role==="switch")&&L.click(),L.focus({preventScroll:!0})}}}),x=l||!1,A=_e.useMemo(()=>({...s.slot,disabled:x}),[s.slot,x]),I={ref:m,...s.props,id:c,htmlFor:a,onClick:_};return d&&("onClick"in I&&(delete I.htmlFor,delete I.onClick),"onClick"in f&&delete f.onClick),$h()({ourProps:I,theirProps:f,slot:A,defaultTag:a?B5e:"div",name:s.name||"Label"})}let O5e=Xh(k5e);Object.assign(O5e,{});function F5e(n){if(n===null)return{width:0,height:0};let{width:e,height:t}=n.getBoundingClientRect();return{width:e,height:t}}function N5e(n,e=!1){let[t,r]=_e.useReducer(()=>({}),{}),s=_e.useMemo(()=>F5e(n),[n,t]);return Pa(()=>{if(!n)return;let o=new ResizeObserver(r);return o.observe(n),()=>{o.disconnect()}},[n]),e?{width:`${s.width}px`,height:`${s.height}px`}:s}let z5e=class extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return t===void 0&&(t=this.factory(e),this.set(e,t)),t}};function nue(n,e){let t=n(),r=new Set;return{getSnapshot(){return t},subscribe(s){return r.add(s),()=>r.delete(s)},dispatch(s,...o){let l=e[s].call(t,...o);l&&(t=l,r.forEach(c=>c()))}}}function rue(n){return _e.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getSnapshot)}let U5e=new z5e(()=>nue(()=>[],{ADD(n){return this.includes(n)?this:[...this,n]},REMOVE(n){let e=this.indexOf(n);if(e===-1)return this;let t=this.slice();return t.splice(e,1),t}}));function L8(n,e){let t=U5e.get(e),r=_e.useId(),s=rue(t);if(Pa(()=>{if(n)return t.dispatch("ADD",r),()=>t.dispatch("REMOVE",r)},[t,n]),!n)return!1;let o=s.indexOf(r),l=s.length;return o===-1&&(o=l,l+=1),o===l-1}let K5=new Map,VT=new Map;function mJ(n){var e;let t=(e=VT.get(n))!=null?e:0;return VT.set(n,t+1),t!==0?()=>gJ(n):(K5.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0,()=>gJ(n))}function gJ(n){var e;let t=(e=VT.get(n))!=null?e:1;if(t===1?VT.delete(n):VT.set(n,t-1),t!==1)return;let r=K5.get(n);r&&(r["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",r["aria-hidden"]),n.inert=r.inert,K5.delete(n))}function G5e(n,{allowed:e,disallowed:t}={}){let r=L8(n,"inert-others");Pa(()=>{var s,o;if(!r)return;let l=Pp();for(let a of(s=t==null?void 0:t())!=null?s:[])a&&l.add(mJ(a));let c=(o=e==null?void 0:e())!=null?o:[];for(let a of c){if(!a)continue;let d=Jw(a);if(!d)continue;let f=a.parentElement;for(;f&&f!==d.body;){for(let m of f.children)c.some(_=>m.contains(_))||l.add(mJ(m));f=f.parentElement}}return l.dispose},[r,e,t])}function V5e(n,e,t){let r=GC(s=>{let o=s.getBoundingClientRect();o.x===0&&o.y===0&&o.width===0&&o.height===0&&t()});_e.useEffect(()=>{if(!n)return;let s=e===null?null:e instanceof HTMLElement?e:e.current;if(!s)return;let o=Pp();if(typeof ResizeObserver<"u"){let l=new ResizeObserver(()=>r.current(s));l.observe(s),o.add(()=>l.disconnect())}if(typeof IntersectionObserver<"u"){let l=new IntersectionObserver(()=>r.current(s));l.observe(s),o.add(()=>l.disconnect())}return()=>o.dispose()},[e,r,n])}let J5=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>`${n}:not([tabindex='-1'])`).join(","),H5e=["[data-autofocus]"].map(n=>`${n}:not([tabindex='-1'])`).join(",");var Q5=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n[n.AutoFocus=64]="AutoFocus",n))(Q5||{}),j5e=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(j5e||{}),W5e=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(W5e||{});function iue(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(J5)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}function $5e(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(H5e)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var D8=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(D8||{});function B8(n,e=0){var t;return n===((t=Jw(n))==null?void 0:t.body)?!1:VC(e,{0(){return n.matches(J5)},1(){let r=n;for(;r!==null;){if(r.matches(J5))return!0;r=r.parentElement}return!1}})}function sue(n){let e=Jw(n);Pp().nextFrame(()=>{e&&!B8(e.activeElement,0)&&q5e(n)})}var X5e=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(X5e||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function q5e(n){n==null||n.focus({preventScroll:!0})}let Y5e=["textarea","input"].join(",");function Z5e(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,Y5e))!=null?t:!1}function oue(n,e=t=>t){return n.slice().sort((t,r)=>{let s=e(t),o=e(r);if(s===null||o===null)return 0;let l=s.compareDocumentPosition(o);return l&Node.DOCUMENT_POSITION_FOLLOWING?-1:l&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function K5e(n,e){return J5e(iue(),e,{relativeTo:n})}function J5e(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:s=[]}={}){let o=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n.ownerDocument,l=Array.isArray(n)?t?oue(n):n:e&64?$5e(n):iue(n);s.length>0&&l.length>1&&(l=l.filter(x=>!s.some(A=>A!=null&&"current"in A?(A==null?void 0:A.current)===x:A===x))),r=r??o.activeElement;let c=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),a=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,l.indexOf(r))-1;if(e&4)return Math.max(0,l.indexOf(r))+1;if(e&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=e&32?{preventScroll:!0}:{},f=0,m=l.length,_;do{if(f>=m||f+m<=0)return 0;let x=a+f;if(e&16)x=(x+m)%m;else{if(x<0)return 3;if(x>=m)return 1}_=l[x],_==null||_.focus(d),f+=c}while(_!==o.activeElement);return e&6&&Z5e(_)&&_.select(),2}function aue(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Q5e(){return/Android/gi.test(window.navigator.userAgent)}function eUe(){return aue()||Q5e()}function RA(n,e,t,r){let s=GC(t);_e.useEffect(()=>{if(!n)return;function o(l){s.current(l)}return document.addEventListener(e,o,r),()=>document.removeEventListener(e,o,r)},[n,e,r])}function tUe(n,e,t,r){let s=GC(t);_e.useEffect(()=>{if(!n)return;function o(l){s.current(l)}return window.addEventListener(e,o,r),()=>window.removeEventListener(e,o,r)},[n,e,r])}const vJ=30;function nUe(n,e,t){let r=L8(n,"outside-click"),s=GC(t),o=_e.useCallback(function(a,d){if(a.defaultPrevented)return;let f=d(a);if(f===null||!f.getRootNode().contains(f)||!f.isConnected)return;let m=function _(x){return typeof x=="function"?_(x()):Array.isArray(x)||x instanceof Set?x:[x]}(e);for(let _ of m)if(_!==null&&(_.contains(f)||a.composed&&a.composedPath().includes(_)))return;return!B8(f,D8.Loose)&&f.tabIndex!==-1&&a.preventDefault(),s.current(a,f)},[s,e]),l=_e.useRef(null);RA(r,"pointerdown",a=>{var d,f;l.current=((f=(d=a.composedPath)==null?void 0:d.call(a))==null?void 0:f[0])||a.target},!0),RA(r,"mousedown",a=>{var d,f;l.current=((f=(d=a.composedPath)==null?void 0:d.call(a))==null?void 0:f[0])||a.target},!0),RA(r,"click",a=>{eUe()||l.current&&(o(a,()=>l.current),l.current=null)},!0);let c=_e.useRef({x:0,y:0});RA(r,"touchstart",a=>{c.current.x=a.touches[0].clientX,c.current.y=a.touches[0].clientY},!0),RA(r,"touchend",a=>{let d={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(d.x-c.current.x)>=vJ||Math.abs(d.y-c.current.y)>=vJ))return o(a,()=>a.target instanceof HTMLElement?a.target:null)},!0),tUe(r,"blur",a=>o(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function k8(...n){return _e.useMemo(()=>Jw(...n),[...n])}function rUe(n,e){return _e.useMemo(()=>{var t;if(n.type)return n.type;let r=(t=n.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[n.type,n.as,e])}function iUe(){let n;return{before({doc:e}){var t;let r=e.documentElement,s=(t=e.defaultView)!=null?t:window;n=Math.max(0,s.innerWidth-r.clientWidth)},after({doc:e,d:t}){let r=e.documentElement,s=Math.max(0,r.clientWidth-r.offsetWidth),o=Math.max(0,n-s);t.style(r,"paddingRight",`${o}px`)}}}function sUe(){return aue()?{before({doc:n,d:e,meta:t}){function r(s){return t.containers.flatMap(o=>o()).some(o=>o.contains(s))}e.microTask(()=>{var s;if(window.getComputedStyle(n.documentElement).scrollBehavior!=="auto"){let c=Pp();c.style(n.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>c.dispose()))}let o=(s=window.scrollY)!=null?s:window.pageYOffset,l=null;e.addEventListener(n,"click",c=>{if(c.target instanceof HTMLElement)try{let a=c.target.closest("a");if(!a)return;let{hash:d}=new URL(a.href),f=n.querySelector(d);f&&!r(f)&&(l=f)}catch{}},!0),e.addEventListener(n,"touchstart",c=>{if(c.target instanceof HTMLElement)if(r(c.target)){let a=c.target;for(;a.parentElement&&r(a.parentElement);)a=a.parentElement;e.style(a,"overscrollBehavior","contain")}else e.style(c.target,"touchAction","none")}),e.addEventListener(n,"touchmove",c=>{if(c.target instanceof HTMLElement){if(c.target.tagName==="INPUT")return;if(r(c.target)){let a=c.target;for(;a.parentElement&&a.dataset.headlessuiPortal!==""&&!(a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth);)a=a.parentElement;a.dataset.headlessuiPortal===""&&c.preventDefault()}else c.preventDefault()}},{passive:!1}),e.add(()=>{var c;let a=(c=window.scrollY)!=null?c:window.pageYOffset;o!==a&&window.scrollTo(0,o),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}:{}}function oUe(){return{before({doc:n,d:e}){e.style(n.documentElement,"overflow","hidden")}}}function aUe(n){let e={};for(let t of n)Object.assign(e,t(e));return e}let Hy=nue(()=>new Map,{PUSH(n,e){var t;let r=(t=this.get(n))!=null?t:{doc:n,count:0,d:Pp(),meta:new Set};return r.count++,r.meta.add(e),this.set(n,r),this},POP(n,e){let t=this.get(n);return t&&(t.count--,t.meta.delete(e)),this},SCROLL_PREVENT({doc:n,d:e,meta:t}){let r={doc:n,d:e,meta:aUe(t)},s=[sUe(),iUe(),oUe()];s.forEach(({before:o})=>o==null?void 0:o(r)),s.forEach(({after:o})=>o==null?void 0:o(r))},SCROLL_ALLOW({d:n}){n.dispose()},TEARDOWN({doc:n}){this.delete(n)}});Hy.subscribe(()=>{let n=Hy.getSnapshot(),e=new Map;for(let[t]of n)e.set(t,t.documentElement.style.overflow);for(let t of n.values()){let r=e.get(t.doc)==="hidden",s=t.count!==0;(s&&!r||!s&&r)&&Hy.dispatch(t.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",t),t.count===0&&Hy.dispatch("TEARDOWN",t)}});function lUe(n,e,t=()=>({containers:[]})){let r=rue(Hy),s=e?r.get(e):void 0,o=s?s.count>0:!1;return Pa(()=>{if(!(!e||!n))return Hy.dispatch("PUSH",e,t),()=>Hy.dispatch("POP",e,t)},[n,e]),o}function cUe(n,e,t=()=>[document.body]){let r=L8(n,"scroll-lock");lUe(r,e,s=>{var o;return{containers:[...(o=s.containers)!=null?o:[],t]}})}function _J(n){return[n.screenX,n.screenY]}function uUe(){let n=_e.useRef([-1,-1]);return{wasMoved(e){let t=_J(e);return n.current[0]===t[0]&&n.current[1]===t[1]?!1:(n.current=t,!0)},update(e){n.current=_J(e)}}}function hUe(n=0){let[e,t]=_e.useState(n),r=_e.useCallback(a=>t(a),[e]),s=_e.useCallback(a=>t(d=>d|a),[e]),o=_e.useCallback(a=>(e&a)===a,[e]),l=_e.useCallback(a=>t(d=>d&~a),[t]),c=_e.useCallback(a=>t(d=>d^a),[t]);return{flags:e,setFlag:r,addFlag:s,hasFlag:o,removeFlag:l,toggleFlag:c}}var dUe={},yJ,xJ;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((yJ=process==null?void 0:dUe)==null?void 0:yJ.NODE_ENV)==="test"&&typeof((xJ=Element==null?void 0:Element.prototype)==null?void 0:xJ.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var fUe=(n=>(n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Enter=2]="Enter",n[n.Leave=4]="Leave",n))(fUe||{});function pUe(n){let e={};for(let t in n)n[t]===!0&&(e[`data-${t}`]="");return e}function mUe(n,e,t,r){let[s,o]=_e.useState(t),{hasFlag:l,addFlag:c,removeFlag:a}=hUe(n&&s?3:0),d=_e.useRef(!1),f=_e.useRef(!1),m=HB();return Pa(()=>{var _;if(n){if(t&&o(!0),!e){t&&c(3);return}return(_=void 0)==null||_.call(r,t),gUe(e,{inFlight:d,prepare(){f.current?f.current=!1:f.current=d.current,d.current=!0,!f.current&&(t?(c(3),a(4)):(c(4),a(2)))},run(){f.current?t?(a(3),c(4)):(a(4),c(3)):t?a(1):c(1)},done(){var x;f.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(d.current=!1,a(7),t||o(!1),(x=void 0)==null||x.call(r,t))}})}},[n,t,e,m]),n?[s,{closed:l(1),enter:l(2),leave:l(4),transition:l(2)||l(4)}]:[t,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function gUe(n,{prepare:e,run:t,done:r,inFlight:s}){let o=Pp();return _Ue(n,{prepare:e,inFlight:s}),o.nextFrame(()=>{t(),o.requestAnimationFrame(()=>{o.add(vUe(n,r))})}),o.dispose}function vUe(n,e){var t,r;let s=Pp();if(!n)return s.dispose;let o=!1;s.add(()=>{o=!0});let l=(r=(t=n.getAnimations)==null?void 0:t.call(n).filter(c=>c instanceof CSSTransition))!=null?r:[];return l.length===0?(e(),s.dispose):(Promise.allSettled(l.map(c=>c.finished)).then(()=>{o||e()}),s.dispose)}function _Ue(n,{inFlight:e,prepare:t}){if(e!=null&&e.current){t();return}let r=n.style.transition;n.style.transition="none",t(),n.offsetHeight,n.style.transition=r}function yUe(n,{container:e,accept:t,walk:r}){let s=_e.useRef(t),o=_e.useRef(r);_e.useEffect(()=>{s.current=t,o.current=r},[t,r]),Pa(()=>{if(!e||!n)return;let l=Jw(e);if(!l)return;let c=s.current,a=o.current,d=Object.assign(m=>c(m),{acceptNode:c}),f=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;f.nextNode();)a(f.currentNode)},[e,n,s,o])}function WB(){return typeof window<"u"}function Qw(n){return lue(n)?(n.nodeName||"").toLowerCase():"#document"}function Vu(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Rp(n){var e;return(e=(lue(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function lue(n){return WB()?n instanceof Node||n instanceof Vu(n).Node:!1}function Ic(n){return WB()?n instanceof Element||n instanceof Vu(n).Element:!1}function Ap(n){return WB()?n instanceof HTMLElement||n instanceof Vu(n).HTMLElement:!1}function bJ(n){return!WB()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Vu(n).ShadowRoot}function HC(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=of(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function xUe(n){return["table","td","th"].includes(Qw(n))}function $B(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function O8(n){const e=F8(),t=Ic(n)?of(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function bUe(n){let e=P0(n);for(;Ap(e)&&!Iw(e);){if(O8(e))return e;if($B(e))return null;e=P0(e)}return null}function F8(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Iw(n){return["html","body","#document"].includes(Qw(n))}function of(n){return Vu(n).getComputedStyle(n)}function XB(n){return Ic(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function P0(n){if(Qw(n)==="html")return n;const e=n.assignedSlot||n.parentNode||bJ(n)&&n.host||Rp(n);return bJ(e)?e.host:e}function cue(n){const e=P0(n);return Iw(e)?n.ownerDocument?n.ownerDocument.body:n.body:Ap(e)&&HC(e)?e:cue(e)}function WM(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=cue(n),o=s===((r=n.ownerDocument)==null?void 0:r.body),l=Vu(s);if(o){const c=eU(l);return e.concat(l,l.visualViewport||[],HC(s)?s:[],c&&t?WM(c):[])}return e.concat(s,WM(s,[],t))}function eU(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function wUe(){const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?n.brands.map(e=>{let{brand:t,version:r}=e;return t+"/"+r}).join(" "):navigator.userAgent}const Mx=Math.min,ql=Math.max,$M=Math.round,$I=Math.floor,yp=n=>({x:n,y:n}),SUe={left:"right",right:"left",bottom:"top",top:"bottom"},AUe={start:"end",end:"start"};function wJ(n,e,t){return ql(n,Mx(e,t))}function eS(n,e){return typeof n=="function"?n(e):n}function R0(n){return n.split("-")[0]}function jC(n){return n.split("-")[1]}function uue(n){return n==="x"?"y":"x"}function hue(n){return n==="y"?"height":"width"}function Cx(n){return["top","bottom"].includes(R0(n))?"y":"x"}function due(n){return uue(Cx(n))}function TUe(n,e,t){t===void 0&&(t=!1);const r=jC(n),s=due(n),o=hue(s);let l=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(l=FL(l)),[l,FL(l)]}function MUe(n){const e=FL(n);return[tU(n),e,tU(e)]}function tU(n){return n.replace(/start|end/g,e=>AUe[e])}function CUe(n,e,t){const r=["left","right"],s=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?o:l;default:return[]}}function EUe(n,e,t,r){const s=jC(n);let o=CUe(R0(n),t==="start",r);return s&&(o=o.map(l=>l+"-"+s),e&&(o=o.concat(o.map(tU)))),o}function FL(n){return n.replace(/left|right|bottom|top/g,e=>SUe[e])}function IUe(n){return{top:0,right:0,bottom:0,left:0,...n}}function PUe(n){return typeof n!="number"?IUe(n):{top:n,right:n,bottom:n,left:n}}function NL(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function SJ(n,e,t){let{reference:r,floating:s}=n;const o=Cx(e),l=due(e),c=hue(l),a=R0(e),d=o==="y",f=r.x+r.width/2-s.width/2,m=r.y+r.height/2-s.height/2,_=r[c]/2-s[c]/2;let x;switch(a){case"top":x={x:f,y:r.y-s.height};break;case"bottom":x={x:f,y:r.y+r.height};break;case"right":x={x:r.x+r.width,y:m};break;case"left":x={x:r.x-s.width,y:m};break;default:x={x:r.x,y:r.y}}switch(jC(e)){case"start":x[l]-=_*(t&&d?-1:1);break;case"end":x[l]+=_*(t&&d?-1:1);break}return x}const RUe=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),a=await(l.isRTL==null?void 0:l.isRTL(e));let d=await l.getElementRects({reference:n,floating:e,strategy:s}),{x:f,y:m}=SJ(d,r,a),_=r,x={},A=0;for(let I=0;I<c.length;I++){const{name:E,fn:C}=c[I],{x:L,y:O,data:H,reset:q}=await C({x:f,y:m,initialPlacement:r,placement:_,strategy:s,middlewareData:x,rects:d,platform:l,elements:{reference:n,floating:e}});f=L??f,m=O??m,x={...x,[E]:{...x[E],...H}},q&&A<=50&&(A++,typeof q=="object"&&(q.placement&&(_=q.placement),q.rects&&(d=q.rects===!0?await l.getElementRects({reference:n,floating:e,strategy:s}):q.rects),{x:f,y:m}=SJ(d,_,a)),I=-1)}return{x:f,y:m,placement:_,strategy:s,middlewareData:x}};async function qB(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:o,rects:l,elements:c,strategy:a}=n,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:m="floating",altBoundary:_=!1,padding:x=0}=eS(e,n),A=PUe(x),E=c[_?m==="floating"?"reference":"floating":m],C=NL(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(E)))==null||t?E:E.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:d,rootBoundary:f,strategy:a})),L=m==="floating"?{x:r,y:s,width:l.floating.width,height:l.floating.height}:l.reference,O=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),H=await(o.isElement==null?void 0:o.isElement(O))?await(o.getScale==null?void 0:o.getScale(O))||{x:1,y:1}:{x:1,y:1},q=NL(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:L,offsetParent:O,strategy:a}):L);return{top:(C.top-q.top+A.top)/H.y,bottom:(q.bottom-C.bottom+A.bottom)/H.y,left:(C.left-q.left+A.left)/H.x,right:(q.right-C.right+A.right)/H.x}}const LUe=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:o,rects:l,initialPlacement:c,platform:a,elements:d}=e,{mainAxis:f=!0,crossAxis:m=!0,fallbackPlacements:_,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:A="none",flipAlignment:I=!0,...E}=eS(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const C=R0(s),L=Cx(c),O=R0(c)===c,H=await(a.isRTL==null?void 0:a.isRTL(d.floating)),q=_||(O||!I?[FL(c)]:MUe(c)),Z=A!=="none";!_&&Z&&q.push(...EUe(c,I,A,H));const J=[c,...q],re=await qB(e,E),se=[];let ae=((r=o.flip)==null?void 0:r.overflows)||[];if(f&&se.push(re[C]),m){const Pe=TUe(s,l,H);se.push(re[Pe[0]],re[Pe[1]])}if(ae=[...ae,{placement:s,overflows:se}],!se.every(Pe=>Pe<=0)){var he,Ae;const Pe=(((he=o.flip)==null?void 0:he.index)||0)+1,ze=J[Pe];if(ze)return{data:{index:Pe,overflows:ae},reset:{placement:ze}};let Re=(Ae=ae.filter(rt=>rt.overflows[0]<=0).sort((rt,ye)=>rt.overflows[1]-ye.overflows[1])[0])==null?void 0:Ae.placement;if(!Re)switch(x){case"bestFit":{var Ee;const rt=(Ee=ae.filter(ye=>{if(Z){const We=Cx(ye.placement);return We===L||We==="y"}return!0}).map(ye=>[ye.placement,ye.overflows.filter(We=>We>0).reduce((We,Ue)=>We+Ue,0)]).sort((ye,We)=>ye[1]-We[1])[0])==null?void 0:Ee[0];rt&&(Re=rt);break}case"initialPlacement":Re=c;break}if(s!==Re)return{reset:{placement:Re}}}return{}}}};async function DUe(n,e){const{placement:t,platform:r,elements:s}=n,o=await(r.isRTL==null?void 0:r.isRTL(s.floating)),l=R0(t),c=jC(t),a=Cx(t)==="y",d=["left","top"].includes(l)?-1:1,f=o&&a?-1:1,m=eS(e,n);let{mainAxis:_,crossAxis:x,alignmentAxis:A}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof A=="number"&&(x=c==="end"?A*-1:A),a?{x:x*f,y:_*d}:{x:_*d,y:x*f}}const BUe=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:o,placement:l,middlewareData:c}=e,a=await DUe(e,n);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:s+a.x,y:o+a.y,data:{...a,placement:l}}}}},kUe=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:E=>{let{x:C,y:L}=E;return{x:C,y:L}}},...a}=eS(n,e),d={x:t,y:r},f=await qB(e,a),m=Cx(R0(s)),_=uue(m);let x=d[_],A=d[m];if(o){const E=_==="y"?"top":"left",C=_==="y"?"bottom":"right",L=x+f[E],O=x-f[C];x=wJ(L,x,O)}if(l){const E=m==="y"?"top":"left",C=m==="y"?"bottom":"right",L=A+f[E],O=A-f[C];A=wJ(L,A,O)}const I=c.fn({...e,[_]:x,[m]:A});return{...I,data:{x:I.x-t,y:I.y-r,enabled:{[_]:o,[m]:l}}}}}},OUe=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:o,platform:l,elements:c}=e,{apply:a=()=>{},...d}=eS(n,e),f=await qB(e,d),m=R0(s),_=jC(s),x=Cx(s)==="y",{width:A,height:I}=o.floating;let E,C;m==="top"||m==="bottom"?(E=m,C=_===(await(l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(C=m,E=_==="end"?"top":"bottom");const L=I-f.top-f.bottom,O=A-f.left-f.right,H=Mx(I-f[E],L),q=Mx(A-f[C],O),Z=!e.middlewareData.shift;let J=H,re=q;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(re=O),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(J=L),Z&&!_){const ae=ql(f.left,0),he=ql(f.right,0),Ae=ql(f.top,0),Ee=ql(f.bottom,0);x?re=A-2*(ae!==0||he!==0?ae+he:ql(f.left,f.right)):J=I-2*(Ae!==0||Ee!==0?Ae+Ee:ql(f.top,f.bottom))}await a({...e,availableWidth:re,availableHeight:J});const se=await l.getDimensions(c.floating);return A!==se.width||I!==se.height?{reset:{rects:!0}}:{}}}};function fue(n){const e=of(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Ap(n),o=s?n.offsetWidth:t,l=s?n.offsetHeight:r,c=$M(t)!==o||$M(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function N8(n){return Ic(n)?n:n.contextElement}function ow(n){const e=N8(n);if(!Ap(e))return yp(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:o}=fue(e);let l=(o?$M(t.width):t.width)/r,c=(o?$M(t.height):t.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const FUe=yp(0);function pue(n){const e=Vu(n);return!F8()||!e.visualViewport?FUe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function NUe(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Vu(n)?!1:e}function Ex(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),o=N8(n);let l=yp(1);e&&(r?Ic(r)&&(l=ow(r)):l=ow(n));const c=NUe(o,t,r)?pue(o):yp(0);let a=(s.left+c.x)/l.x,d=(s.top+c.y)/l.y,f=s.width/l.x,m=s.height/l.y;if(o){const _=Vu(o),x=r&&Ic(r)?Vu(r):r;let A=_,I=eU(A);for(;I&&r&&x!==A;){const E=ow(I),C=I.getBoundingClientRect(),L=of(I),O=C.left+(I.clientLeft+parseFloat(L.paddingLeft))*E.x,H=C.top+(I.clientTop+parseFloat(L.paddingTop))*E.y;a*=E.x,d*=E.y,f*=E.x,m*=E.y,a+=O,d+=H,A=Vu(I),I=eU(A)}}return NL({width:f,height:m,x:a,y:d})}function z8(n,e){const t=XB(n).scrollLeft;return e?e.left+t:Ex(Rp(n)).left+t}function mue(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:z8(n,r)),o=r.top+e.scrollTop;return{x:s,y:o}}function zUe(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const o=s==="fixed",l=Rp(r),c=e?$B(e.floating):!1;if(r===l||c&&o)return t;let a={scrollLeft:0,scrollTop:0},d=yp(1);const f=yp(0),m=Ap(r);if((m||!m&&!o)&&((Qw(r)!=="body"||HC(l))&&(a=XB(r)),Ap(r))){const x=Ex(r);d=ow(r),f.x=x.x+r.clientLeft,f.y=x.y+r.clientTop}const _=l&&!m&&!o?mue(l,a,!0):yp(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-a.scrollLeft*d.x+f.x+_.x,y:t.y*d.y-a.scrollTop*d.y+f.y+_.y}}function UUe(n){return Array.from(n.getClientRects())}function GUe(n){const e=Rp(n),t=XB(n),r=n.ownerDocument.body,s=ql(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=ql(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+z8(n);const c=-t.scrollTop;return of(r).direction==="rtl"&&(l+=ql(e.clientWidth,r.clientWidth)-s),{width:s,height:o,x:l,y:c}}function VUe(n,e){const t=Vu(n),r=Rp(n),s=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,a=0;if(s){o=s.width,l=s.height;const d=F8();(!d||d&&e==="fixed")&&(c=s.offsetLeft,a=s.offsetTop)}return{width:o,height:l,x:c,y:a}}function HUe(n,e){const t=Ex(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,o=Ap(n)?ow(n):yp(1),l=n.clientWidth*o.x,c=n.clientHeight*o.y,a=s*o.x,d=r*o.y;return{width:l,height:c,x:a,y:d}}function AJ(n,e,t){let r;if(e==="viewport")r=VUe(n,t);else if(e==="document")r=GUe(Rp(n));else if(Ic(e))r=HUe(e,t);else{const s=pue(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return NL(r)}function gue(n,e){const t=P0(n);return t===e||!Ic(t)||Iw(t)?!1:of(t).position==="fixed"||gue(t,e)}function jUe(n,e){const t=e.get(n);if(t)return t;let r=WM(n,[],!1).filter(c=>Ic(c)&&Qw(c)!=="body"),s=null;const o=of(n).position==="fixed";let l=o?P0(n):n;for(;Ic(l)&&!Iw(l);){const c=of(l),a=O8(l);!a&&c.position==="fixed"&&(s=null),(o?!a&&!s:!a&&c.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||HC(l)&&!a&&gue(n,l))?r=r.filter(f=>f!==l):s=c,l=P0(l)}return e.set(n,r),r}function WUe(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const l=[...t==="clippingAncestors"?$B(e)?[]:jUe(e,this._c):[].concat(t),r],c=l[0],a=l.reduce((d,f)=>{const m=AJ(e,f,s);return d.top=ql(m.top,d.top),d.right=Mx(m.right,d.right),d.bottom=Mx(m.bottom,d.bottom),d.left=ql(m.left,d.left),d},AJ(e,c,s));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function $Ue(n){const{width:e,height:t}=fue(n);return{width:e,height:t}}function XUe(n,e,t){const r=Ap(e),s=Rp(e),o=t==="fixed",l=Ex(n,!0,o,e);let c={scrollLeft:0,scrollTop:0};const a=yp(0);if(r||!r&&!o)if((Qw(e)!=="body"||HC(s))&&(c=XB(e)),r){const _=Ex(e,!0,o,e);a.x=_.x+e.clientLeft,a.y=_.y+e.clientTop}else s&&(a.x=z8(s));const d=s&&!r&&!o?mue(s,c):yp(0),f=l.left+c.scrollLeft-a.x-d.x,m=l.top+c.scrollTop-a.y-d.y;return{x:f,y:m,width:l.width,height:l.height}}function RN(n){return of(n).position==="static"}function TJ(n,e){if(!Ap(n)||of(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Rp(n)===t&&(t=t.ownerDocument.body),t}function vue(n,e){const t=Vu(n);if($B(n))return t;if(!Ap(n)){let s=P0(n);for(;s&&!Iw(s);){if(Ic(s)&&!RN(s))return s;s=P0(s)}return t}let r=TJ(n,e);for(;r&&xUe(r)&&RN(r);)r=TJ(r,e);return r&&Iw(r)&&RN(r)&&!O8(r)?t:r||bUe(n)||t}const qUe=async function(n){const e=this.getOffsetParent||vue,t=this.getDimensions,r=await t(n.floating);return{reference:XUe(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YUe(n){return of(n).direction==="rtl"}const ZUe={convertOffsetParentRelativeRectToViewportRelativeRect:zUe,getDocumentElement:Rp,getClippingRect:WUe,getOffsetParent:vue,getElementRects:qUe,getClientRects:UUe,getDimensions:$Ue,getScale:ow,isElement:Ic,isRTL:YUe};function KUe(n,e){let t=null,r;const s=Rp(n);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,a){c===void 0&&(c=!1),a===void 0&&(a=1),o();const{left:d,top:f,width:m,height:_}=n.getBoundingClientRect();if(c||e(),!m||!_)return;const x=$I(f),A=$I(s.clientWidth-(d+m)),I=$I(s.clientHeight-(f+_)),E=$I(d),L={rootMargin:-x+"px "+-A+"px "+-I+"px "+-E+"px",threshold:ql(0,Mx(1,a))||1};let O=!0;function H(q){const Z=q[0].intersectionRatio;if(Z!==a){if(!O)return l();Z?l(!1,Z):r=setTimeout(()=>{l(!1,1e-7)},1e3)}O=!1}try{t=new IntersectionObserver(H,{...L,root:s.ownerDocument})}catch{t=new IntersectionObserver(H,L)}t.observe(n)}return l(!0),o}function JUe(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,d=N8(n),f=s||o?[...d?WM(d):[],...WM(e)]:[];f.forEach(C=>{s&&C.addEventListener("scroll",t,{passive:!0}),o&&C.addEventListener("resize",t)});const m=d&&c?KUe(d,t):null;let _=-1,x=null;l&&(x=new ResizeObserver(C=>{let[L]=C;L&&L.target===d&&x&&(x.unobserve(e),cancelAnimationFrame(_),_=requestAnimationFrame(()=>{var O;(O=x)==null||O.observe(e)})),t()}),d&&!a&&x.observe(d),x.observe(e));let A,I=a?Ex(n):null;a&&E();function E(){const C=Ex(n);I&&(C.x!==I.x||C.y!==I.y||C.width!==I.width||C.height!==I.height)&&t(),I=C,A=requestAnimationFrame(E)}return t(),()=>{var C;f.forEach(L=>{s&&L.removeEventListener("scroll",t),o&&L.removeEventListener("resize",t)}),m==null||m(),(C=x)==null||C.disconnect(),x=null,a&&cancelAnimationFrame(A)}}const LN=qB,QUe=BUe,e6e=kUe,t6e=LUe,n6e=OUe,r6e=(n,e,t)=>{const r=new Map,s={platform:ZUe,...t},o={...s.platform,_c:r};return RUe(n,e,{...s,platform:o})};var kP=typeof document<"u"?_e.useLayoutEffect:_e.useEffect;function zL(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!zL(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const o=s[r];if(!(o==="_owner"&&n.$$typeof)&&!zL(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}function _ue(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function MJ(n,e){const t=_ue(n);return Math.round(e*t)/t}function DN(n){const e=_e.useRef(n);return kP(()=>{e.current=n}),e}function i6e(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:a,open:d}=n,[f,m]=_e.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[_,x]=_e.useState(r);zL(_,r)||x(r);const[A,I]=_e.useState(null),[E,C]=_e.useState(null),L=_e.useCallback(ye=>{ye!==Z.current&&(Z.current=ye,I(ye))},[]),O=_e.useCallback(ye=>{ye!==J.current&&(J.current=ye,C(ye))},[]),H=o||A,q=l||E,Z=_e.useRef(null),J=_e.useRef(null),re=_e.useRef(f),se=a!=null,ae=DN(a),he=DN(s),Ae=DN(d),Ee=_e.useCallback(()=>{if(!Z.current||!J.current)return;const ye={placement:e,strategy:t,middleware:_};he.current&&(ye.platform=he.current),r6e(Z.current,J.current,ye).then(We=>{const Ue={...We,isPositioned:Ae.current!==!1};Pe.current&&!zL(re.current,Ue)&&(re.current=Ue,Dh.flushSync(()=>{m(Ue)}))})},[_,e,t,he,Ae]);kP(()=>{d===!1&&re.current.isPositioned&&(re.current.isPositioned=!1,m(ye=>({...ye,isPositioned:!1})))},[d]);const Pe=_e.useRef(!1);kP(()=>(Pe.current=!0,()=>{Pe.current=!1}),[]),kP(()=>{if(H&&(Z.current=H),q&&(J.current=q),H&&q){if(ae.current)return ae.current(H,q,Ee);Ee()}},[H,q,Ee,ae,se]);const ze=_e.useMemo(()=>({reference:Z,floating:J,setReference:L,setFloating:O}),[L,O]),Re=_e.useMemo(()=>({reference:H,floating:q}),[H,q]),rt=_e.useMemo(()=>{const ye={position:t,left:0,top:0};if(!Re.floating)return ye;const We=MJ(Re.floating,f.x),Ue=MJ(Re.floating,f.y);return c?{...ye,transform:"translate("+We+"px, "+Ue+"px)",..._ue(Re.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:We,top:Ue}},[t,c,Re.floating,f.x,f.y]);return _e.useMemo(()=>({...f,update:Ee,refs:ze,elements:Re,floatingStyles:rt}),[f,Ee,ze,Re,rt])}const yue=(n,e)=>({...QUe(n),options:[n,e]}),s6e=(n,e)=>({...e6e(n),options:[n,e]}),o6e=(n,e)=>({...t6e(n),options:[n,e]}),a6e=(n,e)=>({...n6e(n),options:[n,e]}),xue={...UP},l6e=xue.useInsertionEffect,c6e=l6e||(n=>n());function bue(n){const e=_e.useRef(()=>{});return c6e(()=>{e.current=n}),_e.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var nU=typeof document<"u"?_e.useLayoutEffect:_e.useEffect;let CJ=!1,u6e=0;const EJ=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+u6e++;function h6e(){const[n,e]=_e.useState(()=>CJ?EJ():void 0);return nU(()=>{n==null&&e(EJ())},[]),_e.useEffect(()=>{CJ=!0},[]),n}const d6e=xue.useId,f6e=d6e||h6e;function p6e(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(s=>s(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(s=>s!==t))||[])}}}const m6e=_e.createContext(null),g6e=_e.createContext(null),v6e=()=>{var n;return((n=_e.useContext(m6e))==null?void 0:n.id)||null},_6e=()=>_e.useContext(g6e),y6e="data-floating-ui-focusable";function x6e(n){const{open:e=!1,onOpenChange:t,elements:r}=n,s=f6e(),o=_e.useRef({}),[l]=_e.useState(()=>p6e()),c=v6e()!=null,[a,d]=_e.useState(r.reference),f=bue((x,A,I)=>{o.current.openEvent=x?A:void 0,l.emit("openchange",{open:x,event:A,reason:I,nested:c}),t==null||t(x,A,I)}),m=_e.useMemo(()=>({setPositionReference:d}),[]),_=_e.useMemo(()=>({reference:a||r.reference||null,floating:r.floating||null,domReference:r.reference}),[a,r.reference,r.floating]);return _e.useMemo(()=>({dataRef:o,open:e,onOpenChange:f,elements:_,events:l,floatingId:s,refs:m}),[e,f,_,l,s,m])}function b6e(n){n===void 0&&(n={});const{nodeId:e}=n,t=x6e({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[o,l]=_e.useState(null),[c,a]=_e.useState(null),f=(s==null?void 0:s.domReference)||o,m=_e.useRef(null),_=_6e();nU(()=>{f&&(m.current=f)},[f]);const x=i6e({...n,elements:{...s,...c&&{reference:c}}}),A=_e.useCallback(O=>{const H=Ic(O)?{getBoundingClientRect:()=>O.getBoundingClientRect(),contextElement:O}:O;a(H),x.refs.setReference(H)},[x.refs]),I=_e.useCallback(O=>{(Ic(O)||O===null)&&(m.current=O,l(O)),(Ic(x.refs.reference.current)||x.refs.reference.current===null||O!==null&&!Ic(O))&&x.refs.setReference(O)},[x.refs]),E=_e.useMemo(()=>({...x.refs,setReference:I,setPositionReference:A,domReference:m}),[x.refs,I,A]),C=_e.useMemo(()=>({...x.elements,domReference:f}),[x.elements,f]),L=_e.useMemo(()=>({...x,...r,refs:E,elements:C,nodeId:e}),[x,E,C,e,r]);return nU(()=>{r.dataRef.current.floatingContext=L;const O=_==null?void 0:_.nodesRef.current.find(H=>H.id===e);O&&(O.context=L)}),_e.useMemo(()=>({...x,context:L,refs:E,elements:C}),[x,E,C,L])}const IJ="active",PJ="selected";function BN(n,e,t){const r=new Map,s=t==="item";let o=n;if(s&&n){const{[IJ]:l,[PJ]:c,...a}=n;o=a}return{...t==="floating"&&{tabIndex:-1,[y6e]:""},...o,...e.map(l=>{const c=l?l[t]:null;return typeof c=="function"?n?c(n):null:c}).concat(n).reduce((l,c)=>(c&&Object.entries(c).forEach(a=>{let[d,f]=a;if(!(s&&[IJ,PJ].includes(d)))if(d.indexOf("on")===0){if(r.has(d)||r.set(d,[]),typeof f=="function"){var m;(m=r.get(d))==null||m.push(f),l[d]=function(){for(var _,x=arguments.length,A=new Array(x),I=0;I<x;I++)A[I]=arguments[I];return(_=r.get(d))==null?void 0:_.map(E=>E(...A)).find(E=>E!==void 0)}}}else l[d]=f}),l),{})}}function w6e(n){n===void 0&&(n=[]);const e=n.map(c=>c==null?void 0:c.reference),t=n.map(c=>c==null?void 0:c.floating),r=n.map(c=>c==null?void 0:c.item),s=_e.useCallback(c=>BN(c,n,"reference"),e),o=_e.useCallback(c=>BN(c,n,"floating"),t),l=_e.useCallback(c=>BN(c,n,"item"),r);return _e.useMemo(()=>({getReferenceProps:s,getFloatingProps:o,getItemProps:l}),[s,o,l])}function RJ(n,e){return{...n,rects:{...n.rects,floating:{...n.rects.floating,height:e}}}}const S6e=n=>({name:"inner",options:n,async fn(e){const{listRef:t,overflowRef:r,onFallbackChange:s,offset:o=0,index:l=0,minItemsVisible:c=4,referenceOverflowThreshold:a=0,scrollRef:d,...f}=eS(n,e),{rects:m,elements:{floating:_}}=e,x=t.current[l],A=(d==null?void 0:d.current)||_,I=_.clientTop||A.clientTop,E=_.clientTop!==0,C=A.clientTop!==0,L=_===A;if(!x)return{};const O={...e,...await yue(-x.offsetTop-_.clientTop-m.reference.height/2-x.offsetHeight/2-o).fn(e)},H=await LN(RJ(O,A.scrollHeight+I+_.clientTop),f),q=await LN(O,{...f,elementContext:"reference"}),Z=ql(0,H.top),J=O.y+Z,ae=(A.scrollHeight>A.clientHeight?he=>he:$M)(ql(0,A.scrollHeight+(E&&L||C?I*2:0)-Z-ql(0,H.bottom)));if(A.style.maxHeight=ae+"px",A.scrollTop=Z,s){const he=A.offsetHeight<x.offsetHeight*Mx(c,t.current.length)-1||q.top>=-a||q.bottom>=-a;Dh.flushSync(()=>s(he))}return r&&(r.current=await LN(RJ({...O,y:J},A.offsetHeight+I+_.clientTop),f)),{y:J}}});function A6e(n,e){const{open:t,elements:r}=n,{enabled:s=!0,overflowRef:o,scrollRef:l,onChange:c}=e,a=bue(c),d=_e.useRef(!1),f=_e.useRef(null),m=_e.useRef(null);_e.useEffect(()=>{if(!s)return;function x(I){if(I.ctrlKey||!A||o.current==null)return;const E=I.deltaY,C=o.current.top>=-.5,L=o.current.bottom>=-.5,O=A.scrollHeight-A.clientHeight,H=E<0?-1:1,q=E<0?"max":"min";A.scrollHeight<=A.clientHeight||(!C&&E>0||!L&&E<0?(I.preventDefault(),Dh.flushSync(()=>{a(Z=>Z+Math[q](E,O*H))})):/firefox/i.test(wUe())&&(A.scrollTop+=E))}const A=(l==null?void 0:l.current)||r.floating;if(t&&A)return A.addEventListener("wheel",x),requestAnimationFrame(()=>{f.current=A.scrollTop,o.current!=null&&(m.current={...o.current})}),()=>{f.current=null,m.current=null,A.removeEventListener("wheel",x)}},[s,t,r.floating,o,l,a]);const _=_e.useMemo(()=>({onKeyDown(){d.current=!0},onWheel(){d.current=!1},onPointerMove(){d.current=!1},onScroll(){const x=(l==null?void 0:l.current)||r.floating;if(!(!o.current||!x||!d.current)){if(f.current!==null){const A=x.scrollTop-f.current;(o.current.bottom<-.5&&A<-1||o.current.top<-.5&&A>1)&&Dh.flushSync(()=>a(I=>I+A))}requestAnimationFrame(()=>{f.current=x.scrollTop})}}}),[r.floating,a,o,l]);return _e.useMemo(()=>s?{floating:_}:{},[s,_])}let tS=_e.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});tS.displayName="FloatingContext";let U8=_e.createContext(null);U8.displayName="PlacementContext";function T6e(n){return _e.useMemo(()=>n?typeof n=="string"?{to:n}:n:null,[n])}function M6e(){return _e.useContext(tS).setReference}function C6e(){return _e.useContext(tS).getReferenceProps}function E6e(){let{getFloatingProps:n,slot:e}=_e.useContext(tS);return _e.useCallback((...t)=>Object.assign({},n(...t),{"data-anchor":e.anchor}),[n,e])}function I6e(n=null){n===!1&&(n=null),typeof n=="string"&&(n={to:n});let e=_e.useContext(U8),t=_e.useMemo(()=>n,[JSON.stringify(n,(s,o)=>{var l;return(l=o==null?void 0:o.outerHTML)!=null?l:o})]);Pa(()=>{e==null||e(t??null)},[e,t]);let r=_e.useContext(tS);return _e.useMemo(()=>[r.setFloating,n?r.styles:{}],[r.setFloating,n,r.styles])}let LJ=4;function P6e({children:n,enabled:e=!0}){let[t,r]=_e.useState(null),[s,o]=_e.useState(0),l=_e.useRef(null),[c,a]=_e.useState(null);R6e(c);let d=e&&t!==null&&c!==null,{to:f="bottom",gap:m=0,offset:_=0,padding:x=0,inner:A}=L6e(t,c),[I,E="center"]=f.split(" ");Pa(()=>{d&&o(0)},[d]);let{refs:C,floatingStyles:L,context:O}=b6e({open:d,placement:I==="selection"?E==="center"?"bottom":`bottom-${E}`:E==="center"?`${I}`:`${I}-${E}`,strategy:"absolute",transform:!1,middleware:[yue({mainAxis:I==="selection"?0:m,crossAxis:_}),s6e({padding:x}),I!=="selection"&&o6e({padding:x}),I==="selection"&&A?S6e({...A,padding:x,overflowRef:l,offset:s,minItemsVisible:LJ,referenceOverflowThreshold:x,onFallbackChange(he){var Ae,Ee;if(!he)return;let Pe=O.elements.floating;if(!Pe)return;let ze=parseFloat(getComputedStyle(Pe).scrollPaddingBottom)||0,Re=Math.min(LJ,Pe.childElementCount),rt=0,ye=0;for(let We of(Ee=(Ae=O.elements.floating)==null?void 0:Ae.childNodes)!=null?Ee:[])if(We instanceof HTMLElement){let Ue=We.offsetTop,gt=Ue+We.clientHeight+ze,vt=Pe.scrollTop,Dt=vt+Pe.clientHeight;if(Ue>=vt&&gt<=Dt)Re--;else{ye=Math.max(0,Math.min(gt,Dt)-Math.max(Ue,vt)),rt=We.clientHeight;break}}Re>=1&&o(We=>{let Ue=rt*Re-ye+ze;return We>=Ue?We:Ue})}}):null,a6e({padding:x,apply({availableWidth:he,availableHeight:Ae,elements:Ee}){Object.assign(Ee.floating.style,{overflow:"auto",maxWidth:`${he}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${Ae}px)`})}})].filter(Boolean),whileElementsMounted:JUe}),[H=I,q=E]=O.placement.split("-");I==="selection"&&(H="selection");let Z=_e.useMemo(()=>({anchor:[H,q].filter(Boolean).join(" ")}),[H,q]),J=A6e(O,{overflowRef:l,onChange:o}),{getReferenceProps:re,getFloatingProps:se}=w6e([J]),ae=Po(he=>{a(he),C.setFloating(he)});return _e.createElement(U8.Provider,{value:r},_e.createElement(tS.Provider,{value:{setFloating:ae,setReference:C.setReference,styles:L,getReferenceProps:re,getFloatingProps:se,slot:Z}},n))}function R6e(n){Pa(()=>{if(!n)return;let e=new MutationObserver(()=>{let t=window.getComputedStyle(n).maxHeight,r=parseFloat(t);if(isNaN(r))return;let s=parseInt(t);isNaN(s)||r!==s&&(n.style.maxHeight=`${Math.ceil(r)}px`)});return e.observe(n,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[n])}function L6e(n,e){var t,r,s;let o=kN((t=n==null?void 0:n.gap)!=null?t:"var(--anchor-gap, 0)",e),l=kN((r=n==null?void 0:n.offset)!=null?r:"var(--anchor-offset, 0)",e),c=kN((s=n==null?void 0:n.padding)!=null?s:"var(--anchor-padding, 0)",e);return{...n,gap:o,offset:l,padding:c}}function kN(n,e,t=void 0){let r=HB(),s=Po((a,d)=>{if(a==null)return[t,null];if(typeof a=="number")return[a,null];if(typeof a=="string"){if(!d)return[t,null];let f=DJ(a,d);return[f,m=>{let _=wue(a);{let x=_.map(A=>window.getComputedStyle(d).getPropertyValue(A));r.requestAnimationFrame(function A(){r.nextFrame(A);let I=!1;for(let[C,L]of _.entries()){let O=window.getComputedStyle(d).getPropertyValue(L);if(x[C]!==O){x[C]=O,I=!0;break}}if(!I)return;let E=DJ(a,d);f!==E&&(m(E),f=E)})}return r.dispose}]}return[t,null]}),o=_e.useMemo(()=>s(n,e)[0],[n,e]),[l=o,c]=_e.useState();return Pa(()=>{let[a,d]=s(n,e);if(c(a),!!d)return d(c)},[n,e]),l}function wue(n){let e=/var\((.*)\)/.exec(n);if(e){let t=e[1].indexOf(",");if(t===-1)return[e[1]];let r=e[1].slice(0,t).trim(),s=e[1].slice(t+1).trim();return s?[r,...wue(s)]:[r]}return[]}function DJ(n,e){let t=document.createElement("div");e.appendChild(t),t.style.setProperty("margin-top","0px","important"),t.style.setProperty("margin-top",n,"important");let r=parseFloat(window.getComputedStyle(t).marginTop)||0;return e.removeChild(t),r}let G8=_e.createContext(null);G8.displayName="OpenClosedContext";var XM=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(XM||{});function D6e(){return _e.useContext(G8)}function B6e({value:n,children:e}){return Al.createElement(G8.Provider,{value:n},e)}function k6e(n){throw new Error("Unexpected object: "+n)}var Yl=(n=>(n[n.First=0]="First",n[n.Previous=1]="Previous",n[n.Next=2]="Next",n[n.Last=3]="Last",n[n.Specific=4]="Specific",n[n.Nothing=5]="Nothing",n))(Yl||{});function ON(n,e){let t=e.resolveItems();if(t.length<=0)return null;let r=e.resolveActiveIndex(),s=r??-1;switch(n.focus){case 0:{for(let o=0;o<t.length;++o)if(!e.resolveDisabled(t[o],o,t))return o;return r}case 1:{s===-1&&(s=t.length);for(let o=s-1;o>=0;--o)if(!e.resolveDisabled(t[o],o,t))return o;return r}case 2:{for(let o=s+1;o<t.length;++o)if(!e.resolveDisabled(t[o],o,t))return o;return r}case 3:{for(let o=t.length-1;o>=0;--o)if(!e.resolveDisabled(t[o],o,t))return o;return r}case 4:{for(let o=0;o<t.length;++o)if(e.resolveId(t[o],o,t)===n.id)return o;return r}case 5:return null;default:k6e(n)}}function O6e(n){let e=Po(n),t=_e.useRef(!1);_e.useEffect(()=>(t.current=!1,()=>{t.current=!0,Yce(()=>{t.current&&e()})}),[e])}function F6e(){let n=typeof document>"u";return"useSyncExternalStore"in UP?(e=>e.useSyncExternalStore)(UP)(()=>()=>{},()=>!1,()=>!n):!1}function N6e(){let n=F6e(),[e,t]=_e.useState(rx.isHandoffComplete);return e&&rx.isHandoffComplete===!1&&t(!1),_e.useEffect(()=>{e!==!0&&t(!0)},[e]),_e.useEffect(()=>rx.handoff(),[]),n?!1:e}let z6e=_e.createContext(!1);function U6e(){return _e.useContext(z6e)}function G6e(n){let e=U6e(),t=_e.useContext(Aue),r=k8(n),[s,o]=_e.useState(()=>{var l;if(!e&&t!==null)return(l=t.current)!=null?l:null;if(rx.isServer)return null;let c=r==null?void 0:r.getElementById("headlessui-portal-root");if(c)return c;if(r===null)return null;let a=r.createElement("div");return a.setAttribute("id","headlessui-portal-root"),r.body.appendChild(a)});return _e.useEffect(()=>{s!==null&&(r!=null&&r.body.contains(s)||r==null||r.body.appendChild(s))},[s,r]),_e.useEffect(()=>{e||t!==null&&o(t.current)},[t,o,e]),s}let Sue=_e.Fragment,V6e=Xh(function(n,e){let t=n,r=_e.useRef(null),s=mg(E5e(m=>{r.current=m}),e),o=k8(r),l=G6e(r),[c]=_e.useState(()=>{var m;return rx.isServer?null:(m=o==null?void 0:o.createElement("div"))!=null?m:null}),a=_e.useContext($6e),d=N6e();Pa(()=>{!l||!c||l.contains(c)||(c.setAttribute("data-headlessui-portal",""),l.appendChild(c))},[l,c]),Pa(()=>{if(c&&a)return a.register(c)},[a,c]),O6e(()=>{var m;!l||!c||(c instanceof Node&&l.contains(c)&&l.removeChild(c),l.childNodes.length<=0&&((m=l.parentElement)==null||m.removeChild(l)))});let f=$h();return d?!l||!c?null:Dh.createPortal(f({ourProps:{ref:s},theirProps:t,slot:{},defaultTag:Sue,name:"Portal"}),c):null});function H6e(n,e){let t=mg(e),{enabled:r=!0,...s}=n,o=$h();return r?Al.createElement(V6e,{...s,ref:t}):o({ourProps:{ref:t},theirProps:s,slot:{},defaultTag:Sue,name:"Portal"})}let j6e=_e.Fragment,Aue=_e.createContext(null);function W6e(n,e){let{target:t,...r}=n,s={ref:mg(e)},o=$h();return Al.createElement(Aue.Provider,{value:t},o({ourProps:s,theirProps:r,defaultTag:j6e,name:"Popover.Group"}))}let $6e=_e.createContext(null),X6e=Xh(H6e),q6e=Xh(W6e),Y6e=Object.assign(X6e,{Group:q6e});function Z6e(n,e){let t=_e.useRef({left:0,top:0});if(Pa(()=>{if(!e)return;let s=e.getBoundingClientRect();s&&(t.current=s)},[n,e]),e==null||!n||e===document.activeElement)return!1;let r=e.getBoundingClientRect();return r.top!==t.current.top||r.left!==t.current.left}let BJ=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function kJ(n){var e,t;let r=(e=n.innerText)!=null?e:"",s=n.cloneNode(!0);if(!(s instanceof HTMLElement))return r;let o=!1;for(let c of s.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))c.remove(),o=!0;let l=o?(t=s.innerText)!=null?t:"":r;return BJ.test(l)&&(l=l.replace(BJ,"")),l}function K6e(n){let e=n.getAttribute("aria-label");if(typeof e=="string")return e.trim();let t=n.getAttribute("aria-labelledby");if(t){let r=t.split(" ").map(s=>{let o=document.getElementById(s);if(o){let l=o.getAttribute("aria-label");return typeof l=="string"?l.trim():kJ(o).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return kJ(n).trim()}function J6e(n){let e=_e.useRef(""),t=_e.useRef("");return Po(()=>{let r=n.current;if(!r)return"";let s=r.innerText;if(e.current===s)return t.current;let o=K6e(r).trim().toLowerCase();return e.current=s,t.current=o,o})}var Q6e=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(Q6e||{}),eGe=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(eGe||{}),tGe=(n=>(n[n.OpenMenu=0]="OpenMenu",n[n.CloseMenu=1]="CloseMenu",n[n.GoToItem=2]="GoToItem",n[n.Search=3]="Search",n[n.ClearSearch=4]="ClearSearch",n[n.RegisterItem=5]="RegisterItem",n[n.UnregisterItem=6]="UnregisterItem",n[n.SetButtonElement=7]="SetButtonElement",n[n.SetItemsElement=8]="SetItemsElement",n))(tGe||{});function FN(n,e=t=>t){let t=n.activeItemIndex!==null?n.items[n.activeItemIndex]:null,r=oue(e(n.items.slice()),o=>o.dataRef.current.domRef.current),s=t?r.indexOf(t):null;return s===-1&&(s=null),{items:r,activeItemIndex:s}}let nGe={1(n){return n.menuState===1?n:{...n,activeItemIndex:null,menuState:1}},0(n){return n.menuState===0?n:{...n,__demoMode:!1,menuState:0}},2:(n,e)=>{var t,r,s,o,l;if(n.menuState===1)return n;let c={...n,searchQuery:"",activationTrigger:(t=e.trigger)!=null?t:1,__demoMode:!1};if(e.focus===Yl.Nothing)return{...c,activeItemIndex:null};if(e.focus===Yl.Specific)return{...c,activeItemIndex:n.items.findIndex(f=>f.id===e.id)};if(e.focus===Yl.Previous){let f=n.activeItemIndex;if(f!==null){let m=n.items[f].dataRef.current.domRef,_=ON(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:x=>x.id,resolveDisabled:x=>x.dataRef.current.disabled});if(_!==null){let x=n.items[_].dataRef.current.domRef;if(((r=m.current)==null?void 0:r.previousElementSibling)===x.current||((s=x.current)==null?void 0:s.previousElementSibling)===null)return{...c,activeItemIndex:_}}}}else if(e.focus===Yl.Next){let f=n.activeItemIndex;if(f!==null){let m=n.items[f].dataRef.current.domRef,_=ON(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:x=>x.id,resolveDisabled:x=>x.dataRef.current.disabled});if(_!==null){let x=n.items[_].dataRef.current.domRef;if(((o=m.current)==null?void 0:o.nextElementSibling)===x.current||((l=x.current)==null?void 0:l.nextElementSibling)===null)return{...c,activeItemIndex:_}}}}let a=FN(n),d=ON(e,{resolveItems:()=>a.items,resolveActiveIndex:()=>a.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});return{...c,...a,activeItemIndex:d}},3:(n,e)=>{let t=n.searchQuery!==""?0:1,r=n.searchQuery+e.value.toLowerCase(),s=(n.activeItemIndex!==null?n.items.slice(n.activeItemIndex+t).concat(n.items.slice(0,n.activeItemIndex+t)):n.items).find(l=>{var c;return((c=l.dataRef.current.textValue)==null?void 0:c.startsWith(r))&&!l.dataRef.current.disabled}),o=s?n.items.indexOf(s):-1;return o===-1||o===n.activeItemIndex?{...n,searchQuery:r}:{...n,searchQuery:r,activeItemIndex:o,activationTrigger:1}},4(n){return n.searchQuery===""?n:{...n,searchQuery:"",searchActiveItemIndex:null}},5:(n,e)=>{let t=FN(n,r=>[...r,{id:e.id,dataRef:e.dataRef}]);return{...n,...t}},6:(n,e)=>{let t=FN(n,r=>{let s=r.findIndex(o=>o.id===e.id);return s!==-1&&r.splice(s,1),r});return{...n,...t,activationTrigger:1}},7:(n,e)=>n.buttonElement===e.element?n:{...n,buttonElement:e.element},8:(n,e)=>n.itemsElement===e.element?n:{...n,itemsElement:e.element}},V8=_e.createContext(null);V8.displayName="MenuContext";function YB(n){let e=_e.useContext(V8);if(e===null){let t=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,YB),t}return e}function rGe(n,e){return VC(e.type,nGe,n,e)}let iGe=_e.Fragment;function sGe(n,e){let{__demoMode:t=!1,...r}=n,s=_e.useReducer(rGe,{__demoMode:t,menuState:t?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:o,itemsElement:l,buttonElement:c},a]=s,d=mg(e);nUe(o===0,[c,l],(A,I)=>{a({type:1}),B8(I,D8.Loose)||(A.preventDefault(),c==null||c.focus())});let f=Po(()=>{a({type:1})}),m=_e.useMemo(()=>({open:o===0,close:f}),[o,f]),_={ref:d},x=$h();return Al.createElement(P6e,null,Al.createElement(V8.Provider,{value:s},Al.createElement(B6e,{value:VC(o,{0:XM.Open,1:XM.Closed})},x({ourProps:_,theirProps:r,slot:m,defaultTag:iGe,name:"Menu"}))))}let oGe="button";function aGe(n,e){var t;let r=_e.useId(),{id:s=`headlessui-menu-button-${r}`,disabled:o=!1,autoFocus:l=!1,...c}=n,[a,d]=YB("Menu.Button"),f=C6e(),m=mg(e,M6e(),Po(J=>d({type:7,element:J}))),_=Po(J=>{switch(J.key){case wl.Space:case wl.Enter:case wl.ArrowDown:J.preventDefault(),J.stopPropagation(),Dh.flushSync(()=>d({type:0})),d({type:2,focus:Yl.First});break;case wl.ArrowUp:J.preventDefault(),J.stopPropagation(),Dh.flushSync(()=>d({type:0})),d({type:2,focus:Yl.Last});break}}),x=Po(J=>{switch(J.key){case wl.Space:J.preventDefault();break}}),A=Po(J=>{var re;if(M5e(J.currentTarget))return J.preventDefault();o||(a.menuState===0?(Dh.flushSync(()=>d({type:1})),(re=a.buttonElement)==null||re.focus({preventScroll:!0})):(J.preventDefault(),d({type:0})))}),{isFocusVisible:I,focusProps:E}=h5e({autoFocus:l}),{isHovered:C,hoverProps:L}=u5e({isDisabled:o}),{pressed:O,pressProps:H}=v5e({disabled:o}),q=_e.useMemo(()=>({open:a.menuState===0,active:O||a.menuState===0,disabled:o,hover:C,focus:I,autofocus:l}),[a,C,I,O,o,l]),Z=Jce(f(),{ref:m,id:s,type:rUe(n,a.buttonElement),"aria-haspopup":"menu","aria-controls":(t=a.itemsElement)==null?void 0:t.id,"aria-expanded":a.menuState===0,disabled:o||void 0,autoFocus:l,onKeyDown:_,onKeyUp:x,onClick:A},E,L,H);return $h()({ourProps:Z,theirProps:c,slot:q,defaultTag:oGe,name:"Menu.Button"})}let lGe="div",cGe=Z5.RenderStrategy|Z5.Static;function uGe(n,e){var t,r;let s=_e.useId(),{id:o=`headlessui-menu-items-${s}`,anchor:l,portal:c=!1,modal:a=!0,transition:d=!1,...f}=n,m=T6e(l),[_,x]=YB("Menu.Items"),[A,I]=I6e(m),E=E6e(),[C,L]=_e.useState(null),O=mg(e,m?A:null,Po(ye=>x({type:8,element:ye})),L),H=k8(_.itemsElement);m&&(c=!0);let q=D6e(),[Z,J]=mUe(d,C,q!==null?(q&XM.Open)===XM.Open:_.menuState===0);V5e(Z,_.buttonElement,()=>{x({type:1})});let re=_.__demoMode?!1:a&&_.menuState===0;cUe(re,H);let se=_.__demoMode?!1:a&&_.menuState===0;G5e(se,{allowed:_e.useCallback(()=>[_.buttonElement,_.itemsElement],[_.buttonElement,_.itemsElement])});let ae=_.menuState!==0,he=Z6e(ae,_.buttonElement)?!1:Z;_e.useEffect(()=>{let ye=_.itemsElement;ye&&_.menuState===0&&ye!==(H==null?void 0:H.activeElement)&&ye.focus({preventScroll:!0})},[_.menuState,_.itemsElement,H]),yUe(_.menuState===0,{container:_.itemsElement,accept(ye){return ye.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:ye.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(ye){ye.setAttribute("role","none")}});let Ae=HB(),Ee=Po(ye=>{var We,Ue,gt;switch(Ae.dispose(),ye.key){case wl.Space:if(_.searchQuery!=="")return ye.preventDefault(),ye.stopPropagation(),x({type:3,value:ye.key});case wl.Enter:if(ye.preventDefault(),ye.stopPropagation(),x({type:1}),_.activeItemIndex!==null){let{dataRef:vt}=_.items[_.activeItemIndex];(Ue=(We=vt.current)==null?void 0:We.domRef.current)==null||Ue.click()}sue(_.buttonElement);break;case wl.ArrowDown:return ye.preventDefault(),ye.stopPropagation(),x({type:2,focus:Yl.Next});case wl.ArrowUp:return ye.preventDefault(),ye.stopPropagation(),x({type:2,focus:Yl.Previous});case wl.Home:case wl.PageUp:return ye.preventDefault(),ye.stopPropagation(),x({type:2,focus:Yl.First});case wl.End:case wl.PageDown:return ye.preventDefault(),ye.stopPropagation(),x({type:2,focus:Yl.Last});case wl.Escape:ye.preventDefault(),ye.stopPropagation(),Dh.flushSync(()=>x({type:1})),(gt=_.buttonElement)==null||gt.focus({preventScroll:!0});break;case wl.Tab:ye.preventDefault(),ye.stopPropagation(),Dh.flushSync(()=>x({type:1})),K5e(_.buttonElement,ye.shiftKey?Q5.Previous:Q5.Next);break;default:ye.key.length===1&&(x({type:3,value:ye.key}),Ae.setTimeout(()=>x({type:4}),350));break}}),Pe=Po(ye=>{switch(ye.key){case wl.Space:ye.preventDefault();break}}),ze=_e.useMemo(()=>({open:_.menuState===0}),[_.menuState]),Re=Jce(m?E():{},{"aria-activedescendant":_.activeItemIndex===null||(t=_.items[_.activeItemIndex])==null?void 0:t.id,"aria-labelledby":(r=_.buttonElement)==null?void 0:r.id,id:o,onKeyDown:Ee,onKeyUp:Pe,role:"menu",tabIndex:_.menuState===0?0:void 0,ref:O,style:{...f.style,...I,"--button-width":N5e(_.buttonElement,!0).width},...pUe(J)}),rt=$h();return Al.createElement(Y6e,{enabled:c?n.static||Z:!1},rt({ourProps:Re,theirProps:f,slot:ze,defaultTag:lGe,features:cGe,visible:he,name:"Menu.Items"}))}let hGe=_e.Fragment;function dGe(n,e){let t=_e.useId(),{id:r=`headlessui-menu-item-${t}`,disabled:s=!1,...o}=n,[l,c]=YB("Menu.Item"),a=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===r:!1,d=_e.useRef(null),f=mg(e,d);Pa(()=>{if(!l.__demoMode&&l.menuState===0&&a&&l.activationTrigger!==0)return Pp().requestAnimationFrame(()=>{var he,Ae;(Ae=(he=d.current)==null?void 0:he.scrollIntoView)==null||Ae.call(he,{block:"nearest"})})},[l.__demoMode,d,a,l.menuState,l.activationTrigger,l.activeItemIndex]);let m=J6e(d),_=_e.useRef({disabled:s,domRef:d,get textValue(){return m()}});Pa(()=>{_.current.disabled=s},[_,s]),Pa(()=>(c({type:5,id:r,dataRef:_}),()=>c({type:6,id:r})),[_,r]);let x=Po(()=>{c({type:1})}),A=Po(he=>{if(s)return he.preventDefault();c({type:1}),sue(l.buttonElement)}),I=Po(()=>{if(s)return c({type:2,focus:Yl.Nothing});c({type:2,focus:Yl.Specific,id:r})}),E=uUe(),C=Po(he=>{E.update(he),!s&&(a||c({type:2,focus:Yl.Specific,id:r,trigger:0}))}),L=Po(he=>{E.wasMoved(he)&&(s||a||c({type:2,focus:Yl.Specific,id:r,trigger:0}))}),O=Po(he=>{E.wasMoved(he)&&(s||a&&c({type:2,focus:Yl.Nothing}))}),[H,q]=tue(),[Z,J]=I5e(),re=_e.useMemo(()=>({active:a,focus:a,disabled:s,close:x}),[a,s,x]),se={id:r,ref:f,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,"aria-labelledby":H,"aria-describedby":Z,disabled:void 0,onClick:A,onFocus:I,onPointerEnter:C,onMouseEnter:C,onPointerMove:L,onMouseMove:L,onPointerLeave:O,onMouseLeave:O},ae=$h();return Al.createElement(q,null,Al.createElement(J,null,ae({ourProps:se,theirProps:o,slot:re,defaultTag:hGe,name:"Menu.Item"})))}let fGe="div";function pGe(n,e){let[t,r]=tue(),s=n,o={ref:e,"aria-labelledby":t,role:"group"},l=$h();return Al.createElement(r,null,l({ourProps:o,theirProps:s,slot:{},defaultTag:fGe,name:"Menu.Section"}))}let mGe="header";function gGe(n,e){let t=_e.useId(),{id:r=`headlessui-menu-heading-${t}`,...s}=n,o=R8();Pa(()=>o.register(r),[r,o.register]);let l={id:r,ref:e,role:"presentation",...o.props};return $h()({ourProps:l,theirProps:s,slot:{},defaultTag:mGe,name:"Menu.Heading"})}let vGe="div";function _Ge(n,e){let t=n,r={ref:e,role:"separator"};return $h()({ourProps:r,theirProps:t,slot:{},defaultTag:vGe,name:"Menu.Separator"})}let yGe=Xh(sGe),H8=Xh(aGe),j8=Xh(uGe),Xd=Xh(dGe),xGe=Xh(pGe),bGe=Xh(gGe),wGe=Xh(_Ge),Tue=Object.assign(yGe,{Button:H8,Items:j8,Item:Xd,Section:xGe,Heading:bGe,Separator:wGe});const SGe="/about_portfolio/assets/heart--ic8Oklh.png",AGe=()=>{let n=_e.useRef(null),e,t,r,s=null;const o=()=>{for(let I=-15;I<16;I++)for(let E=-10;E<11;E++){let C=new FD({color:Math.random()*16777215}),L=new O6(C);L.position.set(I*2,E*2,0),e.add(L)}},l=()=>{const I=new Yr,E=new du({size:3,vertexColors:!0,color:16777215});let C=[],L=[];for(let H=-15;H<16;H++)for(let q=-15;q<16;q++){C.push(H*4,q*4,0);let Z=new Hn(Math.random()*16777215);L.push(Z.r,Z.g,Z.b)}I.attributes.position=new lr(C,3),I.attributes.color=new lr(L,3);const O=new Rh(I,E);e.add(O)},c=()=>{const I=document.createElement("canvas");I.width=300,I.height=300;const E=I.getContext("2d");E.lineWidth=10,E.beginPath(),E.moveTo(200,150);var C=E.createLinearGradient(100,0,200,0);C.addColorStop("0","black"),C.addColorStop("0.3","magenta"),C.addColorStop("0.5","blue"),C.addColorStop("0.6","green"),C.addColorStop("0.8","yellow"),C.addColorStop("1","red"),E.strokeStyle=C,E.arc(150,150,50,0,2*Math.PI),E.stroke();const L=new cz(I);return L.needsUpdate=!0,L},a=(I,E,C,L,O)=>{const H=new Yr,q=new du({size:I,transparent:E,opacity:C,sizeAttenuation:L,map:c(),color:O,depthTest:!0,depthWrite:!1});let Z=[],J=200;for(let ae=0;ae<400;ae++){let he=new Ze(Math.random()*J-J/2,Math.random()*J-J/2,Math.random()*J-J/2);Z.push(he.x,he.y,he.z)}let re=new lr(Z,3);H.attributes.position=re;const se=new Rh(H,q);e.add(se)},d=(I,E,C)=>{const L=new Yr,O=new du({size:I,transparent:C,opacity:E,map:new rf().load(SGe),sizeAttenuation:!0,depthTest:!0,depthWrite:!1});let H=[],q=200;for(let J=0;J<400;J++){let re=new Ze(Math.random()*q-q/2,Math.random()*q-q/2,Math.random()*q-q/2);H.push(re.x,re.y,re.z)}L.attributes.position=new lr(H,3);let Z=new Rh(L,O);e.add(Z)},f=()=>{const I=document.createElement("canvas");I.width=16,I.height=16;let E=I.getContext("2d"),C=E.createRadialGradient(I.width/2,I.height/2,0,I.width/2,I.height/2,I.width/2);C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.2,"rgba(0,255,255,1)"),C.addColorStop(.4,"rgba(0,0,255,1)"),C.addColorStop(1,"rgba(0,255,0,1)"),E.fillStyle=C,E.fillRect(0,0,I.width,I.height);const L=new cz(I);return L.needsUpdate=!0,L},m=()=>{const I=new Wm(50,32,32),E=new du({size:1,map:f(),transparent:!0,opacity:1,sizeAttenuation:!0,color:15539236,blending:gw,depthTest:!0,depthWrite:!1}),C=new Rh(I,E);e.add(C)},_=()=>{const I={width:window.innerWidth,height:window.innerHeight};e=new Il,t=new is(75,1,.1,1e3),e.add(t),r=new j0(t,n.current),r.enableDamping=!0,s=new ec({canvas:n.current}),s.setSize(I.width,I.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.aspect=I.width/I.height,t.position.z=120,t.lookAt(new Ze(0,0,0))},x=()=>{s.render(e,t),r&&r.update(),requestAnimationFrame(x)},A=I=>{switch(e.clear(),I){case 0:o();break;case 1:{l();break}case 2:a(10,!0,.6,!0,16777215);break;case 3:d(10,.6,!0);break;case 4:m();break;default:o()}};return _e.useEffect(()=>{_(),A(0),x()},[]),pe.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[pe.jsx("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:pe.jsx("div",{className:"mr-8 text-right",children:pe.jsxs(Tue,{children:[pe.jsx(H8,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:"different ways to create particles"}),pe.jsxs(j8,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[pe.jsx(Xd,{children:pe.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>A(0),children:"createParticlesBySprite"})}),pe.jsx(Xd,{children:pe.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>A(1),children:"createParticlesByPoints"})}),pe.jsx(Xd,{children:pe.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>A(2),children:"createParticlesByCanvas"})}),pe.jsx(Xd,{children:pe.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>A(3),children:"createParticlesByTexture"})}),pe.jsx(Xd,{children:pe.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>A(4),children:"createParticlesByGeometry"})})]})]})})}),pe.jsx("canvas",{ref:n})]})},TGe="/about_portfolio/assets/astronaut-FRdIWehG.glb",MGe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgSURBVHgB7cmxDQAACALBj/vvrIWUJCzAtQf1VtwNlR3vKwf7lmC9zQAAAABJRU5ErkJggg==",CGe=()=>{let n=_e.useRef(null),e=null,t=null,r=null,s=null,o=null,l=0,c=[],a={width:0,height:0};const d=()=>{t=new ec({canvas:n.current,antialias:!0}),t.setSize(a.width,a.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),e=new Il,r=new is(75,a.width/a.height,.1,100),r.position.z=150,r.lookAt(new Ze(0,0,0)),e.add(r),t.render(e,r),f(),m(),_()},f=()=>{new VB().load(TGe,Z=>{s=Z.scene,s.material=new SC,s.scale.set(4e-4,4e-4,4e-4),s.position.z=-10,e.add(s)})},m=()=>{const q=new Yr,Z=new du({size:10,alphaTest:.8,color:16777215,map:new rf().load(MGe)});let J=[];for(let re=0;re<1e3;re++){c.push(H(20,300)*Math.cos(re),H(20,300)*Math.sin(re),H(-1500,10));let se=new Hn(Math.random()*16777215);J.push(se.r,se.g,se.b)}q.attributes.position=new lr(c,3),q.attributes.color=new lr(J,3),o=new Rh(q,Z),e.add(o)},_=()=>{e.fog=new vC(0,.005);let q=new p0(16777215,.8);q.position.set(50,50,75),e.add(q),q=new p0(16777215,.8),q.position.set(-50,-50,75),e.add(q),q=new p0(16777215,.5),q.position.set(25,50,200),e.add(q),q=new Ox(16777215,.8),e.add(q)},x=()=>{o.position.x=.2*Math.cos(l),o.position.y=.2*Math.cos(l),o.position.z+=.015,r.lookAt(o.position);for(let q=0;q<c.length;q++)if((q+1)%3===0){c[q]-r.position.z>=0&&(c[q]=H(-1e3,-500)),c[q]+=2.5;let J=new lr(c,3);o.geometry.attributes.position=J}o.geometry.verticesNeedUpdate=!0},A=()=>{s&&(s.position.z=.08*Math.sin(l)+(r.position.z-.2),s.rotation.x+=.015,s.rotation.y+=.015,s.rotation.z+=.01)},I=()=>{let q=window.innerWidth,Z=window.innerHeight;(window.innerHeight!==Z||window.innerWidth!==q)&&(t.setSize(q,Z,!1),r.aspect=q/Z,r.updateProjectionMatrix())},E=()=>{x(),A(),I(),t.render(e,r),l+=.01,requestAnimationFrame(E)},C=()=>({onResize:()=>{a.width=window.innerWidth,a.height=window.innerHeight,t.setSize(a.width,a.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.aspect=a.width/a.height,r.updateProjectionMatrix()},onMouseMove:J=>{let re=window.innerWidth/2,se=window.innerHeight/2,ae=-1*((re-J.clientX)/re),he=-1*((se-J.clientY)/se);r&&(r.position.x=ae*5),r&&(r.position.y=he*5),s&&(s.position.x=ae*5),s&&(s.position.y=he*5)}}),{onResize:L,onMouseMove:O}=C(),H=(q,Z)=>q+Math.random()*(Z-q);return _e.useEffect(()=>(a.width=window.innerWidth,a.height=window.innerHeight,d(),E(),window.addEventListener("resize",L),window.addEventListener("mousemove",O),()=>{window.removeEventListener("resize",L),window.removeEventListener("mousemove",O)}),[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{ref:n})})},EGe={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Hn(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class L0 extends X0{constructor(e,t,r,s){super(),this.strength=t!==void 0?t:1,this.radius=r,this.threshold=s,this.resolution=e!==void 0?new sn(e.x,e.y):new sn(256,256),this.clearColor=new Hn(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let o=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);this.renderTargetBright=new Ml(o,l,{type:Bh}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let m=0;m<this.nMips;m++){const _=new Ml(o,l,{type:Bh});_.texture.name="UnrealBloomPass.h"+m,_.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(_);const x=new Ml(o,l,{type:Bh});x.texture.name="UnrealBloomPass.v"+m,x.texture.generateMipmaps=!1,this.renderTargetsVertical.push(x),o=Math.round(o/2),l=Math.round(l/2)}const c=EGe;this.highPassUniforms=tg.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Lo({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];o=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);for(let m=0;m<this.nMips;m++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(a[m])),this.separableBlurMaterials[m].uniforms.invSize.value=new sn(1/o,1/l),o=Math.round(o/2),l=Math.round(l/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const d=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=d,this.bloomTintColors=[new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const f=jie;this.copyUniforms=tg.clone(f.uniforms),this.blendMaterial=new Lo({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:gw,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Hn,this.oldClearAlpha=1,this.basic=new bo,this.fsQuad=new IC(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let r=Math.round(e/2),s=Math.round(t/2);this.renderTargetBright.setSize(r,s);for(let o=0;o<this.nMips;o++)this.renderTargetsHorizontal[o].setSize(r,s),this.renderTargetsVertical[o].setSize(r,s),this.separableBlurMaterials[o].uniforms.invSize.value=new sn(1/r,1/s),r=Math.round(r/2),s=Math.round(s/2)}render(e,t,r,s,o){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const l=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),o&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let c=this.renderTargetBright;for(let a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=c.texture,this.separableBlurMaterials[a].uniforms.direction.value=L0.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[a]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=L0.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[a]),e.clear(),this.fsQuad.render(e),c=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=l}getSeperableBlurMaterial(e){const t=[];for(let r=0;r<e;r++)t.push(.39894*Math.exp(-.5*r*r/(e*e))/e);return new Lo({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new sn(.5,.5)},direction:{value:new sn(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Lo({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}L0.BlurDirectionX=new sn(1,0);L0.BlurDirectionY=new sn(0,1);const OJ={name:"ConvolutionShader",defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new sn(.001953125,0)},cKernel:{value:[]}},vertexShader:`

		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float cKernel[ KERNEL_SIZE_INT ];

		uniform sampler2D tDiffuse;
		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vec2 imageCoord = vUv;
			vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );

			for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {

				sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];
				imageCoord += uImageIncrement;

			}

			gl_FragColor = sum;

		}`,buildKernel:function(n){let t=2*Math.ceil(n*3)+1;t>25&&(t=25);const r=(t-1)*.5,s=new Array(t);let o=0;for(let l=0;l<t;++l)s[l]=IGe(l-r,n),o+=s[l];for(let l=0;l<t;++l)s[l]/=o;return s}};function IGe(n,e){return Math.exp(-(n*n)/(2*e*e))}class ix extends X0{constructor(e=1,t=25,r=4){super(),this.renderTargetX=new Ml(1,1,{type:Bh}),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Ml(1,1,{type:Bh}),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=tg.clone(XI.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Lo({name:XI.name,uniforms:this.combineUniforms,vertexShader:XI.vertexShader,fragmentShader:XI.fragmentShader,blending:gw,transparent:!0});const s=OJ;this.convolutionUniforms=tg.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=ix.blurX,this.convolutionUniforms.cKernel.value=OJ.buildKernel(r),this.materialConvolution=new Lo({name:s.name,uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new IC(null)}render(e,t,r,s,o){o&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=ix.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=ix.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,o&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}dispose(){this.renderTargetX.dispose(),this.renderTargetY.dispose(),this.materialCombine.dispose(),this.materialConvolution.dispose(),this.fsQuad.dispose()}}const XI={name:"CombineShader",uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float strength;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = strength * texel;

		}`};ix.blurX=new sn(.001953125,0);ix.blurY=new sn(0,.001953125);const PGe={name:"FilmShader",uniforms:{tDiffuse:{value:null},time:{value:0},intensity:{value:.5},grayscale:{value:!1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		uniform float intensity;
		uniform bool grayscale;
		uniform float time;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 base = texture2D( tDiffuse, vUv );

			float noise = rand( fract( vUv + time ) );

			vec3 color = base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );

			color = mix( base.rgb, color, intensity );

			if ( grayscale ) {

				color = vec3( luminance( color ) ); // assuming linear-srgb

			}

			gl_FragColor = vec4( color, base.a );

		}`};class RGe extends X0{constructor(e=.5,t=!1){super();const r=PGe;this.uniforms=tg.clone(r.uniforms),this.material=new Lo({name:r.name,uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.uniforms.intensity.value=e,this.uniforms.grayscale.value=t,this.fsQuad=new IC(this.material)}render(e,t,r,s){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=s,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const LGe=()=>{const n=_e.useRef(null);let e,t,r,s,o=null,l={width:0,height:0},c;const a=()=>{l.width=window.innerWidth,l.height=window.innerHeight,e=new Il,t=new is(75,l.width/l.height,.1,100),t.position.set(1,-1,1),e.add(t),o=new ec({canvas:n.current,antialias:!0}),o.setSize(l.width,l.height),o.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.autoClear=!1,c=new j0(t,o.domElement),c.enableDamping=!0;const f=new Mp(1,1,1),m=new bo({color:65280});s=new Di(f,m),e.add(s);const _=new iB(e,t);new L0(new sn(l.width,l.height),1.5,.4,.85);const x=new ix(1.5,25,4,256),A=new RGe(.35,.25,648,!1);r=new rB(o),r.renderToScreen=!0,r.addPass(_),r.addPass(x),r.addPass(A)},d=()=>{c&&c.update(),s&&(s.rotation.y+=.002),s&&(s.rotation.x+=.002),r&&r.render(),r.setSize(l.width,l.height),o.render(e,t),window.requestAnimationFrame(d)};return _e.useEffect(()=>{a(),d()},[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{ref:n})})},DGe="/about_portfolio/assets/rickAndMorty-Do2rctLy.glb";var BGe=`#define MUN_OCTAVES 5\r
#define M_PI 3.1415926535897932384626433832795\r
precision mediump float;

varying vec3 vNormal;\r
varying vec3 vCamPos;\r
varying vec2 vUv;

uniform vec4 resolution;\r
uniform sampler2D perlinNoise;\r
uniform sampler2D sparkNoise;\r
uniform sampler2D waterTurbulence;\r
uniform sampler2D noiseText;\r
uniform float time;\r
uniform vec3 color0;\r
uniform vec3 color1;\r
uniform vec3 color2;\r
uniform vec3 color3;\r
uniform vec3 color4;\r
uniform vec3 color5;

float Rand(vec2 n) {\r
  return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r
}

float Noise(vec2 p) {\r
  vec2 ip = floor(p);\r
  vec2 u = fract(p);\r
  u = u * u * (3.0 - 2.0 * u);

  float res =\r
      mix(mix(Rand(ip), Rand(ip + vec2(1.0, 0.0)), u.x),\r
          mix(Rand(ip + vec2(0.0, 1.0)), Rand(ip + vec2(1.0, 1.0)), u.x), u.y);\r
  return res * res;\r
}

float Fbm(vec2 p) {\r
  float v = 0.0;\r
  float a = 0.5;\r
  vec2 shift = vec2(100);\r
  
  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\r
  for (int i = 0; i < MUN_OCTAVES; ++i) {\r
    v += a * Noise(p);\r
    p = rot * p * 2.0 + shift;\r
    a *= 0.5;\r
  }\r
  return v;\r
}

float SetOpacity(float r, float g, float b, float toneThreshold) {\r
  float tone = (r + g + b) / 3.0;\r
  if (tone < toneThreshold) {\r
    return 0.0;\r
  }\r
  return 1.0;\r
}

vec3 Rgbcol(vec3 col) {\r
  return vec3(col.r / 255.0, col.g / 255.0, col.b / 255.0);\r
}

vec2 Rotate(vec2 v, float a) {\r
  float s = sin(a);\r
  float c = cos(a);\r
  mat2 m = mat2(c, -s, s, c);\r
  return m * v;\r
}

vec2 UnityPolarCoordinates(vec2 uv, vec2 center, float radialScale,\r
                           float lengthScale) {\r
  vec2 delta = uv - center;\r
  float radius = length(delta) * radialScale * 2.0;\r
  float angle = atan(delta.x, delta.y) * 1.0 / 6.28 * lengthScale;\r
  return vec2(radius, angle);\r
}

void main() {\r
  
  vec2 oldUv = gl_FragCoord.xy / resolution.xy;\r
  vec2 uv = vUv;\r
  vec2 imgUv = uv;\r
  float scale = 1.0;\r
  oldUv *= 0.5 + time;\r
  oldUv.y = oldUv.y;\r
  vec2 p = oldUv * scale; 

  
  float noise = Fbm(p) * 0.04;\r
  vec4 txt = texture2D(perlinNoise, oldUv);\r
  float gradient = dot(normalize(-vCamPos), normalize(vNormal));\r
  float pct = distance(vUv, vec2(0.5));\r
  
  vec3 rgbColor0 = Rgbcol(color0);\r
  vec3 rgbColor1 = Rgbcol(color1);\r
  vec3 rgbColor2 = Rgbcol(color2);\r
  vec3 rgbColor3 = Rgbcol(color3);\r
  vec3 rgbColor4 = Rgbcol(color4);\r
  vec3 rgbColor5 = Rgbcol(color5);

  
  float y = smoothstep(0.16, 0.525, pct);\r
  vec3 backColor = mix(rgbColor0, rgbColor5, y);\r
  gl_FragColor = vec4(backColor, 1.0);

  
  vec2 center = vec2(0.5);\r
  vec2 cor = UnityPolarCoordinates(vUv, center, 1.0, 1.0);\r
  vec2 newvUv = vUv - 0.5;\r
  vec3 noiseTextvUv =\r
      texture2D(perlinNoise, mod(Rotate(newvUv * 0.15 + vec2(sin(time * 0.005),\r
                                                             cos(time * 0.005)),\r
                                        time),\r
                                 1.0))\r
          .rgb; 

  
  vec2 newUv = vec2(cor.x + time, cor.x + cor.y);\r
  vec3 noiseText1 = texture2D(perlinNoise, mod(newUv, 1.0))\r
                        .rgb; 
  vec3 noiseText2 = texture2D(sparkNoise, mod(newUv, 1.)).rgb;\r
  vec3 noiseText3 = texture2D(waterTurbulence, mod(newUv, 1.))\r
                        .rgb; 

  
  float tone0 = 1. - smoothstep(0.3, 0.6, noiseText1.r);\r
  float tone1 = smoothstep(0.3, 0.6, noiseText2.r);\r
  float tone2 = smoothstep(0.3, 0.6, noiseText3.r);

  
  float opacity0 = SetOpacity(tone0, tone0, tone0, .29);\r
  float opacity1 = SetOpacity(tone1, tone1, tone1, .49);\r
  float opacity2 = SetOpacity(tone2, tone2, tone2, .69);

  
  float gradientTone = 1. - smoothstep(0.196, 0.532, pct);\r
  vec4 circularNoise = vec4(vec3(gradientTone) * noiseTextvUv * 1.4, 1.0);\r
  float gradOpacity =\r
      SetOpacity(circularNoise.r, circularNoise.g, circularNoise.b, 0.19);

  
  vec2 uv2 = uv;\r
  float iTime = time * 0.004;\r
  uv.y += iTime / 10.0;\r
  uv.x -= (sin(iTime / 10.0) / 2.0);\r
  uv2.x += iTime / 14.0;\r
  uv2.x += (sin(iTime / 10.0) / 9.0);\r
  float result = 0.0;\r
  result +=\r
      texture2D(noiseText, mod(uv * 0.5, 1.) * 0.6 + vec2(iTime * (-0.003)))\r
          .r; 
              
  result *=\r
      texture2D(noiseText, mod(uv2 * 0.5, 1.) * 0.9 + vec2(iTime * 0.002)).b;\r
  result = pow(result, 4.0);

  
  if (opacity2 > 0.0) {\r
    gl_FragColor = vec4(rgbColor4, 0.) * vec4(opacity2);\r
  } else if (opacity1 > 0.0) {\r
    gl_FragColor = vec4(rgbColor2, 0.) * vec4(opacity1);\r
  } else if (opacity0 > 0.0) {\r
    gl_FragColor = vec4(rgbColor1, 0.) * vec4(opacity0);\r
  }\r
  gl_FragColor += vec4(108.0) * result * (y * 0.02);\r
  gl_FragColor *= vec4(gradOpacity);\r
}`,kGe=`varying vec2 vUv;\r
varying vec3 vNormal;\r
varying vec3 vCamPos;

void main() {\r
  vUv = uv;\r
  vNormal = normal;\r
  vCamPos = cameraPosition;\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
}`;const OGe="/about_portfolio/assets/noise-CSy_EG5b.png",FGe="/about_portfolio/assets/waterturbulence-D5gcttvO.png",NGe=()=>{const n=_e.useRef(null);let e,t,r,s=null,o={width:0,height:0},l,c,a=null,d=null;const f=()=>{o.width=window.innerWidth,o.height=window.innerHeight,e=new Il,t=new is(75,o.width/o.height,.1,100),t.position.set(0,1,5),e.add(t),r=new ec({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(o.width,o.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.autoClear=!1,r.setClearAlpha(0),r.physicallyCorrectLights=!0,r.toneMapping=TD,r.toneMappingExposure=2,r.render(e,t);const E=new H0(16777215,1);E.castShadow=!0,E.shadow.camera.far=15,E.shadow.mapSize.set(1024,1024),E.shadow.normalBias=.05,E.position.set(.25,3,-1.25),e.add(E);const C=new Ox(16777215,1.2);e.add(C),s=new j0(t,r.domElement),s.enableDamping=!0,s.enablePan=!1,s.minPolarAngle=.5,s.maxPolarAngle=2.5,s.minAzimuthAngle=-1,s.maxAzimuthAngle=1},m={exposure:2.8,bloomStrength:2.39,bloomThreshold:0,bloomRadius:.38,color0:[1,5,1],color1:[2,20,2],color2:[44,97,15],color3:[14,28,5],color4:[255,255,255],color5:[74,145,0]},_=()=>{const E=new iB(e,t),C=new L0(new sn(o.width,o.height),1.5,.4,.85);C.threshold=m.bloomThreshold,C.strength=m.bloomStrength,C.radius=m.bloomRadius,d=new rB(r),d.renderToScreen=!0,d.addPass(E),d.addPass(C)},x=()=>{const E=new hg(8,8,1,1),C=new rf;c=new Lo({uniforms:{time:{type:"f",value:0},perlinNoise:{type:"t",value:C.load(Nce)},sparkNoise:{type:"t",value:C.load(zce)},waterTurbulence:{type:"t",value:C.load(FGe)},noiseText:{type:"t",value:C.load(OGe)},color0:{value:new Ze(...m.color0)},color1:{value:new Ze(...m.color1)},color2:{value:new Ze(...m.color2)},color3:{value:new Ze(...m.color3)},color4:{value:new Ze(...m.color4)},color5:{value:new Ze(...m.color5)},resolution:{value:new sn(o.width,o.height)}},vertexShader:kGe,fragmentShader:BGe}),l=new Di(E,c),l.layers.enable(1),e.add(l),_();const L=new AC;L.onLoad=()=>{};const O="/about_portfolio/",H=new E8;H.setDecoderPath(`${O}/draco/`),H.setDecoderConfig({type:"js"});const q=new VB(L);q.setDRACOLoader(H),q.load(DGe,Z=>{Z.scene&&(a=Z.scene,a.scale.set(.02,.02,.02),a.position.x=-.5,a.rotation.y=Math.PI,a.layers.set(0),e.add(a))})},A=()=>{const E=new Gie,C=E.addFolder("bloom");C.add(m,"bloomStrength",0,10).name("bloomStrength").listen(),C.add(m,"bloomRadius",.1,10).name("bloomRadius").listen(),C.open();const L=E.addFolder("Colors");L.addColor(m,"color0").name("layer0"),L.addColor(m,"color1").name("layer1"),L.addColor(m,"color2").name("layer2"),L.addColor(m,"color3").name("layer3"),L.addColor(m,"color4").name("layer4"),L.addColor(m,"color5").name("layer5"),L.open()},I=E=>{const C=new dg;c.uniforms.time.value=E/5e3,c.uniforms.color5.value=new Ze(...m.color5),c.uniforms.color4.value=new Ze(...m.color4),c.uniforms.color3.value=new Ze(...m.color3),c.uniforms.color2.value=new Ze(...m.color2),c.uniforms.color1.value=new Ze(...m.color1),c.uniforms.color0.value=new Ze(...m.color0),r.clear(),t.layers.set(1),d.render(),r.clearDepth(),t.layers.set(0),r.render(e,t);const O=C.getElapsedTime()*.5;a&&(a.rotation.x=Math.cos(O)*.2,a.rotation.z=Math.sin(O)*.1,a.position.z+=Math.cos(O)*.005);const H=Math.cos(O)*2+3;l&&l.scale.set(H,H,H),s.update(),window.requestAnimationFrame(I)};return _e.useEffect(()=>{f(),x(),A(),I()},[]),pe.jsx("div",{className:"w-screen h-screen bg-black",children:pe.jsx("canvas",{ref:n})})};var zGe=`varying vec2 vUv;

void main() {\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
  vUv = uv;\r
}`,UGe=`precision mediump float;\r
#define PI 3.1415926535897932384626433832795

varying vec2 vUv;

float random(vec2 st) {\r
  return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\r
}

vec2 rotate(vec2 uv, float rotation, vec2 mid) {\r
  return vec2(\r
      cos(rotation) * (uv.x - mid.x) - sin(rotation) * (uv.y - mid.y) + mid.x,\r
      sin(rotation) * (uv.x - mid.x) + cos(rotation) * (uv.y - mid.y) + mid.y);\r
}\r

vec2 fade(vec2 t) { return t * t * t * (t * (t * 6.0 - 15.0) + 10.0); }

vec4 permute(vec4 x) { return mod(((x * 34.0) + 1.0) * x, 289.0); }

float cnoise(vec2 P) {\r
  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\r
  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\r
  Pi = mod(Pi, 289.0); 
  vec4 ix = Pi.xzxz;\r
  vec4 iy = Pi.yyww;\r
  vec4 fx = Pf.xzxz;\r
  vec4 fy = Pf.yyww;\r
  vec4 i = permute(permute(ix) + iy);\r
  vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0; 
  vec4 gy = abs(gx) - 0.5;\r
  vec4 tx = floor(gx + 0.5);\r
  gx = gx - tx;\r
  vec2 g00 = vec2(gx.x, gy.x);\r
  vec2 g10 = vec2(gx.y, gy.y);\r
  vec2 g01 = vec2(gx.z, gy.z);\r
  vec2 g11 = vec2(gx.w, gy.w);\r
  vec4 norm =\r
      1.79284291400159 - 0.85373472095314 * vec4(dot(g00, g00), dot(g01, g01),\r
                                                 dot(g10, g10), dot(g11, g11));\r
  g00 *= norm.x;\r
  g01 *= norm.y;\r
  g10 *= norm.z;\r
  g11 *= norm.w;\r
  float n00 = dot(g00, vec2(fx.x, fy.x));\r
  float n10 = dot(g10, vec2(fx.y, fy.y));\r
  float n01 = dot(g01, vec2(fx.z, fy.z));\r
  float n11 = dot(g11, vec2(fx.w, fy.w));\r
  vec2 fade_xy = fade(Pf.xy);\r
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\r
  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\r
  return 2.3 * n_xy;\r
}

void main() {\r
  
  
  
  
  
  
  
  

  
  
  
  
  

  vec2 rotateUv = rotate(vUv, PI / 4.0, vec2(0.5));\r
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  

  

  
  
  
  
  
  
  
  
  

  
  

  
  

  
  
  
  

  
  
  

  float strength = step(0.9, sin(cnoise(vUv * 10.0) * 20.0));

  vec3 blackColor = vec3(0.0);\r
  vec3 uvColor = vec3(vUv, 0.2);\r
  vec3 mixColor = mix(blackColor, uvColor, strength);\r
  gl_FragColor = vec4(mixColor, 1.0);\r
}`;const GGe=()=>{let n,e,t=null,r={width:0,height:0},s=_e.useRef(null),o,l,c=null;const a=()=>{r.width=window.innerWidth,r.height=window.innerHeight,n=new Il,e=new is(75,r.width/r.height,.1,100),e.position.set(1,-1,1),n.add(e),t=new ec({canvas:s.current}),t.setSize(r.width,r.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.autoClear=!1,l=new j0(e,t.domElement),l.enableDamping=!0;const f=new gx(1,64),m=new Lo({vertexShader:zGe,fragmentShader:UGe,side:Mc});o=new Di(f,m),n.add(o);const _=new iB(n,e),x=new L0(new sn(r.width,r.height),2.2,.2,0);c=new rB(t),c.renderToScreen=!0,c.addPass(_),c.addPass(x)},d=()=>{l&&l.update(),o&&(o.rotation.y+=.002),o&&(o.rotation.x+=.002),c&&c.render(),l.update(),t.render(n,e),requestAnimationFrame(d)};return _e.useEffect(()=>{a(),d()},[]),pe.jsx("div",{className:"w-screen h-screen",children:pe.jsx("canvas",{ref:s})})};var Mue={exports:{}};(function(n,e){var t={};(function(r,s){n.exports=s()})(Epe,function(){var r,s,o;function l(a,d){if(!r)r=d;else if(!s)s=d;else{var f="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",m={};r(m),o=d(m),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([f],{type:"text/javascript"})))}}l(["exports"],function(a){function d(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var f,m={},_={};function x(){if(f)return _;f=1,Object.defineProperty(_,"__esModule",{value:!0}),_.setMatrixArrayType=function(T){_.ARRAY_TYPE=u=T},_.toRadian=function(T){return T*y},_.equals=function(T,b){return Math.abs(T-b)<=v*Math.max(1,Math.abs(T),Math.abs(b))},_.RANDOM=_.ARRAY_TYPE=_.EPSILON=void 0;var v=1e-6;_.EPSILON=v;var u=typeof Float32Array<"u"?Float32Array:Array;_.ARRAY_TYPE=u;var p=Math.random;_.RANDOM=p;var y=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var T=0,b=arguments.length;b--;)T+=arguments[b]*arguments[b];return Math.sqrt(T)}),_}var A,I={};function E(){if(A)return I;function v(b){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},v(b)}A=1,Object.defineProperty(I,"__esModule",{value:!0}),I.create=function(){var b=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b},I.clone=function(b){var M=new u.ARRAY_TYPE(4);return M[0]=b[0],M[1]=b[1],M[2]=b[2],M[3]=b[3],M},I.copy=function(b,M){return b[0]=M[0],b[1]=M[1],b[2]=M[2],b[3]=M[3],b},I.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b},I.fromValues=function(b,M,k,G){var W=new u.ARRAY_TYPE(4);return W[0]=b,W[1]=M,W[2]=k,W[3]=G,W},I.set=function(b,M,k,G,W){return b[0]=M,b[1]=k,b[2]=G,b[3]=W,b},I.transpose=function(b,M){if(b===M){var k=M[1];b[1]=M[2],b[2]=k}else b[0]=M[0],b[1]=M[2],b[2]=M[1],b[3]=M[3];return b},I.invert=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=k*R-W*G;return z?(b[0]=R*(z=1/z),b[1]=-G*z,b[2]=-W*z,b[3]=k*z,b):null},I.adjoint=function(b,M){var k=M[0];return b[0]=M[3],b[1]=-M[1],b[2]=-M[2],b[3]=k,b},I.determinant=function(b){return b[0]*b[3]-b[2]*b[1]},I.multiply=y,I.rotate=function(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=Math.sin(k),U=Math.cos(k);return b[0]=G*U+R*j,b[1]=W*U+z*j,b[2]=G*-j+R*U,b[3]=W*-j+z*U,b},I.scale=function(b,M,k){var G=M[1],W=M[2],R=M[3],z=k[0],j=k[1];return b[0]=M[0]*z,b[1]=G*z,b[2]=W*j,b[3]=R*j,b},I.fromRotation=function(b,M){var k=Math.sin(M),G=Math.cos(M);return b[0]=G,b[1]=k,b[2]=-k,b[3]=G,b},I.fromScaling=function(b,M){return b[0]=M[0],b[1]=0,b[2]=0,b[3]=M[1],b},I.str=function(b){return"mat2("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")"},I.frob=function(b){return Math.hypot(b[0],b[1],b[2],b[3])},I.LDU=function(b,M,k,G){return b[2]=G[2]/G[0],k[0]=G[0],k[1]=G[1],k[3]=G[3]-b[2]*k[1],[b,M,k]},I.add=function(b,M,k){return b[0]=M[0]+k[0],b[1]=M[1]+k[1],b[2]=M[2]+k[2],b[3]=M[3]+k[3],b},I.subtract=T,I.exactEquals=function(b,M){return b[0]===M[0]&&b[1]===M[1]&&b[2]===M[2]&&b[3]===M[3]},I.equals=function(b,M){var k=b[0],G=b[1],W=b[2],R=b[3],z=M[0],j=M[1],U=M[2],V=M[3];return Math.abs(k-z)<=u.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(G-j)<=u.EPSILON*Math.max(1,Math.abs(G),Math.abs(j))&&Math.abs(W-U)<=u.EPSILON*Math.max(1,Math.abs(W),Math.abs(U))&&Math.abs(R-V)<=u.EPSILON*Math.max(1,Math.abs(R),Math.abs(V))},I.multiplyScalar=function(b,M,k){return b[0]=M[0]*k,b[1]=M[1]*k,b[2]=M[2]*k,b[3]=M[3]*k,b},I.multiplyScalarAndAdd=function(b,M,k,G){return b[0]=M[0]+k[0]*G,b[1]=M[1]+k[1]*G,b[2]=M[2]+k[2]*G,b[3]=M[3]+k[3]*G,b},I.sub=I.mul=void 0;var u=function(b,M){if(b&&b.__esModule)return b;if(b===null||v(b)!=="object"&&typeof b!="function")return{default:b};var k=p(void 0);if(k&&k.has(b))return k.get(b);var G={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if(R!=="default"&&Object.prototype.hasOwnProperty.call(b,R)){var z=W?Object.getOwnPropertyDescriptor(b,R):null;z&&(z.get||z.set)?Object.defineProperty(G,R,z):G[R]=b[R]}return G.default=b,k&&k.set(b,G),G}(x());function p(b){if(typeof WeakMap!="function")return null;var M=new WeakMap,k=new WeakMap;return(p=function(G){return G?k:M})(b)}function y(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=k[0],U=k[1],V=k[2],X=k[3];return b[0]=G*j+R*U,b[1]=W*j+z*U,b[2]=G*V+R*X,b[3]=W*V+z*X,b}function T(b,M,k){return b[0]=M[0]-k[0],b[1]=M[1]-k[1],b[2]=M[2]-k[2],b[3]=M[3]-k[3],b}return I.mul=y,I.sub=T,I}var C,L={};function O(){if(C)return L;function v(b){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},v(b)}C=1,Object.defineProperty(L,"__esModule",{value:!0}),L.create=function(){var b=new u.ARRAY_TYPE(6);return u.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0,b[4]=0,b[5]=0),b[0]=1,b[3]=1,b},L.clone=function(b){var M=new u.ARRAY_TYPE(6);return M[0]=b[0],M[1]=b[1],M[2]=b[2],M[3]=b[3],M[4]=b[4],M[5]=b[5],M},L.copy=function(b,M){return b[0]=M[0],b[1]=M[1],b[2]=M[2],b[3]=M[3],b[4]=M[4],b[5]=M[5],b},L.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=0,b[5]=0,b},L.fromValues=function(b,M,k,G,W,R){var z=new u.ARRAY_TYPE(6);return z[0]=b,z[1]=M,z[2]=k,z[3]=G,z[4]=W,z[5]=R,z},L.set=function(b,M,k,G,W,R,z){return b[0]=M,b[1]=k,b[2]=G,b[3]=W,b[4]=R,b[5]=z,b},L.invert=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=M[4],j=M[5],U=k*R-G*W;return U?(b[0]=R*(U=1/U),b[1]=-G*U,b[2]=-W*U,b[3]=k*U,b[4]=(W*j-R*z)*U,b[5]=(G*z-k*j)*U,b):null},L.determinant=function(b){return b[0]*b[3]-b[1]*b[2]},L.multiply=y,L.rotate=function(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=Math.sin(k),X=Math.cos(k);return b[0]=G*X+R*V,b[1]=W*X+z*V,b[2]=G*-V+R*X,b[3]=W*-V+z*X,b[4]=j,b[5]=U,b},L.scale=function(b,M,k){var G=M[1],W=M[2],R=M[3],z=M[4],j=M[5],U=k[0],V=k[1];return b[0]=M[0]*U,b[1]=G*U,b[2]=W*V,b[3]=R*V,b[4]=z,b[5]=j,b},L.translate=function(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=k[0],X=k[1];return b[0]=G,b[1]=W,b[2]=R,b[3]=z,b[4]=G*V+R*X+j,b[5]=W*V+z*X+U,b},L.fromRotation=function(b,M){var k=Math.sin(M),G=Math.cos(M);return b[0]=G,b[1]=k,b[2]=-k,b[3]=G,b[4]=0,b[5]=0,b},L.fromScaling=function(b,M){return b[0]=M[0],b[1]=0,b[2]=0,b[3]=M[1],b[4]=0,b[5]=0,b},L.fromTranslation=function(b,M){return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=M[0],b[5]=M[1],b},L.str=function(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"},L.frob=function(b){return Math.hypot(b[0],b[1],b[2],b[3],b[4],b[5],1)},L.add=function(b,M,k){return b[0]=M[0]+k[0],b[1]=M[1]+k[1],b[2]=M[2]+k[2],b[3]=M[3]+k[3],b[4]=M[4]+k[4],b[5]=M[5]+k[5],b},L.subtract=T,L.multiplyScalar=function(b,M,k){return b[0]=M[0]*k,b[1]=M[1]*k,b[2]=M[2]*k,b[3]=M[3]*k,b[4]=M[4]*k,b[5]=M[5]*k,b},L.multiplyScalarAndAdd=function(b,M,k,G){return b[0]=M[0]+k[0]*G,b[1]=M[1]+k[1]*G,b[2]=M[2]+k[2]*G,b[3]=M[3]+k[3]*G,b[4]=M[4]+k[4]*G,b[5]=M[5]+k[5]*G,b},L.exactEquals=function(b,M){return b[0]===M[0]&&b[1]===M[1]&&b[2]===M[2]&&b[3]===M[3]&&b[4]===M[4]&&b[5]===M[5]},L.equals=function(b,M){var k=b[0],G=b[1],W=b[2],R=b[3],z=b[4],j=b[5],U=M[0],V=M[1],X=M[2],Q=M[3],ne=M[4],ue=M[5];return Math.abs(k-U)<=u.EPSILON*Math.max(1,Math.abs(k),Math.abs(U))&&Math.abs(G-V)<=u.EPSILON*Math.max(1,Math.abs(G),Math.abs(V))&&Math.abs(W-X)<=u.EPSILON*Math.max(1,Math.abs(W),Math.abs(X))&&Math.abs(R-Q)<=u.EPSILON*Math.max(1,Math.abs(R),Math.abs(Q))&&Math.abs(z-ne)<=u.EPSILON*Math.max(1,Math.abs(z),Math.abs(ne))&&Math.abs(j-ue)<=u.EPSILON*Math.max(1,Math.abs(j),Math.abs(ue))},L.sub=L.mul=void 0;var u=function(b,M){if(b&&b.__esModule)return b;if(b===null||v(b)!=="object"&&typeof b!="function")return{default:b};var k=p(void 0);if(k&&k.has(b))return k.get(b);var G={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if(R!=="default"&&Object.prototype.hasOwnProperty.call(b,R)){var z=W?Object.getOwnPropertyDescriptor(b,R):null;z&&(z.get||z.set)?Object.defineProperty(G,R,z):G[R]=b[R]}return G.default=b,k&&k.set(b,G),G}(x());function p(b){if(typeof WeakMap!="function")return null;var M=new WeakMap,k=new WeakMap;return(p=function(G){return G?k:M})(b)}function y(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=k[0],X=k[1],Q=k[2],ne=k[3],ue=k[4],fe=k[5];return b[0]=G*V+R*X,b[1]=W*V+z*X,b[2]=G*Q+R*ne,b[3]=W*Q+z*ne,b[4]=G*ue+R*fe+j,b[5]=W*ue+z*fe+U,b}function T(b,M,k){return b[0]=M[0]-k[0],b[1]=M[1]-k[1],b[2]=M[2]-k[2],b[3]=M[3]-k[3],b[4]=M[4]-k[4],b[5]=M[5]-k[5],b}return L.mul=y,L.sub=T,L}var H,q={};function Z(){if(H)return q;function v(b){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},v(b)}H=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var b=new u.ARRAY_TYPE(9);return u.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[5]=0,b[6]=0,b[7]=0),b[0]=1,b[4]=1,b[8]=1,b},q.fromMat4=function(b,M){return b[0]=M[0],b[1]=M[1],b[2]=M[2],b[3]=M[4],b[4]=M[5],b[5]=M[6],b[6]=M[8],b[7]=M[9],b[8]=M[10],b},q.clone=function(b){var M=new u.ARRAY_TYPE(9);return M[0]=b[0],M[1]=b[1],M[2]=b[2],M[3]=b[3],M[4]=b[4],M[5]=b[5],M[6]=b[6],M[7]=b[7],M[8]=b[8],M},q.copy=function(b,M){return b[0]=M[0],b[1]=M[1],b[2]=M[2],b[3]=M[3],b[4]=M[4],b[5]=M[5],b[6]=M[6],b[7]=M[7],b[8]=M[8],b},q.fromValues=function(b,M,k,G,W,R,z,j,U){var V=new u.ARRAY_TYPE(9);return V[0]=b,V[1]=M,V[2]=k,V[3]=G,V[4]=W,V[5]=R,V[6]=z,V[7]=j,V[8]=U,V},q.set=function(b,M,k,G,W,R,z,j,U,V){return b[0]=M,b[1]=k,b[2]=G,b[3]=W,b[4]=R,b[5]=z,b[6]=j,b[7]=U,b[8]=V,b},q.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},q.transpose=function(b,M){if(b===M){var k=M[1],G=M[2],W=M[5];b[1]=M[3],b[2]=M[6],b[3]=k,b[5]=M[7],b[6]=G,b[7]=W}else b[0]=M[0],b[1]=M[3],b[2]=M[6],b[3]=M[1],b[4]=M[4],b[5]=M[7],b[6]=M[2],b[7]=M[5],b[8]=M[8];return b},q.invert=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=M[4],j=M[5],U=M[6],V=M[7],X=M[8],Q=X*z-j*V,ne=-X*R+j*U,ue=V*R-z*U,fe=k*Q+G*ne+W*ue;return fe?(b[0]=Q*(fe=1/fe),b[1]=(-X*G+W*V)*fe,b[2]=(j*G-W*z)*fe,b[3]=ne*fe,b[4]=(X*k-W*U)*fe,b[5]=(-j*k+W*R)*fe,b[6]=ue*fe,b[7]=(-V*k+G*U)*fe,b[8]=(z*k-G*R)*fe,b):null},q.adjoint=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=M[4],j=M[5],U=M[6],V=M[7],X=M[8];return b[0]=z*X-j*V,b[1]=W*V-G*X,b[2]=G*j-W*z,b[3]=j*U-R*X,b[4]=k*X-W*U,b[5]=W*R-k*j,b[6]=R*V-z*U,b[7]=G*U-k*V,b[8]=k*z-G*R,b},q.determinant=function(b){var M=b[3],k=b[4],G=b[5],W=b[6],R=b[7],z=b[8];return b[0]*(z*k-G*R)+b[1]*(-z*M+G*W)+b[2]*(R*M-k*W)},q.multiply=y,q.translate=function(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=M[6],X=M[7],Q=M[8],ne=k[0],ue=k[1];return b[0]=G,b[1]=W,b[2]=R,b[3]=z,b[4]=j,b[5]=U,b[6]=ne*G+ue*z+V,b[7]=ne*W+ue*j+X,b[8]=ne*R+ue*U+Q,b},q.rotate=function(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=M[6],X=M[7],Q=M[8],ne=Math.sin(k),ue=Math.cos(k);return b[0]=ue*G+ne*z,b[1]=ue*W+ne*j,b[2]=ue*R+ne*U,b[3]=ue*z-ne*G,b[4]=ue*j-ne*W,b[5]=ue*U-ne*R,b[6]=V,b[7]=X,b[8]=Q,b},q.scale=function(b,M,k){var G=k[0],W=k[1];return b[0]=G*M[0],b[1]=G*M[1],b[2]=G*M[2],b[3]=W*M[3],b[4]=W*M[4],b[5]=W*M[5],b[6]=M[6],b[7]=M[7],b[8]=M[8],b},q.fromTranslation=function(b,M){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=M[0],b[7]=M[1],b[8]=1,b},q.fromRotation=function(b,M){var k=Math.sin(M),G=Math.cos(M);return b[0]=G,b[1]=k,b[2]=0,b[3]=-k,b[4]=G,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},q.fromScaling=function(b,M){return b[0]=M[0],b[1]=0,b[2]=0,b[3]=0,b[4]=M[1],b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},q.fromMat2d=function(b,M){return b[0]=M[0],b[1]=M[1],b[2]=0,b[3]=M[2],b[4]=M[3],b[5]=0,b[6]=M[4],b[7]=M[5],b[8]=1,b},q.fromQuat=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=k+k,j=G+G,U=W+W,V=k*z,X=G*z,Q=G*j,ne=W*z,ue=W*j,fe=W*U,ie=R*z,me=R*j,ve=R*U;return b[0]=1-Q-fe,b[3]=X-ve,b[6]=ne+me,b[1]=X+ve,b[4]=1-V-fe,b[7]=ue-ie,b[2]=ne-me,b[5]=ue+ie,b[8]=1-V-Q,b},q.normalFromMat4=function(b,M){var k=M[0],G=M[1],W=M[2],R=M[3],z=M[4],j=M[5],U=M[6],V=M[7],X=M[8],Q=M[9],ne=M[10],ue=M[11],fe=M[12],ie=M[13],me=M[14],ve=M[15],Ce=k*j-G*z,ke=k*U-W*z,Fe=k*V-R*z,Le=G*U-W*j,Ke=G*V-R*j,Ve=W*V-R*U,et=X*ie-Q*fe,ut=X*me-ne*fe,dt=X*ve-ue*fe,ft=Q*me-ne*ie,_t=Q*ve-ue*ie,It=ne*ve-ue*me,xt=Ce*It-ke*_t+Fe*ft+Le*dt-Ke*ut+Ve*et;return xt?(b[0]=(j*It-U*_t+V*ft)*(xt=1/xt),b[1]=(U*dt-z*It-V*ut)*xt,b[2]=(z*_t-j*dt+V*et)*xt,b[3]=(W*_t-G*It-R*ft)*xt,b[4]=(k*It-W*dt+R*ut)*xt,b[5]=(G*dt-k*_t-R*et)*xt,b[6]=(ie*Ve-me*Ke+ve*Le)*xt,b[7]=(me*Fe-fe*Ve-ve*ke)*xt,b[8]=(fe*Ke-ie*Fe+ve*Ce)*xt,b):null},q.projection=function(b,M,k){return b[0]=2/M,b[1]=0,b[2]=0,b[3]=0,b[4]=-2/k,b[5]=0,b[6]=-1,b[7]=1,b[8]=1,b},q.str=function(b){return"mat3("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+")"},q.frob=function(b){return Math.hypot(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])},q.add=function(b,M,k){return b[0]=M[0]+k[0],b[1]=M[1]+k[1],b[2]=M[2]+k[2],b[3]=M[3]+k[3],b[4]=M[4]+k[4],b[5]=M[5]+k[5],b[6]=M[6]+k[6],b[7]=M[7]+k[7],b[8]=M[8]+k[8],b},q.subtract=T,q.multiplyScalar=function(b,M,k){return b[0]=M[0]*k,b[1]=M[1]*k,b[2]=M[2]*k,b[3]=M[3]*k,b[4]=M[4]*k,b[5]=M[5]*k,b[6]=M[6]*k,b[7]=M[7]*k,b[8]=M[8]*k,b},q.multiplyScalarAndAdd=function(b,M,k,G){return b[0]=M[0]+k[0]*G,b[1]=M[1]+k[1]*G,b[2]=M[2]+k[2]*G,b[3]=M[3]+k[3]*G,b[4]=M[4]+k[4]*G,b[5]=M[5]+k[5]*G,b[6]=M[6]+k[6]*G,b[7]=M[7]+k[7]*G,b[8]=M[8]+k[8]*G,b},q.exactEquals=function(b,M){return b[0]===M[0]&&b[1]===M[1]&&b[2]===M[2]&&b[3]===M[3]&&b[4]===M[4]&&b[5]===M[5]&&b[6]===M[6]&&b[7]===M[7]&&b[8]===M[8]},q.equals=function(b,M){var k=b[0],G=b[1],W=b[2],R=b[3],z=b[4],j=b[5],U=b[6],V=b[7],X=b[8],Q=M[0],ne=M[1],ue=M[2],fe=M[3],ie=M[4],me=M[5],ve=M[6],Ce=M[7],ke=M[8];return Math.abs(k-Q)<=u.EPSILON*Math.max(1,Math.abs(k),Math.abs(Q))&&Math.abs(G-ne)<=u.EPSILON*Math.max(1,Math.abs(G),Math.abs(ne))&&Math.abs(W-ue)<=u.EPSILON*Math.max(1,Math.abs(W),Math.abs(ue))&&Math.abs(R-fe)<=u.EPSILON*Math.max(1,Math.abs(R),Math.abs(fe))&&Math.abs(z-ie)<=u.EPSILON*Math.max(1,Math.abs(z),Math.abs(ie))&&Math.abs(j-me)<=u.EPSILON*Math.max(1,Math.abs(j),Math.abs(me))&&Math.abs(U-ve)<=u.EPSILON*Math.max(1,Math.abs(U),Math.abs(ve))&&Math.abs(V-Ce)<=u.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ce))&&Math.abs(X-ke)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(ke))},q.sub=q.mul=void 0;var u=function(b,M){if(b&&b.__esModule)return b;if(b===null||v(b)!=="object"&&typeof b!="function")return{default:b};var k=p(void 0);if(k&&k.has(b))return k.get(b);var G={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if(R!=="default"&&Object.prototype.hasOwnProperty.call(b,R)){var z=W?Object.getOwnPropertyDescriptor(b,R):null;z&&(z.get||z.set)?Object.defineProperty(G,R,z):G[R]=b[R]}return G.default=b,k&&k.set(b,G),G}(x());function p(b){if(typeof WeakMap!="function")return null;var M=new WeakMap,k=new WeakMap;return(p=function(G){return G?k:M})(b)}function y(b,M,k){var G=M[0],W=M[1],R=M[2],z=M[3],j=M[4],U=M[5],V=M[6],X=M[7],Q=M[8],ne=k[0],ue=k[1],fe=k[2],ie=k[3],me=k[4],ve=k[5],Ce=k[6],ke=k[7],Fe=k[8];return b[0]=ne*G+ue*z+fe*V,b[1]=ne*W+ue*j+fe*X,b[2]=ne*R+ue*U+fe*Q,b[3]=ie*G+me*z+ve*V,b[4]=ie*W+me*j+ve*X,b[5]=ie*R+me*U+ve*Q,b[6]=Ce*G+ke*z+Fe*V,b[7]=Ce*W+ke*j+Fe*X,b[8]=Ce*R+ke*U+Fe*Q,b}function T(b,M,k){return b[0]=M[0]-k[0],b[1]=M[1]-k[1],b[2]=M[2]-k[2],b[3]=M[3]-k[3],b[4]=M[4]-k[4],b[5]=M[5]-k[5],b[6]=M[6]-k[6],b[7]=M[7]-k[7],b[8]=M[8]-k[8],b}return q.mul=y,q.sub=T,q}var J,re={};function se(){if(J)return re;function v(R){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},v(R)}J=1,Object.defineProperty(re,"__esModule",{value:!0}),re.create=function(){var R=new u.ARRAY_TYPE(16);return u.ARRAY_TYPE!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0),R[0]=1,R[5]=1,R[10]=1,R[15]=1,R},re.clone=function(R){var z=new u.ARRAY_TYPE(16);return z[0]=R[0],z[1]=R[1],z[2]=R[2],z[3]=R[3],z[4]=R[4],z[5]=R[5],z[6]=R[6],z[7]=R[7],z[8]=R[8],z[9]=R[9],z[10]=R[10],z[11]=R[11],z[12]=R[12],z[13]=R[13],z[14]=R[14],z[15]=R[15],z},re.copy=function(R,z){return R[0]=z[0],R[1]=z[1],R[2]=z[2],R[3]=z[3],R[4]=z[4],R[5]=z[5],R[6]=z[6],R[7]=z[7],R[8]=z[8],R[9]=z[9],R[10]=z[10],R[11]=z[11],R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15],R},re.fromValues=function(R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe){var Le=new u.ARRAY_TYPE(16);return Le[0]=R,Le[1]=z,Le[2]=j,Le[3]=U,Le[4]=V,Le[5]=X,Le[6]=Q,Le[7]=ne,Le[8]=ue,Le[9]=fe,Le[10]=ie,Le[11]=me,Le[12]=ve,Le[13]=Ce,Le[14]=ke,Le[15]=Fe,Le},re.set=function(R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe,Le){return R[0]=z,R[1]=j,R[2]=U,R[3]=V,R[4]=X,R[5]=Q,R[6]=ne,R[7]=ue,R[8]=fe,R[9]=ie,R[10]=me,R[11]=ve,R[12]=Ce,R[13]=ke,R[14]=Fe,R[15]=Le,R},re.identity=y,re.transpose=function(R,z){if(R===z){var j=z[1],U=z[2],V=z[3],X=z[6],Q=z[7],ne=z[11];R[1]=z[4],R[2]=z[8],R[3]=z[12],R[4]=j,R[6]=z[9],R[7]=z[13],R[8]=U,R[9]=X,R[11]=z[14],R[12]=V,R[13]=Q,R[14]=ne}else R[0]=z[0],R[1]=z[4],R[2]=z[8],R[3]=z[12],R[4]=z[1],R[5]=z[5],R[6]=z[9],R[7]=z[13],R[8]=z[2],R[9]=z[6],R[10]=z[10],R[11]=z[14],R[12]=z[3],R[13]=z[7],R[14]=z[11],R[15]=z[15];return R},re.invert=function(R,z){var j=z[0],U=z[1],V=z[2],X=z[3],Q=z[4],ne=z[5],ue=z[6],fe=z[7],ie=z[8],me=z[9],ve=z[10],Ce=z[11],ke=z[12],Fe=z[13],Le=z[14],Ke=z[15],Ve=j*ne-U*Q,et=j*ue-V*Q,ut=j*fe-X*Q,dt=U*ue-V*ne,ft=U*fe-X*ne,_t=V*fe-X*ue,It=ie*Fe-me*ke,xt=ie*Le-ve*ke,Vt=ie*Ke-Ce*ke,Kt=me*Le-ve*Fe,kt=me*Ke-Ce*Fe,Rn=ve*Ke-Ce*Le,wn=Ve*Rn-et*kt+ut*Kt+dt*Vt-ft*xt+_t*It;return wn?(R[0]=(ne*Rn-ue*kt+fe*Kt)*(wn=1/wn),R[1]=(V*kt-U*Rn-X*Kt)*wn,R[2]=(Fe*_t-Le*ft+Ke*dt)*wn,R[3]=(ve*ft-me*_t-Ce*dt)*wn,R[4]=(ue*Vt-Q*Rn-fe*xt)*wn,R[5]=(j*Rn-V*Vt+X*xt)*wn,R[6]=(Le*ut-ke*_t-Ke*et)*wn,R[7]=(ie*_t-ve*ut+Ce*et)*wn,R[8]=(Q*kt-ne*Vt+fe*It)*wn,R[9]=(U*Vt-j*kt-X*It)*wn,R[10]=(ke*ft-Fe*ut+Ke*Ve)*wn,R[11]=(me*ut-ie*ft-Ce*Ve)*wn,R[12]=(ne*xt-Q*Kt-ue*It)*wn,R[13]=(j*Kt-U*xt+V*It)*wn,R[14]=(Fe*et-ke*dt-Le*Ve)*wn,R[15]=(ie*dt-me*et+ve*Ve)*wn,R):null},re.adjoint=function(R,z){var j=z[0],U=z[1],V=z[2],X=z[3],Q=z[4],ne=z[5],ue=z[6],fe=z[7],ie=z[8],me=z[9],ve=z[10],Ce=z[11],ke=z[12],Fe=z[13],Le=z[14],Ke=z[15];return R[0]=ne*(ve*Ke-Ce*Le)-me*(ue*Ke-fe*Le)+Fe*(ue*Ce-fe*ve),R[1]=-(U*(ve*Ke-Ce*Le)-me*(V*Ke-X*Le)+Fe*(V*Ce-X*ve)),R[2]=U*(ue*Ke-fe*Le)-ne*(V*Ke-X*Le)+Fe*(V*fe-X*ue),R[3]=-(U*(ue*Ce-fe*ve)-ne*(V*Ce-X*ve)+me*(V*fe-X*ue)),R[4]=-(Q*(ve*Ke-Ce*Le)-ie*(ue*Ke-fe*Le)+ke*(ue*Ce-fe*ve)),R[5]=j*(ve*Ke-Ce*Le)-ie*(V*Ke-X*Le)+ke*(V*Ce-X*ve),R[6]=-(j*(ue*Ke-fe*Le)-Q*(V*Ke-X*Le)+ke*(V*fe-X*ue)),R[7]=j*(ue*Ce-fe*ve)-Q*(V*Ce-X*ve)+ie*(V*fe-X*ue),R[8]=Q*(me*Ke-Ce*Fe)-ie*(ne*Ke-fe*Fe)+ke*(ne*Ce-fe*me),R[9]=-(j*(me*Ke-Ce*Fe)-ie*(U*Ke-X*Fe)+ke*(U*Ce-X*me)),R[10]=j*(ne*Ke-fe*Fe)-Q*(U*Ke-X*Fe)+ke*(U*fe-X*ne),R[11]=-(j*(ne*Ce-fe*me)-Q*(U*Ce-X*me)+ie*(U*fe-X*ne)),R[12]=-(Q*(me*Le-ve*Fe)-ie*(ne*Le-ue*Fe)+ke*(ne*ve-ue*me)),R[13]=j*(me*Le-ve*Fe)-ie*(U*Le-V*Fe)+ke*(U*ve-V*me),R[14]=-(j*(ne*Le-ue*Fe)-Q*(U*Le-V*Fe)+ke*(U*ue-V*ne)),R[15]=j*(ne*ve-ue*me)-Q*(U*ve-V*me)+ie*(U*ue-V*ne),R},re.determinant=function(R){var z=R[0],j=R[1],U=R[2],V=R[3],X=R[4],Q=R[5],ne=R[6],ue=R[7],fe=R[8],ie=R[9],me=R[10],ve=R[11],Ce=R[12],ke=R[13],Fe=R[14],Le=R[15];return(z*Q-j*X)*(me*Le-ve*Fe)-(z*ne-U*X)*(ie*Le-ve*ke)+(z*ue-V*X)*(ie*Fe-me*ke)+(j*ne-U*Q)*(fe*Le-ve*Ce)-(j*ue-V*Q)*(fe*Fe-me*Ce)+(U*ue-V*ne)*(fe*ke-ie*Ce)},re.multiply=T,re.translate=function(R,z,j){var U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe=j[0],Le=j[1],Ke=j[2];return z===R?(R[12]=z[0]*Fe+z[4]*Le+z[8]*Ke+z[12],R[13]=z[1]*Fe+z[5]*Le+z[9]*Ke+z[13],R[14]=z[2]*Fe+z[6]*Le+z[10]*Ke+z[14],R[15]=z[3]*Fe+z[7]*Le+z[11]*Ke+z[15]):(V=z[1],X=z[2],Q=z[3],ne=z[4],ue=z[5],fe=z[6],ie=z[7],me=z[8],ve=z[9],Ce=z[10],ke=z[11],R[0]=U=z[0],R[1]=V,R[2]=X,R[3]=Q,R[4]=ne,R[5]=ue,R[6]=fe,R[7]=ie,R[8]=me,R[9]=ve,R[10]=Ce,R[11]=ke,R[12]=U*Fe+ne*Le+me*Ke+z[12],R[13]=V*Fe+ue*Le+ve*Ke+z[13],R[14]=X*Fe+fe*Le+Ce*Ke+z[14],R[15]=Q*Fe+ie*Le+ke*Ke+z[15]),R},re.scale=function(R,z,j){var U=j[0],V=j[1],X=j[2];return R[0]=z[0]*U,R[1]=z[1]*U,R[2]=z[2]*U,R[3]=z[3]*U,R[4]=z[4]*V,R[5]=z[5]*V,R[6]=z[6]*V,R[7]=z[7]*V,R[8]=z[8]*X,R[9]=z[9]*X,R[10]=z[10]*X,R[11]=z[11]*X,R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15],R},re.rotate=function(R,z,j,U){var V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut,dt,ft,_t,It,xt,Vt,Kt,kt=U[0],Rn=U[1],wn=U[2],pn=Math.hypot(kt,Rn,wn);return pn<u.EPSILON?null:(kt*=pn=1/pn,Rn*=pn,wn*=pn,V=Math.sin(j),X=Math.cos(j),ue=z[1],fe=z[2],ie=z[3],ve=z[5],Ce=z[6],ke=z[7],Le=z[9],Ke=z[10],Ve=z[11],et=kt*kt*(Q=1-X)+X,ft=kt*Rn*Q-wn*V,_t=Rn*Rn*Q+X,It=wn*Rn*Q+kt*V,xt=kt*wn*Q+Rn*V,Vt=Rn*wn*Q-kt*V,Kt=wn*wn*Q+X,R[0]=(ne=z[0])*et+(me=z[4])*(ut=Rn*kt*Q+wn*V)+(Fe=z[8])*(dt=wn*kt*Q-Rn*V),R[1]=ue*et+ve*ut+Le*dt,R[2]=fe*et+Ce*ut+Ke*dt,R[3]=ie*et+ke*ut+Ve*dt,R[4]=ne*ft+me*_t+Fe*It,R[5]=ue*ft+ve*_t+Le*It,R[6]=fe*ft+Ce*_t+Ke*It,R[7]=ie*ft+ke*_t+Ve*It,R[8]=ne*xt+me*Vt+Fe*Kt,R[9]=ue*xt+ve*Vt+Le*Kt,R[10]=fe*xt+Ce*Vt+Ke*Kt,R[11]=ie*xt+ke*Vt+Ve*Kt,z!==R&&(R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15]),R)},re.rotateX=function(R,z,j){var U=Math.sin(j),V=Math.cos(j),X=z[4],Q=z[5],ne=z[6],ue=z[7],fe=z[8],ie=z[9],me=z[10],ve=z[11];return z!==R&&(R[0]=z[0],R[1]=z[1],R[2]=z[2],R[3]=z[3],R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15]),R[4]=X*V+fe*U,R[5]=Q*V+ie*U,R[6]=ne*V+me*U,R[7]=ue*V+ve*U,R[8]=fe*V-X*U,R[9]=ie*V-Q*U,R[10]=me*V-ne*U,R[11]=ve*V-ue*U,R},re.rotateY=function(R,z,j){var U=Math.sin(j),V=Math.cos(j),X=z[0],Q=z[1],ne=z[2],ue=z[3],fe=z[8],ie=z[9],me=z[10],ve=z[11];return z!==R&&(R[4]=z[4],R[5]=z[5],R[6]=z[6],R[7]=z[7],R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15]),R[0]=X*V-fe*U,R[1]=Q*V-ie*U,R[2]=ne*V-me*U,R[3]=ue*V-ve*U,R[8]=X*U+fe*V,R[9]=Q*U+ie*V,R[10]=ne*U+me*V,R[11]=ue*U+ve*V,R},re.rotateZ=function(R,z,j){var U=Math.sin(j),V=Math.cos(j),X=z[0],Q=z[1],ne=z[2],ue=z[3],fe=z[4],ie=z[5],me=z[6],ve=z[7];return z!==R&&(R[8]=z[8],R[9]=z[9],R[10]=z[10],R[11]=z[11],R[12]=z[12],R[13]=z[13],R[14]=z[14],R[15]=z[15]),R[0]=X*V+fe*U,R[1]=Q*V+ie*U,R[2]=ne*V+me*U,R[3]=ue*V+ve*U,R[4]=fe*V-X*U,R[5]=ie*V-Q*U,R[6]=me*V-ne*U,R[7]=ve*V-ue*U,R},re.fromTranslation=function(R,z){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=z[0],R[13]=z[1],R[14]=z[2],R[15]=1,R},re.fromScaling=function(R,z){return R[0]=z[0],R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=z[1],R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=z[2],R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotation=function(R,z,j){var U,V,X,Q=j[0],ne=j[1],ue=j[2],fe=Math.hypot(Q,ne,ue);return fe<u.EPSILON?null:(Q*=fe=1/fe,ne*=fe,ue*=fe,U=Math.sin(z),V=Math.cos(z),R[0]=Q*Q*(X=1-V)+V,R[1]=ne*Q*X+ue*U,R[2]=ue*Q*X-ne*U,R[3]=0,R[4]=Q*ne*X-ue*U,R[5]=ne*ne*X+V,R[6]=ue*ne*X+Q*U,R[7]=0,R[8]=Q*ue*X+ne*U,R[9]=ne*ue*X-Q*U,R[10]=ue*ue*X+V,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R)},re.fromXRotation=function(R,z){var j=Math.sin(z),U=Math.cos(z);return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=U,R[6]=j,R[7]=0,R[8]=0,R[9]=-j,R[10]=U,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromYRotation=function(R,z){var j=Math.sin(z),U=Math.cos(z);return R[0]=U,R[1]=0,R[2]=-j,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=j,R[9]=0,R[10]=U,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromZRotation=function(R,z){var j=Math.sin(z),U=Math.cos(z);return R[0]=U,R[1]=j,R[2]=0,R[3]=0,R[4]=-j,R[5]=U,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotationTranslation=b,re.fromQuat2=function(R,z){var j=new u.ARRAY_TYPE(3),U=-z[0],V=-z[1],X=-z[2],Q=z[3],ne=z[4],ue=z[5],fe=z[6],ie=z[7],me=U*U+V*V+X*X+Q*Q;return me>0?(j[0]=2*(ne*Q+ie*U+ue*X-fe*V)/me,j[1]=2*(ue*Q+ie*V+fe*U-ne*X)/me,j[2]=2*(fe*Q+ie*X+ne*V-ue*U)/me):(j[0]=2*(ne*Q+ie*U+ue*X-fe*V),j[1]=2*(ue*Q+ie*V+fe*U-ne*X),j[2]=2*(fe*Q+ie*X+ne*V-ue*U)),b(R,z,j),R},re.getTranslation=function(R,z){return R[0]=z[12],R[1]=z[13],R[2]=z[14],R},re.getScaling=M,re.getRotation=function(R,z){var j=new u.ARRAY_TYPE(3);M(j,z);var U=1/j[0],V=1/j[1],X=1/j[2],Q=z[0]*U,ne=z[1]*V,ue=z[2]*X,fe=z[4]*U,ie=z[5]*V,me=z[6]*X,ve=z[8]*U,Ce=z[9]*V,ke=z[10]*X,Fe=Q+ie+ke,Le=0;return Fe>0?(Le=2*Math.sqrt(Fe+1),R[3]=.25*Le,R[0]=(me-Ce)/Le,R[1]=(ve-ue)/Le,R[2]=(ne-fe)/Le):Q>ie&&Q>ke?(Le=2*Math.sqrt(1+Q-ie-ke),R[3]=(me-Ce)/Le,R[0]=.25*Le,R[1]=(ne+fe)/Le,R[2]=(ve+ue)/Le):ie>ke?(Le=2*Math.sqrt(1+ie-Q-ke),R[3]=(ve-ue)/Le,R[0]=(ne+fe)/Le,R[1]=.25*Le,R[2]=(me+Ce)/Le):(Le=2*Math.sqrt(1+ke-Q-ie),R[3]=(ne-fe)/Le,R[0]=(ve+ue)/Le,R[1]=(me+Ce)/Le,R[2]=.25*Le),R},re.fromRotationTranslationScale=function(R,z,j,U){var V=z[0],X=z[1],Q=z[2],ne=z[3],ue=V+V,fe=X+X,ie=Q+Q,me=V*ue,ve=V*fe,Ce=V*ie,ke=X*fe,Fe=X*ie,Le=Q*ie,Ke=ne*ue,Ve=ne*fe,et=ne*ie,ut=U[0],dt=U[1],ft=U[2];return R[0]=(1-(ke+Le))*ut,R[1]=(ve+et)*ut,R[2]=(Ce-Ve)*ut,R[3]=0,R[4]=(ve-et)*dt,R[5]=(1-(me+Le))*dt,R[6]=(Fe+Ke)*dt,R[7]=0,R[8]=(Ce+Ve)*ft,R[9]=(Fe-Ke)*ft,R[10]=(1-(me+ke))*ft,R[11]=0,R[12]=j[0],R[13]=j[1],R[14]=j[2],R[15]=1,R},re.fromRotationTranslationScaleOrigin=function(R,z,j,U,V){var X=z[0],Q=z[1],ne=z[2],ue=z[3],fe=X+X,ie=Q+Q,me=ne+ne,ve=X*fe,Ce=X*ie,ke=X*me,Fe=Q*ie,Le=Q*me,Ke=ne*me,Ve=ue*fe,et=ue*ie,ut=ue*me,dt=U[0],ft=U[1],_t=U[2],It=V[0],xt=V[1],Vt=V[2],Kt=(1-(Fe+Ke))*dt,kt=(Ce+ut)*dt,Rn=(ke-et)*dt,wn=(Ce-ut)*ft,pn=(1-(ve+Ke))*ft,rn=(Le+Ve)*ft,rr=(ke+et)*_t,Pn=(Le-Ve)*_t,zn=(1-(ve+Fe))*_t;return R[0]=Kt,R[1]=kt,R[2]=Rn,R[3]=0,R[4]=wn,R[5]=pn,R[6]=rn,R[7]=0,R[8]=rr,R[9]=Pn,R[10]=zn,R[11]=0,R[12]=j[0]+It-(Kt*It+wn*xt+rr*Vt),R[13]=j[1]+xt-(kt*It+pn*xt+Pn*Vt),R[14]=j[2]+Vt-(Rn*It+rn*xt+zn*Vt),R[15]=1,R},re.fromQuat=function(R,z){var j=z[0],U=z[1],V=z[2],X=z[3],Q=j+j,ne=U+U,ue=V+V,fe=j*Q,ie=U*Q,me=U*ne,ve=V*Q,Ce=V*ne,ke=V*ue,Fe=X*Q,Le=X*ne,Ke=X*ue;return R[0]=1-me-ke,R[1]=ie+Ke,R[2]=ve-Le,R[3]=0,R[4]=ie-Ke,R[5]=1-fe-ke,R[6]=Ce+Fe,R[7]=0,R[8]=ve+Le,R[9]=Ce-Fe,R[10]=1-fe-me,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.frustum=function(R,z,j,U,V,X,Q){var ne=1/(j-z),ue=1/(V-U),fe=1/(X-Q);return R[0]=2*X*ne,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=2*X*ue,R[6]=0,R[7]=0,R[8]=(j+z)*ne,R[9]=(V+U)*ue,R[10]=(Q+X)*fe,R[11]=-1,R[12]=0,R[13]=0,R[14]=Q*X*2*fe,R[15]=0,R},re.perspectiveNO=k,re.perspectiveZO=function(R,z,j,U,V){var X,Q=1/Math.tan(z/2);return R[0]=Q/j,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=Q,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,V!=null&&V!==1/0?(R[10]=V*(X=1/(U-V)),R[14]=V*U*X):(R[10]=-1,R[14]=-U),R},re.perspectiveFromFieldOfView=function(R,z,j,U){var V=Math.tan(z.upDegrees*Math.PI/180),X=Math.tan(z.downDegrees*Math.PI/180),Q=Math.tan(z.leftDegrees*Math.PI/180),ne=Math.tan(z.rightDegrees*Math.PI/180),ue=2/(Q+ne),fe=2/(V+X);return R[0]=ue,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=fe,R[6]=0,R[7]=0,R[8]=-(Q-ne)*ue*.5,R[9]=(V-X)*fe*.5,R[10]=U/(j-U),R[11]=-1,R[12]=0,R[13]=0,R[14]=U*j/(j-U),R[15]=0,R},re.orthoNO=G,re.orthoZO=function(R,z,j,U,V,X,Q){var ne=1/(z-j),ue=1/(U-V),fe=1/(X-Q);return R[0]=-2*ne,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ue,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=fe,R[11]=0,R[12]=(z+j)*ne,R[13]=(V+U)*ue,R[14]=X*fe,R[15]=1,R},re.lookAt=function(R,z,j,U){var V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke=z[0],Fe=z[1],Le=z[2],Ke=U[0],Ve=U[1],et=U[2],ut=j[0],dt=j[1],ft=j[2];return Math.abs(ke-ut)<u.EPSILON&&Math.abs(Fe-dt)<u.EPSILON&&Math.abs(Le-ft)<u.EPSILON?y(R):(ie=ke-ut,me=Fe-dt,ve=Le-ft,V=Ve*(ve*=Ce=1/Math.hypot(ie,me,ve))-et*(me*=Ce),X=et*(ie*=Ce)-Ke*ve,Q=Ke*me-Ve*ie,(Ce=Math.hypot(V,X,Q))?(V*=Ce=1/Ce,X*=Ce,Q*=Ce):(V=0,X=0,Q=0),ne=me*Q-ve*X,ue=ve*V-ie*Q,fe=ie*X-me*V,(Ce=Math.hypot(ne,ue,fe))?(ne*=Ce=1/Ce,ue*=Ce,fe*=Ce):(ne=0,ue=0,fe=0),R[0]=V,R[1]=ne,R[2]=ie,R[3]=0,R[4]=X,R[5]=ue,R[6]=me,R[7]=0,R[8]=Q,R[9]=fe,R[10]=ve,R[11]=0,R[12]=-(V*ke+X*Fe+Q*Le),R[13]=-(ne*ke+ue*Fe+fe*Le),R[14]=-(ie*ke+me*Fe+ve*Le),R[15]=1,R)},re.targetTo=function(R,z,j,U){var V=z[0],X=z[1],Q=z[2],ne=U[0],ue=U[1],fe=U[2],ie=V-j[0],me=X-j[1],ve=Q-j[2],Ce=ie*ie+me*me+ve*ve;Ce>0&&(ie*=Ce=1/Math.sqrt(Ce),me*=Ce,ve*=Ce);var ke=ue*ve-fe*me,Fe=fe*ie-ne*ve,Le=ne*me-ue*ie;return(Ce=ke*ke+Fe*Fe+Le*Le)>0&&(ke*=Ce=1/Math.sqrt(Ce),Fe*=Ce,Le*=Ce),R[0]=ke,R[1]=Fe,R[2]=Le,R[3]=0,R[4]=me*Le-ve*Fe,R[5]=ve*ke-ie*Le,R[6]=ie*Fe-me*ke,R[7]=0,R[8]=ie,R[9]=me,R[10]=ve,R[11]=0,R[12]=V,R[13]=X,R[14]=Q,R[15]=1,R},re.str=function(R){return"mat4("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+", "+R[8]+", "+R[9]+", "+R[10]+", "+R[11]+", "+R[12]+", "+R[13]+", "+R[14]+", "+R[15]+")"},re.frob=function(R){return Math.hypot(R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8],R[9],R[10],R[11],R[12],R[13],R[14],R[15])},re.add=function(R,z,j){return R[0]=z[0]+j[0],R[1]=z[1]+j[1],R[2]=z[2]+j[2],R[3]=z[3]+j[3],R[4]=z[4]+j[4],R[5]=z[5]+j[5],R[6]=z[6]+j[6],R[7]=z[7]+j[7],R[8]=z[8]+j[8],R[9]=z[9]+j[9],R[10]=z[10]+j[10],R[11]=z[11]+j[11],R[12]=z[12]+j[12],R[13]=z[13]+j[13],R[14]=z[14]+j[14],R[15]=z[15]+j[15],R},re.subtract=W,re.multiplyScalar=function(R,z,j){return R[0]=z[0]*j,R[1]=z[1]*j,R[2]=z[2]*j,R[3]=z[3]*j,R[4]=z[4]*j,R[5]=z[5]*j,R[6]=z[6]*j,R[7]=z[7]*j,R[8]=z[8]*j,R[9]=z[9]*j,R[10]=z[10]*j,R[11]=z[11]*j,R[12]=z[12]*j,R[13]=z[13]*j,R[14]=z[14]*j,R[15]=z[15]*j,R},re.multiplyScalarAndAdd=function(R,z,j,U){return R[0]=z[0]+j[0]*U,R[1]=z[1]+j[1]*U,R[2]=z[2]+j[2]*U,R[3]=z[3]+j[3]*U,R[4]=z[4]+j[4]*U,R[5]=z[5]+j[5]*U,R[6]=z[6]+j[6]*U,R[7]=z[7]+j[7]*U,R[8]=z[8]+j[8]*U,R[9]=z[9]+j[9]*U,R[10]=z[10]+j[10]*U,R[11]=z[11]+j[11]*U,R[12]=z[12]+j[12]*U,R[13]=z[13]+j[13]*U,R[14]=z[14]+j[14]*U,R[15]=z[15]+j[15]*U,R},re.exactEquals=function(R,z){return R[0]===z[0]&&R[1]===z[1]&&R[2]===z[2]&&R[3]===z[3]&&R[4]===z[4]&&R[5]===z[5]&&R[6]===z[6]&&R[7]===z[7]&&R[8]===z[8]&&R[9]===z[9]&&R[10]===z[10]&&R[11]===z[11]&&R[12]===z[12]&&R[13]===z[13]&&R[14]===z[14]&&R[15]===z[15]},re.equals=function(R,z){var j=R[0],U=R[1],V=R[2],X=R[3],Q=R[4],ne=R[5],ue=R[6],fe=R[7],ie=R[8],me=R[9],ve=R[10],Ce=R[11],ke=R[12],Fe=R[13],Le=R[14],Ke=R[15],Ve=z[0],et=z[1],ut=z[2],dt=z[3],ft=z[4],_t=z[5],It=z[6],xt=z[7],Vt=z[8],Kt=z[9],kt=z[10],Rn=z[11],wn=z[12],pn=z[13],rn=z[14],rr=z[15];return Math.abs(j-Ve)<=u.EPSILON*Math.max(1,Math.abs(j),Math.abs(Ve))&&Math.abs(U-et)<=u.EPSILON*Math.max(1,Math.abs(U),Math.abs(et))&&Math.abs(V-ut)<=u.EPSILON*Math.max(1,Math.abs(V),Math.abs(ut))&&Math.abs(X-dt)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(dt))&&Math.abs(Q-ft)<=u.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ft))&&Math.abs(ne-_t)<=u.EPSILON*Math.max(1,Math.abs(ne),Math.abs(_t))&&Math.abs(ue-It)<=u.EPSILON*Math.max(1,Math.abs(ue),Math.abs(It))&&Math.abs(fe-xt)<=u.EPSILON*Math.max(1,Math.abs(fe),Math.abs(xt))&&Math.abs(ie-Vt)<=u.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Vt))&&Math.abs(me-Kt)<=u.EPSILON*Math.max(1,Math.abs(me),Math.abs(Kt))&&Math.abs(ve-kt)<=u.EPSILON*Math.max(1,Math.abs(ve),Math.abs(kt))&&Math.abs(Ce-Rn)<=u.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Rn))&&Math.abs(ke-wn)<=u.EPSILON*Math.max(1,Math.abs(ke),Math.abs(wn))&&Math.abs(Fe-pn)<=u.EPSILON*Math.max(1,Math.abs(Fe),Math.abs(pn))&&Math.abs(Le-rn)<=u.EPSILON*Math.max(1,Math.abs(Le),Math.abs(rn))&&Math.abs(Ke-rr)<=u.EPSILON*Math.max(1,Math.abs(Ke),Math.abs(rr))},re.sub=re.mul=re.ortho=re.perspective=void 0;var u=function(R,z){if(R&&R.__esModule)return R;if(R===null||v(R)!=="object"&&typeof R!="function")return{default:R};var j=p(void 0);if(j&&j.has(R))return j.get(R);var U={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in R)if(X!=="default"&&Object.prototype.hasOwnProperty.call(R,X)){var Q=V?Object.getOwnPropertyDescriptor(R,X):null;Q&&(Q.get||Q.set)?Object.defineProperty(U,X,Q):U[X]=R[X]}return U.default=R,j&&j.set(R,U),U}(x());function p(R){if(typeof WeakMap!="function")return null;var z=new WeakMap,j=new WeakMap;return(p=function(U){return U?j:z})(R)}function y(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R}function T(R,z,j){var U=z[0],V=z[1],X=z[2],Q=z[3],ne=z[4],ue=z[5],fe=z[6],ie=z[7],me=z[8],ve=z[9],Ce=z[10],ke=z[11],Fe=z[12],Le=z[13],Ke=z[14],Ve=z[15],et=j[0],ut=j[1],dt=j[2],ft=j[3];return R[0]=et*U+ut*ne+dt*me+ft*Fe,R[1]=et*V+ut*ue+dt*ve+ft*Le,R[2]=et*X+ut*fe+dt*Ce+ft*Ke,R[3]=et*Q+ut*ie+dt*ke+ft*Ve,R[4]=(et=j[4])*U+(ut=j[5])*ne+(dt=j[6])*me+(ft=j[7])*Fe,R[5]=et*V+ut*ue+dt*ve+ft*Le,R[6]=et*X+ut*fe+dt*Ce+ft*Ke,R[7]=et*Q+ut*ie+dt*ke+ft*Ve,R[8]=(et=j[8])*U+(ut=j[9])*ne+(dt=j[10])*me+(ft=j[11])*Fe,R[9]=et*V+ut*ue+dt*ve+ft*Le,R[10]=et*X+ut*fe+dt*Ce+ft*Ke,R[11]=et*Q+ut*ie+dt*ke+ft*Ve,R[12]=(et=j[12])*U+(ut=j[13])*ne+(dt=j[14])*me+(ft=j[15])*Fe,R[13]=et*V+ut*ue+dt*ve+ft*Le,R[14]=et*X+ut*fe+dt*Ce+ft*Ke,R[15]=et*Q+ut*ie+dt*ke+ft*Ve,R}function b(R,z,j){var U=z[0],V=z[1],X=z[2],Q=z[3],ne=U+U,ue=V+V,fe=X+X,ie=U*ne,me=U*ue,ve=U*fe,Ce=V*ue,ke=V*fe,Fe=X*fe,Le=Q*ne,Ke=Q*ue,Ve=Q*fe;return R[0]=1-(Ce+Fe),R[1]=me+Ve,R[2]=ve-Ke,R[3]=0,R[4]=me-Ve,R[5]=1-(ie+Fe),R[6]=ke+Le,R[7]=0,R[8]=ve+Ke,R[9]=ke-Le,R[10]=1-(ie+Ce),R[11]=0,R[12]=j[0],R[13]=j[1],R[14]=j[2],R[15]=1,R}function M(R,z){var j=z[4],U=z[5],V=z[6],X=z[8],Q=z[9],ne=z[10];return R[0]=Math.hypot(z[0],z[1],z[2]),R[1]=Math.hypot(j,U,V),R[2]=Math.hypot(X,Q,ne),R}function k(R,z,j,U,V){var X,Q=1/Math.tan(z/2);return R[0]=Q/j,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=Q,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,V!=null&&V!==1/0?(R[10]=(V+U)*(X=1/(U-V)),R[14]=2*V*U*X):(R[10]=-1,R[14]=-2*U),R}function G(R,z,j,U,V,X,Q){var ne=1/(z-j),ue=1/(U-V),fe=1/(X-Q);return R[0]=-2*ne,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ue,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=2*fe,R[11]=0,R[12]=(z+j)*ne,R[13]=(V+U)*ue,R[14]=(Q+X)*fe,R[15]=1,R}function W(R,z,j){return R[0]=z[0]-j[0],R[1]=z[1]-j[1],R[2]=z[2]-j[2],R[3]=z[3]-j[3],R[4]=z[4]-j[4],R[5]=z[5]-j[5],R[6]=z[6]-j[6],R[7]=z[7]-j[7],R[8]=z[8]-j[8],R[9]=z[9]-j[9],R[10]=z[10]-j[10],R[11]=z[11]-j[11],R[12]=z[12]-j[12],R[13]=z[13]-j[13],R[14]=z[14]-j[14],R[15]=z[15]-j[15],R}return re.perspective=k,re.ortho=G,re.mul=T,re.sub=W,re}var ae,he={},Ae={};function Ee(){if(ae)return Ae;function v(V){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},v(V)}ae=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.create=y,Ae.clone=function(V){var X=new u.ARRAY_TYPE(3);return X[0]=V[0],X[1]=V[1],X[2]=V[2],X},Ae.length=T,Ae.fromValues=function(V,X,Q){var ne=new u.ARRAY_TYPE(3);return ne[0]=V,ne[1]=X,ne[2]=Q,ne},Ae.copy=function(V,X){return V[0]=X[0],V[1]=X[1],V[2]=X[2],V},Ae.set=function(V,X,Q,ne){return V[0]=X,V[1]=Q,V[2]=ne,V},Ae.add=function(V,X,Q){return V[0]=X[0]+Q[0],V[1]=X[1]+Q[1],V[2]=X[2]+Q[2],V},Ae.subtract=b,Ae.multiply=M,Ae.divide=k,Ae.ceil=function(V,X){return V[0]=Math.ceil(X[0]),V[1]=Math.ceil(X[1]),V[2]=Math.ceil(X[2]),V},Ae.floor=function(V,X){return V[0]=Math.floor(X[0]),V[1]=Math.floor(X[1]),V[2]=Math.floor(X[2]),V},Ae.min=function(V,X,Q){return V[0]=Math.min(X[0],Q[0]),V[1]=Math.min(X[1],Q[1]),V[2]=Math.min(X[2],Q[2]),V},Ae.max=function(V,X,Q){return V[0]=Math.max(X[0],Q[0]),V[1]=Math.max(X[1],Q[1]),V[2]=Math.max(X[2],Q[2]),V},Ae.round=function(V,X){return V[0]=Math.round(X[0]),V[1]=Math.round(X[1]),V[2]=Math.round(X[2]),V},Ae.scale=function(V,X,Q){return V[0]=X[0]*Q,V[1]=X[1]*Q,V[2]=X[2]*Q,V},Ae.scaleAndAdd=function(V,X,Q,ne){return V[0]=X[0]+Q[0]*ne,V[1]=X[1]+Q[1]*ne,V[2]=X[2]+Q[2]*ne,V},Ae.distance=G,Ae.squaredDistance=W,Ae.squaredLength=R,Ae.negate=function(V,X){return V[0]=-X[0],V[1]=-X[1],V[2]=-X[2],V},Ae.inverse=function(V,X){return V[0]=1/X[0],V[1]=1/X[1],V[2]=1/X[2],V},Ae.normalize=function(V,X){var Q=X[0],ne=X[1],ue=X[2],fe=Q*Q+ne*ne+ue*ue;return fe>0&&(fe=1/Math.sqrt(fe)),V[0]=X[0]*fe,V[1]=X[1]*fe,V[2]=X[2]*fe,V},Ae.dot=z,Ae.cross=function(V,X,Q){var ne=X[0],ue=X[1],fe=X[2],ie=Q[0],me=Q[1],ve=Q[2];return V[0]=ue*ve-fe*me,V[1]=fe*ie-ne*ve,V[2]=ne*me-ue*ie,V},Ae.lerp=function(V,X,Q,ne){var ue=X[0],fe=X[1],ie=X[2];return V[0]=ue+ne*(Q[0]-ue),V[1]=fe+ne*(Q[1]-fe),V[2]=ie+ne*(Q[2]-ie),V},Ae.hermite=function(V,X,Q,ne,ue,fe){var ie=fe*fe,me=ie*(2*fe-3)+1,ve=ie*(fe-2)+fe,Ce=ie*(fe-1),ke=ie*(3-2*fe);return V[0]=X[0]*me+Q[0]*ve+ne[0]*Ce+ue[0]*ke,V[1]=X[1]*me+Q[1]*ve+ne[1]*Ce+ue[1]*ke,V[2]=X[2]*me+Q[2]*ve+ne[2]*Ce+ue[2]*ke,V},Ae.bezier=function(V,X,Q,ne,ue,fe){var ie=1-fe,me=ie*ie,ve=fe*fe,Ce=me*ie,ke=3*fe*me,Fe=3*ve*ie,Le=ve*fe;return V[0]=X[0]*Ce+Q[0]*ke+ne[0]*Fe+ue[0]*Le,V[1]=X[1]*Ce+Q[1]*ke+ne[1]*Fe+ue[1]*Le,V[2]=X[2]*Ce+Q[2]*ke+ne[2]*Fe+ue[2]*Le,V},Ae.random=function(V,X){X=X||1;var Q=2*u.RANDOM()*Math.PI,ne=2*u.RANDOM()-1,ue=Math.sqrt(1-ne*ne)*X;return V[0]=Math.cos(Q)*ue,V[1]=Math.sin(Q)*ue,V[2]=ne*X,V},Ae.transformMat4=function(V,X,Q){var ne=X[0],ue=X[1],fe=X[2],ie=Q[3]*ne+Q[7]*ue+Q[11]*fe+Q[15];return V[0]=(Q[0]*ne+Q[4]*ue+Q[8]*fe+Q[12])/(ie=ie||1),V[1]=(Q[1]*ne+Q[5]*ue+Q[9]*fe+Q[13])/ie,V[2]=(Q[2]*ne+Q[6]*ue+Q[10]*fe+Q[14])/ie,V},Ae.transformMat3=function(V,X,Q){var ne=X[0],ue=X[1],fe=X[2];return V[0]=ne*Q[0]+ue*Q[3]+fe*Q[6],V[1]=ne*Q[1]+ue*Q[4]+fe*Q[7],V[2]=ne*Q[2]+ue*Q[5]+fe*Q[8],V},Ae.transformQuat=function(V,X,Q){var ne=Q[0],ue=Q[1],fe=Q[2],ie=X[0],me=X[1],ve=X[2],Ce=ue*ve-fe*me,ke=fe*ie-ne*ve,Fe=ne*me-ue*ie,Le=ue*Fe-fe*ke,Ke=fe*Ce-ne*Fe,Ve=ne*ke-ue*Ce,et=2*Q[3];return ke*=et,Fe*=et,Ke*=2,Ve*=2,V[0]=ie+(Ce*=et)+(Le*=2),V[1]=me+ke+Ke,V[2]=ve+Fe+Ve,V},Ae.rotateX=function(V,X,Q,ne){var ue=[],fe=[];return ue[0]=X[0]-Q[0],ue[1]=X[1]-Q[1],ue[2]=X[2]-Q[2],fe[0]=ue[0],fe[1]=ue[1]*Math.cos(ne)-ue[2]*Math.sin(ne),fe[2]=ue[1]*Math.sin(ne)+ue[2]*Math.cos(ne),V[0]=fe[0]+Q[0],V[1]=fe[1]+Q[1],V[2]=fe[2]+Q[2],V},Ae.rotateY=function(V,X,Q,ne){var ue=[],fe=[];return ue[0]=X[0]-Q[0],ue[1]=X[1]-Q[1],ue[2]=X[2]-Q[2],fe[0]=ue[2]*Math.sin(ne)+ue[0]*Math.cos(ne),fe[1]=ue[1],fe[2]=ue[2]*Math.cos(ne)-ue[0]*Math.sin(ne),V[0]=fe[0]+Q[0],V[1]=fe[1]+Q[1],V[2]=fe[2]+Q[2],V},Ae.rotateZ=function(V,X,Q,ne){var ue=[],fe=[];return ue[0]=X[0]-Q[0],ue[1]=X[1]-Q[1],ue[2]=X[2]-Q[2],fe[0]=ue[0]*Math.cos(ne)-ue[1]*Math.sin(ne),fe[1]=ue[0]*Math.sin(ne)+ue[1]*Math.cos(ne),fe[2]=ue[2],V[0]=fe[0]+Q[0],V[1]=fe[1]+Q[1],V[2]=fe[2]+Q[2],V},Ae.angle=function(V,X){var Q=V[0],ne=V[1],ue=V[2],fe=X[0],ie=X[1],me=X[2],ve=Math.sqrt(Q*Q+ne*ne+ue*ue)*Math.sqrt(fe*fe+ie*ie+me*me),Ce=ve&&z(V,X)/ve;return Math.acos(Math.min(Math.max(Ce,-1),1))},Ae.zero=function(V){return V[0]=0,V[1]=0,V[2]=0,V},Ae.str=function(V){return"vec3("+V[0]+", "+V[1]+", "+V[2]+")"},Ae.exactEquals=function(V,X){return V[0]===X[0]&&V[1]===X[1]&&V[2]===X[2]},Ae.equals=function(V,X){var Q=V[0],ne=V[1],ue=V[2],fe=X[0],ie=X[1],me=X[2];return Math.abs(Q-fe)<=u.EPSILON*Math.max(1,Math.abs(Q),Math.abs(fe))&&Math.abs(ne-ie)<=u.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ie))&&Math.abs(ue-me)<=u.EPSILON*Math.max(1,Math.abs(ue),Math.abs(me))},Ae.forEach=Ae.sqrLen=Ae.len=Ae.sqrDist=Ae.dist=Ae.div=Ae.mul=Ae.sub=void 0;var u=function(V,X){if(V&&V.__esModule)return V;if(V===null||v(V)!=="object"&&typeof V!="function")return{default:V};var Q=p(void 0);if(Q&&Q.has(V))return Q.get(V);var ne={},ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var fe in V)if(fe!=="default"&&Object.prototype.hasOwnProperty.call(V,fe)){var ie=ue?Object.getOwnPropertyDescriptor(V,fe):null;ie&&(ie.get||ie.set)?Object.defineProperty(ne,fe,ie):ne[fe]=V[fe]}return ne.default=V,Q&&Q.set(V,ne),ne}(x());function p(V){if(typeof WeakMap!="function")return null;var X=new WeakMap,Q=new WeakMap;return(p=function(ne){return ne?Q:X})(V)}function y(){var V=new u.ARRAY_TYPE(3);return u.ARRAY_TYPE!=Float32Array&&(V[0]=0,V[1]=0,V[2]=0),V}function T(V){return Math.hypot(V[0],V[1],V[2])}function b(V,X,Q){return V[0]=X[0]-Q[0],V[1]=X[1]-Q[1],V[2]=X[2]-Q[2],V}function M(V,X,Q){return V[0]=X[0]*Q[0],V[1]=X[1]*Q[1],V[2]=X[2]*Q[2],V}function k(V,X,Q){return V[0]=X[0]/Q[0],V[1]=X[1]/Q[1],V[2]=X[2]/Q[2],V}function G(V,X){return Math.hypot(X[0]-V[0],X[1]-V[1],X[2]-V[2])}function W(V,X){var Q=X[0]-V[0],ne=X[1]-V[1],ue=X[2]-V[2];return Q*Q+ne*ne+ue*ue}function R(V){var X=V[0],Q=V[1],ne=V[2];return X*X+Q*Q+ne*ne}function z(V,X){return V[0]*X[0]+V[1]*X[1]+V[2]*X[2]}Ae.sub=b,Ae.mul=M,Ae.div=k,Ae.dist=G,Ae.sqrDist=W,Ae.len=T,Ae.sqrLen=R;var j,U=(j=y(),function(V,X,Q,ne,ue,fe){var ie,me;for(X||(X=3),Q||(Q=0),me=ne?Math.min(ne*X+Q,V.length):V.length,ie=Q;ie<me;ie+=X)j[0]=V[ie],j[1]=V[ie+1],j[2]=V[ie+2],ue(j,j,fe),V[ie]=j[0],V[ie+1]=j[1],V[ie+2]=j[2];return V});return Ae.forEach=U,Ae}var Pe,ze,Re={};function rt(){if(Pe)return Re;function v(U){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},v(U)}Pe=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.create=y,Re.clone=function(U){var V=new u.ARRAY_TYPE(4);return V[0]=U[0],V[1]=U[1],V[2]=U[2],V[3]=U[3],V},Re.fromValues=function(U,V,X,Q){var ne=new u.ARRAY_TYPE(4);return ne[0]=U,ne[1]=V,ne[2]=X,ne[3]=Q,ne},Re.copy=function(U,V){return U[0]=V[0],U[1]=V[1],U[2]=V[2],U[3]=V[3],U},Re.set=function(U,V,X,Q,ne){return U[0]=V,U[1]=X,U[2]=Q,U[3]=ne,U},Re.add=function(U,V,X){return U[0]=V[0]+X[0],U[1]=V[1]+X[1],U[2]=V[2]+X[2],U[3]=V[3]+X[3],U},Re.subtract=T,Re.multiply=b,Re.divide=M,Re.ceil=function(U,V){return U[0]=Math.ceil(V[0]),U[1]=Math.ceil(V[1]),U[2]=Math.ceil(V[2]),U[3]=Math.ceil(V[3]),U},Re.floor=function(U,V){return U[0]=Math.floor(V[0]),U[1]=Math.floor(V[1]),U[2]=Math.floor(V[2]),U[3]=Math.floor(V[3]),U},Re.min=function(U,V,X){return U[0]=Math.min(V[0],X[0]),U[1]=Math.min(V[1],X[1]),U[2]=Math.min(V[2],X[2]),U[3]=Math.min(V[3],X[3]),U},Re.max=function(U,V,X){return U[0]=Math.max(V[0],X[0]),U[1]=Math.max(V[1],X[1]),U[2]=Math.max(V[2],X[2]),U[3]=Math.max(V[3],X[3]),U},Re.round=function(U,V){return U[0]=Math.round(V[0]),U[1]=Math.round(V[1]),U[2]=Math.round(V[2]),U[3]=Math.round(V[3]),U},Re.scale=function(U,V,X){return U[0]=V[0]*X,U[1]=V[1]*X,U[2]=V[2]*X,U[3]=V[3]*X,U},Re.scaleAndAdd=function(U,V,X,Q){return U[0]=V[0]+X[0]*Q,U[1]=V[1]+X[1]*Q,U[2]=V[2]+X[2]*Q,U[3]=V[3]+X[3]*Q,U},Re.distance=k,Re.squaredDistance=G,Re.length=W,Re.squaredLength=R,Re.negate=function(U,V){return U[0]=-V[0],U[1]=-V[1],U[2]=-V[2],U[3]=-V[3],U},Re.inverse=function(U,V){return U[0]=1/V[0],U[1]=1/V[1],U[2]=1/V[2],U[3]=1/V[3],U},Re.normalize=function(U,V){var X=V[0],Q=V[1],ne=V[2],ue=V[3],fe=X*X+Q*Q+ne*ne+ue*ue;return fe>0&&(fe=1/Math.sqrt(fe)),U[0]=X*fe,U[1]=Q*fe,U[2]=ne*fe,U[3]=ue*fe,U},Re.dot=function(U,V){return U[0]*V[0]+U[1]*V[1]+U[2]*V[2]+U[3]*V[3]},Re.cross=function(U,V,X,Q){var ne=X[0]*Q[1]-X[1]*Q[0],ue=X[0]*Q[2]-X[2]*Q[0],fe=X[0]*Q[3]-X[3]*Q[0],ie=X[1]*Q[2]-X[2]*Q[1],me=X[1]*Q[3]-X[3]*Q[1],ve=X[2]*Q[3]-X[3]*Q[2],Ce=V[0],ke=V[1],Fe=V[2],Le=V[3];return U[0]=ke*ve-Fe*me+Le*ie,U[1]=-Ce*ve+Fe*fe-Le*ue,U[2]=Ce*me-ke*fe+Le*ne,U[3]=-Ce*ie+ke*ue-Fe*ne,U},Re.lerp=function(U,V,X,Q){var ne=V[0],ue=V[1],fe=V[2],ie=V[3];return U[0]=ne+Q*(X[0]-ne),U[1]=ue+Q*(X[1]-ue),U[2]=fe+Q*(X[2]-fe),U[3]=ie+Q*(X[3]-ie),U},Re.random=function(U,V){var X,Q,ne,ue,fe,ie;V=V||1;do fe=(X=2*u.RANDOM()-1)*X+(Q=2*u.RANDOM()-1)*Q;while(fe>=1);do ie=(ne=2*u.RANDOM()-1)*ne+(ue=2*u.RANDOM()-1)*ue;while(ie>=1);var me=Math.sqrt((1-fe)/ie);return U[0]=V*X,U[1]=V*Q,U[2]=V*ne*me,U[3]=V*ue*me,U},Re.transformMat4=function(U,V,X){var Q=V[0],ne=V[1],ue=V[2],fe=V[3];return U[0]=X[0]*Q+X[4]*ne+X[8]*ue+X[12]*fe,U[1]=X[1]*Q+X[5]*ne+X[9]*ue+X[13]*fe,U[2]=X[2]*Q+X[6]*ne+X[10]*ue+X[14]*fe,U[3]=X[3]*Q+X[7]*ne+X[11]*ue+X[15]*fe,U},Re.transformQuat=function(U,V,X){var Q=V[0],ne=V[1],ue=V[2],fe=X[0],ie=X[1],me=X[2],ve=X[3],Ce=ve*Q+ie*ue-me*ne,ke=ve*ne+me*Q-fe*ue,Fe=ve*ue+fe*ne-ie*Q,Le=-fe*Q-ie*ne-me*ue;return U[0]=Ce*ve+Le*-fe+ke*-me-Fe*-ie,U[1]=ke*ve+Le*-ie+Fe*-fe-Ce*-me,U[2]=Fe*ve+Le*-me+Ce*-ie-ke*-fe,U[3]=V[3],U},Re.zero=function(U){return U[0]=0,U[1]=0,U[2]=0,U[3]=0,U},Re.str=function(U){return"vec4("+U[0]+", "+U[1]+", "+U[2]+", "+U[3]+")"},Re.exactEquals=function(U,V){return U[0]===V[0]&&U[1]===V[1]&&U[2]===V[2]&&U[3]===V[3]},Re.equals=function(U,V){var X=U[0],Q=U[1],ne=U[2],ue=U[3],fe=V[0],ie=V[1],me=V[2],ve=V[3];return Math.abs(X-fe)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(fe))&&Math.abs(Q-ie)<=u.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ie))&&Math.abs(ne-me)<=u.EPSILON*Math.max(1,Math.abs(ne),Math.abs(me))&&Math.abs(ue-ve)<=u.EPSILON*Math.max(1,Math.abs(ue),Math.abs(ve))},Re.forEach=Re.sqrLen=Re.len=Re.sqrDist=Re.dist=Re.div=Re.mul=Re.sub=void 0;var u=function(U,V){if(U&&U.__esModule)return U;if(U===null||v(U)!=="object"&&typeof U!="function")return{default:U};var X=p(void 0);if(X&&X.has(U))return X.get(U);var Q={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in U)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(U,ue)){var fe=ne?Object.getOwnPropertyDescriptor(U,ue):null;fe&&(fe.get||fe.set)?Object.defineProperty(Q,ue,fe):Q[ue]=U[ue]}return Q.default=U,X&&X.set(U,Q),Q}(x());function p(U){if(typeof WeakMap!="function")return null;var V=new WeakMap,X=new WeakMap;return(p=function(Q){return Q?X:V})(U)}function y(){var U=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(U[0]=0,U[1]=0,U[2]=0,U[3]=0),U}function T(U,V,X){return U[0]=V[0]-X[0],U[1]=V[1]-X[1],U[2]=V[2]-X[2],U[3]=V[3]-X[3],U}function b(U,V,X){return U[0]=V[0]*X[0],U[1]=V[1]*X[1],U[2]=V[2]*X[2],U[3]=V[3]*X[3],U}function M(U,V,X){return U[0]=V[0]/X[0],U[1]=V[1]/X[1],U[2]=V[2]/X[2],U[3]=V[3]/X[3],U}function k(U,V){return Math.hypot(V[0]-U[0],V[1]-U[1],V[2]-U[2],V[3]-U[3])}function G(U,V){var X=V[0]-U[0],Q=V[1]-U[1],ne=V[2]-U[2],ue=V[3]-U[3];return X*X+Q*Q+ne*ne+ue*ue}function W(U){return Math.hypot(U[0],U[1],U[2],U[3])}function R(U){var V=U[0],X=U[1],Q=U[2],ne=U[3];return V*V+X*X+Q*Q+ne*ne}Re.sub=T,Re.mul=b,Re.div=M,Re.dist=k,Re.sqrDist=G,Re.len=W,Re.sqrLen=R;var z,j=(z=y(),function(U,V,X,Q,ne,ue){var fe,ie;for(V||(V=4),X||(X=0),ie=Q?Math.min(Q*V+X,U.length):U.length,fe=X;fe<ie;fe+=V)z[0]=U[fe],z[1]=U[fe+1],z[2]=U[fe+2],z[3]=U[fe+3],ne(z,z,ue),U[fe]=z[0],U[fe+1]=z[1],U[fe+2]=z[2],U[fe+3]=z[3];return U});return Re.forEach=j,Re}function ye(){if(ze)return he;function v(Ve){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et},v(Ve)}ze=1,Object.defineProperty(he,"__esModule",{value:!0}),he.create=k,he.identity=function(Ve){return Ve[0]=0,Ve[1]=0,Ve[2]=0,Ve[3]=1,Ve},he.setAxisAngle=G,he.getAxisAngle=function(Ve,et){var ut=2*Math.acos(et[3]),dt=Math.sin(ut/2);return dt>u.EPSILON?(Ve[0]=et[0]/dt,Ve[1]=et[1]/dt,Ve[2]=et[2]/dt):(Ve[0]=1,Ve[1]=0,Ve[2]=0),ut},he.getAngle=function(Ve,et){var ut=X(Ve,et);return Math.acos(2*ut*ut-1)},he.multiply=W,he.rotateX=function(Ve,et,ut){ut*=.5;var dt=et[0],ft=et[1],_t=et[2],It=et[3],xt=Math.sin(ut),Vt=Math.cos(ut);return Ve[0]=dt*Vt+It*xt,Ve[1]=ft*Vt+_t*xt,Ve[2]=_t*Vt-ft*xt,Ve[3]=It*Vt-dt*xt,Ve},he.rotateY=function(Ve,et,ut){ut*=.5;var dt=et[0],ft=et[1],_t=et[2],It=et[3],xt=Math.sin(ut),Vt=Math.cos(ut);return Ve[0]=dt*Vt-_t*xt,Ve[1]=ft*Vt+It*xt,Ve[2]=_t*Vt+dt*xt,Ve[3]=It*Vt-ft*xt,Ve},he.rotateZ=function(Ve,et,ut){ut*=.5;var dt=et[0],ft=et[1],_t=et[2],It=et[3],xt=Math.sin(ut),Vt=Math.cos(ut);return Ve[0]=dt*Vt+ft*xt,Ve[1]=ft*Vt-dt*xt,Ve[2]=_t*Vt+It*xt,Ve[3]=It*Vt-_t*xt,Ve},he.calculateW=function(Ve,et){var ut=et[0],dt=et[1],ft=et[2];return Ve[0]=ut,Ve[1]=dt,Ve[2]=ft,Ve[3]=Math.sqrt(Math.abs(1-ut*ut-dt*dt-ft*ft)),Ve},he.exp=R,he.ln=z,he.pow=function(Ve,et,ut){return z(Ve,et),V(Ve,Ve,ut),R(Ve,Ve),Ve},he.slerp=j,he.random=function(Ve){var et=u.RANDOM(),ut=u.RANDOM(),dt=u.RANDOM(),ft=Math.sqrt(1-et),_t=Math.sqrt(et);return Ve[0]=ft*Math.sin(2*Math.PI*ut),Ve[1]=ft*Math.cos(2*Math.PI*ut),Ve[2]=_t*Math.sin(2*Math.PI*dt),Ve[3]=_t*Math.cos(2*Math.PI*dt),Ve},he.invert=function(Ve,et){var ut=et[0],dt=et[1],ft=et[2],_t=et[3],It=ut*ut+dt*dt+ft*ft+_t*_t,xt=It?1/It:0;return Ve[0]=-ut*xt,Ve[1]=-dt*xt,Ve[2]=-ft*xt,Ve[3]=_t*xt,Ve},he.conjugate=function(Ve,et){return Ve[0]=-et[0],Ve[1]=-et[1],Ve[2]=-et[2],Ve[3]=et[3],Ve},he.fromMat3=U,he.fromEuler=function(Ve,et,ut,dt){var ft=.5*Math.PI/180;et*=ft,ut*=ft,dt*=ft;var _t=Math.sin(et),It=Math.cos(et),xt=Math.sin(ut),Vt=Math.cos(ut),Kt=Math.sin(dt),kt=Math.cos(dt);return Ve[0]=_t*Vt*kt-It*xt*Kt,Ve[1]=It*xt*kt+_t*Vt*Kt,Ve[2]=It*Vt*Kt-_t*xt*kt,Ve[3]=It*Vt*kt+_t*xt*Kt,Ve},he.str=function(Ve){return"quat("+Ve[0]+", "+Ve[1]+", "+Ve[2]+", "+Ve[3]+")"},he.setAxes=he.sqlerp=he.rotationTo=he.equals=he.exactEquals=he.normalize=he.sqrLen=he.squaredLength=he.len=he.length=he.lerp=he.dot=he.scale=he.mul=he.add=he.set=he.copy=he.fromValues=he.clone=void 0;var u=M(x()),p=M(Z()),y=M(Ee()),T=M(rt());function b(Ve){if(typeof WeakMap!="function")return null;var et=new WeakMap,ut=new WeakMap;return(b=function(dt){return dt?ut:et})(Ve)}function M(Ve,et){if(Ve&&Ve.__esModule)return Ve;if(Ve===null||v(Ve)!=="object"&&typeof Ve!="function")return{default:Ve};var ut=b(et);if(ut&&ut.has(Ve))return ut.get(Ve);var dt={},ft=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _t in Ve)if(_t!=="default"&&Object.prototype.hasOwnProperty.call(Ve,_t)){var It=ft?Object.getOwnPropertyDescriptor(Ve,_t):null;It&&(It.get||It.set)?Object.defineProperty(dt,_t,It):dt[_t]=Ve[_t]}return dt.default=Ve,ut&&ut.set(Ve,dt),dt}function k(){var Ve=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(Ve[0]=0,Ve[1]=0,Ve[2]=0),Ve[3]=1,Ve}function G(Ve,et,ut){ut*=.5;var dt=Math.sin(ut);return Ve[0]=dt*et[0],Ve[1]=dt*et[1],Ve[2]=dt*et[2],Ve[3]=Math.cos(ut),Ve}function W(Ve,et,ut){var dt=et[0],ft=et[1],_t=et[2],It=et[3],xt=ut[0],Vt=ut[1],Kt=ut[2],kt=ut[3];return Ve[0]=dt*kt+It*xt+ft*Kt-_t*Vt,Ve[1]=ft*kt+It*Vt+_t*xt-dt*Kt,Ve[2]=_t*kt+It*Kt+dt*Vt-ft*xt,Ve[3]=It*kt-dt*xt-ft*Vt-_t*Kt,Ve}function R(Ve,et){var ut=et[0],dt=et[1],ft=et[2],_t=et[3],It=Math.sqrt(ut*ut+dt*dt+ft*ft),xt=Math.exp(_t),Vt=It>0?xt*Math.sin(It)/It:0;return Ve[0]=ut*Vt,Ve[1]=dt*Vt,Ve[2]=ft*Vt,Ve[3]=xt*Math.cos(It),Ve}function z(Ve,et){var ut=et[0],dt=et[1],ft=et[2],_t=et[3],It=Math.sqrt(ut*ut+dt*dt+ft*ft),xt=It>0?Math.atan2(It,_t)/It:0;return Ve[0]=ut*xt,Ve[1]=dt*xt,Ve[2]=ft*xt,Ve[3]=.5*Math.log(ut*ut+dt*dt+ft*ft+_t*_t),Ve}function j(Ve,et,ut,dt){var ft,_t,It,xt,Vt,Kt=et[0],kt=et[1],Rn=et[2],wn=et[3],pn=ut[0],rn=ut[1],rr=ut[2],Pn=ut[3];return(_t=Kt*pn+kt*rn+Rn*rr+wn*Pn)<0&&(_t=-_t,pn=-pn,rn=-rn,rr=-rr,Pn=-Pn),1-_t>u.EPSILON?(ft=Math.acos(_t),It=Math.sin(ft),xt=Math.sin((1-dt)*ft)/It,Vt=Math.sin(dt*ft)/It):(xt=1-dt,Vt=dt),Ve[0]=xt*Kt+Vt*pn,Ve[1]=xt*kt+Vt*rn,Ve[2]=xt*Rn+Vt*rr,Ve[3]=xt*wn+Vt*Pn,Ve}function U(Ve,et){var ut,dt=et[0]+et[4]+et[8];if(dt>0)ut=Math.sqrt(dt+1),Ve[3]=.5*ut,Ve[0]=(et[5]-et[7])*(ut=.5/ut),Ve[1]=(et[6]-et[2])*ut,Ve[2]=(et[1]-et[3])*ut;else{var ft=0;et[4]>et[0]&&(ft=1),et[8]>et[3*ft+ft]&&(ft=2);var _t=(ft+1)%3,It=(ft+2)%3;ut=Math.sqrt(et[3*ft+ft]-et[3*_t+_t]-et[3*It+It]+1),Ve[ft]=.5*ut,Ve[3]=(et[3*_t+It]-et[3*It+_t])*(ut=.5/ut),Ve[_t]=(et[3*_t+ft]+et[3*ft+_t])*ut,Ve[It]=(et[3*It+ft]+et[3*ft+It])*ut}return Ve}he.clone=T.clone,he.fromValues=T.fromValues,he.copy=T.copy,he.set=T.set,he.add=T.add,he.mul=W;var V=T.scale;he.scale=V;var X=T.dot;he.dot=X,he.lerp=T.lerp;var Q=T.length;he.length=Q,he.len=Q;var ne=T.squaredLength;he.squaredLength=ne,he.sqrLen=ne;var ue=T.normalize;he.normalize=ue,he.exactEquals=T.exactEquals,he.equals=T.equals;var fe,ie,me,ve=(fe=y.create(),ie=y.fromValues(1,0,0),me=y.fromValues(0,1,0),function(Ve,et,ut){var dt=y.dot(et,ut);return dt<-.999999?(y.cross(fe,ie,et),y.len(fe)<1e-6&&y.cross(fe,me,et),y.normalize(fe,fe),G(Ve,fe,Math.PI),Ve):dt>.999999?(Ve[0]=0,Ve[1]=0,Ve[2]=0,Ve[3]=1,Ve):(y.cross(fe,et,ut),Ve[0]=fe[0],Ve[1]=fe[1],Ve[2]=fe[2],Ve[3]=1+dt,ue(Ve,Ve))});he.rotationTo=ve;var Ce,ke,Fe=(Ce=k(),ke=k(),function(Ve,et,ut,dt,ft,_t){return j(Ce,et,ft,_t),j(ke,ut,dt,_t),j(Ve,Ce,ke,2*_t*(1-_t)),Ve});he.sqlerp=Fe;var Le,Ke=(Le=p.create(),function(Ve,et,ut,dt){return Le[0]=ut[0],Le[3]=ut[1],Le[6]=ut[2],Le[1]=dt[0],Le[4]=dt[1],Le[7]=dt[2],Le[2]=-et[0],Le[5]=-et[1],Le[8]=-et[2],ue(Ve,U(Ve,Le))});return he.setAxes=Ke,he}var We,Ue={};function gt(){if(We)return Ue;function v(j){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},v(j)}We=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.create=function(){var j=new u.ARRAY_TYPE(8);return u.ARRAY_TYPE!=Float32Array&&(j[0]=0,j[1]=0,j[2]=0,j[4]=0,j[5]=0,j[6]=0,j[7]=0),j[3]=1,j},Ue.clone=function(j){var U=new u.ARRAY_TYPE(8);return U[0]=j[0],U[1]=j[1],U[2]=j[2],U[3]=j[3],U[4]=j[4],U[5]=j[5],U[6]=j[6],U[7]=j[7],U},Ue.fromValues=function(j,U,V,X,Q,ne,ue,fe){var ie=new u.ARRAY_TYPE(8);return ie[0]=j,ie[1]=U,ie[2]=V,ie[3]=X,ie[4]=Q,ie[5]=ne,ie[6]=ue,ie[7]=fe,ie},Ue.fromRotationTranslationValues=function(j,U,V,X,Q,ne,ue){var fe=new u.ARRAY_TYPE(8);fe[0]=j,fe[1]=U,fe[2]=V,fe[3]=X;var ie=.5*Q,me=.5*ne,ve=.5*ue;return fe[4]=ie*X+me*V-ve*U,fe[5]=me*X+ve*j-ie*V,fe[6]=ve*X+ie*U-me*j,fe[7]=-ie*j-me*U-ve*V,fe},Ue.fromRotationTranslation=M,Ue.fromTranslation=function(j,U){return j[0]=0,j[1]=0,j[2]=0,j[3]=1,j[4]=.5*U[0],j[5]=.5*U[1],j[6]=.5*U[2],j[7]=0,j},Ue.fromRotation=function(j,U){return j[0]=U[0],j[1]=U[1],j[2]=U[2],j[3]=U[3],j[4]=0,j[5]=0,j[6]=0,j[7]=0,j},Ue.fromMat4=function(j,U){var V=p.create();y.getRotation(V,U);var X=new u.ARRAY_TYPE(3);return y.getTranslation(X,U),M(j,V,X),j},Ue.copy=k,Ue.identity=function(j){return j[0]=0,j[1]=0,j[2]=0,j[3]=1,j[4]=0,j[5]=0,j[6]=0,j[7]=0,j},Ue.set=function(j,U,V,X,Q,ne,ue,fe,ie){return j[0]=U,j[1]=V,j[2]=X,j[3]=Q,j[4]=ne,j[5]=ue,j[6]=fe,j[7]=ie,j},Ue.getDual=function(j,U){return j[0]=U[4],j[1]=U[5],j[2]=U[6],j[3]=U[7],j},Ue.setDual=function(j,U){return j[4]=U[0],j[5]=U[1],j[6]=U[2],j[7]=U[3],j},Ue.getTranslation=function(j,U){var V=U[4],X=U[5],Q=U[6],ne=U[7],ue=-U[0],fe=-U[1],ie=-U[2],me=U[3];return j[0]=2*(V*me+ne*ue+X*ie-Q*fe),j[1]=2*(X*me+ne*fe+Q*ue-V*ie),j[2]=2*(Q*me+ne*ie+V*fe-X*ue),j},Ue.translate=function(j,U,V){var X=U[0],Q=U[1],ne=U[2],ue=U[3],fe=.5*V[0],ie=.5*V[1],me=.5*V[2],ve=U[4],Ce=U[5],ke=U[6],Fe=U[7];return j[0]=X,j[1]=Q,j[2]=ne,j[3]=ue,j[4]=ue*fe+Q*me-ne*ie+ve,j[5]=ue*ie+ne*fe-X*me+Ce,j[6]=ue*me+X*ie-Q*fe+ke,j[7]=-X*fe-Q*ie-ne*me+Fe,j},Ue.rotateX=function(j,U,V){var X=-U[0],Q=-U[1],ne=-U[2],ue=U[3],fe=U[4],ie=U[5],me=U[6],ve=U[7],Ce=fe*ue+ve*X+ie*ne-me*Q,ke=ie*ue+ve*Q+me*X-fe*ne,Fe=me*ue+ve*ne+fe*Q-ie*X,Le=ve*ue-fe*X-ie*Q-me*ne;return p.rotateX(j,U,V),j[4]=Ce*(ue=j[3])+Le*(X=j[0])+ke*(ne=j[2])-Fe*(Q=j[1]),j[5]=ke*ue+Le*Q+Fe*X-Ce*ne,j[6]=Fe*ue+Le*ne+Ce*Q-ke*X,j[7]=Le*ue-Ce*X-ke*Q-Fe*ne,j},Ue.rotateY=function(j,U,V){var X=-U[0],Q=-U[1],ne=-U[2],ue=U[3],fe=U[4],ie=U[5],me=U[6],ve=U[7],Ce=fe*ue+ve*X+ie*ne-me*Q,ke=ie*ue+ve*Q+me*X-fe*ne,Fe=me*ue+ve*ne+fe*Q-ie*X,Le=ve*ue-fe*X-ie*Q-me*ne;return p.rotateY(j,U,V),j[4]=Ce*(ue=j[3])+Le*(X=j[0])+ke*(ne=j[2])-Fe*(Q=j[1]),j[5]=ke*ue+Le*Q+Fe*X-Ce*ne,j[6]=Fe*ue+Le*ne+Ce*Q-ke*X,j[7]=Le*ue-Ce*X-ke*Q-Fe*ne,j},Ue.rotateZ=function(j,U,V){var X=-U[0],Q=-U[1],ne=-U[2],ue=U[3],fe=U[4],ie=U[5],me=U[6],ve=U[7],Ce=fe*ue+ve*X+ie*ne-me*Q,ke=ie*ue+ve*Q+me*X-fe*ne,Fe=me*ue+ve*ne+fe*Q-ie*X,Le=ve*ue-fe*X-ie*Q-me*ne;return p.rotateZ(j,U,V),j[4]=Ce*(ue=j[3])+Le*(X=j[0])+ke*(ne=j[2])-Fe*(Q=j[1]),j[5]=ke*ue+Le*Q+Fe*X-Ce*ne,j[6]=Fe*ue+Le*ne+Ce*Q-ke*X,j[7]=Le*ue-Ce*X-ke*Q-Fe*ne,j},Ue.rotateByQuatAppend=function(j,U,V){var X=V[0],Q=V[1],ne=V[2],ue=V[3],fe=U[0],ie=U[1],me=U[2],ve=U[3];return j[0]=fe*ue+ve*X+ie*ne-me*Q,j[1]=ie*ue+ve*Q+me*X-fe*ne,j[2]=me*ue+ve*ne+fe*Q-ie*X,j[3]=ve*ue-fe*X-ie*Q-me*ne,j[4]=(fe=U[4])*ue+(ve=U[7])*X+(ie=U[5])*ne-(me=U[6])*Q,j[5]=ie*ue+ve*Q+me*X-fe*ne,j[6]=me*ue+ve*ne+fe*Q-ie*X,j[7]=ve*ue-fe*X-ie*Q-me*ne,j},Ue.rotateByQuatPrepend=function(j,U,V){var X=U[0],Q=U[1],ne=U[2],ue=U[3],fe=V[0],ie=V[1],me=V[2],ve=V[3];return j[0]=X*ve+ue*fe+Q*me-ne*ie,j[1]=Q*ve+ue*ie+ne*fe-X*me,j[2]=ne*ve+ue*me+X*ie-Q*fe,j[3]=ue*ve-X*fe-Q*ie-ne*me,j[4]=X*(ve=V[7])+ue*(fe=V[4])+Q*(me=V[6])-ne*(ie=V[5]),j[5]=Q*ve+ue*ie+ne*fe-X*me,j[6]=ne*ve+ue*me+X*ie-Q*fe,j[7]=ue*ve-X*fe-Q*ie-ne*me,j},Ue.rotateAroundAxis=function(j,U,V,X){if(Math.abs(X)<u.EPSILON)return k(j,U);var Q=Math.hypot(V[0],V[1],V[2]);X*=.5;var ne=Math.sin(X),ue=ne*V[0]/Q,fe=ne*V[1]/Q,ie=ne*V[2]/Q,me=Math.cos(X),ve=U[0],Ce=U[1],ke=U[2],Fe=U[3];j[0]=ve*me+Fe*ue+Ce*ie-ke*fe,j[1]=Ce*me+Fe*fe+ke*ue-ve*ie,j[2]=ke*me+Fe*ie+ve*fe-Ce*ue,j[3]=Fe*me-ve*ue-Ce*fe-ke*ie;var Le=U[4],Ke=U[5],Ve=U[6],et=U[7];return j[4]=Le*me+et*ue+Ke*ie-Ve*fe,j[5]=Ke*me+et*fe+Ve*ue-Le*ie,j[6]=Ve*me+et*ie+Le*fe-Ke*ue,j[7]=et*me-Le*ue-Ke*fe-Ve*ie,j},Ue.add=function(j,U,V){return j[0]=U[0]+V[0],j[1]=U[1]+V[1],j[2]=U[2]+V[2],j[3]=U[3]+V[3],j[4]=U[4]+V[4],j[5]=U[5]+V[5],j[6]=U[6]+V[6],j[7]=U[7]+V[7],j},Ue.multiply=G,Ue.scale=function(j,U,V){return j[0]=U[0]*V,j[1]=U[1]*V,j[2]=U[2]*V,j[3]=U[3]*V,j[4]=U[4]*V,j[5]=U[5]*V,j[6]=U[6]*V,j[7]=U[7]*V,j},Ue.lerp=function(j,U,V,X){var Q=1-X;return W(U,V)<0&&(X=-X),j[0]=U[0]*Q+V[0]*X,j[1]=U[1]*Q+V[1]*X,j[2]=U[2]*Q+V[2]*X,j[3]=U[3]*Q+V[3]*X,j[4]=U[4]*Q+V[4]*X,j[5]=U[5]*Q+V[5]*X,j[6]=U[6]*Q+V[6]*X,j[7]=U[7]*Q+V[7]*X,j},Ue.invert=function(j,U){var V=z(U);return j[0]=-U[0]/V,j[1]=-U[1]/V,j[2]=-U[2]/V,j[3]=U[3]/V,j[4]=-U[4]/V,j[5]=-U[5]/V,j[6]=-U[6]/V,j[7]=U[7]/V,j},Ue.conjugate=function(j,U){return j[0]=-U[0],j[1]=-U[1],j[2]=-U[2],j[3]=U[3],j[4]=-U[4],j[5]=-U[5],j[6]=-U[6],j[7]=U[7],j},Ue.normalize=function(j,U){var V=z(U);if(V>0){V=Math.sqrt(V);var X=U[0]/V,Q=U[1]/V,ne=U[2]/V,ue=U[3]/V,fe=U[4],ie=U[5],me=U[6],ve=U[7],Ce=X*fe+Q*ie+ne*me+ue*ve;j[0]=X,j[1]=Q,j[2]=ne,j[3]=ue,j[4]=(fe-X*Ce)/V,j[5]=(ie-Q*Ce)/V,j[6]=(me-ne*Ce)/V,j[7]=(ve-ue*Ce)/V}return j},Ue.str=function(j){return"quat2("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+", "+j[4]+", "+j[5]+", "+j[6]+", "+j[7]+")"},Ue.exactEquals=function(j,U){return j[0]===U[0]&&j[1]===U[1]&&j[2]===U[2]&&j[3]===U[3]&&j[4]===U[4]&&j[5]===U[5]&&j[6]===U[6]&&j[7]===U[7]},Ue.equals=function(j,U){var V=j[0],X=j[1],Q=j[2],ne=j[3],ue=j[4],fe=j[5],ie=j[6],me=j[7],ve=U[0],Ce=U[1],ke=U[2],Fe=U[3],Le=U[4],Ke=U[5],Ve=U[6],et=U[7];return Math.abs(V-ve)<=u.EPSILON*Math.max(1,Math.abs(V),Math.abs(ve))&&Math.abs(X-Ce)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ce))&&Math.abs(Q-ke)<=u.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ke))&&Math.abs(ne-Fe)<=u.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Fe))&&Math.abs(ue-Le)<=u.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Le))&&Math.abs(fe-Ke)<=u.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Ke))&&Math.abs(ie-Ve)<=u.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ve))&&Math.abs(me-et)<=u.EPSILON*Math.max(1,Math.abs(me),Math.abs(et))},Ue.sqrLen=Ue.squaredLength=Ue.len=Ue.length=Ue.dot=Ue.mul=Ue.setReal=Ue.getReal=void 0;var u=b(x()),p=b(ye()),y=b(se());function T(j){if(typeof WeakMap!="function")return null;var U=new WeakMap,V=new WeakMap;return(T=function(X){return X?V:U})(j)}function b(j,U){if(j&&j.__esModule)return j;if(j===null||v(j)!=="object"&&typeof j!="function")return{default:j};var V=T(U);if(V&&V.has(j))return V.get(j);var X={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in j)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(j,ne)){var ue=Q?Object.getOwnPropertyDescriptor(j,ne):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,ne,ue):X[ne]=j[ne]}return X.default=j,V&&V.set(j,X),X}function M(j,U,V){var X=.5*V[0],Q=.5*V[1],ne=.5*V[2],ue=U[0],fe=U[1],ie=U[2],me=U[3];return j[0]=ue,j[1]=fe,j[2]=ie,j[3]=me,j[4]=X*me+Q*ie-ne*fe,j[5]=Q*me+ne*ue-X*ie,j[6]=ne*me+X*fe-Q*ue,j[7]=-X*ue-Q*fe-ne*ie,j}function k(j,U){return j[0]=U[0],j[1]=U[1],j[2]=U[2],j[3]=U[3],j[4]=U[4],j[5]=U[5],j[6]=U[6],j[7]=U[7],j}function G(j,U,V){var X=U[0],Q=U[1],ne=U[2],ue=U[3],fe=V[4],ie=V[5],me=V[6],ve=V[7],Ce=U[4],ke=U[5],Fe=U[6],Le=U[7],Ke=V[0],Ve=V[1],et=V[2],ut=V[3];return j[0]=X*ut+ue*Ke+Q*et-ne*Ve,j[1]=Q*ut+ue*Ve+ne*Ke-X*et,j[2]=ne*ut+ue*et+X*Ve-Q*Ke,j[3]=ue*ut-X*Ke-Q*Ve-ne*et,j[4]=X*ve+ue*fe+Q*me-ne*ie+Ce*ut+Le*Ke+ke*et-Fe*Ve,j[5]=Q*ve+ue*ie+ne*fe-X*me+ke*ut+Le*Ve+Fe*Ke-Ce*et,j[6]=ne*ve+ue*me+X*ie-Q*fe+Fe*ut+Le*et+Ce*Ve-ke*Ke,j[7]=ue*ve-X*fe-Q*ie-ne*me+Le*ut-Ce*Ke-ke*Ve-Fe*et,j}Ue.getReal=p.copy,Ue.setReal=p.copy,Ue.mul=G;var W=p.dot;Ue.dot=W;var R=p.length;Ue.length=R,Ue.len=R;var z=p.squaredLength;return Ue.squaredLength=z,Ue.sqrLen=z,Ue}var vt,Dt,lt={};function jt(){if(vt)return lt;function v(U){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},v(U)}vt=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=y,lt.clone=function(U){var V=new u.ARRAY_TYPE(2);return V[0]=U[0],V[1]=U[1],V},lt.fromValues=function(U,V){var X=new u.ARRAY_TYPE(2);return X[0]=U,X[1]=V,X},lt.copy=function(U,V){return U[0]=V[0],U[1]=V[1],U},lt.set=function(U,V,X){return U[0]=V,U[1]=X,U},lt.add=function(U,V,X){return U[0]=V[0]+X[0],U[1]=V[1]+X[1],U},lt.subtract=T,lt.multiply=b,lt.divide=M,lt.ceil=function(U,V){return U[0]=Math.ceil(V[0]),U[1]=Math.ceil(V[1]),U},lt.floor=function(U,V){return U[0]=Math.floor(V[0]),U[1]=Math.floor(V[1]),U},lt.min=function(U,V,X){return U[0]=Math.min(V[0],X[0]),U[1]=Math.min(V[1],X[1]),U},lt.max=function(U,V,X){return U[0]=Math.max(V[0],X[0]),U[1]=Math.max(V[1],X[1]),U},lt.round=function(U,V){return U[0]=Math.round(V[0]),U[1]=Math.round(V[1]),U},lt.scale=function(U,V,X){return U[0]=V[0]*X,U[1]=V[1]*X,U},lt.scaleAndAdd=function(U,V,X,Q){return U[0]=V[0]+X[0]*Q,U[1]=V[1]+X[1]*Q,U},lt.distance=k,lt.squaredDistance=G,lt.length=W,lt.squaredLength=R,lt.negate=function(U,V){return U[0]=-V[0],U[1]=-V[1],U},lt.inverse=function(U,V){return U[0]=1/V[0],U[1]=1/V[1],U},lt.normalize=function(U,V){var X=V[0],Q=V[1],ne=X*X+Q*Q;return ne>0&&(ne=1/Math.sqrt(ne)),U[0]=V[0]*ne,U[1]=V[1]*ne,U},lt.dot=function(U,V){return U[0]*V[0]+U[1]*V[1]},lt.cross=function(U,V,X){var Q=V[0]*X[1]-V[1]*X[0];return U[0]=U[1]=0,U[2]=Q,U},lt.lerp=function(U,V,X,Q){var ne=V[0],ue=V[1];return U[0]=ne+Q*(X[0]-ne),U[1]=ue+Q*(X[1]-ue),U},lt.random=function(U,V){V=V||1;var X=2*u.RANDOM()*Math.PI;return U[0]=Math.cos(X)*V,U[1]=Math.sin(X)*V,U},lt.transformMat2=function(U,V,X){var Q=V[0],ne=V[1];return U[0]=X[0]*Q+X[2]*ne,U[1]=X[1]*Q+X[3]*ne,U},lt.transformMat2d=function(U,V,X){var Q=V[0],ne=V[1];return U[0]=X[0]*Q+X[2]*ne+X[4],U[1]=X[1]*Q+X[3]*ne+X[5],U},lt.transformMat3=function(U,V,X){var Q=V[0],ne=V[1];return U[0]=X[0]*Q+X[3]*ne+X[6],U[1]=X[1]*Q+X[4]*ne+X[7],U},lt.transformMat4=function(U,V,X){var Q=V[0],ne=V[1];return U[0]=X[0]*Q+X[4]*ne+X[12],U[1]=X[1]*Q+X[5]*ne+X[13],U},lt.rotate=function(U,V,X,Q){var ne=V[0]-X[0],ue=V[1]-X[1],fe=Math.sin(Q),ie=Math.cos(Q);return U[0]=ne*ie-ue*fe+X[0],U[1]=ne*fe+ue*ie+X[1],U},lt.angle=function(U,V){var X=U[0],Q=U[1],ne=V[0],ue=V[1],fe=Math.sqrt(X*X+Q*Q)*Math.sqrt(ne*ne+ue*ue);return Math.acos(Math.min(Math.max(fe&&(X*ne+Q*ue)/fe,-1),1))},lt.zero=function(U){return U[0]=0,U[1]=0,U},lt.str=function(U){return"vec2("+U[0]+", "+U[1]+")"},lt.exactEquals=function(U,V){return U[0]===V[0]&&U[1]===V[1]},lt.equals=function(U,V){var X=U[0],Q=U[1],ne=V[0],ue=V[1];return Math.abs(X-ne)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(ne))&&Math.abs(Q-ue)<=u.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ue))},lt.forEach=lt.sqrLen=lt.sqrDist=lt.dist=lt.div=lt.mul=lt.sub=lt.len=void 0;var u=function(U,V){if(U&&U.__esModule)return U;if(U===null||v(U)!=="object"&&typeof U!="function")return{default:U};var X=p(void 0);if(X&&X.has(U))return X.get(U);var Q={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in U)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(U,ue)){var fe=ne?Object.getOwnPropertyDescriptor(U,ue):null;fe&&(fe.get||fe.set)?Object.defineProperty(Q,ue,fe):Q[ue]=U[ue]}return Q.default=U,X&&X.set(U,Q),Q}(x());function p(U){if(typeof WeakMap!="function")return null;var V=new WeakMap,X=new WeakMap;return(p=function(Q){return Q?X:V})(U)}function y(){var U=new u.ARRAY_TYPE(2);return u.ARRAY_TYPE!=Float32Array&&(U[0]=0,U[1]=0),U}function T(U,V,X){return U[0]=V[0]-X[0],U[1]=V[1]-X[1],U}function b(U,V,X){return U[0]=V[0]*X[0],U[1]=V[1]*X[1],U}function M(U,V,X){return U[0]=V[0]/X[0],U[1]=V[1]/X[1],U}function k(U,V){return Math.hypot(V[0]-U[0],V[1]-U[1])}function G(U,V){var X=V[0]-U[0],Q=V[1]-U[1];return X*X+Q*Q}function W(U){return Math.hypot(U[0],U[1])}function R(U){var V=U[0],X=U[1];return V*V+X*X}lt.len=W,lt.sub=T,lt.mul=b,lt.div=M,lt.dist=k,lt.sqrDist=G,lt.sqrLen=R;var z,j=(z=y(),function(U,V,X,Q,ne,ue){var fe,ie;for(V||(V=2),X||(X=0),ie=Q?Math.min(Q*V+X,U.length):U.length,fe=X;fe<ie;fe+=V)z[0]=U[fe],z[1]=U[fe+1],ne(z,z,ue),U[fe]=z[0],U[fe+1]=z[1];return U});return lt.forEach=j,lt}function Qt(){if(Dt)return m;function v(U){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},v(U)}Dt=1,Object.defineProperty(m,"__esModule",{value:!0}),m.vec4=m.vec3=m.vec2=m.quat2=m.quat=m.mat4=m.mat3=m.mat2d=m.mat2=m.glMatrix=void 0;var u=j(x());m.glMatrix=u;var p=j(E());m.mat2=p;var y=j(O());m.mat2d=y;var T=j(Z());m.mat3=T;var b=j(se());m.mat4=b;var M=j(ye());m.quat=M;var k=j(gt());m.quat2=k;var G=j(jt());m.vec2=G;var W=j(Ee());m.vec3=W;var R=j(rt());function z(U){if(typeof WeakMap!="function")return null;var V=new WeakMap,X=new WeakMap;return(z=function(Q){return Q?X:V})(U)}function j(U,V){if(U&&U.__esModule)return U;if(U===null||v(U)!=="object"&&typeof U!="function")return{default:U};var X=z(V);if(X&&X.has(U))return X.get(U);var Q={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in U)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(U,ue)){var fe=ne?Object.getOwnPropertyDescriptor(U,ue):null;fe&&(fe.get||fe.set)?Object.defineProperty(Q,ue,fe):Q[ue]=U[ue]}return Q.default=U,X&&X.set(U,Q),Q}return m.vec4=R,m}var nn,Wn,kn,Mn,De=Qt(),Ye=function(){if(Wn)return nn;function v(u,p,y,T){this.cx=3*u,this.bx=3*(y-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(T-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=p,this.p2x=y,this.p2y=T}return Wn=1,nn=v,v.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,p){if(p===void 0&&(p=1e-6),u<0)return 0;if(u>1)return 1;for(var y=u,T=0;T<8;T++){var b=this.sampleCurveX(y)-u;if(Math.abs(b)<p)return y;var M=this.sampleCurveDerivativeX(y);if(Math.abs(M)<1e-6)break;y-=b/M}var k=0,G=1;for(y=u,T=0;T<20&&(b=this.sampleCurveX(y),!(Math.abs(b-u)<p));T++)u>b?k=y:G=y,y=.5*(G-k)+k;return y},solve:function(u,p){return this.sampleCurveY(this.solveCurveX(u,p))}},nn}(),gn=d(Ye);function un(){if(Mn)return kn;function v(u,p){this.x=u,this.y=p}return Mn=1,kn=v,v.prototype={clone:function(){return new v(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,p){return this.clone()._rotateAround(u,p)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var p=u.x-this.x,y=u.y-this.y;return p*p+y*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,p){return Math.atan2(this.x*p-this.y*u,this.x*u+this.y*p)},_matMult:function(u){var p=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=p,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var p=Math.cos(u),y=Math.sin(u),T=y*this.x+p*this.y;return this.x=p*this.x-y*this.y,this.y=T,this},_rotateAround:function(u,p){var y=Math.cos(u),T=Math.sin(u),b=p.y+T*(this.x-p.x)+y*(this.y-p.y);return this.x=p.x+y*(this.x-p.x)-T*(this.y-p.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},v.convert=function(u){return u instanceof v?u:Array.isArray(u)?new v(u[0],u[1]):u},kn}var At=d(un());function en(v,u){if(Array.isArray(v)){if(!Array.isArray(u)||v.length!==u.length)return!1;for(let p=0;p<v.length;p++)if(!en(v[p],u[p]))return!1;return!0}if(typeof v=="object"&&v!==null&&u!==null){if(typeof u!="object"||Object.keys(v).length!==Object.keys(u).length)return!1;for(const p in v)if(!en(v[p],u[p]))return!1;return!0}return v===u}const On=Math.PI/180,Vn=180/Math.PI;function on(v){return v*On}function ct(v){return v*Vn}const He=[[0,0],[1,0],[1,1],[0,1]];function qt(v){if(v<=0)return 0;if(v>=1)return 1;const u=v*v,p=u*v;return 4*(v<.5?p:3*(v-u)+p-.75)}function Tn(v,u,p,y){const T=new gn(v,u,p,y);return function(b){return T.solve(b)}}const An=Tn(.25,.1,.25,1);function Wt(v,u,p){return Math.min(p,Math.max(u,v))}function gr(v,u,p){return(p=Wt((p-v)/(u-v),0,1))*p*(3-2*p)}function Gn(v,u,p){const y=p-u,T=((v-u)%y+y)%y+u;return T===u?p:T}function nr(v,u,p){if(!v.length)return p(null,[]);let y=v.length;const T=new Array(v.length);let b=null;v.forEach((M,k)=>{u(M,(G,W)=>{G&&(b=G),T[k]=W,--y==0&&p(b,T)})})}function Ar(v,...u){for(const p of u)for(const y in p)v[y]=p[y];return v}let Dn=1;function sr(){return Dn++}function di(v){return v<=1?1:Math.pow(2,Math.ceil(Math.log(v)/Math.LN2))}function zr(v,u){v.forEach(p=>{u[p]&&(u[p]=u[p].bind(u))})}function ar(v,u){return v.indexOf(u,v.length-u.length)!==-1}function Ur(v,u,p){const y={};for(const T in v)y[T]=u.call(this,v[T],T,v);return y}function Wr(v,u,p){const y={};for(const T in v)u.call(this,v[T],T,v)&&(y[T]=v[T]);return y}function Si(v){return Array.isArray(v)?v.map(Si):typeof v=="object"&&v?Ur(v,Si):v}const Ne={};function Bt(v){Ne[v]||(typeof console<"u"&&console.warn(v),Ne[v]=!0)}function Jt(v,u,p){return(p.y-v.y)*(u.x-v.x)>(u.y-v.y)*(p.x-v.x)}function hn(v){let u=0;for(let p,y,T=0,b=v.length,M=b-1;T<b;M=T++)p=v[T],y=v[M],u+=(y.x-p.x)*(p.y+y.y);return u}function In([v,u,p]){const y=on(u+90),T=on(p);return{x:v*Math.cos(y)*Math.sin(T),y:v*Math.sin(y)*Math.sin(T),z:v*Math.cos(T),azimuthal:u,polar:p}}function Tr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function jr(v){const u={};if(v.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,y,T,b)=>{const M=T||b;return u[y]=!M||M.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u}let ps,Bs=null;function fi(v,u){return[v[4*u],v[4*u+1],v[4*u+2],v[4*u+3]]}function Mt(v,u,p,y){for(;u<p;){const T=u+p>>1;v[T]<y?u=T+1:p=T}return u}function we(v,u,p,y){for(;u<p;){const T=u+p>>1;v[T]<=y?u=T+1:p=T}return u}function Ie(v){return v>0?1/(1.001-v):1+v}function qe(v){return v>0?1-1/(1.001-v):-v}const it={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ps==null){const v=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ps=t.API_URL_REGEX!=null?new RegExp(t.API_URL_REGEX):v}catch{ps=v}}return ps},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!it.API_URL)return null;try{const v=new URL(it.API_URL);return v.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":v.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Qe(v){return it.API_URL_REGEX.test(v)}function mt(v){return it.API_SPRITE_REGEX.test(v)}let Rt,yt,Lt,Gt,Ot,cn;function Cn(){return Rt==null&&(Rt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Rt}const En={now:()=>Gt!==void 0?Gt:performance.now(),setNow(v){Gt=v},restoreNow(){Gt=void 0},frame(v){const u=requestAnimationFrame(v);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(v,u=0){const{width:p,height:y}=v;Ot||(Ot=document.createElement("canvas"));const T=Ot.getContext("2d",{willReadFrequently:!0});if(!T)throw new Error("failed to create canvas 2d context");return(p>Ot.width||y>Ot.height)&&(Ot.width=p,Ot.height=y),T.clearRect(-u,-u,p+2*u,y+2*u),T.drawImage(v,0,0,p,y),T.getImageData(-u,-u,p+2*u,y+2*u)},resolveURL:v=>(yt||(yt=document.createElement("a")),yt.href=v,yt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Lt==null&&(Lt=window.matchMedia("(prefers-reduced-motion: reduce)")),Lt.matches)},hasCanvasFingerprintNoise(){if(cn!==void 0)return cn;if(!Cn())return cn=!1,!1;const v=new OffscreenCanvas(85,1),u=v.getContext("2d",{willReadFrequently:!0});let p=0;for(let T=0;T<v.width;++T)u.fillStyle=`rgba(${p++},${p++},${p++}, 255)`,u.fillRect(T,0,1,1);const y=u.getImageData(0,0,v.width,v.height);p=0;for(let T=0;T<y.data.length;++T)if(T%4!=3&&p++!==y.data[T])return cn=!0,!0;return cn=!1,!1}};function je(v,u){const p=v.indexOf("?");if(p<0)return`${v}?${new URLSearchParams(u).toString()}`;const y=new URLSearchParams(v.slice(p));for(const T in u)y.set(T,u[T]);return`${v.slice(0,p)}?${y.toString()}`}function bt(v,u={persistentParams:[]}){const p=v.indexOf("?");if(p<0)return v;const y=new URLSearchParams,T=new URLSearchParams(v.slice(p));for(const M of u.persistentParams){const k=T.get(M);k&&y.set(M,k)}const b=y.toString();return`${v.slice(0,p)}${b.length>0?`?${b}`:""}`}const Ct="mapbox-tiles";let Et=500,Pt=50;const Sn=["language","worldview","jobid"];let yn,Un;function Xn(){try{return caches}catch{}}function cr(){const v=Xn();v&&yn==null&&(yn=v.open(Ct))}let vr=1/0;const pr={supported:!1,testSupport:function(v){!Xi&&zi&&(Ms?er(v):pi=v)}};let pi,zi,Xi=!1,Ms=!1;const Ir=typeof self<"u"?self:{};function er(v){const u=v.createTexture();v.bindTexture(v.TEXTURE_2D,u);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,zi),v.isContextLost())return;pr.supported=!0}catch{}v.deleteTexture(u),Xi=!0}Ir.document&&(zi=Ir.document.createElement("img"),zi.onload=function(){pi&&er(pi),pi=null,Ms=!0},zi.onerror=function(){Xi=!0,pi=null},zi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Qi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Qi);class Zr extends Error{constructor(u,p,y){p===401&&Qe(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(u),this.status=p,this.url=y}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const bs=Tr()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Yo=function(v,u){if(!(/^file:/.test(p=v.url)||/^file:/.test(bs())&&!/^\w+:/.test(p))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(y,T){const b=new AbortController,M=new Request(y.url,{method:y.method||"GET",body:y.body,credentials:y.credentials,headers:y.headers,referrer:bs(),referrerPolicy:y.referrerPolicy,signal:b.signal});let k=!1,G=!1;const W=(R=M.url).indexOf("sku=")>0&&Qe(R);var R;y.type==="json"&&M.headers.set("Accept","application/json");const z=(U,V,X)=>{if(G)return;if(U&&U.message!=="SecurityError"&&Bt(U.toString()),V&&X)return j(V);const Q=Date.now();fetch(M).then(ne=>{if(ne.ok){const ue=W?ne.clone():null;return j(ne,ue,Q)}return T(new Zr(ne.statusText,ne.status,y.url))}).catch(ne=>{ne.name!=="AbortError"&&T(new Error(`${ne.message} ${y.url}`))})},j=(U,V,X)=>{(y.type==="arrayBuffer"?U.arrayBuffer():y.type==="json"?U.json():U.text()).then(Q=>{G||(V&&X&&function(ne,ue,fe){if(cr(),yn==null)return;const ie=jr(ue.headers.get("Cache-Control")||"");if(ie["no-store"])return;const me={status:ue.status,statusText:ue.statusText,headers:new Headers};ue.headers.forEach((ke,Fe)=>me.headers.set(Fe,ke)),ie["max-age"]&&me.headers.set("Expires",new Date(fe+1e3*ie["max-age"]).toUTCString());const ve=me.headers.get("Expires");if(!ve||new Date(ve).getTime()-fe<42e4)return;let Ce=bt(ne.url,{persistentParams:Sn});if(ue.status===206){const ke=ne.headers.get("Range");if(!ke)return;me.status=200,Ce=je(Ce,{range:ke})}(function(ke,Fe){if(Un===void 0)try{new Response(new ReadableStream),Un=!0}catch{Un=!1}Un?Fe(ke.body):ke.blob().then(Fe)})(ue,ke=>{const Fe=new Response((Le=ue.status)!==200&&Le!==404&&[101,103,204,205,304].includes(Le)?null:ke,me);var Le;cr(),yn!=null&&yn.then(Ke=>Ke.put(Ce,Fe)).catch(Ke=>Bt(Ke.message))})}(M,V,X),k=!0,T(null,Q,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(Q=>{G||T(new Error(Q.message))})};return W?function(U,V){if(cr(),yn==null)return V(null);yn.then(X=>{let Q=bt(U.url,{persistentParams:Sn});const ne=U.headers.get("Range");ne&&(Q=je(Q,{range:ne})),X.match(Q).then(ue=>{const fe=function(ie){if(!ie)return!1;const me=new Date(ie.headers.get("Expires")||0),ve=jr(ie.headers.get("Cache-Control")||"");return me>Date.now()&&!ve["no-cache"]}(ue);X.delete(Q),fe&&X.put(Q,ue.clone()),V(null,ue,fe)}).catch(V)}).catch(V)}(M,z):z(null,null),{cancel:()=>{G=!0,k||b.abort()}}}(v,u);if(Tr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",v,u,void 0,!0)}var p;return function(y,T){const b=new XMLHttpRequest;b.open(y.method||"GET",y.url,!0),y.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const M in y.headers)b.setRequestHeader(M,y.headers[M]);return y.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=y.credentials==="include",b.onerror=()=>{T(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let M=b.response;if(y.type==="json")try{M=JSON.parse(b.response)}catch(k){return T(k)}T(null,M,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else T(new Zr(b.statusText,b.status,y.url))},b.send(y.body),{cancel:()=>b.abort()}}(v,u)},ks=function(v,u){return Yo(Ar(v,{type:"arrayBuffer"}),u)};function ms(v){const u=document.createElement("a");return u.href=v,u.protocol===location.protocol&&u.host===location.host}const ki="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let co,Bo;co=[],Bo=0;const Cs=function(v,u){if(pr.supported&&(v.headers||(v.headers={}),v.headers.accept="image/webp,*/*"),Bo>=it.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:v,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return co.push(b),b}Bo++;let p=!1;const y=()=>{if(!p)for(p=!0,Bo--;co.length&&Bo<it.MAX_PARALLEL_IMAGE_REQUESTS;){const b=co.shift(),{requestParameters:M,callback:k,cancelled:G}=b;G||(b.cancel=Cs(M,k).cancel)}},T=ks(v,(b,M,k,G)=>{y(),b?u(b):M&&(self.createImageBitmap?function(W,R){const z=new Blob([new Uint8Array(W)],{type:"image/png"});createImageBitmap(z).then(j=>{R(null,j)}).catch(j=>{R(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(M,(W,R)=>u(W,R,k,G)):function(W,R){const z=new Image;z.onload=()=>{R(null,z),URL.revokeObjectURL(z.src),z.onload=null,requestAnimationFrame(()=>{z.src=ki})},z.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new Blob([new Uint8Array(W)],{type:"image/png"});z.src=W.byteLength?URL.createObjectURL(j):ki}(M,(W,R)=>u(W,R,k,G)))});return{cancel:()=>{T.cancel(),y()}}};var Nc,Da,gf,zc={exports:{}},gg={exports:{}},Dp={exports:{}},vg=function(){if(gf)return zc.exports;gf=1;var v=(Nc||(Nc=1,gg.exports=function(p,y){var T,b,M,k,G,W,R,z;for(b=p.length-(T=3&p.length),M=y,G=3432918353,W=461845907,z=0;z<b;)R=255&p.charCodeAt(z)|(255&p.charCodeAt(++z))<<8|(255&p.charCodeAt(++z))<<16|(255&p.charCodeAt(++z))<<24,++z,M=27492+(65535&(k=5*(65535&(M=(M^=R=(65535&(R=(R=(65535&R)*G+(((R>>>16)*G&65535)<<16)&4294967295)<<15|R>>>17))*W+(((R>>>16)*W&65535)<<16)&4294967295)<<13|M>>>19))+((5*(M>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(R=0,T){case 3:R^=(255&p.charCodeAt(z+2))<<16;case 2:R^=(255&p.charCodeAt(z+1))<<8;case 1:M^=R=(65535&(R=(R=(65535&(R^=255&p.charCodeAt(z)))*G+(((R>>>16)*G&65535)<<16)&4294967295)<<15|R>>>17))*W+(((R>>>16)*W&65535)<<16)&4294967295}return M^=p.length,M=2246822507*(65535&(M^=M>>>16))+((2246822507*(M>>>16)&65535)<<16)&4294967295,M=3266489909*(65535&(M^=M>>>13))+((3266489909*(M>>>16)&65535)<<16)&4294967295,(M^=M>>>16)>>>0}),gg.exports),u=(Da||(Da=1,Dp.exports=function(p,y){for(var T,b=p.length,M=y^b,k=0;b>=4;)T=1540483477*(65535&(T=255&p.charCodeAt(k)|(255&p.charCodeAt(++k))<<8|(255&p.charCodeAt(++k))<<16|(255&p.charCodeAt(++k))<<24))+((1540483477*(T>>>16)&65535)<<16),M=1540483477*(65535&M)+((1540483477*(M>>>16)&65535)<<16)^(T=1540483477*(65535&(T^=T>>>24))+((1540483477*(T>>>16)&65535)<<16)),b-=4,++k;switch(b){case 3:M^=(255&p.charCodeAt(k+2))<<16;case 2:M^=(255&p.charCodeAt(k+1))<<8;case 1:M=1540483477*(65535&(M^=255&p.charCodeAt(k)))+((1540483477*(M>>>16)&65535)<<16)}return M=1540483477*(65535&(M^=M>>>13))+((1540483477*(M>>>16)&65535)<<16),(M^=M>>>15)>>>0}),Dp.exports);return zc.exports=v,zc.exports.murmur3=v,zc.exports.murmur2=u,zc.exports}(),Zo=d(vg);class tc{constructor(u,...p){Ar(this,p[0]||{}),this.type=u}}class Bp extends tc{constructor(u,p={}){super("error",Ar({error:u},p))}}function vf(v,u,p){p[v]&&p[v].indexOf(u)!==-1||(p[v]=p[v]||[],p[v].push(u))}function kp(v,u,p){if(p&&p[v]){const y=p[v].indexOf(u);y!==-1&&p[v].splice(y,1)}}class Xu{on(u,p){return this._listeners=this._listeners||{},vf(u,p,this._listeners),this}off(u,p){return kp(u,p,this._listeners),kp(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},vf(u,p,this._oneTimeListeners),this):new Promise(y=>this.once(u,y))}fire(u,p){const y=typeof u=="string"?new tc(u,p):u,T=y.type;if(this.listens(T)){y.target=this;const b=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const G of b)G.call(this,y);const M=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const G of M)kp(T,G,this._oneTimeListeners),G.call(this,y);const k=this._eventedParent;k&&(Ar(y,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(y))}else y instanceof Bp&&console.error(y.error);return this}listens(u){return!!(this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u))}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var qh,ai={},Op=function(){if(qh)return ai;qh=1;var v={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(b){return(b=Math.round(b))<0?0:b>255?255:b}function p(b){return u(b[b.length-1]==="%"?parseFloat(b)/100*255:parseInt(b))}function y(b){return(M=b[b.length-1]==="%"?parseFloat(b)/100:parseFloat(b))<0?0:M>1?1:M;var M}function T(b,M,k){return k<0?k+=1:k>1&&(k-=1),6*k<1?b+(M-b)*k*6:2*k<1?M:3*k<2?b+(M-b)*(2/3-k)*6:b}try{ai.parseCSSColor=function(b){var M,k=b.replace(/ /g,"").toLowerCase();if(k in v)return v[k].slice();if(k[0]==="#")return k.length===4?(M=parseInt(k.substr(1),16))>=0&&M<=4095?[(3840&M)>>4|(3840&M)>>8,240&M|(240&M)>>4,15&M|(15&M)<<4,1]:null:k.length===7&&(M=parseInt(k.substr(1),16))>=0&&M<=16777215?[(16711680&M)>>16,(65280&M)>>8,255&M,1]:null;var G=k.indexOf("("),W=k.indexOf(")");if(G!==-1&&W+1===k.length){var R=k.substr(0,G),z=k.substr(G+1,W-(G+1)).split(","),j=1;switch(R){case"rgba":if(z.length!==4)return null;j=y(z.pop());case"rgb":return z.length!==3?null:[p(z[0]),p(z[1]),p(z[2]),j];case"hsla":if(z.length!==4)return null;j=y(z.pop());case"hsl":if(z.length!==3)return null;var U=(parseFloat(z[0])%360+360)%360/360,V=y(z[1]),X=y(z[2]),Q=X<=.5?X*(V+1):X+V-X*V,ne=2*X-Q;return[u(255*T(ne,Q,U+1/3)),u(255*T(ne,Q,U)),u(255*T(ne,Q,U-1/3)),j];default:return null}}return null}}catch{}return ai}();class _r{constructor(u,p,y,T=1){this.r=u,this.g=p,this.b=y,this.a=T}static parse(u){if(!u)return;if(u instanceof _r)return u;if(typeof u!="string")return;const p=Op.parseCSSColor(u);return p?new _r(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3]):void 0}toString(){const[u,p,y,T]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(u)},${Math.round(p)},${Math.round(y)},${T})`}toRenderColor(u){const{r:p,g:y,b:T,a:b}=this;return new Gx(u,p,y,T,b)}}class Gx{constructor(u,p,y,T,b){if(u){const M=u.image.height,k=M*M;p=b===0?0:p/b*(M-1),y=b===0?0:y/b*(M-1),T=b===0?0:T/b*(M-1);const G=Math.floor(p),W=Math.floor(y),R=Math.floor(T),z=Math.ceil(p),j=Math.ceil(y),U=Math.ceil(T),V=p-G,X=y-W,Q=T-R,ne=u.image.data,ue=4*(G+W*k+R*M),fe=4*(G+W*k+U*M),ie=4*(G+j*k+R*M),me=4*(G+j*k+U*M),ve=4*(z+W*k+R*M),Ce=4*(z+W*k+U*M),ke=4*(z+j*k+R*M),Fe=4*(z+j*k+U*M);if(ue<0||Fe>=ne.length)throw new Error("out of range");this.r=ur(ur(ur(ne[ue],ne[fe],Q),ur(ne[ie],ne[me],Q),X),ur(ur(ne[ve],ne[Ce],Q),ur(ne[ke],ne[Fe],Q),X),V)/255*b,this.g=ur(ur(ur(ne[ue+1],ne[fe+1],Q),ur(ne[ie+1],ne[me+1],Q),X),ur(ur(ne[ve+1],ne[Ce+1],Q),ur(ne[ke+1],ne[Fe+1],Q),X),V)/255*b,this.b=ur(ur(ur(ne[ue+2],ne[fe+2],Q),ur(ne[ie+2],ne[me+2],Q),X),ur(ur(ne[ve+2],ne[Ce+2],Q),ur(ne[ke+2],ne[Fe+2],Q),X),V)/255*b,this.a=b}else this.r=p,this.g=y,this.b=T,this.a=b}toArray(){const{r:u,g:p,b:y,a:T}=this;return T===0?[0,0,0,0]:[255*u/T,255*p/T,255*y/T,T]}toArray01(){const{r:u,g:p,b:y,a:T}=this;return T===0?[0,0,0,0]:[u/T,p/T,y/T,T]}toArray01Scaled(u){const{r:p,g:y,b:T,a:b}=this;return b===0?[0,0,0]:[p/b*u,y/b*u,T/b*u]}toArray01PremultipliedAlpha(){const{r:u,g:p,b:y,a:T}=this;return[u,p,y,T]}toArray01Linear(){const{r:u,g:p,b:y,a:T}=this;return T===0?[0,0,0,0]:[Math.pow(u/T,2.2),Math.pow(p/T,2.2),Math.pow(y/T,2.2),T]}}function ur(v,u,p){return v*(1-p)+u*p}function _f(v,u,p){return v.map((y,T)=>ur(y,u[T],p))}_r.black=new _r(0,0,0,1),_r.white=new _r(1,1,1,1),_r.transparent=new _r(0,0,0,0),_r.red=new _r(1,0,0,1),_r.blue=new _r(0,0,1,1);var Yh=Object.freeze({__proto__:null,array:_f,color:function(v,u,p){return new _r(ur(v.r,u.r,p),ur(v.g,u.g,p),ur(v.b,u.b,p),ur(v.a,u.a,p))},number:ur});function yf(v,...u){for(const p of u)for(const y in p)v[y]=p[y];return v}class Ss extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class xf{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[y,T]of p)this.bindings[y]=T}concat(u){return new xf(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const nc={kind:"null"},Fn={kind:"number"},ni={kind:"string"},Kr={kind:"boolean"},Hs={kind:"color"},ya={kind:"object"},ii={kind:"value"},ul={kind:"collator"},Za={kind:"formatted"},yu={kind:"resolvedImage"};function la(v,u){return{kind:"array",itemType:v,N:u}}function Es(v){if(v.kind==="array"){const u=Es(v.itemType);return typeof v.N=="number"?`array<${u}, ${v.N}>`:v.itemType.kind==="value"?"array":`array<${u}>`}return v.kind}const Vx=[nc,Fn,ni,Kr,Hs,Za,ya,la(ii),yu];function Ba(v,u){if(u.kind==="error")return null;if(v.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Ba(v.itemType,u.itemType))&&(typeof v.N!="number"||v.N===u.N))return null}else{if(v.kind===u.kind)return null;if(v.kind==="value"){for(const p of Vx)if(!Ba(p,u))return null}}return`Expected ${Es(v)} but found ${Es(u)} instead.`}function bf(v,u){return u.some(p=>p.kind===v.kind)}function hl(v,u){return u.some(p=>p==="null"?v===null:p==="array"?Array.isArray(v):p==="object"?v&&!Array.isArray(v)&&typeof v=="object":p===typeof v)}class _g{constructor(u,p,y){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class js{constructor(u,p,y,T,b){this.text=u.normalize?u.normalize():u,this.image=p,this.scale=y,this.fontStack=T,this.textColor=b}}class ko{constructor(u){this.sections=u}static fromString(u){return new ko([new js(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.namePrimary.length!==0)}static factory(u){return u instanceof ko?u:ko.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}serialize(){const u=["format"];for(const p of this.sections){if(p.image){u.push(["image",p.image.namePrimary]);continue}u.push(p.text);const y={};p.fontStack&&(y["text-font"]=["literal",p.fontStack.split(",")]),p.scale&&(y["font-scale"]=p.scale),p.textColor&&(y["text-color"]=["rgba"].concat(p.textColor.toRenderColor(null).toArray())),u.push(y)}return u}}class Ko{constructor(u){this.namePrimary=u.namePrimary,u.nameSecondary&&(this.nameSecondary=u.nameSecondary),this.available=u.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(u,p){return u?new Ko({namePrimary:u,nameSecondary:p,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Zh(v,u,p,y){return typeof v=="number"&&v>=0&&v<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?y===void 0||typeof y=="number"&&y>=0&&y<=1?null:`Invalid rgba value [${[v,u,p,y].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof y=="number"?[v,u,p,y]:[v,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Uc(v){if(v===null||typeof v=="string"||typeof v=="boolean"||typeof v=="number"||v instanceof _r||v instanceof _g||v instanceof ko||v instanceof Ko)return!0;if(Array.isArray(v)){for(const u of v)if(!Uc(u))return!1;return!0}if(typeof v=="object"){for(const u in v)if(!Uc(v[u]))return!1;return!0}return!1}function Os(v){if(v===null)return nc;if(typeof v=="string")return ni;if(typeof v=="boolean")return Kr;if(typeof v=="number")return Fn;if(v instanceof _r)return Hs;if(v instanceof _g)return ul;if(v instanceof ko)return Za;if(v instanceof Ko)return yu;if(Array.isArray(v)){const u=v.length;let p;for(const y of v){const T=Os(y);if(p){if(p===T)continue;p=ii;break}p=T}return la(p||ii,u)}return ya}function xa(v){const u=typeof v;return v===null?"":u==="string"||u==="number"||u==="boolean"?String(v):v instanceof _r||v instanceof ko||v instanceof Ko?v.toString():JSON.stringify(v)}class dl{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Uc(u[1]))return p.error("invalid value");const y=u[1];let T=Os(y);const b=p.expectedType;return T.kind!=="array"||T.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(T=b),new dl(T,y)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ko?this.value.serialize():this.value}}class Ks{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const qu={string:ni,number:Fn,boolean:Kr,object:ya};class Js{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let y,T=1;const b=u[0];if(b==="array"){let k,G;if(u.length>2){const W=u[1];if(typeof W!="string"||!(W in qu)||W==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);k=qu[W],T++}else k=ii;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);G=u[2],T++}y=la(k,G)}else y=qu[b];const M=[];for(;T<u.length;T++){const k=p.parse(u[T],T,ii);if(!k)return null;M.push(k)}return new Js(y,M)}evaluate(u){for(let p=0;p<this.args.length;p++){const y=this.args[p].evaluate(u);if(!Ba(this.type,Os(y)))return y;if(p===this.args.length-1)throw new Ks(`The expression ${JSON.stringify(this.args[p].serialize())} evaluated to ${Es(Os(y))} but was expected to be of type ${Es(this.type)}.`)}return null}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}serialize(){const u=this.type,p=[u.kind];if(u.kind==="array"){const y=u.itemType;if(y.kind==="string"||y.kind==="number"||y.kind==="boolean"){p.push(y.kind);const T=u.N;(typeof T=="number"||this.args.length>1)&&p.push(T)}}return p.concat(this.args.map(y=>y.serialize()))}}class ka{constructor(u){this.type=Za,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const y=u[1];if(!Array.isArray(y)&&typeof y=="object")return p.error("First argument must be an image or text section.");const T=[];let b=!1;for(let M=1;M<=u.length-1;++M){const k=u[M];if(b&&typeof k=="object"&&!Array.isArray(k)){b=!1;let G=null;if(k["font-scale"]&&(G=p.parseObjectValue(k["font-scale"],M,"font-scale",Fn),!G))return null;let W=null;if(k["text-font"]&&(W=p.parseObjectValue(k["text-font"],M,"text-font",la(ni)),!W))return null;let R=null;if(k["text-color"]&&(R=p.parseObjectValue(k["text-color"],M,"text-color",Hs),!R))return null;const z=T[T.length-1];z.scale=G,z.font=W,z.textColor=R}else{const G=p.parse(u[M],M,ii);if(!G)return null;const W=G.type.kind;if(W!=="string"&&W!=="value"&&W!=="null"&&W!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,T.push({content:G,scale:null,font:null,textColor:null})}}return new ka(T)}evaluate(u){return new ko(this.sections.map(p=>{const y=p.content.evaluate(u);return Os(y)===yu?new js("",y,null,null,null):new js(xa(y),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}serialize(){const u=["format"];for(const p of this.sections){u.push(p.content.serialize());const y={};p.scale&&(y["font-scale"]=p.scale.serialize()),p.font&&(y["text-font"]=p.font.serialize()),p.textColor&&(y["text-color"]=p.textColor.serialize()),u.push(y)}return u}}class Ka{constructor(u,p){this.type=yu,this.inputPrimary=u,this.inputSecondary=p}static parse(u,p){if(u.length<2)return p.error("Expected two or more arguments.");const y=p.parse(u[1],1,ni);if(!y)return p.error("No image name provided.");if(u.length===2)return new Ka(y);const T=p.parse(u[2],1,ni);return T?new Ka(y,T):p.error("Secondary image variant is not a string.")}evaluate(u){const p=Ko.fromString(this.inputPrimary.evaluate(u),this.inputSecondary?this.inputSecondary.evaluate(u):void 0);return p&&u.availableImages&&(p.available=u.availableImages.indexOf(p.namePrimary)>-1,p.nameSecondary&&p.available&&u.availableImages&&(p.available=u.availableImages.indexOf(p.nameSecondary)>-1)),p}eachChild(u){u(this.inputPrimary),this.inputSecondary&&u(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function xu(v){return v instanceof Number?"number":v instanceof String?"string":v instanceof Boolean?"boolean":Array.isArray(v)?"array":v===null?"null":typeof v}const Fp={"to-boolean":Kr,"to-color":Hs,"to-number":Fn,"to-string":ni};class ca{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const y=u[0],T=[];let b=nc;if(y==="to-array"){if(!Array.isArray(u[1]))return null;const M=u[1].length;if(p.expectedType){if(p.expectedType.kind!=="array")return p.error(`Expected ${p.expectedType.kind} but found array.`);b=la(p.expectedType.itemType,M)}else{if(!(M>0&&Uc(u[1][0])))return null;b=la(Os(u[1][0]),M)}for(let k=0;k<M;k++){const G=u[1][k];let W;if(xu(G)==="array")W=p.parse(G,void 0,b.itemType);else{const R=xu(G);if(R!==b.itemType.kind)return p.error(`Expected ${b.itemType.kind} but found ${R}.`);W=p.registry.literal.parse(["literal",G===void 0?null:G],p)}if(!W)return null;T.push(W)}}else{if((y==="to-boolean"||y==="to-string")&&u.length!==2)return p.error("Expected one argument.");b=Fp[y];for(let M=1;M<u.length;M++){const k=p.parse(u[M],M,ii);if(!k)return null;T.push(k)}}return new ca(b,T)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let p,y;for(const T of this.args){if(p=T.evaluate(u),y=null,p instanceof _r)return p;if(typeof p=="string"){const b=u.parseColor(p);if(b)return b}else if(Array.isArray(p)&&(y=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Zh(p[0],p[1],p[2],p[3]),!y))return new _r(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Ks(y||`Could not parse color from value '${typeof p=="string"?p:String(JSON.stringify(p))}'`)}if(this.type.kind==="number"){let p=null;for(const y of this.args){if(p=y.evaluate(u),p===null)return 0;const T=Number(p);if(!isNaN(T))return T}throw new Ks(`Could not convert ${JSON.stringify(p)} to number.`)}return this.type.kind==="formatted"?ko.fromString(xa(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?Ko.fromString(xa(this.args[0].evaluate(u))):this.type.kind==="array"?this.args.map(p=>p.evaluate(u)):xa(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ka([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ka(this.args[0]).serialize();const u=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(p=>{u.push(p.serialize())}),u}}const Yu=["Unknown","Point","LineString","Polygon"];class Np{constructor(u,p){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=u,this.options=p}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(u){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const u=this.featureDistanceData.center,p=this.featureDistanceData.scale,{x:y,y:T}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(y*p-u[0])+this.featureDistanceData.bearing[1]*(T*p-u[1])}return 0}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=_r.parse(u)),p}getConfig(u){return this.options?this.options.get(u):null}}class Oa{constructor(u,p,y,T,b){this.name=u,this.type=p,this._evaluate=y,this.args=T,this._overloadIndex=b}evaluate(u){if(!this._evaluate){const p=Oa.definitions[this.name];this._evaluate=Array.isArray(p)?p[2]:p.overloads[this._overloadIndex][1]}return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(u=>u.serialize()))}static parse(u,p){const y=u[0],T=Oa.definitions[y];if(!T)return p.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(T)?T[0]:T.type,M=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,k=[];let G=null,W=-1;for(const[R,z]of M){if(Array.isArray(R)&&R.length!==u.length-1)continue;k.push(R),W++,G=new K0(p.registry,p.path,null,p.scope,void 0,p._scope,p.options);const j=[];let U=!1;for(let V=1;V<u.length;V++){const X=u[V],Q=Array.isArray(R)?R[V-1]:R.type,ne=G.parse(X,1+j.length,Q);if(!ne){U=!0;break}j.push(ne)}if(!U)if(Array.isArray(R)&&R.length!==j.length)G.error(`Expected ${R.length} arguments, but found ${j.length} instead.`);else{for(let V=0;V<j.length;V++){const X=Array.isArray(R)?R[V]:R.type,Q=j[V];G.concat(V+1).checkSubtype(X,Q.type)}if(G.errors.length===0)return new Oa(y,b,z,j,W)}}if(k.length===1)p.errors.push(...G.errors);else{const R=(k.length?k:M.map(([j])=>j)).map(yg).join(" | "),z=[];for(let j=1;j<u.length;j++){const U=p.parse(u[j],1+z.length);if(!U)return null;z.push(Es(U.type))}p.error(`Expected arguments of type ${R}, but found (${z.join(", ")}) instead.`)}return null}static register(u,p){Oa.definitions=p;for(const y in p)u[y]=Oa}}function yg(v){return Array.isArray(v)?`(${v.map(Es).join(", ")})`:`(${Es(v.type)}...)`}class zp{constructor(u,p,y){this.type=ul,this.locale=y,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const y=u[1];if(typeof y!="object"||Array.isArray(y))return p.error("Collator options argument must be an object.");const T=y["case-sensitive"]===void 0?p.parse(!1,1,Kr):p.parseObjectValue(y["case-sensitive"],1,"case-sensitive",Kr);if(!T)return null;const b=y["diacritic-sensitive"]===void 0?p.parse(!1,1,Kr):p.parseObjectValue(y["diacritic-sensitive"],1,"diacritic-sensitive",Kr);if(!b)return null;let M=null;return y.locale&&(M=p.parseObjectValue(y.locale,1,"locale",ni),!M)?null:new zp(T,b,M)}evaluate(u){return new _g(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}serialize(){const u={};return u["case-sensitive"]=this.caseSensitive.serialize(),u["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(u.locale=this.locale.serialize()),["collator",u]}}function Y0(v,u,p=0,y=v.length-1,T=bu){for(;y>p;){if(y-p>600){const G=y-p+1,W=u-p+1,R=Math.log(G),z=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*z*(G-z)/G)*(W-G/2<0?-1:1);Y0(v,u,Math.max(p,Math.floor(u-W*z/G+j)),Math.min(y,Math.floor(u+(G-W)*z/G+j)),T)}const b=v[u];let M=p,k=y;for(Zu(v,p,u),T(v[y],b)>0&&Zu(v,p,y);M<k;){for(Zu(v,M,k),M++,k--;T(v[M],b)<0;)M++;for(;T(v[k],b)>0;)k--}T(v[p],b)===0?Zu(v,p,k):(k++,Zu(v,k,y)),k<=u&&(p=k+1),u<=k&&(y=k-1)}}function Zu(v,u,p){const y=v[u];v[u]=v[p],v[p]=y}function bu(v,u){return v<u?-1:v>u?1:0}function Hx(v){let u=0;for(let p,y,T=0,b=v.length,M=b-1;T<b;M=T++)p=v[T],y=v[M],u+=(y.x-p.x)*(p.y+y.y);return u}function wf(v,u){v[0]=Math.min(v[0],u[0]),v[1]=Math.min(v[1],u[1]),v[2]=Math.max(v[2],u[0]),v[3]=Math.max(v[3],u[1])}function Ku(v,u){return!(v[0]<=u[0]||v[2]>=u[2]||v[1]<=u[1]||v[3]>=u[3])}function Z0(v,u,p){const y=v[0]-u[0],T=v[1]-u[1],b=v[0]-p[0],M=v[1]-p[1];return y*M-b*T==0&&y*b<=0&&T*M<=0}function rc(v,u,p=!1){let y=!1;for(let k=0,G=u.length;k<G;k++){const W=u[k];for(let R=0,z=W.length,j=z-1;R<z;j=R++){const U=W[j],V=W[R];if(Z0(v,U,V))return p;(b=U)[1]>(T=v)[1]!=(M=V)[1]>T[1]&&T[0]<(M[0]-b[0])*(T[1]-b[1])/(M[1]-b[1])+b[0]&&(y=!y)}}var T,b,M;return y}function Kh(v,u,p,y){const T=y[0]-p[0],b=y[1]-p[1],M=(v[0]-p[0])*b-T*(v[1]-p[1]),k=(u[0]-p[0])*b-T*(u[1]-p[1]);return M>0&&k<0||M<0&&k>0}function Jh(v,u,p,y){return(T=[y[0]-p[0],y[1]-p[1]])[0]*(b=[u[0]-v[0],u[1]-v[1]])[1]-T[1]*b[0]!=0&&!(!Kh(v,u,p,y)||!Kh(p,y,v,u));var T,b}const ba=8192;function Cr(v,u){const p=(180+v[0])/360,y=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+v[1]*Math.PI/360)))/360,T=Math.pow(2,u.z);return[Math.round(p*T*ba),Math.round(y*T*ba)]}function qn(v,u){for(let p=0;p<u.length;p++)if(rc(v,u[p]))return!0;return!1}function wu(v,u,p){for(const y of p)for(let T=0,b=y.length,M=b-1;T<b;M=T++)if(Jh(v,u,y[M],y[T]))return!0;return!1}function mr(v,u){for(let p=0;p<v.length;++p)if(!rc(v[p],u))return!1;for(let p=0;p<v.length-1;++p)if(wu(v[p],v[p+1],u))return!1;return!0}function ic(v,u){for(let p=0;p<u.length;p++)if(mr(v,u[p]))return!0;return!1}function sc(v,u,p){const y=[];for(let T=0;T<v.length;T++){const b=[];for(let M=0;M<v[T].length;M++){const k=Cr(v[T][M],p);wf(u,k),b.push(k)}y.push(b)}return y}function yr(v,u,p){const y=[];for(let T=0;T<v.length;T++){const b=sc(v[T],u,p);y.push(b)}return y}function Up(v,u,p,y){if(v[0]<p[0]||v[0]>p[2]){const T=.5*y;let b=v[0]-p[0]>T?-y:p[0]-v[0]>T?y:0;b===0&&(b=v[0]-p[2]>T?-y:p[2]-v[0]>T?y:0),v[0]+=b}wf(u,v)}function Sf(v,u,p,y){const T=Math.pow(2,y.z)*ba,b=[y.x*ba,y.y*ba],M=[];if(!v)return M;for(const k of v)for(const G of k){const W=[G.x+b[0],G.y+b[1]];Up(W,u,p,T),M.push(W)}return M}function Fa(v,u,p,y){const T=Math.pow(2,y.z)*ba,b=[y.x*ba,y.y*ba],M=[];if(!v)return M;for(const G of v){const W=[];for(const R of G){const z=[R.x+b[0],R.y+b[1]];wf(u,z),W.push(z)}M.push(W)}if(u[2]-u[0]<=T/2){(k=u)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const G of M)for(const W of G)Up(W,u,p,T)}var k;return M}class So{constructor(u,p){this.type=Kr,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Uc(u[1])){const y=u[1];if(y.type==="FeatureCollection")for(let T=0;T<y.features.length;++T){const b=y.features[T].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new So(y,y.features[T].geometry)}else if(y.type==="Feature"){const T=y.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new So(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new So(y,y)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,y){const T=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],M=p.canonicalID();if(!M)return!1;if(y.type==="Polygon"){const k=sc(y.coordinates,b,M),G=Sf(p.geometry(),T,b,M);if(!Ku(T,b))return!1;for(const W of G)if(!rc(W,k))return!1}if(y.type==="MultiPolygon"){const k=yr(y.coordinates,b,M),G=Sf(p.geometry(),T,b,M);if(!Ku(T,b))return!1;for(const W of G)if(!qn(W,k))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,y){const T=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],M=p.canonicalID();if(!M)return!1;if(y.type==="Polygon"){const k=sc(y.coordinates,b,M),G=Fa(p.geometry(),T,b,M);if(!Ku(T,b))return!1;for(const W of G)if(!mr(W,k))return!1}if(y.type==="MultiPolygon"){const k=yr(y.coordinates,b,M),G=Fa(p.geometry(),T,b,M);if(!Ku(T,b))return!1;for(const W of G)if(!ic(W,k))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const ss={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},uo=1/298.257223563,Ja=uo*(2-uo),Qh=Math.PI/180;class ed{static fromTile(u,p,y){const T=Math.PI*(1-2*(u+.5)/Math.pow(2,p)),b=Math.atan(.5*(Math.exp(T)-Math.exp(-T)))/Qh;return new ed(b,y)}static get units(){return ss}constructor(u,p){if(u===void 0)throw new Error("No latitude given.");if(p&&!ss[p])throw new Error(`Unknown unit ${p}. Use one of: ${Object.keys(ss).join(", ")}`);const y=6378.137*Qh*(p?ss[p]:1),T=Math.cos(u*Qh),b=1/(1-Ja*(1-T*T)),M=Math.sqrt(b);this.kx=y*M*T,this.ky=y*M*b*(1-Ja)}distance(u,p){const y=ws(u[0]-p[0])*this.kx,T=(u[1]-p[1])*this.ky;return Math.sqrt(y*y+T*T)}bearing(u,p){const y=ws(p[0]-u[0])*this.kx;return Math.atan2(y,(p[1]-u[1])*this.ky)/Qh}destination(u,p,y){const T=y*Qh;return this.offset(u,Math.sin(T)*p,Math.cos(T)*p)}offset(u,p,y){return[u[0]+p/this.kx,u[1]+y/this.ky]}lineDistance(u){let p=0;for(let y=0;y<u.length-1;y++)p+=this.distance(u[y],u[y+1]);return p}area(u){let p=0;for(let y=0;y<u.length;y++){const T=u[y];for(let b=0,M=T.length,k=M-1;b<M;k=b++)p+=ws(T[b][0]-T[k][0])*(T[b][1]+T[k][1])*(y?-1:1)}return Math.abs(p)/2*this.kx*this.ky}along(u,p){let y=0;if(p<=0)return u[0];for(let T=0;T<u.length-1;T++){const b=u[T],M=u[T+1],k=this.distance(b,M);if(y+=k,y>p)return oc(b,M,(p-(y-k))/k)}return u[u.length-1]}pointToSegmentDistance(u,p,y){let[T,b]=p,M=ws(y[0]-T)*this.kx,k=(y[1]-b)*this.ky;if(M!==0||k!==0){const G=(ws(u[0]-T)*this.kx*M+(u[1]-b)*this.ky*k)/(M*M+k*k);G>1?(T=y[0],b=y[1]):G>0&&(T+=M/this.kx*G,b+=k/this.ky*G)}return M=ws(u[0]-T)*this.kx,k=(u[1]-b)*this.ky,Math.sqrt(M*M+k*k)}pointOnLine(u,p){let y=1/0,T=u[0][0],b=u[0][1],M=0,k=0;for(let G=0;G<u.length-1;G++){let W=u[G][0],R=u[G][1],z=ws(u[G+1][0]-W)*this.kx,j=(u[G+1][1]-R)*this.ky,U=0;z===0&&j===0||(U=(ws(p[0]-W)*this.kx*z+(p[1]-R)*this.ky*j)/(z*z+j*j),U>1?(W=u[G+1][0],R=u[G+1][1]):U>0&&(W+=z/this.kx*U,R+=j/this.ky*U)),z=ws(p[0]-W)*this.kx,j=(p[1]-R)*this.ky;const V=z*z+j*j;V<y&&(y=V,T=W,b=R,M=G,k=U)}return{point:[T,b],index:M,t:Math.max(0,Math.min(1,k))}}lineSlice(u,p,y){let T=this.pointOnLine(y,u),b=this.pointOnLine(y,p);if(T.index>b.index||T.index===b.index&&T.t>b.t){const W=T;T=b,b=W}const M=[T.point],k=T.index+1,G=b.index;!Af(y[k],M[0])&&k<=G&&M.push(y[k]);for(let W=k+1;W<=G;W++)M.push(y[W]);return Af(y[G],b.point)||M.push(b.point),M}lineSliceAlong(u,p,y){let T=0;const b=[];for(let M=0;M<y.length-1;M++){const k=y[M],G=y[M+1],W=this.distance(k,G);if(T+=W,T>u&&b.length===0&&b.push(oc(k,G,(u-(T-W))/W)),T>=p)return b.push(oc(k,G,(p-(T-W))/W)),b;T>u&&b.push(G)}return b}bufferPoint(u,p){const y=p/this.ky,T=p/this.kx;return[u[0]-T,u[1]-y,u[0]+T,u[1]+y]}bufferBBox(u,p){const y=p/this.ky,T=p/this.kx;return[u[0]-T,u[1]-y,u[2]+T,u[3]+y]}insideBBox(u,p){return ws(u[0]-p[0])>=0&&ws(u[0]-p[2])<=0&&u[1]>=p[1]&&u[1]<=p[3]}}function Af(v,u){return v[0]===u[0]&&v[1]===u[1]}function oc(v,u,p){const y=ws(u[0]-v[0]);return[v[0]+y*p,v[1]+(u[1]-v[1])*p]}function ws(v){for(;v<-180;)v+=360;for(;v>180;)v-=360;return v}class td{constructor(u=[],p=(y,T)=>y<T?-1:y>T?1:0){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let y=(this.length>>1)-1;y>=0;y--)this._down(y)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return--this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:y}=this,T=p[u];for(;u>0;){const b=u-1>>1,M=p[b];if(y(T,M)>=0)break;p[u]=M,u=b}p[u]=T}_down(u){const{data:p,compare:y}=this,T=this.length>>1,b=p[u];for(;u<T;){let M=1+(u<<1);const k=M+1;if(k<this.length&&y(p[k],p[M])<0&&(M=k),y(p[M],b)>=0)break;p[u]=p[M],u=M}p[u]=b}}var xn=8192;function xg(v,u){return u.dist-v.dist}const Gc=100,nd=50;function Gp(v){const u=[1/0,1/0,-1/0,-1/0];if(u.length!==v.length)return!1;for(let p=0;p<u.length;p++)if(u[p]!==v[p])return!1;return!0}function Vp(v){return v[1]-v[0]+1}function Qa(v,u){const p=v[1]>=v[0]&&v[1]<u;return p||console.warn("Distance Expression: Index is out of range"),p}function bg(v,u){if(v[0]>v[1])return[null,null];const p=Vp(v);if(u){if(p===2)return[v,null];const y=Math.floor(p/2);return[[v[0],v[0]+y],[v[0]+y,v[1]]]}{if(p===1)return[v,null];const y=Math.floor(p/2)-1;return[[v[0],v[0]+y],[v[0]+y+1,v[1]]]}}function ua(v,u){const p=[1/0,1/0,-1/0,-1/0];if(!Qa(u,v.length))return p;for(let y=u[0];y<=u[1];++y)wf(p,v[y]);return p}function Na(v){const u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<v.length;++p)for(let y=0;y<v[p].length;++y)wf(u,v[p][y]);return u}function Vc(v,u,p){if(Gp(v)||Gp(u))return NaN;let y=0,T=0;return v[2]<u[0]&&(y=u[0]-v[2]),v[0]>u[2]&&(y=v[0]-u[2]),v[1]>u[3]&&(T=v[1]-u[3]),v[3]<u[1]&&(T=u[1]-v[3]),p.distance([0,0],[y,T])}function rd(v){return 360*v-180}function ac(v){return 360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90}function za(v,u){const p=Math.pow(2,u.z),y=(v.y/xn+u.y)/p;return[rd((v.x/xn+u.x)/p),ac(y)]}function id(v,u){const p=[];for(let y=0;y<v.length;++y)p.push(za(v[y],u));return p}function wg(v,u,p){const y=p.pointOnLine(u,v).point;return p.distance(v,y)}function Hp(v,u,p,y,T){const b=p.slice(y[0],y[1]+1);let M=1/0;for(let k=u[0];k<=u[1];++k)if((M=Math.min(M,wg(v[k],b,T)))===0)return 0;return M}function Is(v,u,p,y,T){const b=Math.min(T.pointToSegmentDistance(v,p,y),T.pointToSegmentDistance(u,p,y)),M=Math.min(T.pointToSegmentDistance(p,v,u),T.pointToSegmentDistance(y,v,u));return Math.min(b,M)}function jp(v,u,p,y,T){if(!Qa(u,v.length)||!Qa(y,p.length))return NaN;let b=1/0;for(let M=u[0];M<u[1];++M)for(let k=y[0];k<y[1];++k){if(Jh(v[M],v[M+1],p[k],p[k+1]))return 0;b=Math.min(b,Is(v[M],v[M+1],p[k],p[k+1],T))}return b}function Sg(v,u,p,y,T){if(!Qa(u,v.length)||!Qa(y,p.length))return NaN;let b=1/0;for(let M=u[0];M<=u[1];++M)for(let k=y[0];k<=y[1];++k)if((b=Math.min(b,T.distance(v[M],p[k])))===0)return b;return b}function Ag(v,u,p){if(rc(v,u,!0))return 0;let y=1/0;for(const T of u){const b=T.length;if(b<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(T[0]!==T[b-1]&&(y=Math.min(y,p.pointToSegmentDistance(v,T[b-1],T[0])))===0||(y=Math.min(y,wg(v,T,p)))===0)return y}return y}function Wp(v,u,p,y){if(!Qa(u,v.length))return NaN;for(let b=u[0];b<=u[1];++b)if(rc(v[b],p,!0))return 0;let T=1/0;for(let b=u[0];b<u[1];++b)for(const M of p)for(let k=0,G=M.length,W=G-1;k<G;W=k++){if(Jh(v[b],v[b+1],M[W],M[k]))return 0;T=Math.min(T,Is(v[b],v[b+1],M[W],M[k],y))}return T}function el(v,u){for(const p of v)for(let y=0;y<=p.length-1;++y)if(rc(p[y],u,!0))return!0;return!1}function sd(v,u,p,y=1/0){const T=Na(v),b=Na(u);if(y!==1/0&&Vc(T,b,p)>=y)return y;if(Ku(T,b)){if(el(v,u))return 0}else if(el(u,v))return 0;let M=y;for(const k of v)for(let G=0,W=k.length,R=W-1;G<W;R=G++)for(const z of u)for(let j=0,U=z.length,V=U-1;j<U;V=j++){if(Jh(k[R],k[G],z[V],z[j]))return 0;M=Math.min(M,Is(k[R],k[G],z[V],z[j],p))}return M}function Ps(v,u,p,y,T,b,M){if(b===null||M===null)return;const k=Vc(ua(y,b),ua(T,M),p);k<u&&v.push({dist:k,range1:b,range2:M})}function Oo(v,u,p,y,T=1/0){let b=Math.min(y.distance(v[0],p[0][0]),T);if(b===0)return b;const M=new td([{dist:0,range1:[0,v.length-1],range2:[0,0]}],xg),k=u?nd:Gc,G=Na(p);for(;M.length;){const W=M.pop();if(W.dist>=b)continue;const R=W.range1;if(Vp(R)<=k){if(!Qa(R,v.length))return NaN;if(u){const z=Wp(v,R,p,y);if((b=Math.min(b,z))===0)return b}else for(let z=R[0];z<=R[1];++z){const j=Ag(v[z],p,y);if((b=Math.min(b,j))===0)return b}}else{const z=bg(R,u);if(z[0]!==null){const j=Vc(ua(v,z[0]),G,y);j<b&&M.push({dist:j,range1:z[0],range2:[0,0]})}if(z[1]!==null){const j=Vc(ua(v,z[1]),G,y);j<b&&M.push({dist:j,range1:z[1],range2:[0,0]})}}}return b}function Qs(v,u,p,y,T,b=1/0){let M=Math.min(b,T.distance(v[0],p[0]));if(M===0)return M;const k=new td([{dist:0,range1:[0,v.length-1],range2:[0,p.length-1]}],xg),G=u?nd:Gc,W=y?nd:Gc;for(;k.length;){const R=k.pop();if(R.dist>=M)continue;const z=R.range1,j=R.range2;if(Vp(z)<=G&&Vp(j)<=W){if(!Qa(z,v.length)||!Qa(j,p.length))return NaN;if(u&&y?M=Math.min(M,jp(v,z,p,j,T)):u||y?u&&!y?M=Math.min(M,Hp(p,j,v,z,T)):!u&&y&&(M=Math.min(M,Hp(v,z,p,j,T))):M=Math.min(M,Sg(v,z,p,j,T)),M===0)return M}else{const U=bg(z,u),V=bg(j,y);Ps(k,M,T,v,p,U[0],V[0]),Ps(k,M,T,v,p,U[0],V[1]),Ps(k,M,T,v,p,U[1],V[0]),Ps(k,M,T,v,p,U[1],V[1])}}return M}function Su(v,u,p,y,T=1/0){let b=T;const M=ua(v,[0,v.length-1]);for(const k of p)if(!(b!==1/0&&Vc(M,ua(k,[0,k.length-1]),y)>=b)&&(b=Math.min(b,Qs(v,u,k,!0,y,b)),b===0))return b;return b}function Au(v,u,p,y,T=1/0){let b=T;const M=ua(v,[0,v.length-1]);for(const k of p){if(b!==1/0&&Vc(M,Na(k),y)>=b)continue;const G=Oo(v,u,k,y,b);if(isNaN(G))return G;if((b=Math.min(b,G))===0)return b}return b}function Ju(v){return v==="Point"||v==="MultiPoint"||v==="LineString"||v==="MultiLineString"||v==="Polygon"||v==="MultiPolygon"}class Qu{constructor(u,p){this.type=Fn,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'distance' expression requires either one argument, but found ' ${u.length-1} instead.`);if(Uc(u[1])){const y=u[1];if(y.type==="FeatureCollection"){for(let T=0;T<y.features.length;++T)if(Ju(y.features[T].geometry.type))return new Qu(y,y.features[T].geometry)}else if(y.type==="Feature"){if(Ju(y.geometry.type))return new Qu(y,y.geometry)}else if(Ju(y.type))return new Qu(y,y)}return p.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(u){const p=u.geometry(),y=u.canonicalID();if(p!=null&&y!=null){if(u.geometryType()==="Point")return function(T,b,M){const k=[];for(const W of T)for(const R of W)k.push(za(R,b));const G=new ed(k[0][1],"meters");return M.type==="Point"||M.type==="MultiPoint"||M.type==="LineString"?Qs(k,!1,M.type==="Point"?[M.coordinates]:M.coordinates,M.type==="LineString",G):M.type==="MultiLineString"?Su(k,!1,M.coordinates,G):M.type==="Polygon"||M.type==="MultiPolygon"?Au(k,!1,M.type==="Polygon"?[M.coordinates]:M.coordinates,G):null}(p,y,this.geometries);if(u.geometryType()==="LineString")return function(T,b,M){const k=[];for(const W of T){const R=[];for(const z of W)R.push(za(z,b));k.push(R)}const G=new ed(k[0][0][1],"meters");if(M.type==="Point"||M.type==="MultiPoint"||M.type==="LineString")return Su(M.type==="Point"?[M.coordinates]:M.coordinates,M.type==="LineString",k,G);if(M.type==="MultiLineString"){let W=1/0;for(let R=0;R<M.coordinates.length;R++){const z=Su(M.coordinates[R],!0,k,G,W);if(isNaN(z))return z;if((W=Math.min(W,z))===0)return W}return W}if(M.type==="Polygon"||M.type==="MultiPolygon"){let W=1/0;for(let R=0;R<k.length;R++){const z=Au(k[R],!0,M.type==="Polygon"?[M.coordinates]:M.coordinates,G,W);if(isNaN(z))return z;if((W=Math.min(W,z))===0)return W}return W}return null}(p,y,this.geometries);if(u.geometryType()==="Polygon")return function(T,b,M){const k=[];for(const W of function(R,z){const j=R.length;if(j<=1)return[R];const U=[];let V,X;for(let Q=0;Q<j;Q++){const ne=Hx(R[Q]);ne!==0&&(R[Q].area=Math.abs(ne),X===void 0&&(X=ne<0),X===ne<0?(V&&U.push(V),V=[R[Q]]):V.push(R[Q]))}return V&&U.push(V),U}(T)){const R=[];for(let z=0;z<W.length;++z)R.push(id(W[z],b));k.push(R)}const G=new ed(k[0][0][0][1],"meters");if(M.type==="Point"||M.type==="MultiPoint"||M.type==="LineString")return Au(M.type==="Point"?[M.coordinates]:M.coordinates,M.type==="LineString",k,G);if(M.type==="MultiLineString"){let W=1/0;for(let R=0;R<M.coordinates.length;R++){const z=Au(M.coordinates[R],!0,k,G,W);if(isNaN(z))return z;if((W=Math.min(W,z))===0)return W}return W}return M.type==="Polygon"||M.type==="MultiPolygon"?function(W,R,z){let j=1/0;for(const U of W)for(const V of R){const X=sd(U,V,z,j);if(isNaN(X))return X;if((j=Math.min(j,X))===0)return j}return j}(M.type==="Polygon"?[M.coordinates]:M.coordinates,k,G):null}(p,y,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Ws(v,u){switch(v){case"string":return xa(u);case"number":return+u;case"boolean":return!!u;case"color":return _r.parse(u);case"formatted":return ko.fromString(xa(u));case"resolvedImage":return Ko.fromString(xa(u))}return u}function Qr(v,u,p,y){return y!==void 0&&(v=y*Math.round(v/y)),u!==void 0&&v<u&&(v=u),p!==void 0&&v>p&&(v=p),v}class eh{constructor(u,p,y){this.type=u,this.key=p,this.scope=y}static parse(u,p){let y=p.expectedType;if(y==null&&(y=ii),u.length<2||u.length>3)return p.error("Invalid number of arguments for 'config' expression.");const T=p.parse(u[1],1);if(!(T instanceof dl))return p.error("Key name of 'config' expression must be a string literal.");if(u.length>=3){const b=p.parse(u[2],2);return b instanceof dl?new eh(y,xa(T.value),xa(b.value)):p.error("Scope of 'config' expression must be a string literal.")}return new eh(y,xa(T.value))}evaluate(u){const p=[this.key,this.scope,u.scope].filter(Boolean).join(""),y=u.getConfig(p);if(!y)return null;const{type:T,value:b,values:M,minValue:k,maxValue:G,stepValue:W}=y,R=y.default.evaluate(u);let z=R;if(b){const j=u.scope;u.scope=(j||"").split("").slice(1).join(""),z=b.evaluate(u),u.scope=j}return T&&(z=Ws(T,z)),z===void 0||k===void 0&&G===void 0&&W===void 0||(typeof z=="number"?z=Qr(z,k,G,W):Array.isArray(z)&&(z=z.map(j=>typeof j=="number"?Qr(j,k,G,W):j))),b!==void 0&&z!==void 0&&M&&!M.includes(z)&&(z=R,T&&(z=Ws(T,z))),(T&&T!==this.type||z!==void 0&&Os(z)!==this.type)&&(z=Ws(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const u=["config",this.key];return this.scope&&u.concat(this.key),u}}function od(v){if(v instanceof Oa&&(v.name==="get"&&v.args.length===1||v.name==="feature-state"||v.name==="has"&&v.args.length===1||v.name==="properties"||v.name==="geometry-type"||v.name==="id"||/^filter-/.test(v.name))||v instanceof So||v instanceof Qu)return!1;let u=!0;return v.eachChild(p=>{u&&!od(p)&&(u=!1)}),u}function Rl(v){if(v instanceof Oa&&v.name==="feature-state")return!1;let u=!0;return v.eachChild(p=>{u&&!Rl(p)&&(u=!1)}),u}function fl(v){if(v instanceof eh)return new Set([v.key]);let u=new Set;return v.eachChild(p=>{u=new Set([...u,...fl(p)])}),u}function lc(v,u){if(v instanceof Oa&&u.indexOf(v.name)>=0)return!1;let p=!0;return v.eachChild(y=>{p&&!lc(y,u)&&(p=!1)}),p}class Ai{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const y=u[1];return p.scope.has(y)?new Ai(y,p.scope.get(y)):p.error(`Unknown variable "${y}". Make sure "${y}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Tf{constructor(u,p=[],y,T=new xf,b=[],M,k){this.registry=u,this.path=p,this.key=p.map(G=>typeof G=="string"?`['${G}']`:`[${G}]`).join(""),this.scope=T,this.errors=b,this.expectedType=y,this._scope=M,this.options=k}parse(u,p,y,T,b={}){return p||y?this.concat(p,null,y,T)._parse(u,b):this._parse(u,b)}parseObjectValue(u,p,y,T,b,M={}){return this.concat(p,y,T,b)._parse(u,M)}_parse(u,p){function y(T,b,M){return M==="assert"?new Js(b,[T]):M==="coerce"?new ca(b,[T]):T}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=typeof u[0]=="string"?this.registry[u[0]]:void 0;if(T){let b=T.parse(u,this);if(!b)return null;if(this.expectedType){const M=this.expectedType,k=b.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||k.kind!=="value")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(M,k))return null}else b=y(b,M,p.typeAnnotation||"coerce");else b=y(b,M,p.typeAnnotation||"assert")}if(!(b instanceof dl)&&b.type.kind!=="resolvedImage"&&Tg(b)){const M=new Np(this._scope,this.options);try{b=new dl(b.type,b.evaluate(M))}catch(k){return this.error(k.message),null}}return b}return ca.parse(["to-array",u],this)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,y,T){let b=typeof u=="number"?this.path.concat(u):this.path;b=typeof p=="string"?b.concat(p):b;const M=T?this.scope.concat(T):this.scope;return new Tf(this.registry,b,y||null,M,this.errors,this._scope,this.options)}error(u,...p){const y=`${this.key}${p.map(T=>`[${T}]`).join("")}`;this.errors.push(new Ss(y,u))}checkSubtype(u,p){const y=Ba(u,p);return y&&this.error(y),y}}var K0=Tf;function Tg(v){if(v instanceof Ai)return Tg(v.boundExpression);if(v instanceof Oa&&v.name==="error"||v instanceof zp||v instanceof So||v instanceof Qu||v instanceof eh)return!1;const u=v instanceof ca||v instanceof Js;let p=!0;return v.eachChild(y=>{p=u?p&&Tg(y):p&&y instanceof dl}),!!p&&od(v)&&lc(v,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function $p(v,u){const p=v.length-1;let y,T,b=0,M=p,k=0;for(;b<=M;)if(k=Math.floor((b+M)/2),y=v[k],T=v[k+1],y<=u){if(k===p||u<T)return k;b=k+1}else{if(!(y>u))throw new Ks("Input is not a number.");M=k-1}return 0}class Mf{constructor(u,p,y){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[T,b]of y)this.labels.push(T),this.outputs.push(b)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const y=p.parse(u[1],1,Fn);if(!y)return null;const T=[];let b=null;p.expectedType&&p.expectedType.kind!=="value"&&(b=p.expectedType);for(let M=1;M<u.length;M+=2){const k=M===1?-1/0:u[M],G=u[M+1],W=M,R=M+1;if(typeof k!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(T.length&&T[T.length-1][0]>=k)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',W);const z=p.parse(G,R,b);if(!z)return null;b=b||z.type,T.push([k,z])}return new Mf(b,y,T)}evaluate(u){const p=this.labels,y=this.outputs;if(p.length===1)return y[0].evaluate(u);const T=this.input.evaluate(u);if(T<=p[0])return y[0].evaluate(u);const b=p.length;return T>=p[b-1]?y[b-1].evaluate(u):y[$p(p,T)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}serialize(){const u=["step",this.input.serialize()];for(let p=0;p<this.labels.length;p++)p>0&&u.push(this.labels[p]),u.push(this.outputs[p].serialize());return u}}const J0=.95047,Q0=1.08883,Mg=4/29,Hc=6/29,e_=3*Hc*Hc,Cg=Hc*Hc*Hc,Eg=Math.PI/180,t_=180/Math.PI;function ad(v){return v>Cg?Math.pow(v,1/3):v/e_+Mg}function Ig(v){return v>Hc?v*v*v:e_*(v-Mg)}function Pg(v){return 255*(v<=.0031308?12.92*v:1.055*Math.pow(v,1/2.4)-.055)}function Rg(v){return(v/=255)<=.04045?v/12.92:Math.pow((v+.055)/1.055,2.4)}function n_(v){const u=Rg(v.r),p=Rg(v.g),y=Rg(v.b),T=ad((.4124564*u+.3575761*p+.1804375*y)/J0),b=ad((.2126729*u+.7151522*p+.072175*y)/1);return{l:116*b-16,a:500*(T-b),b:200*(b-ad((.0193339*u+.119192*p+.9503041*y)/Q0)),alpha:v.a}}function Lg(v){let u=(v.l+16)/116,p=isNaN(v.a)?u:u+v.a/500,y=isNaN(v.b)?u:u-v.b/200;return u=1*Ig(u),p=J0*Ig(p),y=Q0*Ig(y),new _r(Pg(3.2404542*p-1.5371385*u-.4985314*y),Pg(-.969266*p+1.8760108*u+.041556*y),Pg(.0556434*p-.2040259*u+1.0572252*y),v.alpha)}function jx(v,u,p){const y=u-v;return v+p*(y>180||y<-180?y-360*Math.round(y/360):y)}const Cf={forward:n_,reverse:Lg,interpolate:function(v,u,p){return{l:ur(v.l,u.l,p),a:ur(v.a,u.a,p),b:ur(v.b,u.b,p),alpha:ur(v.alpha,u.alpha,p)}}},Xp={forward:function(v){const{l:u,a:p,b:y}=n_(v),T=Math.atan2(y,p)*t_;return{h:T<0?T+360:T,c:Math.sqrt(p*p+y*y),l:u,alpha:v.a}},reverse:function(v){const u=v.h*Eg,p=v.c;return Lg({l:v.l,a:Math.cos(u)*p,b:Math.sin(u)*p,alpha:v.alpha})},interpolate:function(v,u,p){return{h:jx(v.h,u.h,p),c:ur(v.c,u.c,p),l:ur(v.l,u.l,p),alpha:ur(v.alpha,u.alpha,p)}}};var r_=Object.freeze({__proto__:null,hcl:Xp,lab:Cf});class pl{constructor(u,p,y,T,b){this.type=u,this.operator=p,this.interpolation=y,this.input=T,this.labels=[],this.outputs=[];for(const[M,k]of b)this.labels.push(M),this.outputs.push(k)}static interpolationFactor(u,p,y,T){let b=0;if(u.name==="exponential")b=i_(p,u.base,y,T);else if(u.name==="linear")b=i_(p,1,y,T);else if(u.name==="cubic-bezier"){const M=u.controlPoints;b=new gn(M[0],M[1],M[2],M[3]).solve(i_(p,1,y,T))}return b}static parse(u,p){let[y,T,b,...M]=u;if(!Array.isArray(T)||T.length===0)return p.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const W=T[1];if(typeof W!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:W}}else{if(T[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(T[0])}`,1,0);{const W=T.slice(1);if(W.length!==4||W.some(R=>typeof R!="number"||R<0||R>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:W}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(b=p.parse(b,2,Fn),!b)return null;const k=[];let G=null;y==="interpolate-hcl"||y==="interpolate-lab"?G=Hs:p.expectedType&&p.expectedType.kind!=="value"&&(G=p.expectedType);for(let W=0;W<M.length;W+=2){const R=M[W],z=M[W+1],j=W+3,U=W+4;if(typeof R!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(k.length&&k[k.length-1][0]>=R)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const V=p.parse(z,U,G);if(!V)return null;G=G||V.type,k.push([R,V])}return G.kind==="number"||G.kind==="color"||G.kind==="array"&&G.itemType.kind==="number"&&typeof G.N=="number"?new pl(G,y,T,b,k):p.error(`Type ${Es(G)} is not interpolatable.`)}evaluate(u){const p=this.labels,y=this.outputs;if(p.length===1)return y[0].evaluate(u);const T=this.input.evaluate(u);if(T<=p[0])return y[0].evaluate(u);const b=p.length;if(T>=p[b-1])return y[b-1].evaluate(u);const M=$p(p,T),k=pl.interpolationFactor(this.interpolation,T,p[M],p[M+1]),G=y[M].evaluate(u),W=y[M+1].evaluate(u);return this.operator==="interpolate"?Yh[this.type.kind.toLowerCase()](G,W,k):this.operator==="interpolate-hcl"?Xp.reverse(Xp.interpolate(Xp.forward(G),Xp.forward(W),k)):Cf.reverse(Cf.interpolate(Cf.forward(G),Cf.forward(W),k))}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}serialize(){let u;u=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const p=[this.operator,u,this.input.serialize()];for(let y=0;y<this.labels.length;y++)p.push(this.labels[y],this.outputs[y].serialize());return p}}function i_(v,u,p,y){const T=y-p,b=v-p;return T===0?0:u===1?b/T:(Math.pow(u,b)-1)/(Math.pow(u,T)-1)}class qp{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let y=null;const T=p.expectedType;T&&T.kind!=="value"&&(y=T);const b=[];for(const k of u.slice(1)){const G=p.parse(k,1+b.length,y,void 0,{typeAnnotation:"omit"});if(!G)return null;y=y||G.type,b.push(G)}const M=T&&b.some(k=>Ba(T,k.type));return new qp(M?ii:y,b)}evaluate(u){let p,y=null,T=0;for(const b of this.args){if(T++,y=b.evaluate(u),y&&y instanceof Ko&&!y.available&&(p||(p=y),y=null,T===this.args.length))return p;if(y!==null)break}return y}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}serialize(){const u=["coalesce"];return this.eachChild(p=>{u.push(p.serialize())}),u}}class Yp{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const y=[];for(let b=1;b<u.length-1;b+=2){const M=u[b];if(typeof M!="string")return p.error(`Expected string, but found ${typeof M} instead.`,b);if(/[^a-zA-Z0-9_]/.test(M))return p.error("Variable names must contain only alphanumeric characters or '_'.",b);const k=p.parse(u[b+1],b+1);if(!k)return null;y.push([M,k])}const T=p.parse(u[u.length-1],u.length-1,p.expectedType,y);return T?new Yp(y,T):null}outputDefined(){return this.result.outputDefined()}serialize(){const u=["let"];for(const[p,y]of this.bindings)u.push(p,y.serialize());return u.push(this.result.serialize()),u}}class Dg{constructor(u,p,y){this.type=u,this.index=p,this.input=y}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const y=p.parse(u[1],1,Fn),T=p.parse(u[2],2,la(p.expectedType||ii));return y&&T?new Dg(T.type.itemType,y,T):null}evaluate(u){const p=this.index.evaluate(u),y=this.input.evaluate(u);if(p<0)throw new Ks(`Array index out of bounds: ${p} < 0.`);if(p>=y.length)throw new Ks(`Array index out of bounds: ${p} > ${y.length-1}.`);if(p!==Math.floor(p))throw new Ks(`Array index must be an integer, but found ${p} instead.`);return y[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Bg{constructor(u,p){this.type=Kr,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const y=p.parse(u[1],1,ii),T=p.parse(u[2],2,ii);return y&&T?bf(y.type,[Kr,ni,Fn,nc,ii])?new Bg(y,T):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Es(y.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),y=this.haystack.evaluate(u);if(y==null)return!1;if(!hl(p,["boolean","string","number","null"]))throw new Ks(`Expected first argument to be of type boolean, string, number or null, but found ${Es(Os(p))} instead.`);if(!hl(y,["string","array"]))throw new Ks(`Expected second argument to be of type array or string, but found ${Es(Os(y))} instead.`);return y.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ld{constructor(u,p,y){this.type=Fn,this.needle=u,this.haystack=p,this.fromIndex=y}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const y=p.parse(u[1],1,ii),T=p.parse(u[2],2,ii);if(!y||!T)return null;if(!bf(y.type,[Kr,ni,Fn,nc,ii]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Es(y.type)} instead`);if(u.length===4){const b=p.parse(u[3],3,Fn);return b?new ld(y,T,b):null}return new ld(y,T)}evaluate(u){const p=this.needle.evaluate(u),y=this.haystack.evaluate(u);if(!hl(p,["boolean","string","number","null"]))throw new Ks(`Expected first argument to be of type boolean, string, number or null, but found ${Es(Os(p))} instead.`);if(!hl(y,["string","array"]))throw new Ks(`Expected second argument to be of type array or string, but found ${Es(Os(y))} instead.`);if(this.fromIndex){const T=this.fromIndex.evaluate(u);return y.indexOf(p,T)}return y.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const u=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),u]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class s_{constructor(u,p,y,T,b,M){this.inputType=u,this.type=p,this.input=y,this.cases=T,this.outputs=b,this.otherwise=M}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let y,T;p.expectedType&&p.expectedType.kind!=="value"&&(T=p.expectedType);const b={},M=[];for(let W=2;W<u.length-1;W+=2){let R=u[W];const z=u[W+1];Array.isArray(R)||(R=[R]);const j=p.concat(W);if(R.length===0)return j.error("Expected at least one branch label.");for(const V of R){if(typeof V!="number"&&typeof V!="string")return j.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return j.error("Numeric branch labels must be integer values.");if(y){if(j.checkSubtype(y,Os(V)))return null}else y=Os(V);if(b[String(V)]!==void 0)return j.error("Branch labels must be unique.");b[String(V)]=M.length}const U=p.parse(z,W,T);if(!U)return null;T=T||U.type,M.push(U)}const k=p.parse(u[1],1,ii);if(!k)return null;const G=p.parse(u[u.length-1],u.length-1,T);return G?k.type.kind!=="value"&&p.concat(1).checkSubtype(y,k.type)?null:new s_(y,T,k,b,M,G):null}evaluate(u){const p=this.input.evaluate(u);return(Os(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const u=["match",this.input.serialize()],p=Object.keys(this.cases).sort(),y=[],T={};for(const M of p){const k=T[this.cases[M]];k===void 0?(T[this.cases[M]]=y.length,y.push([this.cases[M],[M]])):y[k][1].push(M)}const b=M=>this.inputType.kind==="number"?Number(M):M;for(const[M,k]of y)u.push(k.length===1?b(k[0]):k.map(b)),u.push(this.outputs[M].serialize());return u.push(this.otherwise.serialize()),u}}class Zp{constructor(u,p,y){this.type=u,this.branches=p,this.otherwise=y}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let y;p.expectedType&&p.expectedType.kind!=="value"&&(y=p.expectedType);const T=[];for(let M=1;M<u.length-1;M+=2){const k=p.parse(u[M],M,Kr);if(!k)return null;const G=p.parse(u[M+1],M+1,y);if(!G)return null;T.push([k,G]),y=y||G.type}const b=p.parse(u[u.length-1],u.length-1,y);return b?new Zp(y,T,b):null}evaluate(u){for(const[p,y]of this.branches)if(p.evaluate(u))return y.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,y]of this.branches)u(p),u(y);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}serialize(){const u=["case"];return this.eachChild(p=>{u.push(p.serialize())}),u}}class kg{constructor(u,p,y,T){this.type=u,this.input=p,this.beginIndex=y,this.endIndex=T}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const y=p.parse(u[1],1,ii),T=p.parse(u[2],2,Fn);if(!y||!T)return null;if(!bf(y.type,[la(ii),ni,ii]))return p.error(`Expected first argument to be of type array or string, but found ${Es(y.type)} instead`);if(u.length===4){const b=p.parse(u[3],3,Fn);return b?new kg(y.type,y,T,b):null}return new kg(y.type,y,T)}evaluate(u){const p=this.input.evaluate(u),y=this.beginIndex.evaluate(u);if(!hl(p,["string","array"]))throw new Ks(`Expected first argument to be of type array or string, but found ${Es(Os(p))} instead.`);if(this.endIndex){const T=this.endIndex.evaluate(u);return p.slice(y,T)}return p.slice(y)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const u=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),u]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Kp(v,u){return v==="=="||v==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Og(v,u,p,y){return y.compare(u,p)===0}function Ef(v,u,p){const y=v!=="=="&&v!=="!=";return class Cue{constructor(b,M,k){this.type=Kr,this.lhs=b,this.rhs=M,this.collator=k,this.hasUntypedArgument=b.type.kind==="value"||M.type.kind==="value"}static parse(b,M){if(b.length!==3&&b.length!==4)return M.error("Expected two or three arguments.");const k=b[0];let G=M.parse(b[1],1,ii);if(!G)return null;if(!Kp(k,G.type))return M.concat(1).error(`"${k}" comparisons are not supported for type '${Es(G.type)}'.`);let W=M.parse(b[2],2,ii);if(!W)return null;if(!Kp(k,W.type))return M.concat(2).error(`"${k}" comparisons are not supported for type '${Es(W.type)}'.`);if(G.type.kind!==W.type.kind&&G.type.kind!=="value"&&W.type.kind!=="value")return M.error(`Cannot compare types '${Es(G.type)}' and '${Es(W.type)}'.`);y&&(G.type.kind==="value"&&W.type.kind!=="value"?G=new Js(W.type,[G]):G.type.kind!=="value"&&W.type.kind==="value"&&(W=new Js(G.type,[W])));let R=null;if(b.length===4){if(G.type.kind!=="string"&&W.type.kind!=="string"&&G.type.kind!=="value"&&W.type.kind!=="value")return M.error("Cannot use collator to compare non-string types.");if(R=M.parse(b[3],3,ul),!R)return null}return new Cue(G,W,R)}evaluate(b){const M=this.lhs.evaluate(b),k=this.rhs.evaluate(b);if(y&&this.hasUntypedArgument){const G=Os(M),W=Os(k);if(G.kind!==W.kind||G.kind!=="string"&&G.kind!=="number")throw new Ks(`Expected arguments for "${v}" to be (string, string) or (number, number), but found (${G.kind}, ${W.kind}) instead.`)}if(this.collator&&!y&&this.hasUntypedArgument){const G=Os(M),W=Os(k);if(G.kind!=="string"||W.kind!=="string")return u(b,M,k)}return this.collator?p(b,M,k,this.collator.evaluate(b)):u(b,M,k)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[v];return this.eachChild(M=>{b.push(M.serialize())}),b}}}const Wx=Ef("==",function(v,u,p){return u===p},Og),o_=Ef("!=",function(v,u,p){return u!==p},function(v,u,p,y){return!Og(0,u,p,y)}),a_=Ef("<",function(v,u,p){return u<p},function(v,u,p,y){return y.compare(u,p)<0}),cd=Ef(">",function(v,u,p){return u>p},function(v,u,p,y){return y.compare(u,p)>0}),l_=Ef("<=",function(v,u,p){return u<=p},function(v,u,p,y){return y.compare(u,p)<=0}),cc=Ef(">=",function(v,u,p){return u>=p},function(v,u,p,y){return y.compare(u,p)>=0});class Fg{constructor(u,p,y,T,b,M){this.type=ni,this.number=u,this.locale=p,this.currency=y,this.unit=T,this.minFractionDigits=b,this.maxFractionDigits=M}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const y=p.parse(u[1],1,Fn);if(!y)return null;const T=u[2];if(typeof T!="object"||Array.isArray(T))return p.error("NumberFormat options argument must be an object.");let b=null;if(T.locale&&(b=p.parseObjectValue(T.locale,2,"locale",ni),!b))return null;let M=null;if(T.currency&&(M=p.parseObjectValue(T.currency,2,"currency",ni),!M))return null;let k=null;if(T.unit&&(k=p.parseObjectValue(T.unit,2,"unit",ni),!k))return null;let G=null;if(T["min-fraction-digits"]&&(G=p.parseObjectValue(T["min-fraction-digits"],2,"min-fraction-digits",Fn),!G))return null;let W=null;return T["max-fraction-digits"]&&(W=p.parseObjectValue(T["max-fraction-digits"],2,"max-fraction-digits",Fn),!W)?null:new Fg(y,b,M,k,G,W)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(u):void 0,unit:this.unit?this.unit.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.unit&&u(this.unit),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const u={};return this.locale&&(u.locale=this.locale.serialize()),this.currency&&(u.currency=this.currency.serialize()),this.unit&&(u.unit=this.unit.serialize()),this.minFractionDigits&&(u["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(u["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),u]}}class Tu{constructor(u){this.type=Fn,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const y=p.parse(u[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${Es(y.type)} instead.`):new Tu(y):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Ks(`Expected value to be of type string or array, but found ${Es(Os(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}serialize(){const u=["length"];return this.eachChild(p=>{u.push(p.serialize())}),u}}function th(v){return function(){v=1831565813+(v|=0)|0;let u=Math.imul(v^v>>>15,1|v);return u=u+Math.imul(u^u>>>7,61|u)^u,((u^u>>>14)>>>0)/4294967296}}const Mu={"==":Wx,"!=":o_,">":cd,"<":a_,">=":cc,"<=":l_,array:Js,at:Dg,boolean:Js,case:Zp,coalesce:qp,collator:zp,format:ka,image:Ka,in:Bg,"index-of":ld,interpolate:pl,"interpolate-hcl":pl,"interpolate-lab":pl,length:Tu,let:Yp,literal:dl,match:s_,number:Js,"number-format":Fg,object:Js,slice:kg,step:Mf,string:Js,"to-boolean":ca,"to-color":ca,"to-number":ca,"to-string":ca,var:Ai,within:So,distance:Qu,config:eh};function Jp(v,[u,p,y,T]){u=u.evaluate(v),p=p.evaluate(v),y=y.evaluate(v);const b=T?T.evaluate(v):1,M=Zh(u,p,y,b);if(M)throw new Ks(M);return new _r(u/255*b,p/255*b,y/255*b,b)}function Ng(v,[u,p,y,T]){u=u.evaluate(v),p=p.evaluate(v),y=y.evaluate(v);const b=T?T.evaluate(v):1,M=function(W,R,z,j){return typeof W=="number"&&W>=0&&W<=360?typeof R=="number"&&R>=0&&R<=100&&typeof z=="number"&&z>=0&&z<=100?j===void 0||typeof j=="number"&&j>=0&&j<=1?null:`Invalid hsla value [${[W,R,z,j].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof j=="number"?[W,R,z,j]:[W,R,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof j=="number"?[W,R,z,j]:[W,R,z]).join(", ")}]: 'h' must be between 0 and 360.`}(u,p,y,b);if(M)throw new Ks(M);const k=`hsla(${u}, ${p}%, ${y}%, ${b})`,G=_r.parse(k);if(!G)throw new Ks(`Failed to parse HSLA color: ${k}`);return G}function ud(v,u){return v in u}function Jo(v,u){const p=u[v];return p===void 0?null:p}function hd(v){return{type:v}}function $x(v){return{result:"success",value:v}}function Ao(v){return{result:"error",value:v}}function ha(v,u){return!!v&&!!v.parameters&&v.parameters.indexOf(u)>-1}function Qp(v){return v["property-type"]==="data-driven"}function zg(v){return ha(v.expression,"measure-light")}function c_(v){return ha(v.expression,"zoom")}function Ug(v){return!!v.expression&&v.expression.interpolated}function em(v){return typeof v=="object"&&v!==null&&!Array.isArray(v)}function Gg(v){return v}function u_(v,u){const p=u.type==="color",y=v.stops&&typeof v.stops[0][0]=="object",T=y||!(y||v.property!==void 0),b=v.type||(Ug(u)?"exponential":"interval");if(p&&((v=yf({},v)).stops&&(v.stops=v.stops.map(W=>[W[0],_r.parse(W[1])])),v.default=_r.parse(v.default?v.default:u.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!r_[v.colorSpace])throw new Error(`Unknown color space: ${v.colorSpace}`);let M,k,G;if(b==="exponential")M=tm;else if(b==="interval")M=h_;else if(b==="categorical"){M=Xx,k=Object.create(null);for(const W of v.stops)k[W[0]]=W[1];G=typeof v.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);M=Vg}if(y){const W={},R=[];for(let U=0;U<v.stops.length;U++){const V=v.stops[U],X=V[0].zoom;W[X]===void 0&&(W[X]={zoom:X,type:v.type,property:v.property,default:v.default,stops:[]},R.push(X)),W[X].stops.push([V[0].value,V[1]])}const z=[];for(const U of R)z.push([W[U].zoom,u_(W[U],u)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:pl.interpolationFactor.bind(void 0,j),zoomStops:z.map(U=>U[0]),evaluate:({zoom:U},V)=>tm({stops:z,base:v.base},u,U).evaluate(U,V)}}if(T){const W=b==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:W,interpolationFactor:pl.interpolationFactor.bind(void 0,W),zoomStops:v.stops.map(R=>R[0]),evaluate:({zoom:R})=>M(v,u,R,k,G)}}return{kind:"source",evaluate(W,R){const z=R&&R.properties?R.properties[v.property]:void 0;return z===void 0?dd(v.default,u.default):M(v,u,z,k,G)}}}function dd(v,u,p){return v!==void 0?v:u!==void 0?u:p!==void 0?p:void 0}function Xx(v,u,p,y,T){return dd(typeof p===T?y[p]:void 0,v.default,u.default)}function h_(v,u,p){if(xu(p)!=="number")return dd(v.default,u.default);const y=v.stops.length;if(y===1||p<=v.stops[0][0])return v.stops[0][1];if(p>=v.stops[y-1][0])return v.stops[y-1][1];const T=$p(v.stops.map(b=>b[0]),p);return v.stops[T][1]}function tm(v,u,p){const y=v.base!==void 0?v.base:1;if(xu(p)!=="number")return dd(v.default,u.default);const T=v.stops.length;if(T===1||p<=v.stops[0][0])return v.stops[0][1];if(p>=v.stops[T-1][0])return v.stops[T-1][1];const b=$p(v.stops.map(R=>R[0]),p),M=function(R,z,j,U){const V=U-j,X=R-j;return V===0?0:z===1?X/V:(Math.pow(z,X)-1)/(Math.pow(z,V)-1)}(p,y,v.stops[b][0],v.stops[b+1][0]),k=v.stops[b][1],G=v.stops[b+1][1];let W=Yh[u.type]||Gg;if(v.colorSpace&&v.colorSpace!=="rgb"){const R=r_[v.colorSpace];W=(z,j)=>R.reverse(R.interpolate(R.forward(z),R.forward(j),M))}return typeof k.evaluate=="function"?{evaluate(...R){const z=k.evaluate.apply(void 0,R),j=G.evaluate.apply(void 0,R);if(z!==void 0&&j!==void 0)return W(z,j,M)}}:W(k,G,M)}function Vg(v,u,p){return u.type==="color"?p=_r.parse(p):u.type==="formatted"?p=ko.fromString(p.toString()):u.type==="resolvedImage"?p=Ko.fromString(p.toString()):xu(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0),dd(p,v.default,u.default)}Oa.register(Mu,{error:[{kind:"error"},[ni],(v,[u])=>{throw new Ks(u.evaluate(v))}],typeof:[ni,[ii],(v,[u])=>Es(Os(u.evaluate(v)))],"to-rgba":[la(Fn,4),[Hs],(v,[u])=>u.evaluate(v).toRenderColor(null).toArray()],rgb:[Hs,[Fn,Fn,Fn],Jp],rgba:[Hs,[Fn,Fn,Fn,Fn],Jp],hsl:[Hs,[Fn,Fn,Fn],Ng],hsla:[Hs,[Fn,Fn,Fn,Fn],Ng],has:{type:Kr,overloads:[[[ni],(v,[u])=>ud(u.evaluate(v),v.properties())],[[ni,ya],(v,[u,p])=>ud(u.evaluate(v),p.evaluate(v))]]},get:{type:ii,overloads:[[[ni],(v,[u])=>Jo(u.evaluate(v),v.properties())],[[ni,ya],(v,[u,p])=>Jo(u.evaluate(v),p.evaluate(v))]]},"feature-state":[ii,[ni],(v,[u])=>Jo(u.evaluate(v),v.featureState||{})],properties:[ya,[],v=>v.properties()],"geometry-type":[ni,[],v=>v.geometryType()],id:[ii,[],v=>v.id()],zoom:[Fn,[],v=>v.globals.zoom],pitch:[Fn,[],v=>v.globals.pitch||0],"distance-from-center":[Fn,[],v=>v.distanceFromCenter()],"measure-light":[Fn,[ni],(v,[u])=>v.measureLight(u.evaluate(v))],"heatmap-density":[Fn,[],v=>v.globals.heatmapDensity||0],"line-progress":[Fn,[],v=>v.globals.lineProgress||0],"raster-value":[Fn,[],v=>v.globals.rasterValue||0],"raster-particle-speed":[Fn,[],v=>v.globals.rasterParticleSpeed||0],"sky-radial-progress":[Fn,[],v=>v.globals.skyRadialProgress||0],accumulated:[ii,[],v=>v.globals.accumulated===void 0?null:v.globals.accumulated],"+":[Fn,hd(Fn),(v,u)=>{let p=0;for(const y of u)p+=y.evaluate(v);return p}],"*":[Fn,hd(Fn),(v,u)=>{let p=1;for(const y of u)p*=y.evaluate(v);return p}],"-":{type:Fn,overloads:[[[Fn,Fn],(v,[u,p])=>u.evaluate(v)-p.evaluate(v)],[[Fn],(v,[u])=>-u.evaluate(v)]]},"/":[Fn,[Fn,Fn],(v,[u,p])=>u.evaluate(v)/p.evaluate(v)],"%":[Fn,[Fn,Fn],(v,[u,p])=>u.evaluate(v)%p.evaluate(v)],ln2:[Fn,[],()=>Math.LN2],pi:[Fn,[],()=>Math.PI],e:[Fn,[],()=>Math.E],"^":[Fn,[Fn,Fn],(v,[u,p])=>Math.pow(u.evaluate(v),p.evaluate(v))],sqrt:[Fn,[Fn],(v,[u])=>Math.sqrt(u.evaluate(v))],log10:[Fn,[Fn],(v,[u])=>Math.log(u.evaluate(v))/Math.LN10],ln:[Fn,[Fn],(v,[u])=>Math.log(u.evaluate(v))],log2:[Fn,[Fn],(v,[u])=>Math.log(u.evaluate(v))/Math.LN2],sin:[Fn,[Fn],(v,[u])=>Math.sin(u.evaluate(v))],cos:[Fn,[Fn],(v,[u])=>Math.cos(u.evaluate(v))],tan:[Fn,[Fn],(v,[u])=>Math.tan(u.evaluate(v))],asin:[Fn,[Fn],(v,[u])=>Math.asin(u.evaluate(v))],acos:[Fn,[Fn],(v,[u])=>Math.acos(u.evaluate(v))],atan:[Fn,[Fn],(v,[u])=>Math.atan(u.evaluate(v))],min:[Fn,hd(Fn),(v,u)=>Math.min(...u.map(p=>p.evaluate(v)))],max:[Fn,hd(Fn),(v,u)=>Math.max(...u.map(p=>p.evaluate(v)))],abs:[Fn,[Fn],(v,[u])=>Math.abs(u.evaluate(v))],round:[Fn,[Fn],(v,[u])=>{const p=u.evaluate(v);return p<0?-Math.round(-p):Math.round(p)}],floor:[Fn,[Fn],(v,[u])=>Math.floor(u.evaluate(v))],ceil:[Fn,[Fn],(v,[u])=>Math.ceil(u.evaluate(v))],"filter-==":[Kr,[ni,ii],(v,[u,p])=>v.properties()[u.value]===p.value],"filter-id-==":[Kr,[ii],(v,[u])=>v.id()===u.value],"filter-type-==":[Kr,[ni],(v,[u])=>v.geometryType()===u.value],"filter-<":[Kr,[ni,ii],(v,[u,p])=>{const y=v.properties()[u.value],T=p.value;return typeof y==typeof T&&y<T}],"filter-id-<":[Kr,[ii],(v,[u])=>{const p=v.id(),y=u.value;return typeof p==typeof y&&p<y}],"filter->":[Kr,[ni,ii],(v,[u,p])=>{const y=v.properties()[u.value],T=p.value;return typeof y==typeof T&&y>T}],"filter-id->":[Kr,[ii],(v,[u])=>{const p=v.id(),y=u.value;return typeof p==typeof y&&p>y}],"filter-<=":[Kr,[ni,ii],(v,[u,p])=>{const y=v.properties()[u.value],T=p.value;return typeof y==typeof T&&y<=T}],"filter-id-<=":[Kr,[ii],(v,[u])=>{const p=v.id(),y=u.value;return typeof p==typeof y&&p<=y}],"filter->=":[Kr,[ni,ii],(v,[u,p])=>{const y=v.properties()[u.value],T=p.value;return typeof y==typeof T&&y>=T}],"filter-id->=":[Kr,[ii],(v,[u])=>{const p=v.id(),y=u.value;return typeof p==typeof y&&p>=y}],"filter-has":[Kr,[ii],(v,[u])=>u.value in v.properties()],"filter-has-id":[Kr,[],v=>v.id()!==null&&v.id()!==void 0],"filter-type-in":[Kr,[la(ni)],(v,[u])=>u.value.indexOf(v.geometryType())>=0],"filter-id-in":[Kr,[la(ii)],(v,[u])=>u.value.indexOf(v.id())>=0],"filter-in-small":[Kr,[ni,la(ii)],(v,[u,p])=>p.value.indexOf(v.properties()[u.value])>=0],"filter-in-large":[Kr,[ni,la(ii)],(v,[u,p])=>function(y,T,b,M){for(;b<=M;){const k=b+M>>1;if(T[k]===y)return!0;T[k]>y?M=k-1:b=k+1}return!1}(v.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Kr,overloads:[[[Kr,Kr],(v,[u,p])=>u.evaluate(v)&&p.evaluate(v)],[hd(Kr),(v,u)=>{for(const p of u)if(!p.evaluate(v))return!1;return!0}]]},any:{type:Kr,overloads:[[[Kr,Kr],(v,[u,p])=>u.evaluate(v)||p.evaluate(v)],[hd(Kr),(v,u)=>{for(const p of u)if(p.evaluate(v))return!0;return!1}]]},"!":[Kr,[Kr],(v,[u])=>!u.evaluate(v)],"is-supported-script":[Kr,[ni],(v,[u])=>{const p=v.globals&&v.globals.isSupportedScript;return!p||p(u.evaluate(v))}],upcase:[ni,[ni],(v,[u])=>u.evaluate(v).toUpperCase()],downcase:[ni,[ni],(v,[u])=>u.evaluate(v).toLowerCase()],concat:[ni,hd(ii),(v,u)=>u.map(p=>xa(p.evaluate(v))).join("")],"resolved-locale":[ni,[ul],(v,[u])=>u.evaluate(v).resolvedLocale()],random:[Fn,[Fn,Fn,ii],(v,u)=>{const[p,y,T]=u.map(M=>M.evaluate(v));if(p>y||p===y)return p;let b;if(typeof T=="string")b=function(M){let k=0;if(M.length===0)return k;for(let G=0;G<M.length;G++)k=(k<<5)-k+M.charCodeAt(G),k|=0;return k}(T);else{if(typeof T!="number")throw new Ks(`Invalid seed input: ${T}`);b=T}return p+th(b)()*(y-p)}]});class nm{constructor(u,p,y,T){this.expression=u,this._warningHistory={},this._evaluator=new Np(y,T),this._defaultValue=p?function(b){return b.type==="color"&&(em(b.default)||Array.isArray(b.default))?new _r(0,0,0,0):b.type==="color"?_r.parse(b.default)||null:b.default===void 0?null:b.default}(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,y,T,b,M,k,G){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=y,this._evaluator.canonical=T||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=M,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=G||null,this.expression.evaluate(this._evaluator)}evaluate(u,p,y,T,b,M,k,G){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=y||null,this._evaluator.canonical=T||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=M||null,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=G||null;try{const W=this.expression.evaluate(this._evaluator);if(W==null||typeof W=="number"&&W!=W)return this._defaultValue;if(this._enumValues&&!(W in this._enumValues))throw new Ks(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(W)} instead.`);return W}catch(W){return this._warningHistory[W.message]||(this._warningHistory[W.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${W.message}`)),this._defaultValue}}}function If(v){return Array.isArray(v)&&v.length>0&&typeof v[0]=="string"&&v[0]in Mu}function Pf(v,u,p,y){const T=new K0(Mu,[],u?function(M){const k={color:Hs,string:ni,number:Fn,enum:ni,boolean:Kr,formatted:Za,resolvedImage:yu};return M.type==="array"?la(k[M.value]||ii,M.length):k[M.type]}(u):void 0,void 0,void 0,p,y),b=T.parse(v,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return b?$x(new nm(b,u,p,y)):Ao(T.errors)}class Hg{constructor(u,p,y){this.kind=u,this._styleExpression=p,this.isLightConstant=y,this.isStateDependent=u!=="constant"&&!Rl(p.expression),this.configDependencies=fl(p.expression)}evaluateWithoutErrorHandling(u,p,y,T,b,M){return this._styleExpression.evaluateWithoutErrorHandling(u,p,y,T,b,M)}evaluate(u,p,y,T,b,M){return this._styleExpression.evaluate(u,p,y,T,b,M)}}class ml{constructor(u,p,y,T,b){this.kind=u,this.zoomStops=y,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!Rl(p.expression),this.isLightConstant=b,this.configDependencies=fl(p.expression),this.interpolationType=T}evaluateWithoutErrorHandling(u,p,y,T,b,M){return this._styleExpression.evaluateWithoutErrorHandling(u,p,y,T,b,M)}evaluate(u,p,y,T,b,M){return this._styleExpression.evaluate(u,p,y,T,b,M)}interpolationFactor(u,p,y){return this.interpolationType?pl.interpolationFactor(this.interpolationType,u,p,y):0}}function d_(v,u,p,y){if((v=Pf(v,u,p,y)).result==="error")return v;const T=v.value.expression,b=od(T);if(!b&&!Qp(u))return Ao([new Ss("","data expressions not supported")]);const M=lc(T,["zoom","pitch","distance-from-center"]);if(!M&&!c_(u))return Ao([new Ss("","zoom expressions not supported")]);const k=lc(T,["measure-light"]);if(!k&&!zg(u))return Ao([new Ss("","measure-light expression not supported")]);const G=u.expression&&u.expression.relaxZoomRestriction,W=rm(T);return W||M||G?W instanceof Ss?Ao([W]):W instanceof pl&&!Ug(u)?Ao([new Ss("",'"interpolate" expressions cannot be used with this property')]):$x(W?new ml(b?"camera":"composite",v.value,W.labels,W instanceof pl?W.interpolation:void 0,k):new Hg(b?"constant":"source",v.value,k)):Ao([new Ss("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Rf{constructor(u,p){this._parameters=u,this._specification=p,yf(this,u_(this._parameters,this._specification))}static deserialize(u){return new Rf(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function rm(v){let u=null;if(v instanceof Yp)u=rm(v.result);else if(v instanceof qp){for(const p of v.args)if(u=rm(p),u)break}else(v instanceof Mf||v instanceof pl)&&v.input instanceof Oa&&v.input.name==="zoom"&&(u=v);return u instanceof Ss||v.eachChild(p=>{const y=rm(p);y instanceof Ss?u=y:u&&y&&u!==y&&(u=new Ss("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}var Ll,f_,qx=function(){if(f_)return Ll;f_=1,Ll=u;var v=3;function u(p,y,T){var b=this.cells=[];if(p instanceof ArrayBuffer){this.arrayBuffer=p;var M=new Int32Array(this.arrayBuffer);p=M[0],this.d=(y=M[1])+2*(T=M[2]);for(var k=0;k<this.d*this.d;k++){var G=M[v+k],W=M[v+k+1];b.push(G===W?null:M.subarray(G,W))}var R=M[v+b.length+1];this.keys=M.subarray(M[v+b.length],R),this.bboxes=M.subarray(R),this.insert=this._insertReadonly}else{this.d=y+2*T;for(var z=0;z<this.d*this.d;z++)b.push([]);this.keys=[],this.bboxes=[]}this.n=y,this.extent=p,this.padding=T,this.scale=y/p,this.uid=0;var j=T/y*p;this.min=-j,this.max=p+j}return u.prototype.insert=function(p,y,T,b,M){this._forEachCell(y,T,b,M,this._insertCell,this.uid++),this.keys.push(p),this.bboxes.push(y),this.bboxes.push(T),this.bboxes.push(b),this.bboxes.push(M)},u.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},u.prototype._insertCell=function(p,y,T,b,M,k){this.cells[M].push(k)},u.prototype.query=function(p,y,T,b,M){var k=this.min,G=this.max;if(p<=k&&y<=k&&G<=T&&G<=b&&!M)return Array.prototype.slice.call(this.keys);var W=[];return this._forEachCell(p,y,T,b,this._queryCell,W,{},M),W},u.prototype._queryCell=function(p,y,T,b,M,k,G,W){var R=this.cells[M];if(R!==null)for(var z=this.keys,j=this.bboxes,U=0;U<R.length;U++){var V=R[U];if(G[V]===void 0){var X=4*V;(W?W(j[X+0],j[X+1],j[X+2],j[X+3]):p<=j[X+2]&&y<=j[X+3]&&T>=j[X+0]&&b>=j[X+1])?(G[V]=!0,k.push(z[V])):G[V]=!1}}},u.prototype._forEachCell=function(p,y,T,b,M,k,G,W){for(var R=this._convertToCellCoord(p),z=this._convertToCellCoord(y),j=this._convertToCellCoord(T),U=this._convertToCellCoord(b),V=R;V<=j;V++)for(var X=z;X<=U;X++){var Q=this.d*X+V;if((!W||W(this._convertFromCellCoord(V),this._convertFromCellCoord(X),this._convertFromCellCoord(V+1),this._convertFromCellCoord(X+1)))&&M.call(this,p,y,T,b,Q,k,G,W))return}},u.prototype._convertFromCellCoord=function(p){return(p-this.padding)/this.scale},u.prototype._convertToCellCoord=function(p){return Math.max(0,Math.min(this.d-1,Math.floor(p*this.scale)+this.padding))},u.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var p=this.cells,y=v+this.cells.length+1+1,T=0,b=0;b<this.cells.length;b++)T+=this.cells[b].length;var M=new Int32Array(y+T+this.keys.length+this.bboxes.length);M[0]=this.extent,M[1]=this.n,M[2]=this.padding;for(var k=y,G=0;G<p.length;G++){var W=p[G];M[v+G]=k,M.set(W,k),k+=W.length}return M[v+p.length]=k,M.set(this.keys,k),M[v+p.length+1]=k+=this.keys.length,M.set(this.bboxes,k),k+=this.bboxes.length,M.buffer},Ll}(),jc=d(qx);const Dl={};function Nn(v,u,p={}){Object.defineProperty(v,"_classRegistryKey",{value:u,writable:!1}),Dl[u]={klass:v,omit:p.omit||[]}}Nn(Object,"Object"),jc.serialize=function(v,u){const p=v.toArrayBuffer();return u&&u.add(p),{buffer:p}},jc.deserialize=function(v){return new jc(v.buffer)},Object.defineProperty(jc,"name",{value:"Grid"}),Nn(jc,"Grid"),Nn(_r,"Color"),Nn(Error,"Error"),Nn(ko,"Formatted"),Nn(js,"FormattedSection"),Nn(Zr,"AJAXError"),Nn(Ko,"ResolvedImage"),Nn(Rf,"StylePropertyFunction"),Nn(nm,"StyleExpression",{omit:["_evaluator"]}),Nn(ml,"ZoomDependentExpression"),Nn(Hg,"ZoomConstantExpression"),Nn(Oa,"CompoundExpression",{omit:["_evaluate"]});for(const v in Mu)Dl[Mu[v]._classRegistryKey]||Nn(Mu[v],`Expression${v}`);function or(v){return v&&typeof ArrayBuffer<"u"&&(v instanceof ArrayBuffer||v.constructor&&v.constructor.name==="ArrayBuffer")}function im(v){return self.ImageBitmap&&v instanceof ImageBitmap}function wa(v,u){if(v==null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"||v instanceof Boolean||v instanceof Number||v instanceof String||v instanceof Date||v instanceof RegExp)return v;if(or(v)||im(v))return u&&u.add(v),v;if(ArrayBuffer.isView(v)){const p=v;return u&&u.add(p.buffer),p}if(v instanceof ImageData)return u&&u.add(v.data.buffer),v;if(Array.isArray(v)){const p=[];for(const y of v)p.push(wa(y,u));return p}if(v instanceof Map){const p={$name:"Map"};for(const[y,T]of v.entries())p[y]=wa(T);return p}if(v instanceof Set){const p={$name:"Set"};let y=0;for(const T of v.values())p[++y]=wa(T);return p}if(typeof v=="object"){const p=v.constructor,y=p._classRegistryKey;if(!y)throw new Error(`can't serialize object of unregistered class ${y}`);const T=p.serialize?p.serialize(v,u):{};if(!p.serialize){for(const b in v)v.hasOwnProperty(b)&&(Dl[y].omit.indexOf(b)>=0||(T[b]=wa(v[b],u)));v instanceof Error&&(T.message=v.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return y!=="Object"&&(T.$name=y),T}throw new Error("can't serialize object of type "+typeof v)}function nh(v){if(v==null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"||v instanceof Boolean||v instanceof Number||v instanceof String||v instanceof Date||v instanceof RegExp||or(v)||im(v)||ArrayBuffer.isView(v)||v instanceof ImageData)return v;if(Array.isArray(v))return v.map(nh);if(typeof v=="object"){const u=v.$name||"Object";if(u==="Map"){const T=new Map;for(const b of Object.keys(v))b!=="$name"&&T.set(b,nh(v[b]));return T}if(u==="Set"){const T=new Set;for(const b of Object.keys(v))b!=="$name"&&T.add(nh(v[b]));return T}const{klass:p}=Dl[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(v);const y=Object.create(p.prototype);for(const T of Object.keys(v))T!=="$name"&&(y[T]=nh(v[T]));return y}throw new Error("can't deserialize object of type "+typeof v)}const Kn={"Latin-1 Supplement":v=>v>=128&&v<=255,Arabic:v=>v>=1536&&v<=1791,"Arabic Supplement":v=>v>=1872&&v<=1919,"Arabic Extended-A":v=>v>=2208&&v<=2303,"Hangul Jamo":v=>v>=4352&&v<=4607,"Unified Canadian Aboriginal Syllabics":v=>v>=5120&&v<=5759,Khmer:v=>v>=6016&&v<=6143,"Unified Canadian Aboriginal Syllabics Extended":v=>v>=6320&&v<=6399,"General Punctuation":v=>v>=8192&&v<=8303,"Letterlike Symbols":v=>v>=8448&&v<=8527,"Number Forms":v=>v>=8528&&v<=8591,"Miscellaneous Technical":v=>v>=8960&&v<=9215,"Control Pictures":v=>v>=9216&&v<=9279,"Optical Character Recognition":v=>v>=9280&&v<=9311,"Enclosed Alphanumerics":v=>v>=9312&&v<=9471,"Geometric Shapes":v=>v>=9632&&v<=9727,"Miscellaneous Symbols":v=>v>=9728&&v<=9983,"Miscellaneous Symbols and Arrows":v=>v>=11008&&v<=11263,"CJK Radicals Supplement":v=>v>=11904&&v<=12031,"Kangxi Radicals":v=>v>=12032&&v<=12255,"Ideographic Description Characters":v=>v>=12272&&v<=12287,"CJK Symbols and Punctuation":v=>v>=12288&&v<=12351,Hiragana:v=>v>=12352&&v<=12447,Katakana:v=>v>=12448&&v<=12543,Bopomofo:v=>v>=12544&&v<=12591,"Hangul Compatibility Jamo":v=>v>=12592&&v<=12687,Kanbun:v=>v>=12688&&v<=12703,"Bopomofo Extended":v=>v>=12704&&v<=12735,"CJK Strokes":v=>v>=12736&&v<=12783,"Katakana Phonetic Extensions":v=>v>=12784&&v<=12799,"Enclosed CJK Letters and Months":v=>v>=12800&&v<=13055,"CJK Compatibility":v=>v>=13056&&v<=13311,"CJK Unified Ideographs Extension A":v=>v>=13312&&v<=19903,"Yijing Hexagram Symbols":v=>v>=19904&&v<=19967,"CJK Unified Ideographs":v=>v>=19968&&v<=40959,"Yi Syllables":v=>v>=40960&&v<=42127,"Yi Radicals":v=>v>=42128&&v<=42191,"Hangul Jamo Extended-A":v=>v>=43360&&v<=43391,"Hangul Syllables":v=>v>=44032&&v<=55215,"Hangul Jamo Extended-B":v=>v>=55216&&v<=55295,"Private Use Area":v=>v>=57344&&v<=63743,"CJK Compatibility Ideographs":v=>v>=63744&&v<=64255,"Arabic Presentation Forms-A":v=>v>=64336&&v<=65023,"Vertical Forms":v=>v>=65040&&v<=65055,"CJK Compatibility Forms":v=>v>=65072&&v<=65103,"Small Form Variants":v=>v>=65104&&v<=65135,"Arabic Presentation Forms-B":v=>v>=65136&&v<=65279,"Halfwidth and Fullwidth Forms":v=>v>=65280&&v<=65519,"CJK Unified Ideographs Extension B":v=>v>=131072&&v<=173791};function Wc(v){for(const u of v)if(om(u.charCodeAt(0)))return!0;return!1}function sm(v){for(const u of v)if(!Lf(u.charCodeAt(0)))return!1;return!0}function Lf(v){return!(Kn.Arabic(v)||Kn["Arabic Supplement"](v)||Kn["Arabic Extended-A"](v)||Kn["Arabic Presentation Forms-A"](v)||Kn["Arabic Presentation Forms-B"](v))}function om(v){return!(v!==746&&v!==747&&(v<4352||!(Kn["Bopomofo Extended"](v)||Kn.Bopomofo(v)||Kn["CJK Compatibility Forms"](v)&&!(v>=65097&&v<=65103)||Kn["CJK Compatibility Ideographs"](v)||Kn["CJK Compatibility"](v)||Kn["CJK Radicals Supplement"](v)||Kn["CJK Strokes"](v)||!(!Kn["CJK Symbols and Punctuation"](v)||v>=12296&&v<=12305||v>=12308&&v<=12319||v===12336)||Kn["CJK Unified Ideographs Extension A"](v)||Kn["CJK Unified Ideographs"](v)||Kn["Enclosed CJK Letters and Months"](v)||Kn["Hangul Compatibility Jamo"](v)||Kn["Hangul Jamo Extended-A"](v)||Kn["Hangul Jamo Extended-B"](v)||Kn["Hangul Jamo"](v)||Kn["Hangul Syllables"](v)||Kn.Hiragana(v)||Kn["Ideographic Description Characters"](v)||Kn.Kanbun(v)||Kn["Kangxi Radicals"](v)||Kn["Katakana Phonetic Extensions"](v)||Kn.Katakana(v)&&v!==12540||!(!Kn["Halfwidth and Fullwidth Forms"](v)||v===65288||v===65289||v===65293||v>=65306&&v<=65310||v===65339||v===65341||v===65343||v>=65371&&v<=65503||v===65507||v>=65512&&v<=65519)||!(!Kn["Small Form Variants"](v)||v>=65112&&v<=65118||v>=65123&&v<=65126)||Kn["Unified Canadian Aboriginal Syllabics"](v)||Kn["Unified Canadian Aboriginal Syllabics Extended"](v)||Kn["Vertical Forms"](v)||Kn["Yijing Hexagram Symbols"](v)||Kn["Yi Syllables"](v)||Kn["Yi Radicals"](v))))}function Df(v){return!(om(v)||function(u){return!!(Kn["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Kn["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Kn["Letterlike Symbols"](u)||Kn["Number Forms"](u)||Kn["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Kn["Control Pictures"](u)&&u!==9251||Kn["Optical Character Recognition"](u)||Kn["Enclosed Alphanumerics"](u)||Kn["Geometric Shapes"](u)||Kn["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Kn["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Kn["CJK Symbols and Punctuation"](u)||Kn.Katakana(u)||Kn["Private Use Area"](u)||Kn["CJK Compatibility Forms"](u)||Kn["Small Form Variants"](u)||Kn["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(v))}function jg(v){return v>=1424&&v<=2303||Kn["Arabic Presentation Forms-A"](v)||Kn["Arabic Presentation Forms-B"](v)}function Yx(v,u){return!(!u&&jg(v)||v>=2304&&v<=3583||v>=3840&&v<=4255||Kn.Khmer(v))}function Zx(v){for(const u of v)if(jg(u.charCodeAt(0)))return!0;return!1}const Bf="deferred",fd="loading",kf="loaded";let pd=null,ho="unavailable",uc=null;const Kx=function(v){v&&typeof v=="string"&&v.indexOf("NetworkError")>-1&&(ho="error"),pd&&pd(v)};function p_(){Wg.fire(new tc("pluginStateChange",{pluginStatus:ho,pluginURL:uc}))}const Wg=new Xu,$g=function(){return ho},Xg=function(){if(ho!==Bf||!uc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ho=fd,p_(),uc&&ks({url:uc},v=>{v?Kx(v):(ho=kf,p_())})},Ua={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ho===kf||Ua.applyArabicShaping!=null,isLoading:()=>ho===fd,setState(v){ho=v.pluginStatus,uc=v.pluginURL},isParsed:()=>Ua.applyArabicShaping!=null&&Ua.processBidirectionalText!=null&&Ua.processStyledBidirectionalText!=null,getPluginURL:()=>uc};class gs{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.transition=p.transition,this.pitch=p.pitch,this.brightness=p.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(u){return function(p,y){for(const T of p)if(!Yx(T.charCodeAt(0),y))return!1;return!0}(u,Ua.isLoaded())}}class md{constructor(u,p,y,T){this.property=u,this.value=p,this.expression=function(b,M,k,G){if(em(b))return new Rf(b,M);if(If(b)||Array.isArray(b)&&b.length>0){const W=d_(b,M,k,G);if(W.result==="error")throw new Error(W.value.map(R=>`${R.key}: ${R.message}`).join(", "));return W.value}{let W=b;return typeof b=="string"&&M.type==="color"&&(W=_r.parse(b)),{kind:"constant",configDependencies:new Set,evaluate:()=>W}}}(p===void 0?u.specification.default:p,u.specification,y,T)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,y){return this.property.possiblyEvaluate(this,u,p,y)}}class Of{constructor(u,p,y){this.property=u,this.value=new md(u,void 0,p,y)}transitioned(u,p){return new lm(this.property,this.value,p,Ar({},u.transition,this.transition),u.now)}untransitioned(){return new lm(this.property,this.value,null,{},0)}}class am{constructor(u,p,y){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues),this._scope=p,this._options=y,this.configDependencies=new Set}getValue(u){return Si(this._values[u].value.value)}setValue(u,p){this._values.hasOwnProperty(u)||(this._values[u]=new Of(this._values[u].property,this._scope,this._options)),this._values[u].value=new md(this._values[u].property,p===null?void 0:Si(p),this._scope,this._options),this._values[u].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[u].value.expression.configDependencies]))}setTransitionOrValue(u,p){p&&(this._options=p);const y=this._properties.properties;if(u)for(const T in u){const b=u[T];if(ar(T,"-transition")){const M=T.slice(0,-11);y[M]&&this.setTransition(M,b)}else y.hasOwnProperty(T)&&this.setValue(T,b)}}getTransition(u){return Si(this._values[u].transition)}setTransition(u,p){this._values.hasOwnProperty(u)||(this._values[u]=new Of(this._values[u].property)),this._values[u].transition=Si(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const y=this.getValue(p);y!==void 0&&(u[p]=y);const T=this.getTransition(p);T!==void 0&&(u[`${p}-transition`]=T)}return u}transitioned(u,p){const y=new Ff(this._properties);for(const T of Object.keys(this._values))y._values[T]=this._values[T].transitioned(u,p._values[T]);return y}untransitioned(){const u=new Ff(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class lm{constructor(u,p,y,T,b){const M=T.delay||0,k=T.duration||0;b=b||0,this.property=u,this.value=p,this.begin=b+M,this.end=this.begin+k,u.specification.transition&&(T.delay||T.duration)&&(this.prior=y)}possiblyEvaluate(u,p,y){const T=u.now||0,b=this.value.possiblyEvaluate(u,p,y),M=this.prior;if(M){if(T>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(T<this.begin)return M.possiblyEvaluate(u,p,y);{const k=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(M.possiblyEvaluate(u,p,y),b,qt(k))}}return b}}class Ff{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,y){const T=new ih(this._properties);for(const b of Object.keys(this._values))T._values[b]=this._values[b].possiblyEvaluate(u,p,y);return T}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class m_{constructor(u,p,y){this._properties=u,this._values=Object.create(u.defaultPropertyValues),this._scope=p,this._options=y,this.configDependencies=new Set}getValue(u){return Si(this._values[u].value)}setValue(u,p){this._values[u]=new md(this._values[u].property,p===null?void 0:Si(p),this._scope,this._options),this._values[u].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[u].expression.configDependencies]))}serialize(){const u={};for(const p of Object.keys(this._values)){const y=this.getValue(p);y!==void 0&&(u[p]=y)}return u}possiblyEvaluate(u,p,y){const T=new ih(this._properties);for(const b of Object.keys(this._values))T._values[b]=this._values[b].possiblyEvaluate(u,p,y);return T}}class rh{constructor(u,p,y){this.property=u,this.value=p,this.parameters=y}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,y,T){return this.property.evaluate(this.value,this.parameters,u,p,y,T)}}class ih{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class vn{constructor(u){this.specification=u}possiblyEvaluate(u,p){return u.expression.evaluate(p)}interpolate(u,p,y){const T=Yh[this.specification.type];return T?T(u,p,y):u}}class Jn{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,y,T){return new rh(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},y,T)}:u.expression,p)}interpolate(u,p,y){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new rh(this,{kind:"constant",value:void 0},u.parameters);const T=Yh[this.specification.type];return T?new rh(this,{kind:"constant",value:T(u.value.value,p.value.value,y)},u.parameters):u}evaluate(u,p,y,T,b,M){return u.kind==="constant"?u.value:u.evaluate(p,y,T,b,M)}}class hc{constructor(u){this.specification=u}possiblyEvaluate(u,p,y,T){return!!u.expression.evaluate(p,null,{},y,T)}interpolate(){return!1}}class qi{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const p=new gs(0,{});for(const y in u){const T=u[y];T.specification.overridable&&this.overridableProperties.push(y);const b=this.defaultPropertyValues[y]=new md(T,void 0),M=this.defaultTransitionablePropertyValues[y]=new Of(T);this.defaultTransitioningPropertyValues[y]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[y]=b.possiblyEvaluate(p)}}}Nn(Jn,"DataDrivenProperty"),Nn(vn,"DataConstantProperty"),Nn(hc,"ColorRampProperty");var Tt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Fs(v){return v instanceof Number||v instanceof String||v instanceof Boolean?v.valueOf():v}function mi(v){if(Array.isArray(v))return v.map(mi);if(v instanceof Object&&!(v instanceof Number||v instanceof String||v instanceof Boolean)){const u={};for(const p in v)u[p]=mi(v[p]);return u}return Fs(v)}function eo(v){if(v===!0||v===!1)return!0;if(!Array.isArray(v)||v.length===0)return!1;switch(v[0]){case"has":return v.length>=2&&v[1]!=="$id"&&v[1]!=="$type";case"in":return v.length>=3&&(typeof v[1]!="string"||Array.isArray(v[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return v.length!==3||Array.isArray(v[1])||Array.isArray(v[2]);case"any":case"all":for(const u of v.slice(1))if(!eo(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}function os(v,u="",p=null,y="fill"){if(v==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};eo(v)||(v=vd(v));const T=v;let b=!0;try{b=function(z){if(!dc(z))return z;let j=mi(z);return No(j),j=Fo(j),j}(T)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(T,null,2)}
        `)}const M=Tt[`filter_${y}`],k=Pf(b,M,u,p);let G=null;if(k.result==="error")throw new Error(k.value.map(z=>`${z.key}: ${z.message}`).join(", "));G=(z,j,U)=>k.value.evaluate(z,j,{},U);let W=null,R=null;if(b!==T){const z=Pf(T,M,u,p);if(z.result==="error")throw new Error(z.value.map(j=>`${j.key}: ${j.message}`).join(", "));W=(j,U,V,X,Q)=>z.value.evaluate(j,U,{},V,void 0,void 0,X,Q),R=!od(z.value.expression)}return{filter:G,dynamicFilter:W||void 0,needGeometry:gd(b),needFeature:!!R}}function Fo(v){if(!Array.isArray(v))return v;const u=function(p){if(zo.has(p[0])){for(let y=1;y<p.length;y++)if(dc(p[y]))return!0}return p}(v);return u===!0?u:u.map(p=>Fo(p))}function No(v){let u=!1;const p=[];if(v[0]==="case"){for(let y=1;y<v.length-1;y+=2)u=u||dc(v[y]),p.push(v[y+1]);p.push(v[v.length-1])}else if(v[0]==="match"){u=u||dc(v[1]);for(let y=2;y<v.length-1;y+=2)p.push(v[y+1]);p.push(v[v.length-1])}else if(v[0]==="step"){u=u||dc(v[1]);for(let y=1;y<v.length-1;y+=2)p.push(v[y+1])}u&&(v.length=0,v.push("any",...p));for(let y=1;y<v.length;y++)No(v[y])}function dc(v){if(!Array.isArray(v))return!1;if((u=v[0])==="pitch"||u==="distance-from-center")return!0;var u;for(let p=1;p<v.length;p++)if(dc(v[p]))return!0;return!1}const zo=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function cm(v,u){return v<u?-1:v>u?1:0}function gd(v){if(!Array.isArray(v))return!1;if(v[0]==="within"||v[0]==="distance")return!0;for(let u=1;u<v.length;u++)if(gd(v[u]))return!0;return!1}function vd(v){if(!v)return!0;const u=v[0];return v.length<=1?u!=="any":u==="=="?Nf(v[1],v[2],"=="):u==="!="?_d(Nf(v[1],v[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Nf(v[1],v[2],u):u==="any"?(p=v.slice(1),["any"].concat(p.map(vd))):u==="all"?["all"].concat(v.slice(1).map(vd)):u==="none"?["all"].concat(v.slice(1).map(vd).map(_d)):u==="in"?sh(v[1],v.slice(2)):u==="!in"?_d(sh(v[1],v.slice(2))):u==="has"?Qo(v[1]):u!=="!has"||_d(Qo(v[1]));var p}function Nf(v,u,p){switch(v){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,v,u]}}function sh(v,u){if(u.length===0)return!1;switch(v){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",v,["literal",u.sort(cm)]]:["filter-in-small",v,["literal",u]]}}function Qo(v){switch(v){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",v]}}function _d(v){return["!",v]}const oh="";function yd(v,u){return u?`${v}${oh}${u}`:v}const tl="-transition",g_=new Set(["fill","line","background","hillshade","raster"]);class $s extends Xu{constructor(u,p,y,T,b){if(super(),this.id=u.id,this.fqid=yd(this.id,y),this.type=u.type,this.scope=y,this.lut=T,this.options=b,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&u.type!=="sky"&&u.type!=="slot"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),u.slot&&(this.slot=u.slot),p.layout&&(this._unevaluatedLayout=new m_(p.layout,this.scope,b),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),p.paint)){this._transitionablePaint=new am(p.paint,this.scope,b);for(const M in u.paint)this.setPaintProperty(M,u.paint[M]);for(const M in u.layout)this.setLayoutProperty(M,u.layout[M]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ih(p.paint)}}onAdd(u){}onRemove(u){}isDraped(u){return!this.is3D()&&g_.has(this.type)}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p){if(this.type==="custom"&&u==="visibility")return void(this.visibility=p);const y=this._unevaluatedLayout;y._properties.properties[u]&&(y.setValue(u,p),this.configDependencies=new Set([...this.configDependencies,...y.configDependencies]),u==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(u){return ar(u,tl)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p){const y=this._transitionablePaint,T=y._properties.properties;if(ar(u,tl)){const z=u.slice(0,-11);return T[z]&&y.setTransition(z,p||void 0),!1}if(!T[u])return!1;const b=y._values[u],M=b.value.isDataDriven(),k=b.value;y.setValue(u,p),this.configDependencies=new Set([...this.configDependencies,...y.configDependencies]),this._handleSpecialPaintPropertyUpdate(u);const G=y._values[u].value,W=G.isDataDriven(),R=ar(u,"pattern")||u==="line-dasharray";return W||M||R||this._handleOverridablePaintPropertyUpdate(u,k,G)}_handleSpecialPaintPropertyUpdate(u){}getProgramIds(){return null}getDefaultProgramParams(u,p,y){return null}_handleOverridablePaintPropertyUpdate(u,p,y){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){return Wr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(u,p)=>!(u===void 0||p==="layout"&&!Object.keys(u).length||p==="paint"&&!Object.keys(u).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof rh&&Qp(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}compileFilter(u){this._filterCompiled||(this._featureFilter=os(this.filter,this.scope,u),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(u){this._stats&&(u.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(u){}queryIntersectsFeature(u,p,y,T,b,M,k,G,W){}queryIntersectsMatchingFeature(u,p,y,T){}}const qg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bl{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ui{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.add(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...u){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...u){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ti(v,u=1){let p=0,y=0;return{members:v.map(T=>{const b=qg[T.type].BYTES_PER_ELEMENT,M=p=Yg(p,Math.max(u,b)),k=T.components||1;return y=Math.max(y,b),p+=b*k,{name:T.name,type:T.type,components:k,offset:M}}),size:Yg(p,Math.max(y,u)),alignment:u}}function Yg(v,u){return Math.ceil(v/u)*u}class fc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const y=this.length;return this.resize(y+1),this.emplace(y,u,p)}emplace(u,p,y){const T=2*u;return this.int16[T+0]=p,this.int16[T+1]=y,u}}fc.prototype.bytesPerElement=4,Nn(fc,"StructArrayLayout2i4");class xd extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,u,p,y)}emplace(u,p,y,T){const b=3*u;return this.int16[b+0]=p,this.int16[b+1]=y,this.int16[b+2]=T,u}}xd.prototype.bytesPerElement=6,Nn(xd,"StructArrayLayout3i6");class to extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y,T){const b=this.length;return this.resize(b+1),this.emplace(b,u,p,y,T)}emplace(u,p,y,T,b){const M=4*u;return this.int16[M+0]=p,this.int16[M+1]=y,this.int16[M+2]=T,this.int16[M+3]=b,u}}to.prototype.bytesPerElement=8,Nn(to,"StructArrayLayout4i8");class pc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b){const M=this.length;return this.resize(M+1),this.emplace(M,u,p,y,T,b)}emplace(u,p,y,T,b,M){const k=5*u;return this.int16[k+0]=p,this.int16[k+1]=y,this.int16[k+2]=T,this.int16[k+3]=b,this.int16[k+4]=M,u}}pc.prototype.bytesPerElement=10,Nn(pc,"StructArrayLayout5i10");class nl extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,y,T,b,M,k)}emplace(u,p,y,T,b,M,k,G){const W=6*u,R=12*u,z=3*u;return this.int16[W+0]=p,this.int16[W+1]=y,this.uint8[R+4]=T,this.uint8[R+5]=b,this.uint8[R+6]=M,this.uint8[R+7]=k,this.float32[z+2]=G,u}}nl.prototype.bytesPerElement=12,Nn(nl,"StructArrayLayout2i4ub1f12");class kl extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T){const b=this.length;return this.resize(b+1),this.emplace(b,u,p,y,T)}emplace(u,p,y,T,b){const M=4*u;return this.float32[M+0]=p,this.float32[M+1]=y,this.float32[M+2]=T,this.float32[M+3]=b,u}}kl.prototype.bytesPerElement=16,Nn(kl,"StructArrayLayout4f16");class fo extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,u,p,y)}emplace(u,p,y,T){const b=3*u;return this.float32[b+0]=p,this.float32[b+1]=y,this.float32[b+2]=T,u}}fo.prototype.bytesPerElement=12,Nn(fo,"StructArrayLayout3f12");class $c extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b){const M=this.length;return this.resize(M+1),this.emplace(M,u,p,y,T,b)}emplace(u,p,y,T,b,M){const k=6*u,G=3*u;return this.uint16[k+0]=p,this.uint16[k+1]=y,this.uint16[k+2]=T,this.uint16[k+3]=b,this.float32[G+2]=M,u}}$c.prototype.bytesPerElement=12,Nn($c,"StructArrayLayout4ui1f12");class Cu extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,y,T){const b=this.length;return this.resize(b+1),this.emplace(b,u,p,y,T)}emplace(u,p,y,T,b){const M=4*u;return this.uint16[M+0]=p,this.uint16[M+1]=y,this.uint16[M+2]=T,this.uint16[M+3]=b,u}}Cu.prototype.bytesPerElement=8,Nn(Cu,"StructArrayLayout4ui8");class zf extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M){const k=this.length;return this.resize(k+1),this.emplace(k,u,p,y,T,b,M)}emplace(u,p,y,T,b,M,k){const G=6*u;return this.int16[G+0]=p,this.int16[G+1]=y,this.int16[G+2]=T,this.int16[G+3]=b,this.int16[G+4]=M,this.int16[G+5]=k,u}}zf.prototype.bytesPerElement=12,Nn(zf,"StructArrayLayout6i12");class v_ extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k,G,W,R,z,j){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,y,T,b,M,k,G,W,R,z,j)}emplace(u,p,y,T,b,M,k,G,W,R,z,j,U){const V=12*u;return this.int16[V+0]=p,this.int16[V+1]=y,this.int16[V+2]=T,this.int16[V+3]=b,this.uint16[V+4]=M,this.uint16[V+5]=k,this.uint16[V+6]=G,this.uint16[V+7]=W,this.int16[V+8]=R,this.int16[V+9]=z,this.int16[V+10]=j,this.int16[V+11]=U,u}}v_.prototype.bytesPerElement=24,Nn(v_,"StructArrayLayout4i4ui4i24");class Xc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M){const k=this.length;return this.resize(k+1),this.emplace(k,u,p,y,T,b,M)}emplace(u,p,y,T,b,M,k){const G=10*u,W=5*u;return this.int16[G+0]=p,this.int16[G+1]=y,this.int16[G+2]=T,this.float32[W+2]=b,this.float32[W+3]=M,this.float32[W+4]=k,u}}Xc.prototype.bytesPerElement=20,Nn(Xc,"StructArrayLayout3i3f20");class Zg extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Zg.prototype.bytesPerElement=4,Nn(Zg,"StructArrayLayout1ul4");class Eu extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const y=this.length;return this.resize(y+1),this.emplace(y,u,p)}emplace(u,p,y){const T=2*u;return this.uint16[T+0]=p,this.uint16[T+1]=y,u}}Eu.prototype.bytesPerElement=4,Nn(Eu,"StructArrayLayout2ui4");class ah extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k,G,W,R,z,j,U){const V=this.length;return this.resize(V+1),this.emplace(V,u,p,y,T,b,M,k,G,W,R,z,j,U)}emplace(u,p,y,T,b,M,k,G,W,R,z,j,U,V){const X=20*u,Q=10*u;return this.int16[X+0]=p,this.int16[X+1]=y,this.int16[X+2]=T,this.int16[X+3]=b,this.int16[X+4]=M,this.float32[Q+3]=k,this.float32[Q+4]=G,this.float32[Q+5]=W,this.float32[Q+6]=R,this.int16[X+14]=z,this.uint32[Q+8]=j,this.uint16[X+18]=U,this.uint16[X+19]=V,u}}ah.prototype.bytesPerElement=40,Nn(ah,"StructArrayLayout5i4f1i1ul2ui40");class gl extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,y,T,b,M,k)}emplace(u,p,y,T,b,M,k,G){const W=8*u;return this.int16[W+0]=p,this.int16[W+1]=y,this.int16[W+2]=T,this.int16[W+4]=b,this.int16[W+5]=M,this.int16[W+6]=k,this.int16[W+7]=G,u}}gl.prototype.bytesPerElement=16,Nn(gl,"StructArrayLayout3i2i2i16");class Sa extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b){const M=this.length;return this.resize(M+1),this.emplace(M,u,p,y,T,b)}emplace(u,p,y,T,b,M){const k=4*u,G=8*u;return this.float32[k+0]=p,this.float32[k+1]=y,this.float32[k+2]=T,this.int16[G+6]=b,this.int16[G+7]=M,u}}Sa.prototype.bytesPerElement=16,Nn(Sa,"StructArrayLayout2f1f2i16");class bd extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M){const k=this.length;return this.resize(k+1),this.emplace(k,u,p,y,T,b,M)}emplace(u,p,y,T,b,M,k){const G=20*u,W=5*u;return this.uint8[G+0]=p,this.uint8[G+1]=y,this.float32[W+1]=T,this.float32[W+2]=b,this.float32[W+3]=M,this.float32[W+4]=k,u}}bd.prototype.bytesPerElement=20,Nn(bd,"StructArrayLayout2ub4f20");class To extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,u,p,y)}emplace(u,p,y,T){const b=3*u;return this.uint16[b+0]=p,this.uint16[b+1]=y,this.uint16[b+2]=T,u}}To.prototype.bytesPerElement=6,Nn(To,"StructArrayLayout3ui6");class Uf extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me){const ve=this.length;return this.resize(ve+1),this.emplace(ve,u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me)}emplace(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve){const Ce=30*u,ke=15*u,Fe=60*u;return this.int16[Ce+0]=p,this.int16[Ce+1]=y,this.int16[Ce+2]=T,this.float32[ke+2]=b,this.float32[ke+3]=M,this.uint16[Ce+8]=k,this.uint16[Ce+9]=G,this.uint32[ke+5]=W,this.uint32[ke+6]=R,this.uint32[ke+7]=z,this.uint16[Ce+16]=j,this.uint16[Ce+17]=U,this.uint16[Ce+18]=V,this.float32[ke+10]=X,this.float32[ke+11]=Q,this.uint8[Fe+48]=ne,this.uint8[Fe+49]=ue,this.uint8[Fe+50]=fe,this.uint32[ke+13]=ie,this.int16[Ce+28]=me,this.uint8[Fe+58]=ve,u}}Uf.prototype.bytesPerElement=60,Nn(Uf,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class __ extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut,dt,ft){const _t=this.length;return this.resize(_t+1),this.emplace(_t,u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut,dt,ft)}emplace(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne,ue,fe,ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut,dt,ft,_t){const It=20*u,xt=40*u,Vt=80*u;return this.float32[It+0]=p,this.float32[It+1]=y,this.int16[xt+4]=T,this.int16[xt+5]=b,this.int16[xt+6]=M,this.int16[xt+7]=k,this.int16[xt+8]=G,this.int16[xt+9]=W,this.int16[xt+10]=R,this.int16[xt+11]=z,this.int16[xt+12]=j,this.uint16[xt+13]=U,this.uint16[xt+14]=V,this.uint16[xt+15]=X,this.uint16[xt+16]=Q,this.uint16[xt+17]=ne,this.uint16[xt+18]=ue,this.uint16[xt+19]=fe,this.uint16[xt+20]=ie,this.uint16[xt+21]=me,this.uint16[xt+22]=ve,this.uint16[xt+23]=Ce,this.uint16[xt+24]=ke,this.uint16[xt+25]=Fe,this.uint16[xt+26]=Le,this.uint16[xt+27]=Ke,this.uint32[It+14]=Ve,this.float32[It+15]=et,this.float32[It+16]=ut,this.float32[It+17]=dt,this.float32[It+18]=ft,this.uint8[Vt+76]=_t,u}}__.prototype.bytesPerElement=80,Nn(__,"StructArrayLayout2f9i15ui1ul4f1ub80");class Gf extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}Gf.prototype.bytesPerElement=4,Nn(Gf,"StructArrayLayout1f4");class qc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b){const M=this.length;return this.resize(M+1),this.emplace(M,u,p,y,T,b)}emplace(u,p,y,T,b,M){const k=5*u;return this.float32[k+0]=p,this.float32[k+1]=y,this.float32[k+2]=T,this.float32[k+3]=b,this.float32[k+4]=M,u}}qc.prototype.bytesPerElement=20,Nn(qc,"StructArrayLayout5f20");class Kg extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,y,T,b,M,k)}emplace(u,p,y,T,b,M,k,G){const W=7*u;return this.float32[W+0]=p,this.float32[W+1]=y,this.float32[W+2]=T,this.float32[W+3]=b,this.float32[W+4]=M,this.float32[W+5]=k,this.float32[W+6]=G,u}}Kg.prototype.bytesPerElement=28,Nn(Kg,"StructArrayLayout7f28");class mc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,y,T){const b=this.length;return this.resize(b+1),this.emplace(b,u,p,y,T)}emplace(u,p,y,T,b){const M=6*u;return this.uint32[3*u+0]=p,this.uint16[M+2]=y,this.uint16[M+3]=T,this.uint16[M+4]=b,u}}mc.prototype.bytesPerElement=12,Nn(mc,"StructArrayLayout1ul3ui12");class y_ extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}y_.prototype.bytesPerElement=2,Nn(y_,"StructArrayLayout1ui2");class gc extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const y=this.length;return this.resize(y+1),this.emplace(y,u,p)}emplace(u,p,y){const T=2*u;return this.float32[T+0]=p,this.float32[T+1]=y,u}}gc.prototype.bytesPerElement=8,Nn(gc,"StructArrayLayout2f8");class Vf extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q){const ne=this.length;return this.resize(ne+1),this.emplace(ne,u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q)}emplace(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne){const ue=16*u;return this.float32[ue+0]=p,this.float32[ue+1]=y,this.float32[ue+2]=T,this.float32[ue+3]=b,this.float32[ue+4]=M,this.float32[ue+5]=k,this.float32[ue+6]=G,this.float32[ue+7]=W,this.float32[ue+8]=R,this.float32[ue+9]=z,this.float32[ue+10]=j,this.float32[ue+11]=U,this.float32[ue+12]=V,this.float32[ue+13]=X,this.float32[ue+14]=Q,this.float32[ue+15]=ne,u}}Vf.prototype.bytesPerElement=64,Nn(Vf,"StructArrayLayout16f64");class da extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,y,T,b,M,k){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,y,T,b,M,k)}emplace(u,p,y,T,b,M,k,G){const W=10*u,R=5*u;return this.uint16[W+0]=p,this.uint16[W+1]=y,this.uint16[W+2]=T,this.uint16[W+3]=b,this.float32[R+2]=M,this.float32[R+3]=k,this.float32[R+4]=G,u}}da.prototype.bytesPerElement=20,Nn(da,"StructArrayLayout4ui3f20");class Jg extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.int16[1*u+0]=p,u}}Jg.prototype.bytesPerElement=2,Nn(Jg,"StructArrayLayout1i2");class um extends Ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint8[1*u+0]=p,u}}um.prototype.bytesPerElement=1,Nn(um,"StructArrayLayout1ub1");class Jx extends Bl{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Jx.prototype.size=40;class Qg extends ah{get(u){return new Jx(this,u)}}Nn(Qg,"CollisionBoxArray");class Hf extends Bl{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(u){this._structArray.uint8[this._pos1+49]=u}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(u){this._structArray.uint8[this._pos1+50]=u}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(u){this._structArray.uint32[this._pos4+13]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(u){this._structArray.uint8[this._pos1+58]=u}}Hf.prototype.size=60;class ev extends Uf{get(u){return new Hf(this,u)}}Nn(ev,"PlacedSymbolArray");class Qx extends Bl{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(u){this._structArray.uint32[this._pos4+14]=u}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(u){this._structArray.float32[this._pos4+18]=u}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Qx.prototype.size=80;class rl extends __{get(u){return new Qx(this,u)}}Nn(rl,"SymbolInstanceArray");class tv extends Gf{getoffsetX(u){return this.float32[1*u+0]}}Nn(tv,"GlyphOffsetArray");class nv extends fc{getx(u){return this.int16[2*u+0]}gety(u){return this.int16[2*u+1]}}Nn(nv,"SymbolLineVertexArray");class Iu extends Bl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Iu.prototype.size=12;class hm extends mc{get(u){return new Iu(this,u)}}Nn(hm,"FeatureIndexArray");class lh extends Eu{geta_centroid_pos0(u){return this.uint16[2*u+0]}geta_centroid_pos1(u){return this.uint16[2*u+1]}}Nn(lh,"FillExtrusionCentroidArray");class dm extends Bl{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}dm.prototype.size=6;class fm extends xd{get(u){return new dm(this,u)}}Nn(fm,"FillExtrusionWallArray");const x_=ti([{name:"a_pos",components:2,type:"Int16"}],4),nS=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class As{constructor(u=[]){this.segments=u}_prepareSegment(u,p,y,T){let b=this.segments[this.segments.length-1];return u>As.MAX_VERTEX_ARRAY_LENGTH&&Bt(`Max vertices per segment is ${As.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!b||b.vertexLength+u>As.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==T)&&(b={vertexOffset:p,primitiveOffset:y,vertexLength:0,primitiveLength:0},T!==void 0&&(b.sortKey=T),this.segments.push(b)),b}prepareSegment(u,p,y,T){return this._prepareSegment(u,p.length,y.length,T)}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,y,T){return new As([{vertexOffset:u,primitiveOffset:p,vertexLength:y,primitiveLength:T,vaos:{},sortKey:0}])}}function b_(v,u){return 256*(v=Wt(Math.floor(v),0,255))+Wt(Math.floor(u),0,255)}As.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn(As,"SegmentVector");const e1=ti([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),t1=ti([{name:"a_dash",components:4,type:"Uint16"}]);class wd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(u,p,y,T){this.ids.push(n1(u)),this.positions.push(p,y,T)}eachPosition(u,p){const y=n1(u);let T=0,b=this.ids.length-1;for(;T<b;){const M=T+b>>1;this.ids[M]>=y?b=M:T=M+1}for(;this.ids[T]===y;)p(this.positions[3*T],this.positions[3*T+1],this.positions[3*T+2]),T++}static serialize(u,p){const y=new Float64Array(u.ids),T=new Uint32Array(u.positions);return jf(y,T,0,y.length-1),p&&(p.add(y.buffer),p.add(T.buffer)),{ids:y,positions:T}}static deserialize(u){const p=new wd;let y;p.ids=u.ids,p.positions=u.positions;for(const T of p.ids)T!==y&&p.uniqueIds.push(T),y=T;return p.indexed=!0,p}}function n1(v){const u=+v;return!isNaN(u)&&Number.MIN_SAFE_INTEGER<=u&&u<=Number.MAX_SAFE_INTEGER?u:Zo(String(v))}function jf(v,u,p,y){for(;p<y;){const T=v[p+y>>1];let b=p-1,M=y+1;for(;;){do b++;while(v[b]<T);do M--;while(v[M]>T);if(b>=M)break;B(v,b,M),B(u,3*b,3*M),B(u,3*b+1,3*M+1),B(u,3*b+2,3*M+2)}M-p<y-M?(jf(v,u,p,M),p=M+1):(jf(v,u,M+1,y),y=M)}}function B(v,u,p){const y=v[u];v[u]=v[p],v[p]=y}Nn(wd,"FeaturePositionMap");class F{constructor(u){this.gl=u.gl,this.initialized=!1}fetchUniformLocation(u,p){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(u,p),this.initialized=!0),!!this.location}set(u,p,y){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class K extends F{constructor(u){super(u),this.current=0}set(u,p,y){this.fetchUniformLocation(u,p)&&this.current!==y&&(this.current=y,this.gl.uniform1i(this.location,y))}}class oe extends F{constructor(u){super(u),this.current=0}set(u,p,y){this.fetchUniformLocation(u,p)&&this.current!==y&&(this.current=y,this.gl.uniform1f(this.location,y))}}class ge extends F{constructor(u){super(u),this.current=[0,0]}set(u,p,y){this.fetchUniformLocation(u,p)&&(y[0]===this.current[0]&&y[1]===this.current[1]||(this.current=y,this.gl.uniform2f(this.location,y[0],y[1])))}}class Me extends F{constructor(u){super(u),this.current=[0,0,0]}set(u,p,y){this.fetchUniformLocation(u,p)&&(y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]||(this.current=y,this.gl.uniform3f(this.location,y[0],y[1],y[2])))}}class pt extends F{constructor(u){super(u),this.current=[0,0,0,0]}set(u,p,y){this.fetchUniformLocation(u,p)&&(y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]&&y[3]===this.current[3]||(this.current=y,this.gl.uniform4f(this.location,y[0],y[1],y[2],y[3])))}}class Nt extends F{constructor(u){super(u),this.current=_r.transparent.toRenderColor(null)}set(u,p,y){this.fetchUniformLocation(u,p)&&(y.r===this.current.r&&y.g===this.current.g&&y.b===this.current.b&&y.a===this.current.a||(this.current=y,this.gl.uniform4f(this.location,y.r,y.g,y.b,y.a)))}}const _n=new Float32Array(16);class $n extends F{constructor(u){super(u),this.current=_n}set(u,p,y){if(this.fetchUniformLocation(u,p)){if(y[12]!==this.current[12]||y[0]!==this.current[0])return this.current=y,void this.gl.uniformMatrix4fv(this.location,!1,y);for(let T=1;T<16;T++)if(y[T]!==this.current[T]){this.current=y,this.gl.uniformMatrix4fv(this.location,!1,y);break}}}}const wr=new Float32Array(9),ci=new Float32Array(4);class Gr extends F{constructor(u){super(u),this.current=ci}set(u,p,y){if(this.fetchUniformLocation(u,p)){for(let T=0;T<4;T++)if(y[T]!==this.current[T]){this.current=y,this.gl.uniformMatrix2fv(this.location,!1,y);break}}}}function vs(v){return[b_(255*v.r,255*v.g),b_(255*v.b,255*v.a)]}class Pr{constructor(u,p,y,T){this.value=u,this.uniformNames=p.map(b=>`u_${b}`),this.type=y,this.context=T}setUniform(u,p,y,T,b){const M=T.constantOr(this.value);p.set(u,b,M instanceof _r?M.toRenderColor(this.context.lut):M)}getBinding(u,p){return this.type==="color"?new Nt(u):new oe(u)}}class po{constructor(u,p){this.uniformNames=p.map(y=>`u_${y}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(u){this.pixelRatio=u.pixelRatio||1,this.pattern=u.tl.concat(u.br)}setUniform(u,p,y,T,b){const M=b==="u_pattern"||b==="u_dash"?this.pattern:b==="u_pixel_ratio"?this.pixelRatio:null;M&&p.set(u,b,M)}getBinding(u,p){return p==="u_pattern"||p==="u_dash"?new pt(u):new oe(u)}}class mo{constructor(u,p,y,T){this.expression=u,this.type=y,this.maxValue=0,this.paintVertexAttributes=p.map(b=>({name:`a_${b}`,type:"Float32",components:y==="color"?2:1,offset:0})),this.paintVertexArray=new T}populatePaintArray(u,p,y,T,b,M,k){const G=this.paintVertexArray.length,W=this.expression.evaluate(new gs(0,{brightness:M}),p,{},b,T,k);this.paintVertexArray.resize(u),this._setPaintValue(G,u,W,this.context)}updatePaintArray(u,p,y,T,b,M,k){const G=this.expression.evaluate({zoom:0,brightness:k},y,T,void 0,b);this._setPaintValue(u,p,G,this.context)}_setPaintValue(u,p,y,T){if(this.type==="color"){const b=vs(y.toRenderColor(T.lut));for(let M=u;M<p;M++)this.paintVertexArray.emplace(M,b[0],b[1])}else{for(let b=u;b<p;b++)this.paintVertexArray.emplace(b,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xt{constructor(u,p,y,T,b,M){this.expression=u,this.uniformNames=p.map(k=>`u_${k}_t`),this.type=y,this.useIntegerZoom=T,this.context=b,this.maxValue=0,this.paintVertexAttributes=p.map(k=>({name:`a_${k}`,type:"Float32",components:y==="color"?4:2,offset:0})),this.paintVertexArray=new M}populatePaintArray(u,p,y,T,b,M,k){const G=this.expression.evaluate(new gs(this.context.zoom,{brightness:M}),p,{},b,T,k),W=this.expression.evaluate(new gs(this.context.zoom+1,{brightness:M}),p,{},b,T,k),R=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(R,u,G,W,this.context)}updatePaintArray(u,p,y,T,b,M,k){const G=this.expression.evaluate({zoom:this.context.zoom,brightness:k},y,T,void 0,b),W=this.expression.evaluate({zoom:this.context.zoom+1,brightness:k},y,T,void 0,b);this._setPaintValue(u,p,G,W,this.context)}_setPaintValue(u,p,y,T,b){if(this.type==="color"){const M=vs(y.toRenderColor(b.lut)),k=vs(y.toRenderColor(b.lut));for(let G=u;G<p;G++)this.paintVertexArray.emplace(G,M[0],M[1],k[0],k[1])}else{for(let M=u;M<p;M++)this.paintVertexArray.emplace(M,y,T);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p,y,T,b){const M=this.useIntegerZoom?Math.floor(y.zoom):y.zoom,k=Wt(this.expression.interpolationFactor(M,this.context.zoom,this.context.zoom+1),0,1);p.set(u,b,k)}getBinding(u,p){return new oe(u)}}class Ut{constructor(u,p,y,T,b){this.expression=u,this.layerId=b,this.paintVertexAttributes=(y==="array"?t1:e1).members;for(let M=0;M<p.length;++M);this.paintVertexArray=new T}populatePaintArray(u,p,y,T){const b=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValues(b,u,p.patterns&&p.patterns[this.layerId],y)}updatePaintArray(u,p,y,T,b,M,k){this._setPaintValues(u,p,y.patterns&&y.patterns[this.layerId],M)}_setPaintValues(u,p,y,T){if(!T||!y)return;const b=T[y];if(!b)return;const{tl:M,br:k,pixelRatio:G}=b;for(let W=u;W<p;W++)this.paintVertexArray.emplace(W,M[0],M[1],k[0],k[1],G)}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class an{constructor(u,p,y=()=>!0){this.binders={},this._buffers=[],this.context=p;const T=[];for(const b in u.paint._values){const M=u.paint.get(b);if(!y(b)||!(M instanceof rh&&Qp(M.property.specification)))continue;const k=xi(b,u.type),G=M.value,W=M.property.specification.type,R=!!M.property.useIntegerZoom,z=b==="line-dasharray"||b.endsWith("pattern"),j=b==="line-dasharray"&&u.layout.get("line-cap").value.kind!=="constant";if(G.kind!=="constant"||j)if(G.kind==="source"||j||z){const U=w(b,W,"source");this.binders[b]=z?new Ut(G,k,W,U,u.id):new mo(G,k,W,U),T.push(`/a_${b}`)}else{const U=w(b,W,"composite");this.binders[b]=new Xt(G,k,W,R,p,U),T.push(`/z_${b}`)}else this.binders[b]=z?new po(G.value,k):new Pr(G.value,k,W,p),T.push(`/u_${b}`)}this.cacheKey=T.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof mo||p instanceof Xt?p.maxValue:0}populatePaintArrays(u,p,y,T,b,M,k){for(const G in this.binders){const W=this.binders[G];W.context=this.context,(W instanceof mo||W instanceof Xt||W instanceof Ut)&&W.populatePaintArray(u,p,y,T,b,M,k)}}setConstantPatternPositions(u){for(const p in this.binders){const y=this.binders[p];y instanceof po&&y.setConstantPatternPositions(u)}}updatePaintArrays(u,p,y,T,b,M,k,G){let W=!1;const R=Object.keys(u),z=R.length!==0,j=z?R:p.uniqueIds;this.context.lut=b.lut;for(const U in this.binders){const V=this.binders[U];if(V.context=this.context,(V instanceof mo||V instanceof Xt||V instanceof Ut)&&(V.expression.isStateDependent===!0||V.expression.isLightConstant===!1)){const X=b.paint.get(U);V.expression=X.value;for(const Q of j){const ne=u[Q.toString()];p.eachPosition(Q,(ue,fe,ie)=>{const me=T.feature(ue);V.updatePaintArray(fe,ie,me,ne,M,k,G)})}if(!z)for(const Q of y.uniqueIds){const ne=u[Q.toString()];y.eachPosition(Q,(ue,fe,ie)=>{const me=T.feature(ue);V.updatePaintArray(fe,ie,me,ne,M,k,G)})}W=!0}}return W}defines(){const u=[];for(const p in this.binders){const y=this.binders[p];(y instanceof Pr||y instanceof po)&&u.push(...y.uniformNames.map(T=>`#define HAS_UNIFORM_${T}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof mo||y instanceof Xt||y instanceof Ut)for(let T=0;T<y.paintVertexAttributes.length;T++)u.push(y.paintVertexAttributes[T].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof Pr||y instanceof po||y instanceof Xt)for(const T of y.uniformNames)u.push(T)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u){const p=[];for(const y in this.binders){const T=this.binders[y];if(T instanceof Pr||T instanceof po||T instanceof Xt)for(const b of T.uniformNames)p.push({name:b,property:y,binding:T.getBinding(u,b)})}return p}setUniforms(u,p,y,T,b){for(const{name:M,property:k,binding:G}of y)this.binders[k].setUniform(u,G,b,T.get(k),M)}updatePaintBuffers(){this._buffers=[];for(const u in this.binders){const p=this.binders[u];(p instanceof mo||p instanceof Xt||p instanceof Ut)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(u){for(const p in this.binders){const y=this.binders[p];(y instanceof mo||y instanceof Xt||y instanceof Ut)&&y.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof mo||p instanceof Xt||p instanceof Ut)&&p.destroy()}}}class ir{constructor(u,p,y=()=>!0){this.programConfigurations={};for(const T of u)this.programConfigurations[T.id]=new an(T,p,y);this.needsUpload=!1,this._featureMap=new wd,this._featureMapWithoutIds=new wd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(u,p,y,T,b,M,k,G){for(const W in this.programConfigurations)this.programConfigurations[W].populatePaintArrays(u,p,T,b,M,k,G);p.id!==void 0?this._featureMap.add(p.id,y,this._bufferOffset,u):(this._featureMapWithoutIds.add(this._idlessCounter,y,this._bufferOffset,u),this._idlessCounter+=1),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,y,T,b,M){for(const k of y)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(u,this._featureMap,this._featureMapWithoutIds,p,k,T,b,M||0)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}const Rr={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xi(v,u){return Rr[v]||[v.replace(`${u}-`,"").replace(/-/g,"_")]}const ui={"line-pattern":{source:$c,composite:$c},"fill-pattern":{source:$c,composite:$c},"fill-extrusion-pattern":{source:$c,composite:$c},"line-dasharray":{source:Cu,composite:Cu}},Vi={color:{source:gc,composite:kl},number:{source:Gf,composite:gc}};function w(v,u,p){const y=ui[v];return y&&y[p]||Vi[u][p]}Nn(Pr,"ConstantBinder"),Nn(po,"PatternConstantBinder"),Nn(mo,"SourceExpressionBinder"),Nn(Ut,"PatternCompositeBinder"),Nn(Xt,"CompositeExpressionBinder"),Nn(an,"ProgramConfiguration",{omit:["_buffers"]}),Nn(ir,"ProgramConfigurationSet");const h=xn/Math.PI/2,g=5,S=6,P=16383,D=64,N=[D,32,16],$=-h,Y=h;function ee(v,u,p,y=h){return p=on(p),[v*Math.sin(p)*y,-u*y,v*Math.cos(p)*y]}function te(v,u,p){return ee(Math.cos(on(v)),Math.sin(on(v)),u,p)}const le=63710088e-1,ce=2*Math.PI*le;class de{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new de(Gn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,y=this.lat*p,T=u.lat*p,b=Math.sin(y)*Math.sin(T)+Math.cos(y)*Math.cos(T)*Math.cos((u.lng-this.lng)*p);return le*Math.acos(Math.min(b,1))}toBounds(u=0){const p=360*u/40075017,y=p/Math.cos(Math.PI/180*this.lat);return new xe({lng:this.lng-y,lat:this.lat-p},{lng:this.lng+y,lat:this.lat+p})}toEcef(u){return te(this.lat,this.lng,h+u*h/le)}static convert(u){if(u instanceof de)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new de(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new de(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class xe{constructor(u,p){if(u)if(p)this.setSouthWest(u).setNorthEast(p);else if(u.length===4){const y=u;this.setSouthWest([y[0],y[1]]).setNorthEast([y[2],y[3]])}else{const y=u;this.setSouthWest(y[0]).setNorthEast(y[1])}}setNorthEast(u){return this._ne=u instanceof de?new de(u.lng,u.lat):de.convert(u),this}setSouthWest(u){return this._sw=u instanceof de?new de(u.lng,u.lat):de.convert(u),this}extend(u){const p=this._sw,y=this._ne;let T,b;if(u instanceof de)T=u,b=u;else{if(!(u instanceof xe))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(xe.convert(u)):this.extend(de.convert(u)):typeof u=="object"&&u!==null&&u.hasOwnProperty("lat")&&(u.hasOwnProperty("lon")||u.hasOwnProperty("lng"))?this.extend(de.convert(u)):this;if(T=u._sw,b=u._ne,!T||!b)return this}return p||y?(p.lng=Math.min(T.lng,p.lng),p.lat=Math.min(T.lat,p.lat),y.lng=Math.max(b.lng,y.lng),y.lat=Math.max(b.lat,y.lat)):(this._sw=new de(T.lng,T.lat),this._ne=new de(b.lng,b.lat)),this}getCenter(){return new de((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new de(this.getWest(),this.getNorth())}getSouthEast(){return new de(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:p,lat:y}=de.convert(u);let T=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&T}static convert(u){if(u)return u instanceof xe?u:new xe(u)}}const be=0,Se=25.5;function Te(v){return ce*Math.cos(v*Math.PI/180)}function Oe(v){return(180+v)/360}function Ge(v){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+v*Math.PI/360)))/360}function Be(v,u){return v/Te(u)}function Xe(v){return 360*v-180}function $e(v){return 360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90}function tt(v,u){return v*Te($e(u))}const Je=85.051129;function nt(v){return Math.cos(on(Wt(v,-Je,Je)))}function ht(v,u){const p=Wt(u,be,Se),y=Math.pow(2,p);return nt(v)*ce/(512*y)}function at(v){return 1/Math.cos(v*Math.PI/180)}function st(v,u=0){const p=Math.exp(Math.PI*(1-(v.y+u/xn)/(1<<v.z)*2));return 80150034*p/(p*p+1)/xn/(1<<v.z)}class wt{constructor(u,p,y=0){this.x=+u,this.y=+p,this.z=+y}static fromLngLat(u,p=0){const y=de.convert(u);return new wt(Oe(y.lng),Ge(y.lat),Be(p,y.lat))}toLngLat(){return new de(Xe(this.x),$e(this.y))}toAltitude(){return tt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ce*at($e(this.y))}}function zt(v,u,p,y,T,b,M,k,G){const W=(u+y)/2,R=(p+T)/2,z=new At(W,R);k(z),function(j,U,V,X,Q,ne){const ue=V-Q,fe=X-ne;return Math.abs((X-U)*ue-(V-j)*fe)/Math.hypot(ue,fe)}(z.x,z.y,b.x,b.y,M.x,M.y)>=G?(zt(v,u,p,W,R,b,z,k,G),zt(v,W,R,y,T,z,M,k,G)):v.push(M)}function Zt(v,u,p){let y=v[0],T=y.x,b=y.y;u(y);const M=[y];for(let k=1;k<v.length;k++){const G=v[k],{x:W,y:R}=G;u(G),zt(M,T,b,W,R,y,G,u,p),T=W,b=R,y=G}return M}function Ft(v,u,p,y){if(y(u,p)){const T=u.add(p)._mult(.5);Ft(v,u,T,y),Ft(v,T,p,y)}else v.push(p)}function dn(v,u){let p=v[0];const y=[p];for(let T=1;T<v.length;T++){const b=v[T];Ft(y,p,b,u),p=b}return y}const St=Math.pow(2,14)-1,$t=-St-1;function Ht(v,u){const p=Math.round(v.x*u),y=Math.round(v.y*u);return v.x=Wt(p,$t,St),v.y=Wt(y,$t,St),(p<v.x||p>v.x+1||y<v.y||y>v.y+1)&&Bt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),v}function fn(v,u,p){const y=v.loadGeometry(),T=v.extent,b=xn/T;if(u&&p&&p.projection.isReprojectedInTileSpace){const M=1<<u.z,{scale:k,x:G,y:W,projection:R}=p,z=j=>{const U=Xe((u.x+j.x/T)/M),V=$e((u.y+j.y/T)/M),X=R.project(U,V);j.x=(X.x*k-G)*T,j.y=(X.y*k-W)*T};for(let j=0;j<y.length;j++)if(v.type!==1)y[j]=Zt(y[j],z,1);else{const U=[];for(const V of y[j])V.x<0||V.x>=T||V.y<0||V.y>=T||(z(V),U.push(V));y[j]=U}}for(const M of y)for(const k of M)Ht(k,b);return y}function mn(v,u){return{type:v.type,id:v.id,properties:v.properties,geometry:u?fn(v):[]}}function Yt(v,u,p,y,T){v.emplaceBack(2*u+(y+1)/2,2*p+(T+1)/2)}function tn(v,u,p){v.emplaceBack(u.x,u.y,u.z,p[0]*16384,p[1]*16384,p[2]*16384)}class tr{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=u.index,this.hasPattern=!1,this.projection=u.projection,this.layoutVertexArray=new fc,this.indexArray=new To,this.segments=new As,this.programConfigurations=new ir(u.layers,{zoom:u.zoom,lut:u.lut}),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}updateFootprints(u,p){}populate(u,p,y,T){const b=this.layers[0],M=[];let k=null;b.type==="circle"&&(k=b.layout.get("circle-sort-key"));for(const{feature:W,id:R,index:z,sourceLayerIndex:j}of u){const U=this.layers[0]._featureFilter.needGeometry,V=mn(W,U);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),V,y))continue;const X=k?k.evaluate(V,{},y):void 0,Q={id:R,properties:W.properties,type:W.type,sourceLayerIndex:j,index:z,geometry:U?V.geometry:fn(W,y,T),patterns:{},sortKey:X};M.push(Q)}k&&M.sort((W,R)=>W.sortKey-R.sortKey);let G=null;T.projection.name==="globe"&&(this.globeExtVertexArray=new zf,G=T.projection);for(const W of M){const{geometry:R,index:z,sourceLayerIndex:j}=W,U=u[z].feature;this.addFeature(W,R,z,p.availableImages,y,G,p.brightness),p.featureIndex.insert(U,R,z,j,this.index)}}update(u,p,y,T,b){const M=Object.keys(u).length!==0;M&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(u,p,M?this.stateDependentLayers:this.layers,y,T,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,x_.members),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=u.createVertexBuffer(this.globeExtVertexArray,nS.members))),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(u,p,y,T,b,M,k){for(const G of p)for(const W of G){const R=W.x,z=W.y;if(R<0||R>=xn||z<0||z>=xn)continue;if(M){const V=M.projectTilePoint(R,z,b),X=M.upVector(b,R,z),Q=this.globeExtVertexArray;tn(Q,V,X),tn(Q,V,X),tn(Q,V,X),tn(Q,V,X)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),U=j.vertexLength;Yt(this.layoutVertexArray,R,z,-1,-1),Yt(this.layoutVertexArray,R,z,1,-1),Yt(this.layoutVertexArray,R,z,1,1),Yt(this.layoutVertexArray,R,z,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,y,{},T,b,k)}}function bn(v,u){for(let p=0;p<v.length;p++)if(as(u,v[p]))return!0;for(let p=0;p<u.length;p++)if(as(v,u[p]))return!0;return!!hr(v,u)}function Bn(v,u,p){return!!as(v,u)||!!kr(u,v,p)}function xr(v,u){if(v.length===1)return Hi(u,v[0]);for(let p=0;p<u.length;p++){const y=u[p];for(let T=0;T<y.length;T++)if(as(v,y[T]))return!0}for(let p=0;p<v.length;p++)if(Hi(u,v[p]))return!0;for(let p=0;p<u.length;p++)if(hr(v,u[p]))return!0;return!1}function Yn(v,u,p){if(v.length>1){if(hr(v,u))return!0;for(let y=0;y<u.length;y++)if(kr(u[y],v,p))return!0}for(let y=0;y<v.length;y++)if(kr(v[y],u,p))return!0;return!1}function hr(v,u){if(v.length===0||u.length===0)return!1;for(let p=0;p<v.length-1;p++){const y=v[p],T=v[p+1];for(let b=0;b<u.length-1;b++)if(Vr(y,T,u[b],u[b+1]))return!0}return!1}function Vr(v,u,p,y){return Jt(v,p,y)!==Jt(u,p,y)&&Jt(v,u,p)!==Jt(v,u,y)}function kr(v,u,p){const y=p*p;if(u.length===1)return v.distSqr(u[0])<y;for(let T=1;T<u.length;T++)if(Ri(v,u[T-1],u[T])<y)return!0;return!1}function Ri(v,u,p){const y=u.distSqr(p);if(y===0)return v.distSqr(u);const T=((v.x-u.x)*(p.x-u.x)+(v.y-u.y)*(p.y-u.y))/y;return v.distSqr(T<0?u:T>1?p:p.sub(u)._mult(T)._add(u))}function Hi(v,u){let p,y,T,b=!1;for(let M=0;M<v.length;M++){p=v[M];for(let k=0,G=p.length-1;k<p.length;G=k++)y=p[k],T=p[G],y.y>u.y!=T.y>u.y&&u.x<(T.x-y.x)*(u.y-y.y)/(T.y-y.y)+y.x&&(b=!b)}return b}function as(v,u){let p=!1;for(let y=0,T=v.length-1;y<v.length;T=y++){const b=v[y],M=v[T];b.y>u.y!=M.y>u.y&&u.x<(M.x-b.x)*(u.y-b.y)/(M.y-b.y)+b.x&&(p=!p)}return p}function Yc(v,u,p,y,T){for(const M of v)if(u<=M.x&&p<=M.y&&y>=M.x&&T>=M.y)return!0;const b=[new At(u,p),new At(u,T),new At(y,T),new At(y,p)];if(v.length>2){for(const M of b)if(as(v,M))return!0}for(let M=0;M<v.length-1;M++)if(no(v[M],v[M+1],b))return!0;return!1}function no(v,u,p){const y=p[0],T=p[2];if(v.x<y.x&&u.x<y.x||v.x>T.x&&u.x>T.x||v.y<y.y&&u.y<y.y||v.y>T.y&&u.y>T.y)return!1;const b=Jt(v,u,p[0]);return b!==Jt(v,u,p[1])||b!==Jt(v,u,p[2])||b!==Jt(v,u,p[3])}function Jr(v,u,p,y,T,b){let M=u.y-v.y,k=v.x-u.x;if(b=b||0){const G=M*M+k*k;if(G===0)return!0;const W=Math.sqrt(G);M/=W,k/=W}return!((p.x-v.x)*M+(p.y-v.y)*k-b<0||(y.x-v.x)*M+(y.y-v.y)*k-b<0||(T.x-v.x)*M+(T.y-v.y)*k-b<0)}function Gi(v,u,p,y,T,b,M){return!(Jr(v,u,y,T,b,M)||Jr(u,p,y,T,b,M)||Jr(p,v,y,T,b,M)||Jr(y,T,v,u,p,M)||Jr(T,b,v,u,p,M)||Jr(b,y,v,u,p,M))}function Ts(v,u,p){const y=u.paint.get(v).value;return y.kind==="constant"?y.value:p.programConfigurations.get(u.id).getMaxValue(v)}function Oi(v){return Math.sqrt(v[0]*v[0]+v[1]*v[1])}function Fr(v,u,p,y,T){if(!u[0]&&!u[1])return v;const b=At.convert(u)._mult(T);p==="viewport"&&b._rotate(-y);const M=[];for(let k=0;k<v.length;k++)M.push(v[k].sub(b));return M}function gi(v,u,p,y){const T=At.convert(v)._mult(y);return u==="viewport"&&T._rotate(-p),T}let Ei,Gs;Nn(tr,"CircleBucket",{omit:["layers"]});var ro,li={exports:{}},Uo=(ro||(ro=1,function(v,u){(function(p){function y(b,M,k){var G=T(256*b,256*(M=Math.pow(2,k)-M-1),k),W=T(256*(b+1),256*(M+1),k);return G[0]+","+G[1]+","+W[0]+","+W[1]}function T(b,M,k){var G=2*Math.PI*6378137/256/Math.pow(2,k);return[b*G-2*Math.PI*6378137/2,M*G-2*Math.PI*6378137/2]}p.getURL=function(b,M,k,G,W,R){return R=R||{},b+"?"+["bbox="+y(k,G,W),"format="+(R.format||"image/png"),"service="+(R.service||"WMS"),"version="+(R.version||"1.1.1"),"request="+(R.request||"GetMap"),"srs="+(R.srs||"EPSG:3857"),"width="+(R.width||256),"height="+(R.height||256),"layers="+M].join("&")},p.getTileBBox=y,p.getMercCoords=T,Object.defineProperty(p,"__esModule",{value:!0})})(u)}(0,li.exports)),li.exports);class ea{constructor(u,p,y){this.z=u,this.x=p,this.y=y,this.key=vl(0,u,u,p,y)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p){const y=Uo.getTileBBox(this.x,this.y,this.z),T=function(b,M,k){let G,W="";for(let R=b;R>0;R--)G=1<<R-1,W+=(M&G?1:0)+(k&G?2:0);return W}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",y)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Go{constructor(u,p){this.wrap=u,this.canonical=p,this.key=vl(u,p.z,p.z,p.x,p.y)}}class es{constructor(u,p,y,T,b){this.overscaledZ=u,this.wrap=p,this.canonical=new ea(y,+T,+b),this.key=p===0&&u===y?this.canonical.key:vl(p,u,y,T,b)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){const p=this.canonical.z-u;return u>this.canonical.z?new es(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new es(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p=!0){if(this.overscaledZ===u&&p)return this.key;if(u>this.canonical.z)return vl(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y);{const y=this.canonical.z-u;return vl(this.wrap*+p,u,u,this.canonical.x>>y,this.canonical.y>>y)}}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.z<this.canonical.z&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new es(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,y=2*this.canonical.x,T=2*this.canonical.y;return[new es(p,this.wrap,p,y,T),new es(p,this.wrap,p,y+1,T),new es(p,this.wrap,p,y,T+1),new es(p,this.wrap,p,y+1,T+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new es(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new es(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Go(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function vl(v,u,p,y,T){const b=1<<Math.min(p,22);let M=b*(T%b)+y%b;return v&&p<22&&(M+=b*b*((v<0?-2*v-1:2*v)%(1<<2*(22-p)))),16*(32*M+p)+(u-p)}const _l=[v=>{let u=v.canonical.x-1,p=v.wrap;return u<0&&(u=(1<<v.canonical.z)-1,p--),new es(v.overscaledZ,p,v.canonical.z,u,v.canonical.y)},v=>{let u=v.canonical.x+1,p=v.wrap;return u===1<<v.canonical.z&&(u=0,p++),new es(v.overscaledZ,p,v.canonical.z,u,v.canonical.y)},v=>new es(v.overscaledZ,v.wrap,v.canonical.z,v.canonical.x,(v.canonical.y===0?1<<v.canonical.z:v.canonical.y)-1),v=>new es(v.overscaledZ,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y===(1<<v.canonical.z)-1?0:v.canonical.y+1)];Nn(ea,"CanonicalTileID"),Nn(es,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Zc=ti([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:vc}=Zc,Ol=ti([{name:"a_pos_3",components:3,type:"Int16"}]);var Kc=ti([{name:"a_pos",type:"Int16",components:2}]);class Sd{constructor(u,p){this.pos=u,this.dir=p}intersectsPlane(u,p,y){const T=De.vec3.dot(p,this.dir);if(Math.abs(T)<1e-6)return!1;const b=((u[0]-this.pos[0])*p[0]+(u[1]-this.pos[1])*p[1]+(u[2]-this.pos[2])*p[2])/T;return y[0]=this.pos[0]+this.dir[0]*b,y[1]=this.pos[1]+this.dir[1]*b,y[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(u,p,y){if(De.vec3.equals(this.pos,u)||p===0)return y[0]=y[1]=y[2]=0,!1;const[T,b,M]=this.dir,k=this.pos[0]-u[0],G=this.pos[1]-u[1],W=this.pos[2]-u[2],R=T*T+b*b+M*M,z=2*(k*T+G*b+W*M),j=z*z-4*R*(k*k+G*G+W*W-p*p);if(j<0){const U=Math.max(-z/2,0),V=k+T*U,X=G+b*U,Q=W+M*U,ne=Math.hypot(V,X,Q);return y[0]=V*p/ne,y[1]=X*p/ne,y[2]=Q*p/ne,!1}{const U=(-z-Math.sqrt(j))/(2*R);if(U<0){const V=Math.hypot(k,G,W);return y[0]=k*p/V,y[1]=G*p/V,y[2]=W*p/V,!1}return y[0]=k+T*U,y[1]=G+b*U,y[2]=W+M*U,!0}}}class Wf{constructor(u,p,y,T,b){this.TL=u,this.TR=p,this.BR=y,this.BL=T,this.horizon=b}static fromInvProjectionMatrix(u,p,y){const T=[-1,1,1],b=[1,1,1],M=[1,-1,1],k=[-1,-1,1],G=De.vec3.transformMat4(T,T,u),W=De.vec3.transformMat4(b,b,u),R=De.vec3.transformMat4(M,M,u),z=De.vec3.transformMat4(k,k,u);return new Wf(G,W,R,z,p/y)}}function ch(v,u,p){let y=1/0,T=-1/0;const b=[];for(const M of v){De.vec3.sub(b,M,u);const k=De.vec3.dot(b,p);y=Math.min(y,k),T=Math.max(T,k)}return[y,T]}function rv(v,u){let p=!0;for(let y=0;y<v.planes.length;y++){const T=v.planes[y];let b=0;for(let M=0;M<u.length;M++)b+=De.vec3.dot(T,u[M])+T[3]>=0;if(b===0)return 0;b!==u.length&&(p=!1)}return p?2:1}function iv(v,u){for(const p of v.projections){const y=ch(u,v.points[0],p.axis);if(p.projection[1]<y[0]||p.projection[0]>y[1])return 0}return 1}function r1(v,u){let p=0;const y=[0,0,0,0];for(let T=0;T<v.length;T++)y[0]=v[T][0],y[1]=v[T][1],y[2]=v[T][2],y[3]=1,De.vec4.dot(y,u)>=0&&p++;return p}class sv{constructor(u,p){this.points=u||new Array(8).fill([0,0,0]),this.planes=p||new Array(6).fill([0,0,0,0]),this.bounds=ts.fromPoints(this.points),this.projections=[],this.frustumEdges=[De.vec3.sub([],this.points[2],this.points[3]),De.vec3.sub([],this.points[0],this.points[3]),De.vec3.sub([],this.points[4],this.points[0]),De.vec3.sub([],this.points[5],this.points[1]),De.vec3.sub([],this.points[6],this.points[2]),De.vec3.sub([],this.points[7],this.points[3])];for(const y of this.frustumEdges){const T=[0,-y[2],y[1]],b=[y[2],0,-y[0]];this.projections.push({axis:T,projection:ch(this.points,this.points[0],T)}),this.projections.push({axis:b,projection:ch(this.points,this.points[0],b)})}}static fromInvProjectionMatrix(u,p,y,T){const b=Math.pow(2,y),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(W=>{const R=De.vec4.transformMat4([],W,u),z=1/R[3]/p*b;return De.vec4.mul(R,R,[z,z,T?1/R[3]:z,z])}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(W=>{const R=De.vec3.sub([],M[W[0]],M[W[1]]),z=De.vec3.sub([],M[W[2]],M[W[1]]),j=De.vec3.normalize([],De.vec3.cross([],R,z)),U=-De.vec3.dot(j,M[W[1]]);return j.concat(U)}),G=[];for(let W=0;W<M.length;W++)G.push([M[W][0],M[W][1],M[W][2]]);return new sv(G,k)}intersectsPrecise(u,p,y){for(let T=0;T<p.length;T++)if(!r1(u,p[T]))return 0;for(let T=0;T<this.planes.length;T++)if(!r1(u,this.planes[T]))return 0;for(const T of y)for(const b of this.frustumEdges){const M=De.vec3.cross([],T,b),k=De.vec3.length(M);if(k===0)continue;De.vec3.scale(M,M,1/k);const G=ch(this.points,this.points[0],M),W=ch(u,this.points[0],M);if(G[0]>W[1]||W[0]>G[1])return 0}return 1}containsPoint(u){for(const p of this.planes){const y=p[3];if(De.vec3.dot([p[0],p[1],p[2]],u)+y<0)return!1}return!0}}class ts{static fromPoints(u){const p=[1/0,1/0,1/0],y=[-1/0,-1/0,-1/0];for(const T of u)De.vec3.min(p,p,T),De.vec3.max(y,y,T);return new ts(p,y)}static fromTileIdAndHeight(u,p,y){const T=1<<u.canonical.z,b=u.canonical.x,M=u.canonical.y;return new ts([b/T,M/T,p],[(b+1)/T,(M+1)/T,y])}static applyTransform(u,p){const y=u.getCorners();for(let T=0;T<y.length;++T)De.vec3.transformMat4(y[T],y[T],p);return ts.fromPoints(y)}static applyTransformFast(u,p){const y=[p[12],p[13],p[14]],T=[...y];for(let b=0;b<3;b++)for(let M=0;M<3;M++){const k=p[4*M+b],G=k*u.min[M],W=k*u.max[M];y[b]+=Math.min(G,W),T[b]+=Math.max(G,W)}return new ts(y,T)}static projectAabbCorners(u,p){const y=u.getCorners();for(let T=0;T<y.length;++T)De.vec3.transformMat4(y[T],y[T],p);return y}constructor(u,p){this.min=u,this.max=p,this.center=De.vec3.scale([],De.vec3.add([],this.min,this.max),.5)}quadrant(u){const p=[u%2==0,u<2],y=De.vec3.clone(this.min),T=De.vec3.clone(this.max);for(let b=0;b<p.length;b++)y[b]=p[b]?this.min[b]:this.center[b],T[b]=p[b]?this.center[b]:this.max[b];return T[2]=this.max[2],new ts(y,T)}distanceX(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]}distanceY(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]}distanceZ(u){return Math.max(Math.min(this.max[2],u[2]),this.min[2])-u[2]}getCorners(){const u=this.min,p=this.max;return[[u[0],u[1],u[2]],[p[0],u[1],u[2]],[p[0],p[1],u[2]],[u[0],p[1],u[2]],[u[0],u[1],p[2]],[p[0],u[1],p[2]],[p[0],p[1],p[2]],[u[0],p[1],p[2]]]}intersects(u){return this.intersectsAabb(u.bounds)?rv(u,this.getCorners()):0}intersectsFlat(u){return this.intersectsAabb(u.bounds)?rv(u,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(u,p){return p||this.intersects(u)?iv(u,this.getCorners()):0}intersectsPreciseFlat(u,p){return p||this.intersectsFlat(u)?iv(u,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(u){for(let p=0;p<3;++p)if(this.min[p]>u.max[p]||u.min[p]>this.max[p])return!1;return!0}intersectsAabbXY(u){return!(this.min[0]>u.max[0]||u.min[0]>this.max[0]||this.min[1]>u.max[1]||u.min[1]>this.max[1])}encapsulate(u){for(let p=0;p<3;p++)this.min[p]=Math.min(this.min[p],u.min[p]),this.max[p]=Math.max(this.max[p],u.max[p])}encapsulatePoint(u){for(let p=0;p<3;p++)this.min[p]=Math.min(this.min[p],u[p]),this.max[p]=Math.max(this.max[p],u[p])}closestPoint(u){return[Math.max(Math.min(this.max[0],u[0]),this.min[0]),Math.max(Math.min(this.max[1],u[1]),this.min[1]),Math.max(Math.min(this.max[2],u[2]),this.min[2])]}}function pm(v){return v*h/le}Nn(ts,"Aabb");const rk=[new ts([$,$,$],[Y,Y,Y]),new ts([$,$,$],[0,0,Y]),new ts([0,$,$],[Y,0,Y]),new ts([$,0,$],[0,Y,Y]),new ts([0,0,$],[Y,Y,Y])];function qC(v,u,p,y=!0){const T=De.vec3.scale([],v._camera.position,v.worldSize),b=[u,p,1,1];De.vec4.transformMat4(b,b,v.pixelMatrixInverse),De.vec4.scale(b,b,1/b[3]);const M=De.vec3.sub([],b,T),k=De.vec3.normalize([],M),G=v.globeMatrix,W=[G[12],G[13],G[14]],R=De.vec3.sub([],W,T),z=De.vec3.length(R),j=De.vec3.normalize([],R),U=v.worldSize/(2*Math.PI),V=De.vec3.dot(j,k),X=Math.asin(U/z);if(X<Math.acos(V)){if(!y)return null;const Ke=[],Ve=[];De.vec3.scale(Ke,k,z/V),De.vec3.normalize(Ve,De.vec3.sub(Ve,Ke,R)),De.vec3.normalize(k,De.vec3.add(k,R,De.vec3.scale(k,Ve,Math.tan(X)*z)))}const Q=[];new Sd(T,k).closestPointOnSphere(W,U,Q);const ne=De.vec3.normalize([],fi(G,0)),ue=De.vec3.normalize([],fi(G,1)),fe=De.vec3.normalize([],fi(G,2)),ie=De.vec3.dot(ne,Q),me=De.vec3.dot(ue,Q),ve=De.vec3.dot(fe,Q),Ce=ct(Math.asin(-me/U));let ke=ct(Math.atan2(ie,ve));ke=v.center.lng+function(Ke,Ve){const et=(Ve-Ke+180)%360-180;return et<-180?et+360:et}(v.center.lng,ke);const Fe=Oe(ke),Le=Wt(Ge(Ce),0,1);return new wt(Fe,Le)}class Xhe{constructor(u,p,y){this.a=De.vec3.sub([],u,y),this.b=De.vec3.sub([],p,y),this.center=y;const T=De.vec3.normalize([],this.a),b=De.vec3.normalize([],this.b);this.angle=Math.acos(De.vec3.dot(T,b))}}function ik(v,u){if(v.angle===0)return null;let p;return p=v.a[u]===0?1/v.angle*.5*Math.PI:1/v.angle*Math.atan(v.b[u]/v.a[u]/Math.sin(v.angle)-1/Math.tan(v.angle)),p<0||p>1?null:function(y,T,b,M){const k=Math.sin(b);return y*(Math.sin((1-M)*b)/k)+T*(Math.sin(M*b)/k)}(v.a[u],v.b[u],v.angle,Wt(p,0,1))+v.center[u]}function $f(v){if(v.z<=1)return rk[v.z+2*v.y+v.x];const u=sk(YC(v));return ts.fromPoints(u)}function mm(v,u,p){return De.vec3.scale(v,v,1-p),De.vec3.scaleAndAdd(v,v,u,p)}function yV(v,u,p){for(const y of v)De.vec3.transformMat4(y,y,u),De.vec3.scale(y,y,p)}function xV(v,u,p,y){const T=u/v.worldSize,b=v.globeMatrix;if(p.z<=1){const Fe=$f(p).getCorners();return yV(Fe,b,T),ts.fromPoints(Fe)}const M=YC(p,y),k=sk(M,h+pm(v._tileCoverLift));yV(k,b,T);const G=Number.MAX_VALUE,W=[-G,-G,-G],R=[G,G,G];if(M.contains(v.center)){for(const Ke of k)De.vec3.min(R,R,Ke),De.vec3.max(W,W,Ke);W[2]=0;const Fe=v.point,Le=[Fe.x*T,Fe.y*T,0];return De.vec3.min(R,R,Le),De.vec3.max(W,W,Le),new ts(R,W)}if(v._tileCoverLift>0){for(const Fe of k)De.vec3.min(R,R,Fe),De.vec3.max(W,W,Fe);return new ts(R,W)}const z=[b[12]*T,b[13]*T,b[14]*T],j=M.getCenter(),U=Wt(v.center.lat,-Je,Je),V=Wt(j.lat,-Je,Je),X=Oe(v.center.lng),Q=Ge(U);let ne=X-Oe(j.lng);const ue=Q-Ge(V);ne>.5?ne-=1:ne<-.5&&(ne+=1);let fe=0;if(Math.abs(ne)>Math.abs(ue))fe=ne>=0?1:3;else{fe=ue>=0?0:2;const Fe=[b[4]*T,b[5]*T,b[6]*T],Le=-Math.sin(on(ue>=0?M.getSouth():M.getNorth()))*h;De.vec3.scaleAndAdd(z,z,Fe,Le)}const ie=k[fe],me=k[(fe+1)%4],ve=new Xhe(ie,me,z),Ce=[ik(ve,0)||ie[0],ik(ve,1)||ie[1],ik(ve,2)||ie[2]],ke=ov(v.zoom);if(ke>0){const Fe=function({x:Ke,y:Ve,z:et},ut,dt,ft,_t){const It=1/(1<<et);let xt=Ke*It,Vt=xt+It,Kt=Ve*It,kt=Kt+It,Rn=0;const wn=(xt+Vt)/2-ft;return wn>.5?Rn=-1:wn<-.5&&(Rn=1),xt=((xt+Rn)*ut-(ft*=ut))*dt+ft,Vt=((Vt+Rn)*ut-ft)*dt+ft,Kt=(Kt*ut-(_t*=ut))*dt+_t,kt=(kt*ut-_t)*dt+_t,[[xt,kt,0],[Vt,kt,0],[Vt,Kt,0],[xt,Kt,0]]}(p,u,v._pixelsPerMercatorPixel,X,Q);for(let Ke=0;Ke<k.length;Ke++)mm(k[Ke],Fe[Ke],ke);const Le=De.vec3.add([],Fe[fe],Fe[(fe+1)%4]);De.vec3.scale(Le,Le,.5),mm(Ce,Le,ke)}for(const Fe of k)De.vec3.min(R,R,Fe),De.vec3.max(W,W,Fe);return R[2]=Math.min(ie[2],me[2]),De.vec3.min(R,R,Ce),De.vec3.max(W,W,Ce),new ts(R,W)}function YC({x:v,y:u,z:p},y=!1){const T=1/(1<<p),b=new de(Xe(v*T),u===(1<<p)-1&&y?-90:$e((u+1)*T)),M=new de(Xe((v+1)*T),u===0&&y?90:$e(u*T));return new xe(b,M)}function sk(v,u=h){const p=on(v.getNorth()),y=on(v.getSouth()),T=Math.cos(p),b=Math.cos(y),M=Math.sin(p),k=Math.sin(y),G=v.getWest(),W=v.getEast();return[ee(b,k,G,u),ee(b,k,W,u),ee(T,M,W,u),ee(T,M,G,u)]}function rS(v,u,p,y){const T=1<<p.z,b=(v/xn+p.x)/T;return te($e((u/xn+p.y)/T),Xe(b),y)}function ZC({min:v,max:u}){return P/Math.max(u[0]-v[0],u[1]-v[1],u[2]-v[2])}const bV=new Float64Array(16);function KC(v){const u=ZC(v),p=De.mat4.fromScaling(bV,[u,u,u]);return De.mat4.translate(p,p,De.vec3.negate([],v.min))}function ok(v){const u=De.mat4.fromTranslation(bV,v.min),p=1/ZC(v);return De.mat4.scale(u,u,[p,p,p])}function ak(v){const u=xn/(2*Math.PI);return v/(2*Math.PI)/u}function wV(v,u){return xn/(512*Math.pow(2,v))*ZC($f(u))}function SV(v,u,p,y,T){const b=ak(p),M=[v,u,-p/(2*Math.PI)],k=De.mat4.identity(new Float64Array(16));return De.mat4.translate(k,k,M),De.mat4.scale(k,k,[b,b,b]),De.mat4.rotateX(k,k,on(-T)),De.mat4.rotateY(k,k,on(-y)),k}function ov(v){return gr(g,S,v)}function AV(v,u){const p=te(u.lat,u.lng),y=function(b){const M=te(b._center.lat,b._center.lng),k=De.vec3.fromValues(0,1,0);let G=De.vec3.cross([],k,M);const W=De.mat4.fromRotation([],-b.angle,M);G=De.vec3.transformMat4(G,G,W),De.mat4.fromRotation(W,-b._pitch,G);const R=De.vec3.normalize([],M);return De.vec3.scale(R,R,pm(b.cameraToCenterDistance/b.pixelsPerMeter)),De.vec3.transformMat4(R,R,W),De.vec3.add([],M,R)}(v),T=De.vec3.subtract([],y,p);return De.vec3.angle(T,p)}function lk(v,u){return AV(v,u)>Math.PI/2*1.01}const TV=on(85),qhe=Math.cos(TV),Yhe=Math.sin(TV),Zhe=De.mat4.create(),MV=v=>{const u=[];return v.paint.get("circle-pitch-alignment")==="map"&&u.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&u.push("SCALE_WITH_MAP"),u};function CV(v,u,p,y,T,b,M,k,G){if(b&&v.queryGeometry.isAboveHorizon)return!1;b&&(G*=v.pixelToTileUnitsFactor);const W=v.tileID.canonical,R=p.projection.upVectorScale(W,p.center.lat,p.worldSize).metersToTile;for(const z of u)for(const j of z){const U=j.add(k),V=T&&p.elevation?p.elevation.exaggeration()*T.getElevationAt(U.x,U.y,!0):0,X=p.projection.projectTilePoint(U.x,U.y,W);if(V>0){const fe=p.projection.upVector(W,U.x,U.y);X.x+=fe[0]*R*V,X.y+=fe[1]*R*V,X.z+=fe[2]*R*V}const Q=b?U:Khe(X.x,X.y,X.z,y),ne=b?v.tilespaceRays.map(fe=>Qhe(fe,V)):v.queryGeometry.screenGeometry,ue=De.vec4.transformMat4([],[X.x,X.y,X.z,1],y);if(!M&&b?G*=ue[3]/p.cameraToCenterDistance:M&&!b&&(G*=p.cameraToCenterDistance/ue[3]),b){const fe=$e((j.y/xn+W.y)/(1<<W.z));G/=p.projection.pixelsPerMeter(fe,1)/Be(1,fe)}if(Bn(ne,Q,G))return!0}return!1}function Khe(v,u,p,y){const T=De.vec4.transformMat4([],[v,u,p,1],y);return new At(T[0]/T[3],T[1]/T[3])}const EV=De.vec3.fromValues(0,0,0),Jhe=De.vec3.fromValues(0,0,1);function Qhe(v,u){const p=De.vec3.create();return EV[2]=u,v.intersectsPlane(EV,Jhe,p),new At(p[0],p[1])}class IV extends tr{}let PV,RV,LV,DV;function BV(v,{width:u,height:p},y,T){if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==u*p*y)throw new RangeError("mismatched image size")}else T=new Uint8Array(u*p*y);return v.width=u,v.height=p,v.data=T,v}function kV(v,u,p){const{width:y,height:T}=u;y===v.width&&T===v.height||(ck(v,u,{x:0,y:0},{x:0,y:0},{width:Math.min(v.width,y),height:Math.min(v.height,T)},p,null),v.width=y,v.height=T,v.data=u.data)}function ck(v,u,p,y,T,b,M,k){if(T.width===0||T.height===0)return u;if(T.width>v.width||T.height>v.height||p.x>v.width-T.width||p.y>v.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>u.width||T.height>u.height||y.x>u.width-T.width||y.y>u.height-T.height)throw new RangeError("out of range destination coordinates for image copy");const G=v.data,W=u.data,R=b===4&&k;for(let z=0;z<T.height;z++){const j=((p.y+z)*v.width+p.x)*b,U=((y.y+z)*u.width+y.x)*b;if(R)for(let V=0;V<T.width;V++){const X=j+V*b+3,Q=U+V*b;W[Q+0]=255,W[Q+1]=255,W[Q+2]=255,W[Q+3]=G[X]}else if(M)for(let V=0;V<T.width;V++){const X=j+V*b,Q=U+V*b,ne=G[X+3],ue=new _r(G[X+0]/255*ne,G[X+1]/255*ne,G[X+2]/255*ne,ne).toRenderColor(M).toArray();W[Q+0]=ue[0],W[Q+1]=ue[1],W[Q+2]=ue[2],W[Q+3]=ue[3]}else for(let V=0;V<T.width*b;V++)W[U+V]=G[j+V]}return u}Nn(IV,"HeatmapBucket",{omit:["layers"]});class av{constructor(u,p){BV(this,u,1,p)}resize(u){kV(this,new av(u),1)}clone(){return new av({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,y,T,b){ck(u,p,y,T,b,1,null)}}class yl{constructor(u,p){BV(this,u,4,p)}resize(u){kV(this,new yl(u),4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new yl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,y,T,b,M,k){ck(u,p,y,T,b,4,M,k)}}class OV{constructor(u,p){this.width=u.width,this.height=u.height,this.data=p instanceof Uint8Array?new Float32Array(p.buffer):p}}function iS(v){const u={},p=v.resolution||256,y=v.clips?v.clips.length:1,T=v.image||new yl({width:p,height:y}),b=(M,k,G)=>{u[v.evaluationKey]=G;const W=v.expression.evaluate(u);W&&(T.data[M+k+0]=Math.floor(255*W.r/W.a),T.data[M+k+1]=Math.floor(255*W.g/W.a),T.data[M+k+2]=Math.floor(255*W.b/W.a),T.data[M+k+3]=Math.floor(255*W.a))};if(v.clips)for(let M=0,k=0;M<y;++M,k+=4*p)for(let G=0,W=0;G<p;G++,W+=4){const R=G/(p-1),{start:z,end:j}=v.clips[M];b(k,W,z*(1-R)+j*R)}else for(let M=0,k=0;M<p;M++,k+=4)b(0,k,M/(p-1));return T}Nn(av,"AlphaImage"),Nn(yl,"RGBAImage");const ede=ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:tde}=ede;function sS(v,u,p=2){const y=u&&u.length,T=y?u[0]*p:v.length;let b=FV(v,0,T,p,!0);const M=[];if(!b||b.next===b.prev)return M;let k,G,W;if(y&&(b=function(R,z,j,U){const V=[];for(let X=0,Q=z.length;X<Q;X++){const ne=FV(R,z[X]*U,X<Q-1?z[X+1]*U:R.length,U,!1);ne===ne.next&&(ne.steiner=!0),V.push(cde(ne))}V.sort(ode);for(let X=0;X<V.length;X++)j=ade(V[X],j);return j}(v,u,b,p)),v.length>80*p){k=1/0,G=1/0;let R=-1/0,z=-1/0;for(let j=p;j<T;j+=p){const U=v[j],V=v[j+1];U<k&&(k=U),V<G&&(G=V),U>R&&(R=U),V>z&&(z=V)}W=Math.max(R-k,z-G),W=W!==0?32767/W:0}return oS(b,M,p,k,G,W,0),M}function FV(v,u,p,y,T){let b;if(T===function(M,k,G,W){let R=0;for(let z=k,j=G-W;z<G;z+=W)R+=(M[j]-M[z])*(M[z+1]+M[j+1]),j=z;return R}(v,u,p,y)>0)for(let M=u;M<p;M+=y)b=UV(M/y|0,v[M],v[M+1],b);else for(let M=p-y;M>=u;M-=y)b=UV(M/y|0,v[M],v[M+1],b);return b&&JC(b,b.next)&&(lS(b),b=b.next),b}function w_(v,u){if(!v)return v;u||(u=v);let p,y=v;do if(p=!1,y.steiner||!JC(y,y.next)&&Vo(y.prev,y,y.next)!==0)y=y.next;else{if(lS(y),y=u=y.prev,y===y.next)break;p=!0}while(p||y!==u);return u}function oS(v,u,p,y,T,b,M){if(!v)return;!M&&b&&function(G,W,R,z){let j=G;do j.z===0&&(j.z=uk(j.x,j.y,W,R,z)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==G);j.prevZ.nextZ=null,j.prevZ=null,function(U){let V,X=1;do{let Q,ne=U;U=null;let ue=null;for(V=0;ne;){V++;let fe=ne,ie=0;for(let ve=0;ve<X&&(ie++,fe=fe.nextZ,fe);ve++);let me=X;for(;ie>0||me>0&&fe;)ie!==0&&(me===0||!fe||ne.z<=fe.z)?(Q=ne,ne=ne.nextZ,ie--):(Q=fe,fe=fe.nextZ,me--),ue?ue.nextZ=Q:U=Q,Q.prevZ=ue,ue=Q;ne=fe}ue.nextZ=null,X*=2}while(V>1)}(j)}(v,y,T,b);let k=v;for(;v.prev!==v.next;){const G=v.prev,W=v.next;if(b?rde(v,y,T,b):nde(v))u.push(G.i,v.i,W.i),lS(v),v=W.next,k=W.next;else if((v=W)===k){M?M===1?oS(v=ide(w_(v),u),u,p,y,T,b,2):M===2&&sde(v,u,p,y,T,b):oS(w_(v),u,p,y,T,b,1);break}}}function nde(v){const u=v.prev,p=v,y=v.next;if(Vo(u,p,y)>=0)return!1;const T=u.x,b=p.x,M=y.x,k=u.y,G=p.y,W=y.y,R=T<b?T<M?T:M:b<M?b:M,z=k<G?k<W?k:W:G<W?G:W,j=T>b?T>M?T:M:b>M?b:M,U=k>G?k>W?k:W:G>W?G:W;let V=y.next;for(;V!==u;){if(V.x>=R&&V.x<=j&&V.y>=z&&V.y<=U&&i1(T,k,b,G,M,W,V.x,V.y)&&Vo(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function rde(v,u,p,y){const T=v.prev,b=v,M=v.next;if(Vo(T,b,M)>=0)return!1;const k=T.x,G=b.x,W=M.x,R=T.y,z=b.y,j=M.y,U=k<G?k<W?k:W:G<W?G:W,V=R<z?R<j?R:j:z<j?z:j,X=k>G?k>W?k:W:G>W?G:W,Q=R>z?R>j?R:j:z>j?z:j,ne=uk(U,V,u,p,y),ue=uk(X,Q,u,p,y);let fe=v.prevZ,ie=v.nextZ;for(;fe&&fe.z>=ne&&ie&&ie.z<=ue;){if(fe.x>=U&&fe.x<=X&&fe.y>=V&&fe.y<=Q&&fe!==T&&fe!==M&&i1(k,R,G,z,W,j,fe.x,fe.y)&&Vo(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,ie.x>=U&&ie.x<=X&&ie.y>=V&&ie.y<=Q&&ie!==T&&ie!==M&&i1(k,R,G,z,W,j,ie.x,ie.y)&&Vo(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;fe&&fe.z>=ne;){if(fe.x>=U&&fe.x<=X&&fe.y>=V&&fe.y<=Q&&fe!==T&&fe!==M&&i1(k,R,G,z,W,j,fe.x,fe.y)&&Vo(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;ie&&ie.z<=ue;){if(ie.x>=U&&ie.x<=X&&ie.y>=V&&ie.y<=Q&&ie!==T&&ie!==M&&i1(k,R,G,z,W,j,ie.x,ie.y)&&Vo(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function ide(v,u){let p=v;do{const y=p.prev,T=p.next.next;!JC(y,T)&&NV(y,p,p.next,T)&&aS(y,T)&&aS(T,y)&&(u.push(y.i,p.i,T.i),lS(p),lS(p.next),p=v=T),p=p.next}while(p!==v);return w_(p)}function sde(v,u,p,y,T,b){let M=v;do{let k=M.next.next;for(;k!==M.prev;){if(M.i!==k.i&&ude(M,k)){let G=zV(M,k);return M=w_(M,M.next),G=w_(G,G.next),oS(M,u,p,y,T,b,0),void oS(G,u,p,y,T,b,0)}k=k.next}M=M.next}while(M!==v)}function ode(v,u){return v.x-u.x}function ade(v,u){const p=function(T,b){let M=b;const k=T.x,G=T.y;let W,R=-1/0;do{if(G<=M.y&&G>=M.next.y&&M.next.y!==M.y){const X=M.x+(G-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(X<=k&&X>R&&(R=X,W=M.x<M.next.x?M:M.next,X===k))return W}M=M.next}while(M!==b);if(!W)return null;const z=W,j=W.x,U=W.y;let V=1/0;M=W;do{if(k>=M.x&&M.x>=j&&k!==M.x&&i1(G<U?k:R,G,j,U,G<U?R:k,G,M.x,M.y)){const X=Math.abs(G-M.y)/(k-M.x);aS(M,T)&&(X<V||X===V&&(M.x>W.x||M.x===W.x&&lde(W,M)))&&(W=M,V=X)}M=M.next}while(M!==z);return W}(v,u);if(!p)return u;const y=zV(p,v);return w_(y,y.next),w_(p,p.next)}function lde(v,u){return Vo(v.prev,v,u.prev)<0&&Vo(u.next,v,v.next)<0}function uk(v,u,p,y,T){return(v=1431655765&((v=858993459&((v=252645135&((v=16711935&((v=(v-p)*T|0)|v<<8))|v<<4))|v<<2))|v<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-y)*T|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function cde(v){let u=v,p=v;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==v);return p}function i1(v,u,p,y,T,b,M,k){return(T-M)*(u-k)>=(v-M)*(b-k)&&(v-M)*(y-k)>=(p-M)*(u-k)&&(p-M)*(b-k)>=(T-M)*(y-k)}function ude(v,u){return v.next.i!==u.i&&v.prev.i!==u.i&&!function(p,y){let T=p;do{if(T.i!==p.i&&T.next.i!==p.i&&T.i!==y.i&&T.next.i!==y.i&&NV(T,T.next,p,y))return!0;T=T.next}while(T!==p);return!1}(v,u)&&(aS(v,u)&&aS(u,v)&&function(p,y){let T=p,b=!1;const M=(p.x+y.x)/2,k=(p.y+y.y)/2;do T.y>k!=T.next.y>k&&T.next.y!==T.y&&M<(T.next.x-T.x)*(k-T.y)/(T.next.y-T.y)+T.x&&(b=!b),T=T.next;while(T!==p);return b}(v,u)&&(Vo(v.prev,v,u.prev)||Vo(v,u.prev,u))||JC(v,u)&&Vo(v.prev,v,v.next)>0&&Vo(u.prev,u,u.next)>0)}function Vo(v,u,p){return(u.y-v.y)*(p.x-u.x)-(u.x-v.x)*(p.y-u.y)}function JC(v,u){return v.x===u.x&&v.y===u.y}function NV(v,u,p,y){const T=eE(Vo(v,u,p)),b=eE(Vo(v,u,y)),M=eE(Vo(p,y,v)),k=eE(Vo(p,y,u));return T!==b&&M!==k||!(T!==0||!QC(v,p,u))||!(b!==0||!QC(v,y,u))||!(M!==0||!QC(p,v,y))||!(k!==0||!QC(p,u,y))}function QC(v,u,p){return u.x<=Math.max(v.x,p.x)&&u.x>=Math.min(v.x,p.x)&&u.y<=Math.max(v.y,p.y)&&u.y>=Math.min(v.y,p.y)}function eE(v){return v>0?1:v<0?-1:0}function aS(v,u){return Vo(v.prev,v,v.next)<0?Vo(v,u,v.next)>=0&&Vo(v,v.prev,u)>=0:Vo(v,u,v.prev)<0||Vo(v,v.next,u)<0}function zV(v,u){const p=hk(v.i,v.x,v.y),y=hk(u.i,u.x,u.y),T=v.next,b=u.prev;return v.next=u,u.prev=v,p.next=T,T.prev=p,y.next=p,p.prev=y,b.next=y,y.prev=b,y}function UV(v,u,p,y){const T=hk(v,u,p);return y?(T.next=y.next,T.prev=y,y.next.prev=T,y.next=T):(T.prev=T,T.next=T),T}function lS(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function hk(v,u,p){return{i:v,x:u,y:p,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function tE(v,u){const p=v.length;if(p<=1)return[v];const y=[];let T,b;for(let M=0;M<p;M++){const k=hn(v[M]);k!==0&&(v[M].area=Math.abs(k),b===void 0&&(b=k<0),b===k<0?(T&&y.push(T),T=[v[M]]):T.push(v[M]))}if(T&&y.push(T),u>1)for(let M=0;M<y.length;M++)y[M].length<=u||(Y0(y[M],u,1,y[M].length-1,hde),y[M]=y[M].slice(0,u));return y}function hde(v,u){return u.area-v.area}function dk(v,u,p){const y=p.patternDependencies;let T=!1;for(const b of u){const M=b.paint.get(`${v}-pattern`);M.isConstant()||(T=!0);const k=M.constantOr(null);k&&(T=!0,y[k]=!0)}return T}function fk(v,u,p,y,T){const b=T.patternDependencies;for(const M of u){const k=M.paint.get(`${v}-pattern`).value;if(k.kind!=="constant"){let G=k.evaluate({zoom:y},p,{},T.availableImages);G=G&&G.name?G.name:G,b[G]=!0,p.patterns[M.id]=G}}return p}class pk{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fc,this.indexArray=new To,this.indexArray2=new Eu,this.programConfigurations=new ir(u.layers,{zoom:u.zoom,lut:u.lut}),this.segments=new As,this.segments2=new As,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.projection=u.projection}updateFootprints(u,p){}populate(u,p,y,T){this.hasPattern=dk("fill",this.layers,p);const b=this.layers[0].layout.get("fill-sort-key"),M=[];for(const{feature:k,id:G,index:W,sourceLayerIndex:R}of u){const z=this.layers[0]._featureFilter.needGeometry,j=mn(k,z);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),j,y))continue;const U=b?b.evaluate(j,{},y,p.availableImages):void 0,V={id:G,properties:k.properties,type:k.type,sourceLayerIndex:R,index:W,geometry:z?j.geometry:fn(k,y,T),patterns:{},sortKey:U};M.push(V)}b&&M.sort((k,G)=>k.sortKey-G.sortKey);for(const k of M){const{geometry:G,index:W,sourceLayerIndex:R}=k;if(this.hasPattern){const z=fk("fill",this.layers,k,this.zoom,p);this.patternFeatures.push(z)}else this.addFeature(k,G,W,y,{},p.availableImages,p.brightness);p.featureIndex.insert(u[W].feature,G,W,R,this.index)}}update(u,p,y,T,b){const M=Object.keys(u).length!==0;M&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(u,p,M?this.stateDependentLayers:this.layers,y,T,b)}addFeatures(u,p,y,T,b,M){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,p,y,T,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,tde),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,y,T,b,M=[],k){for(const G of tE(p,500)){let W=0;for(const X of G)W+=X.length;const R=this.segments.prepareSegment(W,this.layoutVertexArray,this.indexArray),z=R.vertexLength,j=[],U=[];for(const X of G){if(X.length===0)continue;X!==G[0]&&U.push(j.length/2);const Q=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),ne=Q.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(ne+X.length-1,ne),j.push(X[0].x),j.push(X[0].y);for(let ue=1;ue<X.length;ue++)this.layoutVertexArray.emplaceBack(X[ue].x,X[ue].y),this.indexArray2.emplaceBack(ne+ue-1,ne+ue),j.push(X[ue].x),j.push(X[ue].y);Q.vertexLength+=X.length,Q.primitiveLength+=X.length}const V=sS(j,U);for(let X=0;X<V.length;X+=3)this.indexArray.emplaceBack(z+V[X],z+V[X+1],z+V[X+2]);R.vertexLength+=W,R.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,y,b,M,T,k)}}let GV,VV,HV,jV;Nn(pk,"FillBucket",{omit:["layers","patternFeatures"]});class mk{constructor(u,p,y,T){if(this.triangleCount=p.length/3,this.min=new At(0,0),this.max=new At(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||u.length===0)return;const[b,M]=[u[0].clone(),u[0].clone()];for(let z=1;z<u.length;++z){const j=u[z];b.x=Math.min(b.x,j.x),b.y=Math.min(b.y,j.y),M.x=Math.max(M.x,j.x),M.y=Math.max(M.y,j.y)}if(T){const z=Math.ceil(Math.max(M.x-b.x,M.y-b.y)/T);y=Math.max(y,z)}if(y===0)return;this.min=b,this.max=M;const k=this.max.sub(this.min);k.x=Math.max(k.x,1),k.y=Math.max(k.y,1);const G=Math.max(k.x,k.y)/y;this.cellsX=Math.max(1,Math.ceil(k.x/G)),this.cellsY=Math.max(1,Math.ceil(k.y/G)),this.xScale=1/G,this.yScale=1/G;const W=[];for(let z=0;z<this.triangleCount;z++){const j=u[p[3*z+0]].sub(this.min),U=u[p[3*z+1]].sub(this.min),V=u[p[3*z+2]].sub(this.min),X=Xf(Math.floor(Math.min(j.x,U.x,V.x)),this.xScale,this.cellsX),Q=Xf(Math.floor(Math.max(j.x,U.x,V.x)),this.xScale,this.cellsX),ne=Xf(Math.floor(Math.min(j.y,U.y,V.y)),this.yScale,this.cellsY),ue=Xf(Math.floor(Math.max(j.y,U.y,V.y)),this.yScale,this.cellsY),fe=new At(0,0),ie=new At(0,0),me=new At(0,0),ve=new At(0,0);for(let Ce=ne;Ce<=ue;++Ce){fe.y=ie.y=Ce*G,me.y=ve.y=(Ce+1)*G;for(let ke=X;ke<=Q;++ke)fe.x=me.x=ke*G,ie.x=ve.x=(ke+1)*G,(Gi(j,U,V,fe,ie,ve)||Gi(j,U,V,fe,ve,me))&&W.push({cellIdx:Ce*this.cellsX+ke,triIdx:z})}}if(W.length===0)return;W.sort((z,j)=>z.cellIdx-j.cellIdx||z.triIdx-j.triIdx);let R=0;for(;R<W.length;){const z=W[R].cellIdx,j={start:this.payload.length,len:0};for(;R<W.length&&W[R].cellIdx===z;)++j.len,this.payload.push(W[R++].triIdx);this.cells[z]=j}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(u,p){if(this.triangleCount===0||this.cells.length===0||u.x>this.max.x||this.min.x>u.x||u.y>this.max.y||this.min.y>u.y)return;const y=Xf(u.x-this.min.x,this.xScale,this.cellsX),T=Xf(u.y-this.min.y,this.yScale,this.cellsY),b=this.cells[T*this.cellsX+y];if(b){this._lazyInitLookup();for(let M=0;M<b.len;M++){const k=this.payload[b.start+M],G=Math.floor(k/8),W=1<<k%8;if(!(this.lookup[G]&W)&&(this.lookup[G]|=W,p.push(k),p.length===this.triangleCount))return}}}query(u,p,y){if(this.triangleCount===0||this.cells.length===0||u.x>this.max.x||this.min.x>p.x||u.y>this.max.y||this.min.y>p.y)return;this._lazyInitLookup();const T=Xf(u.x-this.min.x,this.xScale,this.cellsX),b=Xf(p.x-this.min.x,this.xScale,this.cellsX),M=Xf(u.y-this.min.y,this.yScale,this.cellsY),k=Xf(p.y-this.min.y,this.yScale,this.cellsY);for(let G=M;G<=k;G++)for(let W=T;W<=b;W++){const R=this.cells[G*this.cellsX+W];if(R)for(let z=0;z<R.len;z++){const j=this.payload[R.start+z],U=Math.floor(j/8),V=1<<j%8;if(!(this.lookup[U]&V)&&(this.lookup[U]|=V,y.push(j),y.length===this.triangleCount))return}}}}function Xf(v,u,p){return Math.max(0,Math.min(p-1,Math.floor(v*u)))}Nn(mk,"TriangleGridIndex");class WV{constructor(u){this.zoom=u.zoom,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=u.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.footprints=[]}updateFootprints(u,p){for(const y of this.footprints)p.push({footprint:y,id:u})}populate(u,p,y,T){const b=[];for(const{feature:M,id:k,index:G,sourceLayerIndex:W}of u){const R=this.layers[0]._featureFilter.needGeometry,z=mn(M,R);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),z,y))continue;const j={id:k,properties:M.properties,type:M.type,sourceLayerIndex:W,index:G,geometry:R?z.geometry:fn(M,y,T),patterns:{}};b.push(j)}for(const M of b){const{geometry:k,index:G,sourceLayerIndex:W}=M;this.addFeature(M,k,G,y,{},p.availableImages,p.brightness),p.featureIndex.insert(u[G].feature,k,G,W,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(u){}update(u,p,y,T,b){}destroy(){}addFeature(u,p,y,T,b,M=[],k){for(const G of tE(p,2)){const W=[],R=[],z=[],j=new At(1/0,1/0),U=new At(-1/0,-1/0);for(const Q of G)if(Q.length!==0){Q!==G[0]&&z.push(R.length/2);for(let ne=0;ne<Q.length;ne++)R.push(Q[ne].x),R.push(Q[ne].y),W.push(Q[ne]),j.x=Math.min(j.x,Q[ne].x),j.y=Math.min(j.y,Q[ne].y),U.x=Math.max(U.x,Q[ne].x),U.y=Math.max(U.y,Q[ne].y)}const V=sS(R,z),X=new mk(W,V,8,256);this.footprints.push({vertices:W,indices:V,grid:X,min:j,max:U})}}}Nn(WV,"ClipBucket",{omit:["layers"]});const dde=ti([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fde=ti([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),pde=ti([{name:"a_centroid_pos",components:2,type:"Uint16"}]),mde=ti([{name:"a_join_normal_inside",components:3,type:"Int16"}]),gde=ti([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),vde=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:_de}=dde;var gk,$V,vk,XV,_k,qV,YV,nE={};function ZV(){if($V)return gk;$V=1;var v=un();function u(T,b,M,k,G){this.properties={},this.extent=M,this.type=0,this._pbf=T,this._geometry=-1,this._keys=k,this._values=G,T.readFields(p,this,b)}function p(T,b,M){T==1?b.id=M.readVarint():T==2?function(k,G){for(var W=k.readVarint()+k.pos;k.pos<W;){var R=G._keys[k.readVarint()],z=G._values[k.readVarint()];G.properties[R]=z}}(M,b):T==3?b.type=M.readVarint():T==4&&(b._geometry=M.pos)}function y(T){for(var b,M,k=0,G=0,W=T.length,R=W-1;G<W;R=G++)k+=((M=T[R]).x-(b=T[G]).x)*(b.y+M.y);return k}return gk=u,u.types=["Unknown","Point","LineString","Polygon"],u.prototype.loadGeometry=function(){var T=this._pbf;T.pos=this._geometry;for(var b,M=T.readVarint()+T.pos,k=1,G=0,W=0,R=0,z=[];T.pos<M;){if(G<=0){var j=T.readVarint();k=7&j,G=j>>3}if(G--,k===1||k===2)W+=T.readSVarint(),R+=T.readSVarint(),k===1&&(b&&z.push(b),b=[]),b.push(new v(W,R));else{if(k!==7)throw new Error("unknown command "+k);b&&b.push(b[0].clone())}}return b&&z.push(b),z},u.prototype.bbox=function(){var T=this._pbf;T.pos=this._geometry;for(var b=T.readVarint()+T.pos,M=1,k=0,G=0,W=0,R=1/0,z=-1/0,j=1/0,U=-1/0;T.pos<b;){if(k<=0){var V=T.readVarint();M=7&V,k=V>>3}if(k--,M===1||M===2)(G+=T.readSVarint())<R&&(R=G),G>z&&(z=G),(W+=T.readSVarint())<j&&(j=W),W>U&&(U=W);else if(M!==7)throw new Error("unknown command "+M)}return[R,j,z,U]},u.prototype.toGeoJSON=function(T,b,M){var k,G,W=this.extent*Math.pow(2,M),R=this.extent*T,z=this.extent*b,j=this.loadGeometry(),U=u.types[this.type];function V(ne){for(var ue=0;ue<ne.length;ue++){var fe=ne[ue];ne[ue]=[360*(fe.x+R)/W-180,360/Math.PI*Math.atan(Math.exp((180-360*(fe.y+z)/W)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(k=0;k<j.length;k++)X[k]=j[k][0];V(j=X);break;case 2:for(k=0;k<j.length;k++)V(j[k]);break;case 3:for(j=function(ne){var ue=ne.length;if(ue<=1)return[ne];for(var fe,ie,me=[],ve=0;ve<ue;ve++){var Ce=y(ne[ve]);Ce!==0&&(ie===void 0&&(ie=Ce<0),ie===Ce<0?(fe&&me.push(fe),fe=[ne[ve]]):fe.push(ne[ve]))}return fe&&me.push(fe),me}(j),k=0;k<j.length;k++)for(G=0;G<j[k].length;G++)V(j[k][G])}j.length===1?j=j[0]:U="Multi"+U;var Q={type:"Feature",geometry:{type:U,coordinates:j},properties:this.properties};return"id"in this&&(Q.id=this.id),Q},gk}function KV(){if(XV)return vk;XV=1;var v=ZV();function u(y,T){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=y,this._keys=[],this._values=[],this._features=[],y.readFields(p,this,T),this.length=this._features.length}function p(y,T,b){y===15?T.version=b.readVarint():y===1?T.name=b.readString():y===5?T.extent=b.readVarint():y===2?T._features.push(b.pos):y===3?T._keys.push(b.readString()):y===4&&T._values.push(function(M){for(var k=null,G=M.readVarint()+M.pos;M.pos<G;){var W=M.readVarint()>>3;k=W===1?M.readString():W===2?M.readFloat():W===3?M.readDouble():W===4?M.readVarint64():W===5?M.readVarint():W===6?M.readSVarint():W===7?M.readBoolean():null}return k}(b))}return vk=u,u.prototype.feature=function(y){if(y<0||y>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[y];var T=this._pbf.readVarint()+this._pbf.pos;return new v(this._pbf,T,this.extent,this._keys,this._values)},vk}function JV(){return YV||(YV=1,nE.VectorTile=function(){if(qV)return _k;qV=1;var v=KV();function u(p,y,T){if(p===3){var b=new v(T,T.readVarint()+T.pos);b.length&&(y[b.name]=b)}}return _k=function(p,y){this.layers=p.readFields(u,{},y)},_k}(),nE.VectorTileFeature=ZV(),nE.VectorTileLayer=KV()),nE}var s1=JV();class S_ extends At{constructor(u,p,y){super(u,p),this.z=y}}class QV extends S_{constructor(u,p,y,T){super(u,p,y),this.w=T}}function rE(v,u,p,y){const T=[],b=y===0?(M,k,G,W,R,z)=>{M.push(new At(z,G+(z-k)/(W-k)*(R-G)))}:(M,k,G,W,R,z)=>{M.push(new At(k+(z-G)/(R-G)*(W-k),z))};for(const M of v){const k=[];for(const G of M){if(G.length<=2)continue;const W=[];for(let j=0;j<G.length-1;j++){const U=G[j].x,V=G[j].y,X=G[j+1].x,Q=G[j+1].y,ne=y===0?U:V,ue=y===0?X:Q;ne<u?ue>u&&b(W,U,V,X,Q,u):ne>p?ue<p&&b(W,U,V,X,Q,p):W.push(G[j]),ue<u&&ne>=u&&b(W,U,V,X,Q,u),ue>p&&ne<=p&&b(W,U,V,X,Q,p)}let R=G[G.length-1];const z=y===0?R.x:R.y;z>=u&&z<=p&&W.push(R),W.length&&(R=W[W.length-1],W[0].x===R.x&&W[0].y===R.y||W.push(W[0]),k.push(W))}k.length&&T.push(k)}return T}function eH(v,u,p,y){const T=p==="x"?"y":"x",b=(y-v[p])/(u[p]-v[p]);v[T]=v[T]+(u[T]-v[T])*b,v[p]=y,v.hasOwnProperty("z")&&(v.z=ur(v.z,u.z,b)),v.hasOwnProperty("w")&&(v.w=ur(v.w,u.w,b))}function tH(v,u,p,y){const T=p,b=y;for(const M of["x","y"]){let k=v,G=u;k[M]>=G[M]&&(k=u,G=v),k[M]<T&&G[M]>T&&eH(k,G,M,T),k[M]<b&&G[M]>b&&eH(G,k,M,b)}}const iE=Number.MAX_SAFE_INTEGER;function nH(v,u,p,y){return v.order<u||v.order===iE||!(v.clipMask&p)||function(T,b){return b.length!==0&&b.find(M=>M===T)===void 0}(y,v.clipScope)}function sE(v,u){return v.x-u.x||v.y-u.y}function rH(v,u){return sE(v.min,u.min)===0&&sE(v.max,u.max)===0}function yk(v,u){return!(v.min.x>u.max.x||v.max.x<u.min.x||v.min.y>u.max.y||v.max.y<u.min.y)}function xk(v,u){if(v.length!==u.length)return!1;for(let p=0;p<v.length;p++)if(v[p].sourceId!==u[p].sourceId||!rH(v[p],u[p])||v[p].order!==u[p].order||v[p].clipMask!==u[p].clipMask||!en(v[p].clipScope,u[p].clipScope))return!1;return!0}function iH(v,u,p){const y=1/xn,T=1/(1<<p.canonical.z),b=(u.x*y+p.canonical.x)*T+p.wrap,M=(u.y*y+p.canonical.y)*T;return{min:new At((v.x*y+p.canonical.x)*T+p.wrap,(v.y*y+p.canonical.y)*T),max:new At(b,M)}}function yde(v,u,p){const y=1<<p.canonical.z,T=((u.x-p.wrap)*y-p.canonical.x)*xn,b=(u.y*y-p.canonical.y)*xn;return{min:new At(((v.x-p.wrap)*y-p.canonical.x)*xn,(v.y*y-p.canonical.y)*xn),max:new At(T,b)}}function sH(v,u,p,y,T,b,M){const k=v.indices,G=v.vertices,W=[];for(let R=y;R<y+T;R+=3){const z=u[p[R+0]+b],j=u[p[R+1]+b],U=u[p[R+2]+b],V=Math.min(z.x,j.x,U.x),X=Math.max(z.x,j.x,U.x),Q=Math.min(z.y,j.y,U.y),ne=Math.max(z.y,j.y,U.y);W.length=0,v.grid.query(new At(V,Q),new At(X,ne),W);for(let ue=0;ue<W.length;ue++){const fe=W[ue];if(Gi(G[k[3*fe+0]],G[k[3*fe+1]],G[k[3*fe+2]],z,j,U,M))return!0}}return!1}function oH(v,u,p,y){if(!v||!p)return!1;let T=v.vertices;if(!u.canonical.equals(y.canonical)||u.wrap!==y.wrap){if(p.vertices.length<v.vertices.length)return oH(p,y,v,u);const b=u.canonical,M=y.canonical,k=Math.pow(2,M.z-b.z);T=v.vertices.map(G=>new At((G.x+b.x*xn)*k-M.x*xn,(G.y+b.y*xn)*k-M.y*xn))}return sH(p,T,v.indices,0,v.indices.length,0,0)}function aH(v,u,p,y){const T=Math.pow(2,y.z-p.z);return new At((v+p.x*xn)*T-y.x*xn,(u+p.y*xn)*T-y.y*xn)}function lH(v,u){const p=[];u.grid.queryPoint(v,p);const y=u.indices,T=u.vertices;for(let b=0;b<p.length;b++){const M=p[b];if(as([T[y[3*M+0]],T[y[3*M+1]],T[y[3*M+2]]],v))return!0}return!1}const bk=[new At(0,0),new At(xn,0),new At(xn,xn),new At(0,xn)];function cH(v,u){const p=[];let y=[];if(!u||v.length<2)return[v];if(v.length===2)return no(v[0],v[1],bk)?[v]:[];for(let T=0;T<v.length+2;T++){const b=v[T%v.length],M=v[(T+1)%v.length],k=no(T===0?v[v.length-1]:v[(T-1)%v.length],b,bk),G=no(b,M,bk),W=k||G;W&&y.push(b),W&&G||y.length>0&&(y.length>1&&p.push(y),y=[])}return y.length>1&&p.push(y),p}const wk=s1.VectorTileFeature.types,xde=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],bde=["fill-extrusion-flood-light-ground-radius"],wde=Math.pow(2,13),Sde=Math.pow(2,15)-1,uH=new At(0,1),lv=2147483648;function cS(v,u,p,y,T,b,M,k){v.emplaceBack((u<<1)+M,(p<<1)+b,(Math.floor(y*wde)<<1)+T,Math.round(k))}function uS(v,u,p){v.emplaceBack(u.x*xn,u.y*xn,p?1:0)}function oE(v,u,p,y,T,b){v.emplaceBack(u.x,u.y,(p.x<<1)+y,(p.y<<1)+T,b)}function hS(v,u,p){v.emplaceBack(u.x,u.y,u.z,p[0]*16384,p[1]*16384,p[2]*16384)}class hH{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class dH{constructor(){this.centroidXY=new At(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new At(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new At(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new At(this.max.x-this.min.x,this.max.y-this.min.y)}}class fH{constructor(){this.acc=new At(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(u,p){u.min.x===Number.MAX_VALUE&&(u.min.x=u.max.x=p.x,u.min.y=u.max.y=p.y)}appendEdge(u,p,y){this.accCount++,this.acc._add(p);let T=!!this.borders;p.x<u.min.x?(u.min.x=p.x,T=!0):p.x>u.max.x&&(u.max.x=p.x,T=!0),p.y<u.min.y?(u.min.y=p.y,T=!0):p.y>u.max.y&&(u.max.y=p.y,T=!0),((p.x===0||p.x===xn)&&p.x===y.x)!=((p.y===0||p.y===xn)&&p.y===y.y)&&this.processBorderOverlap(p,y),T&&this.checkBorderIntersection(p,y)}checkBorderIntersection(u,p){p.x<0!=u.x<0&&this.addBorderIntersection(0,ur(p.y,u.y,(0-p.x)/(u.x-p.x))),p.x>xn!=u.x>xn&&this.addBorderIntersection(1,ur(p.y,u.y,(xn-p.x)/(u.x-p.x))),p.y<0!=u.y<0&&this.addBorderIntersection(2,ur(p.x,u.x,(0-p.y)/(u.y-p.y))),p.y>xn!=u.y>xn&&this.addBorderIntersection(3,ur(p.x,u.x,(xn-p.y)/(u.y-p.y)))}addBorderIntersection(u,p){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const y=this.borders[u];p<y[0]&&(y[0]=p),p>y[1]&&(y[1]=p)}processBorderOverlap(u,p){if(u.x===p.x){if(u.y===p.y)return;const y=u.x===0?0:1;this.addBorderIntersection(y,p.y),this.addBorderIntersection(y,u.y)}else{const y=u.y===0?2:3;this.addBorderIntersection(y,p.x),this.addBorderIntersection(y,u.x)}}centroid(){return this.accCount===0?new At(0,0):new At(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((u,p)=>u+ +(p[0]!==Number.MAX_VALUE),0):0}}function pH(v,u){const p=v.add(u)._unit(),y=Wt(v.x*p.x+v.y*p.y,-1,1);var T,b,M;return M=Math.acos(y),Math.min(4,Math.max(-4,Math.tan(M)))/4*Sde*((T=v).x*(b=u).y-T.y*b.x<0?-1:1)}const Ade=[v=>v.x<0,v=>v.x>xn,v=>v.y<0,v=>v.y>xn];function Tde(v,u,p,y){const T=[4];if(y===0)return T;p._mult(y);const b=v.sub(p),M=u.sub(p),k=[v,u,b,M];for(let G=0;G<4;G++)for(const W of k)if(Ade[G](W)){T.push(G);break}return T}class mH{constructor(u){this.vertexArray=new pc,this.indexArray=new To,this.programConfigurations=new ir(u.layers,{zoom:u.zoom,lut:u.lut},p=>bde.includes(p)),this._segments=new As,this.hiddenByLandmarkVertexArray=new um,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new As}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(u,p,y,T=!1){const b=u.length;if(b>2){let M=Math.max(0,this._segments.get().length-1);const k=this._segments._prepareSegment(4*b,this.vertexArray.length,2*this._segmentToGroundQuads[M].length);let G;M!==this._segments.get().length-1&&(M++,this._segmentToGroundQuads[M]=[],this._segmentToRegionTriCounts[M]=[0,0,0,0,0]);{const W=u[0],R=u[1];G=pH(W.sub(u[b-1])._perp()._unit(),R.sub(W)._perp()._unit())}for(let W=0;W<b;W++){const R=W===b-1?0:W+1,z=u[W],j=u[R],U=u[R===b-1?0:R+1],V=j.sub(z)._perp()._unit(),X=pH(V,U.sub(j)._perp()._unit()),Q=G,ne=X;if(Sk(z,j,p)||T&&_H(z,p)&&_H(j,p)){G=X;continue}const ue=k.vertexLength;oE(this.vertexArray,z,j,1,1,Q),oE(this.vertexArray,z,j,1,0,Q),oE(this.vertexArray,z,j,0,1,ne),oE(this.vertexArray,z,j,0,0,ne),k.vertexLength+=4;const fe=Tde(z,j,V,y);for(const ie of fe)this._segmentToGroundQuads[M].push({id:ue,region:ie}),this._segmentToRegionTriCounts[M][ie]+=2,k.primitiveLength+=2;G=X}}}prepareBorderSegments(){if(!this.hasData())return;const u=this._segments.get(),p=u.length;for(let y=0;y<p;y++)this._segmentToGroundQuads[y].sort((T,b)=>T.region-b.region);for(let y=0;y<p;y++){const T=this._segmentToGroundQuads[y],b=u[y],M=this._segmentToRegionTriCounts[y];M.reduce((G,W)=>G+W,0);let k=0;for(let G=0;G<=4;G++){const W=M[G];if(W!==0){let R=this.regionSegments[G];R||(R=this.regionSegments[G]=new As);const z={vertexOffset:b.vertexOffset,primitiveOffset:b.primitiveOffset+k,vertexLength:b.vertexLength,primitiveLength:W};R.get().push(z)}k+=W}for(let G=0;G<T.length;G++){const W=T[G].id;this.indexArray.emplaceBack(W,W+1,W+3),this.indexArray.emplaceBack(W,W+3,W+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(u,p,y,T,b,M){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,u,p,y,T,b,M)}upload(u){this.hasData()&&(this.vertexBuffer=u.createVertexBuffer(this.vertexArray,fde.members),this.indexBuffer=u.createIndexBuffer(this.indexArray))}uploadPaintProperties(u){this.hasData()&&this.programConfigurations.upload(u)}update(u,p,y,T,b,M){this.hasData()&&this.programConfigurations.updatePaintArrays(u,p,y,T,b,M)}updateHiddenByLandmark(u){if(!this.hasData())return;const p=u.groundVertexCount+u.groundVertexArrayOffset;if(u.groundVertexCount===0)return;const y=u.flags&lv?1:0;for(let T=u.groundVertexArrayOffset;T<p;++T)this.hiddenByLandmarkVertexArray.emplace(T,y);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(u){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=u.createVertexBuffer(this.hiddenByLandmarkVertexArray,gde.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let u=0;u<=4;u++){const p=this.regionSegments[u];p&&p.destroy()}}}}class aE{constructor(u){this.zoom=u.zoom,this.canonical=u.canonical,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=u.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=u.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new To,this.footprintVertices=new fc,this.footprintSegments=[],this.layoutVertexArray=new to,this.centroidVertexArray=new lh,this.wallVertexArray=new fm,this.indexArray=new To,this.programConfigurations=new ir(u.layers,{zoom:u.zoom,lut:u.lut},p=>xde.includes(p)),this.segments=new As,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.groundEffect=new mH(u),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(u,p){}populate(u,p,y,T){this.features=[],this.hasPattern=dk("fill-extrusion",this.layers,p),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=st(y),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:b,id:M,index:k,sourceLayerIndex:G}of u){const W=this.layers[0]._featureFilter.needGeometry,R=mn(b,W);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),R,y))continue;const z={id:M,sourceLayerIndex:G,index:k,geometry:W?R.geometry:fn(b,y,T),properties:b.properties,type:b.type,patterns:{}},j=this.layoutVertexArray.length,U=wk[z.type]==="Polygon";if(this.hasPattern)this.features.push(fk("fill-extrusion",this.layers,z,this.zoom,p));else if(this.wallMode)for(const V of z.geometry)for(const X of cH(V,U))this.addFeature(z,[X],k,y,{},p.availableImages,T,p.brightness);else this.addFeature(z,z.geometry,k,y,{},p.availableImages,T,p.brightness);p.featureIndex.insert(b,z.geometry,k,G,this.index,j)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(u,p,y,T,b,M){for(const k of this.features){const G=wk[k.type]==="Polygon",{geometry:W}=k;if(this.wallMode)for(const R of W)for(const z of cH(R,G))this.addFeature(k,[z],k.index,p,y,T,b,M);else this.addFeature(k,W,k.index,p,y,T,b,M)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(u,p,y,T,b){const M=Object.keys(u).length!==0;if(M&&!this.stateDependentLayers.length)return;const k=M?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(u,p,k,y,T,b),this.groundEffect.update(u,p,k,y,T,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,_de),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.wallVertexBuffer=u.createVertexBuffer(this.wallVertexArray,mde.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=u.createVertexBuffer(this.layoutVertexExtArray,vde.members,!0)),this.groundEffect.upload(u)),this.groundEffect.uploadPaintProperties(u),this.programConfigurations.upload(u),this.uploaded=!0}uploadCentroid(u){this.groundEffect.uploadHiddenByLandmark(u),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,pde.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,y,T,b,M,k,G){const W=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(u,{})/this.tileToMeter,R=[new At(0,0),new At(xn,xn)],z=k.projection,j=z.name==="globe",U=this.wallMode||wk[u.type]==="Polygon",V=new fH;V.centroidDataIndex=this.centroidData.length;const X=new dH,Q=this.layers[0].paint.get("fill-extrusion-base").evaluate(u,{},T)<=0,ne=this.layers[0].paint.get("fill-extrusion-height").evaluate(u,{},T);let ue;if(X.height=ne,X.vertexArrayOffset=this.layoutVertexArray.length,X.groundVertexArrayOffset=this.groundEffect.vertexArray.length,j&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zf),this.wallMode){if(j)return void Bt("Non zero fill-extrusion-line-width is not yet supported on globe.");if(p.length!==1)return;ue=function(Le){const Ke=Le[0].x===Le[Le.length-1].x&&Le[0].y===Le[Le.length-1].y;(function(pn){let rn=0;const rr=pn.length;for(let Pn=0;Pn<rr;Pn++)rn+=(pn[(Pn+1)%rr].x-pn[Pn].x)*(pn[(Pn+1)%rr].y+pn[Pn].y);return rn>=0})(Le)||(Le=Le.reverse());const et={geometry:[],joinNormals:[],indices:[]},ut=[],dt=[],ft=[];let _t=Le.length;if(_t<(Ke?3:2))return et;for(;_t>=2&&Le[_t-1].equals(Le[_t-2]);)_t--;let It,xt,Vt,Kt,kt,Rn=0;for(;Rn<_t-1&&Le[Rn].equals(Le[Rn+1]);)Rn++;Ke&&(It=Le[_t-2],kt=Le[Rn].sub(It)._unit()._perp());for(let pn=Rn;pn<_t;pn++){if(Vt=pn===_t-1?Ke?Le[Rn+1]:void 0:Le[pn+1],Vt&&Le[pn].equals(Vt))continue;kt&&(Kt=kt),It&&(xt=It),It=Le[pn],kt=Vt?Vt.sub(It)._unit()._perp():Kt,Kt=Kt||kt;let rn=Kt.add(kt);rn.x===0&&rn.y===0||rn._unit();const rr=rn.x*kt.x+rn.y*kt.y,Pn=rr!==0?1/rr:1/0,zn=Kt.x*kt.y-Kt.y*kt.x>0;let Sr="miter";const Nr=2;Sr==="miter"&&Pn>Nr&&(Sr="bevel"),Sr==="bevel"&&(Pn>100&&(Sr="flipbevel"),Pn<Nr&&(Sr="miter"));const Lr=(Dr,$r,Xr,ji)=>{const Ii=new At(Dr.x,Dr.y),Mr=new At(Dr.x,Dr.y);Ii.x+=$r.x*ji,Ii.y+=$r.y*ji,Mr.x-=$r.x*Math.max(Xr,1),Mr.y-=$r.y*Math.max(Xr,1),ft.push($r),ut.push(Ii),dt.push(Mr)};if(Sr==="miter")rn._mult(Pn),Lr(It,rn,0,0);else if(Sr==="flipbevel")rn=kt.mult(-1),Lr(It,rn,0,0),Lr(It,rn.mult(-1),0,0);else{const Dr=-Math.sqrt(Pn*Pn-1),$r=zn?Dr:0,Xr=zn?0:Dr;xt&&Lr(It,Kt,$r,Xr),Vt&&Lr(It,kt,$r,Xr)}}et.geometry=[...ut,...dt.reverse(),ut[0]],et.joinNormals=[...ft,...ft.reverse(),ft[ft.length-1]];const wn=et.geometry.length-1;for(let pn=0;pn<wn/2;pn++)if(pn+1<wn/2){let rn=pn,rr=pn+1,Pn=wn-1-pn,zn=wn-2-pn;rn=rn===0?wn-1:rn-1,rr=rr===0?wn-1:rr-1,Pn=Pn===0?wn-1:Pn-1,zn=zn===0?wn-1:zn-1,et.indices.push(Pn),et.indices.push(rr),et.indices.push(rn),et.indices.push(Pn),et.indices.push(zn),et.indices.push(rr)}return et}(p[0]),p=[ue.geometry]}const fe=(Le,Ke)=>Le<(Ke.length-1)/2||Le===Ke.length-1,ie=this.wallMode?[p]:tE(p,500);for(let Le=ie.length-1;Le>=0;Le--){const Ke=ie[Le];(Ke.length===0||(me=Ke[0]).every(Ve=>Ve.x<=0)||me.every(Ve=>Ve.x>=xn)||me.every(Ve=>Ve.y<=0)||me.every(Ve=>Ve.y>=xn))&&ie.splice(Le,1)}var me;let ve;if(j)ve=wH(ie,R,T);else{ve=[];for(const Le of ie)ve.push({polygon:Le,bounds:R})}const Ce=U?this.edgeRadius:0,ke=Ce>0&&this.zoom<17,Fe=(Le,Ke)=>{if(Le.length===0)return!1;const Ve=Le[Le.length-1];return Ke.x===Ve.x&&Ke.y===Ve.y};for(const{polygon:Le,bounds:Ke}of ve){let Ve=0,et=0;for(const _t of Le)U&&!_t[0].equals(_t[_t.length-1])&&_t.push(_t[0]),et+=U?_t.length-1:_t.length;const ut=this.segments.prepareSegment((U?5:4)*et,this.layoutVertexArray,this.indexArray);X.footprintSegIdx<0&&(X.footprintSegIdx=this.footprintSegments.length),X.polygonSegIdx<0&&(X.polygonSegIdx=this.polygonSegments.length);const dt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ft=new hH;if(ft.vertexOffset=this.footprintVertices.length,ft.indexOffset=3*this.footprintIndices.length,ft.ringIndices=[],U){const _t=[],It=[];Ve=ut.vertexLength;for(let Vt=0;Vt<Le.length;Vt++){const Kt=Le[Vt];Kt.length&&Vt!==0&&It.push(_t.length/2);const kt=[];let Rn,wn;Rn=Kt[1].sub(Kt[0])._perp()._unit(),ft.ringIndices.push(Kt.length-1);for(let pn=1;pn<Kt.length;pn++){const rn=Kt[pn],rr=Kt[pn===Kt.length-1?1:pn+1],Pn=rn.clone();if(Ce){wn=rr.sub(rn)._perp()._unit();const zn=Rn.add(wn)._unit(),Sr=Ce*Math.min(4,1/(Rn.x*zn.x+Rn.y*zn.y));Pn.x+=Sr*zn.x,Pn.y+=Sr*zn.y,Pn.x=Math.round(Pn.x),Pn.y=Math.round(Pn.y),Rn=wn}if(!Q||Ce!==0&&!ke||Fe(kt,Pn)||kt.push(Pn),cS(this.layoutVertexArray,Pn.x,Pn.y,0,0,1,1,0),this.wallMode){const zn=fe(pn,Kt);uS(this.wallVertexArray,ue.joinNormals[pn],!zn)}ut.vertexLength++,this.footprintVertices.emplaceBack(rn.x,rn.y),_t.push(rn.x,rn.y),j&&hS(this.layoutVertexExtArray,z.projectTilePoint(Pn.x,Pn.y,T),z.upVector(T,Pn.x,Pn.y))}Q&&(Ce===0||ke)&&(kt.length!==0&&Fe(kt,kt[0])&&kt.pop(),this.groundEffect.addData(kt,Ke,W))}const xt=this.wallMode?ue.indices:sS(_t,It);for(let Vt=0;Vt<xt.length;Vt+=3)this.footprintIndices.emplaceBack(ft.vertexOffset+xt[Vt+0],ft.vertexOffset+xt[Vt+1],ft.vertexOffset+xt[Vt+2]),this.indexArray.emplaceBack(Ve+xt[Vt],Ve+xt[Vt+2],Ve+xt[Vt+1]),ut.primitiveLength++;ft.indexCount+=xt.length,ft.vertexCount+=this.footprintVertices.length-ft.vertexOffset}for(let _t=0;_t<Le.length;_t++){const It=Le[_t];V.startRing(X,It[0]);let xt=It.length>4&&yH(It[It.length-2],It[0],It[1]),Vt=Ce?Mde(It[It.length-2],It[0],It[1],Ce):0;const Kt=[];let kt,Rn,wn;Rn=It[1].sub(It[0])._perp()._unit();let pn=!0;for(let rn=1,rr=0;rn<It.length;rn++){let Pn=It[rn-1],zn=It[rn];const Sr=It[rn===It.length-1?1:rn+1];if(V.appendEdge(X,zn,Pn),Sk(zn,Pn,Ke)){Ce&&(Rn=Sr.sub(zn)._perp()._unit(),pn=!pn);continue}const Nr=zn.sub(Pn)._perp(),Lr=Nr.x/(Math.abs(Nr.x)+Math.abs(Nr.y)),Dr=Nr.y>0?1:0,$r=Pn.dist(zn);if(rr+$r>32768&&(rr=0),Ce){wn=Sr.sub(zn)._perp()._unit();let Mr=vH(Pn,zn,Sr,gH(Rn,wn),Ce);isNaN(Mr)&&(Mr=0);const bi=zn.sub(Pn)._unit();Pn=Pn.add(bi.mult(Vt))._round(),zn=zn.add(bi.mult(-Mr))._round(),Vt=Mr,Rn=wn,Q&&this.zoom>=17&&(Fe(Kt,Pn)||Kt.push(Pn),Fe(Kt,zn)||Kt.push(zn))}const Xr=ut.vertexLength,ji=It.length>4&&yH(Pn,zn,Sr);let Ii=xH(rr,xt,pn);if(cS(this.layoutVertexArray,Pn.x,Pn.y,Lr,Dr,0,0,Ii),cS(this.layoutVertexArray,Pn.x,Pn.y,Lr,Dr,0,1,Ii),this.wallMode){const Mr=fe(rn-1,It),bi=ue.joinNormals[rn-1];uS(this.wallVertexArray,bi,Mr),uS(this.wallVertexArray,bi,Mr)}if(rr+=$r,Ii=xH(rr,ji,!pn),xt=ji,cS(this.layoutVertexArray,zn.x,zn.y,Lr,Dr,0,0,Ii),cS(this.layoutVertexArray,zn.x,zn.y,Lr,Dr,0,1,Ii),this.wallMode){const Mr=fe(rn,It),bi=ue.joinNormals[rn];uS(this.wallVertexArray,bi,Mr),uS(this.wallVertexArray,bi,Mr)}if(ut.vertexLength+=4,this.indexArray.emplaceBack(Xr+0,Xr+1,Xr+2),this.indexArray.emplaceBack(Xr+1,Xr+3,Xr+2),ut.primitiveLength+=2,Ce){const Mr=Ve+(rn===1?It.length-2:rn-2),bi=rn===1?Ve:Mr+1;if(this.indexArray.emplaceBack(Xr+1,Mr,Xr+3),this.indexArray.emplaceBack(Mr,bi,Xr+3),ut.primitiveLength+=2,kt===void 0&&(kt=Xr),!Sk(Sr,It[rn],Ke)){const Ti=rn===It.length-1?kt:ut.vertexLength;this.indexArray.emplaceBack(Xr+2,Xr+3,Ti),this.indexArray.emplaceBack(Xr+3,Ti+1,Ti),this.indexArray.emplaceBack(Xr+3,bi,Ti+1),ut.primitiveLength+=3}pn=!pn}if(j){const Mr=this.layoutVertexExtArray,bi=z.projectTilePoint(Pn.x,Pn.y,T),Ti=z.projectTilePoint(zn.x,zn.y,T),ls=z.upVector(T,Pn.x,Pn.y),Xs=z.upVector(T,zn.x,zn.y);hS(Mr,bi,ls),hS(Mr,bi,ls),hS(Mr,Ti,Xs),hS(Mr,Ti,Xs)}}U&&(Ve+=It.length-1),Q&&Ce&&this.zoom>=17&&(Kt.length!==0&&Fe(Kt,Kt[0])&&Kt.pop(),this.groundEffect.addData(Kt,Ke,W,Ce>0))}this.footprintSegments.push(ft),dt.triangleCount=this.indexArray.length-dt.triangleArrayOffset,this.polygonSegments.push(dt),++X.footprintSegLen,++X.polygonSegLen}if(X.vertexCount=this.layoutVertexArray.length-X.vertexArrayOffset,X.groundVertexCount=this.groundEffect.vertexArray.length-X.groundVertexArrayOffset,X.vertexCount!==0){if(X.centroidXY=V.borders?uH:this.encodeCentroid(V,X),this.centroidData.push(X),V.borders){this.featuresOnBorder.push(V);const Le=this.featuresOnBorder.length-1;for(let Ke=0;Ke<V.borders.length;Ke++)V.borders[Ke][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ke].push(Le)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,y,b,M,T,G),this.groundEffect.addPaintPropertiesData(u,y,b,M,T,G),this.maxHeight=Math.max(this.maxHeight,ne)}}sortBorders(){for(let u=0;u<this.borderFeatureIndices.length;u++)this.borderFeatureIndices[u].sort((p,y)=>this.featuresOnBorder[p].borders[u][0]-this.featuresOnBorder[y].borders[u][0])}splitToSubtiles(){const u=[];for(let k=0;k<this.centroidData.length;k++){const G=this.centroidData[k],W=+(G.min.y+G.max.y>xn),R=2*W+(+(G.min.x+G.max.x>xn)^W);for(let z=0;z<G.polygonSegLen;z++){const j=G.polygonSegIdx+z;u.push({centroidIdx:k,subtile:R,polygonSegmentIdx:j,triangleSegmentIdx:this.polygonSegments[j].triangleSegIdx})}}const p=new To;u.sort((k,G)=>k.triangleSegmentIdx===G.triangleSegmentIdx?k.subtile-G.subtile:k.triangleSegmentIdx-G.triangleSegmentIdx);let y=0,T=0,b=0;for(const k of u){if(k.triangleSegmentIdx!==y)break;b++}const M=u.length;for(;T!==u.length;){y=u[T].triangleSegmentIdx;let k=0,G=T,W=T;for(let R=G;R<b&&u[R].subtile===k;R++)W++;for(;G!==b;){const R=u[G];k=R.subtile;const z=this.centroidData[R.centroidIdx].min.clone(),j=this.centroidData[R.centroidIdx].max.clone(),U={vertexOffset:this.segments.segments[y].vertexOffset,primitiveOffset:p.length,vertexLength:this.segments.segments[y].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let V=G;V<W;V++){const X=u[V],Q=this.polygonSegments[X.polygonSegmentIdx],ne=this.centroidData[X.centroidIdx].min,ue=this.centroidData[X.centroidIdx].max,fe=this.indexArray.uint16;for(let ie=Q.triangleArrayOffset;ie<Q.triangleArrayOffset+Q.triangleCount;ie++)p.emplaceBack(fe[3*ie],fe[3*ie+1],fe[3*ie+2]);U.primitiveLength+=Q.triangleCount,z.x=Math.min(z.x,ne.x),z.y=Math.min(z.y,ne.y),j.x=Math.max(j.x,ue.x),j.y=Math.max(j.y,ue.y)}U.primitiveLength>0&&this.triangleSubSegments.push({segment:U,min:z,max:j}),G=W;for(let V=G;V<b&&u[V].subtile===u[G].subtile;V++)W++}T=b;for(let R=T;R<M&&u[R].triangleSegmentIdx===u[T].triangleSegmentIdx;R++)b++}p._trim(),this.indexArray=p}getVisibleSegments(u,p,y){const T=new As;if(this.wallMode){for(const X of this.triangleSubSegments)T.segments.push(X.segment);return T}let b=0,M=0;const k=1<<u.canonical.z;if(p){const X=p.getMinMaxForTile(u);X&&(b=X.min,M=X.max)}M+=this.maxHeight;const G=u.toUnwrapped();let W;const R=[G.canonical.x/k+G.wrap,G.canonical.y/k],z=[(G.canonical.x+1)/k+G.wrap,(G.canonical.y+1)/k],j=(X,Q,ne)=>[X[0]*(1-ne[0])+Q[0]*ne[0],X[1]*(1-ne[1])+Q[1]*ne[1]],U=[],V=[];for(const X of this.triangleSubSegments){U[0]=X.min.x/xn,U[1]=X.min.y/xn,V[0]=X.max.x/xn,V[1]=X.max.y/xn;const Q=j(R,z,U),ne=j(R,z,V);if(new ts([Q[0],Q[1],b],[ne[0],ne[1],M]).intersectsPrecise(y)===0){W&&(T.segments.push(W),W=void 0);continue}const ue=X.segment;W&&W.vertexOffset!==ue.vertexOffset&&(T.segments.push(W),W=void 0),W?(W.vertexLength+=ue.vertexLength,W.primitiveLength+=ue.primitiveLength):W={vertexOffset:ue.vertexOffset,primitiveLength:ue.primitiveLength,vertexLength:ue.vertexLength,primitiveOffset:ue.primitiveOffset,sortKey:void 0,vaos:{}}}return W&&T.segments.push(W),T}encodeCentroid(u,p){const y=u.centroid(),T=p.span(),b=Math.min(7,Math.round(T.x*this.tileToMeter/10)),M=Math.min(7,Math.round(T.y*this.tileToMeter/10));return new At(Wt(y.x,1,xn-1)<<3|b,Wt(y.y,1,xn-1)<<3|M)}encodeBorderCentroid(u){if(!u.borders)return new At(0,0);const p=u.borders,y=Number.MAX_VALUE;if(p[0][0]!==y||p[1][0]!==y){const T=p[0][0]!==y?0:1;return new At(6|(p[0][0]!==y?0:65528),(p[T][0]+p[T][1])/2<<3|6)}{const T=p[2][0]!==y?2:3;return new At((p[T][0]+p[T][1])/2<<3|6,6|(p[2][0]!==y?0:65528))}}showCentroid(u){const p=this.centroidData[u.centroidDataIndex];p.flags&=lv,p.centroidXY.x=0,p.centroidXY.y=0,this.writeCentroidToBuffer(p)}writeCentroidToBuffer(u){this.groundEffect.updateHiddenByLandmark(u);const p=u.vertexArrayOffset,y=u.vertexCount+u.vertexArrayOffset,T=u.flags&lv?uH:u.centroidXY,b=this.centroidVertexArray.geta_centroid_pos0(p);if(this.centroidVertexArray.geta_centroid_pos1(p)!==T.y||b!==T.x){for(let M=p;M<y;++M)this.centroidVertexArray.emplace(M,T.x,T.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const u of this.centroidData)this.writeCentroidToBuffer(u)}updateReplacement(u,p,y){if(p.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=p.updateTime;const T=p.getReplacementRegionsForTile(u.toUnwrapped());if(xk(this.activeReplacements,T))return;if(this.activeReplacements=T,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const M of this.centroidData)M.flags&=2147483647;const b=[];for(const M of this.activeReplacements){if(M.order<y)continue;const k=Math.pow(2,M.footprintTileId.canonical.z-u.canonical.z);for(const G of this.centroidData)if(!(G.flags&lv||M.min.x>G.max.x||G.min.x>M.max.x||M.min.y>G.max.y||G.min.y>M.max.y))for(let W=0;W<G.footprintSegLen;W++){const R=this.footprintSegments[G.footprintSegIdx+W];if(b.length=0,Cde(this.footprintVertices,R.vertexOffset,R.vertexCount,M.footprintTileId.canonical,u.canonical,b),sH(M.footprint,b,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-k)){G.flags|=lv;break}}}for(const M of this.centroidData)this.writeCentroidToBuffer(M);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(u,p,y){let T=!1;for(let b=0;b<y.footprintSegLen;b++){const M=this.footprintSegments[y.footprintSegIdx+b];let k=0;for(const G of M.ringIndices){for(let W=k,R=G+k-1;W<G+k;R=W++){const z=this.footprintVertices.int16[2*(W+M.vertexOffset)+0],j=this.footprintVertices.int16[2*(W+M.vertexOffset)+1],U=this.footprintVertices.int16[2*(R+M.vertexOffset)+1];j>p!=U>p&&u<(this.footprintVertices.int16[2*(R+M.vertexOffset)+0]-z)*(p-j)/(U-j)+z&&(T=!T)}k=G}}return T}getHeightAtTileCoord(u,p){let y=Number.NEGATIVE_INFINITY,T=!0;const b=4*(u+xn)*xn+(p+xn);if(this.partLookup.hasOwnProperty(b)){const M=this.partLookup[b];return M?{height:M.height,hidden:!!(M.flags&lv)}:void 0}for(const M of this.centroidData)u>M.max.x||M.min.x>u||p>M.max.y||M.min.y>p||this.footprintContainsPoint(u,p,M)&&M&&M.height>y&&(y=M.height,this.partLookup[b]=M,T=!!(M.flags&lv));if(y!==Number.NEGATIVE_INFINITY)return{height:y,hidden:T};this.partLookup[b]=void 0}}function gH(v,u){const p=v.add(u)._unit();return v.x*p.x+v.y*p.y}function Mde(v,u,p,y){const T=u.sub(v)._perp()._unit(),b=p.sub(u)._perp()._unit();return vH(v,u,p,gH(T,b),y)}function vH(v,u,p,y,T){const b=Math.sqrt(1-y*y);return Math.min(v.dist(u)/3,u.dist(p)/3,T*b/y)}function Sk(v,u,p){return v.x<p[0].x&&u.x<p[0].x||v.x>p[1].x&&u.x>p[1].x||v.y<p[0].y&&u.y<p[0].y||v.y>p[1].y&&u.y>p[1].y}function _H(v,u){return v.x<u[0].x||v.x>u[1].x||v.y<u[0].y||v.y>u[1].y}function yH(v,u,p){if(v.x<0||v.x>=xn||u.x<0||u.x>=xn||p.x<0||p.x>=xn)return!1;const y=p.sub(u),T=y.perp(),b=v.sub(u);return(y.x*b.x+y.y*b.y)/Math.sqrt((y.x*y.x+y.y*y.y)*(b.x*b.x+b.y*b.y))>-.866&&T.x*b.x+T.y*b.y<0}function xH(v,u,p){const y=u?2|v:-3&v;return p?1|y:-2&y}function bH(){const v=Math.PI/32,u=Math.tan(v),p=le;return p*Math.sqrt(1+2*u*u)-p}function wH(v,u,p){const y=1<<p.z,T=Xe(p.x/y),b=Xe((p.x+1)/y),M=$e(p.y/y),k=$e((p.y+1)/y);return function(G,W,R,z,j=0,U){const V=[];if(!G.length||!R||!z)return V;const X=(ve,Ce)=>{for(const ke of ve)V.push({polygon:ke,bounds:Ce})},Q=Math.ceil(Math.log2(R)),ne=Math.ceil(Math.log2(z)),ue=Q-ne,fe=[];for(let ve=0;ve<Math.abs(ue);ve++)fe.push(ue>0?0:1);for(let ve=0;ve<Math.min(Q,ne);ve++)fe.push(0),fe.push(1);let ie=G;if(ie=rE(ie,W[0].y-j,W[1].y+j,1),ie=rE(ie,W[0].x-j,W[1].x+j,0),!ie.length)return V;const me=[];for(fe.length?me.push({polygons:ie,bounds:W,depth:0}):X(ie,W);me.length;){const ve=me.pop(),Ce=ve.depth,ke=fe[Ce],Fe=ve.bounds[0],Le=ve.bounds[1],Ke=ke===0?Fe.x:Fe.y,Ve=ke===0?Le.x:Le.y,et=U?U(ke,Ke,Ve):.5*(Ke+Ve),ut=rE(ve.polygons,Ke-j,et+j,ke),dt=rE(ve.polygons,et-j,Ve+j,ke);if(ut.length){const ft=[Fe,new At(ke===0?et:Le.x,ke===1?et:Le.y)];fe.length>Ce+1?me.push({polygons:ut,bounds:ft,depth:Ce+1}):X(ut,ft)}if(dt.length){const ft=[new At(ke===0?et:Fe.x,ke===1?et:Fe.y),Le];fe.length>Ce+1?me.push({polygons:dt,bounds:ft,depth:Ce+1}):X(dt,ft)}}return V}(v,u,Math.ceil((b-T)/11.25),Math.ceil((M-k)/11.25),1,(G,W,R)=>{if(G===0)return .5*(W+R);{const z=$e((p.y+W/xn)/y);return(Ge(.5*($e((p.y+R/xn)/y)+z))*y-p.y)*xn}})}function Cde(v,u,p,y,T,b){const M=Math.pow(2,y.z-T.z);for(let k=0;k<p;k++){let G=v.int16[2*(k+u)+0],W=v.int16[2*(k+u)+1];G=(G+T.x*xn)*M-y.x*xn,W=(W+T.y*xn)*M-y.y*xn,b.push(new At(G,W))}}let SH,AH;function dS(v,u){return v.x*u.x+v.y*u.y}function TH(v,u){if(v.length===1){let p=0;const y=u[p++];let T;for(;!T||y.equals(T);)if(T=u[p++],!T)return 1/0;for(;p<u.length;p++){const b=u[p],M=v[0],k=T.sub(y),G=b.sub(y),W=M.sub(y),R=dS(k,k),z=dS(k,G),j=dS(G,G),U=dS(W,k),V=dS(W,G),X=R*j-z*z,Q=(j*U-z*V)/X,ne=(R*V-z*U)/X,ue=y.z*(1-Q-ne)+T.z*Q+b.z*ne;if(isFinite(ue))return ue}return 1/0}{let p=1/0;for(const y of u)p=Math.min(p,y.z);return p}}function MH(v,u,p,y,T,b,M,k){const G=M*T.getElevationAt(v,u,!0,!0),W=b[0]!==0,R=W?b[1]===0?M*(b[0]/7-450):M*function(z,j,U){const V=Math.floor(j[0]/8),X=Math.floor(j[1]/8),Q=10*(j[0]-8*V),ne=10*(j[1]-8*X),ue=z.getElevationAt(V,X,!0,!0),fe=z.getMeterToDEM(U),ie=Math.floor(.5*(Q*fe-1)),me=Math.floor(.5*(ne*fe-1)),ve=z.tileCoordToPixel(V,X),Ce=2*ie+1,ke=2*me+1,Fe=function(dt,ft,_t,It,xt){return[dt.getElevationAtPixel(ft,_t,!0),dt.getElevationAtPixel(ft+xt,_t,!0),dt.getElevationAtPixel(ft,_t+xt,!0),dt.getElevationAtPixel(ft+It,_t+xt,!0)]}(z,ve.x-ie,ve.y-me,Ce,ke),Le=Math.abs(Fe[0]-Fe[1]),Ke=Math.abs(Fe[2]-Fe[3]),Ve=Math.abs(Fe[0]-Fe[2])+Math.abs(Fe[1]-Fe[3]),et=Math.min(.25,.5*fe*(Le+Ke)/Ce),ut=Math.min(.25,.5*fe*Ve/ke);return ue+Math.max(et*Q,ut*ne)}(T,b,k):G;return{base:G+(p===0)?-1:p,top:W?Math.max(R+y,G+p+2):G+y}}Nn(aE,"FillExtrusionBucket",{omit:["layers","features"]}),Nn(dH,"PartData"),Nn(hH,"FootprintSegment"),Nn(fH,"BorderCentroidData"),Nn(mH,"GroundEffect");const Ede=ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Ide=ti([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:Pde}=Ede,Rde=ti([{name:"a_packed",components:4,type:"Float32"}]),{members:Lde}=Rde,Dde=ti([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Bde}=Dde;class CH{constructor(u,p){this.width=u,this.height=p,this.nextRow=0,this.image=new av({width:u,height:p}),this.positions={},this.uploaded=!1}getDash(u,p){const y=this.getKey(u,p);return this.positions[y]}trim(){const u=this.width,p=this.height=di(this.nextRow);this.image.resize({width:u,height:p})}getKey(u,p){return u.join(",")+p}getDashRanges(u,p,y){const T=[];let b=u.length%2==1?-u[u.length-1]*y:0,M=u[0]*y,k=!0;T.push({left:b,right:M,isDash:k,zeroLength:u[0]===0});let G=u[0];for(let W=1;W<u.length;W++){k=!k;const R=u[W];b=G*y,G+=R,M=G*y,T.push({left:b,right:M,isDash:k,zeroLength:R===0})}return T}addRoundDash(u,p,y){const T=p/2;for(let b=-y;b<=y;b++){const M=this.width*(this.nextRow+y+b);let k=0,G=u[k];for(let W=0;W<this.width;W++){W/G.right>1&&(G=u[++k]);const R=Math.abs(W-G.left),z=Math.abs(W-G.right),j=Math.min(R,z);let U;const V=b/y*(T+1);if(G.isDash){const X=T-Math.abs(V);U=Math.sqrt(j*j+X*X)}else U=T-Math.sqrt(j*j+V*V);this.image.data[M+W]=Math.max(0,Math.min(255,U+128))}}}addRegularDash(u,p){for(let G=u.length-1;G>=0;--G){const W=u[G],R=u[G+1];W.zeroLength?u.splice(G,1):R&&R.isDash===W.isDash&&(R.left=W.left,u.splice(G,1))}const y=u[0],T=u[u.length-1];y.isDash===T.isDash&&(y.left=T.left-this.width,T.right=y.right+this.width);const b=this.width*this.nextRow;let M=0,k=u[M];for(let G=0;G<this.width;G++){G/k.right>1&&(k=u[++M]);const W=Math.abs(G-k.left),R=Math.abs(G-k.right),z=Math.min(W,R);this.image.data[b+G]=Math.max(0,Math.min(255,(k.isDash?z:-z)+p+128))}}addDash(u,p){const y=this.getKey(u,p);if(this.positions[y])return this.positions[y];const T=p==="round",b=T?7:0,M=2*b+1;if(this.nextRow+M>this.height)return Bt("LineAtlas out of space"),null;u.length===0&&u.push(1);let k=0;for(let R=0;R<u.length;R++)u[R]<0&&(Bt("Negative value is found in line dasharray, replacing values with 0"),u[R]=0),k+=u[R];if(k!==0){const R=this.width/k,z=this.getDashRanges(u,this.width,R);T?this.addRoundDash(z,R,b):this.addRegularDash(z,p==="square"?.5*R:0)}const G=this.nextRow+b;this.nextRow+=M;const W={tl:[G,b],br:[k,0]};return this.positions[y]=W,W}}Nn(CH,"LineAtlas");const kde=s1.VectorTileFeature.types,Ode=Math.cos(Math.PI/180*37.5),Fde=Math.cos(Math.PI/180*5);class Ak{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=u.index,this.projection=u.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new nl,this.layoutVertexArray2=new kl,this.patternVertexArray=new fo,this.indexArray=new To,this.programConfigurations=new ir(u.layers,{zoom:u.zoom,lut:u.lut}),this.segments=new As,this.maxLineLength=0,this.zOffsetVertexArray=new Gf,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.tessellationStep=u.tessellationStep?u.tessellationStep:xn/64}updateFootprints(u,p){}populate(u,p,y,T){this.hasPattern=dk("line",this.layers,p);const b=this.layers[0].layout.get("line-sort-key"),M=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!M.isConstant()||!!M.constantOr(0);const k=[];for(const{feature:z,id:j,index:U,sourceLayerIndex:V}of u){const X=this.layers[0]._featureFilter.needGeometry,Q=mn(z,X);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),Q,y))continue;const ne=b?b.evaluate(Q,{},y):void 0,ue={id:j,properties:z.properties,type:z.type,sourceLayerIndex:V,index:U,geometry:X?Q.geometry:fn(z,y,T),patterns:{},sortKey:ne};k.push(ue)}b&&k.sort((z,j)=>z.sortKey-j.sortKey);const{lineAtlas:G,featureIndex:W}=p,R=this.addConstantDashes(G);for(const z of k){const{geometry:j,index:U,sourceLayerIndex:V}=z;if(R&&this.addFeatureDashes(z,G),this.hasPattern){const X=fk("line",this.layers,z,this.zoom,p);this.patternFeatures.push(X)}else this.addFeature(z,j,U,y,G.positions,p.availableImages,p.brightness);W.insert(u[U].feature,j,U,V,this.index)}}addConstantDashes(u){let p=!1;for(const y of this.layers){const T=y.paint.get("line-dasharray").value,b=y.layout.get("line-cap").value;if(T.kind!=="constant"||b.kind!=="constant")p=!0;else{const M=b.value,k=T.value;if(!k)continue;u.addDash(k,M)}}return p}addFeatureDashes(u,p){const y=this.zoom;for(const T of this.layers){const b=T.paint.get("line-dasharray").value,M=T.layout.get("line-cap").value;if(b.kind==="constant"&&M.kind==="constant")continue;let k,G;if(b.kind==="constant"){if(k=b.value,!k)continue}else k=b.evaluate({zoom:y},u);G=M.kind==="constant"?M.value:M.evaluate({zoom:y},u),p.addDash(k,G),u.patterns[T.id]=p.getKey(k,G)}}update(u,p,y,T,b){const M=Object.keys(u).length!==0;M&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(u,p,M?this.stateDependentLayers:this.layers,y,T,b)}addFeatures(u,p,y,T,b,M){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,p,y,T,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,Lde)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=u.createVertexBuffer(this.patternVertexArray,Bde)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=u.createVertexBuffer(this.zOffsetVertexArray,Ide.members,!0)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Pde),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&u.properties.hasOwnProperty("mapbox_clip_start")&&u.properties.hasOwnProperty("mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,y,T,b,M,k){const G=this.layers[0].layout,W=G.get("line-join").evaluate(u,{}),R=G.get("line-cap").evaluate(u,{}),z=G.get("line-miter-limit"),j=G.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const U of p)this.addLine(U,u,T,W,R,z,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,y,b,M,T,k)}addLine(u,p,y,T,b,M,k){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const G={zoom:this.zoom,lineProgress:void 0},W=this.layers[0].layout,R=T==="none";if(this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<u.length-1;ve++)this.totalDistance+=u[ve].dist(u[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=kde[p.type]==="Polygon";let j=u.length;for(;j>=2&&u[j-1].equals(u[j-2]);)j--;let U=0;for(;U<j-1&&u[U].equals(u[U+1]);)U++;if(j<(z?3:2))return;T==="bevel"&&(M=1.05);const V=this.overscaling<=16?15*xn/(512*this.overscaling):0,X=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let Q,ne,ue,fe,ie,me;this.e1=this.e2=-1,z&&(Q=u[j-2],ie=u[U].sub(Q)._unit()._perp());for(let ve=U;ve<j;ve++){if(ue=ve===j-1?z?u[U+1]:void 0:u[ve+1],ue&&u[ve].equals(ue))continue;if(ie&&(fe=ie),Q&&(ne=Q),Q=u[ve],this.hasZOffset){const ft=W.get("line-z-offset").value;if(ft.kind==="constant")me=ft.value;else{if(this.lineClips){const _t=this.totalDistance/(this.lineClips.end-this.lineClips.start);G.lineProgress=(_t*this.lineClips.start+this.distance+(ne?ne.dist(Q):0))/_t}else Bt(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),G.lineProgress=0;me=ft.evaluate(G,p)}me=me||0}ie=ue?ue.sub(Q)._unit()._perp():fe,fe=fe||ie;const Ce=ne&&ue;let ke=Ce?T:z||R?"butt":b;const Fe=fe.x*ie.x+fe.y*ie.y;if(R){const ft=function(_t){if(_t.patternJoinNone){const It=_t.segmentPoints.length/2,xt=_t.lineSoFar-_t.segmentStart;for(let Vt=0;Vt<It;++Vt){const Kt=_t.segmentPoints[2*Vt+1],kt=Math.round(_t.segmentPoints[2*Vt])+.5+.25*Kt;_t.patternVertexArray.emplaceBack(kt,xt,_t.segmentStart),_t.patternVertexArray.emplaceBack(kt,xt,_t.segmentStart)}_t.segmentPoints.length=0}_t.e1=_t.e2=-1};if(Ce&&Fe<Fde){this.updateDistance(ne,Q),this.addCurrentVertex(Q,fe,1,1,X,me),ft(this),this.addCurrentVertex(Q,ie,-1,-1,X,me);continue}if(ne){if(!ue){this.updateDistance(ne,Q),this.addCurrentVertex(Q,fe,1,1,X,me),ft(this);continue}ke="miter"}}let Le=fe.add(ie);Le.x===0&&Le.y===0||Le._unit();const Ke=Le.x*ie.x+Le.y*ie.y,Ve=Ke!==0?1/Ke:1/0,et=2*Math.sqrt(2-2*Ke),ut=Ke<Ode&&ne&&ue,dt=fe.x*ie.y-fe.y*ie.x>0;if(ut&&ve>U){const ft=Q.dist(ne);if(ft>2*V){const _t=Q.sub(Q.sub(ne)._mult(V/ft)._round());this.updateDistance(ne,_t),this.addCurrentVertex(_t,fe,0,0,X,me),ne=_t}}if(Ce&&ke==="round"&&(Ve<k?ke="miter":Ve<=2&&(ke="fakeround")),ke==="miter"&&Ve>M&&(ke="bevel"),ke==="bevel"&&(Ve>2&&(ke="flipbevel"),Ve<M&&(ke="miter")),ne&&this.updateDistance(ne,Q),ke==="miter")Le._mult(Ve),this.addCurrentVertex(Q,Le,0,0,X,me);else if(ke==="flipbevel"){if(Ve>100)Le=ie.mult(-1);else{const ft=Ve*fe.add(ie).mag()/fe.sub(ie).mag();Le._perp()._mult(ft*(dt?-1:1))}this.addCurrentVertex(Q,Le,0,0,X,me),this.addCurrentVertex(Q,Le.mult(-1),0,0,X,me)}else if(ke==="bevel"||ke==="fakeround"){const ft=-Math.sqrt(Ve*Ve-1),_t=dt?ft:0,It=dt?0:ft;if(ne&&this.addCurrentVertex(Q,fe,_t,It,X,me),ke==="fakeround"){const xt=Math.round(180*et/Math.PI/20);for(let Vt=1;Vt<xt;Vt++){let Kt=Vt/xt;if(Kt!==.5){const Rn=Kt-.5;Kt+=Kt*Rn*(Kt-1)*((1.0904+Fe*(Fe*(3.55645-1.43519*Fe)-3.2452))*Rn*Rn+(.848013+Fe*(.215638*Fe-1.06021)))}const kt=ie.sub(fe)._mult(Kt)._add(fe)._unit()._mult(dt?-1:1);this.addHalfVertex(Q,kt.x,kt.y,!1,dt,0,X,me)}}ue&&this.addCurrentVertex(Q,ie,-_t,-It,X,me)}else ke==="butt"?this.addCurrentVertex(Q,Le,0,0,X,me):ke==="square"?(ne||this.addCurrentVertex(Q,Le,-1,-1,X,me),this.addCurrentVertex(Q,Le,0,0,X,me),ne&&this.addCurrentVertex(Q,Le,1,1,X,me)):ke==="round"&&(ne&&(this.addCurrentVertex(Q,fe,0,0,X,me),this.addCurrentVertex(Q,fe,1,1,X,me,!0)),ue&&(this.addCurrentVertex(Q,ie,-1,-1,X,me,!0),this.addCurrentVertex(Q,ie,0,0,X,me)));if(ut&&ve<j-1){const ft=Q.dist(ue);if(ft>2*V){const _t=Q.add(ue.sub(Q)._mult(V/ft)._round());this.updateDistance(Q,_t),this.addCurrentVertex(_t,ie,0,0,X,me),Q=_t}}}}addVerticesTo(u,p,y,T,b,M,k,G,W,R){const z=(p.w-u.w)/this.tessellationStep|0;if(z>1){this.lineSoFar=u.w;const j=(p.x-u.x)/z,U=(p.y-u.y)/z,V=(p.z-u.z)/z,X=(p.w-u.w)/z;for(let Q=1;Q<z;++Q)u.x+=j,u.y+=U,u.z+=V,this.lineSoFar+=X,this.addHalfVertex(u,y,T,R,!1,k,W,u.z),this.addHalfVertex(u,b,M,R,!0,-G,W,u.z)}this.lineSoFar=p.w,this.addHalfVertex(p,y,T,R,!1,k,W,p.z),this.addHalfVertex(p,b,M,R,!0,-G,W,p.z)}addCurrentVertex(u,p,y,T,b,M,k=!1){const G=p.x+p.y*y,W=p.y-p.x*y,R=p.y*T-p.x,z=-p.y-p.x*T;if(M!=null){const U=xn+10,V=M,X=new QV(u.x,u.y,V,this.lineSoFar),Q=EH(u,-10,U),ne=this.lineSoFar;if(this.currentVertex)if(Q){const ue=this.currentVertexIsOutside,fe=this.currentVertex,ie=new QV(u.x,u.y,V,this.lineSoFar);tH(fe,ie,-10,U),EH(ie,-10,U)||(ue&&(this.e1=this.e2=-1,this.lineSoFar=fe.w,this.addHalfVertex(fe,G,W,k,!1,y,b,fe.z),this.addHalfVertex(fe,R,z,k,!0,-T,b,fe.z)),this.addVerticesTo(fe,ie,G,W,R,z,y,T,b,k))}else{const ue=this.currentVertex;this.currentVertexIsOutside&&(tH(ue,X,-10,U),this.e1=this.e2=-1,this.lineSoFar=ue.w,this.addHalfVertex(ue,G,W,k,!1,y,b,ue.z),this.addHalfVertex(ue,R,z,k,!0,-T,b,ue.z)),this.addVerticesTo(ue,X,G,W,R,z,y,T,b,k)}else Q||(this.addHalfVertex(u,G,W,k,!1,y,b,M),this.addHalfVertex(u,R,z,k,!0,-T,b,M));this.currentVertex=X,this.currentVertexIsOutside=Q,this.lineSoFar=ne}else this.addHalfVertex(u,G,W,k,!1,y,b,M),this.addHalfVertex(u,R,z,k,!0,-T,b,M)}addHalfVertex({x:u,y:p},y,T,b,M,k,G,W){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),M||this.segmentPoints.push(this.lineSoFar-this.segmentStart,k)),this.layoutVertexArray.emplaceBack((u<<1)+(b?1:0),(p<<1)+(M?1:0),Math.round(63*y)+128,Math.round(63*T)+128,1+(k===0?0:k<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=G.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),G.primitiveLength++),M?this.e2=R:this.e1=R,W!=null&&this.zOffsetVertexArray.emplaceBack(W)}updateScaledDistance(){if(this.lineClips){const u=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=u*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}function EH(v,u,p){return v.x<u||v.x>p||v.y<u||v.y>p}let IH,PH;function RH(v,u,p){return u*(xn/(v.tileSize*Math.pow(2,p-v.tileID.overscaledZ)))}function LH(v,u){return 1/RH(v,1,u.tileZoom)}function DH(v,u,p,y){return v.translatePosMatrix(y||u.tileID.projMatrix,u,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}Nn(Ak,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const BH=v=>{const u=[];kH(v)&&u.push("RENDER_LINE_DASH"),v.paint.get("line-gradient")&&u.push("RENDER_LINE_GRADIENT");const p=v.paint.get("line-trim-offset");p[0]===0&&p[1]===0||u.push("RENDER_LINE_TRIM_OFFSET"),v.paint.get("line-border-width").constantOr(1)!==0&&u.push("RENDER_LINE_BORDER");const y=v.layout.get("line-join").constantOr("miter")==="none",T=!!v.paint.get("line-pattern").constantOr(1);return y&&T&&u.push("LINE_JOIN_NONE"),u};function kH(v){const u=v.paint.get("line-dasharray").value;return u.value||u.kind!=="constant"}let Tk;const OH=()=>Tk||(Tk={layout:IH||(IH=new qi({"line-cap":new Jn(Tt.layout_line["line-cap"]),"line-join":new Jn(Tt.layout_line["line-join"]),"line-miter-limit":new vn(Tt.layout_line["line-miter-limit"]),"line-round-limit":new vn(Tt.layout_line["line-round-limit"]),"line-sort-key":new Jn(Tt.layout_line["line-sort-key"]),"line-z-offset":new Jn(Tt.layout_line["line-z-offset"]),visibility:new vn(Tt.layout_line.visibility)})),paint:PH||(PH=new qi({"line-opacity":new Jn(Tt.paint_line["line-opacity"]),"line-color":new Jn(Tt.paint_line["line-color"]),"line-translate":new vn(Tt.paint_line["line-translate"]),"line-translate-anchor":new vn(Tt.paint_line["line-translate-anchor"]),"line-width":new Jn(Tt.paint_line["line-width"]),"line-gap-width":new Jn(Tt.paint_line["line-gap-width"]),"line-offset":new Jn(Tt.paint_line["line-offset"]),"line-blur":new Jn(Tt.paint_line["line-blur"]),"line-dasharray":new Jn(Tt.paint_line["line-dasharray"]),"line-pattern":new Jn(Tt.paint_line["line-pattern"]),"line-gradient":new hc(Tt.paint_line["line-gradient"]),"line-trim-offset":new vn(Tt.paint_line["line-trim-offset"]),"line-trim-fade-range":new vn(Tt.paint_line["line-trim-fade-range"]),"line-trim-color":new vn(Tt.paint_line["line-trim-color"]),"line-emissive-strength":new vn(Tt.paint_line["line-emissive-strength"]),"line-border-width":new Jn(Tt.paint_line["line-border-width"]),"line-border-color":new Jn(Tt.paint_line["line-border-color"]),"line-occlusion-opacity":new vn(Tt.paint_line["line-occlusion-opacity"])}))},Tk);class Nde extends Jn{possiblyEvaluate(u,p){return p=new gs(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,y,T){return p=Ar({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,y,T)}}let fS;function FH(v,u){return u>0?u+2*v:v}const zde=ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ude=ti([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Gde=ti([{name:"a_projected_pos",components:4,type:"Float32"}],4);ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vde=ti([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Hde=ti([{name:"a_texb",components:2,type:"Uint16"}]),jde=ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Wde=ti([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const NH=ti([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$de=ti([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ti([{name:"triangle",components:3,type:"Uint16"}]),ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ti([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ti([{type:"Float32",name:"offsetX"}]),ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ga=24;const Ad=128;function Mk(v,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new gs(v+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:y,interpolationType:T}=p;let b=0;for(;b<y.length&&y[b]<=v;)b++;b=Math.max(0,b-1);let M=b;for(;M<y.length&&y[M]<v+1;)M++;M=Math.min(y.length-1,M);const k=y[b],G=y[M];return p.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:G,interpolationType:T}:{kind:"camera",minZoom:k,maxZoom:G,minSize:p.evaluate(new gs(k)),maxSize:p.evaluate(new gs(G)),interpolationType:T}}}function lE(v,{uSize:u,uSizeT:p},{lowerSize:y,upperSize:T}){return v.kind==="source"?y/Ad:v.kind==="composite"?ur(y/Ad,T/Ad,p):u}function o1(v,u){let p=0,y=0;if(v.kind==="constant")y=v.layoutSize;else if(v.kind!=="source"){const{interpolationType:T,minZoom:b,maxZoom:M}=v,k=T?Wt(pl.interpolationFactor(T,u,b,M),0,1):0;v.kind==="camera"?y=ur(v.minSize,v.maxSize,k):p=k}return{uSizeT:p,uSize:y}}var Xde=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ad,evaluateSizeForFeature:lE,evaluateSizeForZoom:o1,getSizeData:Mk});function qde(v,u,p){return v.sections.forEach(y=>{y.text=function(T,b,M){const k=b.layout.get("text-transform").evaluate(M,{});return k==="uppercase"?T=T.toLocaleUpperCase():k==="lowercase"&&(T=T.toLocaleLowerCase()),Ua.applyArabicShaping&&(T=Ua.applyArabicShaping(T)),T}(y.text,u,p)}),v}const pS={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Yde(v){return v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""}function Zde(v){return v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""||v===""}var zH,Ck,UH,Ek={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Kde(){return zH||(zH=1,Ek.read=function(v,u,p,y,T){var b,M,k=8*T-y-1,G=(1<<k)-1,W=G>>1,R=-7,z=p?T-1:0,j=p?-1:1,U=v[u+z];for(z+=j,b=U&(1<<-R)-1,U>>=-R,R+=k;R>0;b=256*b+v[u+z],z+=j,R-=8);for(M=b&(1<<-R)-1,b>>=-R,R+=y;R>0;M=256*M+v[u+z],z+=j,R-=8);if(b===0)b=1-W;else{if(b===G)return M?NaN:1/0*(U?-1:1);M+=Math.pow(2,y),b-=W}return(U?-1:1)*M*Math.pow(2,b-y)},Ek.write=function(v,u,p,y,T,b){var M,k,G,W=8*b-T-1,R=(1<<W)-1,z=R>>1,j=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=y?0:b-1,V=y?1:-1,X=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(k=isNaN(u)?1:0,M=R):(M=Math.floor(Math.log(u)/Math.LN2),u*(G=Math.pow(2,-M))<1&&(M--,G*=2),(u+=M+z>=1?j/G:j*Math.pow(2,1-z))*G>=2&&(M++,G/=2),M+z>=R?(k=0,M=R):M+z>=1?(k=(u*G-1)*Math.pow(2,T),M+=z):(k=u*Math.pow(2,z-1)*Math.pow(2,T),M=0));T>=8;v[p+U]=255&k,U+=V,k/=256,T-=8);for(M=M<<T|k,W+=T;W>0;v[p+U]=255&M,U+=V,M/=256,W-=8);v[p+U-V]|=128*X}),Ek}function GH(){if(UH)return Ck;UH=1,Ck=u;var v=Kde();function u(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}u.Varint=0,u.Fixed64=1,u.Bytes=2,u.Fixed32=5;var p=4294967296,y=1/p,T=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function b(ie){return ie.type===u.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function M(ie,me,ve){return ve?4294967296*me+(ie>>>0):4294967296*(me>>>0)+(ie>>>0)}function k(ie,me,ve){var Ce=me<=16383?1:me<=2097151?2:me<=268435455?3:Math.floor(Math.log(me)/(7*Math.LN2));ve.realloc(Ce);for(var ke=ve.pos-1;ke>=ie;ke--)ve.buf[ke+Ce]=ve.buf[ke]}function G(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeVarint(ie[ve])}function W(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeSVarint(ie[ve])}function R(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeFloat(ie[ve])}function z(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeDouble(ie[ve])}function j(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeBoolean(ie[ve])}function U(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeFixed32(ie[ve])}function V(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeSFixed32(ie[ve])}function X(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeFixed64(ie[ve])}function Q(ie,me){for(var ve=0;ve<ie.length;ve++)me.writeSFixed64(ie[ve])}function ne(ie,me){return(ie[me]|ie[me+1]<<8|ie[me+2]<<16)+16777216*ie[me+3]}function ue(ie,me,ve){ie[ve]=me,ie[ve+1]=me>>>8,ie[ve+2]=me>>>16,ie[ve+3]=me>>>24}function fe(ie,me){return(ie[me]|ie[me+1]<<8|ie[me+2]<<16)+(ie[me+3]<<24)}return u.prototype={destroy:function(){this.buf=null},readFields:function(ie,me,ve){for(ve=ve||this.length;this.pos<ve;){var Ce=this.readVarint(),ke=Ce>>3,Fe=this.pos;this.type=7&Ce,ie(ke,me,this),this.pos===Fe&&this.skip(Ce)}return me},readMessage:function(ie,me){return this.readFields(ie,me,this.readVarint()+this.pos)},readFixed32:function(){var ie=ne(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=fe(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=ne(this.buf,this.pos)+ne(this.buf,this.pos+4)*p;return this.pos+=8,ie},readSFixed64:function(){var ie=ne(this.buf,this.pos)+fe(this.buf,this.pos+4)*p;return this.pos+=8,ie},readFloat:function(){var ie=v.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=v.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var me,ve,Ce=this.buf;return me=127&(ve=Ce[this.pos++]),ve<128?me:(me|=(127&(ve=Ce[this.pos++]))<<7,ve<128?me:(me|=(127&(ve=Ce[this.pos++]))<<14,ve<128?me:(me|=(127&(ve=Ce[this.pos++]))<<21,ve<128?me:function(ke,Fe,Le){var Ke,Ve,et=Le.buf;if(Ke=(112&(Ve=et[Le.pos++]))>>4,Ve<128||(Ke|=(127&(Ve=et[Le.pos++]))<<3,Ve<128)||(Ke|=(127&(Ve=et[Le.pos++]))<<10,Ve<128)||(Ke|=(127&(Ve=et[Le.pos++]))<<17,Ve<128)||(Ke|=(127&(Ve=et[Le.pos++]))<<24,Ve<128)||(Ke|=(1&(Ve=et[Le.pos++]))<<31,Ve<128))return M(ke,Ke,Fe);throw new Error("Expected varint not more than 10 bytes")}(me|=(15&(ve=Ce[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,me=this.pos;return this.pos=ie,ie-me>=12&&T?function(ve,Ce,ke){return T.decode(ve.subarray(Ce,ke))}(this.buf,me,ie):function(ve,Ce,ke){for(var Fe="",Le=Ce;Le<ke;){var Ke,Ve,et,ut=ve[Le],dt=null,ft=ut>239?4:ut>223?3:ut>191?2:1;if(Le+ft>ke)break;ft===1?ut<128&&(dt=ut):ft===2?(192&(Ke=ve[Le+1]))==128&&(dt=(31&ut)<<6|63&Ke)<=127&&(dt=null):ft===3?(Ve=ve[Le+2],(192&(Ke=ve[Le+1]))==128&&(192&Ve)==128&&((dt=(15&ut)<<12|(63&Ke)<<6|63&Ve)<=2047||dt>=55296&&dt<=57343)&&(dt=null)):ft===4&&(Ve=ve[Le+2],et=ve[Le+3],(192&(Ke=ve[Le+1]))==128&&(192&Ve)==128&&(192&et)==128&&((dt=(15&ut)<<18|(63&Ke)<<12|(63&Ve)<<6|63&et)<=65535||dt>=1114112)&&(dt=null)),dt===null?(dt=65533,ft=1):dt>65535&&(dt-=65536,Fe+=String.fromCharCode(dt>>>10&1023|55296),dt=56320|1023&dt),Fe+=String.fromCharCode(dt),Le+=ft}return Fe}(this.buf,me,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,me=this.buf.subarray(this.pos,ie);return this.pos=ie,me},readPackedVarint:function(ie,me){if(this.type!==u.Bytes)return ie.push(this.readVarint(me));var ve=b(this);for(ie=ie||[];this.pos<ve;)ie.push(this.readVarint(me));return ie},readPackedSVarint:function(ie){if(this.type!==u.Bytes)return ie.push(this.readSVarint());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==u.Bytes)return ie.push(this.readBoolean());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==u.Bytes)return ie.push(this.readFloat());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==u.Bytes)return ie.push(this.readDouble());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==u.Bytes)return ie.push(this.readFixed32());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==u.Bytes)return ie.push(this.readSFixed32());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==u.Bytes)return ie.push(this.readFixed64());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==u.Bytes)return ie.push(this.readSFixed64());var me=b(this);for(ie=ie||[];this.pos<me;)ie.push(this.readSFixed64());return ie},skip:function(ie){var me=7&ie;if(me===u.Varint)for(;this.buf[this.pos++]>127;);else if(me===u.Bytes)this.pos=this.readVarint()+this.pos;else if(me===u.Fixed32)this.pos+=4;else{if(me!==u.Fixed64)throw new Error("Unimplemented type: "+me);this.pos+=8}},writeTag:function(ie,me){this.writeVarint(ie<<3|me)},realloc:function(ie){for(var me=this.length||16;me<this.pos+ie;)me*=2;if(me!==this.length){var ve=new Uint8Array(me);ve.set(this.buf),this.buf=ve,this.length=me}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),ue(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),ue(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),ue(this.buf,-1&ie,this.pos),ue(this.buf,Math.floor(ie*y),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),ue(this.buf,-1&ie,this.pos),ue(this.buf,Math.floor(ie*y),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(me,ve){var Ce,ke;if(me>=0?(Ce=me%4294967296|0,ke=me/4294967296|0):(ke=~(-me/4294967296),4294967295^(Ce=~(-me%4294967296))?Ce=Ce+1|0:(Ce=0,ke=ke+1|0)),me>=18446744073709552e3||me<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Fe,Le,Ke){Ke.buf[Ke.pos++]=127&Fe|128,Fe>>>=7,Ke.buf[Ke.pos++]=127&Fe|128,Fe>>>=7,Ke.buf[Ke.pos++]=127&Fe|128,Fe>>>=7,Ke.buf[Ke.pos++]=127&Fe|128,Ke.buf[Ke.pos]=127&(Fe>>>=7)}(Ce,0,ve),function(Fe,Le){var Ke=(7&Fe)<<4;Le.buf[Le.pos++]|=Ke|((Fe>>>=3)?128:0),Fe&&(Le.buf[Le.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Le.buf[Le.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Le.buf[Le.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Le.buf[Le.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Le.buf[Le.pos++]=127&Fe)))))}(ke,ve)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var me=this.pos;this.pos=function(Ce,ke,Fe){for(var Le,Ke,Ve=0;Ve<ke.length;Ve++){if((Le=ke.charCodeAt(Ve))>55295&&Le<57344){if(!Ke){Le>56319||Ve+1===ke.length?(Ce[Fe++]=239,Ce[Fe++]=191,Ce[Fe++]=189):Ke=Le;continue}if(Le<56320){Ce[Fe++]=239,Ce[Fe++]=191,Ce[Fe++]=189,Ke=Le;continue}Le=Ke-55296<<10|Le-56320|65536,Ke=null}else Ke&&(Ce[Fe++]=239,Ce[Fe++]=191,Ce[Fe++]=189,Ke=null);Le<128?Ce[Fe++]=Le:(Le<2048?Ce[Fe++]=Le>>6|192:(Le<65536?Ce[Fe++]=Le>>12|224:(Ce[Fe++]=Le>>18|240,Ce[Fe++]=Le>>12&63|128),Ce[Fe++]=Le>>6&63|128),Ce[Fe++]=63&Le|128)}return Fe}(this.buf,ie,this.pos);var ve=this.pos-me;ve>=128&&k(me,ve,this),this.pos=me-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(ie){this.realloc(4),v.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),v.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var me=ie.length;this.writeVarint(me),this.realloc(me);for(var ve=0;ve<me;ve++)this.buf[this.pos++]=ie[ve]},writeRawMessage:function(ie,me){this.pos++;var ve=this.pos;ie(me,this);var Ce=this.pos-ve;Ce>=128&&k(ve,Ce,this),this.pos=ve-1,this.writeVarint(Ce),this.pos+=Ce},writeMessage:function(ie,me,ve){this.writeTag(ie,u.Bytes),this.writeRawMessage(me,ve)},writePackedVarint:function(ie,me){me.length&&this.writeMessage(ie,G,me)},writePackedSVarint:function(ie,me){me.length&&this.writeMessage(ie,W,me)},writePackedBoolean:function(ie,me){me.length&&this.writeMessage(ie,j,me)},writePackedFloat:function(ie,me){me.length&&this.writeMessage(ie,R,me)},writePackedDouble:function(ie,me){me.length&&this.writeMessage(ie,z,me)},writePackedFixed32:function(ie,me){me.length&&this.writeMessage(ie,U,me)},writePackedSFixed32:function(ie,me){me.length&&this.writeMessage(ie,V,me)},writePackedFixed64:function(ie,me){me.length&&this.writeMessage(ie,X,me)},writePackedSFixed64:function(ie,me){me.length&&this.writeMessage(ie,Q,me)},writeBytesField:function(ie,me){this.writeTag(ie,u.Bytes),this.writeBytes(me)},writeFixed32Field:function(ie,me){this.writeTag(ie,u.Fixed32),this.writeFixed32(me)},writeSFixed32Field:function(ie,me){this.writeTag(ie,u.Fixed32),this.writeSFixed32(me)},writeFixed64Field:function(ie,me){this.writeTag(ie,u.Fixed64),this.writeFixed64(me)},writeSFixed64Field:function(ie,me){this.writeTag(ie,u.Fixed64),this.writeSFixed64(me)},writeVarintField:function(ie,me){this.writeTag(ie,u.Varint),this.writeVarint(me)},writeSVarintField:function(ie,me){this.writeTag(ie,u.Varint),this.writeSVarint(me)},writeStringField:function(ie,me){this.writeTag(ie,u.Bytes),this.writeString(me)},writeFloatField:function(ie,me){this.writeTag(ie,u.Fixed32),this.writeFloat(me)},writeDoubleField:function(ie,me){this.writeTag(ie,u.Fixed64),this.writeDouble(me)},writeBooleanField:function(ie,me){this.writeVarintField(ie,!!me)}},Ck}var cE=d(GH());const Ik=3;function Jde(v,u,p){u.glyphs=[],v===1&&p.readMessage(Qde,u)}function Qde(v,u,p){if(v===3){const{id:y,bitmap:T,width:b,height:M,left:k,top:G,advance:W}=p.readMessage(efe,{});u.glyphs.push({id:y,bitmap:new av({width:b+2*Ik,height:M+2*Ik},T),metrics:{width:b,height:M,left:k,top:G,advance:W}})}else v===4?u.ascender=p.readSVarint():v===5&&(u.descender=p.readSVarint())}function efe(v,u,p){v===1?u.id=p.readVarint():v===2?u.bitmap=p.readBytes():v===3?u.width=p.readVarint():v===4?u.height=p.readVarint():v===5?u.left=p.readSVarint():v===6?u.top=p.readSVarint():v===7&&(u.advance=p.readVarint())}const VH=Ik,Pu={horizontal:1,vertical:2,horizontalOnly:3};class mS{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const y=new mS;return y.scale=u||1,y.fontStack=p,y}static forImage(u){const p=new mS;return p.imageName=u,p}}class a1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const y=new a1;for(let T=0;T<u.sections.length;T++){const b=u.sections[T];b.image?y.addImageSection(b):y.addTextSection(b,p)}return y}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSections(){return this.sections}getSectionIndex(u){return this.sectionIndex[u]}getCodePoint(u){return this.text.codePointAt(u)}verticalizePunctuation(u){this.text=function(p,y){let T="";for(let b=0;b<p.length;b++){const M=p.charCodeAt(b+1)||null,k=p.charCodeAt(b-1)||null;T+=!y&&(M&&Df(M)&&!pS[p[b+1]]||k&&Df(k)&&!pS[p[b-1]])||!pS[p[b]]?p[b]:pS[p[b]]}return T}(this.text,u)}trim(){let u=0;for(let y=0;y<this.text.length&&uE[this.text.charCodeAt(y)];y++)u++;let p=this.text.length;for(let y=this.text.length-1;y>=0&&y>=u&&uE[this.text.charCodeAt(y)];y--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const y=new a1;return y.text=this.text.substring(u,p),y.sectionIndex=this.sectionIndex.slice(u,p),y.sections=this.sections,y}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(mS.forText(u.scale,u.fontStack||p));const y=this.sections.length-1;for(let T=0;T<u.text.length;++T)this.sectionIndex.push(y)}addImageSection(u){const p=u.image?u.image.namePrimary:"";if(p.length===0)return void Bt("Can't add FormattedSection with an empty image.");const y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCodePoint(y),this.sections.push(mS.forImage(p)),this.sectionIndex.push(this.sections.length-1)):Bt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pk(v,u,p,y,T,b,M,k,G,W,R,z,j,U,V){const X=a1.fromFeature(v,T);z===Pu.vertical&&X.verticalizePunctuation(j);let Q=[];const ne=function(ve,Ce,ke,Fe,Le,Ke){if(!ve)return[];const Ve=[],et=function(_t,It,xt,Vt,Kt,kt){let Rn=0;for(let wn=0;wn<_t.length();wn++){const pn=_t.getSection(wn);Rn+=HH(_t.getCodePoint(wn),pn,Vt,Kt,It,kt)}return Rn/Math.max(1,Math.ceil(Rn/xt))}(ve,Ce,ke,Fe,Le,Ke),ut=ve.text.indexOf("")>=0;let dt=0;for(let _t=0;_t<ve.length();_t++){const It=ve.getSection(_t),xt=ve.getCodePoint(_t);if(uE[xt]||(dt+=HH(xt,It,Fe,Le,Ce,Ke)),_t<ve.length()-1){const Vt=!((ft=xt)<11904||!(Kn["Bopomofo Extended"](ft)||Kn.Bopomofo(ft)||Kn["CJK Compatibility Forms"](ft)||Kn["CJK Compatibility Ideographs"](ft)||Kn["CJK Compatibility"](ft)||Kn["CJK Radicals Supplement"](ft)||Kn["CJK Strokes"](ft)||Kn["CJK Symbols and Punctuation"](ft)||Kn["CJK Unified Ideographs Extension A"](ft)||Kn["CJK Unified Ideographs"](ft)||Kn["Enclosed CJK Letters and Months"](ft)||Kn["Halfwidth and Fullwidth Forms"](ft)||Kn.Hiragana(ft)||Kn["Ideographic Description Characters"](ft)||Kn["Kangxi Radicals"](ft)||Kn["Katakana Phonetic Extensions"](ft)||Kn.Katakana(ft)||Kn["Vertical Forms"](ft)||Kn["Yi Radicals"](ft)||Kn["Yi Syllables"](ft)));(tfe[xt]||Vt||It.imageName)&&Ve.push(WH(_t+1,dt,et,Ve,nfe(xt,ve.getCodePoint(_t+1),Vt&&ut),!1))}}var ft;return $H(WH(ve.length(),dt,et,Ve,0,!0))}(X,W,b,u,y,U),{processBidirectionalText:ue,processStyledBidirectionalText:fe}=Ua;if(ue&&X.sections.length===1){const ve=ue(X.toString(),ne);for(const Ce of ve){const ke=new a1;ke.text=Ce,ke.sections=X.sections;for(let Fe=0;Fe<Ce.length;Fe++)ke.sectionIndex.push(0);Q.push(ke)}}else if(fe){const ve=fe(X.text,X.sectionIndex,ne);for(const Ce of ve){const ke=new a1;ke.text=Ce[0],ke.sectionIndex=Ce[1],ke.sections=X.sections,Q.push(ke)}}else Q=function(ve,Ce){const ke=[],Fe=ve.text;let Le=0;for(const Ke of Ce)ke.push(ve.substring(Le,Ke)),Le=Ke;return Le<Fe.length&&ke.push(ve.substring(Le,Fe.length)),ke}(X,ne);const ie=[],me={positionedLines:ie,text:X.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ve,Ce,ke,Fe,Le,Ke,Ve,et,ut,dt,ft,_t){let It=0,xt=0,Vt=0;const Kt=et==="right"?1:et==="left"?0:.5;let kt=!1;for(const Pn of Le){const zn=Pn.getSections();for(const Sr of zn){if(Sr.imageName)continue;const Nr=Ce[Sr.fontStack];if(Nr&&(kt=Nr.ascender!==void 0&&Nr.descender!==void 0,!kt))break}if(!kt)break}let Rn=0;for(const Pn of Le){Pn.trim();const zn=Pn.getMaxScale(),Sr=(zn-1)*Ga,Nr={positionedGlyphs:[],lineOffset:0};ve.positionedLines[Rn]=Nr;const Lr=Nr.positionedGlyphs;let Dr=0;if(!Pn.length()){xt+=Ke,++Rn;continue}let $r=0,Xr=0;for(let Ii=0;Ii<Pn.length();Ii++){const Mr=Pn.getSection(Ii),bi=Pn.getSectionIndex(Ii),Ti=Pn.getCodePoint(Ii);let ls=Mr.scale,Xs=null,vo=null,qs=null,Ns=Ga,fa=0;const Mo=!(ut===Pu.horizontal||!ft&&!om(Ti)||ft&&(uE[Ti]||(wn=Ti,Kn.Arabic(wn)||Kn["Arabic Supplement"](wn)||Kn["Arabic Extended-A"](wn)||Kn["Arabic Presentation Forms-A"](wn)||Kn["Arabic Presentation Forms-B"](wn))));if(Mr.imageName){const Va=Fe[Mr.imageName];if(!Va)continue;qs=Mr.imageName,ve.iconsInText=ve.iconsInText||!0,vo=Va.paddedRect;const ns=Va.displaySize;ls=ls*Ga/_t,Xs={width:ns[0],height:ns[1],left:0,top:-VH,advance:Mo?ns[1]:ns[0],localGlyph:!1},fa=kt?-Xs.height*ls:zn*Ga-17-ns[1]*ls,Ns=Xs.advance;const _c=(Mo?ns[0]:ns[1])*ls-Ga*zn;_c>0&&_c>Dr&&(Dr=_c)}else{const Va=ke[Mr.fontStack];if(!Va)continue;Va[Ti]&&(vo=Va[Ti]);const ns=Ce[Mr.fontStack];if(!ns)continue;const _c=ns.glyphs[Ti];if(!_c)continue;if(Xs=_c.metrics,Ns=Ti!==8203?Ga:0,kt){const Id=ns.ascender!==void 0?Math.abs(ns.ascender):0,hh=ns.descender!==void 0?Math.abs(ns.descender):0,dh=(Id+hh)*ls;$r<dh&&($r=dh,Xr=(Id-hh)/2*ls),fa=-Id*ls}else fa=(zn-ls)*Ga-17}Mo?(ve.verticalizable=!0,Lr.push({glyph:Ti,imageName:qs,x:It,y:xt+fa,vertical:Mo,scale:ls,localGlyph:Xs.localGlyph,fontStack:Mr.fontStack,sectionIndex:bi,metrics:Xs,rect:vo}),It+=Ns*ls+dt):(Lr.push({glyph:Ti,imageName:qs,x:It,y:xt+fa,vertical:Mo,scale:ls,localGlyph:Xs.localGlyph,fontStack:Mr.fontStack,sectionIndex:bi,metrics:Xs,rect:vo}),It+=Xs.advance*ls+dt)}Lr.length!==0&&(Vt=Math.max(It-dt,Vt),kt?XH(Lr,Kt,Dr,Xr,Ke*zn/2):XH(Lr,Kt,Dr,0,Ke/2)),It=0;const ji=Ke*zn+Dr;Nr.lineOffset=Math.max(Dr,Sr),xt+=ji,++Rn}var wn;const pn=xt,{horizontalAlign:rn,verticalAlign:rr}=Rk(Ve);(function(Pn,zn,Sr,Nr,Lr,Dr){const $r=(zn-Sr)*Lr,Xr=-Dr*Nr;for(const ji of Pn)for(const Ii of ji.positionedGlyphs)Ii.x+=$r,Ii.y+=Xr})(ve.positionedLines,Kt,rn,rr,Vt,pn),ve.top+=-rr*pn,ve.bottom=ve.top+pn,ve.left+=-rn*Vt,ve.right=ve.left+Vt,ve.hasBaseline=kt}(me,u,p,y,Q,M,k,G,z,W,j,V),!function(ve){for(const Ce of ve)if(Ce.positionedGlyphs.length!==0)return!1;return!0}(ie)&&me}const uE={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},tfe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function HH(v,u,p,y,T,b){if(u.imageName){const M=y[u.imageName];return M?M.displaySize[0]*u.scale*Ga/b+T:0}{const M=p[u.fontStack],k=M&&M.glyphs[v];return k?k.metrics.advance*u.scale+T:0}}function jH(v,u,p,y){const T=Math.pow(v-u,2);return y?v<u?T/2:2*T:T+Math.abs(p)*p}function nfe(v,u,p){let y=0;return v===10&&(y-=1e4),p&&(y+=150),v!==40&&v!==65288||(y+=50),u!==41&&u!==65289||(y+=50),y}function WH(v,u,p,y,T,b){let M=null,k=jH(u,p,T,b);for(const G of y){const W=jH(u-G.x,p,T,b)+G.badness;W<=k&&(M=G,k=W)}return{index:v,x:u,priorBreak:M,badness:k}}function $H(v){return v?$H(v.priorBreak).concat(v.index):[]}function Rk(v){let u=.5,p=.5;switch(v){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(v){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function XH(v,u,p,y,T){if(!(u||p||y||T))return;const b=v.length-1,M=v[b],k=(M.x+M.metrics.advance*M.scale)*u;for(let G=0;G<=b;G++)v[G].x-=k,v[G].y+=p+y+T}function rfe(v,u,p,y){const{horizontalAlign:T,verticalAlign:b}=Rk(y),M=p[0]-v.displaySize[0]*T,k=p[1]-v.displaySize[1]*b;return{imagePrimary:v,imageSecondary:u,top:k,bottom:k+v.displaySize[1],left:M,right:M+v.displaySize[0]}}function qH(v,u,p,y,T,b){const M=v.imagePrimary;let k;if(M.content){const Q=M.content,ne=M.pixelRatio||1;k=[Q[0]/ne,Q[1]/ne,M.displaySize[0]-Q[2]/ne,M.displaySize[1]-Q[3]/ne]}const G=u.left*b,W=u.right*b;let R,z,j,U;p==="width"||p==="both"?(U=T[0]+G-y[3],z=T[0]+W+y[1]):(U=T[0]+(G+W-M.displaySize[0])/2,z=U+M.displaySize[0]);const V=u.top*b,X=u.bottom*b;return p==="height"||p==="both"?(R=T[1]+V-y[0],j=T[1]+X+y[2]):(R=T[1]+(V+X-M.displaySize[1])/2,j=R+M.displaySize[1]),{imagePrimary:M,imageSecondary:void 0,top:R,right:z,bottom:j,left:U,collisionPadding:k}}class gm extends At{constructor(u,p,y,T,b){super(u,p),this.angle=T,this.z=y,b!==void 0&&(this.segment=b)}clone(){return new gm(this.x,this.y,this.z,this.angle,this.segment)}}function YH(v,u,p,y,T){if(u.segment===void 0)return!0;let b=u,M=u.segment+1,k=0;for(;k>-p/2;){if(M--,M<0)return!1;k-=v[M].dist(b),b=v[M]}k+=v[M].dist(v[M+1]),M++;const G=[];let W=0;for(;k<p/2;){const R=v[M],z=v[M+1];if(!z)return!1;let j=v[M-1].angleTo(R)-R.angleTo(z);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),G.push({distance:k,angleDelta:j}),W+=j;k-G[0].distance>y;)W-=G.shift().angleDelta;if(W>T)return!1;M++,k+=R.dist(z)}return!0}function ZH(v){let u=0;for(let p=0;p<v.length-1;p++)u+=v[p].dist(v[p+1]);return u}function KH(v,u,p){return v?.6*u*p:0}function JH(v,u){return Math.max(v?v.right-v.left:0,u?u.right-u.left:0)}function ife(v,u,p,y,T,b){const M=KH(p,T,b),k=JH(p,y)*b;let G=0;const W=ZH(v)/2;for(let R=0;R<v.length-1;R++){const z=v[R],j=v[R+1],U=z.dist(j);if(G+U>W){const V=(W-G)/U,X=ur(z.x,j.x,V),Q=ur(z.y,j.y,V),ne=new gm(X,Q,0,j.angleTo(z),R);return!M||YH(v,ne,k,M,u)?ne:void 0}G+=U}}function sfe(v,u,p,y,T,b,M,k,G){const W=KH(y,b,M),R=JH(y,T),z=R*M,j=v[0].x===0||v[0].x===G||v[0].y===0||v[0].y===G;return u-z<u/4&&(u=z+u/4),QH(v,j?u/2*k%u:(R/2+2*b)*M*k%u,u,W,p,z,j,!1,G)}function QH(v,u,p,y,T,b,M,k,G){const W=b/2,R=ZH(v);let z=0,j=u-p,U=[];for(let V=0;V<v.length-1;V++){const X=v[V],Q=v[V+1],ne=X.dist(Q),ue=Q.angleTo(X);for(;j+p<z+ne;){j+=p;const fe=(j-z)/ne,ie=ur(X.x,Q.x,fe),me=ur(X.y,Q.y,fe);if(ie>=0&&ie<G&&me>=0&&me<G&&j-W>=0&&j+W<=R){const ve=new gm(ie,me,0,ue,V);y&&!YH(v,ve,b,y,T)||U.push(ve)}}z+=ne}return k||U.length||M||(U=QH(v,z/2,p,y,T,b,M,!0,G)),U}function e9(v,u,p,y,T){const b=[];for(let M=0;M<v.length;M++){const k=v[M];let G;for(let W=0;W<k.length-1;W++){let R=k[W],z=k[W+1];R.x<u&&z.x<u||(R.x<u?R=new At(u,R.y+(u-R.x)/(z.x-R.x)*(z.y-R.y))._round():z.x<u&&(z=new At(u,R.y+(u-R.x)/(z.x-R.x)*(z.y-R.y))._round()),R.y<p&&z.y<p||(R.y<p?R=new At(R.x+(p-R.y)/(z.y-R.y)*(z.x-R.x),p)._round():z.y<p&&(z=new At(R.x+(p-R.y)/(z.y-R.y)*(z.x-R.x),p)._round()),R.x>=y&&z.x>=y||(R.x>=y?R=new At(y,R.y+(y-R.x)/(z.x-R.x)*(z.y-R.y))._round():z.x>=y&&(z=new At(y,R.y+(y-R.x)/(z.x-R.x)*(z.y-R.y))._round()),R.y>=T&&z.y>=T||(R.y>=T?R=new At(R.x+(T-R.y)/(z.y-R.y)*(z.x-R.x),T)._round():z.y>=T&&(z=new At(R.x+(T-R.y)/(z.y-R.y)*(z.x-R.x),T)._round()),G&&R.equals(G[G.length-1])||(G=[R],b.push(G)),G.push(z)))))}}return b}function t9(v){let u=0,p=0;for(const M of v)u+=M.w*M.h,p=Math.max(p,M.w);v.sort((M,k)=>k.h-M.h);const y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let T=0,b=0;for(const M of v)for(let k=y.length-1;k>=0;k--){const G=y[k];if(!(M.w>G.w||M.h>G.h)){if(M.x=G.x,M.y=G.y,b=Math.max(b,M.y+M.h),T=Math.max(T,M.x+M.w),M.w===G.w&&M.h===G.h){const W=y.pop();k<y.length&&(y[k]=W)}else M.h===G.h?(G.x+=M.w,G.w-=M.w):M.w===G.w?(G.y+=M.h,G.h-=M.h):(y.push({x:G.x+M.w,y:G.y,w:G.w-M.w,h:M.h}),G.y+=M.h,G.h-=M.h);break}}return{w:T,h:b,fill:u/(T*b)||0}}Nn(gm,"Anchor");const gS=1;class Lk{constructor(u,{pixelRatio:p,version:y,stretchX:T,stretchY:b,content:M},k){this.paddedRect=u,this.pixelRatio=p,this.stretchX=T,this.stretchY=b,this.content=M,this.version=y,this.padding=k}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class n9{constructor(u,p,y){const T={},b={};this.haveRenderCallbacks=[];const M=[];this.addImages(u,T,gS,M),this.addImages(p,b,2,M);const{w:k,h:G}=t9(M),W=new yl({width:k||1,height:G||1});for(const R in u){const z=u[R],j=T[R].paddedRect;yl.copy(z.data,W,{x:0,y:0},{x:j.x+gS,y:j.y+gS},z.data,y,z.sdf)}for(const R in p){const z=p[R],j=b[R].paddedRect;let U=b[R].padding;const V=j.x+U,X=j.y+U,Q=z.data.width,ne=z.data.height;U=U>1?U-1:U,yl.copy(z.data,W,{x:0,y:0},{x:V,y:X},z.data,y),yl.copy(z.data,W,{x:0,y:ne-U},{x:V,y:X-U},{width:Q,height:U},y),yl.copy(z.data,W,{x:0,y:0},{x:V,y:X+ne},{width:Q,height:U},y),yl.copy(z.data,W,{x:Q-U,y:0},{x:V-U,y:X},{width:U,height:ne},y),yl.copy(z.data,W,{x:0,y:0},{x:V+Q,y:X},{width:U,height:ne},y),yl.copy(z.data,W,{x:Q-U,y:ne-U},{x:V-U,y:X-U},{width:U,height:U},y),yl.copy(z.data,W,{x:0,y:ne-U},{x:V+Q,y:X-U},{width:U,height:U},y),yl.copy(z.data,W,{x:0,y:0},{x:V+Q,y:X+ne},{width:U,height:U},y),yl.copy(z.data,W,{x:Q-U,y:0},{x:V-U,y:X+ne},{width:U,height:U},y)}this.image=W,this.iconPositions=T,this.patternPositions=b}addImages(u,p,y,T){for(const b in u){const M=u[b],k={x:0,y:0,w:M.data.width+2*y,h:M.data.height+2*y};T.push(k),p[b]=new Lk(k,M,y),M.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(u,p,y){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(T=>u.hasImage(T,y)),u.dispatchRenderCallbacks(this.haveRenderCallbacks,y);for(const T in u.getUpdatedImages(y))this.patchUpdatedImage(this.iconPositions[T],u.getImage(T,y),p),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T,y),p)}patchUpdatedImage(u,p,y){if(!u||!p||u.version===p.version)return;u.version=p.version;const[T,b]=u.tl;y.update(p.data,{position:{x:T,y:b}})}}Nn(Lk,"ImagePosition"),Nn(n9,"ImageAtlas");const vS=1e20;function r9(v,u,p,y,T,b,M,k,G){for(let W=u;W<u+y;W++)i9(v,p*b+W,b,T,M,k,G);for(let W=p;W<p+T;W++)i9(v,W*b+u,1,y,M,k,G)}function i9(v,u,p,y,T,b,M){b[0]=0,M[0]=-vS,M[1]=vS,T[0]=v[u];for(let k=1,G=0,W=0;k<y;k++){T[k]=v[u+k*p];const R=k*k;do{const z=b[G];W=(T[k]-T[z]+R-z*z)/(k-z)/2}while(W<=M[G]&&--G>-1);G++,b[G]=k,M[G]=W,M[G+1]=vS}for(let k=0,G=0;k<y;k++){for(;M[G+1]<k;)G++;const W=b[G],R=k-W;v[u+k*p]=T[W]+R*R}}const Td=2,Dk={none:0,ideographs:1,all:2};class l1{constructor(u,p,y){this.requestManager=u,this.localGlyphMode=p,this.localFontFamily=y,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(u,p){this.urls[p]=u}getGlyphs(u,p,y){const T=[],b=this.urls[p]||it.GLYPHS_URL;for(const M in u)for(const k of u[M])T.push({stack:M,id:k});nr(T,({stack:M,id:k},G)=>{let W=this.entries[M];W||(W=this.entries[M]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=W.glyphs[k];if(R!==void 0)return void G(null,{stack:M,id:k,glyph:R});if(R=this._tinySDF(W,M,k),R)return W.glyphs[k]=R,void G(null,{stack:M,id:k,glyph:R});const z=Math.floor(k/256);if(256*z>65535)return void G(new Error("glyphs > 65535 not supported"));if(W.ranges[z])return void G(null,{stack:M,id:k,glyph:R});let j=W.requests[z];j||(j=W.requests[z]=[],l1.loadGlyphRange(M,z,b,this.requestManager,(U,V)=>{if(V){W.ascender=V.ascender,W.descender=V.descender;for(const X in V.glyphs)this._doesCharSupportLocalGlyph(+X)||(W.glyphs[+X]=V.glyphs[+X]);W.ranges[z]=!0}for(const X of j)X(U,V);delete W.requests[z]})),j.push((U,V)=>{U?G(U):V&&G(null,{stack:M,id:k,glyph:V.glyphs[k]||null})})},(M,k)=>{if(M)y(M);else if(k){const G={};for(const{stack:W,id:R,glyph:z}of k)G[W]===void 0&&(G[W]={}),G[W].glyphs===void 0&&(G[W].glyphs={}),G[W].glyphs[R]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},G[W].ascender=this.entries[W].ascender,G[W].descender=this.entries[W].descender;y(null,G)}})}_doesCharSupportLocalGlyph(u){return this.localGlyphMode!==Dk.none&&(this.localGlyphMode===Dk.all?!!this.localFontFamily:!!this.localFontFamily&&(Kn["CJK Unified Ideographs"](u)||Kn["Hangul Syllables"](u)||Kn.Hiragana(u)||Kn.Katakana(u)||Kn["CJK Symbols and Punctuation"](u)||Kn["CJK Unified Ideographs Extension A"](u)||Kn["CJK Unified Ideographs Extension B"](u)))}_tinySDF(u,p,y){const T=this.localFontFamily;if(!T||!this._doesCharSupportLocalGlyph(y))return;let b=u.tinySDF;if(!b){let X="400";/bold/i.test(p)?X="900":/medium/i.test(p)?X="500":/light/i.test(p)&&(X="200"),b=u.tinySDF=new l1.TinySDF({fontFamily:T,fontWeight:X,fontSize:24*Td,buffer:3*Td,radius:8*Td}),b.fontWeight=X}if(this.localGlyphs[b.fontWeight][y])return this.localGlyphs[b.fontWeight][y];const M=String.fromCodePoint(y),{data:k,width:G,height:W,glyphWidth:R,glyphHeight:z,glyphLeft:j,glyphTop:U,glyphAdvance:V}=b.draw(M);return this.localGlyphs[b.fontWeight][y]={id:y,bitmap:new av({width:G,height:W},k),metrics:{width:R/Td,height:z/Td,left:j/Td,top:U/Td-27,advance:V/Td,localGlyph:!0}}}}l1.loadGlyphRange=function(v,u,p,y,T){const b=256*u,M=b+255,k=y.transformRequest(y.normalizeGlyphsURL(p).replace("{fontstack}",v).replace("{range}",`${b}-${M}`),Qi.Glyphs);ks(k,(G,W)=>{if(G)T(G);else if(W){const R={},z=function(j){return new cE(j).readFields(Jde,{})}(W);for(const j of z.glyphs)R[j.id]=j;T(null,{glyphs:R,ascender:z.ascender,descender:z.descender})}})},l1.TinySDF=class{constructor({fontSize:v=24,buffer:u=3,radius:p=8,cutoff:y=.25,fontFamily:T="sans-serif",fontWeight:b="normal",fontStyle:M="normal"}={}){this.buffer=u,this.cutoff=y,this.radius=p;const k=this.size=v+4*u,G=this._createCanvas(k),W=this.ctx=G.getContext("2d",{willReadFrequently:!0});W.font=`${M} ${b} ${v}px ${T}`,W.textBaseline="alphabetic",W.textAlign="left",W.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(v){const u=document.createElement("canvas");return u.width=u.height=v,u}draw(v){const{width:u,actualBoundingBoxAscent:p,actualBoundingBoxDescent:y,actualBoundingBoxLeft:T,actualBoundingBoxRight:b}=this.ctx.measureText(v),M=Math.ceil(p),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-T))),G=Math.min(this.size-this.buffer,M+Math.ceil(y)),W=k+2*this.buffer,R=G+2*this.buffer,z=Math.max(W*R,0),j=new Uint8ClampedArray(z),U={data:j,width:W,height:R,glyphWidth:k,glyphHeight:G,glyphTop:M,glyphLeft:0,glyphAdvance:u};if(k===0||G===0)return U;const{ctx:V,buffer:X,gridInner:Q,gridOuter:ne}=this;V.clearRect(X,X,k,G),V.fillText(v,X,X+M);const ue=V.getImageData(X,X,k,G);ne.fill(vS,0,z),Q.fill(0,0,z);for(let fe=0;fe<G;fe++)for(let ie=0;ie<k;ie++){const me=ue.data[4*(fe*k+ie)+3]/255;if(me===0)continue;const ve=(fe+X)*W+ie+X;if(me===1)ne[ve]=0,Q[ve]=vS;else{const Ce=.5-me;ne[ve]=Ce>0?Ce*Ce:0,Q[ve]=Ce<0?Ce*Ce:0}}r9(ne,0,0,W,R,W,this.f,this.v,this.z),r9(Q,X,X,k,G,W,this.f,this.v,this.z);for(let fe=0;fe<z;fe++){const ie=Math.sqrt(ne[fe])-Math.sqrt(Q[fe]);j[fe]=Math.round(255-255*(ie/this.radius+this.cutoff))}return U}};const cv=gS;function s9(v,u,p,y){const T=[],b=v.imagePrimary,M=b.pixelRatio,k=b.paddedRect.w-2*cv,G=b.paddedRect.h-2*cv,W=v.right-v.left,R=v.bottom-v.top,z=b.stretchX||[[0,k]],j=b.stretchY||[[0,G]],U=(Ke,Ve)=>Ke+Ve[1]-Ve[0],V=z.reduce(U,0),X=j.reduce(U,0),Q=k-V,ne=G-X;let ue=0,fe=V,ie=0,me=X,ve=0,Ce=Q,ke=0,Fe=ne;if(b.content&&y){const Ke=b.content;ue=hE(z,0,Ke[0]),ie=hE(j,0,Ke[1]),fe=hE(z,Ke[0],Ke[2]),me=hE(j,Ke[1],Ke[3]),ve=Ke[0]-ue,ke=Ke[1]-ie,Ce=Ke[2]-Ke[0]-fe,Fe=Ke[3]-Ke[1]-me}const Le=(Ke,Ve,et,ut)=>{const dt=dE(Ke.stretch-ue,fe,W,v.left),ft=fE(Ke.fixed-ve,Ce,Ke.stretch,V),_t=dE(Ve.stretch-ie,me,R,v.top),It=fE(Ve.fixed-ke,Fe,Ve.stretch,X),xt=dE(et.stretch-ue,fe,W,v.left),Vt=fE(et.fixed-ve,Ce,et.stretch,V),Kt=dE(ut.stretch-ie,me,R,v.top),kt=fE(ut.fixed-ke,Fe,ut.stretch,X),Rn=new At(dt,_t),wn=new At(xt,_t),pn=new At(xt,Kt),rn=new At(dt,Kt),rr=new At(ft/M,It/M),Pn=new At(Vt/M,kt/M),zn=u*Math.PI/180;if(zn){const Xr=Math.sin(zn),ji=Math.cos(zn),Ii=[ji,-Xr,Xr,ji];Rn._matMult(Ii),wn._matMult(Ii),rn._matMult(Ii),pn._matMult(Ii)}const Sr=Ke.stretch+Ke.fixed,Nr=et.stretch+et.fixed,Lr=Ve.stretch+Ve.fixed,Dr=ut.stretch+ut.fixed,$r=v.imageSecondary;return{tl:Rn,tr:wn,bl:rn,br:pn,texPrimary:{x:b.paddedRect.x+cv+Sr,y:b.paddedRect.y+cv+Lr,w:Nr-Sr,h:Dr-Lr},texSecondary:$r?{x:$r.paddedRect.x+cv+Sr,y:$r.paddedRect.y+cv+Lr,w:Nr-Sr,h:Dr-Lr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:rr,pixelOffsetBR:Pn,minFontScaleX:Ce/M/W,minFontScaleY:Fe/M/R,isSDF:p}};if(y&&(b.stretchX||b.stretchY)){const Ke=o9(z,Q,V),Ve=o9(j,ne,X);for(let et=0;et<Ke.length-1;et++){const ut=Ke[et],dt=Ke[et+1];for(let ft=0;ft<Ve.length-1;ft++)T.push(Le(ut,Ve[ft],dt,Ve[ft+1]))}}else T.push(Le({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:G+1}));return T}function hE(v,u,p){let y=0;for(const T of v)y+=Math.max(u,Math.min(p,T[1]))-Math.max(u,Math.min(p,T[0]));return y}function o9(v,u,p){const y=[{fixed:-cv,stretch:0}];for(const[T,b]of v){const M=y[y.length-1];y.push({fixed:T-M.stretch,stretch:M.stretch}),y.push({fixed:T-M.stretch,stretch:M.stretch+(b-T)})}return y.push({fixed:u+cv,stretch:p}),y}function dE(v,u,p,y){return v/u*p+y}function fE(v,u,p,y){return v-u*p/y}function ofe(v,u,p,y){const T=u+v.positionedLines[y].lineOffset;return y===0?p+T/2:p+(T+(u+v.positionedLines[y-1].lineOffset))/2}function afe(v,u=1,p=!1){let y=1/0,T=1/0,b=-1/0,M=-1/0;const k=v[0];for(let U=0;U<k.length;U++){const V=k[U];(!U||V.x<y)&&(y=V.x),(!U||V.y<T)&&(T=V.y),(!U||V.x>b)&&(b=V.x),(!U||V.y>M)&&(M=V.y)}const G=Math.min(b-y,M-T);let W=G/2;const R=new td([],lfe);if(G===0)return new At(y,T);for(let U=y;U<b;U+=G)for(let V=T;V<M;V+=G)R.push(new c1(U+W,V+W,W,v));let z=function(U){let V=0,X=0,Q=0;const ne=U[0];for(let ue=0,fe=ne.length,ie=fe-1;ue<fe;ie=ue++){const me=ne[ue],ve=ne[ie],Ce=me.x*ve.y-ve.x*me.y;X+=(me.x+ve.x)*Ce,Q+=(me.y+ve.y)*Ce,V+=3*Ce}return new c1(X/V,Q/V,0,U)}(v),j=R.length;for(;R.length;){const U=R.pop();(U.d>z.d||!z.d)&&(z=U,p&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,j)),U.max-z.d<=u||(W=U.h/2,R.push(new c1(U.p.x-W,U.p.y-W,W,v)),R.push(new c1(U.p.x+W,U.p.y-W,W,v)),R.push(new c1(U.p.x-W,U.p.y+W,W,v)),R.push(new c1(U.p.x+W,U.p.y+W,W,v)),j+=4)}return p&&(console.log(`num probes: ${j}`),console.log(`best distance: ${z.d}`)),z.p}function lfe(v,u){return u.max-v.max}class c1{constructor(u,p,y,T){this.p=new At(u,p),this.h=y,this.d=function(b,M){let k=!1,G=1/0;for(let W=0;W<M.length;W++){const R=M[W];for(let z=0,j=R.length,U=j-1;z<j;U=z++){const V=R[z],X=R[U];V.y>b.y!=X.y>b.y&&b.x<(X.x-V.x)*(b.y-V.y)/(X.y-V.y)+V.x&&(k=!k),G=Math.min(G,Ri(b,V,X))}}return(k?1:-1)*Math.sqrt(G)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}}const Bk=Number.POSITIVE_INFINITY,cfe=Math.sqrt(2);function a9(v,[u,p]){let y=0,T=0;if(p===Bk){u<0&&(u=0);const b=u/cfe;switch(v){case"top-right":case"top-left":T=b-7;break;case"bottom-right":case"bottom-left":T=7-b;break;case"bottom":T=7-u;break;case"top":T=u-7}switch(v){case"top-right":case"bottom-right":y=-b;break;case"top-left":case"bottom-left":y=b;break;case"left":y=u;break;case"right":y=-u}}else{switch(u=Math.abs(u),p=Math.abs(p),v){case"top-right":case"top-left":case"top":T=p-7;break;case"bottom-right":case"bottom-left":case"bottom":T=7-p}switch(v){case"top-right":case"bottom-right":case"right":y=-u;break;case"top-left":case"bottom-left":case"left":y=u}}return[y,T]}function kk(v){switch(v){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ufe(v,u,p,y,T,b,M,k,G,W,R,z,j,U,V){let X=b.textMaxSize.evaluate(u,{},z);X===void 0&&(X=M);const Q=v.layers[0].layout,ne=Q.get("icon-offset").evaluate(u,{},z),ue=c9(p.horizontal)||p.vertical,fe=j.name==="globe",ie=Ga,me=M/ie,ve=v.tilePixelRatio*X/ie,Ce=(dt=v.overscaling,v.zoom>18&&dt>2&&(dt>>=1),Math.max(xn/(512*dt),1)*Q.get("symbol-spacing")),ke=Q.get("text-padding")*v.tilePixelRatio,Fe=Q.get("icon-padding")*v.tilePixelRatio,Le=on(Q.get("text-max-angle")),Ke=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Ve=Q.get("icon-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",et=Q.get("symbol-placement"),ut=Ce/2;var dt;const ft=Q.get("icon-text-fit").evaluate(u,{},z),_t=Q.get("icon-text-fit-padding").evaluate(u,{},z),It=ft!=="none";let xt;v.hasAnyIconTextFit===!1&&It&&(v.hasAnyIconTextFit=!0),y&&It&&(v.allowVerticalPlacement&&p.vertical&&(xt=qH(y,p.vertical,ft,_t,ne,me)),ue&&(y=qH(y,ue,ft,_t,ne,me)));const Vt=(Kt,kt,Rn)=>{if(kt.x<0||kt.x>=xn||kt.y<0||kt.y>=xn)return;let wn=null;if(fe){const{x:pn,y:rn,z:rr}=j.projectTilePoint(kt.x,kt.y,Rn);wn={anchor:new gm(pn,rn,rr,0,void 0),up:j.upVector(Rn,kt.x,kt.y)}}(function(pn,rn,rr,Pn,zn,Sr,Nr,Lr,Dr,$r,Xr,ji,Ii,Mr,bi,Ti,ls,Xs,vo,qs,Ns,fa,Mo,Va,ns,_c,Id){const hh=pn.addToLineVertexArray(rn,Pn);let dh,C_,pv,E_,kS,Pj,Rj,Lj=0,Dj=0,Bj=0,kj=0,uO=-1,hO=-1;const qf={};let Oj=Zo("");const I_=rr?rr.anchor:rn,dO=Dr.layout.get("icon-text-fit").evaluate(Ns,{},ns)!=="none";let fO=0,pO=0;if(Dr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[fO,pO]=Dr.layout.get("text-offset").evaluate(Ns,{},ns).map(Jc=>Jc*Ga):(fO=Dr.layout.get("text-radial-offset").evaluate(Ns,{},ns)*Ga,pO=Bk),pn.allowVerticalPlacement&&zn.vertical){const Jc=zn.vertical;if(bi)Pj=Ok(Jc),Lr&&(Rj=Ok(Lr));else{const Qc=Dr.layout.get("text-rotate").evaluate(Ns,{},ns)+90;pv=pE($r,I_,rn,Xr,ji,Ii,Jc,Mr,Qc,Ti),Lr&&(E_=pE($r,I_,rn,Xr,ji,Ii,Lr,Xs,Qc))}}if(Sr){const Jc=Dr.layout.get("icon-rotate").evaluate(Ns,{},ns),Qc=s9(Sr,Jc,Mo,dO),v1=Lr?s9(Lr,Jc,Mo,dO):void 0;C_=pE($r,I_,rn,Xr,ji,Ii,Sr,Xs,Jc),Lj=4*Qc.length;const Fj=pn.iconSizeData;let P_=null;Fj.kind==="source"?(P_=[Ad*Dr.layout.get("icon-size").evaluate(Ns,{},ns)],P_[0]>uv&&Bt(`${pn.layerIds[0]}: Value for "icon-size" is >= ${_S}. Reduce your "icon-size".`)):Fj.kind==="composite"&&(P_=[Ad*fa.compositeIconSizes[0].evaluate(Ns,{},ns),Ad*fa.compositeIconSizes[1].evaluate(Ns,{},ns)],(P_[0]>uv||P_[1]>uv)&&Bt(`${pn.layerIds[0]}: Value for "icon-size" is >= ${_S}. Reduce your "icon-size".`)),pn.addSymbols(pn.icon,Qc,P_,qs,vo,Ns,!1,rr,rn,hh.lineStartIndex,hh.lineLength,-1,Va,ns,_c,Id),uO=pn.icon.placedSymbolArray.length-1,v1&&(Dj=4*v1.length,pn.addSymbols(pn.icon,v1,P_,qs,vo,Ns,Pu.vertical,rr,rn,hh.lineStartIndex,hh.lineLength,-1,Va,ns,_c,Id),hO=pn.icon.placedSymbolArray.length-1)}for(const Jc in zn.horizontal){const Qc=zn.horizontal[Jc];dh||(Oj=Zo(Qc.text),bi?kS=Ok(Qc):dh=pE($r,I_,rn,Xr,ji,Ii,Qc,Mr,Dr.layout.get("text-rotate").evaluate(Ns,{},ns),Ti));const v1=Qc.positionedLines.length===1;if(Bj+=l9(pn,rr,rn,Qc,Nr,Dr,bi,Ns,Ti,hh,zn.vertical?Pu.horizontal:Pu.horizontalOnly,v1?Object.keys(zn.horizontal):[Jc],qf,uO,fa,Va,ns,_c),v1)break}zn.vertical&&(kj+=l9(pn,rr,rn,zn.vertical,Nr,Dr,bi,Ns,Ti,hh,Pu.vertical,["vertical"],qf,hO,fa,Va,ns,_c));let mv=-1;const mO=(Jc,Qc)=>Jc?Math.max(Jc,Qc):Qc;mv=mO(kS,mv),mv=mO(Pj,mv),mv=mO(Rj,mv);const Tpe=mv>-1?1:0;pn.glyphOffsetArray.length>=65535&&Bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ns.sortKey!==void 0&&pn.addToSortKeyRanges(pn.symbolInstances.length,Ns.sortKey),pn.symbolInstances.emplaceBack(rn.x,rn.y,I_.x,I_.y,I_.z,qf.right>=0?qf.right:-1,qf.center>=0?qf.center:-1,qf.left>=0?qf.left:-1,qf.vertical>=0?qf.vertical:-1,uO,hO,Oj,dh!==void 0?dh:pn.collisionBoxArray.length,dh!==void 0?dh+1:pn.collisionBoxArray.length,pv!==void 0?pv:pn.collisionBoxArray.length,pv!==void 0?pv+1:pn.collisionBoxArray.length,C_!==void 0?C_:pn.collisionBoxArray.length,C_!==void 0?C_+1:pn.collisionBoxArray.length,E_||pn.collisionBoxArray.length,E_?E_+1:pn.collisionBoxArray.length,Xr,Bj,kj,Lj,Dj,Tpe,0,fO,pO,mv,0,dO?1:0)})(v,kt,wn,Kt,p,y,T,xt,v.layers[0],v.collisionBoxArray,u.index,u.sourceLayerIndex,v.index,ke,Ke,G,0,Fe,Ve,ne,u,b,W,R,z,U,V)};if(et==="line")for(const Kt of e9(u.geometry,0,0,xn,xn)){const kt=sfe(Kt,Ce,Le,p.vertical||ue,y,ie,ve,v.overscaling,xn);for(const Rn of kt)ue&&hfe(v,ue.text,ut,Rn)||Vt(Kt,Rn,z)}else if(et==="line-center"){for(const Kt of u.geometry)if(Kt.length>1){const kt=ife(Kt,Le,p.vertical||ue,y,ie,ve);kt&&Vt(Kt,kt,z)}}else if(u.type==="Polygon")for(const Kt of tE(u.geometry,0)){const kt=afe(Kt,16);Vt(Kt[0],new gm(kt.x,kt.y,0,0,void 0),z)}else if(u.type==="LineString")for(const Kt of u.geometry)Vt(Kt,new gm(Kt[0].x,Kt[0].y,0,0,void 0),z);else if(u.type==="Point")for(const Kt of u.geometry)for(const kt of Kt)Vt([kt],new gm(kt.x,kt.y,0,0,void 0),z)}const _S=255,uv=_S*Ad;function l9(v,u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q,ne){const ue=function(me,ve,Ce,ke,Fe,Le,Ke,Ve){const et=[];if(ve.positionedLines.length===0)return et;const ut=ke.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,dt=function(Vt){const Kt=Vt[0],kt=Vt[1],Rn=Kt*kt;return Rn>0?[Kt,-kt]:Rn<0?[-Kt,kt]:Kt===0?[kt,Kt]:[kt,-Kt]}(Ce);let ft=Math.abs(ve.top-ve.bottom);for(const Vt of ve.positionedLines)ft-=Vt.lineOffset;const _t=ve.positionedLines.length,It=ft/_t;let xt=ve.top-Ce[1];for(let Vt=0;Vt<_t;++Vt){const Kt=ve.positionedLines[Vt];xt=ofe(ve,It,xt,Vt);for(const kt of Kt.positionedGlyphs){if(!kt.rect)continue;const Rn=kt.rect||{};let wn=VH+1,pn=!0,rn=1,rr=0;if(kt.imageName){const qs=Ke[kt.imageName];if(!qs)continue;if(qs.sdf){Bt("SDF images are not supported in formatted text and will be ignored.");continue}pn=!1,rn=qs.pixelRatio,wn=gS/rn}const Pn=(Fe||Ve)&&kt.vertical,zn=kt.metrics.advance*kt.scale/2,Sr=kt.metrics,Nr=kt.rect;if(Nr===null)continue;Ve&&ve.verticalizable&&(rr=kt.imageName?zn-kt.metrics.width*kt.scale/2:0);const Lr=Fe?[kt.x+zn,kt.y]:[0,0];let Dr=[0,0],$r=[0,0],Xr=!1;Fe||(Pn?($r=[kt.x+zn+dt[0],kt.y+dt[1]-rr],Xr=!0):Dr=[kt.x+zn+Ce[0],kt.y+Ce[1]-rr]);const ji=Nr.w*kt.scale/(rn*(kt.localGlyph?Td:1)),Ii=Nr.h*kt.scale/(rn*(kt.localGlyph?Td:1));let Mr,bi,Ti,ls;if(Pn){const qs=kt.y-xt,Ns=new At(-zn,zn-qs),fa=-Math.PI/2,Mo=new At(...$r);Mr=new At(-zn+Dr[0],Dr[1]),Mr._rotateAround(fa,Ns)._add(Mo),Mr.x+=-qs+zn,Mr.y-=(Sr.left-wn)*kt.scale;const Va=kt.imageName?Sr.advance*kt.scale:Ga*kt.scale,ns=String.fromCodePoint(kt.glyph);Yde(ns)?Mr.x+=(1-wn)*kt.scale:Zde(ns)?Mr.x+=Va-Sr.height*kt.scale+(-wn-1)*kt.scale:Mr.x+=kt.imageName||Sr.width+2*wn===Nr.w&&Sr.height+2*wn===Nr.h?(Va-Ii)/2:(Va-(Sr.height+2*wn)*kt.scale)/2,bi=new At(Mr.x,Mr.y-ji),Ti=new At(Mr.x+Ii,Mr.y),ls=new At(Mr.x+Ii,Mr.y-ji)}else{const qs=(Sr.left-wn)*kt.scale-zn+Dr[0],Ns=(-Sr.top-wn)*kt.scale+Dr[1],fa=qs+ji,Mo=Ns+Ii;Mr=new At(qs,Ns),bi=new At(fa,Ns),Ti=new At(qs,Mo),ls=new At(fa,Mo)}if(ut){let qs;qs=Fe?new At(0,0):Xr?new At(dt[0],dt[1]):new At(Ce[0],Ce[1]),Mr._rotateAround(ut,qs),bi._rotateAround(ut,qs),Ti._rotateAround(ut,qs),ls._rotateAround(ut,qs)}const Xs=new At(0,0),vo=new At(0,0);et.push({tl:Mr,tr:bi,bl:Ti,br:ls,texPrimary:Rn,texSecondary:void 0,writingMode:ve.writingMode,glyphOffset:Lr,sectionIndex:kt.sectionIndex,isSDF:pn,pixelOffsetTL:Xs,pixelOffsetBR:vo,minFontScaleX:0,minFontScaleY:0})}}return et}(0,y,G,b,M,k,T,v.allowVerticalPlacement),fe=v.textSizeData;let ie=null;fe.kind==="source"?(ie=[Ad*b.layout.get("text-size").evaluate(k,{},Q)],ie[0]>uv&&Bt(`${v.layerIds[0]}: Value for "text-size" is >= ${_S}. Reduce your "text-size".`)):fe.kind==="composite"&&(ie=[Ad*V.compositeTextSizes[0].evaluate(k,{},Q),Ad*V.compositeTextSizes[1].evaluate(k,{},Q)],(ie[0]>uv||ie[1]>uv)&&Bt(`${v.layerIds[0]}: Value for "text-size" is >= ${_S}. Reduce your "text-size".`)),v.addSymbols(v.text,ue,ie,G,M,k,R,u,p,W.lineStartIndex,W.lineLength,U,X,Q,ne,!1);for(const me of z)j[me]=v.text.placedSymbolArray.length-1;return 4*ue.length}function c9(v){for(const u in v)return v[u];return null}function pE(v,u,p,y,T,b,M,k,G,W){let R=M.top,z=M.bottom,j=M.left,U=M.right;const V=M.collisionPadding;if(V&&(j-=V[0],R-=V[1],U+=V[2],z+=V[3]),G){const X=new At(j,R),Q=new At(U,R),ne=new At(j,z),ue=new At(U,z),fe=on(G);let ie=new At(0,0);W&&(ie=new At(W[0],W[1])),X._rotateAround(fe,ie),Q._rotateAround(fe,ie),ne._rotateAround(fe,ie),ue._rotateAround(fe,ie),j=Math.min(X.x,Q.x,ne.x,ue.x),U=Math.max(X.x,Q.x,ne.x,ue.x),R=Math.min(X.y,Q.y,ne.y,ue.y),z=Math.max(X.y,Q.y,ne.y,ue.y)}return v.emplaceBack(u.x,u.y,u.z,p.x,p.y,j,R,U,z,k,y,T,b),v.length-1}function Ok(v){v.collisionPadding&&(v.top-=v.collisionPadding[1],v.bottom+=v.collisionPadding[3]);const u=v.bottom-v.top;return u>0?Math.max(10,u):null}function hfe(v,u,p,y){const T=v.compareText;if(u in T){const b=T[u];for(let M=b.length-1;M>=0;M--)if(y.dist(b[M])<p)return!0}else T[u]=[];return T[u].push(y),!1}function u9(v,u){const p=v.fovAboveCenter,y=v.elevation?v.elevation.getMinElevationBelowMSL()*u:0,T=(v._camera.position[2]*v.worldSize-y)/Math.cos(v._pitch),b=Math.sin(p)*T/Math.sin(Math.max(Math.PI/2-v._pitch-p,.01));let M=Math.sin(v._pitch)*b+T;const k=T*(1/v._horizonShift);return v.elevation&&v.elevation.exaggeration()!==0||(M*=1+Math.max(v.zoom-17,0)),Math.min(1.01*M,k)}function yS(v,u){if(!u.isReprojectedInTileSpace)return{scale:1<<v.z,x:v.x,y:v.y,x2:v.x+1,y2:v.y+1,projection:u};const p=Math.pow(2,-v.z),y=v.x*p,T=(v.x+1)*p,b=v.y*p,M=(v.y+1)*p,k=Xe(y),G=Xe(T),W=$e(b),R=$e(M),z=u.project(k,W),j=u.project(G,W),U=u.project(G,R),V=u.project(k,R);let X=Math.min(z.x,j.x,U.x,V.x),Q=Math.min(z.y,j.y,U.y,V.y),ne=Math.max(z.x,j.x,U.x,V.x),ue=Math.max(z.y,j.y,U.y,V.y);const fe=p/16;function ie(ve,Ce,ke,Fe,Le,Ke){const Ve=(ke+Le)/2,et=(Fe+Ke)/2,ut=u.project(Xe(Ve),$e(et)),dt=Math.max(0,X-ut.x,Q-ut.y,ut.x-ne,ut.y-ue);X=Math.min(X,ut.x),ne=Math.max(ne,ut.x),Q=Math.min(Q,ut.y),ue=Math.max(ue,ut.y),dt>fe&&(ie(ve,ut,ke,Fe,Ve,et),ie(ut,Ce,Ve,et,Le,Ke))}ie(z,j,y,b,T,b),ie(j,U,T,b,T,M),ie(U,V,T,M,y,M),ie(V,z,y,M,y,b),X-=fe,Q-=fe,ne+=fe,ue+=fe;const me=1/Math.max(ne-X,ue-Q);return{scale:me,x:X*me,y:Q*me,x2:ne*me,y2:ue*me,projection:u}}function h9(v,{x:u,y:p},y=0){return new At(((u-y)*v.scale-v.x)*xn,(p*v.scale-v.y)*xn)}const dfe=De.mat4.identity(new Float32Array(16));class hv{constructor(u){this.spec=u,this.name=u.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(u,p){return{x:0,y:0,z:0}}unproject(u,p){return new de(0,0)}projectTilePoint(u,p,y){return{x:u,y:p,z:0}}locationPoint(u,p,y=!0){return u._coordinatePoint(u.locationCoordinate(p),y)}pixelsPerMeter(u,p){return Be(1,u)*p}pixelSpaceConversion(u,p,y){return 1}farthestPixelDistance(u){return u9(u,u.pixelsPerMeter)}pointCoordinate(u,p,y,T){const b=u.horizonLineFromTop(!1),M=new At(p,Math.max(b,y));return u.rayIntersectionCoordinate(u.pointRayIntersection(M,T))}pointCoordinate3D(u,p,y){const T=new At(p,y);if(u.elevation)return u.elevation.pointCoordinate(T);{const b=this.pointCoordinate(u,T.x,T.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(u,p){if(u.elevation&&u.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(u,p.x,p.y);const y=u.horizonLineFromTop();return p.y<y}createInversionMatrix(u,p){return dfe}createTileMatrix(u,p,y){let T,b,M;const k=y.canonical,G=De.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const W=yS(k,this);T=1,b=W.x+y.wrap*W.scale,M=W.y,De.mat4.scale(G,G,[T/W.scale,T/W.scale,u.pixelsPerMeter/p])}else T=p/u.zoomScale(k.z),b=(k.x+Math.pow(2,k.z)*y.wrap)*T,M=k.y*T;return De.mat4.translate(G,G,[b,M,0]),De.mat4.scale(G,G,[T/xn,T/xn,1]),G}upVector(u,p,y){return[0,0,1]}upVectorScale(u,p,y){return{metersToTile:1}}}class ffe extends hv{constructor(u){super(u),this.range=[4,7],this.center=u.center||[-96,37.5];const[p,y]=this.parallels=u.parallels||[29.5,45.5],T=Math.sin(on(p));this.n=(T+Math.sin(on(y)))/2,this.c=1+T*(2*this.n-T),this.r0=Math.sqrt(this.c)/this.n}project(u,p){const{n:y,c:T,r0:b}=this,M=on(u-this.center[0]),k=on(p),G=Math.sqrt(T-2*y*Math.sin(k))/y;return{x:G*Math.sin(M*y),y:G*Math.cos(M*y)-b,z:0}}unproject(u,p){const{n:y,c:T,r0:b}=this,M=b+p;let k=Math.atan2(u,Math.abs(M))*Math.sign(M);M*y<0&&(k-=Math.PI*Math.sign(u)*Math.sign(M));const G=on(this.center[0])*y;k=Gn(k,-Math.PI-G,Math.PI-G);const W=Wt(ct(k/y)+this.center[0],-180,180),R=Math.asin(Wt((T-(u*u+M*M)*y*y)/(2*y),-1,1)),z=Wt(ct(R),-Je,Je);return new de(W,z)}}const xS=1.340264,bS=-.081106,wS=893e-6,SS=.003796,mE=Math.sqrt(3)/2;class pfe extends hv{project(u,p){p=p/180*Math.PI,u=u/180*Math.PI;const y=Math.asin(mE*Math.sin(p)),T=y*y,b=T*T*T;return{x:.5*(u*Math.cos(y)/(mE*(xS+3*bS*T+b*(7*wS+9*SS*T)))/Math.PI+.5),y:1-.5*(y*(xS+bS*T+b*(wS+SS*T))/Math.PI+1),z:0}}unproject(u,p){u=(2*u-.5)*Math.PI;let y=p=(2*(1-p)-1)*Math.PI,T=y*y,b=T*T*T;for(let R,z,j,U=0;U<12&&(z=y*(xS+bS*T+b*(wS+SS*T))-p,j=xS+3*bS*T+b*(7*wS+9*SS*T),R=z/j,y=Wt(y-R,-Math.PI/3,Math.PI/3),T=y*y,b=T*T*T,!(Math.abs(R)<1e-12));++U);const M=mE*u*(xS+3*bS*T+b*(7*wS+9*SS*T))/Math.cos(y),k=Math.asin(Math.sin(y)/mE),G=Wt(180*M/Math.PI,-180,180),W=Wt(180*k/Math.PI,-Je,Je);return new de(G,W)}}class mfe extends hv{constructor(u){super(u),this.wrap=!0,this.supportsWorldCopies=!0}project(u,p){return{x:.5+u/360,y:.5-p/360,z:0}}unproject(u,p){const y=360*(u-.5),T=Wt(360*(.5-p),-Je,Je);return new de(y,T)}}const u1=Math.PI/2;function gE(v){return Math.tan((u1+v)/2)}class gfe extends hv{constructor(u){super(u),this.center=u.center||[0,30];const[p,y]=this.parallels=u.parallels||[30,30];let T=on(p),b=on(y);this.southernCenter=T+b<0,this.southernCenter&&(T=-T,b=-b);const M=Math.cos(T),k=gE(T);this.n=T===b?Math.sin(T):Math.log(M/Math.cos(b))/Math.log(gE(b)/k),this.f=M*Math.pow(gE(T),this.n)/this.n}project(u,p){p=on(p),this.southernCenter&&(p=-p),u=on(u-this.center[0]);const y=1e-6,{n:T,f:b}=this;b>0?p<-u1+y&&(p=-u1+y):p>u1-y&&(p=u1-y);const M=b/Math.pow(gE(p),T);let k=M*Math.sin(T*u),G=b-M*Math.cos(T*u);return k=.5*(k/Math.PI+.5),G=.5*(G/Math.PI+.5),{x:k,y:this.southernCenter?G:1-G,z:0}}unproject(u,p){u=(2*u-.5)*Math.PI,this.southernCenter&&(p=1-p),p=(2*(1-p)-.5)*Math.PI;const{n:y,f:T}=this,b=T-p,M=Math.sign(b),k=Math.sign(y)*Math.sqrt(u*u+b*b);let G=Math.atan2(u,Math.abs(b))*M;b*y<0&&(G-=Math.PI*Math.sign(u)*M);const W=Wt(ct(G/y)+this.center[0],-180,180),R=Wt(ct(2*Math.atan(Math.pow(T/k,1/y))-u1),-Je,Je);return new de(W,this.southernCenter?-R:R)}}class d9 extends hv{constructor(u){super(u),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(u,p){return{x:Oe(u),y:Ge(p),z:0}}unproject(u,p){const y=Xe(u),T=$e(p);return new de(y,T)}}const f9=on(Je);class vfe extends hv{project(u,p){const y=(p=on(p))*p,T=y*y;return{x:.5*((u=on(u))*(.8707-.131979*y+T*(T*(.003971*y-.001529*T)-.013791))/Math.PI+.5),y:1-.5*(p*(1.007226+y*(.015085+T*(.028874*y-.044475-.005916*T)))/Math.PI+1),z:0}}unproject(u,p){u=(2*u-.5)*Math.PI;let y=p=(2*(1-p)-1)*Math.PI,T=25,b=0,M=y*y;do{M=y*y;const W=M*M;b=(y*(1.007226+M*(.015085+W*(.028874*M-.044475-.005916*W)))-p)/(1.007226+M*(.045255+W*(.259866*M-.311325-.005916*11*W))),y=Wt(y-b,-f9,f9)}while(Math.abs(b)>1e-6&&--T>0);M=y*y;const k=Wt(ct(u/(.8707+M*(M*(M*M*M*(.003971-.001529*M)-.013791)-.131979))),-180,180),G=ct(y);return new de(k,G)}}const p9=on(Je);class _fe extends hv{project(u,p){p=on(p),u=on(u);const y=Math.cos(p),T=2/Math.PI,b=Math.acos(y*Math.cos(u/2)),M=Math.sin(b)/b,k=.5*(u*T+2*y*Math.sin(u/2)/M)||0,G=.5*(p+Math.sin(p)/M)||0;return{x:.5*(k/Math.PI+.5),y:1-.5*(G/Math.PI+1),z:0}}unproject(u,p){let y=u=(2*u-.5)*Math.PI,T=p=(2*(1-p)-1)*Math.PI,b=25;const M=1e-6;let k=0,G=0;do{const W=Math.cos(T),R=Math.sin(T),z=2*R*W,j=R*R,U=W*W,V=Math.cos(y/2),X=Math.sin(y/2),Q=2*V*X,ne=X*X,ue=1-U*V*V,fe=ue?1/ue:0,ie=ue?Math.acos(W*V)*Math.sqrt(1/ue):0,me=.5*(2*ie*W*X+2*y/Math.PI)-u,ve=.5*(ie*R+T)-p,Ce=.5*fe*(U*ne+ie*W*V*j)+1/Math.PI,ke=fe*(Q*z/4-ie*R*X),Fe=.125*fe*(z*X-ie*R*U*Q),Le=.5*fe*(j*V+ie*ne*W)+.5,Ke=ke*Fe-Le*Ce;k=(ve*ke-me*Le)/Ke,G=(me*Fe-ve*Ce)/Ke,y=Wt(y-k,-Math.PI,Math.PI),T=Wt(T-G,-p9,p9)}while((Math.abs(k)>M||Math.abs(G)>M)&&--b>0);return new de(ct(y),ct(T))}}class m9 extends hv{constructor(u){super(u),this.center=u.center||[0,0],this.parallels=u.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(on(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(u,p){const{scale:y,cosPhi:T}=this;return{x:on(u)*T*y+.5,y:-Math.sin(on(p))/T*y+.5,z:0}}unproject(u,p){const{scale:y,cosPhi:T}=this,b=-(p-.5)/y,M=Wt(ct((u-.5)/y)/T,-180,180),k=Math.asin(Wt(b*T,-1,1)),G=Wt(ct(k),-Je,Je);return new de(M,G)}}class yfe extends d9{constructor(u){super(u),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(u,p,y){const T=rS(u,p,y),b=KC($f(y));return De.vec3.transformMat4(T,T,b),{x:T[0],y:T[1],z:T[2]}}locationPoint(u,p){const y=te(p.lat,p.lng),T=De.vec3.normalize([],y),b=u.elevation?u.elevation.getAtPointOrZero(u.locationCoordinate(p),u._centerAltitude):u._centerAltitude,M=Be(1,0)*xn*b;De.vec3.scaleAndAdd(y,y,T,M);const k=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(k,u.pixelMatrix,u.globeMatrix),De.vec3.transformMat4(y,y,k),new At(y[0],y[1])}pixelsPerMeter(u,p){return Be(1,0)*p}pixelSpaceConversion(u,p,y){const T=Be(1,u)*p,b=ur(Be(1,45)*p,T,y);return this.pixelsPerMeter(u,p)/b}createTileMatrix(u,p,y){const T=ok($f(y.canonical));return De.mat4.multiply(new Float64Array(16),u.globeMatrix,T)}createInversionMatrix(u,p){const{center:y}=u,T=KC($f(p));return De.mat4.rotateY(T,T,on(y.lng)),De.mat4.rotateX(T,T,on(y.lat)),De.mat4.scale(T,T,[u._pixelsPerMercatorPixel,u._pixelsPerMercatorPixel,1]),Float32Array.from(T)}pointCoordinate(u,p,y,T){return qC(u,p,y,!0)||new wt(0,0)}pointCoordinate3D(u,p,y){const T=this.pointCoordinate(u,p,y,0);return[T.x,T.y,T.z]}isPointAboveHorizon(u,p){return!qC(u,p.x,p.y,!1)}farthestPixelDistance(u){const p=function(T,b){const M=T.cameraToCenterDistance,k=T._centerAltitude*b,G=T._camera,W=T._camera.forward(),R=De.vec3.add([],De.vec3.scale([],W,-M),[0,0,k]),z=T.worldSize/(2*Math.PI),j=[0,0,-z],U=T.width/T.height,V=Math.tan(T.fovAboveCenter),X=De.vec3.scale([],G.up(),V),Q=De.vec3.scale([],G.right(),V*U),ne=De.vec3.normalize([],De.vec3.add([],De.vec3.add([],W,X),Q)),ue=[];let fe;if(new Sd(R,ne).closestPointOnSphere(j,z,ue)){const ie=De.vec3.add([],ue,j),me=De.vec3.sub([],ie,R);fe=Math.cos(T.fovAboveCenter)*De.vec3.length(me)}else{const ie=De.vec3.sub([],R,j),me=De.vec3.sub([],j,R);De.vec3.normalize(me,me);const ve=De.vec3.length(ie)-z;fe=Math.sqrt(ve*(ve+2*z));const Ce=Math.acos(fe/(z+ve))-Math.acos(De.vec3.dot(W,me));fe*=Math.cos(Ce)}return 1.01*fe}(u,this.pixelsPerMeter(u.center.lat,u.worldSize)),y=ov(u.zoom);if(y>0){const T=u9(u,Be(1,u.center.lat)*u.worldSize),b=u.worldSize/(2*Math.PI),M=Math.max(u.width,u.height)/u.worldSize*Math.PI;return ur(p,T+b*(1-Math.cos(M)),Math.pow(y,10))}return p}upVector(u,p,y){return rS(p,y,u,1)}upVectorScale(u){return{metersToTile:pm(ZC($f(u)))}}}function g9(v){const u=v.parallels,p=!!u&&Math.abs(u[0]+u[1])<.01;switch(v.name){case"mercator":return new d9(v);case"equirectangular":return new mfe(v);case"naturalEarth":return new vfe(v);case"equalEarth":return new pfe(v);case"winkelTripel":return new _fe(v);case"albers":return p?new m9(v):new ffe(v);case"lambertConformalConic":return p?new m9(v):new gfe(v);case"globe":return new yfe(v)}throw new Error(`Invalid projection name: ${v.name}`)}const xfe=s1.VectorTileFeature.types,bfe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vE(v,u,p,y,T,b,M,k,G,W,R,z,j){const U=k?Math.min(uv,Math.round(k[0])):0,V=k?Math.min(uv,Math.round(k[1])):0;v.emplaceBack(u,p,Math.round(32*y),Math.round(32*T),b,M,(U<<1)+(G?1:0),V,16*W,16*R,256*z,256*j)}function _E(v,u,p){v.emplaceBack(u,p)}function yE(v,u,p,y,T,b,M){v.emplaceBack(u,p,y,T,b,M)}function xE(v,u,p,y,T){v.emplaceBack(u,p,y,T),v.emplaceBack(u,p,y,T),v.emplaceBack(u,p,y,T),v.emplaceBack(u,p,y,T)}function wfe(v){for(const u of v.sections)if(Zx(u.text))return!0;return!1}class Fk{constructor(u){this.layoutVertexArray=new v_,this.indexArray=new To,this.programConfigurations=u,this.segments=new As,this.dynamicLayoutVertexArray=new kl,this.opacityVertexArray=new Zg,this.placedSymbolArray=new ev,this.iconTransitioningVertexArray=new Eu,this.globeExtVertexArray=new Xc,this.zOffsetVertexArray=new Gf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(u,p,y,T,b){this.isEmpty()||(y&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,zde.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,Gde.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,bfe,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=u.createVertexBuffer(this.iconTransitioningVertexArray,Hde.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=u.createVertexBuffer(this.globeExtVertexArray,Ude.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||b)&&(this.zOffsetVertexBuffer=u.createVertexBuffer(this.zOffsetVertexArray,Vde.members,!0)),this.opacityVertexBuffer.itemSize=1),(y||T)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Nn(Fk,"SymbolBuffers");class Nk{constructor(u,p,y){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new y,this.segments=new As,this.collisionVertexArray=new bd,this.collisionVertexArrayExt=new kl}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,jde.members,!0),this.collisionVertexBufferExt=u.createVertexBuffer(this.collisionVertexArrayExt,Wde.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Nn(Nk,"CollisionBuffers");class bE{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.lut=u.lut,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(M=>M.fqid),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=De.mat4.identity([]),this.placementViewportMatrix=De.mat4.identity([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mk(this.zoom,p["text-size"]),this.iconSizeData=Mk(this.zoom,p["icon-size"]);const y=this.layers[0].layout,T=y.get("symbol-sort-key"),b=y.get("symbol-z-order");this.canOverlap=y.get("text-allow-overlap")||y.get("icon-allow-overlap")||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&T.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=y.get("text-writing-mode").map(M=>Pu[M]),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.sourceID=u.sourceID,this.projection=u.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=y.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Fk(new ir(this.layers,{zoom:this.zoom,lut:this.lut},u=>u.startsWith("text")||u.startsWith("symbol"))),this.icon=new Fk(new ir(this.layers,{zoom:this.zoom,lut:this.lut},u=>u.startsWith("icon")||u.startsWith("symbol"))),this.glyphOffsetArray=new tv,this.lineVertexArray=new nv,this.symbolInstances=new rl}calculateGlyphDependencies(u,p,y,T,b){for(let M=0;M<u.length;M++){const k=u.codePointAt(M);if(k===void 0)break;if(p[k]=!0,T&&b&&k<=65535){const G=pS[u.charAt(M)];G&&(p[G.charCodeAt(0)]=!0)}}}updateFootprints(u,p){}updateReplacement(u,p){if(p.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=p.updateTime;const y=p.getReplacementRegionsForTile(u.toUnwrapped(),!0);return!xk(this.activeReplacements,y)&&(this.activeReplacements=y,!0)}populate(u,p,y,T){const b=this.layers[0],M=b.layout,k=this.projection.name==="globe",G=M.get("text-font"),W=M.get("text-field"),R=M.get("icon-image"),z=(W.value.kind!=="constant"||W.value.value instanceof ko&&!W.value.value.isEmpty()||W.value.value.toString().length>0)&&(G.value.kind!=="constant"||G.value.value.length>0),j=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,U=M.get("symbol-sort-key");if(this.features=[],!z&&!j)return;const V=p.iconDependencies,X=p.glyphDependencies,Q=p.availableImages,ne=new gs(this.zoom);for(const{feature:ue,id:fe,index:ie,sourceLayerIndex:me}of u){const ve=b._featureFilter.needGeometry,Ce=mn(ue,ve);if(!b._featureFilter.filter(ne,Ce,y))continue;if(ve||(Ce.geometry=fn(ue,y,T)),k&&ue.type!==1&&y.z<=5){const Ke=Ce.geometry,Ve=.98078528056,et=(ut,dt)=>{const ft=rS(ut.x,ut.y,y,1),_t=rS(dt.x,dt.y,y,1);return De.vec3.dot(ft,_t)<Ve};for(let ut=0;ut<Ke.length;ut++)Ke[ut]=dn(Ke[ut],et)}let ke,Fe;if(z){const Ke=b.getValueAndResolveTokens("text-field",Ce,y,Q),Ve=ko.factory(Ke);wfe(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||$g()==="unavailable"||this.hasRTLText&&Ua.isParsed())&&(ke=qde(Ve,b,Ce))}if(j){const Ke=b.getValueAndResolveTokens("icon-image",Ce,y,Q);Fe=Ke instanceof Ko?Ke:Ko.fromString(Ke)}if(!ke&&!Fe)continue;const Le=this.sortFeaturesByKey?U.evaluate(Ce,{},y):void 0;if(this.features.push({id:fe,text:ke,icon:Fe,index:ie,sourceLayerIndex:me,geometry:Ce.geometry,properties:ue.properties,type:xfe[ue.type],sortKey:Le}),Fe&&(V[Fe.namePrimary]=!0,Fe.nameSecondary&&(V[Fe.nameSecondary]=!0)),ke){const Ke=G.evaluate(Ce,{},y).join(","),Ve=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Pu.vertical)>=0;for(const et of ke.sections)if(et.image)V[et.image.namePrimary]=!0;else{const ut=Wc(ke.toString()),dt=et.fontStack||Ke,ft=X[dt]=X[dt]||{};this.calculateGlyphDependencies(et.text,ft,Ve,this.allowVerticalPlacement,ut)}}}M.get("symbol-placement")==="line"&&(this.features=function(ue){const fe={},ie={},me=[];let ve=0;function Ce(Ke){me.push(ue[Ke]),ve++}function ke(Ke,Ve,et){const ut=ie[Ke];return delete ie[Ke],ie[Ve]=ut,me[ut].geometry[0].pop(),me[ut].geometry[0]=me[ut].geometry[0].concat(et[0]),ut}function Fe(Ke,Ve,et){const ut=fe[Ve];return delete fe[Ve],fe[Ke]=ut,me[ut].geometry[0].shift(),me[ut].geometry[0]=et[0].concat(me[ut].geometry[0]),ut}function Le(Ke,Ve,et){const ut=et?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Ke}:${ut.x}:${ut.y}`}for(let Ke=0;Ke<ue.length;Ke++){const Ve=ue[Ke],et=Ve.geometry,ut=Ve.text?Ve.text.toString():null;if(!ut){Ce(Ke);continue}const dt=Le(ut,et),ft=Le(ut,et,!0);if(dt in ie&&ft in fe&&ie[dt]!==fe[ft]){const _t=Fe(dt,ft,et),It=ke(dt,ft,me[_t].geometry);delete fe[dt],delete ie[ft],ie[Le(ut,me[It].geometry,!0)]=It,me[_t].geometry=null}else dt in ie?ke(dt,ft,et):ft in fe?Fe(dt,ft,et):(Ce(Ke),fe[dt]=ve-1,ie[ft]=ve-1)}return me.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,fe)=>ue.sortKey-fe.sortKey)}update(u,p,y,T,b){const M=Object.keys(u).length!==0;if(M&&!this.stateDependentLayers.length)return;const k=M?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(u,p,k,y,T,b),this.icon.programConfigurations.updatePaintArrays(u,p,k,y,T,b)}updateZOffset(){const u=(b,M,k)=>{y+=M,y>b.length&&b.resize(y);for(let G=-M;G<0;G++)b.emplace(G+y,k)},p=(b,M,k)=>{T+=M,T>b.length&&b.resize(T);for(let G=-M;G<0;G++)b.emplace(G+T,k)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let y=0,T=0;for(let b=0;b<this.symbolInstances.length;b++){const M=this.symbolInstances.get(b),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:G,numIconVertices:W}=M,R=M.zOffset,z=W>0;if((k>0||G>0)&&(u(this.text.zOffsetVertexArray,k,R),u(this.text.zOffsetVertexArray,G,R)),z){const{placedIconSymbolIndex:j,verticalPlacedIconSymbolIndex:U}=M;j>=0&&p(this.icon.zOffsetVertexArray,W,R),U>=0&&p(this.icon.zOffsetVertexArray,M.numVerticalIconVertices,R)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=g9(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const y=this.lineVertexArray.length;if(u.segment!==void 0)for(const{x:T,y:b}of p)this.lineVertexArray.emplaceBack(T,b);return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}}addSymbols(u,p,y,T,b,M,k,G,W,R,z,j,U,V,X,Q){const ne=u.indexArray,ue=u.layoutVertexArray,fe=u.globeExtVertexArray,ie=u.segments.prepareSegment(4*p.length,ue,ne,this.canOverlap?M.sortKey:void 0),me=this.glyphOffsetArray.length,ve=ie.vertexLength,Ce=this.allowVerticalPlacement&&k===Pu.vertical?Math.PI/2:0,ke=M.text&&M.text.sections;for(let Le=0;Le<p.length;Le++){const{tl:Ke,tr:Ve,bl:et,br:ut,texPrimary:dt,texSecondary:ft,pixelOffsetTL:_t,pixelOffsetBR:It,minFontScaleX:xt,minFontScaleY:Vt,glyphOffset:Kt,isSDF:kt,sectionIndex:Rn}=p[Le],wn=ie.vertexLength,pn=Kt[1];if(vE(ue,W.x,W.y,Ke.x,pn+Ke.y,dt.x,dt.y,y,kt,_t.x,_t.y,xt,Vt),vE(ue,W.x,W.y,Ve.x,pn+Ve.y,dt.x+dt.w,dt.y,y,kt,It.x,_t.y,xt,Vt),vE(ue,W.x,W.y,et.x,pn+et.y,dt.x,dt.y+dt.h,y,kt,_t.x,It.y,xt,Vt),vE(ue,W.x,W.y,ut.x,pn+ut.y,dt.x+dt.w,dt.y+dt.h,y,kt,It.x,It.y,xt,Vt),G){const{x:rn,y:rr,z:Pn}=G.anchor,[zn,Sr,Nr]=G.up;yE(fe,rn,rr,Pn,zn,Sr,Nr),yE(fe,rn,rr,Pn,zn,Sr,Nr),yE(fe,rn,rr,Pn,zn,Sr,Nr),yE(fe,rn,rr,Pn,zn,Sr,Nr),xE(u.dynamicLayoutVertexArray,rn,rr,Pn,Ce)}else xE(u.dynamicLayoutVertexArray,W.x,W.y,W.z,Ce);if(Q){const rn=ft||dt;_E(u.iconTransitioningVertexArray,rn.x,rn.y),_E(u.iconTransitioningVertexArray,rn.x+rn.w,rn.y),_E(u.iconTransitioningVertexArray,rn.x,rn.y+rn.h),_E(u.iconTransitioningVertexArray,rn.x+rn.w,rn.y+rn.h)}ne.emplaceBack(wn,wn+1,wn+2),ne.emplaceBack(wn+1,wn+2,wn+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Kt[0]),Le!==p.length-1&&Rn===p[Le+1].sectionIndex||u.programConfigurations.populatePaintArrays(ue.length,M,M.index,{},U,V,X,ke&&ke[Rn])}const Fe=G?G.anchor:W;u.placedSymbolArray.emplaceBack(Fe.x,Fe.y,Fe.z,W.x,W.y,me,this.glyphOffsetArray.length-me,ve,R,z,W.segment,y?y[0]:0,y?y[1]:0,T[0],T[1],k,0,!1,0,j,0)}_commitLayoutVertex(u,p,y,T,b,M,k){u.emplaceBack(p,y,T,b,M,Math.round(k.x),Math.round(k.y))}_addCollisionDebugVertices(u,p,y,T,b,M,k){const G=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),W=G.vertexLength,R=k.tileAnchorX,z=k.tileAnchorY;for(let U=0;U<4;U++)y.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(y.collisionVertexArrayExt,p,u.padding,k.zOffset),this._commitLayoutVertex(y.layoutVertexArray,T,b,M,R,z,new At(u.x1,u.y1)),this._commitLayoutVertex(y.layoutVertexArray,T,b,M,R,z,new At(u.x2,u.y1)),this._commitLayoutVertex(y.layoutVertexArray,T,b,M,R,z,new At(u.x2,u.y2)),this._commitLayoutVertex(y.layoutVertexArray,T,b,M,R,z,new At(u.x1,u.y2)),G.vertexLength+=4;const j=y.indexArray;j.emplaceBack(W,W+1),j.emplaceBack(W+1,W+2),j.emplaceBack(W+2,W+3),j.emplaceBack(W+3,W),G.primitiveLength+=4}_addTextDebugCollisionBoxes(u,p,y,T,b,M){for(let k=T;k<b;k++){const G=y.get(k),W=this.getSymbolInstanceTextSize(u,M,p,k);this._addCollisionDebugVertices(G,W,this.textCollisionBox,G.projectedAnchorX,G.projectedAnchorY,G.projectedAnchorZ,M)}}_addIconDebugCollisionBoxes(u,p,y,T,b,M){for(let k=T;k<b;k++){const G=y.get(k),W=this.getSymbolInstanceIconSize(u,p,M.placedIconSymbolIndex);this._addCollisionDebugVertices(G,W,this.iconCollisionBox,G.projectedAnchorX,G.projectedAnchorY,G.projectedAnchorZ,M)}}generateCollisionDebugBuffers(u,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Nk(gl,NH.members,Eu),this.iconCollisionBox=new Nk(gl,NH.members,Eu);const y=o1(this.iconSizeData,u),T=o1(this.textSizeData,u);for(let b=0;b<this.symbolInstances.length;b++){const M=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(T,u,p,M.textBoxStartIndex,M.textBoxEndIndex,M),this._addTextDebugCollisionBoxes(T,u,p,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M),this._addIconDebugCollisionBoxes(y,u,p,M.iconBoxStartIndex,M.iconBoxEndIndex,M),this._addIconDebugCollisionBoxes(y,u,p,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M)}}getSymbolInstanceTextSize(u,p,y,T){const b=this.text.placedSymbolArray.get(p.rightJustifiedTextSymbolIndex>=0?p.rightJustifiedTextSymbolIndex:p.centerJustifiedTextSymbolIndex>=0?p.centerJustifiedTextSymbolIndex:p.leftJustifiedTextSymbolIndex>=0?p.leftJustifiedTextSymbolIndex:p.verticalPlacedTextSymbolIndex>=0?p.verticalPlacedTextSymbolIndex:T),M=lE(this.textSizeData,u,b)/Ga;return this.tilePixelRatio*M}getSymbolInstanceIconSize(u,p,y){const T=this.icon.placedSymbolArray.get(y),b=lE(this.iconSizeData,u,T);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(u,p,y,T){u.emplaceBack(p,-y,-y,T),u.emplaceBack(p,y,-y,T),u.emplaceBack(p,y,y,T),u.emplaceBack(p,-y,y,T)}_updateTextDebugCollisionBoxes(u,p,y,T,b,M){for(let k=T;k<b;k++){const G=y.get(k),W=this.getSymbolInstanceTextSize(u,M,p,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,W,G.padding,M.zOffset)}}_updateIconDebugCollisionBoxes(u,p,y,T,b,M){for(let k=T;k<b;k++){const G=y.get(k),W=this.getSymbolInstanceIconSize(u,p,M.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,W,G.padding,M.zOffset)}}updateCollisionDebugBuffers(u,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const y=o1(this.iconSizeData,u),T=o1(this.textSizeData,u);for(let b=0;b<this.symbolInstances.length;b++){const M=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(T,u,p,M.textBoxStartIndex,M.textBoxEndIndex,M),this._updateTextDebugCollisionBoxes(T,u,p,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M),this._updateIconDebugCollisionBoxes(y,u,p,M.iconBoxStartIndex,M.iconBoxEndIndex,M),this._updateIconDebugCollisionBoxes(y,u,p,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(u,p,y,T,b,M,k,G,W){const R={};if(p<y){const{x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie,featureIndex:me}=u.get(p);R.textBox={x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie},R.textFeatureIndex=me}if(T<b){const{x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie,featureIndex:me}=u.get(T);R.verticalTextBox={x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie},R.verticalTextFeatureIndex=me}if(M<k){const{x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie,featureIndex:me}=u.get(M);R.iconBox={x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie},R.iconFeatureIndex=me}if(G<W){const{x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie,featureIndex:me}=u.get(G);R.verticalIconBox={x1:z,y1:j,x2:U,y2:V,padding:X,projectedAnchorX:Q,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:fe,tileAnchorY:ie},R.verticalIconFeatureIndex=me}return R}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(u,p){const y=u.placedSymbolArray.get(p),T=y.vertexStartIndex+4*y.numGlyphs;for(let b=y.vertexStartIndex;b<T;b+=4)u.indexArray.emplaceBack(b,b+1,b+2),u.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),y=Math.cos(u),T=[],b=[],M=[];for(let k=0;k<this.symbolInstances.length;++k){M.push(k);const G=this.symbolInstances.get(k);T.push(0|Math.round(p*G.tileAnchorX+y*G.tileAnchorY)),b.push(G.featureIndex)}return M.sort((k,G)=>T[k]-T[G]||b[G]-b[k]),M}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let u=0;u<this.symbolInstances.length;++u)this.symbolInstanceIndexesSortedZOffset.push(u)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((u,p)=>this.symbolInstances.get(p).zOffset-this.symbolInstances.get(u).zOffset)}addToSortKeyRanges(u,p){const y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===p?y.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const y=this.symbolInstances.get(p);this.featureSortOrder.push(y.featureIndex);const{rightJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:k,placedIconSymbolIndex:G,verticalPlacedIconSymbolIndex:W}=y;T>=0&&this.addIndicesForPlacedSymbol(this.text,T),b>=0&&b!==T&&this.addIndicesForPlacedSymbol(this.text,b),M>=0&&M!==b&&M!==T&&this.addIndicesForPlacedSymbol(this.text,M),k>=0&&this.addIndicesForPlacedSymbol(this.text,k),G>=0&&this.addIndicesForPlacedSymbol(this.icon,G),W>=0&&this.addIndicesForPlacedSymbol(this.icon,W)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let v9,_9,zk;Nn(bE,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),bE.addDynamicAttributes=xE;class y9{constructor(u){this.type=u.property.overrides?u.property.overrides.runtimeType:nc,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nn(y9,"FormatSectionOverride",{omit:["defaultValue"]});const Uk=()=>zk||(zk={layout:v9||(v9=new qi({"symbol-placement":new vn(Tt.layout_symbol["symbol-placement"]),"symbol-spacing":new vn(Tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vn(Tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jn(Tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vn(Tt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new vn(Tt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new vn(Tt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new vn(Tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new vn(Tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vn(Tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jn(Tt.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jn(Tt.layout_symbol["icon-image"]),"icon-rotate":new Jn(Tt.layout_symbol["icon-rotate"]),"icon-padding":new vn(Tt.layout_symbol["icon-padding"]),"icon-keep-upright":new vn(Tt.layout_symbol["icon-keep-upright"]),"icon-offset":new Jn(Tt.layout_symbol["icon-offset"]),"icon-anchor":new Jn(Tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vn(Tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vn(Tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vn(Tt.layout_symbol["text-rotation-alignment"]),"text-field":new Jn(Tt.layout_symbol["text-field"]),"text-font":new Jn(Tt.layout_symbol["text-font"]),"text-size":new Jn(Tt.layout_symbol["text-size"]),"text-max-width":new Jn(Tt.layout_symbol["text-max-width"]),"text-line-height":new Jn(Tt.layout_symbol["text-line-height"]),"text-letter-spacing":new Jn(Tt.layout_symbol["text-letter-spacing"]),"text-justify":new Jn(Tt.layout_symbol["text-justify"]),"text-radial-offset":new Jn(Tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vn(Tt.layout_symbol["text-variable-anchor"]),"text-anchor":new Jn(Tt.layout_symbol["text-anchor"]),"text-max-angle":new vn(Tt.layout_symbol["text-max-angle"]),"text-writing-mode":new vn(Tt.layout_symbol["text-writing-mode"]),"text-rotate":new Jn(Tt.layout_symbol["text-rotate"]),"text-padding":new vn(Tt.layout_symbol["text-padding"]),"text-keep-upright":new vn(Tt.layout_symbol["text-keep-upright"]),"text-transform":new Jn(Tt.layout_symbol["text-transform"]),"text-offset":new Jn(Tt.layout_symbol["text-offset"]),"text-allow-overlap":new vn(Tt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new vn(Tt.layout_symbol["text-ignore-placement"]),"text-optional":new vn(Tt.layout_symbol["text-optional"]),visibility:new vn(Tt.layout_symbol.visibility)})),paint:_9||(_9=new qi({"icon-opacity":new Jn(Tt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Jn(Tt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Jn(Tt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Jn(Tt.paint_symbol["text-emissive-strength"]),"icon-color":new Jn(Tt.paint_symbol["icon-color"]),"icon-halo-color":new Jn(Tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jn(Tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jn(Tt.paint_symbol["icon-halo-blur"]),"icon-translate":new vn(Tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new vn(Tt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Jn(Tt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Jn(Tt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Jn(Tt.paint_symbol["text-occlusion-opacity"]),"text-color":new Jn(Tt.paint_symbol["text-color"],{runtimeType:Hs,getOverride:v=>v.textColor,hasOverride:v=>!!v.textColor}),"text-halo-color":new Jn(Tt.paint_symbol["text-halo-color"]),"text-halo-width":new Jn(Tt.paint_symbol["text-halo-width"]),"text-halo-blur":new Jn(Tt.paint_symbol["text-halo-blur"]),"text-translate":new vn(Tt.paint_symbol["text-translate"]),"text-translate-anchor":new vn(Tt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new vn(Tt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new vn(Tt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new vn(Tt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new vn(Tt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Jn(Tt.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new vn(Tt.paint_symbol["symbol-elevation-reference"])}))},zk);class wE extends $s{constructor(u,p,y,T){super(u,Uk(),p,y,T),this._colorAdjustmentMatrix=De.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=u.paint!==void 0&&("icon-occlusion-opacity"in u.paint||"text-occlusion-opacity"in u.paint)}recalculate(u,p){super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const y=this.layout.get("text-writing-mode");if(y){const T=[];for(const b of y)T.indexOf(b)<0&&T.push(b);this.layout._values["text-writing-mode"]=T}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(u,p,y,T){return this._saturation===u&&this._contrast===p&&this._brightnessMin===y&&this._brightnessMax===T||(this._colorAdjustmentMatrix=function(b,M,k,G){b=qe(b),M=Ie(M);const W=De.mat4.create(),R=b/3,z=1-2*R,j=[z,R,R,0,R,z,R,0,R,R,z,0,0,0,0,1],U=.5-.5*M,V=G-k;return De.mat4.multiply(W,[V,0,0,0,0,V,0,0,0,0,V,0,k,k,k,1],[M,0,0,0,0,M,0,0,0,0,M,0,U,U,U,1]),De.mat4.multiply(W,W,j),W}(u,p,y,T),this._saturation=u,this._contrast=p,this._brightnessMin=y,this._brightnessMax=T),this._colorAdjustmentMatrix}getValueAndResolveTokens(u,p,y,T){const b=this.layout.get(u).evaluate(p,{},y,T),M=this._unevaluatedLayout._values[u];return M.isDataDriven()||If(M.value)||!b?b:function(k,G){return G.replace(/{([^{}]+)}/g,(W,R)=>R in k?String(k[R]):"")}(p.properties,b)}createBucket(u){return new bE(u)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const u of Uk().paint.overridableProperties){if(!wE.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),y=new y9(p),T=new nm(y,p.property.specification,this.scope,this.options);let b=null;b=p.value.kind==="constant"||p.value.kind==="source"?new Hg("source",T):new ml("composite",T,p.value.zoomStops,p.value._interpolationType),this.paint._values[u]=new rh(p.property,b,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,y){return!(!this.layout||p.isDataDriven()||y.isDataDriven())&&wE.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const y=u.get("text-field"),T=Uk().paint.properties[p];let b=!1;const M=k=>{for(const G of k)if(T.overrides&&T.overrides.hasOverride(G))return void(b=!0)};if(y.value.kind==="constant"&&y.value.value instanceof ko)M(y.value.value.sections);else if(y.value.kind==="source"){const k=W=>{b||(W instanceof dl&&Os(W.value)===Za?M(W.value.sections):W instanceof ka?M(W.sections):W.eachChild(k))},G=y.value;G._styleExpression&&k(G._styleExpression.expression)}return b}getProgramIds(){return["symbol"]}getDefaultProgramParams(u,p,y){return{config:new an(this,{zoom:p,lut:y}),overrideFog:!1}}}let x9,b9,w9,S9;var Gk=ti([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Vk(v){switch(v){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Hk(v){switch(v){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class jk{constructor(u,p,y,T){this.context=u,this.format=y,this.useMipmap=T&&T.useMipmap,this.texture=u.gl.createTexture(),this.update(p,{premultiply:T&&T.premultiply})}update(u,p){const y=u&&u instanceof HTMLVideoElement&&u.width===0?u.videoWidth:u.width,T=u&&u instanceof HTMLVideoElement&&u.height===0?u.videoHeight:u.height,{context:b}=this,{gl:M}=b,{x:k,y:G}=p&&p.position?p.position:{x:0,y:0},W=Math.max(k+y,this.size?this.size[0]:0),R=Math.max(G+T,this.size?this.size[1]:0);!this.size||this.size[0]===W&&this.size[1]===R||(M.bindTexture(M.TEXTURE_2D,null),M.deleteTexture(this.texture),this.texture=M.createTexture(),this.size=null),M.bindTexture(M.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA8&&(!p||p.premultiply!==!1));const z=u instanceof HTMLImageElement||u instanceof HTMLCanvasElement||u instanceof HTMLVideoElement||u instanceof ImageData||ImageBitmap&&u instanceof ImageBitmap;if(!this.size&&W>0&&R>0){const j=this.useMipmap?Math.floor(Math.log2(Math.max(W,R)))+1:1;M.texStorage2D(M.TEXTURE_2D,j,this.format,W,R),this.size=[W,R]}if(this.size)if(z)M.texSubImage2D(M.TEXTURE_2D,0,k,G,Vk(this.format),Hk(this.format),u);else{const j=u.data;j&&M.texSubImage2D(M.TEXTURE_2D,0,k,G,y,T,Vk(this.format),Hk(this.format),j)}this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(u,p,y=!1){const{context:T}=this,{gl:b}=T;b.bindTexture(b.TEXTURE_2D,this.texture),u!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap&&!y?u===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:u),this.minFilter=u),p!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,p),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,p),this.wrapS=p)}bindExtraParam(u,p,y,T){const{context:b}=this,{gl:M}=b;M.bindTexture(M.TEXTURE_2D,this.texture),p!==this.magFilter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,p),this.magFilter=p),u!==this.minFilter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,this.useMipmap?u===M.NEAREST?M.NEAREST_MIPMAP_NEAREST:M.LINEAR_MIPMAP_LINEAR:u),this.minFilter=u),y!==this.wrapS&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,y),this.wrapS=y),T!==this.wrapT&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,T),this.wrapT=T)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}}class SE{constructor(u,p){this.context=u,this.texture=p}bind(u,p){const{context:y}=this,{gl:T}=y;T.bindTexture(T.TEXTURE_2D,this.texture),u!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,u),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,u),this.minFilter=u),p!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,p),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,p),this.wrapS=p)}}function AE(v,u,p,y,T,b,M,k){const G=[v,u,1,p,y,1,T,b,1],W=[M,k,1],R=De.mat3.adjoint([],G),[z,j,U]=De.vec3.transformMat3(W,W,R);return De.mat3.multiply(G,G,[z,0,0,0,j,0,0,0,U])}function A9(v,u,p,y,T,b,M,k){const G=function(W,R,z,j,U,V,X,Q){const ne=AE(0,0,1,0,1,1,0,1),ue=AE(W,R,z,j,U,V,X,Q),fe=De.mat3.adjoint([],ne);return De.mat3.multiply(ue,ue,fe)}(v,u,p,y,T,b,M,k);return[G[2]/G[8]/xn,G[5]/G[8]/xn]}function TE(v){return[v[0],Math.min(Math.max(v[1],-Je),Je)]}class T9 extends Xu{constructor(u,p,y,T){super(),this.id=u,this.dispatcher=y,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(T),this.options=p,this._dirty=!1}load(u,p){if(this._loaded=p||!1,this.fire(new tc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return u&&(this.coordinates=u),this._loaded=!0,void this._finishLoading();this._imageRequest=Cs(this.map._requestManager.transformRequest(this.url,Qi.Image),(y,T)=>{this._imageRequest=null,this._loaded=!0,y?this.fire(new Bp(y)):T&&(this.image=T instanceof HTMLImageElement?En.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading())})}loaded(){return this._loaded}updateImage(u){return u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}setTexture(u){if(!(u.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new SE(this.map.painter.context,u.handle),this.width=u.dimensions[0],this.height=u.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new tc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(u){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof SE||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(u){if(this.coordinates=u,this._boundsArray=void 0,this._unsupportedCoords=!1,!u.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let p=u[0][1],y=u[0][1];for(const b of u)b[1]>y&&(y=b[1]),b[1]<p&&(p=b[1]);const T=(y+p)/2;if(T>Je?this.onNorthPole=!0:T<-Je&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const b=u.map(wt.fromLngLat);this.tileID=function(M){let k=1/0,G=1/0,W=-1/0,R=-1/0;for(const X of M)k=Math.min(k,X.x),G=Math.min(G,X.y),W=Math.max(W,X.x),R=Math.max(R,X.y);const z=Math.max(W-k,R-G),j=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),U=Math.pow(2,j);let V=Math.floor((k+W)/2*U);return V>1&&(V-=1),new ea(j,V,Math.floor((G+R)/2*U))}(b),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new tc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(u){for(const ne in this.tiles){const ue=this.tiles[ne];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const p=yS(new ea(0,0,0),this.map.transform.projection),y=[p.projection.project(this.coordinates[0][0],this.coordinates[0][1]),p.projection.project(this.coordinates[1][0],this.coordinates[1][1]),p.projection.project(this.coordinates[2][0],this.coordinates[2][1]),p.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ne){const ue=ne[1].x-ne[0].x,fe=ne[1].y-ne[0].y,ie=ne[2].x-ne[1].x,me=ne[2].y-ne[1].y,ve=ne[3].x-ne[2].x,Ce=ne[3].y-ne[2].y,ke=ne[0].x-ne[3].x,Fe=ne[0].y-ne[3].y,Le=ue*me-ie*fe,Ke=ie*Ce-ve*me,Ve=ve*Fe-ke*Ce,et=ke*fe-ue*Fe;return Le>0&&Ke>0&&Ve>0&&et>0||Le<0&&Ke<0&&Ve<0&&et<0}(y))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const T=yS(this.tileID,this.map.transform.projection),[b,M,k,G]=this.coordinates.map(ne=>{const ue=T.projection.project(ne[0],ne[1]);return h9(T,ue)._round()});this.perspectiveTransform=A9(b.x,b.y,M.x,M.y,k.x,k.y,G.x,G.y);const W=this._boundsArray=new to;W.emplaceBack(b.x,b.y,0,0),W.emplaceBack(M.x,M.y,xn,0),W.emplaceBack(G.x,G.y,0,xn),W.emplaceBack(k.x,k.y,xn,xn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=u.createVertexBuffer(W,Gk.members),this.boundsSegments=As.simpleSegment(0,0,4,2);const R=[],z=[TE((j=this.coordinates)[0]),TE(j[1]),TE(j[2]),TE(j[3])];var j;const[U,V,X,Q]=function(ne){let ue=ne[0][0],fe=ue,ie=ne[0][1],me=ie;for(let ve=1;ve<ne.length;ve++)ne[ve][0]<ue?ue=ne[ve][0]:ne[ve][0]>fe&&(fe=ne[ve][0]),ne[ve][1]<ie?ie=ne[ve][1]:ne[ve][1]>me&&(me=ne[ve][1]);return[ue,ie,fe-ue,me-ie]}(z);{const ne=new to,[ue,fe,ie,me]=function(_t){let It=_t[0].x,xt=It,Vt=_t[0].y,Kt=Vt;for(let kt=1;kt<_t.length;kt++)_t[kt].x<It?It=_t[kt].x:_t[kt].x>xt&&(xt=_t[kt].x),_t[kt].y<Vt?Vt=_t[kt].y:_t[kt].y>Kt&&(Kt=_t[kt].y);return[It,Vt,xt-It,Kt-Vt]}(y),ve=_t=>[(_t.x-ue)/ie,(_t.y-fe)/me],[Ce,ke,Fe,Le]=y.map(ve),Ke=function(_t,It,xt,Vt,Kt,kt,Rn,wn){const pn=AE(0,0,1,0,1,1,0,1),rn=AE(_t,It,xt,Vt,Kt,kt,Rn,wn),rr=De.mat3.adjoint([],rn);return De.mat3.multiply(pn,pn,rr)}(Ce[0],Ce[1],ke[0],ke[1],Fe[0],Fe[1],Le[0],Le[1]);this.elevatedGlobePerspectiveTransform=A9(Ce[0],Ce[1],ke[0],ke[1],Fe[0],Fe[1],Le[0],Le[1]);const Ve=(_t,It)=>{R.push(_t.lng);const xt=Math.round((_t.lng-U)/X*xn),Vt=Math.round((_t.lat-V)/Q*xn),Kt=ve(It),kt=De.vec3.transformMat3([],[Kt[0],Kt[1],1],Ke),Rn=Math.round(kt[0]/kt[2]*xn),wn=Math.round(kt[1]/kt[2]*xn);ne.emplaceBack(xt,Vt,Rn,wn)},et=y[3].x-y[0].x,ut=y[3].y-y[0].y,dt=y[2].x-y[1].x,ft=y[2].y-y[1].y;for(let _t=0;_t<65;_t++){const It=_t/64,xt=[y[0].x+It*et,y[0].y+It*ut],Vt=[y[1].x+It*dt,y[1].y+It*ft],Kt=Vt[0]-xt[0],kt=Vt[1]-xt[1];for(let Rn=0;Rn<65;Rn++){const wn=Rn/64,pn={x:xt[0]+Kt*wn,y:xt[1]+kt*wn,z:0};Ve(p.projection.unproject(pn.x,pn.y),pn)}}this.elevatedGlobeVertexBuffer=u.createVertexBuffer(ne,Gk.members)}{this.maxLongitudeTriangleSize=0;let ne=[],ue=new To;const fe=(ie,me,ve)=>{ue.emplaceBack(ie,me,ve);const Ce=R[ie],ke=R[me],Fe=R[ve],Le=Math.min(Math.min(Ce,ke),Fe),Ke=Math.max(Math.max(Ce,ke),Fe)-Le;Ke>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ke),ne.push(Le+Ke/2)};for(let ie=0;ie<64;ie++)for(let me=0;me<64;me++){const ve=65*ie+me,Ce=ve+1,ke=ve+65,Fe=ke+1;fe(ve,ke,Ce),fe(Ce,ke,Fe)}[ne,ue]=function(ie,me){const ve=Array.from({length:ie.length},(Fe,Le)=>Le);ve.sort((Fe,Le)=>ie[Fe]-ie[Le]);const Ce=[],ke=new To;for(let Fe=0;Fe<ve.length;Fe++){const Le=ve[Fe];Ce.push(ie[Le]);const Ke=3*Le,Ve=Ke+1;ke.emplaceBack(me.uint16[Ke],me.uint16[Ve],me.uint16[Ve+1])}return[Ce,ke]}(ne,ue),this.elevatedGlobeTrianglesCenterLongitudes=ne,this.elevatedGlobeIndexBuffer=u.createIndexBuffer(ue)}this.elevatedGlobeSegments=As.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,X/xn,0,Q/xn,0,0,V,U,0])}prepare(){const u=Object.keys(this.tiles).length!==0;if(this.tileID&&!u)return;const p=this.map.painter.context,y=p.gl;!this._dirty||this.texture instanceof SE||(this.texture?this.texture.update(this.image):(this.texture=new jk(p,this.image,y.RGBA8),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE)),this._dirty=!1),u&&this._prepareData(p)}loadTile(u,p){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},p(null)):(u.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(u){const p=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!p)return null;const y=this.elevatedGlobeTrianglesCenterLongitudes;let T=(b=u+180)+360*Math.round((y[0]-b)/360);var b;const M=new As,k=(z,j)=>{M.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:p.segments[0].vertexLength,primitiveLength:j,sortKey:void 0,vaos:{}})},G=.51*this.maxLongitudeTriangleSize;if(Math.abs(y[0]-T)<=G){const z=we(y,0,y.length,T+G);return z===y.length||k(z,Mt(y,z+1,y.length,T+360-G)-z),M}T<y[0]&&(T+=360);const W=Mt(y,0,y.length,T-G);if(W===y.length)return k(0,y.length),M;k(0,W-0);const R=we(y,W+1,y.length,T+G);return R!==y.length&&k(R,y.length-R),M}}const Sfe=(Math.pow(256,2)-1)/16907520;class M9 extends $s{constructor(u,p,y,T){super(u,{layout:w9||(w9=new qi({visibility:new vn(Tt.layout_raster.visibility)})),paint:S9||(S9=new qi({"raster-opacity":new vn(Tt.paint_raster["raster-opacity"]),"raster-color":new hc(Tt.paint_raster["raster-color"]),"raster-color-mix":new vn(Tt.paint_raster["raster-color-mix"]),"raster-color-range":new vn(Tt.paint_raster["raster-color-range"]),"raster-hue-rotate":new vn(Tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vn(Tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vn(Tt.paint_raster["raster-brightness-max"]),"raster-saturation":new vn(Tt.paint_raster["raster-saturation"]),"raster-contrast":new vn(Tt.paint_raster["raster-contrast"]),"raster-resampling":new vn(Tt.paint_raster["raster-resampling"]),"raster-fade-duration":new vn(Tt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new vn(Tt.paint_raster["raster-emissive-strength"]),"raster-array-band":new vn(Tt.paint_raster["raster-array-band"]),"raster-elevation":new vn(Tt.paint_raster["raster-elevation"])}))},p,y,T),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(u){return!(u&&u._source instanceof T9&&(u._source.onNorthPole||u._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(u){u!=="raster-color"&&u!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(u){if(!this.hasColorMap()||!this._curRampRange)return;const p=this._transitionablePaint._values["raster-color"].value.expression,[y,T]=u||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(y)&&isNaN(T)||y===this._curRampRange[0]&&T===this._curRampRange[1]||(this.colorRamp=iS({expression:p,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:y,end:T}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[y,T])}}let C9,E9,I9,P9,R9;class L9 extends $s{constructor(u,p,y,T){super(u,{layout:C9||(C9=new qi({visibility:new vn(Tt["layout_raster-particle"].visibility)})),paint:E9||(E9=new qi({"raster-particle-array-band":new vn(Tt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new vn(Tt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new hc(Tt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new vn(Tt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new vn(Tt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new vn(Tt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new vn(Tt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new vn(Tt["paint_raster-particle"]["raster-particle-elevation"])}))},p,y,T),this._updateColorRamp(),this.lastInvalidatedAt=En.now()}onRemove(u){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(u){return!1}_handleSpecialPaintPropertyUpdate(u){u!=="raster-particle-color"&&u!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),u==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const u=this._transitionablePaint._values["raster-particle-color"].value.expression,p=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=iS({expression:u,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:p}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=En.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Afe extends $s{constructor(u,p){super(u,{},p,null),this.implementation=u,u.slot&&(this.slot=u.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(u){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)}onRemove(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)}}function Wk(v,u,p){const y=[0,0,1],T=De.quat.identity([]);return De.quat.rotateY(T,T,p?-on(v)+Math.PI:on(v)),De.quat.rotateX(T,T,-on(u)),De.vec3.transformQuat(y,y,T),De.vec3.normalize(y,y)}function D9(v,u){const p=ME(v.projection,v.zoom,v.width,v.height),y=function(b,M,k,G,W){const R=new de(k.lng-180*dv,k.lat),z=new de(k.lng+180*dv,k.lat),j=b.project(R.lng,R.lat),U=b.project(z.lng,z.lat),V=-Math.atan2(U.y-j.y,U.x-j.x),X=wt.fromLngLat(k);X.y=Wt(X.y,-1+dv,1-dv);const Q=X.toLngLat(),ne=b.project(Q.lng,Q.lat),ue=wt.fromLngLat(Q);ue.x+=dv;const fe=ue.toLngLat(),ie=b.project(fe.lng,fe.lat),me=k9(ie.x-ne.x,ie.y-ne.y,V),ve=wt.fromLngLat(Q);ve.y+=dv;const Ce=ve.toLngLat(),ke=b.project(Ce.lng,Ce.lat),Fe=k9(ke.x-ne.x,ke.y-ne.y,V),Le=Math.abs(me.x)/Math.abs(Fe.y),Ke=De.mat4.identity([]);De.mat4.rotateZ(Ke,Ke,-V*(1-(W?0:G)));const Ve=De.mat4.identity([]);return De.mat4.scale(Ve,Ve,[1,1-(1-Le)*G,1]),Ve[4]=-Fe.x/Fe.y*G,De.mat4.rotateZ(Ve,Ve,V),De.mat4.multiply(Ve,Ke,Ve),Ve}(v.projection,0,v.center,p,u),T=B9(v);return De.mat4.scale(y,y,[T,T,1]),y}function B9(v){const u=v.projection,p=ME(v.projection,v.zoom,v.width,v.height),y=$k(u,v.center),T=$k(u,de.convert(u.center));return Math.pow(2,y*p+(1-p)*T)}function ME(v,u,p,y,T=1/0){const b=v.range;if(!b)return 0;const M=Math.min(T,Math.max(p,y)),k=Math.log(M/1024)/Math.LN2;return gr(b[0]+k,b[1]+k,u)}const dv=1/4e4;function $k(v,u){const p=Wt(u.lat,-Je,Je),y=new de(u.lng-180*dv,p),T=new de(u.lng+180*dv,p),b=v.project(y.lng,p),M=v.project(T.lng,p),k=wt.fromLngLat(y),G=wt.fromLngLat(T),W=M.x-b.x,R=M.y-b.y,z=G.x-k.x,j=G.y-k.y,U=Math.sqrt((z*z+j*j)/(W*W+R*R));return Math.log(U)/Math.LN2}function k9(v,u,p){const y=Math.cos(p),T=Math.sin(p);return{x:v*y-u*T,y:v*T+u*y}}function O9(v,u,p){De.mat4.identity(v),De.mat4.rotateZ(v,v,on(u[2])),De.mat4.rotateX(v,v,on(u[0])),De.mat4.rotateY(v,v,on(u[1])),De.mat4.scale(v,v,p),De.mat4.multiply(v,v,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function CE(v,u,p,y,T,b,M,k){const G=[p[0]-u[0],p[1]-u[1],0],W=[y[0]-u[0],y[1]-u[1],0];if(De.vec3.length(G)<1e-12||De.vec3.length(W)<1e-12)return De.quat.identity(v);const R=De.vec3.cross([],G,W);De.vec3.normalize(R,R),De.vec3.subtract(W,y,u),G[2]=(b-T)*k,W[2]=(M-T)*k;const z=G;return De.vec3.cross(z,G,W),De.vec3.normalize(z,z),De.quat.rotationTo(v,R,z)}function Xk(v,u,p=!1){const y=ov(u.zoom),T=function(b,M,k){const G=M.worldSize,W=[b[12],b[13],b[14]],R=$e(W[1]/G),z=Xe(W[0]/G),j=De.mat4.identity([]),U=Be(1,R)*G,V=Be(1,0)*G*ht(R,M.zoom),X=1/ak(G);let Q=V*X;if(k){const ie=ME(M.projection,M.zoom,M.width,M.height,1024);Q=X*M.projection.pixelSpaceConversion(M.center.lat,G,ie)}const ne=te(R,z);De.vec3.add(ne,ne,De.vec3.scale([],De.vec3.normalize([],ne),U*Q*W[2]));const ue=function(ie){const me=[ie[0],ie[1],ie[2]];let ve=[0,1,0];const Ce=De.vec3.cross([],ve,me);return De.vec3.cross(ve,me,Ce),De.vec3.squaredLength(ve)===0&&(ve=[0,1,0],De.vec3.cross(Ce,me,ve)),De.vec3.normalize(Ce,Ce),De.vec3.normalize(ve,ve),De.vec3.normalize(me,me),[Ce[0],Ce[1],Ce[2],0,ve[0],ve[1],ve[2],0,me[0],me[1],me[2],0,ie[0],ie[1],ie[2],1]}(ne);De.mat4.scale(j,j,[Q,Q,Q*U]),De.mat4.translate(j,j,[-W[0],-W[1],-W[2]]);const fe=De.mat4.multiply([],M.globeMatrix,ue);return De.mat4.multiply(fe,fe,j),De.mat4.multiply(fe,fe,b),fe}(v,u,p);if(y>0){const b=function(M,k){const G=k.worldSize,W=Be(1,0)*G*ht(k.center.lat,k.zoom)/ak(G),R=Be(1,k.center.lat)*G,z=De.mat4.identity([]);return De.mat4.rotateY(z,z,on(k.center.lng)),De.mat4.rotateX(z,z,on(k.center.lat)),De.mat4.translate(z,z,[0,0,h]),De.mat4.scale(z,z,[W,W,W*R]),De.mat4.translate(z,z,[k.point.x-.5*G,k.point.y-.5*G,0]),De.mat4.multiply(z,z,M),De.mat4.multiply(z,k.globeMatrix,z)}(v,u);return function(M,k,G){const W=(V,X,Q)=>{const ne=De.vec3.length(V),ue=De.vec3.length(X),fe=mm(V,X,Q);return De.vec3.scale(fe,fe,1/De.vec3.length(fe)*ur(ne,ue,Q))},R=W([M[0],M[1],M[2]],[k[0],k[1],k[2]],G),z=W([M[4],M[5],M[6]],[k[4],k[5],k[6]],G),j=W([M[8],M[9],M[10]],[k[8],k[9],k[10]],G),U=mm([M[12],M[13],M[14]],[k[12],k[13],k[14]],G);return[R[0],R[1],R[2],0,z[0],z[1],z[2],0,j[0],j[1],j[2],0,U[0],U[1],U[2],1]}(T,b,y)}return T}function F9(v,u,p,y){const T=ts.projectAabbCorners(y,p);let b=Number.MAX_VALUE,M=-1;for(let W=0;W<T.length;++W){const R=T[W];R[0]=(.5*R[0]+.5)*u.width,R[1]=(.5-.5*R[1])*u.height,R[2]<b&&(M=W,b=R[2])}const k=W=>new At(T[W][0],T[W][1]);let G;switch(M){case 0:case 6:G=[k(1),k(5),k(4),k(7),k(3),k(2),k(1)];break;case 1:case 7:G=[k(0),k(4),k(5),k(6),k(2),k(3),k(0)];break;case 3:case 5:G=[k(1),k(0),k(4),k(7),k(6),k(2),k(1)];break;default:G=[k(1),k(5),k(6),k(7),k(3),k(0),k(1)]}if(bn(v,G))return b}const Tfe=ti([{name:"a_pos_3f",components:3,type:"Float32"}]),Mfe=ti([{name:"a_color_3f",components:3,type:"Float32"}]),Cfe=ti([{name:"a_color_4f",components:4,type:"Float32"}]),Efe=ti([{name:"a_uv_2f",components:2,type:"Float32"}]),Ife=ti([{name:"a_normal_3f",components:3,type:"Float32"}]),Pfe=ti([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Rfe=ti([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),N9={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class EE{constructor(u,p,y,T){this.message=(u?`${u}: `:"")+y,T&&(this.identifier=T),p!=null&&p.__line__&&(this.line=p.__line__)}}function z9(v,u){const p=v.indexOf("://")===-1;try{return new URL(v,p&&u?"http://example.com":void 0),!0}catch{return!1}}class U9{constructor(u,p){this.feature=u,this.instancedDataOffset=p,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class G9{constructor(){this.instancedDataArray=new Vf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class qk{constructor(u){this.zoom=u.zoom,this.canonical=u.canonical,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.fqid),this.projection=u.projection,this.index=u.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(u,p){}populate(u,p,y,T){this.tileToMeter=st(y);const b=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:M,id:k,index:G,sourceLayerIndex:W}of u){const R=k??(M.properties&&M.properties.hasOwnProperty("id")?M.properties.id:void 0),z=mn(M,b);if(!this.layers[0]._featureFilter.filter(new gs(this.zoom),z,y))continue;const j={id:R,sourceLayerIndex:W,index:G,geometry:b?z.geometry:fn(M,y,T),properties:M.properties,type:M.type,patterns:{}},U=this.addFeature(j,j.geometry,z);U&&p.featureIndex.insert(M,j.geometry,G,W,this.index,this.instancesPerModel[U].instancedDataArray.length,xn/32)}this.lookup=null}update(u,p,y,T){for(const b in this.instancesPerModel){const M=this.instancesPerModel[b];for(const k in u)M.idToFeaturesIndex.hasOwnProperty(k)&&(this.evaluate(M.features[M.idToFeaturesIndex[k]],u[k],M,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let u=!1;for(const p in this.instancesPerModel){const y=this.instancesPerModel[p];for(const T of y.features){const b=this.layers[0],M=T.feature,k=this.canonical,G=b.paint.get("model-rotation").evaluate(M,{},k),W=b.paint.get("model-scale").evaluate(M,{},k),R=b.paint.get("model-translation").evaluate(M,{},k);De.vec3.exactEquals(T.rotation,G)&&De.vec3.exactEquals(T.scale,W)&&De.vec3.exactEquals(T.translation,R)||(this.evaluate(T,T.featureStates,y,!0),u=!0)}}return u}updateReplacement(u,p,y,T){if(p.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=p.updateTime;const b=p.getReplacementRegionsForTile(u.toUnwrapped(),!0);if(xk(this.activeReplacements,b))return!1;this.activeReplacements=b;let M=!1;for(const k in this.instancesPerModel){const G=this.instancesPerModel[k],W=G.instancedDataArray;for(const R of G.features){const z=R.instancedDataOffset,j=R.instancedDataCount;for(let U=0;U<j;U++){const V=16*(U+z);let X=W.float32[V+0];const Q=X>xn;X=Q?X-xn:X;const ne=Math.floor(X),ue=W.float32[V+1];let fe=!1;for(const ie of this.activeReplacements)if(!nH(ie,y,N9.Model,T)&&!(ie.min.x>ne||ne>ie.max.x||ie.min.y>ue||ue>ie.max.y)&&(fe=lH(aH(ne,ue,u.canonical,ie.footprintTileId.canonical),ie.footprint),fe))break;W.float32[V]=fe?X+xn:X,M=M||fe!==Q}}}return M}isEmpty(){for(const u in this.instancesPerModel)if(this.instancesPerModel[u].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(u){if(!this.uploaded)for(const p in this.instancesPerModel){const y=this.instancesPerModel[p];y.instancedDataArray.length<0||y.instancedDataArray.length===0||(y.instancedDataBuffer?y.instancedDataBuffer.updateData(y.instancedDataArray):y.instancedDataBuffer=u.createVertexBuffer(y.instancedDataArray,Pfe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const p in this.instancesPerModel){const y=this.instancesPerModel[p];y.instancedDataArray.length!==0&&y.instancedDataBuffer&&y.instancedDataBuffer.destroy()}const u=this.layers[0].modelManager;if(u&&this.modelUris)for(const p of this.modelUris)u.removeModel(p,"")}addFeature(u,p,y){const T=this.layers[0],b=T.layout.get("model-id").evaluate(y,{},this.canonical);if(!b)return Bt(`modelId is not evaluated for layer ${T.id} and it is not going to get rendered.`),b;z9(b,!1)&&(this.modelUris.includes(b)||this.modelUris.push(b)),this.instancesPerModel[b]||(this.instancesPerModel[b]=new G9);const M=this.instancesPerModel[b],k=M.instancedDataArray,G=new U9(y,k.length);for(const W of p)for(const R of W){if(R.x<0||R.x>=xn||R.y<0||R.y>=xn)continue;const z=(this.lookupDim-1)/xn,j=this.lookupDim*(R.y*z|0)+R.x*z|0;if(this.lookup){if(this.lookup[j]!==0)continue;this.lookup[j]=1}this.instanceCount++;const U=k.length;k.resize(U+1),M.instancesEvaluatedElevation.push(0),k.float32[16*U]=R.x,k.float32[16*U+1]=R.y}return G.instancedDataCount=M.instancedDataArray.length-G.instancedDataOffset,G.instancedDataCount>0&&(u.id&&(M.idToFeaturesIndex[u.id]=M.features.length),M.features.push(G),this.evaluate(G,{},M,!1)),b}getModelUris(){return this.modelUris}evaluate(u,p,y,T){const b=this.layers[0],M=u.feature,k=this.canonical,G=u.rotation=b.paint.get("model-rotation").evaluate(M,p,k),W=u.scale=b.paint.get("model-scale").evaluate(M,p,k),R=u.translation=b.paint.get("model-translation").evaluate(M,p,k),z=b.paint.get("model-color").evaluate(M,p,k);z.a=b.paint.get("model-color-mix-intensity").evaluate(M,p,k);const j=[];this.maxVerticalOffset<R[2]&&(this.maxVerticalOffset=R[2]),this.maxScale=Math.max(Math.max(this.maxScale,W[0]),Math.max(W[1],W[2])),O9(j,G,W);const U=Math.round(100*z.a)+z.b/1.05;for(let V=0;V<u.instancedDataCount;++V){const X=u.instancedDataOffset+V,Q=16*X,ne=y.instancedDataArray.float32;let ue=0;T&&(ue=ne[Q+6]-y.instancesEvaluatedElevation[X]);const fe=0|ne[Q+1];ne[Q]=(0|ne[Q])+z.r/1.05,ne[Q+1]=fe+z.g/1.05,ne[Q+2]=U,ne[Q+3]=1/(k.z>10?this.tileToMeter:st(k,fe)),ne[Q+4]=R[0],ne[Q+5]=R[1],ne[Q+6]=R[2]+ue,ne[Q+7]=j[0],ne[Q+8]=j[1],ne[Q+9]=j[2],ne[Q+10]=j[4],ne[Q+11]=j[5],ne[Q+12]=j[6],ne[Q+13]=j[8],ne[Q+14]=j[9],ne[Q+15]=j[10],y.instancesEvaluatedElevation[X]=R[2]}}}let V9,H9;Nn(qk,"ModelBucket",{omit:["layers"]}),Nn(G9,"PerModelAttributes"),Nn(U9,"ModelFeature");const A_=64,h1={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function j9(v,u,p,y,T,b,M,k,G,W=!1){const R=p.zoom,z=p.project(y),j=ht(y.lat,R),U=1/j;De.mat4.identity(v),De.mat4.translate(v,v,[z.x+M[0]*U,z.y+M[1]*U,M[2]]);let V=1,X=1;const Q=p.worldSize;if(W){if(p.projection.name==="mercator"){let ie=0;p.elevation&&(ie=p.elevation.getAtPointOrZero(new wt(z.x/Q,z.y/Q),0));const me=De.vec4.transformMat4([],[z.x,z.y,ie,1],p.projMatrix)[3]/p.cameraToCenterDistance;V=me,X=me*ht(p.center.lat,R)}else if(p.projection.name==="globe"){const ie=Xk(v,p),me=De.mat4.multiply([],p.projMatrix,ie),ve=[0,0,0,1];De.vec4.transformMat4(ve,ve,me);const Ce=ve[3]/p.cameraToCenterDistance,ke=ov(R),Fe=p.projection.pixelsPerMeter(y.lat,Q)*ht(y.lat,R),Le=p.projection.pixelsPerMeter(p.center.lat,Q)*ht(p.center.lat,R);V=Ce/ur(Fe,nt(p.center.lat),ke),X=Ce*j/Fe,V*=Le,X*=Le}}else V=U;De.mat4.scale(v,v,[V,V,X]);const ne=[...v],ue=u.orientation,fe=[];if(O9(fe,[ue[0]+T[0],ue[1]+T[1],ue[2]+T[2]],b),De.mat4.multiply(v,ne,fe),k&&p.elevation){let ie=0;const me=[];if(G&&p.elevation){ie=function(ke,Fe,Le,Ke,Ve){const et=Fe.elevation;if(!et)return 0;const ut=ts.projectAabbCorners(Le,Ke),dt=Be(1,Ve.lat)*Fe.worldSize,ft=function(rr,Pn){const zn=[0,0,1],Sr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Nr of Sr){const Lr=rr[Nr.corners[0]],Dr=rr[Nr.corners[1]],$r=rr[Nr.corners[2]],Xr=[Dr[0]-Lr[0],Dr[1]-Lr[1],Pn*(Dr[2]-Lr[2])],ji=De.vec3.cross(Xr,Xr,[$r[0]-Lr[0],$r[1]-Lr[1],Pn*($r[2]-Lr[2])]);De.vec3.normalize(ji,ji),Nr.dotProductWithUp=De.vec3.dot(ji,zn)}return Sr.sort((Nr,Lr)=>Nr.dotProductWithUp-Lr.dotProductWithUp),Sr[0].corners}(ut,dt),_t=ut[ft[0]],It=ut[ft[1]],xt=ut[ft[2]],Vt=ut[ft[3]],Kt=et.getAtPointOrZero(new wt(_t[0]/Fe.worldSize,_t[1]/Fe.worldSize),0),kt=et.getAtPointOrZero(new wt(It[0]/Fe.worldSize,It[1]/Fe.worldSize),0),Rn=et.getAtPointOrZero(new wt(xt[0]/Fe.worldSize,xt[1]/Fe.worldSize),0),wn=et.getAtPointOrZero(new wt(Vt[0]/Fe.worldSize,Vt[1]/Fe.worldSize),0),pn=(Kt+wn)/2,rn=(kt+Rn)/2;return pn>rn?kt<Rn?CE(ke,It,Vt,_t,kt,wn,Kt,dt):CE(ke,xt,_t,Vt,Rn,Kt,wn,dt):Kt<wn?CE(ke,_t,It,xt,Kt,kt,Rn,dt):CE(ke,Vt,xt,It,wn,Rn,kt,dt),Math.max(pn,rn)}(me,p,u.aabb,v,y);const ve=De.mat4.fromQuat([],me),Ce=De.mat4.multiply([],ve,fe);De.mat4.multiply(v,ne,Ce)}else ie=p.elevation.getAtPointOrZero(new wt(z.x/Q,z.y/Q),0);ie!==0&&(v[14]+=ie)}}function AS(v,u,p=!1){v.uploaded||(v.gfxTexture=new jk(u,v.image,p?u.gl.R8:u.gl.RGBA8,{useMipmap:v.sampler.minFilter>=u.gl.NEAREST_MIPMAP_NEAREST}),v.uploaded=!0,v.image=null)}function Lfe(v,u,p){v.indexBuffer=u.createIndexBuffer(v.indexArray,!1,!0),v.vertexBuffer=u.createVertexBuffer(v.vertexArray,Tfe.members,!1,!0),v.normalArray&&(v.normalBuffer=u.createVertexBuffer(v.normalArray,Ife.members,!1,!0)),v.texcoordArray&&(v.texcoordBuffer=u.createVertexBuffer(v.texcoordArray,Efe.members,!1,!0)),v.colorArray&&(v.colorBuffer=u.createVertexBuffer(v.colorArray,(v.colorArray.bytesPerElement===12?Mfe:Cfe).members,!1,!0)),v.featureArray&&(v.pbrBuffer=u.createVertexBuffer(v.featureArray,Rfe.members,!0)),v.segments=As.simpleSegment(0,0,v.vertexArray.length,v.indexArray.length);const y=v.material;y.pbrMetallicRoughness.baseColorTexture&&AS(y.pbrMetallicRoughness.baseColorTexture,u),y.pbrMetallicRoughness.metallicRoughnessTexture&&AS(y.pbrMetallicRoughness.metallicRoughnessTexture,u),y.normalTexture&&AS(y.normalTexture,u),y.occlusionTexture&&AS(y.occlusionTexture,u,p),y.emissionTexture&&AS(y.emissionTexture,u)}function Yk(v,u,p){if(v.meshes)for(const y of v.meshes)Lfe(y,u,p);if(v.children)for(const y of v.children)Yk(y,u,p)}function IE(v){if(v.meshes)for(const u of v.meshes)u.indexArray.destroy(),u.vertexArray.destroy(),u.colorArray&&u.colorArray.destroy(),u.normalArray&&u.normalArray.destroy(),u.texcoordArray&&u.texcoordArray.destroy(),u.featureArray&&u.featureArray.destroy();if(v.children)for(const u of v.children)IE(u)}function Zk(v){if(v.meshes)for(const p of v.meshes)p.vertexBuffer&&(p.vertexBuffer.destroy(),p.indexBuffer.destroy(),p.normalBuffer&&p.normalBuffer.destroy(),p.texcoordBuffer&&p.texcoordBuffer.destroy(),p.colorBuffer&&p.colorBuffer.destroy(),p.pbrBuffer&&p.pbrBuffer.destroy(),p.segments.destroy(),p.material&&((u=p.material).pbrMetallicRoughness.baseColorTexture&&u.pbrMetallicRoughness.baseColorTexture.gfxTexture&&u.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),u.pbrMetallicRoughness.metallicRoughnessTexture&&u.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&u.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),u.normalTexture&&u.normalTexture.gfxTexture&&u.normalTexture.gfxTexture.destroy(),u.emissionTexture&&u.emissionTexture.gfxTexture&&u.emissionTexture.gfxTexture.destroy(),u.occlusionTexture&&u.occlusionTexture.gfxTexture&&u.occlusionTexture.gfxTexture.destroy()));var u;if(v.children)for(const p of v.children)Zk(p)}class d1{constructor(u,p,y){this._demTile=u,this._dem=this._demTile.dem,this._scale=p,this._offset=y}static create(u,p,y){const T=y||u.findDEMTileFor(p);if(!T||!T.dem)return;const b=T.dem,M=T.tileID,k=1<<p.canonical.z-M.canonical.z;return new d1(T,b.dim/xn/k,[(p.canonical.x/k-M.canonical.x)*b.dim,(p.canonical.y/k-M.canonical.y)*b.dim])}tileCoordToPixel(u,p){const y=p*this._scale+this._offset[1],T=Math.floor(u*this._scale+this._offset[0]),b=Math.floor(y);return new At(T,b)}getElevationAt(u,p,y,T){const b=u*this._scale+this._offset[0],M=p*this._scale+this._offset[1],k=Math.floor(b),G=Math.floor(M),W=this._dem;return T=!!T,y?ur(ur(W.get(k,G,T),W.get(k,G+1,T),M-G),ur(W.get(k+1,G,T),W.get(k+1,G+1,T),M-G),b-k):W.get(k,G,T)}getElevationAtPixel(u,p,y){return this._dem.get(u,p,!!y)}getMeterToDEM(u){return(1<<this._demTile.tileID.canonical.z)*Be(1,u)*this._dem.stride}}const Kk=new Float32Array(262144),T_=new Uint8Array(262144);function W9(v){let u=0;if(v.meshes)for(const p of v.meshes)u=Math.max(u,p.aabb.max[2]);if(v.children)for(const p of v.children)u=Math.max(u,W9(p));return u}function $9(v,u,p){if(v.meshes)for(const y of v.meshes)y.aabb.min[0]!==1/0&&p.insert(u,y.aabb.min[0],y.aabb.min[1],y.aabb.max[0],y.aabb.max[1]);if(v.children)for(const y of v.children)$9(y,u,p)}const X9=["","wall","door","roof","window","lamp","logo"];class q9{constructor(u){this.node=u,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:u.id,geometry:[],properties:{height:W9(u)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new ts([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let u=0;const p=new ts([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const y of this.node.meshes)this.node.lightMeshIndex!==u&&(y.transformedAabb=ts.applyTransformFast(y.aabb,this.node.matrix),p.encapsulate(y.transformedAabb)),u++;this.aabb=p}return this.aabb}}class PE{constructor(u,p,y,T,b,M){this.id=p,this.modelTraits|=h1.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,y&&(this.modelTraits|=h1.HasMapboxMeshFeatures),T&&(this.modelTraits|=h1.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=b,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const k of u)this.nodesInfo.push(new q9(k)),$9(k,M.featureIndexArray.length,M.grid),M.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,M.bucketLayerIDs.length-1,0)}updateFootprints(u,p){for(const y of this.getNodesInfo()){const T=y.node;T.footprint&&p.push({footprint:T.footprint,id:u})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(u){if(!this.needsUpload)return;const p=this.getNodesInfo();for(const y of p){const T=y.node;this.uploaded?this.updatePbrBuffer(T):Yk(T,u,!0)}for(const y of p)IE(y.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(u){let p=!1;if(!u.meshes)return p;for(const y of u.meshes)y.pbrBuffer&&(y.pbrBuffer.updateData(y.featureArray),p=!0);return p}needsReEvaluation(u,p,y){const T=u.transform.projectionOptions,b=u.style.getBrightness(),M=this.brightness!==b;return!!(!this.uploaded||this.dirty||T.name!==this.projection.name||TS(y.paint.get("model-color").value,M)||TS(y.paint.get("model-color-mix-intensity").value,M)||TS(y.paint.get("model-roughness").value,M)||TS(y.paint.get("model-emissive-strength").value,M)||TS(y.paint.get("model-height-based-emissive-strength-multiplier").value,M))&&(this.projection=T,this.brightness=b,!0)}evaluateScale(u,p){if(u.transform.zoom===this.zoom)return;this.zoom=u.transform.zoom;const y=this.getNodesInfo(),T=this.id.canonical;for(const b of y){const M=b.feature;b.evaluatedScale=p.paint.get("model-scale").evaluate(M,{},T)}}evaluate(u){const p=this.getNodesInfo();for(const y of p){if(!y.node.meshes)continue;const T=y.feature,b=y.node.meshes&&y.node.meshes[0].featureData,M=y.evaluatedColor[2],k=y.evaluatedRMEA[2],G=this.id.canonical;if(y.hasTranslucentParts=!1,b){for(let W=0;W<X9.length;W++){const R=X9[W];R.length&&(T.properties.part=R);const z=u.paint.get("model-color").evaluate(T,{},G).toRenderColor(null),j=u.paint.get("model-color-mix-intensity").evaluate(T,{},G);y.evaluatedColor[W]=[z.r,z.g,z.b,j],y.evaluatedRMEA[W][0]=u.paint.get("model-roughness").evaluate(T,{},G),y.evaluatedRMEA[W][2]=u.paint.get("model-emissive-strength").evaluate(T,{},G),y.evaluatedRMEA[W][3]=z.a,y.emissionHeightBasedParams[W]=u.paint.get("model-height-based-emissive-strength-multiplier").evaluate(T,{},G),!y.hasTranslucentParts&&z.a<1&&(y.hasTranslucentParts=!0)}delete T.properties.part,Bfe(y,M!==y.evaluatedColor[2]||k!==y.evaluatedRMEA[2],this.modelTraits)}else y.evaluatedRMEA[0][2]=u.paint.get("model-emissive-strength").evaluate(T,{},G);y.evaluatedScale=u.paint.get("model-scale").evaluate(T,{},G),this.updatePbrBuffer(y.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(u,p,y,T){const b=u.findDEMTileFor(y);if(b&&(b.tileID.canonical!==this.terrainTile||p!==this.terrainExaggeration)){if(b.dem&&b.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=b.tileID.overscaledZ;const M=d1.create(u,y,b);if(!M)return;this.modelTraits&h1.HasMapboxMeshFeatures&&this.updateDEM(u,M,y,T);for(const k of this.getNodesInfo()){const G=k.node;if(!G.footprint||!G.footprint.vertices||!G.footprint.vertices.length)continue;const W=G.footprint.vertices;let R=M.getElevationAt(W[0].x,W[0].y,!0,!0);for(let z=1;z<W.length;z++)R=Math.min(R,M.getElevationAt(W[z].x,W[z].y,!0,!0));G.elevation=R}}this.terrainTile=b.tileID.canonical,this.terrainExaggeration=p}}updateDEM(u,p,y,T){let b=p._dem._modifiedForSources[T];if(b===void 0&&(p._dem._modifiedForSources[T]=[],b=p._dem._modifiedForSources[T]),b.includes(y.canonical))return;const M=p._dem.dim;b.push(y.canonical);let k=!1;for(const G of this.getNodesInfo()){const W=G.node;if(!W.footprint||!W.footprint.grid)continue;const R=W.footprint.grid,z=p.tileCoordToPixel(R.min.x,R.min.y),j=p.tileCoordToPixel(R.max.x,R.max.y),U=Math.min(Math.min(M-j.y,z.x),Math.min(z.y,M-j.x));if(U<0)continue;const V=Wt(U,2,5);let X=Math.max(0,z.x-V),Q=Math.max(0,z.y-V),ne=Math.min(j.x+V,M-1),ue=Math.min(j.y+V,M-1);for(let ve=Q;ve<=ue;++ve)for(let Ce=X;Ce<=ne;++Ce)T_[ve*M+Ce]=255;let fe=0,ie=0;for(let ve=0;ve<R.cellsY;++ve)for(let Ce=0;Ce<R.cellsX;++Ce){if(!R.cells[ve*R.cellsX+Ce])continue;const ke=p.tileCoordToPixel(R.min.x+Ce/R.xScale,R.min.y+ve/R.yScale),Fe=p.tileCoordToPixel(R.min.x+(Ce+1)/R.xScale,R.min.y+(ve+1)/R.yScale);for(let Le=ke.y;Le<=Math.min(Fe.y+1,M-1);++Le)for(let Ke=ke.x;Ke<=Math.min(Fe.x+1,M-1);++Ke)T_[Le*M+Ke]===255&&(T_[Le*M+Ke]=0,fe+=p.getElevationAtPixel(Ke,Le),ie++)}const me=fe/ie;X=Math.max(1,z.x-V),Q=Math.max(1,z.y-V),ne=Math.min(j.x+V,M-2),ue=Math.min(j.y+V,M-2),k=!0;for(let ve=Q;ve<=ue;++ve)for(let Ce=X;Ce<=ne;++Ce)T_[ve*M+Ce]===0&&(Kk[ve*M+Ce]=p._dem.set(Ce,ve,me));for(let ve=1;ve<V;++ve){X=Math.max(1,z.x-ve),Q=Math.max(1,z.y-ve),ne=Math.min(j.x+ve,M-2),ue=Math.min(j.y+ve,M-2);for(let Ce=Q;Ce<=ue;++Ce)for(let ke=X;ke<=ne;++ke){const Fe=Ce*M+ke;if(T_[Fe]===255){let Le=0,Ke=0,Ve=-1,et=-1;for(let ut=-1;ut<=1;++ut)for(let dt=-1;dt<=1;++dt){const ft=(Ce+ut)*M+ke+dt;if(T_[ft]>=ve)continue;const _t=Kk[ft],It=Math.abs(_t);It>Ke&&(Le=_t,Ke=It,Ve=dt,et=ut)}if(Ke>.1){const ut=1-(ve+.5*Math.abs(Ve*et))/V;let dt=p._dem.get(ke,Ce)+Le*ut;const ft=p._dem.get(ke+Ve,Ce+et),_t=p._dem.get(ke-Ve,Ce-et,!0);(dt-ft)*(dt-_t)>0&&(dt=(ft+_t)/2),Kk[Fe]=p._dem.set(ke,Ce,dt),T_[Fe]=ve}}}}}k&&(p._demTile.needsDEMTextureUpload=!0,p._dem._timestamp=En.now())}getNodesInfo(){return this.nodesInfo}destroy(){const u=this.getNodesInfo();for(const p of u)IE(p.node),Zk(p.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(u,p){if(p.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=p.updateTime;const y=p.getReplacementRegionsForTile(u.toUnwrapped()),T=this.getNodesInfo();for(let b=0;b<this.nodesInfo.length;b++){const M=T[b].node;T[b].hiddenByReplacement=!!M.footprint&&!y.find(k=>k.footprint===M.footprint)}}getHeightAtTileCoord(u,p){const y=this.getNodesInfo(),T=[],b=[0,0,0],M=De.mat4.identity([]);for(let k=0;k<this.nodesInfo.length;k++){const G=y[k],W=G.node.meshes[0],R=W.transformedAabb;if(u<R.min[0]||p<R.min[1]||u>R.max[0]||p>R.max[1])continue;if(G.node.hidden===!0)return{height:1/0,maxHeight:G.feature.properties.height,hidden:!1,verticalScale:G.evaluatedScale[2]};De.mat4.invert(M,G.node.matrix),b[0]=u,b[1]=p,De.vec3.transformMat4(b,b,M);const z=(b[0]-W.aabb.min[0])/(W.aabb.max[0]-W.aabb.min[0])*A_|0,j=Math.min(63,(b[1]-W.aabb.min[1])/(W.aabb.max[1]-W.aabb.min[1])*A_|0)*A_+Math.min(63,z),U=W.heightmap[j];if(!(U<0&&G.node.footprint))return G.hiddenByReplacement?void 0:{height:U,maxHeight:G.feature.properties.height,hidden:!1,verticalScale:G.evaluatedScale[2]};if(G.node.footprint.grid.query(new At(u,p),new At(u,p),T),T.length>0)return{height:void 0,maxHeight:G.feature.properties.height,hidden:G.hiddenByReplacement,verticalScale:G.evaluatedScale[2]}}}}function TS(v,u){return!v.isLightConstant&&u}function Dfe(v,u,p,y,T,b,M,k){let G=(61440&u|(61440&u)>>4)>>8,W=(3840&u|(3840&u)>>4)>>4,R=240&u|(240&u)>>4;p[3]>0&&(G=ur(G,255*p[0],p[3]),W=ur(W,255*p[1],p[3]),R=ur(R,255*p[2],p[3]));const z=G<<8|W,j=R<<8|Math.floor(255*y[3]),U=function(ve){const Ce=Wt(ve,0,2);return Math.min(Math.round(.5*Ce*255),255)}(y[2])<<8|15*y[0]<<4|15*y[1],V=Wt(T[0],0,1),X=Wt(T[1],0,1),Q=Wt(T[2],0,1),ne=Wt(T[3],0,1);let ue,fe,ie,me;if(V!==X&&M!==b&&X!==V){const ve=M-b;fe=1/(ve*(X-V)),ie=-(b+ve*V)/(ve*(X-V));const Ce=Wt(T[4],-1,1);me=Math.pow(10,Ce),ue=255*Q<<8|255*ne}else ue=65535,fe=0,ie=1,me=1;if(v.emplaceBack(z,j,U,ue,fe,ie,me),k){const ve=k.length;k.clear();for(let Ce=0;Ce<ve;Ce++)k.emplaceBack(z,j,U,ue,fe,ie,me)}}function Bfe(v,u,p){const y=v.node;let T=0;const b=p&h1.HasMeshoptCompression;for(const M of y.meshes){if(y.lights&&y.lightMeshIndex===T||!M.featureData)continue;M.featureArray=new da,M.featureArray.reserve(M.featureData.length);let k=u;for(const G of M.featureData){const W=b?65535&G:G>>16&65535,R=b?G>>16&65535:65535&G,z=(15&R)<8?15&R:0,j=v.evaluatedRMEA[z],U=v.evaluatedColor[z],V=v.emissionHeightBasedParams[z];let X;if(k&&z===2&&y.lights&&(X=new da,X.resize(10*y.lights.length)),Dfe(M.featureArray,W,U,j,V,M.aabb.min[2],M.aabb.max[2],X),X&&k){k=!1;const Q=y.meshes[y.lightMeshIndex];Q.featureArray=X,Q.featureArray._trim()}}M.featureArray._trim(),T++}}function Y9(v,u,p,y){const T=1<<v.z;u.lat=$e((y/xn+v.y)/T),u.lng=Xe((p/xn+v.x)/T)}Nn(PE,"Tiled3dModelBucket",{omit:["layers"]}),Nn(q9,"Tiled3dModelFeature");const kfe={circle:class extends $s{constructor(v,u,p,y){super(v,{layout:Ei||(Ei=new qi({"circle-sort-key":new Jn(Tt.layout_circle["circle-sort-key"]),visibility:new vn(Tt.layout_circle.visibility)})),paint:Gs||(Gs=new qi({"circle-radius":new Jn(Tt.paint_circle["circle-radius"]),"circle-color":new Jn(Tt.paint_circle["circle-color"]),"circle-blur":new Jn(Tt.paint_circle["circle-blur"]),"circle-opacity":new Jn(Tt.paint_circle["circle-opacity"]),"circle-translate":new vn(Tt.paint_circle["circle-translate"]),"circle-translate-anchor":new vn(Tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vn(Tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vn(Tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jn(Tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jn(Tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jn(Tt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new vn(Tt.paint_circle["circle-emissive-strength"])}))},u,p,y)}createBucket(v){return new tr(v)}queryRadius(v){const u=v;return Ts("circle-radius",this,u)+Ts("circle-stroke-width",this,u)+Oi(this.paint.get("circle-translate"))}queryIntersectsFeature(v,u,p,y,T,b,M,k){const G=gi(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,v.pixelToTileUnitsFactor),W=this.paint.get("circle-radius").evaluate(u,p)+this.paint.get("circle-stroke-width").evaluate(u,p);return CV(v,y,b,M,k,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",G,W)}getProgramIds(){return["circle"]}getDefaultProgramParams(v,u,p){const y=MV(this);return{config:new an(this,{zoom:u,lut:p}),defines:y,overrideFog:!1}}},heatmap:class extends $s{createBucket(v){return new IV(v)}constructor(v,u,p,y){super(v,{layout:PV||(PV=new qi({visibility:new vn(Tt.layout_heatmap.visibility)})),paint:RV||(RV=new qi({"heatmap-radius":new Jn(Tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jn(Tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vn(Tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new hc(Tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vn(Tt.paint_heatmap["heatmap-opacity"])}))},u,p,y),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(v){v==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=iS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(v){return Ts("heatmap-radius",this,v)}queryIntersectsFeature(v,u,p,y,T,b,M,k){const G=this.paint.get("heatmap-radius").evaluate(u,p);return CV(v,y,b,M,k,!0,!0,new At(0,0),G)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(v,u,p){return v==="heatmap"?{config:new an(this,{zoom:u,lut:p}),overrideFog:!1}:{}}},hillshade:class extends $s{constructor(v,u,p,y){super(v,{layout:LV||(LV=new qi({visibility:new vn(Tt.layout_hillshade.visibility)})),paint:DV||(DV=new qi({"hillshade-illumination-direction":new vn(Tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vn(Tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vn(Tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vn(Tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vn(Tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vn(Tt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new vn(Tt.paint_hillshade["hillshade-emissive-strength"])}))},u,p,y)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(v,u,p){return{overrideFog:!1}}},fill:class extends $s{constructor(v,u,p,y){super(v,{layout:GV||(GV=new qi({"fill-sort-key":new Jn(Tt.layout_fill["fill-sort-key"]),visibility:new vn(Tt.layout_fill.visibility)})),paint:VV||(VV=new qi({"fill-antialias":new vn(Tt.paint_fill["fill-antialias"]),"fill-opacity":new Jn(Tt.paint_fill["fill-opacity"]),"fill-color":new Jn(Tt.paint_fill["fill-color"]),"fill-outline-color":new Jn(Tt.paint_fill["fill-outline-color"]),"fill-translate":new vn(Tt.paint_fill["fill-translate"]),"fill-translate-anchor":new vn(Tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jn(Tt.paint_fill["fill-pattern"]),"fill-emissive-strength":new vn(Tt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Jn(Tt.paint_fill["fill-z-offset"])}))},u,p,y)}getProgramIds(){const v=this.paint.get("fill-pattern"),u=v&&v.constantOr(1),p=[u?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&p.push(u&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),p}getDefaultProgramParams(v,u,p){return{config:new an(this,{zoom:u,lut:p}),overrideFog:!1}}recalculate(v,u){super.recalculate(v,u);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(v){return new pk(v)}queryRadius(){return Oi(this.paint.get("fill-translate"))}queryIntersectsFeature(v,u,p,y,T,b){return!v.queryGeometry.isAboveHorizon&&xr(Fr(v.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,v.pixelToTileUnitsFactor),y)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends $s{constructor(v,u,p,y){super(v,{layout:SH||(SH=new qi({visibility:new vn(Tt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new vn(Tt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:AH||(AH=new qi({"fill-extrusion-opacity":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Jn(Tt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new vn(Tt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},u,p,y),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(v){return new aE(v)}queryRadius(){return Oi(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(v,u,p,y,T,b,M,k,G){const W=gi(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,v.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(u,p),z=this.paint.get("fill-extrusion-base").evaluate(u,p),j=[0,0],U=k&&b.elevation,V=b.elevation?b.elevation.exaggeration():1,X=v.tile.getBucket(this);if(U&&X instanceof aE){const ie=X.centroidVertexArray,me=G+1;me<ie.length&&(j[0]=ie.geta_centroid_pos0(me),j[1]=ie.geta_centroid_pos1(me))}if(j[0]===0&&j[1]===1)return!1;b.projection.name==="globe"&&(y=wH([y],[new At(0,0),new At(xn,xn)],v.tileID.canonical).map(ie=>ie.polygon).flat());const Q=U?k:null,[ne,ue]=function(ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut){return ie.projection.name==="globe"?function(dt,ft,_t,It,xt,Vt,Kt,kt,Rn,wn,pn){const rn=[],rr=[],Pn=dt.projection.upVectorScale(pn,dt.center.lat,dt.worldSize).metersToTile,zn=[0,0,0,1],Sr=[0,0,0,1],Nr=(Dr,$r,Xr,ji)=>{Dr[0]=$r,Dr[1]=Xr,Dr[2]=ji,Dr[3]=1},Lr=bH();_t>0&&(_t+=Lr),It+=Lr;for(const Dr of ft){const $r=[],Xr=[];for(const ji of Dr){const Ii=ji.x+xt.x,Mr=ji.y+xt.y,bi=dt.projection.projectTilePoint(Ii,Mr,pn),Ti=dt.projection.upVector(pn,ji.x,ji.y);let ls=_t,Xs=It;if(Kt){const vo=MH(Ii,Mr,_t,It,Kt,kt,Rn,wn);ls+=vo.base,Xs+=vo.top}_t!==0?Nr(zn,bi.x+Ti[0]*Pn*ls,bi.y+Ti[1]*Pn*ls,bi.z+Ti[2]*Pn*ls):Nr(zn,bi.x,bi.y,bi.z),Nr(Sr,bi.x+Ti[0]*Pn*Xs,bi.y+Ti[1]*Pn*Xs,bi.z+Ti[2]*Pn*Xs),De.vec3.transformMat4(zn,zn,Vt),De.vec3.transformMat4(Sr,Sr,Vt),$r.push(new S_(zn[0],zn[1],zn[2])),Xr.push(new S_(Sr[0],Sr[1],Sr[2]))}rn.push($r),rr.push(Xr)}return[rn,rr]}(ie,me,ve,Ce,ke,Fe,Le,Ke,Ve,et,ut):Le?function(dt,ft,_t,It,xt,Vt,Kt,kt,Rn){const wn=[],pn=[],rn=[0,0,0,1];for(const rr of dt){const Pn=[],zn=[];for(const Sr of rr){const Nr=Sr.x+It.x,Lr=Sr.y+It.y,Dr=MH(Nr,Lr,ft,_t,Vt,Kt,kt,Rn);rn[0]=Nr,rn[1]=Lr,rn[2]=Dr.base,rn[3]=1,De.vec4.transformMat4(rn,rn,xt),rn[3]=Math.max(rn[3],1e-5);const $r=new S_(rn[0]/rn[3],rn[1]/rn[3],rn[2]/rn[3]);rn[0]=Nr,rn[1]=Lr,rn[2]=Dr.top,rn[3]=1,De.vec4.transformMat4(rn,rn,xt),rn[3]=Math.max(rn[3],1e-5);const Xr=new S_(rn[0]/rn[3],rn[1]/rn[3],rn[2]/rn[3]);Pn.push($r),zn.push(Xr)}wn.push(Pn),pn.push(zn)}return[wn,pn]}(me,ve,Ce,ke,Fe,Le,Ke,Ve,et):function(dt,ft,_t,It,xt){const Vt=[],Kt=[],kt=xt[8]*ft,Rn=xt[9]*ft,wn=xt[10]*ft,pn=xt[11]*ft,rn=xt[8]*_t,rr=xt[9]*_t,Pn=xt[10]*_t,zn=xt[11]*_t;for(const Sr of dt){const Nr=[],Lr=[];for(const Dr of Sr){const $r=Dr.x+It.x,Xr=Dr.y+It.y,ji=xt[0]*$r+xt[4]*Xr+xt[12],Ii=xt[1]*$r+xt[5]*Xr+xt[13],Mr=xt[2]*$r+xt[6]*Xr+xt[14],bi=xt[3]*$r+xt[7]*Xr+xt[15],Ti=ji+kt,ls=Ii+Rn,Xs=Mr+wn,vo=Math.max(bi+pn,1e-5),qs=ji+rn,Ns=Ii+rr,fa=Mr+Pn,Mo=Math.max(bi+zn,1e-5);Nr.push(new S_(Ti/vo,ls/vo,Xs/vo)),Lr.push(new S_(qs/Mo,Ns/Mo,fa/Mo))}Vt.push(Nr),Kt.push(Lr)}return[Vt,Kt]}(me,ve,Ce,ke,Fe)}(b,y,z,R,W,M,Q,j,V,b.center.lat,v.tileID.canonical),fe=v.queryGeometry;return function(ie,me,ve){let Ce=1/0;xr(ve,me)&&(Ce=TH(ve,me[0]));for(let ke=0;ke<me.length;ke++){const Fe=me[ke],Le=ie[ke];for(let Ke=0;Ke<Fe.length-1;Ke++){const Ve=Fe[Ke],et=[Ve,Fe[Ke+1],Le[Ke+1],Le[Ke],Ve];bn(ve,et)&&(Ce=Math.min(Ce,TH(ve,et)))}}return Ce!==1/0&&Ce}(ne,ue,fe.isPointQuery()?fe.screenBounds:fe.screenGeometry)}},line:class extends $s{constructor(v,u,p,y){const T=OH();super(v,T,u,p,y),T.layout&&(this.layout=new ih(T.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(v){if(v==="line-gradient"){const u=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=u._styleExpression&&u._styleExpression.expression instanceof Mf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(v,u){super.recalculate(v,u),this.paint._values["line-floorwidth"]=(()=>{if(fS)return fS;const p=OH();return fS=new Nde(p.paint.properties["line-width"].specification),fS.useIntegerZoom=!0,fS})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,v)}createBucket(v){return new Ak(v)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(v,u,p){const y=BH(this);return{config:new an(this,{zoom:u,lut:p}),defines:y,overrideFog:!1}}queryRadius(v){const u=v,p=FH(Ts("line-width",this,u),Ts("line-gap-width",this,u)),y=Ts("line-offset",this,u);return p/2+Math.abs(y)+Oi(this.paint.get("line-translate"))}queryIntersectsFeature(v,u,p,y,T,b){if(v.queryGeometry.isAboveHorizon)return!1;const M=Fr(v.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,v.pixelToTileUnitsFactor),k=v.pixelToTileUnitsFactor/2*FH(this.paint.get("line-width").evaluate(u,p),this.paint.get("line-gap-width").evaluate(u,p)),G=this.paint.get("line-offset").evaluate(u,p);return G&&(y=function(W,R){const z=[],j=new At(0,0);for(let U=0;U<W.length;U++){const V=W[U],X=[];for(let Q=0;Q<V.length;Q++){const ne=V[Q],ue=V[Q+1],fe=Q===0?j:ne.sub(V[Q-1])._unit()._perp(),ie=Q===V.length-1?j:ue.sub(ne)._unit()._perp(),me=fe._add(ie)._unit();me._mult(1/(me.x*ie.x+me.y*ie.y)),X.push(me._mult(R)._add(ne))}z.push(X)}return z}(y,G*v.pixelToTileUnitsFactor)),function(W,R,z){for(let j=0;j<R.length;j++){const U=R[j];if(W.length>=3){for(let V=0;V<U.length;V++)if(as(W,U[V]))return!0}if(Yn(W,U,z))return!0}return!1}(M,y,k)}isTileClipped(){return!0}isDraped(v){const u=this.layout.get("line-z-offset");return u.isConstant()&&!u.constantOr(0)}},symbol:wE,background:class extends $s{constructor(v,u,p,y){super(v,{layout:x9||(x9=new qi({visibility:new vn(Tt.layout_background.visibility)})),paint:b9||(b9=new qi({"background-pitch-alignment":new vn(Tt.paint_background["background-pitch-alignment"]),"background-color":new vn(Tt.paint_background["background-color"]),"background-pattern":new vn(Tt.paint_background["background-pattern"]),"background-opacity":new vn(Tt.paint_background["background-opacity"]),"background-emissive-strength":new vn(Tt.paint_background["background-emissive-strength"])}))},u,p,y)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(v,u,p){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:M9,"raster-particle":L9,sky:class extends $s{constructor(v,u,p,y){super(v,{layout:I9||(I9=new qi({visibility:new vn(Tt.layout_sky.visibility)})),paint:P9||(P9=new qi({"sky-type":new vn(Tt.paint_sky["sky-type"]),"sky-atmosphere-sun":new vn(Tt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new vn(Tt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new vn(Tt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new vn(Tt.paint_sky["sky-gradient-radius"]),"sky-gradient":new hc(Tt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new vn(Tt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new vn(Tt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new vn(Tt.paint_sky["sky-opacity"])}))},u,p,y),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(v){v==="sky-gradient"?this._updateColorRamp():v!=="sky-atmosphere-sun"&&v!=="sky-atmosphere-halo-color"&&v!=="sky-atmosphere-color"&&v!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=iS({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(v){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const u=v.style.light.properties.get("position");return this._lightPosition.azimuthal!==u.azimuthal||this._lightPosition.polar!==u.polar}return!1}getCenter(v,u){if(this.paint.get("sky-type")==="atmosphere"){const y=this.paint.get("sky-atmosphere-sun"),T=!y,b=v.style.light,M=b.properties.get("position");return T&&b.properties.get("anchor")==="viewport"&&Bt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),T?Wk(M.azimuthal,90-M.polar,u):Wk(y[0],90-y[1],u)}const p=this.paint.get("sky-gradient-center");return Wk(p[0],90-p[1],u)}isSky(){return!0}markSkyboxValid(v){this._skyboxInvalidated=!1,this._lightPosition=v.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const v=this.paint.get("sky-type");return v==="atmosphere"?["skyboxCapture","skybox"]:v==="gradient"?["skyboxGradient"]:null}},slot:class extends $s{constructor(v,u,p,y){super(v,{paint:R9||(R9=new qi({}))},u,null)}},model:class extends $s{constructor(v,u,p,y){super(v,{layout:V9||(V9=new qi({visibility:new vn(Tt.layout_model.visibility),"model-id":new Jn(Tt.layout_model["model-id"])})),paint:H9||(H9=new qi({"model-opacity":new vn(Tt.paint_model["model-opacity"]),"model-rotation":new Jn(Tt.paint_model["model-rotation"]),"model-scale":new Jn(Tt.paint_model["model-scale"]),"model-translation":new Jn(Tt.paint_model["model-translation"]),"model-color":new Jn(Tt.paint_model["model-color"]),"model-color-mix-intensity":new Jn(Tt.paint_model["model-color-mix-intensity"]),"model-type":new vn(Tt.paint_model["model-type"]),"model-cast-shadows":new vn(Tt.paint_model["model-cast-shadows"]),"model-receive-shadows":new vn(Tt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new vn(Tt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Jn(Tt.paint_model["model-emissive-strength"]),"model-roughness":new Jn(Tt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Jn(Tt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new vn(Tt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new vn(Tt.paint_model["model-front-cutoff"])}))},u,p,y),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(v){return new qk(v)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(v){return v instanceof PE?xn-1:0}queryIntersectsFeature(v,u,p,y,T,b){if(!this.modelManager)return!1;const M=this.modelManager,k=v.tile.getBucket(this);if(!(k&&k instanceof qk))return!1;const G=k;for(const W in G.instancesPerModel){const R=G.instancesPerModel[W],z=u.id!==void 0?u.id:u.properties&&u.properties.hasOwnProperty("id")?u.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(z)){const j=R.features[R.idToFeaturesIndex[z]],U=M.getModel(W,this.scope);if(!U)return!1;let V=De.mat4.create();const X=new de(0,0),Q=G.canonical;let ne=Number.MAX_VALUE;for(let ue=0;ue<j.instancedDataCount;++ue){const fe=16*(j.instancedDataOffset+ue),ie=R.instancedDataArray.float32,me=[ie[fe+4],ie[fe+5],ie[fe+6]];Y9(Q,X,ie[fe],0|ie[fe+1]),j9(V,U,b,X,j.rotation,j.scale,me,!1,!1,!1),b.projection.name==="globe"&&(V=Xk(V,b));const ve=De.mat4.multiply([],b.projMatrix,V),Ce=v.queryGeometry,ke=F9(Ce.isPointQuery()?Ce.screenBounds:Ce.screenGeometry,b,ve,U.aabb);ke!=null&&(ne=Math.min(ke,ne))}return ne!==Number.MAX_VALUE&&ne}}return!1}_handleOverridablePaintPropertyUpdate(v,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven()||v!=="model-color"&&v!=="model-color-mix-intensity"&&v!=="model-rotation"&&v!=="model-scale"&&v!=="model-translation"&&v!=="model-emissive-strength")}_isPropertyZoomDependent(v){const u=this._transitionablePaint._values[v];return u!=null&&u.value!=null&&u.value.expression!=null&&u.value.expression instanceof ml}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(v,u,p,y){const T=v.tile,b=T.getBucket(this);let M=null,k=Number.MAX_VALUE;if(!(b&&b instanceof PE))return{queryFeature:M,intersectionZ:k};const G=b.getNodesInfo()[u];if(G.hiddenByReplacement||!G.node.meshes||!p.filter(new gs(T.tileID.overscaledZ),G.feature,T.tileID.canonical))return{queryFeature:M,intersectionZ:k};const W=G.node,R=y.calculatePosMatrix(T.tileID.toUnwrapped(),y.worldSize),z=G.evaluatedScale;let j=0;y.elevation&&W.elevation&&(j=W.elevation*y.elevation.exaggeration()),De.mat4.translate(R,R,[(W.anchor?W.anchor[0]:0)*(z[0]-1),(W.anchor?W.anchor[1]:0)*(z[1]-1),j]),De.mat4.scale(R,R,z),De.mat4.multiply(R,R,W.matrix);const U=v.queryGeometry,V=U.isPointQuery()?U.screenBounds:U.screenGeometry,X=function(ne){const ue=De.mat4.multiply([],R,ne.matrix),fe=De.mat4.multiply(ue,y.expandedFarZProjMatrix,ue);for(let ie=0;ie<ne.meshes.length;++ie){const me=ne.meshes[ie];if(ie===ne.lightMeshIndex)continue;const ve=F9(V,y,fe,me.aabb);ve!=null&&(k=Math.min(ve,k))}if(ne.children)for(const ie of ne.children)X(ie)};if(X(W),k===Number.MAX_VALUE)return{queryFeature:M,intersectionZ:k};const Q=new de(0,0);return Y9(T.tileID.canonical,Q,G.node.anchor[0],G.node.anchor[1]),M={type:"Feature",geometry:{type:"Point",coordinates:[Q.lng,Q.lat]},properties:G.feature.properties,id:G.feature.id,state:{},layer:this.serialize()},{queryFeature:M,intersectionZ:k}}},clip:class extends $s{constructor(v,u,p,y){super(v,{layout:HV||(HV=new qi({"clip-layer-types":new vn(Tt.layout_clip["clip-layer-types"]),"clip-layer-scope":new vn(Tt.layout_clip["clip-layer-scope"])})),paint:jV||(jV=new qi({}))},u,p,y)}recalculate(v,u){super.recalculate(v,u)}createBucket(v){return new WV(v)}isTileClipped(){return!0}is3D(){return!0}}};class Ofe{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ffe{constructor(){this.tasks={},this.taskQueue=[],zr(["process"],this),this.invoker=new Ofe(this.process),this.nextId=0}add(u,p){const y=this.nextId++,T=function({type:b,isSymbolTile:M,zoom:k}){return k=k||0,b==="message"?0:b!=="maybePrepare"||M?b!=="parseTile"||M?b==="parseTile"&&M?300-k:b==="maybePrepare"&&M?400-k:500:200-k:100-k}(p);if(T===0){try{u()}finally{}return null}return this.tasks[y]={fn:u,metadata:p,priority:T,id:y},this.taskQueue.push(y),this.invoker.trigger(),{cancel:()=>{delete this.tasks[y]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(y=>!!this.tasks[y]),!this.taskQueue.length)return;const u=this.pick();if(u===null)return;const p=this.tasks[u];if(delete this.tasks[u],this.taskQueue.length&&this.invoker.trigger(),!p)return;p.fn()}finally{}}pick(){let u=null,p=1/0;for(let T=0;T<this.taskQueue.length;T++){const b=this.tasks[this.taskQueue[T]];b.priority<p&&(p=b.priority,u=T)}if(u===null)return null;const y=this.taskQueue[u];return this.taskQueue.splice(u,1),y}remove(){this.invoker.remove()}}class Z9{constructor(u,p,y){this.target=u,this.parent=p,this.mapId=y,this.callbacks={},this.cancelCallbacks={},zr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Ffe}send(u,p,y,T,b=!1,M){const k=Math.round(1e18*Math.random()).toString(36).substring(0,10);y&&(y.metadata=M,this.callbacks[k]=y);const G=new Set;return this.target.postMessage({id:k,type:u,hasCallback:!!y,targetMapId:T,mustQueue:b,sourceMapId:this.mapId,data:wa(p,G)},G),{cancel:()=>{y&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(u){const p=u.data,y=p.id;if(y&&(!p.targetMapId||this.mapId===p.targetMapId))if(p.type==="<cancel>"){const T=this.cancelCallbacks[y];delete this.cancelCallbacks[y],T&&T.cancel()}else if(p.mustQueue||Tr()){const T=this.callbacks[y],b=this.scheduler.add(()=>this.processTask(y,p),T&&T.metadata||{type:"message"});b&&(this.cancelCallbacks[y]=b)}else this.processTask(y,p)}processTask(u,p){if(delete this.cancelCallbacks[u],p.type==="<response>"){const y=this.callbacks[u];delete this.callbacks[u],y&&(p.error?y(nh(p.error)):y(null,nh(p.data)))}else{const y=new Set,T=p.hasCallback?(M,k)=>{this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:M?wa(M):null,data:wa(k,y)},y)}:M=>{},b=nh(p.data);if(this.parent[p.type])this.parent[p.type](p.sourceMapId,b,T);else if(this.parent.getWorkerSource){const M=p.type.split(".");this.parent.getWorkerSource(p.sourceMapId,M[0],b.source,b.scope)[M[1]](b,T)}else T(new Error(`Could not find function ${p.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class f1{constructor(u,p){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=sr();const y=this.workerPool.acquire(this.id);for(let T=0;T<y.length;T++){const b=new f1.Actor(y[T],p,this.id);b.name=`Worker ${T}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,p,y){nr(this.actors,(T,b)=>{T.send(u,p,b)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}f1.Actor=Z9;class K9{constructor(u){this.size=u,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(u,p){const y=this.toIdx(u,p);return{min:this.minimums[y],max:this.maximums[y]}}isLeaf(u,p){return this.leaves[this.toIdx(u,p)]}toIdx(u,p){return p*this.size+u}}function J9(v,u,p,y){let T=0,b=Number.MAX_VALUE;for(let M=0;M<3;M++)if(Math.abs(y[M])<1e-15){if(p[M]<v[M]||p[M]>u[M])return null}else{const k=1/y[M];let G=(v[M]-p[M])*k,W=(u[M]-p[M])*k;if(G>W){const R=G;G=W,W=R}if(G>T&&(T=G),W<b&&(b=W),T>b)return null}return T}function Q9(v,u,p,y,T,b,M,k,G,W,R){const z=y-v,j=T-u,U=b-p,V=M-v,X=k-u,Q=G-p,ne=R[1]*Q-R[2]*X,ue=R[2]*V-R[0]*Q,fe=R[0]*X-R[1]*V,ie=z*ne+j*ue+U*fe;if(Math.abs(ie)<1e-15)return null;const me=1/ie,ve=W[0]-v,Ce=W[1]-u,ke=W[2]-p,Fe=(ve*ne+Ce*ue+ke*fe)*me;if(Fe<0||Fe>1)return null;const Le=Ce*U-ke*j,Ke=ke*z-ve*U,Ve=ve*j-Ce*z,et=(R[0]*Le+R[1]*Ke+R[2]*Ve)*me;return et<0||Fe+et>1?null:(V*Le+X*Ke+Q*Ve)*me}function ej(v,u,p){return(v-u)/(p-u)}function tj(v,u,p,y,T,b,M,k,G){const W=1<<p,R=b-y,z=M-T,j=(v+1)/W*R+y,U=(u+0)/W*z+T,V=(u+1)/W*z+T;k[0]=(v+0)/W*R+y,k[1]=U,G[0]=j,G[1]=V}class nj{constructor(u){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=u,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const p=function(b){const M=Math.ceil(Math.log2(b.dim/8)),k=[];let G=Math.ceil(Math.pow(2,M));const W=1/G,R=(U,V,X,Q,ne)=>{const ue=Q?1:0,fe=(U+1)*X-ue,ie=V*X,me=(V+1)*X-ue;ne[0]=U*X,ne[1]=ie,ne[2]=fe,ne[3]=me};let z=new K9(G);const j=[];for(let U=0;U<G*G;U++){R(U%G,Math.floor(U/G),W,!1,j);const V=fv(j[0],j[1],b),X=fv(j[2],j[1],b),Q=fv(j[2],j[3],b),ne=fv(j[0],j[3],b);z.minimums.push(Math.min(V,X,Q,ne)),z.maximums.push(Math.max(V,X,Q,ne)),z.leaves.push(1)}for(k.push(z),G/=2;G>=1;G/=2){const U=k[k.length-1];z=new K9(G);for(let V=0;V<G*G;V++){R(V%G,Math.floor(V/G),2,!0,j);const X=U.getElevation(j[0],j[1]),Q=U.getElevation(j[2],j[1]),ne=U.getElevation(j[2],j[3]),ue=U.getElevation(j[0],j[3]),fe=U.isLeaf(j[0],j[1]),ie=U.isLeaf(j[2],j[1]),me=U.isLeaf(j[2],j[3]),ve=U.isLeaf(j[0],j[3]),Ce=Math.min(X.min,Q.min,ne.min,ue.min),ke=Math.max(X.max,Q.max,ne.max,ue.max),Fe=fe&&ie&&me&&ve;z.maximums.push(ke),z.minimums.push(Ce),z.leaves.push(ke-Ce<=5&&Fe?1:0)}k.push(z)}return k}(this.dem),y=p.length-1,T=p[y];this._addNode(T.minimums[0],T.maximums[0],T.leaves[0]),this._construct(p,0,0,y,0)}raycastRoot(u,p,y,T,b,M,k=1){return J9([u,p,-100],[y,T,this.maximums[0]*k],b,M)}raycast(u,p,y,T,b,M,k=1){if(!this.nodeCount)return null;const G=this.raycastRoot(u,p,y,T,b,M,k);if(G==null)return null;const W=[],R=[],z=[],j=[],U=[{idx:0,t:G,nodex:0,nodey:0,depth:0}];for(;U.length>0;){const{idx:V,t:X,nodex:Q,nodey:ne,depth:ue}=U.pop();if(this.leaves[V]){tj(Q,ne,ue,u,p,y,T,z,j);const ie=1<<ue,me=(Q+0)/ie,ve=(Q+1)/ie,Ce=(ne+0)/ie,ke=(ne+1)/ie,Fe=fv(me,Ce,this.dem)*k,Le=fv(ve,Ce,this.dem)*k,Ke=fv(ve,ke,this.dem)*k,Ve=fv(me,ke,this.dem)*k,et=Q9(z[0],z[1],Fe,j[0],z[1],Le,j[0],j[1],Ke,b,M),ut=Q9(j[0],j[1],Ke,z[0],j[1],Ve,z[0],z[1],Fe,b,M),dt=Math.min(et!==null?et:Number.MAX_VALUE,ut!==null?ut:Number.MAX_VALUE);if(dt!==Number.MAX_VALUE)return dt;{const ft=De.vec3.scaleAndAdd([],b,M,X);if(rj(Fe,Le,Ve,Ke,ej(ft[0],z[0],j[0]),ej(ft[1],z[1],j[1]))>=ft[2])return X}continue}let fe=0;for(let ie=0;ie<this._siblingOffset.length;ie++){tj((Q<<1)+this._siblingOffset[ie][0],(ne<<1)+this._siblingOffset[ie][1],ue+1,u,p,y,T,z,j),z[2]=-100,j[2]=this.maximums[this.childOffsets[V]+ie]*k;const me=J9(z,j,b,M);if(me!=null){const ve=me;W[ie]=ve;let Ce=!1;for(let ke=0;ke<fe&&!Ce;ke++)ve>=W[R[ke]]&&(R.splice(ke,0,ie),Ce=!0);Ce||(R[fe]=ie),fe++}}for(let ie=0;ie<fe;ie++){const me=R[ie];U.push({idx:this.childOffsets[V]+me,t:W[me],nodex:(Q<<1)+this._siblingOffset[me][0],nodey:(ne<<1)+this._siblingOffset[me][1],depth:ue+1})}}return null}_addNode(u,p,y){return this.minimums.push(u),this.maximums.push(p),this.leaves.push(y),this.childOffsets.push(0),this.nodeCount++}_construct(u,p,y,T,b){if(u[T].isLeaf(p,y)===1)return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const M=T-1,k=u[M];let G=0,W=0;for(let R=0;R<this._siblingOffset.length;R++){const z=2*p+this._siblingOffset[R][0],j=2*y+this._siblingOffset[R][1],U=k.getElevation(z,j),V=k.isLeaf(z,j),X=this._addNode(U.min,U.max,V);V&&(G|=1<<R),W||(W=X)}for(let R=0;R<this._siblingOffset.length;R++)G&1<<R||this._construct(u,2*p+this._siblingOffset[R][0],2*y+this._siblingOffset[R][1],M,W+R)}}function rj(v,u,p,y,T,b){return ur(ur(v,p,b),ur(u,y,b),T)}function fv(v,u,p){const y=p.dim,T=Wt(v*y-.5,0,y-1),b=Wt(u*y-.5,0,y-1),M=Math.floor(T),k=Math.floor(b),G=Math.min(M+1,y-1),W=Math.min(k+1,y-1);return rj(p.get(M,k),p.get(G,k),p.get(M,W),p.get(G,W),T-M,b-k)}const Nfe={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function zfe(v,u,p){return(256*v*256+256*u+p)/10-1e4}function Ufe(v,u,p){return 256*v+u+p/256-32768}class RE{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(u,p,y,T=!1){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(y&&y!=="mapbox"&&y!=="terrarium")return void Bt(`"${y}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const b=this.dim=p.height-2,M=new Uint32Array(p.data.buffer);if(this.pixels=new Uint8Array(p.data.buffer),this.floatView=new Float32Array(p.data.buffer),this.borderReady=T,this._modifiedForSources={},!T){for(let G=0;G<b;G++)M[this._idx(-1,G)]=M[this._idx(0,G)],M[this._idx(b,G)]=M[this._idx(b-1,G)],M[this._idx(G,-1)]=M[this._idx(G,0)],M[this._idx(G,b)]=M[this._idx(G,b-1)];M[this._idx(-1,-1)]=M[this._idx(0,0)],M[this._idx(b,-1)]=M[this._idx(b-1,0)],M[this._idx(-1,b)]=M[this._idx(0,b-1)],M[this._idx(b,b)]=M[this._idx(b-1,b-1)]}const k=y==="terrarium"?Ufe:zfe;for(let G=0;G<M.length;++G){const W=4*G;this.floatView[G]=k(this.pixels[W],this.pixels[W+1],this.pixels[W+2])}this._timestamp=En.now()}_buildQuadTree(){this._tree=new nj(this)}get(u,p,y=!1){y&&(u=Wt(u,-1,this.dim),p=Wt(p,-1,this.dim));const T=this._idx(u,p);return this.floatView[T]}set(u,p,y){const T=this._idx(u,p),b=this.floatView[T];return this.floatView[T]=y,y-b}static getUnpackVector(u){return Nfe[u]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}static pack(u,p){const y=[0,0,0,0],T=RE.getUnpackVector(p);let b=Math.floor((u+T[3])/T[2]);return y[2]=b%256,b=Math.floor(b/256),y[1]=b%256,b=Math.floor(b/256),y[0]=b,y}getPixels(){return new OV({width:this.stride,height:this.stride},this.pixels)}backfillBorder(u,p,y){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let T=p*this.dim,b=p*this.dim+this.dim,M=y*this.dim,k=y*this.dim+this.dim;switch(p){case-1:T=b-1;break;case 1:b=T+1}switch(y){case-1:M=k-1;break;case 1:k=M+1}const G=-p*this.dim,W=-y*this.dim;for(let R=M;R<k;R++)for(let z=T;z<b;z++){const j=4*this._idx(z,R),U=4*this._idx(z+G,R+W);this.pixels[j+0]=u.pixels[U+0],this.pixels[j+1]=u.pixels[U+1],this.pixels[j+2]=u.pixels[U+2],this.pixels[j+3]=u.pixels[U+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Gfe(v,u,p){v===1?u.header_length=p.readFixed32():v===2?u.x=p.readVarint():v===3?u.y=p.readVarint():v===4?u.z=p.readVarint():v===5&&u.layers.push(function(y,T){return y.readFields($fe,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},T)}(p,p.readVarint()+p.pos))}function Vfe(v,u,p){v===1?(u.delta_filter=function(y,T){return y.readFields(Hfe,{block_size:0},T)}(p,p.readVarint()+p.pos),u.filter="delta_filter"):v===2?(p.readVarint(),u.filter="zigzag_filter"):v===3?(p.readVarint(),u.filter="bitshuffle_filter"):v===4&&(p.readVarint(),u.filter="byteshuffle_filter")}function Hfe(v,u,p){v===1&&(u.block_size=p.readVarint())}function jfe(v,u,p){v===1?(p.readVarint(),u.codec="gzip_data"):v===2?(p.readVarint(),u.codec="jpeg_image"):v===3?(p.readVarint(),u.codec="webp_image"):v===4&&(p.readVarint(),u.codec="png_image")}function Wfe(v,u,p){v===1?u.first_byte=p.readFixed64():v===2?u.last_byte=p.readFixed64():v===3?u.filters.push(function(y,T){return y.readFields(Vfe,{},T)}(p,p.readVarint()+p.pos)):v===4?u.codec=function(y,T){return y.readFields(jfe,{},T)}(p,p.readVarint()+p.pos):v===5?u.deprecated_offset=p.readFloat():v===6?u.deprecated_scale=p.readFloat():v===7?u.bands.push(p.readString()):v===8?u.offset=p.readDouble():v===9&&(u.scale=p.readDouble())}function $fe(v,u,p){v===1?u.version=p.readVarint():v===2?u.name=p.readString():v===3?u.units=p.readString():v===4?u.tilesize=p.readVarint():v===5?u.buffer=p.readVarint():v===6?u.pixel_format=p.readVarint():v===7&&u.data_index.push(function(y,T){return y.readFields(Wfe,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},T)}(p,p.readVarint()+p.pos))}function Xfe(v,u,p){if(v===2)(function(y,T,b){y.readFields(qfe,b,T)})(p,p.readVarint()+p.pos,u);else if(v===3)throw new Error("Not implemented")}function qfe(v,u,p){if(v===1){let y=0;const T=p.readVarint()+p.pos;for(;p.pos<T;)u[y++]=p.readVarint()}}Nn(RE,"DEMData"),Nn(nj,"DemMinMaxQuadTree",{omit:["dem"]});class Yfe{constructor(u){this.capacity=u,this.cache=new Map}get(u){if(!this.cache.has(u))return;const p=this.cache.get(u);return this.cache.delete(u),this.cache.set(u,p),p}put(u,p){this.cache.has(u)?this.cache.delete(u):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(u,p)}}function Zfe(v,u){if(u.length!==4)throw new Error(`Expected data of dimension 4 but got ${u.length}.`);let p=u[3];for(let y=2;y>=1;y--){const T=y===1?1:0,b=y===2?1:0;for(let M=0;M<u[0];M++){const k=u[1]*M;for(let G=T;G<u[1];G++){const W=u[2]*(G+k);for(let R=b;R<u[2];R++){const z=u[3]*(R+W);for(let j=0;j<u[3];j++){const U=z+j;v[U]+=v[U-p]}}}}p*=u[y]}return v}function Kfe(v){for(let u=0,p=v.length;u<p;u++)v[u]=v[u]>>>1^-(1&v[u]);return v}function Jfe(v,u){switch(u){case"uint32":return v;case"uint16":for(let p=0;p<v.length;p+=2){const y=v[p],T=v[p+1];v[p]=(240&y)>>4|(61440&y)>>8|(240&T)<<4|61440&T,v[p+1]=15&y|(3840&y)>>4|(15&T)<<8|(3840&T)<<4}return v;case"uint8":for(let p=0;p<v.length;p+=4){const y=v[p],T=v[p+1],b=v[p+2],M=v[p+3];v[p+0]=(192&y)>>6|(192&T)>>4|(192&b)>>2|192&M,v[p+1]=(48&y)>>4|(48&T)>>2|48&b|(48&M)<<2,v[p+2]=(12&y)>>2|12&T|(12&b)<<2|(12&M)<<4,v[p+3]=3&y|(3&T)<<2|(3&b)<<4|(3&M)<<6}return v;default:throw new Error(`Invalid pixel format, "${u}"`)}}var Ru=Uint8Array,MS=Uint16Array,Qfe=Int32Array,ij=new Ru([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sj=new Ru([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),epe=new Ru([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oj=function(v,u){for(var p=new MS(31),y=0;y<31;++y)p[y]=u+=1<<v[y-1];var T=new Qfe(p[30]);for(y=1;y<30;++y)for(var b=p[y];b<p[y+1];++b)T[b]=b-p[y]<<5|y;return{b:p,r:T}},aj=oj(ij,2),lj=aj.b,tpe=aj.r;lj[28]=258,tpe[258]=28;for(var npe=oj(sj,0).b,cj=new MS(32768),go=0;go<32768;++go){var p1=(43690&go)>>1|(21845&go)<<1;cj[go]=((65280&(p1=(61680&(p1=(52428&p1)>>2|(13107&p1)<<2))>>4|(3855&p1)<<4))>>8|(255&p1)<<8)>>1}var CS=function(v,u,p){for(var y=v.length,T=0,b=new MS(u);T<y;++T)v[T]&&++b[v[T]-1];var M,k=new MS(u);for(T=1;T<u;++T)k[T]=k[T-1]+b[T-1]<<1;M=new MS(1<<u);var G=15-u;for(T=0;T<y;++T)if(v[T])for(var W=T<<4|v[T],R=u-v[T],z=k[v[T]-1]++<<R,j=z|(1<<R)-1;z<=j;++z)M[cj[z]>>G]=W;return M},ES=new Ru(288);for(go=0;go<144;++go)ES[go]=8;for(go=144;go<256;++go)ES[go]=9;for(go=256;go<280;++go)ES[go]=7;for(go=280;go<288;++go)ES[go]=8;var uj=new Ru(32);for(go=0;go<32;++go)uj[go]=5;var rpe=CS(ES,9),ipe=CS(uj,5),Jk=function(v){for(var u=v[0],p=1;p<v.length;++p)v[p]>u&&(u=v[p]);return u},Md=function(v,u,p){var y=u/8|0;return(v[y]|v[y+1]<<8)>>(7&u)&p},Qk=function(v,u){var p=u/8|0;return(v[p]|v[p+1]<<8|v[p+2]<<16)>>(7&u)},spe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Cd=function(v,u,p){var y=new Error(u||spe[v]);if(y.code=v,Error.captureStackTrace&&Error.captureStackTrace(y,Cd),!p)throw y;return y},ope=new Ru(0),ape=typeof TextDecoder<"u"&&new TextDecoder;try{ape.decode(ope,{stream:!0})}catch{}const lpe={gzip_data:"gzip"};class uh extends Error{constructor(u){super(u),this.name="MRTError"}}const cpe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},hj={uint32:1,uint16:2,uint8:4},upe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let eO;class tO{constructor(u=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=u}getLayer(u){const p=this.layers[u];if(!p)throw new uh(`Layer '${u}' not found`);return p}getHeaderLength(u){const p=new Uint8Array(u),y=new DataView(u);if(p[0]!==13)throw new uh("File is not a valid MRT.");return y.getUint32(1,!0)}parseHeader(u){const p=new Uint8Array(u),y=this.getHeaderLength(u);if(p.length<y)throw new uh(`Expected header with length >= ${y} but got buffer of length ${p.length}`);const T=function(b,M){return b.readFields(Gfe,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new eO(p.subarray(0,y)));if(!isNaN(this.x)&&(this.x!==T.x||this.y!==T.y||this.z!==T.z))throw new uh(`Invalid attempt to parse header ${T.z}/${T.x}/${T.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=T.x,this.y=T.y,this.z=T.z;for(const b of T.layers)this.layers[b.name]=new hpe(b,{cacheSize:this._cacheSize});return this}createDecodingTask(u){const p=[],y=this.getLayer(u.layerName);for(let T of u.blockIndices){const b=y.dataIndex[T],M=b.first_byte-u.firstByte,k=b.last_byte-u.firstByte;if(y._blocksInProgress.has(T))continue;const G={layerName:y.name,firstByte:M,lastByte:k,pixelFormat:y.pixelFormat,blockIndex:T,blockShape:[b.bands.length].concat(y.bandShape),buffer:y.buffer,codec:b.codec.codec,filters:b.filters.map(W=>W.filter)};y._blocksInProgress.add(T),p.push(G)}return new dj(p,()=>{p.forEach(T=>y._blocksInProgress.delete(T.blockIndex))},(T,b)=>{if(p.forEach(M=>y._blocksInProgress.delete(M.blockIndex)),T)throw T;b.forEach(M=>{this.getLayer(M.layerName).processDecodedData(M)})})}}class hpe{constructor({version:u,name:p,units:y,tilesize:T,pixel_format:b,buffer:M,data_index:k},G){if(this.version=u,this.version!==1)throw new uh(`Cannot parse raster layer encoded with MRT version ${u}`);this.name=p,this.units=y,this.tileSize=T,this.buffer=M,this.pixelFormat=cpe[b],this.dataIndex=k,this.bandShape=[T+2*M,T+2*M,hj[this.pixelFormat]],this._decodedBlocks=new Yfe(G?G.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return hj[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:u})=>u).flat()}processDecodedData(u){const p=u.blockIndex.toString();this._decodedBlocks.get(p)||this._decodedBlocks.put(p,u.data)}getBlockForBand(u){let p=0;switch(typeof u){case"string":for(const[y,T]of this.dataIndex.entries()){for(const[b,M]of T.bands.entries())if(M===u)return{bandIndex:p+b,blockIndex:y,blockBandIndex:b};p+=T.bands.length}break;case"number":for(const[y,T]of this.dataIndex.entries()){if(u>=p&&u<p+T.bands.length)return{bandIndex:u,blockIndex:y,blockBandIndex:u-p};p+=T.bands.length}break;default:throw new uh(`Invalid band \`${JSON.stringify(u)}\`. Expected string or integer.`)}throw new uh(`Band not found: ${JSON.stringify(u)}`)}getDataRange(u){let p=1/0,y=-1/0;const T=[],b=new Set;for(const M of u){const{blockIndex:k}=this.getBlockForBand(M);if(k<0)throw new uh(`Invalid band: ${JSON.stringify(M)}`);const G=this.dataIndex[k];T.includes(k)||T.push(k),b.add(k),p=Math.min(p,G.first_byte),y=Math.max(y,G.last_byte)}if(b.size>this.cacheSize)throw new uh(`Number of blocks to decode (${b.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:p,lastByte:y,blockIndices:T}}hasBand(u){const{blockIndex:p}=this.getBlockForBand(u);return p>=0}hasDataForBand(u){const{blockIndex:p}=this.getBlockForBand(u);return p>=0&&!!this._decodedBlocks.get(p.toString())}getBandView(u){const{blockIndex:p,blockBandIndex:y}=this.getBlockForBand(u),T=this._decodedBlocks.get(p.toString());if(!T)throw new uh(`Data for band ${JSON.stringify(u)} of layer "${this.name}" not decoded.`);const b=this.dataIndex[p],M=this.bandShape.reduce((W,R)=>W*R,1),k=y*M,G=T.subarray(k,k+M);return{data:G,bytes:new Uint8Array(G.buffer).subarray(G.byteOffset,G.byteOffset+G.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:b.offset!==0?b.offset:b.deprecated_offset,scale:b.scale!==0?b.scale:b.deprecated_scale}}}tO.setPbf=function(v){eO=v};class dj{constructor(u,p,y){this.tasks=u,this._onCancel=p,this._onComplete=y,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(u,p){this._finalized||(this._onComplete(u,p),this._finalized=!0)}}tO.performDecoding=function(v,u){const p=new Uint8Array(v);return Promise.all(u.tasks.map(y=>{const{layerName:T,firstByte:b,lastByte:M,pixelFormat:k,blockShape:G,blockIndex:W,filters:R,codec:z}=y,j=p.subarray(b,M+1),U=new Uint32Array(G[0]*G[1]*G[2]);let V;if(z!=="gzip_data")throw new uh(`Unhandled codec: ${z}`);return V=function(X,Q){if(!globalThis.DecompressionStream&&Q==="gzip_data")return Promise.resolve(((ie=function(Ce){Ce[0]==31&&Ce[1]==139&&Ce[2]==8||Cd(6,"invalid gzip data");var ke=Ce[3],Fe=10;4&ke&&(Fe+=2+(Ce[10]|Ce[11]<<8));for(var Le=(ke>>3&1)+(ke>>4&1);Le>0;Le-=!Ce[Fe++]);return Fe+(2&ke)}(fe=X))+8>fe.length&&Cd(6,"invalid gzip data"),function(Ce,ke,Fe,Le){var Ke=Ce.length;if(!Ke||ke.f&&!ke.l)return Fe||new Ru(0);var Ve=!Fe,et=Ve||ke.i!=2,ut=ke.i;Ve&&(Fe=new Ru(3*Ke));var dt,ft,_t=function(pv){var E_=Fe.length;if(pv>E_){var kS=new Ru(Math.max(2*E_,pv));kS.set(Fe),Fe=kS}},It=ke.f||0,xt=ke.p||0,Vt=ke.b||0,Kt=ke.l,kt=ke.d,Rn=ke.m,wn=ke.n,pn=8*Ke;do{if(!Kt){It=Md(Ce,xt,1);var rn=Md(Ce,xt+1,3);if(xt+=3,!rn){var rr=Ce[(Mr=4+((xt+7)/8|0))-4]|Ce[Mr-3]<<8,Pn=Mr+rr;if(Pn>Ke){ut&&Cd(0);break}et&&_t(Vt+rr),Fe.set(Ce.subarray(Mr,Pn),Vt),ke.b=Vt+=rr,ke.p=xt=8*Pn,ke.f=It;continue}if(rn==1)Kt=rpe,kt=ipe,Rn=9,wn=5;else if(rn==2){var zn=Md(Ce,xt,31)+257,Sr=Md(Ce,xt+10,15)+4,Nr=zn+Md(Ce,xt+5,31)+1;xt+=14;for(var Lr=new Ru(Nr),Dr=new Ru(19),$r=0;$r<Sr;++$r)Dr[epe[$r]]=Md(Ce,xt+3*$r,7);xt+=3*Sr;var Xr=Jk(Dr),ji=(1<<Xr)-1,Ii=CS(Dr,Xr);for($r=0;$r<Nr;){var Mr,bi=Ii[Md(Ce,xt,ji)];if(xt+=15&bi,(Mr=bi>>4)<16)Lr[$r++]=Mr;else{var Ti=0,ls=0;for(Mr==16?(ls=3+Md(Ce,xt,3),xt+=2,Ti=Lr[$r-1]):Mr==17?(ls=3+Md(Ce,xt,7),xt+=3):Mr==18&&(ls=11+Md(Ce,xt,127),xt+=7);ls--;)Lr[$r++]=Ti}}var Xs=Lr.subarray(0,zn),vo=Lr.subarray(zn);Rn=Jk(Xs),wn=Jk(vo),Kt=CS(Xs,Rn),kt=CS(vo,wn)}else Cd(1);if(xt>pn){ut&&Cd(0);break}}et&&_t(Vt+131072);for(var qs=(1<<Rn)-1,Ns=(1<<wn)-1,fa=xt;;fa=xt){var Mo=(Ti=Kt[Qk(Ce,xt)&qs])>>4;if((xt+=15&Ti)>pn){ut&&Cd(0);break}if(Ti||Cd(2),Mo<256)Fe[Vt++]=Mo;else{if(Mo==256){fa=xt,Kt=null;break}var Va=Mo-254;Mo>264&&(Va=Md(Ce,xt,(1<<(Id=ij[$r=Mo-257]))-1)+lj[$r],xt+=Id);var ns=kt[Qk(Ce,xt)&Ns],_c=ns>>4;if(ns||Cd(3),xt+=15&ns,vo=npe[_c],_c>3){var Id=sj[_c];vo+=Qk(Ce,xt)&(1<<Id)-1,xt+=Id}if(xt>pn){ut&&Cd(0);break}et&&_t(Vt+131072);var hh=Vt+Va;if(Vt<vo){var dh=0-vo,C_=Math.min(vo,hh);for(dh+Vt<0&&Cd(3);Vt<C_;++Vt)Fe[Vt]=(void 0)[dh+Vt]}for(;Vt<hh;++Vt)Fe[Vt]=Fe[Vt-vo]}}ke.l=Kt,ke.p=fa,ke.b=Vt,ke.f=It,Kt&&(It=1,ke.m=Rn,ke.d=kt,ke.n=wn)}while(!It);return Vt!=Fe.length&&Ve?(dt=Fe,((ft=Vt)==null||ft>dt.length)&&(ft=dt.length),new Ru(dt.subarray(0,ft))):Fe.subarray(0,Vt)}(fe.subarray(ie,-8),{i:2},new Ru(((ne=fe)[(ue=ne.length)-4]|ne[ue-3]<<8|ne[ue-2]<<16|ne[ue-1]<<24)>>>0))));var ne,ue,fe,ie;const me=lpe[Q];if(!me)throw new Error(`Unhandled codec: ${Q}`);const ve=new globalThis.DecompressionStream(me);return new Response(new Blob([X]).stream().pipeThrough(ve)).arrayBuffer().then(Ce=>new Uint8Array(Ce))}(j,z).then(X=>(function(Q,ne){Q.readFields(Xfe,ne)}(new eO(X),U),new upe[k](U.buffer))),V.then(X=>{for(let Q=R.length-1;Q>=0;Q--)switch(R[Q]){case"delta_filter":Zfe(X,G);break;case"zigzag_filter":Kfe(X);break;case"bitshuffle_filter":Jfe(X,k);break;default:throw new uh(`Unhandled filter "${R[Q]}"`)}return{layerName:T,blockIndex:W,data:X}}).catch(X=>{throw X})}))},Nn(dj,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var IS={workerUrl:"",workerClass:null,workerParams:void 0};const nO="mapboxgl_preloaded_worker_pool";class PS{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<PS.workerCount;)this.workers.push(IS.workerClass!=null?new IS.workerClass:new self.Worker(IS.workerUrl,IS.workerParams));return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.workers&&this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nO]}numActive(){return Object.keys(this.active).length}}let RS;function LE(){return RS||(RS=new PS),RS}PS.workerCount=2;let LS,rO,Ed,m1,iO,g1=null;function fj(){return Tr()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:rO||it.DRACO_URL}function pj(){if(Tr()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(m1)return m1;const v=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return m1=WebAssembly.validate(v)?it.MESHOPT_SIMD_URL:it.MESHOPT_URL,m1}const DE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},dpe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},DS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function mj(v,u,p){const y=p.json.bufferViews.length,T=p.buffers.length;u.bufferView=y,p.json.bufferViews[y]={buffer:T,byteLength:v.byteLength},p.buffers[T]=v}const sO="KHR_draco_mesh_compression";function fpe(v,u){const p=v.extensions&&v.extensions[sO];if(!p)return;const y=new Ed.Decoder,T=yj(u,p.bufferView),b=new Ed.Mesh;if(!y.DecodeArrayToMesh(T,T.byteLength,b))throw new Error("Failed to decode Draco mesh");const M=u.json.accessors[v.indices],k=DE[M.componentType],G=M.count*k.BYTES_PER_ELEMENT,W=Ed._malloc(G);k===Uint16Array?y.GetTrianglesUInt16Array(b,G,W):y.GetTrianglesUInt32Array(b,G,W),mj(Ed.memory.buffer.slice(W,W+G),M,u),Ed._free(W);for(const R of Object.keys(p.attributes)){const z=y.GetAttributeByUniqueId(b,p.attributes[R]),j=u.json.accessors[v.attributes[R]],U=dpe[j.componentType],V=j.count*DS[j.type]*DE[j.componentType].BYTES_PER_ELEMENT,X=Ed._malloc(V);y.GetAttributeDataArrayForAllPoints(b,z,Ed[U],V,X),mj(Ed.memory.buffer.slice(X,X+V),j,u),Ed._free(X)}y.destroy(),b.destroy(),delete v.extensions[sO]}const BE="EXT_meshopt_compression";function ppe(v,u){if(!v.extensions||!v.extensions[BE])return;const p=v.extensions[BE],y=new Uint8Array(u.buffers[p.buffer],p.byteOffset||0,p.byteLength||0),T=new Uint8Array(p.count*p.byteStride);iO.decodeGltfBuffer(T,p.count,p.byteStride,y,p.mode,p.filter),v.buffer=u.buffers.length,v.byteOffset=0,u.buffers[v.buffer]=T.buffer,delete v.extensions[BE]}const gj=1179937895,vj=new TextDecoder("utf8");function _j(v,u){return new URL(v,u).href}function mpe(v,u,p,y){return fetch(_j(v.uri,y)).then(T=>T.arrayBuffer()).then(T=>{u.buffers[p]=T})}function yj(v,u){const p=v.json.bufferViews[u];return new Uint8Array(v.buffers[p.buffer],p.byteOffset||0,p.byteLength)}function gpe(v,u,p,y){if(v.uri){const T=_j(v.uri,y);return fetch(T).then(b=>b.blob()).then(b=>createImageBitmap(b)).then(b=>{u.images[p]=b})}if(v.bufferView!==void 0){const T=yj(u,v.bufferView),b=new Blob([T],{type:v.mimeType});return createImageBitmap(b).then(M=>{u.images[p]=M})}}function xj(v,u=0,p){const y={json:null,images:[],buffers:[]};if(new Uint32Array(v,u,1)[0]===gj){const R=new Uint32Array(v,u);let z=2;const j=(R[z++]>>2)-3,U=R[z++]>>2;if(z++,y.json=JSON.parse(vj.decode(R.subarray(z,z+U))),z+=U,z<j){const V=R[z++];z++;const X=u+(z<<2);y.buffers[0]=v.slice(X,X+V)}}else y.json=JSON.parse(vj.decode(new Uint8Array(v,u)));const{buffers:T,images:b,meshes:M,extensionsUsed:k,bufferViews:G}=y.json;let W=Promise.resolve();if(T){const R=[];for(let z=0;z<T.length;z++){const j=T[z];j.uri?R.push(mpe(j,y,z,p)):y.buffers[z]||(y.buffers[z]=null)}W=Promise.all(R)}return W.then(()=>{const R=[],z=k&&k.includes(sO),j=k&&k.includes(BE);if(z&&R.push(function(){if(!Ed)return LS??(LS=function(U){let V,X=null;function Q(){V=new Uint8Array(X.buffer)}function ne(){throw new Error("Unexpected Draco error.")}const ue={a:{a:ne,d:function(fe,ie,me){return V.copyWithin(fe,ie,ie+me)},c:function(fe){const ie=V.length,me=Math.max(fe>>>0,Math.ceil(1.2*ie)),ve=Math.ceil((me-ie)/65536);try{return X.grow(ve),Q(),!0}catch{return!1}},b:ne}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(U,ue):U.then(fe=>fe.arrayBuffer()).then(fe=>WebAssembly.instantiate(fe,ue))).then(fe=>{const{Rb:ie,Qb:me,P:ve,T:Ce,X:ke,Ja:Fe,La:Le,Qa:Ke,Va:Ve,Wa:et,eb:ut,jb:dt,f:ft,e:_t,yb:It,zb:xt,Ab:Vt,Bb:Kt,Db:kt,Gb:Rn}=fe.instance.exports;X=_t;const wn=(()=>{let pn=0,rn=0,rr=0,Pn=0;return zn=>{rr&&(ie(Pn),ie(pn),rn+=rr,rr=pn=0),pn||(rn+=128,pn=me(rn));const Sr=zn.length+7&-8;let Nr=pn;Sr>=rn&&(rr=Sr,Nr=Pn=me(Sr));for(let Lr=0;Lr<zn.length;Lr++)V[Nr+Lr]=zn[Lr];return Nr}})();return Q(),ft(),{memory:_t,_free:ie,_malloc:me,Mesh:class{constructor(){this.ptr=ve()}destroy(){Ce(this.ptr)}},Decoder:class{constructor(){this.ptr=Fe()}destroy(){dt(this.ptr)}DecodeArrayToMesh(pn,rn,rr){const Pn=wn(pn),zn=Le(this.ptr,Pn,rn,rr.ptr);return!!ke(zn)}GetAttributeByUniqueId(pn,rn){return{ptr:Ke(this.ptr,pn.ptr,rn)}}GetTrianglesUInt16Array(pn,rn,rr){Ve(this.ptr,pn.ptr,rn,rr)}GetTrianglesUInt32Array(pn,rn,rr){et(this.ptr,pn.ptr,rn,rr)}GetAttributeDataArrayForAllPoints(pn,rn,rr,Pn,zn){ut(this.ptr,pn.ptr,rn.ptr,rr,Pn,zn)}},DT_INT8:It(),DT_UINT8:xt(),DT_INT16:Vt(),DT_UINT16:Kt(),DT_UINT32:kt(),DT_FLOAT32:Rn()}})}(fetch(fj())),LS.then(U=>{Ed=U,LS=void 0}))}()),j&&R.push(function(){if(iO)return;const U=function(V){let X;const Q=WebAssembly.instantiateStreaming(V,{}).then(fe=>{X=fe.instance,X.exports.__wasm_call_ctors()}),ne={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ue={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Q,supported:!0,decodeGltfBuffer(fe,ie,me,ve,Ce,ke){(function(Fe,Le,Ke,Ve,et,ut,dt){const ft=Fe.exports.sbrk,_t=Ve+3&-4,It=ft(_t*et),xt=ft(ut.length),Vt=new Uint8Array(Fe.exports.memory.buffer);Vt.set(ut,xt);const Kt=Le(It,Ve,et,xt,ut.length);if(Kt===0&&dt&&dt(It,_t,et),Ke.set(Vt.subarray(It,It+Ve*et)),ft(It-ft(0)),Kt!==0)throw new Error(`Malformed buffer data: ${Kt}`)})(X,X.exports[ue[Ce]],fe,ie,me,ve,X.exports[ne[ke]])}}}(fetch(pj()));return U.ready.then(()=>{iO=U})}()),b)for(let U=0;U<b.length;U++)R.push(gpe(b[U],y,U,p));return(R.length?Promise.all(R):Promise.resolve()).then(()=>{if(z&&M)for(const{primitives:U}of M)for(const V of U)fpe(V,y);if(j&&M&&G)for(const U of G)ppe(U,y);return y})})}function M_(v,u){const p=v.json.bufferViews[u.bufferView],y=DE[u.componentType];return new y(v.buffers[p.buffer],(u.byteOffset||0)+(p.byteOffset||0),u.count*(p.byteStride&&p.byteStride!==DS[u.type]*y.BYTES_PER_ELEMENT?p.byteStride/y.BYTES_PER_ELEMENT:DS[u.type]))}function oO(v,u,p,y){const T=DE[u.componentType],b=function(R){switch(R){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(T),M=v.json.bufferViews[u.bufferView],k=M.byteStride?M.byteStride/T.BYTES_PER_ELEMENT:DS[u.type],G=p.float32,W=G.length/p.capacity;for(let R=0,z=0;R<u.count*k;R+=k,z+=W)for(let j=0;j<W;j++)G[z+j]=y[R+j]*b;p._trim()}function vpe(v,u,p){const y=v.indices,T=v.attributes,b={};b.indexArray=new To;const M=u.json.accessors[y],k=M.count/3;b.indexArray.reserve(k);const G=M_(u,M);for(let j=0;j<k;j++)b.indexArray.emplaceBack(G[3*j],G[3*j+1],G[3*j+2]);b.indexArray._trim(),b.vertexArray=new fo;const W=u.json.accessors[T.POSITION];b.vertexArray.reserve(W.count);const R=M_(u,W);for(let j=0;j<W.count;j++)b.vertexArray.emplaceBack(R[3*j],R[3*j+1],R[3*j+2]);if(b.vertexArray._trim(),b.aabb=new ts(W.min,W.max),b.centroid=function(j,U){const V=[0,0,0],X=j.length;if(X>0){for(let Q=0;Q<X;Q++){const ne=3*j[Q];V[0]+=U[ne],V[1]+=U[ne+1],V[2]+=U[ne+2]}V[0]/=X,V[1]/=X,V[2]/=X}return V}(G,R),T.COLOR_0!==void 0){const j=u.json.accessors[T.COLOR_0],U=DS[j.type],V=M_(u,j);b.colorArray=U===3?new fo:new kl,b.colorArray.resize(j.count),oO(u,j,b.colorArray,V)}if(T.NORMAL!==void 0){b.normalArray=new fo;const j=u.json.accessors[T.NORMAL];b.normalArray.resize(j.count);const U=M_(u,j);oO(u,j,b.normalArray,U)}if(T.TEXCOORD_0!==void 0&&p.length>0){b.texcoordArray=new gc;const j=u.json.accessors[T.TEXCOORD_0];b.texcoordArray.resize(j.count);const U=M_(u,j);oO(u,j,b.texcoordArray,U)}if(T._FEATURE_ID_RGBA4444!==void 0){const j=u.json.accessors[T._FEATURE_ID_RGBA4444];u.json.extensionsUsed&&u.json.extensionsUsed.includes("EXT_meshopt_compression")&&(b.featureData=M_(u,j))}T._FEATURE_RGBA4444!==void 0&&(b.featureData=new Uint32Array(M_(u,u.json.accessors[T._FEATURE_RGBA4444]).buffer));const z=v.material;return b.material=function(j,U){const{emissiveFactor:V=[0,0,0],alphaMode:X="OPAQUE",alphaCutoff:Q=.5,normalTexture:ne,occlusionTexture:ue,emissiveTexture:fe,doubleSided:ie}=j,{baseColorFactor:me=[1,1,1,1],metallicFactor:ve=1,roughnessFactor:Ce=1,baseColorTexture:ke,metallicRoughnessTexture:Fe}=j.pbrMetallicRoughness||{},Le=ue?U[ue.index]:void 0;if(ue&&ue.extensions&&ue.extensions.KHR_texture_transform&&Le){const Ke=ue.extensions.KHR_texture_transform;Le.offsetScale=[Ke.offset[0],Ke.offset[1],Ke.scale[0],Ke.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new _r(...me),metallicFactor:ve,roughnessFactor:Ce,baseColorTexture:ke?U[ke.index]:void 0,metallicRoughnessTexture:Fe?U[Fe.index]:void 0},doubleSided:ie,emissiveFactor:V,alphaMode:X,alphaCutoff:Q,normalTexture:ne?U[ne.index]:void 0,occlusionTexture:Le,emissionTexture:fe?U[fe.index]:void 0,defined:j.defined===void 0}}(z!==void 0?u.json.materials[z]:{defined:!1},p),b}function bj(v,u,p){const{matrix:y,rotation:T,translation:b,scale:M,mesh:k,extras:G,children:W}=v,R={};if(R.matrix=y||De.mat4.fromRotationTranslationScale([],T||[0,0,0,1],b||[0,0,0],M||[1,1,1]),k!==void 0){R.meshes=p[k];const z=R.anchor=[0,0];for(const j of R.meshes){const{min:U,max:V}=j.aabb;z[0]+=U[0]+V[0],z[1]+=U[1]+V[1]}z[0]=Math.floor(z[0]/R.meshes.length/2),z[1]=Math.floor(z[1]/R.meshes.length/2)}if(G&&(G.id&&(R.id=G.id),G.lights&&(R.lights=function(z){if(!z.length)return[];const j=function(ne){const ue=atob(ne),fe=new Uint8Array(ue.length);for(let ie=0;ie<ue.length;ie++)fe[ie]=ue.codePointAt(ie);return fe}(z),U=[],V=j.length/24,X=new Uint16Array(j.buffer),Q=new Float32Array(j.buffer);for(let ne=0;ne<V;ne++){const ue=X[2*ne*6]/30,fe=X[2*ne*6+1]/30,ie=X[2*ne*6+10]/100,me=Q[6*ne+1],ve=Q[6*ne+2],Ce=Q[6*ne+3],ke=Q[6*ne+4],Fe=Ce-me,Le=ke-ve,Ke=Math.hypot(Fe,Le);U.push({pos:[me+.5*Fe,ve+.5*Le,fe],normal:[Le/Ke,-Fe/Ke,0],width:Ke,height:ue,depth:ie,points:[me,ve,Ce,ke]})}return U}(G.lights))),W){const z=[];for(const j of W)z.push(bj(u.json.nodes[j],u,p));R.children=z}return R}function _pe(v){if(v.vertices.length===0||v.indices.length===0)return null;const u=new mk(v.vertices,v.indices,8,256),[p,y]=[u.min.clone(),u.max.clone()];return{vertices:v.vertices,indices:v.indices,grid:u,min:p,max:y}}function ype(v){if(!v.extras||!v.extras.ground)return null;const u=v.extras.ground;if(!u||!Array.isArray(u)||u.length===0)return null;const p=u[0];if(!p||!Array.isArray(p)||p.length===0)return null;const y=[];for(const M of p){if(!Array.isArray(M)||M.length!==2)continue;const k=M[0],G=M[1];typeof k=="number"&&typeof G=="number"&&y.push(new At(k,G))}if(y.length<3)return null;y.length>1&&y[y.length-1].equals(y[0])&&y.pop();let T=0;for(let M=0;M<y.length;M++){const k=y[M],G=y[(M+1)%y.length],W=y[(M+2)%y.length];T+=(k.x-G.x)*(W.y-G.y)-(W.x-G.x)*(k.y-G.y)}T>0&&y.reverse();const b=sS(y.flatMap(M=>[M.x,M.y]),[]);return b.length===0?null:{vertices:y,indices:b}}function xpe(v,u){const p=[],y=[];let T=0;const b=[];for(const M of v){T=p.length;const k=M.vertexArray.float32,G=M.indexArray.uint16;for(let W=0;W<M.vertexArray.length;W++)b[0]=k[3*W+0],b[1]=k[3*W+1],b[2]=k[3*W+2],De.vec3.transformMat4(b,b,u),p.push(new At(b[0],b[1]));for(let W=0;W<3*M.indexArray.length;W++)y.push(G[W]+T)}if(y.length%3!=0)return null;for(let M=0;M<y.length;M+=3){const k=p[y[M+0]],G=p[y[M+1]],W=p[y[M+2]];(k.x-G.x)*(W.y-G.y)-(W.x-G.x)*(k.y-G.y)>0&&([y[M+1],y[M+2]]=[y[M+2],y[M+1]])}return{vertices:p,indices:y}}function wj(v){const u=function(G,W){const R=[],z=WebGL2RenderingContext;if(G.json.textures)for(const j of G.json.textures){const U={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};j.sampler!==void 0&&Object.assign(U,G.json.samplers[j.sampler]),R.push({image:W[j.source],sampler:U,uploaded:!1})}return R}(v,v.images),p=function(G,W){const R=[];for(const z of G.json.meshes){const j=[];for(const U of z.primitives)j.push(vpe(U,G,W));R.push(j)}return R}(v,u),{scenes:y,scene:T,nodes:b}=v.json,M=y?y[T||0].nodes:b,k=[];for(const G of M)k.push(bj(b[G],v,p));return function(G,W,R){const z={},j=new Set;for(let U=0;U<G.length;U++){const V=R[W[U]];if(!V.extras)continue;const X=V.extras["mapbox:footprint:version"],Q=V.extras["mapbox:footprint:id"];(X||Q)&&j.add(U),X==="1.0.0"&&Q&&(z[Q]=U)}for(let U=0;U<G.length;U++){if(j.has(U))continue;const V=G[U],X=R[W[U]];if(!X.extras)continue;let Q=null;V.id in z&&(Q=xpe(G[z[V.id]].meshes,V.matrix)),Q||(Q=ype(X)),Q&&(V.footprint=_pe(Q))}if(j.size>0){const U=Array.from(j.values()).sort((V,X)=>V-X);for(let V=U.length-1;V>=0;V--)G.splice(U[V],1)}}(k,M,v.json.nodes),k}function bpe(v){v.heightmap=new Float32Array(4096),v.heightmap.fill(-1);const u=v.vertexArray.float32,p=v.aabb.min[0]-1,y=v.aabb.min[1]-1,T=A_/(v.aabb.max[0]-p+2),b=A_/(v.aabb.max[1]-y+2);for(let M=0;M<u.length;M+=3){const k=u[M+2],G=(u[M+0]-p)*T|0,W=(u[M+1]-y)*b|0;k>v.heightmap[W*A_+G]&&(v.heightmap[W*A_+G]=k)}}function wpe(v,u){const p={};p.indexArray=new To,p.indexArray.reserve(4*v.length),p.vertexArray=new fo,p.vertexArray.reserve(10*v.length),p.colorArray=new kl,p.vertexArray.reserve(10*v.length);let y=0;for(const M of v){const k=Math.min(10,Math.max(4,1.3*M.height))*u,G=[-M.normal[1],M.normal[0],0],W=Math.min(.29,.1*M.width/M.depth),R=M.width-2*M.depth*u*(W+.01),z=De.vec3.scaleAndAdd([],M.pos,G,R/2),j=De.vec3.scaleAndAdd([],M.pos,G,-R/2),U=[z[0],z[1],z[2]+M.height],V=[j[0],j[1],j[2]+M.height],X=De.vec3.scaleAndAdd([],M.normal,G,W);De.vec3.scale(X,X,k);const Q=De.vec3.scaleAndAdd([],M.normal,G,-W);De.vec3.scale(Q,Q,k),De.vec3.add(X,z,X),De.vec3.add(Q,j,Q),z[2]+=.1,j[2]+=.1,p.vertexArray.emplaceBack(X[0],X[1],X[2]),p.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),p.vertexArray.emplaceBack(z[0],z[1],z[2]),p.vertexArray.emplaceBack(j[0],j[1],j[2]),p.vertexArray.emplaceBack(U[0],U[1],U[2]),p.vertexArray.emplaceBack(V[0],V[1],V[2]),p.vertexArray.emplaceBack(z[0],z[1],z[2]),p.vertexArray.emplaceBack(j[0],j[1],j[2]),p.vertexArray.emplaceBack(X[0],X[1],X[2]),p.vertexArray.emplaceBack(Q[0],Q[1],Q[2]);const ne=R/k/2;p.colorArray.emplaceBack(-ne-W,-1,ne,.8),p.colorArray.emplaceBack(ne+W,-1,ne,.8),p.colorArray.emplaceBack(-ne,0,ne,1.3),p.colorArray.emplaceBack(ne,0,ne,1.3),p.colorArray.emplaceBack(ne+W,-.8,ne,.7),p.colorArray.emplaceBack(ne+W,-.8,ne,.7),p.colorArray.emplaceBack(0,0,ne,1.3),p.colorArray.emplaceBack(0,0,ne,1.3),p.colorArray.emplaceBack(ne+W,-1.2,ne,.8),p.colorArray.emplaceBack(ne+W,-1.2,ne,.8),p.indexArray.emplaceBack(6+y,4+y,8+y),p.indexArray.emplaceBack(7+y,9+y,5+y),p.indexArray.emplaceBack(0+y,1+y,2+y),p.indexArray.emplaceBack(1+y,3+y,2+y),y+=10}const T={defined:!0,emissiveFactor:[0,0,0]},b={};return b.baseColorFactor=_r.white,T.pbrMetallicRoughness=b,p.material=T,p.aabb=new ts([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),p}class Sj{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const y=u[p];this._stringToNumber[y]=p,this._numberToString[p]=y}}encode(u){return this._stringToNumber[u]}decode(u){return this._numberToString[u]}}const Spe=["id","tile","layer","source","sourceLayer","state"];class Aj{constructor(u,p,y,T,b){this.type="Feature",this._vectorTileFeature=u,this._z=p,this._x=y,this._y=T,this.properties=u.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const p of Spe)this[p]!==void 0&&(u[p]=this[p]);return u}}class Tj{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new jc(xn,16,0),this.featureIndexArray=new hm,this.promoteId=p,this.is3DTile=!1}insert(u,p,y,T,b,M=0,k=0){const G=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,T,b,M);const W=this.grid;for(let R=0;R<p.length;R++){const z=p[R],j=[1/0,1/0,-1/0,-1/0];for(let U=0;U<z.length;U++){const V=z[U];j[0]=Math.min(j[0],V.x),j[1]=Math.min(j[1],V.y),j[2]=Math.max(j[2],V.x),j[3]=Math.max(j[3],V.y)}k!==0&&(j[0]-=k,j[1]-=k,j[2]+=k,j[3]+=k),j[0]<xn&&j[1]<xn&&j[2]>=0&&j[3]>=0&&W.insert(G,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new s1.VectorTile(new cE(this.rawTileData)).layers,this.sourceLayerCoder=new Sj(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const u in this.vtLayers)this.vtFeatures[u]=[]}return this.vtLayers}query(u,p,y,T){this.loadVTLayers();const b=u.params||{},M=os(b.filter),k=u.tileResult,G=u.transform,W=k.bufferedTilespaceBounds,R=this.grid.query(W.min.x,W.min.y,W.max.x,W.max.y,(V,X,Q,ne)=>Yc(k.bufferedTilespaceGeometry,V,X,Q,ne));R.sort(Ape);let z=null;G.elevation&&R.length>0&&(z=d1.create(G.elevation,this.tileID));const j={};let U;for(let V=0;V<R.length;V++){const X=R[V];if(X===U)continue;U=X;const Q=this.featureIndexArray.get(X);let ne=null;if(this.is3DTile){const ue=this.bucketLayerIDs[0][0],fe=p[ue];if(fe.type!=="model")continue;const{queryFeature:ie,intersectionZ:me}=fe.queryIntersectsMatchingFeature(k,Q.featureIndex,M,G);ie&&this.appendToResult(j,ue,Q.featureIndex,ie,me)}else this.loadMatchingFeature(j,Q,M,b.layers,b.availableImages,p,y,T,(ue,fe,ie,me=0)=>(ne||(ne=fn(ue,this.tileID.canonical,u.tileTransform)),fe.queryIntersectsFeature(k,ue,ie,ne,this.z,u.transform,u.pixelPosMatrix,z,me)))}return j}loadMatchingFeature(u,p,y,T,b,M,k,G,W){const{featureIndex:R,bucketIndex:z,sourceLayerIndex:j,layoutVertexArrayOffset:U}=p,V=this.bucketLayerIDs[z];if(T&&!function(ue,fe){for(let ie=0;ie<ue.length;ie++)if(fe.indexOf(ue[ie])>=0)return!0;return!1}(T,V))return;const X=this.sourceLayerCoder.decode(j),Q=this.vtLayers[X].feature(R);if(y.needGeometry){const ue=mn(Q,!0);if(!y.filter(new gs(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!y.filter(new gs(this.tileID.overscaledZ),Q))return;const ne=this.getId(Q,X);for(let ue=0;ue<V.length;ue++){const fe=V[ue];if(T&&T.indexOf(fe)<0)continue;const ie=M[fe];if(!ie)continue;let me={};ne!==void 0&&G&&(me=G.getState(ie.sourceLayer||"_geojsonTileLayer",ne));const ve=!W||W(Q,ie,me,U);if(!ve)continue;const Ce=new Aj(Q,this.z,this.x,this.y,ne),ke=Ar({},k[fe]);ke.paint=Mj(ke.paint,ie.paint,Q,me,b),ke.layout=Mj(ke.layout,ie.layout,Q,me,b),Ce.layer=ke,this.appendToResult(u,fe,R,Ce,ve)}}appendToResult(u,p,y,T,b){let M=u[p];M===void 0&&(M=u[p]=[]),M.push({featureIndex:y,feature:T,intersectionZ:b})}lookupSymbolFeatures(u,p,y,T,b,M,k,G){const W={};this.loadVTLayers();const R=os(b);for(const z of u)this.loadMatchingFeature(W,{bucketIndex:y,sourceLayerIndex:T,featureIndex:z,layoutVertexArrayOffset:0},R,M,k,G,p);return W}loadFeature(u){const{featureIndex:p,sourceLayerIndex:y}=u;this.loadVTLayers();const T=this.sourceLayerCoder.decode(y),b=this.vtFeatures[T];if(b[p])return b[p];const M=this.vtLayers[T].feature(p);return b[p]=M,M}hasLayer(u){for(const p of this.bucketLayerIDs)for(const y of p)if(u===y)return!0;return!1}getId(u,p){let y=u.id;if(this.promoteId){const T=typeof this.promoteId=="string"?this.promoteId:this.promoteId[p];T!=null&&(y=u.properties[T]),typeof y=="boolean"&&(y=Number(y))}return y}}function Mj(v,u,p,y,T){return Ur(v,(b,M)=>{const k=u instanceof ih?u.get(M):null;return k&&k.evaluate?k.evaluate(p,y,T):k})}function Ape(v,u){return u-v}Nn(Tj,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Cj=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class aO{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,y]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const T=y>>4;if(T!==1)throw new Error(`Got v${T} data when expected v1.`);const b=Cj[15&y];if(!b)throw new Error("Unrecognized array type.");const[M]=new Uint16Array(u,2,1),[k]=new Uint32Array(u,4,1);return new aO(k,M,b,u)}constructor(u,p=64,y=Float64Array,T){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=y,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const b=Cj.indexOf(this.ArrayType),M=2*u*this.ArrayType.BYTES_PER_ELEMENT,k=u*this.IndexArrayType.BYTES_PER_ELEMENT,G=(8-k%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${y}.`);T&&T instanceof ArrayBuffer?(this.data=T,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+k+G,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+M+k+G),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+k+G,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const y=this._pos>>1;return this.ids[y]=y,this.coords[this._pos++]=u,this.coords[this._pos++]=p,y}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return lO(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,y,T){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:M,nodeSize:k}=this,G=[0,b.length-1,0],W=[];for(;G.length;){const R=G.pop()||0,z=G.pop()||0,j=G.pop()||0;if(z-j<=k){for(let Q=j;Q<=z;Q++){const ne=M[2*Q],ue=M[2*Q+1];ne>=u&&ne<=y&&ue>=p&&ue<=T&&W.push(b[Q])}continue}const U=j+z>>1,V=M[2*U],X=M[2*U+1];V>=u&&V<=y&&X>=p&&X<=T&&W.push(b[U]),(R===0?u<=V:p<=X)&&(G.push(j),G.push(U-1),G.push(1-R)),(R===0?y>=V:T>=X)&&(G.push(U+1),G.push(z),G.push(1-R))}return W}within(u,p,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:b,nodeSize:M}=this,k=[0,T.length-1,0],G=[],W=y*y;for(;k.length;){const R=k.pop()||0,z=k.pop()||0,j=k.pop()||0;if(z-j<=M){for(let Q=j;Q<=z;Q++)Ij(b[2*Q],b[2*Q+1],u,p)<=W&&G.push(T[Q]);continue}const U=j+z>>1,V=b[2*U],X=b[2*U+1];Ij(V,X,u,p)<=W&&G.push(T[U]),(R===0?u-y<=V:p-y<=X)&&(k.push(j),k.push(U-1),k.push(1-R)),(R===0?u+y>=V:p+y>=X)&&(k.push(U+1),k.push(z),k.push(1-R))}return G}}function lO(v,u,p,y,T,b){if(T-y<=p)return;const M=y+T>>1;Ej(v,u,M,y,T,b),lO(v,u,p,y,M-1,1-b),lO(v,u,p,M+1,T,1-b)}function Ej(v,u,p,y,T,b){for(;T>y;){if(T-y>600){const W=T-y+1,R=p-y+1,z=Math.log(W),j=.5*Math.exp(2*z/3),U=.5*Math.sqrt(z*j*(W-j)/W)*(R-W/2<0?-1:1);Ej(v,u,p,Math.max(y,Math.floor(p-R*j/W+U)),Math.min(T,Math.floor(p+(W-R)*j/W+U)),b)}const M=u[2*p+b];let k=y,G=T;for(BS(v,u,y,p),u[2*T+b]>M&&BS(v,u,y,T);k<G;){for(BS(v,u,k,G),k++,G--;u[2*k+b]<M;)k++;for(;u[2*G+b]>M;)G--}u[2*y+b]===M?BS(v,u,y,G):(G++,BS(v,u,G,T)),G<=p&&(y=G+1),p<=G&&(T=G-1)}}function BS(v,u,p,y){cO(v,p,y),cO(u,2*p,2*y),cO(u,2*p+1,2*y+1)}function cO(v,u,p){const y=v[u];v[u]=v[p],v[p]=y}function Ij(v,u,p,y){const T=v-p,b=u-y;return T*T+b*b}a.$=am,a.A=class extends EE{},a.B=xu,a.C=yf,a.D=Fs,a.E=Xu,a.F=Ug,a.G=Qp,a.H=c_,a.I=Lk,a.J=If,a.K=mi,a.L=d_,a.M=Pf,a.N=Rl,a.O=lc,a.P=At,a.Q=od,a.R=Qi,a.S=Oa,a.T=jk,a.U=Op,a.V=EE,a.W=eo,a.X=em,a.Y=zg,a.Z=function(v){const u=v.value;let p=[];if(!u)return p;const y=xu(u);return y!=="string"?(p=p.concat([new EE(v.key,u,`string expected, "${y}" found`)]),p):(z9(u,!0)||(p=p.concat([new EE(v.key,u,`invalid url "${u}"`)])),p)},a._=Tt,a.a=function(v){return it.API_CDN_URL_REGEX.test(v)},a.a$=y_,a.a0=qi,a.a1=vn,a.a2=class{constructor(v){this.specification=v}possiblyEvaluate(v,u){return In(v.expression.evaluate(u))}interpolate(v,u,p){return{x:ur(v.x,u.x,p),y:ur(v.y,u.y,p),z:ur(v.z,u.z,p),azimuthal:ur(v.azimuthal,u.azimuthal,p),polar:ur(v.polar,u.polar,p)}}},a.a3=gs,a.a4=ml,a.a5=wt,a.a6=De,a.a7=gr,a.a8=ih,a.a9=ov,a.aA=es,a.aB=M9,a.aC=L9,a.aD=T9,a.aE=function(v,u){const p=document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let y=0;y<v.length;y++){const T=document.createElement("source");ms(v[y])||(p.crossOrigin="Anonymous"),T.src=v[y],p.appendChild(T)}return{cancel:()=>{}}},a.aF=SE,a.aG=function(v){return fetch(v).then(u=>u.arrayBuffer()).then(u=>xj(u,0,v))},a.aH=wj,a.aI=class{constructor(v,u,p,y){this.id=v,this.position=u!=null?new de(u[0],u[1]):new de(0,0),this.orientation=p??[0,0,0],this.nodes=y,this.uploaded=!1,this.aabb=new ts([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(v,u){if(De.mat4.multiply(v.matrix,u,v.matrix),v.meshes)for(const p of v.meshes){const y=ts.applyTransformFast(p.aabb,v.matrix);this.aabb.encapsulate(y)}if(v.children)for(const p of v.children)this._applyTransformations(p,v.matrix)}computeBoundsAndApplyParent(){const v=De.mat4.identity([]);for(const u of this.nodes)this._applyTransformations(u,v)}computeModelMatrix(v,u,p,y,T,b,M=!1){j9(this.matrix,this,v.transform,this.position,u,p,y,T,b,M)}upload(v){if(!this.uploaded){for(const u of this.nodes)Yk(u,v);for(const u of this.nodes)IE(u);this.uploaded=!0}}destroy(){for(const v of this.nodes)Zk(v)}},a.aJ=zr,a.aK=yS,a.aL=Xe,a.aM=$e,a.aN=to,a.aO=To,a.aP=sr,a.aQ=Qg,a.aR=bE,a.aS=function(){Ua.isLoading()||Ua.isLoaded()||$g()!=="deferred"||Xg()},a.aT=os,a.aU=mn,a.aV=Aj,a.aW=jr,a.aX=Ak,a.aY=pk,a.aZ=fn,a.a_=fc,a.aa=ur,a.ab=xn,a.ac=_f,a.ad=class{constructor(v){this.specification=v}possiblyEvaluate(v,u){return function([p,y]){const T=In([1,p,y]);return{x:T.x,y:T.y,z:T.z}}(v.expression.evaluate(u))}interpolate(v,u,p){return{x:ur(v.x,u.x,p),y:ur(v.y,u.y,p),z:ur(v.z,u.z,p)}}},a.ae=function(v,u,p=0,y=!0){const T=new At(p,p),b=v.sub(T),M=u.add(T),k=[b,new At(M.x,b.y),M,new At(b.x,M.y)];return y&&k.push(b.clone()),k},a.af=function(v,u){const p=[];for(let y=0;y<v.length;y++){const T=Gn(y-1,-1,v.length-1),b=Gn(y+1,-1,v.length-1),M=v[y],k=v[b],G=v[T].sub(M).unit(),W=k.sub(M).unit(),R=W.angleWithSep(G.x,G.y),z=G.add(W).unit().mult(-1*u/Math.sin(R/2));p.push(M.add(z))}return p},a.ag=h9,a.ah=Yc,a.ai=function(v,u,p=0){return De.vec3.fromValues(((u.x-p)*v.scale-v.x)*xn,(u.y*v.scale-v.y)*xn,tt(u.z,u.y))},a.aj=Sd,a.ak=RH,a.al=function(v){let u=1/0,p=1/0,y=-1/0,T=-1/0;for(const b of v)u=Math.min(u,b.x),p=Math.min(p,b.y),y=Math.max(y,b.x),T=Math.max(T,b.y);return{min:new At(u,p),max:new At(y,T)}},a.am=Oe,a.an=as,a.ao=Zt,a.ap=Wt,a.aq=h,a.ar=function(v,u){const p={};for(let y=0;y<u.length;y++){const T=u[y];T in v&&(p[T]=v[T])}return p},a.as=xe,a.at=Ge,a.au=class{constructor(v){this.entries={},this.scheduler=v}request(v,u,p,y){const T=this.entries[v]=this.entries[v]||{callbacks:[]};if(T.result){const[b,M]=T.result;return this.scheduler?this.scheduler.add(()=>{y(b,M)},u):y(b,M),()=>{}}return T.callbacks.push(y),T.cancel||(T.cancel=p((b,M)=>{T.result=[b,M];for(const k of T.callbacks)this.scheduler?this.scheduler.add(()=>{k(b,M)},u):k(b,M);setTimeout(()=>delete this.entries[v],3e3)})),()=>{T.result||(T.callbacks=T.callbacks.filter(b=>b!==y),T.callbacks.length||(T.cancel(),delete this.entries[v]))}}},a.av=yd,a.aw=function(v,u,p){const y=JSON.stringify(v.request);return v.data&&(this.deduped.entries[y]={result:[null,v.data]}),this.deduped.request(y,{type:"parseTile",isSymbolTile:v.isSymbolTile,zoom:v.tileZoom},T=>{const b=ks(v.request,(M,k,G,W)=>{M?T(M):k&&T(null,{vectorTile:p?void 0:new s1.VectorTile(new cE(k)),rawData:k,cacheControl:G,expires:W})});return()=>{b.cancel(),T()}},u)},a.ax=function(v){vr++,vr>Pt&&(v.getActor().send("enforceCacheSizeLimit",Et),vr=0)},a.ay=Cn,a.az=function(v){return v<=1?1:Math.pow(2,Math.floor(Math.log(v)/Math.LN2))},a.b=function(v){return it.API_FONTS_REGEX.test(v)},a.b$=function(v){const{x:u,y:p}=v.point,{lng:y,lat:T}=v._center;return SV(u,p,v.worldSize,y,T)},a.b0=Kc,a.b1=As,a.b2=sS,a.b3=Gk,a.b4=function(v,u){const p=ov(u.zoom);if(p===0)return $f(v);const y=YC(v),T=sk(y),b=Oe(y.getWest())*u.worldSize,M=Oe(y.getEast())*u.worldSize,k=Ge(y.getNorth())*u.worldSize,G=Ge(y.getSouth())*u.worldSize,W=[b,k,0],R=[M,k,0],z=[b,G,0],j=[M,G,0],U=De.mat4.invert([],u.globeMatrix);return De.vec3.transformMat4(W,W,U),De.vec3.transformMat4(R,R,U),De.vec3.transformMat4(z,z,U),De.vec3.transformMat4(j,j,U),T[0]=mm(T[0],z,p),T[1]=mm(T[1],j,p),T[2]=mm(T[2],R,p),T[3]=mm(T[3],W,p),ts.fromPoints(T)},a.b5=KC,a.b6=rS,a.b7=mm,a.b8=xd,a.b9=Ol,a.bA=Gn,a.bB=on,a.bC=fi,a.bD=Be,a.bE=function(v,u,p){v[4*u+0]=p[0],v[4*u+1]=p[1],v[4*u+2]=p[2],v[4*u+3]=p[3]},a.bF=$n,a.bG=ge,a.bH=Me,a.bI=oe,a.bJ=K,a.bK=de,a.bL=g9,a.bM=Go,a.bN=sv,a.bO=B9,a.bP=ea,a.bQ=xV,a.bR=function(v,u,p,y,T,b,M,k,G){if(G.name==="globe")return xV(v,u,new ea(p,y,T),!1);const W=yS({z:p,x:y,y:T},G);return new ts([(b+W.x/W.scale)*u,u*(W.y/W.scale),M],[(b+W.x2/W.scale)*u,u*(W.y2/W.scale),k])},a.bS=function(v,u,p){let y=0;for(let T=0;T<2;++T)v[T]>0&&(y+=(v[T]-0)*(v[T]-0)),u[T]<0&&(y+=(0-u[T])*(0-u[T]));return y},a.bT=Je,a.bU=S,a.bV=function(v){const u=De.mat4.identity(new Float64Array(16));De.mat4.multiply(u,v.pixelMatrix,v.globeMatrix);const p=[0,$,0],y=[0,Y,0];return De.vec3.transformMat4(p,p,u),De.vec3.transformMat4(y,y,u),[p[0]>0&&p[0]<=v.width&&p[1]>0&&p[1]<=v.height&&!lk(v,new de(v.center.lat,90)),y[0]>0&&y[0]<=v.width&&y[1]>0&&y[1]<=v.height&&!lk(v,new de(v.center.lat,-90))]},a.bW=function(v,u){const{scale:p}=v.tileTransform,y=p*xn/(v.tileSize*Math.pow(2,u.zoom-v.tileID.overscaledZ+v.tileID.canonical.z));return De.mat2.scale(new Float32Array(4),u.inverseAdjustmentMatrix,[y,y])},a.bX=ME,a.bY=D9,a.bZ=function(v){const u=D9(v,!0);return De.mat2.invert([],[u[0],u[1],u[4],u[5]])},a.b_=Wf,a.ba=tO,a.bb=cE,a.bc=ks,a.bd=function(v){const u=[];for(const p in v)u.push(v[p]);return u},a.be=function(v,u){const p=[];for(const y in v)y in u||p.push(y);return p},a.bf=nr,a.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bh=en,a.bi=function(v,u){const{x:p,y}=v.point,T=SV(p,y,v.worldSize/v._pixelsPerMercatorPixel,0,0);return De.mat4.multiply(T,T,ok($f(u)))},a.bj=o1,a.bk=Pu,a.bl=lE,a.bm=function(v,u,p,y,T){const b=5*u+2;v.float32[b+0]=p,v.float32[b+1]=y,v.float32[b+2]=T},a.bn=xE,a.bo=e9,a.bp=bn,a.bq=Ga,a.br=nH,a.bs=N9,a.bt=aH,a.bu=lH,a.bv=kk,a.bw=a9,a.bx=Rk,a.by=aO,a.bz=_r,a.c=mt,a.c$=_l,a.c0=ct,a.c1=vl,a.c2=g,a.c3=function(v){const u=Math.round((v+45+360)%360/90)%4;return He[u]},a.c4=45,a.c5=Te,a.c6=pt,a.c7=function(v,u,p){const y=Math.sqrt(v*v+u*u+p*p),T=y>0?Math.acos(p/y)*Vn:0;let b=v!==0||u!==0?Math.atan2(-u,-v)*Vn+90:0;return b<0&&(b+=360),[y,b,T]},a.c8=st,a.c9=ts,a.cA=function(v){const u=Je-5;v=Wt(v,-u,u)/u*90;const p=Math.pow(Math.abs(Math.sin(on(v))),3);return Math.round(p*(N.length-1))},a.cB=function(v,u,p,y){const T=u.getNorth(),b=u.getSouth(),M=u.getWest(),k=u.getEast(),G=1<<v.z,W=k-M,R=T-b,z=W/D,j=-R/N[p],U=[0,z,0,j,0,0,T,M,0];if(v.z>0){const V=180/y;De.mat3.multiply(U,U,[V/W+1,0,0,0,V/R+1,0,-.5*V/z,.5*V/j,1])}return U[2]=G,U[5]=v.x,U[8]=v.y,U},a.cC=$f,a.cD=function(v,u,p){const y=De.mat4.identity(new Float64Array(16)),T=(u/(1<<v)-.5)*Math.PI*2;return De.mat4.rotateY(y,p.globeMatrix,T),Float32Array.from(y)},a.cE=class{isDataAvailableAtPoint(v){const u=this._source();if(this.isUsingMockSource()||!u||v.y<0||v.y>1)return!1;const p=u.getSource().maxzoom,y=1<<p,T=Math.floor(v.x),b=Math.floor((v.x-T)*y),M=Math.floor(v.y*y),k=this.findDEMTileFor(new es(p,T,p,b,M));return!(!k||!k.dem)}getAtPointOrZero(v,u=0){return this.getAtPoint(v,u)||0}getAtPoint(v,u,p=!0){if(this.isUsingMockSource())return null;u==null&&(u=null);const y=this._source();if(!y||v.y<0||v.y>1)return u;const T=y.getSource().maxzoom,b=1<<T,M=Math.floor(v.x),k=v.x-M,G=new es(T,M,T,Math.floor(k*b),Math.floor(v.y*b)),W=this.findDEMTileFor(G);if(!W||!W.dem)return u;const R=W.dem,z=1<<W.tileID.canonical.z,j=(k*z-W.tileID.canonical.x)*R.dim,U=(v.y*z-W.tileID.canonical.y)*R.dim,V=Math.floor(j),X=Math.floor(U);return(p?this.exaggeration():1)*ur(ur(R.get(V,X),R.get(V,X+1),U-X),ur(R.get(V+1,X),R.get(V+1,X+1),U-X),j-V)}getAtTileOffset(v,u,p){const y=1<<v.canonical.z;return this.getAtPointOrZero(new wt(v.wrap+(v.canonical.x+u/xn)/y,(v.canonical.y+p/xn)/y))}getAtTileOffsetFunc(v,u,p,y){return T=>{const b=this.getAtTileOffset(v,T.x,T.y),M=y.upVector(v.canonical,T.x,T.y),k=y.upVectorScale(v.canonical,u,p).metersToTile;return De.vec3.scale(M,M,b*k),M}}getForTilePoints(v,u,p,y){if(this.isUsingMockSource())return!1;const T=d1.create(this,v,y);return!!T&&(u.forEach(b=>{b[2]=this.exaggeration()*T.getElevationAt(b[0],b[1],p)}),!0)}getMinMaxForTile(v){if(this.isUsingMockSource())return null;const u=this.findDEMTileFor(v);if(!u||!u.dem)return null;const p=u.dem.tree,y=u.tileID,T=1<<v.canonical.z-y.canonical.z;let b=v.canonical.x/T-y.canonical.x,M=v.canonical.y/T-y.canonical.y,k=0;for(let G=0;G<v.canonical.z-y.canonical.z&&!p.leaves[k];G++){b*=2,M*=2;const W=2*Math.floor(M)+Math.floor(b);k=p.childOffsets[k]+W,b%=1,M%=1}return{min:this.exaggeration()*p.minimums[k],max:this.exaggeration()*p.maximums[k]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(v,u,p){throw new Error("Pure virtual method called.")}pointCoordinate(v){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(v){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const v=this.visibleDemTiles;if(v.length===0)return null;let u=!1,p=Number.MAX_VALUE,y=Number.MIN_VALUE;for(const T of v){const b=this.getMinMaxForTile(T.tileID);b&&(p=Math.min(p,b.min),y=Math.max(y,b.max),u=!0)}return u?{min:p,max:y}:null}},a.cF=OV,a.cG=pm,a.cH=function(v,u){return[Math.pow(v[0],2.2)*u,Math.pow(v[1],2.2)*u,Math.pow(v[2],2.2)*u]},a.cI=wV,a.cJ=qe,a.cK=Ie,a.cL=256,a.cM=function(v,u){const p=[0,0,0],y=KC($f(u.canonical));return De.vec3.transformMat4(p,p,y),De.vec3.transformMat4(p,p,v),p},a.cN=v=>({u_camera_to_center_distance:new oe(v),u_extrude_scale:new Gr(v),u_device_pixel_ratio:new oe(v),u_matrix:new $n(v),u_inv_rot_matrix:new $n(v),u_merc_center:new ge(v),u_tile_id:new Me(v),u_zoom_transition:new oe(v),u_up_dir:new Me(v),u_emissive_strength:new oe(v)}),a.cO=v=>({u_matrix:new $n(v),u_pixels_to_tile_units:new Gr(v),u_device_pixel_ratio:new oe(v),u_units_to_pixels:new ge(v),u_dash_image:new K(v),u_gradient_image:new K(v),u_image_height:new oe(v),u_texsize:new ge(v),u_tile_units_to_pixels:new oe(v),u_alpha_discard_threshold:new oe(v),u_trim_offset:new ge(v),u_trim_fade_range:new ge(v),u_trim_color:new pt(v),u_emissive_strength:new oe(v)}),a.cP=v=>({u_matrix:new $n(v),u_texsize:new ge(v),u_pixels_to_tile_units:new Gr(v),u_device_pixel_ratio:new oe(v),u_image:new K(v),u_units_to_pixels:new ge(v),u_tile_units_to_pixels:new oe(v),u_alpha_discard_threshold:new oe(v),u_trim_offset:new ge(v)}),a.cQ=Sa,a.cR=$de,a.cS=Xde,a.cT=MV,a.cU=(v,u,p,y,T,b)=>{const M=v.transform,k=M.projection.name==="globe";let G;if(b.paint.get("circle-pitch-alignment")==="map")if(k){const R=wV(M.zoom,u.canonical)*M._pixelsPerMercatorPixel;G=Float32Array.from([R,0,0,R])}else G=M.calculatePixelsToTileUnitsMatrix(p);else G=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:v.transform.getCameraToCenterDistance(M.projection),u_matrix:v.translatePosMatrix(u.projMatrix,p,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:En.devicePixelRatio,u_extrude_scale:G,u_inv_rot_matrix:Zhe,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:b.paint.get("circle-emissive-strength")};if(k){W.u_inv_rot_matrix=y,W.u_merc_center=T,W.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],W.u_zoom_transition=ov(M.zoom);const R=T[0]*xn,z=T[1]*xn;W.u_up_dir=M.projection.upVector(new ea(0,0,0),R,z)}return W},a.cV=BH,a.cW=(v,u,p,y,T,b)=>{const M=v.transform;return{u_matrix:DH(v,u,p,y),u_texsize:u.imageAtlasTexture?u.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:LH(u,M),u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b}},a.cX=(v,u,p,y,T,b,M)=>{const k=v.transform,G=k.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:DH(v,u,p,y),u_pixels_to_tile_units:G,u_device_pixel_ratio:b,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:kH(p)&&u.lineAtlasTexture?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:LH(u,v.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:p.paint.get("line-trim-fade-range"),u_trim_color:p.paint.get("line-trim-color").toRenderColor(p.lut).toArray01(),u_emissive_strength:p.paint.get("line-emissive-strength")}},a.cY=di,a.cZ=iS,a.c_=bH,a.ca=In,a.cb=function(v){return[Math.pow(v[0],1/2.2),Math.pow(v[1],1/2.2),Math.pow(v[2],1/2.2)]},a.cc=function(v){return v({pluginStatus:ho,pluginURL:uc}),Wg.on("pluginStateChange",v),v},a.cd=f1,a.ce=LE,a.cf=l1,a.cg=Dk,a.ch=bs,a.ci=Kx,a.cj=bt,a.ck=Zo,a.cl=Si,a.cm=function(v){const u=v.indexOf(oh);return u>=0?v.slice(0,u):v},a.cn=function(v){return v.indexOf(oh)>=0},a.co=function(v){const u=v.indexOf(oh);return u>=0?v.slice(u+1):""},a.cp=function(v){const u=[],p=v.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),v.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),v.renderingMode&&v.renderingMode!=="2d"&&v.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.cq=function(v,u,p,y){return v.type==="custom"?new Afe(v,u):new kfe[v.type](v,u,p,y)},a.cr=Wr,a.cs=Wg,a.ct=Yo,a.cu=Nt,a.cv=class extends F{constructor(v){super(v),this.current=wr}set(v,u,p){if(this.fetchUniformLocation(v,u)){for(let y=0;y<9;y++)if(p[y]!==this.current[y]){this.current=p,this.gl.uniformMatrix3fv(this.location,!1,p);break}}}},a.cw=qt,a.cx=function(v,u,p){const y=ov(p.zoom),T=v.style.map._antialias,b=u.options.extStandardDerivativesForceOff||v.terrain&&v.terrain.exaggeration()>0;return y===0&&!T&&!b},a.cy=function(v){const u=v.pixelsPerMeter,p=u/Be(1,v.center.lat),y=De.mat4.identity(new Float64Array(16));return De.mat4.translate(y,y,[v.point.x,v.point.y,0]),De.mat4.scale(y,y,[p,p,u]),Float32Array.from(y)},a.cz=YC,a.d=function(v){return it.API_TILEJSON_REGEX.test(v)},a.d$=d,a.d0=aE,a.d1=lv,a.d2=450,a.d3=7,a.d4=Sfe,a.d5=ti,a.d6=Jg,a.d7=256,a.d8=ok,a.d9=fo,a.dA=AV,a.dB=function(v){const u=[0,0,0],p=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(p,v.pixelMatrix,v.globeMatrix),De.vec3.transformMat4(u,u,p),new At(u[0],u[1])},a.dC=function(v,u,p=!1){if(ho===Bf||ho===fd||ho===kf)throw new Error("setRTLTextPlugin cannot be called multiple times.");uc=En.resolveURL(v),ho=Bf,pd=u,p_(),p||Xg()},a.dD=$g,a.dE=function(){LE().acquire(nO)},a.dF=function(){const v=RS;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(nO),RS=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dG=PS,a.dH=function(v){const u=Xn();if(!u)return;const p=u.delete(Ct);v&&p.catch(v).then(()=>v())},a.dI=IS,a.dJ=fj,a.dK=function(v){rO=En.resolveURL(v),g1||(g1=new f1(LE(),new Xu)),g1.broadcast("setDracoUrl",rO)},a.dL=pj,a.dM=function(v){m1=En.resolveURL(v),g1||(g1=new f1(LE(),new Xu)),g1.broadcast("setMeshoptUrl",m1)},a.dN=Nn,a.dO=av,a.dP=Td,a.dQ=Sj,a.dR=Tj,a.dS=CH,a.dT=Ur,a.dU=n9,a.dV=function(v,u,p,y,T,b,M,k,G,W,R){v.createArrays(),v.tilePixelRatio=xn/(512*v.overscaling),v.compareText={},v.iconsNeedLinear=!1;const z=v.layers[0].layout,j=v.layers[0]._unevaluatedLayout._values,U={};if(v.textSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ue}=v.textSizeData;U.compositeTextSizes=[j["text-size"].possiblyEvaluate(new gs(ne),k),j["text-size"].possiblyEvaluate(new gs(ue),k)]}if(v.iconSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ue}=v.iconSizeData;U.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new gs(ne),k),j["icon-size"].possiblyEvaluate(new gs(ue),k)]}U.layoutTextSize=j["text-size"].possiblyEvaluate(new gs(G+1),k),U.layoutIconSize=j["icon-size"].possiblyEvaluate(new gs(G+1),k),U.textMaxSize=j["text-size"].possiblyEvaluate(new gs(18),k);const V=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",X=z.get("text-size");let Q=!1;for(const ne of v.features)if(ne.icon&&ne.icon.nameSecondary){Q=!0;break}for(const ne of v.features){const ue=z.get("text-font").evaluate(ne,{},k).join(","),fe=X.evaluate(ne,{},k),ie=U.layoutTextSize.evaluate(ne,{},k),me=(U.layoutIconSize.evaluate(ne,{},k),{horizontal:{},vertical:void 0}),ve=ne.text;let Ce,ke=[0,0];if(ve){const Ke=ve.toString(),Ve=z.get("text-letter-spacing").evaluate(ne,{},k)*Ga,et=z.get("text-line-height").evaluate(ne,{},k)*Ga,ut=sm(Ke)?Ve:0,dt=z.get("text-anchor").evaluate(ne,{},k),ft=z.get("text-variable-anchor");if(!ft){const Kt=z.get("text-radial-offset").evaluate(ne,{},k);ke=Kt?a9(dt,[Kt*Ga,Bk]):z.get("text-offset").evaluate(ne,{},k).map(kt=>kt*Ga)}let _t=V?"center":z.get("text-justify").evaluate(ne,{},k);const It=z.get("symbol-placement")==="point",xt=It?z.get("text-max-width").evaluate(ne,{},k)*Ga:1/0,Vt=Kt=>{v.allowVerticalPlacement&&Wc(Ke)&&(me.vertical=Pk(ve,u,p,T,ue,xt,et,dt,Kt,ut,ke,Pu.vertical,!0,ie,fe))};if(!V&&ft){const Kt=_t==="auto"?ft.map(Rn=>kk(Rn)):[_t];let kt=!1;for(let Rn=0;Rn<Kt.length;Rn++){const wn=Kt[Rn];if(!me.horizontal[wn])if(kt)me.horizontal[wn]=me.horizontal[0];else{const pn=Pk(ve,u,p,T,ue,xt,et,"center",wn,ut,ke,Pu.horizontal,!1,ie,fe);pn&&(me.horizontal[wn]=pn,kt=pn.positionedLines.length===1)}}Vt("left")}else{if(_t==="auto"&&(_t=kk(dt)),It||z.get("text-writing-mode").indexOf("horizontal")>=0||!Wc(Ke)){const Kt=Pk(ve,u,p,T,ue,xt,et,dt,_t,ut,ke,Pu.horizontal,!1,ie,fe);Kt&&(me.horizontal[_t]=Kt)}Vt(It?"left":_t)}}let Fe=!1;if(ne.icon&&ne.icon.namePrimary){const Ke=y[ne.icon.namePrimary];Ke&&(Ce=rfe(T[ne.icon.namePrimary],ne.icon.nameSecondary?T[ne.icon.nameSecondary]:void 0,z.get("icon-offset").evaluate(ne,{},k),z.get("icon-anchor").evaluate(ne,{},k)),Fe=Ke.sdf,v.sdfIcons===void 0?v.sdfIcons=Ke.sdf:v.sdfIcons!==Ke.sdf&&Bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ke.pixelRatio!==v.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(v.iconsNeedLinear=!0))}const Le=c9(me.horizontal)||me.vertical;v.iconsInText||(v.iconsInText=!!Le&&Le.iconsInText),(Le||Ce)&&ufe(v,ne,me,Ce,y,U,ie,0,ke,Fe,M,k,W,R,Q)}b&&v.generateCollisionDebugBuffers(G,v.collisionBoxArray)},a.dW=s1,a.dX=RE,a.dY=un,a.dZ=JV,a.d_=GH,a.da=qc,a.db=Kg,a.dc=function(v,u,p,y,T){return Wt((v-u)/(p-u)*(T-y)+y,y,T)},a.dd=th,a.de=ht,a.df=class{constructor(v,u,p,y){this.context=v,this.format=y,this.size=p,this.texture=v.gl.createTexture();const[T,b,M]=this.size,{gl:k}=v;k.bindTexture(k.TEXTURE_3D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),k.texImage3D(k.TEXTURE_3D,0,this.format,T,b,M,0,Vk(this.format),Hk(this.format),u.data)}bind(v,u){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_3D,this.texture),v!==this.minFilter&&(y.texParameteri(y.TEXTURE_3D,y.TEXTURE_MAG_FILTER,v),y.texParameteri(y.TEXTURE_3D,y.TEXTURE_MIN_FILTER,v),this.minFilter=v),u!==this.wrapS&&(y.texParameteri(y.TEXTURE_3D,y.TEXTURE_WRAP_S,u),y.texParameteri(y.TEXTURE_3D,y.TEXTURE_WRAP_T,u),this.wrapS=u)}destroy(){const{gl:v}=this.context;v.deleteTexture(this.texture),this.texture=null}},a.dg=Xk,a.dh=[1,1,1],a.di=d1,a.dj=h1,a.dk=Eu,a.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new At(1/0,1/0),max:new At(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(v,u=!1){const p=iH(new At(0,0),new At(xn,xn),v),y=[];if(u&&!yk(p,this._globalClipBounds))return y;for(const T of this._activeRegions){if(T.hiddenByOverlap||!yk(p,T))continue;const b=yde(T.min,T.max,v);y.push({min:b.min,max:b.max,sourceId:this._sourceIds[T.priority],footprint:T.footprint,footprintTileId:T.tileId,order:T.order,clipMask:T.clipMask,clipScope:T.clipScope})}return y}setSources(v){this._setSources(v.map(u=>({getSourceId:()=>u.cache.id,getFootprints:()=>{const p=[];for(const y of u.cache.getVisibleCoordinates()){const T=u.cache.getTile(y).buckets[u.layer];T&&T.updateFootprints(y.toUnwrapped(),p)}return p},getOrder:()=>u.order,getClipMask:()=>u.clipMask,getClipScope:()=>u.clipScope})))}_addSource(v){const u=v.getFootprints();if(u.length===0)return;const p=v.getOrder(),y=v.getClipMask(),T=v.getClipScope();for(const b of u){if(!b.footprint)continue;const M=iH(b.footprint.min,b.footprint.max,b.id);this._activeRegions.push({min:M.min,max:M.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:b.id,footprint:b.footprint,order:p,clipMask:y,clipScope:T})}this._sourceIds.push(v.getSourceId())}_computeReplacement(){this._activeRegions.sort((u,p)=>u.priority-p.priority||sE(u.min,p.min)||sE(u.max,p.max)||u.order-p.order||u.clipMask-p.clipMask||function(y,T){const b=(M,k)=>M+k;return y.length-T.length||y.reduce(b,"").localeCompare(T.reduce(b,""))}(u.clipScope,p.clipScope));let v=this._activeRegions.length!==this._prevRegions.length;if(!v){let u=0;for(;!v&&u!==this._activeRegions.length;){const p=this._activeRegions[u],y=this._prevRegions[u];v=p.priority!==y.priority||!rH(p,y)||p.order!==y.order||p.clipMask!==y.clipMask||!en(p.clipScope,y.clipScope),++u}}if(v){++this._updateTime;for(const p of this._activeRegions)p.order!==iE&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,p.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,p.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,p.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,p.max.y));const u=p=>{const y=this._activeRegions;if(p>=y.length)return p;const T=y[p].priority;for(;p<y.length&&y[p].priority===T;)++p;return p};if(this._sourceIds.length>1){let p=0,y=u(p);for(;p!==y;){let T=p;const b=p;for(;T!==y;){const M=this._activeRegions[T];M.hiddenByOverlap=!1;for(let k=0;k<b;k++){const G=this._activeRegions[k];if(!G.hiddenByOverlap&&M.order===iE&&yk(M,G)&&(M.hiddenByOverlap=oH(M.footprint,M.tileId,G.footprint,G.tileId),M.hiddenByOverlap))break}++T}p=y,y=u(p)}}}}_setSources(v){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let u=v.length-1;u>=0;u--)this._addSource(v[u]);this._computeReplacement()}},a.dm=class{constructor(v){this._createGrid(v),this._createPoles(v)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const v of this._poleSegments)v.destroy();for(const v of this._gridSegments)v.withSkirts.destroy(),v.withoutSkirts.destroy()}_fillGridMeshWithLods(v,u){const p=new fc,y=new To,T=[],b=v+1+2,M=u[0]+1,k=u[0]+1+(1+u.length),G=(W,R,z)=>{let j=W===b-1?W-2:W===0?W:W-1;return j+=z?24575:0,[j,R]};for(let W=0;W<b;++W)p.emplaceBack(...G(W,0,!0));for(let W=0;W<M;++W)for(let R=0;R<b;++R)p.emplaceBack(...G(R,W,(R===0||R===b-1)&&!0));for(let W=0;W<u.length;++W){const R=u[W];for(let z=0;z<b;++z)p.emplaceBack(...G(z,R,!0))}for(let W=0;W<u.length;++W){const R=y.length,z=u[W]+1+2,j=new To;for(let X=0;X<z-1;X++){const Q=X===z-2,ne=Q?b*(k-u.length+W-X):b;for(let ue=0;ue<b-1;ue++){const fe=X*b+ue;X===0||Q||ue===0||ue===b-2?(j.emplaceBack(fe+1,fe,fe+ne),j.emplaceBack(fe+ne,fe+ne+1,fe+1)):(y.emplaceBack(fe+1,fe,fe+ne),y.emplaceBack(fe+ne,fe+ne+1,fe+1))}}const U=As.simpleSegment(0,R,p.length,y.length-R);for(let X=0;X<j.uint16.length;X+=3)y.emplaceBack(j.uint16[X],j.uint16[X+1],j.uint16[X+2]);const V=As.simpleSegment(0,R,p.length,y.length-R);T.push({withoutSkirts:U,withSkirts:V})}return{vertices:p,indices:y,segments:T}}_createGrid(v){const u=this._fillGridMeshWithLods(D,N);this._gridSegments=u.segments,this._gridBuffer=v.createVertexBuffer(u.vertices,Kc.members),this._gridIndexBuffer=v.createIndexBuffer(u.indices,!0)}_createPoles(v){const u=new To;for(let M=0;M<=D;M++)u.emplaceBack(0,M+1,M+2);this._poleIndexBuffer=v.createIndexBuffer(u,!0);const p=new qc,y=new qc,T=new qc,b=new qc;this._poleSegments=[];for(let M=0,k=0;M<g;M++){const G=360/(1<<M);p.emplaceBack(0,-h,0,.5,0),y.emplaceBack(0,-h,0,.5,1),T.emplaceBack(0,-h,0,.5,.5),b.emplaceBack(0,-h,0,.5,.5);for(let W=0;W<=D;W++){let R=W/D,z=0;const j=ur(0,G,R),[U,V,X]=ee(qhe,Yhe,j,h);p.emplaceBack(U,V,X,R,z),y.emplaceBack(U,V,X,R,1-z);const Q=on(j);R=.5+.5*Math.sin(Q),z=.5+.5*Math.cos(Q),T.emplaceBack(U,V,X,R,z),b.emplaceBack(U,V,X,R,1-z)}this._poleSegments.push(As.simpleSegment(k,0,66,64)),k+=66}this._poleNorthVertexBuffer=v.createVertexBuffer(p,vc,!1),this._poleSouthVertexBuffer=v.createVertexBuffer(y,vc,!1),this._texturedPoleNorthVertexBuffer=v.createVertexBuffer(T,vc,!1),this._texturedPoleSouthVertexBuffer=v.createVertexBuffer(b,vc,!1)}getGridBuffers(v,u){return[this._gridBuffer,this._gridIndexBuffer,u?this._gridSegments[v].withSkirts:this._gridSegments[v].withoutSkirts]}getPoleBuffers(v,u){return[u?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,u?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[v]]}},a.dn=iE,a.dp=Tn,a.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.dr=An,a.ds=at,a.dt=te,a.du=function([v,u,p]){const y=Math.hypot(v,u,p),T=Math.atan2(v,p),b=.5*Math.PI-Math.acos(-u/y);return new de(ct(T),ct(b))},a.dv=$k,a.dw=le,a.dx=function(v){const u=v.navigator?v.navigator.userAgent:null;return!!function(p){if(Bs==null){const y=p.navigator?p.navigator.userAgent:null;Bs=!!p.safari||!(!y||!(/\b(iPad|iPhone|iPod)\b/.test(y)||y.match("Safari")&&!y.match("Chrome")))}return Bs}(v)&&u&&(u.match("Version/15.4")||u.match("Version/15.5")||u.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.dy=function(v,u){Et=v,Pt=u},a.dz=lk,a.e=it,a.e0=function(v){let u=0;if(new Uint32Array(v,0,1)[0]!==gj){const p=new Uint32Array(v,0,7),[,,y,T,b,M]=p;u=p.byteLength+T+b+M+b,(y!==v.byteLength||u>=v.byteLength)&&Bt("Invalid b3dm header information.")}return xj(v,u)},a.e1=function(v,u){const p=wj(v);for(const y of p){for(const T of y.meshes)bpe(T);y.lights&&(y.lightMeshIndex=y.meshes.length,y.meshes.push(wpe(y.lights,u)))}return p},a.e2=PE,a.e3=Z9,a.e4=Ua,a.e5=function(v){cr(),yn!=null&&yn.then(u=>{u.keys().then(p=>{for(let y=0;y<p.length-v;y++)u.delete(p[y])})})},a.f=function(v){return v.indexOf("mapbox:")===0},a.g=function(v,u){return Yo(Ar(v,{method:"GET"}),u)},a.h=Qe,a.i=function(v){return it.API_STYLE_REGEX.test(v)&&!mt(v)},a.j=function(v){return decodeURIComponent(atob(v).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.k=function(v){return btoa(encodeURIComponent(v).replace(/%([0-9A-F]{2})/g,(u,p)=>String.fromCharCode(+("0x"+p))))},a.l=Ar,a.m=pr,a.n=function(v,u){return Yo(Ar(v,{type:"json"}),u)},a.o=Cs,a.p=function(v,u){return Yo(Ar(v,{method:"POST"}),u)},a.q=En,a.r=yl,a.s=function(v){try{const u=self[v];return u.setItem("_mapbox_test_",1),u.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=Bp,a.u=function(){return function v(u){return u?(u^Math.random()*(16>>u/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,v)}()},a.v=function(v){return!!v&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(v)},a.w=Bt,a.x=tc,a.y=2,a.z=t9}),l(["./shared"],function(a){function d(Mt){const we=Mt?Mt.url.toString():void 0;return we?performance.getEntriesByName(we):[]}function f(Mt){if(typeof Mt=="number"||typeof Mt=="boolean"||typeof Mt=="string"||Mt==null)return JSON.stringify(Mt);if(Array.isArray(Mt)){let Ie="[";for(const qe of Mt)Ie+=`${f(qe)},`;return`${Ie}]`}let we="{";for(const Ie of Object.keys(Mt).sort())we+=`${Ie}:${f(Mt[Ie])},`;return`${we}}`}function m(Mt){let we="";for(const Ie of a.bg)we+=`/${f(Mt[Ie])}`;return we}class _{constructor(we){this.keyCache={},this._layers={},this._layerConfigs={},we&&this.replace(we)}replace(we,Ie){this._layerConfigs={},this._layers={},this.update(we,[],Ie)}update(we,Ie,qe){this._options=qe;for(const Qe of we)this._layerConfigs[Qe.id]=Qe,(this._layers[Qe.id]=a.cq(Qe,this.scope,null,this._options)).compileFilter(qe),this.keyCache[Qe.id]&&delete this.keyCache[Qe.id];for(const Qe of Ie)delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe];this.familiesBySource={};const it=function(Qe,mt){const Rt={};for(let Lt=0;Lt<Qe.length;Lt++){const Gt=mt&&mt[Qe[Lt].id]||m(Qe[Lt]);mt&&(mt[Qe[Lt].id]=Gt);let Ot=Rt[Gt];Ot||(Ot=Rt[Gt]=[]),Ot.push(Qe[Lt])}const yt=[];for(const Lt in Rt)yt.push(Rt[Lt]);return yt}(a.bd(this._layerConfigs),this.keyCache);for(const Qe of it){const mt=Qe.map(cn=>this._layers[cn.id]),Rt=mt[0];if(Rt.visibility==="none")continue;const yt=Rt.source||"";let Lt=this.familiesBySource[yt];Lt||(Lt=this.familiesBySource[yt]={});const Gt=Rt.sourceLayer||"_geojsonTileLayer";let Ot=Lt[Gt];Ot||(Ot=Lt[Gt]=[]),Ot.push(mt)}}}const x=1*a.dP;class A{constructor(we){const Ie={},qe=[];for(const Rt in we){const yt=we[Rt],Lt=Ie[Rt]={};for(const Gt in yt.glyphs){const Ot=yt.glyphs[+Gt];if(!Ot||Ot.bitmap.width===0||Ot.bitmap.height===0)continue;const cn=Ot.metrics.localGlyph?x:1,Cn={x:0,y:0,w:Ot.bitmap.width+2*cn,h:Ot.bitmap.height+2*cn};qe.push(Cn),Lt[Gt]=Cn}}const{w:it,h:Qe}=a.z(qe),mt=new a.dO({width:it||1,height:Qe||1});for(const Rt in we){const yt=we[Rt];for(const Lt in yt.glyphs){const Gt=yt.glyphs[+Lt];if(!Gt||Gt.bitmap.width===0||Gt.bitmap.height===0)continue;const Ot=Ie[Rt][Lt],cn=Gt.metrics.localGlyph?x:1;a.dO.copy(Gt.bitmap,mt,{x:0,y:0},{x:Ot.x+cn,y:Ot.y+cn},Gt.bitmap)}}this.image=mt,this.positions=Ie}}a.dN(A,"GlyphAtlas");class I{constructor(we){this.tileID=new a.aA(we.tileID.overscaledZ,we.tileID.wrap,we.tileID.canonical.z,we.tileID.canonical.x,we.tileID.canonical.y),this.tileZoom=we.tileZoom,this.uid=we.uid,this.zoom=we.zoom,this.lut=we.lut,this.canonical=we.tileID.canonical,this.pixelRatio=we.pixelRatio,this.tileSize=we.tileSize,this.source=we.source,this.scope=we.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=we.showCollisionBoxes,this.collectResourceTiming=!!we.collectResourceTiming,this.promoteId=we.promoteId,this.isSymbolTile=we.isSymbolTile,this.tileTransform=a.aK(we.tileID.canonical,we.projection),this.projection=we.projection,this.brightness=we.brightness,this.extraShadowCaster=!!we.extraShadowCaster,this.tessellationStep=we.tessellationStep}parse(we,Ie,qe,it,Qe){this.status="parsing",this.data=we,this.collisionBoxArray=new a.aQ;const mt=new a.dQ(Object.keys(we.layers).sort()),Rt=new a.dR(this.tileID,this.promoteId);Rt.bucketLayerIDs=[];const yt={},Lt=new a.dS(256,256),Gt={featureIndex:Rt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Lt,availableImages:qe,brightness:this.brightness},Ot=Ie.familiesBySource[this.source];for(const Et in Ot){const Pt=we.layers[Et];if(!Pt)continue;let Sn=!1,yn=!1,Un=!1;for(const vr of Ot[Et])vr[0].type==="symbol"?Sn=!0:yn=!0,vr[0].is3D()&&vr[0].type!=="model"&&(Un=!0);if(this.extraShadowCaster&&!Un||this.isSymbolTile===!0&&!Sn||this.isSymbolTile===!1&&!yn)continue;Pt.version===1&&a.w(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xn=mt.encode(Et),cr=[];for(let vr=0;vr<Pt.length;vr++){const pr=Pt.feature(vr),pi=Rt.getId(pr,Et);cr.push({feature:pr,id:pi,index:vr,sourceLayerIndex:Xn})}for(const vr of Ot[Et]){const pr=vr[0];(!this.extraShadowCaster||pr.is3D()&&pr.type!=="model")&&(this.isSymbolTile!==void 0&&pr.type==="symbol"!==this.isSymbolTile||pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||pr.visibility!=="none"&&(E(vr,this.zoom,Gt.brightness,qe),(yt[pr.id]=pr.createBucket({index:Rt.bucketLayerIDs.length,layers:vr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(cr,Gt,this.tileID.canonical,this.tileTransform),Rt.bucketLayerIDs.push(vr.map(pi=>pi.id))))}}let cn,Cn,En,je;Lt.trim();const bt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ct=()=>{if(cn)return this.status="done",Qe(cn);if(this.extraShadowCaster)this.status="done",Qe(null,{buckets:a.bd(yt).filter(Et=>!Et.isEmpty()),featureIndex:Rt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Gt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Cn&&En&&je){const Et=new A(Cn),Pt=new a.dU(En,je,this.lut);for(const Sn in yt){const yn=yt[Sn];yn instanceof a.aR?(E(yn.layers,this.zoom,Gt.brightness,qe),a.dV(yn,Cn,Et.positions,En,Pt.iconPositions,this.showCollisionBoxes,qe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):yn.hasPattern&&(yn instanceof a.aX||yn instanceof a.aY||yn instanceof a.d0)&&(E(yn.layers,this.zoom,Gt.brightness,qe),yn.addFeatures(Gt,this.tileID.canonical,Pt.patternPositions,qe,this.tileTransform,this.brightness))}this.status="done",Qe(null,{buckets:a.bd(yt).filter(Sn=>!Sn.isEmpty()),featureIndex:Rt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,lineAtlas:Lt,imageAtlas:Pt,brightness:Gt.brightness})}};if(!this.extraShadowCaster){const Et=a.dT(Gt.glyphDependencies,yn=>Object.keys(yn).map(Number));Object.keys(Et).length?it.send("getGlyphs",{uid:this.uid,stacks:Et,scope:this.scope},(yn,Un)=>{cn||(cn=yn,Cn=Un,Ct())},void 0,!1,bt):Cn={};const Pt=Object.keys(Gt.iconDependencies);Pt.length?it.send("getImages",{icons:Pt,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(yn,Un)=>{cn||(cn=yn,En=Un,Ct())},void 0,!1,bt):En={};const Sn=Object.keys(Gt.patternDependencies);Sn.length?it.send("getImages",{icons:Sn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(yn,Un)=>{cn||(cn=yn,je=Un,Ct())},void 0,!1,bt):je={}}Ct()}}function E(Mt,we,Ie,qe){const it=new a.a3(we,{brightness:Ie});for(const Qe of Mt)Qe.recalculate(it,qe)}class C extends a.E{constructor(we,Ie,qe,it,Qe,mt){super(),this.actor=we,this.layerIndex=Ie,this.availableImages=qe,this.loadVectorData=Qe||a.aw,this.loading={},this.loaded={},this.deduped=new a.au(we.scheduler),this.isSpriteLoaded=it,this.scheduler=we.scheduler,this.brightness=mt}loadTile(we,Ie){const qe=we.uid,it=we&&we.request,Qe=it&&it.collectResourceTiming,mt=this.loading[qe]=new I(we);mt.abort=this.loadVectorData(we,(Rt,yt)=>{const Lt=!this.loading[qe];if(delete this.loading[qe],Lt||Rt||!yt)return mt.status="done",Lt||(this.loaded[qe]=mt),Ie(Rt);const Gt=yt.rawData,Ot={};yt.expires&&(Ot.expires=yt.expires),yt.cacheControl&&(Ot.cacheControl=yt.cacheControl),mt.vectorTile=yt.vectorTile||new a.dW.VectorTile(new a.bb(Gt));const cn=()=>{mt.parse(mt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Cn,En)=>{if(Cn||!En)return Ie(Cn);const je={};if(Qe){const bt=d(it);bt.length>0&&(je.resourceTiming=JSON.parse(JSON.stringify(bt)))}Ie(null,a.l({rawTileData:Gt.slice(0)},En,Ot,je))})};this.isSpriteLoaded?cn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(cn,{type:"parseTile",isSymbolTile:we.isSymbolTile,zoom:we.tileZoom}):cn()}),this.loaded=this.loaded||{},this.loaded[qe]=mt})}reloadTile(we,Ie){const qe=this.loaded,it=we.uid;if(qe&&qe[it]){const Qe=qe[it];Qe.showCollisionBoxes=we.showCollisionBoxes,Qe.projection=we.projection,Qe.brightness=we.brightness,Qe.tileTransform=a.aK(we.tileID.canonical,we.projection),Qe.extraShadowCaster=we.extraShadowCaster,Qe.lut=we.lut;const mt=(Rt,yt)=>{const Lt=Qe.reloadCallback;Lt&&(delete Qe.reloadCallback,Qe.parse(Qe.vectorTile,this.layerIndex,this.availableImages,this.actor,Lt)),Ie(Rt,yt)};Qe.status==="parsing"?Qe.reloadCallback=mt:Qe.status==="done"&&(Qe.vectorTile?Qe.parse(Qe.vectorTile,this.layerIndex,this.availableImages,this.actor,mt):mt())}else Ie(null,void 0)}abortTile(we,Ie){const qe=we.uid,it=this.loading[qe];it&&(it.abort&&it.abort(),delete this.loading[qe]),Ie()}removeTile(we,Ie){const qe=this.loaded,it=we.uid;qe&&qe[it]&&delete qe[it],Ie()}}class L{loadTile(we,Ie){const{uid:qe,encoding:it,rawImageData:Qe,padding:mt}=we,Rt=ImageBitmap&&Qe instanceof ImageBitmap?this.getImageData(Qe,mt):Qe;Ie(null,new a.dX(qe,Rt,it,mt<1))}getImageData(we,Ie){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(we.width,we.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=we.width,this.offscreenCanvas.height=we.height,this.offscreenCanvasContext.drawImage(we,0,0,we.width,we.height);const qe=this.offscreenCanvasContext.getImageData(-Ie,-Ie,we.width+2*Ie,we.height+2*Ie);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),qe}}a.ba.setPbf(a.bb);class O{decodeRasterArray({task:we,buffer:Ie},qe){a.ba.performDecoding(Ie,we).then(it=>{qe(null,it)},it=>{qe(it)})}}const H=a.dW.VectorTileFeature.prototype.toGeoJSON;class q{constructor(we){this._feature=we,this.extent=a.ab,this.type=we.type,this.properties=we.tags,"id"in we&&!isNaN(we.id)&&(this.id=parseInt(we.id,10))}loadGeometry(){if(this._feature.type===1){const we=[];for(const Ie of this._feature.geometry)we.push([new a.P(Ie[0],Ie[1])]);return we}{const we=[];for(const Ie of this._feature.geometry){const qe=[];for(const it of Ie)qe.push(new a.P(it[0],it[1]));we.push(qe)}return we}}toGeoJSON(we,Ie,qe){return H.call(this,we,Ie,qe)}}class Z{constructor(we){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.ab,this.length=we.length,this._features=we}feature(we){return new q(this._features[we])}}const J=64/4096,re=128;class se{constructor(){this.features=new Map}clear(){this.features.clear()}load(we=[],Ie){for(const qe of we){const it=qe.id;if(it==null)continue;let Qe=this.features.get(it);Qe&&this.updateCache(Qe,Ie),qe.geometry?(Qe=he(qe),this.updateCache(Qe,Ie),this.features.set(it,Qe)):this.features.delete(it),this.updateCache(Qe,Ie)}}updateCache(we,Ie){for(const{canonical:qe,uid:it}of Object.values(Ie)){const{z:Qe,x:mt,y:Rt}=qe;ae(we,Math.pow(2,Qe),mt,Rt)&&delete Ie[it]}}getTile(we,Ie,qe){const it=Math.pow(2,we),Qe=[];for(const mt of this.features.values())ae(mt,it,Ie,qe)&&Qe.push(ze(mt,it,Ie,qe));return{features:Qe}}getFeatures(){return[...this.features.values()]}}function ae({minX:Mt,minY:we,maxX:Ie,maxY:qe},it,Qe,mt){return Mt<(Qe+1+J)/it&&we<(mt+1+J)/it&&Ie>(Qe-J)/it&&qe>(mt-J)/it}function he(Mt){const{id:we,geometry:Ie,properties:qe}=Mt;if(!Ie)return;if(Ie.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:it,coordinates:Qe}=Ie,mt={id:we,type:1,geometry:[],tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Rt=mt.geometry;if(it==="Point")Ae(Qe,Rt,mt);else if(it==="MultiPoint")for(const yt of Qe)Ae(yt,Rt,mt);else if(it==="LineString")mt.type=2,Ee(Qe,Rt,mt);else if(it==="MultiLineString")mt.type=2,Pe(Qe,Rt,mt);else if(it==="Polygon")mt.type=3,Pe(Qe,Rt,mt,!0);else{if(it!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");mt.type=3;for(const yt of Qe)Pe(yt,Rt,mt,!0)}return mt}function Ae([Mt,we],Ie,qe){const it=a.am(Mt);let Qe=a.at(we);Qe=Qe<0?0:Qe>1?1:Qe,Ie.push(it,Qe),qe.minX=Math.min(qe.minX,it),qe.minY=Math.min(qe.minY,Qe),qe.maxX=Math.max(qe.maxX,it),qe.maxY=Math.max(qe.maxY,Qe)}function Ee(Mt,we,Ie,qe=!1,it=!1){const Qe=[];for(const mt of Mt)Ae(mt,Qe,Ie);we.push(Qe),qe&&function(mt,Rt){let yt=0;for(let Lt=0,Gt=mt.length,Ot=Gt-2;Lt<Gt;Ot=Lt,Lt+=2)yt+=(mt[Lt]-mt[Ot])*(mt[Lt+1]+mt[Ot+1]);if(yt>0===Rt)for(let Lt=0,Gt=mt.length;Lt<Gt/2;Lt+=2){const Ot=mt[Lt],cn=mt[Lt+1];mt[Lt]=mt[Gt-2-Lt],mt[Lt+1]=mt[Gt-1-Lt],mt[Gt-2-Lt]=Ot,mt[Gt-1-Lt]=cn}}(Qe,it)}function Pe(Mt,we,Ie,qe=!1){for(let it=0;it<Mt.length;it++)Ee(Mt[it],we,Ie,qe,it===0)}function ze(Mt,we,Ie,qe){const{id:it,type:Qe,geometry:mt,tags:Rt}=Mt,yt=[];if(Qe===1)(function(Lt,Gt,Ot,cn,Cn){for(let En=0;En<Lt.length;En+=2){const je=Math.round(a.ab*(Lt[En+0]*Gt-Ot)),bt=Math.round(a.ab*(Lt[En+1]*Gt-cn));Cn.push([je,bt])}})(mt,we,Ie,qe,yt);else for(const Lt of mt)Re(Lt,we,Ie,qe,yt);return{id:it,type:Qe,geometry:yt,tags:Rt}}function Re(Mt,we,Ie,qe,it){const Qe=-re,mt=a.ab+re;let Rt;for(let yt=0;yt<Mt.length-2;yt+=2){let Lt=Math.round(a.ab*(Mt[yt+0]*we-Ie)),Gt=Math.round(a.ab*(Mt[yt+1]*we-qe)),Ot=Math.round(a.ab*(Mt[yt+2]*we-Ie)),cn=Math.round(a.ab*(Mt[yt+3]*we-qe));const Cn=Ot-Lt,En=cn-Gt;Lt<Qe&&Ot<Qe||(Lt<Qe?(Gt+=Math.round(En*((Qe-Lt)/Cn)),Lt=Qe):Ot<Qe&&(cn=Gt+Math.round(En*((Qe-Lt)/Cn)),Ot=Qe),Gt<Qe&&cn<Qe||(Gt<Qe?(Lt+=Math.round(Cn*((Qe-Gt)/En)),Gt=Qe):cn<Qe&&(Ot=Lt+Math.round(Cn*((Qe-Gt)/En)),cn=Qe),Lt>=mt&&Ot>=mt||(Lt>=mt?(Gt+=Math.round(En*((mt-Lt)/Cn)),Lt=mt):Ot>=mt&&(cn=Gt+Math.round(En*((mt-Lt)/Cn)),Ot=mt),Gt>=mt&&cn>=mt||(Gt>=mt?(Lt+=Math.round(Cn*((mt-Gt)/En)),Gt=mt):cn>=mt&&(Ot=Lt+Math.round(Cn*((mt-Gt)/En)),cn=mt),Rt&&Lt===Rt[Rt.length-1][0]&&Gt===Rt[Rt.length-1][1]||(Rt=[[Lt,Gt]],it.push(Rt)),Rt.push([Ot,cn])))))}}var rt,ye,We,Ue={exports:{}},gt=function(){if(We)return Ue.exports;We=1;var Mt=a.d_(),we=function(){if(ye)return rt;ye=1;var Gt=a.dY(),Ot=a.dZ().VectorTileFeature;function cn(En,je){this.options=je||{},this.features=En,this.length=En.length}function Cn(En,je){this.id=typeof En.id=="number"?En.id:void 0,this.type=En.type,this.rawGeometry=En.type===1?[En.geometry]:En.geometry,this.properties=En.tags,this.extent=je||4096}return rt=cn,cn.prototype.feature=function(En){return new Cn(this.features[En],this.options.extent)},Cn.prototype.loadGeometry=function(){var En=this.rawGeometry;this.geometry=[];for(var je=0;je<En.length;je++){for(var bt=En[je],Ct=[],Et=0;Et<bt.length;Et++)Ct.push(new Gt(bt[Et][0],bt[Et][1]));this.geometry.push(Ct)}return this.geometry},Cn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var En=this.geometry,je=1/0,bt=-1/0,Ct=1/0,Et=-1/0,Pt=0;Pt<En.length;Pt++)for(var Sn=En[Pt],yn=0;yn<Sn.length;yn++){var Un=Sn[yn];je=Math.min(je,Un.x),bt=Math.max(bt,Un.x),Ct=Math.min(Ct,Un.y),Et=Math.max(Et,Un.y)}return[je,Ct,bt,Et]},Cn.prototype.toGeoJSON=Ot.prototype.toGeoJSON,rt}();function Ie(Gt){var Ot=new Mt;return function(cn,Cn){for(var En in cn.layers)Cn.writeMessage(3,qe,cn.layers[En])}(Gt,Ot),Ot.finish()}function qe(Gt,Ot){var cn;Ot.writeVarintField(15,Gt.version||1),Ot.writeStringField(1,Gt.name||""),Ot.writeVarintField(5,Gt.extent||4096);var Cn={keys:[],values:[],keycache:{},valuecache:{}};for(cn=0;cn<Gt.length;cn++)Cn.feature=Gt.feature(cn),Ot.writeMessage(2,it,Cn);var En=Cn.keys;for(cn=0;cn<En.length;cn++)Ot.writeStringField(3,En[cn]);var je=Cn.values;for(cn=0;cn<je.length;cn++)Ot.writeMessage(4,Lt,je[cn])}function it(Gt,Ot){var cn=Gt.feature;cn.id!==void 0&&Ot.writeVarintField(1,cn.id),Ot.writeMessage(2,Qe,Gt),Ot.writeVarintField(3,cn.type),Ot.writeMessage(4,yt,cn)}function Qe(Gt,Ot){var cn=Gt.feature,Cn=Gt.keys,En=Gt.values,je=Gt.keycache,bt=Gt.valuecache;for(var Ct in cn.properties){var Et=cn.properties[Ct],Pt=je[Ct];if(Et!==null){Pt===void 0&&(Cn.push(Ct),je[Ct]=Pt=Cn.length-1),Ot.writeVarint(Pt);var Sn=typeof Et;Sn!=="string"&&Sn!=="boolean"&&Sn!=="number"&&(Et=JSON.stringify(Et));var yn=Sn+":"+Et,Un=bt[yn];Un===void 0&&(En.push(Et),bt[yn]=Un=En.length-1),Ot.writeVarint(Un)}}}function mt(Gt,Ot){return(Ot<<3)+(7&Gt)}function Rt(Gt){return Gt<<1^Gt>>31}function yt(Gt,Ot){for(var cn=Gt.loadGeometry(),Cn=Gt.type,En=0,je=0,bt=cn.length,Ct=0;Ct<bt;Ct++){var Et=cn[Ct],Pt=1;Cn===1&&(Pt=Et.length),Ot.writeVarint(mt(1,Pt));for(var Sn=Cn===3?Et.length-1:Et.length,yn=0;yn<Sn;yn++){yn===1&&Cn!==1&&Ot.writeVarint(mt(2,Sn-1));var Un=Et[yn].x-En,Xn=Et[yn].y-je;Ot.writeVarint(Rt(Un)),Ot.writeVarint(Rt(Xn)),En+=Un,je+=Xn}Cn===3&&Ot.writeVarint(mt(7,1))}}function Lt(Gt,Ot){var cn=typeof Gt;cn==="string"?Ot.writeStringField(1,Gt):cn==="boolean"?Ot.writeBooleanField(7,Gt):cn==="number"&&(Gt%1!=0?Ot.writeDoubleField(3,Gt):Gt<0?Ot.writeSVarintField(6,Gt):Ot.writeVarintField(5,Gt))}return Ue.exports=Ie,Ue.exports.fromVectorTileJs=Ie,Ue.exports.fromGeojsonVt=function(Gt,Ot){Ot=Ot||{};var cn={};for(var Cn in Gt)cn[Cn]=new we(Gt[Cn].features,Ot),cn[Cn].name=Cn,cn[Cn].version=Ot.version,cn[Cn].extent=Ot.extent;return Ie({layers:cn})},Ue.exports.GeoJSONWrapper=we,Ue.exports}(),vt=a.d$(gt);const Dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Mt=>Mt},lt=Math.fround||(jt=new Float32Array(1),Mt=>(jt[0]=+Mt,jt[0]));var jt;const Qt=3,nn=5,Wn=6;class kn{constructor(we){this.options=Object.assign(Object.create(Dt),we),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(we){const{log:Ie,minZoom:qe,maxZoom:it}=this.options;Ie&&console.time("total time");const Qe=`prepare ${we.length} points`;Ie&&console.time(Qe),this.points=we;const mt=[];for(let yt=0;yt<we.length;yt++){const Lt=we[yt];if(!Lt.geometry)continue;const[Gt,Ot]=Lt.geometry.coordinates,cn=lt(Ye(Gt)),Cn=lt(gn(Ot));mt.push(cn,Cn,1/0,yt,-1,1),this.options.reduce&&mt.push(0)}let Rt=this.trees[it+1]=this._createTree(mt);Ie&&console.timeEnd(Qe);for(let yt=it;yt>=qe;yt--){const Lt=+Date.now();Rt=this.trees[yt]=this._createTree(this._cluster(Rt,yt)),Ie&&console.log("z%d: %d clusters in %dms",yt,Rt.numItems,+Date.now()-Lt)}return Ie&&console.timeEnd("total time"),this}getClusters(we,Ie){let qe=((we[0]+180)%360+360)%360-180;const it=Math.max(-90,Math.min(90,we[1]));let Qe=we[2]===180?180:((we[2]+180)%360+360)%360-180;const mt=Math.max(-90,Math.min(90,we[3]));if(we[2]-we[0]>=360)qe=-180,Qe=180;else if(qe>Qe){const Ot=this.getClusters([qe,it,180,mt],Ie),cn=this.getClusters([-180,it,Qe,mt],Ie);return Ot.concat(cn)}const Rt=this.trees[this._limitZoom(Ie)],yt=Rt.range(Ye(qe),gn(mt),Ye(Qe),gn(it)),Lt=Rt.data,Gt=[];for(const Ot of yt){const cn=this.stride*Ot;Gt.push(Lt[cn+nn]>1?Mn(Lt,cn,this.clusterProps):this.points[Lt[cn+Qt]])}return Gt}getChildren(we){const Ie=this._getOriginId(we),qe=this._getOriginZoom(we),it="No cluster with the specified id.",Qe=this.trees[qe];if(!Qe)throw new Error(it);const mt=Qe.data;if(Ie*this.stride>=mt.length)throw new Error(it);const Rt=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),yt=Qe.within(mt[Ie*this.stride],mt[Ie*this.stride+1],Rt),Lt=[];for(const Gt of yt){const Ot=Gt*this.stride;mt[Ot+4]===we&&Lt.push(mt[Ot+nn]>1?Mn(mt,Ot,this.clusterProps):this.points[mt[Ot+Qt]])}if(Lt.length===0)throw new Error(it);return Lt}getLeaves(we,Ie,qe){const it=[];return this._appendLeaves(it,we,Ie=Ie||10,qe=qe||0,0),it}getTile(we,Ie,qe){const it=this.trees[this._limitZoom(we)],Qe=Math.pow(2,we),{extent:mt,radius:Rt}=this.options,yt=Rt/mt,Lt=(qe-yt)/Qe,Gt=(qe+1+yt)/Qe,Ot={features:[]};return this._addTileFeatures(it.range((Ie-yt)/Qe,Lt,(Ie+1+yt)/Qe,Gt),it.data,Ie,qe,Qe,Ot),Ie===0&&this._addTileFeatures(it.range(1-yt/Qe,Lt,1,Gt),it.data,Qe,qe,Qe,Ot),Ie===Qe-1&&this._addTileFeatures(it.range(0,Lt,yt/Qe,Gt),it.data,-1,qe,Qe,Ot),Ot.features.length?Ot:null}getClusterExpansionZoom(we){let Ie=this._getOriginZoom(we)-1;for(;Ie<=this.options.maxZoom;){const qe=this.getChildren(we);if(Ie++,qe.length!==1)break;we=qe[0].properties.cluster_id}return Ie}_appendLeaves(we,Ie,qe,it,Qe){const mt=this.getChildren(Ie);for(const Rt of mt){const yt=Rt.properties;if(yt&&yt.cluster?Qe+yt.point_count<=it?Qe+=yt.point_count:Qe=this._appendLeaves(we,yt.cluster_id,qe,it,Qe):Qe<it?Qe++:we.push(Rt),we.length===qe)break}return Qe}_createTree(we){const Ie=new a.by(we.length/this.stride|0,this.options.nodeSize,Float32Array);for(let qe=0;qe<we.length;qe+=this.stride)Ie.add(we[qe],we[qe+1]);return Ie.finish(),Ie.data=we,Ie}_addTileFeatures(we,Ie,qe,it,Qe,mt){for(const Rt of we){const yt=Rt*this.stride,Lt=Ie[yt+nn]>1;let Gt,Ot,cn;if(Lt)Gt=De(Ie,yt,this.clusterProps),Ot=Ie[yt],cn=Ie[yt+1];else{const je=this.points[Ie[yt+Qt]];Gt=je.properties;const[bt,Ct]=je.geometry.coordinates;Ot=Ye(bt),cn=gn(Ct)}const Cn={type:1,geometry:[[Math.round(this.options.extent*(Ot*Qe-qe)),Math.round(this.options.extent*(cn*Qe-it))]],tags:Gt};let En;En=Lt||this.options.generateId?Ie[yt+Qt]:this.points[Ie[yt+Qt]].id,En!==void 0&&(Cn.id=En),mt.features.push(Cn)}}_limitZoom(we){return Math.max(this.options.minZoom,Math.min(Math.floor(+we),this.options.maxZoom+1))}_cluster(we,Ie){const{radius:qe,extent:it,reduce:Qe,minPoints:mt}=this.options,Rt=qe/(it*Math.pow(2,Ie)),yt=we.data,Lt=[],Gt=this.stride;for(let Ot=0;Ot<yt.length;Ot+=Gt){if(yt[Ot+2]<=Ie)continue;yt[Ot+2]=Ie;const cn=yt[Ot],Cn=yt[Ot+1],En=we.within(yt[Ot],yt[Ot+1],Rt),je=yt[Ot+nn];let bt=je;for(const Ct of En){const Et=Ct*Gt;yt[Et+2]>Ie&&(bt+=yt[Et+nn])}if(bt>je&&bt>=mt){let Ct,Et=cn*je,Pt=Cn*je,Sn=-1;const yn=(Ot/Gt<<5)+(Ie+1)+this.points.length;for(const Un of En){const Xn=Un*Gt;if(yt[Xn+2]<=Ie)continue;yt[Xn+2]=Ie;const cr=yt[Xn+nn];Et+=yt[Xn]*cr,Pt+=yt[Xn+1]*cr,yt[Xn+4]=yn,Qe&&(Ct||(Ct=this._map(yt,Ot,!0),Sn=this.clusterProps.length,this.clusterProps.push(Ct)),Qe(Ct,this._map(yt,Xn)))}yt[Ot+4]=yn,Lt.push(Et/bt,Pt/bt,1/0,yn,-1,bt),Qe&&Lt.push(Sn)}else{for(let Ct=0;Ct<Gt;Ct++)Lt.push(yt[Ot+Ct]);if(bt>1)for(const Ct of En){const Et=Ct*Gt;if(!(yt[Et+2]<=Ie)){yt[Et+2]=Ie;for(let Pt=0;Pt<Gt;Pt++)Lt.push(yt[Et+Pt])}}}}return Lt}_getOriginId(we){return we-this.points.length>>5}_getOriginZoom(we){return(we-this.points.length)%32}_map(we,Ie,qe){if(we[Ie+nn]>1){const mt=this.clusterProps[we[Ie+Wn]];return qe?Object.assign({},mt):mt}const it=this.points[we[Ie+Qt]].properties,Qe=this.options.map(it);return qe&&Qe===it?Object.assign({},Qe):Qe}}function Mn(Mt,we,Ie){return{type:"Feature",id:Mt[we+Qt],properties:De(Mt,we,Ie),geometry:{type:"Point",coordinates:[(qe=Mt[we],360*(qe-.5)),un(Mt[we+1])]}};var qe}function De(Mt,we,Ie){const qe=Mt[we+nn],it=qe>=1e4?`${Math.round(qe/1e3)}k`:qe>=1e3?Math.round(qe/100)/10+"k":qe,Qe=Mt[we+Wn],mt=Qe===-1?{}:Object.assign({},Ie[Qe]);return Object.assign(mt,{cluster:!0,cluster_id:Mt[we+Qt],point_count:qe,point_count_abbreviated:it})}function Ye(Mt){return Mt/360+.5}function gn(Mt){const we=Math.sin(Mt*Math.PI/180),Ie=.5-.25*Math.log((1+we)/(1-we))/Math.PI;return Ie<0?0:Ie>1?1:Ie}function un(Mt){const we=(180-360*Mt)*Math.PI/180;return 360*Math.atan(Math.exp(we))/Math.PI-90}function At(Mt,we,Ie,qe){let it=qe;const Qe=we+(Ie-we>>1);let mt,Rt=Ie-we;const yt=Mt[we],Lt=Mt[we+1],Gt=Mt[Ie],Ot=Mt[Ie+1];for(let cn=we+3;cn<Ie;cn+=3){const Cn=en(Mt[cn],Mt[cn+1],yt,Lt,Gt,Ot);if(Cn>it)mt=cn,it=Cn;else if(Cn===it){const En=Math.abs(cn-Qe);En<Rt&&(mt=cn,Rt=En)}}it>qe&&(mt-we>3&&At(Mt,we,mt,qe),Mt[mt+2]=it,Ie-mt>3&&At(Mt,mt,Ie,qe))}function en(Mt,we,Ie,qe,it,Qe){let mt=it-Ie,Rt=Qe-qe;if(mt!==0||Rt!==0){const yt=((Mt-Ie)*mt+(we-qe)*Rt)/(mt*mt+Rt*Rt);yt>1?(Ie=it,qe=Qe):yt>0&&(Ie+=mt*yt,qe+=Rt*yt)}return mt=Mt-Ie,Rt=we-qe,mt*mt+Rt*Rt}function On(Mt,we,Ie,qe){const it={id:Mt??null,type:we,geometry:Ie,tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(we==="Point"||we==="MultiPoint"||we==="LineString")Vn(it,Ie);else if(we==="Polygon")Vn(it,Ie[0]);else if(we==="MultiLineString")for(const Qe of Ie)Vn(it,Qe);else if(we==="MultiPolygon")for(const Qe of Ie)Vn(it,Qe[0]);return it}function Vn(Mt,we){for(let Ie=0;Ie<we.length;Ie+=3)Mt.minX=Math.min(Mt.minX,we[Ie]),Mt.minY=Math.min(Mt.minY,we[Ie+1]),Mt.maxX=Math.max(Mt.maxX,we[Ie]),Mt.maxY=Math.max(Mt.maxY,we[Ie+1])}function on(Mt,we,Ie,qe){if(!we.geometry)return;const it=we.geometry.coordinates;if(it&&it.length===0)return;const Qe=we.geometry.type,mt=Math.pow(Ie.tolerance/((1<<Ie.maxZoom)*Ie.extent),2);let Rt=[],yt=we.id;if(Ie.promoteId?yt=we.properties[Ie.promoteId]:Ie.generateId&&(yt=qe||0),Qe==="Point")ct(it,Rt);else if(Qe==="MultiPoint")for(const Lt of it)ct(Lt,Rt);else if(Qe==="LineString")He(it,Rt,mt,!1);else if(Qe==="MultiLineString"){if(Ie.lineMetrics){for(const Lt of it)Rt=[],He(Lt,Rt,mt,!1),Mt.push(On(yt,"LineString",Rt,we.properties));return}qt(it,Rt,mt,!1)}else if(Qe==="Polygon")qt(it,Rt,mt,!0);else{if(Qe!=="MultiPolygon"){if(Qe==="GeometryCollection"){for(const Lt of we.geometry.geometries)on(Mt,{id:yt,geometry:Lt,properties:we.properties},Ie,qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Lt of it){const Gt=[];qt(Lt,Gt,mt,!0),Rt.push(Gt)}}Mt.push(On(yt,Qe,Rt,we.properties))}function ct(Mt,we){we.push(Tn(Mt[0]),An(Mt[1]),0)}function He(Mt,we,Ie,qe){let it,Qe,mt=0;for(let yt=0;yt<Mt.length;yt++){const Lt=Tn(Mt[yt][0]),Gt=An(Mt[yt][1]);we.push(Lt,Gt,0),yt>0&&(mt+=qe?(it*Gt-Lt*Qe)/2:Math.sqrt(Math.pow(Lt-it,2)+Math.pow(Gt-Qe,2))),it=Lt,Qe=Gt}const Rt=we.length-3;we[2]=1,At(we,0,Rt,Ie),we[Rt+2]=1,we.size=Math.abs(mt),we.start=0,we.end=we.size}function qt(Mt,we,Ie,qe){for(let it=0;it<Mt.length;it++){const Qe=[];He(Mt[it],Qe,Ie,qe),we.push(Qe)}}function Tn(Mt){return Mt/360+.5}function An(Mt){const we=Math.sin(Mt*Math.PI/180),Ie=.5-.25*Math.log((1+we)/(1-we))/Math.PI;return Ie<0?0:Ie>1?1:Ie}function Wt(Mt,we,Ie,qe,it,Qe,mt,Rt){if(qe/=we,Qe>=(Ie/=we)&&mt<qe)return Mt;if(mt<Ie||Qe>=qe)return null;const yt=[];for(const Lt of Mt){const Gt=Lt.geometry;let Ot=Lt.type;const cn=it===0?Lt.minX:Lt.minY,Cn=it===0?Lt.maxX:Lt.maxY;if(cn>=Ie&&Cn<qe){yt.push(Lt);continue}if(Cn<Ie||cn>=qe)continue;let En=[];if(Ot==="Point"||Ot==="MultiPoint")gr(Gt,En,Ie,qe,it);else if(Ot==="LineString")Gn(Gt,En,Ie,qe,it,!1,Rt.lineMetrics);else if(Ot==="MultiLineString")Ar(Gt,En,Ie,qe,it,!1);else if(Ot==="Polygon")Ar(Gt,En,Ie,qe,it,!0);else if(Ot==="MultiPolygon")for(const je of Gt){const bt=[];Ar(je,bt,Ie,qe,it,!0),bt.length&&En.push(bt)}if(En.length){if(Rt.lineMetrics&&Ot==="LineString"){for(const je of En)yt.push(On(Lt.id,Ot,je,Lt.tags));continue}Ot!=="LineString"&&Ot!=="MultiLineString"||(En.length===1?(Ot="LineString",En=En[0]):Ot="MultiLineString"),Ot!=="Point"&&Ot!=="MultiPoint"||(Ot=En.length===3?"Point":"MultiPoint"),yt.push(On(Lt.id,Ot,En,Lt.tags))}}return yt.length?yt:null}function gr(Mt,we,Ie,qe,it){for(let Qe=0;Qe<Mt.length;Qe+=3){const mt=Mt[Qe+it];mt>=Ie&&mt<=qe&&Dn(we,Mt[Qe],Mt[Qe+1],Mt[Qe+2])}}function Gn(Mt,we,Ie,qe,it,Qe,mt){let Rt=nr(Mt);const yt=it===0?sr:di;let Lt,Gt,Ot=Mt.start;for(let bt=0;bt<Mt.length-3;bt+=3){const Ct=Mt[bt],Et=Mt[bt+1],Pt=Mt[bt+2],Sn=Mt[bt+3],yn=Mt[bt+4],Un=it===0?Ct:Et,Xn=it===0?Sn:yn;let cr=!1;mt&&(Lt=Math.sqrt(Math.pow(Ct-Sn,2)+Math.pow(Et-yn,2))),Un<Ie?Xn>Ie&&(Gt=yt(Rt,Ct,Et,Sn,yn,Ie),mt&&(Rt.start=Ot+Lt*Gt)):Un>qe?Xn<qe&&(Gt=yt(Rt,Ct,Et,Sn,yn,qe),mt&&(Rt.start=Ot+Lt*Gt)):Dn(Rt,Ct,Et,Pt),Xn<Ie&&Un>=Ie&&(Gt=yt(Rt,Ct,Et,Sn,yn,Ie),cr=!0),Xn>qe&&Un<=qe&&(Gt=yt(Rt,Ct,Et,Sn,yn,qe),cr=!0),!Qe&&cr&&(mt&&(Rt.end=Ot+Lt*Gt),we.push(Rt),Rt=nr(Mt)),mt&&(Ot+=Lt)}let cn=Mt.length-3;const Cn=Mt[cn],En=Mt[cn+1],je=it===0?Cn:En;je>=Ie&&je<=qe&&Dn(Rt,Cn,En,Mt[cn+2]),cn=Rt.length-3,Qe&&cn>=3&&(Rt[cn]!==Rt[0]||Rt[cn+1]!==Rt[1])&&Dn(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&we.push(Rt)}function nr(Mt){const we=[];return we.size=Mt.size,we.start=Mt.start,we.end=Mt.end,we}function Ar(Mt,we,Ie,qe,it,Qe){for(const mt of Mt)Gn(mt,we,Ie,qe,it,Qe,!1)}function Dn(Mt,we,Ie,qe){Mt.push(we,Ie,qe)}function sr(Mt,we,Ie,qe,it,Qe){const mt=(Qe-we)/(qe-we);return Dn(Mt,Qe,Ie+(it-Ie)*mt,1),mt}function di(Mt,we,Ie,qe,it,Qe){const mt=(Qe-Ie)/(it-Ie);return Dn(Mt,we+(qe-we)*mt,Qe,1),mt}function zr(Mt,we){const Ie=[];for(let qe=0;qe<Mt.length;qe++){const it=Mt[qe],Qe=it.type;let mt;if(Qe==="Point"||Qe==="MultiPoint"||Qe==="LineString")mt=ar(it.geometry,we);else if(Qe==="MultiLineString"||Qe==="Polygon"){mt=[];for(const Rt of it.geometry)mt.push(ar(Rt,we))}else if(Qe==="MultiPolygon"){mt=[];for(const Rt of it.geometry){const yt=[];for(const Lt of Rt)yt.push(ar(Lt,we));mt.push(yt)}}Ie.push(On(it.id,Qe,mt,it.tags))}return Ie}function ar(Mt,we){const Ie=[];Ie.size=Mt.size,Mt.start!==void 0&&(Ie.start=Mt.start,Ie.end=Mt.end);for(let qe=0;qe<Mt.length;qe+=3)Ie.push(Mt[qe]+we,Mt[qe+1],Mt[qe+2]);return Ie}function Ur(Mt,we){if(Mt.transformed)return Mt;const Ie=1<<Mt.z,qe=Mt.x,it=Mt.y;for(const Qe of Mt.features){const mt=Qe.geometry,Rt=Qe.type;if(Qe.geometry=[],Rt===1)for(let yt=0;yt<mt.length;yt+=2)Qe.geometry.push(Wr(mt[yt],mt[yt+1],we,Ie,qe,it));else for(let yt=0;yt<mt.length;yt++){const Lt=[];for(let Gt=0;Gt<mt[yt].length;Gt+=2)Lt.push(Wr(mt[yt][Gt],mt[yt][Gt+1],we,Ie,qe,it));Qe.geometry.push(Lt)}}return Mt.transformed=!0,Mt}function Wr(Mt,we,Ie,qe,it,Qe){return[Math.round(Ie*(Mt*qe-it)),Math.round(Ie*(we*qe-Qe))]}function Si(Mt,we,Ie,qe,it){const Qe=we===it.maxZoom?0:it.tolerance/((1<<we)*it.extent),mt={features:[],numPoints:0,numSimplified:0,numFeatures:Mt.length,source:null,x:Ie,y:qe,z:we,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Rt of Mt)Ne(mt,Rt,Qe,it);return mt}function Ne(Mt,we,Ie,qe){const it=we.geometry,Qe=we.type,mt=[];if(Mt.minX=Math.min(Mt.minX,we.minX),Mt.minY=Math.min(Mt.minY,we.minY),Mt.maxX=Math.max(Mt.maxX,we.maxX),Mt.maxY=Math.max(Mt.maxY,we.maxY),Qe==="Point"||Qe==="MultiPoint")for(let Rt=0;Rt<it.length;Rt+=3)mt.push(it[Rt],it[Rt+1]),Mt.numPoints++,Mt.numSimplified++;else if(Qe==="LineString")Bt(mt,it,Mt,Ie,!1,!1);else if(Qe==="MultiLineString"||Qe==="Polygon")for(let Rt=0;Rt<it.length;Rt++)Bt(mt,it[Rt],Mt,Ie,Qe==="Polygon",Rt===0);else if(Qe==="MultiPolygon")for(let Rt=0;Rt<it.length;Rt++){const yt=it[Rt];for(let Lt=0;Lt<yt.length;Lt++)Bt(mt,yt[Lt],Mt,Ie,!0,Lt===0)}if(mt.length){let Rt=we.tags||null;if(Qe==="LineString"&&qe.lineMetrics){Rt={};for(const Lt in we.tags)Rt[Lt]=we.tags[Lt];Rt.mapbox_clip_start=it.start/it.size,Rt.mapbox_clip_end=it.end/it.size}const yt={geometry:mt,type:Qe==="Polygon"||Qe==="MultiPolygon"?3:Qe==="LineString"||Qe==="MultiLineString"?2:1,tags:Rt};we.id!==null&&(yt.id=we.id),Mt.features.push(yt)}}function Bt(Mt,we,Ie,qe,it,Qe){const mt=qe*qe;if(qe>0&&we.size<(it?mt:qe))return void(Ie.numPoints+=we.length/3);const Rt=[];for(let yt=0;yt<we.length;yt+=3)(qe===0||we[yt+2]>mt)&&(Ie.numSimplified++,Rt.push(we[yt],we[yt+1])),Ie.numPoints++;it&&function(yt,Lt){let Gt=0;for(let Ot=0,cn=yt.length,Cn=cn-2;Ot<cn;Cn=Ot,Ot+=2)Gt+=(yt[Ot]-yt[Cn])*(yt[Ot+1]+yt[Cn+1]);if(Gt>0===Lt)for(let Ot=0,cn=yt.length;Ot<cn/2;Ot+=2){const Cn=yt[Ot],En=yt[Ot+1];yt[Ot]=yt[cn-2-Ot],yt[Ot+1]=yt[cn-1-Ot],yt[cn-2-Ot]=Cn,yt[cn-1-Ot]=En}}(Rt,Qe),Mt.push(Rt)}const Jt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class hn{constructor(we,Ie){const qe=(Ie=this.options=function(Qe,mt){for(const Rt in mt)Qe[Rt]=mt[Rt];return Qe}(Object.create(Jt),Ie)).debug;if(qe&&console.time("preprocess data"),Ie.maxZoom<0||Ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ie.promoteId&&Ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let it=function(Qe,mt){const Rt=[];if(Qe.type==="FeatureCollection")for(let yt=0;yt<Qe.features.length;yt++)on(Rt,Qe.features[yt],mt,yt);else on(Rt,Qe.type==="Feature"?Qe:{geometry:Qe},mt);return Rt}(we,Ie);this.tiles={},this.tileCoords=[],qe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ie.indexMaxZoom,Ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),it=function(Qe,mt){const Rt=mt.buffer/mt.extent;let yt=Qe;const Lt=Wt(Qe,1,-1-Rt,Rt,0,-1,2,mt),Gt=Wt(Qe,1,1-Rt,2+Rt,0,-1,2,mt);return(Lt||Gt)&&(yt=Wt(Qe,1,-Rt,1+Rt,0,-1,2,mt)||[],Lt&&(yt=zr(Lt,1).concat(yt)),Gt&&(yt=yt.concat(zr(Gt,-1)))),yt}(it,Ie),it.length&&this.splitTile(it,0,0,0),qe&&(it.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(we,Ie,qe,it,Qe,mt,Rt){const yt=[we,Ie,qe,it],Lt=this.options,Gt=Lt.debug;for(;yt.length;){it=yt.pop(),qe=yt.pop(),Ie=yt.pop(),we=yt.pop();const Ot=1<<Ie,cn=In(Ie,qe,it);let Cn=this.tiles[cn];if(!Cn&&(Gt>1&&console.time("creation"),Cn=this.tiles[cn]=Si(we,Ie,qe,it,Lt),this.tileCoords.push({z:Ie,x:qe,y:it}),Gt)){Gt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ie,qe,it,Cn.numFeatures,Cn.numPoints,Cn.numSimplified),console.timeEnd("creation"));const cr=`z${Ie}`;this.stats[cr]=(this.stats[cr]||0)+1,this.total++}if(Cn.source=we,Qe==null){if(Ie===Lt.indexMaxZoom||Cn.numPoints<=Lt.indexMaxPoints)continue}else{if(Ie===Lt.maxZoom||Ie===Qe)continue;if(Qe!=null){const cr=Qe-Ie;if(qe!==mt>>cr||it!==Rt>>cr)continue}}if(Cn.source=null,we.length===0)continue;Gt>1&&console.time("clipping");const En=.5*Lt.buffer/Lt.extent,je=.5-En,bt=.5+En,Ct=1+En;let Et=null,Pt=null,Sn=null,yn=null,Un=Wt(we,Ot,qe-En,qe+bt,0,Cn.minX,Cn.maxX,Lt),Xn=Wt(we,Ot,qe+je,qe+Ct,0,Cn.minX,Cn.maxX,Lt);we=null,Un&&(Et=Wt(Un,Ot,it-En,it+bt,1,Cn.minY,Cn.maxY,Lt),Pt=Wt(Un,Ot,it+je,it+Ct,1,Cn.minY,Cn.maxY,Lt),Un=null),Xn&&(Sn=Wt(Xn,Ot,it-En,it+bt,1,Cn.minY,Cn.maxY,Lt),yn=Wt(Xn,Ot,it+je,it+Ct,1,Cn.minY,Cn.maxY,Lt),Xn=null),Gt>1&&console.timeEnd("clipping"),yt.push(Et||[],Ie+1,2*qe,2*it),yt.push(Pt||[],Ie+1,2*qe,2*it+1),yt.push(Sn||[],Ie+1,2*qe+1,2*it),yt.push(yn||[],Ie+1,2*qe+1,2*it+1)}}getTile(we,Ie,qe){we=+we,Ie=+Ie,qe=+qe;const it=this.options,{extent:Qe,debug:mt}=it;if(we<0||we>24)return null;const Rt=1<<we,yt=In(we,Ie=Ie+Rt&Rt-1,qe);if(this.tiles[yt])return Ur(this.tiles[yt],Qe);mt>1&&console.log("drilling down to z%d-%d-%d",we,Ie,qe);let Lt,Gt=we,Ot=Ie,cn=qe;for(;!Lt&&Gt>0;)Gt--,Ot>>=1,cn>>=1,Lt=this.tiles[In(Gt,Ot,cn)];return Lt&&Lt.source?(mt>1&&(console.log("found parent tile z%d-%d-%d",Gt,Ot,cn),console.time("drilling down")),this.splitTile(Lt.source,Gt,Ot,cn,we,Ie,qe),mt>1&&console.timeEnd("drilling down"),this.tiles[yt]?Ur(this.tiles[yt],Qe):null):null}}function In(Mt,we,Ie){return 32*((1<<Mt)*Ie+we)+Mt}function Tr(Mt,we){const Ie=Mt.tileID.canonical;if(!this._geoJSONIndex)return void we(null,null);const qe=this._geoJSONIndex.getTile(Ie.z,Ie.x,Ie.y);if(!qe)return void we(null,null);const it=new Z(qe.features);let Qe=vt(it);Qe.byteOffset===0&&Qe.byteLength===Qe.buffer.byteLength||(Qe=new Uint8Array(Qe)),we(null,{vectorTile:it,rawData:Qe.buffer})}class jr extends C{constructor(we,Ie,qe,it,Qe,mt){super(we,Ie,qe,it,Tr,mt),Qe&&(this.loadGeoJSON=Qe),this._dynamicIndex=new se}loadData(we,Ie){const qe=we&&we.request,it=qe&&qe.collectResourceTiming;this.loadGeoJSON(we,(Qe,mt)=>{if(Qe||!mt)return Ie(Qe);if(typeof mt!="object")return Ie(new Error(`Input data given to '${we.source}' is not a valid GeoJSON object.`));{try{if(we.filter){const yt=a.M(we.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(yt.result==="error")throw new Error(yt.value.map(Lt=>`${Lt.key}: ${Lt.message}`).join(", "));mt.features=mt.features.filter(Lt=>yt.value.evaluate({zoom:0},Lt))}we.dynamic?(mt.type==="Feature"&&(mt={type:"FeatureCollection",features:[mt]}),we.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(mt.features,this.loaded),we.cluster&&(mt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=we.cluster?new kn(function({superclusterOptions:yt,clusterProperties:Lt}){if(!Lt||!yt)return yt;const Gt={},Ot={},cn={accumulated:null,zoom:0},Cn={properties:null},En=Object.keys(Lt);for(const je of En){const[bt,Ct]=Lt[je],Et=a.M(Ct),Pt=a.M(typeof bt=="string"?[bt,["accumulated"],["get",je]]:bt);Gt[je]=Et.value,Ot[je]=Pt.value}return yt.map=je=>{Cn.properties=je;const bt={};for(const Ct of En)bt[Ct]=Gt[Ct].evaluate(cn,Cn);return bt},yt.reduce=(je,bt)=>{Cn.properties=bt;for(const Ct of En)cn.accumulated=je[Ct],je[Ct]=Ot[Ct].evaluate(cn,Cn)},yt}(we)).load(mt.features):we.dynamic?this._dynamicIndex:function(yt,Lt){return new hn(yt,Lt)}(mt,we.geojsonVtOptions)}catch(yt){return Ie(yt)}const Rt={};if(it){const yt=d(qe);yt&&(Rt.resourceTiming={},Rt.resourceTiming[we.source]=JSON.parse(JSON.stringify(yt)))}Ie(null,Rt)}})}reloadTile(we,Ie){const qe=this.loaded;return qe&&qe[we.uid]?we.partial?Ie(null,void 0):super.reloadTile(we,Ie):this.loadTile(we,Ie)}loadGeoJSON(we,Ie){if(we.request)a.n(we.request,Ie);else{if(typeof we.data!="string")return Ie(new Error(`Input data given to '${we.source}' is not a valid GeoJSON object.`));try{return Ie(null,JSON.parse(we.data))}catch{return Ie(new Error(`Input data given to '${we.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(we,Ie){try{Ie(null,this._geoJSONIndex.getClusterExpansionZoom(we.clusterId))}catch(qe){Ie(qe)}}getClusterChildren(we,Ie){try{Ie(null,this._geoJSONIndex.getChildren(we.clusterId))}catch(qe){Ie(qe)}}getClusterLeaves(we,Ie){try{Ie(null,this._geoJSONIndex.getLeaves(we.clusterId,we.limit,we.offset))}catch(qe){Ie(qe)}}}class ps{constructor(we,Ie){this.tileID=new a.aA(we.tileID.overscaledZ,we.tileID.wrap,we.tileID.canonical.z,we.tileID.canonical.x,we.tileID.canonical.y),this.tileZoom=we.tileZoom,this.uid=we.uid,this.zoom=we.zoom,this.canonical=we.tileID.canonical,this.pixelRatio=we.pixelRatio,this.tileSize=we.tileSize,this.source=we.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=we.projection,this.brightness=Ie}parse(we,Ie,qe,it){this.status="parsing";const Qe=new a.aA(qe.tileID.overscaledZ,qe.tileID.wrap,qe.tileID.canonical.z,qe.tileID.canonical.x,qe.tileID.canonical.y),mt={},Rt=Ie.familiesBySource[qe.source],yt=new a.dR(Qe,qe.promoteId);return yt.bucketLayerIDs=[],yt.is3DTile=!0,a.e0(we).then(Lt=>{if(!Lt)return it(new Error("Could not parse tile"));const Gt=a.e1(Lt,1/a.c8(qe.tileID.canonical)),Ot=Lt.json.extensionsUsed&&Lt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Lt.json.asset.extras&&Lt.json.asset.extras.MAPBOX_mesh_features,cn=Lt.json.extensionsUsed&&Lt.json.extensionsUsed.includes("EXT_meshopt_compression"),Cn=new a.a3(this.zoom,{brightness:this.brightness});for(const En in Rt)for(const je of Rt[En]){const bt=je[0];yt.bucketLayerIDs.push(je.map(Et=>Et.id)),bt.recalculate(Cn,[]);const Ct=new a.e2(Gt,Qe,Ot,cn,this.brightness,yt);Ot||(Ct.needsUpload=!0),mt[bt.fqid]=Ct,Ct.evaluate(bt)}this.status="done",it(null,{buckets:mt,featureIndex:yt})}).catch(Lt=>it(new Error(Lt.message)))}}class Bs{constructor(we,Ie,qe,it,Qe,mt){this.actor=we,this.layerIndex=Ie,this.brightness=mt,this.loading={},this.loaded={}}loadTile(we,Ie){const qe=we.uid,it=this.loading[qe]=new ps(we,this.brightness);a.bc(we.request,(Qe,mt)=>{const Rt=!this.loading[qe];return delete this.loading[qe],Rt||Qe?(it.status="done",Rt||(this.loaded[qe]=it),Ie(Qe)):mt&&mt.byteLength!==0?void it.parse(mt,this.layerIndex,we,(yt,Lt)=>{it.status="done",this.loaded=this.loaded||{},this.loaded[qe]=it,yt||!Lt?Ie(yt):Ie(null,Lt)}):(it.status="done",this.loaded[qe]=it,Ie())})}reloadTile(we,Ie){const qe=this.loaded,it=we.uid;if(qe&&qe[it]){const Qe=qe[it];Qe.projection=we.projection,Qe.brightness=we.brightness;const mt=(Rt,yt)=>{Qe.reloadCallback&&(delete Qe.reloadCallback,this.loadTile(we,Ie)),Ie(Rt,yt)};Qe.status==="parsing"?Qe.reloadCallback=mt:Qe.status==="done"&&this.loadTile(we,Ie)}}abortTile(we,Ie){const qe=we.uid;this.loading[qe]&&delete this.loading[qe],Ie()}removeTile(we,Ie){const qe=this.loaded,it=we.uid;qe&&qe[it]&&delete qe[it],Ie()}}class fi{constructor(we){this.self=we,this.actor=new a.e3(we,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.bL({name:"mercator"}),this.workerSourceTypes={vector:C,geojson:jr,"batched-model":Bs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ie,qe)=>{if(this.workerSourceTypes[Ie])throw new Error(`Worker source with name "${Ie}" already registered.`);this.workerSourceTypes[Ie]=qe},this.self.registerRTLTextPlugin=Ie=>{if(a.e4.isParsed())throw new Error("RTL text plugin already registered.");a.e4.applyArabicShaping=Ie.applyArabicShaping,a.e4.processBidirectionalText=Ie.processBidirectionalText,a.e4.processStyledBidirectionalText=Ie.processStyledBidirectionalText}}clearCaches(we,Ie,qe){delete this.layerIndexes[we],delete this.availableImages[we],delete this.workerSources[we],delete this.demWorkerSources[we],delete this.rasterArrayWorkerSource,qe()}checkIfReady(we,Ie,qe){qe()}setReferrer(we,Ie){this.referrer=Ie}spriteLoaded(we,{scope:Ie,isLoaded:qe}){if(this.isSpriteLoaded[we]||(this.isSpriteLoaded[we]={}),this.isSpriteLoaded[we][Ie]=qe,this.workerSources[we]&&this.workerSources[we][Ie])for(const it in this.workerSources[we][Ie]){const Qe=this.workerSources[we][Ie][it];for(const mt in Qe){const Rt=Qe[mt];Rt instanceof C&&(Rt.isSpriteLoaded=qe,Rt.fire(new a.x("isSpriteLoaded")))}}}setImages(we,{scope:Ie,images:qe},it){if(this.availableImages[we]||(this.availableImages[we]={}),this.availableImages[we][Ie]=qe,this.workerSources[we]&&this.workerSources[we][Ie]){for(const Qe in this.workerSources[we][Ie]){const mt=this.workerSources[we][Ie][Qe];for(const Rt in mt)mt[Rt].availableImages=qe}it()}else it()}setProjection(we,Ie){this.projections[we]=a.bL(Ie)}setBrightness(we,Ie,qe){this.brightness=Ie,qe()}setLayers(we,Ie,qe){this.getLayerIndex(we,Ie.scope).replace(Ie.layers,Ie.options),qe()}updateLayers(we,Ie,qe){this.getLayerIndex(we,Ie.scope).update(Ie.layers,Ie.removedIds,Ie.options),qe()}loadTile(we,Ie,qe){Ie.projection=this.projections[we]||this.defaultProjection,this.getWorkerSource(we,Ie.type,Ie.source,Ie.scope).loadTile(Ie,qe)}loadDEMTile(we,Ie,qe){this.getDEMWorkerSource(we,Ie.source,Ie.scope).loadTile(Ie,qe)}decodeRasterArray(we,Ie,qe){this.getRasterArrayWorkerSource().decodeRasterArray(Ie,qe)}reloadTile(we,Ie,qe){Ie.projection=this.projections[we]||this.defaultProjection,this.getWorkerSource(we,Ie.type,Ie.source,Ie.scope).reloadTile(Ie,qe)}abortTile(we,Ie,qe){this.getWorkerSource(we,Ie.type,Ie.source,Ie.scope).abortTile(Ie,qe)}removeTile(we,Ie,qe){this.getWorkerSource(we,Ie.type,Ie.source,Ie.scope).removeTile(Ie,qe)}removeSource(we,Ie,qe){if(!(this.workerSources[we]&&this.workerSources[we][Ie.scope]&&this.workerSources[we][Ie.scope][Ie.type]&&this.workerSources[we][Ie.scope][Ie.type][Ie.source]))return;const it=this.workerSources[we][Ie.scope][Ie.type][Ie.source];delete this.workerSources[we][Ie.scope][Ie.type][Ie.source],it.removeSource!==void 0?it.removeSource(Ie,qe):qe()}loadWorkerSource(we,Ie,qe){try{this.self.importScripts(Ie.url),qe()}catch(it){qe(it.toString())}}syncRTLPluginState(we,Ie,qe){try{a.e4.setState(Ie);const it=a.e4.getPluginURL();if(a.e4.isLoaded()&&!a.e4.isParsed()&&it!=null){this.self.importScripts(it);const Qe=a.e4.isParsed();qe(Qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${it}`),Qe)}}catch(it){qe(it.toString())}}setDracoUrl(we,Ie){this.dracoUrl=Ie}getAvailableImages(we,Ie){this.availableImages[we]||(this.availableImages[we]={});let qe=this.availableImages[we][Ie];return qe||(qe=[]),qe}getLayerIndex(we,Ie){this.layerIndexes[we]||(this.layerIndexes[we]={});let qe=this.layerIndexes[we][Ie];return qe||(qe=this.layerIndexes[we][Ie]=new _,qe.scope=Ie),qe}getWorkerSource(we,Ie,qe,it){return this.workerSources[we]||(this.workerSources[we]={}),this.workerSources[we][it]||(this.workerSources[we][it]={}),this.workerSources[we][it][Ie]||(this.workerSources[we][it][Ie]={}),this.isSpriteLoaded[we]||(this.isSpriteLoaded[we]={}),this.workerSources[we][it][Ie][qe]||(this.workerSources[we][it][Ie][qe]=new this.workerSourceTypes[Ie]({send:(Qe,mt,Rt,yt,Lt,Gt)=>{this.actor.send(Qe,mt,Rt,we,Lt,Gt)},scheduler:this.actor.scheduler},this.getLayerIndex(we,it),this.getAvailableImages(we,it),this.isSpriteLoaded[we][it],void 0,this.brightness)),this.workerSources[we][it][Ie][qe]}getDEMWorkerSource(we,Ie,qe){return this.demWorkerSources[we]||(this.demWorkerSources[we]={}),this.demWorkerSources[we][qe]||(this.demWorkerSources[we][qe]={}),this.demWorkerSources[we][qe][Ie]||(this.demWorkerSources[we][qe][Ie]=new L),this.demWorkerSources[we][qe][Ie]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new O),this.rasterArrayWorkerSource}enforceCacheSizeLimit(we,Ie){a.e5(Ie)}getWorkerPerformanceMetrics(we,Ie,qe){qe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new fi(self)),fi}),l(["./shared"],function(a){var d="3.7.0";const f={create:"create",load:"load",fullLoad:"fullLoad"},m={mark(w){performance.mark(w)},measure(w,h,g){performance.measure(w,h,g)}};function _(w){const h=w.name.split("?")[0];return a.a(h)&&h.includes("mapbox-gl.js")?"javascript":a.a(h)&&h.includes("mapbox-gl.css")?"css":a.b(h)?"fontRange":a.c(h)?"sprite":a.i(h)?"style":a.d(h)?"tilejson":"other"}var x,A={},I=function(){if(x)return A;function w(S){return!h(S)}function h(S){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var D,N,$=new Blob([""],{type:"text/javascript"}),Y=URL.createObjectURL($);try{N=new Worker(Y),D=!0}catch{D=!1}return N&&N.terminate(),URL.revokeObjectURL(Y),D}()?function(){var D=document.createElement("canvas");D.width=D.height=1;var N=D.getContext("2d");if(!N)return!1;var $=N.getImageData(0,0,1,1);return $&&$.width===D.width}()?(g[P=S&&S.failIfMajorPerformanceCaveat]===void 0&&(g[P]=function(D){var N,$=function(Y){var ee=document.createElement("canvas"),te=Object.create(w.webGLContextAttributes);return te.failIfMajorPerformanceCaveat=Y,ee.getContext("webgl2",te)}(D);if(!$)return!1;try{N=$.createShader($.VERTEX_SHADER)}catch{return!1}return!(!N||$.isContextLost())&&($.shaderSource(N,"void main() {}"),$.compileShader(N),$.getShaderParameter(N,$.COMPILE_STATUS)===!0)}(P)),g[P]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var P}x=1,A.supported=w,A.notSupportedReason=h;var g={};return w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},A}();function E(w,h,g){const S=document.createElement(w);return h!=null&&(S.className=h),g&&g.appendChild(S),S}function C(w,h,g){const S=document.createElementNS("http://www.w3.org/2000/svg",w);for(const P of Object.keys(h))S.setAttributeNS(null,P,String(h[P]));return g&&g.appendChild(S),S}const L=typeof document<"u"?document.documentElement&&document.documentElement.style:null,O=L&&L.userSelect!==void 0?"userSelect":"WebkitUserSelect";let H;function q(){L&&O&&(H=L[O],L[O]="none")}function Z(){L&&O&&(L[O]=H)}function J(w){w.preventDefault(),w.stopPropagation(),window.removeEventListener("click",J,!0)}function re(){window.addEventListener("click",J,!0),window.setTimeout(()=>{window.removeEventListener("click",J,!0)},0)}function se(w,h){const g=w.getBoundingClientRect();return Ae(w,g,h)}function ae(w,h){const g=w.getBoundingClientRect(),S=[];for(let P=0;P<h.length;P++)S.push(Ae(w,g,h[P]));return S}function he(w){return window.InstallTrigger!==void 0&&w.button===2&&w.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button}function Ae(w,h,g){const S=w.offsetWidth===h.width?1:w.offsetWidth/h.width;return new a.P((g.clientX-h.left)*S,(g.clientY-h.top)*S)}const Ee="01",Pe="NO_ACCESS_TOKEN";class ze{constructor(h,g,S){this._transformRequestFn=h,this._customAccessToken=g,this._silenceAuthErrors=!!S,this._createSkuToken()}_createSkuToken(){const h=function(){let g="";for(let S=0;S<10;S++)g+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ee,g].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=h.token,this._skuTokenExpiresAt=h.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(h,g){return this._transformRequestFn&&this._transformRequestFn(h,g)||{url:h}}normalizeStyleURL(h,g){if(!a.f(h))return h;const S=rt(h);return S.params.push(`sdk=js-${d}`),S.path=`/styles/v1${S.path}`,this._makeAPIURL(S,this._customAccessToken||g)}normalizeGlyphsURL(h,g){if(!a.f(h))return h;const S=rt(h);return S.path=`/fonts/v1${S.path}`,this._makeAPIURL(S,this._customAccessToken||g)}normalizeModelURL(h,g){if(!a.f(h))return h;const S=rt(h);return S.path=`/models/v1${S.path}`,this._makeAPIURL(S,this._customAccessToken||g)}normalizeSourceURL(h,g,S,P){if(!a.f(h))return h;const D=rt(h);return D.path=`/v4/${D.authority}.json`,D.params.push("secure"),S&&D.params.push(`language=${S}`),P&&D.params.push(`worldview=${P}`),this._makeAPIURL(D,this._customAccessToken||g)}normalizeSpriteURL(h,g,S,P){const D=rt(h);return a.f(h)?(D.path=`/styles/v1${D.path}/sprite${g}${S}`,this._makeAPIURL(D,this._customAccessToken||P)):(D.path+=`${g}${S}`,ye(D))}normalizeTileURL(h,g,S){if(this._isSkuTokenExpired()&&this._createSkuToken(),h&&!a.f(h))return h;const P=rt(h);P.path=P.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${g||S&&P.authority!=="raster"&&S===512?"@2x":""}${a.m.supported?".webp":"$1"}`),P.authority==="raster"?P.path=`/${a.e.RASTER_URL_PREFIX}${P.path}`:P.authority==="rasterarrays"?P.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${P.path}`:P.authority==="3dtiles"?P.path=`/${a.e.TILES3D_URL_PREFIX}${P.path}`:(P.path=P.path.replace(/^.+\/v4\//,"/"),P.path=`/${a.e.TILE_URL_VERSION}${P.path}`);const D=this._customAccessToken||function(N){for(const $ of N){const Y=$.match(/^access_token=(.*)$/);if(Y)return Y[1]}return null}(P.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&D&&this._skuToken&&P.params.push(`sku=${this._skuToken}`),this._makeAPIURL(P,D)}canonicalizeTileURL(h,g){const S=rt(h);if(!S.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!S.path.match(/\.[\w]+$/))return h;let P="mapbox://";S.path.match(/^\/raster\/v1\//)?P+=`raster/${S.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:S.path.match(/^\/rasterarrays\/v1\//)?P+=`rasterarrays/${S.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:P+=`tiles/${S.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let D=S.params;return g&&(D=D.filter(N=>!N.match(/^access_token=/))),D.length&&(P+=`?${D.join("&")}`),P}canonicalizeTileset(h,g){const S=!!g&&a.f(g),P=[];for(const D of h.tiles||[])a.h(D)?P.push(this.canonicalizeTileURL(D,S)):P.push(D);return P}_makeAPIURL(h,g){const S="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",P=rt(a.e.API_URL);if(h.protocol=P.protocol,h.authority=P.authority,h.protocol==="http"){const D=h.params.indexOf("secure");D>=0&&h.params.splice(D,1)}if(P.path!=="/"&&(h.path=`${P.path}${h.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return ye(h);if(g=g||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!g)throw new Error(`An API access token is required to use Mapbox GL. ${S}`);if(g[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${S}`)}return h.params=h.params.filter(D=>D.indexOf("access_token")===-1),h.params.push(`access_token=${g||""}`),ye(h)}}const Re=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function rt(w){const h=w.match(Re);if(!h)throw new Error("Unable to parse URL object");return{protocol:h[1],authority:h[2],path:h[3]||"/",params:h[4]?h[4].split("&"):[]}}function ye(w){const h=w.params.length?`?${w.params.join("&")}`:"";return`${w.protocol}://${w.authority}${w.path}${h}`}const We="mapbox.eventData";function Ue(w){if(!w)return null;const h=w.split(".");if(!h||h.length!==3)return null;try{return JSON.parse(a.j(h[1]))}catch{return null}}class gt{constructor(h){this.type=h,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(h){const g=Ue(a.e.ACCESS_TOKEN);let S="";return S=g&&g.u?a.k(g.u):a.e.ACCESS_TOKEN||"",h?`${We}.${h}:${S}`:`${We}:${S}`}fetchEventData(){const h=a.s("localStorage"),g=this.getStorageKey(),S=this.getStorageKey("uuid");if(h)try{const P=localStorage.getItem(g);P&&(this.eventData=JSON.parse(P));const D=localStorage.getItem(S);D&&(this.anonId=D)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const h=a.s("localStorage"),g=this.getStorageKey(),S=this.getStorageKey("uuid"),P=this.anonId;if(h&&P)try{localStorage.setItem(S,P),Object.keys(this.eventData).length>=1&&localStorage.setItem(g,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(h){}postEvent(h,g,S,P){if(!a.e.EVENTS_URL)return;const D=rt(a.e.EVENTS_URL);D.params.push(`access_token=${P||a.e.ACCESS_TOKEN||""}`);const N={event:this.type,created:new Date(h).toISOString()},$=g?a.l(N,g):N,Y={url:ye(D),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$])};this.pendingRequest=a.p(Y,ee=>{this.pendingRequest=null,S(ee),this.saveEventData(),this.processRequests(P)})}queueRequest(h,g){this.queue.push(h),this.processRequests(g)}}const vt=new class extends gt{constructor(w){super("appUserTurnstile"),this._customAccessToken=w}postTurnstileEvent(w,h){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(w)&&w.some(g=>a.f(g)||a.h(g))&&this.queueRequest(Date.now(),h)}processRequests(w){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const h=Ue(a.e.ACCESS_TOKEN),g=h?h.u:a.e.ACCESS_TOKEN;let S=g!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),S=!0);const P=this.queue.shift();if(this.eventData.lastSuccess){const D=new Date(this.eventData.lastSuccess),N=new Date(P),$=(P-this.eventData.lastSuccess)/864e5;S=S||$>=1||$<-1||D.getDate()!==N.getDate()}else S=!0;S?this.postEvent(P,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:Ee,"enabled.telemetry":!1,userId:this.anonId},D=>{D||(this.eventData.lastSuccess=P,this.eventData.tokenU=g)},w):this.processRequests()}},Dt=vt.postTurnstileEvent.bind(vt),lt=new class extends gt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(w,h,g,S){this.skuToken=h,this.errorCb=S,a.e.EVENTS_URL&&(g||a.e.ACCESS_TOKEN?this.queueRequest({id:w,timestamp:Date.now()},g):this.errorCb(new Error(Pe)))}processRequests(w){if(this.pendingRequest||this.queue.length===0)return;const{id:h,timestamp:g}=this.queue.shift();h&&this.success[h]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:Ee,skuToken:this.skuToken,userId:this.anonId},S=>{S?this.errorCb(S):h&&(this.success[h]=!0)},w))}remove(){this.errorCb=null}},jt=lt.postMapLoadEvent.bind(lt),Qt=new class extends gt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(w){let h=this.mapInstanceIdMap.get(w);return h||(h=a.u(),this.mapInstanceIdMap.set(w,h)),h}getEventId(w){const h=this.eventIdPerMapInstanceMap.get(w)||0;return this.eventIdPerMapInstanceMap.set(w,h+1),h}postStyleLoadEvent(w,h){const{map:g,style:S,importedStyles:P}=h;if(!a.e.EVENTS_URL||!w&&!a.e.ACCESS_TOKEN)return;const D=this.getMapInstanceId(g),N={mapInstanceId:D,eventId:this.getEventId(D),style:S};P.length&&(N.importedStyles=P),this.queueRequest({timestamp:Date.now(),payload:N},w)}processRequests(w){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:h,payload:g}=this.queue.shift();this.postEvent(h,g,()=>{},w)}},nn=Qt.postStyleLoadEvent.bind(Qt),Wn=new class extends gt{constructor(){super("gljs.performance")}postPerformanceEvent(w,h){a.e.EVENTS_URL&&(w||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:h},w)}processRequests(w){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:h,performanceData:g}=this.queue.shift(),S=function(P){const D=performance.getEntriesByType("resource"),N=performance.getEntriesByType("mark"),$=function(de){const xe={};if(de){for(const be in de)if(be!=="other")for(const Se of de[be]){const Te=`${be}ResolveRangeMin`,Oe=`${be}ResolveRangeMax`,Ge=`${be}RequestCount`,Be=`${be}RequestCachedCount`;xe[Te]=Math.min(xe[Te]||1/0,Se.startTime),xe[Oe]=Math.max(xe[Oe]||-1/0,Se.responseEnd);const Xe=$e=>{xe[$e]===void 0&&(xe[$e]=0),++xe[$e]};Se.transferSize!==void 0&&Se.transferSize===0&&Xe(Be),Xe(Ge)}}return xe}(function(de,xe){const be={};if(de)for(const Se of de){const Te=xe(Se);be[Te]===void 0&&(be[Te]=[]),be[Te].push(Se)}return be}(D,_)),Y=window.devicePixelRatio,ee=navigator.connection||navigator.mozConnection||navigator.webkitConnection,te=ee?ee.effectiveType:void 0,le={counters:[],metadata:[],attributes:[]},ce=(de,xe,be)=>{be!=null&&de.push({name:xe,value:be.toString()})};for(const de in $)ce(le.counters,de,$[de]);if(P.interactionRange[0]!==1/0&&P.interactionRange[1]!==-1/0&&(ce(le.counters,"interactionRangeMin",P.interactionRange[0]),ce(le.counters,"interactionRangeMax",P.interactionRange[1])),N)for(const de of Object.keys(f)){const xe=f[de],be=N.find(Se=>Se.name===xe);be&&ce(le.counters,xe,be.startTime)}return ce(le.counters,"visibilityHidden",P.visibilityHidden),ce(le.attributes,"style",function(de){if(de)for(const xe of de){const be=xe.name.split("?")[0];if(a.i(be)){const Se=be.split("/").slice(-2);if(Se.length===2)return`mapbox://styles/${Se[0]}/${Se[1]}`}}}(D)),ce(le.attributes,"terrainEnabled",P.terrainEnabled?"true":"false"),ce(le.attributes,"fogEnabled",P.fogEnabled?"true":"false"),ce(le.attributes,"projection",P.projection),ce(le.attributes,"zoom",P.zoom),ce(le.metadata,"devicePixelRatio",Y),ce(le.metadata,"connectionEffectiveType",te),ce(le.metadata,"navigatorUserAgent",navigator.userAgent),ce(le.metadata,"screenWidth",window.screen.width),ce(le.metadata,"screenHeight",window.screen.height),ce(le.metadata,"windowWidth",window.innerWidth),ce(le.metadata,"windowHeight",window.innerHeight),ce(le.metadata,"mapWidth",P.width/Y),ce(le.metadata,"mapHeight",P.height/Y),ce(le.metadata,"webglRenderer",P.renderer),ce(le.metadata,"webglVendor",P.vendor),ce(le.metadata,"sdkVersion",d),ce(le.metadata,"sdkIdentifier","mapbox-gl-js"),le}(g);for(const P of S.metadata);for(const P of S.counters);for(const P of S.attributes);this.postEvent(h,S,()=>{},w)}},kn=Wn.postPerformanceEvent.bind(Wn),Mn=new class extends gt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(w,h,g,S){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const P=rt(a.e.API_URL+a.e.SESSION_PATH);P.params.push(`sku=${h||""}`),P.params.push(`access_token=${S||a.e.ACCESS_TOKEN||""}`);const D={url:ye(P),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(D,N=>{this.pendingRequest=null,g(N),this.saveEventData(),this.processRequests(S)})}getSessionAPI(w,h,g,S){this.skuToken=h,this.errorCb=S,a.e.SESSION_PATH&&a.e.API_URL&&(g||a.e.ACCESS_TOKEN?this.queueRequest({id:w,timestamp:Date.now()},g):this.errorCb(new Error(Pe)))}processRequests(w){if(this.pendingRequest||this.queue.length===0)return;const{id:h,timestamp:g}=this.queue.shift();h&&this.success[h]||this.getSession(g,this.skuToken,S=>{S?this.errorCb(S):h&&(this.success[h]=!0)},w)}remove(){this.errorCb=null}},De=Mn.getSessionAPI.bind(Mn),Ye=new Set;function gn(w,h){h?Ye.add(w):Ye.delete(w)}class un{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(h,g){this._updatedSourceCaches[h]=g,this.setDirty()}discardSourceCacheUpdate(h){delete this._updatedSourceCaches[h]}updateLayer(h){const g=h.scope;this._updatedLayers[g]=this._updatedLayers[g]||new Set,this._updatedLayers[g].add(h.id),this.setDirty()}removeLayer(h){const g=h.scope;this._removedLayers[g]=this._removedLayers[g]||{},this._updatedLayers[g]=this._updatedLayers[g]||new Set,this._removedLayers[g][h.id]=h,this._updatedLayers[g].delete(h.id),this._updatedPaintProps.delete(h.fqid),this.setDirty()}getRemovedLayer(h){return this._removedLayers[h.scope]?this._removedLayers[h.scope][h.id]:null}discardLayerRemoval(h){this._removedLayers[h.scope]&&delete this._removedLayers[h.scope][h.id]}getLayerUpdatesByScope(){const h={};for(const g in this._updatedLayers)h[g]=h[g]||{},h[g].updatedIds=Array.from(this._updatedLayers[g].values());for(const g in this._removedLayers)h[g]=h[g]||{},h[g].removedIds=Object.keys(this._removedLayers[g]);return h}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(h){this._updatedPaintProps.add(h.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(h){this._updatedImages.add(h),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function At(w){const{userImage:h}=w;return!!(h&&h.render&&h.render())&&(w.data.replace(new Uint8Array(h.data.buffer)),!0)}class en extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(h){this.images[h]={},this.loaded[h]=!1,this.updatedImages[h]={},this.patterns[h]={},this.callbackDispatchedThisFrame[h]={},this.atlasImage[h]=new a.r({width:1,height:1})}isLoaded(){for(const h in this.loaded)if(!this.loaded[h])return!1;return!0}setLoaded(h,g){if(this.loaded[g]!==h&&(this.loaded[g]=h,h)){for(const{ids:S,callback:P}of this.requestors)this._notify(S,g,P);this.requestors=[]}}hasImage(h,g){return!!this.getImage(h,g)}getImage(h,g){return this.images[g][h]}addImage(h,g,S){this._validate(h,S)&&(this.images[g][h]=S)}_validate(h,g){let S=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new a.t(new Error(`Image "${h}" has invalid "stretchX" value`))),S=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new a.t(new Error(`Image "${h}" has invalid "stretchY" value`))),S=!1),this._validateContent(g.content,g)||(this.fire(new a.t(new Error(`Image "${h}" has invalid "content" value`))),S=!1),S}_validateStretch(h,g){if(!h)return!0;let S=0;for(const P of h){if(P[0]<S||P[1]<P[0]||g<P[1])return!1;S=P[1]}return!0}_validateContent(h,g){return!(h&&(h.length!==4||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,g,S){S.version=this.images[g][h].version+1,this.images[g][h]=S,this.updatedImages[g][h]=!0}removeImage(h,g){const S=this.images[g][h];delete this.images[g][h],delete this.patterns[g][h],S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(h){return Object.keys(this.images[h])}getImages(h,g,S){let P=!0;const D=!!this.loaded[g];if(!D)for(const N of h)this.images[g][N]||(P=!1);D||P?this._notify(h,g,S):this.requestors.push({ids:h,scope:g,callback:S})}getUpdatedImages(h){return this.updatedImages[h]}_notify(h,g,S){const P={};for(const D of h){this.images[g][D]||this.fire(new a.x("styleimagemissing",{id:D}));const N=this.images[g][D];N?P[D]={data:N.data.clone(),pixelRatio:N.pixelRatio,sdf:N.sdf,version:N.version,stretchX:N.stretchX,stretchY:N.stretchY,content:N.content,hasRenderCallback:!!(N.userImage&&N.userImage.render)}:a.w(`Image "${D}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}S(null,P)}getPixelSize(h){const{width:g,height:S}=this.atlasImage[h];return{width:g,height:S}}getPattern(h,g,S){const P=this.patterns[g][h],D=this.getImage(h,g);if(!D)return null;if(P&&P.position.version===D.version)return P.position;if(P)P.position.version=D.version;else{const N={w:D.data.width+2*a.y,h:D.data.height+2*a.y,x:0,y:0},$=new a.I(N,D,a.y);this.patterns[g][h]={bin:N,position:$}}return this._updatePatternAtlas(g,S),this.patterns[g][h].position}bind(h,g){const S=h.gl;let P=this.atlasTexture[g];P?this.dirty&&(P.update(this.atlasImage[g]),this.dirty=!1):(P=new a.T(h,this.atlasImage[g],S.RGBA8),this.atlasTexture[g]=P),P.bind(S.LINEAR,S.CLAMP_TO_EDGE)}_updatePatternAtlas(h,g){const S=[];for(const $ in this.patterns[h])S.push(this.patterns[h][$].bin);const{w:P,h:D}=a.z(S),N=this.atlasImage[h];N.resize({width:P||1,height:D||1});for(const $ in this.patterns[h]){const{bin:Y,position:ee}=this.patterns[h][$];let te=ee.padding;const le=Y.x+te,ce=Y.y+te,de=this.images[h][$].data,xe=de.width,be=de.height;te=te>1?te-1:te,a.r.copy(de,N,{x:0,y:0},{x:le,y:ce},{width:xe,height:be},g),a.r.copy(de,N,{x:0,y:be-te},{x:le,y:ce-te},{width:xe,height:te},g),a.r.copy(de,N,{x:0,y:0},{x:le,y:ce+be},{width:xe,height:te},g),a.r.copy(de,N,{x:xe-te,y:0},{x:le-te,y:ce},{width:te,height:be},g),a.r.copy(de,N,{x:0,y:0},{x:le+xe,y:ce},{width:te,height:be},g),a.r.copy(de,N,{x:xe-te,y:be-te},{x:le-te,y:ce-te},{width:te,height:te},g),a.r.copy(de,N,{x:0,y:be-te},{x:le+xe,y:ce-te},{width:te,height:te},g),a.r.copy(de,N,{x:0,y:0},{x:le+xe,y:ce+be},{width:te,height:te},g),a.r.copy(de,N,{x:xe-te,y:0},{x:le-te,y:ce+be},{width:te,height:te},g)}this.dirty=!0}beginFrame(){for(const h in this.images)this.callbackDispatchedThisFrame[h]={}}dispatchRenderCallbacks(h,g){for(const S of h){if(this.callbackDispatchedThisFrame[g][S])continue;this.callbackDispatchedThisFrame[g][S]=!0;const P=this.images[g][S];At(P)&&this.updateImage(S,g,P)}}}function On(w){const h=w.key,g=w.value,S=w.valueSpec||{},P=w.objectElementValidators||{},D=w.style,N=w.styleSpec;let $=[];const Y=a.B(g);if(Y!=="object")return[new a.V(h,g,`object expected, ${Y} found`)];for(const ee in g){const te=ee.split(".")[0];let le;P[te]?le=P[te]:S[te]?le=Bt:P["*"]?le=P["*"]:S["*"]&&(le=Bt),le?$=$.concat(le({key:(h&&`${h}.`)+ee,value:g[ee],valueSpec:S[te]||S["*"],style:D,styleSpec:N,object:g,objectKey:ee},g)):$.push(new a.A(h,g[ee],`unknown property "${ee}"`))}for(const ee in S)P[ee]||S[ee].required&&S[ee].default===void 0&&g[ee]===void 0&&$.push(new a.V(h,g,`missing required property "${ee}"`));return $}function Vn(w){const h=w.value,g=w.valueSpec,S=w.style,P=w.styleSpec,D=w.key,N=w.arrayElementValidator||Bt;if(a.B(h)!=="array")return[new a.V(D,h,`array expected, ${a.B(h)} found`)];if(g.length&&h.length!==g.length)return[new a.V(D,h,`array length ${g.length} expected, length ${h.length} found`)];if(g["min-length"]&&h.length<g["min-length"])return[new a.V(D,h,`array length at least ${g["min-length"]} expected, length ${h.length} found`)];let $={type:g.value,values:g.values,minimum:g.minimum,maximum:g.maximum,function:void 0};P.$version<7&&($.function=g.function),a.B(g.value)==="object"&&($=g.value);let Y=[];for(let ee=0;ee<h.length;ee++)Y=Y.concat(N({array:h,arrayIndex:ee,value:h[ee],valueSpec:$,style:S,styleSpec:P,key:`${D}[${ee}]`},!0));return Y}function on(w){const h=w.key,g=w.value,S=w.valueSpec;let P=a.B(g);if(P==="number"&&g!=g&&(P="NaN"),P!=="number")return[new a.V(h,g,`number expected, ${P} found`)];if("minimum"in S){let D=S.minimum;if(a.B(S.minimum)==="array"&&(D=S.minimum[w.arrayIndex]),g<D)return[new a.V(h,g,`${g} is less than the minimum value ${D}`)]}if("maximum"in S){let D=S.maximum;if(a.B(S.maximum)==="array"&&(D=S.maximum[w.arrayIndex]),g>D)return[new a.V(h,g,`${g} is greater than the maximum value ${D}`)]}return[]}function ct(w){const h=w.valueSpec,g=a.D(w.value.type);let S,P,D,N={};const $=g!=="categorical"&&w.value.property===void 0,Y=!$,ee=a.B(w.value.stops)==="array"&&a.B(w.value.stops[0])==="array"&&a.B(w.value.stops[0][0])==="object",te=On({key:w.key,value:w.value,valueSpec:w.styleSpec.function,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{stops:function(de){if(g==="identity")return[new a.V(de.key,de.value,'identity function may not have a "stops" property')];let xe=[];const be=de.value;return xe=xe.concat(Vn({key:de.key,value:be,valueSpec:de.valueSpec,style:de.style,styleSpec:de.styleSpec,arrayElementValidator:le})),a.B(be)==="array"&&be.length===0&&xe.push(new a.V(de.key,be,"array must have at least one stop")),xe},default:function(de){return Bt({key:de.key,value:de.value,valueSpec:h,style:de.style,styleSpec:de.styleSpec})}}});return g==="identity"&&$&&te.push(new a.V(w.key,w.value,'missing required property "property"')),g==="identity"||w.value.stops||te.push(new a.V(w.key,w.value,'missing required property "stops"')),g==="exponential"&&w.valueSpec.expression&&!a.F(w.valueSpec)&&te.push(new a.V(w.key,w.value,"exponential functions not supported")),w.styleSpec.$version>=8&&(Y&&!a.G(w.valueSpec)?te.push(new a.V(w.key,w.value,"property functions not supported")):$&&!a.H(w.valueSpec)&&te.push(new a.V(w.key,w.value,"zoom functions not supported"))),g!=="categorical"&&!ee||w.value.property!==void 0||te.push(new a.V(w.key,w.value,'"property" property is required')),te;function le(de){let xe=[];const be=de.value,Se=de.key;if(a.B(be)!=="array")return[new a.V(Se,be,`array expected, ${a.B(be)} found`)];if(be.length!==2)return[new a.V(Se,be,`array length 2 expected, length ${be.length} found`)];if(ee){if(a.B(be[0])!=="object")return[new a.V(Se,be,`object expected, ${a.B(be[0])} found`)];if(be[0].zoom===void 0)return[new a.V(Se,be,"object stop key must have zoom")];if(be[0].value===void 0)return[new a.V(Se,be,"object stop key must have value")];const Te=a.D(be[0].zoom);if(typeof Te!="number")return[new a.V(Se,be[0].zoom,"stop zoom values must be numbers")];if(D&&D>Te)return[new a.V(Se,be[0].zoom,"stop zoom values must appear in ascending order")];Te!==D&&(D=Te,P=void 0,N={}),xe=xe.concat(On({key:`${Se}[0]`,value:be[0],valueSpec:{zoom:{}},style:de.style,styleSpec:de.styleSpec,objectElementValidators:{zoom:on,value:ce}}))}else xe=xe.concat(ce({key:`${Se}[0]`,value:be[0],valueSpec:{},style:de.style,styleSpec:de.styleSpec},be));return a.J(a.K(be[1]))?xe.concat([new a.V(`${Se}[1]`,be[1],"expressions are not allowed in function stops.")]):xe.concat(Bt({key:`${Se}[1]`,value:be[1],valueSpec:h,style:de.style,styleSpec:de.styleSpec}))}function ce(de,xe){const be=a.B(de.value),Se=a.D(de.value),Te=de.value!==null?de.value:xe;if(S){if(be!==S)return[new a.V(de.key,Te,`${be} stop domain type must match previous stop domain type ${S}`)]}else S=be;if(be!=="number"&&be!=="string"&&be!=="boolean"&&typeof Se!="number"&&typeof Se!="string"&&typeof Se!="boolean")return[new a.V(de.key,Te,"stop domain value must be a number, string, or boolean")];if(be!=="number"&&g!=="categorical"){let Oe=`number expected, ${be} found`;return a.G(h)&&g===void 0&&(Oe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(de.key,Te,Oe)]}return g!=="categorical"||be!=="number"||typeof Se=="number"&&isFinite(Se)&&Math.floor(Se)===Se?g!=="categorical"&&be==="number"&&typeof Se=="number"&&typeof P=="number"&&P!==void 0&&Se<P?[new a.V(de.key,Te,"stop domain values must appear in ascending order")]:(P=Se,g==="categorical"&&Se in N?[new a.V(de.key,Te,"stop domain values must be unique")]:(N[Se]=!0,[])):[new a.V(de.key,Te,`integer expected, found ${String(Se)}`)]}}function He(w){const h=(w.expressionContext==="property"?a.L:a.M)(a.K(w.value),w.valueSpec);if(h.result==="error")return h.value.map(S=>new a.V(`${w.key}${S.key}`,w.value,S.message));const g=h.value.expression||h.value._styleExpression.expression;if(w.expressionContext==="property"&&w.propertyKey==="text-font"&&!g.outputDefined())return[new a.V(w.key,w.value,`Invalid data expression for "${w.propertyKey}". Output values must be contained as literals within the expression.`)];if(w.expressionContext==="property"&&w.propertyType==="layout"&&!a.N(g))return[new a.V(w.key,w.value,'"feature-state" data expressions are not supported with layout properties.')];if(w.expressionContext==="filter")return qt(g,w);if(w.expressionContext&&w.expressionContext.indexOf("cluster")===0){if(!a.O(g,["zoom","feature-state"]))return[new a.V(w.key,w.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(w.expressionContext==="cluster-initial"&&!a.Q(g))return[new a.V(w.key,w.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qt(w,h){const g=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(h.valueSpec&&h.valueSpec.expression)for(const P of h.valueSpec.expression.parameters)g.delete(P);if(g.size===0)return[];const S=[];return w instanceof a.S&&g.has(w.name)?[new a.V(h.key,h.value,`["${w.name}"] expression is not supported in a filter for a ${h.object.type} layer with id: ${h.object.id}`)]:(w.eachChild(P=>{S.push(...qt(P,h))}),S)}function Tn(w){const h=w.key,g=w.value,S=w.valueSpec,P=[];return Array.isArray(S.values)?S.values.indexOf(a.D(g))===-1&&P.push(new a.V(h,g,`expected one of [${S.values.join(", ")}], ${JSON.stringify(g)} found`)):Object.keys(S.values).indexOf(a.D(g))===-1&&P.push(new a.V(h,g,`expected one of [${Object.keys(S.values).join(", ")}], ${JSON.stringify(g)} found`)),P}function An(w){return a.W(a.K(w.value))?He(a.C({},w,{expressionContext:"filter",valueSpec:w.styleSpec[`filter_${w.layerType||"fill"}`]})):Wt(w)}function Wt(w){const h=w.value,g=w.key;if(a.B(h)!=="array")return[new a.V(g,h,`array expected, ${a.B(h)} found`)];const S=w.styleSpec;let P,D=[];if(h.length<1)return[new a.V(g,h,"filter array must have at least 1 element")];switch(D=D.concat(Tn({key:`${g}[0]`,value:h[0],valueSpec:S.filter_operator,style:w.style,styleSpec:w.styleSpec})),a.D(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&a.D(h[1])==="$type"&&D.push(new a.V(g,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&D.push(new a.V(g,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(P=a.B(h[1]),P!=="string"&&D.push(new a.V(`${g}[1]`,h[1],`string expected, ${P} found`)));for(let N=2;N<h.length;N++)P=a.B(h[N]),a.D(h[1])==="$type"?D=D.concat(Tn({key:`${g}[${N}]`,value:h[N],valueSpec:S.geometry_type,style:w.style,styleSpec:w.styleSpec})):P!=="string"&&P!=="number"&&P!=="boolean"&&D.push(new a.V(`${g}[${N}]`,h[N],`string, number, or boolean expected, ${P} found`));break;case"any":case"all":case"none":for(let N=1;N<h.length;N++)D=D.concat(Wt({key:`${g}[${N}]`,value:h[N],style:w.style,styleSpec:w.styleSpec}));break;case"has":case"!has":P=a.B(h[1]),h.length!==2?D.push(new a.V(g,h,`filter array for "${h[0]}" operator must have 2 elements`)):P!=="string"&&D.push(new a.V(`${g}[1]`,h[1],`string expected, ${P} found`))}return D}function gr(w,h){const g=w.key,S=w.style,P=w.layer,D=w.styleSpec,N=w.value,$=w.objectKey,Y=D[`${h}_${w.layerType}`];if(!Y)return[];const ee=$.match(/^(.*)-transition$/);if(h==="paint"&&ee&&Y[ee[1]]&&Y[ee[1]].transition)return Bt({key:g,value:N,valueSpec:D.transition,style:S,styleSpec:D});const te=w.valueSpec||Y[$];if(!te)return[new a.A(g,N,`unknown property "${$}"`)];let le;if(a.B(N)==="string"&&a.G(te)&&!te.tokens&&(le=/^{([^}]+)}$/.exec(N))){const de=`\`{ "type": "identity", "property": ${le?JSON.stringify(le[1]):'"_"'} }\``;return[new a.V(g,N,`"${$}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const ce=[];if(w.layerType==="symbol")$!=="text-field"||!S||S.glyphs||S.imports||ce.push(new a.V(g,N,'use of "text-field" requires a style "glyphs" property')),$==="text-font"&&a.X(a.K(N))&&a.D(N.type)==="identity"&&ce.push(new a.V(g,N,'"text-font" does not support identity functions'));else if(w.layerType==="model"&&h==="paint"&&P&&P.layout&&P.layout.hasOwnProperty("model-id")&&a.G(te)&&(a.Y(te)||a.H(te))){const de=a.L(a.K(N),te),xe=de.value.expression||de.value._styleExpression.expression;xe&&!a.O(xe,["measure-light"])&&($==="model-emissive-strength"&&a.Q(xe)&&a.N(xe)||ce.push(new a.V(g,N,`${$} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ce.concat(Bt({key:w.key,value:N,valueSpec:te,style:S,styleSpec:D,expressionContext:"property",propertyType:h,propertyKey:$}))}function Gn(w){return gr(w,"paint")}function nr(w){return gr(w,"layout")}function Ar(w){let h=[];const g=w.value,S=w.key,P=w.style,D=w.styleSpec;g.type||g.ref||h.push(new a.V(S,g,'either "type" or "ref" is required'));let N=a.D(g.type);const $=a.D(g.ref);if(g.id){const Y=a.D(g.id);for(let ee=0;ee<w.arrayIndex;ee++){const te=P.layers[ee];a.D(te.id)===Y&&h.push(new a.V(S,g.id,`duplicate layer id "${g.id}", previously used at line ${te.id.__line__}`))}}if("ref"in g){let Y;["type","source","source-layer","filter","layout"].forEach(ee=>{ee in g&&h.push(new a.V(S,g[ee],`"${ee}" is prohibited for ref layers`))}),P.layers.forEach(ee=>{a.D(ee.id)===$&&(Y=ee)}),Y?Y.ref?h.push(new a.V(S,g.ref,"ref cannot reference another ref layer")):N=a.D(Y.type):typeof $=="string"&&h.push(new a.V(S,g.ref,`ref layer "${$}" not found`))}else if(N!=="background"&&N!=="sky"&&N!=="slot")if(g.source){const Y=P.sources&&P.sources[g.source],ee=Y&&a.D(Y.type);Y?ee==="vector"&&N==="raster"?h.push(new a.V(S,g.source,`layer "${g.id}" requires a raster source`)):ee==="raster"&&N!=="raster"?h.push(new a.V(S,g.source,`layer "${g.id}" requires a vector source`)):ee!=="vector"||g["source-layer"]?ee==="raster-dem"&&N!=="hillshade"?h.push(new a.V(S,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):ee!=="raster-array"||["raster","raster-particle"].includes(N)?N!=="line"||!g.paint||!g.paint["line-gradient"]&&!g.paint["line-trim-offset"]||ee==="geojson"&&Y.lineMetrics?N==="raster-particle"&&ee!=="raster-array"&&h.push(new a.V(S,g.source,`layer "${g.id}" requires a 'raster-array' source.`)):h.push(new a.V(S,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new a.V(S,g.source,"raster-array source can only be used with layer type 'raster'.")):h.push(new a.V(S,g,`layer "${g.id}" must specify a "source-layer"`)):h.push(new a.V(S,g.source,`source "${g.source}" not found`))}else h.push(new a.V(S,g,'missing required property "source"'));return h=h.concat(On({key:S,value:g,valueSpec:D.layer,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Bt({key:`${S}.type`,value:g.type,valueSpec:D.layer.type,style:w.style,styleSpec:w.styleSpec,object:g,objectKey:"type"}),filter:Y=>An(a.C({layerType:N},Y)),layout:Y=>On({layer:g,key:Y.key,value:Y.value,valueSpec:{},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":ee=>nr(a.C({layerType:N},ee))}}),paint:Y=>On({layer:g,key:Y.key,value:Y.value,valueSpec:{},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":ee=>Gn(a.C({layerType:N,layer:g},ee))}})}})),h}function Dn(w){const h=w.value,g=w.key,S=a.B(h);return S!=="string"?[new a.V(g,h,`string expected, ${S} found`)]:[]}const sr={promoteId:function({key:w,value:h}){if(a.B(h)==="string")return Dn({key:w,value:h});{const g=[];for(const S in h)g.push(...Dn({key:`${w}.${S}`,value:h[S]}));return g}}};function di(w){const h=w.value,g=w.key,S=w.styleSpec,P=w.style;if(!h.type)return[new a.V(g,h,'"type" is required')];const D=a.D(h.type);let N=[];switch(["vector","raster","raster-dem","raster-array"].includes(D)&&(h.url||h.tiles||N.push(new a.A(g,h,'Either "url" or "tiles" is required.'))),D){case"vector":case"raster":case"raster-dem":case"raster-array":return N=N.concat(On({key:g,value:h,valueSpec:S[`source_${D.replace("-","_")}`],style:w.style,styleSpec:S,objectElementValidators:sr})),N;case"geojson":if(N=On({key:g,value:h,valueSpec:S.source_geojson,style:P,styleSpec:S,objectElementValidators:sr}),h.cluster)for(const $ in h.clusterProperties){const[Y,ee]=h.clusterProperties[$],te=typeof Y=="string"?[Y,["accumulated"],["get",$]]:Y;N.push(...He({key:`${g}.${$}.map`,value:ee,expressionContext:"cluster-map"})),N.push(...He({key:`${g}.${$}.reduce`,value:te,expressionContext:"cluster-reduce"}))}return N;case"video":return On({key:g,value:h,valueSpec:S.source_video,style:P,styleSpec:S});case"image":return On({key:g,value:h,valueSpec:S.source_image,style:P,styleSpec:S});case"canvas":return[new a.V(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tn({key:`${g}.type`,value:h.type,valueSpec:{values:zr(S)},style:P,styleSpec:S})}}function zr(w){return w.source.reduce((h,g)=>{const S=w[g];return S.type.type==="enum"&&(h=h.concat(Object.keys(S.type.values))),h},[])}function ar(w){const h=w.value,g=w.styleSpec,S=g.light,P=w.style;let D=[];const N=a.B(h);if(h===void 0)return D;if(N!=="object")return D=D.concat([new a.V("light",h,`object expected, ${N} found`)]),D;for(const $ in h){const Y=$.match(/^(.*)-transition$/);D=D.concat(Y&&S[Y[1]]&&S[Y[1]].transition?Bt({key:$,value:h[$],valueSpec:g.transition,style:P,styleSpec:g}):S[$]?Bt({key:$,value:h[$],valueSpec:S[$],style:P,styleSpec:g}):[new a.V($,h[$],`unknown property "${$}"`)])}return D}function Ur(w){const h=w.value;let g=[];if(!h)return g;const S=a.B(h);if(S!=="object")return g=g.concat([new a.V("light-3d",h,`object expected, ${S} found`)]),g;const P=w.styleSpec,D=P["light-3d"],N=w.key,$=w.style,Y=w.style.lights;for(const le of["type","id"])if(!(le in h))return g=g.concat([new a.V("light-3d",h,`missing property ${le} on light`)]),g;if(h.type&&Y)for(let le=0;le<w.arrayIndex;le++){const ce=a.D(h.type),de=Y[le];a.D(de.type)===ce&&g.push(new a.V(N,h.id,`duplicate light type "${h.type}", previously defined at line ${de.id.__line__}`))}const ee=`properties_light_${h.type}`;if(!(ee in P))return g=g.concat([new a.V("light-3d",h,`Invalid light type ${h.type}`)]),g;const te=P[ee];for(const le in h)if(le==="properties"){const ce=h[le],de=a.B(ce);if(de!=="object")return g=g.concat([new a.V("properties",ce,`object expected, ${de} found`)]),g;for(const xe in ce)g=g.concat(te[xe]?Bt({key:xe,value:ce[xe],valueSpec:te[xe],style:$,styleSpec:P}):[new a.A(w.key,ce[xe],`unknown property "${xe}"`)])}else{const ce=le.match(/^(.*)-transition$/);g=g.concat(ce&&D[ce[1]]&&D[ce[1]].transition?Bt({key:le,value:h[le],valueSpec:P.transition,style:$,styleSpec:P}):D[le]?Bt({key:le,value:h[le],valueSpec:D[le],style:$,styleSpec:P}):[new a.A(le,h[le],`unknown property "${le}"`)])}return g}function Wr(w){const h=w.value,g=w.key,S=w.style,P=w.styleSpec,D=P.terrain;let N=[];const $=a.B(h);if(h===void 0||$==="null")return N;if($!=="object")return N=N.concat([new a.V("terrain",h,`object expected, ${$} found`)]),N;for(const Y in h){const ee=Y.match(/^(.*)-transition$/);N=N.concat(ee&&D[ee[1]]&&D[ee[1]].transition?Bt({key:Y,value:h[Y],valueSpec:P.transition,style:S,styleSpec:P}):D[Y]?Bt({key:Y,value:h[Y],valueSpec:D[Y],style:S,styleSpec:P}):[new a.A(Y,h[Y],`unknown property "${Y}"`)])}if(h.source){const Y=S.sources&&S.sources[h.source],ee=Y&&a.D(Y.type);Y?ee!=="raster-dem"&&N.push(new a.V(g,h.source,`terrain cannot be used with a source of type ${String(ee)}, it only be used with a "raster-dem" source type`)):N.push(new a.V(g,h.source,`source "${h.source}" not found`))}else N.push(new a.V(g,h,'terrain is missing required property "source"'));return N}function Si(w){const h=w.value,g=w.style,S=w.styleSpec,P=S.fog;let D=[];const N=a.B(h);if(h===void 0)return D;if(N!=="object")return D=D.concat([new a.V("fog",h,`object expected, ${N} found`)]),D;for(const $ in h){const Y=$.match(/^(.*)-transition$/);D=D.concat(Y&&P[Y[1]]&&P[Y[1]].transition?Bt({key:$,value:h[$],valueSpec:S.transition,style:g,styleSpec:S}):P[$]?Bt({key:$,value:h[$],valueSpec:P[$],style:g,styleSpec:S}):[new a.A($,h[$],`unknown property "${$}"`)])}return D}const Ne={"*":()=>[],array:Vn,boolean:function(w){const h=w.value,g=w.key,S=a.B(h);return S!=="boolean"?[new a.V(g,h,`boolean expected, ${S} found`)]:[]},number:on,color:function(w){const h=w.key,g=w.value,S=a.B(g);return S!=="string"?[new a.V(h,g,`color expected, ${S} found`)]:a.U.parseCSSColor(g)===null?[new a.V(h,g,`color expected, "${g}" found`)]:[]},enum:Tn,filter:An,function:ct,layer:Ar,object:On,source:di,model:a.Z,light:ar,"light-3d":Ur,terrain:Wr,fog:Si,string:Dn,formatted:function(w){return Dn(w).length===0?[]:He(w)},resolvedImage:function(w){return Dn(w).length===0?[]:He(w)},projection:function(w){const h=w.value,g=w.styleSpec,S=g.projection,P=w.style;let D=[];const N=a.B(h);if(N==="object")for(const $ in h)D=D.concat(Bt({key:$,value:h[$],valueSpec:S[$],style:P,styleSpec:g}));else N!=="string"&&(D=D.concat([new a.V("projection",h,`object or string expected, ${N} found`)]));return D},import:function(w){const{value:h,styleSpec:g}=w,{data:S,...P}=h;Object.defineProperty(P,"__line__",{value:h.__line__,enumerable:!1});let D=On(a.C({},w,{value:P,valueSpec:g.import}));return a.D(P.id)===""&&D.push(new a.V(`${w.key}.id`,P,"import id can't be an empty string")),S&&(D=D.concat(hn(S,g,{key:`${w.key}.data`}))),D}};function Bt(w,h=!1){const g=w.value,S=w.valueSpec,P=w.styleSpec;if(S.expression&&a.X(a.D(g)))return ct(w);if(S.expression&&a.J(a.K(g)))return He(w);if(S.type&&Ne[S.type]){const D=Ne[S.type](w);return h===!0&&D.length>0&&a.B(w.value)==="array"?He(w):D}return On(a.C({},w,{valueSpec:S.type?P[S.type]:S}))}function Jt(w){const h=w.value,g=w.key,S=Dn(w);return S.length||(h.indexOf("{fontstack}")===-1&&S.push(new a.V(g,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&S.push(new a.V(g,h,'"glyphs" url must include a "{range}" token'))),S}function hn(w,h=a._,g={}){return Bt({key:g.key||"",value:w,valueSpec:h.$root,styleSpec:h,style:w,objectElementValidators:{glyphs:Jt,"*":()=>[]}})}function In(w,h=a._){return Qe(hn(w,h))}const Tr=w=>Qe(di(w)),jr=w=>Qe(ar(w)),ps=w=>Qe(Ur(w)),Bs=w=>Qe(Wr(w)),fi=w=>Qe(Si(w)),Mt=w=>Qe(Ar(w)),we=w=>Qe(An(w)),Ie=w=>Qe(Gn(w)),qe=w=>Qe(nr(w)),it=w=>Qe(a.Z(w));function Qe(w){return w.slice().sort((h,g)=>h.line&&g.line?h.line-g.line:0)}function mt(w,h){let g=!1;if(h&&h.length)for(const S of h)S instanceof a.A?a.w(S.message):(w.fire(new a.t(new Error(S.message))),g=!0);return g}let Rt;class yt extends a.E{constructor(h,g="flat"){super(),this._transitionable=new a.$(Rt||(Rt=new a.a0({anchor:new a.a1(a._.light.anchor),position:new a.a2(a._.light.position),color:new a.a1(a._.light.color),intensity:new a.a1(a._.light.intensity)}))),this.setLight(h,g),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,g,S={}){this._validate(jr,h,S)||(this._transitionable.setTransitionOrValue(h),this.id=g)}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,g,S){return(!S||S.validate!==!1)&&mt(this,h.call(In,a.l({value:g,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}const Lt=new a.a0({source:new a.a1(a._.terrain.source),exaggeration:new a.a1(a._.terrain.exaggeration)});let Gt=class extends a.E{constructor(w,h,g,S){super(),this.scope=g,this._transitionable=new a.$(Lt,g,S),this._transitionable.setTransitionOrValue(w,S),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(w,h){this._transitionable.setTransitionOrValue(w,h)}updateTransitions(w){this._transitioning=this._transitionable.transitioned(w,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(w){this.properties=this._transitioning.possiblyEvaluate(w)}getExaggeration(w){return this._transitioning.possiblyEvaluate(new a.a3(w)).get("exaggeration")}isZoomDependent(){const w=this._transitionable._values.exaggeration;return w!=null&&w.value!=null&&w.value.expression!=null&&w.value.expression instanceof a.a4}};const Ot=45,cn=65,Cn=.05;function En(w,h,g,S){const P=a.a7(Ot,cn,g),[D,N]=je(w,S);let $=1-Math.min(1,Math.exp((h-D)/(N-D)*-6));return $*=$*$,$=Math.min(1,1.00747*$),$*P*w.alpha}function je(w,h){const g=.5/Math.tan(.5*h);return[w.range[0]+g,w.range[1]+g]}function bt(w,h,g,S,P){const D=a.a6.vec3.transformMat4([],[h,g,S],P.mercatorFogMatrix);return En(w,a.a6.vec3.length(D),P.pitch,P._fov)}function Ct(w,h,g,S,P,D,N){const $=[[g,S,0],[P,S,0],[P,D,0],[g,D,0]];let Y=Number.MAX_VALUE,ee=-Number.MAX_VALUE;for(const te of $){const le=a.a6.vec3.transformMat4([],te,h),ce=a.a6.vec3.length(le);Y=Math.min(Y,ce),ee=Math.max(ee,ce)}return[En(w,Y,N.pitch,N._fov),En(w,ee,N.pitch,N._fov)]}const Et=new a.a0({range:new a.a1(a._.fog.range),color:new a.a1(a._.fog.color),"high-color":new a.a1(a._.fog["high-color"]),"space-color":new a.a1(a._.fog["space-color"]),"horizon-blend":new a.a1(a._.fog["horizon-blend"]),"star-intensity":new a.a1(a._.fog["star-intensity"]),"vertical-range":new a.a1(a._.fog["vertical-range"])});class Pt extends a.E{constructor(h,g,S,P){super(),this._transitionable=new a.$(Et,S,new Map(P)),this.set(h,P),this._transitioning=this._transitionable.untransitioned(),this._transform=g,this.properties=new a.a8(Et),this.scope=S}get state(){const h=this._transform,g=h.projection.name==="globe",S=a.a9(h.zoom),P=this.properties.get("range"),D=[.5,3];return{range:g?[a.aa(D[0],P[0],S),a.aa(D[1],P[1],S)]:P,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,g,S={}){if(this._validate(fi,h,S))return;const P=a.l({},h);for(const D of Object.keys(a._.fog))P[D]===void 0&&(P[D]=a._.fog[D].default);this._options=P,this._transitionable.setTransitionOrValue(this._options,g)}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.a7(Ot,cn,h))*g.a}getOpacityAtLatLng(h,g){return this._transform.projection.supportsFog?function(S,P,D){const N=a.a5.fromLngLat(P),$=D.elevation?D.elevation.getAtPointOrZero(N):0;return bt(S,N.x,N.y,$,D)}(this.state,h,g):0}getOpacityForTile(h){if(!this._transform.projection.supportsFog)return[1,1];const g=this._transform.calculateFogTileMatrix(h.toUnwrapped());return Ct(this.state,g,0,0,a.ab,a.ab,this._transform)}getOpacityForBounds(h,g,S,P,D){return this._transform.projection.supportsFog?Ct(this.state,h,g,S,P,D,this._transform):[1,1]}getFovAdjustedRange(h){return this._transform.projection.supportsFog?je(this.state,h):[0,1]}isVisibleOnFrustum(h){if(!this._transform.projection.supportsFog)return!1;const g=[4,5,6,7];for(const S of g){const P=h.points[S];let D;if(P[2]>=0)D=P;else{const N=h.points[S-4];D=a.ac(N,P,N[2]/(N[2]-P[2]))}if(bt(this.state,D[0],D[1],0,this._transform)>=Cn)return!0}return!1}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,g,S){return(!S||S.validate!==!1)&&mt(this,h.call(In,a.l({value:g,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}class Sn extends a.E{constructor(h,g,S,P){super(),this.scope=S,this._options=h,this.properties=new a.a8(g),this._transitionable=new a.$(g,S,new Map(P)),this._transitionable.setTransitionOrValue(h.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(h){this._transitionable.setTransitionOrValue(this._options.properties,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(h,g){this._options=h,this._transitionable.setTransitionOrValue(h.properties,g)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let yn,Un;class Xn{constructor(h,g,S,P){this.screenBounds=h,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=S,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,P)}static createFromScreenPoints(h,g){let S,P;if(h instanceof a.P||typeof h[0]=="number"){const D=a.P.convert(h);S=[D],P=g.isPointAboveHorizon(D)}else{const D=a.P.convert(h[0]),N=a.P.convert(h[1]);S=[D,N],P=a.ae(D,N).every($=>g.isPointAboveHorizon($))}return new Xn(S,g.getCameraPoint(),P,g)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return a.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const g=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],P=a.ae(g,S,0,!1);return this.cameraPoint.y>S.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<S.x?P.splice(3,0,this.cameraPoint):this.cameraPoint.x>=S.x?P[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(P[3]=this.cameraPoint)),a.af(P,h)}bufferedCameraGeometryGlobe(h){const g=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],P=a.ae(g,S,h),D=this.cameraPoint.clone();switch(3*((D.y>g.y)+(D.y>S.y))+((D.x>g.x)+(D.x>S.x))){case 0:P[0]=D,P[4]=D.clone();break;case 1:P.splice(1,0,D);break;case 2:P[1]=D;break;case 3:P.splice(4,0,D);break;case 5:P.splice(2,0,D);break;case 6:P[3]=D;break;case 7:P.splice(3,0,D);break;case 8:P[2]=D}return P}containsTile(h,g,S,P=0){const D=h.queryPadding/g._pixelsPerMercatorPixel+1,N=S?this._bufferedCameraMercator(D,g):this._bufferedScreenMercator(D,g);let $=h.tileID.wrap+(N.unwrapped?P:0);const Y=N.polygon.map(Se=>a.ag(h.tileTransform,Se,$));if(!a.ah(Y,0,0,a.ab,a.ab))return;$=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?P:0);const ee=this.screenGeometryMercator.polygon.map(Se=>a.ai(h.tileTransform,Se,$)),te=ee.map(Se=>new a.P(Se[0],Se[1])),le=g.getFreeCameraOptions().position||new a.a5(0,0,0),ce=a.ai(h.tileTransform,le,$),de=ee.map(Se=>{const Te=a.a6.vec3.sub(Se,Se,ce);return a.a6.vec3.normalize(Te,Te),new a.aj(ce,Te)}),xe=a.ak(h,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:te,tilespaceRays:de,bufferedTilespaceGeometry:Y,bufferedTilespaceBounds:(be=a.al(Y),be.min.x=a.ap(be.min.x,0,a.ab),be.min.y=a.ap(be.min.y,0,a.ab),be.max.x=a.ap(be.max.x,0,a.ab),be.max.y=a.ap(be.max.y,0,a.ab),be),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:xe};var be}_bufferedScreenMercator(h,g){const S=pr(h);if(this._screenRaycastCache[S])return this._screenRaycastCache[S];{let P;return P=g.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),g):{polygon:this.bufferedScreenGeometry(h).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[S]=P,P}}_bufferedCameraMercator(h,g){const S=pr(h);if(this._cameraRaycastCache[S])return this._cameraRaycastCache[S];{let P;return P=g.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),g):{polygon:this.bufferedCameraGeometry(h).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[S]=P,P}}_projectAndResample(h,g){const S=function(D,N){const $=a.a6.mat4.multiply([],N.pixelMatrix,N.globeMatrix),Y=[0,-a.aq,0,1],ee=[0,a.aq,0,1],te=[0,0,0,1];a.a6.vec4.transformMat4(Y,Y,$),a.a6.vec4.transformMat4(ee,ee,$),a.a6.vec4.transformMat4(te,te,$);const le=new a.P(Y[0]/Y[3],Y[1]/Y[3]),ce=new a.P(ee[0]/ee[3],ee[1]/ee[3]),de=a.an(D,le)&&Y[3]<te[3],xe=a.an(D,ce)&&ee[3]<te[3];if(!de&&!xe)return null;const be=function(tt,Je,nt){for(let ht=1;ht<tt.length;ht++){const at=vr(Je.pointCoordinate3D(tt[ht-1]).x),st=vr(Je.pointCoordinate3D(tt[ht]).x);if(nt<0){if(at<st)return{idx:ht,t:-at/(st-1-at)}}else if(st<at)return{idx:ht,t:(1-at)/(st+1-at)}}return null}(D,N,de?-1:1);if(!be)return null;const{idx:Se,t:Te}=be;let Oe=Se>1?cr(D.slice(0,Se),N):[],Ge=Se<D.length?cr(D.slice(Se),N):[];Oe=Oe.map(tt=>new a.P(vr(tt.x),tt.y)),Ge=Ge.map(tt=>new a.P(vr(tt.x),tt.y));const Be=[...Oe];Be.length===0&&Be.push(Ge[Ge.length-1]);const Xe=a.aa(Be[Be.length-1].y,(Ge.length===0?Oe[0]:Ge[0]).y,Te);let $e;return $e=de?[new a.P(0,Xe),new a.P(0,0),new a.P(1,0),new a.P(1,Xe)]:[new a.P(1,Xe),new a.P(1,1),new a.P(0,1),new a.P(0,Xe)],Be.push(...$e),Ge.length===0?Be.push(Oe[0]):Be.push(...Ge),{polygon:Be.map(tt=>new a.a5(tt.x,tt.y)),unwrapped:!1}}(h,g);if(S)return S;const P=function(D,N){let $=!1,Y=-1/0,ee=0;for(let le=0;le<D.length-1;le++)D[le].x>Y&&(Y=D[le].x,ee=le);for(let le=0;le<D.length-1;le++){const ce=(ee+le)%(D.length-1),de=D[ce],xe=D[ce+1];Math.abs(de.x-xe.x)>.5&&(de.x<xe.x?(de.x+=1,ce===0&&(D[D.length-1].x+=1)):(xe.x+=1,ce+1===D.length-1&&(D[0].x+=1)),$=!0)}const te=a.am(N.center.lng);return $&&te<Math.abs(te-1)&&D.forEach(le=>{le.x-=1}),{polygon:D,unwrapped:$}}(cr(h,g).map(D=>new a.P(vr(D.x),D.y)),g);return{polygon:P.polygon.map(D=>new a.a5(D.x,D.y)),unwrapped:P.unwrapped}}}function cr(w,h){return a.ao(w,g=>{const S=h.pointCoordinate3D(g);g.x=S.x,g.y=S.y},1/256)}function vr(w){return w<0?1+w%1:w%1}function pr(w){return 100*w|0}function pi(w,h,g,S,P){const D=function($,Y){if($)return P($);if(Y){if(w.url&&Y.tiles&&w.tiles&&delete w.tiles,Y.variants){if(!Array.isArray(Y.variants))return P(new Error("variants must be an array"));for(const te of Y.variants){if(te==null||typeof te!="object"||te.constructor!==Object)return P(new Error("variant must be an object"));if(!Array.isArray(te.capabilities))return P(new Error("capabilities must be an array"));if(te.capabilities.length===1&&te.capabilities[0]==="meshopt"){Y=a.l(Y,te);break}}}const ee=a.ar(a.l(Y,w),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Y.vector_layers&&(ee.vectorLayers=Y.vector_layers,ee.vectorLayerIds=ee.vectorLayers.map(te=>te.id)),Y.raster_layers&&(ee.rasterLayers=Y.raster_layers,ee.rasterLayerIds=ee.rasterLayers.map(te=>te.id)),ee.tiles=h.canonicalizeTileset(ee,w.url),P(null,ee)}},N=function($,Y,ee){if(!$)return null;if(!Y&&!ee)return $;ee=ee||$.worldview_default;const te=Object.values($.language||{});if(te.length===0)return null;const le=Object.values($.worldview||{});if(le.length===0)return null;const ce=te.every(xe=>xe===Y),de=le.every(xe=>xe===ee);return ce&&de?$:Y in($.language_options||{})||ee in($.worldview_options||{})?null:$.language_options&&$.worldview_options?$:null}(w.data,g,S);return N?a.q.frame(()=>D(null,N)):w.url?a.n(h.transformRequest(h.normalizeSourceURL(w.url,null,g,S),a.R.Source),D):a.q.frame(()=>{const{data:$,...Y}=w;D(null,Y)})}class zi{constructor(h,g,S){this.bounds=a.as.convert(this.validateBounds(h)),this.minzoom=g||0,this.maxzoom=S||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const g=Math.pow(2,h.z),S=Math.floor(a.am(this.bounds.getWest())*g),P=Math.floor(a.at(this.bounds.getNorth())*g),D=Math.ceil(a.am(this.bounds.getEast())*g),N=Math.ceil(a.at(this.bounds.getSouth())*g);return h.x>=S&&h.x<D&&h.y>=P&&h.y<N}}class Xi extends a.E{constructor(h,g,S,P){if(super(),this.id=h,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.l(this,a.ar(g,["url","scheme","tileSize","promoteId"])),this._options=a.l({type:"vector"},g),this._collectResourceTiming=!!g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(P),this._tileWorkers={},this._deduped=new a.au}load(h){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,S=this.map._worldview;this._tileJSONRequest=pi(this._options,this.map._requestManager,g,S,(P,D)=>{this._tileJSONRequest=null,this._loaded=!0,P?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),S&&S.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${S}`),this.fire(new a.t(P))):D&&(a.l(this,D),D.bounds&&(this.tileBounds=new zi(D.bounds,this.minzoom,this.maxzoom)),Dt(D.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),h&&h(P)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest();const h=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(h))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(h){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}loadTile(h,g){const S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),P=this.map._requestManager.transformRequest(S,a.R.Tile),D=this.map.style?this.map.style.getLut(this.scope):null,N={request:P,data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,lut:D?{image:D.image.clone()}:null,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:h.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(N.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=g:h.request=h.actor.send("reloadTile",N,$.bind(this));else if(h.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",N,$.bind(this),void 0,!0);else{const Y=a.aw.call({deduped:this._deduped},N,(ee,te)=>{ee||!te?$.call(this,ee):(N.data={cacheControl:te.cacheControl,expires:te.expires,rawData:te.rawData.slice(0)},h.actor&&h.actor.send("loadTile",N,$.bind(this),void 0,!0))},!0);h.request={cancel:Y}}function $(Y,ee){return delete h.request,h.aborted?g(null):Y&&Y.status!==404?g(Y):(ee&&ee.resourceTiming&&(h.resourceTiming=ee.resourceTiming),this.map._refreshExpiredTiles&&ee&&h.setExpiryData(ee),h.loadVectorData(ee,this.map.painter),a.ax(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(h,g){h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope}),h.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ms extends a.E{constructor(h,g,S,P){super(),this.id=h,this.dispatcher=S,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.l({type:"raster"},g),a.l(this,a.ar(g,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._tileJSONRequest=pi(this._options,this.map._requestManager,null,null,(g,S)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new a.t(g)):S&&(a.l(this,S),S.bounds&&(this.tileBounds=new zi(S.bounds,this.minzoom,this.maxzoom)),Dt(S.tiles),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),h&&h(g)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest();const h=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(h))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(h){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,g){const S=a.q.devicePixelRatio>=2,P=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),S,this.tileSize);h.request=a.o(this.map._requestManager.transformRequest(P,a.R.Tile),(D,N,$,Y)=>(delete h.request,h.aborted?(h.state="unloaded",g(null)):D?(h.state="errored",g(D)):N?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:$,expires:Y}),h.setTexture(N,this.map.painter),h.state="loaded",a.ax(this.dispatcher),void g(null)):g(null)))}abortTile(h,g){h.request&&(h.request.cancel(),delete h.request),g&&g()}unloadTile(h,g){h.texture&&h.texture instanceof a.T?(h.destroy(!0),h.texture&&h.texture instanceof a.T&&this.map.painter.saveTileTexture(h.texture)):h.destroy(),g&&g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ir extends Ms{constructor(h,g,S,P){super(h,g,S,P),this.type="raster-array",this.maxzoom=22,this._options=a.l({type:"raster-array"},g)}triggerRepaint(h){const g=this.map.painter._terrain,S=this.map.style.getSourceCache(this.id);g&&g.enabled&&S&&g._clearRenderCacheForTile(S.id,h.tileID),this.map.triggerRepaint()}loadTile(h,g){const S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),P=this.map._requestManager.transformRequest(S,a.R.Tile);h.requestParams=P,h.actor||(h.actor=this.dispatcher.getActor()),h.request=h.fetchHeader(void 0,(D,N,$,Y)=>{if(delete h.request,h.aborted)return h.state="unloaded",g(null);if(D)return D.code===20?void 0:(h.state="errored",g(D));this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:$,expires:Y}),h.state="empty",g(null)})}unloadTile(h,g){const S=h.texture;S&&S instanceof a.T?(h.destroy(!0),this.map.painter.saveTileTexture(S)):(h.destroy(),h.flushQueues(),h._isHeaderLoaded=!1,delete h._mrt,delete h.textureDescriptor),h.fbo&&(h.fbo.destroy(),delete h.fbo),delete h.request,delete h.requestParams,delete h.neighboringTiles,h.state="unloaded"}prepareTile(h,g,S){h._isHeaderLoaded&&(h.state!=="empty"&&(h.state="reloading"),h.fetchBand(g,S,(P,D)=>{if(P)return h.state="errored",this.fire(new a.t(P)),void this.triggerRepaint(h);D&&(h.setTexture(D,this.map.painter),h.state="loaded",this.triggerRepaint(h))}))}getInitialBand(h){if(!this.rasterLayers)return 0;const g=this.rasterLayers.find(({id:D})=>D===h),S=g&&g.fields,P=S&&S.bands&&S.bands;return P?P[0]:0}getTextureDescriptor(h,g,S){if(!h)return;const P=g.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!P)return;let D=null;g instanceof a.aB?D=g.paint.get("raster-array-band"):g instanceof a.aC&&(D=g.paint.get("raster-particle-array-band"));const N=D||this.getInitialBand(P);if(N!=null)if(h.textureDescriptor){if(!h.updateNeeded(P,N)||S)return Object.assign({},h.textureDescriptor,{texture:h.texture})}else this.prepareTile(h,P,N)}}const er={vector:Xi,raster:Ms,"raster-dem":class extends Ms{constructor(w,h,g,S){super(w,h,g,S),this.type="raster-dem",this.maxzoom=22,this._options=a.l({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(w,h){const g=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function S(P,D){P&&(w.state="errored",h(P)),D&&(w.dem=D,w.dem.onDeserialize(),w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0,w.state="loaded",h(null))}w.request=a.o(this.map._requestManager.transformRequest(g,a.R.Tile),(function(P,D,N,$){if(delete w.request,w.aborted)w.state="unloaded",h(null);else if(P)w.state="errored",h(P);else if(D){this.map._refreshExpiredTiles&&w.setExpiryData({cacheControl:N,expires:$});const Y=ImageBitmap&&D instanceof ImageBitmap&&a.ay(),ee=1-(D.width-a.az(D.width))/2;ee<1||w.neighboringTiles||(w.neighboringTiles=this._getNeighboringTiles(w.tileID));const te=Y?D:a.q.getImageData(D,ee),le={uid:w.uid,coord:w.tileID,source:this.id,scope:this.scope,rawImageData:te,encoding:this.encoding,padding:ee};w.actor&&w.state!=="expired"||(w.actor=this.dispatcher.getActor(),w.actor.send("loadDEMTile",le,S.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(w){const h=w.canonical,g=Math.pow(2,h.z),S=(h.x-1+g)%g,P=h.x===0?w.wrap-1:w.wrap,D=(h.x+1+g)%g,N=h.x+1===g?w.wrap+1:w.wrap,$={};return $[new a.aA(w.overscaledZ,P,h.z,S,h.y).key]={backfilled:!1},$[new a.aA(w.overscaledZ,N,h.z,D,h.y).key]={backfilled:!1},h.y>0&&($[new a.aA(w.overscaledZ,P,h.z,S,h.y-1).key]={backfilled:!1},$[new a.aA(w.overscaledZ,w.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},$[new a.aA(w.overscaledZ,N,h.z,D,h.y-1).key]={backfilled:!1}),h.y+1<g&&($[new a.aA(w.overscaledZ,P,h.z,S,h.y+1).key]={backfilled:!1},$[new a.aA(w.overscaledZ,w.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},$[new a.aA(w.overscaledZ,N,h.z,D,h.y+1).key]={backfilled:!1}),$}},"raster-array":Ir,geojson:class extends a.E{constructor(w,h,g,S){super(),this.id=w,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(S),this._data=h.data,this._options=a.l({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.minzoom!==void 0&&(this.minzoom=h.minzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const P=a.ab/this.tileSize;this.workerOptions=a.l({source:this.id,scope:this.scope,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*P,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*P,extent:a.ab,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:a.ab,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*P,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter,dynamic:h.dynamic},h.workerOptions)}onAdd(w){this.map=w,this.setData(this._data)}setData(w){return this._data=w,this._updateWorkerData(),this}updateData(w){if(!this._options.dynamic)return this.fire(new a.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof w!="string"&&(w.type==="Feature"&&(w={type:"FeatureCollection",features:[w]}),w.type!=="FeatureCollection"))return this.fire(new a.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof w!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const h=new Map;for(const g of this._data.features)h.set(g.id,g);for(const g of w.features)h.set(g.id,g);this._data.features=[...h.values()]}else this._data=w;return this._updateWorkerData(!0),this}getClusterExpansionZoom(w,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:w,source:this.id,scope:this.scope},h),this}getClusterChildren(w,h){return this.actor.send("geojson.getClusterChildren",{clusterId:w,source:this.id,scope:this.scope},h),this}getClusterLeaves(w,h,g,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:w,limit:h,offset:g},S),this}_updateWorkerData(w=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.x("dataloading",{dataType:"source"})),this._loaded=!1;const h=a.l({append:w},this.workerOptions);h.scope=this.scope;const g=this._data;typeof g=="string"?(h.request=this.map._requestManager.transformRequest(a.q.resolveURL(g),a.R.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(g),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(S,P)=>{if(this._loaded=!0,this._pendingLoad=null,S)this.fire(new a.t(S));else{const D={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&P&&P.resourceTiming&&P.resourceTiming[this.id]&&(D.resourceTiming=P.resourceTiming[this.id]),w&&(this._partialReload=!0),this.fire(new a.x("data",D)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(w),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(w,h){const g=w.actor?"reloadTile":"loadTile";w.actor=this.actor;const S=this.map.style?this.map.style.getLut(this.scope):null,P=this._partialReload,D={type:this.type,uid:w.uid,tileID:w.tileID,tileZoom:w.tileZoom,zoom:w.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S?{image:S.image.clone()}:null,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:P};w.request=this.actor.send(g,D,(N,$)=>P&&!$?(w.state="loaded",h(null)):(delete w.request,w.destroy(),w.aborted?h(null):N?h(N):(w.loadVectorData($,this.map.painter,g==="reloadTile"),h(null))),void 0,g==="loadTile")}abortTile(w){w.request&&(w.request.cancel(),delete w.request),w.aborted=!0}unloadTile(w,h){this.actor.send("removeTile",{uid:w.uid,type:this.type,source:this.id,scope:this.scope}),w.destroy()}onRemove(w){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aD{constructor(w,h,g,S){super(w,h,g,S),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const w=this.options;this.urls=[];for(const h of w.urls)this.urls.push(this.map._requestManager.transformRequest(h,a.R.Source).url);a.aE(this.urls,(h,g)=>{this._loaded=!0,h?this.fire(new a.t(h)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(w){if(this.video){const h=this.video.seekable;w<h.start(0)||w>h.end(0)?this.fire(new a.t(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=w}}getVideo(){return this.video}onAdd(w){this.map||(this.map=w,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const w=this.map.painter.context,h=w.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(w,this.video,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(w)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aD,model:class extends a.E{constructor(w,h,g,S){super(),this.id=w,this.type="model",this.models=[],this._loaded=!1,this._options=h}load(){const w=[];for(const h in this._options.models){const g=this._options.models[h],S=a.aG(this.map._requestManager.transformRequest(g.uri,a.R.Model).url).then(P=>{if(!P)return;const D=a.aH(P),N=new a.aI(h,g.position,g.orientation,D);N.computeBoundsAndApplyParent(),this.models.push(N)}).catch(P=>{this.fire(new a.t(new Error(`Could not load model ${h} from ${g.uri}: ${P.message}`)))});w.push(S)}return Promise.allSettled(w).then(()=>{this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(h=>{this.fire(new a.t(new Error(`Could not load models: ${h.message}`)))})}onAdd(w){this.map=w,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(w,h){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(w,h,g,S){super(),this.type="batched-model",this.id=w,this.tileSize=512,this._options=h,this.tiles=this._options.tiles,this.maxzoom=h.maxzoom||19,this.minzoom=h.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=g,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(S)}onAdd(w){this.map=w,this.load()}load(w){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=pi(this._options,this.map._requestManager,h,g,(S,P)=>{this._tileJSONRequest=null,this._loaded=!0,S?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new a.t(S))):P&&(a.l(this,P),P.bounds&&(this.tileBounds=new zi(P.bounds,this.minzoom,this.maxzoom)),Dt(P.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),w&&w(S)})}hasTransition(){return!1}hasTile(w){return!this.tileBounds||this.tileBounds.contains(w.canonical)}loaded(){return this._loaded}loadTile(w,h){const g=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(g,a.R.Tile),data:void 0,uid:w.uid,tileID:w.tileID,tileZoom:w.tileZoom,zoom:w.tileID.overscaledZ,tileSize:this.tileSize*w.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:w.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(w.actor&&w.state!=="expired")if(w.state==="loading")w.reloadCallback=h;else{if(w.buckets){const D=Object.values(w.buckets);for(const N of D)N.dirty=!0;return void(w.state="loaded")}w.request=w.actor.send("reloadTile",S,P.bind(this))}else w.actor=this.dispatcher.getActor(),w.request=w.actor.send("loadTile",S,P.bind(this),void 0,!0);function P(D,N){return w.aborted?h(null):D&&D.status!==404?h(D):(N&&(N.resourceTiming&&(w.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&w.setExpiryData(N),w.buckets={...w.buckets,...N.buckets},N.featureIndex&&(w.latestFeatureIndex=N.featureIndex)),w.state="loaded",void h(null))}}serialize(){return a.l({},this._options)}},canvas:class extends a.aD{constructor(w,h,g,S){super(w,h,g,S),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(D=>typeof D!="number"))||this.fire(new a.t(new a.V(`sources.${w}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.t(new a.V(`sources.${w}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new a.t(new a.V(`sources.${w}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new a.t(new a.V(`sources.${w}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.t(new a.V(`sources.${w}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(w){this.map=w,this.load(),this.canvas&&this.animate&&this.play()}onRemove(w){this.pause()}prepare(){let w=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,w=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,w=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?!w&&!this._playing||this.texture instanceof a.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(h,this.canvas,h.gl.RGBA8,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const w of[this.canvas.width,this.canvas.height])if(isNaN(w)||w<=0)return!0;return!1}},custom:class extends a.E{constructor(w,h,g,S){super(),this.id=w,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=h,this.setEventedParent(S),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new zi(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),a.l(this,a.ar(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(w){this.map=w,this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(w),this.load()}onRemove(w){this._implementation.onRemove&&this._implementation.onRemove(w)}hasTile(w){if(this._implementation.hasTile){const{x:h,y:g,z:S}=w.canonical;return this._implementation.hasTile({x:h,y:g,z:S})}return!this.tileBounds||this.tileBounds.contains(w.canonical)}loadTile(w,h){const{x:g,y:S,z:P}=w.tileID.canonical,D=new AbortController;w.request=Promise.resolve(this._implementation.loadTile({x:g,y:S,z:P},{signal:D.signal})).then((function(N){return delete w.request,w.aborted?(w.state="unloaded",h(null)):N===void 0?(w.state="errored",h(null)):N===null?(this.loadTileData(w,{width:this.tileSize,height:this.tileSize,data:null}),w.state="loaded",h(null)):function($){return $ instanceof ImageData||$ instanceof HTMLCanvasElement||$ instanceof ImageBitmap||$ instanceof HTMLImageElement}(N)?(this.loadTileData(w,N),w.state="loaded",void h(null)):(w.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(N=>{N.code!==20&&(w.state="errored",h(N))}),w.request.cancel=()=>D.abort()}loadTileData(w,h){w.setTexture(h,this.map.painter)}unloadTile(w,h){if(w.texture&&w.texture instanceof a.T?(w.destroy(!0),w.texture&&w.texture instanceof a.T&&this.map.painter.saveTileTexture(w.texture)):w.destroy(),this._implementation.unloadTile){const{x:g,y:S,z:P}=w.tileID.canonical;this._implementation.unloadTile({x:g,y:S,z:P})}h&&h()}abortTile(w,h){w.request&&w.request.cancel&&(w.request.cancel(),delete w.request),h&&h()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(w=>({x:w.canonical.x,y:w.canonical.y,z:w.canonical.z}))}_clearTiles(){const w=a.av(this.id,this.scope);this.map.style.clearSource(w)}_update(){this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}}},Qi=function(w,h,g,S){const P=new er[h.type](w,h,g,S);if(P.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${P.id}`);return a.aJ(["load","abort","unload","serialize","prepare"],P),P};function Zr(w,h){const g=a.a6.mat4.identity([]);return a.a6.mat4.scale(g,g,[.5*w.width,.5*-w.height,1]),a.a6.mat4.translate(g,g,[1,-1,0]),a.a6.mat4.multiply(g,g,w.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(g)}function bs(w,h,g,S,P,D,N,$=!1){const Y=w.tilesIn(S,N,$);Y.sort(ks);const ee=[];for(const le of Y)ee.push({wrappedTileID:le.tile.tileID.wrapped().key,queryResults:le.tile.queryRenderedFeatures(h,g,w._state,le,P,D,Zr(w.transform,le.tile.tileID),$)});const te=function(le){const ce={},de={};for(const xe of le){const be=xe.queryResults,Se=xe.wrappedTileID,Te=de[Se]=de[Se]||{};for(const Oe in be){const Ge=be[Oe],Be=Te[Oe]=Te[Oe]||{},Xe=ce[Oe]=ce[Oe]||[];for(const $e of Ge)Be[$e.featureIndex]||(Be[$e.featureIndex]=!0,Xe.push($e))}}return ce}(ee);for(const le in te)te[le].forEach(ce=>{const de=ce.feature,xe=de.layer;xe&&xe.type!=="background"&&xe.type!=="sky"&&xe.type!=="slot"&&(de.source=xe.source,xe["source-layer"]&&(de.sourceLayer=xe["source-layer"]),de.state=de.id!==void 0?w.getFeatureState(xe["source-layer"],de.id):{})});return te}function Yo(w,h){const g=w.getRenderableIds().map(D=>w.getTileByID(D)),S=[],P={};for(let D=0;D<g.length;D++){const N=g[D],$=N.tileID.canonical.key;P[$]||(P[$]=!0,N.querySourceFeatures(S,h))}return S}function ks(w,h){const g=w.tileID,S=h.tileID;return g.overscaledZ-S.overscaledZ||g.canonical.y-S.canonical.y||g.wrap-S.wrap||g.canonical.x-S.canonical.x}const ms=32,ki=33,co=new Uint16Array(8184);for(let w=0;w<2046;w++){let h=w+2,g=0,S=0,P=0,D=0,N=0,$=0;for(1&h?P=D=N=ms:g=S=$=ms;(h>>=1)>1;){const ee=g+P>>1,te=S+D>>1;1&h?(P=g,D=S,g=N,S=$):(g=P,S=D,P=N,D=$),N=ee,$=te}const Y=4*w;co[Y+0]=g,co[Y+1]=S,co[Y+2]=P,co[Y+3]=D}const Bo=new Uint16Array(2178),Cs=new Uint8Array(1089),Nc=new Uint16Array(1089);function Da(w){return w===0?-.03125:w===32?.03125:0}const gf={type:2,extent:a.ab,loadGeometry:()=>[[new a.P(0,0),new a.P(a.ab+1,0),new a.P(a.ab+1,a.ab+1),new a.P(0,a.ab+1),new a.P(0,0)]]};class zc{constructor(h,g,S,P,D){this.tileID=h,this.uid=a.aP(),this.uses=0,this.tileSize=g,this.tileZoom=S,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=D,P&&P.style&&(this._lastUpdatedBrightness=P.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",P&&P.transform&&(this.projection=P.transform.projection)}registerFadeDuration(h){const g=h+this.timeAdded;g<a.q.now()||this.fadeEndTime&&g<this.fadeEndTime||(this.fadeEndTime=g)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(h,g,S){if(this.unloadVectorData(),this.state="loaded",h){h.featureIndex&&(this.latestFeatureIndex=h.featureIndex,h.rawTileData?(this.latestRawTileData=h.rawTileData,this.latestFeatureIndex.rawTileData=h.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=h.collisionBoxArray,this.buckets=function(P,D){const N={};if(!D)return N;for(const $ of P){const Y=$.layerIds.map(ee=>D.getLayer(ee)).filter(Boolean);if(Y.length!==0){$.layers=Y,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(ee=>Y.filter(te=>te.id===ee)[0]));for(const ee of Y)N[ee.fqid]=$}}return N}(h.buckets,g.style),this.hasSymbolBuckets=!1;for(const P in this.buckets){const D=this.buckets[P];if(D instanceof a.aR){if(this.hasSymbolBuckets=!0,!S)break;D.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const P in this.buckets){const D=this.buckets[P];if(D instanceof a.aR&&D.hasRTLText){this.hasRTLText=!0,a.aS();break}}this.queryPadding=0;for(const P in this.buckets){const D=this.buckets[P],N=g.style.getOwnLayer(P);if(!N)continue;const $=N.queryRadius(D);this.queryPadding=Math.max(this.queryPadding,$)}h.imageAtlas&&(this.imageAtlas=h.imageAtlas),h.glyphAtlasImage&&(this.glyphAtlasImage=h.glyphAtlasImage),h.lineAtlas&&(this.lineAtlas=h.lineAtlas),this._lastUpdatedBrightness=h.brightness}else this.collisionBoxArray=new a.aQ}unloadVectorData(){if(this.hasData()){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(h){return this.buckets[h.fqid]}upload(h){for(const P in this.buckets){const D=this.buckets[P];D.uploadPending()&&D.upload(h)}const g=h.gl,S=this.imageAtlas;if(S&&!S.uploaded){const P=!!Object.keys(S.patternPositions).length;this.imageAtlasTexture=new a.T(h,S.image,g.RGBA8,{useMipmap:P}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(h,this.glyphAtlasImage,g.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(h,this.lineAtlas.image,g.R8),this.lineAtlas.uploaded=!0)}prepare(h,g,S){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(h,this.imageAtlasTexture,S),!g||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const P=g.style.getBrightness();(this._lastUpdatedBrightness||P)&&(this._lastUpdatedBrightness&&P&&Math.abs(this._lastUpdatedBrightness-P)<.001||(this._lastUpdatedBrightness=P,this.updateBuckets(g)))}queryRenderedFeatures(h,g,S,P,D,N,$,Y){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:P,pixelPosMatrix:$,transform:N,params:D,tileTransform:this.tileTransform},h,g,S):{}}querySourceFeatures(h,g){const S=this.latestFeatureIndex;if(!S||!S.rawTileData)return;const P=S.loadVTLayers(),D=g?g.sourceLayer:"",N=P._geojsonTileLayer||P[D];if(!N)return;const $=a.aT(g&&g.filter),{z:Y,x:ee,y:te}=this.tileID.canonical,le={z:Y,x:ee,y:te};for(let ce=0;ce<N.length;ce++){const de=N.feature(ce);if($.needGeometry){const Se=a.aU(de,!0);if(!$.filter(new a.a3(this.tileID.overscaledZ),Se,this.tileID.canonical))continue}else if(!$.filter(new a.a3(this.tileID.overscaledZ),de))continue;const xe=S.getId(de,D),be=new a.aV(de,Y,ee,te,xe);be.tile=le,h.push(be)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(h){const g=this.expirationTime;if(h.cacheControl){const S=a.aW(h.cacheControl);S["max-age"]&&(this.expirationTime=Date.now()+1e3*S["max-age"])}else h.expires&&(this.expirationTime=new Date(h.expires).getTime());if(this.expirationTime){const S=Date.now();let P=!1;if(this.expirationTime>S)P=!1;else if(g)if(this.expirationTime<g)P=!0;else{const D=this.expirationTime-g;D?this.expirationTime=S+Math.max(D,3e4):P=!0}else P=!0;P?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(h,g){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(h).length!==0&&g&&this.updateBuckets(g)}updateBuckets(h){if(!this.latestFeatureIndex)return;const g=this.latestFeatureIndex.loadVTLayers(),S=h.style.listImages(),P=h.style.getBrightness();for(const D in this.buckets){if(!h.style.hasLayer(D))continue;const N=this.buckets[D],$=N.layers[0].sourceLayer||"_geojsonTileLayer",Y=g[$],ee=h.style.getOwnSourceCache(N.layers[0].source);let te={};ee&&(te=ee._state.getState($,void 0)),N.update(te,Y,S,this.imageAtlas&&this.imageAtlas.patternPositions||{},P),(N instanceof a.aX||N instanceof a.aY)&&h._terrain&&h._terrain.enabled&&ee&&N.programConfigurations.needsUpload&&h._terrain._clearRenderCacheForTile(ee.id,this.tileID);const le=h&&h.style&&h.style.getOwnLayer(D);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(h){this.symbolFadeHoldUntil=a.q.now()+h}setTexture(h,g){const S=g.context,P=S.gl;this.texture=this.texture||g.getTileTexture(h.width),this.texture&&this.texture instanceof a.T?this.texture.update(h):(this.texture=new a.T(S,h,P.RGBA8,{useMipmap:!0}),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE))}setDependencies(h,g){const S={};for(const P of g)S[P]=!0;this.dependencies[h]=S}hasDependency(h,g){for(const S of h){const P=this.dependencies[S];if(P){for(const D of g)if(P[D])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(h,g){if(!g||g.name==="mercator"||this._tileDebugBuffer)return;const S=a.aZ(gf,this.tileID.canonical,this.tileTransform)[0],P=new a.a_,D=new a.a$;for(let N=0;N<S.length;N++){const{x:$,y:Y}=S[N];P.emplaceBack($,Y),D.emplaceBack(N)}D.emplaceBack(0),this._tileDebugIndexBuffer=h.createIndexBuffer(D),this._tileDebugBuffer=h.createVertexBuffer(P,a.b0.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,P.length,D.length)}_makeTileBoundsBuffers(h,g){if(this._tileBoundsBuffer||!g||g.name==="mercator")return;const S=a.aZ(gf,this.tileID.canonical,this.tileTransform)[0];let P,D;if(this.isRaster){const N=function($,Y){const ee=a.aK($,Y),te=Math.pow(2,$.z);for(let Se=0;Se<ki;Se++)for(let Te=0;Te<ki;Te++){const Oe=a.aL(($.x+(Te+Da(Te))/ms)/te),Ge=a.aM(($.y+(Se+Da(Se))/ms)/te),Be=Y.project(Oe,Ge),Xe=Se*ki+Te;Bo[2*Xe+0]=Math.round((Be.x*ee.scale-ee.x)*a.ab),Bo[2*Xe+1]=Math.round((Be.y*ee.scale-ee.y)*a.ab)}Cs.fill(0),Nc.fill(0);for(let Se=2045;Se>=0;Se--){const Te=4*Se,Oe=co[Te+0],Ge=co[Te+1],Be=co[Te+2],Xe=co[Te+3],$e=Oe+Be>>1,tt=Ge+Xe>>1,Je=$e+tt-Ge,nt=tt+Oe-$e,ht=Ge*ki+Oe,at=Xe*ki+Be,st=tt*ki+$e,wt=Math.hypot((Bo[2*ht+0]+Bo[2*at+0])/2-Bo[2*st+0],(Bo[2*ht+1]+Bo[2*at+1])/2-Bo[2*st+1])>=16;Cs[st]=Cs[st]||(wt?1:0),Se<1022&&(Cs[st]=Cs[st]||Cs[(Ge+nt>>1)*ki+(Oe+Je>>1)]||Cs[(Xe+nt>>1)*ki+(Be+Je>>1)])}const le=new a.aN,ce=new a.aO;let de=0;function xe(Se,Te){const Oe=Te*ki+Se;return Nc[Oe]===0&&(le.emplaceBack(Bo[2*Oe+0],Bo[2*Oe+1],Se*a.ab/ms,Te*a.ab/ms),Nc[Oe]=++de),Nc[Oe]-1}function be(Se,Te,Oe,Ge,Be,Xe){const $e=Se+Oe>>1,tt=Te+Ge>>1;if(Math.abs(Se-Be)+Math.abs(Te-Xe)>1&&Cs[tt*ki+$e])be(Be,Xe,Se,Te,$e,tt),be(Oe,Ge,Be,Xe,$e,tt);else{const Je=xe(Se,Te),nt=xe(Oe,Ge),ht=xe(Be,Xe);ce.emplaceBack(Je,nt,ht)}}return be(0,0,ms,ms,ms,0),be(ms,ms,0,0,0,ms),{vertices:le,indices:ce}}(this.tileID.canonical,g);P=N.vertices,D=N.indices}else{P=new a.aN,D=new a.aO;for(const{x:$,y:Y}of S)P.emplaceBack($,Y,0,0);const N=a.b2(P.int16,void 0,4);for(let $=0;$<N.length;$+=3)D.emplaceBack(N[$],N[$+1],N[$+2])}this._tileBoundsBuffer=h.createVertexBuffer(P,a.b3.members),this._tileBoundsIndexBuffer=h.createIndexBuffer(D),this._tileBoundsSegments=a.b1.simpleSegment(0,0,P.length,D.length)}_makeGlobeTileDebugBuffers(h,g){const S=g.projection;if(!S||S.name!=="globe"||g.freezeTileCoverage)return;const P=this.tileID.canonical,D=a.b4(P,g),N=a.b5(D),$=a.a9(g.zoom);let Y;$>0&&(Y=a.a6.mat4.invert(new Float64Array(16),g.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(h,P,g,N,Y,$),this._makeGlobeTileDebugTextBuffer(h,P,g,N,Y,$)}_globePoint(h,g,S,P,D,N,$){let Y=a.b6(h,g,S);if(N){const ee=1<<S.z,te=a.am(P.center.lng),le=a.at(P.center.lat),ce=(S.x+.5)/ee-te;let de=0;ce>.5?de=-1:ce<-.5&&(de=1);let xe=(h/a.ab+S.x)/ee+de,be=(g/a.ab+S.y)/ee;xe=(xe-te)*P._pixelsPerMercatorPixel+te,be=(be-le)*P._pixelsPerMercatorPixel+le;const Se=[xe*P.worldSize,be*P.worldSize,0];a.a6.vec3.transformMat4(Se,Se,N),Y=a.b7(Y,Se,$)}return a.a6.vec3.transformMat4(Y,Y,D)}_makeGlobeTileDebugBorderBuffer(h,g,S,P,D,N){const $=new a.a_,Y=new a.a$,ee=new a.b8,te=(ce,de,xe,be,Se)=>{const Te=(xe-ce)/(Se-1),Oe=(be-de)/(Se-1),Ge=$.length;for(let Be=0;Be<Se;Be++){const Xe=ce+Be*Te,$e=de+Be*Oe;$.emplaceBack(Xe,$e);const tt=this._globePoint(Xe,$e,g,S,P,D,N);ee.emplaceBack(tt[0],tt[1],tt[2]),Y.emplaceBack(Ge+Be)}},le=a.ab;te(0,0,le,0,16),te(le,0,le,le,16),te(le,le,0,le,16),te(0,le,0,0,16),this._tileDebugIndexBuffer=h.createIndexBuffer(Y),this._tileDebugBuffer=h.createVertexBuffer($,a.b0.members),this._globeTileDebugBorderBuffer=h.createVertexBuffer(ee,a.b9.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,$.length,Y.length)}_makeGlobeTileDebugTextBuffer(h,g,S,P,D,N){const $=a.ab/4,Y=new a.a_,ee=new a.aO,te=new a.b8,le=25;ee.reserve(32),Y.reserve(le),te.reserve(le);const ce=(de,xe)=>le*de+xe;for(let de=0;de<le;de++){const xe=de*$;for(let be=0;be<le;be++){const Se=be*$;Y.emplaceBack(Se,xe);const Te=this._globePoint(Se,xe,g,S,P,D,N);te.emplaceBack(Te[0],Te[1],Te[2])}}for(let de=0;de<4;de++)for(let xe=0;xe<4;xe++){const be=ce(de,xe),Se=ce(de,xe+1),Te=ce(de+1,xe),Oe=ce(de+1,xe+1);ee.emplaceBack(be,Se,Te),ee.emplaceBack(Te,Se,Oe)}this._tileDebugTextIndexBuffer=h.createIndexBuffer(ee),this._tileDebugTextBuffer=h.createVertexBuffer(Y,a.b0.members),this._globeTileDebugTextBuffer=h.createVertexBuffer(te,a.b9.members),this._tileDebugTextSegments=a.b1.simpleSegment(0,0,le,32)}destroy(h=!1){for(const g in this.buckets)this.buckets[g].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!h&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.ba.setPbf(a.bb);class gg extends zc{constructor(h,g,S,P,D){super(h,g,S,P,D),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(h,g){const S=g.context,P=S.gl;this.texture=this.texture||g.getTileTexture(h.width),this.texture&&this.texture instanceof a.T?this.texture.update(h,{premultiply:!1}):this.texture=new a.T(S,h,P.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(h=16384,g){const S=this._mrt=new a.ba(30),P=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(h-1)}});return this.entireBuffer=null,this.request=a.bc(P,(D,N,$,Y)=>{if(D)g(D);else try{const ee=S.getHeaderLength(N);if(ee>h)return void(this.request=this.fetchHeader(ee,g));S.parseHeader(N),this._isHeaderLoaded=!0;let te=0;for(const le of Object.values(S.layers))te=Math.max(te,le.dataIndex[le.dataIndex.length-1].last_byte);N.byteLength>=te&&(this.entireBuffer=N),g(null,this.entireBuffer||N,$,Y)}catch(ee){g(ee)}}),this.request}fetchBand(h,g,S){const P=this._mrt;if(!this._isHeaderLoaded||!P)return void S(new Error("Tile header is not ready"));const D=this.actor;if(!D)return void S(new Error("Can't fetch tile band without an actor"));let N;const $=(le,ce)=>{N.complete(le,ce),le?S(le):(this.updateTextureDescriptor(h,g),S(null,this.textureDescriptor&&this.textureDescriptor.img))},Y=(le,ce)=>{if(le)return S(le);const de=D.send("decodeRasterArray",{buffer:ce,task:N},$,void 0,!0);this._workQueue.push(()=>{de&&de.cancel(),N.cancel()})},ee=P.getLayer(h);if(!ee)return void S(new Error(`Unknown sourceLayer "${h}"`));if(ee.hasDataForBand(g))return this.updateTextureDescriptor(h,g),void S(null,this.textureDescriptor?this.textureDescriptor.img:null);const te=ee.getDataRange([g]);if(N=P.createDecodingTask(te),!N||N.tasks.length)if(this.flushQueues(),this.entireBuffer)Y(null,this.entireBuffer.slice(te.firstByte,te.lastByte+1));else{const le=Object.assign({},this.requestParams,{headers:{Range:`bytes=${te.firstByte}-${te.lastByte}`}}),ce=a.bc(le,Y);this._fetchQueue.push(()=>{ce.cancel(),N.cancel()})}else S(null)}updateNeeded(h,g){return(!this.textureDescriptor||this.textureDescriptor.band!==g||this.textureDescriptor.layer!==h)&&this.state!=="errored"}updateTextureDescriptor(h,g){if(!this._mrt)return;const S=this._mrt.getLayer(h);if(!S||!S.hasBand(g)||!S.hasDataForBand(g))return;const{bytes:P,tileSize:D,buffer:N,offset:$,scale:Y}=S.getBandView(g),ee=D+2*N,te={data:P,width:ee,height:ee},le=this.texture;le&&le instanceof a.T&&le.update(te,{premultiply:!1}),this.textureDescriptor={layer:h,band:g,img:te,buffer:N,offset:$,tileSize:D,format:S.pixelFormat,mix:[Y,256*Y,65536*Y,16777216*Y]}}}class Dp{constructor(h,g){this.max=h,this.onRemove=g,this.reset()}reset(){for(const h in this.data)for(const g of this.data[h])g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value);return this.data={},this.order=[],this}add(h,g,S){const P=h.wrapped().key;this.data[P]===void 0&&(this.data[P]=[]);const D={value:g,timeout:void 0};if(S!==void 0&&(D.timeout=setTimeout(()=>{this.remove(h,D)},S)),this.data[P].push(D),this.order.push(P),this.order.length>this.max){const N=this._getAndRemoveByKey(this.order[0]);N&&this.onRemove(N)}return this}has(h){return h.wrapped().key in this.data}getAndRemove(h){return this.has(h)?this._getAndRemoveByKey(h.wrapped().key):null}_getAndRemoveByKey(h){const g=this.data[h].shift();return g.timeout&&clearTimeout(g.timeout),this.data[h].length===0&&delete this.data[h],this.order.splice(this.order.indexOf(h),1),g.value}getByKey(h){const g=this.data[h];return g?g[0].value:null}get(h){return this.has(h)?this.data[h.wrapped().key][0].value:null}remove(h,g){if(!this.has(h))return this;const S=h.wrapped().key,P=g===void 0?0:this.data[S].indexOf(g),D=this.data[S][P];return this.data[S].splice(P,1),D.timeout&&clearTimeout(D.timeout),this.data[S].length===0&&delete this.data[S],this.onRemove(D.value),this.order.splice(this.order.indexOf(S),1),this}setMaxSize(h){for(this.max=h;this.order.length>this.max;){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}filter(h){const g=[];for(const S in this.data)for(const P of this.data[S])h(P.value)||g.push(P);for(const S of g)this.remove(S.value.tileID,S)}}class vg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(h,g,S){const P=String(g);if(this.stateChanges[h]=this.stateChanges[h]||{},this.stateChanges[h][P]=this.stateChanges[h][P]||{},a.l(this.stateChanges[h][P],S),this.deletedStates[h]===null){this.deletedStates[h]={};for(const D in this.state[h])D!==P&&(this.deletedStates[h][D]=null)}else if(this.deletedStates[h]&&this.deletedStates[h][P]===null){this.deletedStates[h][P]={};for(const D in this.state[h][P])S[D]||(this.deletedStates[h][P][D]=null)}else for(const D in S)this.deletedStates[h]&&this.deletedStates[h][P]&&this.deletedStates[h][P][D]===null&&delete this.deletedStates[h][P][D]}removeFeatureState(h,g,S){if(this.deletedStates[h]===null)return;const P=String(g);if(this.deletedStates[h]=this.deletedStates[h]||{},S&&g!==void 0)this.deletedStates[h][P]!==null&&(this.deletedStates[h][P]=this.deletedStates[h][P]||{},this.deletedStates[h][P][S]=null);else if(g!==void 0)if(this.stateChanges[h]&&this.stateChanges[h][P])for(S in this.deletedStates[h][P]={},this.stateChanges[h][P])this.deletedStates[h][P][S]=null;else this.deletedStates[h][P]=null;else this.deletedStates[h]=null}getState(h,g){const S=this.state[h]||{},P=this.stateChanges[h]||{},D=this.deletedStates[h];if(D===null)return{};if(g!==void 0){const $=String(g),Y=a.l({},S[$],P[$]);if(D){const ee=D[g];if(ee===null)return{};for(const te in ee)delete Y[te]}return Y}const N=a.l({},S,P);if(D)for(const $ in D)delete N[$];return N}initializeTileState(h,g){h.setFeatureState(this.state,g)}coalesceChanges(h,g){const S={};for(const P in this.stateChanges){this.state[P]=this.state[P]||{};const D={};for(const N in this.stateChanges[P])this.state[P][N]||(this.state[P][N]={}),a.l(this.state[P][N],this.stateChanges[P][N]),D[N]=this.state[P][N];S[P]=D}for(const P in this.deletedStates){this.state[P]=this.state[P]||{};const D={};if(this.deletedStates[P]===null)for(const N in this.state[P])D[N]={},this.state[P][N]={};else for(const N in this.deletedStates[P]){if(this.deletedStates[P][N]===null)this.state[P][N]={};else if(this.state[P][N])for(const $ of Object.keys(this.deletedStates[P][N]))delete this.state[P][N][$];D[N]=this.state[P][N]}S[P]=S[P]||{},a.l(S[P],D)}if(this.stateChanges={},this.deletedStates={},Object.keys(S).length!==0)for(const P in h)h[P].setFeatureState(S,g)}}class Zo extends a.E{constructor(h,g,S){super(),this.id=h,this._onlySymbols=S,g.on("data",P=>{P.dataType==="source"&&P.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&P.dataType==="source"&&P.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),g.on("error",()=>{this._sourceErrored=!0}),this._source=g,this._tiles={},this._cache=new Dp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new vg,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(h){this.map=h,this._minTileCacheSize=this._minTileCacheSize===void 0&&h?h._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&h?h._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const h in this._tiles){const g=this._tiles[h];if(g.state!=="loaded"&&g.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(h,g){return h.isSymbolTile=this._onlySymbols,h.isExtraShadowCaster=this._shadowCasterTiles[h.tileID.key],this._source.loadTile(h,g)}_unloadTile(h){if(this._source.unloadTile)return this._source.unloadTile(h)}_abortTile(h){if(this._source.abortTile)return this._source.abortTile(h)}serialize(){return this._source.serialize()}prepare(h){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const g in this._tiles){const S=this._tiles[g];S.upload(h),S.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return a.bd(this._tiles).map(h=>h.tileID).sort(tc).map(h=>h.key)}getRenderableIds(h,g){const S=[];for(const P in this._tiles)this._isIdRenderable(+P,h,g)&&S.push(this._tiles[P]);return h?S.sort((P,D)=>{const N=P.tileID,$=D.tileID,Y=new a.P(N.canonical.x,N.canonical.y)._rotate(this.transform.angle),ee=new a.P($.canonical.x,$.canonical.y)._rotate(this.transform.angle);return N.overscaledZ-$.overscaledZ||ee.y-Y.y||ee.x-Y.x}).map(P=>P.tileID.key):S.map(P=>P.tileID).sort(tc).map(P=>P.key)}hasRenderableParent(h){const g=this.findLoadedParent(h,0);return!!g&&this._isIdRenderable(g.tileID.key)}_isIdRenderable(h,g,S){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(g||!this._tiles[h].holdingForFade())&&(S||!this._shadowCasterTiles[h])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const h in this._tiles)this._tiles[h].state!=="errored"&&this._reloadTile(+h,"reloading")}}_reloadTile(h,g){const S=this._tiles[h];S&&(S.state!=="loading"&&(S.state=g),this._loadTile(S,this._tileLoaded.bind(this,S,h,g)))}_tileLoaded(h,g,S,P){if(P)if(h.state="errored",P.status!==404)this._source.fire(new a.t(P,{tile:h}));else{if(this._source.fire(new a.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:h})),!(h.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const D=this.map.painter.terrain;this.update(this.transform,D.getScaledDemTileSize(),!0),D.resetTileLookupCache(this.id)}else this.update(this.transform)}else h.timeAdded=a.q.now(),S==="expired"&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(g,h),this._source.type==="raster-dem"&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new a.x("data",{dataType:"source",tile:h,coord:h.tileID,sourceCacheId:this.id}))}_backfillDEM(h){const g=this.getRenderableIds();for(let P=0;P<g.length;P++){const D=g[P];if(h.neighboringTiles&&h.neighboringTiles[D]){const N=this.getTileByID(D);S(h,N),S(N,h)}}function S(P,D){if(!P.dem||P.dem.borderReady)return;P.needsHillshadePrepare=!0,P.needsDEMTextureUpload=!0;let N=D.tileID.canonical.x-P.tileID.canonical.x;const $=D.tileID.canonical.y-P.tileID.canonical.y,Y=Math.pow(2,P.tileID.canonical.z),ee=D.tileID.key;N===0&&$===0||Math.abs($)>1||(Math.abs(N)>1&&(Math.abs(N+Y)===1?N+=Y:Math.abs(N-Y)===1&&(N-=Y)),D.dem&&P.dem&&(P.dem.backfillBorder(D.dem,N,$),P.neighboringTiles&&P.neighboringTiles[ee]&&(P.neighboringTiles[ee].backfilled=!0)))}}getTile(h){return this.getTileByID(h.key)}getTileByID(h){return this._tiles[h]}_retainLoadedChildren(h,g,S,P){for(const D in this._tiles){let N=this._tiles[D];if(P[D]||!N.hasData()||N.tileID.overscaledZ<=g||N.tileID.overscaledZ>S)continue;let $=N.tileID;for(;N&&N.tileID.overscaledZ>g+1;){const ee=N.tileID.scaledTo(N.tileID.overscaledZ-1);N=this._tiles[ee.key],N&&N.hasData()&&($=ee)}let Y=$;for(;Y.overscaledZ>g;)if(Y=Y.scaledTo(Y.overscaledZ-1),h[Y.key]){P[$.key]=$;break}}}findLoadedParent(h,g){if(h.key in this._loadedParentTiles){const S=this._loadedParentTiles[h.key];return S&&S.tileID.overscaledZ>=g?S:null}for(let S=h.overscaledZ-1;S>=g;S--){const P=h.scaledTo(S),D=this._getLoadedTile(P);if(D)return D}}_getLoadedTile(h){const g=this._tiles[h.key];return g&&g.hasData()?g:this._cache.getByKey(this._source.reparseOverscaled?h.wrapped().key:h.canonical.key)}updateCacheSize(h,g){g=g||this._source.tileSize;const S=Math.ceil(h.width/g)+1,P=Math.ceil(h.height/g)+1,D=Math.floor(S*P*5),N=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,D):D,$=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,N):N;this._cache.setMaxSize($)}handleWrapJump(h){const g=Math.round((h-(this._prevLng===void 0?h:this._prevLng))/360);if(this._prevLng=h,g){const S={};for(const P in this._tiles){const D=this._tiles[P];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+g),S[D.tileID.key]=D}this._tiles=S;for(const P in this._timers)clearTimeout(this._timers[P]),delete this._timers[P];for(const P in this._tiles)this._setTileReloadTimer(+P,this._tiles[P])}}update(h,g,S,P){if(this.transform=h,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!S)return;this.updateCacheSize(h,g),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const D=this._source.type==="batched-model";let N;if(this.used||this.usedForTerrain){if(this._source.tileID)N=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(ee=>new a.aA(ee.canonical.z,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y));else if(this.tileCoverLift!==0){const ee=h.clone();ee.tileCoverLift=this.tileCoverLift,N=ee.coveringTiles({tileSize:g||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!S,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:D}),this._source.minzoom<=1&&h.projection.name==="globe"&&(N.push(new a.aA(1,0,1,0,0)),N.push(new a.aA(1,0,1,1,0)),N.push(new a.aA(1,0,1,0,1)),N.push(new a.aA(1,0,1,1,1)))}else if(N=h.coveringTiles({tileSize:g||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!S,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:D}),this._source.hasTile){const ee=this._source.hasTile.bind(this._source);N=N.filter(te=>ee(te))}}else N=[];if(N.length>0&&this.castsShadows&&P&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Bp(this._source.type)){const ee=h.coveringZoomLevel({tileSize:g||this._source.tileSize,roundZoom:this._source.roundZoom&&!S}),te=Math.min(ee,this._source.maxzoom);if(D){const le=h.extendTileCover(N,te);for(const ce of le)N.push(ce)}else{const le=h.extendTileCover(N,te,P);for(const ce of le)this._shadowCasterTiles[ce.key]=!0,N.push(ce)}}const $=this._updateRetainedTiles(N);if(Bp(this._source.type)&&N.length!==0){const ee={},te={},le=Object.keys($);for(const de of le){const xe=$[de],be=this._tiles[de];if(!be||be.fadeEndTime&&be.fadeEndTime<=a.q.now())continue;const Se=this.findLoadedParent(xe,Math.max(xe.overscaledZ-Zo.maxOverzooming,this._source.minzoom));Se&&(this._addTile(Se.tileID),ee[Se.tileID.key]=Se.tileID),te[de]=xe}const ce=N[N.length-1].overscaledZ;for(const de in this._tiles){const xe=this._tiles[de];if($[de]||!xe.hasData())continue;let be=xe.tileID;for(;be.overscaledZ>ce;){be=be.scaledTo(be.overscaledZ-1);const Se=this._tiles[be.key];if(Se&&Se.hasData()&&te[be.key]){$[de]=xe.tileID;break}}}for(const de in ee)$[de]||(this._coveredTiles[de]=!0,$[de]=ee[de])}for(const ee in $)this._tiles[ee].clearFadeHold();const Y=a.be(this._tiles,$);for(const ee of Y){const te=this._tiles[ee];te.hasSymbolBuckets&&!te.holdingForFade()?te.setHoldDuration(this.map._fadeDuration):te.hasSymbolBuckets&&!te.symbolFadeFinished()||this._removeTile(+ee)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(+h)}_updateRetainedTiles(h){const g={};if(h.length===0)return g;const S={},P=h.reduce((ee,te)=>Math.min(ee,te.overscaledZ),1/0),D=h[0].overscaledZ,N=Math.max(D-Zo.maxOverzooming,this._source.minzoom),$=Math.max(D+Zo.maxUnderzooming,this._source.minzoom),Y={};for(const ee of h){const te=this._addTile(ee);g[ee.key]=ee,te.hasData()||P<this._source.maxzoom&&(Y[ee.key]=ee)}this._retainLoadedChildren(Y,P,$,g);for(const ee of h){let te=this._tiles[ee.key];if(te.hasData())continue;if(ee.canonical.z>=this._source.maxzoom){const ce=ee.children(this._source.maxzoom)[0],de=this.getTile(ce);if(de&&de.hasData()){g[ce.key]=ce;continue}}else{const ce=ee.children(this._source.maxzoom);if(g[ce[0].key]&&g[ce[1].key]&&g[ce[2].key]&&g[ce[3].key])continue}let le=te.wasRequested();for(let ce=ee.overscaledZ-1;ce>=N;--ce){const de=ee.scaledTo(ce);if(S[de.key]||(S[de.key]=!0,te=this.getTile(de),!te&&le&&(te=this._addTile(de)),te&&(g[de.key]=de,le=te.wasRequested(),te.hasData())))break}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const h in this._tiles){const g=[];let S,P=this._tiles[h].tileID;for(;P.overscaledZ>0;){if(P.key in this._loadedParentTiles){S=this._loadedParentTiles[P.key];break}g.push(P.key);const D=P.scaledTo(P.overscaledZ-1);if(S=this._getLoadedTile(D),S)break;P=D}for(const D of g)this._loadedParentTiles[D]=S}}_addTile(h){let g=this._tiles[h.key];if(g)return g.isExtraShadowCaster!==!0||this._shadowCasterTiles[h.key]||this._reloadTile(h.key,"reloading"),g;g=this._cache.getAndRemove(h),g&&(this._setTileReloadTimer(h.key,g),g.tileID=h,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,g)));const S=!!g;if(!S){const P=this.map?this.map.painter:null,D=this._source.tileSize*h.overscaleFactor();g=this._source.type==="raster-array"?new gg(h,D,this.transform.tileZoom,P,this._isRaster):new zc(h,D,this.transform.tileZoom,P,this._isRaster),this._loadTile(g,this._tileLoaded.bind(this,g,h.key,g.state))}return g?(g.uses++,this._tiles[h.key]=g,S||this._source.fire(new a.x("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null}_setTileReloadTimer(h,g){h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);const S=g.getExpiryTimeout();S&&(this._timers[h]=setTimeout(()=>{this._reloadTile(h,"expired"),delete this._timers[h]},S))}_removeTile(h){const g=this._tiles[h];g&&(g.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),g.uses>0||(g.hasData()&&g.state!=="reloading"||g.state==="empty"?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const h in this._tiles)this._removeTile(+h);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(h,g,S){const P=[],D=this.transform;if(!D)return P;const N=D.projection.name==="globe",$=a.am(D.center.lng);for(const Y in this._tiles){const ee=this._tiles[Y];if(S&&ee.clearQueryDebugViz(),ee.holdingForFade())continue;let te;if(N){const le=ee.tileID.canonical;if(le.z===0){const ce=[Math.abs(a.ap($,...vf(le,-1))-$),Math.abs(a.ap($,...vf(le,1))-$)];te=[0,2*ce.indexOf(Math.min(...ce))-1]}else{const ce=[Math.abs(a.ap($,...vf(le,-1))-$),Math.abs(a.ap($,...vf(le,0))-$),Math.abs(a.ap($,...vf(le,1))-$)];te=[ce.indexOf(Math.min(...ce))-1]}}else te=[0];for(const le of te){const ce=h.containsTile(ee,D,g,le);ce&&P.push(ce)}}return P}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(h){return this._getRenderableCoordinates(h)}_getRenderableCoordinates(h,g){const S=this.getRenderableIds(h,g).map(D=>this._tiles[D].tileID),P=this.transform.projection.name==="globe";for(const D of S)D.projMatrix=this.transform.calculateProjMatrix(D.toUnwrapped()),D.expandedProjMatrix=P?this.transform.calculateProjMatrix(D.toUnwrapped(),!1,!0):D.projMatrix;return S}sortCoordinatesByDistance(h){const g=h.slice(),S=this.transform._camera.position,P=this.transform._camera.forward(),D={};for(const N of g){const $=1/(1<<N.canonical.z);D[N.key]=((N.canonical.x+.5)*$+N.wrap-S[0])*P[0]+((N.canonical.y+.5)*$-S[1])*P[1]-S[2]*P[2]}return g.sort((N,$)=>D[N.key]-D[$.key]),g}hasTransition(){if(this._source.hasTransition())return!0;if(Bp(this._source.type))for(const h in this._tiles){const g=this._tiles[h];if(g.fadeEndTime!==void 0&&g.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(h,g,S){this._state.updateState(h=h||"_geojsonTileLayer",g,S)}removeFeatureState(h,g,S){this._state.removeFeatureState(h=h||"_geojsonTileLayer",g,S)}getFeatureState(h,g){return this._state.getState(h=h||"_geojsonTileLayer",g)}setDependencies(h,g,S){const P=this._tiles[h];P&&P.setDependencies(g,S)}reloadTilesForDependencies(h,g){for(const S in this._tiles)this._tiles[S].hasDependency(h,g)&&this._reloadTile(+S,"reloading");this._cache.filter(S=>!S.hasDependency(h,g))}_preloadTiles(h,g){if(!this._sourceLoaded){const Y=()=>{this._sourceLoaded&&(this._source.off("data",Y),this._preloadTiles(h,g))};return void this._source.on("data",Y)}const S=new Map,P=Array.isArray(h)?h:[h],D=this.map.painter.terrain,N=this.usedForTerrain&&D?D.getScaledDemTileSize():this._source.tileSize;for(const Y of P){const ee=Y.coveringTiles({tileSize:N,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const te of ee)S.set(te.key,te);this.usedForTerrain&&Y.updateElevation(!1)}const $=Array.from(S.values());a.bf($,(Y,ee)=>{const te=new zc(Y,this._source.tileSize*Y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(te,le=>{this._source.type==="raster-dem"&&te.dem&&this._backfillDEM(te),ee(le,te)})},g)}}function tc(w,h){const g=Math.abs(2*w.wrap)-+(w.wrap<0),S=Math.abs(2*h.wrap)-+(h.wrap<0);return w.overscaledZ-h.overscaledZ||S-g||h.canonical.y-w.canonical.y||h.canonical.x-w.canonical.x}function Bp(w){return w==="raster"||w==="image"||w==="video"||w==="custom"}function vf(w,h){const g=1<<w.z;return[w.x/g+h,(w.x+1)/g+h]}Zo.maxOverzooming=10,Zo.maxUnderzooming=3;class kp{constructor(h){this.style=h,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const h=!1,g=!1;for(const S in this.style._mergedLayers){const P=this.style._mergedLayers[S];if(P.type==="fill-extrusion")this.layers.push({layer:P,visible:h,visibilityChanged:g});else if(P.type==="model"){const D=this.style.getLayerSource(P);D&&D.type==="batched-model"&&this.layers.push({layer:P,visible:h,visibilityChanged:g})}}}onNewFrame(h){this.layersGotHidden=!1;for(const g of this.layers){const S=g.layer;let P=!1;S.type==="fill-extrusion"?P=!S.isHidden(h)&&S.paint.get("fill-extrusion-opacity")>0:S.type==="model"&&(P=!S.isHidden(h)&&S.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!P&&g.visible,g.visible=P}}updateZOffset(h,g){this.currentBuildingBuckets=[];for(const P of this.layers){const D=P.layer,N=this.style.getLayerSourceCache(D);let $=1;D.type==="fill-extrusion"&&($=P.visible?D.paint.get("fill-extrusion-vertical-scale"):0);let Y=N?N.getTile(g):null;if(!Y&&N&&g.canonical.z>N.getSource().minzoom){let ee=g.scaledTo(Math.min(N.getSource().maxzoom,g.overscaledZ-1));for(;ee.overscaledZ>=N.getSource().minzoom&&(Y=N.getTile(ee),!Y&&ee.overscaledZ!==0);)ee=ee.scaledTo(ee.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:Y?Y.getBucket(D):null,tileID:Y?Y.tileID:g,verticalScale:$})}h.hasAnyZOffset=!1;let S=!1;for(let P=0;P<h.symbolInstances.length;P++){const D=h.symbolInstances.get(P),N=D.zOffset,$=this._getHeightAtTileOffset(g,D.tileAnchorX,D.tileAnchorY);D.zOffset=$!==Number.NEGATIVE_INFINITY?$:N,S||N===D.zOffset||(S=!0),h.hasAnyZOffset||D.zOffset===0||(h.hasAnyZOffset=!0)}S&&(h.zOffsetBuffersNeedUpload=!0,h.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(h,g,S,P){let D=g,N=S;if(h.canonical.z!==P.canonical.z){const $=P.canonical,Y=1/(1<<h.canonical.z-$.z);D=(g+h.canonical.x*a.ab)*Y-$.x*a.ab|0,N=(S+h.canonical.y*a.ab)*Y-$.y*a.ab|0}return{tileX:D,tileY:N}}_getHeightAtTileOffset(h,g,S){let P,D;for(let N=0;N<this.layers.length;++N){if(this.layers[N].layer.type!=="fill-extrusion")continue;const{bucket:$,tileID:Y,verticalScale:ee}=this.currentBuildingBuckets[N];if(!$)continue;const{tileX:te,tileY:le}=this._mapCoordToOverlappingTile(h,g,S,Y),ce=$.getHeightAtTileCoord(te,le);ce&&ce.height!==void 0&&(ce.hidden?P=ce.height:D=Math.max(ce.height*ee,D||0))}if(D!==void 0)return D;for(let N=0;N<this.layers.length;++N){const $=this.layers[N];if($.layer.type!=="model"||!$.visible)continue;const{bucket:Y,tileID:ee}=this.currentBuildingBuckets[N];if(!Y)continue;const{tileX:te,tileY:le}=this._mapCoordToOverlappingTile(h,g,S,ee),ce=Y.getHeightAtTileCoord(te,le);if(ce&&!ce.hidden)return ce.height===void 0&&P!==void 0?Math.min(ce.maxHeight,P)*ce.verticalScale:ce.height?ce.height*ce.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Xu(w,h){const g={};for(const S in w)S!=="ref"&&(g[S]=w[S]);return a.bg.forEach(S=>{S in h&&(g[S]=h[S])}),g}function qh(w){w=w.slice();const h=Object.create(null);for(let g=0;g<w.length;g++)h[w[g].id]=w[g];for(let g=0;g<w.length;g++)"ref"in w[g]&&(w[g]=Xu(w[g],h[w[g].ref]));return w}const ai={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Op(w,h,g){g.push({command:ai.addSource,args:[w,h[w]]})}function _r(w,h,g){h.push({command:ai.removeSource,args:[w]}),g[w]=!0}function Gx(w,h,g,S){_r(w,g,S),Op(w,h,g)}function ur(w,h,g){let S;for(S in w[g])if(w[g].hasOwnProperty(S)&&S!=="data"&&!a.bh(w[g][S],h[g][S]))return!1;for(S in h[g])if(h[g].hasOwnProperty(S)&&S!=="data"&&!a.bh(w[g][S],h[g][S]))return!1;return!0}function _f(w,h,g,S,P,D){let N;for(N in h=h||{},w=w||{})w.hasOwnProperty(N)&&(a.bh(w[N],h[N])||g.push({command:D,args:[S,N,h[N],P]}));for(N in h)h.hasOwnProperty(N)&&!w.hasOwnProperty(N)&&(a.bh(w[N],h[N])||g.push({command:D,args:[S,N,h[N],P]}))}function Yh(w){return w.id}function yf(w,h){return w[h.id]=h,w}class Ss{constructor(h,g){this.reset(h,g)}reset(h,g){this.points=h||[],this._distances=[0];for(let S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=a.ap(h,0,1);let g=1,S=this._distances[g];const P=h*this.paddedLength+this.padding;for(;S<P&&g<this._distances.length;)S=this._distances[++g];const D=g-1,N=this._distances[D],$=S-N,Y=$>0?(P-N)/$:0;return this.points[D].mult(1-Y).add(this.points[g].mult(Y))}}class xf{constructor(h,g,S){const P=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(h/S),this.yCellCount=Math.ceil(g/S);for(let N=0;N<this.xCellCount*this.yCellCount;N++)P.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=g,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,g,S,P,D){this._forEachCell(g,S,P,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(g),this.bboxes.push(S),this.bboxes.push(P),this.bboxes.push(D)}insertCircle(h,g,S,P){this._forEachCell(g-P,S-P,g+P,S+P,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(g),this.circles.push(S),this.circles.push(P)}_insertBoxCell(h,g,S,P,D,N){this.boxCells[D].push(N)}_insertCircleCell(h,g,S,P,D,N){this.circleCells[D].push(N)}_query(h,g,S,P,D,N){if(S<0||h>this.width||P<0||g>this.height)return!D&&[];const $=[];if(h<=0&&g<=0&&this.width<=S&&this.height<=P){if(D)return!0;for(let Y=0;Y<this.boxKeys.length;Y++)$.push({key:this.boxKeys[Y],x1:this.bboxes[4*Y],y1:this.bboxes[4*Y+1],x2:this.bboxes[4*Y+2],y2:this.bboxes[4*Y+3]});for(let Y=0;Y<this.circleKeys.length;Y++){const ee=this.circles[3*Y],te=this.circles[3*Y+1],le=this.circles[3*Y+2];$.push({key:this.circleKeys[Y],x1:ee-le,y1:te-le,x2:ee+le,y2:te+le})}return N?$.filter(N):$}return this._forEachCell(h,g,S,P,this._queryCell,$,{hitTest:D,seenUids:{box:{},circle:{}}},N),D?$.length>0:$}_queryCircle(h,g,S,P,D){const N=h-S,$=h+S,Y=g-S,ee=g+S;if($<0||N>this.width||ee<0||Y>this.height)return!P&&[];const te=[];return this._forEachCell(N,Y,$,ee,this._queryCellCircle,te,{hitTest:P,circle:{x:h,y:g,radius:S},seenUids:{box:{},circle:{}}},D),P?te.length>0:te}query(h,g,S,P,D){return this._query(h,g,S,P,!1,D)}hitTest(h,g,S,P,D){return this._query(h,g,S,P,!0,D)}hitTestCircle(h,g,S,P){return this._queryCircle(h,g,S,!0,P)}_queryCell(h,g,S,P,D,N,$,Y){const ee=$.seenUids,te=this.boxCells[D];if(te!==null){const ce=this.bboxes;for(const de of te)if(!ee.box[de]){ee.box[de]=!0;const xe=4*de;if(h<=ce[xe+2]&&g<=ce[xe+3]&&S>=ce[xe+0]&&P>=ce[xe+1]&&(!Y||Y(this.boxKeys[de]))){if($.hitTest)return N.push(!0),!0;N.push({key:this.boxKeys[de],x1:ce[xe],y1:ce[xe+1],x2:ce[xe+2],y2:ce[xe+3]})}}}const le=this.circleCells[D];if(le!==null){const ce=this.circles;for(const de of le)if(!ee.circle[de]){ee.circle[de]=!0;const xe=3*de;if(this._circleAndRectCollide(ce[xe],ce[xe+1],ce[xe+2],h,g,S,P)&&(!Y||Y(this.circleKeys[de]))){if($.hitTest)return N.push(!0),!0;{const be=ce[xe],Se=ce[xe+1],Te=ce[xe+2];N.push({key:this.circleKeys[de],x1:be-Te,y1:Se-Te,x2:be+Te,y2:Se+Te})}}}}}_queryCellCircle(h,g,S,P,D,N,$,Y){const ee=$.circle,te=$.seenUids,le=this.boxCells[D];if(le!==null){const de=this.bboxes;for(const xe of le)if(!te.box[xe]){te.box[xe]=!0;const be=4*xe;if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,de[be+0],de[be+1],de[be+2],de[be+3])&&(!Y||Y(this.boxKeys[xe])))return N.push(!0),!0}}const ce=this.circleCells[D];if(ce!==null){const de=this.circles;for(const xe of ce)if(!te.circle[xe]){te.circle[xe]=!0;const be=3*xe;if(this._circlesCollide(de[be],de[be+1],de[be+2],ee.x,ee.y,ee.radius)&&(!Y||Y(this.circleKeys[xe])))return N.push(!0),!0}}}_forEachCell(h,g,S,P,D,N,$,Y){const ee=this._convertToXCellCoord(h),te=this._convertToYCellCoord(g),le=this._convertToXCellCoord(S),ce=this._convertToYCellCoord(P);for(let de=ee;de<=le;de++)for(let xe=te;xe<=ce;xe++)if(D.call(this,h,g,S,P,this.xCellCount*xe+de,N,$,Y))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,g,S,P,D,N){const $=P-h,Y=D-g,ee=S+N;return ee*ee>$*$+Y*Y}_circleAndRectCollide(h,g,S,P,D,N,$){const Y=(N-P)/2,ee=Math.abs(h-(P+Y));if(ee>Y+S)return!1;const te=($-D)/2,le=Math.abs(g-(D+te));if(le>te+S)return!1;if(ee<=Y||le<=te)return!0;const ce=ee-Y,de=le-te;return ce*ce+de*de<=S*S}}const nc={unknown:0,flipRequired:1,flipNotRequired:2},Fn=Math.tan(85*Math.PI/180);function ni(w,h,g,S,P,D,N){const $=a.a6.mat4.create();if(g)if(D.name==="globe"){const Y=a.bi(P,h);a.a6.mat4.multiply($,$,Y)}else{const Y=a.a6.mat2.invert([],N);$[0]=Y[0],$[1]=Y[1],$[4]=Y[2],$[5]=Y[3],S||a.a6.mat4.rotateZ($,$,P.angle)}else a.a6.mat4.multiply($,P.labelPlaneMatrix,w);return $}function Kr(w,h,g,S,P,D,N){const $=ni(w,h,g,S,P,D,N);return D.name==="globe"&&g||($[2]=$[6]=$[10]=$[14]=0),$}function Hs(w,h,g,S,P,D,N){if(g){if(D.name==="globe"){const $=ni(w,h,g,S,P,D,N);return a.a6.mat4.invert($,$),a.a6.mat4.multiply($,w,$),$}{const $=a.a6.mat4.clone(w),Y=a.a6.mat4.identity([]);return Y[0]=N[0],Y[1]=N[1],Y[4]=N[2],Y[5]=N[3],a.a6.mat4.multiply($,$,Y),S||a.a6.mat4.rotateZ($,$,-P.angle),$}}return P.glCoordMatrix}function ya(w,h,g,S){const P=[w,h,g,1];g?a.a6.vec4.transformMat4(P,P,S):_g(P,P,S);const D=P[3];return P[0]/=D,P[1]/=D,P[2]/=D,P}function ii(w,h){return Math.min(.5+w/h*.5,1.5)}function ul(w,h){const g=w[0]/w[3],S=w[1]/w[3];return g>=-h[0]&&g<=h[0]&&S>=-h[1]&&S<=h[1]}function Za(w,h,g,S,P,D,N,$,Y,ee){const te=g.transform,le=S?w.textSizeData:w.iconSizeData,ce=a.bj(le,g.transform.zoom),de=te.projection.name==="globe",xe=[256/g.width*2+1,256/g.height*2+1],be=S?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;be.clear();let Se=null;de&&(Se=S?w.text.globeExtVertexArray:w.icon.globeExtVertexArray);const Te=w.lineVertexArray,Oe=S?w.text.placedSymbolArray:w.icon.placedSymbolArray,Ge=g.transform.width/g.transform.height;let Be,Xe=!1;for(let $e=0;$e<Oe.length;$e++){const tt=Oe.get($e),{numGlyphs:Je,writingMode:nt}=tt;if(nt!==a.bk.vertical||Xe||Be===a.bk.horizontal||(Xe=!0),Be=nt,(tt.hidden||nt===a.bk.vertical)&&!Xe){hl(Je,be);continue}Xe=!1;const ht=new a.P(tt.tileAnchorX,tt.tileAnchorY);let{x:at,y:st,z:wt}=te.projection.projectTilePoint(ht.x,ht.y,ee.canonical);if(Y){const[Yt,tn,tr]=Y(ht);at+=Yt,st+=tn,wt+=tr}const zt=[at,st,wt,1];if(a.a6.vec4.transformMat4(zt,zt,h),!ul(zt,xe)){hl(Je,be);continue}const Zt=zt[3],Ft=ii(g.transform.getCameraToCenterDistance(te.projection),Zt),dn=a.bl(le,ce,tt),St=N?dn/Ft:dn*Ft,$t=ya(at,st,wt,P);if($t[3]<=0){hl(Je,be);continue}let Ht={};const fn=N?null:Y,mn=Es(tt,St,!1,$,h,P,D,w.glyphOffsetArray,Te,be,Se,$t,ht,Ht,Ge,fn,te.projection,ee,N);Xe=mn.useVertical,fn&&mn.needsFlipping&&(Ht={}),(mn.notEnoughRoom||Xe||mn.needsFlipping&&Es(tt,St,!0,$,h,P,D,w.glyphOffsetArray,Te,be,Se,$t,ht,Ht,Ge,fn,te.projection,ee,N).notEnoughRoom)&&hl(Je,be)}S?(w.text.dynamicLayoutVertexBuffer.updateData(be),Se&&w.text.globeExtVertexBuffer&&w.text.globeExtVertexBuffer.updateData(Se)):(w.icon.dynamicLayoutVertexBuffer.updateData(be),Se&&w.icon.globeExtVertexBuffer&&w.icon.globeExtVertexBuffer.updateData(Se))}function yu(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be){const{lineStartIndex:Se,glyphStartIndex:Te,segment:Oe}=$,Ge=Te+$.numGlyphs,Be=Se+$.lineLength,Xe=h.getoffsetX(Te),$e=h.getoffsetX(Ge-1),tt=bf(w*Xe,g,S,P,D,N,Oe,Se,Be,Y,ee,te,le,ce,!0,de,xe,be);if(!tt)return null;const Je=bf(w*$e,g,S,P,D,N,Oe,Se,Be,Y,ee,te,le,ce,!0,de,xe,be);return Je?{first:tt,last:Je}:null}function la(w,h,g,S){return w===a.bk.horizontal&&Math.abs(S)>Math.abs(g)?{useVertical:!0}:w===a.bk.vertical?S>0?{needsFlipping:!0}:null:h!==nc.unknown&&function(P,D){return P===0||Math.abs(D/P)>Fn}(g,S)?h===nc.flipRequired?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null}function Es(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te,Oe){const Ge=h/24,Be=w.lineOffsetX*Ge,Xe=w.lineOffsetY*Ge,{lineStartIndex:$e,glyphStartIndex:tt,numGlyphs:Je,segment:nt,writingMode:ht,flipState:at}=w,st=$e+w.lineLength,wt=zt=>{if(te){const[St,$t,Ht]=zt.up,fn=ee.length;a.bm(te,fn+0,St,$t,Ht),a.bm(te,fn+1,St,$t,Ht),a.bm(te,fn+2,St,$t,Ht),a.bm(te,fn+3,St,$t,Ht)}const[Zt,Ft,dn]=zt.point;a.bn(ee,Zt,Ft,dn,zt.angle)};if(Je>1){const zt=yu(Ge,$,Be,Xe,g,le,ce,w,Y,D,de,be,!1,Se,Te,Oe);if(!zt)return{notEnoughRoom:!0};if(S&&!g){let[Zt,Ft,dn]=zt.first.point,[St,$t,Ht]=zt.last.point;[Zt,Ft]=ya(Zt,Ft,dn,N),[St,$t]=ya(St,$t,Ht,N);const fn=la(ht,at,(St-Zt)*xe,$t-Ft);if(w.flipState=fn&&fn.needsFlipping?nc.flipRequired:nc.flipNotRequired,fn)return fn}wt(zt.first);for(let Zt=tt+1;Zt<tt+Je-1;Zt++){const Ft=bf(Ge*$.getoffsetX(Zt),Be,Xe,g,le,ce,nt,$e,st,Y,D,de,be,!1,!1,Se,Te,Oe);if(!Ft)return ee.length-=4*(Zt-tt),{notEnoughRoom:!0};wt(Ft)}wt(zt.last)}else{if(S&&!g){const Zt=ya(ce.x,ce.y,0,P),Ft=$e+nt+1,dn=new a.P(Y.getx(Ft),Y.gety(Ft)),St=ya(dn.x,dn.y,0,P),$t=St[3]>0?St:Ba(ce,dn,Zt,1,P,void 0,Se,Te.canonical),Ht=la(ht,at,($t[0]-Zt[0])*xe,$t[1]-Zt[1]);if(w.flipState=Ht&&Ht.needsFlipping?nc.flipRequired:nc.flipNotRequired,Ht)return Ht}const zt=bf(Ge*$.getoffsetX(tt),Be,Xe,g,le,ce,nt,$e,st,Y,D,de,be,!1,!1,Se,Te,Oe);if(!zt)return{notEnoughRoom:!0};wt(zt)}return{}}function Vx(w,h,g,S,P){const{x:D,y:N,z:$}=S.projectTilePoint(w.x,w.y,h);if(!P)return ya(D,N,$,g);const[Y,ee,te]=P(w);return ya(D+Y,N+ee,$+te,g)}function Ba(w,h,g,S,P,D,N,$){const Y=Vx(w.sub(h)._unit()._add(w),$,P,N,D);return a.a6.vec3.sub(Y,g,Y),a.a6.vec3.normalize(Y,Y),a.a6.vec3.scaleAndAdd(Y,g,Y,S)}function bf(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te){const Oe=S?w-h:w+h;let Ge=Oe>0?1:-1,Be=0;S&&(Ge*=-1,Be=Math.PI),Ge<0&&(Be+=Math.PI);let Xe=$+N+(Ge>0?0:1)|0,$e=P,tt=P,Je=0,nt=0;const ht=Math.abs(Oe),at=[],st=[];let wt=D,zt=wt;const Zt=()=>Ba(zt,wt,tt,ht-Je+1,te,ce,be,Se.canonical);for(;Je+nt<=ht;){if(Xe+=Ge,Xe<$||Xe>=Y)return null;if(tt=$e,zt=wt,at.push(tt),de&&st.push(zt),wt=new a.P(ee.getx(Xe),ee.gety(Xe)),$e=le[Xe],!$e){const tn=Vx(wt,Se.canonical,te,be,ce);$e=tn[3]>0?le[Xe]=tn:Zt()}Je+=nt,nt=a.a6.vec3.distance(tt,$e)}xe&&ce&&(le[Xe]&&($e=Zt(),nt=a.a6.vec3.distance(tt,$e)),le[Xe]=$e);const Ft=(ht-Je)/nt,dn=wt.sub(zt)._mult(Ft)._add(zt),St=a.a6.vec3.sub([],$e,tt),$t=a.a6.vec3.scaleAndAdd([],tt,St,Ft);let Ht=[0,0,1],fn=St[0],mn=St[1];if(Te&&(Ht=be.upVector(Se.canonical,dn.x,dn.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const tn=[Ht[2],0,-Ht[0]],tr=a.a6.vec3.cross([],Ht,tn);a.a6.vec3.normalize(tn,tn),a.a6.vec3.normalize(tr,tr),fn=a.a6.vec3.dot(St,tn),mn=a.a6.vec3.dot(St,tr)}if(g){const tn=a.a6.vec3.cross([],Ht,St);a.a6.vec3.normalize(tn,tn),a.a6.vec3.scaleAndAdd($t,$t,tn,g*Ge)}const Yt=Be+Math.atan2(mn,fn);return at.push($t),de&&st.push(dn),{point:$t,angle:Yt,path:at,tilePath:st,up:Ht}}function hl(w,h){const g=h.length,S=g+4*w;h.resize(S),h.float32.fill(-1/0,4*g,4*S)}function _g(w,h,g){const S=h[0],P=h[1];return w[0]=g[0]*S+g[4]*P+g[12],w[1]=g[1]*S+g[5]*P+g[13],w[3]=g[3]*S+g[7]*P+g[15],w}const js=100;class ko{constructor(h,g,S=new xf(h.width+200,h.height+200,25),P=new xf(h.width+200,h.height+200,25)){this.transform=h,this.grid=S,this.ignoredGrid=P,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+js,this.screenBottomBoundary=h.height+js,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=g}placeCollisionBox(h,g,S,P,D,N,$,Y){let ee=S.projectedAnchorX,te=S.projectedAnchorY,le=S.projectedAnchorZ;const ce=S.elevation,de=S.tileID,xe=h.getProjection();if(ce&&de){const[$e,tt,Je]=xe.upVector(de.canonical,S.tileAnchorX,S.tileAnchorY),nt=xe.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ee+=$e*ce*nt,te+=tt*ce*nt,le+=Je*ce*nt}const be=this.projectAndGetPerspectiveRatio($,ee,te,le,S.tileID,xe.name==="globe"||!!ce||this.transform.pitch>0,xe),Se=N*be.perspectiveRatio,Te=(S.x1*g+P.x-S.padding)*Se+be.point.x,Oe=(S.y1*g+P.y-S.padding)*Se+be.point.y,Ge=(S.x2*g+P.x+S.padding)*Se+be.point.x,Be=(S.y2*g+P.y+S.padding)*Se+be.point.y,Xe=be.perspectiveRatio<=.55||be.occluded;return!this.isInsideGrid(Te,Oe,Ge,Be)||!D&&this.grid.hitTest(Te,Oe,Ge,Be,Y)||Xe?{box:[],offscreen:!1,occluded:be.occluded}:{box:[Te,Oe,Ge,Be],offscreen:this.isOffscreen(Te,Oe,Ge,Be),occluded:!1}}placeCollisionCircles(h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be){const Se=[],Te=this.transform.elevation,Oe=h.getProjection(),Ge=Te?Te.getAtTileOffsetFunc(be,this.transform.center.lat,this.transform.worldSize,Oe):null,Be=new a.P(S.tileAnchorX,S.tileAnchorY);let{x:Xe,y:$e,z:tt}=Oe.projectTilePoint(Be.x,Be.y,be.canonical);if(Ge){const[dn,St,$t]=Ge(Be);Xe+=dn,$e+=St,tt+=$t}const Je=Oe.name==="globe",nt=this.projectAndGetPerspectiveRatio($,Xe,$e,tt,be,Je||!!Te||this.transform.pitch>0,Oe),{perspectiveRatio:ht}=nt,at=(le?N/ht:N*ht)/a.bq,st=ya(Xe,$e,tt,Y),wt=nt.signedDistanceFromCamera>0?yu(at,D,S.lineOffsetX*at,S.lineOffsetY*at,!1,st,Be,S,P,Y,{},Te&&!le?Ge:null,le&&!!Te,Oe,be,le):null;let zt=!1,Zt=!1,Ft=!0;if(wt&&!nt.occluded){const dn=.5*de*ht+xe,St=new a.P(-100,-100),$t=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Ht=new Ss,{first:fn,last:mn}=wt,Yt=fn.path.length;let tn=[];for(let Bn=Yt-1;Bn>=1;Bn--)tn.push(fn.path[Bn]);for(let Bn=1;Bn<mn.path.length;Bn++)tn.push(mn.path[Bn]);const tr=2.5*dn;ee&&(tn=tn.map(([Bn,xr,Yn],hr)=>(Ge&&!Je&&(Yn=Ge(hr<Yt-1?fn.tilePath[Yt-1-hr]:mn.tilePath[hr-Yt+2])[2]),ya(Bn,xr,Yn,ee))),tn.some(Bn=>Bn[3]<=0)&&(tn=[]));let bn=[];if(tn.length>0){let Bn=1/0,xr=-1/0,Yn=1/0,hr=-1/0;for(const Vr of tn)Bn=Math.min(Bn,Vr[0]),Yn=Math.min(Yn,Vr[1]),xr=Math.max(xr,Vr[0]),hr=Math.max(hr,Vr[1]);xr>=St.x&&Bn<=$t.x&&hr>=St.y&&Yn<=$t.y&&(bn=[tn.map(Vr=>new a.P(Vr[0],Vr[1]))],(Bn<St.x||xr>$t.x||Yn<St.y||hr>$t.y)&&(bn=a.bo(bn,St.x,St.y,$t.x,$t.y)))}for(const Bn of bn){Ht.reset(Bn,.25*dn);let xr=0;xr=Ht.length<=.5*dn?1:Math.ceil(Ht.paddedLength/tr)+1;for(let Yn=0;Yn<xr;Yn++){const hr=Yn/Math.max(xr-1,1),Vr=Ht.lerp(hr),kr=Vr.x+js,Ri=Vr.y+js;Se.push(kr,Ri,dn,0);const Hi=kr-dn,as=Ri-dn,Yc=kr+dn,no=Ri+dn;if(Ft=Ft&&this.isOffscreen(Hi,as,Yc,no),Zt=Zt||this.isInsideGrid(Hi,as,Yc,no),!g&&this.grid.hitTestCircle(kr,Ri,dn,ce)&&(zt=!0,!te))return{circles:[],offscreen:!1,collisionDetected:zt,occluded:!1}}}}return{circles:!te&&zt||!Zt?[]:Se,offscreen:Ft,collisionDetected:zt,occluded:nt.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[];let S=1/0,P=1/0,D=-1/0,N=-1/0;for(const te of h){const le=new a.P(te.x+js,te.y+js);S=Math.min(S,le.x),P=Math.min(P,le.y),D=Math.max(D,le.x),N=Math.max(N,le.y),g.push(le)}const $=this.grid.query(S,P,D,N).concat(this.ignoredGrid.query(S,P,D,N)),Y={},ee={};for(const te of $){const le=te.key;if(Y[le.bucketInstanceId]===void 0&&(Y[le.bucketInstanceId]={}),Y[le.bucketInstanceId][le.featureIndex])continue;const ce=[new a.P(te.x1,te.y1),new a.P(te.x2,te.y1),new a.P(te.x2,te.y2),new a.P(te.x1,te.y2)];a.bp(g,ce)&&(Y[le.bucketInstanceId][le.featureIndex]=!0,ee[le.bucketInstanceId]===void 0&&(ee[le.bucketInstanceId]=[]),ee[le.bucketInstanceId].push(le.featureIndex))}return ee}insertCollisionBox(h,g,S,P,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:P,collisionGroupID:D},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,g,S,P,D){const N=g?this.ignoredGrid:this.grid,$={bucketInstanceId:S,featureIndex:P,collisionGroupID:D};for(let Y=0;Y<h.length;Y+=4)N.insertCircle($,h[Y],h[Y+1],h[Y+2])}projectAndGetPerspectiveRatio(h,g,S,P,D,N,$){const Y=[g,S,P,1];let ee=!1;P||this.transform.pitch>0?(a.a6.vec4.transformMat4(Y,Y,h),this.fogState&&D&&$.name!=="globe"&&(ee=function(ce,de,xe,be,Se,Te){const Oe=Te.calculateFogTileMatrix(Se),Ge=[de,xe,be];return a.a6.vec3.transformMat4(Ge,Ge,Oe),En(ce,a.a6.vec3.length(Ge),Te.pitch,Te._fov)}(this.fogState,g,S,P,D.toUnwrapped(),this.transform)>.9)):_g(Y,Y,h);const te=Y[3];return{point:new a.P((Y[0]/te+1)/2*this.transform.width+js,(-Y[1]/te+1)/2*this.transform.height+js),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance($)/te*.5,1.5),signedDistanceFromCamera:te,occluded:N&&Y[2]>te||ee}}isOffscreen(h,g,S,P){return S<js||h>=this.screenRightBoundary||P<js||g>this.screenBottomBoundary}isInsideGrid(h,g,S,P){return S>=0&&h<this.gridRightBoundary&&P>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const h=a.a6.mat4.identity([]);return a.a6.mat4.translate(h,h,[-100,-100,0]),h}}function Ko(w,h,g){const S=h.createTileMatrix(w,w.worldSize,g.toUnwrapped());return a.a6.mat4.multiply(new Float32Array(16),w.projMatrix,S)}function Zh(w,h,g){if(h.projection.name===g.projection.name)return w.projMatrix;const S=g.clone();return S.setProjection(h.projection),Ko(S,h.getProjection(),w)}function Uc(w,h,g){return h.name===g.projection.name?w.projMatrix:Ko(g,h,w)}class Os{constructor(h,g,S,P){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?g:-g))):P&&S?1:0,this.placed=S}isHidden(){return this.opacity===0&&!this.placed}}class xa{constructor(h,g,S,P,D,N=!1){this.text=new Os(h?h.text:null,g,S,D),this.icon=new Os(h?h.icon:null,g,P,D),this.clipped=N}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class dl{constructor(h,g,S,P=!1){this.text=h,this.icon=g,this.skipFade=S,this.clipped=P}}class Ks{constructor(){this.invProjMatrix=a.a6.mat4.create(),this.viewportMatrix=a.a6.mat4.create(),this.circles=[]}}class qu{constructor(h,g,S,P,D){this.bucketInstanceId=h,this.featureIndex=g,this.sourceLayerIndex=S,this.bucketIndex=P,this.tileID=D}}class Js{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const g=++this.maxGroupID;this.collisionGroups[h]={ID:g,predicate:S=>S.collisionGroupID===g}}return this.collisionGroups[h]}}function ka(w,h,g,S,P){const{horizontalAlign:D,verticalAlign:N}=a.bx(w),$=-(D-.5)*h,Y=-(N-.5)*g,ee=a.bw(w,S);return new a.P($+ee[0]*P,Y+ee[1]*P)}function Ka(w,h,g,S,P){const D=new a.P(w,h);return g&&D._rotate(S?P:-P),D}class xu{constructor(h,g,S,P,D,N){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new ko(this.transform,D),this.buildingIndex=N,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Js(S),this.collisionCircleArrays={},this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,g,S,P){const D=S.getBucket(g),N=S.latestFeatureIndex;if(!D||!N||g.fqid!==D.layerIds[0])return;const $=D.layers[0].layout,Y=D.layers[0].paint,ee=S.collisionBoxArray,te=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),le=S.tileSize/a.ab,ce=S.tileID.toUnwrapped();this.transform.setProjection(D.projection);const de=(xe=S.tileID,be=D.getProjection(),Se=this.transform,be.name===this.projection?Se.calculateProjMatrix(xe.toUnwrapped()):Ko(Se,be,xe));var xe,be,Se;const Te=$.get("text-pitch-alignment")==="map",Oe=$.get("text-rotation-alignment")==="map";g.compileFilter();const Ge=g.dynamicFilter(),Be=g.dynamicFilterNeedsFeature(),Xe=this.transform.calculatePixelsToTileUnitsMatrix(S),$e=Kr(de,S.tileID.canonical,Te,Oe,this.transform,D.getProjection(),Xe);let tt=null;if(Te){const ht=Hs(de,S.tileID.canonical,Te,Oe,this.transform,D.getProjection(),Xe);tt=a.a6.mat4.multiply([],this.transform.labelPlaneMatrix,ht)}let Je=null;Ge&&S.latestFeatureIndex&&(Je={unwrappedTileID:ce,dynamicFilter:Ge,dynamicFilterNeedsFeature:Be}),this.retainedQueryData[D.bucketInstanceId]=new qu(D.bucketInstanceId,N,D.sourceLayerIndex,D.index,S.tileID);const nt={bucket:D,layout:$,paint:Y,posMatrix:de,textLabelPlaneMatrix:$e,labelToScreenMatrix:tt,clippingData:Je,scale:te,textPixelRatio:le,holdingForFade:S.holdingForFade(),collisionBoxArray:ee,partiallyEvaluatedTextSize:a.bj(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.bj(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID),latestFeatureIndex:S.latestFeatureIndex};if(P)for(const ht of D.sortKeyRanges){const{sortKey:at,symbolInstanceStart:st,symbolInstanceEnd:wt}=ht;h.push({sortKey:at,symbolInstanceStart:st,symbolInstanceEnd:wt,parameters:nt})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:nt})}attemptAnchorPlacement(h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te,Oe){const{textOffset0:Ge,textOffset1:Be,crossTileID:Xe}=ce,$e=[Ge,Be],tt=ka(h,S,P,$e,D),Je=this.collisionIndex.placeCollisionBox(xe,D,g,Ka(tt.x,tt.y,N,$,this.transform.angle),le,Y,ee,te.predicate);if(Se){const nt=xe.getSymbolInstanceIconSize(Oe,this.transform.zoom,ce.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(xe,nt,Se,Ka(tt.x,tt.y,N,$,this.transform.angle),le,Y,ee,te.predicate).box.length===0)return}if(Je.box.length>0){let nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Xe]&&this.prevPlacement.placements[Xe]&&this.prevPlacement.placements[Xe].text&&(nt=this.prevPlacement.variableOffsets[Xe].anchor),this.variableOffsets[Xe]={textOffset:$e,width:S,height:P,anchor:h,textScale:D,prevAnchor:nt},this.markUsedJustification(xe,h,ce,be),xe.allowVerticalPlacement&&(this.markUsedOrientation(xe,be,ce),this.placedOrientations[Xe]=be),{shift:tt,placedGlyphBoxes:Je}}}placeLayerBucketPart(h,g,S,P){const{bucket:D,layout:N,paint:$,posMatrix:Y,textLabelPlaneMatrix:ee,labelToScreenMatrix:te,clippingData:le,textPixelRatio:ce,holdingForFade:de,collisionBoxArray:xe,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:Se,collisionGroup:Te,latestFeatureIndex:Oe}=h.parameters,Ge=N.get("text-optional"),Be=N.get("icon-optional"),Xe=N.get("text-allow-overlap"),$e=N.get("icon-allow-overlap"),tt=N.get("text-rotation-alignment")==="map",Je=N.get("text-pitch-alignment")==="map",nt=N.get("symbol-z-elevate"),ht=$.get("symbol-z-offset"),at=$.get("symbol-elevation-reference")==="sea";this.transform.setProjection(D.projection);let st=Xe&&($e||!D.hasIconData()||Be),wt=$e&&(Xe||!D.hasTextData()||Ge);const zt=!ht.isConstant();!D.collisionArrays&&xe&&D.deserializeCollisionBoxes(xe),S&&P&&D.updateCollisionDebugBuffers(this.transform.zoom,xe);const Zt=(Ft,dn,St)=>{const{crossTileID:$t,numVerticalGlyphVertices:Ht}=Ft;let fn=null;if(le&&le.dynamicFilterNeedsFeature||zt){const Fr=this.retainedQueryData[D.bucketInstanceId];fn=Oe.loadFeature({featureIndex:Ft.featureIndex,bucketIndex:Fr.bucketIndex,sourceLayerIndex:Fr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(le&&!(0,le.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},fn,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new a.P(Ft.tileAnchorX,Ft.tileAnchorY),this.transform.calculateDistanceTileData(le.unwrappedTileID)))return this.placements[$t]=new dl(!1,!1,!1,!0),void g.add($t);const mn=ht.evaluate(fn,{});if(g.has($t))return;if(de)return void(this.placements[$t]=new dl(!1,!1,!1));let Yt=!1,tn=!1,tr=!0,bn=!1,Bn=!1,xr=null,Yn={box:null,offscreen:null,occluded:null},hr={box:null,offscreen:null,occluded:null},Vr=null,kr=null,Ri=null,Hi=0,as=0,Yc=0;St.textFeatureIndex?Hi=St.textFeatureIndex:Ft.useRuntimeCollisionCircles&&(Hi=Ft.featureIndex),St.verticalTextFeatureIndex&&(as=St.verticalTextFeatureIndex);const no=Fr=>{Fr.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;const gi=this.transform.elevation;Fr.elevation=at?mn:mn+(gi?gi.getAtTileOffset(Fr.tileID,Fr.tileAnchorX,Fr.tileAnchorY):0),Fr.elevation+=Ft.zOffset},Jr=St.textBox;if(Jr){no(Jr);const Fr=Ei=>{let Gs=a.bk.horizontal;if(D.allowVerticalPlacement&&!Ei&&this.prevPlacement){const ro=this.prevPlacement.placedOrientations[$t];ro&&(this.placedOrientations[$t]=ro,Gs=ro,this.markUsedOrientation(D,Gs,Ft))}return Gs},gi=(Ei,Gs)=>{if(D.allowVerticalPlacement&&Ht>0&&St.verticalTextBox){for(const ro of D.writingModes)if(ro===a.bk.vertical?(Yn=Gs(),hr=Yn):Yn=Ei(),Yn&&Yn.box&&Yn.box.length)break}else Yn=Ei()};if(N.get("text-variable-anchor")){let Ei=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[$t]){const li=this.prevPlacement.variableOffsets[$t];Ei.indexOf(li.anchor)>0&&(Ei=Ei.filter(Uo=>Uo!==li.anchor),Ei.unshift(li.anchor))}const Gs=(li,Uo,ea)=>{const Go=D.getSymbolInstanceTextSize(be,Ft,this.transform.zoom,dn),es=(li.x2-li.x1)*Go+2*li.padding,vl=(li.y2-li.y1)*Go+2*li.padding,_l=Ft.hasIconTextFit&&!$e?Uo:null;_l&&no(_l);let Zc={box:[],offscreen:!1,occluded:!1};const vc=Xe?2*Ei.length:Ei.length;for(let Ol=0;Ol<vc;++Ol){const Kc=this.attemptAnchorPlacement(Ei[Ol%Ei.length],li,es,vl,Go,tt,Je,ce,Y,Te,Ol>=Ei.length,Ft,dn,D,ea,_l,be,Se);if(Kc&&(Zc=Kc.placedGlyphBoxes,Zc&&Zc.box&&Zc.box.length)){Yt=!0,xr=Kc.shift;break}}return Zc};gi(()=>Gs(Jr,St.iconBox,a.bk.horizontal),()=>{const li=St.verticalTextBox;return li&&no(li),D.allowVerticalPlacement&&!(Yn&&Yn.box&&Yn.box.length)&&Ht>0&&li?Gs(li,St.verticalIconBox,a.bk.vertical):{box:null,offscreen:null,occluded:null}}),Yn&&(Yt=Yn.box,tr=Yn.offscreen,bn=Yn.occluded);const ro=Fr(!(!Yn||!Yn.box));if(!Yt&&this.prevPlacement){const li=this.prevPlacement.variableOffsets[$t];li&&(this.variableOffsets[$t]=li,this.markUsedJustification(D,li.anchor,Ft,ro))}}else{const Ei=(Gs,ro)=>{const li=D.getSymbolInstanceTextSize(be,Ft,this.transform.zoom,dn),Uo=this.collisionIndex.placeCollisionBox(D,li,Gs,new a.P(0,0),Xe,ce,Y,Te.predicate);return Uo&&Uo.box&&Uo.box.length&&(this.markUsedOrientation(D,ro,Ft),this.placedOrientations[$t]=ro),Uo};gi(()=>Ei(Jr,a.bk.horizontal),()=>{const Gs=St.verticalTextBox;return D.allowVerticalPlacement&&Ht>0&&Gs?(no(Gs),Ei(Gs,a.bk.vertical)):{box:null,offscreen:null,occluded:null}}),Fr(!!(Yn&&Yn.box&&Yn.box.length))}}if(Vr=Yn,Yt=Vr&&Vr.box&&Vr.box.length>0,tr=Vr&&Vr.offscreen,bn=Vr&&Vr.occluded,Ft.useRuntimeCollisionCircles){const Fr=D.text.placedSymbolArray.get(Ft.centerJustifiedTextSymbolIndex>=0?Ft.centerJustifiedTextSymbolIndex:Ft.verticalPlacedTextSymbolIndex),gi=a.bl(D.textSizeData,be,Fr),Ei=N.get("text-padding");kr=this.collisionIndex.placeCollisionCircles(D,Xe,Fr,D.lineVertexArray,D.glyphOffsetArray,gi,Y,ee,te,S,Je,Te.predicate,Ft.collisionCircleDiameter*gi/a.bq,Ei,this.retainedQueryData[D.bucketInstanceId].tileID),Yt=Xe||kr.circles.length>0&&!kr.collisionDetected,tr=tr&&kr.offscreen,bn=kr.occluded}if(St.iconFeatureIndex&&(Yc=St.iconFeatureIndex),St.iconBox){const Fr=gi=>{no(gi);const Ei=Ft.hasIconTextFit&&xr?Ka(xr.x,xr.y,tt,Je,this.transform.angle):new a.P(0,0),Gs=D.getSymbolInstanceIconSize(Se,this.transform.zoom,Ft.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,Gs,gi,Ei,$e,ce,Y,Te.predicate)};hr&&hr.box&&hr.box.length&&St.verticalIconBox?(Ri=Fr(St.verticalIconBox),tn=Ri.box.length>0):(Ri=Fr(St.iconBox),tn=Ri.box.length>0),tr=tr&&Ri.offscreen,Bn=Ri.occluded}const Gi=Ge||Ft.numHorizontalGlyphVertices===0&&Ht===0,Ts=Be||Ft.numIconVertices===0;if(Gi||Ts?Ts?Gi||(tn=tn&&Yt):Yt=tn&&Yt:tn=Yt=tn&&Yt,Yt&&Vr&&Vr.box&&this.collisionIndex.insertCollisionBox(Vr.box,N.get("text-ignore-placement"),D.bucketInstanceId,hr&&hr.box&&as?as:Hi,Te.ID),tn&&Ri&&this.collisionIndex.insertCollisionBox(Ri.box,N.get("icon-ignore-placement"),D.bucketInstanceId,Yc,Te.ID),kr&&(Yt&&this.collisionIndex.insertCollisionCircles(kr.circles,N.get("text-ignore-placement"),D.bucketInstanceId,Hi,Te.ID),S)){const Fr=D.bucketInstanceId;let gi=this.collisionCircleArrays[Fr];gi===void 0&&(gi=this.collisionCircleArrays[Fr]=new Ks);for(let Ei=0;Ei<kr.circles.length;Ei+=4)gi.circles.push(kr.circles[Ei+0]),gi.circles.push(kr.circles[Ei+1]),gi.circles.push(kr.circles[Ei+2]),gi.circles.push(kr.collisionDetected?1:0)}const Oi=D.projection.name!=="globe";st=st&&(Oi||!bn),wt=wt&&(Oi||!Bn),this.placements[$t]=new dl(Yt||st,tn||wt,tr||D.justReloaded),g.add($t)};if(nt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,this.retainedQueryData[D.bucketInstanceId].tileID),D.updateZOffset()),D.sortFeaturesByY){const Ft=D.getSortedSymbolIndexes(this.transform.angle);for(let dn=Ft.length-1;dn>=0;--dn){const St=Ft[dn];Zt(D.symbolInstances.get(St),St,D.collisionArrays[St])}D.hasAnyZOffset&&a.w(`${D.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(D.hasAnyZOffset){const Ft=D.getSortedIndexesByZOffset();for(let dn=0;dn<Ft.length;++dn){const St=Ft[dn];Zt(D.symbolInstances.get(St),St,D.collisionArrays[St])}}else for(let Ft=h.symbolInstanceStart;Ft<h.symbolInstanceEnd;Ft++)Zt(D.symbolInstances.get(Ft),Ft,D.collisionArrays[Ft]);if(S&&D.bucketInstanceId in this.collisionCircleArrays){const Ft=this.collisionCircleArrays[D.bucketInstanceId];a.a6.mat4.invert(Ft.invProjMatrix,Y),Ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(h,g,S,P){const{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:Y,crossTileID:ee}=S,te=a.bv(g),le=P===a.bk.vertical?Y:te==="left"?D:te==="center"?N:te==="right"?$:-1;D>=0&&(h.text.placedSymbolArray.get(D).crossTileID=le>=0&&D!==le?0:ee),N>=0&&(h.text.placedSymbolArray.get(N).crossTileID=le>=0&&N!==le?0:ee),$>=0&&(h.text.placedSymbolArray.get($).crossTileID=le>=0&&$!==le?0:ee),Y>=0&&(h.text.placedSymbolArray.get(Y).crossTileID=le>=0&&Y!==le?0:ee)}markUsedOrientation(h,g,S){const P=g===a.bk.horizontal||g===a.bk.horizontalOnly?g:0,D=g===a.bk.vertical?g:0,{leftJustifiedTextSymbolIndex:N,centerJustifiedTextSymbolIndex:$,rightJustifiedTextSymbolIndex:Y,verticalPlacedTextSymbolIndex:ee}=S,te=h.text.placedSymbolArray;N>=0&&(te.get(N).placedOrientation=P),$>=0&&(te.get($).placedOrientation=P),Y>=0&&(te.get(Y).placedOrientation=P),ee>=0&&(te.get(ee).placedOrientation=D)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let S=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const P=g?g.symbolFadeChange(h):1,D=g?g.opacities:{},N=g?g.variableOffsets:{},$=g?g.placedOrientations:{};for(const Y in this.placements){const ee=this.placements[Y],te=D[Y];te?(this.opacities[Y]=new xa(te,P,ee.text,ee.icon,null,ee.clipped),S=S||ee.text!==te.text.placed||ee.icon!==te.icon.placed):(this.opacities[Y]=new xa(null,P,ee.text,ee.icon,ee.skipFade,ee.clipped),S=S||ee.text||ee.icon)}for(const Y in D){const ee=D[Y];if(!this.opacities[Y]){const te=new xa(ee,P,!1,!1);te.isHidden()||(this.opacities[Y]=te,S=S||ee.text.placed||ee.icon.placed)}}for(const Y in N)this.variableOffsets[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.variableOffsets[Y]=N[Y]);for(const Y in $)this.placedOrientations[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.placedOrientations[Y]=$[Y]);S?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:h)}updateLayerOpacities(h,g,S,P){const D=new Set;for(const N of g){const $=N.getBucket(h);$&&N.latestFeatureIndex&&h.fqid===$.layerIds[0]&&(this.updateBucketOpacities($,D,N,N.collisionBoxArray,S,P,N.tileID,h.scope),$.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset($,N.tileID),$.updateZOffset()))}}updateBucketOpacities(h,g,S,P,D,N,$,Y){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const ee=h.layers[0].layout,te=h.layers[0].paint,le=!!h.layers[0].dynamicFilter(),ce=new xa(null,0,!1,!1,!0),de=ee.get("text-allow-overlap"),xe=ee.get("icon-allow-overlap"),be=ee.get("text-variable-anchor"),Se=ee.get("text-rotation-alignment")==="map",Te=ee.get("text-pitch-alignment")==="map",Oe=te.get("symbol-z-offset"),Ge=te.get("symbol-elevation-reference")==="sea",Be=!Oe.isConstant(),Xe=new xa(null,0,de&&(xe||!h.hasIconData()||ee.get("icon-optional")),xe&&(de||!h.hasTextData()||ee.get("text-optional")),!0);!h.collisionArrays&&P&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(P);const $e=(Je,nt,ht)=>{for(let at=0;at<nt/4;at++)Je.opacityVertexArray.emplaceBack(ht)};let tt=0;N&&h.updateReplacement($,N);for(let Je=0;Je<h.symbolInstances.length;Je++){const nt=h.symbolInstances.get(Je),{numHorizontalGlyphVertices:ht,numVerticalGlyphVertices:at,crossTileID:st,numIconVertices:wt,tileAnchorX:zt,tileAnchorY:Zt}=nt;let Ft=null;if(nt&&Be){const bn=this.retainedQueryData[h.bucketInstanceId];Ft=S.latestFeatureIndex.loadFeature({featureIndex:nt.featureIndex,bucketIndex:bn.bucketIndex,sourceLayerIndex:bn.sourceLayerIndex,layoutVertexArrayOffset:0})}const dn=Oe.evaluate(Ft,{}),St=g.has(st);let $t=this.opacities[st];St?$t=ce:$t||($t=Xe,this.opacities[st]=$t),g.add(st);const Ht=ht>0||at>0,fn=wt>0,mn=this.placedOrientations[st],Yt=mn===a.bk.vertical,tn=mn===a.bk.horizontal||mn===a.bk.horizontalOnly;!Ht&&!fn||$t.isHidden()||tt++;let tr=!1;if((Ht||fn)&&N)for(const bn of h.activeReplacements){if(a.br(bn,D,a.bs.Symbol,Y)||bn.min.x>zt||zt>bn.max.x||bn.min.y>Zt||Zt>bn.max.y)continue;const Bn=a.bt(zt,Zt,$.canonical,bn.footprintTileId.canonical);if(tr=a.bu(Bn,bn.footprint),tr)break}if(Ht){const bn=tr?bu:Zu($t.text);$e(h.text,ht,Yt?bu:bn),$e(h.text,at,tn?bu:bn);const Bn=$t.text.isHidden(),{leftJustifiedTextSymbolIndex:xr,centerJustifiedTextSymbolIndex:Yn,rightJustifiedTextSymbolIndex:hr,verticalPlacedTextSymbolIndex:Vr}=nt,kr=h.text.placedSymbolArray,Ri=Bn||Yt?1:0;xr>=0&&(kr.get(xr).hidden=Ri),Yn>=0&&(kr.get(Yn).hidden=Ri),hr>=0&&(kr.get(hr).hidden=Ri),Vr>=0&&(kr.get(Vr).hidden=Bn||tn?1:0);const Hi=this.variableOffsets[st];Hi&&this.markUsedJustification(h,Hi.anchor,nt,mn);const as=this.placedOrientations[st];as&&(this.markUsedJustification(h,"left",nt,as),this.markUsedOrientation(h,as,nt))}if(fn){const bn=tr?bu:Zu($t.icon),{placedIconSymbolIndex:Bn,verticalPlacedIconSymbolIndex:xr}=nt,Yn=h.icon.placedSymbolArray,hr=$t.icon.isHidden()?1:0;Bn>=0&&($e(h.icon,wt,Yt?bu:bn),Yn.get(Bn).hidden=hr),xr>=0&&($e(h.icon,nt.numVerticalIconVertices,tn?bu:bn),Yn.get(xr).hidden=hr)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const bn=h.collisionArrays[Je];if(bn){let Bn=new a.P(0,0),xr=!0;if(bn.textBox||bn.verticalTextBox){if(be){const hr=this.variableOffsets[st];hr?(Bn=ka(hr.anchor,hr.width,hr.height,hr.textOffset,hr.textScale),Se&&Bn._rotate(Te?this.transform.angle:-this.transform.angle)):xr=!1}le&&(xr=!$t.clipped),bn.textBox&&Fp(h.textCollisionBox.collisionVertexArray,$t.text.placed,!xr||Yt,dn,Ge,Bn.x,Bn.y),bn.verticalTextBox&&Fp(h.textCollisionBox.collisionVertexArray,$t.text.placed,!xr||tn,dn,Ge,Bn.x,Bn.y)}const Yn=xr&&!!(!tn&&bn.verticalIconBox);bn.iconBox&&Fp(h.iconCollisionBox.collisionVertexArray,$t.icon.placed,Yn,dn,Ge,nt.hasIconTextFit?Bn.x:0,nt.hasIconTextFit?Bn.y:0),bn.verticalIconBox&&Fp(h.iconCollisionBox.collisionVertexArray,$t.icon.placed,!Yn,dn,Ge,nt.hasIconTextFit?Bn.x:0,nt.hasIconTextFit?Bn.y:0)}}}if(h.fullyClipped=tt===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const Je=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=Je.invProjMatrix,h.placementViewportMatrix=Je.viewportMatrix,h.collisionCircleArray=Je.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,g){const S=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*S>h}setStale(){this.stale=!0}}function Fp(w,h,g,S,P,D,N){w.emplaceBack(h?1:0,g?1:0,D||0,N||0,S,P?1:0),w.emplaceBack(h?1:0,g?1:0,D||0,N||0,S,P?1:0),w.emplaceBack(h?1:0,g?1:0,D||0,N||0,S,P?1:0),w.emplaceBack(h?1:0,g?1:0,D||0,N||0,S,P?1:0)}const ca=Math.pow(2,25),Yu=Math.pow(2,24),Np=Math.pow(2,17),Oa=Math.pow(2,16),yg=Math.pow(2,9),zp=Math.pow(2,8),Y0=Math.pow(2,1);function Zu(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const h=w.placed?1:0,g=Math.floor(127*w.opacity);return g*ca+h*Yu+g*Np+h*Oa+g*yg+h*zp+g*Y0+h}const bu=0;class Hx{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(h,g,S,P,D){const N=this._bucketParts;for(;this._currentTileIndex<h.length;)if(g.getBucketParts(N,P,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort(($,Y)=>$.sortKey-Y.sortKey));this._currentPartIndex<N.length;){const $=N[this._currentPartIndex];if(g.placeLayerBucketPart($,this._seenCrossTileIDs,S,$.symbolInstanceStart===0),this._currentPartIndex++,D())return!0}return!1}}class wf{constructor(h,g,S,P,D,N,$,Y,ee){this.placement=new xu(h,D,N,$,Y,ee),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(h,g,S,P){const D=a.q.now(),N=()=>{const $=a.q.now()-D;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=g[h[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=Y)&&(!$.maxzoom||$.maxzoom>Y)){const ee=$,te=ee.layout.get("symbol-z-elevate"),le=ee.layout.get("symbol-sort-key").constantOr(1)!==void 0,ce=ee.layout.get("symbol-z-order"),de=ce==="viewport-y"||ce==="auto"&&!(ce!=="viewport-y"&&le),xe=ee.layout.get("text-allow-overlap")||ee.layout.get("icon-allow-overlap")||ee.layout.get("text-ignore-placement")||ee.layout.get("icon-ignore-placement"),be=de&&xe,Se=this._inProgressLayer=this._inProgressLayer||new Hx(ee),Te=a.av($.source,$.scope);if(Se.continuePlacement(te||be?P[Te]:S[Te],this.placement,this._showCollisionBoxes,$,N))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Ku=512/a.ab/2;class Z0{constructor(h,g,S){this.tileID=h,this.bucketInstanceId=S,this.index=new a.by(g.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const P=h.canonical.x*a.ab,D=h.canonical.y*a.ab;for(let N=0;N<g.length;N++){const{key:$,crossTileID:Y,tileAnchorX:ee,tileAnchorY:te}=g.get(N),le=Math.floor((P+ee)*Ku),ce=Math.floor((D+te)*Ku);this.index.add(le,ce),this.keys.push($),this.crossTileIDs.push(Y)}this.index.finish()}findMatches(h,g,S){const P=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z),D=Ku/Math.pow(2,g.canonical.z-this.tileID.canonical.z),N=g.canonical.x*a.ab,$=g.canonical.y*a.ab;for(let Y=0;Y<h.length;Y++){const ee=h.get(Y);if(ee.crossTileID)continue;const{key:te,tileAnchorX:le,tileAnchorY:ce}=ee,de=Math.floor((N+le)*D),xe=Math.floor(($+ce)*D),be=this.index.range(de-P,xe-P,de+P,xe+P);for(const Se of be){const Te=this.crossTileIDs[Se];if(this.keys[Se]===te&&!S.has(Te)){S.add(Te),ee.crossTileID=Te;break}}}}}class rc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const g=Math.round((h-this.lng)/360);if(g!==0)for(const S in this.indexes){const P=this.indexes[S],D={};for(const N in P){const $=P[N];$.tileID=$.tileID.unwrapTo($.tileID.wrap+g),D[$.tileID.key]=$}this.indexes[S]=D}this.lng=h}addBucket(h,g,S){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let D=0;D<g.symbolInstances.length;D++)g.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]=new Set);const P=this.usedCrossTileIDs[h.overscaledZ];for(const D in this.indexes){const N=this.indexes[D];if(Number(D)>h.overscaledZ)for(const $ in N){const Y=N[$];Y.tileID.isChildOf(h)&&Y.findMatches(g.symbolInstances,h,P)}else{const $=N[h.scaledTo(Number(D)).key];$&&$.findMatches(g.symbolInstances,h,P)}}for(let D=0;D<g.symbolInstances.length;D++){const N=g.symbolInstances.get(D);N.crossTileID||(N.crossTileID=S.generate(),P.add(N.crossTileID))}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new Z0(h,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(h,g){for(const S of g.crossTileIDs)this.usedCrossTileIDs[h].delete(S)}removeStaleBuckets(h){let g=!1;for(const S in this.indexes){const P=this.indexes[S];for(const D in P)h[P[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,P[D]),delete P[D],g=!0)}return g}}class Jh{constructor(){this.layerIndexes={},this.crossTileIDs=new rc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,g,S,P){let D=this.layerIndexes[h.fqid];D===void 0&&(D=this.layerIndexes[h.fqid]=new Kh);let N=!1;const $={};P.name!=="globe"&&D.handleWrapJump(S);for(const Y of g){const ee=Y.getBucket(h);ee&&h.fqid===ee.layerIds[0]&&(ee.bucketInstanceId||(ee.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(Y.tileID,ee,this.crossTileIDs)&&(N=!0),$[ee.bucketInstanceId]=!0)}return D.removeStaleBuckets($)&&(N=!0),N}pruneUnusedLayers(h){const g={};h.forEach(S=>{g[S]=!0});for(const S in this.layerIndexes)g[S]||delete this.layerIndexes[S]}}const ba=771;class Cr{constructor(h,g,S,P){this.blendFunction=h,this.blendColor=g,this.mask=S,this.blendEquation=P}}Cr.Replace=[1,0,1,0],Cr.disabled=new Cr(Cr.Replace,a.bz.transparent,[!1,!1,!1,!1]),Cr.unblended=new Cr(Cr.Replace,a.bz.transparent,[!0,!0,!0,!0]),Cr.alphaBlended=new Cr([1,ba,1,ba],a.bz.transparent,[!0,!0,!0,!0]),Cr.alphaBlendedNonPremultiplied=new Cr([770,ba,770,ba],a.bz.transparent,[!0,!0,!0,!0]),Cr.multiply=new Cr([774,0,774,0],a.bz.transparent,[!0,!0,!0,!0]);class qn{constructor(h,g,S){this.func=h,this.mask=g,this.range=S}}qn.ReadOnly=!1,qn.ReadWrite=!0,qn.disabled=new qn(519,qn.ReadOnly,[0,1]);const wu=7680;class mr{constructor(h,g,S,P,D,N){this.test=h,this.ref=g,this.mask=S,this.fail=P,this.depthFail=D,this.pass=N}}mr.disabled=new mr({func:519,mask:0},0,0,wu,wu,wu);const ic=1029,sc=2305;class yr{constructor(h,g,S){this.enable=h,this.mode=g,this.frontFace=S}}function Up(w,h){const g=a.bC(w,3);a.a6.mat4.fromQuat(w,h),a.bE(w,3,g)}function Sf(w,h){const g=a.a6.quat.identity([]);return a.a6.quat.rotateZ(g,g,-h),a.a6.quat.rotateX(g,g,-w),g}function Fa(w,h){const g=[w[0],w[1],0],S=[h[0],h[1],0];if(a.a6.vec3.length(g)>=1e-15){const N=a.a6.vec3.normalize([],g);a.a6.vec3.scale(S,N,a.a6.vec3.dot(S,N)),h[0]=S[0],h[1]=S[1]}const P=a.a6.vec3.cross([],h,w);if(a.a6.vec3.len(P)<1e-15)return null;const D=Math.atan2(-P[1],P[0]);return Sf(Math.atan2(Math.sqrt(w[0]*w[0]+w[1]*w[1]),-w[2]),D)}yr.disabled=new yr(!1,ic,sc),yr.backCCW=new yr(!0,ic,sc),yr.backCW=new yr(!0,ic,2304),yr.frontCW=new yr(!0,1028,2304),yr.frontCCW=new yr(!0,1028,sc);class So{constructor(h,g){this.position=h,this.orientation=g}get position(){return this._position}set position(h){if(h){const g=h instanceof a.a5?h:new a.a5(h[0],h[1],h[2]);this._renderWorldCopies&&(g.x=a.bA(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(h,g){if(this.orientation=null,!this.position)return;const S=this.position,P=this._elevation?this._elevation.getAtPointOrZero(a.a5.fromLngLat(h)):0,D=a.a5.fromLngLat(h,P),N=[D.x-S.x,D.y-S.y,D.z-S.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=Fa(N,g)}setPitchBearing(h,g){this.orientation=Sf(a.bB(h),a.bB(-g))}}class ss{constructor(h,g){this._transform=a.a6.mat4.identity([]),this.orientation=g,this.position=h}get mercatorPosition(){const h=this.position;return new a.a5(h[0],h[1],h[2])}get position(){const h=a.bC(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var g;h&&a.bE(this._transform,3,[(g=h)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||a.a6.quat.identity([]),h&&Up(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,g){this._orientation=Sf(h,g),Up(this._transform,this._orientation)}forward(){const h=a.bC(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=a.bC(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=a.bC(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,g){const S=new Float64Array(16);return a.a6.mat4.invert(S,this.getWorldToCamera(h,g)),S}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(h,g,S){const P=this.position;a.a6.vec3.scale(P,P,-h);const D=new Float64Array(16);return a.a6.mat4.fromScaling(D,[S,S,S]),a.a6.mat4.translate(D,D,P),D[10]*=g,D}getWorldToCamera(h,g){const S=new Float64Array(16),P=new Float64Array(4),D=this.position;return a.a6.quat.conjugate(P,this._orientation),a.a6.vec3.scale(D,D,-h),a.a6.mat4.fromQuat(S,P),a.a6.mat4.translate(S,S,D),S[1]*=-1,S[5]*=-1,S[9]*=-1,S[13]*=-1,S[8]*=g,S[9]*=g,S[10]*=g,S[11]*=g,S}getCameraToClipPerspective(h,g,S,P){const D=new Float64Array(16);return a.a6.mat4.perspective(D,h,g,S,P),D}getCameraToClipOrthographic(h,g,S,P,D,N){const $=new Float64Array(16);return a.a6.mat4.ortho($,h,g,S,P,D,N),$}getDistanceToElevation(h,g=!1){const S=h===0?0:a.bD(h,g?a.aM(this.position[1]):this.position[1]),P=this.forward();return(S-this.position[2])/P[2]}clone(){return new ss([...this.position],[...this.orientation])}}const uo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Ja{constructor(h=0,g=0,S=0,P=0){if(isNaN(h)||h<0||isNaN(g)||g<0||isNaN(S)||S<0||isNaN(P)||P<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=g,this.left=S,this.right=P}interpolate(h,g,S){return g.top!=null&&h.top!=null&&(this.top=a.aa(h.top,g.top,S)),g.bottom!=null&&h.bottom!=null&&(this.bottom=a.aa(h.bottom,g.bottom,S)),g.left!=null&&h.left!=null&&(this.left=a.aa(h.left,g.left,S)),g.right!=null&&h.right!=null&&(this.right=a.aa(h.right,g.right,S)),this}getCenter(h,g){const S=a.ap((this.left+h-this.right)/2,0,h),P=a.ap((this.top+g-this.bottom)/2,0,g);return new a.P(S,P)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new Ja(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Qh=(w,h,g)=>(1-g)*w+g*h,ed=w=>w*w*w*w*w;class Af{constructor(h,g,S,P,D,N,$){this.tileSize=512,this._renderWorldCopies=D===void 0||D,this._minZoom=h||0,this._maxZoom=g||22,this._minPitch=S??0,this._maxPitch=P??60,this.setProjection(N),this.setMaxBounds($),this.width=0,this.height=0,this._center=new a.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ja,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ss,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const h=new Af(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(h,g=!1){const S=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||S)&&this._updateCameraOnTerrain(),(h||S)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return a.ar(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=a.bL(this.projectionOptions);const S=this.getProjection(),P=!a.bh(g,S);return P&&this._calcMatrices(),this.mercatorFromTransition=!1,P}setOrthographicProjectionAtLowPitch(h){return this._orthographicProjectionAtLowPitch!==h&&(this._orthographicProjectionAtLowPitch=h,this._calcMatrices(),!0)}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.bL({name:"mercator"});const g=h!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bA(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const g=-h*Math.PI/180;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=a.a6.mat2.create(),a.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const g=a.ap(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=a.bB(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const g=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(h){this._tileCoverLift!==h&&(this._tileCoverLift=h)}_updateCameraOnTerrain(){const h=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,g=this.elevation&&h===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||h===Number.NEGATIVE_INFINITY&&(!g||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const S=this._elevation;g||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&S.exaggeration()&&this._centerAltitudeValidForExaggeration!==S.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*S.exaggeration(),this._centerAltitudeValidForExaggeration=S.exaggeration()):(this._centerAltitude=h||0,this._centerAltitudeValidForExaggeration=S.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],S=this.horizonLineFromTop();let P=0,D=0;for(let N=0;N<g.length;N++){const $=new a.P(g[N][0]*this.width,S+g[N][1]*(this.height-S)),Y=h.pointCoordinate($);if(!Y)continue;const ee=1/Math.hypot(Y[0]-this._camera.position[0],Y[1]-this._camera.position[1]);P+=Y[3]*ee,D+=ee}return D===0?NaN:P/D}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),S=this.pixelsPerMeter/this.worldSize*g,P=this._mercatorZfromZoom(h),D=this._mercatorZfromZoom(this._maxZoom),N=Math.max(P-S,D);this._setZoom(this._zoomFromMercatorZ(N))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let S;S=h.z<this._camera.position[2]?[g.x,g.y,g.z]:[h.x,h.y,h.z];const P=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,S));return a.ap(this._zoomFromMercatorZ(P),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let g=!1;if(h.orientation&&!a.a6.quat.exactEquals(h.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(h.orientation)),h.position){const S=[h.position.x,h.position.y,h.position.z];a.a6.vec3.exactEquals(S,this._camera.position)||(this._setCameraPosition(S),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,g=new So;return g.position=new a.a5(h[0],h[1],h[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(h){if(!a.a6.quat.length(h))return!1;a.a6.quat.normalize(h,h);const g=a.a6.vec3.transformQuat([],[0,0,-1],h),S=a.a6.vec3.transformQuat([],[0,-1,0],h);if(S[2]<0)return!1;const P=Fa(g,S);return!!P&&(this._camera.orientation=P,!0)}_setCameraPosition(h){const g=this.zoomScale(this.minZoom)*this.tileSize,S=this.zoomScale(this.maxZoom)*this.tileSize,P=this.cameraToCenterDistance;h[2]=a.ap(h[2],P/S,P/g),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,g,S){this._unmodified=!1,this._edgeInsets.interpolate(h,g,S),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const g=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(h){const g=[new a.bM(0,h)];if(this.renderWorldCopies){const S=this.pointCoordinate(new a.P(0,0)),P=this.pointCoordinate(new a.P(this.width,0)),D=this.pointCoordinate(new a.P(this.width,this.height)),N=this.pointCoordinate(new a.P(0,this.height)),$=Math.floor(Math.min(S.x,P.x,D.x,N.x)),Y=Math.floor(Math.max(S.x,P.x,D.x,N.x)),ee=1;for(let te=$-ee;te<=Y+ee;te++)te!==0&&g.push(new a.bM(te,h))}return g}isLODDisabled(h){return(!h||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(h,g,S){let P=[];const D=S!==void 0,N=!D;if(N&&this.zoom<g||D&&S[0]===0&&S[1]===0)return P;const $=new Set,Y=(te,le,ce,de,xe)=>{const be=a.c1(le,te,ce,de,xe);$.has(be)||(P.push(new a.aA(te,le,ce,de,xe)),$.add(be))};for(let te=0;te<h.length;te++){const le=h[te];if(N&&le.canonical.z!==g)continue;const ce=le.canonical,de=le.overscaledZ,xe=le.wrap,be=1<<ce.z,Se=ce.x+1<be,Te=ce.x>0,Oe=ce.y+1<be,Ge=ce.y>0,Be=le.wrap-(Te?0:1),Xe=le.wrap+(Se?0:1),$e=Te?ce.x-1:be-1,tt=Se?ce.x+1:0;if(D)S[0]<0?(Y(de,Xe,ce.z,tt,ce.y),S[1]<0&&Oe&&(Y(de,xe,ce.z,ce.x,ce.y+1),Y(de,Xe,ce.z,tt,ce.y+1)),S[1]>0&&Ge&&(Y(de,xe,ce.z,ce.x,ce.y-1),Y(de,Xe,ce.z,tt,ce.y-1))):S[0]>0?(Y(de,Be,ce.z,$e,ce.y),S[1]<0&&Oe&&(Y(de,xe,ce.z,ce.x,ce.y+1),Y(de,Be,ce.z,$e,ce.y+1)),S[1]>0&&Ge&&(Y(de,xe,ce.z,ce.x,ce.y-1),Y(de,Be,ce.z,$e,ce.y-1))):S[1]<0&&Oe?Y(de,xe,ce.z,ce.x,ce.y+1):Ge&&Y(de,xe,ce.z,ce.x,ce.y-1);else{const Je=le.visibleQuadrants;1&Je&&(Y(de,Be,ce.z,$e,ce.y),Ge&&(Y(de,xe,ce.z,ce.x,ce.y-1),Y(de,Be,ce.z,$e,ce.y-1))),2&Je&&(Y(de,Xe,ce.z,tt,ce.y),Ge&&(Y(de,xe,ce.z,ce.x,ce.y-1),Y(de,Xe,ce.z,tt,ce.y-1))),4&Je&&(Y(de,Be,ce.z,$e,ce.y),Oe&&(Y(de,xe,ce.z,ce.x,ce.y+1),Y(de,Be,ce.z,$e,ce.y+1))),8&Je&&(Y(de,Xe,ce.z,tt,ce.y),Oe&&(Y(de,xe,ce.z,ce.x,ce.y+1),Y(de,Xe,ce.z,tt,ce.y+1)))}}const ee=[];for(const te of P)P.some(le=>te.isChildOf(le))||ee.push(te);if(P=ee.filter(te=>!h.some(le=>!!(te.overscaledZ<g&&le.isChildOf(te))||te.equals(le)||te.isChildOf(le))),N){const te=1<<g,le=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=[te*le.x,te*le.y],de=4,xe=de*de;P=P.filter(be=>{const Se=be.canonical.x+.5-ce[0],Te=be.canonical.y+.5-ce[1];return Se*Se+Te*Te<xe})}return P}coveringTiles(h){let g=this.coveringZoomLevel(h);const S=g,P=this.elevation&&this.elevation.exaggeration(),D=P&&!h.isTerrainDEM,N=this.projection.name==="mercator";if(h.minzoom!==void 0&&g<h.minzoom)return[];h.maxzoom!==void 0&&g>h.maxzoom&&(g=h.maxzoom);const $=this.locationCoordinate(this.center),Y=this.center.lat,ee=1<<g,te=[ee*$.x,ee*$.y,0],le=this.projection.name==="globe",ce=!le,de=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,ce),xe=le?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),be=ee*a.bD(1,this.center.lat),Se=this._camera.position[2]/a.bD(1,this.center.lat),Te=[ee*xe.x,ee*xe.y,Se*(ce?1:be)],Oe=le||P,Ge=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Be=this.isLODDisabled(!0)?g:0;let Xe;if(this._elevation&&h.isTerrainDEM)Xe=1e4*this._elevation.exaggeration();else if(this._elevation){const St=this._elevation.getMinMaxForVisibleTiles();Xe=St?St.max:this._centerAltitude}else Xe=this._centerAltitude;const $e=h.isTerrainDEM?-Xe:this._elevation?this._elevation.getMinElevationBelowMSL():0,tt=this.projection.isReprojectedInTileSpace?a.bO(this):1,Je=St=>{const Ht=new a.a5(St.x+25e-6,St.y,St.z),fn=new a.a5(St.x,St.y+25e-6,St.z),mn=St.toLngLat(),Yt=Ht.toLngLat(),tn=fn.toLngLat(),tr=this.locationCoordinate(mn),bn=this.locationCoordinate(Yt),Bn=this.locationCoordinate(tn),xr=Math.hypot(bn.x-tr.x,bn.y-tr.y),Yn=Math.hypot(Bn.x-tr.x,Bn.y-tr.y);return Math.sqrt(xr*Yn)*tt/25e-6},nt=St=>{const $t=Xe,Ht=$e;return{aabb:a.bR(this,ee,0,0,0,St,Ht,$t,this.projection),zoom:0,x:0,y:0,minZ:Ht,maxZ:$t,wrap:St,fullyVisible:!1}},ht=[];let at=[];const st=g,wt=h.reparseOverscaled?S:g,zt=(Se-this._centerAltitude)*be,Zt=St=>{if(!this._elevation||!St.tileID||!N)return;const $t=this._elevation.getMinMaxForTile(St.tileID),Ht=St.aabb;$t?(Ht.min[2]=$t.min,Ht.max[2]=$t.max,Ht.center[2]=(Ht.min[2]+Ht.max[2])/2):(St.shouldSplit=dn(St),St.shouldSplit||(Ht.min[2]=Ht.max[2]=Ht.center[2]=this._centerAltitude))},Ft=(St,$t)=>{if(.707*$t<St)return 1;const Ht=$t/St;return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)},dn=St=>{if(St.zoom<Be)return!0;if(St.zoom===st)return!1;if(St.shouldSplit!=null)return St.shouldSplit;const $t=St.aabb.distanceX(Te),Ht=St.aabb.distanceY(Te);let fn=zt,mn=1;if(le){fn=St.aabb.distanceZ(Te);const Yn=Math.pow(2,St.zoom),hr=a.aM((St.y+1)/Yn),Vr=a.aM(St.y/Yn),kr=Math.min(Math.max(Y,hr),Vr),Ri=a.c5(kr)/a.c5(Y);if(mn=kr===Y?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ri/this._mercatorScaleRatio),this.zoom<=a.c2&&St.zoom===st-1&&Ri>=.9)return!0}else if(D&&(fn=St.aabb.distanceZ(Te)*be),this.projection.isReprojectedInTileSpace&&S<=5){const Yn=Math.pow(2,St.zoom),hr=Je(new a.a5((St.x+.5)/Yn,(St.y+.5)/Yn));mn=hr>.85?1:hr}if(!N){const Yn=Math.sqrt($t*$t+Ht*Ht+fn*fn);let hr=(1<<st-St.zoom)*Ge*mn;return hr*=Ft(Math.max(fn,zt),Yn),Yn<hr}let Yt=Number.MAX_VALUE,tn=0;const tr=St.aabb.getCorners(),bn=[];for(const Yn of tr){a.a6.vec3.sub(bn,Yn,Te),le||(D?bn[2]*=be:bn[2]=zt);const hr=a.a6.vec3.dot(bn,this._camera.forward());hr<Yt&&(Yt=hr,tn=Math.abs(bn[2]))}let Bn=(1<<st-St.zoom)*Ge*mn;if(Bn*=Ft(Math.max(tn,zt),Yt),Yt<Bn)return!0;const xr=St.aabb.closestPoint(te);return xr[0]===te[0]&&xr[1]===te[1]};if(this.renderWorldCopies)for(let St=1;St<=3;St++)ht.push(nt(-St)),ht.push(nt(St));for(ht.push(nt(0));ht.length>0;){const St=ht.pop(),$t=St.x,Ht=St.y;let fn=St.fullyVisible;const mn=()=>this.projection.name==="globe"&&(St.y===0||St.y===(1<<St.zoom)-1);if(!fn){let Yt=Oe?St.aabb.intersects(de):St.aabb.intersectsFlat(de);if(Yt===0&&mn()){const tn=new a.bP(St.zoom,$t,Ht);Yt=a.bQ(this,ee,tn,!0).intersects(de)}if(Yt===0)continue;fn=Yt===2}if(St.zoom!==st&&dn(St))for(let Yt=0;Yt<4;Yt++){const tn=($t<<1)+Yt%2,tr=(Ht<<1)+(Yt>>1),bn={aabb:N?St.aabb.quadrant(Yt):a.bR(this,ee,St.zoom+1,tn,tr,St.wrap,St.minZ,St.maxZ,this.projection),zoom:St.zoom+1,x:tn,y:tr,wrap:St.wrap,fullyVisible:fn,tileID:void 0,shouldSplit:void 0,minZ:St.minZ,maxZ:St.maxZ};D&&!le&&(bn.tileID=new a.aA(St.zoom+1===st?wt:St.zoom+1,St.wrap,St.zoom+1,tn,tr),Zt(bn)),ht.push(bn)}else{const Yt=St.zoom===st?wt:St.zoom;if(h.minzoom&&h.minzoom>Yt)continue;let tn=0;if(!fn){let xr=Oe?St.aabb.intersectsPrecise(de):St.aabb.intersectsPreciseFlat(de);if(xr===0&&mn()){const Yn=new a.bP(St.zoom,$t,Ht);xr=a.bQ(this,ee,Yn,!0).intersectsPrecise(de)}if(xr===0)continue;if(h.calculateQuadrantVisibility)if(de.containsPoint(St.aabb.center))tn=15;else for(let Yn=0;Yn<4;Yn++)St.aabb.quadrant(Yn).intersects(de)!==0&&(tn|=1<<Yn)}const tr=te[0]-(.5+$t+(St.wrap<<St.zoom))*(1<<g-St.zoom),bn=te[1]-.5-Ht,Bn=St.tileID?St.tileID:new a.aA(Yt,St.wrap,St.zoom,$t,Ht);h.calculateQuadrantVisibility&&(Bn.visibleQuadrants=tn),at.push({tileID:Bn,distanceSq:tr*tr+bn*bn})}}if(this.fogCullDistSq){const St=this.fogCullDistSq,$t=this.horizonLineFromTop();at=at.filter(Ht=>{const fn=[0,0,0,1],mn=[a.ab,a.ab,0,1],Yt=this.calculateFogTileMatrix(Ht.tileID.toUnwrapped());a.a6.vec4.transformMat4(fn,fn,Yt),a.a6.vec4.transformMat4(mn,mn,Yt);const tn=a.a6.vec4.min([],fn,mn),tr=a.a6.vec4.max([],fn,mn),bn=a.bS(tn,tr);if(bn===0)return!0;let Bn=!1;const xr=this._elevation;if(xr&&bn>St&&$t!==0){const Yn=this.calculateProjMatrix(Ht.tileID.toUnwrapped());let hr;h.isTerrainDEM||(hr=xr.getMinMaxForTile(Ht.tileID)),hr||(hr={min:$e,max:Xe});const Vr=a.c3(this.rotation),kr=[Vr[0]*a.ab,Vr[1]*a.ab,hr.max];a.a6.vec3.transformMat4(kr,kr,Yn),Bn=(1-kr[1])*this.height*.5<$t}return bn<St||Bn})}return at.sort((St,$t)=>St.distanceSq-$t.distanceSq).map(St=>St.tileID)}resize(h,g){this.width=h,this.height=g,this.pixelsToGLUnits=[2/h,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const g=a.ap(h.lat,-a.bT,a.bT),S=this.projection.project(h.lng,g);return new a.P(S.x*this.worldSize,S.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,g){let S,P;const D=this.centerPoint;if(this.projection.name==="globe"){const $=this.worldSize;S=(g.x-D.x)/$,P=(g.y-D.y)/$}else{const $=this.pointCoordinate(g),Y=this.pointCoordinate(D);S=$.x-Y.x,P=$.y-Y.y}const N=this.locationCoordinate(h);this.setLocation(new a.a5(N.x-S,N.y-P))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,g){const S=g?a.bD(g,h.lat):void 0,P=this.projection.project(h.lng,h.lat);return new a.a5(P.x,P.y,S)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,g){const S=g??this._centerAltitude,P=[h.x,h.y,0,1],D=[h.x,h.y,1,1];a.a6.vec4.transformMat4(P,P,this.pixelMatrixInverse),a.a6.vec4.transformMat4(D,D,this.pixelMatrixInverse);const N=D[3];a.a6.vec4.scale(P,P,1/P[3]),a.a6.vec4.scale(D,D,1/N);const $=P[2],Y=D[2];return{p0:P,p1:D,t:$===Y?0:(S-$)/(Y-$)}}screenPointToMercatorRay(h){const g=[h.x,h.y,0,1],S=[h.x,h.y,1,1];return a.a6.vec4.transformMat4(g,g,this.pixelMatrixInverse),a.a6.vec4.transformMat4(S,S,this.pixelMatrixInverse),a.a6.vec4.scale(g,g,1/g[3]),a.a6.vec4.scale(S,S,1/S[3]),g[2]=a.bD(g[2],this._center.lat)*this.worldSize,S[2]=a.bD(S[2],this._center.lat)*this.worldSize,a.a6.vec4.scale(g,g,1/this.worldSize),a.a6.vec4.scale(S,S,1/this.worldSize),new a.aj([g[0],g[1],g[2]],a.a6.vec3.normalize([],a.a6.vec3.sub([],S,g)))}rayIntersectionCoordinate(h){const{p0:g,p1:S,t:P}=h,D=a.bD(g[2],this._center.lat),N=a.bD(S[2],this._center.lat);return new a.a5(a.aa(g[0],S[0],P)/this.worldSize,a.aa(g[1],S[1],P)/this.worldSize,a.aa(D,N,P))}pointCoordinate(h,g=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,g)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let g=this.projection.pointCoordinate3D(this,h.x,h.y);if(g)return new a.a5(g[0],g[1],g[2]);let S=0,P=this.horizonLineFromTop();if(h.y>P)return this.pointCoordinate(h);const D=.02*P,N=h.clone();for(let $=0;$<10&&P-S>D;$++){N.y=a.aa(S,P,.66);const Y=this.projection.pointCoordinate3D(this,N.x,N.y);Y?(P=N.y,g=Y):S=N.y}return g?new a.a5(g[0],g[1],g[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}isPointOnSurface(h){if(h.y<0||h.y>this.height||h.x<0||h.x>this.width)return!1;if(this.elevation||this.zoom>=a.bU)return!this.isPointAboveHorizon(h);const g=this.pointCoordinate(h);return g.y>=0&&g.y<=1}_coordinatePoint(h,g){const S=g&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,P=[h.x*this.worldSize,h.y*this.worldSize,S+h.toAltitude(),1];return a.a6.vec4.transformMat4(P,P,this.pixelMatrix),P[3]>0?new a.P(P[0]/P[3],P[1]/P[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:g}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,D=this.pointLocation3D(new a.P(g,h)),N=this.pointLocation3D(new a.P(P,h)),$=this.pointLocation3D(new a.P(P,S)),Y=this.pointLocation3D(new a.P(g,S));let ee=Math.min(D.lng,N.lng,$.lng,Y.lng),te=Math.max(D.lng,N.lng,$.lng,Y.lng),le=Math.min(D.lat,N.lat,$.lat,Y.lat),ce=Math.max(D.lat,N.lat,$.lat,Y.lat);const de=Math.pow(2,-this.zoom)/16*270,xe=this.projection.name==="globe"?1:4,be=(Se,Te,Oe,Ge,Be)=>{const Xe=(Se+Oe)/2,$e=(Te+Ge)/2,tt=new a.P(Xe,$e),{lng:Je,lat:nt}=this.pointLocation3D(tt),ht=Math.max(0,ee-Je,le-nt,Je-te,nt-ce);ee=Math.min(ee,Je),te=Math.max(te,Je),le=Math.min(le,nt),ce=Math.max(ce,nt),(Be<xe||ht>de)&&(be(Se,Te,Xe,$e,Be+1),be(Xe,$e,Oe,Ge,Be+1))};if(be(g,h,P,h,1),be(P,h,P,S,1),be(P,S,g,S,1),be(g,S,g,h,1),this.projection.name==="globe"){const[Se,Te]=a.bV(this);Se?(ce=90,te=180,ee=-180):Te&&(le=-90,te=180,ee=-180)}return new a.as(new a.bK(ee,le),new a.bK(te,ce))}_getBoundsRectangular(h,g){const{top:S,left:P}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,N=this.width-this._edgeInsets.right,$=new a.P(P,S),Y=new a.P(N,S),ee=new a.P(N,D),te=new a.P(P,D);let le=this.pointCoordinate($,h),ce=this.pointCoordinate(Y,h);const de=this.pointCoordinate(ee,g),xe=this.pointCoordinate(te,g),be=(Se,Te)=>(Te.y-Se.y)/(Te.x-Se.x);return le.y>1&&ce.y>=0?le=new a.a5((1-xe.y)/be(xe,le)+xe.x,1):le.y<0&&ce.y<=1&&(le=new a.a5(-xe.y/be(xe,le)+xe.x,0)),ce.y>1&&le.y>=0?ce=new a.a5((1-de.y)/be(de,ce)+de.x,1):ce.y<0&&le.y<=1&&(ce=new a.a5(-de.y/be(de,ce)+de.x,0)),new a.as().extend(this.coordinateLocation(le)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(xe)).extend(this.coordinateLocation(de))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=h.visibleDemTiles.reduce((S,P)=>{if(P.dem){const D=P.dem.tree;S.min=Math.min(S.min,D.minimums[0]),S.max=Math.max(S.max,D.maximums[0])}return S},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*h.exaggeration(),g.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,S=this.height/2-g*(1-this._horizonShift);return h?Math.max(0,S):S}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-a.bT,this.maxLat=a.bT,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.am(this.minLng)*this.tileSize,this.worldMaxX=a.am(this.maxLng)*this.tileSize,this.worldMinY=a.at(this.maxLat)*this.tileSize,this.worldMaxY=a.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,g){return this.projection.createTileMatrix(this,g,h)}calculateDistanceTileData(h){const g=h.key,S=this._distanceTileDataCache;if(S[g])return S[g];const P=h.canonical,D=1/this.height,N=this.cameraWorldSize,$=N/this.zoomScale(P.z),Y=(P.x+Math.pow(2,P.z)*h.wrap)*$,ee=P.y*$,te=this.point;te.x*=N/this.worldSize,te.y*=N/this.worldSize;const le=this.angle,ce=Math.sin(-le),de=-Math.cos(-le);return S[g]={bearing:[ce,de],center:[(te.x-Y)*D,(te.y-ee)*D],scale:$/a.ab*D},S[g]}calculateFogTileMatrix(h){const g=h.key,S=this._fogTileMatrixCache;if(S[g])return S[g];const P=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return a.a6.mat4.multiply(P,this.worldToFogMatrix,P),S[g]=new Float32Array(P),S[g]}calculateProjMatrix(h,g=!1,S=!1){const P=h.key;let D;if(D=S?this._expandedProjMatrixCache:g?this._alignedProjMatrixCache:this._projMatrixCache,D[P])return D[P];const N=this.calculatePosMatrix(h,this.worldSize);let $;return $=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:S?this.expandedFarZProjMatrix:g?this.alignedProjMatrix:this.projMatrix,a.a6.mat4.multiply(N,$,N),D[P]=new Float32Array(N),D[P]}calculatePixelsToTileUnitsMatrix(h){const g=h.tileID.key,S=this._pixelsToTileUnitsCache;if(S[g])return S[g];const P=a.bW(h,this);return S[g]=P,S[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,g=a.a6.mat4.fromScaling([],[h,h,h]);return a.a6.mat4.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const g=a.bD(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(g),P=this._camera.forward(),D=a.bD(1,this._center.lat);S[2]/=D,P[2]/=D,a.a6.vec3.normalize(P,P);const N=h.raycast(S,P,h.exaggeration());if(N){const $=a.a6.vec3.scaleAndAdd([],S,P,N),Y=new a.a5($[0],$[1],a.bD($[2],a.aM($[1]))),ee=(Y.z+a.a6.vec3.length([Y.x-S[0],Y.y-S[1],Y.z-S[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ee),this._centerAltitude=Y.toAltitude(),this._center=this.coordinateLocation(Y),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const g=this._elevation,S=a.bD(1,this._center.lat)*this.worldSize,P=this._computeCameraPosition(S),D=g.getAtPointOrZero(new a.a5(...P)),N=this.pixelsPerMeter/this.worldSize*D,$=this._minimumHeightOverTerrain(),Y=P[2]-N;if(Y<=$)if(Y<0||h){const ee=this.locationCoordinate(this._center,this._centerAltitude),te=[P[0],P[1],ee.z-P[2]],le=a.a6.vec3.length(te);te[2]-=($-Y)/this._pixelsPerMercatorPixel;const ce=a.a6.vec3.length(te);if(ce===0)return;a.a6.vec3.scale(te,te,le/ce*this._pixelsPerMercatorPixel),this._camera.position=[P[0],P[1],ee.z*this._pixelsPerMercatorPixel-te[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const ce=this.center;return ce.lat=a.ap(ce.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(ce.lng=a.ap(ce.lng,this.minLng,this.maxLng)),this.center=ce,void(this._constraining=!1)}const g=this._unmodified,{x:S,y:P}=this.point;let D=0,N=S,$=P;const Y=this.width/2,ee=this.height/2,te=this.worldMinY*this.scale,le=this.worldMaxY*this.scale;if(P-ee<te&&($=te+ee),P+ee>le&&($=le-ee),le-te<this.height&&(D=Math.max(D,this.height/(le-te)),$=(le+te)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ce=this.worldMinX*this.scale,de=this.worldMaxX*this.scale,xe=this.worldSize/2-(ce+de)/2;N=(S+xe+this.worldSize)%this.worldSize-xe,N-Y<ce&&(N=ce+Y),N+Y>de&&(N=de-Y),de-ce<this.width&&(D=Math.max(D,this.width/(de-ce)),N=(de+ce)/2)}N===S&&$===P||(this.center=this.unproject(new a.P(N,$))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,g=this.projection.name==="globe",S=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.bD(1,this.center.lat)/a.bD(1,a.c4));const P=a.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,P),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const D=this.projection.zAxisUnit==="meters"?S:1,N=this._camera.getWorldToCamera(this.worldSize,D);let $;const Y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(Y[8]=2*-h.x/this.width,Y[9]=2*h.y/this.height,this.isOrthographic){let nt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ht=nt*this.aspect,at=-ht,st=-nt;ht-=h.x,at-=h.x,nt+=h.y,st+=h.y,$=this._camera.getCameraToClipOrthographic(at,ht,st,nt,this._nearZ,this._farZ),((wt,zt,Zt,Ft)=>{for(let dn=0;dn<16;dn++)wt[dn]=Qh(zt[dn],Zt[dn],Ft)})($,$,Y,ed(this.pitch>=15?1:this.pitch/15))}else $=Y;const ee=a.a6.mat4.mul([],Y,N);let te=a.a6.mat4.mul([],$,N);if(this.projection.isReprojectedInTileSpace){const nt=this.locationCoordinate(this.center),ht=a.a6.mat4.identity([]);a.a6.mat4.translate(ht,ht,[nt.x*this.worldSize,nt.y*this.worldSize,0]),a.a6.mat4.multiply(ht,ht,a.bY(this)),a.a6.mat4.translate(ht,ht,[-nt.x*this.worldSize,-nt.y*this.worldSize,0]),a.a6.mat4.multiply(te,te,ht),a.a6.mat4.multiply(ee,ee,ht),this.inverseAdjustmentMatrix=a.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.a6.mat4.scale([],te,[this.worldSize,this.worldSize,this.worldSize/D,1]),this.projMatrix=te,this.invProjMatrix=a.a6.mat4.invert(new Float64Array(16),this.projMatrix),g){const nt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);nt[8]=2*-h.x/this.width,nt[9]=2*h.y/this.height,this.expandedFarZProjMatrix=a.a6.mat4.mul([],nt,N)}else this.expandedFarZProjMatrix=this.projMatrix;const le=a.a6.mat4.invert([],$);this.frustumCorners=a.b_.fromInvProjectionMatrix(le,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!g);const ce=new Float32Array(16);a.a6.mat4.identity(ce),a.a6.mat4.scale(ce,ce,[1,-1,1]),a.a6.mat4.rotateX(ce,ce,this._pitch),a.a6.mat4.rotateZ(ce,ce,this.angle);const de=a.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.a6.mat4.clone(de);const xe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;de[8]=2*-h.x/this.width,de[9]=2*(h.y+xe)/this.height,this.skyboxMatrix=a.a6.mat4.multiply(ce,de,ce);const be=this.point,Se=be.x,Te=be.y,Oe=this.width%2/2,Ge=this.height%2/2,Be=Math.cos(this.angle),Xe=Math.sin(this.angle),$e=Se-Math.round(Se)+Be*Oe+Xe*Ge,tt=Te-Math.round(Te)+Be*Ge+Xe*Oe,Je=new Float64Array(te);if(a.a6.mat4.translate(Je,Je,[$e>.5?$e-1:$e,tt>.5?tt-1:tt,0]),this.alignedProjMatrix=Je,te=a.a6.mat4.create(),a.a6.mat4.scale(te,te,[this.width/2,-this.height/2,1]),a.a6.mat4.translate(te,te,[1,-1,0]),this.labelPlaneMatrix=te,te=a.a6.mat4.create(),a.a6.mat4.scale(te,te,[1,-1,1]),a.a6.mat4.translate(te,te,[-1,-1,0]),a.a6.mat4.scale(te,te,[2/this.width,2/this.height,1]),this.glCoordMatrix=te,this.pixelMatrix=a.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,ee),this._calcFogMatrices(),this._distanceTileDataCache={},te=a.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!te)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=te,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.b$(this);const nt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.a6.vec3.transformMat4(nt,nt,N),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=te;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,S=this._camera.position,P=1/this.height/this._pixelsPerMercatorPixel,D=[h,h,g];a.a6.vec3.scale(D,D,P),a.a6.vec3.scale(S,S,-1),a.a6.vec3.multiply(S,S,D);const N=a.a6.mat4.create();a.a6.mat4.translate(N,N,S),a.a6.mat4.scale(N,N,D),this.mercatorFogMatrix=N,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,g,P)}_computeCameraPosition(h){const g=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,S=this._camera.forward(),P=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-h/this.worldSize*this._centerAltitude;return[P.x/this.worldSize-S[0]*D,P.y/this.worldSize-S[1]*D,h/this.worldSize*this._centerAltitude-S[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),S=this._camera.position[2],P=h[2];let D=1;this.projection.wrap&&(this.center=this.center.wrap()),P>0&&(D=Math.min((g-S)/P,1)),this._camera.position=a.a6.vec3.scaleAndAdd([],this._camera.position,h,D),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,g=this._camera.forward(),{pitch:S,bearing:P}=this._camera.getPitchBearing(),D=a.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,N=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.bB(this._maxPitch)),$=Math.max((h[2]-D)/Math.cos(S),N),Y=this._zoomFromMercatorZ($);a.a6.vec3.scaleAndAdd(h,h,g,$),this._pitch=a.ap(S,a.bB(this.minPitch),a.bB(this.maxPitch)),this.angle=a.bA(P,-Math.PI,Math.PI),this._setZoom(a.ap(Y,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.a5(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let g=0,S=a.bU,P=0,D=1/0;for(;S-g>1e-6&&S>g;){const N=g+.5*(S-g),$=this.tileSize*Math.pow(2,N),Y=this.getCameraToCenterDistance(this.projection,N,$),ee=this.scaleZoom(Y/(h*this.tileSize)),te=Math.abs(N-ee);te<D&&(D=te,P=N),N<ee?g=N:S=N}return P}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,g){const S=Math.min(h.x,g.x),P=Math.max(h.x,g.x),D=Math.min(h.y,g.y),N=Math.max(h.y,g.y);if(D<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const $=[new a.P(S,D),new a.P(P,N),new a.P(S,N),new a.P(P,D)],Y=this.renderWorldCopies?-3:0,ee=this.renderWorldCopies?4:1;for(const te of $){const le=this.pointRayIntersection(te);if(le.t<0)return!0;const ce=this.rayIntersectionCoordinate(le);if(ce.x<Y||ce.y<0||ce.x>ee||ce.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(h,g){const S=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,h)),P=this._zoomFromMercatorZ(S)+g;return S-this._mercatorZfromZoom(P)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([g,S,P],D){const N=[g,S,P,1];a.a6.vec4.transformMat4(N,N,D);const $=N[3]=Math.max(N[3],1e-6);return N[0]/=$,N[1]/=$,N[2]/=$,N}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,h))}}getCameraToCenterDistance(h,g=this.zoom,S=this.worldSize){const P=a.bX(h,g,this.width,this.height,1024),D=h.pixelSpaceConversion(this.center.lat,S,P);let N=.5/Math.tan(.5*this._fov)*this.height*D;return this.isOrthographic&&(N=Qh(1,N,ed(this.pitch>=15?1:this.pitch/15))),N}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.a6.mat4.multiply(h,h,this.globeMatrix),h}getFrustum(h){return a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,this.projection.zAxisUnit==="meters")}}const oc=(w,h)=>{if(h>0&&w.terrain&&a.w("Cutoff is currently disabled on terrain"),h<=0||w.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const g=w.transform,S=Math.max(Math.abs(g._zoom-(w.minCutoffZoom-1)),1),P=g.isLODDisabled(!1)?a.a7(60,45,g.pitch):a.a7(30,15,g.pitch),D=g._farZ-g._nearZ,N=h*g.height,$=((1-(Y=P))*g.cameraToCenterDistance+Y*(g._farZ+N))*S;var Y;return{shouldRenderCutoff:P<1,uniformValues:{u_cutoff_params:[g._nearZ,g._farZ,($-g._nearZ)/D,($-N-g._nearZ)/D]}}},ws={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class td{constructor(h,g){this.aabb=h,this.lastCascade=g}}class xn{add(h,g){const S=this.receivers[h.key];S!==void 0?(S.aabb.min[0]=Math.min(S.aabb.min[0],g.min[0]),S.aabb.min[1]=Math.min(S.aabb.min[1],g.min[1]),S.aabb.min[2]=Math.min(S.aabb.min[2],g.min[2]),S.aabb.max[0]=Math.max(S.aabb.max[0],g.max[0]),S.aabb.max[1]=Math.max(S.aabb.max[1],g.max[1]),S.aabb.max[2]=Math.max(S.aabb.max[2],g.max[2])):this.receivers[h.key]=new td(g,null)}clear(){this.receivers={}}get(h){return this.receivers[h.key]}computeRequiredCascades(h,g,S){const P=a.c9.fromPoints(h.points);let D=0;for(const N in this.receivers){const $=this.receivers[N];if(!$||!P.intersectsAabb($.aabb))continue;$.aabb.min=P.closestPoint($.aabb.min),$.aabb.max=P.closestPoint($.aabb.max);const Y=$.aabb.getCorners();for(let ee=0;ee<S.length;ee++){let te=!0;for(const le of Y){const ce=[le[0]*g,le[1]*g,le[2]];if(a.a6.vec3.transformMat4(ce,ce,S[ee].matrix),ce[0]<-1||ce[0]>1||ce[1]<-1||ce[1]>1){te=!1;break}}if($.lastCascade=ee,D=Math.max(D,ee),te)break}}return D+1}}class xg{constructor(h){this.painter=h,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new xn,this._depthMode=new qn(h.context.gl.LEQUAL,qn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,h.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),h.tp.registerParameter(ws,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),h.tp.registerParameter(ws,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),h.tp.registerParameter(ws,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),h.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const h of this._cascades)h.texture.destroy(),h.framebuffer.destroy();this._cascades=[]}updateShadowParameters(h,g){const S=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!g||!g.properties)return;const P=g.properties.get("shadow-intensity");if(!g.shadowsEnabled()||P<=0||(this._shadowLayerCount=S.style.order.reduce((xe,be)=>{const Se=S.style._mergedLayers[be];return xe+(Se.hasShadowPass()&&!Se.isHidden(h.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const D=S.context,N=ws.shadowMapResolution,$=ws.shadowMapResolution;if(this._cascades.length===0||ws.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let xe=0;xe<ws.cascadeCount;++xe){const be=S._shadowMapDebug,Se=D.gl,Te=D.createFramebuffer(N,$,be,"texture"),Oe=new a.T(D,{width:N,height:$,data:null},Se.DEPTH_COMPONENT16);if(Te.depthAttachment.set(Oe.texture),be){const Ge=new a.T(D,{width:N,height:$,data:null},Se.RGBA8);Te.colorAttachment.set(Ge.texture)}this._cascades.push({framebuffer:Te,texture:Oe,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.bN,scale:0})}}this.shadowDirection=nd(g);let Y=0;if(h.elevation){const xe=h.elevation,be=[1e4,-1e4];xe.visibleDemTiles.filter(Se=>Se.dem).forEach(Se=>{const Te=Se.dem.tree;be[0]=Math.min(be[0],Te.minimums[0]),be[1]=Math.max(be[1],Te.maximums[0])}),be[0]!==1e4&&(Y=(be[1]-be[0])*xe.exaggeration())}const ee=1.5*h.cameraToCenterDistance,te=3*ee,le=new Float64Array(16);for(let xe=0;xe<this._cascades.length;++xe){const be=this._cascades[xe];let Se=h.height/50,Te=1;ws.cascadeCount===1?Te=te:xe===0?Te=ee:(Se=ee,Te=te);const[Oe,Ge]=Vp(h,this.shadowDirection,Se,Te,ws.shadowMapResolution,Y);be.scale=h.scale,be.matrix=Oe,be.boundingSphereRadius=Ge,a.a6.mat4.invert(le,be.matrix),be.frustum=a.bN.fromInvProjectionMatrix(le,1,0,!0),be.far=Te}const ce=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ce].far,this._cascades[ce].far],this._uniformValues.u_shadow_intensity=P,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ws.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ws.shadowMapResolution,this._uniformValues.u_shadowmap_0=uo.ShadowMap0,this._uniformValues.u_shadowmap_1=uo.ShadowMap0+1,this._groundShadowTiles=S.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const de=S.transform.elevation;for(const xe of this._groundShadowTiles){let be={min:0,max:0};if(de){const Se=de.getMinMaxForTile(xe);Se&&(be=Se)}this.addShadowReceiver(xe.toUnwrapped(),be.min,be.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(h){this._enabled=h}drawShadowPass(h,g){if(!this.enabled)return;const S=this.painter,P=S.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(S.transform.getFrustum(0),S.transform.worldSize,this._cascades),P.viewport.set([0,0,ws.shadowMapResolution,ws.shadowMapResolution]);for(let D=0;D<this._numCascadesToRender;++D){S.currentShadowCascade=D,P.bindFramebuffer.set(this._cascades[D].framebuffer.framebuffer),P.clear({color:a.bz.white,depth:1});for(const N of h.order){const $=h._mergedLayers[N];if(!$.hasShadowPass()||$.isHidden(S.transform.zoom))continue;const Y=h.getLayerSourceCache($),ee=Y?g[Y.id]:void 0;($.type==="model"||ee&&ee.length)&&S.renderLayer(S,Y,$,ee)}}S.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const h=this.painter,g=h.style,S=h.context,P=g.directionalLight,D=g.ambientLight;if(!P||!D)return;const N=[],$=oc(h,h.longestCutoffRange);$.shouldRenderCutoff&&N.push("RENDER_CUTOFF");const Y=Gp(g,P,D),ee=new qn(S.gl.LEQUAL,qn.ReadOnly,h.depthRangeFor3D);for(const te of this._groundShadowTiles){const le=te.toUnwrapped(),ce=h.isTileAffectedByFog(te),de=h.getOrCreateProgram("groundShadow",{defines:N,overrideFog:ce});this.setupShadows(le,de),h.uploadCommonUniforms(S,de,le,null,$);const xe={u_matrix:h.transform.calculateProjMatrix(le),u_ground_shadow_factor:Y};de.draw(h,S.gl.TRIANGLES,ee,mr.disabled,Cr.multiply,yr.disabled,xe,"ground_shadow",h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments,{},h.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Cr.unblended:Cr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(h){const g=this.painter.transform,S=g.calculatePosMatrix(h,g.worldSize);return a.a6.mat4.multiply(S,this._cascades[this.painter.currentShadowCascade].matrix,S),Float32Array.from(S)}calculateShadowPassMatrixFromMatrix(h){return a.a6.mat4.multiply(h,this._cascades[this.painter.currentShadowCascade].matrix,h),Float32Array.from(h)}setupShadows(h,g,S,P=0){if(!this.enabled)return;const D=this.painter.transform,N=this.painter.context,$=N.gl,Y=this._uniformValues,ee=new Float64Array(16),te=D.calculatePosMatrix(h,D.worldSize);for(let le=0;le<this._cascades.length;le++)a.a6.mat4.multiply(ee,this._cascades[le].matrix,te),Y[le===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(ee),N.activeTexture.set($.TEXTURE0+uo.ShadowMap0+le),this._cascades[le].texture.bind($.NEAREST,$.CLAMP_TO_EDGE);if(this.useNormalOffset=!!S,this.useNormalOffset){const le=a.c8(h.canonical),ce=2/D.tileSize*a.ab/ws.shadowMapResolution,de=ce*this._cascades[0].boundingSphereRadius,xe=ce*this._cascades[this._cascades.length-1].boundingSphereRadius,be=(S==="vector-tile"?1:3)/Math.pow(2,P-h.canonical.z-(1-D.zoom+Math.floor(D.zoom)));Y.u_shadow_normal_offset=[le,de*be,xe*be],Y.u_shadow_bias=[6e-5,.0012,.012]}else Y.u_shadow_bias=[36e-5,.0012,.012];g.setShadowUniformValues(N,Y)}setupShadowsFromMatrix(h,g,S=!1){if(!this.enabled)return;const P=this.painter.context,D=P.gl,N=this._uniformValues,$=new Float64Array(16);for(let Y=0;Y<ws.cascadeCount;Y++)a.a6.mat4.multiply($,this._cascades[Y].matrix,h),N[Y===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from($),P.activeTexture.set(D.TEXTURE0+uo.ShadowMap0+Y),this._cascades[Y].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=S,S){const Y=ws.normalOffset;N.u_shadow_normal_offset=[1,Y,Y],N.u_shadow_bias=[6e-5,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];g.setShadowUniformValues(P,N)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(h,g,S,P){if(P[2]>=0)return{};const D=function(Y,ee,te){const le=te/(1<<Y.canonical.z);return new a.c9([Y.canonical.x*le+Y.wrap*te,Y.canonical.y*le+Y.wrap*te,0],[(Y.canonical.x+1)*le+Y.wrap*te,(Y.canonical.y+1)*le+Y.wrap*te,ee])}(h,g,S).getCorners(),N=g/-P[2];P[0]<0?(a.a6.vec3.add(D[0],D[0],[P[0]*N,0,0]),a.a6.vec3.add(D[3],D[3],[P[0]*N,0,0])):P[0]>0&&(a.a6.vec3.add(D[1],D[1],[P[0]*N,0,0]),a.a6.vec3.add(D[2],D[2],[P[0]*N,0,0])),P[1]<0?(a.a6.vec3.add(D[0],D[0],[0,P[1]*N,0]),a.a6.vec3.add(D[1],D[1],[0,P[1]*N,0])):P[1]>0&&(a.a6.vec3.add(D[2],D[2],[0,P[1]*N,0]),a.a6.vec3.add(D[3],D[3],[0,P[1]*N,0]));const $={};return $.vertices=D,$.planes=[Gc(D[1],D[0],D[4]),Gc(D[2],D[1],D[5]),Gc(D[3],D[2],D[6]),Gc(D[0],D[3],D[7])],$}addShadowReceiver(h,g,S){this._receivers.add(h,a.c9.fromTileIdAndHeight(h,g,S))}getMaxCascadeForTile(h){const g=this._receivers.get(h);return g&&g.lastCascade?g.lastCascade:0}}function Gc(w,h,g){const S=a.a6.vec3.sub([],g,h),P=a.a6.vec3.sub([],w,h),D=a.a6.vec3.cross([],S,P),N=a.a6.vec3.length(D);return N===0?[0,0,1,0]:(a.a6.vec3.scale(D,D,1/N),[D[0],D[1],D[2],-a.a6.vec3.dot(D,h)])}function nd(w){const h=w.properties.get("direction"),g=a.c7(h.x,h.y,h.z);g[2]=a.ap(g[2],0,75);const S=a.ca([g[0],g[1],g[2]]);return a.a6.vec3.fromValues(S.x,S.y,S.z)}function Gp(w,h,g){const S=h.properties.get("color"),P=h.properties.get("intensity"),D=h.properties.get("direction"),N=[D.x,D.y,D.z],$=g.properties.get("color"),Y=g.properties.get("intensity"),ee=Math.max(a.a6.vec3.dot([0,0,1],N),0),te=[0,0,0];a.a6.vec3.scale(te,$.toRenderColor(w.getLut(h.scope)).toArray01Linear().slice(0,3),Y);const le=[0,0,0];return a.a6.vec3.scale(le,S.toRenderColor(w.getLut(g.scope)).toArray01Linear().slice(0,3),ee*P),a.cb([te[0]>0?te[0]/(te[0]+le[0]):0,te[1]>0?te[1]/(te[1]+le[1]):0,te[2]>0?te[2]/(te[2]+le[2]):0])}function Vp(w,h,g,S,P,D){const N=w.zoom,$=w.scale,Y=w.worldSize,ee=1/Y,te=w.aspect,le=Math.sqrt(1+te*te)*Math.tan(.5*w.fovX),ce=le*le,de=S-g,xe=S+g;let be,Se;ce>de/xe?(be=S,Se=S*le):(be=.5*xe*(1+ce),Se=.5*Math.sqrt(de*de+2*(S*S+g*g)*ce+xe*xe*ce*ce));const Te=w.projection.pixelsPerMeter(w.center.lat,Y),Oe=w._camera.getCameraToWorldMercator(),Ge=[0,0,-be*ee];a.a6.vec3.transformMat4(Ge,Ge,Oe);let Be=Se*ee;const Xe=w._edgeInsets;if(!(Xe.left===0&&Xe.top===0&&Xe.right===0&&Xe.bottom===0||Xe.left===Xe.right&&Xe.top===Xe.bottom)){const fn=w._camera.getWorldToCamera(w.worldSize,w.projection.zAxisUnit==="meters"?Te:1),mn=w._camera.getCameraToClipPerspective(w._fov,w.width/w.height,g,S);mn[8]=2*-w.centerOffset.x/w.width,mn[9]=2*w.centerOffset.y/w.height;const Yt=new Float64Array(16);a.a6.mat4.mul(Yt,mn,fn);const tn=new Float64Array(16);a.a6.mat4.invert(tn,Yt);const tr=a.bN.fromInvProjectionMatrix(tn,Y,N,!0);for(const bn of tr.points){const Bn=(($e=bn)[0]/=$,$e[1]/=$,$e[2]=a.bD($e[2],w._center.lat),$e);Be=Math.max(Be,a.a6.vec3.len(a.a6.vec3.subtract([],Ge,Bn)))}}var $e;Be*=P/(P-1);const tt=Math.acos(h[2]),Je=Math.atan2(-h[0],-h[1]),nt=new ss;nt.position=Ge,nt.setPitchBearing(tt,Je);const ht=nt.getWorldToCamera(Y,Te),at=Be*Y,st=Math.min(w._mercatorZfromZoom(17)*Y*-2,-2*at),wt=nt.getCameraToClipOrthographic(-at,at,-at,at,st,(at+D*Te)/h[2]),zt=new Float64Array(16);a.a6.mat4.multiply(zt,wt,ht);const Zt=a.a6.vec3.fromValues(Math.floor(1e6*Ge[0])/1e6*Y,Math.floor(1e6*Ge[1])/1e6*Y,0),Ft=.5*P,dn=[0,0,0];a.a6.vec3.transformMat4(dn,Zt,zt),a.a6.vec3.scale(dn,dn,Ft);const St=[Math.floor(dn[0]),Math.floor(dn[1]),Math.floor(dn[2])],$t=[0,0,0];a.a6.vec3.sub($t,dn,St),a.a6.vec3.scale($t,$t,-1/Ft);const Ht=new Float64Array(16);return a.a6.mat4.identity(Ht),a.a6.mat4.translate(Ht,Ht,$t),a.a6.mat4.multiply(zt,Ht,zt),[zt,at]}class Qa extends a.E{constructor(h){super(),this.requestManager=h,this.models={"":{}},this.numModelsLoading={}}loadModel(h,g){return a.aG(this.requestManager.transformRequest(g,a.R.Model).url).then(S=>{if(!S)return;const P=a.aH(S),D=new a.aI(h,void 0,void 0,P);return D.computeBoundsAndApplyParent(),D}).catch(S=>{if(S&&S.status===404)return null;this.fire(new a.t(new Error(`Could not load model ${h} from ${g}: ${S.message}`)))})}load(h,g){this.models[g]||(this.models[g]={});const S=Object.keys(h);this.numModelsLoading[g]=(this.numModelsLoading[g]||0)+S.length;const P=[];for(const D of S)P.push(this.loadModel(D,h[D]));Promise.allSettled(P).then(D=>{for(let N=0;N<D.length;N++){const{status:$,value:Y}=D[N];$==="fulfilled"&&Y&&(this.models[g][S[N]]={model:Y,numReferences:1})}this.numModelsLoading[g]-=S.length,this.fire(new a.x("data",{dataType:"style"}))}).catch(D=>{this.fire(new a.t(new Error(`Could not load models: ${D.message}`)))})}isLoaded(){for(const h in this.numModelsLoading)if(this.numModelsLoading[h]>0)return!1;return!0}hasModel(h,g){return!!this.getModel(h,g)}getModel(h,g){return this.models[g]||(this.models[g]={}),this.models[g][h]?this.models[g][h].model:void 0}addModel(h,g,S){this.models[S]||(this.models[S]={}),this.hasModel(h,S)&&this.models[S][h].numReferences++,this.load({[h]:this.requestManager.normalizeModelURL(g)},S)}addModels(h,g){this.models[g]||(this.models[g]={});const S={};for(const P in h)this.models[g][P]={},S[P]=this.requestManager.normalizeModelURL(h[P]);this.load(S,g)}addModelsFromBucket(h,g){this.models[g]||(this.models[g]={});const S={};for(const P of h)this.hasModel(P,g)?this.models[g][P].numReferences++:S[P]=this.requestManager.normalizeModelURL(P);this.load(S,g)}removeModel(h,g){if(this.models[g]&&this.models[g][h]&&(this.models[g][h].numReferences--,this.models[g][h].numReferences===0)){const S=this.models[g][h].model;delete this.models[g][h],S.destroy()}}listModels(h){return this.models[h]||(this.models[h]={}),Object.keys(this.models[h])}upload(h,g){this.models[g]||(this.models[g]={});for(const S in this.models[g])this.models[g][S].model&&this.models[g][S].model.upload(h.context)}}const bg=new a.a0({data:new a.a1(a._.colorTheme.data)}),ua=(w,h)=>mt(w,h&&h.filter(g=>g.identifier!=="source.canvas")),Na=a.ar(ai,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Vc=a.ar(ai,["setCenter","setZoom","setBearing","setPitch"]),rd={version:8,layers:[],sources:{}},ac={duration:300,delay:0};class za extends a.E{constructor(h,g={}){super(),this.map=h,this.scope=g.scope||"",this.globalId=null,this.fragments=[],this.importDepth=g.importDepth||0,this.importsCache=g.importsCache||new Map,this.resolvedImports=g.resolvedImports||new Set,this.transition=a.l({},ac),this._buildingIndex=new kp(this),this.crossTileSymbolIndex=new Jh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=g.styleChanges||new un,this.dispatcher=g.dispatcher?g.dispatcher:new a.cd(a.ce(),this),g.imageManager?this.imageManager=g.imageManager:(this.imageManager=new en,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=g.glyphManager?g.glyphManager:new a.cf(h._requestManager,g.localFontFamily?a.cg.all:g.localIdeographFontFamily?a.cg.ideographs:a.cg.none,g.localFontFamily||g.localIdeographFontFamily),g.modelManager?this.modelManager=g.modelManager:(this.modelManager=new Qa(h._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=g.configOptions?g.configOptions:new Map,this._configDependentLayers=g.configDependentLayers?g.configDependentLayers:new Set,this._config=g.config,this._initialConfig=g.initialConfig,this.dispatcher.broadcast("setReferrer",a.ch());const S=this;this._rtlTextPluginCallback=za.registerForPluginStateChange(P=>{S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:P.pluginStatus,pluginURL:P.pluginURL},(D,N)=>{if(a.ci(D),N&&N.every($=>$))for(const $ in S._sourceCaches){const Y=S._sourceCaches[$],ee=Y.getSource().type;ee!=="vector"&&ee!=="geojson"||Y.reload()}})}),this.on("data",P=>{if(P.dataType!=="source"||P.sourceDataType!=="metadata")return;const D=this.getOwnSource(P.sourceId);if(D&&D.vectorLayerIds)for(const N in this._layers){const $=this._layers[N];$.source===D.id&&this._validateLayer($)}})}load(h){return h?(typeof h=="string"?this.loadURL(h):this.loadJSON(h),this):this}_getGlobalId(h){if(!h)return null;if(typeof h=="string"){if(a.f(h))return h;const g=a.cj(h);if(!g.startsWith("http"))try{return new URL(g,location.href).toString()}catch{return g}return g}return`json://${a.ck(JSON.stringify(h))}`}_diffStyle(h,g,S){this.globalId=this._getGlobalId(h);const P=(D,N)=>{try{N(null,this.setState(D,S))}catch($){N($,!1)}};if(typeof h=="string"){const D=this.map._requestManager.normalizeStyleURL(h),N=this.map._requestManager.transformRequest(D,a.R.Style);a.n(N,($,Y)=>{$?this.fire(new a.t($)):Y&&P(Y,g)})}else typeof h=="object"&&P(h,g)}loadURL(h,g={}){this.fire(new a.x("dataloading",{dataType:"style"}));const S=typeof g.validate=="boolean"?g.validate:!a.f(h);this.globalId=this._getGlobalId(h),h=this.map._requestManager.normalizeStyleURL(h,g.accessToken),this.resolvedImports.add(h);const P=this.importsCache.get(h);if(P)return this._load(P,S);const D=this.map._requestManager.transformRequest(h,a.R.Style);this._request=a.n(D,(N,$)=>{if(this._request=null,N)this.fire(new a.t(N));else if($)return this.importsCache.set(h,$),this._load($,S)})}loadJSON(h,g={}){this.fire(new a.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(h),this._request=a.q.frame(()=>{this._request=null,this._load(h,g.validate!==!1)})}loadEmpty(){this.fire(new a.x("dataloading",{dataType:"style"})),this._load(rd,!1)}_loadImports(h,g,S){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const P=[];for(const D of h){const N=this._createFragmentStyle(D),$=new Promise(te=>{N.once("style.import.load",te),N.once("error",te)}).then(()=>this.mergeAll());if(P.push($),this.resolvedImports.has(D.url)){N.loadEmpty();continue}const Y=D.data||this.importsCache.get(D.url);Y?(N.loadJSON(Y,{validate:g}),this._isInternalStyle(Y)&&(N.globalId=null)):D.url?N.loadURL(D.url,{validate:g}):N.loadEmpty();const ee={style:N,id:D.id,config:D.config};if(S){const te=this.fragments.findIndex(({id:le})=>le===S);this.fragments=this.fragments.slice(0,te).concat(ee).concat(this.fragments.slice(te))}else this.fragments.push(ee)}return Promise.allSettled(P)}getImportGlobalIds(h=this,g=new Set){for(const S of h.fragments)S.style.globalId&&g.add(S.style.globalId),this.getImportGlobalIds(S.style,g);return[...g.values()]}_createFragmentStyle(h){const g=this.scope?a.av(h.id,this.scope):h.id;let S;const P=this._initialConfig&&this._initialConfig[g];(h.config||P)&&(S=a.l({},h.config,P));const D=new za(this.map,{scope:g,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:S,configOptions:this.options,configDependentLayers:this._configDependentLayers});return D.setEventedParent(this.map,{style:D}),D}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(h){return this.isRootStyle()&&(h.fragment||!!h.schema&&h.fragment!==!1)}_load(h,g){const S=h.schema;if(this._isInternalStyle(h)){const N=a.l({},rd,{imports:[{id:"basemap",data:h,url:""}]});return void this._load(N,g)}if(this.updateConfig(this._config,S),g&&ua(this,In(h)))return;this._loaded=!0,this.stylesheet=a.cl(h);const P=()=>{for(const ee in h.sources)this.addSource(ee,h.sources[ee],{validate:!1,isInitialLoad:!0});h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(h.glyphs,this.scope);const N=qh(this.stylesheet.layers);if(this._order=N.map(ee=>ee.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const ee=this.stylesheet.lights[0];this.light=new yt(ee.properties,ee.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new yt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const ee of N){const te=a.cq(ee,this.scope,this._styleColorTheme.lut,this.options);te.configDependencies.size!==0&&this._configDependentLayers.add(te.fqid),te.setEventedParent(this,{layer:{id:te.id}}),this._layers[te.id]=te,this._serializedLayers[te.id]=te.serialize();const le=this.getOwnLayerSourceCache(te),ce=!!this.directionalLight&&this.directionalLight.shadowsEnabled();le&&te.canCastShadows()&&ce&&(le.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const $=this.stylesheet.terrain;$&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain($,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.x("data",{dataType:"style"}));const Y=this.isRootStyle();h.imports?this._loadImports(h.imports,g).then(()=>{this._reloadImports(),this.fire(new a.x(Y?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.x(Y?"style.load":"style.import.load")))},D=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=D,D){const N=this._evaluateColorThemeData(D);this._loadColorTheme(N).then(()=>{P()}).catch($=>{a.w(`Couldn't load color theme from the stylesheet: ${$}`),P()})}else this._styleColorTheme.lut=null,P()}isRootStyle(){return this.importDepth===0}mergeAll(){let h,g,S,P,D,N,$,Y;const ee={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(te=>{if(te.stylesheet){if(te.light!=null&&(h=te.light),te.stylesheet.lights)for(const le of te.stylesheet.lights)le.type==="ambient"&&te.ambientLight!=null&&(g=te.ambientLight),le.type==="directional"&&te.directionalLight!=null&&(S=te.directionalLight);P=this._prioritizeTerrain(P,te.terrain,te.stylesheet.terrain),te.stylesheet.fog&&te.fog!=null&&(D=te.fog),te.stylesheet.camera!=null&&(Y=te.stylesheet.camera),te.stylesheet.projection!=null&&(N=te.stylesheet.projection),te.stylesheet.transition!=null&&($=te.stylesheet.transition),ee[te.scope]=te._styleColorTheme}}),this.light=h,this.ambientLight=g,this.directionalLight=S,this.fog=D,this._styleColorThemeForScope=ee,P===null?delete this.terrain:this.terrain=P,this.camera=Y||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=a.l({},ac,$),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(h){const g=S=>{for(const P of S.fragments)g(P.style);h(S)};g(this)}_prioritizeTerrain(h,g,S){const P=h&&h.drapeRenderMode===0;return S===null?g&&g.drapeRenderMode===0?g:P?h:null:g!=null&&(!h||P||g&&g.drapeRenderMode===1)?g:h}mergeTerrain(){let h;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(g=>{h=this._prioritizeTerrain(h,g.terrain,g.stylesheet.terrain)}),h===null?delete this.terrain:this.terrain=h}mergeProjection(){let h;this.forEachFragmentStyle(g=>{g.stylesheet.projection!=null&&(h=g.stylesheet.projection)}),this.projection=h||{name:"mercator"}}mergeSources(){const h={},g={},S={};this.forEachFragmentStyle(P=>{for(const D in P._sourceCaches){const N=a.av(D,P.scope);h[N]=P._sourceCaches[D]}for(const D in P._otherSourceCaches){const N=a.av(D,P.scope);g[N]=P._otherSourceCaches[D]}for(const D in P._symbolSourceCaches){const N=a.av(D,P.scope);S[N]=P._symbolSourceCaches[D]}}),this._mergedSourceCaches=h,this._mergedOtherSourceCaches=g,this._mergedSymbolSourceCaches=S}mergeLayers(){const h={},g=[],S={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(D=>{for(const N of D._order){const $=D._layers[N];if($.type==="slot"){const Y=a.cm(N);if(h[Y])continue;h[Y]=[]}$.slot&&h[$.slot]?h[$.slot].push($):g.push($)}}),this._mergedOrder=[];const P=(D=[])=>{for(const N of D)if(N.type==="slot"){const $=a.cm(N.id);h[$]&&P(h[$]),this._mergedSlots.push($)}else{const $=a.av(N.id,N.scope);this._mergedOrder.push($),S[$]=N,N.is3D()&&(this._has3DLayers=!0),N.type==="circle"&&(this._hasCircleLayers=!0),N.type==="symbol"&&(this._hasSymbolLayers=!0),N.type==="clip"&&(this._clipLayerPresent=!0)}};P(g),this._mergedOrder.sort((D,N)=>{const $=S[D],Y=S[N];return $.hasInitialOcclusionOpacityProperties?Y.is3D()?1:0:$.is3D()&&Y.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=S,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(h){return this.stylesheet.camera=a.l({},this.stylesheet.camera,h),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(h){return h.data?function(g,S,P){const D=a.l({},S);for(const $ of Object.keys(a._.colorTheme))D[$]===void 0&&(D[$]=a._.colorTheme[$].default);const N=new a.$(bg,g,new Map(P));return N.setTransitionOrValue(D,P),N.untransitioned().possiblyEvaluate(new a.a3(0))}(this.scope,h,this.options).get("data"):null}_loadColorTheme(h){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const g=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((S,P)=>{const D="data:image/png;base64,";if(!h||h.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void S();let N=h;N.startsWith(D)||(N=D+N);const $="mapbox-reserved-lut",Y=new Image;Y.src=N,Y.onerror=()=>{this._styleColorTheme.lutLoading=!1,P(new Error("Failed to load image data"))},Y.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==g)return void S();this._styleColorTheme.lutLoading=!1;const{width:ee,height:te,data:le}=a.q.getImageData(Y);if(te>32)return void P(new Error("The height of the image must be less than or equal to 32 pixels."));if(ee!==te*te)return void P(new Error("The width of the image must be equal to the height squared."));this.getImage($)&&this.removeImage($),this.addImage($,{data:new a.r({width:ee,height:te},le),pixelRatio:1,sdf:!1,version:0});const ce=this.imageManager.getImage($,this.scope);ce?(this._styleColorTheme.lut={image:ce.data,data:h},S()):P(new Error("Missing LUT image."))}})}getLut(h){const g=this._styleColorThemeForScope[h];return g?g.lut:null}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(h){this._spriteRequest=function(g,S,P){let D,N,$;const Y=a.q.devicePixelRatio>1?"@2x":"";let ee=a.n(S.transformRequest(S.normalizeSpriteURL(g,Y,".json"),a.R.SpriteJSON),(ce,de)=>{ee=null,$||($=ce,D=de,le())}),te=a.o(S.transformRequest(S.normalizeSpriteURL(g,Y,".png"),a.R.SpriteImage),(ce,de)=>{te=null,$||($=ce,N=de,le())});function le(){if($)P($);else if(D&&N){const ce=a.q.getImageData(N),de={};for(const xe in D){const{width:be,height:Se,x:Te,y:Oe,sdf:Ge,pixelRatio:Be,stretchX:Xe,stretchY:$e,content:tt}=D[xe],Je=new a.r({width:be,height:Se});a.r.copy(ce,Je,{x:Te,y:Oe},{x:0,y:0},{width:be,height:Se},null),de[xe]={data:Je,pixelRatio:Be,sdf:Ge,stretchX:Xe,stretchY:$e,content:tt}}P(null,de)}}return{cancel(){ee&&(ee.cancel(),ee=null),te&&(te.cancel(),te=null)}}}(h,this.map._requestManager,(g,S)=>{if(this._spriteRequest=null,g)this.fire(new a.t(g));else if(S)for(const P in S)this.imageManager.addImage(P,this.scope,S[P]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.x("data",{dataType:"style"}))})}_validateLayer(h){const g=this.getOwnSource(h.source);if(!g)return;const S=h.sourceLayer;S&&(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(S)===-1)&&this.fire(new a.t(new Error(`Source layer "${S}" does not exist on source "${g.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:h}of this.fragments)if(!h.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((h,g)=>{const S=this.fragments[g];return S&&S.style&&(h.data=S.style.serialize()),h})}_serializeSources(){const h={};for(const g in this._sourceCaches){const S=this._sourceCaches[g].getSource();h[S.id]||(h[S.id]=S.serialize())}return h}_serializeLayers(h){const g=[];for(const S of h){const P=this._layers[S];P&&P.type!=="custom"&&g.push(P.serialize())}return g}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(h){return!!this.terrain&&h.isDraped(this.getLayerSourceCache(h))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(h){const g=this.getOwnLayer(h);if(g)return g;this.fire(new a.t(new Error(`The layer '${h}' does not exist in the map's style.`)))}_checkSource(h){const g=this.getOwnSource(h);if(g)return g;this.fire(new a.t(new Error(`The source '${h}' does not exist in the map's style.`)))}precompilePrograms(h,g){const S=this.map.painter;if(S)for(let P=h.minzoom||0;P<(h.maxzoom||25.5);P++){const D=h.getProgramIds();if(D)for(const N of D){const $=h.getDefaultProgramParams(N,g.zoom,this._styleColorTheme.lut);$&&(S.style=this,this.fog&&(S._fogVisible=!0,$.overrideFog=!0,S.getOrCreateProgram(N,$)),S._fogVisible=!1,$.overrideFog=!1,S.getOrCreateProgram(N,$),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&($.overrideRtt=!0,S.getOrCreateProgram(N,$)))}}}update(h){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(h),this.directionalLight&&this.directionalLight.recalculate(h);const g=this.calculateLightsBrightness();h.brightness=g||0,g!==this._brightness&&(this._brightness=g,this.dispatcher.broadcast("setBrightness",g));const S=this._changes.isDirty();let P=!1;if(this._changes.isDirty()){const N=this._changes.getLayerUpdatesByScope();for(const $ in N){const{updatedIds:Y,removedIds:ee}=N[$];(Y||ee)&&(this._updateWorkerLayers($,Y,ee),P=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(h),this.light&&this.light.updateTransitions(h),this.ambientLight&&this.ambientLight.updateTransitions(h),this.directionalLight&&this.directionalLight.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._changes.reset()}const D={};for(const N in this._mergedSourceCaches){const $=this._mergedSourceCaches[N];D[N]=$.used,$.used=!1,$.tileCoverLift=0}for(const N of this._mergedOrder){const $=this._mergedLayers[N];if($.recalculate(h,this._availableImages),!$.isHidden(h.zoom)){const Y=this.getLayerSourceCache($);Y&&(Y.used=!0,Y.tileCoverLift=Math.max(Y.tileCoverLift,$.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms($,h)}):this.precompilePrograms($,h))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&P&&this.mergeLayers();for(const N in D){const $=this._mergedSourceCaches[N];D[N]!==$.used&&$.getSource().fire(new a.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:$.getSource().id}))}this.light&&this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),S&&this.fire(new a.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=this._changes.getUpdatedImages();if(h.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changes.resetUpdatedImages()}}_updateWorkerLayers(h,g,S){const P=this.getFragmentStyle(h);P&&this.dispatcher.broadcast("updateLayers",{layers:g?P._serializeLayers(g):[],scope:h,removedIds:S||[],options:P.options})}setState(h,g){if(this._checkLoaded(),ua(this,In(h)))return!1;(h=a.cl(h)).layers=qh(h.layers);const S=function(N,$){if(!N)return[{command:ai.setStyle,args:[$]}];let Y=[];try{if(!a.bh(N.version,$.version))return[{command:ai.setStyle,args:[$]}];if(a.bh(N.center,$.center)||Y.push({command:ai.setCenter,args:[$.center]}),a.bh(N.zoom,$.zoom)||Y.push({command:ai.setZoom,args:[$.zoom]}),a.bh(N.bearing,$.bearing)||Y.push({command:ai.setBearing,args:[$.bearing]}),a.bh(N.pitch,$.pitch)||Y.push({command:ai.setPitch,args:[$.pitch]}),a.bh(N.sprite,$.sprite)||Y.push({command:ai.setSprite,args:[$.sprite]}),a.bh(N.glyphs,$.glyphs)||Y.push({command:ai.setGlyphs,args:[$.glyphs]}),a.bh(N.imports,$.imports)||function(de=[],xe=[],be){xe=xe||[];const Se=(de=de||[]).map(Yh),Te=xe.map(Yh),Oe=de.reduce(yf,{}),Ge=xe.reduce(yf,{}),Be=Se.slice();let Xe,$e,tt,Je;for(Xe=0,$e=0;Xe<Se.length;Xe++)tt=Se[Xe],Ge.hasOwnProperty(tt)?$e++:(be.push({command:ai.removeImport,args:[tt]}),Be.splice(Be.indexOf(tt,$e),1));for(Xe=0,$e=0;Xe<Te.length;Xe++)tt=Te[Te.length-1-Xe],Be[Be.length-1-Xe]!==tt&&(Oe.hasOwnProperty(tt)?(be.push({command:ai.removeImport,args:[tt]}),Be.splice(Be.lastIndexOf(tt,Be.length-$e),1)):$e++,Je=Be[Be.length-Xe],be.push({command:ai.addImport,args:[Ge[tt],Je]}),Be.splice(Be.length-Xe,0,tt));for(const nt of xe){const ht=Oe[nt.id];ht&&!a.bh(ht,nt)&&be.push({command:ai.updateImport,args:[nt.id,nt]})}}(N.imports,$.imports,Y),a.bh(N.transition,$.transition)||Y.push({command:ai.setTransition,args:[$.transition]}),a.bh(N.light,$.light)||Y.push({command:ai.setLight,args:[$.light]}),a.bh(N.fog,$.fog)||Y.push({command:ai.setFog,args:[$.fog]}),a.bh(N.projection,$.projection)||Y.push({command:ai.setProjection,args:[$.projection]}),a.bh(N.lights,$.lights)||Y.push({command:ai.setLights,args:[$.lights]}),a.bh(N.camera,$.camera)||Y.push({command:ai.setCamera,args:[$.camera]}),!a.bh(N["color-theme"],$["color-theme"]))return[{command:ai.setStyle,args:[$]}];const ee={},te=[];(function(de,xe,be,Se){let Te;for(Te in xe=xe||{},de=de||{})de.hasOwnProperty(Te)&&(xe.hasOwnProperty(Te)||_r(Te,be,Se));for(Te in xe){if(!xe.hasOwnProperty(Te))continue;const Oe=xe[Te];de.hasOwnProperty(Te)?a.bh(de[Te],Oe)||(de[Te].type==="geojson"&&Oe.type==="geojson"&&ur(de,xe,Te)?be.push({command:ai.setGeoJSONSourceData,args:[Te,Oe.data]}):Gx(Te,xe,be,Se)):Op(Te,xe,be)}})(N.sources,$.sources,te,ee);const le=[];N.layers&&N.layers.forEach(de=>{de.source&&ee[de.source]?Y.push({command:ai.removeLayer,args:[de.id]}):le.push(de)});let ce=N.terrain;ce&&ee[ce.source]&&(Y.push({command:ai.setTerrain,args:[void 0]}),ce=void 0),Y=Y.concat(te),a.bh(ce,$.terrain)||Y.push({command:ai.setTerrain,args:[$.terrain]}),function(de,xe,be){xe=xe||[];const Se=(de=de||[]).map(Yh),Te=xe.map(Yh),Oe=de.reduce(yf,{}),Ge=xe.reduce(yf,{}),Be=Se.slice(),Xe=Object.create(null);let $e,tt,Je,nt,ht,at,st;for($e=0,tt=0;$e<Se.length;$e++)Je=Se[$e],Ge.hasOwnProperty(Je)?tt++:(be.push({command:ai.removeLayer,args:[Je]}),Be.splice(Be.indexOf(Je,tt),1));for($e=0,tt=0;$e<Te.length;$e++)Je=Te[Te.length-1-$e],Be[Be.length-1-$e]!==Je&&(Oe.hasOwnProperty(Je)?(be.push({command:ai.removeLayer,args:[Je]}),Be.splice(Be.lastIndexOf(Je,Be.length-tt),1)):tt++,at=Be[Be.length-$e],be.push({command:ai.addLayer,args:[Ge[Je],at]}),Be.splice(Be.length-$e,0,Je),Xe[Je]=!0);for($e=0;$e<Te.length;$e++)if(Je=Te[$e],nt=Oe[Je],ht=Ge[Je],!Xe[Je]&&!a.bh(nt,ht))if(a.bh(nt.source,ht.source)&&a.bh(nt["source-layer"],ht["source-layer"])&&a.bh(nt.type,ht.type)){for(st in _f(nt.layout,ht.layout,be,Je,null,ai.setLayoutProperty),_f(nt.paint,ht.paint,be,Je,null,ai.setPaintProperty),a.bh(nt.slot,ht.slot)||be.push({command:ai.setSlot,args:[Je,ht.slot]}),a.bh(nt.filter,ht.filter)||be.push({command:ai.setFilter,args:[Je,ht.filter]}),a.bh(nt.minzoom,ht.minzoom)&&a.bh(nt.maxzoom,ht.maxzoom)||be.push({command:ai.setLayerZoomRange,args:[Je,ht.minzoom,ht.maxzoom]}),nt)nt.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&st!=="slot"&&(st.indexOf("paint.")===0?_f(nt[st],ht[st],be,Je,st.slice(6),ai.setPaintProperty):a.bh(nt[st],ht[st])||be.push({command:ai.setLayerProperty,args:[Je,st,ht[st]]}));for(st in ht)ht.hasOwnProperty(st)&&!nt.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&st!=="slot"&&(st.indexOf("paint.")===0?_f(nt[st],ht[st],be,Je,st.slice(6),ai.setPaintProperty):a.bh(nt[st],ht[st])||be.push({command:ai.setLayerProperty,args:[Je,st,ht[st]]}))}else be.push({command:ai.removeLayer,args:[Je]}),at=Be[Be.lastIndexOf(Je)+1],be.push({command:ai.addLayer,args:[ht,at]})}(le,$.layers,Y)}catch(ee){console.warn("Unable to compute style diff:",ee),Y=[{command:ai.setStyle,args:[$]}]}return Y}(this.serialize(),h).filter(N=>!(N.command in Vc));if(S.length===0)return!1;const P=S.filter(N=>!(N.command in Na));if(P.length>0)throw new Error(`Unimplemented: ${P.map(N=>N.command).join(", ")}.`);const D=[];return S.forEach(N=>{D.push(this[N.command].apply(this,N.args))}),g&&Promise.all(D).then(g),this.stylesheet=h,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(h,g){return this.getImage(h)?this.fire(new a.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,this.scope,g),this._afterImageUpdated(h),this)}updateImage(h,g){this.imageManager.updateImage(h,this.scope,g)}getImage(h){return this.imageManager.getImage(h,this.scope)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h,this.scope),this._afterImageUpdated(h),this):this.fire(new a.t(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(h),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(h,g,S={}){return this._checkLoaded(),this._validate(it,`models.${h}`,g,null,S)||(this.modelManager.addModel(h,g,this.scope),this._changes.setDirty()),this}hasModel(h){return this.modelManager.hasModel(h,this.scope)}removeModel(h){return this.hasModel(h)?(this.modelManager.removeModel(h,this.scope),this):this.fire(new a.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(h,g,S={}){if(this._checkLoaded(),this.getOwnSource(h)!==void 0)throw new Error(`There is already a source with ID "${h}".`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(Tr,`sources.${h}`,g,null,S))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const P=Qi(h,g,this.dispatcher,this);P.scope=this.scope,P.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(P.id),source:P.serialize(),sourceId:P.id}));const D=N=>{const $=(N?"symbol:":"other:")+P.id,Y=a.av($,this.scope),ee=this._sourceCaches[$]=new Zo(Y,P,N);(N?this._symbolSourceCaches:this._otherSourceCaches)[P.id]=ee,ee.onAdd(this.map)};D(!1),g.type!=="vector"&&g.type!=="geojson"||D(!0),P.onAdd&&P.onAdd(this.map),S.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(h){this._checkLoaded();const g=this.getOwnSource(h);if(!g)throw new Error("There is no source with this ID");for(const P in this._layers)if(this._layers[P].source===h)return this.fire(new a.t(new Error(`Source "${h}" cannot be removed while layer "${P}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===h)return this.fire(new a.t(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const S=this.getOwnSourceCaches(h);for(const P of S){const D=a.cm(P.id);delete this._sourceCaches[D],this._changes.discardSourceCacheUpdate(P.id),P.fire(new a.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:P.getSource().id})),P.setEventedParent(null),P.clearTiles()}return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],this.mergeSources(),g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(h,g){this._checkLoaded(),this.getOwnSource(h).setData(g),this._changes.setDirty()}getOwnSource(h){const g=this.getOwnSourceCache(h);return g&&g.getSource()}getOwnSources(){const h=[];for(const g in this._otherSourceCaches){const S=this.getOwnSourceCache(g);S&&h.push(S.getSource())}return h}areTilesLoaded(){const h=this._mergedSourceCaches;for(const g in h){const S=h[g]._tiles;for(const P in S){const D=S[P];if(D.state!=="loaded"&&D.state!=="errored")return!1}}return!0}setLights(h){if(this._checkLoaded(),!h)return delete this.ambientLight,void delete this.directionalLight;const g=this._getTransitionParameters();for(const P of h){if(this._validate(ps,"lights",P))return;switch(P.type){case"ambient":if(this.ambientLight){const D=this.ambientLight;D.set(P),D.updateTransitions(g)}else this.ambientLight=new Sn(P,yn||(yn=new a.a0({color:new a.a1(a._.properties_light_ambient.color),intensity:new a.a1(a._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const D=this.directionalLight;D.set(P),D.updateTransitions(g)}else this.directionalLight=new Sn(P,Un||(Un=new a.a0({direction:new a.ad(a._.properties_light_directional.direction),color:new a.a1(a._.properties_light_directional.color),intensity:new a.a1(a._.properties_light_directional.intensity),"cast-shadows":new a.a1(a._.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.a1(a._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const S=new a.a3(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(S),this.directionalLight&&this.directionalLight.recalculate(S),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const h=this.directionalLight,g=this.ambientLight;if(!h||!g)return;const S=le=>.2126*(le[0]<=.03928?le[0]/12.92:Math.pow((le[0]+.055)/1.055,2.4))+.7152*(le[1]<=.03928?le[1]/12.92:Math.pow((le[1]+.055)/1.055,2.4))+.0722*(le[2]<=.03928?le[2]/12.92:Math.pow((le[2]+.055)/1.055,2.4)),P=h.properties.get("color").toRenderColor(null).toArray01(),D=h.properties.get("intensity"),N=h.properties.get("direction"),$=1-a.c7(N.x,N.y,N.z)[2]/90,Y=S(P)*D*$,ee=g.properties.get("color").toRenderColor(null).toArray01(),te=g.properties.get("intensity");return(Y+S(ee)*te)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const h=[];return this.directionalLight&&h.push(this.directionalLight.get()),this.ambientLight&&h.push(this.ambientLight.get()),h}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(h){if(!h)return this;if(a.cn(h)){const g=a.co(h),S=this.fragments.find(({id:D})=>D===g);if(!S)throw new Error(`Style import not found: ${h}`);const P=a.cm(h);return S.style.getFragmentStyle(P)}{const g=this.fragments.find(({id:S})=>S===h);if(!g)throw new Error(`Style import not found: ${h}`);return g.style}}getConfigProperty(h,g){const S=this.getFragmentStyle(h);if(!S)return null;const P=a.av(g,S.scope),D=S.options.get(P),N=D?D.value||D.default:null;return N?N.serialize():null}setConfigProperty(h,g,S){const P=this.getFragmentStyle(h);if(!P)return;const D=P.stylesheet.schema;if(!D||!D[g])return;const N=a.M(S);if(N.result!=="success")return void ua(this,N.value);const $=N.value.expression,Y=a.av(g,P.scope),ee=P.options.get(Y);if(!ee)return;let te;const{minValue:le,maxValue:ce,stepValue:de,type:xe,values:be}=D[g],Se=a.M(D[g].default);Se.result==="success"&&(te=Se.value.expression),te?(this.options.set(Y,{...ee,value:$,default:te,minValue:le,maxValue:ce,stepValue:de,type:xe,values:be}),this.updateConfigDependencies(g)):this.fire(new a.t(new Error(`No schema defined for the config option "${g}" in the "${h}" fragment.`)))}getConfig(h){const g=this.getFragmentStyle(h);if(!g)return null;const S=g.stylesheet.schema;if(!S)return null;const P={};for(const D in S){const N=a.av(D,g.scope),$=g.options.get(N),Y=$?$.value||$.default:null;P[D]=Y?Y.serialize():null}return P}setConfig(h,g){const S=this.getFragmentStyle(h);S&&(S.updateConfig(g,S.stylesheet.schema),this.updateConfigDependencies())}getSchema(h){const g=this.getFragmentStyle(h);return g?g.stylesheet.schema:null}setSchema(h,g){const S=this.getFragmentStyle(h);S&&(S.stylesheet.schema=g,S.updateConfig(S._config,g),this.updateConfigDependencies())}updateConfig(h,g){if(this._config=h,h||g)if(g)for(const S in g){let P,D;const N=a.M(g[S].default);if(N.result==="success"&&(P=N.value.expression),h&&h[S]!==void 0){const ce=a.M(h[S]);ce.result==="success"&&(D=ce.value.expression)}const{minValue:$,maxValue:Y,stepValue:ee,type:te,values:le}=g[S];if(P){const ce=a.av(S,this.scope);this.options.set(ce,{default:P,value:D,minValue:$,maxValue:Y,stepValue:ee,type:te,values:le})}else this.fire(new a.t(new Error(`No schema defined for config option "${S}".`)))}else this.fire(new a.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(h){for(const g of this._configDependentLayers){const S=this.getLayer(g);if(S){if(h&&!S.configDependencies.has(h))continue;S.possiblyEvaluateVisibility(),this._updateLayer(S)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(g=>{if(g._styleColorTheme.colorTheme){const S=g._evaluateColorThemeData(g._styleColorTheme.colorTheme);(!g._styleColorTheme.lut&&S!==""||g._styleColorTheme.lut&&S!==g._styleColorTheme.lut.data)&&g.setColorTheme(g._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(h,g,S={}){this._checkLoaded();const P=h.id;if(this._layers[P])return void this.fire(new a.t(new Error(`Layer with id "${P}" already exists on this map`)));let D;if(h.type==="custom"){if(ua(this,a.cp(h)))return;D=a.cq(h,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof h.source=="object"&&(this.addSource(P,h.source),h=a.cl(h),h=a.l(h,{source:P})),this._validate(Mt,`layers.${P}`,h,{arrayIndex:-1},S))return;D=a.cq(h,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(D),D.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[D.id]=D.serialize()}D.configDependencies.size!==0&&this._configDependentLayers.add(D.fqid);let N=this._order.length;if(g){const te=this._order.indexOf(g);if(te===-1)return void this.fire(new a.t(new Error(`Layer with id "${g}" does not exist on this map.`)));D.slot===this._layers[g].slot?N=te:a.w(`Layer with id "${g}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(N,0,P),this._layerOrderChanged=!0,this._layers[P]=D;const $=this.getOwnLayerSourceCache(D),Y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();$&&D.canCastShadows()&&Y&&($.castsShadows=!0);const ee=this._changes.getRemovedLayer(D);if(ee&&D.source&&$&&D.type!=="custom"){this._changes.discardLayerRemoval(D);const te=a.av(D.source,D.scope);ee.type!==D.type?this._changes.updateSourceCache(te,"clear"):(this._changes.updateSourceCache(te,"reload"),$.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),D.scope=this.scope,this.mergeLayers()}moveLayer(h,g){this._checkLoaded();const S=this._checkLayer(h);if(!S||h===g)return;const P=this._order.indexOf(h);this._order.splice(P,1);let D=this._order.length;if(g){const N=this._order.indexOf(g);if(N===-1)return void this.fire(new a.t(new Error(`Layer with id "${g}" does not exist on this map.`)));S.slot===this._layers[g].slot?D=N:a.w(`Layer with id "${g}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(D,0,h),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(h){this._checkLoaded();const g=this._checkLayer(h);if(!g)return;g.setEventedParent(null);const S=this._order.indexOf(h);this._order.splice(S,1),delete this._layers[h],delete this._serializedLayers[h],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(g.fqid),this._changes.removeLayer(g);const P=this.getOwnLayerSourceCache(g);if(P&&P.castsShadows){let D=!1;for(const N in this._layers)if(this._layers[N].source===g.source&&this._layers[N].canCastShadows()){D=!0;break}P.castsShadows=D}g.onRemove&&g.onRemove(this.map),this.mergeLayers()}getOwnLayer(h){return this._layers[h]}hasLayer(h){return h in this._mergedLayers}hasLayerType(h){for(const g in this._layers)if(this._layers[g].type===h)return!0;return!1}setLayerZoomRange(h,g,S){this._checkLoaded();const P=this._checkLayer(h);P&&(P.minzoom===g&&P.maxzoom===S||(g!=null&&(P.minzoom=g),S!=null&&(P.maxzoom=S),this._updateLayer(P)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(h,g){this._checkLoaded();const S=this._checkLayer(h);S&&S.slot!==g&&(S.slot=g,this._updateLayer(S))}setFilter(h,g,S={}){this._checkLoaded();const P=this._checkLayer(h);if(P&&!a.bh(P.filter,g))return g==null?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(we,`layers.${P.id}.filter`,g,{layerType:P.type},S)||(P.filter=a.cl(g),this._updateLayer(P)))}getFilter(h){const g=this._checkLayer(h);if(g)return a.cl(g.filter)}setLayoutProperty(h,g,S,P={}){this._checkLoaded();const D=this._checkLayer(h);if(D&&!a.bh(D.getLayoutProperty(g),S)){if(S!=null&&(!P||P.validate!==!1)&&ua(D,qe.call(In,{key:`layers.${h}.layout.${g}`,layerType:D.type,objectKey:g,value:S,styleSpec:a._,style:{glyphs:!0,sprite:!0}})))return;D.setLayoutProperty(g,S),D.configDependencies.size!==0&&this._configDependentLayers.add(D.fqid),this._updateLayer(D)}}getLayoutProperty(h,g){const S=this._checkLayer(h);if(S)return S.getLayoutProperty(g)}setPaintProperty(h,g,S,P={}){this._checkLoaded();const D=this._checkLayer(h);if(!D||a.bh(D.getPaintProperty(g),S)||S!=null&&(!P||P.validate!==!1)&&ua(D,Ie.call(In,{key:`layers.${h}.paint.${g}`,layerType:D.type,objectKey:g,value:S,styleSpec:a._})))return;const N=D.setPaintProperty(g,S);D.configDependencies.size!==0&&this._configDependentLayers.add(D.fqid),N&&this._updateLayer(D),this._changes.updatePaintProperties(D)}getPaintProperty(h,g){const S=this._checkLayer(h);if(S)return S.getPaintProperty(g)}setFeatureState(h,g){this._checkLoaded();const S=h.source,P=h.sourceLayer,D=this._checkSource(S);if(!D)return;const N=D.type;if(N==="geojson"&&P)return void this.fire(new a.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(N==="vector"&&!P)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided.")));const $=this.getOwnSourceCaches(S);for(const Y of $)Y.setFeatureState(P,h.id,g)}removeFeatureState(h,g){this._checkLoaded();const S=h.source,P=this._checkSource(S);if(!P)return;const D=P.type,N=D==="vector"?h.sourceLayer:void 0;if(D==="vector"&&!N)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new a.t(new Error("A feature id is required to remove its specific state property.")));const $=this.getOwnSourceCaches(S);for(const Y of $)Y.removeFeatureState(N,h.id,g)}getFeatureState(h){this._checkLoaded();const g=h.source,S=h.sourceLayer,P=this._checkSource(g);if(P){if(P.type!=="vector"||S)return h.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(g)[0].getFeatureState(S,h.id);this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(h){return this.stylesheet.transition=a.l({},this.stylesheet.transition,h),this.transition=this.stylesheet.transition,this}getTransition(){return a.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const h=this.getTerrain(),g=h&&this.terrain&&this.terrain.scope===this.scope?h:this.stylesheet.terrain;return a.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:g,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},S=>S!==void 0)}_updateLayer(h){this._changes.updateLayer(h);const g=this.getLayerSourceCache(h),S=a.av(h.source,h.scope),P=this._changes.getUpdatedSourceCaches();h.source&&!P[S]&&g&&g.getSource().type!=="raster"&&(this._changes.updateSourceCache(S,"reload"),g.pause()),h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const g=$=>this._mergedLayers[$].is3D(),S=this.order,P={},D=[];for(let $=S.length-1;$>=0;$--){const Y=S[$];if(g(Y)){P[Y]=$;for(const ee of h){const te=ee[Y];if(te)for(const le of te)D.push(le)}}}D.sort(($,Y)=>Y.intersectionZ-$.intersectionZ);const N=[];for(let $=S.length-1;$>=0;$--){const Y=S[$];if(g(Y))for(let ee=D.length-1;ee>=0;ee--){const te=D[ee].feature;if(te.layer&&P[te.layer.id]<$)break;N.push(te),D.pop()}else for(const ee of h){const te=ee[Y];if(te)for(const le of te)N.push(le.feature)}}return N}queryRenderedFeatures(h,g,S){g&&g.filter&&this._validate(we,"queryRenderedFeatures.filter",g.filter,null,g),g.scope=this.scope,g.availableImages=this._availableImages,g.serializedLayers=this._serializedLayers;const P={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new a.t(new Error("parameters.layers must be an Array."))),[];for(const ee of g.layers){const te=this._mergedLayers[ee];if(!te)return this.fire(new a.t(new Error(`The layer '${ee}' does not exist in the map's style and cannot be queried for features.`))),[];P[te.source]=!0}}const D=[],N=g.serializedLayers||{},$=g&&g.layers?g.layers.some(ee=>{const te=this.getLayer(ee);return te&&te.is3D()}):this.has3DLayers(),Y=Xn.createFromScreenPoints(h,S);for(const ee in this._mergedSourceCaches){const te=this._mergedSourceCaches[ee].getSource();if(!te||te.scope!==g.scope)continue;const le=this._mergedSourceCaches[ee].getSource().id;g.layers&&!P[le]||D.push(bs(this._mergedSourceCaches[ee],this._mergedLayers,N,Y,g,S,$,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(ee,te,le,ce,de,xe,be){const Se={},Te=xe.queryRenderedSymbols(ce),Oe=[];for(const Ge of Object.keys(Te).map(Number))Oe.push(be[Ge]);Oe.sort(ks);for(const Ge of Oe){const Be=Ge.featureIndex.lookupSymbolFeatures(Te[Ge.bucketInstanceId],te,Ge.bucketIndex,Ge.sourceLayerIndex,de.filter,de.layers,de.availableImages,ee);for(const Xe in Be){const $e=Se[Xe]=Se[Xe]||[],tt=Be[Xe];tt.sort((Je,nt)=>{const ht=Ge.featureSortOrder;if(ht){const at=ht.indexOf(Je.featureIndex);return ht.indexOf(nt.featureIndex)-at}return nt.featureIndex-Je.featureIndex});for(const Je of tt)$e.push(Je)}}for(const Ge in Se)Se[Ge].forEach(Be=>{const Xe=Be.feature,$e=le(ee[Ge]);if(!$e)return;const tt=$e.getFeatureState(Xe.layer["source-layer"],Xe.id);Xe.source=Xe.layer.source,Xe.layer["source-layer"]&&(Xe.sourceLayer=Xe.layer["source-layer"]),Xe.state=tt});return Se}(this._mergedLayers,N,this.getLayerSourceCache.bind(this),Y.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(h,g){g&&g.filter&&this._validate(we,"querySourceFeatures.filter",g.filter,null,g);const S=this.getOwnSourceCaches(h);let P=[];for(const D of S)P=P.concat(Yo(D,g));return P}addSourceType(h,g,S){return za.getSourceType(h)?S(new Error(`A source type called "${h}" already exists.`)):(za.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},S):S(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(h,g,S={}){this._checkLoaded();const P=this.light.getLight();let D=!1;for(const $ in h)if(!a.bh(h[$],P[$])){D=!0;break}if(!D)return;const N=this._getTransitionParameters();this.light.setLight(h,g,S),this.light.updateTransitions(N)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(h,g=1){if(this._checkLoaded(),!h)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),g===0&&delete this.terrain,h===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let S=h;const P=h.source==null;if(g===1){if(this.disableElevatedTerrain)return;if(typeof S.source=="object"){const $="terrain-dem-src";this.addSource($,S.source),S=a.cl(S),S=a.l(S,{source:$})}const D=a.l({},S),N={};if(this.terrain&&P){D.source=this.terrain.get().source;const $=this.terrain?this.getFragmentStyle(this.terrain.scope):null;$&&(N.style=$.serialize())}if(this._validate(Bs,"terrain",D,N))return}if(!this.terrain||this.terrain.scope!==this.scope&&!P||this.terrain&&g!==this.terrain.drapeRenderMode){if(!S)return;this._createTerrain(S,g),this.fire(new a.x("data",{dataType:"style"}))}else{const D=this.terrain,N=D.get();for(const $ of Object.keys(a._.terrain))!S.hasOwnProperty($)&&a._.terrain[$].default&&(S[$]=a._.terrain[$].default);for(const $ in h)if(!a.bh(h[$],N[$])){D.set(h,this.options),this.stylesheet.terrain=h;const Y=this._getTransitionParameters({duration:0});D.updateTransitions(Y),this.fire(new a.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const g=this.fog=new Pt(h,this.map.transform,this.scope,this.options);this.stylesheet.fog=g.get();const S=this._getTransitionParameters({duration:0});g.updateTransitions(S)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog;if(!a.bh(g.get(),h)){g.set(h,this.options),this.stylesheet.fog=g.get();const S=this._getTransitionParameters({duration:0});g.updateTransitions(S)}}else this._createFog(h);this._markersNeedUpdate=!0}setColorTheme(h){this._checkLoaded();const g=()=>{for(const P in this._layers)this._layers[P].lut=this._styleColorTheme.lut;for(const P in this._sourceCaches)this._sourceCaches[P].clearTiles()};if(this._styleColorTheme.colorTheme=h,!h)return this._styleColorTheme.lut=null,void g();const S=this._evaluateColorThemeData(h);this._loadColorTheme(S).then(()=>{this.fire(new a.x("colorthemeset")),g()}).catch(P=>{a.w(`Couldn't set color theme: ${P}`)})}_getTransitionParameters(h){return{now:a.q.now(),transition:a.l(this.transition,h)}}updateDrapeFirstLayers(){if(!this.terrain)return;const h=[],g=[];for(const S of this._mergedOrder)this.isLayerDraped(this._mergedLayers[S])?h.push(S):g.push(S);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...g)}_createTerrain(h,g){const S=this.terrain=new Gt(h,g,this.scope,this.options);g===1&&(this.stylesheet.terrain=h),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const P=this._getTransitionParameters({duration:0});S.updateTransitions(P)}_force3DLayerUpdate(){for(const h in this._layers){const g=this._layers[h];g.type==="fill-extrusion"&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const g=this._layers[h];g.type==="symbol"&&this._updateLayer(g)}}_validate(h,g,S,P,D={}){if(D&&D.validate===!1)return!1;const N=a.l({},this.serialize());return ua(this,h.call(In,a.l({key:g,style:N,value:S,styleSpec:a._},P)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._mergedLayers)this._mergedLayers[h].setEventedParent(null);for(const h in this._mergedSourceCaches)this._mergedSourceCaches[h].clearTiles(),this._mergedSourceCaches[h].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(h){const g=this.getSourceCaches(h);for(const S of g)S.clearTiles()}clearSources(){for(const h in this._mergedSourceCaches)this._mergedSourceCaches[h].clearTiles()}reloadSource(h){const g=this.getSourceCaches(h);for(const S of g)S.resume(),S.reload()}reloadSources(){for(const h of this.getSources())h.reload&&h.reload()}updateSources(h){let g;this.directionalLight&&(g=nd(this.directionalLight));for(const S in this._mergedSourceCaches)this._mergedSourceCaches[S].update(h,void 0,void 0,g)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const g=this._sourceCaches[h];g.resume(),g.reload()}}_updatePlacement(h,g,S,P,D,N,$=!1){let Y=!1,ee=!1;const te={},le={};for(const ce of this._mergedOrder){const de=this._mergedLayers[ce];if(de.type!=="symbol")continue;const xe=a.av(de.source,de.scope);let be=te[xe];if(!be){const Te=this.getLayerSourceCache(de);if(!Te)continue;const Oe=Te.getRenderableIds(!0).map(Ge=>Te.getTileByID(Ge));le[xe]=Oe.slice(),be=te[xe]=Oe.sort((Ge,Be)=>Be.tileID.overscaledZ-Ge.tileID.overscaledZ||(Ge.tileID.isLessThan(Be.tileID)?-1:1))}const Se=this.crossTileSymbolIndex.addLayer(de,be,g.center.lng,g.projection);Y=Y||Se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),$=$||this._layerOrderChanged||P===0,this._layerOrderChanged&&this.fire(new a.x("neworder")),($||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),g.zoom))&&(this.pauseablePlacement=new wf(g,this._mergedOrder,$,S,P,D,this.placement,this.fog&&g.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,te,le),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),ee=!0),Y&&this.pauseablePlacement.placement.setStale()),ee||Y){this._buildingIndex.onNewFrame(g.zoom);for(let ce=0;ce<this._mergedOrder.length;ce++){const de=this._mergedLayers[this._mergedOrder[ce]];if(de.type!=="symbol")continue;const xe=this.isLayerClipped(de);this.placement.updateLayerOpacities(de,te[a.av(de.source,de.scope)],ce,xe?N:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}addImport(h,g){this._checkLoaded();const S=this.stylesheet.imports=this.stylesheet.imports||[];if(S.findIndex(({id:D})=>D===h.id)!==-1)return void this.fire(new a.t(new Error(`Import with id '${h.id}' already exists in the map's style.`)));if(!g)return S.push(h),this._loadImports([h],!0);const P=S.findIndex(({id:D})=>D===g);return P===-1&&this.fire(new a.t(new Error(`Import with id "${g}" does not exist on this map.`))),this.stylesheet.imports=S.slice(0,P).concat(h).concat(S.slice(P)),this._loadImports([h],!0,g)}updateImport(h,g){this._checkLoaded();const S=this.stylesheet.imports||[],P=this.getImportIndex(h);return P===-1?this:typeof g=="string"?(this.setImportUrl(h,g),this):(g.url&&g.url!==S[P].url&&this.setImportUrl(h,g.url),a.bh(g.config,S[P].config)||this.setImportConfig(h,g.config),a.bh(g.data,S[P].data)||this.setImportData(h,g.data),this)}moveImport(h,g){this._checkLoaded();let S=this.stylesheet.imports||[];const P=this.getImportIndex(h);if(P===-1)return this;const D=this.getImportIndex(g);if(D===-1)return this;const N=S[P],$=this.fragments[P];return S=S.filter(({id:Y})=>Y!==h),this.fragments=this.fragments.filter(({id:Y})=>Y!==h),this.stylesheet.imports=S.slice(0,D).concat(N).concat(S.slice(D)),this.fragments=this.fragments.slice(0,D).concat($).concat(this.fragments.slice(D)),this.mergeLayers(),this}setImportUrl(h,g){this._checkLoaded();const S=this.stylesheet.imports||[],P=this.getImportIndex(h);if(P===-1)return this;S[P].url=g;const D=this.fragments[P];return D.style=this._createFragmentStyle(S[P]),D.style.on("style.import.load",()=>this.mergeAll()),D.style.loadURL(g),this}setImportData(h,g){this._checkLoaded();const S=this.getImportIndex(h),P=this.stylesheet.imports||[];return S===-1?this:g?(this.fragments[S].style.setState(g),this._reloadImports(),this):(delete P[S].data,this.setImportUrl(h,P[S].url))}setImportConfig(h,g){this._checkLoaded();const S=this.getImportIndex(h),P=this.stylesheet.imports||[];if(S===-1)return this;g?P[S].config=g:delete P[S].config;const D=this.fragments[S],N=D.style.stylesheet&&D.style.stylesheet.schema;return D.config=g,D.style.updateConfig(g,N),this.updateConfigDependencies(),this}removeImport(h){this._checkLoaded();const g=this.stylesheet.imports||[],S=this.getImportIndex(h);S!==-1&&(g.splice(S,1),this.fragments[S].style._remove(),this.fragments.splice(S,1),this._reloadImports())}getImportIndex(h){const g=(this.stylesheet.imports||[]).findIndex(S=>S.id===h);return g===-1&&this.fire(new a.t(new Error(`Import '${h}' does not exist in the map's style and cannot be updated.`))),g}getLayer(h){return this._mergedLayers[h]}getSources(){const h=[];for(const g in this._mergedOtherSourceCaches){const S=this._mergedOtherSourceCaches[g];S&&h.push(S.getSource())}return h}getSource(h,g){const S=this.getSourceCache(h,g);return S&&S.getSource()}getLayerSource(h){const g=this.getLayerSourceCache(h);return g&&g.getSource()}getSourceCache(h,g){const S=a.av(h,g);return this._mergedOtherSourceCaches[S]}getLayerSourceCache(h){const g=a.av(h.source,h.scope);return h.type==="symbol"?this._mergedSymbolSourceCaches[g]:this._mergedOtherSourceCaches[g]}getSourceCaches(h){if(h==null)return Object.values(this._mergedSourceCaches);const g=[];return this._mergedOtherSourceCaches[h]&&g.push(this._mergedOtherSourceCaches[h]),this._mergedSymbolSourceCaches[h]&&g.push(this._mergedSymbolSourceCaches[h]),g}updateSourceCaches(){const h=this._changes.getUpdatedSourceCaches();for(const g in h){const S=h[g];S==="reload"?this.reloadSource(g):S==="clear"&&this.clearSource(g)}}updateLayers(h){const g=this._changes.getUpdatedPaintProperties();for(const S of g){const P=this.getLayer(S);P&&P.updateTransitions(h)}}getImages(h,g,S){this.imageManager.getImages(g.icons,g.scope,S),this._updateTilesForChangedImages();const P=D=>{D&&D.setDependencies(g.tileID.key,g.type,g.icons)};P(this._otherSourceCaches[g.source]),P(this._symbolSourceCaches[g.source])}getGlyphs(h,g,S){this.glyphManager.getGlyphs(g.stacks,g.scope,S)}getResource(h,g,S){return a.ct(g,S)}getOwnSourceCache(h){return this._otherSourceCaches[h]}getOwnLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}getOwnSourceCaches(h){const g=[];return this._otherSourceCaches[h]&&g.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&g.push(this._symbolSourceCaches[h]),g}_isSourceCacheLoaded(h){const g=this.getOwnSourceCaches(h);return g.length===0?(this.fire(new a.t(new Error(`There is no source with ID '${h}'`))),!1):g.every(S=>S.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(h,g){if(!this._clipLayerPresent&&h.type!=="fill-extrusion")return!1;const S=h.type==="fill-extrusion"&&h.sourceLayer==="building";if(h.is3D()){if(S||g&&g.type==="batched-model"||h.type==="model")return!0}else if(h.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(h=>{h.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}za.getSourceType=function(w){return er[w]},za.setSourceType=function(w,h){er[w]=h},za.registerForPluginStateChange=a.cc;var id=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,wg=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Hp=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Is="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",jp=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Sg=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ag=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Wp=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,el=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,sd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Ps=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Oo=[];Ws(id,Oo),Ws(Hp,Oo),Ws(wg,Oo);const Qs={"_prelude_fog.vertex.glsl":Sg,"_prelude_terrain.vertex.glsl":jp,"_prelude_shadow.vertex.glsl":sd,"_prelude_fog.fragment.glsl":Ag,"_prelude_shadow.fragment.glsl":Ps,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Wp,"_prelude_raster_particle.glsl":el},Su={};Qr("",jp),Qr(Ag,Sg),Qr(Ps,sd),Qr(Wp,""),Qr(el,"");const Au=Qr(wg,Hp),Ju=id;var Qu={background:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Qr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Qr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Qr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Qr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Qr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Qr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Qr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Qr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Qr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Qr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Qr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Qr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Qr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Qr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Qr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Qr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Is),skyboxGradient:Qr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Is),skyboxCapture:Qr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Qr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Qr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Qr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Qr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Qr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ws(w,h){const g=w.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let S of g)if(S=S.trim(),S[0]==="#"&&S.includes("if")&&!S.includes("endif")){S=S.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const P=S.split(" ");for(const D of P)h.includes(D)||h.push(D)}}function Qr(w,h){const g=/#include\s+"([^"]+)"/g,S=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let P=h.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);P&&(P=P.map(ee=>{const te=ee.split(" ");return te[te.length-1]}),P=[...new Set(P)]);const D={},N=[],$=[];if(w=w.replace(g,(ee,te)=>($.push(te),"")),(h=h.replace(g,(ee,te)=>(N.push(te),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let Y=[...Oo];Ws(w,Y),Ws(h,Y);for(const ee of[...N,...$])Qs[ee]||console.error(`Undefined include: ${ee}`),Su[ee]||(Su[ee]=[],Ws(Qs[ee],Su[ee])),Y=[...Y,...Su[ee]];return{fragmentSource:w=w.replace(S,(ee,te,le,ce,de)=>(D[de]=!0,te==="define"?`
#ifndef HAS_UNIFORM_u_${de}
in ${le} ${ce} ${de};
#else
uniform ${le} ${ce} u_${de};
#endif
`:te==="initialize"?`
#ifdef HAS_UNIFORM_u_${de}
    ${le} ${ce} ${de} = u_${de};
#endif
`:te==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${de}
    in ${le} ${ce} ${de};
#endif
`:te==="initialize-attribute"?"":void 0)),vertexSource:h=h.replace(S,(ee,te,le,ce,de)=>{const xe=ce==="float"?"vec2":ce,be=de.match(/color/)?"color":xe;return te==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${de}
in ${le} ${ce} a_${de};
#endif
`:D[de]?te==="define"?`
#ifndef HAS_UNIFORM_u_${de}
uniform lowp float u_${de}_t;
in ${le} ${xe} a_${de};
out ${le} ${ce} ${de};
#else
uniform ${le} ${ce} u_${de};
#endif
`:te==="initialize"?be==="vec4"?`
#ifndef HAS_UNIFORM_u_${de}
    ${de} = a_${de};
#else
    ${le} ${ce} ${de} = u_${de};
#endif
`:`
#ifndef HAS_UNIFORM_u_${de}
    ${de} = unpack_mix_${be}(a_${de}, u_${de}_t);
#else
    ${le} ${ce} ${de} = u_${de};
#endif
`:te==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${de}
    in ${le} ${ce} a_${de};
    out ${le} ${ce} ${de};
#endif
`:te==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${de}
    ${de} = a_${de};
#endif
`:void 0:te==="define"?`
#ifndef HAS_UNIFORM_u_${de}
uniform lowp float u_${de}_t;
in ${le} ${xe} a_${de};
#else
uniform ${le} ${ce} u_${de};
#endif
`:te==="define-instanced"?be==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${de}0;
in vec4 a_${de}1;
in vec4 a_${de}2;
in vec4 a_${de}3;
#else
uniform ${le} ${ce} u_${de};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${le} ${xe} a_${de};
#else
uniform ${le} ${ce} u_${de};
#endif
`:te==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${de}
    ${le} ${ce} ${de} = a_${de};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${de}
    ${le} ${ce} ${de} = a_${de};
#else
    ${le} ${ce} ${de} = u_${de};
#endif
`:`
#ifndef HAS_UNIFORM_u_${de}
    ${le} ${ce} ${de} = unpack_mix_${be}(a_${de}, u_${de}_t);
#else
    ${le} ${ce} ${de} = u_${de};
#endif
`}),staticAttributes:P,usedDefines:Y,vertexIncludes:N,fragmentIncludes:$}}class eh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,g,S,P,D,N,$,Y){this.context=h;let ee=this.boundPaintVertexBuffers.length!==P.length;for(let le=0;!ee&&le<P.length;le++)this.boundPaintVertexBuffers[le]!==P[le]&&(ee=!0);let te=this.boundDynamicVertexBuffers.length!==$.length;for(let le=0;!te&&le<$.length;le++)this.boundDynamicVertexBuffers[le]!==$[le]&&(te=!0);if(!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==S||ee||te||this.boundIndexBuffer!==D||this.boundVertexOffset!==N)this.freshBind(g,S,P,D,N,$,Y);else{h.bindVertexArrayOES.set(this.vao);for(const le of $)le&&(le.bind(),Y&&le.instanceCount&&le.setVertexAttribDivisor(h.gl,g,Y));D&&D.dynamicDraw&&D.bind()}}freshBind(h,g,S,P,D,N,$){const Y=h.numAttributes,ee=this.context,te=ee.gl;this.vao&&this.destroy(),this.vao=ee.gl.createVertexArray(),ee.bindVertexArrayOES.set(this.vao),this.boundProgram=h,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=P,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=N,g.enableAttributes(te,h),g.bind(),g.setVertexAttribPointers(te,h,D);for(const le of S)le.enableAttributes(te,h),le.bind(),le.setVertexAttribPointers(te,h,D);for(const le of N)le&&(le.enableAttributes(te,h),le.bind(),le.setVertexAttribPointers(te,h,D),$&&le.instanceCount&&le.setVertexAttribDivisor(te,h,$));P&&P.bind(),ee.currentNumAttributes=Y}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function od(w,h){const g=Math.pow(2,h.canonical.z),S=h.canonical.y;return[new a.a5(0,S/g).toLngLat().lat,new a.a5(0,(S+1)/g).toLngLat().lat]}function Rl(w,h,g,S,P,D,N){const $=w.context,Y=$.gl,ee=g.hillshadeFBO;if(!ee)return;w.prepareDrawTile();const te=w.isTileAffectedByFog(h),le=w.getOrCreateProgram("hillshade",{overrideFog:te});$.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ee.colorAttachment.get());const ce=((Se,Te,Oe,Ge)=>{const Be=Oe.paint.get("hillshade-shadow-color"),Xe=Oe.paint.get("hillshade-highlight-color"),$e=Oe.paint.get("hillshade-accent-color"),tt=Oe.paint.get("hillshade-emissive-strength");let Je=a.bB(Oe.paint.get("hillshade-illumination-direction"));if(Oe.paint.get("hillshade-illumination-anchor")==="viewport")Je-=Se.transform.angle;else if(Se.style&&Se.style.enable3dLights()&&Se.style.directionalLight){const ht=Se.style.directionalLight.properties.get("direction"),at=a.c7(ht.x,ht.y,ht.z);Je=a.bB(at[1])}const nt=!Se.options.moving;return{u_matrix:Ge||Se.transform.calculateProjMatrix(Te.tileID.toUnwrapped(),nt),u_image:0,u_latrange:od(0,Te.tileID),u_light:[Oe.paint.get("hillshade-exaggeration"),Je],u_shadow:Be.toRenderColor(Oe.lut),u_highlight:Xe.toRenderColor(Oe.lut),u_emissive_strength:tt,u_accent:$e.toRenderColor(Oe.lut)}})(w,g,S,w.terrain?h.projMatrix:null);w.uploadCommonUniforms($,le,h.toUnwrapped());const{tileBoundsBuffer:de,tileBoundsIndexBuffer:xe,tileBoundsSegments:be}=w.getTileBoundsBuffers(g);le.draw(w,Y.TRIANGLES,P,D,N,yr.disabled,ce,S.id,de,xe,be)}function fl(w,h,g){if(!h.needsDEMTextureUpload)return;const S=w.context,P=S.gl;S.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||w.getTileTexture(g.stride);const D=g.getPixels();h.demTexture?h.demTexture.update(D,{premultiply:!1}):h.demTexture=new a.T(S,D,P.R32F,{premultiply:!1}),h.needsDEMTextureUpload=!1}function lc(w,h,g){const S=w.context,P=S.gl;if(!h.dem)return;const D=h.dem;if(S.activeTexture.set(P.TEXTURE1),fl(w,h,D),!h.demTexture)return;h.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);const N=D.dim;S.activeTexture.set(P.TEXTURE0);let $=h.hillshadeFBO;if(!$){const ce=new a.T(S,{width:N,height:N,data:null},P.RGBA8);ce.bind(P.LINEAR,P.CLAMP_TO_EDGE),$=h.hillshadeFBO=S.createFramebuffer(N,N,!0,"renderbuffer"),$.colorAttachment.set(ce.texture)}S.bindFramebuffer.set($.framebuffer),S.viewport.set([0,0,N,N]);const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:te}=w.getMercatorTileBoundsBuffers(),le=[];w.linearFloatFilteringSupported()&&le.push("TERRAIN_DEM_FLOAT_FORMAT"),w.getOrCreateProgram("hillshadePrepare",{defines:le}).draw(w,P.TRIANGLES,qn.disabled,mr.disabled,Cr.unblended,yr.disabled,((ce,de)=>{const xe=de.stride,be=a.a6.mat4.create();return a.a6.mat4.ortho(be,0,a.ab,-a.ab,0,0,1),a.a6.mat4.translate(be,be,[0,-a.ab,0]),{u_matrix:be,u_image:1,u_dimension:[xe,xe],u_zoom:ce.overscaledZ}})(h.tileID,D),g.id,Y,ee,te),h.needsHillshadePrepare=!1}class Ai{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Tf extends Ai{getDefault(){return a.bz.transparent}set(h){const g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class K0 extends Ai{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class Tg extends Ai{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class $p extends Ai{getDefault(){return[!0,!0,!0,!0]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Mf extends Ai{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class J0 extends Ai{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Q0 extends Ai{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class Mg extends Ai{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class Hc extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}}class e_ extends Ai{getDefault(){return[0,1]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class Cg extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}}class Eg extends Ai{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class t_ extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}}class ad extends Ai{getDefault(){const h=this.gl;return[h.ONE,h.ZERO,h.ONE,h.ZERO]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.blendFuncSeparate(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Ig extends Ai{getDefault(){return a.bz.transparent}set(h){const g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Pg extends Ai{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(h,h),this.current=h,this.dirty=!1)}}class Rg extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}}class n_ extends Ai{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class Lg extends Ai{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}let jx=class extends Ai{getDefault(){return null}set(w){(w!==this.current||this.dirty)&&(this.gl.useProgram(w),this.current=w,this.dirty=!1)}};class Cf extends Ai{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class Xp extends Ai{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class r_ extends Ai{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class pl extends Ai{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class i_ extends Ai{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class qp extends Ai{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Yp extends Ai{getDefault(){return null}set(h){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Dg extends Ai{getDefault(){return null}set(h){this.gl&&(h!==this.current||this.dirty)&&(this.gl.bindVertexArray(h),this.current=h,this.dirty=!1)}}class Bg extends Ai{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class ld extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class s_ extends Ai{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class Zp extends Ai{constructor(h,g){super(h),this.context=h,this.parent=g}getDefault(){return null}}class kg extends Zp{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class Kp extends Zp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Og extends Zp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,this.attachment(),g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class Ef extends Kp{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Wx=(w,h,g)=>({u_matrix:w,u_image0:0,u_skirt_height:h,u_ground_shadow_factor:g}),o_=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be)=>({u_proj_matrix:Float32Array.from(w),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(S),u_merc_matrix:g,u_zoom_transition:P,u_merc_center:D,u_image0:0,u_frustum_tl:N,u_frustum_tr:$,u_frustum_br:Y,u_frustum_bl:ee,u_globe_pos:te,u_globe_radius:le,u_viewport:ce,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9),u_skirt_height:de,u_far_z_cutoff:xe});function a_(w,h){return w!=null&&h!=null&&!(!w.hasData()||!h.hasData())&&w.demTexture!=null&&h.demTexture!=null&&w.tileID.key!==h.tileID.key}const cd=new class{constructor(){this.operations={}}newMorphing(w,h,g,S,P){if(w in this.operations){const D=this.operations[w];D.to.tileID.key!==g.tileID.key&&(D.queued=g)}else this.operations[w]={startTime:S,phase:0,duration:P,from:h,to:g,queued:null}}getMorphValuesForProxy(w){if(!(w in this.operations))return null;const h=this.operations[w];return{from:h.from,to:h.to,phase:h.phase}}update(w){for(const h in this.operations){const g=this.operations[h];for(g.phase=(w-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,w)){delete this.operations[h];break}}}_nextOp(w,h){return!!w.queued&&(w.from=w.to,w.to=w.queued,w.queued=null,w.phase=0,w.startTime=h,!0)}_validOp(w){return w.from.hasData()&&w.to.hasData()}},l_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function cc(w,h,g){if(h===0)return 0;const S=h<1&&g===514?.25/h:1;return 6*Math.pow(1.5,22-w)*Math.max(h,1)*S}function Fg(w,h){const g=1<<w.z;return!h&&(w.x===0||w.x===g-1)||w.y===0||w.y===g-1}const Tu=w=>({u_matrix:w});function th(w,h,g,S,P){if(P>0){const D=a.q.now(),N=(D-w.timeAdded)/P,$=h?(D-h.timeAdded)/P:-1,Y=g.getSource(),ee=S.coveringZoomLevel({tileSize:Y.tileSize,roundZoom:Y.roundZoom}),te=!h||Math.abs(h.tileID.overscaledZ-ee)>Math.abs(w.tileID.overscaledZ-ee),le=te&&w.refreshedUponExpiration?1:a.ap(te?N:1-$,0,1);return w.refreshedUponExpiration&&N>=1&&(w.refreshedUponExpiration=!1),h?{opacity:1,mix:1-le}:{opacity:le,mix:0}}return{opacity:1,mix:0}}class Mu extends Zo{constructor(h){const g={type:"raster-dem",maxzoom:h.transform.maxZoom},S=new a.cd(a.ce(),null),P=Qi("mock-dem",g,S,h.style);super("mock-dem",P,!1),P.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,g){h.state="loaded",g(null)}}class Jp extends Zo{constructor(h){const g=Qi("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new a.cd(a.ce(),null),h.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,g,S){if(h.freezeTileCoverage)return;this.transform=h;const P=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,N)=>{if(D[N.key]="",!this._tiles[N.key]){const $=new zc(N,this._source.tileSize*N.overscaleFactor(),h.tileZoom);$.state="loaded",this._tiles[N.key]=$}return D},{});for(const D in this._tiles)D in P||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(h){const g=this.proxyCachedFBO[h];if(g!==void 0){const S=Object.values(g);this.renderCachePool.push(...S),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ng extends a.aA{constructor(h,g,S){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=g,this.projMatrix=S}}class ud extends a.cE{constructor(h,g){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},h.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),h.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),h.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[S,P,D]=function(Y){const ee=new a.a_,te=new a.aO,le=131;ee.reserve(17161),te.reserve(33800);const ce=a.ab/128,de=a.ab+ce/2,xe=de+ce;for(let Se=-ce;Se<xe;Se+=ce)for(let Te=-ce;Te<xe;Te+=ce){const Oe=Te<0||Te>de||Se<0||Se>de?24575:0,Ge=a.ap(Math.round(Te),0,a.ab),Be=a.ap(Math.round(Se),0,a.ab);ee.emplaceBack(Ge+Oe,Be)}const be=(Se,Te)=>{const Oe=Te*le+Se;te.emplaceBack(Oe+1,Oe,Oe+le),te.emplaceBack(Oe+le,Oe+le+1,Oe+1)};for(let Se=1;Se<129;Se++)for(let Te=1;Te<129;Te++)be(Te,Se);return[0,129].forEach(Se=>{for(let Te=0;Te<130;Te++)be(Te,Se),be(Se,Te)}),[ee,te,32768]}(),N=h.context;this.gridBuffer=N.createVertexBuffer(S,a.b0.members),this.gridIndexBuffer=N.createIndexBuffer(P),this.gridSegments=a.b1.simpleSegment(0,0,S.length,P.length),this.gridNoSkirtSegments=a.b1.simpleSegment(0,0,S.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Jp(g.map),this.orthoMatrix=a.a6.mat4.create(),a.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.ab,0,a.ab,0,1);const $=N.gl;this._overlapStencilMode=new mr({func:$.GEQUAL,mask:255},0,255,$.KEEP,$.KEEP,$.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Mu(g.map),this._pendingGroundEffectLayers=[]}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),this._style=h,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,g,S){if(h&&h.terrain){this._style!==h&&(this.style=h,this._evaluationZoom=void 0);const P=h.terrain.properties,D=h.terrain.drapeRenderMode===0,N=h.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const $=h.terrain&&h.terrain.scope,Y=P.get("source"),ee=D?this._mockSourceCache:h.getSourceCache(Y,$);if(!ee)return void a.w(`Couldn't find terrain source "${Y}".`);if(this.sourceCache=ee,this._exaggeration=N?this.calculateExaggeration(g):P.get("exaggeration"),!g.projection.requiresDraping&&N&&this._exaggeration===0)return void this._disable();this.enabled=!0;const te=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const le=this.getScaledDemTileSize();this.sourceCache.update(g,le,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,te(),this._initializing=!0),te(),g.updateElevation(!0,S),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0,this._previousZoom=g.zoom}else this._disable()}calculateExaggeration(h){const g=this._previousCameraAltitude,S=h.getFreeCameraOptions().position.z/h.pixelsPerMeter*h.worldSize;this._previousCameraAltitude=S;const P=g!=null?S-g:Number.MAX_VALUE;if(Math.abs(P)<2)return this._exaggeration;const D=h.zoom,N=this._style.terrain;if(!this._previousUpdateTimestamp)return N.getExaggeration(D);let $=D-this._previousZoom;const Y=this._previousUpdateTimestamp;let ee=D;this._evaluationZoom!=null&&(ee=this._evaluationZoom,Math.abs(D-ee)>.5&&($=.5*(D-ee+$)),$*P<0&&(ee+=$)),this._evaluationZoom=ee;const te=N.getExaggeration(ee),le=te===N.getExaggeration(Math.max(0,ee-.1));if(le&&Math.abs(te-this._exaggeration)<.01)return te;let ce=Math.min(.1,.00375*(this._updateTimestamp-Y));return(le||te<.1||Math.abs($)<1e-4)&&(ce=Math.min(.2,4*ce)),a.aa(this._exaggeration,te,ce)}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._mergedSourceCaches)this._style._mergedSourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,S=this.painter.transform;this._initializing&&(this._initializing=S._centerAltitude===0&&this.getAtPointOrZero(a.a5.fromLngLat(S.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const P=this.proxyCoords=g.getIds().map(Y=>{const ee=g.getTileByID(Y).tileID;return ee.projMatrix=S.calculateProjMatrix(ee.toUnwrapped()),ee});(function(Y,ee){const te=ee.transform.pointCoordinate(ee.transform.getCameraPoint()),le=new a.P(te.x,te.y);Y.sort((ce,de)=>{if(de.overscaledZ-ce.overscaledZ)return de.overscaledZ-ce.overscaledZ;const xe=new a.P(ce.canonical.x+(1<<ce.canonical.z)*ce.wrap,ce.canonical.y),be=new a.P(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),Se=le.mult(1<<ce.canonical.z);return Se.x-=.5,Se.y-=.5,Se.distSqr(xe)-Se.distSqr(be)})})(P,this.painter);const D=this.proxyToSource||{};this.proxyToSource={},P.forEach(Y=>{this.proxyToSource[Y.key]={}}),this.terrainTileForTile={};const N=this._style._mergedSourceCaches;for(const Y in N){const ee=N[Y];if(!ee.used||(ee!==this.sourceCache&&this.resetTileLookupCache(ee.id),this._setupProxiedCoordsForOrtho(ee,h[Y],D),ee.usedForTerrain))continue;const te=h[Y];ee.getSource().reparseOverscaled&&this._assignTerrainTiles(te)}this.proxiedCoords[g.id]=P.map(Y=>new Ng(Y,Y.key,this.orthoMatrix)),this._assignTerrainTiles(P),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1;const $={};this._visibleDemTiles=[];for(const Y of this.proxyCoords){const ee=this.terrainTileForTile[Y.key];if(!ee)continue;const te=ee.tileID.key;te in $||(this._visibleDemTiles.push(ee),$[te]=te)}}_assignTerrainTiles(h){this._initializing||h.forEach(g=>{if(this.terrainTileForTile[g.key])return;const S=this._findTileCoveringTileID(g,this.sourceCache);S&&(this.terrainTileForTile[g.key]=S)})}_prepareDEMTextures(){const h=this.painter.context,g=h.gl;for(const S in this.terrainTileForTile){const P=this.terrainTileForTile[S],D=P.dem;!D||P.demTexture&&!P.needsDEMTextureUpload||(h.activeTexture.set(g.TEXTURE1),fl(this.painter,P,D))}}_prepareDemTileUniforms(h,g,S,P){if(!g||g.demTexture==null)return!1;const D=h.tileID.canonical,N=Math.pow(2,g.tileID.canonical.z-D.z),$=P||"";return S[`u_dem_tl${$}`]=[D.x*N%1,D.y*N%1],S[`u_dem_scale${$}`]=N,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let h=0;const g=this._visibleDemTiles.reduce((S,P)=>{if(!P.dem)return S;const D=P.dem.tree.minimums[0];return D>0&&h++,S+D},0);return h?g/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,g=h.gl;h.activeTexture.set(g.TEXTURE2);const S=this._getLoadedAreaMinimum(),P=new a.cF({width:1,height:1},new Float32Array([S]));this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(P,{premultiply:!1}):D=this._emptyDEMTexture=new a.T(h,P,g.R32F,{premultiply:!1}),D}setupElevationDraw(h,g,S){const P=this.painter.context,D=P.gl,N={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};N.u_exaggeration=this.exaggeration();let $=null,Y=null,ee=1;if(S&&S.morphing&&this._useVertexMorphing){const de=S.morphing.srcDemTile,xe=S.morphing.dstDemTile;ee=S.morphing.phase,de&&xe&&(this._prepareDemTileUniforms(h,de,N,"_prev")&&(Y=de),this._prepareDemTileUniforms(h,xe,N)&&($=xe))}const te=de=>de&&de.demTexture&&this.painter.linearFloatFilteringSupported()?D.LINEAR:D.NEAREST;let le=null;var ce;if(this.enabled?Y&&$?(le=$.demTexture,P.activeTexture.set(D.TEXTURE4),Y.demTexture.bind(te(Y),D.CLAMP_TO_EDGE),N.u_dem_lerp=ee):($=this.terrainTileForTile[h.tileID.key],le=this._prepareDemTileUniforms(h,$,N)?$.demTexture:this.emptyDEMTexture):le=this.emptyDEMTexture,P.activeTexture.set(D.TEXTURE2),le&&(N.u_dem_size=(ce=le).size[0]===1?1:ce.size[0]-2,le.bind(te($),D.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(S&&S.useDepthForOcclusion,g,N),S&&S.useMeterToDem&&$){const de=(1<<$.tileID.canonical.z)*a.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;N.u_meter_to_dem=de}if(S&&S.labelPlaneMatrixInv&&(N.u_label_plane_matrix_inv=S.labelPlaneMatrixInv),g.setTerrainUniformValues(P,N),this.painter.transform.projection.name==="globe"){const de=this.globeUniformValues(this.painter.transform,h.tileID.canonical,S&&S.useDenormalizedUpVectorScale);g.setGlobeUniformValues(P,de)}}globeUniformValues(h,g,S){const P=h.projection;return{u_tile_tl_up:P.upVector(g,0,0),u_tile_tr_up:P.upVector(g,a.ab,0),u_tile_br_up:P.upVector(g,a.ab,a.ab),u_tile_bl_up:P.upVector(g,0,a.ab),u_tile_up_scale:S?a.cG(1):P.upVectorScale(g,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const g=this.painter,S=this.painter.context;h.length!==0&&(S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(P,D,N,$,Y){if(P.transform.projection.name==="globe")(function(ee,te,le,ce,de){const xe=ee.context,be=xe.gl;let Se,Te;const Oe=ee.transform,Ge=a.cx(ee,xe,Oe),Be=(wt,zt)=>{if(Te===zt)return;const Zt=[l_[zt],"PROJECTION_GLOBE_VIEW"];Ge&&Zt.push("CUSTOM_ANTIALIASING");const Ft=ee.isTileAffectedByFog(wt);Se=ee.getOrCreateProgram("globeRaster",{defines:Zt,overrideFog:Ft}),Te=zt},Xe=ee.colorModeForRenderPass(),$e=new qn(be.LEQUAL,qn.ReadWrite,ee.depthRangeFor3D);cd.update(de);const tt=a.cy(Oe),Je=[a.am(Oe.center.lng),a.at(Oe.center.lat)],nt=ee.globeSharedBuffers,ht=[Oe.width*a.q.devicePixelRatio,Oe.height*a.q.devicePixelRatio],at=Float32Array.from(Oe.globeMatrix),st={useDenormalizedUpVectorScale:!0};{const wt=ee.transform,zt=cc(wt.zoom,te.exaggeration(),te.sourceCache._source.tileSize);Te=-1;const Zt=be.TRIANGLES;for(const Ft of ce){const dn=le.getTile(Ft),St=mr.disabled,$t=te.prevTerrainTileForTile[Ft.key],Ht=te.terrainTileForTile[Ft.key];a_($t,Ht)&&cd.newMorphing(Ft.key,$t,Ht,de,250),xe.activeTexture.set(be.TEXTURE0),dn.texture&&dn.texture.bind(be.LINEAR,be.CLAMP_TO_EDGE);const fn=cd.getMorphValuesForProxy(Ft.key),mn=fn?1:0;fn&&a.C(st,{morphing:{srcDemTile:fn.from,dstDemTile:fn.to,phase:a.cw(fn.phase)}});const Yt=a.cz(Ft.canonical),tn=a.cA(Yt.getCenter().lat),tr=a.cB(Ft.canonical,Yt,tn,wt.worldSize/wt._pixelsPerMercatorPixel),bn=a.b5(a.cC(Ft.canonical)),Bn=o_(wt.expandedFarZProjMatrix,at,tt,bn,a.a9(wt.zoom),Je,wt.frustumCorners.TL,wt.frustumCorners.TR,wt.frustumCorners.BR,wt.frustumCorners.BL,wt.globeCenterInViewSpace,wt.globeRadius,ht,zt,wt._farZ,tr);if(Be(Ft,mn),Se&&(te.setupElevationDraw(dn,Se,st),ee.uploadCommonUniforms(xe,Se,Ft.toUnwrapped()),nt)){const[xr,Yn,hr]=nt.getGridBuffers(tn,zt!==0);Se.draw(ee,Zt,$e,St,Xe,yr.backCCW,Bn,"globe_raster",xr,Yn,hr)}}}if(nt&&(ee.renderDefaultNorthPole||ee.renderDefaultSouthPole)){const wt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ge&&wt.push("CUSTOM_ANTIALIASING"),Se=ee.getOrCreateProgram("globeRaster",{defines:wt});for(const zt of ce){const{x:Zt,y:Ft,z:dn}=zt.canonical,St=Ft===0,$t=Ft===(1<<dn)-1,[Ht,fn,mn,Yt]=nt.getPoleBuffers(dn,!1);if(Yt&&(St||$t)){const tn=le.getTile(zt);xe.activeTexture.set(be.TEXTURE0),tn.texture&&tn.texture.bind(be.LINEAR,be.CLAMP_TO_EDGE);let tr=a.cD(dn,Zt,Oe);const bn=a.b5(a.cC(zt.canonical)),Bn=(xr,Yn)=>xr.draw(ee,be.TRIANGLES,$e,mr.disabled,Xe,yr.disabled,o_(Oe.expandedFarZProjMatrix,tr,tr,bn,0,Je,Oe.frustumCorners.TL,Oe.frustumCorners.TR,Oe.frustumCorners.BR,Oe.frustumCorners.BL,Oe.globeCenterInViewSpace,Oe.globeRadius,ht,0,Oe._farZ),"globe_pole_raster",Yn,mn,Yt);te.setupElevationDraw(tn,Se,st),ee.uploadCommonUniforms(xe,Se,zt.toUnwrapped()),St&&ee.renderDefaultNorthPole&&Bn(Se,Ht),$t&&ee.renderDefaultSouthPole&&(tr=a.a6.mat4.scale(a.a6.mat4.create(),tr,[1,-1,1]),Bn(Se,fn))}}}})(P,D,N,$,Y);else{const ee=P.context,te=ee.gl;let le,ce;const de=P.shadowRenderer,xe=oc(P,P.longestCutoffRange),be=Xe=>{if(ce===Xe)return;const $e=[];$e.push(l_[Xe]),xe.shouldRenderCutoff&&$e.push("RENDER_CUTOFF"),le=P.getOrCreateProgram("terrainRaster",{defines:$e}),ce=Xe},Se=P.colorModeForRenderPass(),Te=new qn(te.LEQUAL,qn.ReadWrite,P.depthRangeFor3D);cd.update(Y);const Oe=P.transform,Ge=cc(Oe.zoom,D.exaggeration(),D.sourceCache._source.tileSize);let Be=[0,0,0];if(de){const Xe=P.style.directionalLight,$e=P.style.ambientLight;Xe&&$e&&(Be=Gp(P.style,Xe,$e))}{ce=-1;const Xe=te.TRIANGLES,[$e,tt]=[D.gridIndexBuffer,D.gridSegments];for(const Je of $){const nt=N.getTile(Je),ht=mr.disabled,at=D.prevTerrainTileForTile[Je.key],st=D.terrainTileForTile[Je.key];a_(at,st)&&cd.newMorphing(Je.key,at,st,Y,250),ee.activeTexture.set(te.TEXTURE0),nt.texture&&nt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const wt=cd.getMorphValuesForProxy(Je.key),zt=wt?1:0;let Zt;wt&&(Zt={morphing:{srcDemTile:wt.from,dstDemTile:wt.to,phase:a.cw(wt.phase)}});const Ft=Wx(Je.projMatrix,Fg(Je.canonical,Oe.renderWorldCopies)?Ge/10:Ge,Be);if(be(zt),!le)continue;D.setupElevationDraw(nt,le,Zt);const dn=Je.toUnwrapped();de&&de.setupShadows(dn,le),P.uploadCommonUniforms(ee,le,dn,null,xe),le.draw(P,Xe,Te,ht,Se,yr.backCCW,Ft,"terrain_raster",D.gridBuffer,$e,tt)}}}}(g,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const g=this.painter,S=this.painter.context,P=this.proxySourceCache,D=this.proxiedCoords[P.id],N=this._drapedRenderBatches.shift(),$=g.style.order,Y=[];let ee=0;for(const te of D){const le=P.getTileByID(te.proxyTileKey),ce=P.proxyCachedFBO[te.key]?P.proxyCachedFBO[te.key][h]:void 0,de=ce!==void 0?P.renderCache[ce]:this.pool[ee++],xe=ce!==void 0;if(le.texture=de.tex,xe&&!de.dirty){Y.push(le.tileID);continue}let be;S.bindFramebuffer.set(de.fb.framebuffer),this.renderedToTile=!1,de.dirty&&(S.clear({color:a.bz.transparent,stencil:0}),de.dirty=!1);for(let Se=N.start;Se<=N.end;++Se){const Te=g.style._mergedLayers[$[Se]];if(Te.isHidden(g.transform.zoom))continue;const Oe=g.style.getLayerSourceCache(Te),Ge=Oe?this.proxyToSource[te.key][Oe.id]:[te];if(!Ge)continue;const Be=Ge;S.viewport.set([0,0,de.fb.width,de.fb.height]),be!==(Oe?Oe.id:null)&&(this._setupStencil(de,Ge,Te,Oe),be=Oe?Oe.id:null),g.renderLayer(g,Oe,Te,Be)}if(this._drapedRenderBatches.length===0)for(const Se of this._pendingGroundEffectLayers){const Te=g.style._mergedLayers[$[Se]];if(Te.isHidden(g.transform.zoom))continue;const Oe=g.style.getLayerSourceCache(Te),Ge=Oe?this.proxyToSource[te.key][Oe.id]:[te];if(!Ge)continue;const Be=Ge;S.viewport.set([0,0,de.fb.width,de.fb.height]),be!==(Oe?Oe.id:null)&&(this._setupStencil(de,Ge,Te,Oe),be=Oe?Oe.id:null),g.renderLayer(g,Oe,Te,Be)}this.renderedToTile?(de.dirty=!0,Y.push(le.tileID)):xe||--ee,ee===5&&(ee=0,this.renderToBackBuffer(Y))}return this.renderToBackBuffer(Y),this.renderingToTexture=!1,S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height]),N.end+1}postRender(){}isLayerOrderingCorrect(h){const g=h.order.length;let S=-1,P=g;for(let D=0;D<g;++D)this._style.isLayerDraped(h._mergedLayers[h.order[D]])?S=Math.max(S,D):P=Math.min(P,D);return P>S}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{h=Math.min(h,g.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,g,S){if(!this._visibleDemTiles)return null;const P=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const N=D.tileID,$=1<<N.overscaledZ,{x:Y,y:ee}=N.canonical,te=Y/$,le=(Y+1)/$,ce=ee/$,de=(ee+1)/$;return{minx:te,miny:ce,maxx:le,maxy:de,t:D.dem.tree.raycastRoot(te,ce,le,de,h,g,S),tile:D}});P.sort((D,N)=>(D.t!==null?D.t:Number.MAX_VALUE)-(N.t!==null?N.t:Number.MAX_VALUE));for(const D of P){if(D.t==null)return null;const N=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,h,g,S);if(N!=null)return N}return null}_createFBO(){const h=this.painter.context,g=h.gl,S=this.drapeBufferSize;h.activeTexture.set(g.TEXTURE0);const P=new a.T(h,{width:S[0],height:S[1],data:null},g.RGBA8);P.bind(g.LINEAR,g.CLAMP_TO_EDGE);const D=h.createFramebuffer(S[0],S[1],!0,null);return D.colorAttachment.set(P.texture),D.depthAttachment=new Ef(h,D.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,S[0],S[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:D,tex:P,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const h in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const g=this._style._mergedLayers[h],S=g.isHidden(this.painter.transform.zoom);return g.type==="hillshade"||g.type==="custom"?!S&&g.shouldRedrape():!S&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const S of this._style.getSources())if(S instanceof Xi){h=!0;break}if(!h)return;const g={};for(let S=0;S<this._style.order.length;++S){const P=this._style._mergedLayers[this._style.order[S]],D=this._style.getLayerSourceCache(P);if(D&&!g[D.id]&&!P.isHidden(this.painter.transform.zoom)&&P.type==="line"&&P.widthExpression()instanceof a.a4){g[D.id]=!0;for(const N of this.proxyCoords){const $=this.proxyToSource[N.key][D.id];if($)for(const Y of $)this._clearRenderCacheForTile(D.id,Y)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const S in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[S]._source instanceof Ms){h=!0;break}if(!h)return;const g={};for(let S=0;S<this._style.order.length;++S){const P=this._style._mergedLayers[this._style.order[S]],D=this._style.getLayerSourceCache(P);if(!D||g[D.id]||P.isHidden(this.painter.transform.zoom)||P.type!=="raster")continue;const N=P.paint.get("raster-fade-duration");for(const $ of this.proxyCoords){const Y=this.proxyToSource[$.key][D.id];if(Y)for(const ee of Y){const te=th(D.getTile(ee),D.findLoadedParent(ee,0),D,this.painter.transform,N);(te.opacity!==1||te.mix!==0)&&this._clearRenderCacheForTile(D.id,ee)}}}}_setupDrapedRenderBatches(){const h=this._style.order,g=h.length;if(g===0)return;const S=[];this._pendingGroundEffectLayers=[];let P,D=0,N=this._style._mergedLayers[h[D]];for(;!this._style.isLayerDraped(N)&&N.isHidden(this.painter.transform.zoom)&&++D<g;)N=this._style._mergedLayers[h[D]];for(;D<g;++D){const $=this._style._mergedLayers[h[D]];$.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped($)?P===void 0&&(P=D):($.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(D),P!==void 0&&(S.push({start:P,end:D-1}),P=void 0)))}if(P!==void 0&&S.push({start:P,end:D-1}),S.length!==0){const $=S[S.length-1];this._pendingGroundEffectLayers.every(Y=>Y>$.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=S}_setupRenderCache(h){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const N=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let $=0;$<N.length;++$){const Y=Object.values(N[$]);g.renderCachePool.push(...Y)}}return}this._clearRasterLayersFromRenderCache();const S=this.proxyCoords,P=this._tilesDirty;for(let N=S.length-1;N>=0;N--){const $=S[N];if(g.getTileByID($.key),g.proxyCachedFBO[$.key]!==void 0){const Y=h[$.key],ee=this.proxyToSource[$.key];let te=0;for(const le in ee){const ce=ee[le],de=Y[le];if(!de||de.length!==ce.length||ce.some((xe,be)=>xe!==de[be]||P[le]&&P[le].hasOwnProperty(xe.key))){te=-1;break}++te}for(const le in g.proxyCachedFBO[$.key])g.renderCache[g.proxyCachedFBO[$.key][le]].dirty=te<0||te!==Object.values(Y).length}}const D=[...this._drapedRenderBatches];D.sort((N,$)=>$.end-$.start-(N.end-N.start));for(const N of D)for(const $ of S){if(g.proxyCachedFBO[$.key])continue;let Y=g.renderCachePool.pop();Y===void 0&&g.renderCache.length<50&&(Y=g.renderCache.length,g.renderCache.push(this._createFBO())),Y!==void 0&&(g.proxyCachedFBO[$.key]={},g.proxyCachedFBO[$.key][N.start]=Y,g.renderCache[Y].dirty=!0)}this._tilesDirty={}}_setupStencil(h,g,S,P){if(!P||!this._sourceTilesOverlap[P.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,N=D.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let $;if(S.isTileClipped())$=g.length,this._overlapStencilMode.test={func:N.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);$=1,this._overlapStencilMode.test={func:N.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+$>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=$,this._overlapStencilMode.ref=this._stencilRef,S.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):mr.disabled}_renderTileClippingMasks(h,g){const S=this.painter,P=this.painter.context,D=P.gl;S._tileClippingMaskIDs={},P.setColorMode(Cr.disabled),P.setDepthMode(qn.disabled);const N=S.getOrCreateProgram("clippingMask");for(const $ of h){const Y=S._tileClippingMaskIDs[$.key]=--g;N.draw(S,D.TRIANGLES,qn.disabled,new mr({func:D.ALWAYS,mask:0},Y,255,D.KEEP,D.KEEP,D.REPLACE),Cr.disabled,yr.disabled,Tu($.projMatrix),"$clipping",S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}}pointCoordinate(h){const g=this.painter.transform;if(h.x<0||h.x>g.width||h.y<0||h.y>g.height)return null;const S=[h.x,h.y,1,1];a.a6.vec4.transformMat4(S,S,g.pixelMatrixInverse),a.a6.vec4.scale(S,S,1/S[3]),S[0]/=g.worldSize,S[1]/=g.worldSize;const P=g._camera.position,D=a.bD(1,g.center.lat),N=[P[0],P[1],P[2]/D,0],$=a.a6.vec3.subtract([],S.slice(0,3),N);a.a6.vec3.normalize($,$);const Y=this.raycast(N,$,this._exaggeration);return Y!==null&&Y?(a.a6.vec3.scaleAndAdd(N,N,$,Y),N[3]=N[2],N[2]*=D,N):null}_setupProxiedCoordsForOrtho(h,g,S){if(h.getSource()instanceof a.aD)return this._setupProxiedCoordsForImageSource(h,g,S);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const P=this.proxiedCoords[h.id]=[],D=this.proxyCoords;for(let Y=0;Y<D.length;Y++){const ee=D[Y],te=this._findTileCoveringTileID(ee,h);if(te){const le=this._createProxiedId(ee,te,S[ee.key]&&S[ee.key][h.id]);P.push(le),this.proxyToSource[ee.key][h.id]=[le]}}let N=!1;const $=new Set;for(let Y=0;Y<g.length;Y++){const ee=h.getTile(g[Y]);if(!ee||!ee.hasData())continue;const te=this._findTileCoveringTileID(ee.tileID,this.proxySourceCache);if(te&&te.tileID.canonical.z!==ee.tileID.canonical.z){const le=this.proxyToSource[te.tileID.key][h.id],ce=this._createProxiedId(te.tileID,ee,S[te.tileID.key]&&S[te.tileID.key][h.id]);le?le.splice(le.length-1,0,ce):this.proxyToSource[te.tileID.key][h.id]=[ce];const de=this.proxyToSource[te.tileID.key][h.id];$.has(de)||$.add(de),P.push(ce),N=!0}}if(this._sourceTilesOverlap[h.id]=N,N&&this._debugParams.sortTilesHiZFirst)for(const Y of $)Y.sort((ee,te)=>te.overscaledZ-ee.overscaledZ)}_setupProxiedCoordsForImageSource(h,g,S){if(!h.getSource().loaded())return;const P=this.proxiedCoords[h.id]=[],D=this.proxyCoords,N=h.getSource(),$=N.tileID;if(!$)return;const Y=new a.P($.x,$.y)._div(1<<$.z),ee=N.coordinates.map(a.a5.fromLngLat).reduce((le,ce)=>(le.min.x=Math.min(le.min.x,ce.x-Y.x),le.min.y=Math.min(le.min.y,ce.y-Y.y),le.max.x=Math.max(le.max.x,ce.x-Y.x),le.max.y=Math.max(le.max.y,ce.y-Y.y),le),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),te=(le,ce)=>{const de=le.wrap+le.canonical.x/(1<<le.canonical.z),xe=le.canonical.y/(1<<le.canonical.z),be=a.ab/(1<<le.canonical.z),Se=ce.wrap+ce.canonical.x/(1<<ce.canonical.z),Te=ce.canonical.y/(1<<ce.canonical.z);return de+be<Se+ee.min.x||de>Se+ee.max.x||xe+be<Te+ee.min.y||xe>Te+ee.max.y};for(let le=0;le<D.length;le++){const ce=D[le];for(let de=0;de<g.length;de++){const xe=h.getTile(g[de]);if(!xe||!xe.hasData()||te(ce,xe.tileID))continue;const be=this._createProxiedId(ce,xe,S[ce.key]&&S[ce.key][h.id]),Se=this.proxyToSource[ce.key][h.id];Se?Se.push(be):this.proxyToSource[ce.key][h.id]=[be],P.push(be)}}}_createProxiedId(h,g,S){let P=this.orthoMatrix;if(S){const D=S.find(N=>N.key===g.tileID.key);if(D)return D}if(g.tileID.key!==h.key){const D=h.canonical.z-g.tileID.canonical.z;let N,$,Y;P=a.a6.mat4.create();const ee=g.tileID.wrap-h.wrap<<h.overscaledZ;D>0?(N=a.ab>>D,$=N*((g.tileID.canonical.x<<D)-h.canonical.x+ee),Y=N*((g.tileID.canonical.y<<D)-h.canonical.y)):(N=a.ab<<-D,$=a.ab*(g.tileID.canonical.x-(h.canonical.x+ee<<-D)),Y=a.ab*(g.tileID.canonical.y-(h.canonical.y<<-D))),a.a6.mat4.ortho(P,0,N,0,N,0,1),a.a6.mat4.translate(P,P,[$,Y,0])}return new Ng(g.tileID,h.key,P)}_findTileCoveringTileID(h,g){let S=g.getTile(h);if(S&&S.hasData())return S;const P=this._findCoveringTileCache[g.id],D=P[h.key];if(S=D?g.getTileByID(D):null,S&&S.hasData()||D===null)return S;let N=S?S.tileID:h,$=N.overscaledZ;const Y=g.getSource().minzoom,ee=[];if(!D){const le=g.getSource().maxzoom;if(h.canonical.z>=le){const ce=h.canonical.z-le;g.getSource().reparseOverscaled?($=Math.max(h.canonical.z+2,g.transform.tileZoom),N=new a.aA($,h.wrap,le,h.canonical.x>>ce,h.canonical.y>>ce)):ce!==0&&($=le,N=new a.aA($,h.wrap,le,h.canonical.x>>ce,h.canonical.y>>ce))}N.key!==h.key&&(ee.push(N.key),S=g.getTile(N))}const te=le=>{ee.forEach(ce=>{P[ce]=le}),ee.length=0};for($-=1;$>=Y&&(!S||!S.hasData());$--){S&&te(S.tileID.key);const le=N.calculateScaledKey($);if(S=g.getTileByID(le),S&&S.hasData())break;const ce=P[le];if(ce===null)break;ce===void 0?ee.push(le):S=g.getTileByID(ce)}return te(S?S.tileID.key:null),S&&S.hasData()?S:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,g){let S=this._tilesDirty[h];S||(S=this._tilesDirty[h]={}),S[g.key]=!0}}function Jo(w,h,g){const S=function($,Y,ee){const te=a.a6.vec3.dot(Y,$),le=a.a6.vec3.dot(ee,[.2126,.7152,.0722]),ce=(xe,be,Se)=>(1-Se)*xe+Se*be,de=ce(1-.3*Math.min(le,1),1,Math.min(te+1,1));return ce(.92,1,Math.asin(a.ap(Y[2],-1,1))/Math.PI+.5)*de}(w,[0,0,1],h),P=[0,0,0];a.a6.vec3.scale(P,g.slice(0,3),S);const D=[0,0,0];a.a6.vec3.scale(D,h.slice(0,3),w[2]);const N=[0,0,0];return a.a6.vec3.add(N,P,D),a.cb(N)}const hd=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],$x=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Ao{static cacheKey(h,g,S,P){let D=`${g}${P?P.cacheKey:""}`;for(const N of S)h.usedDefines.includes(N)&&(D+=`/${N}`);return D}constructor(h,g,S,P,D,N){const $=h.gl;this.program=$.createProgram(),this.configuration=P,this.name=g,this.fixedDefines=[...N];const Y=P?P.getBinderAttributes():[],ee=(S.staticAttributes||[]).concat(Y);let te=P?P.defines():[];te=te.concat(N.map(Se=>`#define ${Se}`));const le=`#version 300 es
`;let ce=le+te.concat("precision mediump float;",Ju,Au.fragmentSource).join(`
`);for(const Se of S.fragmentIncludes)ce+=`
${Qs[Se]}`;ce+=`
${S.fragmentSource}`;let de=le+te.concat("precision highp float;",Ju,Au.vertexSource).join(`
`);for(const Se of S.vertexIncludes)de+=`
${Qs[Se]}`;de+=`
${S.vertexSource}`;const xe=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(xe,ce),$.compileShader(xe),$.attachShader(this.program,xe);const be=$.createShader($.VERTEX_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(be,de),$.compileShader(be),$.attachShader(this.program,be),this.attributes={},this.numAttributes=ee.length;for(let Se=0;Se<this.numAttributes;Se++)if(ee[Se]){const Te=ee[Se].startsWith("a_")?ee[Se]:`a_${ee[Se]}`;$.bindAttribLocation(this.program,Se,Te),this.attributes[Te]=Se}$.linkProgram(this.program),$.deleteShader(be),$.deleteShader(xe),this.fixedUniforms=D(h),this.binderUniforms=P?P.getUniforms(h):[],(N.includes("TERRAIN")||g.indexOf("symbol")!==-1||g.indexOf("circle")!==-1)&&(this.terrainUniforms=(Se=>({u_dem:new a.bJ(Se),u_dem_prev:new a.bJ(Se),u_dem_tl:new a.bG(Se),u_dem_scale:new a.bI(Se),u_dem_tl_prev:new a.bG(Se),u_dem_scale_prev:new a.bI(Se),u_dem_size:new a.bI(Se),u_dem_lerp:new a.bI(Se),u_exaggeration:new a.bI(Se),u_depth:new a.bJ(Se),u_depth_size_inv:new a.bG(Se),u_depth_range_unpack:new a.bG(Se),u_occluder_half_size:new a.bI(Se),u_occlusion_depth_offset:new a.bI(Se),u_meter_to_dem:new a.bI(Se),u_label_plane_matrix_inv:new a.bF(Se)}))(h)),N.includes("GLOBE")&&(this.globeUniforms=(Se=>({u_tile_tl_up:new a.bH(Se),u_tile_tr_up:new a.bH(Se),u_tile_br_up:new a.bH(Se),u_tile_bl_up:new a.bH(Se),u_tile_up_scale:new a.bI(Se)}))(h)),N.includes("FOG")&&(this.fogUniforms=(Se=>({u_fog_matrix:new a.bF(Se),u_fog_range:new a.bG(Se),u_fog_color:new a.c6(Se),u_fog_horizon_blend:new a.bI(Se),u_fog_vertical_limit:new a.bG(Se),u_fog_temporal_offset:new a.bI(Se),u_frustum_tl:new a.bH(Se),u_frustum_tr:new a.bH(Se),u_frustum_br:new a.bH(Se),u_frustum_bl:new a.bH(Se),u_globe_pos:new a.bH(Se),u_globe_radius:new a.bI(Se),u_globe_transition:new a.bI(Se),u_is_globe:new a.bJ(Se),u_viewport:new a.bG(Se)}))(h)),N.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Se=>({u_cutoff_params:new a.c6(Se)}))(h)),N.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Se=>({u_lighting_ambient_color:new a.bH(Se),u_lighting_directional_dir:new a.bH(Se),u_lighting_directional_color:new a.bH(Se),u_ground_radiance:new a.bH(Se)}))(h)),N.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Se=>({u_light_matrix_0:new a.bF(Se),u_light_matrix_1:new a.bF(Se),u_fade_range:new a.bG(Se),u_shadow_normal_offset:new a.bH(Se),u_shadow_intensity:new a.bI(Se),u_shadow_texel_size:new a.bI(Se),u_shadow_map_resolution:new a.bI(Se),u_shadow_direction:new a.bH(Se),u_shadow_bias:new a.bH(Se),u_shadowmap_0:new a.bJ(Se),u_shadowmap_1:new a.bJ(Se)}))(h))}}setTerrainUniformValues(h,g){if(!this.terrainUniforms)return;const S=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const P in g)S[P]&&S[P].set(this.program,P,g[P])}}setGlobeUniformValues(h,g){if(!this.globeUniforms)return;const S=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const P in g)S[P]&&S[P].set(this.program,P,g[P])}}setFogUniformValues(h,g){if(!this.fogUniforms)return;const S=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const P in g)S[P].set(this.program,P,g[P])}}setCutoffUniformValues(h,g){if(!this.cutoffUniforms)return;const S=this.cutoffUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const P in g)S[P].set(this.program,P,g[P])}}setLightsUniformValues(h,g){if(!this.lightsUniforms)return;const S=this.lightsUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const P in g)S[P].set(this.program,P,g[P])}}setShadowUniformValues(h,g){if(this.failedToCreate||!this.shadowUniforms)return;const S=this.shadowUniforms;h.program.set(this.program);for(const P in g)S[P].set(this.program,P,g[P])}_drawDebugWireframe(h,g,S,P,D,N,$,Y,ee,te){const le=h.options.wireframe;if(le.terrain===!1&&le.layers2D===!1&&le.layers3D===!1)return;const ce=h.context;if(!(!(!le.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!le.layers2D||h._terrain&&h._terrain.renderingToTexture||!hd.includes(this.name))||!(!le.layers3D||!$x.includes(this.name))))return;const de=ce.gl,xe=h.wireframeDebugCache.getLinesFromTrianglesBuffer(h.frameCounter,D,ce);if(!xe)return;const be=[...this.fixedDefines];be.push("DEBUG_WIREFRAME");const Se=h.getOrCreateProgram(this.name,{config:this.configuration,defines:be});ce.program.set(Se.program);const Te=(Be,Xe,$e)=>{if(Xe[Be]&&$e[Be])for(const tt in Xe[Be])$e[Be][tt]&&$e[Be][tt].set($e.program,tt,Xe[Be][tt].current)};ee&&ee.setUniforms(Se.program,ce,Se.binderUniforms,$,{zoom:Y}),Te("fixedUniforms",this,Se),Te("terrainUniforms",this,Se),Te("globeUniforms",this,Se),Te("fogUniforms",this,Se),Te("lightsUniforms",this,Se),Te("shadowUniforms",this,Se),xe.bind(),ce.setColorMode(new Cr([de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ZERO,de.ONE],a.bz.transparent,[!0,!0,!0,!1])),ce.setDepthMode(new qn(g.func===de.LESS?de.LEQUAL:g.func,qn.ReadOnly,g.range)),ce.setStencilMode(mr.disabled);const Oe=3*N.primitiveLength*2,Ge=3*N.primitiveOffset*2*2;te&&te>1?de.drawElementsInstanced(de.LINES,Oe,de.UNSIGNED_SHORT,Ge,te):de.drawElements(de.LINES,Oe,de.UNSIGNED_SHORT,Ge),D.bind(),ce.program.set(this.program),ce.setDepthMode(g),ce.setStencilMode(S),ce.setColorMode(P)}draw(h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se){const Te=h.context,Oe=Te.gl;if(this.failedToCreate)return;Te.program.set(this.program),Te.setDepthMode(S),Te.setStencilMode(P),Te.setColorMode(D),Te.setCullFace(N);for(const Xe of Object.keys(this.fixedUniforms))this.fixedUniforms[Xe].set(this.program,Xe,$[Xe]);xe&&xe.setUniforms(this.program,Te,this.binderUniforms,ce,{zoom:de});const Ge={[Oe.POINTS]:1,[Oe.LINES]:2,[Oe.TRIANGLES]:3,[Oe.LINE_STRIP]:1}[g],Be=Se&&Se>0?1:void 0;for(const Xe of le.get()){const $e=Xe.vaos||(Xe.vaos={});($e[Y]||($e[Y]=new eh)).bind(Te,this,ee,xe?xe.getPaintVertexBuffers():[],te,Xe.vertexOffset,be||[],Be),Se&&Se>1?Oe.drawElementsInstanced(g,Xe.primitiveLength*Ge,Oe.UNSIGNED_SHORT,Xe.primitiveOffset*Ge*2,Se):te?Oe.drawElements(g,Xe.primitiveLength*Ge,Oe.UNSIGNED_SHORT,Xe.primitiveOffset*Ge*2):Oe.drawArrays(g,Xe.vertexOffset,Xe.vertexLength),g===Oe.TRIANGLES&&te&&this._drawDebugWireframe(h,S,P,D,te,Xe,ce,de,xe,Se)}}}function ha(w,h){const g=Math.pow(2,h.tileID.overscaledZ),S=h.tileSize*Math.pow(2,w.transform.tileZoom)/g,P=S*(h.tileID.canonical.x+h.tileID.wrap*g),D=S*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture?h.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.ak(h,1,w.transform.tileZoom),u_pixel_coord_upper:[P>>16,D>>16],u_pixel_coord_lower:[65535&P,65535&D]}}const Qp=a.a6.mat4.create(),zg=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be)=>{const Se=h.style.light,Te=Se.properties.get("position"),Oe=[Te.x,Te.y,Te.z],Ge=a.a6.mat3.create();Se.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(Ge,-h.transform.angle),a.a6.vec3.transformMat3(Oe,Oe,Ge));const Be=Se.properties.get("color"),Xe=h.transform,$e={u_matrix:w,u_lightpos:Oe,u_lightintensity:Se.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_vertical_gradient:+g,u_opacity:S,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Qp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:P,u_edge_radius:D,u_width_scale:N,u_flood_light_color:ce,u_vertical_scale:de,u_flood_light_intensity:xe,u_ground_shadow_factor:be};return Xe.projection.name==="globe"&&($e.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],$e.u_zoom_transition=ee,$e.u_inv_rot_matrix=le,$e.u_merc_center=te,$e.u_up_dir=Xe.projection.upVector(new a.bP(0,0,0),te[0]*a.ab,te[1]*a.ab),$e.u_height_lift=Y),$e},c_=(w,h,g,S)=>({u_matrix:w,u_edge_radius:h,u_width_scale:g,u_vertical_scale:S}),Ug=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe)=>{const be=zg(w,h,g,S,P,D,N,$,ee,te,le,ce,de,xe,1,[0,0,0]),Se={u_height_factor:-Math.pow(2,$.overscaledZ)/Y.tileSize/8};return a.l(be,ha(h,Y),Se)},em=(w,h)=>({u_matrix:w,u_emissive_strength:h}),Gg=(w,h,g,S)=>a.l(em(w,h),ha(g,S)),u_=(w,h,g)=>({u_matrix:w,u_world:g,u_emissive_strength:h}),dd=(w,h,g,S,P)=>a.l(Gg(w,h,g,S),{u_world:P}),Xx=(w,h,g,S)=>{const P=a.ab/g.tileSize;return{u_matrix:w,u_camera_to_center_distance:h.getCameraToCenterDistance(S),u_extrude_scale:[h.pixelsToGLUnits[0]/P,h.pixelsToGLUnits[1]/P]}},h_=(w,h,g=1)=>({u_matrix:w,u_color:h.toRenderColor(null),u_overlay:0,u_overlay_scale:g}),tm=a.a6.mat4.create(),Vg=(w,h,g,S,P,D,N)=>{const $=w.transform,Y=$.projection.name==="globe",ee=Y?a.cI($.zoom,h.canonical)*$._pixelsPerMercatorPixel:a.ak(g,1,D),te={u_matrix:h.projMatrix,u_extrude_scale:ee,u_intensity:N,u_inv_rot_matrix:tm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Y){te.u_inv_rot_matrix=S,te.u_merc_center=P,te.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],te.u_zoom_transition=a.a9($.zoom);const le=P[0]*a.ab,ce=P[1]*a.ab;te.u_up_dir=$.projection.upVector(new a.bP(0,0,0),le,ce)}return te};function nm(w,[h,g,S,P],[D,N]){if(D===N)return[0,0,0,0];const $=255*(w-1)/(w*(N-D));return[h*$,g*$,S*$,P*$]}function If(w,h,[g,S]){return g===S?0:.5/w+(h-g)*(w-1)/(w*(S-g))}const Pf=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te,Oe,Ge,Be)=>({u_matrix:w,u_normalize_matrix:h,u_globe_matrix:g,u_merc_matrix:S,u_grid_matrix:P,u_tl_parent:D,u_scale_parent:ee,u_fade_t:te.mix,u_opacity:te.opacity*le.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:le.paint.get("raster-brightness-min"),u_brightness_high:le.paint.get("raster-brightness-max"),u_saturation_factor:a.cJ(le.paint.get("raster-saturation")),u_contrast_factor:a.cK(le.paint.get("raster-contrast")),u_spin_weights:Hg(le.paint.get("raster-hue-rotate")),u_perspective_transform:ce,u_raster_elevation:de,u_zoom_transition:N,u_merc_center:$,u_cutoff_params:Y,u_colorization_mix:nm(a.cL,be,Te),u_colorization_offset:If(a.cL,Se,Te),u_color_ramp:xe,u_texture_offset:[Ge/(Oe+2*Ge),Oe/(Oe+2*Ge)],u_texture_res:[Oe+2*Ge,Oe+2*Ge],u_emissive_strength:Be});function Hg(w){w*=Math.PI/180;const h=Math.sin(w),g=Math.cos(w);return[(2*g+1)/3,(-Math.sqrt(3)*h-g+1)/3,(Math.sqrt(3)*h-g+1)/3]}const ml=.05,d_=(w,h,g,S,P,D,N,$,Y,ee,te,le)=>({u_matrix:w,u_normalize_matrix:h,u_globe_matrix:g,u_merc_matrix:S,u_grid_matrix:P,u_tl_parent:D,u_scale_parent:ee,u_fade_t:te.mix,u_opacity:te.opacity,u_image0:0,u_image1:1,u_raster_elevation:le,u_zoom_transition:N,u_merc_center:$,u_cutoff_params:Y}),Rf=(w,h,g,S,P,D,N,$,Y,ee)=>({u_particle_texture:w,u_particle_texture_side_len:h,u_tile_offset:g,u_velocity:S,u_color_ramp:D,u_velocity_res:P,u_max_speed:N,u_uv_offset:$,u_data_scale:[255*Y[0],255*Y[1]],u_data_offset:ee,u_particle_pos_scale:1.1,u_particle_pos_offset:[ml,ml]}),rm=(w,h,g,S,P,D,N,$,Y,ee)=>({u_particle_texture:w,u_particle_texture_side_len:h,u_velocity:g,u_velocity_res:S,u_max_speed:P,u_speed_factor:D,u_reset_rate:N,u_rand_seed:Math.random(),u_uv_offset:$,u_data_scale:[255*Y[0],255*Y[1]],u_data_offset:ee,u_particle_pos_scale:1.1,u_particle_pos_offset:[ml,ml]}),Ll=a.a6.mat4.create(),f_=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te,Oe,Ge,Be)=>{const Xe=P.transform,$e={u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:Xe.getCameraToCenterDistance(Oe),u_rotate_symbol:+g,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:N,u_coord_matrix:$,u_is_text:+ee,u_elevation_from_sea:Y?1:0,u_pitch_with_map:+S,u_texsize:te,u_texsize_icon:le,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ll,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ll,u_up_vector:[0,-1,0],u_color_adj_mat:Ge,u_icon_transition:Be||0,u_gamma_scale:S?P.transform.getCameraToCenterDistance(Oe)*Math.cos(P.terrain?0:P.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:+ce};return Oe.name==="globe"&&($e.u_tile_id=[de.canonical.x,de.canonical.y,1<<de.canonical.z],$e.u_zoom_transition=xe,$e.u_inv_rot_matrix=Se,$e.u_merc_center=be,$e.u_camera_forward=Xe._camera.forward(),$e.u_ecef_origin=a.cM(Xe.globeMatrix,de.toUnwrapped()),$e.u_tile_matrix=Float32Array.from(Xe.globeMatrix),$e.u_up_vector=Te),$e},qx=(w,h,g,S)=>({u_matrix:w,u_emissive_strength:h,u_opacity:g,u_color:S}),jc=(w,h,g,S,P,D,N,$,Y)=>a.l(function(ee,te,le,ce,de,xe){const{width:be,height:Se}=ce.imageManager.getPixelSize(te),Te=Math.pow(2,xe.tileID.overscaledZ),Oe=xe.tileSize*Math.pow(2,ce.transform.tileZoom)/Te,Ge=Oe*(xe.tileID.canonical.x+xe.tileID.wrap*Te),Be=Oe*xe.tileID.canonical.y;return{u_image:0,u_pattern_tl:le.tl,u_pattern_br:le.br,u_texsize:[be,Se],u_pattern_size:le.displaySize,u_pattern_units_to_pixels:de?[ce.transform.width,-1*ce.transform.height]:[1/a.ak(xe,1,ce.transform.tileZoom),1/a.ak(xe,1,ce.transform.tileZoom)],u_pixel_coord_upper:[Ge>>16,Be>>16],u_pixel_coord_lower:[65535&Ge,65535&Be]}}(0,D,N,S,$,Y),{u_matrix:w,u_emissive_strength:h,u_opacity:g}),Dl=new Float32Array(a.a6.mat4.identity([])),Nn=(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de=[0,0,0],xe)=>{const be=P.style.light,Se=be.properties.get("position"),Te=[-Se.x,-Se.y,Se.z],Oe=a.a6.mat3.create();be.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(Oe,-P.transform.angle),a.a6.vec3.transformMat3(Te,Te,Oe));const Ge=te.alphaMode==="MASK",Be=be.properties.get("color").toRenderColor(null),Xe=ce.paint.get("model-ambient-occlusion-intensity"),$e=ce.paint.get("model-color").constantOr(a.bz.white).toRenderColor(null),tt=ce.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:w,u_lighting_matrix:h,u_normal_matrix:g,u_node_matrix:S||Dl,u_lightpos:Te,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_camera_pos:de,u_opacity:D,u_baseTextureIsAlpha:0,u_alphaMask:+Ge,u_alphaCutoff:te.alphaCutoff,u_baseColorFactor:[N.r,N.g,N.b,N.a],u_emissiveFactor:[$[0],$[1],$[2],1],u_metallicFactor:Y,u_roughnessFactor:ee,u_baseColorTexture:uo.BaseColor,u_metallicRoughnessTexture:uo.MetallicRoughness,u_normalTexture:uo.Normal,u_occlusionTexture:uo.Occlusion,u_emissionTexture:uo.Emission,u_lutTexture:uo.LUT,u_color_mix:[$e.r,$e.g,$e.b,tt],u_aoIntensity:Xe,u_emissive_strength:le,u_occlusionTextureTransform:xe||[0,0,0,0]}},or=(w,h=Dl,g=Dl)=>({u_matrix:w,u_instance:h,u_node_matrix:g}),im={fillExtrusion:w=>({u_matrix:new a.bF(w),u_lightpos:new a.bH(w),u_lightintensity:new a.bI(w),u_lightcolor:new a.bH(w),u_vertical_gradient:new a.bI(w),u_opacity:new a.bI(w),u_edge_radius:new a.bI(w),u_width_scale:new a.bI(w),u_ao:new a.bG(w),u_tile_id:new a.bH(w),u_zoom_transition:new a.bI(w),u_inv_rot_matrix:new a.bF(w),u_merc_center:new a.bG(w),u_up_dir:new a.bH(w),u_height_lift:new a.bI(w),u_flood_light_color:new a.bH(w),u_vertical_scale:new a.bI(w),u_flood_light_intensity:new a.bI(w),u_ground_shadow_factor:new a.bH(w)}),fillExtrusionDepth:w=>({u_matrix:new a.bF(w),u_edge_radius:new a.bI(w),u_width_scale:new a.bI(w),u_vertical_scale:new a.bI(w)}),fillExtrusionPattern:w=>({u_matrix:new a.bF(w),u_lightpos:new a.bH(w),u_lightintensity:new a.bI(w),u_lightcolor:new a.bH(w),u_vertical_gradient:new a.bI(w),u_height_factor:new a.bI(w),u_edge_radius:new a.bI(w),u_width_scale:new a.bI(w),u_ao:new a.bG(w),u_tile_id:new a.bH(w),u_zoom_transition:new a.bI(w),u_inv_rot_matrix:new a.bF(w),u_merc_center:new a.bG(w),u_up_dir:new a.bH(w),u_height_lift:new a.bI(w),u_image:new a.bJ(w),u_texsize:new a.bG(w),u_pixel_coord_upper:new a.bG(w),u_pixel_coord_lower:new a.bG(w),u_tile_units_to_pixels:new a.bI(w),u_opacity:new a.bI(w)}),fillExtrusionGroundEffect:w=>({u_matrix:new a.bF(w),u_opacity:new a.bI(w),u_ao_pass:new a.bI(w),u_meter_to_tile:new a.bI(w),u_ao:new a.bG(w),u_flood_light_intensity:new a.bI(w),u_flood_light_color:new a.bH(w),u_attenuation:new a.bI(w),u_edge_radius:new a.bI(w),u_fb:new a.bJ(w),u_fb_size:new a.bI(w),u_dynamic_offset:new a.bI(w)}),fill:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w)}),fillPattern:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w),u_image:new a.bJ(w),u_texsize:new a.bG(w),u_pixel_coord_upper:new a.bG(w),u_pixel_coord_lower:new a.bG(w),u_tile_units_to_pixels:new a.bI(w)}),fillOutline:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w),u_world:new a.bG(w)}),fillOutlinePattern:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w),u_world:new a.bG(w),u_image:new a.bJ(w),u_texsize:new a.bG(w),u_pixel_coord_upper:new a.bG(w),u_pixel_coord_lower:new a.bG(w),u_tile_units_to_pixels:new a.bI(w)}),circle:a.cN,collisionBox:w=>({u_matrix:new a.bF(w),u_camera_to_center_distance:new a.bI(w),u_extrude_scale:new a.bG(w)}),collisionCircle:w=>({u_matrix:new a.bF(w),u_inv_matrix:new a.bF(w),u_camera_to_center_distance:new a.bI(w),u_viewport_size:new a.bG(w)}),debug:w=>({u_color:new a.cu(w),u_matrix:new a.bF(w),u_overlay:new a.bJ(w),u_overlay_scale:new a.bI(w)}),clippingMask:w=>({u_matrix:new a.bF(w)}),heatmap:w=>({u_extrude_scale:new a.bI(w),u_intensity:new a.bI(w),u_matrix:new a.bF(w),u_inv_rot_matrix:new a.bF(w),u_merc_center:new a.bG(w),u_tile_id:new a.bH(w),u_zoom_transition:new a.bI(w),u_up_dir:new a.bH(w)}),heatmapTexture:w=>({u_image:new a.bJ(w),u_color_ramp:new a.bJ(w),u_opacity:new a.bI(w)}),hillshade:w=>({u_matrix:new a.bF(w),u_image:new a.bJ(w),u_latrange:new a.bG(w),u_light:new a.bG(w),u_shadow:new a.cu(w),u_highlight:new a.cu(w),u_emissive_strength:new a.bI(w),u_accent:new a.cu(w)}),hillshadePrepare:w=>({u_matrix:new a.bF(w),u_image:new a.bJ(w),u_dimension:new a.bG(w),u_zoom:new a.bI(w)}),line:a.cO,linePattern:a.cP,raster:w=>({u_matrix:new a.bF(w),u_normalize_matrix:new a.bF(w),u_globe_matrix:new a.bF(w),u_merc_matrix:new a.bF(w),u_grid_matrix:new a.cv(w),u_tl_parent:new a.bG(w),u_scale_parent:new a.bI(w),u_fade_t:new a.bI(w),u_opacity:new a.bI(w),u_image0:new a.bJ(w),u_image1:new a.bJ(w),u_brightness_low:new a.bI(w),u_brightness_high:new a.bI(w),u_saturation_factor:new a.bI(w),u_contrast_factor:new a.bI(w),u_spin_weights:new a.bH(w),u_perspective_transform:new a.bG(w),u_raster_elevation:new a.bI(w),u_zoom_transition:new a.bI(w),u_merc_center:new a.bG(w),u_cutoff_params:new a.c6(w),u_colorization_mix:new a.c6(w),u_colorization_offset:new a.bI(w),u_color_ramp:new a.bJ(w),u_texture_offset:new a.bG(w),u_texture_res:new a.bG(w),u_emissive_strength:new a.bI(w)}),rasterParticle:w=>({u_matrix:new a.bF(w),u_normalize_matrix:new a.bF(w),u_globe_matrix:new a.bF(w),u_merc_matrix:new a.bF(w),u_grid_matrix:new a.cv(w),u_tl_parent:new a.bG(w),u_scale_parent:new a.bI(w),u_fade_t:new a.bI(w),u_opacity:new a.bI(w),u_image0:new a.bJ(w),u_image1:new a.bJ(w),u_raster_elevation:new a.bI(w),u_zoom_transition:new a.bI(w),u_merc_center:new a.bG(w),u_cutoff_params:new a.c6(w)}),rasterParticleTexture:w=>({u_texture:new a.bJ(w),u_opacity:new a.bI(w)}),rasterParticleDraw:w=>({u_particle_texture:new a.bJ(w),u_particle_texture_side_len:new a.bI(w),u_tile_offset:new a.bG(w),u_velocity:new a.bJ(w),u_color_ramp:new a.bJ(w),u_velocity_res:new a.bG(w),u_max_speed:new a.bI(w),u_uv_offset:new a.bG(w),u_data_scale:new a.bG(w),u_data_offset:new a.bI(w),u_particle_pos_scale:new a.bI(w),u_particle_pos_offset:new a.bG(w)}),rasterParticleUpdate:w=>({u_particle_texture:new a.bJ(w),u_particle_texture_side_len:new a.bI(w),u_velocity:new a.bJ(w),u_velocity_res:new a.bG(w),u_max_speed:new a.bI(w),u_speed_factor:new a.bI(w),u_reset_rate:new a.bI(w),u_rand_seed:new a.bI(w),u_uv_offset:new a.bG(w),u_data_scale:new a.bG(w),u_data_offset:new a.bI(w),u_particle_pos_scale:new a.bI(w),u_particle_pos_offset:new a.bG(w)}),symbol:w=>({u_is_size_zoom_constant:new a.bJ(w),u_is_size_feature_constant:new a.bJ(w),u_size_t:new a.bI(w),u_size:new a.bI(w),u_camera_to_center_distance:new a.bI(w),u_rotate_symbol:new a.bJ(w),u_aspect_ratio:new a.bI(w),u_fade_change:new a.bI(w),u_matrix:new a.bF(w),u_label_plane_matrix:new a.bF(w),u_coord_matrix:new a.bF(w),u_is_text:new a.bJ(w),u_elevation_from_sea:new a.bJ(w),u_pitch_with_map:new a.bJ(w),u_texsize:new a.bG(w),u_texsize_icon:new a.bG(w),u_texture:new a.bJ(w),u_texture_icon:new a.bJ(w),u_gamma_scale:new a.bI(w),u_device_pixel_ratio:new a.bI(w),u_tile_id:new a.bH(w),u_zoom_transition:new a.bI(w),u_inv_rot_matrix:new a.bF(w),u_merc_center:new a.bG(w),u_camera_forward:new a.bH(w),u_tile_matrix:new a.bF(w),u_up_vector:new a.bH(w),u_ecef_origin:new a.bH(w),u_is_halo:new a.bJ(w),u_icon_transition:new a.bI(w),u_color_adj_mat:new a.bF(w)}),background:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w),u_opacity:new a.bI(w),u_color:new a.cu(w)}),backgroundPattern:w=>({u_matrix:new a.bF(w),u_emissive_strength:new a.bI(w),u_opacity:new a.bI(w),u_image:new a.bJ(w),u_pattern_tl:new a.bG(w),u_pattern_br:new a.bG(w),u_texsize:new a.bG(w),u_pattern_size:new a.bG(w),u_pixel_coord_upper:new a.bG(w),u_pixel_coord_lower:new a.bG(w),u_pattern_units_to_pixels:new a.bG(w)}),terrainRaster:w=>({u_matrix:new a.bF(w),u_image0:new a.bJ(w),u_skirt_height:new a.bI(w),u_ground_shadow_factor:new a.bH(w)}),skybox:w=>({u_matrix:new a.bF(w),u_sun_direction:new a.bH(w),u_cubemap:new a.bJ(w),u_opacity:new a.bI(w),u_temporal_offset:new a.bI(w)}),skyboxGradient:w=>({u_matrix:new a.bF(w),u_color_ramp:new a.bJ(w),u_center_direction:new a.bH(w),u_radius:new a.bI(w),u_opacity:new a.bI(w),u_temporal_offset:new a.bI(w)}),skyboxCapture:w=>({u_matrix_3f:new a.cv(w),u_sun_direction:new a.bH(w),u_sun_intensity:new a.bI(w),u_color_tint_r:new a.c6(w),u_color_tint_m:new a.c6(w),u_luminance:new a.bI(w)}),globeRaster:w=>({u_proj_matrix:new a.bF(w),u_globe_matrix:new a.bF(w),u_normalize_matrix:new a.bF(w),u_merc_matrix:new a.bF(w),u_zoom_transition:new a.bI(w),u_merc_center:new a.bG(w),u_image0:new a.bJ(w),u_grid_matrix:new a.cv(w),u_skirt_height:new a.bI(w),u_far_z_cutoff:new a.bI(w),u_frustum_tl:new a.bH(w),u_frustum_tr:new a.bH(w),u_frustum_br:new a.bH(w),u_frustum_bl:new a.bH(w),u_globe_pos:new a.bH(w),u_globe_radius:new a.bI(w),u_viewport:new a.bG(w)}),globeAtmosphere:w=>({u_frustum_tl:new a.bH(w),u_frustum_tr:new a.bH(w),u_frustum_br:new a.bH(w),u_frustum_bl:new a.bH(w),u_horizon:new a.bI(w),u_transition:new a.bI(w),u_fadeout_range:new a.bI(w),u_color:new a.c6(w),u_high_color:new a.c6(w),u_space_color:new a.c6(w),u_temporal_offset:new a.bI(w),u_horizon_angle:new a.bI(w)}),model:w=>({u_matrix:new a.bF(w),u_lighting_matrix:new a.bF(w),u_normal_matrix:new a.bF(w),u_node_matrix:new a.bF(w),u_lightpos:new a.bH(w),u_lightintensity:new a.bI(w),u_lightcolor:new a.bH(w),u_camera_pos:new a.bH(w),u_opacity:new a.bI(w),u_baseColorFactor:new a.c6(w),u_emissiveFactor:new a.c6(w),u_metallicFactor:new a.bI(w),u_roughnessFactor:new a.bI(w),u_baseTextureIsAlpha:new a.bJ(w),u_alphaMask:new a.bJ(w),u_alphaCutoff:new a.bI(w),u_baseColorTexture:new a.bJ(w),u_metallicRoughnessTexture:new a.bJ(w),u_normalTexture:new a.bJ(w),u_occlusionTexture:new a.bJ(w),u_emissionTexture:new a.bJ(w),u_lutTexture:new a.bJ(w),u_color_mix:new a.c6(w),u_aoIntensity:new a.bI(w),u_emissive_strength:new a.bI(w),u_occlusionTextureTransform:new a.c6(w)}),modelDepth:w=>({u_matrix:new a.bF(w),u_instance:new a.bF(w),u_node_matrix:new a.bF(w)}),groundShadow:w=>({u_matrix:new a.bF(w),u_ground_shadow_factor:new a.bH(w)}),stars:w=>({u_matrix:new a.bF(w),u_up:new a.bH(w),u_right:new a.bH(w),u_intensity_multiplier:new a.bI(w)}),occlusion:w=>({u_matrix:new a.bF(w),u_anchorPos:new a.bH(w),u_screenSizePx:new a.bG(w),u_occluderSizePx:new a.bG(w),u_color:new a.c6(w)})};class wa{constructor(h,g,S,P){this.id=wa.uniqueIdxCounter,wa.uniqueIdxCounter++,this.context=h;const D=h.gl;this.buffer=D.createBuffer(),this.dynamicDraw=!!S,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||P||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){this.id=wa.uniqueIdxCounter,wa.uniqueIdxCounter++;const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}wa.uniqueIdxCounter=0;const nh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Kn{constructor(h,g,S,P,D,N){this.length=g.length,this.attributes=S,this.itemSize=g.bytesPerElement,this.dynamicDraw=P,this.instanceCount=N,this.context=h;const $=h.gl;this.buffer=$.createBuffer(),h.bindVertexBuffer.set(this.buffer),$.bufferData($.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?$.DYNAMIC_DRAW:$.STATIC_DRAW),this.dynamicDraw||D||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,g){for(let S=0;S<this.attributes.length;S++){const P=g.attributes[this.attributes[S].name];P!==void 0&&h.enableVertexAttribArray(P)}}setVertexAttribPointers(h,g,S){for(let P=0;P<this.attributes.length;P++){const D=this.attributes[P],N=g.attributes[D.name];N!==void 0&&h.vertexAttribPointer(N,D.components,h[nh[D.type]],!1,this.itemSize,D.offset+this.itemSize*(S||0))}}setVertexAttribDivisor(h,g,S){for(let P=0;P<this.attributes.length;P++){const D=g.attributes[this.attributes[P].name];D!==void 0&&this.instanceCount&&this.instanceCount>0&&h.vertexAttribDivisor(D,S)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Wc{constructor(h,g,S,P,D){this.context=h,this.width=g,this.height=S;const N=this.framebuffer=h.gl.createFramebuffer();P&&(this.colorAttachment=new kg(h,N)),D&&(this.depthAttachmentType=D,this.depthAttachment=D==="renderbuffer"?new Kp(h,N):new Og(h,N))}destroy(){const h=this.context.gl;if(this.colorAttachment){const g=this.colorAttachment.get();g&&h.deleteTexture(g)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const g=this.depthAttachment.get();g&&h.deleteRenderbuffer(g)}else{const g=this.depthAttachment.get();g&&h.deleteTexture(g)}h.deleteFramebuffer(this.framebuffer)}}class sm{constructor(h,g){this.gl=h,this.clearColor=new Tf(this),this.clearDepth=new K0(this),this.clearStencil=new Tg(this),this.colorMask=new $p(this),this.depthMask=new Mf(this),this.stencilMask=new J0(this),this.stencilFunc=new Q0(this),this.stencilOp=new Mg(this),this.stencilTest=new Hc(this),this.depthRange=new e_(this),this.depthTest=new Cg(this),this.depthFunc=new Eg(this),this.blend=new t_(this),this.blendFunc=new ad(this),this.blendColor=new Ig(this),this.blendEquation=new Pg(this),this.cullFace=new Rg(this),this.cullFaceSide=new n_(this),this.frontFace=new Lg(this),this.program=new jx(this),this.activeTexture=new Cf(this),this.viewport=new Xp(this),this.bindFramebuffer=new r_(this),this.bindRenderbuffer=new pl(this),this.bindTexture=new i_(this),this.bindVertexBuffer=new qp(this),this.bindElementBuffer=new Yp(this),this.bindVertexArrayOES=new Dg(this),this.pixelStoreUnpack=new Bg(this),this.pixelStoreUnpackPremultiplyAlpha=new ld(this),this.pixelStoreUnpackFlipY=new s_(this),this.options=g?{...g}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=h.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),this.maxPointSize=h.getParameter(h.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,g,S){return new wa(this,h,g,S)}createVertexBuffer(h,g,S,P,D){return new Kn(this,h,g,S,P,D)}createRenderbuffer(h,g,S){const P=this.gl,D=P.createRenderbuffer();return this.bindRenderbuffer.set(D),P.renderbufferStorage(P.RENDERBUFFER,h,g,S),this.bindRenderbuffer.set(null),D}createFramebuffer(h,g,S,P){return new Wc(this,h,g,S,P)}clear({color:h,depth:g,stencil:S,colorMask:P}){const D=this.gl;let N=0;h&&(N|=D.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set(P||[!0,!0,!0,!0])),g!==void 0&&(N|=D.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),S!==void 0&&(N|=D.STENCIL_BUFFER_BIT,this.clearStencil.set(S),this.stencilMask.set(255)),D.clear(N)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){a.bh(h.blendFunction,Cr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor),h.blendEquation?this.blendEquation.set(h.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(h.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Lf;function om(w,h,g,S,P,D,N){const $=w.context,Y=$.gl,ee=w.transform,te=w.getOrCreateProgram("collisionBox"),le=[];let ce=0,de=0;for(let Be=0;Be<S.length;Be++){const Xe=S[Be],$e=h.getTile(Xe),tt=$e.getBucket(g);if(!tt)continue;const Je=Zh(Xe,tt,ee);let nt=Je;P[0]===0&&P[1]===0||(nt=w.translatePosMatrix(Je,$e,P,D));const ht=N?tt.textCollisionBox:tt.iconCollisionBox,at=tt.collisionCircleArray;if(at.length>0){const st=a.a6.mat4.create(),wt=nt;a.a6.mat4.mul(st,tt.placementInvProjMatrix,ee.glCoordMatrix),a.a6.mat4.mul(st,st,tt.placementViewportMatrix),le.push({circleArray:at,circleOffset:de,transform:wt,invTransform:st,projection:tt.getProjection()}),ce+=at.length/4,de=ce}ht&&(w.terrain&&w.terrain.setupElevationDraw($e,te),te.draw(w,Y.LINES,qn.disabled,mr.disabled,w.colorModeForRenderPass(),yr.disabled,Xx(nt,ee,$e,tt.getProjection()),g.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,null,ee.zoom,null,[ht.collisionVertexBuffer,ht.collisionVertexBufferExt]))}if(!N||!le.length)return;const xe=w.getOrCreateProgram("collisionCircle"),be=new a.cQ;be.resize(4*ce),be._trim();let Se=0;for(const Be of le)for(let Xe=0;Xe<Be.circleArray.length/4;Xe++){const $e=4*Xe,tt=Be.circleArray[$e+0],Je=Be.circleArray[$e+1],nt=Be.circleArray[$e+2],ht=Be.circleArray[$e+3];be.emplace(Se++,tt,Je,nt,ht,0),be.emplace(Se++,tt,Je,nt,ht,1),be.emplace(Se++,tt,Je,nt,ht,2),be.emplace(Se++,tt,Je,nt,ht,3)}(!Lf||Lf.length<2*ce)&&(Lf=function(Be){const Xe=2*Be,$e=new a.aO;$e.resize(Xe),$e._trim();for(let tt=0;tt<Xe;tt++){const Je=6*tt;$e.uint16[Je+0]=4*tt+0,$e.uint16[Je+1]=4*tt+1,$e.uint16[Je+2]=4*tt+2,$e.uint16[Je+3]=4*tt+2,$e.uint16[Je+4]=4*tt+3,$e.uint16[Je+5]=4*tt+0}return $e}(ce));const Te=$.createIndexBuffer(Lf,!0),Oe=$.createVertexBuffer(be,a.cR.members,!0);for(const Be of le){const Xe={u_matrix:Be.transform,u_inv_matrix:Be.invTransform,u_camera_to_center_distance:(Ge=ee).getCameraToCenterDistance(Be.projection),u_viewport_size:[Ge.width,Ge.height]};xe.draw(w,Y.TRIANGLES,qn.disabled,mr.disabled,w.colorModeForRenderPass(),yr.disabled,Xe,g.id,Oe,Te,a.b1.simpleSegment(0,2*Be.circleOffset,Be.circleArray.length,Be.circleArray.length/2),null,ee.zoom)}var Ge;Oe.destroy(),Te.destroy()}const Df=a.a6.mat4.create();function jg(w){const h=w._camera.getWorldToCamera(w.worldSize,1),g=a.a6.mat4.multiply([],h,w.globeMatrix);a.a6.mat4.invert(g,g);const S=[0,0,0],P=[0,1,0,0];return a.a6.vec4.transformMat4(P,P,g),S[0]=P[0],S[1]=P[1],S[2]=P[2],a.a6.vec3.normalize(S,S),S}function Yx({width:w,height:h,anchor:g,textOffset:S,textScale:P},D){const{horizontalAlign:N,verticalAlign:$}=a.bx(g),Y=-(N-.5)*w,ee=-($-.5)*h,te=a.bw(g,S);return new a.P((Y/P+te[0])*D,(ee/P+te[1])*D)}function Zx(w,h,g,S,P,D,N,$,Y,ee,te){const le=w.text.placedSymbolArray,ce=w.text.dynamicLayoutVertexArray,de=w.icon.dynamicLayoutVertexArray,xe={},be=w.getProjection(),Se=Uc($,be,D),Te=D.elevation,Oe=be.upVectorScale($.canonical,D.center.lat,D.worldSize).metersToTile;ce.clear();for(let Ge=0;Ge<le.length;Ge++){const Be=le.get(Ge),{tileAnchorX:Xe,tileAnchorY:$e,numGlyphs:tt}=Be,Je=Be.hidden||!Be.crossTileID||w.allowVerticalPlacement&&!Be.placedOrientation?null:S[Be.crossTileID];if(Je){let nt=0,ht=0,at=0;if(Te){const Ht=Te?Te.getAtTileOffset($,Xe,$e):0,[fn,mn,Yt]=be.upVector($.canonical,Xe,$e);nt=Ht*fn*Oe,ht=Ht*mn*Oe,at=Ht*Yt*Oe}let[st,wt,zt,Zt]=ya(Be.projectedAnchorX+nt,Be.projectedAnchorY+ht,Be.projectedAnchorZ+at,g?Se:N);const Ft=ii(D.getCameraToCenterDistance(be),Zt);let dn=P.evaluateSizeForFeature(w.textSizeData,ee,Be)*Ft/a.bq;g&&(dn*=w.tilePixelRatio/Y);const St=Yx(Je,dn);g?({x:st,y:wt,z:zt}=be.projectTilePoint(Xe+St.x,$e+St.y,$.canonical),[st,wt,zt]=ya(st+nt,wt+ht,zt+at,N)):(h&&St._rotate(-D.angle),st+=St.x,wt+=St.y,zt=0);const $t=w.allowVerticalPlacement&&Be.placedOrientation===a.bk.vertical?Math.PI/2:0;for(let Ht=0;Ht<tt;Ht++)a.bn(ce,st,wt,zt,$t);te&&Be.associatedIconIndex>=0&&(xe[Be.associatedIconIndex]={x:st,y:wt,z:zt,angle:$t})}else hl(tt,ce)}if(te){de.clear();const Ge=w.icon.placedSymbolArray;for(let Be=0;Be<Ge.length;Be++){const Xe=Ge.get(Be),{numGlyphs:$e}=Xe,tt=xe[Be];if(Xe.hidden||!tt)hl($e,de);else{const{x:Je,y:nt,z:ht,angle:at}=tt;for(let st=0;st<$e;st++)a.bn(de,Je,nt,ht,at)}}w.icon.dynamicLayoutVertexBuffer.updateData(de)}w.text.dynamicLayoutVertexBuffer.updateData(ce)}function Bf(w,h,g,S,P,D,N={}){const $=g.paint.get("icon-translate"),Y=g.paint.get("text-translate"),ee=g.paint.get("icon-translate-anchor"),te=g.paint.get("text-translate-anchor"),le=g.layout.get("icon-rotation-alignment"),ce=g.layout.get("text-rotation-alignment"),de=g.layout.get("icon-pitch-alignment"),xe=g.layout.get("text-pitch-alignment"),be=g.layout.get("icon-keep-upright"),Se=g.layout.get("text-keep-upright"),Te=g.paint.get("icon-color-saturation"),Oe=g.paint.get("icon-color-contrast"),Ge=g.paint.get("icon-color-brightness-min"),Be=g.paint.get("icon-color-brightness-max"),Xe=g.paint.get("symbol-elevation-reference")==="sea",$e=g.paint.get("text-occlusion-opacity").constantOr(0),tt=w.context,Je=tt.gl,nt=w.transform,ht=le==="map",at=ce==="map",st=de==="map",wt=xe==="map",zt=g.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Zt=!1;const Ft=w.depthModeForSublayer(0,qn.ReadOnly),dn=[a.am(nt.center.lng),a.at(nt.center.lat)],St=g.layout.get("text-variable-anchor"),$t=nt.projection.name==="globe",Ht=[],fn=[0,-1,0];for(const mn of S){const Yt=h.getTile(mn),tn=Yt.getBucket(g);if(!tn||tn.projection.name==="mercator"&&$t||tn.fullyClipped)continue;const tr=tn.projection.name==="globe",bn=tr?a.a9(nt.zoom):0,Bn=Uc(mn,tn.getProjection(),nt),xr=nt.calculatePixelsToTileUnitsMatrix(Yt),Yn=St&&tn.hasTextData(),hr=tn.hasIconTextFit()&&Yn&&tn.hasIconData(),Vr=tn.getProjection().createInversionMatrix(nt,mn.canonical),kr=Oi=>{nt.depthOcclusionForSymbolsAndCircles&&(g.hasInitialOcclusionOpacityProperties||w.terrain)&&(Oi.push("DEPTH_D24"),Oi.push("DEPTH_OCCLUSION"))},Ri=()=>{const Oi=ht&&g.layout.get("symbol-placement")!=="point",Fr=[];kr(Fr);const gi=Oi||hr,Ei=g.paint.get("icon-image-cross-fade").constantOr(0);w.terrainRenderModeElevated()&&st&&Fr.push("PITCH_WITH_MAP_TERRAIN"),tr&&(Fr.push("PROJECTION_GLOBE_VIEW"),gi&&Fr.push("PROJECTED_POS_ON_VIEWPORT")),Ei>0&&Fr.push("ICON_TRANSITION"),tn.icon.zOffsetVertexBuffer&&Fr.push("Z_OFFSET"),Te===0&&Oe===0&&Ge===0&&Be===1||Fr.push("COLOR_ADJUSTMENT"),tn.sdfIcons&&Fr.push("RENDER_SDF");const Gs=tn.icon.programConfigurations.get(g.id),ro=w.getOrCreateProgram("symbol",{config:Gs,defines:Fr}),li=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],Uo=tn.iconSizeData,ea=a.bj(Uo,nt.zoom),Go=st||nt.pitch!==0,es=ni(Bn,Yt.tileID.canonical,st,ht,nt,tn.getProjection(),xr),vl=Hs(Bn,Yt.tileID.canonical,st,ht,nt,tn.getProjection(),xr),_l=w.translatePosMatrix(vl,Yt,$,ee,!0),Zc=w.translatePosMatrix(Bn,Yt,$,ee),vc=gi?Df:es,Ol=ht&&!st&&!Oi;let Kc=fn;!$t&&!nt.mercatorFromTransition||ht||(Kc=jg(nt));const Sd=tr?Kc:fn,Wf=g.getColorAdjustmentMatrix(Te,Oe,Ge,Be),ch=f_(Uo.kind,ea,Ol,st,w,Zc,vc,_l,Xe,!1,li,[0,0],!0,mn,bn,dn,Vr,Sd,tn.getProjection(),Wf,Ei),rv=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,iv=g.layout.get("icon-size").constantOr(0)!==1||tn.iconsNeedLinear,r1=tn.sdfIcons||w.options.rotating||w.options.zooming||iv||Go?Je.LINEAR:Je.NEAREST,sv=tn.sdfIcons&&g.paint.get("icon-halo-width").constantOr(1)!==0,ts=w.terrain&&st&&Oi?a.a6.mat4.invert(a.a6.mat4.create(),es):Df;if(Oi&&tn.icon){const pm=nt.elevation,rk=pm?pm.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,tn.getProjection()):null,qC=Kr(Bn,Yt.tileID.canonical,st,ht,nt,tn.getProjection(),xr);Za(tn,Bn,w,!1,qC,vl,st,be,rk,mn)}return{program:ro,buffers:tn.icon,uniformValues:ch,atlasTexture:rv,atlasTextureIcon:null,atlasInterpolation:r1,atlasInterpolationIcon:null,isSDF:tn.sdfIcons,hasHalo:sv,tile:Yt,labelPlaneMatrixInv:ts}},Hi=()=>{const Oi=at&&g.layout.get("symbol-placement")!=="point",Fr=[],gi=Oi||St||hr;w.terrainRenderModeElevated()&&wt&&Fr.push("PITCH_WITH_MAP_TERRAIN"),tr&&(Fr.push("PROJECTION_GLOBE_VIEW"),gi&&Fr.push("PROJECTED_POS_ON_VIEWPORT")),tn.text.zOffsetVertexBuffer&&Fr.push("Z_OFFSET"),tn.iconsInText&&Fr.push("RENDER_TEXT_AND_SYMBOL"),Fr.push("RENDER_SDF"),kr(Fr);const Ei=tn.text.programConfigurations.get(g.id),Gs=w.getOrCreateProgram("symbol",{config:Ei,defines:Fr});let ro,li=[0,0],Uo=null;const ea=tn.textSizeData;tn.iconsInText&&(li=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],Uo=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,ro=wt||nt.pitch!==0||w.options.rotating||w.options.zooming||ea.kind==="composite"||ea.kind==="camera"?Je.LINEAR:Je.NEAREST);const Go=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture.size:[0,0],es=a.bj(ea,nt.zoom),vl=ni(Bn,Yt.tileID.canonical,wt,at,nt,tn.getProjection(),xr),_l=Hs(Bn,Yt.tileID.canonical,wt,at,nt,tn.getProjection(),xr),Zc=w.translatePosMatrix(_l,Yt,Y,te,!0),vc=w.translatePosMatrix(Bn,Yt,Y,te),Ol=gi?Df:vl,Kc=at&&!wt&&!Oi;let Sd=fn;!$t&&!nt.mercatorFromTransition||at||(Sd=jg(nt));const Wf=f_(ea.kind,es,Kc,wt,w,vc,Ol,Zc,Xe,!0,Go,li,!0,mn,bn,dn,Vr,tr?Sd:fn,tn.getProjection(),$e),ch=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture:null,rv=Je.LINEAR,iv=g.paint.get("text-halo-width").constantOr(1)!==0,r1=w.terrain&&wt&&Oi?a.a6.mat4.invert(a.a6.mat4.create(),vl):Df;if(Oi&&tn.text){const sv=nt.elevation,ts=sv?sv.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,tn.getProjection()):null,pm=Kr(Bn,Yt.tileID.canonical,wt,at,nt,tn.getProjection(),xr);Za(tn,Bn,w,!0,pm,_l,wt,Se,ts,mn)}return{program:Gs,buffers:tn.text,uniformValues:Wf,atlasTexture:ch,atlasTextureIcon:Uo,atlasInterpolation:rv,atlasInterpolationIcon:ro,isSDF:!0,hasHalo:iv,tile:Yt,labelPlaneMatrixInv:r1}},as=tn.icon.segments.get().length,Yc=tn.text.segments.get().length,no=as&&!N.onlyText?Ri():null,Jr=Yc&&!N.onlyIcons?Hi():null,Gi=g.paint.get("icon-opacity").constantOr(1),Ts=g.paint.get("text-opacity").constantOr(1);if(zt&&tn.canOverlap){Zt=!0;const Oi=Gi&&!N.onlyText?tn.icon.segments.get():[],Fr=Ts&&!N.onlyIcons?tn.text.segments.get():[];for(const gi of Oi)Ht.push({segments:new a.b1([gi]),sortKey:gi.sortKey,state:no});for(const gi of Fr)Ht.push({segments:new a.b1([gi]),sortKey:gi.sortKey,state:Jr})}else N.onlyText||Ht.push({segments:Gi?tn.icon.segments:new a.b1([]),sortKey:0,state:no}),N.onlyIcons||Ht.push({segments:Ts?tn.text.segments:new a.b1([]),sortKey:0,state:Jr})}Zt&&Ht.sort((mn,Yt)=>mn.sortKey-Yt.sortKey);for(const mn of Ht){const Yt=mn.state;if(Yt)if(w.terrain?w.terrain.setupElevationDraw(Yt.tile,Yt.program,{useDepthForOcclusion:nt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Yt.labelPlaneMatrixInv}):w.setupDepthForOcclusion(nt.depthOcclusionForSymbolsAndCircles,Yt.program),tt.activeTexture.set(Je.TEXTURE0),Yt.atlasTexture&&Yt.atlasTexture.bind(Yt.atlasInterpolation,Je.CLAMP_TO_EDGE,!0),Yt.atlasTextureIcon&&(tt.activeTexture.set(Je.TEXTURE1),Yt.atlasTextureIcon&&Yt.atlasTextureIcon.bind(Yt.atlasInterpolationIcon,Je.CLAMP_TO_EDGE,!0)),w.uploadCommonLightUniforms(w.context,Yt.program),Yt.hasHalo){const tn=Yt.uniformValues;tn.u_is_halo=1,fd(Yt.buffers,mn.segments,g,w,Yt.program,Ft,P,D,tn,2),tn.u_is_halo=0}else{if(Yt.isSDF){const tn=Yt.uniformValues;Yt.hasHalo&&(tn.u_is_halo=1,fd(Yt.buffers,mn.segments,g,w,Yt.program,Ft,P,D,tn,1)),tn.u_is_halo=0}fd(Yt.buffers,mn.segments,g,w,Yt.program,Ft,P,D,Yt.uniformValues,1)}}}function fd(w,h,g,S,P,D,N,$,Y,ee){const te=[w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer,w.iconTransitioningVertexBuffer,w.globeExtVertexBuffer,w.zOffsetVertexBuffer];P.draw(S,S.context.gl.TRIANGLES,D,N,$,yr.disabled,Y,g.id,w.layoutVertexBuffer,w.indexBuffer,h,g.paint,S.transform.zoom,w.programConfigurations.get(g.id),te,ee)}function kf(w,h,g,S,P,D,N){const $=w.context.gl,Y=g.paint.get("fill-pattern"),ee=g.is3D(),te=ee?w.stencilModeFor3D():mr.disabled,le=Y&&Y.constantOr(1);let ce,de,xe,be,Se;N?(de=le&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=$.LINES):(de=le?"fillPattern":"fill",ce=$.TRIANGLES);for(const Te of S){const Oe=h.getTile(Te);if(le&&!Oe.patternsLoaded())continue;const Ge=Oe.getBucket(g);if(!Ge)continue;w.prepareDrawTile();const Be=Ge.programConfigurations.get(g.id),Xe=w.isTileAffectedByFog(Te),$e=w.getOrCreateProgram(de,{config:Be,overrideFog:Xe});le&&(w.context.activeTexture.set($.TEXTURE0),Oe.imageAtlasTexture&&Oe.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Be.updatePaintBuffers());const tt=Y.constantOr(null);if(tt&&Oe.imageAtlas){const ht=Oe.imageAtlas.patternPositions[tt.toString()];ht&&Be.setConstantPatternPositions(ht)}const Je=w.translatePosMatrix(Te.projMatrix,Oe,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor")),nt=g.paint.get("fill-emissive-strength");if(N){be=Ge.indexBuffer2,Se=Ge.segments2;const ht=w.terrain&&w.terrain.renderingToTexture?w.terrain.drapeBufferSize:[$.drawingBufferWidth,$.drawingBufferHeight];xe=de==="fillOutlinePattern"&&le?dd(Je,nt,w,Oe,ht):u_(Je,nt,ht)}else be=Ge.indexBuffer,Se=Ge.segments,xe=le?Gg(Je,nt,w,Oe):em(Je,nt);w.uploadCommonUniforms(w.context,$e,Te.toUnwrapped()),$e.draw(w,ce,P,ee?te:w.stencilModeForClipping(Te),D,yr.disabled,xe,g.id,Ge.layoutVertexBuffer,be,Se,g.paint,w.transform.zoom,Be,void 0)}}function pd(w,h,g,S,P,D,N,$){g.resetLayerRenderingStats(w);const Y=w.context,ee=Y.gl,te=w.transform,le=g.paint.get("fill-extrusion-pattern"),ce=le.constantOr(1),de=g.paint.get("fill-extrusion-opacity"),xe=w.style.enable3dLights(),be=g.paint.get(xe&&!ce?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Se=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),be],Te=g.layout.get("fill-extrusion-edge-radius"),Oe=Te>0&&!g.paint.get("fill-extrusion-rounded-roof"),Ge=Oe?0:Te,Be=te.projection.name==="globe"?a.c_():0,Xe=te.projection.name==="globe",$e=Xe?a.a9(te.zoom):0,tt=[a.am(te.center.lng),a.at(te.center.lat)],Je=g.paint.get("fill-extrusion-flood-light-color").toRenderColor(g.lut).toArray01().slice(0,3),nt=g.paint.get("fill-extrusion-flood-light-intensity"),ht=g.paint.get("fill-extrusion-vertical-scale"),at=g.paint.get("fill-extrusion-line-width").constantOr(1)!==0,st=oc(w,g.paint.get("fill-extrusion-cutoff-fade-range")),wt=[];let zt;Xe&&wt.push("PROJECTION_GLOBE_VIEW"),Se[0]>0&&wt.push("FAUX_AO"),Oe&&wt.push("ZERO_ROOF_RADIUS"),$&&wt.push("HAS_CENTROID"),nt>0&&wt.push("FLOOD_LIGHT"),st.shouldRenderCutoff&&wt.push("RENDER_CUTOFF"),at&&wt.push("RENDER_WALL_MODE");const Zt=w.renderPass==="shadow",Ft=w.shadowRenderer,dn=Zt&&!!Ft;w.shadowRenderer&&(w.shadowRenderer.useNormalOffset=!0);let St=[0,0,0];if(Ft){const fn=w.style.directionalLight,mn=w.style.ambientLight;fn&&mn&&(St=Gp(w.style,fn,mn)),zt=wt.concat(["SHADOWS_SINGLE_CASCADE"])}const $t=dn?"fillExtrusionDepth":ce?"fillExtrusionPattern":"fillExtrusion",Ht=g.getLayerRenderingStats();for(const fn of S){const mn=h.getTile(fn),Yt=mn.getBucket(g);if(!Yt||Yt.projection.name!==te.projection.name)continue;let tn=!1;Ft&&(tn=Ft.getMaxCascadeForTile(fn.toUnwrapped())===0);const tr=w.isTileAffectedByFog(fn),bn=Yt.programConfigurations.get(g.id),Bn=w.getOrCreateProgram($t,{config:bn,defines:tn?zt:wt,overrideFog:tr});if(w.terrain&&w.terrain.setupElevationDraw(mn,Bn,{useMeterToDem:!0}),!Yt.centroidVertexBuffer){const Hi=Bn.attributes.a_centroid_pos;Hi!==void 0&&ee.vertexAttrib2f(Hi,0,0)}!Zt&&Ft&&Ft.setupShadows(mn.tileID.toUnwrapped(),Bn,"vector-tile",mn.tileID.overscaledZ),ce&&(w.context.activeTexture.set(ee.TEXTURE0),mn.imageAtlasTexture&&mn.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),bn.updatePaintBuffers());const xr=le.constantOr(null);if(xr&&mn.imageAtlas){const Hi=mn.imageAtlas.patternPositions[xr.toString()];Hi&&bn.setConstantPatternPositions(Hi)}const Yn=g.paint.get("fill-extrusion-vertical-gradient"),hr=1/Yt.tileToMeter;let Vr;if(Zt&&Ft){if($g(mn.tileID,Yt,w))continue;const Hi=Ft.calculateShadowPassMatrixFromTile(mn.tileID.toUnwrapped());Vr=c_(Hi,Ge,hr,ht)}else{const Hi=w.translatePosMatrix(fn.expandedProjMatrix,mn,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),as=te.projection.createInversionMatrix(te,fn.canonical);Vr=ce?Ug(Hi,w,Yn,de,Se,Ge,hr,fn,mn,Be,$e,tt,as,Je,ht):zg(Hi,w,Yn,de,Se,Ge,hr,fn,Be,$e,tt,as,Je,ht,nt,St)}w.uploadCommonUniforms(Y,Bn,fn.toUnwrapped(),null,st);let kr=Yt.segments;if(te.projection.name==="mercator"&&!Zt&&(kr=Yt.getVisibleSegments(mn.tileID,w.terrain,w.transform.getFrustum(0)),!kr.get().length))continue;if(Ht)if(Zt)for(const Hi of kr.get())Ht.numRenderedVerticesInShadowPass+=Hi.primitiveLength;else for(const Hi of kr.get())Ht.numRenderedVerticesInTransparentPass+=Hi.primitiveLength;const Ri=[];(w.terrain||$)&&Ri.push(Yt.centroidVertexBuffer),Xe&&Ri.push(Yt.layoutVertexExtBuffer),at&&Ri.push(Yt.wallVertexBuffer),Bn.draw(w,Y.gl.TRIANGLES,P,D,N,yr.backCCW,Vr,g.id,Yt.layoutVertexBuffer,Yt.indexBuffer,kr,g.paint,w.transform.zoom,bn,Ri)}w.shadowRenderer&&(w.shadowRenderer.useNormalOffset=!1)}function ho(w,h,g,S,P,D,N,$,Y,ee,te,le,ce,de,xe,be,Se,Te,Oe){const Ge=w.context,Be=Ge.gl,Xe=w.transform,$e=w.transform.zoom,tt=[],Je=oc(w,g.paint.get("fill-extrusion-cutoff-fade-range"));ee==="clear"?(tt.push("CLEAR_SUBPASS"),Oe&&(tt.push("CLEAR_FROM_TEXTURE"),Ge.activeTexture.set(Be.TEXTURE0),Oe.bind(Be.LINEAR,Be.CLAMP_TO_EDGE))):ee==="sdf"&&tt.push("SDF_SUBPASS"),Se&&tt.push("HAS_CENTROID"),Je.shouldRenderCutoff&&tt.push("RENDER_CUTOFF");const nt=g.layout.get("fill-extrusion-edge-radius"),ht=(at,st,wt,zt,Zt)=>{const Ft=st.programConfigurations.get(g.id),dn=w.isTileAffectedByFog(at),St=w.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ft,defines:tt,overrideFog:dn}),$t=((fn,mn,Yt,tn,tr,bn,Bn,xr,Yn,hr,Vr)=>({u_matrix:mn,u_opacity:Yt,u_ao_pass:tn?1:0,u_meter_to_tile:tr,u_ao:bn,u_flood_light_intensity:Bn,u_flood_light_color:xr,u_attenuation:Yn,u_edge_radius:hr,u_fb:0,u_fb_size:Vr,u_dynamic_offset:1}))(0,zt,te,Y,Zt,[le,ce*Zt],de,xe,be,$e>=17?0:nt*Zt,Oe?Oe.size[0]:0),Ht=[];Se&&Ht.push(st.hiddenByLandmarkVertexBuffer),w.uploadCommonUniforms(Ge,St,at.toUnwrapped(),null,Je),St.draw(w,Ge.gl.TRIANGLES,P,D,N,$,$t,g.id,st.vertexBuffer,st.indexBuffer,wt,g.paint,$e,Ft,Ht)};for(const at of S){const st=h.getTile(at),wt=st.getBucket(g);if(!wt||wt.projection.name!==Xe.projection.name||!wt.groundEffect||wt.groundEffect&&!wt.groundEffect.hasData())continue;const zt=wt.groundEffect,Zt=1/wt.tileToMeter;{const Ft=w.translatePosMatrix(at.projMatrix,st,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),dn=zt.getDefaultSegment();ht(at,zt,dn,Ft,Zt)}if(Te)for(let Ft=0;Ft<4;Ft++){const dn=a.c$[Ft](at),St=h.getTile(dn);if(!St)continue;const $t=St.getBucket(g);if(!$t||$t.projection.name!==Xe.projection.name||!$t.groundEffect||$t.groundEffect&&!$t.groundEffect.hasData())continue;const Ht=$t.groundEffect;let fn,mn;Ft===0?(fn=[-a.ab,0,0],mn=1):Ft===1?(fn=[a.ab,0,0],mn=0):Ft===2?(fn=[0,-a.ab,0],mn=3):(fn=[0,a.ab,0],mn=2);const Yt=Ht.regionSegments[mn];if(!Yt)continue;const tn=new Float32Array(16);a.a6.mat4.translate(tn,at.projMatrix,fn),ht(at,Ht,Yt,w.translatePosMatrix(tn,st,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Zt)}}}function uc(w,h,g,S,P,D,N){S.centroidVertexArray.length===0&&S.createCentroidsBuffer();const $=D?D.findDEMTileFor(g):null;if(!($&&$.dem||N))return;const Y=Te=>new a.P(Math.ceil((Te+a.d2)*a.d3),0),ee=Te=>{const Oe=h.getSource().minzoom,Ge=Xe=>{const $e=h.getTileByID(Xe);if($e&&$e.hasData())return $e.getBucket(P)},Be=[0,-1,1];for(const Xe of Be){if(Te.overscaledZ+Xe<Oe)continue;const $e=Ge(Te.calculateScaledKey(Te.overscaledZ+Xe));if($e)return $e}},te=[0,0,0],le=(Te,Oe)=>(te[0]=Math.min(Te.min.y,Oe.min.y),te[1]=Math.max(Te.max.y,Oe.max.y),te[2]=a.ab-Oe.min.x>Te.max.x?Oe.min.x-a.ab:Te.max.x,te),ce=(Te,Oe)=>(te[0]=Math.min(Te.min.x,Oe.min.x),te[1]=Math.max(Te.max.x,Oe.max.x),te[2]=a.ab-Oe.min.y>Te.max.y?Oe.min.y-a.ab:Te.max.y,te),de=[(Te,Oe)=>le(Te,Oe),(Te,Oe)=>le(Oe,Te),(Te,Oe)=>ce(Te,Oe),(Te,Oe)=>ce(Oe,Te)],xe=(Te,Oe,Ge,Be,Xe,$e,tt)=>{if(!D)return 0;const Je=[[$e?Ge:Te,$e?Te:Ge,0],[$e?Ge:Oe,$e?Oe:Ge,0]],nt=tt<0?a.ab+tt:tt,ht=[$e?nt:(Te+Oe)/2,$e?(Te+Oe)/2:nt,0];return Ge===0&&tt<0||Ge!==0&&tt>0?D.getForTilePoints(Xe,[ht],!0,Be):Je.push(ht),D.getForTilePoints(g,Je,!0,$),Math.max(Je[0][2],Je[1][2],ht[2])/D.exaggeration()};for(let Te=0;Te<4;Te++){const Oe=S.borderFeatureIndices[Te];if(Oe.length===0)continue;const Ge=a.c$[Te](g),Be=ee(Ge);if(!(Be&&Be instanceof a.d0)||S.borderDoneWithNeighborZ[Te]===Be.canonical.z)continue;Be.centroidVertexArray.length===0&&Be.createCentroidsBuffer();const Xe=D?D.findDEMTileFor(Ge):null;if(!(Xe&&Xe.dem||N))continue;const $e=(Te<2?1:5)-Te,tt=Be.borderDoneWithNeighborZ[$e]!==S.canonical.z,Je=Be.borderFeatureIndices[$e];let nt=0;if(S.canonical.z!==Be.canonical.z){for(const ht of Oe)S.showCentroid(S.featuresOnBorder[ht]);if(tt)for(const ht of Je)Be.showCentroid(Be.featuresOnBorder[ht]);S.borderDoneWithNeighborZ[Te]=Be.canonical.z,Be.borderDoneWithNeighborZ[$e]=S.canonical.z}for(const ht of Oe){const at=S.featuresOnBorder[ht],st=S.centroidData[at.centroidDataIndex],wt=at.borders[Te];let zt;for(;nt<Je.length;){zt=Be.featuresOnBorder[Je[nt]];const Zt=zt.borders[$e];if(Zt[1]>wt[0]+3||Zt[0]>wt[0]-3)break;Be.showCentroid(zt),nt++}if(zt&&nt<Je.length){const Zt=nt;let Ft=0;for(;!(zt.borders[$e][0]>wt[1]-3)&&(Ft++,++nt!==Je.length);)zt=Be.featuresOnBorder[Je[nt]];zt=Be.featuresOnBorder[Je[Zt]];let dn=!1;if(Ft>=1){const Ht=zt.borders[$e];Math.abs(wt[0]-Ht[0])<3&&Math.abs(wt[1]-Ht[1])<3&&(Ft=1,dn=!0,nt=Zt+1)}else if(Ft===0){S.showCentroid(at);continue}const St=Be.centroidData[zt.centroidDataIndex];N&&dn&&(((be=st).flags|(Se=St).flags)&a.d1?(be.flags|=a.d1,Se.flags|=a.d1):(be.flags&=~a.d1,Se.flags&=~a.d1));const $t=at.intersectsCount()>1||zt.intersectsCount()>1;if(Ft>1)nt=Zt,st.centroidXY=St.centroidXY=new a.P(0,0);else if(Xe&&Xe.dem&&!$t){const Ht=de[Te](st,St),fn=Te%2?a.ab-1:0,mn=xe(Ht[0],Math.min(a.ab-1,Ht[1]),fn,Xe,Ge,Te<2,Ht[2]);st.centroidXY=St.centroidXY=Y(mn)}else $t?st.centroidXY=St.centroidXY=new a.P(0,0):(st.centroidXY=S.encodeBorderCentroid(at),St.centroidXY=Be.encodeBorderCentroid(zt));S.writeCentroidToBuffer(st),Be.writeCentroidToBuffer(St)}else S.showCentroid(at)}S.borderDoneWithNeighborZ[Te]=Be.canonical.z,Be.borderDoneWithNeighborZ[$e]=S.canonical.z}var be,Se;(S.needsCentroidUpdate||!S.centroidVertexBuffer&&S.centroidVertexArray.length!==0)&&S.uploadCentroid(w)}const Kx=[1,0,0],p_=[0,1,0],Wg=[0,0,1];function $g(w,h,g){const S=g.transform,P=g.shadowRenderer;if(!P)return!0;const D=w.toUnwrapped(),N=S.tileSize*P._cascades[g.currentShadowCascade].scale;let $=h.maxHeight;if(S.elevation){const be=S.elevation.getMinMaxForTile(w);be&&($+=be.max)}const Y=[...P.shadowDirection];Y[2]=-Y[2];const ee=P.computeSimplifiedTileShadowVolume(D,$,N,Y);if(!ee)return!1;const te=[Kx,p_,Wg,Y,[Y[0],0,Y[2]],[0,Y[1],Y[2]]],le=S.projection.name==="globe",ce=S.scaleZoom(N),de=a.bN.fromInvProjectionMatrix(S.invProjMatrix,S.worldSize,ce,!le),xe=P.getCurrentCascadeFrustum();return de.intersectsPrecise(ee.vertices,ee.planes,te)===0||xe.intersectsPrecise(ee.vertices,ee.planes,te)===0}function Xg(w){return[w[0]*a.d4,w[1]*a.d4,w[2]*a.d4,0]}function Ua(w,h,g,S,P,D,N,$,Y){const ee=S.getSource(),te=g.globeSharedBuffers;if(!te)return;let le,ce,de;if(h&&(le=S.getTile(h)),ee instanceof a.aD?(ce=ee.texture,de=a.cD(0,0,g.transform)):le&&h&&(ce=le.texture,de=a.cD(h.canonical.z,h.canonical.x,g.transform)),!ce||!de)return;w||(de=a.a6.mat4.scale(a.a6.mat4.create(),de,[1,-1,1]));const xe=g.context,be=xe.gl,Se=P.paint.get("raster-resampling")==="nearest"?be.NEAREST:be.LINEAR,Te=g.colorModeForDrapableLayerRenderPass(D),Oe=N.defines;Oe.push("GLOBE_POLES");const Ge=new qn(be.LEQUAL,qn.ReadWrite,g.depthRangeFor3D),Be=Float32Array.from(g.transform.expandedFarZProjMatrix),Xe=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0))));g.terrain&&g.terrain.prepareDrawTile(),xe.activeTexture.set(be.TEXTURE0),ce.bind(Se,be.CLAMP_TO_EDGE),xe.activeTexture.set(be.TEXTURE1),ce.bind(Se,be.CLAMP_TO_EDGE),ce.useMipmap&&xe.extTextureFilterAnisotropic&&g.transform.pitch>20&&be.texParameterf(be.TEXTURE_2D,xe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,xe.extTextureFilterAnisotropicMax);const[$e,tt,Je,nt]=h?te.getPoleBuffers(h.canonical.z,!1):te.getPoleBuffers(0,!0),ht=P.paint.get("raster-elevation");let at;w?(at=$e,g.renderDefaultNorthPole=ht!==0):(at=tt,g.renderDefaultSouthPole=ht!==0);const st=Xg(N.mix),wt=((Zt,Ft,dn,St,$t,Ht,fn,mn,Yt,tn,tr,bn,Bn)=>Pf(Zt,Ft,dn,new Float32Array(16),new Float32Array(9),[0,0],St,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ht,[0,0],mn,2,tn,tr,bn,1,0,Bn))(Be,Xe,de,a.a9(g.transform.zoom),0,P,0,ht,0,st,N.offset,N.range,D),zt=g.getOrCreateProgram("raster",{defines:Oe});g.uploadCommonUniforms(xe,zt,null),zt.draw(g,be.TRIANGLES,Ge,Y,Te,$,wt,P.id,at,Je,nt)}function gs(w){const h=w._nearZ,g=w.projection.farthestPixelDistance(w),S=g-h,P=.2*w.height,D=h+P;return[h,g,(D-P-h)/S,(D-h)/S]}function md(w,h,g,S){if(w)return h instanceof Ir&&w instanceof gg?h.getTextureDescriptor(w,g,!0):{texture:w.texture,mix:Xg(S.mix),offset:S.offset,buffer:0,tileSize:1}}var Of=a.d5([{name:"a_index",type:"Int16",components:1}]);class am{constructor(h,g,S,P){const D={width:S[0],height:S[1],data:null},N=h.gl;this.targetColorTexture=new a.T(h,D,N.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(h,D,N.RGBA8,{useMipmap:!1}),this.context=h,this.updateParticleTexture(g,P),this.lastInvalidatedAt=0}updateParticleTexture(h,g){if(this.particleTextureDimension===g.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const S=this.context.gl,P=g.width*g.height;this.particleTexture0=new a.T(this.context,g,S.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,g,S.RGBA8,{premultiply:!1,useMipmap:!1});const D=new a.d6;D.reserve(P);for(let N=0;N<P;N++)D.emplaceBack(N);this.particleIndexBuffer=this.context.createVertexBuffer(D,Of.members,!0),this.particleSegment=a.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=g.width}update(h){return!(this.lastInvalidatedAt<h&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function lm(w,h,g){if(!w)return null;const S=h.getTextureDescriptor(w,g,!0);if(!S)return null;let{texture:P,mix:D,offset:N,tileSize:$,buffer:Y,format:ee}=S;if(!P||!ee)return null;let te=!1;return ee==="uint32"&&(te=!0,D[3]=0,D=nm(a.d7,D,[0,g.paint.get("raster-particle-max-speed")]),N=If(a.d7,N,[0,g.paint.get("raster-particle-max-speed")])),{texture:P,textureOffset:[Y/($+2*Y),$/($+2*Y)],tileSize:$,scalarData:te,scale:D,offset:N,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[ee]]}}function Ff(w){const h=w._nearZ,g=w.projection.farthestPixelDistance(w),S=g-h,P=.2*w.height,D=h+P;return[h,g,(D-P-h)/S,(D-h)/S]}const m_=new a.bz(1,0,0,1),rh=new a.bz(0,1,0,1),ih=new a.bz(0,0,1,1),vn=new a.bz(1,0,1,1),Jn=new a.bz(0,1,1,1);function hc(w,h,g,S,P,D,N){const $=w.context,Y=w.transform,ee=$.gl,te=Y.projection.name==="globe",le=te?["PROJECTION_GLOBE_VIEW"]:[];let ce=a.a6.mat4.clone(g.projMatrix);if(te&&a.a9(Y.zoom)>0){const st=a.b4(g.canonical,Y),wt=a.d8(st);ce=a.a6.mat4.multiply(new Float32Array(16),Y.globeMatrix,wt),a.a6.mat4.multiply(ce,Y.projMatrix,ce)}const de=a.a6.mat4.create();de[12]+=2*P/(a.q.devicePixelRatio*Y.width),de[13]+=2*D/(a.q.devicePixelRatio*Y.height),a.a6.mat4.multiply(ce,de,ce);const xe=w.getOrCreateProgram("debug",{defines:le}),be=h.getTileByID(g.key);w.terrain&&w.terrain.setupElevationDraw(be,xe);const Se=qn.disabled,Te=mr.disabled,Oe=w.colorModeForRenderPass(),Ge="$debug";$.activeTexture.set(ee.TEXTURE0),w.emptyTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),te?be._makeGlobeTileDebugBuffers(w.context,Y):be._makeDebugTileBoundsBuffers(w.context,Y.projection);const Be=be._tileDebugBuffer||w.debugBuffer,Xe=be._tileDebugIndexBuffer||w.debugIndexBuffer,$e=be._tileDebugSegments||w.debugSegments;if(xe.draw(w,ee.LINE_STRIP,Se,Te,Oe,yr.disabled,h_(ce,S),Ge,Be,Xe,$e,null,null,null,[be._globeTileDebugBorderBuffer]),N){const st=be.latestRawTileData,wt=Math.floor((st&&st.byteLength||0)/1024);let zt=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(zt+=` => ${g.overscaledZ}`),zt+=` ${be.state}`,zt+=` ${wt}kb`,function(Zt,Ft){Zt.initDebugOverlayCanvas();const dn=Zt.debugOverlayCanvas,St=Zt.context.gl,$t=Zt.debugOverlayCanvas.getContext("2d");$t.clearRect(0,0,dn.width,dn.height),$t.shadowColor="white",$t.shadowBlur=2,$t.lineWidth=1.5,$t.strokeStyle="white",$t.textBaseline="top",$t.font="bold 36px Open Sans, sans-serif",$t.fillText(Ft,5,5),$t.strokeText(Ft,5,5),Zt.debugOverlayTexture.update(dn),Zt.debugOverlayTexture.bind(St.LINEAR,St.CLAMP_TO_EDGE)}(w,zt)}const tt=h.getTile(g).tileSize,Je=512/Math.min(tt,512)*(g.overscaledZ/Y.zoom)*.5,nt=be._tileDebugTextBuffer||w.debugBuffer,ht=be._tileDebugTextIndexBuffer||w.quadTriangleIndexBuffer,at=be._tileDebugTextSegments||w.debugSegments;xe.draw(w,ee.TRIANGLES,Se,Te,Cr.alphaBlended,yr.disabled,h_(ce,a.bz.transparent,Je),Ge,nt,ht,at,null,null,null,[be._globeTileDebugTextBuffer])}function qi(w,h,g,S){Fs(w,0,h+g/2,w.transform.width,g,S)}function Tt(w,h,g,S){Fs(w,h-g/2,0,g,w.transform.height,S)}function Fs(w,h,g,S,P,D){const N=w.context,$=N.gl;$.enable($.SCISSOR_TEST),$.scissor(h*a.q.devicePixelRatio,g*a.q.devicePixelRatio,S*a.q.devicePixelRatio,P*a.q.devicePixelRatio),N.clear({color:D}),$.disable($.SCISSOR_TEST)}const mi=a.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:eo}=mi;function os(w,h,g,S){w.emplaceBack(h,g,S)}class Fo{constructor(h){this.vertexArray=new a.d9,this.indices=new a.aO,os(this.vertexArray,-1,-1,1),os(this.vertexArray,1,-1,1),os(this.vertexArray,-1,1,1),os(this.vertexArray,1,1,1),os(this.vertexArray,-1,-1,-1),os(this.vertexArray,1,-1,-1),os(this.vertexArray,-1,1,-1),os(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,eo),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=a.b1.simpleSegment(0,0,36,12)}}function No(w,h,g,S,P,D){const N=w.context.gl,$=h.paint.get("sky-atmosphere-color"),Y=h.paint.get("sky-atmosphere-halo-color"),ee=h.paint.get("sky-atmosphere-sun-intensity"),te=((le,ce,de,xe,be)=>({u_matrix_3f:le,u_sun_direction:ce,u_sun_intensity:de,u_color_tint_r:[xe.r,xe.g,xe.b,xe.a],u_color_tint_m:[be.r,be.g,be.b,be.a],u_luminance:5e-5}))(a.a6.mat3.fromMat4(a.a6.mat3.create(),S),P,ee,$,Y);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+D,h.skyboxTexture,0),g.draw(w,N.TRIANGLES,qn.disabled,mr.disabled,Cr.unblended,yr.frontCW,te,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const dc=a.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class zo{constructor(h){const g=new a.da;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const S=new a.aO;S.emplaceBack(0,1,2),S.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(g,dc.members),this.indexBuffer=h.createIndexBuffer(S),this.segments=a.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const cm=a.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class gd{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class vd{constructor(h){this.colorModeAlphaBlendedWriteRGB=new Cr([1,ba,1,ba],a.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Cr([1,0,1,0],a.bz.transparent,[!1,!1,!1,!0]),this.params=new gd,this.updateNeeded=!0,h.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),h.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),h.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),h.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(h){const g=h.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new zo(g);const S=this.params.sizeRange,P=this.params.intensityRange,D=function(te){const le=a.dd(30),ce=[];for(let de=0;de<te;++de){const xe=2*Math.PI*le(),be=Math.acos(1-2*le())-.5*Math.PI;ce.push(a.a6.vec3.fromValues(Math.cos(be)*Math.cos(xe),Math.cos(be)*Math.sin(xe),Math.sin(be)))}return ce}(this.params.starsCount),N=a.dd(300),$=new a.db,Y=new a.aO;let ee=0;for(let te=0;te<D.length;++te){const le=a.a6.vec3.scale([],D[te],200),ce=Math.max(0,1+.01*S*(1*N()-.5)),de=Math.max(0,1+.01*P*(1*N()-.5));$.emplaceBack(le[0],le[1],le[2],-1,-1,ce,de),$.emplaceBack(le[0],le[1],le[2],1,-1,ce,de),$.emplaceBack(le[0],le[1],le[2],1,1,ce,de),$.emplaceBack(le[0],le[1],le[2],-1,1,ce,de),Y.emplaceBack(ee+0,ee+1,ee+2),Y.emplaceBack(ee+0,ee+2,ee+3),ee+=4}this.starsVx=g.createVertexBuffer($,cm.members),this.starsIdx=g.createIndexBuffer(Y),this.starsSegments=a.b1.simpleSegment(0,0,$.length,Y.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(h,g){const S=h.context,P=S.gl,D=h.transform,N=new qn(P.LEQUAL,qn.ReadOnly,[0,1]),$=a.a9(D.zoom),Y=h.style.getLut(g.scope),ee=g.properties.get("color").toRenderColor(Y).toArray01(),te=g.properties.get("high-color").toRenderColor(Y).toArray01(),le=g.properties.get("space-color").toRenderColor(Y).toArray01PremultipliedAlpha(),ce=5e-4,de=a.dc(g.properties.get("horizon-blend"),0,1,ce,.25),xe=a.cx(h,S,D)&&de===ce?D.worldSize/(2*Math.PI*1.025)-1:D.globeRadius,be=h.frameCounter/1e3%1,Se=a.a6.vec3.length(D.globeCenterInViewSpace),Te=Math.sqrt(Math.pow(Se,2)-Math.pow(xe,2)),Oe=Math.acos(Te/Se),Ge=Be=>{const Xe=D.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Be&&Xe.push("ALPHA_PASS");const $e=h.getOrCreateProgram("globeAtmosphere",{defines:Xe}),tt=((nt,ht,at,st,wt,zt,Zt,Ft,dn,St,$t,Ht)=>({u_frustum_tl:nt,u_frustum_tr:ht,u_frustum_br:at,u_frustum_bl:st,u_horizon:wt,u_transition:zt,u_fadeout_range:Zt,u_color:Ft,u_high_color:dn,u_space_color:St,u_temporal_offset:$t,u_horizon_angle:Ht}))(D.frustumCorners.TL,D.frustumCorners.TR,D.frustumCorners.BR,D.frustumCorners.BL,D.frustumCorners.horizon,$,de,ee,te,le,be,Oe);h.uploadCommonUniforms(S,$e);const Je=this.atmosphereBuffer;Je&&$e.draw(h,P.TRIANGLES,N,mr.disabled,Be?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,yr.backCW,tt,Be?"atmosphere_glow_alpha":"atmosphere_glow",Je.vertexBuffer,Je.indexBuffer,Je.segments)};Ge(!1),Ge(!0)}drawStars(h,g){const S=a.ap(g.properties.get("star-intensity"),0,1);if(S===0)return;const P=h.context,D=P.gl,N=h.transform,$=h.getOrCreateProgram("stars"),Y=a.a6.quat.identity([]);a.a6.quat.rotateX(Y,Y,-N._pitch),a.a6.quat.rotateZ(Y,Y,-N.angle),a.a6.quat.rotateX(Y,Y,a.bB(N._center.lat)),a.a6.quat.rotateY(Y,Y,-a.bB(N._center.lng));const ee=a.a6.mat4.fromQuat(new Float32Array(16),Y),te=a.a6.mat4.multiply([],N.starsProjMatrix,ee),le=a.a6.mat3.fromMat4([],ee),ce=a.a6.mat3.invert([],le),de=[0,1,0];a.a6.vec3.transformMat3(de,de,ce),a.a6.vec3.scale(de,de,this.params.sizeMultiplier);const xe=[1,0,0];a.a6.vec3.transformMat3(xe,xe,ce),a.a6.vec3.scale(xe,xe,this.params.sizeMultiplier);const be=(Se=de,Te=xe,Oe=S,{u_matrix:Float32Array.from(te),u_up:Se,u_right:Te,u_intensity_multiplier:Oe});var Se,Te,Oe;h.uploadCommonUniforms(P,$),this.starsVx&&this.starsIdx&&$.draw(h,D.TRIANGLES,qn.disabled,mr.disabled,this.colorModeAlphaBlendedWriteRGB,yr.disabled,be,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Nf(w,h){const g=[...w],S=h.cameraWorldSizeForFog/h.worldSize,P=a.a6.mat4.identity([]);return a.a6.mat4.scale(P,P,[S,S,1]),a.a6.mat4.multiply(g,P,g),a.a6.mat4.multiply(g,h.worldToFogMatrix,g),g}function sh(w,h,g,S,P){const D=g.material,N=S.context,{baseColorTexture:$,metallicRoughnessTexture:Y}=D.pbrMetallicRoughness,{normalTexture:ee,occlusionTexture:te,emissionTexture:le}=D;function ce(de,xe,be){if(de&&(w.push(xe),N.activeTexture.set(N.gl.TEXTURE0+be),de.gfxTexture)){const{minFilter:Se,magFilter:Te,wrapS:Oe,wrapT:Ge}=de.sampler;de.gfxTexture.bindExtraParam(Se,Te,Oe,Ge)}}ce($,"HAS_TEXTURE_u_baseColorTexture",uo.BaseColor),ce(Y,"HAS_TEXTURE_u_metallicRoughnessTexture",uo.MetallicRoughness),ce(ee,"HAS_TEXTURE_u_normalTexture",uo.Normal),ce(te,"HAS_TEXTURE_u_occlusionTexture",uo.Occlusion),ce(le,"HAS_TEXTURE_u_emissionTexture",uo.Emission),P&&(P.texture||(P.texture=new a.df(S.context,P.image,[P.image.height,P.image.height,P.image.height],N.gl.RGBA8)),N.activeTexture.set(N.gl.TEXTURE0+uo.LUT),P.texture&&P.texture.bind(N.gl.LINEAR,N.gl.CLAMP_TO_EDGE),w.push("APPLY_LUT_ON_GPU")),g.texcoordBuffer&&(w.push("HAS_ATTRIBUTE_a_uv_2f"),h.push(g.texcoordBuffer)),g.colorBuffer&&(w.push(g.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),h.push(g.colorBuffer)),g.normalBuffer&&(w.push("HAS_ATTRIBUTE_a_normal_3f"),h.push(g.normalBuffer)),g.pbrBuffer&&(w.push("HAS_ATTRIBUTE_a_pbr"),w.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),h.push(g.pbrBuffer)),D.alphaMode!=="OPAQUE"&&D.alphaMode!=="MASK"||w.push("UNPREMULT_TEXTURE_IN_SHADER"),D.defined||w.push("DIFFUSE_SHADED"),w.push("USE_STANDARD_DERIVATIVES")}function Qo(w,h,g,S,P,D){const N=g.paint.get("model-opacity"),$=h.context,Y=new qn(h.context.gl.LEQUAL,qn.ReadWrite,h.depthRangeFor3D),ee=h.transform,te=w.mesh,le=te.material,ce=le.pbrMetallicRoughness,de=h.style.fog;let xe;xe=h.transform.projection.zAxisUnit==="pixels"?[...w.nodeModelMatrix]:a.a6.mat4.multiply([],S.zScaleMatrix,w.nodeModelMatrix),a.a6.mat4.multiply(xe,S.negCameraPosMatrix,xe);const be=a.a6.mat4.invert([],xe);a.a6.mat4.transpose(be,be);const Se=g.paint.get("model-emissive-strength").constantOr(0),Te=Nn(new Float32Array(w.worldViewProjection),new Float32Array(xe),new Float32Array(be),null,h,N,ce.baseColorFactor.toRenderColor(null),le.emissiveFactor,ce.metallicFactor,ce.roughnessFactor,le,Se,g),Oe={defines:[]},Ge=[];sh(Oe.defines,Ge,te,h,g.lut);const Be=h.shadowRenderer;Be&&(Be.useNormalOffset=!1);let Xe=null;if(de){const Je=Nf(w.nodeModelMatrix,h.transform);if(Xe=new Float32Array(Je),ee.projection.name!=="globe"){const nt=te.aabb.min,ht=te.aabb.max,[at,st]=de.getOpacityForBounds(Je,nt[0],nt[1],ht[0],ht[1]);Oe.overrideFog=at>=Cn||st>=Cn}}const $e=oc(h,g.paint.get("model-cutoff-fade-range"));$e.shouldRenderCutoff&&Oe.defines.push("RENDER_CUTOFF");const tt=h.getOrCreateProgram("model",Oe);h.uploadCommonUniforms($,tt,null,Xe,$e),h.renderPass!=="shadow"&&Be&&Be.setupShadowsFromMatrix(w.nodeModelMatrix,tt),tt.draw(h,$.gl.TRIANGLES,Y,P,D,te.material.doubleSided?yr.disabled:yr.backCCW,Te,g.id,te.vertexBuffer,te.indexBuffer,te.segments,g.paint,h.transform.zoom,void 0,Ge)}function _d(w,h,g,S,P,D,N){let $;$=w.projection.name==="globe"?a.dg(g,w):[...g],a.a6.mat4.multiply($,$,h.matrix);const Y=a.a6.mat4.multiply([],S,$);if(h.meshes)for(const ee of h.meshes){if(ee.material.alphaMode!=="BLEND"){N.push({mesh:ee,depth:0,modelIndex:P,worldViewProjection:Y,nodeModelMatrix:$});continue}const te=a.a6.vec3.transformMat4([],ee.centroid,Y);te[2]>0&&D.push({mesh:ee,depth:te[2],modelIndex:P,worldViewProjection:Y,nodeModelMatrix:$})}if(h.children)for(const ee of h.children)_d(w,ee,g,S,P,D,N)}function oh(w,h,g,S){const P=g.shadowRenderer;if(!P)return;const D=P.getShadowPassDepthMode(),N=P.getShadowPassColorMode(),$=P.calculateShadowPassMatrixFromMatrix(h),Y=or($);g.getOrCreateProgram("modelDepth",{defines:g._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(g,g.context.gl.TRIANGLES,D,mr.disabled,N,yr.backCCW,Y,S.id,w.vertexBuffer,w.indexBuffer,w.segments,S.paint,g.transform.zoom,void 0,void 0)}function yd(w,h,g){const S=h.updateZoomBasedPaintProperties(),P=function(D,N,$){let Y,ee,te,le=D.terrain?D.terrain.exaggeration():0;if(D.terrain&&le>0){const ce=D.terrain,de=ce.findDEMTileFor($);de&&de.dem?Y=a.di.create(ce,$,de):le=0}if(le===0&&(N.terrainElevationMin=0,N.terrainElevationMax=0),le===N.validForExaggeration&&(le===0||Y&&Y._demTile&&Y._demTile.tileID===N.validForDEMTile.id&&Y._dem._timestamp===N.validForDEMTile.timestamp))return!1;for(const ce in N.instancesPerModel){const de=N.instancesPerModel[ce];for(let xe=0;xe<de.instancedDataArray.length;++xe){const be=(Y?le*Y.getElevationAt(0|de.instancedDataArray.float32[16*xe],0|de.instancedDataArray.float32[16*xe+1],!0,!0):0)+de.instancesEvaluatedElevation[xe];de.instancedDataArray.float32[16*xe+6]=be,ee=ee?Math.min(N.terrainElevationMin,be):be,te=te?Math.max(N.terrainElevationMax,be):be}}return N.terrainElevationMin=ee||0,N.terrainElevationMax=te||0,N.validForExaggeration=le,N.validForDEMTile=Y&&Y._demTile?{id:Y._demTile.tileID,timestamp:Y._dem._timestamp}:{id:void 0,timestamp:0},!0}(w,h,g);(S||P)&&(h.uploaded=!1,h.upload(w.context))}const tl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.c9([0,0,0],[a.ab,a.ab,0])};function g_(w,h){const g=1<<w.canonical.z,S=h.getFreeCameraOptions().position,P=h.elevation,D=w.canonical.x/g,N=(w.canonical.x+1)/g,$=w.canonical.y/g,Y=(w.canonical.y+1)/g;let ee=h._centerAltitude;if(P){const de=P.getMinMaxForTile(w);de&&de.max>ee&&(ee=de.max)}const te=a.ap(S.x,D,N)-S.x,le=a.ap(S.y,$,Y)-S.y,ce=a.bD(ee,h.center.lat)-S.z;return h._zoomFromMercatorZ(Math.sqrt(te*te+le*le+ce*ce))}function $s(w,h,g,S,P,D,N){const $=w.context,Y=w.renderPass==="shadow",ee=w.shadowRenderer,te=Y&&ee?ee.getShadowPassDepthMode():new qn($.gl.LEQUAL,qn.ReadWrite,w.depthRangeFor3D),le=w.isTileAffectedByFog(D);if(g.meshes)for(const ce of g.meshes){const de=["MODEL_POSITION_ON_GPU"],xe=[];let be,Se,Te;S.instancedDataArray.length>20&&de.push("INSTANCED_ARRAYS");const Oe=oc(w,h.paint.get("model-cutoff-fade-range"));if(Oe.shouldRenderCutoff&&de.push("RENDER_CUTOFF"),Y&&ee)be=w.getOrCreateProgram("modelDepth",{defines:de}),Se=or(N.shadowTileMatrix,N.shadowTileMatrix,Float32Array.from(g.matrix)),Te=ee.getShadowPassColorMode();else{sh(de,xe,ce,w,h.lut),be=w.getOrCreateProgram("model",{defines:de,overrideFog:le});const Be=ce.material,Xe=Be.pbrMetallicRoughness,$e=h.paint.get("model-opacity"),tt=h.paint.get("model-emissive-strength").constantOr(0);Se=Nn(D.expandedProjMatrix,Float32Array.from(g.matrix),new Float32Array(16),null,w,$e,Xe.baseColorFactor.toRenderColor(null),Be.emissiveFactor,Xe.metallicFactor,Xe.roughnessFactor,Be,tt,h,P),ee&&(N.shadowUniformsInitialized?be.setShadowUniformValues($,ee.getShadowUniformValues()):(ee.setupShadows(D.toUnwrapped(),be,"model-tile",D.overscaledZ),N.shadowUniformsInitialized=!0)),Te=Oe.shouldRenderCutoff||$e<1||Be.alphaMode!=="OPAQUE"?Cr.alphaBlended:Cr.unblended}w.uploadCommonUniforms($,be,D.toUnwrapped(),null,Oe);const Ge=ce.material.doubleSided?yr.disabled:yr.backCCW;if(S.instancedDataArray.length>20)xe.push(S.instancedDataBuffer),be.draw(w,$.gl.TRIANGLES,te,mr.disabled,Te,Ge,Se,h.id,ce.vertexBuffer,ce.indexBuffer,ce.segments,h.paint,w.transform.zoom,void 0,xe,S.instancedDataArray.length);else{const Be=Y?"u_instance":"u_normal_matrix";for(let Xe=0;Xe<S.instancedDataArray.length;++Xe)Se[Be]=new Float32Array(S.instancedDataArray.arrayBuffer,64*Xe,16),be.draw(w,$.gl.TRIANGLES,te,mr.disabled,Te,Ge,Se,h.id,ce.vertexBuffer,ce.indexBuffer,ce.segments,h.paint,w.transform.zoom,void 0,xe)}}if(g.children)for(const ce of g.children)$s(w,h,ce,S,P,D,N)}const qg=[1,-1,1];function Bl(w,h,g,S){if(!g.modelManager)return!0;const P=g.modelManager;if(!g.shadowRenderer)return!0;const D=g.shadowRenderer,N=h.aabb;let $=!0,Y=w.maxHeight;if(Y===0){let te=0;for(const le in w.instancesPerModel){const ce=P.getModel(le,S);ce?te=Math.max(te,Math.max(Math.max(ce.aabb.max[0],ce.aabb.max[1]),ce.aabb.max[2])):$=!1}Y=w.maxScale*te*1.41+w.maxVerticalOffset,$&&(w.maxHeight=Y)}N.max[2]=Y,N.min[2]+=w.terrainElevationMin,N.max[2]+=w.terrainElevationMax,a.a6.vec3.transformMat4(N.min,N.min,h.tileMatrix),a.a6.vec3.transformMat4(N.max,N.max,h.tileMatrix);const ee=N.intersects(D.getCurrentCascadeFrustum());return g.currentShadowCascade===0&&(w.isInsideFirstShadowMapFrustum=ee===2),ee===0}function Ui(w,h){const g=w.uniformValues.u_cutoff_params[0],S=w.uniformValues.u_cutoff_params[1],P=w.uniformValues.u_cutoff_params[2],D=w.uniformValues.u_cutoff_params[3];return S===g||D===P?1:a.ap(((h-g)/(S-g)-P)/(D-P),0,1)}function ti(w,h,g,S){if(h.pitch<20)return 1;const P=h.getWorldToCameraMatrix();a.a6.mat4.multiply(P,P,w);const D=a.a6.vec4.fromValues(g.min[0],g.min[1],g.min[2],1);let N=a.a6.vec4.transformMat4(a.a6.vec4.create(),D,P),$=N,Y=N;D[1]=g.max[1],N=a.a6.vec4.transformMat4(a.a6.vec4.create(),D,P),$=N[1]<$[1]?N:$,Y=N[1]>Y[1]?N:Y,D[0]=g.max[0],N=a.a6.vec4.transformMat4(a.a6.vec4.create(),D,P),$=N[1]<$[1]?N:$,Y=N[1]>Y[1]?N:Y,D[1]=g.min[1],N=a.a6.vec4.transformMat4(a.a6.vec4.create(),D,P),$=N[1]<$[1]?N:$,Y=N[1]>Y[1]?N:Y;const ee=a.ap(S[0],0,1),te=100*h.pixelsPerMeter*a.ap(S[1],0,1),le=a.ap(S[2],0,1),ce=a.a6.vec4.lerp(a.a6.vec4.create(),$,Y,ee),de=Math.tan(.5*h.fovX),xe=-ce[2]*de;if(te===0)return ce[1]<-Math.abs(xe)?le:1;const be=(-Math.abs(xe)-ce[1])/te,Se=(Oe,Ge,Be)=>(1-Be)*Oe+Be*Ge,Te=a.ap(Se(1,le,be),le,1);return Se(1,Te,a.ap((h.pitch-20)/20,0,1))}class Yg{}class fc{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(h,g,S){{const le=this._storage.get(g.id);if(le)return le.lastUsedFrameIdx=h,le.buf}const P=S.gl,D=P.getBufferParameter(P.ELEMENT_ARRAY_BUFFER,P.BUFFER_SIZE),N=new ArrayBuffer(D),$=new Int16Array(N);P.getBufferSubData(P.ELEMENT_ARRAY_BUFFER,0,new Int16Array(N));const Y=new a.dk;for(let le=0;le<D/2;le+=3){const ce=$[le],de=$[le+1],xe=$[le+2];Y.emplaceBack(ce,de),Y.emplaceBack(de,xe),Y.emplaceBack(xe,ce)}const ee=S.bindVertexArrayOES.current,te=new Yg;return te.buf=new wa(S,Y),te.lastUsedFrameIdx=h,this._storage.set(g.id,te),S.bindVertexArrayOES.set(ee),te.buf}update(h){for(const[g,S]of this._storage)h-S.lastUsedFrameIdx>30&&(S.buf.destroy(),this._storage.delete(g))}destroy(){for(const[h,g]of this._storage)g.buf.destroy(),this._storage.delete(h)}}class xd{constructor(h){this.occluderSize=30,this.depthOffset=-1e-4,h.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),h.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const to={symbol:function(w,h,g,S,P){if(w.renderPass!=="translucent")return;const D=mr.disabled,N=w.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(ee,te,le,ce,de,xe,be){const Se=te.transform,Te=de==="map",Oe=xe==="map";for(const Ge of ee){const Be=ce.getTile(Ge),Xe=Be.getBucket(le);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const $e=a.bj(Xe.textSizeData,Se.zoom),tt=Uc(Ge,Xe.getProjection(),Se),Je=Se.calculatePixelsToTileUnitsMatrix(Be),nt=ni(tt,Be.tileID.canonical,Oe,Te,Se,Xe.getProjection(),Je),ht=Xe.hasIconTextFit()&&Xe.hasIconData();if($e){const at=Math.pow(2,Se.zoom-Be.tileID.overscaledZ);Zx(Xe,Te,Oe,be,a.cS,Se,nt,Ge,at,$e,ht)}}}(S,w,g,h,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),P);const $=g.paint.get("icon-opacity").constantOr(1)!==0,Y=g.paint.get("text-opacity").constantOr(1)!==0;g.layout.get("symbol-sort-key").constantOr(1)!==void 0&&($||Y)?Bf(w,h,g,S,D,N):($&&Bf(w,h,g,S,D,N,{onlyIcons:!0}),Y&&Bf(w,h,g,S,D,N,{onlyText:!0})),h.map.showCollisionBoxes&&(om(w,h,g,S,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),om(w,h,g,S,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(w,h,g,S){if(w.renderPass!=="translucent")return;const P=g.paint.get("circle-opacity"),D=g.paint.get("circle-stroke-width"),N=g.paint.get("circle-stroke-opacity"),$=g.layout.get("circle-sort-key").constantOr(1)!==void 0,Y=g.paint.get("circle-emissive-strength");if(P.constantOr(1)===0&&(D.constantOr(1)===0||N.constantOr(1)===0))return;const ee=w.context,te=ee.gl,le=w.transform,ce=w.depthModeForSublayer(0,qn.ReadOnly),de=mr.disabled,xe=w.colorModeForDrapableLayerRenderPass(Y),be=le.projection.name==="globe",Se=[a.am(le.center.lng),a.at(le.center.lat)],Te=[];for(let Ge=0;Ge<S.length;Ge++){const Be=S[Ge],Xe=h.getTile(Be),$e=Xe.getBucket(g);if(!$e||$e.projection.name!==le.projection.name)continue;const tt=$e.programConfigurations.get(g.id),Je=a.cT(g),nt=w.isTileAffectedByFog(Be);be&&Je.push("PROJECTION_GLOBE_VIEW"),Je.push("DEPTH_D24"),w.terrain&&le.depthOcclusionForSymbolsAndCircles&&Je.push("DEPTH_OCCLUSION");const ht=w.getOrCreateProgram("circle",{config:tt,defines:Je,overrideFog:nt}),at=$e.layoutVertexBuffer,st=$e.globeExtVertexBuffer,wt=$e.indexBuffer,zt=le.projection.createInversionMatrix(le,Be.canonical),Zt={programConfiguration:tt,program:ht,layoutVertexBuffer:at,globeExtVertexBuffer:st,indexBuffer:wt,uniformValues:a.cU(w,Be,Xe,zt,Se,g),tile:Xe};if($){const Ft=$e.segments.get();for(const dn of Ft)Te.push({segments:new a.b1([dn]),sortKey:dn.sortKey,state:Zt})}else Te.push({segments:$e.segments,sortKey:0,state:Zt})}$&&Te.sort((Ge,Be)=>Ge.sortKey-Be.sortKey);const Oe={useDepthForOcclusion:le.depthOcclusionForSymbolsAndCircles};for(const Ge of Te){const{programConfiguration:Be,program:Xe,layoutVertexBuffer:$e,globeExtVertexBuffer:tt,indexBuffer:Je,uniformValues:nt,tile:ht}=Ge.state,at=Ge.segments;w.terrain&&w.terrain.setupElevationDraw(ht,Xe,Oe),w.uploadCommonUniforms(ee,Xe,ht.tileID.toUnwrapped()),Xe.draw(w,te.TRIANGLES,ce,de,xe,yr.disabled,nt,g.id,$e,Je,at,g.paint,le.zoom,Be,[tt])}},heatmap:function(w,h,g,S){if(g.paint.get("heatmap-opacity")!==0)if(w.renderPass==="offscreen"){const P=w.context,D=P.gl,N=mr.disabled,$=new Cr([D.ONE,D.ONE,D.ONE,D.ONE],a.bz.transparent,[!0,!0,!0,!0]);(function(de,xe,be,Se){const Te=de.gl,Oe=xe.width*Se,Ge=xe.height*Se;de.activeTexture.set(Te.TEXTURE1),de.viewport.set([0,0,Oe,Ge]);let Be=be.heatmapFbo;if(!Be||Be&&(Be.width!==Oe||Be.height!==Ge)){Be&&Be.destroy();const Xe=Te.createTexture();Te.bindTexture(Te.TEXTURE_2D,Xe),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.LINEAR),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.LINEAR),Be=be.heatmapFbo=de.createFramebuffer(Oe,Ge,!0,null),function($e,tt,Je,nt,ht,at){const st=$e.gl;st.texImage2D(st.TEXTURE_2D,0,$e.extRenderToTextureHalfFloat?st.RGBA16F:st.RGBA,ht,at,0,st.RGBA,$e.extRenderToTextureHalfFloat?st.HALF_FLOAT:st.UNSIGNED_BYTE,null),nt.colorAttachment.set(Je)}(de,0,Xe,Be,Oe,Ge)}else Te.bindTexture(Te.TEXTURE_2D,Be.colorAttachment.get()),de.bindFramebuffer.set(Be.framebuffer)})(P,w,g,w.transform.projection.name==="globe"?.5:.25),P.clear({color:a.bz.transparent});const Y=w.transform,ee=Y.projection.name==="globe",te=ee?["PROJECTION_GLOBE_VIEW"]:[],le=ee?yr.frontCCW:yr.disabled,ce=[a.am(Y.center.lng),a.at(Y.center.lat)];for(let de=0;de<S.length;de++){const xe=S[de];if(h.hasRenderableParent(xe))continue;const be=h.getTile(xe),Se=be.getBucket(g);if(!Se||Se.projection.name!==Y.projection.name)continue;const Te=w.isTileAffectedByFog(xe),Oe=Se.programConfigurations.get(g.id),Ge=w.getOrCreateProgram("heatmap",{config:Oe,defines:te,overrideFog:Te}),{zoom:Be}=w.transform;w.terrain&&w.terrain.setupElevationDraw(be,Ge),w.uploadCommonUniforms(P,Ge,xe.toUnwrapped());const Xe=Y.projection.createInversionMatrix(Y,xe.canonical);Ge.draw(w,D.TRIANGLES,qn.disabled,N,$,le,Vg(w,xe,be,Xe,ce,Be,g.paint.get("heatmap-intensity")),g.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,g.paint,w.transform.zoom,Oe,ee?[Se.globeExtVertexBuffer]:null)}P.viewport.set([0,0,w.width,w.height])}else w.renderPass==="translucent"&&(w.context.setColorMode(w.colorModeForRenderPass()),function(P,D){const N=P.context,$=N.gl,Y=D.heatmapFbo;if(!Y)return;N.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,Y.colorAttachment.get()),N.activeTexture.set($.TEXTURE1);let ee=D.colorRampTexture;ee||(ee=D.colorRampTexture=new a.T(N,D.colorRamp,$.RGBA8)),ee.bind($.LINEAR,$.CLAMP_TO_EDGE),P.getOrCreateProgram("heatmapTexture").draw(P,$.TRIANGLES,qn.disabled,mr.disabled,P.colorModeForRenderPass(),yr.disabled,((te,le,ce,de)=>({u_image:0,u_color_ramp:1,u_opacity:le.paint.get("heatmap-opacity")}))(0,D),D.id,P.viewportBuffer,P.quadTriangleIndexBuffer,P.viewportSegments,D.paint,P.transform.zoom)}(w,g))},line:function(w,h,g,S){if(w.renderPass!=="translucent")return;const P=g.paint.get("line-opacity"),D=g.paint.get("line-width");if(P.constantOr(1)===0||D.constantOr(1)===0)return;const N=g.paint.get("line-emissive-strength"),$=g.paint.get("line-occlusion-opacity"),Y=w.context,ee=Y.gl,te=g.layout.get("line-z-offset"),le=!te.isConstant()||!!te.constantOr(0),ce=le?new qn(w.depthOcclusion?ee.GREATER:ee.LEQUAL,qn.ReadOnly,w.depthRangeFor3D):w.depthModeForSublayer(0,qn.ReadOnly),de=w.colorModeForDrapableLayerRenderPass(N),xe=w.terrain&&w.terrain.renderingToTexture,be=xe?1:a.q.devicePixelRatio,Se=g.paint.get("line-dasharray"),Te=Se.constantOr(1),Oe=g.layout.get("line-cap"),Ge=Se.constantOr(null),Be=Oe.constantOr(null),Xe=g.paint.get("line-pattern"),$e=Xe.constantOr(1),tt=Xe.constantOr(null),Je=g.paint.get("line-opacity").constantOr(1);let nt=!$e&&Je!==1||w.depthOcclusion&&$>0&&$<1;const ht=g.paint.get("line-gradient"),at=$e?"linePattern":"line",st=a.cV(g);let wt;if(xe&&w.terrain&&w.terrain.clipOrMaskOverlapStencilType()&&(nt=!1),$!==0&&w.depthOcclusion){const Zt=g.paint._values["line-opacity"];Zt&&Zt.value&&Zt.value.kind==="constant"?wt=Zt.value:a.w(`Occlusion opacity for layer ${g.id} is supported only when line-opacity isn't data-driven.`)}if(le&&(w.forceTerrainMode=!0),!le&&$!==0&&w.terrain&&!xe)return void a.w(`Occlusion opacity for layer ${g.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const zt=nt&&le?w.stencilModeFor3D():mr.disabled;for(const Zt of S){const Ft=h.getTile(Zt);if($e&&!Ft.patternsLoaded())continue;const dn=Ft.getBucket(g);if(!dn)continue;w.prepareDrawTile();const St=dn.programConfigurations.get(g.id),$t=w.isTileAffectedByFog(Zt),Ht=w.getOrCreateProgram(at,{config:St,defines:le?[...st,"ELEVATED"]:st,overrideFog:$t});if(tt&&Ft.imageAtlas){const bn=Ft.imageAtlas.patternPositions[tt.toString()];bn&&St.setConstantPatternPositions(bn)}if(!$e&&Ge&&Be&&Ft.lineAtlas){const bn=Ft.lineAtlas.getDash(Ge,Be);bn&&St.setConstantPatternPositions(bn)}let[fn,mn]=g.paint.get("line-trim-offset");(Be==="round"||Be==="square")&&fn!==mn&&(fn===0&&(fn-=1),mn===1&&(mn+=1));const Yt=xe?Zt.projMatrix:null,tn=$e?a.cW(w,Ft,g,Yt,be,[fn,mn]):a.cX(w,Ft,g,Yt,dn.lineClipsArray.length,be,[fn,mn]);if(ht){const bn=dn.gradients[g.id];let Bn=bn.texture;if(g.gradientVersion!==bn.version){let xr=256;if(g.stepInterpolant){const Yn=h.getSource().maxzoom,hr=Zt.canonical.z===Yn?Math.ceil(1<<w.transform.maxZoom-Zt.canonical.z):1;xr=a.ap(a.cY(dn.maxLineLength/a.ab*1024*hr),256,Y.maxTextureSize)}bn.gradient=a.cZ({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:xr,image:bn.gradient||void 0,clips:dn.lineClipsArray}),bn.texture?bn.texture.update(bn.gradient):bn.texture=new a.T(Y,bn.gradient,ee.RGBA8),bn.version=g.gradientVersion,Bn=bn.texture}Y.activeTexture.set(ee.TEXTURE1),Bn.bind(g.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}Te&&(Y.activeTexture.set(ee.TEXTURE0),Ft.lineAtlasTexture&&Ft.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),St.updatePaintBuffers()),$e&&(Y.activeTexture.set(ee.TEXTURE0),Ft.imageAtlasTexture&&Ft.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),St.updatePaintBuffers()),le&&w.terrain.setupElevationDraw(Ft,Ht),w.uploadCommonUniforms(Y,Ht,Zt.toUnwrapped());const tr=bn=>{wt!=null&&(wt.value=Je*$),Ht.draw(w,ee.TRIANGLES,ce,bn,de,yr.disabled,tn,g.id,dn.layoutVertexBuffer,dn.indexBuffer,dn.segments,g.paint,w.transform.zoom,St,[dn.layoutVertexBuffer2,dn.patternVertexBuffer,dn.zOffsetVertexBuffer]),wt!=null&&(wt.value=Je)};if(nt&&!le){const bn=w.stencilModeForClipping(Zt).ref;bn===0&&xe&&Y.clear({stencil:0});const Bn={func:ee.EQUAL,mask:255};tn.u_alpha_discard_threshold=.8,tr(new mr(Bn,bn,255,ee.KEEP,ee.KEEP,ee.INVERT)),tn.u_alpha_discard_threshold=0,tr(new mr(Bn,bn,255,ee.KEEP,ee.KEEP,ee.KEEP))}else nt&&le&&(tn.u_alpha_discard_threshold=.001),tr(le?zt:w.stencilModeForClipping(Zt))}nt&&(w.resetStencilClippingMasks(),xe&&Y.clear({stencil:0})),$===0||w.depthOcclusion||xe||w.layersWithOcclusionOpacity.push(w.currentLayer),le&&(w.forceTerrainMode=!1)},fill:function(w,h,g,S){const P=g.paint.get("fill-color"),D=g.paint.get("fill-opacity"),N=g.is3D(),$=new qn(w.context.gl.LEQUAL,qn.ReadWrite,w.depthRangeFor3D);if(D.constantOr(1)===0)return;const Y=g.paint.get("fill-emissive-strength"),ee=w.colorModeForDrapableLayerRenderPass(Y),te=g.paint.get("fill-pattern"),le=w.opaquePassEnabledForLayer()&&!te.constantOr(1)&&P.constantOr(a.bz.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(w.renderPass===le){const ce=N?$:w.depthModeForSublayer(1,w.renderPass==="opaque"?qn.ReadWrite:qn.ReadOnly);kf(w,h,g,S,ce,ee,!1)}if(!N&&w.renderPass==="translucent"&&g.paint.get("fill-antialias")){const ce=N?$:w.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,qn.ReadOnly);kf(w,h,g,S,ce,ee,!0)}},"fill-extrusion":function(w,h,g,S){const P=g.paint.get("fill-extrusion-opacity"),D=w.context,N=D.gl,$=w.terrain,Y=$&&$.renderingToTexture;if(P===0)return;const ee=w.conflationActive&&w.style.isLayerClipped(g,h.getSource()),te=w.style.order.indexOf(g.fqid);if(ee&&function(le,ce,de,xe,be){for(const Se of xe){const Te=ce.getTile(Se).getBucket(de);Te&&(Te.updateReplacement(Se,le.replacementSource,be),Te.uploadCentroid(le.context))}}(w,h,g,S,te),$||ee)for(const le of S){const ce=h.getTile(le).getBucket(g);ce&&uc(w.context,h,le,ce,g,$,ee)}if(w.renderPass==="shadow"&&w.shadowRenderer){const le=w.shadowRenderer;if($&&P<.65&&g._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.a4)return;const ce=le.getShadowPassDepthMode(),de=le.getShadowPassColorMode();pd(w,h,g,S,ce,mr.disabled,de,ee)}else if(w.renderPass==="translucent"){const le=!g.paint.get("fill-extrusion-pattern").constantOr(1),ce=g.paint.get("fill-extrusion-color").constantOr(a.bz.white);if(!Y&&ce.a!==0){const de=new qn(w.context.gl.LEQUAL,qn.ReadWrite,w.depthRangeFor3D);P===1&&le?pd(w,h,g,S,de,mr.disabled,Cr.unblended,ee):(pd(w,h,g,S,de,mr.disabled,Cr.disabled,ee),pd(w,h,g,S,de,w.stencilModeFor3D(),w.colorModeForRenderPass(),ee),w.resetStencilClippingMasks())}if(w.style.enable3dLights()&&le&&(!$&&w.transform.projection.name!=="globe"||Y)){const de=g.paint.get("fill-extrusion-opacity"),xe=g.paint.get("fill-extrusion-ambient-occlusion-intensity"),be=g.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Se=g.paint.get("fill-extrusion-flood-light-intensity"),Te=g.paint.get("fill-extrusion-flood-light-color").toRenderColor(g.lut).toArray01().slice(0,3),Oe=xe>0&&be>0,Ge=Se>0,Be=($e,tt,Je)=>(1-Je)*$e+Je*tt,Xe=$e=>{const tt=w.depthModeForSublayer(1,qn.ReadOnly,N.LEQUAL,!0),Je=g.paint.get($e?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),nt=Be(.1,3,Je),ht=w._showOverdrawInspector;if(!ht){const at=new mr({func:N.ALWAYS,mask:255},255,255,N.KEEP,N.KEEP,N.REPLACE),st=new Cr([N.ONE,N.ONE,N.ONE,N.ONE],a.bz.transparent,[!1,!1,!1,!0],N.MIN);ho(w,h,g,S,tt,at,st,yr.disabled,$e,"sdf",de,xe,be,Se,Te,nt,ee,!1)}{const at=ht?mr.disabled:new mr({func:N.EQUAL,mask:255},255,255,N.KEEP,N.DECR,N.DECR),st=ht?w.colorModeForRenderPass():new Cr([N.ONE_MINUS_DST_ALPHA,N.DST_ALPHA,N.ONE,N.ONE],a.bz.transparent,[!0,!0,!0,!0]);ho(w,h,g,S,tt,at,st,yr.disabled,$e,"color",de,xe,be,Se,Te,nt,ee,!1)}};if(Y){const $e=(tt,Je,nt)=>{const ht=w.depthModeForSublayer(1,qn.ReadOnly,N.LEQUAL,!1),at=g.paint.get(tt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),st=Be(.1,3,at);{const wt=new Cr([N.ONE,N.ONE,N.ONE,N.ONE],a.bz.transparent,[!1,!1,!1,!0]);ho(w,h,g,S,ht,mr.disabled,wt,yr.disabled,tt,"clear",de,xe,be,Se,Te,st,ee,Je)}{const wt=new mr({func:N.ALWAYS,mask:255},255,255,N.KEEP,N.KEEP,N.REPLACE),zt=new Cr([N.ONE,N.ONE,N.ONE,N.ONE],a.bz.transparent,[!1,!1,!1,!0],N.MIN);ho(w,h,g,S,ht,wt,zt,yr.disabled,tt,"sdf",de,xe,be,Se,Te,st,ee,Je)}{const wt=tt?N.ZERO:N.ONE_MINUS_DST_ALPHA,zt=new mr({func:N.EQUAL,mask:255},255,255,N.KEEP,N.DECR,N.DECR),Zt=new Cr([wt,N.DST_ALPHA,N.ONE_MINUS_DST_ALPHA,N.ZERO],a.bz.transparent,[!0,!0,!0,!0]);ho(w,h,g,S,ht,zt,Zt,yr.disabled,tt,"color",de,xe,be,Se,Te,st,ee,Je)}{const wt=new Cr([N.ONE,N.ONE,N.ONE,tt?N.ZERO:N.ONE],a.bz.transparent,[!1,!1,!1,!0],tt?N.FUNC_ADD:N.MAX);ho(w,h,g,S,ht,mr.disabled,wt,yr.disabled,tt,"clear",de,xe,be,Se,Te,st,ee,Je,nt)}};if(Oe||Ge){let tt;if(w.prepareDrawTile(),$){const Je=$.drapeBufferSize[0],nt=$.drapeBufferSize[1];tt=$.framebufferCopyTexture,tt&&(!tt||tt.size[0]===Je&&tt.size[1]===nt)||(tt&&tt.destroy(),tt=$.framebufferCopyTexture=new a.T(D,new a.r({width:Je,height:nt}),N.RGBA8)),tt.bind(N.LINEAR,N.CLAMP_TO_EDGE),N.copyTexImage2D(N.TEXTURE_2D,0,N.RGBA,0,0,Je,nt,0)}Oe&&$e(!0,!1,tt),Ge&&$e(!1,!0,tt)}}else Oe&&Xe(!0),Ge&&Xe(!1),(Oe||Ge)&&w.resetStencilClippingMasks()}}},hillshade:function(w,h,g,S){if(w.renderPass!=="offscreen"&&w.renderPass!=="translucent"||w.style.disableElevatedTerrain)return;const P=w.context,D=w.terrain&&w.terrain.renderingToTexture,[N,$]=w.renderPass!=="translucent"||D?[{},S]:w.stencilConfigForOverlap(S);for(const Y of $){const ee=h.getTile(Y);if(ee.needsHillshadePrepare&&w.renderPass==="offscreen")lc(w,ee,g);else if(w.renderPass==="translucent"){const te=w.depthModeForSublayer(0,qn.ReadOnly),le=g.paint.get("hillshade-emissive-strength"),ce=w.colorModeForDrapableLayerRenderPass(le),de=D&&w.terrain?w.terrain.stencilModeForRTTOverlap(Y):N[Y.overscaledZ];Rl(w,Y,ee,g,te,de,ce)}}P.viewport.set([0,0,w.width,w.height]),w.resetStencilClippingMasks()},raster:function(w,h,g,S,P,D){if(w.renderPass!=="translucent"||g.paint.get("raster-opacity")===0)return;const N=w.transform.projection.name==="globe",$=g.paint.get("raster-elevation")!==0,Y=$&&N;if(w.renderElevatedRasterBackface&&!Y)return;const ee=w.context,te=ee.gl,le=h.getSource(),ce=function($e,tt,Je,nt){const ht=tt.paint.get("raster-color"),at=$e.type==="raster-array",st=[],wt=tt.paint.get("raster-resampling"),zt=tt.paint.get("raster-color-mix");let Zt=tt.paint.get("raster-color-range");const Ft=[zt[0],zt[1],zt[2],0],dn=zt[3];let St=wt==="nearest"?nt.NEAREST:nt.LINEAR;if(at&&(st.push("RASTER_ARRAY"),ht||st.push("RASTER_COLOR"),wt==="linear"&&st.push("RASTER_ARRAY_LINEAR"),St=nt.NEAREST,!Zt&&$e.rasterLayers)){const $t=$e.rasterLayers.find(({id:Ht})=>Ht===tt.sourceLayer);$t&&$t.fields&&$t.fields.range&&(Zt=$t.fields.range)}if(Zt=Zt||[0,1],ht){st.push("RASTER_COLOR"),Je.activeTexture.set(nt.TEXTURE2),tt.updateColorRamp(Zt);let $t=tt.colorRampTexture;$t||($t=tt.colorRampTexture=new a.T(Je,tt.colorRamp,nt.RGBA8)),$t.bind(nt.LINEAR,nt.CLAMP_TO_EDGE)}return{mix:Ft,range:Zt,offset:dn,defines:st,resampling:St}}(le,g,ee,te);if(le instanceof a.aD&&!S.length&&!N)return;const de=g.paint.get("raster-emissive-strength"),xe=w.colorModeForDrapableLayerRenderPass(de),be=w.terrain&&w.terrain.renderingToTexture,Se=!w.options.moving,Te=g.paint.get("raster-resampling")==="nearest"?te.NEAREST:te.LINEAR;if(le instanceof a.aD&&!S.length&&(le.onNorthPole||le.onSouthPole)){const $e=$?w.stencilModeFor3D():mr.disabled;return void Ua(!!le.onNorthPole,null,w,h,g,de,ce,yr.disabled,$e)}if(!S.length)return;const[Oe,Ge]=le instanceof a.aD||be?[{},S]:w.stencilConfigForOverlap(S),Be=Ge[Ge.length-1].overscaledZ;Y&&ce.defines.push("PROJECTION_GLOBE_VIEW"),$&&ce.defines.push("RENDER_CUTOFF");const Xe=($e,tt,Je)=>{for(const nt of $e){const ht=nt.toUnwrapped(),at=h.getTile(nt);if(be&&(!at||!at.hasData()))continue;ee.activeTexture.set(te.TEXTURE0);const st=md(at,le,g,ce);if(!st||!st.texture)continue;const{texture:wt,mix:zt,offset:Zt,tileSize:Ft,buffer:dn}=st;let St,$t;be?(St=qn.disabled,$t=nt.projMatrix):$?(St=new qn(te.LEQUAL,qn.ReadWrite,w.depthRangeFor3D),$t=N?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(ht,Se)):(St=w.depthModeForSublayer(nt.overscaledZ-Be,g.paint.get("raster-opacity")===1?qn.ReadWrite:qn.ReadOnly,te.LESS),$t=w.transform.calculateProjMatrix(ht,Se));const Ht=w.terrain&&be?w.terrain.stencilModeForRTTOverlap(nt):Oe[nt.overscaledZ],fn=D?0:g.paint.get("raster-fade-duration");at.registerFadeDuration(fn);const mn=h.findLoadedParent(nt,0),Yt=th(at,mn,h,w.transform,fn);let tn,tr;w.terrain&&w.terrain.prepareDrawTile(),ee.activeTexture.set(te.TEXTURE0),wt.bind(Te,te.CLAMP_TO_EDGE),ee.activeTexture.set(te.TEXTURE1),mn?(mn.texture&&mn.texture.bind(Te,te.CLAMP_TO_EDGE),tn=Math.pow(2,mn.tileID.overscaledZ-at.tileID.overscaledZ),tr=[at.tileID.canonical.x*tn%1,at.tileID.canonical.y*tn%1]):wt.bind(Te,te.CLAMP_TO_EDGE),wt.useMipmap&&ee.extTextureFilterAnisotropic&&w.transform.pitch>20&&te.texParameterf(te.TEXTURE_2D,ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ee.extTextureFilterAnisotropicMax);const bn=w.transform;let Bn;const xr=$?gs(bn):[0,0,0,0];let Yn,hr,Vr,kr,Ri,Hi=0;if(Y&&le instanceof a.aD&&le.coordinates.length>3)Yn=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0)))),hr=Float32Array.from(bn.globeMatrix),Vr=Float32Array.from(a.cy(bn)),kr=[a.am(bn.center.lng),a.at(bn.center.lat)],Bn=le.elevatedGlobePerspectiveTransform,Ri=le.elevatedGlobeGridMatrix||new Float32Array(9);else if(Y){const Jr=a.cz(nt.canonical);Hi=a.cA(Jr.getCenter().lat),Yn=Float32Array.from(a.b5(a.cC(nt.canonical))),hr=Float32Array.from(bn.globeMatrix),Vr=Float32Array.from(a.cy(bn)),kr=[a.am(bn.center.lng),a.at(bn.center.lat)],Bn=[0,0],Ri=Float32Array.from(a.cB(nt.canonical,Jr,Hi,bn.worldSize/bn._pixelsPerMercatorPixel))}else Bn=le instanceof a.aD?le.perspectiveTransform:[0,0],Yn=new Float32Array(16),hr=new Float32Array(9),Vr=new Float32Array(16),kr=[0,0],Ri=new Float32Array(9);const as=Pf($t,Yn,hr,Vr,Ri,tr||[0,0],a.a9(w.transform.zoom),kr,xr,tn||1,Yt,g,Bn,$?g.paint.get("raster-elevation"):0,2,zt,Zt,ce.range,Ft,dn,de),Yc=w.isTileAffectedByFog(nt),no=w.getOrCreateProgram("raster",{defines:ce.defines,overrideFog:Yc});if(w.uploadCommonUniforms(ee,no,ht),le instanceof a.aD){const Jr=le.elevatedGlobeVertexBuffer,Gi=le.elevatedGlobeIndexBuffer;if(be||!N)le.boundsBuffer&&le.boundsSegments&&no.draw(w,te.TRIANGLES,St,mr.disabled,xe,yr.disabled,as,g.id,le.boundsBuffer,w.quadTriangleIndexBuffer,le.boundsSegments);else if(Jr&&Gi){const Ts=bn.zoom<=a.c2?le.elevatedGlobeSegments:le.getSegmentsForLongitude(bn.center.lng);Ts&&no.draw(w,te.TRIANGLES,St,mr.disabled,xe,tt,as,g.id,Jr,Gi,Ts)}}else if(Y){St=new qn(te.LEQUAL,qn.ReadOnly,w.depthRangeFor3D);const Jr=w.globeSharedBuffers;if(Jr){const[Gi,Ts,Oi]=Jr.getGridBuffers(Hi,!1);no.draw(w,te.TRIANGLES,St,Je||Ht,w.colorModeForRenderPass(),tt,as,g.id,Gi,Ts,Oi)}}else{const{tileBoundsBuffer:Jr,tileBoundsIndexBuffer:Gi,tileBoundsSegments:Ts}=w.getTileBoundsBuffers(at);no.draw(w,te.TRIANGLES,St,Ht,xe,yr.disabled,as,g.id,Jr,Gi,Ts)}}if(!(le instanceof a.aD)&&Y)for(const nt of $e){const ht=nt.canonical.y===(1<<nt.canonical.z)-1;nt.canonical.y===0&&Ua(!0,nt,w,h,g,de,ce,tt,Je||mr.disabled),ht&&Ua(!1,nt,w,h,g,de,ce,tt===yr.frontCW?yr.backCW:yr.frontCW,Je||mr.disabled)}};Y?Xe(Ge,w.renderElevatedRasterBackface?yr.backCW:yr.frontCW,w.stencilModeFor3D()):Xe(Ge,yr.disabled,void 0),w.resetStencilClippingMasks()},"raster-particle":function(w,h,g,S,P,D){w.renderPass==="offscreen"&&function(N,$,Y,ee){if(!ee.length)return;const te=N.context,le=te.gl,ce=$.getSource();if(!(ce instanceof Ir))return;const de=Math.ceil(Math.sqrt(Y.paint.get("raster-particle-count")));let xe=Y.particlePositionRGBAImage;if(!xe||xe.width!==de){const Ge=function(Be){const Xe=Be*Be,$e=new Uint8Array(4*Xe),tt=function(nt){return nt|=0,nt=Math.imul(2747636419^nt,2654435769),nt=Math.imul(nt^nt>>>16,2654435769),((nt=Math.imul(nt^nt>>>16,2654435769))>>>0)/4294967296},Je=1/1.1;for(let nt=0;nt<Xe;nt++){const ht=Je*(tt(2*nt+0)+ml),at=Je*(tt(2*nt+1)+ml),st=255*ht%1,wt=255*at%1,zt=st,Zt=at-wt/255,Ft=wt;$e[4*nt+0]=255*(ht-st/255),$e[4*nt+1]=255*zt,$e[4*nt+2]=255*Zt,$e[4*nt+3]=255*Ft}return $e}(de);xe=Y.particlePositionRGBAImage=new a.r({width:de,height:de},Ge)}let be=Y.particleFramebuffer;be?be.width!==de&&(be.destroy(),be=Y.particleFramebuffer=te.createFramebuffer(de,de,!0,null)):be=Y.particleFramebuffer=te.createFramebuffer(de,de,!0,null);const Se=[];for(const Ge of ee){const Be=$.getTile(Ge);if(!(Be instanceof gg))continue;const Xe=lm(Be,ce,Y);if(!Xe)continue;const $e=[Be.tileSize,Be.tileSize];let tt=Y.tileFramebuffer;tt||(tt=Y.tileFramebuffer=te.createFramebuffer($e[0],$e[1],!0,null));let Je=Be.rasterParticleState;Je||(Je=Be.rasterParticleState=new am(te,Ge,$e,xe));const nt=Je.update(Y.lastInvalidatedAt);Je.particleTextureDimension!==de&&Je.updateParticleTexture(Ge,xe);const ht=Je.targetColorTexture;Je.targetColorTexture=Je.backgroundColorTexture,Je.backgroundColorTexture=ht;const at=Je.particleTexture0;Je.particleTexture0=Je.particleTexture1,Je.particleTexture1=at,Se.push([Ge,Xe,Je,nt])}if(Se.length===0)return;const Te=a.q.now(),Oe=Y.previousDrawTimestamp?.001*(Te-Y.previousDrawTimestamp):.0167;if(Y.previousDrawTimestamp=Te,Y.hasColorMap()){te.activeTexture.set(le.TEXTURE0+2);let Ge=Y.colorRampTexture;Ge||(Ge=Y.colorRampTexture=new a.T(te,Y.colorRamp,le.RGBA8)),Ge.bind(le.LINEAR,le.CLAMP_TO_EDGE)}te.bindFramebuffer.set(Y.tileFramebuffer.framebuffer),function(Ge,Be,Xe){const $e=Ge.context,tt=$e.gl,Je=Be.tileFramebuffer;$e.activeTexture.set(tt.TEXTURE0);const nt={u_texture:0,u_opacity:1.05*(at=Be.paint.get("raster-particle-fade-opacity-factor"))/(at+.05)},ht=Ge.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var at;for(const st of Xe){const[,,wt,zt]=st;Je.colorAttachment.set(wt.targetColorTexture.texture),$e.viewport.set([0,0,Je.width,Je.height]),$e.clear({color:a.bz.transparent}),zt&&(wt.backgroundColorTexture.bind(tt.NEAREST,tt.CLAMP_TO_EDGE),ht.draw(Ge,tt.TRIANGLES,qn.disabled,mr.disabled,Cr.alphaBlended,yr.disabled,nt,Be.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments))}}(N,Y,Se),function(Ge,Be,Xe,$e){const tt=Ge.context,Je=tt.gl,nt=Xe.tileFramebuffer,ht=Ge.transform.projection.name==="globe",at=Xe.paint.get("raster-particle-max-speed");for(const st of $e){const[wt,zt,Zt]=st;tt.activeTexture.set(Je.TEXTURE0+0),zt.texture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE),nt.colorAttachment.set(Zt.targetColorTexture.texture);const Ft=Ge.getOrCreateProgram("rasterParticleDraw",{defines:zt.defines,overrideFog:!1});tt.activeTexture.set(Je.TEXTURE0+1);const dn=zt.scalarData?[]:[0,1,2,3].map(Ht=>a.c$[Ht](wt));dn.push(wt);const St=wt.canonical.x,$t=wt.canonical.y;for(const Ht of dn){const fn=Be.getTile(ht?Ht.wrapped():Ht);if(!fn)continue;const mn=fn.rasterParticleState;if(!mn)continue;const Yt=Ht.canonical.x+(1<<Ht.canonical.z)*(Ht.wrap-wt.wrap),tn=Ht.canonical.y;mn.particleTexture0.bind(Je.NEAREST,Je.CLAMP_TO_EDGE);const tr=Rf(1,mn.particleTexture0.size[0],[Yt-St,tn-$t],0,zt.texture.size,2,at,zt.textureOffset,zt.scale,zt.offset);Ft.draw(Ge,Je.POINTS,qn.disabled,mr.disabled,Cr.alphaBlended,yr.disabled,tr,Xe.id,mn.particleIndexBuffer,void 0,mn.particleSegment)}}}(N,$,Y,Se),te.bindFramebuffer.set(Y.particleFramebuffer.framebuffer),function(Ge,Be,Xe,$e){const tt=Ge.context,Je=tt.gl,nt=Be.paint.get("raster-particle-max-speed"),ht=$e*Be.paint.get("raster-particle-speed-factor")*.15,at=function(wt){return Math.pow(wt,6)}(.01+1*Be.paint.get("raster-particle-reset-rate-factor")),st=Be.particleFramebuffer;tt.viewport.set([0,0,st.width,st.height]);for(const wt of Xe){const[,zt,Zt]=wt;tt.activeTexture.set(Je.TEXTURE0+0),zt.texture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE),tt.activeTexture.set(Je.TEXTURE0+1);const Ft=Zt.particleTexture0;Ft.bind(Je.NEAREST,Je.CLAMP_TO_EDGE);const dn=rm(1,Ft.size[0],0,zt.texture.size,nt,ht,at,zt.textureOffset,zt.scale,zt.offset);st.colorAttachment.set(Zt.particleTexture1.texture),tt.clear({color:a.bz.transparent}),Ge.getOrCreateProgram("rasterParticleUpdate",{defines:zt.defines}).draw(Ge,Je.TRIANGLES,qn.disabled,mr.disabled,Cr.unblended,yr.disabled,dn,Be.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments)}}(N,Y,Se,Oe)}(w,h,g,S),w.renderPass==="translucent"&&(function(N,$,Y,ee,te){const le=N.context,ce=le.gl,de=$.getSource().tileSize,xe=5*(1-a.a7(a.bU,a.bU+1,N.transform.zoom))*de+Y.paint.get("raster-particle-elevation"),be=!N.options.moving,Se=N.transform.projection.name==="globe";if(!ee.length)return;const[Te,Oe]=N.stencilConfigForOverlap(ee),Ge=[];Se&&Ge.push("PROJECTION_GLOBE_VIEW");const Be=N.stencilModeFor3D();for(const Xe of Oe){const $e=Xe.toUnwrapped(),tt=$.getTile(Xe);if(!tt.rasterParticleState)continue;const Je=tt.rasterParticleState,nt=100;tt.registerFadeDuration(nt);const ht=$.findLoadedParent(Xe,0),at=th(tt,ht,$,N.transform,nt);let st,wt;N.terrain&&N.terrain.prepareDrawTile(),le.activeTexture.set(ce.TEXTURE0),Je.targetColorTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),le.activeTexture.set(ce.TEXTURE1),ht&&ht.rasterParticleState?(ht.rasterParticleState.targetColorTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),st=Math.pow(2,ht.tileID.overscaledZ-tt.tileID.overscaledZ),wt=[tt.tileID.canonical.x*st%1,tt.tileID.canonical.y*st%1]):Je.targetColorTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const zt=Se?Float32Array.from(N.transform.expandedFarZProjMatrix):N.transform.calculateProjMatrix($e,be),Zt=N.transform,Ft=Ff(Zt),dn=a.cz(Xe.canonical),St=a.cA(dn.getCenter().lat);let $t,Ht,fn,mn,Yt;Se?($t=Float32Array.from(a.b5(a.cC(Xe.canonical))),Ht=Float32Array.from(Zt.globeMatrix),fn=Float32Array.from(a.cy(Zt)),mn=[a.am(Zt.center.lng),a.at(Zt.center.lat)],Yt=Float32Array.from(a.cB(Xe.canonical,dn,St,Zt.worldSize/Zt._pixelsPerMercatorPixel))):($t=new Float32Array(16),Ht=new Float32Array(9),fn=new Float32Array(16),mn=[0,0],Yt=new Float32Array(9));const tn=d_(zt,$t,Ht,fn,Yt,wt||[0,0],a.a9(N.transform.zoom),mn,Ft,st||1,at,xe),tr=N.isTileAffectedByFog(Xe),bn=N.getOrCreateProgram("rasterParticle",{defines:Ge,overrideFog:tr});if(N.uploadCommonUniforms(le,bn,$e),Se){const Bn=new qn(ce.LEQUAL,qn.ReadOnly,N.depthRangeFor3D),xr=0,Yn=N.globeSharedBuffers;if(Yn){const[hr,Vr,kr]=Yn.getGridBuffers(St,xr!==0);bn.draw(N,ce.TRIANGLES,Bn,Be,Cr.alphaBlended,N.renderElevatedRasterBackface?yr.frontCCW:yr.backCCW,tn,Y.id,hr,Vr,kr)}}else{const Bn=N.depthModeForSublayer(0,qn.ReadOnly),xr=Te[Xe.overscaledZ],{tileBoundsBuffer:Yn,tileBoundsIndexBuffer:hr,tileBoundsSegments:Vr}=N.getTileBoundsBuffers(tt);bn.draw(N,ce.TRIANGLES,Bn,xr,Cr.alphaBlended,yr.disabled,tn,Y.id,Yn,hr,Vr)}}N.resetStencilClippingMasks()}(w,h,g,S),w.style.map.triggerRepaint())},background:function(w,h,g,S){const P=g.paint.get("background-color"),D=g.paint.get("background-opacity"),N=g.paint.get("background-emissive-strength"),$=g.paint.get("background-pitch-alignment")==="viewport";if(D===0)return;const Y=w.context,ee=Y.gl,te=w.transform,le=te.tileSize,ce=g.paint.get("background-pattern");let de;if(ce!==void 0&&(ce===null||(de=w.imageManager.getPattern(ce.toString(),g.scope,w.style.getLut(g.scope)),!de)))return;const xe=!ce&&P.a===1&&D===1&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==xe)return;const be=mr.disabled,Se=w.depthModeForSublayer(0,xe==="opaque"?qn.ReadWrite:qn.ReadOnly),Te=w.colorModeForDrapableLayerRenderPass(N),Oe=ce?"backgroundPattern":"background";let Ge,Be=S;if(Be||(Ge=w.getBackgroundTiles(),Be=Object.values(Ge).map(Xe=>Xe.tileID)),ce&&(Y.activeTexture.set(ee.TEXTURE0),w.imageManager.bind(w.context,g.scope)),$){const Xe=w.getOrCreateProgram(Oe,{overrideFog:!1,overrideRtt:!0}),$e=new Float32Array(a.a6.mat4.identity([])),tt=new a.aA(0,0,0,0,0),Je=ce?jc($e,N,D,w,0,g.scope,de,$,{tileID:tt,tileSize:le}):qx($e,N,D,P.toRenderColor(g.lut));Xe.draw(w,ee.TRIANGLES,Se,be,Te,yr.disabled,Je,g.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments)}else for(const Xe of Be){const $e=w.isTileAffectedByFog(Xe),tt=w.getOrCreateProgram(Oe,{overrideFog:$e}),Je=Xe.toUnwrapped(),nt=S?Xe.projMatrix:w.transform.calculateProjMatrix(Je);w.prepareDrawTile();const ht=h?h.getTile(Xe):Ge?Ge[Xe.key]:new zc(Xe,le,te.zoom,w),at=ce?jc(nt,N,D,w,0,g.scope,de,$,{tileID:Xe,tileSize:le}):qx(nt,N,D,P.toRenderColor(g.lut));w.uploadCommonUniforms(Y,tt,Je);const{tileBoundsBuffer:st,tileBoundsIndexBuffer:wt,tileBoundsSegments:zt}=w.getTileBoundsBuffers(ht);tt.draw(w,ee.TRIANGLES,Se,be,Te,yr.disabled,at,g.id,st,wt,zt)}},sky:function(w,h,g){const S=w._atmosphere?a.a9(w.transform.zoom):1,P=g.paint.get("sky-opacity")*S;if(P===0)return;const D=w.context,N=g.paint.get("sky-type"),$=new qn(D.gl.LEQUAL,qn.ReadOnly,[0,1]),Y=w.frameCounter/1e3%1;N==="atmosphere"?w.renderPass==="offscreen"?g.needsSkyboxCapture(w)&&(function(ee,te,le,ce){const de=ee.context,xe=de.gl;let be=te.skyboxFbo;if(!be){be=te.skyboxFbo=de.createFramebuffer(32,32,!0,null),te.skyboxGeometry=new Fo(de),te.skyboxTexture=de.gl.createTexture(),xe.bindTexture(xe.TEXTURE_CUBE_MAP,te.skyboxTexture),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MAG_FILTER,xe.LINEAR);for(let Ge=0;Ge<6;++Ge)xe.texImage2D(xe.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,xe.RGBA,32,32,0,xe.RGBA,xe.UNSIGNED_BYTE,null)}de.bindFramebuffer.set(be.framebuffer),de.viewport.set([0,0,32,32]);const Se=te.getCenter(ee,!0),Te=ee.getOrCreateProgram("skyboxCapture"),Oe=new Float64Array(16);a.a6.mat4.identity(Oe),a.a6.mat4.rotateY(Oe,Oe,.5*-Math.PI),No(ee,te,Te,Oe,Se,0),a.a6.mat4.identity(Oe),a.a6.mat4.rotateY(Oe,Oe,.5*Math.PI),No(ee,te,Te,Oe,Se,1),a.a6.mat4.identity(Oe),a.a6.mat4.rotateX(Oe,Oe,.5*-Math.PI),No(ee,te,Te,Oe,Se,2),a.a6.mat4.identity(Oe),a.a6.mat4.rotateX(Oe,Oe,.5*Math.PI),No(ee,te,Te,Oe,Se,3),a.a6.mat4.identity(Oe),No(ee,te,Te,Oe,Se,4),a.a6.mat4.identity(Oe),a.a6.mat4.rotateY(Oe,Oe,Math.PI),No(ee,te,Te,Oe,Se,5),de.viewport.set([0,0,ee.width,ee.height])}(w,g),g.markSkyboxValid(w)):w.renderPass==="sky"&&function(ee,te,le,ce,de){const xe=ee.context,be=xe.gl,Se=ee.transform,Te=ee.getOrCreateProgram("skybox");xe.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_CUBE_MAP,te.skyboxTexture);const Oe=((Ge,Be,Xe,$e,tt)=>({u_matrix:Ge,u_sun_direction:Be,u_cubemap:0,u_opacity:$e,u_temporal_offset:tt}))(Se.skyboxMatrix,te.getCenter(ee,!1),0,ce,de);ee.uploadCommonUniforms(xe,Te),Te.draw(ee,be.TRIANGLES,le,mr.disabled,ee.colorModeForRenderPass(),yr.backCW,Oe,"skybox",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(w,g,$,P,Y):N==="gradient"&&w.renderPass==="sky"&&function(ee,te,le,ce,de){const xe=ee.context,be=xe.gl,Se=ee.transform,Te=ee.getOrCreateProgram("skyboxGradient");te.skyboxGeometry||(te.skyboxGeometry=new Fo(xe)),xe.activeTexture.set(be.TEXTURE0);let Oe=te.colorRampTexture;Oe||(Oe=te.colorRampTexture=new a.T(xe,te.colorRamp,be.RGBA8)),Oe.bind(be.LINEAR,be.CLAMP_TO_EDGE);const Ge=((Be,Xe,$e,tt,Je)=>({u_matrix:Be,u_color_ramp:0,u_center_direction:Xe,u_radius:a.bB($e),u_opacity:tt,u_temporal_offset:Je}))(Se.skyboxMatrix,te.getCenter(ee,!1),te.paint.get("sky-gradient-radius"),ce,de);ee.uploadCommonUniforms(xe,Te),Te.draw(ee,be.TRIANGLES,le,mr.disabled,ee.colorModeForRenderPass(),yr.backCW,Ge,"skyboxGradient",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(w,g,$,P,Y)},debug:function(w,h,g,S,P,D){for(let N=0;N<g.length;N++)if(P){const ee=new a.bz(S.r*.8,S.g*.8,S.b*.8,1);hc(w,h,g[N],S,-1,-1,D),hc(w,h,g[N],S,-1,1,D),hc(w,h,g[N],S,1,1,D),hc(w,h,g[N],S,1,-1,D),hc(w,h,g[N],ee,0,0,D)}else hc(w,h,g[N],S,0,0,D)},custom:function(w,h,g,S){const P=w.context,D=g.implementation;if(!w.transform.projection.unsupportedLayers||!w.transform.projection.unsupportedLayers.includes("custom")||w.terrain&&(w.terrain.renderingToTexture||w.renderPass==="offscreen")&&g.isDraped(h)){if(w.renderPass==="offscreen"){const N=D.prerender;if(N){if(w.setCustomLayerDefaults(),P.setColorMode(w.colorModeForRenderPass()),w.transform.projection.name==="globe"){const $=w.transform.pointMerc;N.call(D,P.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),a.a9(w.transform.zoom),[$.x,$.y],w.transform.pixelsPerMeterRatio)}else N.call(D,P.gl,w.transform.customLayerMatrix());P.setDirty(),w.setBaseState()}}else if(w.renderPass==="translucent"){if(w.terrain&&w.terrain.renderingToTexture){const $=D.renderToTile;if($){const Y=S[0].canonical,ee=new a.a5(Y.x+S[0].wrap*(1<<Y.z),Y.y,Y.z);P.setDepthMode(qn.disabled),P.setStencilMode(mr.disabled),P.setColorMode(w.colorModeForRenderPass()),w.setCustomLayerDefaults(),$.call(D,P.gl,ee),P.setDirty(),w.setBaseState()}return}w.setCustomLayerDefaults(),P.setColorMode(w.colorModeForRenderPass()),P.setStencilMode(mr.disabled);const N=D.renderingMode==="3d"?new qn(w.context.gl.LEQUAL,qn.ReadWrite,w.depthRangeFor3D):w.depthModeForSublayer(0,qn.ReadOnly);if(P.setDepthMode(N),w.transform.projection.name==="globe"){const $=w.transform.pointMerc;D.render(P.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),a.a9(w.transform.zoom),[$.x,$.y],w.transform.pixelsPerMeterRatio)}else D.render(P.gl,w.transform.customLayerMatrix());P.setDirty(),w.setBaseState(),P.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(w,h,g,S){if(w.renderPass==="opaque")return;const P=g.paint.get("model-opacity");if(P===0)return;const D=g.paint.get("model-cast-shadows");if(w.renderPass==="shadow"&&(!D||w.terrain&&P<.65&&g._transitionablePaint._values["model-opacity"].value.expression instanceof a.a4))return;const N=w.shadowRenderer,$=g.paint.get("model-receive-shadows");N&&(N.useNormalOffset=!0,$||(N.enabled=!1));const Y=()=>{N&&(N.useNormalOffset=!0,$||(N.enabled=!0))},ee=h.getSource();if(w.renderPass==="light-beam"&&ee.type!=="batched-model")return;if(ee.type==="vector"||ee.type==="geojson")return function(Te,Oe,Ge,Be,Xe){const $e=Te.transform;if($e.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${$e.projection.name} projection is not yet implemented`);const tt=$e.getFreeCameraOptions().position;if(!Te.modelManager)return;const Je=Te.modelManager;Ge.modelManager=Je;const nt=Te.shadowRenderer;if(!Ge._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ht=Ge._unevaluatedLayout._values["model-id"],at={...Ge.layout.get("model-id").parameters},st=Te.style.order.indexOf(Ge.fqid);for(const wt of Be){const zt=Oe.getTile(wt).getBucket(Ge);if(!zt||zt.projection.name!==$e.projection.name)continue;const Zt=zt.getModelUris();Zt&&!zt.modelsRequested&&(Je.addModelsFromBucket(Zt,Xe),zt.modelsRequested=!0);const Ft=g_(wt,$e);at.zoom=Ft;const dn=ht.possiblyEvaluate(at);if(yd(Te,zt,wt),tl.shadowUniformsInitialized=!1,tl.useSingleShadowCascade=!!nt&&nt.getMaxCascadeForTile(wt.toUnwrapped())===0,Te.renderPass==="shadow"&&nt){if(Te.currentShadowCascade===1&&zt.isInsideFirstShadowMapFrustum)continue;const Ht=$e.calculatePosMatrix(wt.toUnwrapped(),$e.worldSize);if(tl.tileMatrix.set(Ht),tl.shadowTileMatrix=Float32Array.from(nt.calculateShadowPassMatrixFromMatrix(Ht)),tl.aabb.min.fill(0),tl.aabb.max[0]=tl.aabb.max[1]=a.ab,tl.aabb.max[2]=0,Bl(zt,tl,Te,Ge.scope))continue}const St=1<<wt.canonical.z,$t=[((tt.x-wt.wrap)*St-wt.canonical.x)*a.ab,(tt.y*St-wt.canonical.y)*a.ab,tt.z*St*a.ab];Te.conflationActive&&Object.keys(zt.instancesPerModel).length>0&&Te.style.isLayerClipped(Ge,Oe.getSource())&&zt.updateReplacement(wt,Te.replacementSource,st,Xe)&&(zt.uploaded=!1,zt.upload(Te.context));for(let Ht in zt.instancesPerModel){const fn=zt.instancesPerModel[Ht];fn.features.length>0&&(Ht=dn.evaluate(fn.features[0].feature,{}));const mn=Je.getModel(Ht,Xe);if(mn&&mn.uploaded)for(const Yt of mn.nodes)$s(Te,Ge,Yt,fn,$t,wt,tl)}}}(w,h,g,S,ee.type==="vector"?g.scope:""),void Y();if(!ee.loaded())return;if(ee.type==="batched-model")return function(Te,Oe,Ge,Be){Ge.resetLayerRenderingStats(Te);const Xe=Te.context,$e=Te.transform,tt=Te.style.fog,Je=Te.shadowRenderer;if($e.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${$e.projection.name} projection is not yet implemented`);const nt=Te.transform.getFreeCameraOptions().position,ht=a.a6.vec3.scale([],[nt.x,nt.y,nt.z],Te.transform.worldSize),at=a.a6.vec3.negate([],ht),st=a.a6.mat4.identity([]),wt=a.de($e.center.lat,$e.zoom),zt=a.a6.mat4.fromScaling([],[1,1,1/wt]);a.a6.mat4.translate(st,st,at);const Zt=Ge.paint.get("model-opacity"),Ft=new qn(Xe.gl.LEQUAL,qn.ReadWrite,Te.depthRangeFor3D),dn=new qn(Xe.gl.LEQUAL,qn.ReadOnly,Te.depthRangeFor3D),St=new a.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),$t=Te.renderPass==="shadow",Ht=$t&&Je?Je.getCurrentCascadeFrustum():$e.getFrustum($e.scaleZoom($e.worldSize)),fn=Ge.paint.get("model-front-cutoff"),mn=fn[2]<1,Yt=oc(Te,Ge.paint.get("model-cutoff-fade-range")),tn=Ge.getLayerRenderingStats();(function(tr,bn,Bn,xr){const Yn=tr.terrain?tr.terrain.exaggeration():0,hr=tr.transform.zoom;for(const Vr of xr){const kr=bn.getTile(Vr).getBucket(Bn);kr&&(tr.conflationActive&&kr.updateReplacement(Vr,tr.replacementSource),kr.evaluateScale(tr,Bn),tr.terrain&&Yn>0&&kr.elevationUpdate(tr.terrain,Yn,Vr,Bn.source),kr.needsReEvaluation(tr,hr,Bn)&&kr.evaluate(Bn))}})(Te,Oe,Ge,Be),function(){let tr,bn,Bn;mn?(tr=Be.length-1,bn=-1,Bn=-1):(tr=0,bn=Be.length,Bn=1);const xr=new Float64Array(16),Yn=a.a6.vec3.create(),hr=new a.P(0,0);for(let Vr=tr;Vr!==bn;Vr+=Bn){const kr=Be[Vr],Ri=Oe.getTile(kr).getBucket(Ge);if(!Ri||!Ri.uploaded)continue;let Hi=!1;Je&&(Hi=Je.getMaxCascadeForTile(kr.toUnwrapped())===0);const as=$e.calculatePosMatrix(kr.toUnwrapped(),$e.worldSize),Yc=Ri.modelTraits;!$t&&mn&&(a.a6.mat4.invert(xr,as),a.a6.vec3.transformMat4(Yn,ht,xr),hr.x=Yn[0],hr.y=Yn[1]);const no=[];for(const Jr of Ri.getNodesInfo()){if(Jr.hiddenByReplacement||!Jr.node.meshes)continue;const Gi=Jr.node;let Ts=0;Te.terrain&&Gi.elevation&&(Ts=Gi.elevation*Te.terrain.exaggeration());const Oi=(()=>{const es=Jr.aabb;return St.min=[...es.min],St.max=[...es.max],St.min[2]+=Ts,St.max[2]+=Ts,a.a6.vec3.transformMat4(St.min,St.min,as),a.a6.vec3.transformMat4(St.max,St.max,as),St})(),Fr=Jr.evaluatedScale;if(Fr[0]<=1&&Fr[1]<=1&&Fr[2]<=1&&Oi.intersects(Ht)===0)continue;if(!$t&&mn){const es=.16666666666666666;Jr.cameraCollisionOpacity=ht[0]>Oi.min[0]&&ht[0]<Oi.max[0]&&ht[1]>Oi.min[1]&&ht[1]<Oi.max[1]&&ht[2]*wt<Oi.max[2]&&Gi.footprint&&a.bu(hr,Gi.footprint)?Math.max(Jr.cameraCollisionOpacity-es,0):Math.min(1,Jr.cameraCollisionOpacity+es)}const gi=[...as],Ei=Gi.anchor?Gi.anchor[0]:0,Gs=Gi.anchor?Gi.anchor[1]:0;a.a6.mat4.translate(gi,gi,[Ei*(Fr[0]-1),Gs*(Fr[1]-1),Ts]),a.a6.vec3.exactEquals(Fr,a.dh)||a.a6.mat4.scale(gi,gi,Fr);const ro=a.a6.mat4.multiply([],gi,Gi.matrix),li=a.a6.mat4.multiply([],$e.expandedFarZProjMatrix,ro),Uo=a.a6.mat4.multiply([],$e.expandedFarZProjMatrix,gi),ea=a.a6.vec4.transformMat4([],[Ei,Gs,Ts,1],li)[2];Gi.hidden=!1;let Go=Zt;$t||(mn&&(Go*=Jr.cameraCollisionOpacity,Go*=ti(gi,$e,Jr.aabb,fn)),Go*=Ui(Yt,ea)),Go!==0?no.push({nodeInfo:Jr,depth:ea,opacity:Go,wvpForNode:li,wvpForTile:Uo,nodeModelMatrix:ro,tileModelMatrix:gi}):Gi.hidden=!0}$t||no.sort((Jr,Gi)=>!mn||Jr.opacity===1&&Gi.opacity===1?Jr.depth<Gi.depth?-1:1:Jr.opacity===1?-1:Gi.opacity===1?1:Jr.depth>Gi.depth?-1:1);for(const Jr of no){const Gi=Jr.nodeInfo,Ts=Gi.node;let Oi=a.a6.mat4.multiply([],zt,Jr.tileModelMatrix);a.a6.mat4.multiply(Oi,st,Oi);const Fr=a.a6.mat4.invert([],Oi);a.a6.mat4.transpose(Fr,Fr),a.a6.mat4.scale(Fr,Fr,qg),Oi=a.a6.mat4.multiply(Oi,Oi,Ts.matrix);const gi=Te.renderPass==="light-beam",Ei=Yc&a.dj.HasMapboxMeshFeatures,Gs=Ei?0:Gi.evaluatedRMEA[0][2];for(let ro=0;ro<Ts.meshes.length;++ro){const li=Ts.meshes[ro],Uo=ro===Ts.lightMeshIndex;let ea=Jr.wvpForNode;if(Uo){if(!gi&&!Te.terrain&&Te.shadowRenderer){Te.currentLayer<Te.firstLightBeamLayer&&(Te.firstLightBeamLayer=Te.currentLayer);continue}ea=Jr.wvpForTile}else if(gi)continue;const Go={defines:[]},es=[];if(sh(Go.defines,es,li,Te,Ge.lut),Ei||Go.defines.push("DIFFUSE_SHADED"),Hi&&Go.defines.push("SHADOWS_SINGLE_CASCADE"),tn&&($t?tn.numRenderedVerticesInShadowPass+=li.vertexArray.length:tn.numRenderedVerticesInTransparentPass+=li.vertexArray.length),$t){oh(li,Jr.nodeModelMatrix,Te,Ge);continue}let vl=null;if(tt){const Sd=Nf(Jr.nodeModelMatrix,Te.transform);if(vl=new Float32Array(Sd),$e.projection.name!=="globe"){const Wf=li.aabb.min,ch=li.aabb.max,[rv,iv]=tt.getOpacityForBounds(Sd,Wf[0],Wf[1],ch[0],ch[1]);Go.overrideFog=rv>=Cn||iv>=Cn}}const _l=li.material;let Zc;_l.occlusionTexture&&_l.occlusionTexture.offsetScale&&(Zc=_l.occlusionTexture.offsetScale,Go.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!$t&&Je&&(Je.useNormalOffset=!!li.normalBuffer);const vc=Te.getOrCreateProgram("model",Go);!$t&&Je&&Je.setupShadowsFromMatrix(Jr.tileModelMatrix,vc,Je.useNormalOffset),Te.uploadCommonUniforms(Xe,vc,null,vl);const Ol=_l.pbrMetallicRoughness;Ol.metallicFactor=.9,Ol.roughnessFactor=.5;const Kc=Nn(new Float32Array(ea),new Float32Array(Oi),new Float32Array(Fr),new Float32Array(Ts.matrix),Te,Jr.opacity,Ol.baseColorFactor.toRenderColor(null),_l.emissiveFactor,Ol.metallicFactor,Ol.roughnessFactor,_l,Gs,Ge,[0,0,0],Zc);!Uo&&(Gi.hasTranslucentParts||Jr.opacity<1)&&vc.draw(Te,Xe.gl.TRIANGLES,Ft,mr.disabled,Cr.disabled,yr.backCCW,Kc,Ge.id,li.vertexBuffer,li.indexBuffer,li.segments,Ge.paint,Te.transform.zoom,void 0,es),vc.draw(Te,Xe.gl.TRIANGLES,Uo?dn:Ft,mr.disabled,Uo||Jr.opacity<1||Gi.hasTranslucentParts?Cr.alphaBlended:Cr.unblended,yr.backCCW,Kc,Ge.id,li.vertexBuffer,li.indexBuffer,li.segments,Ge.paint,Te.transform.zoom,void 0,es)}}}}()}(w,h,g,S),void Y();if(ee.type!=="model")return;const te=ee.getModels(),le=[],ce=w.transform.getFreeCameraOptions().position,de=a.a6.vec3.scale([],[ce.x,ce.y,ce.z],w.transform.worldSize);a.a6.vec3.negate(de,de);const xe=[],be=[];let Se=0;for(const Te of te){const Oe=g.paint.get("model-rotation").constantOr(null),Ge=g.paint.get("model-scale").constantOr(null),Be=g.paint.get("model-translation").constantOr(null);Te.computeModelMatrix(w,Oe,Ge,Be,!0,!0,!1);const Xe=a.a6.mat4.identity([]),$e=a.de(Te.position.lat,w.transform.zoom),tt=a.a6.mat4.fromScaling([],[1,1,1/$e]);a.a6.mat4.translate(Xe,Xe,de),le.push({zScaleMatrix:tt,negCameraPosMatrix:Xe});for(const Je of Te.nodes)_d(w.transform,Je,Te.matrix,w.transform.expandedFarZProjMatrix,Se,xe,be);Se++}if(xe.sort((Te,Oe)=>Oe.depth-Te.depth),w.renderPass!=="shadow"){if(P===1)for(const Te of be)Qo(Te,w,g,le[Te.modelIndex],mr.disabled,w.colorModeForRenderPass());else{for(const Te of be)Qo(Te,w,g,le[Te.modelIndex],mr.disabled,Cr.disabled);for(const Te of be)Qo(Te,w,g,le[Te.modelIndex],w.stencilModeFor3D(),w.colorModeForRenderPass());w.resetStencilClippingMasks()}for(const Te of xe)Qo(Te,w,g,le[Te.modelIndex],mr.disabled,w.colorModeForRenderPass());Y()}else{for(const Te of be)oh(Te.mesh,Te.nodeModelMatrix,w,g);for(const Te of xe)oh(Te.mesh,Te.nodeModelMatrix,w,g);Y()}}},pc={model:function(w,h,g){const S=h.getSource();if(!S.loaded())return;if(S.type==="vector"||S.type==="geojson")return void(g.modelManager&&g.modelManager.upload(g,S.type==="vector"?w.scope:""));if(S.type==="batched-model"||S.type!=="model")return;const P=S.getModels();for(const D of P)D.upload(g.context)},raster:function(w,h,g){const S=h.getSource();if(!(S instanceof Ir&&S.loaded()))return;const P=w.sourceLayer||S.rasterLayerIds&&S.rasterLayerIds[0];if(!P)return;const D=w.paint.get("raster-array-band")||S.getInitialBand(P);if(D==null)return;const N=h.getIds().map($=>h.getTileByID($));for(const $ of N)$.updateNeeded(P,D)&&S.prepareTile($,P,D)},"raster-particle":function(w,h,g){const S=h.getSource();if(!(S instanceof Ir&&S.loaded()))return;const P=w.sourceLayer||S.rasterLayerIds&&S.rasterLayerIds[0];if(!P)return;const D=w.paint.get("raster-particle-array-band")||S.getInitialBand(P);if(D==null)return;const N=h.getIds().map($=>h.getTileByID($));for(const $ of N)$.updateNeeded(P,D)&&S.prepareTile($,P,D)}};class nl{constructor(h,g,S,P){this.context=new sm(h,g),this.transform=S,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=P,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const D=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const $ of D)this._debugParams.enabledLayers[$]=!0;P.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),P.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),P.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const $ of D)P.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],$);this.occlusionParams=new xd(P),this.setup(),this.numSublayers=Zo.maxUnderzooming+Zo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new xg(this),this._wireframeDebugCache=new fc,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const N=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,N,h.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(h,g){const S=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(S||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ud(this,h));const P=this._terrain;this.transform.elevation=S?P:null,P.update(h,this.transform,g),this.transform.elevation&&!P.enabled&&(this.transform.elevation=null)}_updateFog(h){const g=h.fog;if(!g||this.transform.projection.name==="globe"||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[S,P]=g.getFovAdjustedRange(this.transform._fov);if(S>P)return void(this.transform.fogCullDistSq=null);const D=S+.78*(P-S);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(h){h&&!this._terrain&&(this._terrain=new ud(this,this.style)),this._forceTerrainMode=h}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(h,g){if(this.width=h*a.q.devicePixelRatio,this.height=g*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const S of this.style.order)this.style._mergedLayers[S].resize()}setup(){const h=this.context,g=new a.a_;g.emplaceBack(0,0),g.emplaceBack(a.ab,0),g.emplaceBack(0,a.ab),g.emplaceBack(a.ab,a.ab),this.tileExtentBuffer=h.createVertexBuffer(g,a.b0.members),this.tileExtentSegments=a.b1.simpleSegment(0,0,4,2);const S=new a.a_;S.emplaceBack(0,0),S.emplaceBack(a.ab,0),S.emplaceBack(0,a.ab),S.emplaceBack(a.ab,a.ab),this.debugBuffer=h.createVertexBuffer(S,a.b0.members),this.debugSegments=a.b1.simpleSegment(0,0,4,5);const P=new a.a_;P.emplaceBack(-1,-1),P.emplaceBack(1,-1),P.emplaceBack(-1,1),P.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(P,a.b0.members),this.viewportSegments=a.b1.simpleSegment(0,0,4,2);const D=new a.aN;D.emplaceBack(0,0,0,0),D.emplaceBack(a.ab,0,a.ab,0),D.emplaceBack(0,a.ab,0,a.ab),D.emplaceBack(a.ab,a.ab,a.ab,a.ab),this.mercatorBoundsBuffer=h.createVertexBuffer(D,a.b3.members),this.mercatorBoundsSegments=a.b1.simpleSegment(0,0,4,2);const N=new a.aO;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(N);const $=new a.a$;for(const ee of[0,1,3,2,0])$.emplaceBack(ee);this.debugIndexBuffer=h.createIndexBuffer($),this.emptyTexture=new a.T(h,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA8),this.identityMat=a.a6.mat4.create();const Y=this.context.gl;this.stencilClearMode=new mr({func:Y.ALWAYS,mask:0},0,255,Y.ZERO,Y.ZERO,Y.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,h.TRIANGLES,qn.disabled,this.stencilClearMode,Cr.disabled,yr.disabled,Tu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,g,S){if(!g||this.currentStencilSource===g.id||!h.isTileClipped()||!S||S.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let $=!1;for(const Y of S)if(this._tileClippingMaskIDs[Y.key]===void 0){$=!0;break}if(!$)return}this.currentStencilSource=g.id;const P=this.context,D=P.gl;this.nextStencilID+S.length>256&&this.clearStencil(),P.setColorMode(Cr.disabled),P.setDepthMode(qn.disabled);const N=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const $ of S){const Y=g.getTile($),ee=this._tileClippingMaskIDs[$.key]=this.nextStencilID++,{tileBoundsBuffer:te,tileBoundsIndexBuffer:le,tileBoundsSegments:ce}=this.getTileBoundsBuffers(Y);N.draw(this,D.TRIANGLES,qn.disabled,new mr({func:D.ALWAYS,mask:0},ee,255,D.KEEP,D.KEEP,D.REPLACE),Cr.disabled,yr.disabled,Tu($.projMatrix),"$clipping",te,le,ce)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,g=this.context.gl;return new mr({func:g.NOTEQUAL,mask:255},h,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const g=this.context.gl;return new mr({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(h){const g=this.context.gl,S=h.sort((N,$)=>$.overscaledZ-N.overscaledZ),P=S[S.length-1].overscaledZ,D=S[0].overscaledZ-P+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const N={};for(let $=0;$<D;$++)N[$+P]=new mr({func:g.GEQUAL,mask:255},$+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=D,[N,S]}return[{[P]:mr.disabled},S]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new Cr([h.CONSTANT_COLOR,h.ONE,h.CONSTANT_COLOR,h.ONE],new a.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cr.unblended:Cr.alphaBlended}colorModeForDrapableLayerRenderPass(h){const g=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Cr([g.ONE,g.ONE_MINUS_SRC_ALPHA,g.CONSTANT_ALPHA,g.ONE_MINUS_SRC_ALPHA],new a.bz(0,0,0,h===void 0?0:h),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(h,g,S,P=!1){if(this.depthOcclusion)return new qn(this.context.gl.GREATER,qn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!P)return qn.disabled;const D=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new qn(S||this.context.gl.LEQUAL,g,[D,D])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const h=this.context.gl,g=Math.ceil(this.width),S=Math.ceil(this.height),P=this.context.bindFramebuffer.get(),D=h.getParameter(h.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===g&&this.depthFBO.height===S||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),g!==0&&S!==0&&(this.depthFBO=new Wc(this.context,g,S,!1,"texture"),this.depthTexture=new a.T(this.context,{width:g,height:S,data:null},h.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(P),h.bindTexture(h.TEXTURE_2D,D),this.depthFBO&&(h.bindFramebuffer(h.READ_FRAMEBUFFER,null),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),h.blitFramebuffer(0,0,g,S,0,0,g,S,h.DEPTH_BUFFER_BIT,h.NEAREST),h.bindFramebuffer(h.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((h,g)=>h+g/this._fpsHistory.length,0))}render(h,g){const S=a.q.now();this._dt=S-this._timeStamp,this._timeStamp=S,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=h.map.repaint,this.style=h,this.options=g;const P=this.style._mergedLayers,D=this.style.order.filter(at=>{const st=P[at];return!(st.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[st.type]});let N=!1,$=!1;for(const at of D){const st=P[at];st.type==="circle"&&(N=!0),st.type==="symbol"&&(st.hasInitialOcclusionOpacityProperties?$=!0:N=!0)}const Y=D.map(at=>P[at]),ee=this.style._mergedSourceCaches;this.imageManager=h.imageManager,this.modelManager=h.modelManager,this.symbolFadeChange=h.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let te=0,le=!1;for(const at in ee){const st=ee[at];st.used&&(st.prepare(this.context),st.getSource().usedInConflation&&++te)}let ce=!1;for(const at of Y)at.isHidden(this.transform.zoom)||(at.type==="clip"&&(ce=!0),this.prepareLayer(at));const de={},xe={},be={},Se={},Te={};for(const at in ee){const st=ee[at];de[at]=st.getVisibleCoordinates(),xe[at]=de[at].slice().reverse(),be[at]=st.getVisibleCoordinates(!0).reverse(),Se[at]=st.getShadowCasterCoordinates(),Te[at]=st.sortCoordinatesByDistance(de[at])}const Oe=at=>{const st=this.style.getLayerSourceCache(at);return st&&st.used?st.getSource():null};if(te||ce||this._clippingActiveLastFrame){const at=[],st=[];let wt=0;for(const zt of Y)this.isSourceForClippingOrConflation(zt,Oe(zt))&&(at.push(zt),st.push(wt)),wt++;if(at&&(ce||at.length>1)||this._clippingActiveLastFrame){ce=!1;const zt=[];for(let Zt=0;Zt<at.length;Zt++){const Ft=at[Zt],dn=st[Zt],St=this.style.getLayerSourceCache(Ft);if(!St||!St.used||!St.getSource().usedInConflation&&Ft.type!=="clip")continue;let $t=a.dn,Ht=a.bs.None;const fn=[];let mn=!0;if(Ft.type==="clip"){$t=dn;for(const Yt of Ft.layout.get("clip-layer-types"))Ht|=Yt==="model"?a.bs.Model:Yt==="symbol"?a.bs.Symbol:a.bs.FillExtrusion;for(const Yt of Ft.layout.get("clip-layer-scope"))fn.push(Yt);Ft.isHidden(this.transform.zoom)?mn=!1:ce=!0}mn&&zt.push({layer:Ft.fqid,cache:St,order:$t,clipMask:Ht,clipScope:fn})}this.replacementSource.setSources(zt),le=!0}}this._clippingActiveLastFrame=ce,le||this.replacementSource.clear(),this.conflationActive=le,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let at=0;at<Y.length;at++){const st=Y[at],wt=st.cutoffRange();if(this.longestCutoffRange=Math.max(wt,this.longestCutoffRange),wt>0){const zt=Oe(st);zt&&(this.minCutoffZoom=Math.max(zt.minzoom,this.minCutoffZoom)),st.minzoom&&(this.minCutoffZoom=Math.max(st.minzoom,this.minCutoffZoom))}st.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=at),this._lastOcclusionLayer=at)}const Ge=this.style&&this.style.fog;Ge?(this._fogVisible=Ge.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ge.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(be),this.opaquePassCutoff=0);const Be=this._shadowRenderer;if(Be){Be.updateShadowParameters(this.transform,this.style.directionalLight);for(const at in ee)for(const st of de[at]){let wt={min:0,max:0};this.terrain&&(wt=this.terrain.getMinMaxForTile(st)||wt),Be.addShadowReceiver(st.toUnwrapped(),wt.min,wt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new vd(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Ye.has(this.context.gl))return;this.renderPass="offscreen";for(const at of Y){const st=h.getLayerSourceCache(at);if(!at.hasOffscreenPass()||at.isHidden(this.transform.zoom))continue;const wt=st?xe[st.id]:void 0;(at.type==="custom"||at.type==="raster"||at.type==="raster-particle"||at.isSky()||wt&&wt.length)&&this.renderLayer(this,st,at,wt)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Se)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Xe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),$e=(()=>{if(g.showOverdrawInspector)return a.bz.black;const at=this.style.fog;if(at&&this.transform.projection.supportsFog){const st=this.style.getLut(at.scope);if(!Xe){const wt=at.properties.get("color").toRenderColor(st).toArray01();return new a.bz(...wt)}if(Xe){const wt=at.properties.get("space-color").toRenderColor(st).toArray01();return new a.bz(...wt)}}return a.bz.transparent})();if(this.context.clear({color:$e,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const at=Y[this.currentLayer],st=h.getLayerSourceCache(at);if(at.isSky())continue;const wt=st?(at.is3D()?Te:xe)[st.id]:void 0;this._renderTileClippingMasks(at,st,wt),this.renderLayer(this,st,at,wt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const at=Y[this.currentLayer],st=h.getLayerSourceCache(at);at.isSky()&&this.renderLayer(this,st,at,st?xe[st.id]:void 0)}function tt(at,st){let wt;return st&&(wt=(at.type==="symbol"?be:at.is3D()?Te:xe)[st.id]),wt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const at=Y[this.currentLayer];if(at.type==="raster"||at.type==="raster-particle"){const st=h.getLayerSourceCache(at);this.renderLayer(this,st,at,tt(at,st))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Je=0;Be&&(Je=Be.getShadowCastingLayerCount());let nt=!1,ht=-1;for(let at=0;at<D.length;++at){const st=Y[at];st.isHidden(this.transform.zoom)||st.is3D()&&(ht=at)}for($&&ht===-1&&(N=!0);this.currentLayer<D.length;){const at=Y[this.currentLayer],st=h.getLayerSourceCache(at);if(at.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(at)){if(at.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(N&&!nt&&this.terrain&&!this.transform.isOrthographic&&(nt=!0,this.blitDepth()),$&&ht!==-1&&this.currentLayer===ht+1&&!this.transform.isOrthographic&&this.blitDepth(),at.is3D()||this.terrain||this._renderTileClippingMasks(at,st,st?de[st.id]:void 0),this.renderLayer(this,st,at,tt(at,st)),!this.terrain&&Be&&Je>0&&at.hasShadowPass()&&--Je==0&&(Be.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const wt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=wt;this.currentLayer++){const zt=Y[this.currentLayer];if(!zt.hasLightBeamPass())continue;const Zt=h.getLayerSourceCache(zt);this.renderLayer(this,Zt,zt,Zt?xe[Zt.id]:void 0)}this.currentLayer=wt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const wt=this.currentLayer;this.depthOcclusion=!0;for(const zt of this.layersWithOcclusionOpacity){this.currentLayer=zt;const Zt=Y[this.currentLayer],Ft=h.getLayerSourceCache(Zt),dn=Ft?xe[Ft.id]:void 0;Zt.is3D()||this.terrain||this._renderTileClippingMasks(Zt,Ft,Ft?de[Ft.id]:void 0),this.renderLayer(this,Ft,Zt,dn)}this.depthOcclusion=!1,this.currentLayer=wt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let at=null;Y.forEach(st=>{const wt=h.getLayerSourceCache(st);wt&&!st.isHidden(this.transform.zoom)&&wt.getVisibleCoordinates().length&&(!at||at.getSource().maxzoom<wt.getSource().maxzoom)&&(at=wt)}),at&&this.options.showTileBoundaries&&to.debug(this,at,at.getVisibleCoordinates(),a.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&to.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(at){const st=at.transform.padding;qi(at,at.transform.height-(st.top||0),3,m_),qi(at,st.bottom||0,3,rh),Tt(at,st.left||0,3,ih),Tt(at,at.transform.width-(st.right||0),3,vn);const wt=at.transform.centerPoint;(function(zt,Zt,Ft,dn){Fs(zt,Zt-1,Ft-10,2,20,dn),Fs(zt,Zt-10,Ft-1,20,2,dn)})(at,wt.x,at.transform.height-wt.y,Jn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),le||(this.conflationActive=!1)}prepareLayer(h){this.gpuTimingStart(h);const{unsupportedLayers:g}=this.transform.projection,S=!g||!g.includes(h.type);if(pc[h.type]&&(S||this.terrain&&h.type==="custom")){const P=this.style.getLayerSourceCache(h);pc[h.type](h,P,this)}this.gpuTimingEnd()}renderLayer(h,g,S,P){S.isHidden(this.transform.zoom)||(S.type==="background"||S.type==="sky"||S.type==="custom"||S.type==="model"||S.type==="raster"||S.type==="raster-particle"||P&&P.length)&&(this.id=S.id,this.gpuTimingStart(S),h.transform.projection.unsupportedLayers&&h.transform.projection.unsupportedLayers.includes(S.type)&&(!h.terrain||S.type!=="custom")||S.type==="clip"||to[S.type](h,g,S,P,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery,S=this.context.gl;let P=this.gpuTimers[h.id];P||(P=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:S.createQuery()}),P.calls++,S.beginQuery(g.TIME_ELAPSED_EXT,P.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,g=this.context.gl,S=g.createQuery();this.deferredRenderGpuTimeQueries.push(S),g.beginQuery(h.TIME_ELAPSED_EXT,S)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const g={};for(const S in h){const P=h[S],D=this.context.extTimerQuery,N=D.getQueryParameter(P.query,this.context.gl.QUERY_RESULT)/1e6;D.deleteQueryEXT(P.query),g[S]=N}return g}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery,S=this.context.gl;let P=0;for(const D of h)P+=g.getQueryParameter(D,S.QUERY_RESULT)/1e6,g.deleteQueryEXT(D);return P}translatePosMatrix(h,g,S,P,D){if(!S[0]&&!S[1])return h;const N=D?P==="map"?this.transform.angle:0:P==="viewport"?-this.transform.angle:0;if(N){const ee=Math.sin(N),te=Math.cos(N);S=[S[0]*te-S[1]*ee,S[0]*ee+S[1]*te]}const $=[D?S[0]:a.ak(g,S[0],this.transform.zoom),D?S[1]:a.ak(g,S[1],this.transform.zoom),0],Y=new Float32Array(16);return a.a6.mat4.translate(Y,h,$),Y}saveTileTexture(h){const g=h.size[0],S=this._tileTextures[g];S?S.push(h):this._tileTextures[g]=[h]}getTileTexture(h){const g=this._tileTextures[h];return g&&g.length>0?g.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(h,g,S){const P=S===void 0?this.terrain&&this.terrain.renderingToTexture:S,D=[];return this.style&&this.style.enable3dLights()&&(h==="globeRaster"||h==="terrainRaster"?(D.push("LIGHTING_3D_MODE"),D.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):P||D.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||D.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?D.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):D.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(D.push("TERRAIN"),this.linearFloatFilteringSupported()&&D.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&D.push("GLOBE"),!this._fogVisible||P||g!==void 0&&!g||D.push("FOG","FOG_DITHERING"),P&&D.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&D.push("OVERDRAW_INSPECTOR"),D}getOrCreateProgram(h,g){this.cache=this.cache||{};const S=g&&g.defines||[],P=g&&g.config,D=this.currentGlobalDefines(h,g&&g.overrideFog,g&&g.overrideRtt).concat(S),N=Ao.cacheKey(Qu[h],h,D,P);return this.cache[N]||(this.cache[N]=new Ao(this.context,h,Qu[h],P,im[h],D)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(h,g){if(this.style.enable3dLights()){const S=this.style.directionalLight,P=this.style.ambientLight;if(S&&P){const D=((N,$,Y)=>{const ee=N.properties.get("direction"),te=N.properties.get("color").toRenderColor(Y.getLut(N.scope)).toArray01(),le=N.properties.get("intensity"),ce=$.properties.get("color").toRenderColor(Y.getLut($.scope)).toArray01(),de=$.properties.get("intensity"),xe=[ee.x,ee.y,ee.z],be=a.cH(ce,de),Se=a.cH(te,le);return{u_lighting_ambient_color:be,u_lighting_directional_dir:xe,u_lighting_directional_color:Se,u_ground_radiance:Jo(xe,Se,be)}})(S,P,this.style);g.setLightsUniformValues(h,D)}}}uploadCommonUniforms(h,g,S,P,D){if(this.uploadCommonLightUniforms(h,g),this.terrain&&this.terrain.renderingToTexture)return;const N=this.style.fog;if(N){const $=N.getOpacity(this.transform.pitch),Y=((ee,te,le,ce,de,xe,be,Se,Te,Oe,Ge,Be)=>{const Xe=ee.transform,$e=te.properties.get("color").toRenderColor(ee.style.getLut(te.scope)).toArray01();$e[3]=ce;const tt=ee.frameCounter/1e3%1,[Je,nt]=te.properties.get("vertical-range");return{u_fog_matrix:le?Xe.calculateFogTileMatrix(le):Be||ee.identityMat,u_fog_range:te.getFovAdjustedRange(Xe._fov),u_fog_color:$e,u_fog_horizon_blend:te.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Je,nt),nt],u_fog_temporal_offset:tt,u_frustum_tl:de,u_frustum_tr:xe,u_frustum_br:be,u_frustum_bl:Se,u_globe_pos:Te,u_globe_radius:Oe,u_viewport:Ge,u_globe_transition:a.a9(Xe.zoom),u_is_globe:+(Xe.projection.name==="globe")}})(this,N,S,$,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],P);g.setFogUniformValues(h,Y)}D&&g.setCutoffUniformValues(h,D.uniformValues)}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,g=h.createTexture();return h.bindTexture(h.TEXTURE_2D,g),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,g=this._backgroundTiles={},S=this.transform.coveringTiles({tileSize:512});for(const P of S)g[P.key]=h[P.key]||new zc(P,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(h,g){return!(!h.is3D()||h.type!=="clip"&&(h.minzoom&&h.minzoom>this.transform.zoom||(this.style._clipLayerPresent||h.sourceLayer!=="building")&&(!g||g.type!=="batched-model")))}isTileAffectedByFog(h){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let g=this._cachedTileFogOpacities[h.key];return g||(this._cachedTileFogOpacities[h.key]=g=this.style.fog.getOpacityForTile(h)),g[0]>=Cn||g[1]>=Cn}setupDepthForOcclusion(h,g,S){const P=this.context,D=P.gl,N=!!S;var $;S||(S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),P.activeTexture.set(D.TEXTURE3),h&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),S.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],S.u_depth_range_unpack=[2/(($=this.depthRangeFor3D)[1]-$[0]),-1-2*$[0]/($[1]-$[0])],S.u_occluder_half_size=.5*this.occlusionParams.occluderSize,S.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),P.activeTexture.set(D.TEXTURE0),N||g.setTerrainUniformValues(P,S)}}function kl(w,h){let g=!1,S=null;const P=()=>{S=null,g&&(w(),S=setTimeout(P,h),g=!1)};return()=>(g=!0,S||P(),S)}class fo{constructor(h){this._hashName=h&&encodeURIComponent(h),a.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=kl(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const g=$c(h);if(this._hashName){const S=this._hashName;let P=!1;const D=location.hash.slice(1).split("&").map(N=>{const $=N.split("=")[0];return $===S?(P=!0,`${$}=${g}`):N}).filter(N=>N);return P||D.push(`${S}=${g}`),`#${D.join("&")}`}return`#${g}`}_getCurrentHash(){const h=location.hash.replace("#","");if(this._hashName){let g;return h.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(g=S)}),(g&&g[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(S=>isNaN(S))){const S=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(g[3]||0):h.getBearing();return h.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:S,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function $c(w,h){const g=w.getCenter(),S=Math.round(100*w.getZoom())/100,P=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,P),N=Math.round(g.lng*D)/D,$=Math.round(g.lat*D)/D,Y=w.getBearing(),ee=w.getPitch();let te=h?`/${N}/${$}/${S}`:`${S}/${$}/${N}`;return(Y||ee)&&(te+="/"+Math.round(10*Y)/10),ee&&(te+=`/${Math.round(ee)}`),te}const Cu={linearity:.3,easing:a.dp(0,0,.3,1)},zf=a.l({deceleration:2500,maxSpeed:1400},Cu),v_=a.l({deceleration:20,maxSpeed:1400},Cu),Xc=a.l({deceleration:1e3,maxSpeed:360},Cu),Zg=a.l({deceleration:1e3,maxSpeed:90},Cu);class Eu{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,g=a.q.now();for(;h.length>0&&g-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const g={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)g.zoom+=D.zoomDelta||0,g.bearing+=D.bearingDelta||0,g.pitch+=D.pitchDelta||0,D.panDelta&&g.pan._add(D.panDelta),D.around&&(g.around=D.around),D.pinchAround&&(g.pinchAround=D.pinchAround);const S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,P={};if(g.pan.mag()){const D=gl(g.pan.mag(),S,a.l({},zf,h||{}));P.offset=g.pan.mult(D.amount/g.pan.mag()),P.center=this._map.transform.center,ah(P,D)}if(g.zoom){const D=gl(g.zoom,S,v_);P.zoom=this._map.transform.zoom+D.amount,ah(P,D)}if(g.bearing){const D=gl(g.bearing,S,Xc);P.bearing=this._map.transform.bearing+a.ap(D.amount,-179,179),ah(P,D)}if(g.pitch){const D=gl(g.pitch,S,Zg);P.pitch=this._map.transform.pitch+D.amount,ah(P,D)}if(P.zoom||P.bearing){const D=g.pinchAround===void 0?g.around:g.pinchAround;P.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),P.noMoveStart=!0,P}}function ah(w,h){(!w.duration||w.duration<h.duration)&&(w.duration=h.duration,w.easing=h.easing)}function gl(w,h,g){const{maxSpeed:S,linearity:P,deceleration:D}=g,N=a.ap(w*P/(h/1e3),-S,S),$=Math.abs(N)/(D*P);return{easing:g.easing,duration:1e3*$,amount:N*($/2)}}class Sa extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g,S,P={}){const D=se(g.getCanvasContainer(),S),N=g.unproject(D);super(h,a.l({point:D,lngLat:N,originalEvent:S},P)),this._defaultPrevented=!1,this.target=g}}class bd extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g,S){const P=h==="touchend"?S.changedTouches:S.touches,D=ae(g.getCanvasContainer(),P),N=D.map(Y=>g.unproject(Y)),$=D.reduce((Y,ee,te,le)=>Y.add(ee.div(le.length)),new a.P(0,0));super(h,{points:D,point:$,lngLats:N,lngLat:g.unproject($),originalEvent:S}),this._defaultPrevented=!1}}class To extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g){super("wheel",{originalEvent:g}),this._defaultPrevented=!1}}class Uf{constructor(h,g){this._map=h,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new To(this._map,h))}mousedown(h,g){return this._mousedownPos=g,this._firePreventable(new Sa(h.type,this._map,h))}mouseup(h){this._map.fire(new Sa(h.type,this._map,h))}preclick(h){const g=a.l({},h);g.type="preclick",this._map.fire(new Sa(g.type,this._map,g))}click(h,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(h),this._map.fire(new Sa(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new Sa(h.type,this._map,h))}mouseover(h){this._map.fire(new Sa(h.type,this._map,h))}mouseout(h){this._map.fire(new Sa(h.type,this._map,h))}touchstart(h){return this._firePreventable(new bd(h.type,this._map,h))}touchmove(h){this._map.fire(new bd(h.type,this._map,h))}touchend(h){this._map.fire(new bd(h.type,this._map,h))}touchcancel(h){this._map.fire(new bd(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class __{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new Sa(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new Sa(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gf{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,g){this.isEnabled()&&h.shiftKey&&h.button===0&&(q(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(h,g){if(!this._active)return;const S=g,P=this._startPos,D=this._lastPos;if(!P||!D||D.equals(S)||!this._box&&S.dist(P)<this._clickTolerance)return;this._lastPos=S,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const N=Math.min(P.x,S.x),$=Math.max(P.x,S.x),Y=Math.min(P.y,S.y),ee=Math.max(P.y,S.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${N}px,${Y}px)`,this._box.style.width=$-N+"px",this._box.style.height=ee-Y+"px")})}mouseupWindow(h,g){if(!this._active)return;const S=this._startPos,P=g;if(S&&h.button===0){if(this.reset(),re(),S.x!==P.x||S.y!==P.y)return this._map.fire(new a.x("boxzoomend",{originalEvent:h})),{cameraAnimation:D=>D.fitScreenCoordinates(S,P,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(h,g){return this._map.fire(new a.x(h,{originalEvent:g}))}}function qc(w,h){const g={};for(let S=0;S<w.length;S++)g[w[S].identifier]=h[S];return g}class Kg{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,g,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),S.length===this.numTouches&&(this.centroid=function(P){const D=new a.P(0,0);for(const N of P)D._add(N);return D.div(P.length)}(g),this.touches=qc(S,g)))}touchmove(h,g,S){if(this.aborted||!this.centroid)return;const P=qc(S,g);for(const D in this.touches){const N=P[D];(!N||N.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(h,g,S){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),S.length===0){const P=!this.aborted&&this.centroid;if(this.reset(),P)return P}}}class mc{constructor(h){this.singleTap=new Kg(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,g,S){this.singleTap.touchstart(h,g,S)}touchmove(h,g,S){this.singleTap.touchmove(h,g,S)}touchend(h,g,S){const P=this.singleTap.touchend(h,g,S);if(P){const D=h.timeStamp-this.lastTime<500,N=!this.lastTap||this.lastTap.dist(P)<30;if(D&&N||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=P,this.count===this.numTaps)return this.reset(),P}}}class y_{constructor(){this._zoomIn=new mc({numTouches:1,numTaps:2}),this._zoomOut=new mc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,g,S){this._zoomIn.touchstart(h,g,S),this._zoomOut.touchstart(h,g,S)}touchmove(h,g,S){this._zoomIn.touchmove(h,g,S),this._zoomOut.touchmove(h,g,S)}touchend(h,g,S){const P=this._zoomIn.touchend(h,g,S),D=this._zoomOut.touchend(h,g,S);return P?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()+1,around:N.unproject(P)},{originalEvent:h})}):D?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()-1,around:N.unproject(D)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const gc={0:1,2:2};class Vf{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,g){return!1}_move(h,g){return{}}mousedown(h,g){if(this._lastPoint)return;const S=he(h);this._correctButton(h,S)&&(this._lastPoint=g,this._eventButton=S)}mousemoveWindow(h,g){const S=this._lastPoint;if(S){if(h.preventDefault(),this._eventButton!=null&&function(P,D){const N=gc[D];return P.buttons===void 0||(P.buttons&N)!==N}(h,this._eventButton))this.reset();else if(this._moved||!(g.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(S,g)}}mouseupWindow(h){this._lastPoint&&he(h)===this._eventButton&&(this._moved&&re(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class da extends Vf{mousedown(h,g){super.mousedown(h,g),this._lastPoint&&(this._active=!0)}_correctButton(h,g){return g===0&&!h.ctrlKey}_move(h,g){return{around:g,panDelta:g.sub(h)}}}class Jg extends Vf{_correctButton(h,g){return g===0&&h.ctrlKey||g===2}_move(h,g){const S=.8*(g.x-h.x);if(S)return this._active=!0,{bearingDelta:S}}contextmenu(h){h.preventDefault()}}class um extends Vf{_correctButton(h,g){return g===0&&h.ctrlKey||g===2}_move(h,g){const S=-.5*(g.y-h.y);if(S)return this._active=!0,{pitchDelta:S}}contextmenu(h){h.preventDefault()}}class Jx{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),a.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(h,g,S){return this._calculateTransform(h,g,S)}touchmove(h,g,S){if(this._active&&!(S.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(S.length===1&&!a.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,g,S)}}touchend(h,g,S){this._calculateTransform(h,g,S),this._active&&S.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,g,S){S.length>0&&(this._active=!0);const P=qc(S,g),D=new a.P(0,0),N=new a.P(0,0);let $=0;for(const ee in P){const te=P[ee],le=this._touches[ee];le&&(D._add(te),N._add(te.sub(le)),$++,P[ee]=te)}if(this._touches=P,$<this._minTouches||!N.mag())return;const Y=N.div($);return this._sum._add(Y),this._sum.mag()<this._clickTolerance?void 0:{around:D.div($),panDelta:Y}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Qg{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,g,S){return{}}touchstart(h,g,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([g[0],g[1]]))}touchmove(h,g,S){const P=this._firstTwoTouches;if(!P)return;h.preventDefault();const[D,N]=P,$=Hf(S,g,D),Y=Hf(S,g,N);if(!$||!Y)return;const ee=this._aroundCenter?null:$.add(Y).div(2);return this._move([$,Y],ee,h)}touchend(h,g,S){if(!this._firstTwoTouches)return;const[P,D]=this._firstTwoTouches,N=Hf(S,g,P),$=Hf(S,g,D);N&&$||(this._active&&re(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Hf(w,h,g){for(let S=0;S<w.length;S++)if(w[S].identifier===g)return h[S]}function ev(w,h){return Math.log(w/h)/Math.LN2}class Qx extends Qg{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,g){const S=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(ev(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ev(this._distance,S),pinchAround:g}}}function rl(w,h){return 180*w.angleWith(h)/Math.PI}class tv extends Qg{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,g){const S=this._vector;if(this._vector=h[0].sub(h[1]),S&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:rl(this._vector,S),pinchAround:g}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const g=25/(Math.PI*this._minDiameter)*360,S=this._startVector;if(!S)return!1;const P=rl(h,S);return Math.abs(P)<g}}function nv(w){return Math.abs(w.y)>Math.abs(w.x)}class Iu extends Qg{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,nv(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,g,S){const P=this._lastPoints;if(!P)return;const D=h[0].sub(P[0]),N=h[1].sub(P[1]);return this._map._cooperativeGestures&&!a.dq()&&S.touches.length<3||(this._valid=this.gestureBeginsVertically(D,N,S.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(D.y+N.y)/2*-.5})}gestureBeginsVertically(h,g,S){if(this._valid!==void 0)return this._valid;const P=h.mag()>=2,D=g.mag()>=2;if(!P&&!D)return;if(!P||!D)return this._firstMove==null&&(this._firstMove=S),S-this._firstMove<100&&void 0;const N=h.y>0==g.y>0;return nv(h)&&nv(g)&&N}}const hm={panStep:100,bearingStep:15,pitchStep:10};class lh{constructor(){const h=hm;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let g=0,S=0,P=0,D=0,N=0;switch(h.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:h.shiftKey?S=-1:(h.preventDefault(),D=-1);break;case 39:h.shiftKey?S=1:(h.preventDefault(),D=1);break;case 38:h.shiftKey?P=1:(h.preventDefault(),N=-1);break;case 40:h.shiftKey?P=-1:(h.preventDefault(),N=1);break;default:return}return this._rotationDisabled&&(S=0,P=0),{cameraAnimation:$=>{const Y=$.getZoom();$.easeTo({duration:300,easeId:"keyboardHandler",easing:dm,zoom:g?Math.round(Y)+g*(h.shiftKey?2:1):Y,bearing:$.getBearing()+S*this._bearingStep,pitch:$.getPitch()+P*this._pitchStep,offset:[-D*this._panStep,-N*this._panStep],center:$.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function dm(w){return w*(2-w)}const fm=4.000244140625,x_=1/450;class nS{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._handler=g,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=x_,a.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||a.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=h.deltaMode===WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const S=a.q.now(),P=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,g!==0&&g%fm==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":P>400?(this._type=null,this._lastValue=g,this._timeout=window.setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(P*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),h.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=h,this._delta-=g,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=se(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const ee=this._type==="wheel"&&Math.abs(this._delta)>fm?this._wheelZoomRate:this._defaultZoomRate;let te=2/(1+Math.exp(-Math.abs(this._delta*ee)));this._delta<0&&te!==0&&(te=1/te);const le=g(),ce=Math.pow(2,le),de=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):ce;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(de*te))),this._type==="wheel"&&(this._startZoom=le,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const S=typeof this._targetZoom=="number"?this._targetZoom:g(),P=this._startZoom,D=this._easing;let N,$=!1;if(this._type==="wheel"&&P&&D){const ee=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),te=D(ee);N=a.aa(P,S,te),ee<1?this._frameId||(this._frameId=!0):$=!0}else N=S,$=!0;this._active=!0,$&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let Y=N-g();return Y*this._lastDelta<0&&(Y=0),{noInertia:!0,needsRenderFrame:!$,zoomDelta:Y,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let g=a.dr;if(this._prevEase){const S=this._prevEase,P=(a.q.now()-S.start)/S.duration,D=S.easing(P+.01)-S.easing(P),N=.27/Math.sqrt(D*D+1e-4)*.01,$=Math.sqrt(.0729-N*N);g=a.dp(N,$,.25,1)}return this._prevEase={start:a.q.now(),duration:h,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class As{constructor(h,g){this._clickZoom=h,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class b_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,g){return h.preventDefault(),{cameraAnimation:S=>{S.easeTo({duration:300,zoom:S.getZoom()+(h.shiftKey?-1:1),around:S.unproject(g)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class e1{constructor(){this._tap=new mc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,g,S){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=g[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(h,g,S))}touchmove(h,g,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;const P=g[0],D=P.y-this._swipePoint.y;return this._swipePoint=P,h.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(h,g,S)}touchend(h,g,S){this._tapTime?this._swipePoint&&S.length===0&&this.reset():this._tap.touchend(h,g,S)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class t1{constructor(h,g,S){this._el=h,this._mousePan=g,this._touchPan=S}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wd{constructor(h,g,S){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=g,this._mousePitch=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class n1{constructor(h,g,S,P){this._el=h,this._touchZoom=g,this._touchRotate=S,this._tapDragZoom=P,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const jf=w=>w.zoom||w.drag||w.pitch||w.rotate;class B extends a.x{}class F{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,g){const S=a.a6.vec3.sub([],g,h);this.radius=a.a6.vec3.length(S[2]<0?a.a6.vec3.div([],S,this.constants):[S[0],S[1],0])}projectRay(h){a.a6.vec3.div(h,h,this.constants),a.a6.vec3.normalize(h,h),a.a6.vec3.mul(h,h,this.constants);const g=a.a6.vec3.scale([],h,this.radius);if(g[2]>0){const S=a.a6.vec3.scale([],[0,0,1],a.a6.vec3.dot(g,[0,0,1])),P=a.a6.vec3.scale([],a.a6.vec3.normalize([],[g[0],g[1],0]),this.radius),D=a.a6.vec3.add([],g,a.a6.vec3.scale([],a.a6.vec3.sub([],a.a6.vec3.add([],P,S),g),2));g[0]=D[0],g[1]=D[1]}return g}}function K(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}class oe{constructor(h,g){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Eu(h),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new F,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),a.aJ(["handleEvent","handleWindowEvent"],this);const S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[window,"blur",void 0]];for(const[P,D,N]of this._listeners){const $=P===document?this.handleWindowEvent:this.handleEvent;P.addEventListener(D,$,N)}}destroy(){for(const[h,g,S]of this._listeners){const P=h===document?this.handleWindowEvent:this.handleEvent;h.removeEventListener(g,P,S)}}_addDefaultHandlers(h){const g=this._map,S=g.getCanvasContainer();this._add("mapEvent",new Uf(g,h));const P=g.boxZoom=new Gf(g,h);this._add("boxZoom",P);const D=new y_,N=new b_;g.doubleClickZoom=new As(N,D),this._add("tapZoom",D),this._add("clickZoom",N);const $=new e1;this._add("tapDragZoom",$);const Y=g.touchPitch=new Iu(g);this._add("touchPitch",Y);const ee=new Jg(h),te=new um(h);g.dragRotate=new wd(h,ee,te),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",te,["mouseRotate"]);const le=new da(h),ce=new Jx(g,h);g.dragPan=new t1(S,le,ce),this._add("mousePan",le),this._add("touchPan",ce,["touchZoom","touchRotate"]);const de=new tv,xe=new Qx;g.touchZoomRotate=new n1(S,xe,de,$),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",xe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new __(g));const be=g.scrollZoom=new nS(g,this);this._add("scrollZoom",be,["mousePan"]);const Se=g.keyboard=new lh;this._add("keyboard",Se);for(const Te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[Te]&&g[Te].enable(h[Te])}_add(h,g,S){this._handlers.push({handlerName:h,handler:g,allowed:S}),this._handlersById[h]=g}stop(h){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!jf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,g,S){for(const P in h)if(P!==S&&(!g||g.indexOf(P)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const g=[];for(const S of h)this._el.contains(S.target)&&g.push(S);return g}handleEvent(h,g){this._updatingCamera=!0;const S=h.type==="renderFrame",P=S?void 0:h,D={needsRenderFrame:!1},N={},$={},Y=h.touches?this._getMapTouches(h.touches):void 0,ee=Y?ae(this._el,Y):S?void 0:se(this._el,h);for(const{handlerName:ce,handler:de,allowed:xe}of this._handlers){if(!de.isEnabled())continue;let be;this._blockedByActive($,xe,ce)?de.reset():de[g||h.type]&&(be=de[g||h.type](h,ee,Y),this.mergeHandlerResult(D,N,be,ce,P),be&&be.needsRenderFrame&&this._triggerRenderFrame()),(be||de.isActive())&&($[ce]=de)}const te={};for(const ce in this._previousActiveHandlers)$[ce]||(te[ce]=P);this._previousActiveHandlers=$,(Object.keys(te).length||K(D))&&(this._changes.push([D,N,te]),this._triggerRenderFrame()),(Object.keys($).length||K(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:le}=D;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))}mergeHandlerResult(h,g,S,P,D){if(!S)return;a.l(h,S);const N={handlerName:P,originalEvent:S.originalEvent||D};S.zoomDelta!==void 0&&(g.zoom=N),S.panDelta!==void 0&&(g.drag=N),S.pitchDelta!==void 0&&(g.pitch=N),S.bearingDelta!==void 0&&(g.rotate=N)}_applyChanges(){const h={},g={},S={};for(const[P,D,N]of this._changes)P.panDelta&&(h.panDelta=(h.panDelta||new a.P(0,0))._add(P.panDelta)),P.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+P.zoomDelta),P.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+P.bearingDelta),P.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+P.pitchDelta),P.around!==void 0&&(h.around=P.around),P.aroundCoord!==void 0&&(h.aroundCoord=P.aroundCoord),P.pinchAround!==void 0&&(h.pinchAround=P.pinchAround),P.noInertia&&(h.noInertia=P.noInertia),a.l(g,D),a.l(S,N);this._updateMapTransform(h,g,S),this._changes=[]}_updateMapTransform(h,g,S){const P=this._map,D=P.transform,N=Oe=>[Oe.x,Oe.y,Oe.z];if((Oe=>{const Ge=this._eventsInProgress.drag;return Ge&&!this._handlersById[Ge.handlerName].isActive()})()&&!K(h)){const Oe=D.zoom;D.cameraElevationReference="sea",this._originalZoom!=null&&D._orthographicProjectionAtLowPitch&&D.projection.name!=="globe"&&D.pitch===0?(D.cameraElevationReference="ground",D.zoom=this._originalZoom):(D.recenterOnTerrain(),D.cameraElevationReference="ground"),Oe!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&P._stop(!0),!K(h))return void this._fireEvents(g,S,!0);let{panDelta:$,zoomDelta:Y,bearingDelta:ee,pitchDelta:te,around:le,aroundCoord:ce,pinchAround:de}=h;D._isCameraConstrained&&(Y>0&&(Y=0),D._isCameraConstrained=!1),de!==void 0&&(le=de),(Y||(Oe=>g[Oe]&&!this._eventsInProgress[Oe])("drag"))&&le&&(this._dragOrigin=N(D.pointCoordinate3D(le)),this._originalZoom=D.zoom,this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",P._stop(!0),le=le||P.transform.centerPoint,ee&&(D.bearing+=ee),te&&(D.pitch+=te),D._updateCameraState();const xe=[0,0,0];if($)if(D.projection.name==="mercator"){const Oe=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(le).dir),Ge=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(le.sub($)).dir);xe[0]=Ge[0]-Oe[0],xe[1]=Ge[1]-Oe[1]}else{const Oe=D.pointCoordinate(le);if(D.projection.name==="globe"){$=$.rotate(-D.angle);const Ge=D._pixelsPerMercatorPixel/D.worldSize;xe[0]=-$.x*a.ds(a.aM(Oe.y))*Ge,xe[1]=-$.y*a.ds(D.center.lat)*Ge}else{const Ge=D.pointCoordinate(le.sub($));Oe&&Ge&&(xe[0]=Ge.x-Oe.x,xe[1]=Ge.y-Oe.y)}}const be=D.zoom,Se=[0,0,0];if(Y){const Oe=N(ce||D.pointCoordinate3D(le)),Ge={dir:a.a6.vec3.normalize([],a.a6.vec3.sub([],Oe,D._camera.position))};if(Ge.dir[2]<0){const Be=D.zoomDeltaToMovement(Oe,Y);a.a6.vec3.scale(Se,Ge.dir,Be)}}const Te=a.a6.vec3.add(xe,xe,Se);D._translateCameraConstrained(Te),Y&&Math.abs(D.zoom-be)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(g,S,!0)}_fireEvents(h,g,S){const P=jf(this._eventsInProgress),D=jf(h),N={};for(const te in h){const{originalEvent:le}=h[te];this._eventsInProgress[te]||(N[`${te}start`]=le),this._eventsInProgress[te]=h[te]}!P&&D&&this._fireEvent("movestart",D.originalEvent);for(const te in N)this._fireEvent(te,N[te]);D&&this._fireEvent("move",D.originalEvent);for(const te in h){const{originalEvent:le}=h[te];this._fireEvent(te,le)}const $={};let Y;for(const te in this._eventsInProgress){const{handlerName:le,originalEvent:ce}=this._eventsInProgress[te];this._handlersById[le].isActive()||(delete this._eventsInProgress[te],Y=g[le]||ce,$[`${te}end`]=Y)}for(const te in $)this._fireEvent(te,$[te]);const ee=jf(this._eventsInProgress);if(S&&(P||D)&&!ee){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),le=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;te?(le(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:Y})):(this._map.fire(new a.x("moveend",{originalEvent:Y})),le(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,g){this._map.fire(new a.x(h,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new B("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ge="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Me extends a.E{constructor(h,g){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,this._respectPrefersReducedMotion=g.respectPrefersReducedMotion!==!1,a.aJ(["_renderFrameCallback"],this)}getCenter(){return new a.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(h,g){return this.jumpTo({center:h},g)}panBy(h,g,S){return h=a.P.convert(h).mult(-1),this.panTo(this.transform.center,a.l({offset:h},g),S)}panTo(h,g,S){return this.easeTo(a.l({center:h},g),S)}getZoom(){return this.transform.zoom}setZoom(h,g){return this.jumpTo({zoom:h},g),this}zoomTo(h,g,S){return this.easeTo(a.l({zoom:h},g),S)}zoomIn(h,g){return this.zoomTo(this.getZoom()+1,h,g),this}zoomOut(h,g){return this.zoomTo(this.getZoom()-1,h,g),this}getBearing(){return this.transform.bearing}setBearing(h,g){return this.jumpTo({bearing:h},g),this}getPadding(){return this.transform.padding}setPadding(h,g){return this.jumpTo({padding:h},g),this}rotateTo(h,g,S){return this.easeTo(a.l({bearing:h},g),S)}resetNorth(h,g){return this.rotateTo(0,a.l({duration:1e3},h),g),this}resetNorthPitch(h,g){return this.easeTo(a.l({bearing:0,pitch:0,duration:1e3},h),g),this}snapToNorth(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this}getPitch(){return this.transform.pitch}setPitch(h,g){return this.jumpTo({pitch:h},g),this}cameraForBounds(h,g){h=a.as.convert(h);const S=g&&g.bearing||0,P=g&&g.pitch||0,D=h.getNorthWest(),N=h.getSouthEast();return this._cameraForBounds(this.transform,D,N,S,P,g)}_extendPadding(h){const g={top:0,right:0,bottom:0,left:0};return h==null?a.l({},g,this.transform.padding):typeof h=="number"?{top:h,bottom:h,right:h,left:h}:a.l({},g,h)}_extendCameraOptions(h){return(h=a.l({offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=this._extendPadding(h.padding),h}_minimumAABBFrustumDistance(h,g){const S=g.max[0]-g.min[0],P=g.max[1]-g.min[1];return S/P>h.aspect?S/(2*Math.tan(.5*h.fovX)*h.aspect):P/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,g,S,P,D,N){const $=h.clone(),Y=this._extendCameraOptions(N);$.bearing=P,$.pitch=D;const ee=a.bK.convert(g),te=a.bK.convert(S),le=.5*(ee.lat+te.lat),ce=.5*(ee.lng+te.lng),de=a.dt(le,ce),xe=a.a6.vec3.normalize([],de),be=a.a6.vec3.normalize([],a.a6.vec3.cross([],xe,[0,1,0])),Se=a.a6.vec3.cross([],be,xe),Te=[be[0],be[1],be[2],0,Se[0],Se[1],Se[2],0,xe[0],xe[1],xe[2],0,0,0,0,1],Oe=[de,a.dt(ee.lat,ee.lng),a.dt(te.lat,ee.lng),a.dt(te.lat,te.lng),a.dt(ee.lat,te.lng),a.dt(le,ee.lng),a.dt(le,te.lng),a.dt(ee.lat,ce),a.dt(te.lat,ce)];let Ge=a.c9.fromPoints(Oe.map(Ht=>[a.a6.vec3.dot(be,Ht),a.a6.vec3.dot(Se,Ht),a.a6.vec3.dot(xe,Ht)]));const Be=a.a6.vec3.transformMat4([],Ge.center,Te);a.a6.vec3.squaredLength(Be)===0&&a.a6.vec3.set(Be,0,0,1),a.a6.vec3.normalize(Be,Be),a.a6.vec3.scale(Be,Be,a.aq),$.center=a.du(Be);const Xe=$.getWorldToCameraMatrix(),$e=a.a6.mat4.invert(new Float64Array(16),Xe);Ge=a.c9.applyTransform(Ge,a.a6.mat4.multiply([],Xe,Te));const tt=this._extendAABB(Ge,$,Y,P);if(!tt)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ge=tt,a.a6.vec3.transformMat4(Be,Be,Xe);const Je=.5*(Ge.max[2]-Ge.min[2]),nt=this._minimumAABBFrustumDistance($,Ge),ht=a.a6.vec3.scale([],[0,0,1],Je),at=a.a6.vec3.add(ht,Be,ht),st=nt+($.pitch===0?0:a.a6.vec3.distance(Be,at)),wt=$.globeCenterInViewSpace,zt=a.a6.vec3.sub([],Be,[wt[0],wt[1],wt[2]]);a.a6.vec3.normalize(zt,zt),a.a6.vec3.scale(zt,zt,st);const Zt=a.a6.vec3.add([],Be,zt);a.a6.vec3.transformMat4(Zt,Zt,$e);const Ft=a.dw/a.aq,dn=a.a6.vec3.length(Zt),St=a.bD(Math.max(dn*Ft-a.dw,Number.EPSILON),0),$t=Math.min($.zoomFromMercatorZAdjusted(St),Y.maxZoom);return $t>.5*(a.c2+a.bU)?($.setProjection({name:"mercator"}),$.zoom=$t,this._cameraForBounds($,g,S,P,D,N)):{center:$.center,zoom:$t,bearing:P,pitch:D}}_extendAABB(h,g,S,P){const D=.5*((S.padding.left||0)+(S.padding.right||0)),N=.5*((S.padding.top||0)+(S.padding.bottom||0)),$=N,Y=D,ee=D,te=N,le=g.width-(Y+ee),ce=g.height-($+te),de=a.a6.vec3.sub([],h.max,h.min),xe=Math.min(le/de[0],ce/de[1]),be=Math.min(g.scaleZoom(g.scale*xe),S.maxZoom);if(isNaN(be))return null;const Se=g.scale/g.zoomScale(be),Te=new a.c9([h.min[0]-Y*Se,h.min[1]-te*Se,h.min[2]],[h.max[0]+ee*Se,h.max[1]+$*Se,h.max[2]]),Oe=(typeof S.offset.x=="number"&&typeof S.offset.y=="number"?new a.P(S.offset.x,S.offset.y):a.P.convert(S.offset)).rotate(-a.bB(P));return Te.center[0]-=Oe.x*Se,Te.center[1]+=Oe.y*Se,Te}queryTerrainElevation(h,g){const S=this.transform.elevation;return S?(g=a.l({},{exaggerated:!0},g),S.getAtPoint(a.a5.fromLngLat(h),null,g.exaggerated)):null}_cameraForBounds(h,g,S,P,D,N){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,g,S,P,D,N);const $=h.clone(),Y=this._extendCameraOptions(N);$.bearing=P,$.pitch=D;const ee=a.bK.convert(g),te=a.bK.convert(S),le=new a.bK(ee.lng,te.lat),ce=new a.bK(te.lng,ee.lat),de=$.project(ee),xe=$.project(te),be=this.queryTerrainElevation(ee),Se=this.queryTerrainElevation(te),Te=this.queryTerrainElevation(le),Oe=this.queryTerrainElevation(ce),Ge=[[de.x,de.y,Math.min(be||0,Se||0,Te||0,Oe||0)],[xe.x,xe.y,Math.max(be||0,Se||0,Te||0,Oe||0)]];let Be=a.c9.fromPoints(Ge);const Xe=$.getWorldToCameraMatrix(),$e=a.a6.mat4.invert(new Float64Array(16),Xe);Be=a.c9.applyTransform(Be,Xe);const tt=this._extendAABB(Be,$,Y,P);if(!tt)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Be=tt;const Je=.5*a.a6.vec3.sub([],Be.max,Be.min)[2],nt=this._minimumAABBFrustumDistance($,Be),ht=[0,0,1,0];a.a6.vec4.transformMat4(ht,ht,Xe),a.a6.vec4.normalize(ht,ht);const at=a.a6.vec3.scale([],ht,nt+Je),st=a.a6.vec3.add([],Be.center,at);a.a6.vec3.transformMat4(Be.center,Be.center,$e),a.a6.vec3.transformMat4(st,st,$e);const wt=$.unproject(new a.P(Be.center[0],Be.center[1])),zt=a.dv($.projection,wt),Zt=Math.pow(2,zt),Ft=Math.min($._zoomFromMercatorZ(st[2]*$.pixelsPerMeter*Zt/$.worldSize),Y.maxZoom);return $.mercatorFromTransition&&Ft<.5*(a.c2+a.bU)?($.setProjection({name:"globe"}),$.zoom=Ft,this._cameraForBounds($,g,S,P,D,N)):{center:wt,zoom:Ft,bearing:P,pitch:D}}fitBounds(h,g,S){const P=this.cameraForBounds(h,g);return this._fitInternal(P,g,S)}fitScreenCoordinates(h,g,S,P,D){const N=a.P.convert(h),$=a.P.convert(g),Y=new a.P(Math.min(N.x,$.x),Math.min(N.y,$.y)),ee=new a.P(Math.max(N.x,$.x),Math.max(N.y,$.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(N,$))return this;const te=this.transform.pointLocation3D(Y),le=this.transform.pointLocation3D(ee),ce=this.transform.pointLocation3D(new a.P(Y.x,ee.y)),de=this.transform.pointLocation3D(new a.P(ee.x,Y.y)),xe=[Math.min(te.lng,le.lng,ce.lng,de.lng),Math.min(te.lat,le.lat,ce.lat,de.lat)],be=[Math.max(te.lng,le.lng,ce.lng,de.lng),Math.max(te.lat,le.lat,ce.lat,de.lat)],Se=P&&P.pitch?P.pitch:this.getPitch(),Te=this._cameraForBounds(this.transform,xe,be,S,Se,P);return this._fitInternal(Te,P,D)}_fitInternal(h,g,S){return h?(g=a.l(h,g)).linear?this.easeTo(g,S):this.flyTo(g,S):this}jumpTo(h,g){this.stop();const S=h.preloadOnly?this.transform.clone():this.transform;let P=!1,D=!1,N=!1;"zoom"in h&&S.zoom!==+h.zoom&&(P=!0,S.zoom=+h.zoom),h.center!==void 0&&(S.center=a.bK.convert(h.center)),"bearing"in h&&S.bearing!==+h.bearing&&(D=!0,S.bearing=+h.bearing),"pitch"in h&&S.pitch!==+h.pitch&&(N=!0,S.pitch=+h.pitch);const $=typeof h.padding=="number"?this._extendPadding(h.padding):h.padding;if(h.padding!=null&&!S.isPaddingEqual($))if(h.retainPadding===!1){const Y=S.clone();Y.padding=$,S.setLocationAtPoint(S.center,Y.centerPoint)}else S.padding=$;return h.preloadOnly?(this._preloadTiles(S),this):(this.fire(new a.x("movestart",g)).fire(new a.x("move",g)),P&&this.fire(new a.x("zoomstart",g)).fire(new a.x("zoom",g)).fire(new a.x("zoomend",g)),D&&this.fire(new a.x("rotatestart",g)).fire(new a.x("rotate",g)).fire(new a.x("rotateend",g)),N&&this.fire(new a.x("pitchstart",g)).fire(new a.x("pitch",g)).fire(new a.x("pitchend",g)),this.fire(new a.x("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(ge),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,g){const S=this.transform;if(!S.projection.supportsFreeCamera)return a.w(ge),this;this.stop();const P=S.zoom,D=S.pitch,N=S.bearing;S.setFreeCameraOptions(h);const $=P!==S.zoom,Y=D!==S.pitch,ee=N!==S.bearing;return this.fire(new a.x("movestart",g)).fire(new a.x("move",g)),$&&this.fire(new a.x("zoomstart",g)).fire(new a.x("zoom",g)).fire(new a.x("zoomend",g)),ee&&this.fire(new a.x("rotatestart",g)).fire(new a.x("rotate",g)).fire(new a.x("rotateend",g)),Y&&this.fire(new a.x("pitchstart",g)).fire(new a.x("pitch",g)).fire(new a.x("pitchend",g)),this.fire(new a.x("moveend",g)),this}easeTo(h,g){this._stop(!1,h.easeId),((h=a.l({offset:[0,0],duration:500,easing:a.dr},h)).animate===!1||this._prefersReducedMotion(h))&&(h.duration=0);const S=this.transform,P=this.getZoom(),D=this.getBearing(),N=this.getPitch(),$=this.getPadding(),Y="zoom"in h?+h.zoom:P,ee="bearing"in h?this._normalizeBearing(h.bearing,D):D,te="pitch"in h?+h.pitch:N,le=this._extendPadding(h.padding),ce=a.P.convert(h.offset);let de,xe,be;if(S.projection.name==="globe"){const ht=a.a5.fromLngLat(S.center),at=ce.rotate(-S.angle);ht.x+=at.x/S.worldSize,ht.y+=at.y/S.worldSize;const st=ht.toLngLat(),wt=a.bK.convert(h.center||st);this._normalizeCenter(wt),de=S.centerPoint.add(at),xe=new a.P(ht.x,ht.y).mult(S.worldSize),be=new a.P(a.am(wt.lng),a.at(wt.lat)).mult(S.worldSize).sub(xe)}else{de=S.centerPoint.add(ce);const ht=S.pointLocation(de),at=a.bK.convert(h.center||ht);this._normalizeCenter(at),xe=S.project(ht),be=S.project(at).sub(xe)}const Se=S.zoomScale(Y-P);let Te,Oe;h.around&&(Te=a.bK.convert(h.around),Oe=S.locationPoint(Te));const Ge=this._zooming||Y!==P,Be=this._rotating||D!==ee,Xe=this._pitching||te!==N,$e=!S.isPaddingEqual(le),tt=h.retainPadding===!1?S.clone():S,Je=ht=>at=>{if(Ge&&(ht.zoom=a.aa(P,Y,at)),Be&&(ht.bearing=a.aa(D,ee,at)),Xe&&(ht.pitch=a.aa(N,te,at)),$e&&(tt.interpolatePadding($,le,at),de=tt.centerPoint.add(ce)),Te)ht.setLocationAtPoint(Te,Oe);else{const st=ht.zoomScale(ht.zoom-P),wt=Y>P?Math.min(2,Se):Math.max(.5,Se),zt=Math.pow(wt,1-at),Zt=ht.unproject(xe.add(be.mult(at*zt)).mult(st));ht.setLocationAtPoint(ht.renderWorldCopies?Zt.wrap():Zt,de)}return h.preloadOnly||this._fireMoveEvents(g),ht};if(h.preloadOnly){const ht=this._emulate(Je,h.duration,S);return this._preloadTiles(ht),this}const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ge,this._rotating=Be,this._pitching=Xe,this._padding=$e,this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,nt),this._ease(Je(S),ht=>{S.cameraElevationReference==="sea"&&S.recenterOnTerrain(),this._afterEase(g,ht)},h),this}_prepareEase(h,g,S={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),g||S.moving||this.fire(new a.x("movestart",h)),this._zooming&&!S.zooming&&this.fire(new a.x("zoomstart",h)),this._rotating&&!S.rotating&&this.fire(new a.x("rotatestart",h)),this._pitching&&!S.pitching&&this.fire(new a.x("pitchstart",h))}_fireMoveEvents(h){this.fire(new a.x("move",h)),this._zooming&&this.fire(new a.x("zoom",h)),this._rotating&&this.fire(new a.x("rotate",h)),this._pitching&&this.fire(new a.x("pitch",h))}_afterEase(h,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const S=this._zooming,P=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new a.x("zoomend",h)),P&&this.fire(new a.x("rotateend",h)),D&&this.fire(new a.x("pitchend",h)),this.fire(new a.x("moveend",h))}flyTo(h,g){if(this._prefersReducedMotion(h)){const Ht=a.ar(h,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ht,g)}this.stop(),h=a.l({offset:[0,0],speed:1.2,curve:1.42,easing:a.dr},h);const S=this.transform,P=this.getZoom(),D=this.getBearing(),N=this.getPitch(),$=this.getPadding(),Y="zoom"in h?a.ap(+h.zoom,S.minZoom,S.maxZoom):P,ee="bearing"in h?this._normalizeBearing(h.bearing,D):D,te="pitch"in h?+h.pitch:N,le=this._extendPadding(h.padding),ce=S.zoomScale(Y-P),de=a.P.convert(h.offset);let xe=S.centerPoint.add(de);const be=S.pointLocation(xe),Se=a.bK.convert(h.center||be);this._normalizeCenter(Se);const Te=S.project(be),Oe=S.project(Se).sub(Te);let Ge=h.curve;const Be=Math.max(S.width,S.height),Xe=Be/ce,$e=Oe.mag();if("minZoom"in h){const Ht=a.ap(Math.min(h.minZoom,P,Y),S.minZoom,S.maxZoom),fn=Be/S.zoomScale(Ht-P);Ge=Math.sqrt(fn/$e*2)}const tt=Ge*Ge;function Je(Ht){const fn=(Xe*Xe-Be*Be+(Ht?-1:1)*tt*tt*$e*$e)/(2*(Ht?Xe:Be)*tt*$e);return Math.log(Math.sqrt(fn*fn+1)-fn)}function nt(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function ht(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}const at=Je(0);let st=function(Ht){return ht(at)/ht(at+Ge*Ht)},wt=function(Ht){return Be*((ht(at)*(nt(fn=at+Ge*Ht)/ht(fn))-nt(at))/tt)/$e;var fn},zt=(Je(1)-at)/Ge;if(Math.abs($e)<1e-6||!isFinite(zt)){if(Math.abs(Be-Xe)<1e-6)return this.easeTo(h,g);const Ht=Xe<Be?-1:1;zt=Math.abs(Math.log(Xe/Be))/Ge,wt=function(){return 0},st=function(fn){return Math.exp(Ht*Ge*fn)}}h.duration="duration"in h?+h.duration:1e3*zt/("screenSpeed"in h?+h.screenSpeed/Ge:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const Zt=D!==ee,Ft=te!==N,dn=!S.isPaddingEqual(le),St=h.retainPadding===!1?S.clone():S,$t=Ht=>fn=>{const mn=fn*zt,Yt=1/st(mn);Ht.zoom=fn===1?Y:P+Ht.scaleZoom(Yt),Zt&&(Ht.bearing=a.aa(D,ee,fn)),Ft&&(Ht.pitch=a.aa(N,te,fn)),dn&&(St.interpolatePadding($,le,fn),xe=St.centerPoint.add(de));const tn=fn===1?Se:Ht.unproject(Te.add(Oe.mult(wt(mn))).mult(Yt));return Ht.setLocationAtPoint(Ht.renderWorldCopies?tn.wrap():tn,xe),Ht._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(g),Ht};if(h.preloadOnly){const Ht=this._emulate($t,h.duration,S);return this._preloadTiles(Ht),this}return this._zooming=!0,this._rotating=Zt,this._pitching=Ft,this._padding=dn,this._prepareEase(g,!1),this._ease($t(S),()=>this._afterEase(g),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(h){}_cancelRenderFrame(h){}_stop(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const S=this._onEaseEnd;this._onEaseEnd=void 0,S.call(this,g)}if(!h){const S=this.handlers;S&&S.stop(!1)}return this}_ease(h,g,S){S.animate===!1||S.duration===0?(h(1),g()):(this._easeStart=a.q.now(),this._easeOptions=S,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,g){h=a.bA(h,-180,180);const S=Math.abs(h-g);return Math.abs(h-360-g)<S&&(h-=360),Math.abs(h+360-g)<S&&(h+=360),h}_normalizeCenter(h){const g=this.transform;if(g.maxBounds||g.projection.name!=="globe"&&!g.renderWorldCopies)return;const S=h.lng-g.center.lng;h.lng+=S>180?-360:S<-180?360:0}_prefersReducedMotion(h){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(h&&h.essential)}_emulate(h,g,S){const P=Math.ceil(15*g/1e3),D=[],N=h(S.clone());for(let $=0;$<=P;$++){const Y=N($/P);D.push(Y.clone())}return D}_preloadTiles(h,g){}}class pt{constructor(h={}){this.options=h,a.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const g=this.options&&this.options.compact,S=h._getUIString("AttributionControl.ToggleAttribution");this._map=h,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",S);const P=E("span","mapboxgl-ctrl-icon",this._compactButton);return P.setAttribute("aria-hidden","true"),P.setAttribute("title",S),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),g===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(h){const S=g.reduce((P,D,N)=>(D.value&&(P+=`${D.key}=${D.value}${N<g.length-1?"&":""}`),P),"?");h.href=`${a.e.FEEDBACK_URL}/${S}#${$c(this._map,!0)}`,h.rel="noopener nofollow"}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const P=this._map.style.stylesheet;this.styleOwner=P.owner,this.styleId=P.id}const g=this._map.style._mergedSourceCaches;for(const P in g){const D=g[P];if(D.used){const N=D.getSource();N.attribution&&h.indexOf(N.attribution)<0&&h.push(N.attribution)}}h.sort((P,D)=>P.length-D.length),h=h.filter((P,D)=>{for(let N=D+1;N<h.length;N++)if(h[N].indexOf(P)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const S=h.join(" | ");S!==this._attribHTML&&(this._attribHTML=S,h.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Nt{constructor(){a.aJ(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=E("div","mapboxgl-ctrl");const g=E("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const g in h){const S=h[g].getSource();if(S.hasOwnProperty("mapbox_logo")&&!S.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const g=h[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class _n{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const g=++this._id;return this._queue.push({callback:h,id:g,cancelled:!1}),g}remove(h){const g=this._currentlyRunning,S=g?this._queue.concat(g):this._queue;for(const P of S)if(P.id===h)return void(P.cancelled=!0)}run(h=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const S of g)if(!S.cancelled&&(S.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class $n{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const g=a.cw((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,g,S){this._start=this.getValue(g),this._end=h,this._startTime=g,this._endTime=g+S}}const wr={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class ci{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Gr{constructor(h){this.map=h,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(h,g){if(this.typeById.has(h))throw new Error(`Interaction id "${h}" already exists.`);const{type:S,filter:P}=g;if(P){const N=a.M(P,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(N.result==="error")throw new Error(N.value.map($=>`${$.key}: ${$.message}`).join(", "));this.filters.set(h,N.value)}const D=this.interactionsByType.get(S)||new Map;D.size===0&&(this.map.on(S,this.handleType),this.interactionsByType.set(S,D)),D.set(h,g),this.typeById.set(h,S)}remove(h){const g=this.typeById.get(h);if(!g)return;this.typeById.delete(h),this.filters.delete(h);const S=this.interactionsByType.get(g);S&&(S.delete(h),S.size===0&&this.map.off(g,this.handleType))}handleType(h){const g=h.features||this.map.queryRenderedFeatures(h.point);if(!g)return;const S=this.interactionsByType.get(h.type),P={zoom:0};for(const[D,N]of S){const $=this.filters.get(D),{handler:Y,layers:ee}=N;for(const te of g)if((!ee||ee.includes(te.layer.id))&&(!$||$.evaluate(P,te))&&Y({id:D,feature:te,interaction:N})!==!1)break}}}const vs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Pr={showCompass:!0,showZoom:!0,visualizePitch:!1};class po{constructor(h,g,S=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new Jg({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,S&&(this.mousePitch=new um({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),a.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(h,g){this.mouseRotate.mousedown(h,g),this.mousePitch&&this.mousePitch.mousedown(h,g),q()}move(h,g){const S=this.map,P=this.mouseRotate.mousemoveWindow(h,g),D=P&&P.bearingDelta;if(D&&S.setBearing(S.getBearing()+D),this.mousePitch){const N=this.mousePitch.mousemoveWindow(h,g),$=N&&N.pitchDelta;$&&S.setPitch(S.getPitch()+$)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(a.l({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),se(this.element,h)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,se(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=ae(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function mo(w,h,g){if(w=new a.bK(w.lng,w.lat),h){const S=new a.bK(w.lng-360,w.lat),P=new a.bK(w.lng+360,w.lat),D=360*Math.ceil(Math.abs(w.lng-g.center.lng)/360),N=g.locationPoint(w).distSqr(h),$=h.x<0||h.y<0||h.x>g.width||h.y>g.height;g.locationPoint(S).distSqr(h)<N&&($||Math.abs(S.lng-g.center.lng)<D)?w=S:g.locationPoint(P).distSqr(h)<N&&($||Math.abs(P.lng-g.center.lng)<D)&&(w=P)}for(;Math.abs(w.lng-g.center.lng)>180;){const S=g.locationPoint(w);if(S.x>=0&&S.y>=0&&S.x<=g.width&&S.y<=g.height)break;w.lng>g.center.lng?w.lng-=360:w.lng+=360}return w}const Xt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ut extends a.E{constructor(h,g){if(super(),(h instanceof HTMLElement||g)&&(h=a.l({element:h},g)),a.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=a.P.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const D=41,N=27,$=C("svg",{display:"block",height:D*this._scale+"px",width:N*this._scale+"px",viewBox:`0 0 ${N} ${D}`},this._element),Y=C("radialGradient",{id:"shadowGradient"},C("defs",{},$));C("stop",{offset:"10%","stop-opacity":.4},Y),C("stop",{offset:"100%","stop-opacity":.05},Y),C("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},$),C("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},$),C("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},$),C("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},$),this._offset=a.P.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",D=>{D.preventDefault()}),this._element.addEventListener("mousedown",D=>{D.preventDefault()});const S=this._element.classList;for(const D in Xt)S.remove(`mapboxgl-marker-anchor-${D}`);S.add(`mapboxgl-marker-anchor-${this._anchor}`);const P=h&&h.className?h.className.trim().split(/\s+/):[];S.add(...P),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=a.bK.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const P=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[P,-1*(38.1-13.5+P)],"bottom-right":[-P,-1*(38.1-13.5+P)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const g=h.code,S=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&S!==32&&S!==13||this.togglePopup()}_onMapClick(h){const g=h.originalEvent.target,S=this._element;this._popup&&(g===S||S.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,g=this._pos;if(!h||!g)return!1;const S=h.unproject(g),P=h.getFreeCameraOptions();if(!P.position)return!1;const D=P.position.toLngLat();return D.distanceTo(S)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const g=this._pos;if(!g||g.x<0||g.x>h.transform.width||g.y<0||g.y>h.transform.height)return void this._clearFadeTimer();const S=h.unproject(g);let P;h._showingGlobe()&&a.dz(h.transform,this._lngLat)?P=0:(P=1-h._queryFogOpacity(S),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(P*=this._occludedOpacity)),this._element.style.opacity=`${P}`,this._element.style.pointerEvents=P>0?"auto":"none",this._popup&&this._popup._setOpacity(P),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${Xt[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${g.x}px,${g.y}px)
        `}_calculateXYTransform(){const h=this._pos,g=this._map,S=this.getPitchAlignment();if(!g||!h||S!=="map")return"";if(!g._showingGlobe()){const Y=g.getPitch();return Y?`rotateX(${Y}deg)`:""}const P=a.c0(a.dA(g.transform,this._lngLat)),D=h.sub(a.dB(g.transform)),N=Math.abs(D.x)+Math.abs(D.y);if(N===0)return"";const $=P/N;return`rotateX(${-D.y*$}deg) rotateY(${D.x*$}deg)`}_calculateZTransform(){const h=this._pos,g=this._map;if(!g||!h)return"";let S=0;const P=this.getRotationAlignment();if(P==="map")if(g._showingGlobe()){const D=g.project(new a.bK(this._lngLat.lng,this._lngLat.lat+.001)),N=g.project(new a.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);S=a.c0(Math.atan2(N.y,N.x))-90}else S=-g.getBearing();else if(P==="horizon"){const D=a.a7(4,6,g.getZoom()),N=a.dB(g.transform);N.y+=D*g.transform.height;const $=h.sub(N),Y=a.c0(Math.atan2($.y,$.x));S=(Y>90?Y-270:Y+90)*(1-D)}return S+=this._rotation,S?`rotateZ(${S}deg)`:""}_update(h){cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=mo(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),h===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=a.P.convert(h),this._update(),this}addClassName(h){return this._element.classList.add(h),this}removeClassName(h){return this._element.classList.remove(h),this}toggleClassName(h){return this._element.classList.toggle(h)}_onMove(h){const g=this._map;if(!g)return;const S=this._pointerdownPos,P=this._positionDelta;if(S&&P){if(!this._isDragging){const D=this._clickTolerance||g._clickTolerance;if(h.point.dist(S)<D)return;this._isDragging=!0}this._pos=h.point.sub(P),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.x("dragstart"))),this.fire(new a.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.x("dragend")),this._state="inactive"}_addDragHandler(h){const g=this._map,S=this._pos;g&&S&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(S),this._pointerdownPos=h.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const g=this._map;return g&&(h?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const an={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ir={maxWidth:100,unit:"metric"},Rr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},xi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ui=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vi(w=new a.P(0,0),h="bottom"){if(typeof w=="number"){const g=Math.round(Math.sqrt(.5*Math.pow(w,2)));switch(h){case"top":return new a.P(0,w);case"top-left":return new a.P(g,g);case"top-right":return new a.P(-g,g);case"bottom":return new a.P(0,-w);case"bottom-left":return new a.P(g,-g);case"bottom-right":return new a.P(-g,-g);case"left":return new a.P(w,0);case"right":return new a.P(-w,0)}return new a.P(0,0)}return w instanceof a.P||Array.isArray(w)?a.P.convert(w):a.P.convert(w[h]||[0,0])}return{version:d,supported:I.supported,setRTLTextPlugin:a.dC,getRTLTextPluginStatus:a.dD,Map:class extends Me{constructor(w){m.mark(f.create);const h=w;if((w=a.l({},vs,w)).minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(w.antialias&&a.dx(window)&&(w.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Af(w.minZoom,w.maxZoom,w.minPitch,w.maxPitch,w.renderWorldCopies),w),this._repaint=!!w.repaint,this._interactive=w.interactive,this._minTileCacheSize=w.minTileCacheSize,this._maxTileCacheSize=w.maxTileCacheSize,this._failIfMajorPerformanceCaveat=w.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=w.preserveDrawingBuffer,this._antialias=w.antialias,this._trackResize=w.trackResize,this._bearingSnap=w.bearingSnap,this._refreshExpiredTiles=w.refreshExpiredTiles,this._fadeDuration=w.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=w.crossSourceCollisions,this._collectResourceTiming=w.collectResourceTiming,this._language=this._parseLanguage(w.language),this._worldview=w.worldview,this._renderTaskQueue=new _n,this._domRenderTaskQueue=new _n,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.aP(),this._locale=a.l({},wr,w.locale),this._clickTolerance=w.clickTolerance,this._cooperativeGestures=w.cooperativeGestures,this._performanceMetricsCollection=w.performanceMetricsCollection,this._tessellationStep=w.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=w.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new $n(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new ze(w.transformRequest,w.accessToken,w.testMode),this._silenceAuthErrors=!!w.testMode,this._contextCreateOptions=w.contextCreateOptions?{...w.contextCreateOptions}:{},typeof w.container=="string"){const g=document.getElementById(w.container);if(!g)throw new Error(`Container '${w.container.toString()}' not found.`);this._container=g}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),w.maxBounds&&this.setMaxBounds(w.maxBounds),a.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ci),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new oe(this,w),this._localFontFamily=w.localFontFamily,this._localIdeographFontFamily=w.localIdeographFontFamily,(w.style||!w.testMode)&&this.setStyle(w.style||a.e.DEFAULT_STYLE,{config:w.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),w.projection&&this.setProjection(w.projection),w.hash&&(this._hash=new fo(typeof w.hash=="string"&&w.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){h.center==null&&h.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch});const g=w.bounds;g&&(this.resize(),this.fitBounds(g,a.l({},w.fitBoundsOptions,{duration:0})))}this.resize(),w.attributionControl&&this.addControl(new pt({customAttribution:w.customAttribution})),this._logoControl=new Nt,this.addControl(this._logoControl,w.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",g=>{this._update(g.dataType==="style"),this.fire(new a.x(`${g.dataType}data`,g))}),this.on("dataloading",g=>{this.fire(new a.x(`${g.dataType}dataloading`,g))}),this._interactions=new Gr(this)}_getMapId(){return this._mapId}addControl(w,h){if(h===void 0&&(h=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new a.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=w.onAdd(this);this._controls.push(w);const S=this._controlPositions[h];return h.indexOf("bottom")!==-1?S.insertBefore(g,S.firstChild):S.appendChild(g),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new a.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(w);return h>-1&&this._controls.splice(h,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(w){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new a.x("movestart",w)).fire(new a.x("move",w)),this.fire(new a.x("resize",w)),h&&this.fire(new a.x("moveend",w)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(w){return this.transform.setMaxBounds(a.as.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.minZoom=w,this._update(),this.getZoom()<w?this.setZoom(w):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.maxZoom=w,this._update(),this.getZoom()>w?this.setZoom(w):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.minPitch=w,this._update(),this.getPitch()<w?this.setPitch(w):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(w>=this.transform.minPitch)return this.transform.maxPitch=w,this._update(),this.getPitch()>w?this.setPitch(w):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.renderWorldCopies=w,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(w){return w==="auto"?navigator.language:Array.isArray(w)?w.length===0?void 0:w.map(h=>h==="auto"?navigator.language:h):w}setLanguage(w){const h=this._parseLanguage(w);if(!this.style||h===this._language)return this;this._language=h,this.style.reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(w){return this.style&&w!==this._worldview?(this._worldview=w,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(w){return this._lazyInitEmptyStyle(),w?typeof w=="string"&&(w={name:w}):w=null,this._useExplicitProjection=!!w,this._prioritizeAndUpdateProjection(w,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const w=this.transform,h=w.projection.name;let g;h==="globe"&&w.zoom>=a.bU?(w.setMercatorFromTransition(),g=!0):h==="mercator"&&w.zoom<a.bU&&(w.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(w,h){return this._updateProjection(w||h||{name:"mercator"})}_updateProjection(w){let h;return h=w.name==="globe"&&this.transform.zoom>=a.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(w),this.style.applyProjectionUpdate(),h&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(w){return this.transform.locationPoint3D(a.bK.convert(w))}unproject(w){return this.transform.pointLocation3D(a.P.convert(w))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(w,h,g){if(w==="mouseenter"||w==="mouseover"){let S=!1;const P=N=>{const $=h.filter(ee=>this.getLayer(ee)),Y=$.length?this.queryRenderedFeatures(N.point,{layers:$}):[];Y.length?S||(S=!0,g.call(this,new Sa(w,this,N.originalEvent,{features:Y}))):S=!1},D=()=>{S=!1};return{layers:new Set(h),listener:g,delegates:{mousemove:P,mouseout:D}}}if(w==="mouseleave"||w==="mouseout"){let S=!1;const P=N=>{const $=h.filter(Y=>this.getLayer(Y));($.length?this.queryRenderedFeatures(N.point,{layers:$}):[]).length?S=!0:S&&(S=!1,g.call(this,new Sa(w,this,N.originalEvent)))},D=N=>{S&&(S=!1,g.call(this,new Sa(w,this,N.originalEvent)))};return{layers:new Set(h),listener:g,delegates:{mousemove:P,mouseout:D}}}{const S=P=>{const D=h.filter($=>this.getLayer($)),N=D.length?this.queryRenderedFeatures(P.point,{layers:D}):[];N.length&&(P.features=N,g.call(this,P),delete P.features)};return{layers:new Set(h),listener:g,delegates:{[w]:S}}}}on(w,h,g){if(typeof h=="function"||g===void 0)return super.on(w,h);if(Array.isArray(h)||(h=[h]),h){for(const P of h)if(!this._isValidId(P))return this}const S=this._createDelegatedListener(w,h,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(S);for(const P in S.delegates)this.on(P,S.delegates[P]);return this}once(w,h,g){if(typeof h=="function"||g===void 0)return super.once(w,h);if(Array.isArray(h)||(h=[h]),h){for(const P of h)if(!this._isValidId(P))return this}const S=this._createDelegatedListener(w,h,g);for(const P in S.delegates)this.once(P,S.delegates[P]);return this}off(w,h,g){if(typeof h=="function"||g===void 0)return super.off(w,h);const S=new Set(Array.isArray(h)?h:[h]);for(const N of S)if(!this._isValidId(N))return this;const P=(N,$)=>{if(N.size!==$.size)return!1;for(const Y of N)if(!$.has(Y))return!1;return!0},D=this._delegatedListeners?this._delegatedListeners[w]:void 0;return D&&(N=>{for(let $=0;$<N.length;$++){const Y=N[$];if(Y.listener===g&&P(Y.layers,S)){for(const ee in Y.delegates)this.off(ee,Y.delegates[ee]);return N.splice($,1),this}}})(D),this}queryRenderedFeatures(w,h){if(!this.style)return[];if(h!==void 0||w===void 0||w instanceof a.P||Array.isArray(w)||(h=w,w=void 0),w=w||[[0,0],[this.transform.width,this.transform.height]],(h=h||{}).layers&&Array.isArray(h.layers)){for(const g of h.layers)if(!this._isValidId(g))return[]}return this.style.queryRenderedFeatures(w,h,this.transform)}querySourceFeatures(w,h){return this._isValidId(w)?this.style.querySourceFeatures(w,h):[]}isPointOnSurface(w){const{name:h}=this.transform.projection;return h!=="globe"&&h!=="mercator"&&a.w(`${h} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(w))}addInteraction(w,h){return this._interactions.add(w,h),this}removeInteraction(w){return this._interactions.remove(w),this}setStyle(w,h){return h=a.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h),this.style&&w&&h.diff!==!1&&h.localFontFamily===this._localFontFamily&&h.localIdeographFontFamily===this._localIdeographFontFamily&&!h.config?(this.style._diffStyle(w,(g,S)=>{g?(a.w(`Unable to perform style diff: ${String(g.message||g.error||g)}. Rebuilding the style from scratch.`),this._updateStyle(w,h)):S&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(w,h))}_getUIString(w){const h=this._locale[w];if(h==null)throw new Error(`Missing UI string '${w}'`);return h}_updateStyle(w,h){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),w){const g=a.l({},h);h&&h.config&&(g.initialConfig=h.config,delete g.config),this.style=new za(this,g).load(w),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new za(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(w){return w==null?(this.fire(new a.t(new Error("IDs can't be empty."))),!1):!a.cn(w)||(this.fire(new a.t(new Error(`IDs can't contain special symbols: "${w}".`))),!1)}addSource(w,h){return this._isValidId(w)?(this._lazyInitEmptyStyle(),this.style.addSource(w,h),this._update(!0)):this}isSourceLoaded(w){return!!this._isValidId(w)&&!!this.style&&this.style._isSourceCacheLoaded(w)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(w,h,g){this._lazyInitEmptyStyle(),this.style.addSourceType(w,h,g)}removeSource(w){return this._isValidId(w)?(this.style.removeSource(w),this._updateTerrain(),this._update(!0)):this}getSource(w){return this._isValidId(w)?this.style.getOwnSource(w):null}addImage(w,h,{pixelRatio:g=1,sdf:S=!1,stretchX:P,stretchY:D,content:N}={}){if(this._lazyInitEmptyStyle(),h instanceof HTMLImageElement||ImageBitmap&&h instanceof ImageBitmap){const{width:$,height:Y,data:ee}=a.q.getImageData(h);this.style.addImage(w,{data:new a.r({width:$,height:Y},ee),pixelRatio:g,stretchX:P,stretchY:D,content:N,sdf:S,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new a.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:$,height:Y}=h,ee=h;this.style.addImage(w,{data:new a.r({width:$,height:Y},new Uint8Array(ee.data)),pixelRatio:g,stretchX:P,stretchY:D,content:N,sdf:S,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,w)}}updateImage(w,h){this._lazyInitEmptyStyle();const g=this.style.getImage(w);if(!g)return void this.fire(new a.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=h instanceof HTMLImageElement||ImageBitmap&&h instanceof ImageBitmap?a.q.getImageData(h):h,{width:P,height:D,data:N}=S;if(P===void 0||D===void 0)return void this.fire(new a.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(P!==g.data.width||D!==g.data.height)return void this.fire(new a.t(new Error(`The width and height of the updated image (${P}, ${D})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const $=!(h instanceof HTMLImageElement||ImageBitmap&&h instanceof ImageBitmap);g.data.replace(N,$),this.style.updateImage(w,g)}hasImage(w){return w?!!this.style&&!!this.style.getImage(w):(this.fire(new a.t(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w,h){a.o(this._requestManager.transformRequest(w,a.R.Image),(g,S)=>{h(g,S instanceof HTMLImageElement?a.q.getImageData(S):S)})}listImages(){return this.style.listImages()}addModel(w,h){this._lazyInitEmptyStyle(),this.style.addModel(w,h)}hasModel(w){return w?this.style.hasModel(w):(this.fire(new a.t(new Error("Missing required model id"))),!1)}removeModel(w){this.style.removeModel(w)}listModels(){return this.style.listModels()}addLayer(w,h){return this._isValidId(w.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(w,h),this._update(!0)):this}getSlot(w){const h=this.getLayer(w);return h&&h.slot||null}setSlot(w,h){return this.style.setSlot(w,h),this.style.mergeLayers(),this._update(!0)}addImport(w,h){return this.style.addImport(w,h),this}updateImport(w,h){return typeof h!="string"&&h.id!==w?(this.removeImport(w),this.addImport(h)):(this.style.updateImport(w,h),this._update(!0))}removeImport(w){return this.style.removeImport(w),this}moveImport(w,h){return this.style.moveImport(w,h),this._update(!0)}moveLayer(w,h){return this._isValidId(w)?(this.style.moveLayer(w,h),this._update(!0)):this}removeLayer(w){return this._isValidId(w)?(this.style.removeLayer(w),this._update(!0)):this}getLayer(w){if(!this._isValidId(w))return null;const h=this.style.getOwnLayer(w);return h?h.type==="custom"?h.implementation:h.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(w,h,g){return this._isValidId(w)?(this.style.setLayerZoomRange(w,h,g),this._update(!0)):this}setFilter(w,h,g={}){return this._isValidId(w)?(this.style.setFilter(w,h,g),this._update(!0)):this}getFilter(w){return this._isValidId(w)?this.style.getFilter(w):null}setPaintProperty(w,h,g,S={}){return this._isValidId(w)?(this.style.setPaintProperty(w,h,g,S),this._update(!0)):this}getPaintProperty(w,h){return this._isValidId(w)?this.style.getPaintProperty(w,h):null}setLayoutProperty(w,h,g,S={}){return this._isValidId(w)?(this.style.setLayoutProperty(w,h,g,S),this._update(!0)):this}getLayoutProperty(w,h){return this._isValidId(w)?this.style.getLayoutProperty(w,h):null}getSchema(w){return this.style.getSchema(w)}setSchema(w,h){return this.style.setSchema(w,h),this._update(!0)}getConfig(w){return this.style.getConfig(w)}setConfig(w,h){return this.style.setConfig(w,h),this._update(!0)}getConfigProperty(w,h){return this.style.getConfigProperty(w,h)}setConfigProperty(w,h,g){return this.style.setConfigProperty(w,h,g),this._update(!0)}setLights(w){if(this._lazyInitEmptyStyle(),w&&w.length===1&&w[0].type==="flat"){const h=w[0];h.properties?this.style.setFlatLight(h.properties,h.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(w),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const w=this.style.getLights()||[];return w.length===0&&w.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),w}setLight(w,h={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:w}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(w){return this._lazyInitEmptyStyle(),!w&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(w),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(w){return this._lazyInitEmptyStyle(),this.style.setFog(w),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(w){return this._lazyInitEmptyStyle(),this.style.setColorTheme(w),this._update(!0)}setCamera(w){return this.style.setCamera(w),this._triggerCameraUpdate(w)}_triggerCameraUpdate(w){return this._update(this.transform.setOrthographicProjectionAtLowPitch(w["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(w){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.bK.convert(w),this.transform):0}setFeatureState(w,h){return this._isValidId(w.source)?(this.style.setFeatureState(w,h),this._update()):this}removeFeatureState(w,h){return this._isValidId(w.source)?(this.style.removeFeatureState(w,h),this._update()):this}getFeatureState(w){return this._isValidId(w.source)?this.style.getFeatureState(w):null}_updateContainerDimensions(){if(!this._container)return;const w=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let g,S,P,D=this._container;for(;D&&(!S||!P);){const N=window.getComputedStyle(D).transform;N&&N!=="none"&&(g=N.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&g[0]!=="0"&&g[0]!=="1"&&(S=g[0]),g[3]&&g[3]!=="0"&&g[3]!=="1"&&(P=g[3])),D=D.parentElement}this._containerWidth=S?Math.abs(w/S):w,this._containerHeight=P?Math.abs(h/P):h}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const w=this._container;w.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",w)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=E("div","mapboxgl-canvas-container",w);this._canvas=E("canvas","mapboxgl-canvas",h),this._interactive&&(h.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=E("div","mapboxgl-control-container",w),S=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(P=>{S[P]=E("div",`mapboxgl-ctrl-${P}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,h){const g=a.q.devicePixelRatio||1;this._canvas.width=g*Math.ceil(w),this._canvas.height=g*Math.ceil(h),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${h}px`}_addMarker(w){this._markers.push(w)}_removeMarker(w){const h=this._markers.indexOf(w);h!==-1&&this._markers.splice(h,1)}_addPopup(w){this._popups.push(w)}_removePopup(w){const h=this._popups.indexOf(w);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const w=a.l({},I.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._canvas.getContext("webgl2",w);h?(gn(h,!0),this.painter=new nl(h,this._contextCreateOptions,this.transform,this._tp),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.m.testSupport(h)):this.fire(new a.t(new Error("Failed to initialize WebGL")))}_contextLost(w){w.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.x("webglcontextlost",{originalEvent:w}))}_contextRestored(w){this._setupPainter(),this.resize(),this._update(),this.fire(new a.x("webglcontextrestored",{originalEvent:w}))}_onMapScroll(w){if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(w){return this.style?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_requestDomTask(w){!this.loaded()||this.loaded()&&!this.isMoving()?w():this._domRenderTaskQueue.add(w)}_render(w){let h;this.fire(new a.x("renderstart")),++this._frameId;const g=this.painter.context.extTimerQuery,S=a.q.now(),P=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(h=P.createQuery(),P.beginQuery(g.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(w),this._domRenderTaskQueue.run(w),this._removed)return;this._updateProjectionTransition();const D=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const ee=this.transform.zoom,te=this.transform.pitch,le=a.q.now(),ce=new a.a3(ee,{now:le,fadeDuration:D,pitch:te,transition:this.style.transition});this.style.update(ce)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let N=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),N=this._updateAverageElevation(S),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):N=this._updateAverageElevation(S);const $=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,D,this._crossSourceCollisions,this.painter.replacementSource);if($&&(this._placementDirty=$.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:D,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,m.mark(f.load),this.fire(new a.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const ee=a.q.now()-S;P.endQuery(g.TIME_ELAPSED_EXT),setTimeout(()=>{const te=P.getQueryParameter(h,P.QUERY_RESULT)/1e6;P.deleteQuery(h),this.fire(new a.x("gpu-timing-frame",{cpuTime:ee,gpuTime:te}))},50)}if(this.listens("gpu-timing-layer")){const ee=this.painter.collectGpuTimers();setTimeout(()=>{const te=this.painter.queryGpuTimers(ee);this.fire(new a.x("gpu-timing-layer",{layerTimes:te}))},50)}if(this.listens("gpu-timing-deferred-render")){const ee=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const te=this.painter.queryGpuTimeDeferredRender(ee);this.fire(new a.x("gpu-timing-deferred-render",{gpuTime:te}))},50)}const Y=this._sourcesDirty||this._styleDirty||this._placementDirty||N;if(Y||this._repaint)this.triggerRepaint();else{const ee=this.idle();if(ee&&(N=this._updateAverageElevation(S,!0)),N)this.triggerRepaint();else if(this._triggerFrame(!1),ee&&(this.fire(new a.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const te=this._calculateSpeedIndex();this.fire(new a.x("speedindexcompleted",{speedIndex:te})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||Y||(this._fullyLoaded=!0,m.mark(f.fullLoad),this._performanceMetricsCollection&&kn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(w){for(const h of this._markers)w&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!w||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(w,h=!1){const g=P=>(this.transform.averageElevation=P,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&g(0);const S=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(S||(h||w-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(w)){const P=this.transform.averageElevation;let D=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(D)?D=0:this._averageElevationLastSampledAt=w;const N=Math.abs(P-D);if(N>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(D),g(D);this._averageElevation.easeTo(D,w,300)}else if(N>1e-4)return this._averageElevation.jumpTo(D),g(D)}return!!this._averageElevation.isEasing(w)&&g(this._averageElevation.getValue(w))}_authenticate(){De(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,w=>{if(w&&(w.message===Pe||w.status===401)){const h=this.painter.context.gl;gn(h,!1),this._logoControl instanceof Nt&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),jt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&nn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const w=this._isDragging();this.painter.updateTerrain(this.style,w)}_calculateSpeedIndex(){const w=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const g=this.painter.context.gl,S=g.createFramebuffer();function P(D){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,D,0);const N=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,N),N}return g.bindFramebuffer(g.FRAMEBUFFER,S),this._canvasPixelComparison(P(w),h.canvasCopies.map(P),h.timeStamps)}_canvasPixelComparison(w,h,g){let S=g[1]-g[0];const P=w.length/4;for(let D=0;D<h.length;D++){const N=h[D];let $=0;for(let Y=0;Y<N.length;Y+=4)N[Y]===w[Y]&&N[Y+1]===w[Y+1]&&N[Y+2]===w[Y+2]&&N[Y+3]===w[Y+3]&&($+=1);S+=(g[D+2]-g[D+1])*(1-$/P)}return S}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ye.delete(this.painter.context.gl),Mn.remove(),lt.remove(),this._removed=!0,this.fire(new a.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(w){this._renderNextFrame=this._renderNextFrame||w,this.style&&!this._frame&&(this._frame=a.q.frame(h=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(h)}))}_preloadTiles(w){const h=this.style?this.style.getSourceCaches():[];return a.bf(h,(g,S)=>g._preloadTiles(w,S),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(w){this._trackResize&&this.resize({originalEvent:w})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(w){this._showParseStatus!==w&&(this._showParseStatus=w,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(w){this._showTerrainWireframe!==w&&(this._showTerrainWireframe=w,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(w){this._showLayers2DWireframe!==w&&(this._showLayers2DWireframe=w,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(w){this._showLayers3DWireframe!==w&&(this._showLayers3DWireframe=w,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(w){this._speedIndexTiming!==w&&(this._speedIndexTiming=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,this._tp.refreshUI(),w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(w){this._showTileAABBs!==w&&(this._showTileAABBs=w,this._tp.refreshUI(),w&&this._update())}_setCacheLimits(w,h){a.dy(w,h)}get version(){return d}},NavigationControl:class{constructor(w={}){this.options=a.l({},Pr,w),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(a.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:h}):g.resetNorth({},{originalEvent:h}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const w=this._map;if(!w)return;const h=w.getZoom(),g=h===w.getMaxZoom(),S=h===w.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=S,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",S.toString())}_rotateCompassArrow(){const w=this._map;if(!w)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(w.transform.pitch*(Math.PI/180)),.5)}) rotateX(${w.transform.pitch}deg) rotateZ(${w.transform.angle*(180/Math.PI)}deg)`:`rotate(${w.transform.angle*(180/Math.PI)}deg)`;w._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),w.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&w.on("pitch",this._rotateCompassArrow),w.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new po(w,this._compass,this.options.visualizePitch)),this._container}onRemove(){const w=this._map;w&&(this._container.remove(),this.options.showZoom&&w.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&w.off("pitch",this._rotateCompassArrow),w.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(w,h){const g=E("button",w,this._container);return g.type="button",g.addEventListener("click",h),g}_setButtonTitle(w,h){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${h}`);w.setAttribute("aria-label",g),w.firstElementChild&&w.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends a.E{constructor(w={}){super();const h=navigator.geolocation;this.options=a.l({geolocation:h},an,w),a.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=kl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(w){return this._map=w,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(w){const h=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,w(g)};this._supportsGeolocation!==void 0?w(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(g=>h(g.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(w){const h=this._map.getMaxBounds(),g=w.coords;return!!h&&(g.longitude<h.getWest()||g.longitude>h.getEast()||g.latitude<h.getSouth()||g.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(w){if(this._map){if(this._isOutOfMapMaxBounds(w))return this._setErrorState(),this.fire(new a.x("outofmaxbounds",w)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=w,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(w),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(w),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("geolocate",w)),this._finish()}}_updateCamera(w){const h=new a.bK(w.coords.longitude,w.coords.latitude),g=w.coords.accuracy,S=this._map.getBearing(),P=a.l({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(g),P,{geolocateSource:!0})}_updateMarker(w){if(w){const h=new a.bK(w.coords.longitude,w.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=w.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const w=this._map.transform,h=a.bD(1,w._center.lat)*w.worldSize,g=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(w){if(this._map){if(this.options.trackUserLocation)if(w.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(w.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("error",w)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(w){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",w===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ut({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ut({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.x("trackuserlocationend")))})}}_onDeviceOrientation(w){this._userLocationDotMarker&&(w.webkitCompassHeading?this._heading=w.webkitCompassHeading:w.absolute===!0&&(this._heading=-1*w.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(w={maximumAge:6e5,timeout:0},this._noTimeout=!0):(w=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,w),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const w=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&w()}).catch(console.error):w()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pt,ScaleControl:class{constructor(w={}){this.options=a.l({},ir,w),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const w=this.options.maxWidth||100,h=this._map,g=h._containerHeight/2,S=h._containerWidth/2-w/2,P=h.unproject([S,g]),D=h.unproject([S+w,g]),N=P.distanceTo(D);if(this.options.unit==="imperial"){const $=3.2808*N;$>5280?this._setScale(w,$/5280,"mile"):this._setScale(w,$,"foot")}else this.options.unit==="nautical"?this._setScale(w,N/1852,"nautical-mile"):N>=1e3?this._setScale(w,N/1e3,"kilometer"):this._setScale(w,N,"meter")}_setScale(w,h,g){this._map._requestDomTask(()=>{const S=function(D){const N=Math.pow(10,`${Math.floor(D)}`.length-1);let $=D/N;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(Y){const ee=Math.pow(10,Math.ceil(-Math.log(Y)/Math.LN10));return Math.round(Y*ee)/ee}($),N*$}(h),P=S/h;this._container.innerHTML=this._isNumberFormatSupported&&g!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:g}).format(S):`${S}&nbsp;${Rr[g]}`,this._container.style.width=w*P+"px"})}onAdd(w){return this._map=w,this._language=w.getLanguage(),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",w.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(w){this._language=w,this._update()}setUnit(w){this.options.unit=w,this._update()}},FullscreenControl:class{constructor(w={}){this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:a.w("Full screen control 'container' must be a DOM element.")),a.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const w=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",w)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(w){super(),this.options=a.l(Object.create(xi),w),a.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(w&&w.className?w.className.trim().split(/\s+/):[])}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&w.on("preclick",this._onClose),this.options.closeOnMove&&w.on("move",this._onClose),w.on("remove",this.remove),this._update(),w._addPopup(this),this._focusFirstElement(),this._trackPointer?(w.on("mousemove",this._onMouseEvent),w.on("mouseup",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")):w.on("move",this._update),this.fire(new a.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const w=this._map;return w&&(w.off("move",this._update),w.off("move",this._onClose),w.off("preclick",this._onClose),w.off("click",this._onClose),w.off("remove",this.remove),w.off("mousemove",this._onMouseEvent),w.off("mouseup",this._onMouseEvent),w.off("drag",this._onMouseEvent),w._canvasContainer&&w._canvasContainer.classList.remove("mapboxgl-track-pointer"),w._removePopup(this),this._map=void 0),this.fire(new a.x("close")),this}getLngLat(){return this._lngLat}setLngLat(w){this._lngLat=a.bK.convert(w),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const w=this._map;return w&&(w.off("move",this._update),w.on("mousemove",this._onMouseEvent),w.on("drag",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const h=document.createDocumentFragment(),g=document.createElement("body");let S;for(g.innerHTML=w;S=g.firstChild,S;)h.appendChild(S);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(w),this.options.closeButton){const g=this._closeButton=E("button","mapboxgl-popup-close-button",h);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(w){return this._classList.add(w),this._updateClassList(),this}removeClassName(w){return this._classList.delete(w),this._updateClassList(),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){let h;return this._classList.delete(w)?h=!1:(this._classList.add(w),h=!0),this._updateClassList(),h}_onMouseEvent(w){this._update(w.point)}_getAnchor(w){if(this.options.anchor)return this.options.anchor;const h=this._map,g=this._container,S=this._pos;if(!h||!g||!S)return"bottom";const P=g.offsetWidth,D=g.offsetHeight,N=S.x<P/2,$=S.x>h.transform.width-P/2;if(S.y+w<D)return N?"top-left":$?"top-right":"top";if(S.y>h.transform.height-D){if(N)return"bottom-left";if($)return"bottom-right"}return N?"left":$?"right":"bottom"}_updateClassList(){const w=this._container;if(!w)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),w.className=h.join(" ")}_update(w){const h=this._map,g=this._content;if(!h||!this._lngLat&&!this._trackPointer||!g)return;let S=this._container;if(S||(S=this._container=E("div","mapboxgl-popup",h.getContainer()),this._tip=E("div","mapboxgl-popup-tip",S),S.appendChild(g)),this.options.maxWidth&&S.style.maxWidth!==this.options.maxWidth&&(S.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=mo(this._lngLat,this._pos,h.transform)),!this._trackPointer||w){const P=this._pos=this._trackPointer&&w instanceof a.P?w:h.project(this._lngLat),D=Vi(this.options.offset),N=this._anchor=this._getAnchor(D.y),$=Vi(this.options.offset,N),Y=P.add($).round();h._requestDomTask(()=>{this._container&&N&&(this._container.style.transform=`${Xt[N]} translate(${Y.x}px,${Y.y}px)`)})}if(!this._marker&&h._showingGlobe()){const P=a.dz(h.transform,this._lngLat)?0:1;this._setOpacity(P)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(ui);w&&w.focus()}_onClose(){this.remove()}_setOpacity(w){this._container&&(this._container.style.opacity=`${w}`),this._content&&(this._content.style.pointerEvents=w?"auto":"none")}},Marker:Ut,Style:za,LngLat:a.bK,LngLatBounds:a.as,Point:a.P,MercatorCoordinate:a.a5,FreeCameraOptions:So,Evented:a.E,config:a.e,prewarm:a.dE,clearPrewarmedResources:a.dF,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(w){a.e.ACCESS_TOKEN=w},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(w){a.e.API_URL=w},get workerCount(){return a.dG.workerCount},set workerCount(w){a.dG.workerCount=w},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(w){a.e.MAX_PARALLEL_IMAGE_REQUESTS=w},clearStorage(w){a.dH(w)},get workerUrl(){return a.dI.workerUrl},set workerUrl(w){a.dI.workerUrl=w},get workerClass(){return a.dI.workerClass},set workerClass(w){a.dI.workerClass=w},get workerParams(){return a.dI.workerParams},set workerParams(w){a.dI.workerParams=w},get dracoUrl(){return a.dJ()},set dracoUrl(w){a.dK(w)},get meshoptUrl(){return a.dL()},set meshoptUrl(w){a.dM(w)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}});var c=o;return c})})(Mue);var VGe=Mue.exports;const jv=rD(VGe),HGe=()=>{const n=_e.useRef(null),e=_e.useRef(null),t={lng:-74.5,lat:40,zoom:9,bearing:0,pitch:0},[r,s]=_e.useState(t),o=()=>{e.current.flyTo({center:[t.lng,t.lat],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch})};return _e.useEffect(()=>(jv.accessToken="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",e.current=new jv.Map({container:n.current,center:[r.lng,r.lat],zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),e.current&&e.current.on("move",()=>{const l=e.current.getCenter();s({...r,lng:l.lng,lat:l.lat})}),e.current&&e.current.on("zoom",()=>{const l=e.current.getZoom();s({...r,zoom:l})}),e.current&&e.current.on("rotate",()=>{const l=e.current.getBearing();s({...r,bearing:l})}),e.current&&e.current.on("pitch",()=>{const l=e.current.getPitch();s({...r,pitch:l})}),()=>{e.current.remove()}),[]),pe.jsxs("div",{children:[pe.jsxs("div",{className:"absolute bottom-0 left-0 m-1 p-1 rounded-md bg-black-500 text-white z-10",children:["Longitude: ",r.lng.toFixed(4)," | Latitude: ",r.lat.toFixed(4)," | Zoom: ",r.zoom.toFixed(2)," | Bearing: ",r.bearing.toFixed(2)," | Pitch: ",r.pitch.toFixed(2),pe.jsx("button",{className:"ml-6 bg-slate-500 rounded-md",onClick:o,children:"RESET"})]}),pe.jsx("div",{className:"w-screen h-screen z-0",ref:n})]})};(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function n(O){try{return O.defaultView&&O.defaultView.frameElement||null}catch{return null}}var e=function(O){for(var H=O,q=n(H);q;)H=q.ownerDocument,q=n(H);return H}(window.document),t=[],r=null,s=null;function o(O){this.time=O.time,this.target=O.target,this.rootBounds=A(O.rootBounds),this.boundingClientRect=A(O.boundingClientRect),this.intersectionRect=A(O.intersectionRect||x()),this.isIntersecting=!!O.intersectionRect;var H=this.boundingClientRect,q=H.width*H.height,Z=this.intersectionRect,J=Z.width*Z.height;q?this.intersectionRatio=Number((J/q).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function l(O,H){var q=H||{};if(typeof O!="function")throw new Error("callback must be a function");if(q.root&&q.root.nodeType!=1&&q.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=a(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=O,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(q.rootMargin),this.thresholds=this._initThresholds(q.threshold),this.root=q.root||null,this.rootMargin=this._rootMarginValues.map(function(Z){return Z.value+Z.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}l.prototype.THROTTLE_TIMEOUT=100,l.prototype.POLL_INTERVAL=null,l.prototype.USE_MUTATION_OBSERVER=!0,l._setupCrossOriginUpdater=function(){return r||(r=function(O,H){!O||!H?s=x():s=I(O,H),t.forEach(function(q){q._checkForIntersections()})}),r},l._resetCrossOriginUpdater=function(){r=null,s=null},l.prototype.observe=function(O){var H=this._observationTargets.some(function(q){return q.element==O});if(!H){if(!(O&&O.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:O,entry:null}),this._monitorIntersections(O.ownerDocument),this._checkForIntersections()}},l.prototype.unobserve=function(O){this._observationTargets=this._observationTargets.filter(function(H){return H.element!=O}),this._unmonitorIntersections(O.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},l.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},l.prototype.takeRecords=function(){var O=this._queuedEntries.slice();return this._queuedEntries=[],O},l.prototype._initThresholds=function(O){var H=O||[0];return Array.isArray(H)||(H=[H]),H.sort().filter(function(q,Z,J){if(typeof q!="number"||isNaN(q)||q<0||q>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return q!==J[Z-1]})},l.prototype._parseRootMargin=function(O){var H=O||"0px",q=H.split(/\s+/).map(function(Z){var J=/^(-?\d*\.?\d+)(px|%)$/.exec(Z);if(!J)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(J[1]),unit:J[2]}});return q[1]=q[1]||q[0],q[2]=q[2]||q[0],q[3]=q[3]||q[1],q},l.prototype._monitorIntersections=function(O){var H=O.defaultView;if(H&&this._monitoringDocuments.indexOf(O)==-1){var q=this._checkForIntersections,Z=null,J=null;this.POLL_INTERVAL?Z=H.setInterval(q,this.POLL_INTERVAL):(d(H,"resize",q,!0),d(O,"scroll",q,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in H&&(J=new H.MutationObserver(q),J.observe(O,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(O),this._monitoringUnsubscribes.push(function(){var ae=O.defaultView;ae&&(Z&&ae.clearInterval(Z),f(ae,"resize",q,!0)),f(O,"scroll",q,!0),J&&J.disconnect()});var re=this.root&&(this.root.ownerDocument||this.root)||e;if(O!=re){var se=n(O);se&&this._monitorIntersections(se.ownerDocument)}}},l.prototype._unmonitorIntersections=function(O){var H=this._monitoringDocuments.indexOf(O);if(H!=-1){var q=this.root&&(this.root.ownerDocument||this.root)||e,Z=this._observationTargets.some(function(se){var ae=se.element.ownerDocument;if(ae==O)return!0;for(;ae&&ae!=q;){var he=n(ae);if(ae=he&&he.ownerDocument,ae==O)return!0}return!1});if(!Z){var J=this._monitoringUnsubscribes[H];if(this._monitoringDocuments.splice(H,1),this._monitoringUnsubscribes.splice(H,1),J(),O!=q){var re=n(O);re&&this._unmonitorIntersections(re.ownerDocument)}}}},l.prototype._unmonitorAllIntersections=function(){var O=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var H=0;H<O.length;H++)O[H]()},l.prototype._checkForIntersections=function(){if(!(!this.root&&r&&!s)){var O=this._rootIsInDom(),H=O?this._getRootRect():x();this._observationTargets.forEach(function(q){var Z=q.element,J=_(Z),re=this._rootContainsTarget(Z),se=q.entry,ae=O&&re&&this._computeTargetAndRootIntersection(Z,J,H),he=null;this._rootContainsTarget(Z)?(!r||this.root)&&(he=H):he=x();var Ae=q.entry=new o({time:c(),target:Z,boundingClientRect:J,rootBounds:he,intersectionRect:ae});se?O&&re?this._hasCrossedThreshold(se,Ae)&&this._queuedEntries.push(Ae):se&&se.isIntersecting&&this._queuedEntries.push(Ae):this._queuedEntries.push(Ae)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},l.prototype._computeTargetAndRootIntersection=function(O,H,q){if(window.getComputedStyle(O).display!="none"){for(var Z=H,J=C(O),re=!1;!re&&J;){var se=null,ae=J.nodeType==1?window.getComputedStyle(J):{};if(ae.display=="none")return null;if(J==this.root||J.nodeType==9)if(re=!0,J==this.root||J==e)r&&!this.root?!s||s.width==0&&s.height==0?(J=null,se=null,Z=null):se=s:se=q;else{var he=C(J),Ae=he&&_(he),Ee=he&&this._computeTargetAndRootIntersection(he,Ae,q);Ae&&Ee?(J=he,se=I(Ae,Ee)):(J=null,Z=null)}else{var Pe=J.ownerDocument;J!=Pe.body&&J!=Pe.documentElement&&ae.overflow!="visible"&&(se=_(J))}if(se&&(Z=m(se,Z)),!Z)break;J=J&&C(J)}return Z}},l.prototype._getRootRect=function(){var O;if(this.root&&!L(this.root))O=_(this.root);else{var H=L(this.root)?this.root:e,q=H.documentElement,Z=H.body;O={top:0,left:0,right:q.clientWidth||Z.clientWidth,width:q.clientWidth||Z.clientWidth,bottom:q.clientHeight||Z.clientHeight,height:q.clientHeight||Z.clientHeight}}return this._expandRectByRootMargin(O)},l.prototype._expandRectByRootMargin=function(O){var H=this._rootMarginValues.map(function(Z,J){return Z.unit=="px"?Z.value:Z.value*(J%2?O.width:O.height)/100}),q={top:O.top-H[0],right:O.right+H[1],bottom:O.bottom+H[2],left:O.left-H[3]};return q.width=q.right-q.left,q.height=q.bottom-q.top,q},l.prototype._hasCrossedThreshold=function(O,H){var q=O&&O.isIntersecting?O.intersectionRatio||0:-1,Z=H.isIntersecting?H.intersectionRatio||0:-1;if(q!==Z)for(var J=0;J<this.thresholds.length;J++){var re=this.thresholds[J];if(re==q||re==Z||re<q!=re<Z)return!0}},l.prototype._rootIsInDom=function(){return!this.root||E(e,this.root)},l.prototype._rootContainsTarget=function(O){var H=this.root&&(this.root.ownerDocument||this.root)||e;return E(H,O)&&(!this.root||H==O.ownerDocument)},l.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},l.prototype._unregisterInstance=function(){var O=t.indexOf(this);O!=-1&&t.splice(O,1)};function c(){return window.performance&&performance.now&&performance.now()}function a(O,H){var q=null;return function(){q||(q=setTimeout(function(){O(),q=null},H))}}function d(O,H,q,Z){typeof O.addEventListener=="function"?O.addEventListener(H,q,Z):typeof O.attachEvent=="function"&&O.attachEvent("on"+H,q)}function f(O,H,q,Z){typeof O.removeEventListener=="function"?O.removeEventListener(H,q,Z):typeof O.detachEvent=="function"&&O.detachEvent("on"+H,q)}function m(O,H){var q=Math.max(O.top,H.top),Z=Math.min(O.bottom,H.bottom),J=Math.max(O.left,H.left),re=Math.min(O.right,H.right),se=re-J,ae=Z-q;return se>=0&&ae>=0&&{top:q,bottom:Z,left:J,right:re,width:se,height:ae}||null}function _(O){var H;try{H=O.getBoundingClientRect()}catch{}return H?(H.width&&H.height||(H={top:H.top,right:H.right,bottom:H.bottom,left:H.left,width:H.right-H.left,height:H.bottom-H.top}),H):x()}function x(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function A(O){return!O||"x"in O?O:{top:O.top,y:O.top,bottom:O.bottom,left:O.left,x:O.left,right:O.right,width:O.width,height:O.height}}function I(O,H){var q=H.top-O.top,Z=H.left-O.left;return{top:q,left:Z,height:H.height,width:H.width,bottom:q+H.height,right:Z+H.width}}function E(O,H){for(var q=H;q;){if(q==O)return!0;q=C(q)}return!1}function C(O){var H=O.parentNode;return O.nodeType==9&&O!=e?n(O):(H&&H.assignedSlot&&(H=H.assignedSlot.parentNode),H&&H.nodeType==11&&H.host?H.host:H)}function L(O){return O&&O.nodeType===9}window.IntersectionObserver=l,window.IntersectionObserverEntry=o})();function jGe(n,e=document){return typeof n=="string"?Array.from(e.querySelectorAll(n)):n instanceof Element?[n]:n instanceof NodeList?Array.from(n):n instanceof Array?n:[]}function WGe(n){const e=document.createElement("div");e.className=`scrollama__debug-step ${n}`,e.style.position="fixed",e.style.left="0",e.style.width="100%",e.style.zIndex="9999",e.style.borderTop="2px solid black",e.style.borderBottom="2px solid black";const t=document.createElement("p");return t.style.position="absolute",t.style.left="0",t.style.height="1px",t.style.width="100%",t.style.borderTop="1px dashed black",e.appendChild(t),document.body.appendChild(e),e}function $Ge({id:n,step:e,marginTop:t}){const{index:r,height:s}=e,o=`scrollama__debug-step--${n}-${r}`;let l=document.querySelector(`.${o}`);l||(l=WGe(o)),l.style.top=`${t*-1}px`,l.style.height=`${s}px`,l.querySelector("p").style.top=`${s/2}px`}function XGe(){const n="abcdefghijklmnopqrstuvwxyz",e=Date.now(),t=[];for(let r=0;r<6;r+=1){const s=n[Math.floor(Math.random()*n.length)];t.push(s)}return`${t.join("")}${e}`}function qI(n){console.error(`scrollama error: ${n}`)}function LA(n){return+n.getAttribute("data-scrollama-index")}function qGe(n,e){const t=Math.ceil(n/e),r=[],s=1/t;for(let o=0;o<t+1;o+=1)r.push(o*s);return r}function NN(n){if(typeof n=="string"&&n.indexOf("px")>0){const e=+n.replace("px","");return isNaN(e)?(err("offset value must be in 'px' format. Fallback to 0.5."),{format:"percent",value:.5}):{format:"pixels",value:e}}else if(typeof n=="number"||!isNaN(+n))return n>1&&err("offset value is greater than 1. Fallback to 1."),n<0&&err("offset value is lower than 0. Fallback to 0."),{format:"percent",value:Math.min(Math.max(0,n),1)};return null}function YGe(n){n.forEach(e=>e.node.setAttribute("data-scrollama-index",e.index))}function ZGe(n){const{top:e}=n.getBoundingClientRect(),t=window.pageYOffset,r=document.body.clientTop||0;return e+t-r}let vb,OP,Pm;function Eue(n){const e=n?n.scrollTop:window.pageYOffset;vb!==e&&(vb=e,vb>OP?Pm="down":vb<OP&&(Pm="up"),OP=vb)}function KGe(n){vb=0,OP=0,document.addEventListener("scroll",()=>Eue(n))}function JGe(){let n={},e=XGe(),t=[],r,s,o,l=0,c=!1,a=!1,d=!1,f=!1,m=[];function _(){n={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},m=[]}function x(Pe){Pe&&!c&&Ae(),!Pe&&c&&q(),c=Pe}function A(Pe,ze){const Re=LA(Pe),rt=t[Re];ze!==void 0&&(rt.progress=ze);const ye={element:Pe,index:Re,progress:ze,direction:Pm};rt.state==="enter"&&n.stepProgress(ye)}function I(Pe,ze=!0){const Re=LA(Pe),rt=t[Re],ye={element:Pe,index:Re,direction:Pm};rt.direction=Pm,rt.state="enter",m[Re]||n.stepEnter(ye),f&&(m[Re]=!0)}function E(Pe,ze=!0){const Re=LA(Pe),rt=t[Re];if(!rt.state)return!1;const ye={element:Pe,index:Re,direction:Pm};a&&(Pm==="down"&&rt.progress<1?A(Pe,1):Pm==="up"&&rt.progress>0&&A(Pe,0)),rt.direction=Pm,rt.state="exit",n.stepExit(ye)}function C([Pe]){const ze=LA(Pe.target),Re=t[ze],rt=Pe.target.offsetHeight;rt!==Re.height&&(Re.height=rt,H(Re),re(Re),Z(Re))}function L([Pe]){Eue(s);const{isIntersecting:ze,target:Re}=Pe;ze?I(Re):E(Re)}function O([Pe]){const ze=LA(Pe.target),Re=t[ze],{isIntersecting:rt,intersectionRatio:ye,target:We}=Pe;rt&&Re.state==="enter"&&A(We,ye)}function H({observers:Pe}){Object.keys(Pe).map(ze=>{Pe[ze].disconnect()})}function q(){t.forEach(H)}function Z(Pe){const ze=new ResizeObserver(C);ze.observe(Pe.node),Pe.observers.resize=ze}function J(){t.forEach(Z)}function re(Pe){const ze=window.innerHeight,Re=Pe.offset||r,rt=Re.format==="pixels"?1:ze,ye=Re.value*rt,We=Pe.height/2-ye,Ue=Pe.height/2-(ze-ye),lt={rootMargin:`${We}px 0px ${Ue}px 0px`,threshold:.5,root:o},jt=new IntersectionObserver(L,lt);jt.observe(Pe.node),Pe.observers.step=jt,d&&$Ge({id:e,step:Pe,marginTop:We,marginBottom:Ue})}function se(){t.forEach(re)}function ae(Pe){const ze=window.innerHeight,Re=Pe.offset||r,rt=Re.format==="pixels"?1:ze,ye=Re.value*rt,We=-ye+Pe.height,Ue=ye-ze,gt=`${We}px 0px ${Ue}px 0px`,vt=qGe(Pe.height,l),Dt={rootMargin:gt,threshold:vt},lt=new IntersectionObserver(O,Dt);lt.observe(Pe.node),Pe.observers.progress=lt}function he(){t.forEach(ae)}function Ae(){q(),J(),se(),a&&he()}const Ee={};return Ee.setup=({step:Pe,parent:ze,offset:Re=.5,threshold:rt=4,progress:ye=!1,once:We=!1,debug:Ue=!1,container:gt=void 0,root:vt=null})=>(KGe(gt),t=jGe(Pe,ze).map((Dt,lt)=>({index:lt,direction:void 0,height:Dt.offsetHeight,node:Dt,observers:{},offset:NN(Dt.dataset.offset),top:ZGe(Dt),progress:0,state:void 0})),t.length?(a=ye,f=We,d=Ue,l=Math.max(1,+rt),r=NN(Re),s=gt,o=vt,_(),YGe(t),x(!0),Ee):(qI("no step elements"),Ee)),Ee.enable=()=>(x(!0),Ee),Ee.disable=()=>(x(!1),Ee),Ee.destroy=()=>(x(!1),_(),Ee),Ee.resize=()=>(Ae(),Ee),Ee.offset=Pe=>Pe==null?r.value:(r=NN(Pe),Ae(),Ee),Ee.onStepEnter=Pe=>(typeof Pe=="function"?n.stepEnter=Pe:qI("onStepEnter requires a function"),Ee),Ee.onStepExit=Pe=>(typeof Pe=="function"?n.stepExit=Pe:qI("onStepExit requires a function"),Ee),Ee.onStepProgress=Pe=>(typeof Pe=="function"?n.stepProgress=Pe:qI("onStepProgress requires a function"),Ee),Ee}const Iue="/about_portfolio/assets/first%20period-Cjp1RjP4.jpeg",rU="/about_portfolio/assets/hui-Ao1uY3rr.jpeg",Pue="/about_portfolio/assets/naipiao-BUdMlmen.jpg",W8="/about_portfolio/assets/qindiao-CKTdrbCg.png",Rue="/about_portfolio/assets/quanqiu-DnDfEiIO.jpeg",Lue="/about_portfolio/assets/quanqiuhua-CFNf60Po.jpeg",$8="/about_portfolio/assets/sanjuqingan-Bkq-CSnX.png",X8="/about_portfolio/assets/sanyuan-BxeIias_.png",q8="/about_portfolio/assets/sanyuanshangshi-DbcI-flH.jpeg",Y8="/about_portfolio/assets/shangshi-CZtwHG4A.jpeg",Due="/about_portfolio/assets/stage2-D7wGlXfP.png",Bue="/about_portfolio/assets/Thankyou-DonPtijT.jpeg",kue="/about_portfolio/assets/zhiliang-CZ_P7IVS.jpeg",QGe="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",iU=["mapbox://styles/linklink/cm2v9ot6s00fu01pwfs3q147j","mapbox://styles/linklink/cm2fmcw0200bb01ph6edf69ne","mapbox://styles/linklink/cl097w45i001o15mueqt9chmp"],jl={style:iU[0],showMarkers:!1,markerColor:"#3FB1CE",inset:!0,theme:"dark",use3dTerrain:!0,title:"      ",byline:`



`,footer:'Source: source citations, etc. <br> Created using <a href="https://github.com/mapbox/storytelling" target="_blank">Mapbox Storytelling</a> template.',chapters:[{id:"first-period",alignment:"fully",hidden:!1,title:"",description:'""',image:Iue,location:{center:[122.418398,34.759483],zoom:4.5,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"qindiao",alignment:"right",hidden:!1,title:"",image:W8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;10",location:{center:[120.922941,27.893666],zoom:10,pitch:0,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan",alignment:"left",hidden:!1,title:"",image:X8,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",location:{center:[116.489303,39.923409],zoom:10,pitch:8.01,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_conclusion",alignment:"fully",hidden:!1,title:"",image:Pue,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[116.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_map",alignment:"right",hidden:!0,location:{center:[114.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-stage",alignment:"fully",hidden:!1,image:Due,description:"&nbsp;&nbsp;&nbsp;&nbsp;1949-1978197897<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1978<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"zhengce",alignment:"right",title:"",hidden:!1,image:kue,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984719912000",location:{center:[116.70918,40.142585],zoom:7,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"yilishangshi",alignment:"left",title:"",hidden:!1,image:Y8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A",location:{center:[111.74918,40.842585],zoom:10,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"chengli",alignment:"fully",title:"",hidden:!1,image:rU,description:"&nbsp;&nbsp;&nbsp;&nbsp;19901995<br/>&nbsp;&nbsp;&nbsp;&nbsp;19905<br/>&nbsp;&nbsp;&nbsp;&nbsp;19921<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-map",alignment:"left",title:"",hidden:!0,image:rU,location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-stage",alignment:"fully",title:"21",hidden:!1,image:Rue,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan2",alignment:"right",title:"",hidden:!1,image:q8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",location:{center:[116.74918,40.842585],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanju",alignment:"left",title:"",hidden:!1,image:$8,description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[114.586506,38.151115],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"international",alignment:"fully",title:"",hidden:!1,image:Lue,description:"<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-map",alignment:"fully",hidden:!0,location:{center:[114.586506,38.151115],zoom:3,pitch:0,bearing:0},mapType:4,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"Thankyou",alignment:"fully",title:"",hidden:!1,image:Bue,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]}]},Oue="/about_portfolio/assets/bashi-j4Q9hrvQ.png",Fue="/about_portfolio/assets/bifengtang-yZIlcoLv.jpeg",Nue="/about_portfolio/assets/guangming-Ch0sfKFV.png",Z8="/about_portfolio/assets/guangze-COXCU3fq.png",zue="/about_portfolio/assets/hongxing-TMciPCkF.png",Uue="/about_portfolio/assets/sanyuan2-ek_zenH7.jpeg",Gue="/about_portfolio/assets/song-DXjP89Jt.png",Vue="/about_portfolio/assets/wandashan-CrxNEfy8.png",Hue="/about_portfolio/assets/weigang-CEFEuaeN.png",jue="/about_portfolio/assets/wushilan-CQSBRYUS.jpeg",Wue="/about_portfolio/assets/xiaoxiniu-CJwZNYCM.jpeg",$ue="/about_portfolio/assets/xiyuchun-BftcuwaV.png",Xue="/about_portfolio/assets/yili-xXFaKPoe.jpeg",que="/about_portfolio/assets/youzhiyou-DEWmaBTZ.jpeg";var e8e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[120.722941,27.793666]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:W8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.489303,39.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",image:X8,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.419303,30.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Nue,imageHeight:200,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[129.589303,44.603409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;50-80",image:zue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1928<br/>&nbsp;&nbsp;&nbsp;&nbsp;75,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Gue,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[87.419303,43.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1955<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;60,",image:$ue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[126.686109,45.738561]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;101963750",image:Vue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.9736,41.1272]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1956<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Xue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.308198,39.869373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Oue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[117.318198,39.259373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19588<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Z8,imageHeight:100,imageWidth:220}}]},t8e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[111.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Y8,imageHeight:120,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19491983",image:Hue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2001",image:Z8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.70918,40.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;199750%20012003",image:Uue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[114.70918,30.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19986499<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Fue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.586506,31.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1998",image:que,imageHeight:200,imageWidth:200}},{type:"Feature",geometry:{type:"Point",coordinates:[123.586506,23.151115]},properties:{title:"50",description:"&nbsp;&nbsp;&nbsp;&nbsp;501994",image:jue,imageHeight:200,imageWidth:180}},{type:"Feature",geometry:{type:"Point",coordinates:[101.586506,36.751115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2002",image:Wue,imageHeight:200,imageWidth:200}}]},n8e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[114.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:$8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",image:q8,imageHeight:120,imageWidth:220}}]},r8e={type:"FeatureCollection",features:[]};const i8e=[null,e8e,t8e,n8e,r8e],s8e=()=>{const n=_e.useRef(null);let e=_e.useRef(null);const t=_e.useRef(null),r=_e.useRef(null),s=_e.useRef(null);let o=!0,l=[],c=0;const a={fill:["fill-opacity"],line:["line-opacity"],circle:["circle-opacity","circle-stroke-opacity"],symbol:["icon-opacity","text-opacity"],raster:["raster-opacity"],"fill-extrusion":["fill-extrusion-opacity"],heatmap:["heatmap-opacity"]},d={left:"lefty",center:"centered",right:"righty",full:"fully"},f=E=>{let C=n.current.getLayer(E).type;return a[C]},m=E=>{f(E.layer).forEach(L=>{let O={};if(E.duration){let H=L+"-transition";O={duration:E.duration},n.current.setPaintProperty(E.layer,H,O)}n.current.setPaintProperty(E.layer,L,E.opacity,O)})},_=E=>{const L=E.indexOf("?")!==-1?"&pluginName=scrollytellingV2":"?pluginName=scrollytellingV2";return{url:E+L}},x=E=>{e.current.addSource("boundsSource",{type:"geojson",data:E}),e.current.addLayer({id:"boundsLayer",type:"fill",source:"boundsSource",layout:{},paint:{"fill-color":"#fff","fill-opacity":.2}}),e.current.addLayer({id:"outlineLayer",type:"line",source:"boundsSource",layout:{},paint:{"line-color":"#000","line-width":1}})},A=E=>{e.current.getSource("boundsSource").setData(E)},I=()=>{let E=n.current.getBounds(),C={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[E._sw.lng,E._sw.lat],[E._ne.lng,E._sw.lat],[E._ne.lng,E._ne.lat],[E._sw.lng,E._ne.lat],[E._sw.lng,E._sw.lat]]]}}]};o?(x(C),o=!1):A(C)};return _e.useEffect(()=>{jv.accessToken=QGe,n.current=new jv.Map({container:r.current,style:iU[c],center:jl.chapters[0].location.center,zoom:jl.chapters[0].location.zoom,bearing:jl.chapters[0].location.bearing,pitch:jl.chapters[0].location.pitch,interactive:!0,transformRequest:_,projection:jl.projection});const E=new jv.NavigationControl({showCompass:!0,showZoom:!0});n.current.addControl(E,"top-left"),e.current=new jv.Map({container:t.current,style:"mapbox://styles/mapbox/dark-v10",center:jl.chapters[0].location.center,zoom:3,hash:!1,interactive:!1,attributionControl:!1});let C=JGe();n.current.on("load",()=>{n.current.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),n.current.setTerrain({source:"mapbox-dem",exaggeration:1.5}),n.current.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),n.current.on("move",I),n.current.dragPan.enable(),n.current.keyboard.enable(),C.setup({step:".step",offset:.5}).onStepEnter(L=>{const O=jl.chapters.find(H=>H.id===L.element.id);if(L.element.classList.add("active"),n.current[O.mapAnimation||"flyTo"](O.location),O.mapType!==c&&(c=O.mapType,c!==0)){if(n.current.setStyle(iU[c]),l!==null)for(let H=l.length-1;H>=0;H--)l[H].remove();for(let H of i8e[c].features){let q=document.createElement("div");q.className="marker",q.style.backgroundImage="url("+H.properties.image+")",q.style.height="50px",q.style.width="50px",l.push(new jv.Marker(q).setLngLat(H.geometry.coordinates).setPopup(new jv.Popup({closeButton:!1,offset:25}).setHTML(`<h3>${H.properties.title}</h3><img src=${H.properties.image} height=${H.properties.imageHeight} width=${H.properties.imageWidth}><p>${H.properties.description}</p>`)).addTo(n.current))}}O.location.zoom<5?e.current.flyTo({center:O.location.center,zoom:0}):e.current.flyTo({center:O.location.center,zoom:3}),O.onChapterEnter.length>0&&O.onChapterEnter.forEach(m),O.callback&&window[O.callback](),O.rotateAnimation&&n.current.once("moveend",()=>{const H=n.current.getBearing();n.current.rotateTo(H+180,{duration:3e4,easing:function(q){return q}})})}).onStepExit(L=>{console.log(n.current.getStyle().layers);let O=jl.chapters.find(H=>H.id===L.element.id);L.element.classList.remove("active"),O.onChapterExit.length>0&&O.onChapterExit.forEach(m)})})},[]),pe.jsxs("div",{className:"w-screen h-screen",children:[pe.jsx("div",{className:"w-full h-full fixed",ref:r}),pe.jsx("div",{className:"top-20 right-4 h-40 w-60 fixed pointer-events-none transition-opacity ease-in-out",ref:t}),pe.jsxs("div",{className:"box-content",ref:s,children:[pe.jsxs("div",{className:`z-5 top-20 full-bar relative ${jl.theme}`,children:[pe.jsxs("h1",{className:"m-0 p-4 text-center leading-8",children:[" ",jl.title," "]}),jl.subtitle&&pe.jsx("h2",{className:"m-0 p-4 text-center",children:jl.subtitle}),pe.jsx("p",{className:"m-0 p-4 text-center leading-8",children:jl.byline})]}),pe.jsx("div",{className:"z-5 w-full relative",children:jl.chapters.map((E,C)=>pe.jsxs("div",{id:E.id,className:`p-4 dark step card ${C===0?"active":""} ${E.hidden?"hidden":""} ${d[E.alignment]||"centered"}`,children:[E.title&&pe.jsx("h2",{children:E.title}),E.image&&pe.jsx("img",{src:E.image,alt:E.title}),E.description&&pe.jsx("p",{children:E.description})]},C))}),pe.jsx("p",{className:`w-full min-h-5 py-2 text-center text-sm ${jl.theme}`,children:jl.footer})]})]})};var o8e=Object.defineProperty,a8e=(n,e,t)=>e in n?o8e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ay=(n,e,t)=>(a8e(n,typeof e!="symbol"?e+"":e,t),t);const Yue=_e.createContext({}),Zue=()=>_e.useContext(Yue)||{};var Kue={exports:{}},DA={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FJ;function l8e(){if(FJ)return DA;FJ=1;var n=Al,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,a,d){var f,m={},_=null,x=null;d!==void 0&&(_=""+d),a.key!==void 0&&(_=""+a.key),a.ref!==void 0&&(x=a.ref);for(f in a)r.call(a,f)&&!o.hasOwnProperty(f)&&(m[f]=a[f]);if(c&&c.defaultProps)for(f in a=c.defaultProps,a)m[f]===void 0&&(m[f]=a[f]);return{$$typeof:e,type:c,key:_,ref:x,props:m,_owner:s.current}}return DA.Fragment=t,DA.jsx=l,DA.jsxs=l,DA}Kue.exports=l8e();var n0=Kue.exports;function c8e(n,e){return e?sU(n).reduce((t,[r,s])=>(qM(e,r)&&(t[r]=s),t),{}):{}}function sU(n){return Object.keys(n).map(e=>[e,n[e]])}function qM(n,e){return!!n&&n.indexOf(e)!==-1}function u8e(n,e){return!!n&&!!e&&[...Object.keys(n),...Object.keys(e)].every(t=>n[t]===e[t])}function h8e(n){return n&&typeof n.isDestroyed=="function"&&typeof n.destroy=="function"}function d8e(n){return h8e(n)&&n.isDestroyed()}function D0(n){return n&&typeof n=="object"&&"then"in n&&typeof n.then=="function"}const Vb="__RESIUM_EVENT_MANAGER",oU=["onClick","onDoubleClick","onMouseDown","onMouseUp","onMiddleClick","onMiddleDown","onMiddleUp","onMouseMove","onPinchEnd","onPinchMove","onPinchStart","onRightClick","onRightDown","onRightUp","onWheel","onMouseEnter","onMouseLeave"],Jue=class Que{constructor(e){Ay(this,"scene"),Ay(this,"sshe"),Ay(this,"events",{onClick:new Map,onDoubleClick:new Map,onMouseDown:new Map,onMouseUp:new Map,onMiddleClick:new Map,onMiddleDown:new Map,onMiddleUp:new Map,onMouseMove:new Map,onPinchEnd:new Map,onPinchMove:new Map,onPinchStart:new Map,onRightClick:new Map,onRightDown:new Map,onRightUp:new Map,onWheel:new Map,onMouseEnter:new Map,onMouseLeave:new Map}),Ay(this,"hovered"),Ay(this,"onMouseMove",t=>{var r,s,o,l,c,a;const d=this.pick(t.endPosition);this.hovered!==d&&(this.hovered&&((r=this.getEventCallback("onMouseLeave",this.hovered))==null||r(t,this.hovered),(s=this.getEventCallback("onMouseLeave",null))==null||s(t,this.hovered)),d&&((o=this.getEventCallback("onMouseEnter",d))==null||o(t,d),(l=this.getEventCallback("onMouseEnter",null))==null||l(t,d))),d&&((c=this.getEventCallback("onMouseMove",d))==null||c(t,d)),(a=this.getEventCallback("onMouseMove",null))==null||a(t,d),this.hovered=d}),Ay(this,"eventCallback",t=>r=>{var s,o;const l=this.pick(r==null?void 0:r.position);l&&((s=this.getEventCallback(t,l))==null||s(r,l)),(o=this.getEventCallback(t,null))==null||o(r,l)}),this.scene=e,this.sshe=new Cesium.ScreenSpaceEventHandler(e==null?void 0:e.canvas)}destroy(){this.hovered=void 0,this.sshe.isDestroyed()||this.sshe.destroy()}isDestroyed(){return this.sshe.isDestroyed()}on(e,t,r){e&&t==="onWheel"||this.events[t].set(e,r)}off(e,t){this.events[t].delete(e),this.hovered===e&&(this.hovered=void 0)}setEvents(e,t){sU(t).forEach(([r,s])=>{const o=r;qM(oU,o)&&(s?this.on(e,o,s):this.off(e,o))}),this.commit()}clearEvents(e){this.hovered=void 0,oU.forEach(t=>{this.off(e,t)}),this.commit()}commit(){const e=this.sshe,t=this.sshe.isDestroyed();t||(this.events.onMouseEnter.size===0&&this.events.onMouseLeave.size===0&&this.events.onMouseMove.size===0?this.sshe.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE):this.sshe.getInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE)||this.sshe.setInputAction(this.onMouseMove,Cesium.ScreenSpaceEventType.MOUSE_MOVE)),sU(this.events).forEach(([r,s])=>{if(r==="onMouseEnter"||r==="onMouseLeave"||r==="onMouseMove")return;const o=Que.eventTypeMap[r];t||(s.size===0?e.removeInputAction(o):e.getInputAction(o)||e.setInputAction(this.eventCallback(r),o))})}getScreenSpaceEventHandler(){return this.sshe}getEventCallback(e,t){var r,s;return t===null?this.events[e].get(null):this.events[e].get(t.id)||this.events[e].get((s=(r=t.id)==null?void 0:r.entityCollection)==null?void 0:s.owner)||this.events[e].get(t.primitive)||this.events[e].get(t.tileset)}pick(e){var t;if(e)return(t=this.scene)==null?void 0:t.pick(e)}};Ay(Jue,"eventTypeMap",{onClick:Cesium.ScreenSpaceEventType.LEFT_CLICK,onDoubleClick:Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,onMouseDown:Cesium.ScreenSpaceEventType.LEFT_DOWN,onMouseUp:Cesium.ScreenSpaceEventType.LEFT_UP,onMiddleClick:Cesium.ScreenSpaceEventType.MIDDLE_CLICK,onMiddleDown:Cesium.ScreenSpaceEventType.MIDDLE_DOWN,onMiddleUp:Cesium.ScreenSpaceEventType.MIDDLE_UP,onMouseMove:Cesium.ScreenSpaceEventType.MOUSE_MOVE,onPinchEnd:Cesium.ScreenSpaceEventType.PINCH_END,onPinchMove:Cesium.ScreenSpaceEventType.PINCH_MOVE,onPinchStart:Cesium.ScreenSpaceEventType.PINCH_START,onRightClick:Cesium.ScreenSpaceEventType.RIGHT_CLICK,onRightDown:Cesium.ScreenSpaceEventType.RIGHT_DOWN,onRightUp:Cesium.ScreenSpaceEventType.RIGHT_UP,onWheel:Cesium.ScreenSpaceEventType.WHEEL,onMouseEnter:Cesium.ScreenSpaceEventType.MOUSE_MOVE,onMouseLeave:Cesium.ScreenSpaceEventType.MOUSE_MOVE});let ehe=Jue;const f8e=({name:n,create:e,destroy:t,provide:r,update:s,cesiumReadonlyProps:o,cesiumEventProps:l,otherProps:c,setCesiumPropsAfterCreate:a,useCommonEvent:d,useRootEvent:f},m,_)=>{const x=_e.useRef(),A=Zue(),I=_e.useRef(r?{}:void 0),E=_e.useRef({}),C=_e.useRef(NJ(m)),L=_e.useRef({}),[O,H]=_e.useState(!1),q=_e.useRef(!1),Z=_e.useRef(null),J=_e.useRef(),re=A==null?void 0:A[Vb],se=_e.useRef(),ae=_e.useRef(),he=_e.useCallback(async ze=>{var Re;if(!x.current)return;const rt=x.current,ye=Object.keys(ze),We=Object.keys(l||[]),Ue=ye.concat(Object.keys(L.current).filter(Dt=>!ye.includes(Dt))).filter(Dt=>L.current[Dt]!==ze[Dt]).map(Dt=>[Dt,L.current[Dt],ze[Dt]]),gt=[];for(const[Dt,lt,jt]of Ue)if(o!=null&&o.includes(Dt))gt.push(Dt);else if(qM(We,Dt)){const Qt=l==null?void 0:l[Dt],nn=rt[Qt];nn instanceof Cesium.Event&&(typeof lt>"u"?(nn.addEventListener(jt),E.current[Qt]=jt):typeof jt>"u"?(nn.removeEventListener(lt),delete E.current[Qt]):(nn.removeEventListener(lt),nn.addEventListener(jt)))}else Dt!=="children"&&!oU.includes(Dt)&&!(c!=null&&c.includes(Dt))&&(rt[Dt]=jt);const vt=f?(Re=I.current)==null?void 0:Re[Vb]:re;if(d&&vt&&x.current&&vt.setEvents(f?null:x.current,ze),s&&q.current){const Dt=s(x.current,ze,L.current,A);D0(Dt)&&await Dt}L.current=ze,C.current=ze,q.current&&gt.length>0&&(Ee(),await Pe(),se.current=Ae())},[]),Ae=_e.useCallback(async()=>{var ze;await new Promise(We=>queueMicrotask(()=>We(void 0)));const Re=e==null?void 0:e(A,C.current,Z.current);let rt;if(D0(Re)?rt=await Re:rt=Re,Array.isArray(rt)?(x.current=rt[0],J.current=rt[1]):x.current=rt,a)await he(C.current);else{if(x.current&&l){const We=x.current;for(const Ue of Object.keys(C.current)){const gt=l[Ue];if(gt){const vt=C.current[Ue],Dt=We[gt];vt&&Dt instanceof Cesium.Event&&Dt.addEventListener(vt)}}}L.current=C.current}r&&x.current&&(I.current={...A,...r(x.current,A,m,J.current)});const ye=f?(ze=I.current)==null?void 0:ze[Vb]:re;d&&ye&&x.current&&ye.setEvents(f?null:x.current,C.current),ae.current||H(!0)},[]),Ee=_e.useCallback(()=>{H(!1),q.current=!1},[]),Pe=_e.useCallback(async()=>{var ze,Re;await new Promise(ye=>queueMicrotask(()=>ye(void 0))),se.current&&(await se.current,se.current=void 0),x.current&&t&&t(x.current,A,Z.current,J.current);const rt=f?(ze=I.current)==null?void 0:ze[Vb]:re;if(d&&rt&&x.current&&rt.clearEvents(f?null:x.current),x.current&&!d8e(x.current)){const ye=Object.keys(E.current);for(const We of ye){const Ue=x.current[We];(Re=Ue==null?void 0:Ue.removeEventListener)==null||Re.call(Ue,E.current[We])}}E.current={},I.current=void 0,J.current=void 0,x.current=void 0},[]);return _e.useLayoutEffect(()=>((async()=>(ae.current&&(await ae.current,ae.current=void 0),se.current=Ae()))(),()=>{Ee(),ae.current=Pe()}),[Ae,Pe,Ee]),_e.useEffect(()=>{(async()=>{var ze,Re;se.current&&await se.current;const rt=NJ(m);O?u8e(rt,L.current)||(await he(rt),(Re=(ze=A.__$internal)==null?void 0:ze.onUpdate)==null||Re.call(ze)):(L.current=rt,C.current=rt,q.current=!0)})()},[A.__$internal,O,m,he]),_e.useImperativeHandle(_,()=>({cesiumElement:O?x.current:null}),[O]),[I.current,O,Z]};function NJ(n){const{children:e,...t}=n;return t}const Or=({renderContainer:n,noChildren:e,containerProps:t,defaultProps:r,...s})=>{const o=(l,c)=>{const a={...r,...l},[d,f,m]=f8e(s,a,c);if(e)return null;const _=f&&"children"in a?a.children:null,x=n?n0.jsx("div",{"data-testid":"resium-container",ref:m,...typeof t=="function"?t(a):c8e(a,t),children:_}):_?n0.jsx(n0.Fragment,{children:_}):null;return d?n0.jsx(Yue.Provider,{value:d,children:x}):x};return o.displayName=s.name,_e.forwardRef(o)},p8e=["enabled","selected"],mf=n=>Or({name:n.name,create(e,t){if(!e.scene)return;const r=n.create(t,e.scene.postProcessStages);return typeof t.enabled=="boolean"&&(r.enabled=t.enabled),t.selected&&"selected"in r&&(r.selected=t.selected),n.props.forEach(s=>{!qM(n.readonlyProps,s)&&typeof t[s]<"u"&&(r.uniforms[s]=t[s])}),!n.noMount&&e.scene&&!e.scene.isDestroyed()&&e.scene.postProcessStages.add(r),r},destroy(e,t){n.noMount?e.enabled=!1:(t.scene&&!t.scene.isDestroyed()&&t.scene.postProcessStages.remove(e),e.isDestroyed()||e.destroy())},update(e,t,r){n.props.forEach(s=>{!qM(n.readonlyProps,s)&&t[s]!==r[s]&&(e.uniforms[s]=t[s])})},cesiumProps:p8e,cesiumReadonlyProps:n.readonlyProps,defaultProps:{enabled:!0}}),m8e=["alignedAxis","color","disableDepthTestDistance","distanceDisplayCondition","eyeOffset","height","heightReference","horizontalOrigin","image","pixelOffset","pixelOffsetScaleByDistance","position","rotation","scale","scaleByDistance","show","sizeInMeters","translucencyByDistance","verticalOrigin","width","id"];Or({name:"Billboard",create(n,e){var t;return(t=n.billboardCollection)==null?void 0:t.add(e)},destroy(n,e){e.billboardCollection&&!e.billboardCollection.isDestroyed()&&e.billboardCollection.remove(n)},cesiumProps:m8e,useCommonEvent:!0});const g8e=["blendOption","debugShowBoundingVolume","debugShowTextureAtlas","modelMatrix","show"];Or({name:"BillboardCollection",create(n,e){if(!n.primitiveCollection)return;const t=new Cesium.BillboardCollection({modelMatrix:e.modelMatrix,debugShowBoundingVolume:e.debugShowBoundingVolume,scene:n.scene,blendOption:e.blendOption});return n.primitiveCollection.add(t),t},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},provide(n){return{billboardCollection:n}},cesiumProps:g8e});const v8e=["image","show","scale","horizontalOrigin","verticalOrigin","eyeOffset","pixelOffset","rotation","alignedAxis","width","height","color","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","sizeInMeters","heightReference","distanceDisplayCondition","disableDepthTestDistance"],_8e={onDefinitionChange:"definitionChanged"};Or({name:"BillboardGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.BillboardGraphics(e);return n.entity.billboard=t,t},destroy(n,e){e.entity&&(e.entity.billboard=void 0)},cesiumProps:v8e,cesiumEventProps:_8e});const y8e=["heightReference","dimensions","show","fill","material","outline","outlineColor","outlineWidth","shadows","distanceDisplayCondition"],x8e={onDefinitionChange:"definitionChanged"};Or({name:"BoxGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.BoxGraphics(e);return n.entity.box=t,t},destroy(n,e){e.entity&&(e.entity.box=void 0)},cesiumProps:y8e,cesiumEventProps:x8e});const b8e=["position","direction","up","right","frustum","defaultMoveAmount","defaultLookAmount","defaultRotateAmount","defaultZoomAmount","constrainedAxis","maximumZoomFactor","percentageChanged"],w8e={onChange:"changed",onMoveEnd:"moveEnd",onMoveStart:"moveStart"};Or({name:"Camera",create:n=>{var e;return(e=n.scene)==null?void 0:e.camera},cesiumProps:b8e,cesiumEventProps:w8e,setCesiumPropsAfterCreate:!0});const S8e=["show","modelMatrix","shadows","maximumScreenSpaceError","cullRequestsWhileMoving","cullRequestsWhileMovingMultiplier","preloadWhenHidden","preloadFlightDestinations","preferLeaves","progressiveResolutionHeightFraction","foveatedScreenSpaceError","foveatedConeSize","foveatedMinimumScreenSpaceErrorRelaxation","foveatedInterpolationCallback","foveatedTimeDelay","dynamicScreenSpaceError","dynamicScreenSpaceErrorDensity","dynamicScreenSpaceErrorFactor","dynamicScreenSpaceErrorHeightFalloff","skipLevelOfDetail","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","clippingPlanes","classificationType","ellipsoid","lightColor","colorBlendAmount","colorBlendMode","debugFreezeFrame","debugColorizeTiles","debugWireframe","debugShowBoundingVolume","debugShowContentBoundingVolume","debugShowViewerRequestVolume","debugShowGeometricError","debugShowRenderingStatistics","debugShowMemoryUsage","debugShowUrl","style","backFaceCulling","vectorClassificationOnly","vectorKeepDecodedPositions","splitDirection","customShader","imageBasedLighting","showCreditsOnScreen","featureIdLabel","instanceFeatureIdLabel","imageBasedLighting","outlineColor","cacheBytes","maximumCacheOverflowBytes","enableCollision"],A8e=["showOutline","cullWithChildrenBounds","debugHeatmapTilePropertyName","enableDebugWireframe","modelUpAxis","modelForwardAxis","projectTo2D","enableShowOutline","enablePick"],T8e={onAllTilesLoad:"allTilesLoaded",onInitialTilesLoad:"initialTilesLoaded",onLoadProgress:"loadProgress",onTileFailed:"tileFailed",onTileLoad:"tileLoad",onTileUnload:"tileUnload",onTileVisible:"tileVisible"},M8e=["onReady","onError","url"],C8e=Or({name:"Cesium3DTileset",async create(n,e){var t,r;if(!n.primitiveCollection)return;const s=e.url;let o;D0(s)?o=await s:o=s;let l;try{l=await Cesium.Cesium3DTileset.fromUrl(o,e),(t=e.onReady)==null||t.call(e,l)}catch(c){(r=e.onError)==null||r.call(e,c);return}return e.colorBlendAmount&&(l.colorBlendAmount=e.colorBlendAmount),e.colorBlendMode&&(l.colorBlendMode=e.colorBlendMode),e.style&&(l.style=e.style),n.primitiveCollection.add(l),l},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:S8e,cesiumReadonlyProps:A8e,cesiumEventProps:T8e,otherProps:M8e,useCommonEvent:!0}),UL=C8e,E8e=["show","uri","maximumScreenSpaceError"],I8e={onDefinitionChange:"definitionChanged"};Or({name:"Cesium3DTilesetGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.Cesium3DTilesetGraphics(e);return n.entity.tileset=t,t},destroy(n,e){e.entity&&(e.entity.tileset=void 0)},cesiumProps:E8e,cesiumEventProps:I8e});const P8e=["resolutionScale","useDefaultRenderLoop","targetFrameRate","useBrowserRecommendedResolution","creditDisplay"],R8e=["clock","baseLayer","terrainProvider","skyBox","skyAtmosphere","sceneMode","scene3DOnly","orderIndependentTranslucency","mapMode2D","mapProjection","globe","showRenderLoopErrors","contextOptions","creditContainer","creditViewport","shadows","terrainShadows","terrain","requestRenderMode","maximumRenderTimeChange","msaaSamples","blurActiveElementOnCanvasFocus"],L8e=["className","id","style","full","containerProps"];Or({name:"CesiumWidget",create(n,e,t){if(!t)return;const r=new Cesium.CesiumWidget(t,e);if(!r)return;typeof e.resolutionScale=="number"&&(r.resolutionScale=e.resolutionScale);const s=new ehe(r.scene);return[r,s]},destroy(n,e,t,r){r&&!r.isDestroyed()&&r.destroy(),n.isDestroyed()||n.destroy()},provide(n,e,t,r){return{cesiumWidget:n,scene:n.scene,camera:n.scene.camera,imageryLayerCollection:n.scene.globe.imageryLayers,primitiveCollection:n.scene.primitives,globe:n.scene.globe,__$internal:{onUpdate:t==null?void 0:t.onUpdate},[Vb]:r}},containerProps:({id:n,className:e,style:t,full:r,containerProps:s})=>({className:e,id:n,style:{...r?{position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}:{},...t},...s}),cesiumProps:P8e,cesiumReadonlyProps:R8e,otherProps:L8e,renderContainer:!0,useCommonEvent:!0,useRootEvent:!0});const D8e=["classificationType","debugShowBoundingVolume","debugShowShadowVolume","show"],B8e=["allowPicking","asynchronous","compressVertices","geometryInstances","interleave","releaseGeometryInstances","vertexCacheOptimize","appearance"],k8e=["onReady"];Or({name:"ClassificationPrimitive",async create(n,e){var t;if(!n.primitiveCollection)return;const r=new Cesium.ClassificationPrimitive(e);if(e.onReady){const s=()=>{var o,l;r.ready&&((o=e.onReady)==null||o.call(e,r),(l=n.scene)==null||l.postRender.removeEventListener(s))};(t=n.scene)==null||t.postRender.addEventListener(s)}return n.primitiveCollection.add(r),r},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:D8e,cesiumReadonlyProps:B8e,otherProps:k8e,useCommonEvent:!0});const O8e={onStop:"onStop",onTick:"onTick"},F8e=["canAnimate","clockRange","clockStep","currentTime","multiplier","shouldAnimate","startTime","stopTime"];Or({name:"Clock",create:n=>{var e;return(e=n.cesiumWidget)==null?void 0:e.clock},cesiumProps:F8e,cesiumEventProps:O8e,setCesiumPropsAfterCreate:!0});const N8e=["noiseDetail","noiseOffset","show","debugBillboards","debugEllipsoids"];Or({name:"CloudCollection",create:n=>{if(!n.primitiveCollection)return;const e=new Cesium.CloudCollection;return n.primitiveCollection.add(e),e},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},provide:n=>({cloudCollection:n}),cesiumProps:N8e,setCesiumPropsAfterCreate:!0});const z8e=["positions","width","cornerType","height","heightReference","extrudedHeight","extrudedHeightReference","show","fill","material","outline","outlineColor","outlineWidth","granularity","shadows","distanceDisplayCondition","zIndex","classificationType"],U8e={onDefinitionChange:"definitionChanged"};Or({name:"CorridorGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.CorridorGraphics(e);return e.classificationType&&(t.classificationType=e.classificationType),n.entity.corridor=t,t},destroy(n,e){e.entity&&(e.entity.corridor=void 0)},cesiumProps:z8e,cesiumEventProps:U8e});const G8e=["show","position","scale","maximumSize","slice","brightness","color"];Or({name:"CumulusCloud",create:(n,e)=>{var t;return(t=n.cloudCollection)==null?void 0:t.add(e)},destroy(n,e){e.cloudCollection&&!e.cloudCollection.isDestroyed()&&e.cloudCollection.remove(n)},cesiumProps:G8e});const V8e=["clustering","name","show","clock","isLoading"],H8e={onChange:"changedEvent",onError:"errorEvent",onLoading:"loadingEvent"};Or({name:"CustomDataSource",create(n,e){if(!n.dataSourceCollection)return;const t=new Cesium.CustomDataSource(e.name);return e.clustering&&(t.clustering=e.clustering),typeof e.show=="boolean"&&(t.show=e.show),typeof e.clock<"u"&&(t.clock=e.clock),n.dataSourceCollection.add(t),t},destroy(n,e){e.dataSourceCollection&&!e.dataSourceCollection.isDestroyed()&&e.dataSourceCollection.remove(n)},provide(n){return{entityCollection:n.entities,dataSource:n}},cesiumProps:V8e,cesiumEventProps:H8e,useCommonEvent:!0});const j8e=["heightReference","length","topRadius","bottomRadius","show","fill","material","outline","outlineColor","outlineWidth","numberOfVerticalLines","slices","distanceDisplayCondition","shadows"],W8e={onDefinitionChange:"definitionChanged"},$8e=Or({name:"CylinderGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.CylinderGraphics(e);return n.entity.cylinder=t,t},destroy(n,e){e.entity&&(e.entity.cylinder=void 0)},cesiumProps:j8e,cesiumEventProps:W8e}),X8e=$8e,q8e=["clustering","show"],Y8e=["name","sourceUri","credit"],Z8e={onChange:"changedEvent",onError:"errorEvent",onLoading:"loadingEvent"},K8e=["onLoad","data"],zJ=(n,{data:e,onLoad:t,...r})=>{e&&n.load(e,r).then(s=>{t&&t(s)})};Or({name:"CzmlDataSource",create(n,e){if(!n.dataSourceCollection)return;const t=new Cesium.CzmlDataSource(e.name);return e.clustering&&(t.clustering=e.clustering),typeof e.show=="boolean"&&(t.show=e.show),n.dataSourceCollection.add(t),e.data&&zJ(t,e),t},update(n,e,t){e.data?t.show!==e.show&&(n.show=typeof e.show=="boolean"?e.show:!0):n.show=!1,e.data&&(t.data!==e.data||t.sourceUri!==e.sourceUri||t.credit!==e.credit)&&zJ(n,e)},destroy(n,e){e.dataSourceCollection&&!e.dataSourceCollection.isDestroyed()&&e.dataSourceCollection.remove(n)},provide(n){return{dataSource:n}},cesiumProps:q8e,cesiumReadonlyProps:Y8e,cesiumEventProps:Z8e,otherProps:K8e,useCommonEvent:!0});const J8e=["semiMajorAxis","semiMinorAxis","height","heightReference","extrudedHeight","show","fill","material","outline","outlineColor","outlineWidth","numberOfVerticalLines","rotation","stRotation","granularity","shadows","distanceDisplayCondition","zIndex","classificationType","extrudedHeightReference"],Q8e={onDefinitionChange:"definitionChanged"};Or({name:"EllipseGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.EllipseGraphics(e);return n.entity.ellipse=t,t},destroy(n,e){e.entity&&(e.entity.ellipse=void 0)},cesiumProps:J8e,cesiumEventProps:Q8e});const eVe=["heightReference","radii","show","fill","innerRadii","material","maximumClock","maximumCone","minimumClock","minimumCone","outline","outlineColor","outlineWidth","subdivisions","stackPartitions","slicePartitions","shadows","distanceDisplayCondition"],tVe={onDefinitionChange:"definitionChanged"};Or({name:"EllipsoidGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.EllipsoidGraphics(e);return n.entity.ellipsoid=t,t},destroy(n,e){e.entity&&(e.entity.ellipsoid=void 0)},cesiumProps:eVe,cesiumEventProps:tVe});const nVe=["availability","billboard","box","corridor","cylinder","description","ellipse","ellipsoid","entityCollection","label","model","name","orientation","path","plane","parent","point","polygon","polyline","polylineVolume","position","properties","rectangle","show","tileset","viewFrom","wall"],rVe=["id"],iVe={onDefinitionChange:"definitionChanged"},sVe=["selected","tracked"],oVe=Or({name:"Entity",create(n,e){if(!n.entityCollection)return;const t=new Cesium.Entity(e);return n.viewer&&e.selected&&(n.viewer.selectedEntity=t),n.viewer&&e.tracked&&(n.viewer.trackedEntity=t),n.entityCollection.add(t),t},destroy(n,e){e.entityCollection&&e.entityCollection.remove(n)},update(n,e,t,r){r.viewer&&(e.selected!==t.selected&&(e.selected?r.viewer.selectedEntity=n:r.viewer.selectedEntity===n&&(r.viewer.selectedEntity=void 0)),e.tracked!==t.tracked&&(e.tracked?r.viewer.trackedEntity=n:r.viewer.trackedEntity===n&&(r.viewer.trackedEntity=void 0)))},provide(n,e,t){return{entity:n,__$internal:{onUpdate:t==null?void 0:t.onUpdate}}},cesiumProps:nVe,cesiumReadonlyProps:rVe,cesiumEventProps:iVe,otherProps:sVe,useCommonEvent:!0}),GL=oVe,aVe=({children:n,container:e,resizeInfoBox:t=!0})=>{const{viewer:r,entity:s}=Zue(),[o,l]=_e.useState(!1),c=_e.useMemo(()=>{var a;return e??((a=r==null?void 0:r.infoBox.frame.contentDocument)==null?void 0:a.createElement("div"))},[e,r==null?void 0:r.infoBox.frame.contentDocument]);return _e.useEffect(()=>{if(!r||!s)return;const a=d=>{l(!!d&&d.id===s.id)};return r.selectedEntityChanged.addEventListener(a),()=>{r.selectedEntityChanged.removeEventListener(a)}},[s,r]),_e.useEffect(()=>{var a,d;if(e||!c||!r)return;const f=(a=r.infoBox)==null?void 0:a.frame,m=(d=f==null?void 0:f.contentDocument)==null?void 0:d.querySelector(".cesium-infoBox-description");if(!f||!m)return;let _;if(o){if(t){const x=m.getBoundingClientRect().height;f.style.height=x+"px",_=window.setInterval(()=>{const A=r.infoBox.container.querySelector(".cesium-infoBox.cesium-infoBox-visible");A&&(clearInterval(_),_=void 0,m.appendChild(c),A.classList.remove("cesium-infoBox-bodyless"),f.style.height=m.getBoundingClientRect().height+"px")},10)}}else c.parentElement===m&&m.removeChild(c);return _?()=>clearTimeout(_):void 0},[c,e,t,o,r]),c?n0.jsx(n0.Fragment,{children:Dh.createPortal(n0.jsx(n0.Fragment,{children:!e||o?n:null}),c)}):null},lVe=aVe,cVe=["density","enabled","minimumBrightness","screenSpaceErrorFactor","renderable"];Or({name:"Fog",create(n){if(!n.scene)return;const e=new Cesium.Fog;return n.scene.fog=e,e},destroy(n,e){e.scene&&!e.scene.isDestroyed()&&(e.scene.fog=new Cesium.Fog)},cesiumProps:cVe,setCesiumPropsAfterCreate:!0});const uVe=["clustering","name","show"],hVe=["clampToGround","sourceUri","credit","markerSize","markerSymbol","markerColor","stroke","strokeWidth","fill","describe"],dVe={onChange:"changedEvent",onError:"errorEvent",onLoading:"loadingEvent"},fVe=["onLoad","data"],UJ=(n,{data:e,onLoad:t,...r})=>{e&&n.load(e,r).then(s=>{t&&t(s)})},pVe=Or({name:"GeoJsonDataSource",create(n,e){if(!n.dataSourceCollection)return;const t=new Cesium.GeoJsonDataSource(e.name);return e.clustering&&(t.clustering=e.clustering),typeof e.show=="boolean"&&(t.show=e.show),n.dataSourceCollection.add(t),e.data&&UJ(t,e),t},update(n,e,t){e.data?t.show!==e.show&&(n.show=typeof e.show=="boolean"?e.show:!0):n.show=!1,e.data&&(t.data!==e.data||t.clampToGround!==e.clampToGround||t.sourceUri!==e.sourceUri||t.credit!==e.credit||t.markerSize!==e.markerSize||t.markerSymbol!==e.markerSymbol||t.markerColor!==e.markerColor||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fill!==e.fill)&&UJ(n,e)},destroy(n,e){e.dataSourceCollection&&!e.dataSourceCollection.isDestroyed()&&e.dataSourceCollection.remove(n)},provide(n){return{dataSource:n}},cesiumProps:uVe,cesiumReadonlyProps:hVe,cesiumEventProps:dVe,otherProps:fVe,useCommonEvent:!0}),mVe=pVe,gVe={onImageryLayersUpdate:"imageryLayersUpdatedEvent",onTerrainProviderChange:"terrainProviderChanged",onTileLoadProgress:"tileLoadProgressEvent"},vVe=["atmosphereBrightnessShift","atmosphereHueShift","atmosphereSaturationShift","backFaceCulling","baseColor","clippingPlanes","depthTestAgainstTerrain","enableLighting","lightingFadeInDistance","lightingFadeOutDistance","material","maximumScreenSpaceError","nightFadeInDistance","nightFadeOutDistance","oceanNormalMapUrl","shadows","show","showGroundAtmosphere","showWaterEffect","tileCacheSize","loadingDescendantLimit","preloadAncestors","preloadSiblings","fillHighlightColor","dynamicAtmosphereLighting","dynamicAtmosphereLightingFromSun","showSkirts","cartographicLimitRectangle","translucency","undergroundColor","undergroundColorAlphaByDistance","lambertDiffuseMultiplier","atmosphereLightIntensity","atmosphereRayleighCoefficient","atmosphereMieCoefficient","atmosphereRayleighScaleHeight","atmosphereMieScaleHeight","atmosphereMieAnisotropy","vertexShadowDarkness"],_Ve=["terrainProvider"];Or({name:"Globe",create:n=>{var e;return(e=n.scene)==null?void 0:e.globe},update:async(n,e)=>{const t=e.terrainProvider;let r;D0(t)?r=await t:r=t,n.terrainProvider=r},cesiumProps:vVe,cesiumEventProps:gVe,otherProps:_Ve,setCesiumPropsAfterCreate:!0});const yVe=["appearance","classificationType","debugShowBoundingVolume","debugShowShadowVolume","show"],xVe=["allowPicking","asynchronous","geometryInstances","interleave","releaseGeometryInstances"],bVe=["onReady"];Or({name:"GroundPolylinePrimitive",create(n,e){var t;if(!n.primitiveCollection)return;const r=new Cesium.GroundPolylinePrimitive(e);if(e.onReady){const s=()=>{var o,l;r.ready&&((o=e.onReady)==null||o.call(e,r),(l=n.scene)==null||l.postRender.removeEventListener(s))};(t=n.scene)==null||t.postRender.addEventListener(s)}return n.primitiveCollection.add(r),r},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:yVe,cesiumReadonlyProps:xVe,otherProps:bVe,useCommonEvent:!0});const wVe=["appearance","classificationType","debugShowBoundingVolume","debugShowShadowVolume","show"],SVe=["allowPicking","asynchronous","compressVertices","geometryInstances","interleave","releaseGeometryInstances","vertexCacheOptimize"],AVe=["onReady"];Or({name:"GroundPrimitive",create(n,e){var t;if(!n.primitiveCollection)return;const r=new Cesium.GroundPrimitive(e);if(e.onReady){const s=()=>{var o,l;r.ready&&((o=e.onReady)==null||o.call(e,r),(l=n.scene)==null||l.postRender.removeEventListener(s))};(t=n.scene)==null||t.postRender.addEventListener(s)}return n.primitiveCollection.add(r),r},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:wVe,cesiumReadonlyProps:SVe,otherProps:AVe,useCommonEvent:!0});const TVe=["show","destroyPrimitives","primitiveAdded","primitiveRemoved"];Or({name:"GroundPrimitiveCollection",create:n=>{var e;return(e=n.scene)==null?void 0:e.groundPrimitives},provide:n=>({primitiveCollection:n}),cesiumProps:TVe,setCesiumPropsAfterCreate:!0});const MVe=["alpha","brightness","contrast","hue","saturation","gamma","splitDirection","minificationFilter","magnificationFilter","cutoutRectangle","show","nightAlpha","dayAlpha","colorToAlpha","colorToAlphaThreshold","index"],CVe=["rectangle","maximumAnisotropy","minimumTerrainLevel","maximumTerrainLevel","readyEvent","imageryProvider"],EVe=Or({name:"ImageryLayer",async create(n,e){var t,r,s,o;if(!n.imageryLayerCollection)return;const l=D0(e.imageryProvider)?e.imageryProvider:new Promise(f=>queueMicrotask(()=>f(e.imageryProvider))),c=(r=(t=n.__$internal)==null?void 0:t.imageryLayerWaitingList)==null?void 0:r.slice();(s=n.__$internal)!=null&&s.imageryLayerWaitingList&&n.__$internal.imageryLayerWaitingList.push(l),c&&await Promise.all(c.filter(f=>D0(f)));const a=await l;if((o=n.__$internal)!=null&&o.imageryLayerWaitingList&&(n.__$internal.imageryLayerWaitingList=n.__$internal.imageryLayerWaitingList.filter(f=>f!==l)),!a)return;const d=new Cesium.ImageryLayer(a,e);return n.imageryLayerCollection.add(d,e.index),d},destroy(n,e){e.imageryLayerCollection&&e.imageryLayerCollection.remove(n)},cesiumProps:MVe,cesiumReadonlyProps:CVe}),IVe=EVe,PVe={onLayerAdd:"layerAdded",onLayerMove:"layerMoved",onLayerRemove:"layerRemoved",onLayerShowOrHide:"layerShownOrHidden"};Or({name:"ImageryLayerCollection",create:n=>{var e;return(e=n.globe)==null?void 0:e.imageryLayers},cesiumEventProps:PVe});const RVe=["clustering","name","show"],LVe=["canvas","camera","ellipsoid","clampToGround","sourceUri","credit","screenOverlayContainer"],DVe={onChange:"changedEvent",onError:"errorEvent",onLoading:"loadingEvent",onRefresh:"refreshEvent",onUnsupportedNode:"unsupportedNodeEvent"},BVe=["onLoad","data"],GJ=(n,{data:e,onLoad:t,...r})=>{e&&n.load(e,r).then(s=>{t&&t(s)})};Or({name:"KmlDataSource",create(n,e){if(!n.scene||!n.dataSourceCollection||!n.scene)return;const t=new Cesium.KmlDataSource({camera:e.camera||n.scene.camera,canvas:e.canvas||n.scene.canvas,ellipsoid:e.ellipsoid,credit:e.credit});return e.clustering&&(t.clustering=e.clustering),typeof e.show=="boolean"&&(t.show=e.show),typeof e.name<"u"&&(t.name=e.name),n.dataSourceCollection.add(t),e.data&&GJ(t,e),t},update(n,e,t){e.data?t.show!==e.show&&(n.show=typeof e.show=="boolean"?e.show:!0):n.show=!1,e.data&&(t.data!==e.data||t.clampToGround!==e.clampToGround||t.ellipsoid!==e.ellipsoid||t.sourceUri!==e.sourceUri||t.credit!==e.credit)&&GJ(n,e)},destroy(n,e){e.dataSourceCollection&&!e.dataSourceCollection.isDestroyed()&&e.dataSourceCollection.remove(n)},provide(n){return{dataSource:n}},cesiumProps:RVe,cesiumReadonlyProps:LVe,cesiumEventProps:DVe,otherProps:BVe,useCommonEvent:!0});const kVe=["backgroundColor","backgroundPadding","disableDepthTestDistance","distanceDisplayCondition","eyeOffset","fillColor","font","heightReference","horizontalOrigin","id","outlineColor","outlineWidth","pixelOffset","pixelOffsetScaleByDistance","position","scale","scaleByDistance","show","showBackground","style","text","translucencyByDistance","verticalOrigin"];Or({name:"Label",create:(n,e)=>{var t;return(t=n.labelCollection)==null?void 0:t.add(e)},destroy(n,e){e.labelCollection&&!e.labelCollection.isDestroyed()&&e.labelCollection.remove(n)},cesiumProps:kVe,useCommonEvent:!0});const OVe=["blendOption","debugShowBoundingVolume","modelMatrix","show"];Or({name:"LabelCollection",create(n,e){if(!n.scene||!n.primitiveCollection)return;const t=new Cesium.LabelCollection({scene:n.scene,modelMatrix:e.modelMatrix,blendOption:e.blendOption,debugShowBoundingVolume:e.debugShowBoundingVolume});return n.primitiveCollection.add(t),t},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},provide(n){return{labelCollection:n}},cesiumProps:OVe});const FVe=["text","font","style","fillColor","outlineColor","outlineWidth","show","showBackground","backgroundColor","backgroundPadding","scale","horizontalOrigin","verticalOrigin","eyeOffset","pixelOffset","translucencyByDistance","pixelOffsetScaleByDistance","scaleByDistance","heightReference","distanceDisplayCondition","disableDepthTestDistance"],NVe={onDefinitionChange:"definitionChanged"};Or({name:"LabelGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.LabelGraphics(e);return n.entity.label=t,t},destroy(n,e){e.entity&&(e.entity.label=void 0)},cesiumProps:FVe,cesiumEventProps:NVe});const zVe=["backFaceCulling","clampAnimations","clippingPlanes","color","colorBlendAmount","colorBlendMode","customShader","debugShowBoundingVolume","debugWireframe","distanceDisplayCondition","featureIdLabel","heightReference","id","imageBasedLighting","instanceFeatureIdLabel","lightColor","maximumScale","minimumPixelSize","modelMatrix","outlineColor","scale","shadows","show","showCreditsOnScreen","showOutline","silhouetteColor","silhouetteSize","splitDirection","style"],UVe=["allowPicking","asynchronous","basePath","credit","enableDebugWireframe","gltf","heightReference","incrementallyLoadTextures","scene","releaseGltfJson","cull","opaquePass","upAxis","forwardAxis","content","scene","enableShowOutline","projectTo2D","classificationType","errorEvent","readyEvent","texturesReadyEvent","gltfCallback","enablePick"],GVe=["onReady","onError","url"];Or({name:"Model",async create(n,{scene:e,url:t,colorBlendMode:r,...s}){var o;if(!n.scene||!n.primitiveCollection||!t)return;const l=t;let c;D0(l)?c=await l:c=l;let a;try{a=await Cesium.Model.fromGltfAsync({...s,url:c,colorBlendMode:r,scene:e||n.scene})}catch(d){(o=s.onError)==null||o.call(s,d);return}return n.primitiveCollection.add(a),a},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumEventProps:{onReady:"readyEvent"},cesiumProps:zVe,cesiumReadonlyProps:UVe,otherProps:GVe,useCommonEvent:!0});const VVe=["uri","show","scale","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","nodeTransformations","shadows","heightReference","distanceDisplayCondition","silhouetteColor","silhouetteSize","color","colorBlendMode","colorBlendAmount","clippingPlanes","imageBasedLightingFactor","lightColor","articulations","customShader"],HVe={onDefinitionChange:"definitionChanged"};Or({name:"ModelGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.ModelGraphics(e);return n.entity.model=t,t},destroy(n,e){e.entity&&(e.entity.model=void 0)},cesiumProps:VVe,cesiumEventProps:HVe});const jVe=["onlySunLighting","show","textureUrl"],WVe=["ellipsoid"];Or({name:"Moon",create(n,e){if(!n.scene)return;const t=new Cesium.Moon(e);return n.scene.moon=t,t},destroy(n,e){e.scene&&!e.scene.isDestroyed()&&(e.scene.moon=new Cesium.Moon)},cesiumProps:jVe,cesiumReadonlyProps:WVe});const $Ve=["show","emitter","modelMatrix","emitterModelMatrix","emissionRate","bursts","loop","startScale","endScale","startColor","endColor","image","imageSize","minimumImageSize","maximumImageSize","speed","minimumSpeed","maximumSpeed","lifetime","particleLife","minimumParticleLife","maximumParticleLife","mass","minimumMass","maximumMass","sizeInMeters"],XVe={onComplete:"complete",onUpdate:"updateCallback"};Or({name:"ParticleSystem",create(n,e){if(!n.primitiveCollection)return;const t=new Cesium.ParticleSystem({...e,updateCallback:e.onUpdate});return n.primitiveCollection.add(t),t},update(n,e,t){e.onUpdate!==t.onUpdate&&(n.updateCallback=e.onUpdate)},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n)},cesiumProps:$Ve,cesiumEventProps:XVe});const qVe=["leadTime","trailTime","show","width","material","resolution","distanceDisplayCondition"],YVe={onDefinitionChange:"definitionChanged"};Or({name:"PathGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PathGraphics(e);return n.entity.path=t,t},destroy(n,e){e.entity&&(e.entity.path=void 0)},cesiumProps:qVe,cesiumEventProps:YVe});const ZVe=["plane","dimensions","show","fill","material","outline","outlineColor","outlineWidth","shadows","distanceDisplayCondition"],KVe={onDefinitionChange:"definitionChanged"};Or({name:"PlaneGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PlaneGraphics(e);return n.entity.plane=t,t},destroy(n,e){e.entity&&(e.entity.plane=void 0)},cesiumProps:ZVe,cesiumEventProps:KVe});const JVe=["color","pixelSize","outlineColor","outlineWidth","show","scaleByDistance","translucencyByDistance","heightReference","distanceDisplayCondition","disableDepthTestDistance"],QVe={onDefinitionChange:"definitionChanged"},eHe=Or({name:"PointGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PointGraphics(e);return n.entity.point=t,t},destroy(n,e){e.entity&&(e.entity.point=void 0)},cesiumProps:JVe,cesiumEventProps:QVe}),the=eHe,tHe=["color","disableDepthTestDistance","distanceDisplayCondition","id","outlineColor","outlineWidth","pixelSize","position","scaleByDistance","show","translucencyByDistance"];Or({name:"PointPrimitive",create:(n,e)=>{var t;return(t=n.pointPrimitiveCollection)==null?void 0:t.add(e)},destroy(n,e){e.pointPrimitiveCollection&&!e.pointPrimitiveCollection.isDestroyed()&&e.pointPrimitiveCollection.remove(n)},cesiumProps:tHe,useCommonEvent:!0});const nHe=["blendOption","debugShowBoundingVolume","modelMatrix","show"];Or({name:"PointPrimitveCollection",create(n,e){if(!n.primitiveCollection)return;const t=new Cesium.PointPrimitiveCollection(e);return n.primitiveCollection.add(t),t},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},provide(n){return{pointPrimitiveCollection:n}},cesiumProps:nHe});const rHe=["arcType","hierarchy","height","heightReference","extrudedHeight","extrudedHeightReference","show","fill","material","outline","outlineColor","outlineWidth","stRotation","granularity","perPositionHeight","closeTop","closeBottom","shadows","distanceDisplayCondition","zIndex","classificationType","textureCoordinates"],iHe={onDefinitionChange:"definitionChanged"};Or({name:"PolygonGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PolygonGraphics(e);return n.entity.polygon=t,t},destroy(n,e){e.entity&&(e.entity.polygon=void 0)},cesiumProps:rHe,cesiumEventProps:iHe});const sHe=["distanceDisplayCondition","id","loop","material","positions","show","width"];Or({name:"Polyline",create:(n,e)=>{var t;return(t=n.polylineCollection)==null?void 0:t.add(e)},destroy(n,e){e.polylineCollection&&!e.polylineCollection.isDestroyed()&&e.polylineCollection.remove(n)},cesiumProps:sHe,useCommonEvent:!0});const oHe=["debugShowBoundingVolume","length","modelMatrix","show"];Or({name:"PolylineCollection",create(n,e){if(!n.primitiveCollection)return;const t=new Cesium.PolylineCollection({modelMatrix:e.modelMatrix,debugShowBoundingVolume:e.debugShowBoundingVolume,length:e.length,scene:n.scene});return n.primitiveCollection.add(t),t},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},provide(n){return{polylineCollection:n}},cesiumProps:oHe});const aHe=["arcType","classificationType","positions","clampToGround","width","show","material","depthFailMaterial","granularity","shadows","distanceDisplayCondition","zIndex"],lHe={onDefinitionChange:"definitionChanged"};Or({name:"PolylineGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PolylineGraphics(e);return n.entity.polyline=t,t},destroy(n,e){e.entity&&(e.entity.polyline=void 0)},cesiumProps:aHe,cesiumEventProps:lHe});const cHe=["positions","shape","cornerType","show","fill","material","outline","outlineColor","outlineWidth","granularity","shadows","distanceDisplayCondition"],uHe={onDefinitionChange:"definitionChanged"};Or({name:"PolylineVolumeGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.PolylineVolumeGraphics(e);return n.entity.polylineVolume=t,t},destroy(n,e){e.entity&&(e.entity.polylineVolume=void 0)},cesiumProps:cHe,cesiumEventProps:uHe});const hHe=["enabled","selected"],dHe=["clearColor","forcePowerOfTwo","fragmentShader","name","pixelDatatype","pixelFormat","sampleMode","scissorRectangle","textureScale","uniforms"];Or({name:"PostProcessStage",create(n,e){if(!n.scene)return;const t=new Cesium.PostProcessStage(e);return typeof e.enabled=="boolean"&&(t.enabled=e.enabled),e.selected&&(t.selected=e.selected),n.scene.postProcessStages.add(t),t},destroy(n,e){e.scene&&!e.scene.isDestroyed()&&e.scene.postProcessStages.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:hHe,cesiumReadonlyProps:dHe});mf({name:"BlackAndWhiteStage",props:["gradations"],create:()=>Cesium.PostProcessStageLibrary.createBlackAndWhiteStage()});mf({name:"BrightnessStage",props:["brightness"],create:()=>Cesium.PostProcessStageLibrary.createBrightnessStage()});mf({name:"LensFlareStage",props:["dirtTexture","starTexture","intensity","distortion","ghostDispersal","haloWidth","earthRadius"],create:()=>Cesium.PostProcessStageLibrary.createLensFlareStage()});mf({name:"Fxaa",create:(n,e)=>e.fxaa,props:[]});mf({name:"NightVisionStage",props:[],create:()=>Cesium.PostProcessStageLibrary.createNightVisionStage()});const fHe=["enabled","selected"],pHe=["inputPreviousStageTexture","name","stages","uniforms"];Or({name:"PostProcessStageComposite",create(n,e){if(!n.scene)return;const t=new Cesium.PostProcessStageComposite(e);return typeof e.enabled=="boolean"&&(t.enabled=e.enabled),e.selected&&(t.selected=e.selected),n.scene.postProcessStages.add(t),t},destroy(n,e){e.scene&&!e.scene.isDestroyed()&&e.scene.postProcessStages.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:fHe,cesiumReadonlyProps:pHe});mf({name:"AmbientOcclusion",create:(n,e)=>e.ambientOcclusion,props:["ambientOcclusionOnly","bias","delta","frustumLength","intensity","lengthCap","sigma","stepSize"],noMount:!0});mf({name:"Bloom",create:(n,e)=>e.bloom,props:["brightness","contrast","delta","glowOnly","sigma","stepSize"],noMount:!0});mf({name:"BlurStage",props:["delta","sigma","stepSize"],create:()=>Cesium.PostProcessStageLibrary.createBlurStage()});mf({name:"DepthOfFieldStage",props:["delta","focalDistance","sigma","stepSize"],create:()=>Cesium.PostProcessStageLibrary.createDepthOfFieldStage()});mf({name:"EdgeDetectionStage",props:["color","length"],create:()=>Cesium.PostProcessStageLibrary.createEdgeDetectionStage()});mf({name:"SilhouetteStage",props:["color","length"],create:()=>Cesium.PostProcessStageLibrary.createSilhouetteStage()});const mHe=["appearance","cull","debugShowBoundingVolume","depthFailAppearance","modelMatrix","shadows","show"],gHe=["allowPicking","asynchronous","compressVertices","geometryInstances","interleave","releaseGeometryInstances","vertexCacheOptimize"],vHe=["onReady"];Or({name:"Primitive",create(n,e){var t;if(!n.primitiveCollection)return;const r=new Cesium.Primitive(e);if(e.onReady){const s=()=>{var o,l;r.ready&&((o=e.onReady)==null||o.call(e,r),(l=n.scene)==null||l.postRender.removeEventListener(s))};(t=n.scene)==null||t.postRender.addEventListener(s)}return n.primitiveCollection.add(r),r},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:mHe,cesiumReadonlyProps:gHe,otherProps:vHe,useCommonEvent:!0});const _He=["classificationType","coordinates","height","heightReference","extrudedHeight","extrudedHeightReference","show","fill","material","outline","outlineColor","outlineWidth","rotation","stRotation","granularity","shadows","distanceDisplayCondition","zIndex"],yHe={onDefinitionChange:"definitionChanged"};Or({name:"RectangleGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.RectangleGraphics(e);return n.entity.rectangle=t,t},destroy(n,e){e.entity&&(e.entity.rectangle=void 0)},cesiumProps:_He,cesiumEventProps:yHe});const xHe=["backgroundColor","completeMorphOnUserInput","debugCommandFilter","debugShowCommands","debugShowDepthFrustum","debugShowFramesPerSecond","debugShowFrustumPlanes","debugShowFrustums","eyeSeparation","farToNearRatio","focalLength","fog","gamma","globe","highDynamicRange","invertClassification","invertClassificationColor","light","logarithmicDepthBuffer","logarithmicDepthFarToNearRatio","maximumRenderTimeChange","minimumDisableDepthTestDistance","moon","morphTime","nearToFarDistance2D","pickTranslucentDepth","requestRenderMode","rethrowRenderErrors","shadowMap","skyAtmosphere","skyBox","specularEnvironmentMaps","sphericalHarmonicCoefficients","sun","sunBloom","terrainProvider","useDepthPicking","useWebVR","postProcessStages","msaaSamples","splitPosition","debugCommandFilter","verticalExaggeration","verticalExaggerationRelativeHeight","atmosphere"],bHe={onMorphComplete:"morphComplete",onMorphStart:"morphStart",onPostRender:"postRender",onPreRender:"preRender",onPreUpdate:"preUpdate",onPostUpdate:"postUpdate",onRenderError:"renderError",onTerrainProviderChange:"terrainProviderChanged"},wHe=["mode","morphDuration"],VJ=(n,e,t)=>{switch(e){case Cesium.SceneMode.SCENE2D:n.morphTo2D(t);break;case Cesium.SceneMode.COLUMBUS_VIEW:n.morphToColumbusView(t);break;case Cesium.SceneMode.SCENE3D:n.morphTo3D(t);break}};Or({name:"Scene",create(n,e){return n.scene&&e.mode&&VJ(n.scene,e.mode,e.morphDuration),n.scene},update(n,e,t){e.mode!==t.mode&&e.mode&&VJ(n,e.mode,e.morphDuration)},cesiumProps:xHe,cesiumEventProps:bHe,otherProps:wHe,setCesiumPropsAfterCreate:!0});const SHe=["bounceAnimationTime","enableCollisionDetection","enableInputs","enableLook","enableRotate","enableTilt","enableTranslate","enableZoom","inertiaSpin","inertiaTranslate","inertiaZoom","lookEventTypes","maximumMovementRatio","maximumZoomDistance","minimumCollisionTerrainHeight","minimumPickingTerrainHeight","minimumTrackBallHeight","minimumZoomDistance","rotateEventTypes","tiltEventTypes","translateEventTypes","zoomEventTypes","minimumPickingTerrainDistanceWithInertia"];Or({name:"ScreenSpaceCameraController",create:n=>{var e;return(e=n.scene)==null?void 0:e.screenSpaceCameraController},cesiumProps:SHe,setCesiumPropsAfterCreate:!0});Or({name:"ScreenSpaceEventHandler",create(n,e){var t;return e.useDefault?(t=n.cesiumWidget)==null?void 0:t.screenSpaceEventHandler:n.scene?new Cesium.ScreenSpaceEventHandler(n.scene.canvas):void 0},destroy(n){n.isDestroyed()||n.destroy()},provide(n){return{screenSpaceEventHandler:n}}});const AHe=["darkness","fadingEnabled","maximumDistance","enabled","normalOffset","softShadows","size"];Or({name:"ShadowMap",create:n=>{var e;return(e=n.scene)==null?void 0:e.shadowMap},cesiumProps:AHe});const THe=["brightnessShift","hueShift","saturationShift","show","perFragmentAtmosphere","atmosphereLightIntensity","atmosphereRayleighCoefficient","atmosphereMieCoefficient","atmosphereRayleighScaleHeight","atmosphereMieScaleHeight","atmosphereMieAnisotropy"];Or({name:"SkyAtmosphere",create:n=>{var e;return(e=n.scene)==null?void 0:e.skyAtmosphere},cesiumProps:THe,setCesiumPropsAfterCreate:!0});const MHe=["sources","show"];Or({name:"SkyBox",create:n=>{var e;return(e=n.scene)==null?void 0:e.skyBox},cesiumProps:MHe,setCesiumPropsAfterCreate:!0});const CHe=["glowFactor","show"];Or({name:"Sun",create(n){if(!n.scene)return;const e=new Cesium.Sun;return n.scene.sun=e,e},destroy(n,e){e.scene&&!e.scene.isDestroyed()&&(e.scene.sun=new Cesium.Sun)},cesiumProps:CHe,setCesiumPropsAfterCreate:!0});const EHe=["clippingPlanes","maximumMemoryUsage","modelMatrix","shadows","show","style","intervals"],IHe=["clock","shading"],PHe=["onReady"],RHe={onFrameChange:"frameChanged"};Or({name:"TimeDynamicPointCloud",create(n,e){var t;if(!n.cesiumWidget||!n.primitiveCollection||!((t=n.cesiumWidget)!=null&&t.clock))return;const r=new Cesium.TimeDynamicPointCloud({...e,clock:e.clock??n.cesiumWidget.clock});if(e.onReady){const s=()=>{var o;(o=e.onReady)==null||o.call(e,r),r.frameChanged.removeEventListener(s)};r.frameChanged.addEventListener(s)}return n.primitiveCollection.add(r),r},destroy(n,e){e.primitiveCollection&&!e.primitiveCollection.isDestroyed()&&e.primitiveCollection.remove(n),n.isDestroyed()||n.destroy()},cesiumProps:EHe,cesiumReadonlyProps:IHe,cesiumEventProps:RHe,otherProps:PHe,useCommonEvent:!0});const LHe=["terrainShadows","clockTrackedDataSource","targetFrameRate","useDefaultRenderLoop","resolutionScale","allowDataSourcesToSuspendAnimation","trackedEntity","selectedEntity","shadows","useBrowserRecommendedResolution","creditDisplay"],DHe=["baseLayer","animation","baseLayerPicker","fullscreenButton","vrButton","geocoder","homeButton","infoBox","sceneModePicker","selectionIndicator","timeline","navigationHelpButton","navigationInstructionsInitiallyVisible","scene3DOnly","shouldAnimate","clockViewModel","selectedImageryProviderViewModel","imageryProviderViewModels","selectedTerrainProviderViewModel","terrainProviderViewModels","skyBox","skyAtmosphere","fullscreenElement","showRenderLoopErrors","automaticallyTrackDataSourceClocks","contextOptions","sceneMode","mapProjection","globe","orderIndependentTranslucency","creditContainer","creditViewport","dataSources","mapMode2D","projectionPicker","requestRenderMode","maximumRenderTimeChange","depthPlaneEllipsoidOffset","msaaSamples","blurActiveElementOnCanvasFocus","terrain"],BHe={onSelectedEntityChange:"selectedEntityChanged",onTrackedEntityChange:"trackedEntityChanged"},kHe=["className","id","style","full","containerProps","extend","terrainProvider"],OHe=Or({name:"Viewer",async create(n,{baseLayer:e,terrainProvider:t,...r},s){if(!s)return;let o;D0(t)?o=await t:o=t;const l=new Cesium.Viewer(s,{...r,terrainProvider:o,baseLayer:e===!1?void 0:e});if(!l)return;e===!1&&l.imageryLayers.removeAll(),l&&r.extend&&(Array.isArray(r.extend)?r.extend.forEach(a=>{l.extend(a,{})}):l.extend(r.extend,{}));const c=new ehe(l.scene);return[l,c]},destroy(n,e,t,r){r&&!r.isDestroyed()&&r.destroy(),n.isDestroyed()||n.destroy()},provide(n,e,t,r){return{viewer:n,cesiumWidget:n.cesiumWidget,dataSourceCollection:n.dataSources,entityCollection:n.entities,scene:n.scene,camera:n.scene.camera,imageryLayerCollection:n.scene.globe.imageryLayers,primitiveCollection:n.scene.primitives,globe:n.scene.globe,__$internal:{onUpdate:t==null?void 0:t.onUpdate,imageryLayerWaitingList:[]},[Vb]:r}},containerProps:({id:n,className:e,style:t,full:r,containerProps:s})=>({className:e,id:n,style:{...r?{position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}:{},...t},...s}),cesiumProps:LHe,cesiumReadonlyProps:DHe,cesiumEventProps:BHe,otherProps:kHe,renderContainer:!0,useCommonEvent:!0,useRootEvent:!0}),Lp=OHe,FHe=["positions","maximumHeights","minimumHeights","show","fill","material","outline","outlineColor","outlineWidth","granularity","shadows","distanceDisplayCondition"],NHe={onDefinitionChange:"definitionChanged"};Or({name:"WallGraphics",create(n,e){if(!n.entity)return;const t=new Cesium.WallGraphics(e);return n.entity.wall=t,t},destroy(n,e){e.entity&&(e.entity.wall=void 0)},cesiumProps:FHe,cesiumEventProps:NHe});const zHe=()=>{const n=_e.useRef(null);Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM";const e=r=>{n.current&&n.current.cesiumElement&&n.current.cesiumElement.zoomTo(r)},t=new Cesium.Terrain.fromWorldTerrain({requestWaterMask:!0,requestVertexNormals:!0});return pe.jsx(Lp,{full:!0,ref:n,infoBox:!1,terrain:t,children:pe.jsx(UL,{url:Cesium.IonResource.fromAssetId(75343),onReady:e})})},UHe=({url:n=""})=>{new Cesium.TileCoordinatesImageryProvider,new Cesium.GridImageryProvider;const[e,t]=_e.useState(null);_e.useEffect(()=>{Cesium.IonImageryProvider.fromAssetId(3812).then(o=>{t(o)})},[]),new Cesium.UrlTemplateImageryProvider({url:"https://api.mapbox.com/styles/v1/linklink/cm2v9ot6s00fu01pwfs3q147j/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2tvZnVrcHM4MDh6bjJ2b2F3eWRsZnI5MyJ9.e4miL35BnZeUH18Gq3m9Xw"});const r=["mapbox.mapbox-terrain-v2","mapbox.mapbox-streets-v8","linklink.bhygxgjo"];new Cesium.MapboxImageryProvider({mapId:r[2],accessToken:"pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2tvZnVrcHM4MDh6bjJ2b2F3eWRsZnI5MyJ9.e4miL35BnZeUH18Gq3m9Xw"});const s=[{styleId:"streets-v11"},{styleId:"cm2v9ot6s00fu01pwfs3q147j",tilesize:256,username:"linklink"}];return new Cesium.MapboxStyleImageryProvider({...s[1],accessToken:"pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2tvZnVrcHM4MDh6bjJ2b2F3eWRsZnI5MyJ9.e4miL35BnZeUH18Gq3m9Xw"}),pe.jsx(Lp,{full:!0,infoBox:!1,children:e&&pe.jsx(IVe,{imageryProvider:e})})},GHe=()=>{const n=_e.useRef(null);Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM";const e="/about_portfolio/",t=[{text:"Parrot",url:`${e}glb-models/Parrot.glb`,height:0,scale:500},{text:"Fox",url:`${e}glb-models/fox.glb`,height:0,scale:500},{text:"Bird",url:`${e}glb-models/bird.glb`,height:0,scale:120}],[r,s]=_e.useState(t[0]),o=c=>{if(console.log(c),!c)return null;const a=Cesium.Cartesian3.fromDegrees(116.46,39.92,c.height),d=Cesium.Math.toRadians(135),f=0,m=0,_=new Cesium.HeadingPitchRoll(d,f,m),x=Cesium.Transforms.headingPitchRollQuaternion(a,_),A={uri:c.url,minimumPixelSize:c.scale,maximumScale:2e4};return pe.jsx(GL,{name:c.url,position:a,orientation:x,model:A})},l=c=>{const a=c.target.value,d=t.find(f=>f.text===a);d&&s(d)};return pe.jsxs(pe.Fragment,{children:[pe.jsx("select",{className:"absolute top-20 left-20 z-50",onChange:l,value:r?r.text:"",children:t.map(c=>pe.jsx("option",{value:c.text,children:c.text},c.text))}),pe.jsx(Lp,{full:!0,ref:n,infoBox:!1,shadows:!0,shouldAnimate:!0,children:o(r)})]})},VHe=()=>{const n=Cesium.Cartesian3.fromDegrees(120,40,100),e={type:"Feature",properties:{name:"Coors Field",amenity:"Baseball Stadium",popupContent:"This is where the Rockies play!"},geometry:{type:"Point",coordinates:[1204,39.7]}};return pe.jsx(pe.Fragment,{children:pe.jsxs(Lp,{full:!0,infoBox:!0,children:[pe.jsxs(GL,{position:n,name:"Point",children:[pe.jsx(the,{pixelSize:10,color:Cesium.Color.RED}),pe.jsxs(lVe,{children:[pe.jsx("h1",{children:"Hello, world."}),pe.jsx("p",{children:"JSX is available here!"})]})]}),pe.jsx(mVe,{data:e})]})})},HHe=()=>{Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM";const n=["Highlight","Replace","Mix"],e=["White","Red","Green","Blue","Yellow","Gray"],t=["Red","Green","Blue","Yellow","Gray"],r="/about_portfolio/",s=[{url:`${r}glb-models/Parrot.glb`,height:5},{url:`${r}glb-models/bird.glb`,height:5},{url:`${r}glb-models/fox.glb`,height:5}],o=_e.useRef(null),l=_e.useRef(null),[c,a]=_e.useState(`${r}glb-models/Parrot.glb`),[d,f]=_e.useState(5e3),[m,_]=_e.useState(!0),[x,A]=_e.useState(null),[I,E]=_e.useState(null),[C,L]=_e.useState({colorBlendMode:"Highlight",color:"Red",alpha:1,colorBlendAmount:.5,silhouetteColor:"Red",silhouetteAlpha:1,silhouetteSize:2}),O=C.colorBlendMode==="Mix",H=J=>Cesium.ColorBlendMode[J.toUpperCase()],q=(J,re)=>{const se=Cesium.Color[J.toUpperCase()];return Cesium.Color.fromAlpha(se,parseFloat(re))};_e.useEffect(()=>{const J=Cesium.Cartesian3.fromDegrees(116.46,39.92,d),re=Cesium.Math.toRadians(125),se=0,ae=0,he=new Cesium.HeadingPitchRoll(re,se,ae),Ae=Cesium.Transforms.headingPitchRollQuaternion(J,he);A(J),E(Ae)},[d]),_e.useEffect(()=>{if(!o.current||!o.current.cesiumElement||!x||!I)return;const J=o.current.cesiumElement;J.entities.removeAll();const re=J.entities.add({name:c,position:x,orientation:I,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,model:{uri:c,minimumPixelSize:500,maximumScale:2e4,color:q(C.color,C.alpha),colorBlendMode:H(C.colorBlendMode),colorBlendAmount:parseFloat(C.colorBlendAmount),silhouetteColor:q(C.silhouetteColor,C.silhouetteAlpha),silhouetteSize:parseFloat(C.silhouetteSize),castShadows:!0,receiveShadows:!0}});return l.current=re,J.trackedEntity=re,re.model&&re.model.readyPromise&&re.model.readyPromise.then(()=>{console.log("Model loaded successfully!")}).catch(se=>{console.error("Model loading error:",se)}),()=>{J&&!J.isDestroyed()&&J.entities.remove(re)}},[c,x,I]),_e.useEffect(()=>{l.current&&l.current.model&&(l.current.model.color=q(C.color,C.alpha),l.current.model.colorBlendMode=H(C.colorBlendMode),l.current.model.colorBlendAmount=parseFloat(C.colorBlendAmount),l.current.model.silhouetteColor=q(C.silhouetteColor,C.silhouetteAlpha),l.current.model.silhouetteSize=parseFloat(C.silhouetteSize))},[C]);const Z=J=>{var re,se;if(J===2&&!Cesium.FeatureDetection.supportsBasis((se=(re=o.current)==null?void 0:re.cesiumElement)==null?void 0:se.scene)){alert("This browser does not support Basis Universal compressed textures");return}a(s[J].url),f(s[J].height)};return pe.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative"},children:[pe.jsx(Lp,{full:!0,ref:o,infoBox:!1,selectionIndicator:!1,shadows:m,shouldAnimate:!0}),pe.jsx("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(255, 255, 255, 0.9)",padding:"10px",borderRadius:"5px",zIndex:1e3,color:"black",fontSize:"12px",minWidth:"300px"},children:pe.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:pe.jsxs("tbody",{children:[pe.jsx("tr",{children:pe.jsx("td",{colSpan:2,style:{fontWeight:"bold",paddingBottom:"10px"},children:"Model Selection"})}),pe.jsx("tr",{children:pe.jsx("td",{style:{paddingBottom:"10px"},colSpan:2,children:pe.jsxs("select",{style:{width:"100%",backgounrd:"white",border:"1px solid #555"},onChange:J=>Z(J.target.selectedIndex),children:[pe.jsx("option",{children:"Parrot"}),pe.jsx("option",{children:"Bird"}),pe.jsx("option",{children:"Fox"})]})})}),pe.jsx("tr",{children:pe.jsx("td",{style:{paddingBottom:"10px"},colSpan:2,children:pe.jsxs("button",{style:{width:"100%",display:"flex",alignItems:"center",gap:"5px",cursor:"pointer"},onClick:()=>_(!m),children:[pe.jsx("input",{type:"checkbox",checked:m,onChange:()=>{},style:{pointerEvents:"none",margin:0}}),pe.jsx("span",{style:{pointerEvents:"none"},children:"Shadows"})]})})}),pe.jsx("tr",{children:pe.jsx("td",{colSpan:2,style:{fontWeight:"bold",paddingTop:"10px",paddingBottom:"5px"},children:"Model Color"})}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Mode"}),pe.jsx("td",{children:pe.jsx("select",{value:C.colorBlendMode,onChange:J=>L({...C,colorBlendMode:J.target.value}),style:{width:"100%",border:"1px solid #555"},children:n.map(J=>pe.jsx("option",{value:J,children:J},J))})})]}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Color"}),pe.jsx("td",{children:pe.jsx("select",{value:C.color,onChange:J=>L({...C,color:J.target.value}),style:{width:"100%",border:"1px solid #555"},children:e.map(J=>pe.jsx("option",{value:J,children:J},J))})})]}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Alpha"}),pe.jsxs("td",{style:{display:"flex",gap:"5px"},children:[pe.jsx("input",{type:"range",min:"0.0",max:"1.0",step:"0.01",value:C.alpha,onChange:J=>L({...C,alpha:parseFloat(J.target.value)}),style:{flex:1}}),pe.jsx("input",{type:"text",size:"5",value:C.alpha,onChange:J=>L({...C,alpha:parseFloat(J.target.value)||0})})]})]}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px",color:O?"black":"gray"},children:"Mix"}),pe.jsxs("td",{style:{display:"flex",gap:"5px"},children:[pe.jsx("input",{type:"range",min:"0.0",max:"1.0",step:"0.01",value:C.colorBlendAmount,onChange:J=>L({...C,colorBlendAmount:parseFloat(J.target.value)}),disabled:!O,style:{flex:1}}),pe.jsx("input",{type:"text",size:"5",value:C.colorBlendAmount,onChange:J=>L({...C,colorBlendAmount:parseFloat(J.target.value)||0}),disabled:!O})]})]}),pe.jsx("tr",{children:pe.jsx("td",{colSpan:2,style:{fontWeight:"bold",paddingTop:"10px",paddingBottom:"5px"},children:"Model Silhouette"})}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Color"}),pe.jsx("td",{children:pe.jsx("select",{value:C.silhouetteColor,onChange:J=>L({...C,silhouetteColor:J.target.value}),style:{width:"100%",border:"1px solid #555"},children:t.map(J=>pe.jsx("option",{value:J,children:J},J))})})]}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Alpha"}),pe.jsxs("td",{style:{display:"flex",gap:"5px"},children:[pe.jsx("input",{type:"range",min:"0.0",max:"1.0",step:"0.01",value:C.silhouetteAlpha,onChange:J=>L({...C,silhouetteAlpha:parseFloat(J.target.value)}),style:{flex:1}}),pe.jsx("input",{type:"text",size:"5",value:C.silhouetteAlpha,onChange:J=>L({...C,silhouetteAlpha:parseFloat(J.target.value)||0})})]})]}),pe.jsxs("tr",{children:[pe.jsx("td",{style:{paddingRight:"10px"},children:"Size"}),pe.jsxs("td",{style:{display:"flex",gap:"5px"},children:[pe.jsx("input",{type:"range",min:"0.0",max:"10.0",step:"0.01",value:C.silhouetteSize,onChange:J=>L({...C,silhouetteSize:parseFloat(J.target.value)}),style:{flex:1}}),pe.jsx("input",{type:"text",size:"5",value:C.silhouetteSize,onChange:J=>L({...C,silhouetteSize:parseFloat(J.target.value)||0})})]})]})]})})})]})},jHe=()=>{const n=_e.useRef(null);return Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM",_e.useEffect(()=>{requestAnimationFrame(()=>{if(!n.current||!n.current.cesiumElement){console.warn("Viewer not initialized yet");return}const e=n.current.cesiumElement;console.log("Viewer initialized, setting up event handlers");const t=new Cesium.ScreenSpaceEventHandler(e.canvas);t.setInputAction(o=>{console.log("LEFT_CLICK event triggered at:",o.position);const l=e.scene.pick(o.position);Cesium.defined(l)?(console.log("Picked object:",l),e.trackedEntity=l.id,e.selectedEntity=l.id):console.log("No object picked")},Cesium.ScreenSpaceEventType.LEFT_CLICK);const r=e.selectedEntityChanged.addEventListener(o=>{console.log("Selected entity changed:",o),o&&console.log("Selected entity:",o.name||o)}),s=e.trackedEntityChanged.addEventListener(o=>{console.log("Tracked entity changed:",o),o&&console.log("Tracked entity:",o.name||o)});return e.scene.screenSpaceCameraController.tiltEventTypes=[Cesium.CameraEventType.LEFT_DRAG],e.scene.screenSpaceCameraController.zoomEventTypes=[Cesium.CameraEventType.RIGHT_DRAG],()=>{t.destroy(),r==null||r.removeEventListener(),s==null||s.removeEventListener()}})},[]),pe.jsxs(Lp,{full:!0,ref:n,infoBox:!1,children:[pe.jsx(GL,{position:Cesium.Cartesian3.fromDegrees(-75.59777,40.03883),children:pe.jsx(the,{pixelSize:10,color:Cesium.Color.RED})}),pe.jsx(GL,{name:"cylinder",position:Cesium.Cartesian3.fromDegrees(-60,40),children:pe.jsx(X8e,{length:4e5,topRadius:2e5,bottomRadius:2e5,material:Cesium.Color.BLUE.withAlpha(.5)})})]})},WHe=()=>{const n=_e.useRef(null);return Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM",_e.useEffect(()=>{requestAnimationFrame(()=>{var o;const e=(o=n.current)==null?void 0:o.cesiumElement;if(!(e!=null&&e.imageryLayers)){console.log("Waiting for viewer scene...");return}console.log("Viewer scene ready, adding imagery layers...");const t=e.imageryLayers,r=Cesium.ImageryLayer.fromProviderAsync(Cesium.IonImageryProvider.fromAssetId(3812));r.alpha=.5,r.brightness=2,t.add(r);const s=Cesium.ImageryLayer.fromProviderAsync(Cesium.SingleTileImageryProvider.fromUrl("https://cesium.com/learn/cesiumjs/ref-doc/Images/CesiumLogo.png",{rectangle:Cesium.Rectangle.fromDegrees(112,39,116,40)}));t.add(s)})},[]),pe.jsx(Lp,{full:!0,ref:n,baseLayer:Cesium.ImageryLayer.fromWorldImagery({style:Cesium.IonWorldImageryStyle.AERIAL_WITH_LABELS}),baseLayerPicker:!1,infoBox:!1})},$He=()=>{const n=_e.useRef(null),[e,t]=_e.useState(null),[r,s]=_e.useState(null),o=_e.useRef({feature:void 0,originalColor:new Cesium.Color}),l=_e.useRef({feature:void 0,originalColor:new Cesium.Color}),[c,a]=_e.useState(!0);Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM";const d={tileset:{destination:new Cesium.Cartesian3(4397999822774582e-9,440450267774069e-8,1.3977824709840622e6),direction:new Cesium.Cartesian3(-.29335588497705106,-.6066709587467911,.7388454997917905),up:new Cesium.Cartesian3(.6240972421637774,.46391380837591956,.6287182283994301)},airport:{destination:new Cesium.Cartesian3(4394719151490939e-9,4402317401942875e-9,1.4066086602404779e6),direction:new Cesium.Cartesian3(.4146699515908668,-.8887814163588482,.1952342828060377),up:new Cesium.Cartesian3(.8415067525520951,.4561872920946922,.28941240460723)},crater:{destination:new Cesium.Cartesian3(4398179160380196e-9,4402518469409466e-9,1.3991617612076725e6),direction:new Cesium.Cartesian3(-.2800903637088597,-.6348021519070498,.7201219452923355),up:new Cesium.Cartesian3(.6319189548885261,.4427783126727723,.6361020360596605)},port:{destination:new Cesium.Cartesian3(439969885724341e-8,4399019639078034e-9,1.4051537766045567e6),direction:new Cesium.Cartesian3(-.5651458936543287,.17696574231117793,-.8057873447342694),up:new Cesium.Cartesian3(.4886488937394081,.8587605935024302,-.15411846642958343)}},f=new Cesium.Cesium3DTileStyle({color:{conditions:[["${HGT}!== undefined && ${HGT}<1","color('red')"],["${HGT}!== undefined && ${HGT}>=1 && ${HGT}<3","color('yellow')"],["${HGT}!== undefined && ${HGT}>=3 && ${HGT}<5","color('green')"],["${HGT}!== undefined && ${HGT}>=5 && ${HGT}<10","color('blue')"],["${HGT}!== undefined && ${HGT}>=10","color('black')"],["true","color('white')"]]}}),m=new Cesium.Cesium3DTileStyle({color:{conditions:[["true","color('green')"]]}}),_=(C,L=2)=>{if(!n.current||!n.current.cesiumElement)return;n.current.cesiumElement.camera.flyTo({destination:C.destination,duration:L,orientation:{direction:C.direction,up:C.up},easingFunction:Cesium.EasingFunction.QUADRATIC_IN_OUT})},x=()=>{Cesium.defined(l.current.feature)&&(l.current.feature.color=l.current.originalColor,l.current.feature=void 0),Cesium.defined(o.current.feature)&&(o.current.feature.color=o.current.originalColor,o.current.feature=void 0)},A=C=>{t(C)},I=C=>{s(C),n.current&&n.current.cesiumElement&&n.current.cesiumElement.camera.flyTo({duration:0,destination:d.tileset.destination,orientation:{direction:d.tileset.direction,up:d.tileset.up}})},E=C=>{const L=C.content,O=L.featuresLength;for(let H=0;H<O;H++){const q=L.getFeature(H);q.getProperty("cesium#estimatedHeight")!==void 0&&q.setProperty("HGT",q.getProperty("cesium#estimatedHeight"))}};return _e.useEffect(()=>{requestAnimationFrame(()=>{if(!n.current||!n.current.cesiumElement)return;const C=n.current.cesiumElement,L=C.scene;L.light.intensity=7;const O=new Cesium.ScreenSpaceEventHandler(L.canvas),H=document.createElement("div");C.container.appendChild(H),H.className="backdrop",Object.assign(H.style,{display:"none",position:"absolute",bottom:"0",left:"0",pointerEvents:"none",padding:"4px",backgroundColor:"rgba(0, 0, 0, 0.5)",whiteSpace:"pre-line",fontSize:"16px",borderRadius:"4px",color:"white"}),O.setInputAction(Z=>{var J;if(c){Cesium.defined(o.current.feature)&&(o.current.feature.color=o.current.originalColor,o.current.feature=void 0);const re=L.pick(Z.endPosition),se=((J=re==null?void 0:re.content)==null?void 0:J.batchTable)!==void 0,ae=se&&re.hasProperty("substrates"),he=se&&re.hasProperty("cesium#estimatedHeight");if(ae){for(H.style.display="block",H.style.bottom=`${C.canvas.clientHeight-Z.endPosition.y}px`,H.style.left=`${Z.endPosition.x}px`,tableHtmlScratch=`<table><thead><tr><td>Material:</td><th><tt>${re.getProperty("name")}</tt></th></tr></thead><tbody>`,materialScratch=re.getProperty("substrates"),weightScratch=re.getProperty("weights"),tableHtmlScratch+="<tr><td colspan = '2' style='text-align: center;'><b>Substrates</b></td></tr>",i=0;i<materialScratch.length;i++)tableHtmlScratch+=`<tr><td><tt>${materialScratch[i].slice(3)}</tt></td><td style='text-aligh: right;'><tt>${weightScratch[i]}%</tt></td></tr>`;tableHtmlScratch+="</tbody></table>",H.innerHTML=tableHtmlScratch}else H.style.display="none";he&&(console.log("highlight"),re!==l.current.feature&&(o.current.feature=re,Cesium.Color.clone(re.color,o.current.originalColor),re.color=Cesium.Color.YELLOW))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),O.setInputAction(Z=>{var ae;Cesium.defined(l.current.feature)&&(l.current.feature.color=l.current.originalColor,l.current.feature=void 0);const J=L.pick(Z.position);if(((ae=J==null?void 0:J.content)==null?void 0:ae.batchTable)!==void 0&&J.hasProperty("cesium#estimatedHeight")){if(J===l.current.feature)return;l.current.feature=J,J===o.current.feature?(Cesium.Color.clone(o.current.originalColor,l.current.originalColor),o.current.feature=void 0):Cesium.Color.clone(J.color,l.current.originalColor),J.color=Cesium.Color.LIME;let he="<table class='cesium-infoBox-defaultTable'>";he+="<tr><th>Property Name</th><th>Value</th></tr><tbody>";const Ae=J.getPropertyIds();for(let Ee=0;Ee<Ae.length;Ee++){const Pe=Ae[Ee],ze=J.getProperty(Pe);metadataClass.properties[Pe],ze!==void 0&&(he+=`<tr style='font-family
            : monospace;'><th>${Pe}</th><td>${ze}</td></tr>`)}he+="<tr><th colspan='4'><i style='font-size:10px'>Hover on a row for description</i></th></tr></tbody></table>",C.selectedEntity={description:he}}},Cesium.ScreenSpaceEventType.LEFT_CLICK);const q=document.getElementsByClassName("cesium-viewer-infoBoxContainer")[0];return q&&(q.onmouseover=()=>{H.style.display="none"}),()=>{O.destroy(),H.parentNode&&H.parentNode.removeChild(H)}})},[c]),pe.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative"},children:[pe.jsxs(Lp,{full:!0,ref:n,shadows:!0,shouldAnimate:!0,children:[pe.jsx(UL,{url:Cesium.IonResource.fromAssetId(2275207),onReady:A}),pe.jsx(UL,{url:Cesium.IonResource.fromAssetId(96188),maximumScreenSpaceError:12,onReady:I,onTileVisible:E})]}),pe.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(42, 42, 42, 0.9)",padding:"10px",borderRadius:"5px",zIndex:1e3,color:"white",fontSize:"14px",minWidth:"200px"},children:[pe.jsx("div",{style:{marginBottom:"10px",fontWeight:"bold"},children:"Camera Views"}),pe.jsxs("select",{className:"cesium-button",style:{width:"100%",marginBottom:"10px"},onChange:C=>{_(d[["tileset","airport","crater","port"][C.target.selectedIndex]])},children:[pe.jsx("option",{children:"Overview"}),pe.jsx("option",{children:"Airport"}),pe.jsx("option",{children:"Crater"}),pe.jsx("option",{children:"Port"})]}),pe.jsx("div",{style:{marginBottom:"10px",fontWeight:"bold"},children:"Styles"}),pe.jsxs("select",{className:"cesium-button",style:{width:"100%",marginBottom:"10px"},onChange:C=>{x();const L=C.target.selectedIndex;r&&e&&(L===0?(r.style=void 0,e.style=void 0):L===1?(r.style=f,e.style=void 0):L===2&&(r.style=void 0,e.style=m))},children:[pe.jsx("option",{children:"No style"}),pe.jsx("option",{children:"Style buildings by height"}),pe.jsx("option",{children:"Style terrain by materials"})]}),pe.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[pe.jsx("input",{type:"checkbox",checked:c,onChange:C=>a(C.target.checked),style:{marginRight:"8px"}}),"Enable terrain picking"]})]})]})};class XHe{geocode(e){const t="https://nominatim.openstreetmap.org/search";return new Cesium.Resource({url:t,queryParameters:{q:e,format:"json"}}).fetchJson().then(s=>s.map(o=>{const l=o.boundingbox;return{displayName:o.display_name,destination:Cesium.Rectangle.fromDegrees(parseFloat(l[2]),parseFloat(l[0]),parseFloat(l[3]),parseFloat(l[1]))}}))}}const qHe=()=>{const n=_e.useRef(null);return Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM",_e.useEffect(()=>{requestAnimationFrame(()=>{if(!n.current||!n.current.cesiumElement)return;const e=n.current.cesiumElement;e.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(117.16,32.71,15e5)}),e.homeButton&&e.homeButton.viewModel.command.beforeExecute.addEventListener(t=>{console.log("Custom home button behavior triggered."),t.cancel=!0,e.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(117.16,32.71,1500)})})})},[]),pe.jsx(Lp,{full:!0,ref:n,geocoder:new XHe,infoBox:!1})},aw=12,YHe=`
const int NOTHING_SELECTED = 12;
void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
   int id = fsInput.featureIds.featureId_0;
    if(uSelectedFeature == NOTHING_SELECTED) {
      material.diffuse = vec3(1.0, 1.0, 1.0);
      return;
    };
    if (id != uSelectedFeature) {
      material.diffuse = vec3(0.0, 0.0, 1.0); //  id
    } 
    else {
      material.diffuse = vec3(fract(float(id) / 50.0), 0.0, 0.0); //  id
      material.alpha = 1.0;
    }
  }
`,ZHe=`
const int INDIVIDUAL = 0;
const int CORPORATION = 1;
const int PARTNERSHIP = 2;
const int CONDO = 3;
const int NYSTATE = 4;
const int HOISING = 5;
const int DEPENETRY = 6;
const int NYCHOUSING = 7;
const int DEPADMINI = 8;
const int NYCHEALTH = 9;
const int OTHERGOVERN = 10;
const int OTHER = 11;

void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
  int featureId = fsInput.featureIds.featureId_0;

  if (featureId == INDIVIDUAL) {
    material.specular = vec3(0.98, 0.9, 0.59);
    material.roughness = 0.1;
  } else if (featureId == NYSTATE || featureId == NYCHOUSING || featureId == NYCHEALTH) {
    material.specular = vec3(0.91, 0.92, 0.92);
    material.roughness = 0.5;
  } else if (featureId == DEPENETRY || featureId == DEPADMINI) {
    material.emissive = vec3(1.0, 0.3, 0.0);
    material.alpha = 0.5;
  } else if (featureId == OTHERGOVERN || featureId == OTHER) {
    material.diffuse = mix(material.diffuse, vec3(1.0), 0.8);
    material.roughness = 0.9;
  } else {
    material.diffuse += 0.05;
    material.roughness = 0.9;
  }
}
`,KHe=`
const int NOTHING_SELECTED = 12;

void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
  int featureId = fsInput.featureIds.featureId_0;

  // Early out if nothing is selected or this fragment isnt the selected feature
  if (!(uSelectedFeature < NOTHING_SELECTED && featureId == uSelectedFeature)) {
    return;
  }

  // Base metal tint
  vec3 gold = vec3(1.0, 0.85, 0.57);
  material.specular = gold;
  material.roughness = 0.08;

  // Rim light to make silhouettes pop
  vec3 normalEC = normalize(fsInput.attributes.normalEC);
  vec3 viewDir = normalize(-fsInput.attributes.positionEC);
  float rim = pow(1.0 - max(dot(normalEC, viewDir), 0.0), 2.5);

  // Soft pulse over time (requires uTime uniform in seconds)
  float pulse = 0.5 + 0.5 * sin(uTime * 2.5);
  float glow = rim * (0.35 + 0.35 * pulse);

  material.emissive += gold * glow;
}
`,JHe=`
const int IDS0_WINDOW = 0;
const int IDS1_FACADE = 2;
const int IDS1_ROOF = 3;
precision mediump float;
const vec3 PURPLE = vec3(0.5, 0.0, 1.0);
const vec3 YELLOW = vec3(1.0, 1.0, 0.0);
const vec3 NO_TINT = vec3(1.0);

void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
  int featureId0 = fsInput.featureIds.featureId_0; // fine features
  int featureId1 = fsInput.featureIds.featureId_1; // coarse features

  // use both feature ID sets to determine where the features are
  float isWindow = float(featureId0 == IDS0_WINDOW);
  float isFacade = float(featureId1 == IDS1_FACADE);
  float isRoof = float(featureId1 == IDS1_ROOF);

  // Tint the roof windows yellow and facade windows purple
  vec3 tint = NO_TINT;
  tint = mix(tint, YELLOW, isWindow * isRoof);
  tint = mix(tint, PURPLE, isWindow * isFacade);
  material.diffuse *= tint;
}
`,aU=new Cesium.CustomShader({uniforms:{uSelectedFeature:{type:Cesium.UniformType.INT,value:aw}},lightingModel:Cesium.LightingModel.UNLIT,fragmentShaderText:YHe}),QHe=new Cesium.CustomShader({lightingModel:Cesium.LightingModel.PBR,fragmentShaderText:ZHe}),YI=new Cesium.CustomShader({uniforms:{uSelectedFeature:{type:Cesium.UniformType.INT,value:aw},uTime:{type:Cesium.UniformType.FLOAT,value:0}},lightingModel:Cesium.LightingModel.PBR,fragmentShaderText:KHe}),zN=new Cesium.CustomShader({uniforms:{uSelectedFeature:{type:Cesium.UniformType.FLOAT,value:aw}},lightingModel:Cesium.LightingModel.UNLIT,fragmentShaderText:JHe}),Ch={x:-74.2,y:40.5,z:4500,heading:0,pitch:-60,roll:0},Ty=n=>{n.camera.flyTo({destination:new Cesium.Cartesian3.fromDegrees(Ch.x,Ch.y,Ch.z),orientation:new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(Ch.heading),Cesium.Math.toRadians(Ch.pitch),Cesium.Math.toRadians(Ch.roll)),duration:0})};let iu=null;const e9e=n=>(iu&&(iu.destroy(),iu=null),iu=new Gie,iu.add(Ch,"x",-180,180).name("Longitude").onChange(()=>Ty(n)),iu.add(Ch,"y",-90,90).name("Latitude").onChange(()=>Ty(n)),iu.add(Ch,"z",0,5e3).name("Height").onChange(()=>Ty(n)),iu.add(Ch,"heading",-180,180).name("Heading").onChange(()=>Ty(n)),iu.add(Ch,"pitch",-90,90).name("Pitch").onChange(()=>Ty(n)),iu.add(Ch,"roll",-180,180).name("Roll").onChange(()=>Ty(n)),iu),t9e=()=>{iu&&(iu.destroy(),iu=null)},Ov=n=>{Object.assign(n,{style:void 0,customShader:aU,colorBlendMode:Cesium.Cesium3DTileColorBlendMode.HIGHLIGHT,colorBlendAmount:.5})},n9e=()=>{const n=_e.useRef(null),e=_e.useRef(null),[t,r]=_e.useState(!0);Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2NDk3OTUzYy01N2RjLTQyNDMtYTE1Zi0yYjgwNTJlZmYwOTAiLCJpZCI6MTk3MzM4LCJpYXQiOjE3MDg2NTc1NTh9.b8_XHsKZtIQVkUyk95dNvHHB4OE5nmebm5e_JFEIIbM";const s={Individual:0,Corporation:1,Partnership:2,"Condo or Co-op":3,"NY State":4,"Housing Preservation and Development":5,"Department of Energy":6,"NYC Housing Authority":7,"Department of Citywide Administrative Services":8,"NYC Health and Hospitals":9,"Other Government Agency":10,Other:11},o=c=>{if(e.current=c,!n.current||!n.current.cesiumElement)return;const a=n.current.cesiumElement,d=a.scene,f=new Cesium.Cartesian3(-1.398521324920626,.7823052871729486,.7015244410592609);c.modelMatrix=Cesium.Matrix4.fromTranslation(f),c.maximumScreenSpaceError=8,d.pickTranslucentDepth=!0,d.light.intensity=7,Ty(a),Ov(c),d.postRender.addEventListener((m,_)=>{YI.setUniform("uTime",_.secondsOfDay)})},l=c=>{const a=c.content,d=a.featuresLength;for(let f=0;f<d;f++){const m=a.getFeature(f);m.getProperty("Majority_Ownership_Type")!==void 0&&m.setProperty("typeId",s[m.getProperty("Majority_Ownership_Type")])}};return _e.useEffect(()=>{let c,a;return requestAnimationFrame(()=>{if(!n.current||!n.current.cesiumElement)return;const d=n.current.cesiumElement,f=d.scene;a=document.createElement("div"),d.container.appendChild(a),Object.assign(a.style,{display:"none",position:"absolute",bottom:"0",left:"0",pointerEvents:"none",padding:"4px",color:"white",backgroundColor:"black",whiteSpace:"pre-line",fontSize:"12px"}),e9e(d),c=new Cesium.ScreenSpaceEventHandler(f.canvas),c.setInputAction(m=>{var _;if(t){const x=f.pick(m.endPosition);if(((_=x==null?void 0:x.content)==null?void 0:_.batchTable)!==void 0){a.style.display="block",a.style.bottom=`${f.canvas.clientHeight-m.endPosition.y}px`,a.style.left=`${m.endPosition.x}px`;const I=`Ownership: ${x.getProperty("Majority_Ownership_Type")}
Feature ID: ${x.featureId}`;a.textContent=I}else a.style.display="none"}else a.style.display="none"},Cesium.ScreenSpaceEventType.MOUSE_MOVE),c.setInputAction(m=>{if(t){const _=f.pick(m.position);Cesium.defined(_)&&Cesium.defined(_.featureId)?(YI.setUniform("uSelectedFeature",_.featureId),aU.setUniform("uSelectedFeature",_.featureId),zN.setUniform("uSelectedFeature",_.featureId)):(YI.setUniform("uSelectedFeature",aw),aU.setUniform("uSelectedFeature",aw),zN.setUniform("uSelectedFeature",aw))}},Cesium.ScreenSpaceEventType.LEFT_CLICK)}),()=>{c.destroy(),a.parentNode&&a.parentNode.removeChild(a),t9e()}},[t]),pe.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative"},children:[pe.jsx(Lp,{full:!0,ref:n,infoBox:!1,maximumScreenSpaceError:12,orderIndependentTranslucency:!1,children:pe.jsx(UL,{url:Cesium.IonResource.fromAssetId(75343),onReady:o,onTileLoad:l})}),pe.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(42, 42, 42, 0.9)",padding:"10px",borderRadius:"5px",zIndex:1e3,color:"white",fontSize:"14px",minWidth:"200px"},children:[pe.jsx("div",{style:{marginBottom:"10px",fontWeight:"bold"},children:"Classification Styles"}),pe.jsxs("select",{className:"cesium-button",style:{width:"100%",marginBottom:"10px"},onChange:c=>{if(!e.current)return;const a=e.current,d=c.target.selectedIndex;d===0||d===1||d===2?Ov(a):d===3?(Ov(a),a.customShader=QHe):d===4?(Ov(a),a.customShader=YI):d===5?(Ov(a),a.customShader=zN):d===6&&Ov(a)},children:[pe.jsx("option",{children:"Show Classification"}),pe.jsx("option",{children:"Show Alternative Classification"}),pe.jsx("option",{children:"Translucent Windows"}),pe.jsx("option",{children:"Stylized PBR Materials"}),pe.jsx("option",{children:"Golden Touch"}),pe.jsx("option",{children:"Multiple Feature ID sets"}),pe.jsx("option",{children:"No Classification"})]}),pe.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[pe.jsx("input",{type:"checkbox",checked:t,onChange:c=>r(c.target.checked),style:{marginRight:"8px"}}),"Enable picking"]})]})]})},r9e=()=>pe.jsxs("div",{className:"absolute top-20 w-full",children:[pe.jsx("h1",{className:"font-bold text-3xl text-center",children:"HTML+CSS  "}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),pe.jsxs("div",{className:"barGraph",children:[pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{})]}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),pe.jsxs("div",{className:"pieGraph",children:[pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{}),pe.jsx("div",{})]})]}),i9e="China",s9e=[{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""}]}]},{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""},{name:""}]}]}],o9e={name:i9e,children:s9e};function a9e(n){var e=0,t=n.children,r=t&&t.length;if(!r)e=1;else for(;--r>=0;)e+=t[r].value;n.value=e}function l9e(){return this.eachAfter(a9e)}function c9e(n,e){let t=-1;for(const r of this)n.call(e,r,++t,this);return this}function u9e(n,e){for(var t=this,r=[t],s,o,l=-1;t=r.pop();)if(n.call(e,t,++l,this),s=t.children)for(o=s.length-1;o>=0;--o)r.push(s[o]);return this}function h9e(n,e){for(var t=this,r=[t],s=[],o,l,c,a=-1;t=r.pop();)if(s.push(t),o=t.children)for(l=0,c=o.length;l<c;++l)r.push(o[l]);for(;t=s.pop();)n.call(e,t,++a,this);return this}function d9e(n,e){let t=-1;for(const r of this)if(n.call(e,r,++t,this))return r}function f9e(n){return this.eachAfter(function(e){for(var t=+n(e.data)||0,r=e.children,s=r&&r.length;--s>=0;)t+=r[s].value;e.value=t})}function p9e(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function m9e(n){for(var e=this,t=g9e(e,n),r=[e];e!==t;)e=e.parent,r.push(e);for(var s=r.length;n!==t;)r.splice(s,0,n),n=n.parent;return r}function g9e(n,e){if(n===e)return n;var t=n.ancestors(),r=e.ancestors(),s=null;for(n=t.pop(),e=r.pop();n===e;)s=n,n=t.pop(),e=r.pop();return s}function v9e(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function _9e(){return Array.from(this)}function y9e(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function x9e(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e}function*b9e(){var n=this,e,t=[n],r,s,o;do for(e=t.reverse(),t=[];n=e.pop();)if(yield n,r=n.children)for(s=0,o=r.length;s<o;++s)t.push(r[s]);while(t.length)}function K8(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=A9e)):e===void 0&&(e=S9e);for(var t=new VL(n),r,s=[t],o,l,c,a;r=s.pop();)if((l=e(r.data))&&(a=(l=Array.from(l)).length))for(r.children=l,c=a-1;c>=0;--c)s.push(o=l[c]=new VL(l[c])),o.parent=r,o.depth=r.depth+1;return t.eachBefore(M9e)}function w9e(){return K8(this).eachBefore(T9e)}function S9e(n){return n.children}function A9e(n){return Array.isArray(n)?n[1]:null}function T9e(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function M9e(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function VL(n){this.data=n,this.depth=this.height=0,this.parent=null}VL.prototype=K8.prototype={constructor:VL,count:l9e,each:c9e,eachAfter:h9e,eachBefore:u9e,find:d9e,sum:f9e,sort:p9e,path:m9e,ancestors:v9e,descendants:_9e,leaves:y9e,links:x9e,copy:w9e,[Symbol.iterator]:b9e};function C9e(n){return n==null?null:E9e(n)}function E9e(n){if(typeof n!="function")throw new Error;return n}function HJ(){return 0}function I9e(n){return function(){return n}}const P9e=1664525,R9e=1013904223,jJ=4294967296;function L9e(){let n=1;return()=>(n=(P9e*n+R9e)%jJ)/jJ}function D9e(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function B9e(n,e){let t=n.length,r,s;for(;t;)s=e()*t--|0,r=n[t],n[t]=n[s],n[s]=r;return n}function k9e(n,e){for(var t=0,r=(n=B9e(Array.from(n),e)).length,s=[],o,l;t<r;)o=n[t],l&&nhe(l,o)?++t:(l=F9e(s=O9e(s,o)),t=0);return l}function O9e(n,e){var t,r;if(UN(e,n))return[e];for(t=0;t<n.length;++t)if(ZI(e,n[t])&&UN(tT(n[t],e),n))return[n[t],e];for(t=0;t<n.length-1;++t)for(r=t+1;r<n.length;++r)if(ZI(tT(n[t],n[r]),e)&&ZI(tT(n[t],e),n[r])&&ZI(tT(n[r],e),n[t])&&UN(rhe(n[t],n[r],e),n))return[n[t],n[r],e];throw new Error}function ZI(n,e){var t=n.r-e.r,r=e.x-n.x,s=e.y-n.y;return t<0||t*t<r*r+s*s}function nhe(n,e){var t=n.r-e.r+Math.max(n.r,e.r,1)*1e-9,r=e.x-n.x,s=e.y-n.y;return t>0&&t*t>r*r+s*s}function UN(n,e){for(var t=0;t<e.length;++t)if(!nhe(n,e[t]))return!1;return!0}function F9e(n){switch(n.length){case 1:return N9e(n[0]);case 2:return tT(n[0],n[1]);case 3:return rhe(n[0],n[1],n[2])}}function N9e(n){return{x:n.x,y:n.y,r:n.r}}function tT(n,e){var t=n.x,r=n.y,s=n.r,o=e.x,l=e.y,c=e.r,a=o-t,d=l-r,f=c-s,m=Math.sqrt(a*a+d*d);return{x:(t+o+a/m*f)/2,y:(r+l+d/m*f)/2,r:(m+s+c)/2}}function rhe(n,e,t){var r=n.x,s=n.y,o=n.r,l=e.x,c=e.y,a=e.r,d=t.x,f=t.y,m=t.r,_=r-l,x=r-d,A=s-c,I=s-f,E=a-o,C=m-o,L=r*r+s*s-o*o,O=L-l*l-c*c+a*a,H=L-d*d-f*f+m*m,q=x*A-_*I,Z=(A*H-I*O)/(q*2)-r,J=(I*E-A*C)/q,re=(x*O-_*H)/(q*2)-s,se=(_*C-x*E)/q,ae=J*J+se*se-1,he=2*(o+Z*J+re*se),Ae=Z*Z+re*re-o*o,Ee=-(Math.abs(ae)>1e-6?(he+Math.sqrt(he*he-4*ae*Ae))/(2*ae):Ae/he);return{x:r+Z+J*Ee,y:s+re+se*Ee,r:Ee}}function WJ(n,e,t){var r=n.x-e.x,s,o,l=n.y-e.y,c,a,d=r*r+l*l;d?(o=e.r+t.r,o*=o,a=n.r+t.r,a*=a,o>a?(s=(d+a-o)/(2*d),c=Math.sqrt(Math.max(0,a/d-s*s)),t.x=n.x-s*r-c*l,t.y=n.y-s*l+c*r):(s=(d+o-a)/(2*d),c=Math.sqrt(Math.max(0,o/d-s*s)),t.x=e.x+s*r-c*l,t.y=e.y+s*l+c*r)):(t.x=e.x+t.r,t.y=e.y)}function $J(n,e){var t=n.r+e.r-1e-6,r=e.x-n.x,s=e.y-n.y;return t>0&&t*t>r*r+s*s}function XJ(n){var e=n._,t=n.next._,r=e.r+t.r,s=(e.x*t.r+t.x*e.r)/r,o=(e.y*t.r+t.y*e.r)/r;return s*s+o*o}function KI(n){this._=n,this.next=null,this.previous=null}function z9e(n,e){if(!(o=(n=D9e(n)).length))return 0;var t,r,s,o,l,c,a,d,f,m,_;if(t=n[0],t.x=0,t.y=0,!(o>1))return t.r;if(r=n[1],t.x=-r.r,r.x=t.r,r.y=0,!(o>2))return t.r+r.r;WJ(r,t,s=n[2]),t=new KI(t),r=new KI(r),s=new KI(s),t.next=s.previous=r,r.next=t.previous=s,s.next=r.previous=t;e:for(a=3;a<o;++a){WJ(t._,r._,s=n[a]),s=new KI(s),d=r.next,f=t.previous,m=r._.r,_=t._.r;do if(m<=_){if($J(d._,s._)){r=d,t.next=r,r.previous=t,--a;continue e}m+=d._.r,d=d.next}else{if($J(f._,s._)){t=f,t.next=r,r.previous=t,--a;continue e}_+=f._.r,f=f.previous}while(d!==f.next);for(s.previous=t,s.next=r,t.next=r.previous=r=s,l=XJ(t);(s=s.next)!==r;)(c=XJ(s))<l&&(t=s,l=c);r=t.next}for(t=[r._],s=r;(s=s.next)!==r;)t.push(s._);for(s=k9e(t,e),a=0;a<o;++a)t=n[a],t.x-=s.x,t.y-=s.y;return s.r}function U9e(n){return Math.sqrt(n.value)}function G9e(){var n=null,e=1,t=1,r=HJ;function s(o){const l=L9e();return o.x=e/2,o.y=t/2,n?o.eachBefore(qJ(n)).eachAfter(GN(r,.5,l)).eachBefore(YJ(1)):o.eachBefore(qJ(U9e)).eachAfter(GN(HJ,1,l)).eachAfter(GN(r,o.r/Math.min(e,t),l)).eachBefore(YJ(Math.min(e,t)/(2*o.r))),o}return s.radius=function(o){return arguments.length?(n=C9e(o),s):n},s.size=function(o){return arguments.length?(e=+o[0],t=+o[1],s):[e,t]},s.padding=function(o){return arguments.length?(r=typeof o=="function"?o:I9e(+o),s):r},s}function qJ(n){return function(e){e.children||(e.r=Math.max(0,+n(e)||0))}}function GN(n,e,t){return function(r){if(s=r.children){var s,o,l=s.length,c=n(r)*e||0,a;if(c)for(o=0;o<l;++o)s[o].r+=c;if(a=z9e(s,t),c)for(o=0;o<l;++o)s[o].r-=c;r.r=a+c}}}function YJ(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function nT(n,e,t){this.k=n,this.x=e,this.y=t}nT.prototype={constructor:nT,scale:function(n){return n===1?this:new nT(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new nT(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};nT.prototype;const V9e=()=>{const n=_e.useRef(null),e=_e.useRef(null);return _e.useEffect(()=>{const t=n.current.getContext("2d");t.save();const r=[n.current.width,n.current.height],s=[100,100];t.fillStyle="red",t.translate(-.5*s[0],-.5*s[1]),t.beginPath(),t.rect(.5*r[0],.5*r[1],s[0],s[1]),t.fill(),t.restore();const o=e.current.getContext("2d"),l=[e.current.width,e.current.height],c=K8(o9e).sum(_=>1).sort((_,x)=>x.value-_.value);console.log(c);const d=G9e().size(l).padding(3)(c),f=2*Math.PI,m=(_,x,{fillStyle:A="rgba(0,0,0,0.2)",textColor:I="white"}={})=>{const E=x.children;if(_.fillStyle=A,_.beginPath(),_.arc(x.x,x.y,x.r,0,f),_.fill(),E)for(const C of E)m(_,C);else{const C=x.data.name;_.fillStyle=I,_.font="1rem Aerial",_.textAlign="center",_.fillText(C,x.x,x.y)}};console.log(d.children),m(o,d)},[]),pe.jsxs("div",{className:"absolute top-20 w-full",children:[pe.jsx("h1",{className:"font-bold text-3xl text-center",children:"canvas "}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),pe.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:"(hierarchy)"}),pe.jsx("canvas",{ref:e,width:1024,height:1024,className:"ml-3 border-2 border-black-500 border-solid"})]})},H9e=()=>{const n=_e.useRef(null),e=_e.useRef(null);let t;const r=`
    attribute vec2 position;
    void main() {
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,s=`
    precision mediump float;
    void main() {
      gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
    }
  `,o=`
    attribute vec2 position;
    varying vec3 color;
    void main() {
      color = vec3(0.5 + position, 0.0);
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,l=`
    precision mediump float;
    varying vec3 color;
    void main() {
      gl_FragColor = vec4(color, 1.0);
    }
  `;let c;const a=(_,x,A)=>{t=_.getContext("webgl");const I=t.createShader(t.VERTEX_SHADER);t.shaderSource(I,x),t.compileShader(I),t.getShaderParameter(I,t.COMPILE_STATUS)||console.error("Vertex shader compilation failed:",t.getShaderInfoLog(I));const E=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(E,A),t.compileShader(E),t.getShaderParameter(E,t.COMPILE_STATUS)||console.error("Fragment shader compilation failed:",t.getShaderInfoLog(E)),c=t.createProgram(),t.attachShader(c,I),t.attachShader(c,E),t.linkProgram(c),t.getProgramParameter(c,t.LINK_STATUS)||console.error("Program linking failed:",t.getProgramInfoLog(c)),t.useProgram(c)},d=new Float32Array([-1,-1,0,1,1,-1]),f=()=>{const _=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,_),t.bufferData(t.ARRAY_BUFFER,d,t.STATIC_DRAW);const x=t.getAttribLocation(c,"position");t.vertexAttribPointer(x,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(x)},m=()=>{t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,d.length/2)};return _e.useEffect(()=>{a(n.current,r,s),f(),m(),a(e.current,o,l),f(),m()},[]),pe.jsxs("div",{className:"absolute top-20 w-full flex",children:[pe.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),pe.jsx("canvas",{ref:e,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"})]})};function VN(n,e,t){if(n&&n.length){const[r,s]=e,o=Math.PI/180*t,l=Math.cos(o),c=Math.sin(o);for(const a of n){const[d,f]=a;a[0]=(d-r)*l-(f-s)*c+r,a[1]=(d-r)*c+(f-s)*l+s}}}function j9e(n,e){return n[0]===e[0]&&n[1]===e[1]}function W9e(n,e,t,r=1){const s=t,o=Math.max(e,.1),l=n[0]&&n[0][0]&&typeof n[0][0]=="number"?[n]:n,c=[0,0];if(s)for(const d of l)VN(d,c,s);const a=function(d,f,m){const _=[];for(const L of d){const O=[...L];j9e(O[0],O[O.length-1])||O.push([O[0][0],O[0][1]]),O.length>2&&_.push(O)}const x=[];f=Math.max(f,.1);const A=[];for(const L of _)for(let O=0;O<L.length-1;O++){const H=L[O],q=L[O+1];if(H[1]!==q[1]){const Z=Math.min(H[1],q[1]);A.push({ymin:Z,ymax:Math.max(H[1],q[1]),x:Z===H[1]?H[0]:q[0],islope:(q[0]-H[0])/(q[1]-H[1])})}}if(A.sort((L,O)=>L.ymin<O.ymin?-1:L.ymin>O.ymin?1:L.x<O.x?-1:L.x>O.x?1:L.ymax===O.ymax?0:(L.ymax-O.ymax)/Math.abs(L.ymax-O.ymax)),!A.length)return x;let I=[],E=A[0].ymin,C=0;for(;I.length||A.length;){if(A.length){let L=-1;for(let O=0;O<A.length&&!(A[O].ymin>E);O++)L=O;A.splice(0,L+1).forEach(O=>{I.push({s:E,edge:O})})}if(I=I.filter(L=>!(L.edge.ymax<=E)),I.sort((L,O)=>L.edge.x===O.edge.x?0:(L.edge.x-O.edge.x)/Math.abs(L.edge.x-O.edge.x)),(m!==1||C%f==0)&&I.length>1)for(let L=0;L<I.length;L+=2){const O=L+1;if(O>=I.length)break;const H=I[L].edge,q=I[O].edge;x.push([[Math.round(H.x),E],[Math.round(q.x),E]])}E+=m,I.forEach(L=>{L.edge.x=L.edge.x+m*L.edge.islope}),C++}return x}(l,o,r);if(s){for(const d of l)VN(d,c,-s);(function(d,f,m){const _=[];d.forEach(x=>_.push(...x)),VN(_,f,m)})(a,c,-s)}return a}function WC(n,e){var t;const r=e.hachureAngle+90;let s=e.hachureGap;s<0&&(s=4*e.strokeWidth),s=Math.round(Math.max(s,.1));let o=1;return e.roughness>=1&&(((t=e.randomizer)===null||t===void 0?void 0:t.next())||Math.random())>.7&&(o=s),W9e(n,s,r,o||1)}class J8{constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){const r=WC(e,t);return{type:"fillSketch",ops:this.renderLines(r,t)}}renderLines(e,t){const r=[];for(const s of e)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],t));return r}}function ZB(n){const e=n[0],t=n[1];return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}class $9e extends J8{fillPolygons(e,t){let r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);const s=WC(e,Object.assign({},t,{hachureGap:r})),o=Math.PI/180*t.hachureAngle,l=[],c=.5*r*Math.cos(o),a=.5*r*Math.sin(o);for(const[d,f]of s)ZB([d,f])&&l.push([[d[0]-c,d[1]+a],[...f]],[[d[0]+c,d[1]-a],[...f]]);return{type:"fillSketch",ops:this.renderLines(l,t)}}}class X9e extends J8{fillPolygons(e,t){const r=this._fillPolygons(e,t),s=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),o=this._fillPolygons(e,s);return r.ops=r.ops.concat(o.ops),r}}let q9e=class{constructor(e){this.helper=e}fillPolygons(e,t){const r=WC(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(r,t)}dotsOnLines(e,t){const r=[];let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.max(s,.1);let o=t.fillWeight;o<0&&(o=t.strokeWidth/2);const l=s/4;for(const c of e){const a=ZB(c),d=a/s,f=Math.ceil(d)-1,m=a-f*s,_=(c[0][0]+c[1][0])/2-s/4,x=Math.min(c[0][1],c[1][1]);for(let A=0;A<f;A++){const I=x+m+A*s,E=_-l+2*Math.random()*l,C=I-l+2*Math.random()*l,L=this.helper.ellipse(E,C,o,o,t);r.push(...L.ops)}}return{type:"fillSketch",ops:r}}};class Y9e{constructor(e){this.helper=e}fillPolygons(e,t){const r=WC(e,t);return{type:"fillSketch",ops:this.dashedLine(r,t)}}dashedLine(e,t){const r=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,s=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,o=[];return e.forEach(l=>{const c=ZB(l),a=Math.floor(c/(r+s)),d=(c+s-a*(r+s))/2;let f=l[0],m=l[1];f[0]>m[0]&&(f=l[1],m=l[0]);const _=Math.atan((m[1]-f[1])/(m[0]-f[0]));for(let x=0;x<a;x++){const A=x*(r+s),I=A+r,E=[f[0]+A*Math.cos(_)+d*Math.cos(_),f[1]+A*Math.sin(_)+d*Math.sin(_)],C=[f[0]+I*Math.cos(_)+d*Math.cos(_),f[1]+I*Math.sin(_)+d*Math.sin(_)];o.push(...this.helper.doubleLineOps(E[0],E[1],C[0],C[1],t))}}),o}}class Z9e{constructor(e){this.helper=e}fillPolygons(e,t){const r=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,s=t.zigzagOffset<0?r:t.zigzagOffset,o=WC(e,t=Object.assign({},t,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(o,s,t)}}zigzagLines(e,t,r){const s=[];return e.forEach(o=>{const l=ZB(o),c=Math.round(l/(2*t));let a=o[0],d=o[1];a[0]>d[0]&&(a=o[1],d=o[0]);const f=Math.atan((d[1]-a[1])/(d[0]-a[0]));for(let m=0;m<c;m++){const _=2*m*t,x=2*(m+1)*t,A=Math.sqrt(2*Math.pow(t,2)),I=[a[0]+_*Math.cos(f),a[1]+_*Math.sin(f)],E=[a[0]+x*Math.cos(f),a[1]+x*Math.sin(f)],C=[I[0]+A*Math.cos(f+Math.PI/4),I[1]+A*Math.sin(f+Math.PI/4)];s.push(...this.helper.doubleLineOps(I[0],I[1],C[0],C[1],r),...this.helper.doubleLineOps(C[0],C[1],E[0],E[1],r))}}),s}}const nu={};class K9e{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const J9e=0,HN=1,ZJ=2,JI={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function jN(n,e){return n.type===e}function Q8(n){const e=[],t=function(l){const c=new Array;for(;l!=="";)if(l.match(/^([ \t\r\n,]+)/))l=l.substr(RegExp.$1.length);else if(l.match(/^([aAcChHlLmMqQsStTvVzZ])/))c[c.length]={type:J9e,text:RegExp.$1},l=l.substr(RegExp.$1.length);else{if(!l.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];c[c.length]={type:HN,text:`${parseFloat(RegExp.$1)}`},l=l.substr(RegExp.$1.length)}return c[c.length]={type:ZJ,text:""},c}(n);let r="BOD",s=0,o=t[s];for(;!jN(o,ZJ);){let l=0;const c=[];if(r==="BOD"){if(o.text!=="M"&&o.text!=="m")return Q8("M0,0"+n);s++,l=JI[o.text],r=o.text}else jN(o,HN)?l=JI[r]:(s++,l=JI[o.text],r=o.text);if(!(s+l<t.length))throw new Error("Path data ended short");for(let a=s;a<s+l;a++){const d=t[a];if(!jN(d,HN))throw new Error("Param not a number: "+r+","+d.text);c[c.length]=+d.text}if(typeof JI[r]!="number")throw new Error("Bad segment: "+r);{const a={key:r,data:c};e.push(a),s+=l,o=t[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return e}function ihe(n){let e=0,t=0,r=0,s=0;const o=[];for(const{key:l,data:c}of n)switch(l){case"M":o.push({key:"M",data:[...c]}),[e,t]=c,[r,s]=c;break;case"m":e+=c[0],t+=c[1],o.push({key:"M",data:[e,t]}),r=e,s=t;break;case"L":o.push({key:"L",data:[...c]}),[e,t]=c;break;case"l":e+=c[0],t+=c[1],o.push({key:"L",data:[e,t]});break;case"C":o.push({key:"C",data:[...c]}),e=c[4],t=c[5];break;case"c":{const a=c.map((d,f)=>f%2?d+t:d+e);o.push({key:"C",data:a}),e=a[4],t=a[5];break}case"Q":o.push({key:"Q",data:[...c]}),e=c[2],t=c[3];break;case"q":{const a=c.map((d,f)=>f%2?d+t:d+e);o.push({key:"Q",data:a}),e=a[2],t=a[3];break}case"A":o.push({key:"A",data:[...c]}),e=c[5],t=c[6];break;case"a":e+=c[5],t+=c[6],o.push({key:"A",data:[c[0],c[1],c[2],c[3],c[4],e,t]});break;case"H":o.push({key:"H",data:[...c]}),e=c[0];break;case"h":e+=c[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...c]}),t=c[0];break;case"v":t+=c[0],o.push({key:"V",data:[t]});break;case"S":o.push({key:"S",data:[...c]}),e=c[2],t=c[3];break;case"s":{const a=c.map((d,f)=>f%2?d+t:d+e);o.push({key:"S",data:a}),e=a[2],t=a[3];break}case"T":o.push({key:"T",data:[...c]}),e=c[0],t=c[1];break;case"t":e+=c[0],t+=c[1],o.push({key:"T",data:[e,t]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=r,t=s}return o}function she(n){const e=[];let t="",r=0,s=0,o=0,l=0,c=0,a=0;for(const{key:d,data:f}of n){switch(d){case"M":e.push({key:"M",data:[...f]}),[r,s]=f,[o,l]=f;break;case"C":e.push({key:"C",data:[...f]}),r=f[4],s=f[5],c=f[2],a=f[3];break;case"L":e.push({key:"L",data:[...f]}),[r,s]=f;break;case"H":r=f[0],e.push({key:"L",data:[r,s]});break;case"V":s=f[0],e.push({key:"L",data:[r,s]});break;case"S":{let m=0,_=0;t==="C"||t==="S"?(m=r+(r-c),_=s+(s-a)):(m=r,_=s),e.push({key:"C",data:[m,_,...f]}),c=f[0],a=f[1],r=f[2],s=f[3];break}case"T":{const[m,_]=f;let x=0,A=0;t==="Q"||t==="T"?(x=r+(r-c),A=s+(s-a)):(x=r,A=s);const I=r+2*(x-r)/3,E=s+2*(A-s)/3,C=m+2*(x-m)/3,L=_+2*(A-_)/3;e.push({key:"C",data:[I,E,C,L,m,_]}),c=x,a=A,r=m,s=_;break}case"Q":{const[m,_,x,A]=f,I=r+2*(m-r)/3,E=s+2*(_-s)/3,C=x+2*(m-x)/3,L=A+2*(_-A)/3;e.push({key:"C",data:[I,E,C,L,x,A]}),c=m,a=_,r=x,s=A;break}case"A":{const m=Math.abs(f[0]),_=Math.abs(f[1]),x=f[2],A=f[3],I=f[4],E=f[5],C=f[6];m===0||_===0?(e.push({key:"C",data:[r,s,E,C,E,C]}),r=E,s=C):(r!==E||s!==C)&&(ohe(r,s,E,C,m,_,x,A,I).forEach(function(L){e.push({key:"C",data:L})}),r=E,s=C);break}case"Z":e.push({key:"Z",data:[]}),r=o,s=l}t=d}return e}function BA(n,e,t){return[n*Math.cos(t)-e*Math.sin(t),n*Math.sin(t)+e*Math.cos(t)]}function ohe(n,e,t,r,s,o,l,c,a,d){const f=(m=l,Math.PI*m/180);var m;let _=[],x=0,A=0,I=0,E=0;if(d)[x,A,I,E]=d;else{[n,e]=BA(n,e,-f),[t,r]=BA(t,r,-f);const Ee=(n-t)/2,Pe=(e-r)/2;let ze=Ee*Ee/(s*s)+Pe*Pe/(o*o);ze>1&&(ze=Math.sqrt(ze),s*=ze,o*=ze);const Re=s*s,rt=o*o,ye=Re*rt-Re*Pe*Pe-rt*Ee*Ee,We=Re*Pe*Pe+rt*Ee*Ee,Ue=(c===a?-1:1)*Math.sqrt(Math.abs(ye/We));I=Ue*s*Pe/o+(n+t)/2,E=Ue*-o*Ee/s+(e+r)/2,x=Math.asin(parseFloat(((e-E)/o).toFixed(9))),A=Math.asin(parseFloat(((r-E)/o).toFixed(9))),n<I&&(x=Math.PI-x),t<I&&(A=Math.PI-A),x<0&&(x=2*Math.PI+x),A<0&&(A=2*Math.PI+A),a&&x>A&&(x-=2*Math.PI),!a&&A>x&&(A-=2*Math.PI)}let C=A-x;if(Math.abs(C)>120*Math.PI/180){const Ee=A,Pe=t,ze=r;A=a&&A>x?x+120*Math.PI/180*1:x+120*Math.PI/180*-1,_=ohe(t=I+s*Math.cos(A),r=E+o*Math.sin(A),Pe,ze,s,o,l,0,a,[A,Ee,I,E])}C=A-x;const L=Math.cos(x),O=Math.sin(x),H=Math.cos(A),q=Math.sin(A),Z=Math.tan(C/4),J=4/3*s*Z,re=4/3*o*Z,se=[n,e],ae=[n+J*O,e-re*L],he=[t+J*q,r-re*H],Ae=[t,r];if(ae[0]=2*se[0]-ae[0],ae[1]=2*se[1]-ae[1],d)return[ae,he,Ae].concat(_);{_=[ae,he,Ae].concat(_);const Ee=[];for(let Pe=0;Pe<_.length;Pe+=3){const ze=BA(_[Pe][0],_[Pe][1],f),Re=BA(_[Pe+1][0],_[Pe+1][1],f),rt=BA(_[Pe+2][0],_[Pe+2][1],f);Ee.push([ze[0],ze[1],Re[0],Re[1],rt[0],rt[1]])}return Ee}}const Q9e={randOffset:function(n,e){return si(n,e)},randOffsetWithRange:function(n,e,t){return HL(n,e,t)},ellipse:function(n,e,t,r,s){const o=lhe(t,r,s);return lU(n,e,s,o).opset},doubleLineOps:function(n,e,t,r,s){return B0(n,e,t,r,s,!0)}};function ahe(n,e,t,r,s){return{type:"path",ops:B0(n,e,t,r,s)}}function FP(n,e,t){const r=(n||[]).length;if(r>2){const s=[];for(let o=0;o<r-1;o++)s.push(...B0(n[o][0],n[o][1],n[o+1][0],n[o+1][1],t));return e&&s.push(...B0(n[r-1][0],n[r-1][1],n[0][0],n[0][1],t)),{type:"path",ops:s}}return r===2?ahe(n[0][0],n[0][1],n[1][0],n[1][1],t):{type:"path",ops:[]}}function eje(n,e,t,r,s){return function(o,l){return FP(o,!0,l)}([[n,e],[n+t,e],[n+t,e+r],[n,e+r]],s)}function KJ(n,e){if(n.length){const t=typeof n[0][0]=="number"?[n]:n,r=QI(t[0],1*(1+.2*e.roughness),e),s=e.disableMultiStroke?[]:QI(t[0],1.5*(1+.22*e.roughness),eQ(e));for(let o=1;o<t.length;o++){const l=t[o];if(l.length){const c=QI(l,1*(1+.2*e.roughness),e),a=e.disableMultiStroke?[]:QI(l,1.5*(1+.22*e.roughness),eQ(e));for(const d of c)d.op!=="move"&&r.push(d);for(const d of a)d.op!=="move"&&s.push(d)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function lhe(n,e,t){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(n/2,2)+Math.pow(e/2,2))/2)),s=Math.ceil(Math.max(t.curveStepCount,t.curveStepCount/Math.sqrt(200)*r)),o=2*Math.PI/s;let l=Math.abs(n/2),c=Math.abs(e/2);const a=1-t.curveFitting;return l+=si(l*a,t),c+=si(c*a,t),{increment:o,rx:l,ry:c}}function lU(n,e,t,r){const[s,o]=tQ(r.increment,n,e,r.rx,r.ry,1,r.increment*HL(.1,HL(.4,1,t),t),t);let l=jL(s,null,t);if(!t.disableMultiStroke&&t.roughness!==0){const[c]=tQ(r.increment,n,e,r.rx,r.ry,1.5,0,t),a=jL(c,null,t);l=l.concat(a)}return{estimatedPoints:o,opset:{type:"path",ops:l}}}function JJ(n,e,t,r,s,o,l,c,a){const d=n,f=e;let m=Math.abs(t/2),_=Math.abs(r/2);m+=si(.01*m,a),_+=si(.01*_,a);let x=s,A=o;for(;x<0;)x+=2*Math.PI,A+=2*Math.PI;A-x>2*Math.PI&&(x=0,A=2*Math.PI);const I=2*Math.PI/a.curveStepCount,E=Math.min(I/2,(A-x)/2),C=nQ(E,d,f,m,_,x,A,1,a);if(!a.disableMultiStroke){const L=nQ(E,d,f,m,_,x,A,1.5,a);C.push(...L)}return l&&(c?C.push(...B0(d,f,d+m*Math.cos(x),f+_*Math.sin(x),a),...B0(d,f,d+m*Math.cos(A),f+_*Math.sin(A),a)):C.push({op:"lineTo",data:[d,f]},{op:"lineTo",data:[d+m*Math.cos(x),f+_*Math.sin(x)]})),{type:"path",ops:C}}function QJ(n,e){const t=she(ihe(Q8(n))),r=[];let s=[0,0],o=[0,0];for(const{key:l,data:c}of t)switch(l){case"M":o=[c[0],c[1]],s=[c[0],c[1]];break;case"L":r.push(...B0(o[0],o[1],c[0],c[1],e)),o=[c[0],c[1]];break;case"C":{const[a,d,f,m,_,x]=c;r.push(...tje(a,d,f,m,_,x,o,e)),o=[_,x];break}case"Z":r.push(...B0(o[0],o[1],s[0],s[1],e)),o=[s[0],s[1]]}return{type:"path",ops:r}}function WN(n,e){const t=[];for(const r of n)if(r.length){const s=e.maxRandomnessOffset||0,o=r.length;if(o>2){t.push({op:"move",data:[r[0][0]+si(s,e),r[0][1]+si(s,e)]});for(let l=1;l<o;l++)t.push({op:"lineTo",data:[r[l][0]+si(s,e),r[l][1]+si(s,e)]})}}return{type:"fillPath",ops:t}}function ab(n,e){return function(t,r){let s=t.fillStyle||"hachure";if(!nu[s])switch(s){case"zigzag":nu[s]||(nu[s]=new $9e(r));break;case"cross-hatch":nu[s]||(nu[s]=new X9e(r));break;case"dots":nu[s]||(nu[s]=new q9e(r));break;case"dashed":nu[s]||(nu[s]=new Y9e(r));break;case"zigzag-line":nu[s]||(nu[s]=new Z9e(r));break;default:s="hachure",nu[s]||(nu[s]=new J8(r))}return nu[s]}(e,Q9e).fillPolygons(n,e)}function eQ(n){const e=Object.assign({},n);return e.randomizer=void 0,n.seed&&(e.seed=n.seed+1),e}function che(n){return n.randomizer||(n.randomizer=new K9e(n.seed||0)),n.randomizer.next()}function HL(n,e,t,r=1){return t.roughness*r*(che(t)*(e-n)+n)}function si(n,e,t=1){return HL(-n,n,e,t)}function B0(n,e,t,r,s,o=!1){const l=o?s.disableMultiStrokeFill:s.disableMultiStroke,c=cU(n,e,t,r,s,!0,!1);if(l)return c;const a=cU(n,e,t,r,s,!0,!0);return c.concat(a)}function cU(n,e,t,r,s,o,l){const c=Math.pow(n-t,2)+Math.pow(e-r,2),a=Math.sqrt(c);let d=1;d=a<200?1:a>500?.4:-.0016668*a+1.233334;let f=s.maxRandomnessOffset||0;f*f*100>c&&(f=a/10);const m=f/2,_=.2+.2*che(s);let x=s.bowing*s.maxRandomnessOffset*(r-e)/200,A=s.bowing*s.maxRandomnessOffset*(n-t)/200;x=si(x,s,d),A=si(A,s,d);const I=[],E=()=>si(m,s,d),C=()=>si(f,s,d),L=s.preserveVertices;return l?I.push({op:"move",data:[n+(L?0:E()),e+(L?0:E())]}):I.push({op:"move",data:[n+(L?0:si(f,s,d)),e+(L?0:si(f,s,d))]}),l?I.push({op:"bcurveTo",data:[x+n+(t-n)*_+E(),A+e+(r-e)*_+E(),x+n+2*(t-n)*_+E(),A+e+2*(r-e)*_+E(),t+(L?0:E()),r+(L?0:E())]}):I.push({op:"bcurveTo",data:[x+n+(t-n)*_+C(),A+e+(r-e)*_+C(),x+n+2*(t-n)*_+C(),A+e+2*(r-e)*_+C(),t+(L?0:C()),r+(L?0:C())]}),I}function QI(n,e,t){if(!n.length)return[];const r=[];r.push([n[0][0]+si(e,t),n[0][1]+si(e,t)]),r.push([n[0][0]+si(e,t),n[0][1]+si(e,t)]);for(let s=1;s<n.length;s++)r.push([n[s][0]+si(e,t),n[s][1]+si(e,t)]),s===n.length-1&&r.push([n[s][0]+si(e,t),n[s][1]+si(e,t)]);return jL(r,null,t)}function jL(n,e,t){const r=n.length,s=[];if(r>3){const o=[],l=1-t.curveTightness;s.push({op:"move",data:[n[1][0],n[1][1]]});for(let c=1;c+2<r;c++){const a=n[c];o[0]=[a[0],a[1]],o[1]=[a[0]+(l*n[c+1][0]-l*n[c-1][0])/6,a[1]+(l*n[c+1][1]-l*n[c-1][1])/6],o[2]=[n[c+1][0]+(l*n[c][0]-l*n[c+2][0])/6,n[c+1][1]+(l*n[c][1]-l*n[c+2][1])/6],o[3]=[n[c+1][0],n[c+1][1]],s.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}}else r===3?(s.push({op:"move",data:[n[1][0],n[1][1]]}),s.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[2][0],n[2][1]]})):r===2&&s.push(...cU(n[0][0],n[0][1],n[1][0],n[1][1],t,!0,!0));return s}function tQ(n,e,t,r,s,o,l,c){const a=[],d=[];if(c.roughness===0){n/=4,d.push([e+r*Math.cos(-n),t+s*Math.sin(-n)]);for(let f=0;f<=2*Math.PI;f+=n){const m=[e+r*Math.cos(f),t+s*Math.sin(f)];a.push(m),d.push(m)}d.push([e+r*Math.cos(0),t+s*Math.sin(0)]),d.push([e+r*Math.cos(n),t+s*Math.sin(n)])}else{const f=si(.5,c)-Math.PI/2;d.push([si(o,c)+e+.9*r*Math.cos(f-n),si(o,c)+t+.9*s*Math.sin(f-n)]);const m=2*Math.PI+f-.01;for(let _=f;_<m;_+=n){const x=[si(o,c)+e+r*Math.cos(_),si(o,c)+t+s*Math.sin(_)];a.push(x),d.push(x)}d.push([si(o,c)+e+r*Math.cos(f+2*Math.PI+.5*l),si(o,c)+t+s*Math.sin(f+2*Math.PI+.5*l)]),d.push([si(o,c)+e+.98*r*Math.cos(f+l),si(o,c)+t+.98*s*Math.sin(f+l)]),d.push([si(o,c)+e+.9*r*Math.cos(f+.5*l),si(o,c)+t+.9*s*Math.sin(f+.5*l)])}return[d,a]}function nQ(n,e,t,r,s,o,l,c,a){const d=o+si(.1,a),f=[];f.push([si(c,a)+e+.9*r*Math.cos(d-n),si(c,a)+t+.9*s*Math.sin(d-n)]);for(let m=d;m<=l;m+=n)f.push([si(c,a)+e+r*Math.cos(m),si(c,a)+t+s*Math.sin(m)]);return f.push([e+r*Math.cos(l),t+s*Math.sin(l)]),f.push([e+r*Math.cos(l),t+s*Math.sin(l)]),jL(f,null,a)}function tje(n,e,t,r,s,o,l,c){const a=[],d=[c.maxRandomnessOffset||1,(c.maxRandomnessOffset||1)+.3];let f=[0,0];const m=c.disableMultiStroke?1:2,_=c.preserveVertices;for(let x=0;x<m;x++)x===0?a.push({op:"move",data:[l[0],l[1]]}):a.push({op:"move",data:[l[0]+(_?0:si(d[0],c)),l[1]+(_?0:si(d[0],c))]}),f=_?[s,o]:[s+si(d[x],c),o+si(d[x],c)],a.push({op:"bcurveTo",data:[n+si(d[x],c),e+si(d[x],c),t+si(d[x],c),r+si(d[x],c),f[0],f[1]]});return a}function kA(n){return[...n]}function rQ(n,e=0){const t=n.length;if(t<3)throw new Error("A curve must have at least three points.");const r=[];if(t===3)r.push(kA(n[0]),kA(n[1]),kA(n[2]),kA(n[2]));else{const s=[];s.push(n[0],n[0]);for(let c=1;c<n.length;c++)s.push(n[c]),c===n.length-1&&s.push(n[c]);const o=[],l=1-e;r.push(kA(s[0]));for(let c=1;c+2<s.length;c++){const a=s[c];o[0]=[a[0],a[1]],o[1]=[a[0]+(l*s[c+1][0]-l*s[c-1][0])/6,a[1]+(l*s[c+1][1]-l*s[c-1][1])/6],o[2]=[s[c+1][0]+(l*s[c][0]-l*s[c+2][0])/6,s[c+1][1]+(l*s[c][1]-l*s[c+2][1])/6],o[3]=[s[c+1][0],s[c+1][1]],r.push(o[1],o[2],o[3])}}return r}function NP(n,e){return Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)}function nje(n,e,t){const r=NP(e,t);if(r===0)return NP(n,e);let s=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/r;return s=Math.max(0,Math.min(1,s)),NP(n,My(e,t,s))}function My(n,e,t){return[n[0]+(e[0]-n[0])*t,n[1]+(e[1]-n[1])*t]}function uU(n,e,t,r){const s=r||[];if(function(c,a){const d=c[a+0],f=c[a+1],m=c[a+2],_=c[a+3];let x=3*f[0]-2*d[0]-_[0];x*=x;let A=3*f[1]-2*d[1]-_[1];A*=A;let I=3*m[0]-2*_[0]-d[0];I*=I;let E=3*m[1]-2*_[1]-d[1];return E*=E,x<I&&(x=I),A<E&&(A=E),x+A}(n,e)<t){const c=n[e+0];s.length?(o=s[s.length-1],l=c,Math.sqrt(NP(o,l))>1&&s.push(c)):s.push(c),s.push(n[e+3])}else{const a=n[e+0],d=n[e+1],f=n[e+2],m=n[e+3],_=My(a,d,.5),x=My(d,f,.5),A=My(f,m,.5),I=My(_,x,.5),E=My(x,A,.5),C=My(I,E,.5);uU([a,_,I,C],0,t,s),uU([C,E,A,m],0,t,s)}var o,l;return s}function rje(n,e){return WL(n,0,n.length,e)}function WL(n,e,t,r,s){const o=s||[],l=n[e],c=n[t-1];let a=0,d=1;for(let f=e+1;f<t-1;++f){const m=nje(n[f],l,c);m>a&&(a=m,d=f)}return Math.sqrt(a)>r?(WL(n,e,d+1,r,o),WL(n,d,t,r,o)):(o.length||o.push(l),o.push(c)),o}function $N(n,e=.15,t){const r=[],s=(n.length-1)/3;for(let o=0;o<s;o++)uU(n,3*o,e,r);return t&&t>0?WL(r,0,r.length,t):r}const Bu="none";class $L{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,r){return{shape:e,sets:t||[],options:r||this.defaultOptions}}line(e,t,r,s,o){const l=this._o(o);return this._d("line",[ahe(e,t,r,s,l)],l)}rectangle(e,t,r,s,o){const l=this._o(o),c=[],a=eje(e,t,r,s,l);if(l.fill){const d=[[e,t],[e+r,t],[e+r,t+s],[e,t+s]];l.fillStyle==="solid"?c.push(WN([d],l)):c.push(ab([d],l))}return l.stroke!==Bu&&c.push(a),this._d("rectangle",c,l)}ellipse(e,t,r,s,o){const l=this._o(o),c=[],a=lhe(r,s,l),d=lU(e,t,l,a);if(l.fill)if(l.fillStyle==="solid"){const f=lU(e,t,l,a).opset;f.type="fillPath",c.push(f)}else c.push(ab([d.estimatedPoints],l));return l.stroke!==Bu&&c.push(d.opset),this._d("ellipse",c,l)}circle(e,t,r,s){const o=this.ellipse(e,t,r,r,s);return o.shape="circle",o}linearPath(e,t){const r=this._o(t);return this._d("linearPath",[FP(e,!1,r)],r)}arc(e,t,r,s,o,l,c=!1,a){const d=this._o(a),f=[],m=JJ(e,t,r,s,o,l,c,!0,d);if(c&&d.fill)if(d.fillStyle==="solid"){const _=Object.assign({},d);_.disableMultiStroke=!0;const x=JJ(e,t,r,s,o,l,!0,!1,_);x.type="fillPath",f.push(x)}else f.push(function(_,x,A,I,E,C,L){const O=_,H=x;let q=Math.abs(A/2),Z=Math.abs(I/2);q+=si(.01*q,L),Z+=si(.01*Z,L);let J=E,re=C;for(;J<0;)J+=2*Math.PI,re+=2*Math.PI;re-J>2*Math.PI&&(J=0,re=2*Math.PI);const se=(re-J)/L.curveStepCount,ae=[];for(let he=J;he<=re;he+=se)ae.push([O+q*Math.cos(he),H+Z*Math.sin(he)]);return ae.push([O+q*Math.cos(re),H+Z*Math.sin(re)]),ae.push([O,H]),ab([ae],L)}(e,t,r,s,o,l,d));return d.stroke!==Bu&&f.push(m),this._d("arc",f,d)}curve(e,t){const r=this._o(t),s=[],o=KJ(e,r);if(r.fill&&r.fill!==Bu)if(r.fillStyle==="solid"){const l=KJ(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else{const l=[],c=e;if(c.length){const a=typeof c[0][0]=="number"?[c]:c;for(const d of a)d.length<3?l.push(...d):d.length===3?l.push(...$N(rQ([d[0],d[0],d[1],d[2]]),10,(1+r.roughness)/2)):l.push(...$N(rQ(d),10,(1+r.roughness)/2))}l.length&&s.push(ab([l],r))}return r.stroke!==Bu&&s.push(o),this._d("curve",s,r)}polygon(e,t){const r=this._o(t),s=[],o=FP(e,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(WN([e],r)):s.push(ab([e],r))),r.stroke!==Bu&&s.push(o),this._d("polygon",s,r)}path(e,t){const r=this._o(t),s=[];if(!e)return this._d("path",s,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const o=r.fill&&r.fill!=="transparent"&&r.fill!==Bu,l=r.stroke!==Bu,c=!!(r.simplification&&r.simplification<1),a=function(f,m,_){const x=she(ihe(Q8(f))),A=[];let I=[],E=[0,0],C=[];const L=()=>{C.length>=4&&I.push(...$N(C,m)),C=[]},O=()=>{L(),I.length&&(A.push(I),I=[])};for(const{key:q,data:Z}of x)switch(q){case"M":O(),E=[Z[0],Z[1]],I.push(E);break;case"L":L(),I.push([Z[0],Z[1]]);break;case"C":if(!C.length){const J=I.length?I[I.length-1]:E;C.push([J[0],J[1]])}C.push([Z[0],Z[1]]),C.push([Z[2],Z[3]]),C.push([Z[4],Z[5]]);break;case"Z":L(),I.push([E[0],E[1]])}if(O(),!_)return A;const H=[];for(const q of A){const Z=rje(q,_);Z.length&&H.push(Z)}return H}(e,1,c?4-4*(r.simplification||1):(1+r.roughness)/2),d=QJ(e,r);if(o)if(r.fillStyle==="solid")if(a.length===1){const f=QJ(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(f.ops)})}else s.push(WN(a,r));else s.push(ab(a,r));return l&&(c?a.forEach(f=>{s.push(FP(f,!1,r))}):s.push(d)),this._d("path",s,r)}opsToPath(e,t){let r="";for(const s of e.ops){const o=typeof t=="number"&&t>=0?s.data.map(l=>+l.toFixed(t)):s.data;switch(s.op){case"move":r+=`M${o[0]} ${o[1]} `;break;case"bcurveTo":r+=`C${o[0]} ${o[1]}, ${o[2]} ${o[3]}, ${o[4]} ${o[5]} `;break;case"lineTo":r+=`L${o[0]} ${o[1]} `}}return r.trim()}toPaths(e){const t=e.sets||[],r=e.options||this.defaultOptions,s=[];for(const o of t){let l=null;switch(o.type){case"path":l={d:this.opsToPath(o),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Bu};break;case"fillPath":l={d:this.opsToPath(o),stroke:Bu,strokeWidth:0,fill:r.fill||Bu};break;case"fillSketch":l=this.fillSketch(o,r)}l&&s.push(l)}return s}fillSketch(e,t){let r=t.fillWeight;return r<0&&(r=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||Bu,strokeWidth:r,fill:Bu}}_mergedShape(e){return e.filter((t,r)=>r===0||t.op!=="move")}}class ije{constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new $L(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),s=this.ctx,o=e.options.fixedDecimalPlaceDigits;for(const l of t)switch(l.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,l,o),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const c=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,l,o,c),s.restore();break}case"fillSketch":this.fillSketch(s,l,r)}}fillSketch(e,t,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=s,this._drawToContext(e,t,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,r,s="nonzero"){e.beginPath();for(const o of t.ops){const l=typeof r=="number"&&r>=0?o.data.map(c=>+c.toFixed(r)):o.data;switch(o.op){case"move":e.moveTo(l[0],l[1]);break;case"bcurveTo":e.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"lineTo":e.lineTo(l[0],l[1])}}t.type==="fillPath"?e.fill(s):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,r,s,o){const l=this.gen.line(e,t,r,s,o);return this.draw(l),l}rectangle(e,t,r,s,o){const l=this.gen.rectangle(e,t,r,s,o);return this.draw(l),l}ellipse(e,t,r,s,o){const l=this.gen.ellipse(e,t,r,s,o);return this.draw(l),l}circle(e,t,r,s){const o=this.gen.circle(e,t,r,s);return this.draw(o),o}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r),r}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r),r}arc(e,t,r,s,o,l,c=!1,a){const d=this.gen.arc(e,t,r,s,o,l,c,a);return this.draw(d),d}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r),r}path(e,t){const r=this.gen.path(e,t);return this.draw(r),r}}const eP="http://www.w3.org/2000/svg";class sje{constructor(e,t){this.svg=e,this.gen=new $L(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,o=s.createElementNS(eP,"g"),l=e.options.fixedDecimalPlaceDigits;for(const c of t){let a=null;switch(c.type){case"path":a=s.createElementNS(eP,"path"),a.setAttribute("d",this.opsToPath(c,l)),a.setAttribute("stroke",r.stroke),a.setAttribute("stroke-width",r.strokeWidth+""),a.setAttribute("fill","none"),r.strokeLineDash&&a.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&a.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":a=s.createElementNS(eP,"path"),a.setAttribute("d",this.opsToPath(c,l)),a.setAttribute("stroke","none"),a.setAttribute("stroke-width","0"),a.setAttribute("fill",r.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||a.setAttribute("fill-rule","evenodd");break;case"fillSketch":a=this.fillSketch(s,c,r)}a&&o.appendChild(a)}return o}fillSketch(e,t,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const o=e.createElementNS(eP,"path");return o.setAttribute("d",this.opsToPath(t,r.fixedDecimalPlaceDigits)),o.setAttribute("stroke",r.fill||""),o.setAttribute("stroke-width",s+""),o.setAttribute("fill","none"),r.fillLineDash&&o.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&o.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),o}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,t){return this.gen.opsToPath(e,t)}line(e,t,r,s,o){const l=this.gen.line(e,t,r,s,o);return this.draw(l)}rectangle(e,t,r,s,o){const l=this.gen.rectangle(e,t,r,s,o);return this.draw(l)}ellipse(e,t,r,s,o){const l=this.gen.ellipse(e,t,r,s,o);return this.draw(l)}circle(e,t,r,s){const o=this.gen.circle(e,t,r,s);return this.draw(o)}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r)}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r)}arc(e,t,r,s,o,l,c=!1,a){const d=this.gen.arc(e,t,r,s,o,l,c,a);return this.draw(d)}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r)}path(e,t){const r=this.gen.path(e,t);return this.draw(r)}}var uhe={canvas:(n,e)=>new ije(n,e),svg:(n,e)=>new sje(n,e),generator:n=>new $L(n),newSeed:()=>$L.newSeed()};class Pw extends Array{constructor(e=1,t=0){super(e,t)}set x(e){this[0]=e}set y(e){this[1]=e}get x(){return this[0]}get y(){return this[1]}get length(){return Math.hypot(this[0],this[1])}get dir(){return Math.atan2(this[1],this[0])}copy(){return new Pw(this[0],this[1])}add(e){return this.x+=e.x,this.y+=e.y,this}rotate(e){const[t,r]=this;return this[0]=t*Math.cos(e)-r*Math.sin(e),this[1]=t*Math.sin(e)+r*Math.cos(e),this}scale(e){return this[0]*=e,this[1]*=e,this}}const oje=()=>{const n=_e.useRef(null),e={roughness:2.2,strokeWidth:4,fill:"blue"},t={stroke:"red",strokeWidth:4,fill:"yellow",fillStyle:"solid"},r={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},s=(o,l,c,a)=>{const d=2*Math.PI/o;let f=new Pw(l,c),m=[[f.x,f.y]],_=new Pw(a,0);for(let x=0;x<o;x++)f=f.copy().add(_.rotate(d)),m.push([f.x,f.y]);return m};return _e.useEffect(()=>{const o=uhe.canvas(n.current),l=o.ctx;l.translate(256,256),l.scale(1,-1),o.path("M-180 0L-80 100L20 0",e),o.path("M-20 0L80 100L180 0",e),o.circle(0,150,105,t),o.polygon(s(5,n.current.width/2,0,50),r),o.polygon(s(10,0,0,20),r)},[]),pe.jsx("div",{className:"absolute top-20 w-full",children:pe.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},aje=()=>{const n=_e.useRef(null),e=(t,r,s,o,l,c)=>{let a=new Pw().rotate(l).scale(s),d=r.copy().add(a);if(t.lineWidth=o,t.beginPath(),t.moveTo(...r),t.lineTo(...d),t.stroke(),o>2){let f=Math.PI/4+.5*(l+.2)+(Math.random()-.5)*c;e(t,d,s*.9,o*.8,f,c*.9);let m=Math.PI/4+.5*(l-.2)+(Math.random()-.5)*c;e(t,d,s*.9,o*.8,m,c*.9)}o<5&&Math.random()<.3&&(t.save(),t.strokeStyle="red",t.lineWidth=Math.random()*5,t.beginPath(),t.moveTo(...d),t.lineTo(d.x,d.y-2),t.stroke(),t.restore())};return _e.useEffect(()=>{const t=n.current.getContext("2d");t.translate(0,n.current.height),t.scale(1,-1),t.lineCap="round",e(t,new Pw(512,0),50,10,1,3)},[]),pe.jsx("div",{className:"absolute top-20 w-full",children:pe.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},lje=()=>{const n=_e.useRef(null),e={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},t={stroke:"blue",strokeWidth:3},r=Math.PI*2,s=60;function o(a,d,f,m=0,_=r){const x=_-m===r?r:_-m,A=[];for(let I=0;I<s;I++){let E=a+f*Math.cos(m+x*I/s),C=d+f*Math.sin(m+x*I/s);A.push([E,C])}return A}function l(a,d,f,m,_=0,x=r){const A=x-_===r?r:x-_,I=[];for(let E=0;E<=s;E++){let C=a+f*Math.cos(_+A*E/s),L=d+m*Math.sin(_+A*E/s);I.push([C,L])}return I}function c(a,d,f,m,_){let x=[];for(let A=0;A<s;A++){const I=A/s,E=(1-I)*m+I*_,C=a+2*f*E*E,L=d+2*f*E;x.push([C,L])}return x}return _e.useEffect(()=>{const a=uhe.canvas(n.current),d=a.ctx;d.translate(512,256),d.scale(1,-1),a.polygon(o(-100,0,50),e),a.polygon(l(0,0,50,30),e);const f=c(100,0,5,-5,5);for(let m=0;m<f.length-1;m++)a.line(f[m][0],f[m][1],f[m+1][0],f[m+1][1],t)},[]),pe.jsx("div",{className:"absolute top-20 w-full",children:pe.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},cje="_info_d8zv1_1",uje={info:cje},hje=()=>pe.jsx("div",{className:"absolute top-20 w-full text-lg",children:pe.jsx("button",{className:uje.info,children:"yes"})}),dje=()=>{const n={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red"},e={width:0,height:0,border:"80px solid",margin:2,"border-color":"green yellow red black"},t={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red","border-left":0},r={width:"160px",height:"`60px",background:"linear-gradient(45deg, red, red 50%, transparent 50%)"},s={width:"160px",height:"120px",position:"relative",overflow:"hidden"},o={content:"",position:"absolute",left:0,top:0,right:0,bottom:0,background:"red",transformOrigin:"left bottom",transform:"rotate(45deg)"},l={position:"relative",width:0,height:0,"border-width":"0 80px 80px","border-style":"solid","border-color":"transparent transparent red"},c={content:"",position:"absolute",top:"1px",left:"-76px","border-width":"0 76px 76px","border-style":"solid","border-color":"transparent transparent yellow"},a={width:"160px",height:"120px",border:"0px solid transparent",borderTop:"60px solid red",borderLeft:"40px solid transparent"};return pe.jsxs("div",{className:"absolute top-20 w-full",children:[pe.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; linear-gradient; rotate; +border) "}),pe.jsxs("div",{className:"flex",children:[pe.jsx("div",{style:n}),pe.jsx("div",{style:e}),pe.jsx("div",{style:t}),pe.jsx("div",{style:r}),pe.jsx("div",{style:s,children:pe.jsx("div",{style:o})}),pe.jsx("div",{style:l,children:pe.jsx("div",{style:c})})]}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:"(skew)"}),pe.jsxs("div",{className:"flex",children:[pe.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-x-12"}),pe.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-y-12"})]}),pe.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; "}),pe.jsx("div",{className:"flex",children:pe.jsx("div",{style:a})})]})},fje=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"600px",height:"600px",border:"black 1px solid",display:"flex","align-items":"flex-start","flex-wrap":"wrap","align-content":"flex-start"},e={height:"100px",flex:"0 0 25%",border:"red 1px solid",margin:"0"};return pe.jsxs("div",{style:n,children:[pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"}),pe.jsx("div",{style:e,children:"111"})]})},pje=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"white",backgroundColor:"black",display:"flex",alignItems:"center"},e={width:"50px",height:"50px",border:"red 1px solid",marginRight:"10px"},t={overflowWrap:"anywhere"};return pe.jsxs("div",{style:n,children:[pe.jsx("img",{src:Die,alt:"",style:e}),pe.jsx("p",{style:t,children:"ttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt"})]})},mje=()=>{const n={border:"purple 1px solid",flex:1},e={"box-sizing":"border-box",width:"100vw",height:"100vh",display:"flex","flex-direction":"column",border:"yellow 4px solid"},t={border:"red 1px solid",flex:"80%",display:"flex",width:"100%",height:"100%"},r={border:"blue 1px solid",flex:1},s={flex:"0 0 12em"};return pe.jsxs("div",{style:e,children:[pe.jsx("header",{style:n,children:"header"}),pe.jsxs("div",{style:t,children:[pe.jsx("div",{style:{...r,...s},children:"1"}),pe.jsx("div",{style:r,children:"2"}),pe.jsx("div",{style:{...r,...s},children:"3"})]}),pe.jsx("footer",{style:n,children:"footer"})]})};function gje({title:n,titleId:e,...t},r){return _e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?_e.createElement("title",{id:e},n):null,_e.createElement("path",{d:"M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3Z"}),_e.createElement("path",{fillRule:"evenodd",d:"M13 6H3v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V6ZM5.72 7.47a.75.75 0 0 1 1.06 0L8 8.69l1.22-1.22a.75.75 0 1 1 1.06 1.06L9.06 9.75l1.22 1.22a.75.75 0 1 1-1.06 1.06L8 10.81l-1.22 1.22a.75.75 0 0 1-1.06-1.06l1.22-1.22-1.22-1.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const vje=_e.forwardRef(gje);function _je({title:n,titleId:e,...t},r){return _e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?_e.createElement("title",{id:e},n):null,_e.createElement("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const yje=_e.forwardRef(_je);function xje({title:n,titleId:e,...t},r){return _e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?_e.createElement("title",{id:e},n):null,_e.createElement("path",{fillRule:"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z",clipRule:"evenodd"}))}const bje=_e.forwardRef(xje);function wje({title:n,titleId:e,...t},r){return _e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?_e.createElement("title",{id:e},n):null,_e.createElement("path",{d:"M5 6.5A1.5 1.5 0 0 1 6.5 5h6A1.5 1.5 0 0 1 14 6.5v6a1.5 1.5 0 0 1-1.5 1.5h-6A1.5 1.5 0 0 1 5 12.5v-6Z"}),_e.createElement("path",{d:"M3.5 2A1.5 1.5 0 0 0 2 3.5v6A1.5 1.5 0 0 0 3.5 11V6.5a3 3 0 0 1 3-3H11A1.5 1.5 0 0 0 9.5 2h-6Z"}))}const Sje=_e.forwardRef(wje);function Aje({title:n,titleId:e,...t},r){return _e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?_e.createElement("title",{id:e},n):null,_e.createElement("path",{fillRule:"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z",clipRule:"evenodd"}))}const iQ=_e.forwardRef(Aje);/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function sQ(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function tP(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sQ(Object(t),!0).forEach(function(r){Cje(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sQ(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Tje(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function oQ(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,hhe(r.key),r)}}function Mje(n,e,t){return e&&oQ(n.prototype,e),t&&oQ(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Cje(n,e,t){return e=hhe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XL(){return XL=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},XL.apply(this,arguments)}function Eje(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hhe(n){var e=Eje(n,"string");return typeof e=="symbol"?e:String(e)}var dhe={exports:{}};(function(n){typeof window>"u"||function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),s=r&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),o=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,l=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,c=(r||o)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(a){var d,f,m,_,x,A,I,E,C;if(d=a.match(l),!d)throw new Error("invalid data URI");for(f=d[2]?d[1]:"text/plain"+(d[3]||";charset=US-ASCII"),m=!!d[4],_=a.slice(d[0].length),m?x=atob(_):x=decodeURIComponent(_),A=new ArrayBuffer(x.length),I=new Uint8Array(A),E=0;E<x.length;E+=1)I[E]=x.charCodeAt(E);return r?new Blob([s?I:A],{type:f}):(C=new o,C.append(A),C.getBlob(f))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(a,d,f){var m=this;setTimeout(function(){f&&t.toDataURL&&c?a(c(m.toDataURL(d,f))):a(m.mozGetAsFile("blob",d))})}:t.toDataURL&&c&&(t.msToBlob?t.toBlob=function(a,d,f){var m=this;setTimeout(function(){(d&&d!=="image/png"||f)&&t.toDataURL&&c?a(c(m.toDataURL(d,f))):a(m.msToBlob(d))})}:t.toBlob=function(a,d,f){var m=this;setTimeout(function(){a(c(m.toDataURL(d,f)))})})),n.exports?n.exports=c:e.dataURLtoBlob=c}(window)})(dhe);var aQ=dhe.exports,Ije=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},lQ={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Pje=typeof window<"u"&&typeof window.document<"u",k0=Pje?window:{},qL=function(e){return e>0&&e<1/0},Rje=Array.prototype.slice;function eV(n){return Array.from?Array.from(n):Rje.call(n)}var Lje=/^image\/.+$/;function hU(n){return Lje.test(n)}function Dje(n){var e=hU(n)?n.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var fhe=String.fromCharCode;function Bje(n,e,t){var r="",s;for(t+=e,s=e;s<t;s+=1)r+=fhe(n.getUint8(s));return r}var kje=k0.btoa;function cQ(n,e){for(var t=[],r=8192,s=new Uint8Array(n);s.length>0;)t.push(fhe.apply(null,eV(s.subarray(0,r)))),s=s.subarray(r);return"data:".concat(e,";base64,").concat(kje(t.join("")))}function Oje(n){var e=new DataView(n),t;try{var r,s,o;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var l=e.byteLength,c=2;c+1<l;){if(e.getUint8(c)===255&&e.getUint8(c+1)===225){s=c;break}c+=1}if(s){var a=s+4,d=s+10;if(Bje(e,a,4)==="Exif"){var f=e.getUint16(d);if(r=f===18761,(r||f===19789)&&e.getUint16(d+2,r)===42){var m=e.getUint32(d+4,r);m>=8&&(o=d+m)}}}if(o){var _=e.getUint16(o,r),x,A;for(A=0;A<_;A+=1)if(x=o+A*12+2,e.getUint16(x,r)===274){x+=8,t=e.getUint16(x,r),e.setUint16(x,1,r);break}}}catch{t=1}return t}function Fje(n){var e=0,t=1,r=1;switch(n){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var Nje=/\.\d*(?:0|9){12}\d*$/;function uQ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Nje.test(n)?Math.round(n*e)/e:n}function OA(n){var e=n.aspectRatio,t=n.height,r=n.width,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",o=qL(r),l=qL(t);if(o&&l){var c=t*e;(s==="contain"||s==="none")&&c>r||s==="cover"&&c<r?t=r/e:r=t*e}else o?t=r/e:l&&(r=t*e);return{width:r,height:t}}function zje(n){for(var e=eV(new Uint8Array(n)),t=e.length,r=[],s=0;s+3<t;){var o=e[s],l=e[s+1];if(o===255&&l===218)break;if(o===255&&l===216)s+=2;else{var c=e[s+2]*256+e[s+3],a=s+c+2,d=e.slice(s,a);r.push(d),s=a}}return r.reduce(function(f,m){return m[0]===255&&m[1]===225?f.concat(m):f},[])}function Uje(n,e){var t=eV(new Uint8Array(n));if(t[2]!==255||t[3]!==224)return n;var r=t[4]*256+t[5],s=[255,216].concat(e,t.slice(4+r));return new Uint8Array(s)}var Gje=k0.ArrayBuffer,XN=k0.FileReader,py=k0.URL||k0.webkitURL,Vje=/\.\w+$/,Hje=k0.Compressor,jje=function(){function n(e,t){Tje(this,n),this.file=e,this.exif=[],this.image=new Image,this.options=tP(tP({},lQ),t),this.aborted=!1,this.result=null,this.init()}return Mje(n,[{key:"init",value:function(){var t=this,r=this.file,s=this.options;if(!Ije(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var o=r.type;if(!hU(o)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!py||!XN){this.fail(new Error("The current browser does not support image compression."));return}Gje||(s.checkOrientation=!1,s.retainExif=!1);var l=o==="image/jpeg",c=l&&s.checkOrientation,a=l&&s.retainExif;if(py&&!c&&!a)this.load({url:py.createObjectURL(r)});else{var d=new XN;this.reader=d,d.onload=function(f){var m=f.target,_=m.result,x={},A=1;c&&(A=Oje(_),A>1&&XL(x,Fje(A))),a&&(t.exif=zje(_)),c||a?!py||A>1?x.url=cQ(_,o):x.url=py.createObjectURL(r):x.url=_,t.load(x)},d.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},d.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},d.onloadend=function(){t.reader=null},c||a?d.readAsArrayBuffer(r):d.readAsDataURL(r)}}},{key:"load",value:function(t){var r=this,s=this.file,o=this.image;o.onload=function(){r.draw(tP(tP({},t),{},{naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight}))},o.onabort=function(){r.fail(new Error("Aborted to load the image."))},o.onerror=function(){r.fail(new Error("Failed to load the image."))},k0.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(k0.navigator.userAgent)&&(o.crossOrigin="anonymous"),o.alt=s.name,o.src=t.url}},{key:"draw",value:function(t){var r=this,s=t.naturalWidth,o=t.naturalHeight,l=t.rotate,c=l===void 0?0:l,a=t.scaleX,d=a===void 0?1:a,f=t.scaleY,m=f===void 0?1:f,_=this.file,x=this.image,A=this.options,I=document.createElement("canvas"),E=I.getContext("2d"),C=Math.abs(c)%180===90,L=(A.resize==="contain"||A.resize==="cover")&&qL(A.width)&&qL(A.height),O=Math.max(A.maxWidth,0)||1/0,H=Math.max(A.maxHeight,0)||1/0,q=Math.max(A.minWidth,0)||0,Z=Math.max(A.minHeight,0)||0,J=s/o,re=A.width,se=A.height;if(C){var ae=[H,O];O=ae[0],H=ae[1];var he=[Z,q];q=he[0],Z=he[1];var Ae=[se,re];re=Ae[0],se=Ae[1]}L&&(J=re/se);var Ee=OA({aspectRatio:J,width:O,height:H},"contain");O=Ee.width,H=Ee.height;var Pe=OA({aspectRatio:J,width:q,height:Z},"cover");if(q=Pe.width,Z=Pe.height,L){var ze=OA({aspectRatio:J,width:re,height:se},A.resize);re=ze.width,se=ze.height}else{var Re=OA({aspectRatio:J,width:re,height:se}),rt=Re.width;re=rt===void 0?s:rt;var ye=Re.height;se=ye===void 0?o:ye}re=Math.floor(uQ(Math.min(Math.max(re,q),O))),se=Math.floor(uQ(Math.min(Math.max(se,Z),H)));var We=-re/2,Ue=-se/2,gt=re,vt=se,Dt=[];if(L){var lt=0,jt=0,Qt=s,nn=o,Wn=OA({aspectRatio:J,width:s,height:o},{contain:"cover",cover:"contain"}[A.resize]);Qt=Wn.width,nn=Wn.height,lt=(s-Qt)/2,jt=(o-nn)/2,Dt.push(lt,jt,Qt,nn)}if(Dt.push(We,Ue,gt,vt),C){var kn=[se,re];re=kn[0],se=kn[1]}I.width=re,I.height=se,hU(A.mimeType)||(A.mimeType=_.type);var Mn="transparent";_.size>A.convertSize&&A.convertTypes.indexOf(A.mimeType)>=0&&(A.mimeType="image/jpeg");var De=A.mimeType==="image/jpeg";if(De&&(Mn="#fff"),E.fillStyle=Mn,E.fillRect(0,0,re,se),A.beforeDraw&&A.beforeDraw.call(this,E,I),!this.aborted&&(E.save(),E.translate(re/2,se/2),E.rotate(c*Math.PI/180),E.scale(d,m),E.drawImage.apply(E,[x].concat(Dt)),E.restore(),A.drew&&A.drew.call(this,E,I),!this.aborted)){var Ye=function(un){if(!r.aborted){var At=function(on){return r.done({naturalWidth:s,naturalHeight:o,result:on})};if(un&&De&&A.retainExif&&r.exif&&r.exif.length>0){var en=function(on){return At(aQ(cQ(Uje(on,r.exif),A.mimeType)))};if(un.arrayBuffer)un.arrayBuffer().then(en).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var On=new XN;r.reader=On,On.onload=function(Vn){var on=Vn.target;en(on.result)},On.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},On.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},On.onloadend=function(){r.reader=null},On.readAsArrayBuffer(un)}}else At(un)}};I.toBlob?I.toBlob(Ye,A.mimeType,A.quality):Ye(aQ(I.toDataURL(A.mimeType,A.quality)))}}},{key:"done",value:function(t){var r=t.naturalWidth,s=t.naturalHeight,o=t.result,l=this.file,c=this.image,a=this.options;if(py&&c.src.indexOf("blob:")===0&&py.revokeObjectURL(c.src),o)if(a.strict&&!a.retainExif&&o.size>l.size&&a.mimeType===l.type&&!(a.width>r||a.height>s||a.minWidth>r||a.minHeight>s||a.maxWidth<r||a.maxHeight<s))o=l;else{var d=new Date;o.lastModified=d.getTime(),o.lastModifiedDate=d,o.name=l.name,o.name&&o.type!==l.type&&(o.name=o.name.replace(Vje,Dje(o.type)))}else o=l;this.result=o,a.success&&a.success.call(this,o)}},{key:"fail",value:function(t){var r=this.options;if(r.error)r.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Hje,n}},{key:"setDefaults",value:function(t){XL(lQ,t)}}]),n}();const Wje="/about_portfolio/assets/biaozhun-C5OcRpNC.png",$je="/about_portfolio/assets/target-DS1CVM5s.svg",my=[Oue,Wje,Fue,Iue,Nue,Z8,zue,rU,Pue,W8,Rue,Lue,$8,X8,Uue,$je,Bue,Vue,Hue,jue,Wue,$ue,Xue,que,kue,q8,Y8,Gue,Due],Xje=()=>{const[n,e]=_e.useState(0),t=Array.from({length:my.length}).map(()=>_e.useRef(null)),r=_e.useRef(null);return _e.useEffect(()=>{if(n===1){const s=new IntersectionObserver(o=>{o.forEach(l=>{if(l.isIntersecting){let c=l.target;c.src=c.dataset.src,s.unobserve(c)}})});t.forEach(o=>{o.current&&s.observe(o.current)})}if(n===2&&my.forEach((s,o)=>{fetch(s).then(l=>l.blob()).then(l=>{new jje(l,{quality:.6,maxWidth:600,maxHeight:800,success(c){let a=URL.createObjectURL(c);t[o].current.src=a},error(c){console.log("error in compressor:",c)}})}).catch(l=>console.log("error in fetch:",l))}),n===3){const s=new IntersectionObserver(o=>{o[0].isIntersecting&&(my.forEach((l,c)=>{c>10&&(t[c].current.src=l)}),s.unobserve(r.current))});r.current&&s.observe(r.current)}},[n]),pe.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[pe.jsxs("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""}),pe.jsx("div",{className:"mr-8 text-right",children:pe.jsxs(Tue,{children:[pe.jsxs(H8,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:["",pe.jsx(yje,{className:"size-4 fill-white/60"})]}),pe.jsxs(j8,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[pe.jsx(Xd,{children:pe.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(0),children:['loading="lazy"',pe.jsx(bje,{className:"size-4 fill-white/30"})]})}),pe.jsx(Xd,{children:pe.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(1),children:["IntersectionObserver",pe.jsx(Sje,{className:"size-4 fill-white/30"})]})}),pe.jsx(Xd,{children:pe.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(2),children:["",pe.jsx(vje,{className:"size-4 fill-white/30"})]})}),pe.jsx(Xd,{children:pe.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(3),children:["",pe.jsx(iQ,{className:"size-4 fill-white/30"})]})}),pe.jsx(Xd,{children:pe.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(4),children:["",pe.jsx(iQ,{className:"size-4 fill-white/30"})]})})]})]})})]}),pe.jsx("div",{children:n===0&&my.map((s,o)=>pe.jsx("img",{src:s,alt:"",className:"w-full p-2",loading:"lazy"},o))}),n===1&&pe.jsxs("div",{children:[pe.jsxs("p",{children:[" ","vue@vueuse/core{useIntersectionObserver}dom"," "]}),pe.jsx("p",{children:`useIntersectionObserver(refContent, ([{ isIntersecting }]) => {
    isVisible.value = isIntersecting; });`}),pe.jsx("p",{children:"refContentdomisIntersectingrefdomisVisibleboolean"}),pe.jsx("a",{href:"https://ruanyifeng.com/blog/2016/11/intersectionobserver_api.html",children:""}),my.map((s,o)=>pe.jsx("img",{ref:t[o],"data-src":s,alt:o,className:"w-full p-2"},o))]}),n===2&&pe.jsxs("div",{children:[pe.jsx("p",{children:""}),pe.jsx("p",{children:"compressorjs"}),my.map((s,o)=>pe.jsx("img",{ref:t[o],alt:o,className:"w-full p-2"},o))]}),n===3&&pe.jsxs("div",{children:[pe.jsx("p",{children:"/"}),my.map((s,o)=>pe.jsxs("div",{children:[o<10&&pe.jsx("img",{src:s,alt:o,className:"w-full p-2"},o),o===10&&pe.jsx("p",{ref:r,children:"--------------------------------"}),o>10&&pe.jsx("img",{ref:t[o],alt:o,className:"w-full  p-2"},o)]}))]}),n===4&&pe.jsxs("div",{children:[pe.jsx("div",{children:"* CDN"}),pe.jsx("div",{children:"* "}),pe.jsx("div",{children:"* ElementUIUI"})]})]})},qje=()=>pe.jsxs("div",{className:"absolute top-20 m-4 w-1/2 h-1/2 border-4 border-solid border-cyan-500",children:[pe.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:pe.jsx("p",{className:"whitespace-nowrap overflow-hidden text-ellipsis",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgd               egeeeeeeeeeeeeeeeeee         eeeeeeeeeeeddddddggga    aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),pe.jsx("br",{}),pe.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:pe.jsx("p",{className:"whitespace-normal overflow-hidden break-all",children:"mmliugeojdgas      edrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeee              eeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),pe.jsx("br",{}),pe.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:pe.jsx("p",{className:"overflow-hidden break-all text-ellipsis line-clamp-3",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})})]}),Yje=()=>pe.jsxs("div",{className:"absolute top-20 m-4 w-1/2",children:[pe.jsx("p",{children:"input+buttoninput"}),pe.jsx("br",{}),pe.jsxs("div",{className:"flex",children:[pe.jsx("input",{className:"border-2 flex-grow",type:"text"}),pe.jsx("button",{className:"ml-2",children:"Search"})]})]}),Zje=()=>pe.jsx("div",{className:"absolute left-1/4 top-1/4 w-1/3 h-1/3",children:pe.jsx("div",{className:"split-line",children:"SplitLine"})}),Kje=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"};return pe.jsxs("div",{className:"absolute top-20 p-4 w-full h-full flex flex-wrap content-start",children:[pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"1(,)flex + m-auto"}),pe.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"m-auto",children:"box1"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"2(,)grid + place-items-center"}),pe.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{children:"box2"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"3(,)table-cell + align-middle"}),pe.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{children:"box3"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"4(,) + transform"}),pe.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:"box4"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"5(,)"}),pe.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{children:"box5"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"5-1(,)"}),pe.jsx("div",{className:"flex justify-center items-center border-4 border-solid border-red-500",children:pe.jsx("div",{children:"box5"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"6()flex + m-auto"}),pe.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500 m-auto",children:"box1"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"7()grid + place-items-center"}),pe.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box2"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"8()table-cell + align-middle"}),pe.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box3"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"9() + transform"}),pe.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border-2 border-solid border-green-500",children:"box4"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"10()"}),pe.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box5"})})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"11(),top-1/2 left-1/2 -ml- -mt-"}),pe.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:pe.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -ml-6 -mt-6 border-2 border-solid border-green-500",children:"box1"})})]})]})},Jje=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"},e={"font-size":"10px"},t={transform:"scale(0.83)"};return pe.jsxs("div",{className:"absolute top-20 m-4 w-screen h-full flex",children:[pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"1, "}),pe.jsx("div",{style:e,children:"box1"})]}),pe.jsxs("div",{style:n,children:[pe.jsx("p",{children:"2text-xs + scale(0.83),10/12"}),pe.jsx("div",{className:"text-xs",style:t,children:"box2"})]}),pe.jsx("div",{style:n,children:pe.jsx("p",{children:"3htmlfont-size100pxfont-size1rem"})})]})},Qje=()=>{const n={display:"flex",height:"100px"},e={flex:"0 0 100px",backgroundColor:"red"},t={flexGrow:1,backgroundColor:"yellow"},r={display:"table",width:"100%"},s={display:"table-cell",width:"100px",height:"100px",backgroundColor:"red"},o={display:"table-cell",backgroundColor:"yellow"},l={display:"grid",gridTemplateColumns:"100px auto",gridTemplateRows:"100px"},c={backgroundColor:"red"},a={backgroundColor:"yellow"},d={width:"100%",overflow:"hidden"},f={display:"inline-block",width:"100px",height:"100px",backgroundColor:"red"},m={display:"inline-block",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"},_={width:"100%",overflow:"hidden"},x={display:"inline-block",position:"absolute",left:0,right:0,width:"100px",height:"100px",backgroundColor:"red"},A={display:"inline-block",marginLeft:"100px",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"};return pe.jsxs("div",{className:"absolute w-screen top-20 ",children:[pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: flex; right: flex-grow = 1"}),pe.jsxs("div",{style:n,children:[pe.jsx("div",{style:e,children:"left"}),pe.jsx("div",{style:t,children:"right"})]})]}),pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: grid, grid-template-rows, grid-template-cols;"}),pe.jsxs("div",{style:l,children:[pe.jsx("div",{style:c,children:"left"}),pe.jsx("div",{style:a,children:"right"})]})]}),pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: table,; left/right: table-cell"}),pe.jsxs("div",{style:r,children:[pe.jsx("div",{style:s,children:"left"}),pe.jsx("div",{style:o,children:"right"})]})]}),pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"right: calcwidth"}),pe.jsxs("div",{style:d,children:[pe.jsx("div",{style:f,children:"left"}),pe.jsx("div",{style:m,children:"right"})]})]}),pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"leftabsolute,rightmargin-leftleft"}),pe.jsxs("div",{style:_,children:[pe.jsx("div",{style:x,children:"left"}),pe.jsx("div",{style:A,children:"right"})]})]})]})},e7e=()=>{const n={height:"1px",background:"black",transform:"scaleY(0.5)",transformOrigin:"50% 100%"},e={height:"1px",background:"black",boxShadow:"0 0 0.5px  black"};return _e.useEffect(()=>{document.addEventListener("contextmenu",t=>{t.preventDefault()}),document.addEventListener("selectstart",t=>{t.preventDefault()}),document.addEventListener("copy",t=>{t.preventDefault()}),document.addEventListener("cut",t=>{t.preventDefault()})},[]),pe.jsxs("div",{className:"absolute w-screen top-20 ",children:[pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"transform: scaleY(0.5)"}),pe.jsx("div",{style:n})]}),pe.jsxs("div",{children:[pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"box-shadow"}),pe.jsx("div",{style:e})]}),pe.jsx("div",{children:pe.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""})})]})},t7e=()=>pe.jsx("div",{className:"absolute top-20 w-full text-lg",children:pe.jsx("h1",{children:""})}),n7e=[{title:"-",company_name:"",icon:MMe,iconBg:"#FFFFFF",mainColor:"#008CCB",date:"2021.07-2021.08",points:["",""]},{title:"-",company_name:"AR",icon:CMe,iconBg:"#FFFFFF",mainColor:"#C366A1",date:"2023.07 -2023.08",points:["AR AR ","","Windows AR APP Windows AR AR ","unity c# Lua AR "]},{title:"Web Developer",company_name:"",icon:TMe,iconBg:"#FFFFFF",mainColor:"#2BA6DF",date:"2024.06-2024.08",points:["Developing and maintaining web applications using React.js and other related technologies.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Participating in code reviews and providing constructive feedback to other developers."]},{title:"",company_name:"GIS",icon:EMe,iconBg:"#FFFFFF",mainColor:"#AF2020",date:"2023.09",points:["","","",""]}],r7e=[{name:"619",date:"2019.12",color:"#0076FF"},{name:" ",date:"2020.05",color:"#2B9D4A"},{name:"  ",date:"2020.05",color:"#2B9D4A"},{name:"  ",date:"2020.08",color:"#0076FF"},{name:"567",date:"2020.09",color:"#0076FF"},{name:"",date:"2020.11",color:"#FAC11B"},{name:" ",date:"2020.11",color:"#2B9D4A"},{name:" ",date:"2020.12",color:"#2B9D4A"},{name:"  ",date:"2020.12",color:"#2B9D4A"},{name:"C  ",date:"2020.12",color:"#0076FF"},{name:"  A",date:"2020.12",color:"#0076FF"},{name:" ",date:"2021.03",color:"#2B9D4A"},{name:" ",date:"2021.05",color:"#2B9D4A"},{name:"  ",date:"2021.05",color:"#2B9D4A"},{name:"  ",date:"2021.05",color:"#2B9D4A"},{name:"    ",date:"2021.06",color:"#0076FF"},{name:"  ",date:"2021.08",color:"#0076FF"},{name:"",date:"2021.11",color:"#FAC11B"},{name:"  ",date:"2021.11",color:"#2B9D4A"},{name:"GIS",date:"2021.11",color:"#0076FF"},{name:" ",date:"2021.12",color:"#2B9D4A"},{name:"SuperMap GIS ",date:"2022.01",color:"#2B9D4A"},{name:"  A",date:"2022.03",color:"#0076FF"},{name:"  ",date:"2022.05",color:"#2B9D4A"},{name:"Interdisciplinary Contest In Modeling",date:"2022.05",color:"#2B9D4A"},{name:" C/C++ ",date:"2022.05",color:"#2B9D4A"},{name:"  ",date:"2022.06",color:"#0076FF"},{name:"",date:"2022.11",color:"#FAC11B"},{name:" ",date:"2022.12",color:"#2B9D4A"},{name:"  ",date:"2022.12",color:"#2B9D4A"},{name:"  ",date:"2023.05",color:"#2B9D4A"},{name:"  ",date:"2023.05",color:"#2B9D4A"},{name:"  ",date:"2023.11",color:"#2B9D4A"},{name:"  ",date:"2024.06",color:"#2B9D4A"},{name:"12  ",date:"2024.08",color:"#2B9D4A"},{name:"115 ",date:"2024.09",color:"#0076FF"},{name:"  ",date:"2024.11",color:"#2B9D4A"},{name:" ",date:"2024.11",color:"#2B9D4A"},{name:"",date:"2024.12",color:"#2B9D4A"},{name:"International Cartographic Association Scholarship",date:"2024.12",color:"#2B9D4A"}],i7e=r7e.reverse(),s7e=[{iconUrl:yMe,theme:"btn-back-red",name:"",description:`(2021.10 -2021.12)

KeplerKepler.gl OD 
HTML CSS BootStrap supermap iclient for leaflet SuperMapSuperMap.iserver SQL APIAPIPOI `,link:"https://github.com/youxt-njnu/XuXiaKe"},{iconUrl:xMe,theme:"btn-back-pink",name:"",description:`C#GIS(2021.10 -2021.12) 
dotspatial C# .net GIS  ,,, `,link:"https://github.com/youxt-njnu/ProjectSnapshot/blob/master/c%23%E4%B8%8EGIS%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91-%E5%9C%9F%E5%A3%A4%E5%9B%BE%E6%96%91%E8%AF%86%E5%88%AB%E4%B8%8E%E5%B1%9E%E6%80%A7%E9%A2%84%E6%B5%8B%E7%B3%BB%E7%BB%9F.pdf"},{iconUrl:AMe,theme:"btn-back-green",name:"",description:`(2022.04-2022.06) 

 3D
Mapbox JS JS, Bootstrap Echarts `,link:"https://github.com/youxt-njnu/Milk"},{iconUrl:Die,theme:"btn-back-blue",name:"GIS",description:`GIS WebGIS (2022.10 -2022.12)
Axure QGIS postgresql geoserverJquery Ajax httphttp-server openlayer Mapbox echarts `,link:"https://github.com/youxt-njnu/hgisworkHD"},{iconUrl:SMe,theme:"btn-back-yellow",name:"Flappy Bird",description:`XluaFlappy Birdc#(2023.08-2023.09)
Flappy Bird is a mobile game developed by Vietnamese video game artist and programmer Dong Nguyen. The game is a side-scroller where the player controls a bird, attempting to fly between columns of green pipes without hitting them.`,link:"https://github.com/youxt-njnu/flappy_bird_xlua"},{iconUrl:_Me,theme:"btn-back-black",name:"AR",description:`AR(2023.12-2024.06)
 GISARARAR`,link:"https://mp.weixin.qq.com/s?__biz=MzU4MTc2MDAyNg==&mid=2247484289&idx=1&sn=ca9ab0ac73791c6a453b5d0364130248&chksm=fc6d6a49da4532c55ff74676bd34092d37bd742f1ee040c1740ca72043ab6e9050428ac70ce1&scene=126&sessionid=1724225266#rd"}],_i="/arts/",phe=[{name:"",img:"https://s2.loli.net/2024/10/17/yexj6A8cqVvMKDN.png",path:_i+"sky",component:FMe,type:"",info:""},{name:"",img:"https://dragonir.github.io/3d/static/media/earthDigital.8c221282f247bb724b85.png",path:_i+"earth-digital",component:R4e,type:"",info:"3Dshader..."},{name:"",img:"https://s2.loli.net/2024/10/05/Ypj16zckvyd78Do.png",path:_i+"earth-moving",component:q4e,type:"",info:"geometry"},{name:"",img:"https://s2.loli.net/2024/10/05/WiUuGJ3CbnagLc6.png",path:_i+"light-model",component:Rze,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/18/16FgOsBTyM8NntV.png",path:_i+"descent-3d",component:Dze,type:"ShaderToy",info:"ShaderToy3D"},{name:"",img:"https://s2.loli.net/2024/11/29/53zmKr7wkDXvEOV.png",path:_i+"box-rotate",component:Bze,type:"rotate",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/xOVH39vBsNUohSE.png",path:_i+"multimedia",component:Nze,type:"multimedia",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/oHnINiSMd9mua7z.png",path:_i+"multimedia2",component:Xze,type:"multimedia",info:"gltfdraco"},{name:"",img:"https://s2.loli.net/2024/11/29/D48EJRLzi5kofpw.png",path:_i+"particle",component:AGe,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/36QACaqtnJ5FHyX.png",path:_i+"astronaut-particle",component:CGe,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/MUL51g9qBvkbtiO.png",path:_i+"postprocess-box",component:LGe,type:"",info:""},{name:"RickMorty",img:"https://s2.loli.net/2024/11/29/Sfsr5BiyhOXI7mc.png",path:_i+"rick-morty",component:NGe,type:"",info:""},{name:"ShaderPattern",img:"https://s2.loli.net/2024/11/29/19j8O2X3ofJuT7F.png",path:_i+"shader-pattern",component:GGe,type:"",info:""}],mhe=[{name:"",img:"https://s2.loli.net/2024/10/17/OsrIyLWMmZ6Ezpk.png",path:_i+"mapbox-simple",component:HGe,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/08/tDnLboVM1TEu47K.png",path:_i+"milk-story",component:s8e,type:"",info:""}],ghe=[{name:"CesiumBasic",img:"https://s2.loli.net/2025/12/17/FGDImgwEJaAx7Re.png",path:_i+"cesium-basic",component:zHe,type:"cesium",info:"cesium"},{name:"Imagery",img:"https://s2.loli.net/2025/12/17/NDtUVF8W1AgX4Em.png",path:_i+"imagery",component:UHe,type:"cesium",info:"cesium"},{name:"Entity",img:"https://s2.loli.net/2025/12/23/b5S7ugcBpVYMOZX.png",path:_i+"entity",component:GHe,type:"cesium",info:"cesium entity"},{name:"DataInfo",img:"https://s2.loli.net/2025/12/23/IlCDcrnt2jmHS9d.png",path:_i+"data-info",component:VHe,type:"cesium",info:"cesium "},{name:"ModelColoring",img:"https://s2.loli.net/2026/01/11/6l49GTWd1EsNSDe.png",path:_i+"model-coloring",component:HHe,type:"cesium",info:"cesium "},{name:"EventUsage",img:"https://s2.loli.net/2026/01/13/LeFVN7BzMS63Dm9.png",path:_i+"event-usage",component:jHe,type:"cesium",info:"cesium "},{name:"ImageryAdvanced",img:"https://s2.loli.net/2026/01/13/Qsie6jI4lzqVvaM.png",path:_i+"imagery-advanced",component:WHe,type:"cesium",info:"cesium "},{name:"TdTilesCDB",img:"https://s2.loli.net/2026/01/15/WAZluf2UkT9xXEV.png",path:_i+"td-tiles-cdb",component:$He,type:"cesium",info:"3d tileset"},{name:"CustomWidgets",img:"https://s2.loli.net/2026/01/12/ArhInpg3iLjNcFY.png",path:_i+"custom-widgets",component:qHe,type:"cesium",info:"cesium "},{name:"PhotogrammetryClassify",img:"https://s2.loli.net/2026/01/16/8G6o9h7z4LeUVDM.png",path:_i+"photogrammetry-classify",component:n9e,type:"cesium",info:"shader3d tileset"}],vhe=[{name:"html+css ",img:"https://s2.loli.net/2024/11/16/KmZYDPr6bvtiW5V.png",path:_i+"bar-pie",component:r9e,type:"h5c3",info:""},{name:"CanvasDemo",img:"https://s2.loli.net/2024/11/26/A7GhwiavVftz2P3.png",path:_i+"canvas-demo",component:V9e,type:"canvas",info:"canvas"},{name:"WebglUseage",img:"https://s2.loli.net/2025/02/11/DrYwPM5lGSAb2jf.png",path:_i+"webgl-useage",component:H9e,type:"webgl",info:"webgl"},{name:"roughUsage",img:"https://s2.loli.net/2024/12/14/HNgQxS9EdbOqKnF.png",path:_i+"rough-usage",component:oje,type:"rough",info:""},{name:"randomTree",img:"https://s2.loli.net/2024/12/14/EipXTY8VClbhZ2R.png",path:_i+"random-tree",component:aje,type:"vector2d",info:"vector2d"},{name:"ParametricEquation",img:"https://s2.loli.net/2025/02/11/6Bv1UXZqFPRaCu5.png",path:_i+"parametric-equation",component:lje,type:"parametric",info:""},{name:"CssSecrets",img:"",path:_i+"css-secrets",component:hje,type:"h5c3",info:"css"}],_he=[{name:"",img:"https://s2.loli.net/2024/11/06/ozbCSmLM4FHTfXn.png",path:_i+"holy-grail",component:mje,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/PnIGVfoybwmxq1e.png",path:_i+"hanging",component:pje,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/ZWJEAH8I9XdKyzl.png",path:_i+"float",component:fje,type:"flex",info:"flex wrapflex content"},{name:"",img:"https://s2.loli.net/2024/11/08/KTBDMSPIRjyZtxr.png",path:_i+"split-line",component:Zje,type:"",info:"::before, ::after"},{name:"",img:"https://s2.loli.net/2024/11/16/kpwcFnbIV64gJlo.png",path:_i+"img-load",component:Xje,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/chJoFXtiAQOIZ24.png",path:_i+"vertical-center",component:Kje,type:"css",info:""},{name:"10px",img:"https://s2.loli.net/2024/11/16/6UAxNLktFWEp19D.png",path:_i+"px10",component:Jje,type:"css",info:"10px"},{name:"",img:"https://s2.loli.net/2024/11/16/STwlbGxRraoVyvt.png",path:_i+"multi-line",component:qje,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/TGhwNUIS4juCtAP.png",path:_i+"search-btn",component:Yje,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/27/jt7IVgvzb5Scuk8.png",path:_i+"two-band",component:Qje,type:"css",info:""},{name:"0.5px",img:"https://s2.loli.net/2024/11/27/m5CWc6qbVNaH9GJ.png",path:_i+"line05",component:e7e,type:"css",info:"0.5px+"},{name:"",img:"https://s2.loli.net/2024/11/16/m8LDxkrKYtHVG94.png",path:_i+"draw-poly",component:dje,type:"css",info:"CSS"},{name:"",img:"",path:_i+"web-performance",component:t7e,type:"web",info:""}];var KB={},yhe={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=s(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)e.call(o,c)&&o[c]&&(l=s(l,c));return l}function s(o,l){return l?o?o+" "+l:o+l:o}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(yhe);var xhe=yhe.exports;KB.__esModule=!0;KB.default=void 0;var o7e=tV(_e),Fv=tV(Rie),a7e=tV(xhe);function tV(n){return n&&n.__esModule?n:{default:n}}const bhe=({animate:n=!0,className:e="",layout:t="2-columns",lineColor:r="#FFF",children:s})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",r),o7e.default.createElement("div",{className:(0,a7e.default)(e,"vertical-timeline",{"vertical-timeline--animate":n,"vertical-timeline--two-columns":t==="2-columns","vertical-timeline--one-column-left":t==="1-column"||t==="1-column-left","vertical-timeline--one-column-right":t==="1-column-right"})},s));bhe.propTypes={children:Fv.default.oneOfType([Fv.default.arrayOf(Fv.default.node),Fv.default.node]).isRequired,className:Fv.default.string,animate:Fv.default.bool,layout:Fv.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:Fv.default.string};var l7e=bhe;KB.default=l7e;var JB={};function dU(){return dU=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},dU.apply(this,arguments)}function c7e(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,fU(n,e)}function fU(n,e){return fU=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},fU(n,e)}function u7e(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}var pU=new Map,nP=new WeakMap,hQ=0,whe=void 0;function h7e(n){whe=n}function d7e(n){return n?(nP.has(n)||(hQ+=1,nP.set(n,hQ.toString())),nP.get(n)):"0"}function f7e(n){return Object.keys(n).sort().filter(function(e){return n[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?d7e(n.root):n[e])}).toString()}function p7e(n){var e=f7e(n),t=pU.get(e);if(!t){var r=new Map,s,o=new IntersectionObserver(function(l){l.forEach(function(c){var a,d=c.isIntersecting&&s.some(function(f){return c.intersectionRatio>=f});n.trackVisibility&&typeof c.isVisible>"u"&&(c.isVisible=d),(a=r.get(c.target))==null||a.forEach(function(f){f(d,c)})})},n);s=o.thresholds||(Array.isArray(n.threshold)?n.threshold:[n.threshold||0]),t={id:e,observer:o,elements:r},pU.set(e,t)}return t}function nV(n,e,t,r){if(t===void 0&&(t={}),r===void 0&&(r=whe),typeof window.IntersectionObserver>"u"&&r!==void 0){var s=n.getBoundingClientRect();return e(r,{isIntersecting:r,target:n,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:s,intersectionRect:s,rootBounds:s}),function(){}}var o=p7e(t),l=o.id,c=o.observer,a=o.elements,d=a.get(n)||[];return a.has(n)||a.set(n,d),d.push(e),c.observe(n),function(){d.splice(d.indexOf(e),1),d.length===0&&(a.delete(n),c.unobserve(n)),a.size===0&&(c.disconnect(),pU.delete(l))}}var m7e=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function dQ(n){return typeof n.children!="function"}var YL=function(n){c7e(e,n);function e(r){var s;return s=n.call(this,r)||this,s.node=null,s._unobserveCb=null,s.handleNode=function(o){s.node&&(s.unobserve(),!o&&!s.props.triggerOnce&&!s.props.skip&&s.setState({inView:!!s.props.initialInView,entry:void 0})),s.node=o||null,s.observeNode()},s.handleChange=function(o,l){o&&s.props.triggerOnce&&s.unobserve(),dQ(s.props)||s.setState({inView:o,entry:l}),s.props.onChange&&s.props.onChange(o,l)},s.state={inView:!!r.initialInView,entry:void 0},s}var t=e.prototype;return t.componentDidUpdate=function(s){(s.rootMargin!==this.props.rootMargin||s.root!==this.props.root||s.threshold!==this.props.threshold||s.skip!==this.props.skip||s.trackVisibility!==this.props.trackVisibility||s.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},t.componentWillUnmount=function(){this.unobserve(),this.node=null},t.observeNode=function(){if(!(!this.node||this.props.skip)){var s=this.props,o=s.threshold,l=s.root,c=s.rootMargin,a=s.trackVisibility,d=s.delay,f=s.fallbackInView;this._unobserveCb=nV(this.node,this.handleChange,{threshold:o,root:l,rootMargin:c,trackVisibility:a,delay:d},f)}},t.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},t.render=function(){if(!dQ(this.props)){var s=this.state,o=s.inView,l=s.entry;return this.props.children({inView:o,entry:l,ref:this.handleNode})}var c=this.props,a=c.children,d=c.as,f=u7e(c,m7e);return _e.createElement(d||"div",dU({ref:this.handleNode},f),a)},e}(_e.Component);YL.displayName="InView";YL.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function g7e(n){var e=n===void 0?{}:n,t=e.threshold,r=e.delay,s=e.trackVisibility,o=e.rootMargin,l=e.root,c=e.triggerOnce,a=e.skip,d=e.initialInView,f=e.fallbackInView,m=_e.useRef(),_=_e.useState({inView:!!d}),x=_[0],A=_[1],I=_e.useCallback(function(C){m.current!==void 0&&(m.current(),m.current=void 0),!a&&C&&(m.current=nV(C,function(L,O){A({inView:L,entry:O}),O.isIntersecting&&c&&m.current&&(m.current(),m.current=void 0)},{root:l,rootMargin:o,threshold:t,trackVisibility:s,delay:r},f))},[Array.isArray(t)?t.toString():t,l,o,c,a,s,f,r]);_e.useEffect(function(){!m.current&&x.entry&&!c&&!a&&A({inView:!!d})});var E=[I,x.inView,x.entry];return E.ref=E[0],E.inView=E[1],E.entry=E[2],E}const v7e=Object.freeze(Object.defineProperty({__proto__:null,InView:YL,default:YL,defaultFallbackInView:h7e,observe:nV,useInView:g7e},Symbol.toStringTag,{value:"Module"})),_7e=Ipe(v7e);JB.__esModule=!0;JB.default=void 0;var Nv=rV(_e),Co=rV(Rie),rP=rV(xhe),y7e=_7e;function rV(n){return n&&n.__esModule?n:{default:n}}const She=({children:n="",className:e="",contentArrowStyle:t=null,contentStyle:r=null,date:s="",dateClassName:o="",icon:l=null,iconClassName:c="",iconOnClick:a=null,onTimelineElementClick:d=null,iconStyle:f=null,id:m="",position:_="",style:x=null,textClassName:A="",intersectionObserverProps:I={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:E=!1})=>Nv.default.createElement(y7e.InView,I,({inView:C,ref:L})=>Nv.default.createElement("div",{ref:L,id:m,className:(0,rP.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":_==="left","vertical-timeline-element--right":_==="right","vertical-timeline-element--no-children":n===""}),style:x},Nv.default.createElement(Nv.default.Fragment,null,Nv.default.createElement("span",{style:f,onClick:a,className:(0,rP.default)(c,"vertical-timeline-element-icon",{"bounce-in":C||E,"is-hidden":!(C||E)})},l),Nv.default.createElement("div",{style:r,onClick:d,className:(0,rP.default)(A,"vertical-timeline-element-content",{"bounce-in":C||E,"is-hidden":!(C||E)})},Nv.default.createElement("div",{style:t,className:"vertical-timeline-element-content-arrow"}),n,Nv.default.createElement("span",{className:(0,rP.default)(o,"vertical-timeline-element-date")},s)))));She.propTypes={children:Co.default.oneOfType([Co.default.arrayOf(Co.default.node),Co.default.node]),className:Co.default.string,contentArrowStyle:Co.default.shape({}),contentStyle:Co.default.shape({}),date:Co.default.node,dateClassName:Co.default.string,icon:Co.default.element,iconClassName:Co.default.string,iconStyle:Co.default.shape({}),iconOnClick:Co.default.func,onTimelineElementClick:Co.default.func,id:Co.default.string,position:Co.default.string,style:Co.default.shape({}),textClassName:Co.default.string,visible:Co.default.bool,intersectionObserverProps:Co.default.shape({root:Co.default.object,rootMargin:Co.default.string,threshold:Co.default.number,triggerOnce:Co.default.bool})};var x7e=She;JB.default=x7e;var ZL={VerticalTimeline:KB.default,VerticalTimelineElement:JB.default};const iV=()=>{const{t:n}=kw();return pe.jsxs("section",{className:"cta",children:[pe.jsxs("p",{className:"cta-text",children:[n("contact.info")," ",pe.jsx("br",{className:"sm:block hidden"}),n("contact.btnText")," "]}),pe.jsx(Dm,{to:"/contact",className:"btn",children:n("contact.title")})]})},b7e=()=>{const{t:n}=kw();return pe.jsxs("section",{className:"max-container",children:[pe.jsxs("h1",{className:"head-text",children:[n("greeting")," ",pe.jsxs("span",{className:"blue-gradient_text font-semibold drop-shadow",children:[" ",n("name")," "]})]}),pe.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[pe.jsxs("p",{children:[n("concat")," "]}),pe.jsx("p",{children:n("email")}),pe.jsx("p",{children:n("policy")}),pe.jsx("p",{children:n("research.main")}),pe.jsx("p",{children:pe.jsxs("ul",{class:"list-disc",children:[pe.jsx("li",{children:n("research.gis")}),pe.jsx("li",{children:n("research.fe")}),pe.jsx("li",{children:n("research.ar")}),pe.jsx("li",{children:n("research.future")})]})})]}),pe.jsx("div",{className:"py-8 flex flex-col",children:pe.jsx("h3",{className:"subhead-text",children:""})}),pe.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[pe.jsx("h4",{className:"text-slate-800",children:"GPA:4.22/52019.09~2023.07"}),pe.jsx("p",{children:"GIScience"}),pe.jsx("p",{children:"(99)(96)C++GIS(98)C#GIS(97)GIS(95)"}),pe.jsx("p",{children:"38322021H2021C/C++ "}),pe.jsx("h4",{className:"text-slate-800",children:"2023.09"}),pe.jsx("p",{children:""}),pe.jsx("p",{children:"2024202412"})]}),pe.jsx("div",{className:"py-8 flex flex-col",children:pe.jsx("h3",{className:"subhead-text",children:""})}),pe.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[pe.jsx("h4",{className:"text-slate-800",children:""}),pe.jsx("p",{children:"You, X., Chen, G.*, & Duan, J. Exploring Traffic Planning Networks across Multiple Scales Based on Urban Morphology: A Case Study of Nanjing, China. Journal of Urban Planning and Development. https://doi.org/10.1061/JUPDDM/UPENG-5086."}),pe.jsx("p",{children:"Duan, J., Zhao, Z., Xu, Y., You, X., Yang, F., & Chen, G.* (2024). Spatial distribution characteristics and driving factors of Little Giant enterprises in Chinas megacity clusters based on random forest and MGWR. Land, 13(7), 1105. https://doi.org/10.3390/land13071105."}),pe.jsx("p",{children:"Deng, Z., You, X., Shi, Z., Gao, H., Hu, X., Yu, Z., & Yuan, L.* (2022). Identification of urban functional zones based on the spatial specificity of online car-hailing traffic cycle. ISPRS International Journal of Geo-Information, 11(8), 435. https://doi.org/10.3390/ijgi11080435."}),pe.jsx("h4",{className:"text-slate-800",children:""}),pe.jsx("p",{children:". *,,,,,"}),pe.jsx("p",{children:". *,,,,,,"}),pe.jsx("p",{children:".*,,,,,"}),pe.jsx("p",{children:""})]}),pe.jsx("div",{className:"py-8 flex flex-col",children:pe.jsx("h3",{className:"subhead-text",children:""})}),pe.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[pe.jsxs("p",{children:["2023 AR ",pe.jsx("br",{}),"1. 20802020",pe.jsx("br",{}),"2.  AR ",pe.jsx("br",{}),"3.  AR "]}),pe.jsxs("p",{children:["2020-2023,",pe.jsx("br",{}),"1. ",pe.jsx("br",{}),"2. "]}),pe.jsx("p",{children:"2021-2022"}),pe.jsx("p",{children:"2019-2020AHP-"})]}),pe.jsxs("div",{className:"py-16",children:[pe.jsx("h3",{className:"subhead-text",children:""}),pe.jsx("div",{className:"mt-2 flex flex-col gap-3 text-slate-500 "}),pe.jsx("div",{className:"mt-12 flex",children:pe.jsx(ZL.VerticalTimeline,{layout:"1-column-left",children:i7e.map(e=>pe.jsx(ZL.VerticalTimelineElement,{date:e.date,icon:pe.jsx("div",{className:"flex justify-center items-center w-full h-full",children:pe.jsx("img",{src:vMe,alt:e.name,className:"w-[60%] h-[60%] object-contain"})}),iconStyle:{background:"white"},contentStyle:{borderBottom:"8px",borderStyle:"solid",borderBottomColor:e.color,boxShadow:"none"},children:pe.jsx("div",{children:pe.jsx("h3",{className:"text-black text-xl font-poppins font-semibold",children:e.name})})},e.name))})})]}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsx(iV,{})]})},FA=n=>pe.jsxs("div",{className:"group relative",children:[pe.jsx("div",{className:"relative h-80 w-full overflow-hidden rounded-lg bg-white sm:aspect-h-1 sm:aspect-w-2 lg:aspect-h-1 lg:aspect-w-1 group-hover:opacity-75 sm:h-64",children:pe.jsx("img",{src:n.img,alt:n.name,className:"h-full w-full object-cover object-center"})}),pe.jsx("h3",{className:"mt-1 text-sm text-slate-500",children:pe.jsxs("div",{children:[pe.jsx("span",{className:"absolute inset-0"}),n.type]})}),pe.jsx("p",{className:"mb-3 text-base font-semibold text-slate-900",children:n.info})]}),w7e=()=>pe.jsxs("section",{className:"max-container",children:[pe.jsxs("h1",{className:"head-text",children:[" ",pe.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"ThreeJS"})," Works "]}),pe.jsx("div",{className:"py-10",children:pe.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:pe.jsx("div",{className:"mt-6 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:phe.map((n,e)=>pe.jsx(Dm,{to:n.path,children:pe.jsx(FA,{...n})},e))})})}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsxs("h1",{className:"head-text mt-6",children:[" ",pe.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"Mapbox GL JS"})," Works "]}),pe.jsx("div",{className:"py-10",children:pe.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:pe.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:mhe.map((n,e)=>pe.jsx(Dm,{to:n.path,children:pe.jsx(FA,{...n})},e))})})}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsxs("h1",{className:"head-text mt-6",children:[" ",pe.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"Cesium&Resium "})," Works "]}),pe.jsx("div",{className:"py-10",children:pe.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:pe.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:ghe.map((n,e)=>pe.jsx(Dm,{to:n.path,children:pe.jsx(FA,{...n})},e))})})}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsxs("h1",{className:"head-text mt-6",children:[" ",pe.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:" 2D"})," Visualization "]}),pe.jsx("div",{className:"py-10",children:pe.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:pe.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:vhe.map((n,e)=>pe.jsx(Dm,{to:n.path,children:pe.jsx(FA,{...n})},e))})})}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsxs("h1",{className:"head-text mt-6",children:[" ",pe.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:""}),"  "]}),pe.jsx("div",{className:"py-10",children:pe.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:pe.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:_he.map((n,e)=>pe.jsx(Dm,{to:n.path,children:pe.jsx(FA,{...n})},e))})})}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsx(iV,{})]}),YM={_origin:"https://api.emailjs.com"},S7e=(n,e="https://api.emailjs.com")=>{YM._userID=n,YM._origin=e},Ahe=(n,e,t)=>{if(!n)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class fQ{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const The=(n,e,t={})=>new Promise((r,s)=>{const o=new XMLHttpRequest;o.addEventListener("load",({target:l})=>{const c=new fQ(l);c.status===200||c.text==="OK"?r(c):s(c)}),o.addEventListener("error",({target:l})=>{s(new fQ(l))}),o.open("POST",YM._origin+n,!0),Object.keys(t).forEach(l=>{o.setRequestHeader(l,t[l])}),o.send(e)}),A7e=(n,e,t,r)=>{const s=r||YM._userID;return Ahe(s,n,e),The("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:s,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})},T7e=n=>{let e;if(typeof n=="string"?e=document.querySelector(n):e=n,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},M7e=(n,e,t,r)=>{const s=r||YM._userID,o=T7e(t);Ahe(s,n,e);const l=new FormData(o);return l.append("lib_version","3.11.0"),l.append("service_id",n),l.append("template_id",e),l.append("user_id",s),The("/api/v1.0/email/send-form",l)},C7e={init:S7e,send:A7e,sendForm:M7e},E7e=({type:n,text:e})=>pe.jsx("div",{className:"absolute top-10 left-0 right-0 flex justify-center items-center",children:pe.jsxs("div",{className:`${n==="danger"?"bg-red-800":"bg-blue-800"} p-2 text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex items-center`,role:"alert",children:[pe.jsx("p",{className:`${n==="danger"?"bg-red-500":"bg-blue-500"} flex rounded-full uppercase px-2 py-1 font-semibold mr-3 text-xs`,children:n==="danger"?"Failed":"Success"}),pe.jsxs("p",{className:"mr-2 text-left",children:[" ",e," "]})]})}),I7e=()=>{const[n,e]=_e.useState({show:!1,text:"",type:"danger"});return{alert:n,showAlert:({text:s,type:o="danger"})=>e({show:!0,text:s,type:o}),hideAlert:()=>e({show:!1,text:"",type:"danger"})}},P7e=()=>{const n=_e.useRef(null),[e,t]=_e.useState({name:"",email:"",message:""}),[r,s]=_e.useState(!1),[o,l]=_e.useState("idle"),{alert:c,showAlert:a,hideAlert:d}=I7e(),f=A=>{t({...e,[A.target.name]:A.target.value})},m=()=>{l("walk")},_=()=>{l("idle")},x=A=>{A.preventDefault(),s(!0),l("hit"),C7e.send("service_5bezaam","template_dafnzfi",{from_name:e.name,to_name:"Shealin",from_email:e.email,to_email:"yikeyouIl@gmail.com",message:e.message},"JpbkxBEdlS8faxCrq").then(()=>{s(!1),a({show:!0,text:"Your message has been sent successfully!",type:"success"}),setTimeout(()=>{d(),l("idle"),t({name:"",email:"",message:""})},[3e3])}).catch(I=>{s(!1),l("idle"),console.log(I),a({show:!0,text:"I didn't receive your message",type:"danger"})})};return pe.jsxs("section",{className:"relative flex lg:flex-row flex-col max-container h-[100vh]",children:[c.show&&pe.jsx(E7e,{...c}),pe.jsxs("div",{className:"flex-1 min-w-[50%] flex flex-col",children:[pe.jsx("h1",{className:"head-text",children:"Get in Touch"}),pe.jsxs("form",{action:"",className:"w-full flex flex-col gap-7 mt-14",ref:n,onSubmit:x,children:[pe.jsxs("label",{className:"text-black-500 font-semibold",children:["Name",pe.jsx("input",{type:"text",name:"name",className:"input",placeholder:"John",required:!0,value:e.name,onChange:f,onFocus:m,onBlur:_})]}),pe.jsxs("label",{className:"text-black-500 font-semibold",children:["Email",pe.jsx("input",{type:"email",name:"email",className:"input",placeholder:"John@gmail.com",required:!0,value:e.email,onChange:f,onFocus:m,onBlur:_})]}),pe.jsxs("label",{className:"text-black-500 font-semibold",children:["Your Message",pe.jsx("textarea",{name:"message",rows:"4",className:"textarea",placeholder:"Let me know how I can help you!",required:!0,value:e.message,onChange:f,onFocus:m,onBlur:_})]}),pe.jsx("button",{type:"submit",className:"btn",disabled:r,onFocus:m,onBlur:_,children:r?"Sending...":"Submit"})]})]}),pe.jsx("div",{className:"lg:w-1/2 w-full lg:h-auto md:h-[550px] h-[350px]",children:pe.jsxs(wie,{camera:{position:[0,0,5],fov:75,near:.1,far:1e3},children:[pe.jsx("ambientLight",{intensity:.5}),pe.jsx("directionalLight",{intensity:2.5,position:[0,0,1]}),pe.jsx(_e.Suspense,{fallback:pe.jsx(sG,{}),children:pe.jsx(k4e,{currentAnimation:o,position:[.5,.35,0],rotation:[12.6,-.5,0],scale:[.5,.5,.5]})})]})})]})},R7e="/about_portfolio/assets/sakura-Dh6hhofb.mp3",qN=({text:n,link:e,btnText:t})=>pe.jsxs("div",{className:"info-box",children:[pe.jsx("p",{className:"whitespace-pre-wrap font-medium sm:text-xl text-center",children:n}),pe.jsxs(Dm,{to:e,className:"neo-brutalism-white neo-btn",children:[t,pe.jsx("img",{src:Lie,className:"w-4 h-4 object-contain"})]})]}),L7e=({currentStage:n})=>{const{t:e}=kw();return{1:pe.jsxs("h1",{className:"sm:text-xl sm:leading-snug text-center neo-brutalism-blue py-4 px-8 text-white mx-5",children:[e("greeting")," ",pe.jsx("span",{className:"font-semibold",children:e("name")})," ",pe.jsx("br",{}),e("basicInfo")]}),2:pe.jsx(qN,{text:e("aboutMe.info"),link:"/about",btnText:e("aboutMe.btnText")}),3:pe.jsx(qN,{text:e("projects.info"),link:"/projects",btnText:e("projects.btnText")}),4:pe.jsx(qN,{text:e("contact.info"),link:"/contact",btnText:e("contact.btnText")})}[n]||null};var D7e=Object.defineProperty,B7e=(n,e)=>{for(var t in e)D7e(n,t,{get:e[t],enumerable:!0})},Rw={};B7e(Rw,{assign:()=>z7e,colors:()=>_0,createStringInterpolator:()=>hV,skipAnimation:()=>Lhe,to:()=>Rhe,willAdvance:()=>dV});var sV=XC(),fs=n=>$C(n,sV),oV=XC();fs.write=n=>$C(n,oV);var QB=XC();fs.onStart=n=>$C(n,QB);var aV=XC();fs.onFrame=n=>$C(n,aV);var lV=XC();fs.onFinish=n=>$C(n,lV);var lw=[];fs.setTimeout=(n,e)=>{const t=fs.now()+e,r=()=>{const o=lw.findIndex(l=>l.cancel==r);~o&&lw.splice(o,1),i0-=~o?1:0},s={time:t,handler:n,cancel:r};return lw.splice(Mhe(t),0,s),i0+=1,Che(),s};var Mhe=n=>~(~lw.findIndex(e=>e.time>n)||~lw.length);fs.cancel=n=>{QB.delete(n),aV.delete(n),lV.delete(n),sV.delete(n),oV.delete(n)};fs.sync=n=>{mU=!0,fs.batchedUpdates(n),mU=!1};fs.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function r(...s){e=s,fs.onStart(t)}return r.handler=n,r.cancel=()=>{QB.delete(t),e=null},r};var cV=typeof window<"u"?window.requestAnimationFrame:()=>{};fs.use=n=>cV=n;fs.now=typeof performance<"u"?()=>performance.now():Date.now;fs.batchedUpdates=n=>n();fs.catch=console.error;fs.frameLoop="always";fs.advance=()=>{fs.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Ihe()};var r0=-1,i0=0,mU=!1;function $C(n,e){mU?(e.delete(n),n(0)):(e.add(n),Che())}function Che(){r0<0&&(r0=0,fs.frameLoop!=="demand"&&cV(Ehe))}function k7e(){r0=-1}function Ehe(){~r0&&(cV(Ehe),fs.batchedUpdates(Ihe))}function Ihe(){const n=r0;r0=fs.now();const e=Mhe(r0);if(e&&(Phe(lw.splice(0,e),t=>t.handler()),i0-=e),!i0){k7e();return}QB.flush(),sV.flush(n?Math.min(64,r0-n):16.667),aV.flush(),oV.flush(),lV.flush()}function XC(){let n=new Set,e=n;return{add(t){i0+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return i0-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,i0-=e.size,Phe(e,r=>r(t)&&n.add(r)),i0+=n.size,e=n)}}}function Phe(n,e){n.forEach(t=>{try{e(t)}catch(r){fs.catch(r)}})}function O7e(){}var F7e=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),aa={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function N7e(n,e){if(aa.arr(n)){if(!aa.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}var qm=(n,e)=>n.forEach(e);function gU(n,e,t){if(aa.arr(n)){for(let r=0;r<n.length;r++)e.call(t,n[r],`${r}`);return}for(const r in n)n.hasOwnProperty(r)&&e.call(t,n[r],r)}var iP=n=>aa.und(n)?[]:aa.arr(n)?n:[n],uV=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),hV,Rhe,_0=null,Lhe=!1,dV=O7e,z7e=n=>{n.to&&(Rhe=n.to),n.now&&(fs.now=n.now),n.colors!==void 0&&(_0=n.colors),n.skipAnimation!=null&&(Lhe=n.skipAnimation),n.createStringInterpolator&&(hV=n.createStringInterpolator),n.requestAnimationFrame&&fs.use(n.requestAnimationFrame),n.batchedUpdates&&(fs.batchedUpdates=n.batchedUpdates),n.willAdvance&&(dV=n.willAdvance),n.frameLoop&&(fs.frameLoop=n.frameLoop)},HT=new Set,Ih=[],YN=[],KL=0,fV={get idle(){return!HT.size&&!Ih.length},start(n){KL>n.priority?(HT.add(n),fs.onStart(U7e)):(Dhe(n),fs(vU))},advance:vU,sort(n){if(KL)fs.onFrame(()=>fV.sort(n));else{const e=Ih.indexOf(n);~e&&(Ih.splice(e,1),Bhe(n))}},clear(){Ih=[],HT.clear()}};function U7e(){HT.forEach(Dhe),HT.clear(),fs(vU)}function Dhe(n){Ih.includes(n)||Bhe(n)}function Bhe(n){Ih.splice(G7e(Ih,e=>e.priority>n.priority),0,n)}function vU(n){const e=YN;for(let t=0;t<Ih.length;t++){const r=Ih[t];KL=r.priority,r.idle||(dV(r),r.advance(n),r.idle||e.push(r))}return KL=0,YN=Ih,YN.length=0,Ih=e,Ih.length>0}function G7e(n,e){const t=n.findIndex(e);return t<0?n.length:t}var V7e={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Zd="[-+]?\\d*\\.?\\d+",JL=Zd+"%";function ek(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}var H7e=new RegExp("rgb"+ek(Zd,Zd,Zd)),j7e=new RegExp("rgba"+ek(Zd,Zd,Zd,Zd)),W7e=new RegExp("hsl"+ek(Zd,JL,JL)),$7e=new RegExp("hsla"+ek(Zd,JL,JL,Zd)),X7e=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,q7e=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Y7e=/^#([0-9a-fA-F]{6})$/,Z7e=/^#([0-9a-fA-F]{8})$/;function K7e(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=Y7e.exec(n))?parseInt(e[1]+"ff",16)>>>0:_0&&_0[n]!==void 0?_0[n]:(e=H7e.exec(n))?(lb(e[1])<<24|lb(e[2])<<16|lb(e[3])<<8|255)>>>0:(e=j7e.exec(n))?(lb(e[1])<<24|lb(e[2])<<16|lb(e[3])<<8|gQ(e[4]))>>>0:(e=X7e.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Z7e.exec(n))?parseInt(e[1],16)>>>0:(e=q7e.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=W7e.exec(n))?(pQ(mQ(e[1]),sP(e[2]),sP(e[3]))|255)>>>0:(e=$7e.exec(n))?(pQ(mQ(e[1]),sP(e[2]),sP(e[3]))|gQ(e[4]))>>>0:null}function ZN(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function pQ(n,e,t){const r=t<.5?t*(1+e):t+e-t*e,s=2*t-r,o=ZN(s,r,n+1/3),l=ZN(s,r,n),c=ZN(s,r,n-1/3);return Math.round(o*255)<<24|Math.round(l*255)<<16|Math.round(c*255)<<8}function lb(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function mQ(n){return(parseFloat(n)%360+360)%360/360}function gQ(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function sP(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function vQ(n){let e=K7e(n);if(e===null)return n;e=e||0;const t=(e&4278190080)>>>24,r=(e&16711680)>>>16,s=(e&65280)>>>8,o=(e&255)/255;return`rgba(${t}, ${r}, ${s}, ${o})`}var ZM=(n,e,t)=>{if(aa.fun(n))return n;if(aa.arr(n))return ZM({range:n,output:e,extrapolate:t});if(aa.str(n.output[0]))return hV(n);const r=n,s=r.output,o=r.range||[0,1],l=r.extrapolateLeft||r.extrapolate||"extend",c=r.extrapolateRight||r.extrapolate||"extend",a=r.easing||(d=>d);return d=>{const f=Q7e(d,o);return J7e(d,o[f],o[f+1],s[f],s[f+1],a,l,c,r.map)}};function J7e(n,e,t,r,s,o,l,c,a){let d=a?a(n):n;if(d<e){if(l==="identity")return d;l==="clamp"&&(d=e)}if(d>t){if(c==="identity")return d;c==="clamp"&&(d=t)}return r===s?r:e===t?n<=e?r:s:(e===-1/0?d=-d:t===1/0?d=d-e:d=(d-e)/(t-e),d=o(d),r===-1/0?d=-d:s===1/0?d=d+r:d=d*(s-r)+r,d)}function Q7e(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}var KM=Symbol.for("FluidValue.get"),JM=Symbol.for("FluidValue.observers"),QL=n=>!!(n&&n[KM]),eD=n=>n&&n[KM]?n[KM]():n;function eWe(n,e){n.eventObserved?n.eventObserved(e):n(e)}function _U(n,e){const t=n[JM];t&&t.forEach(r=>{eWe(r,e)})}var tWe=class{constructor(n){if(!n&&!(n=this.get))throw Error("Unknown getter");nWe(this,n)}},nWe=(n,e)=>Ohe(n,KM,e);function khe(n,e){if(n[KM]){let t=n[JM];t||Ohe(n,JM,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function yU(n,e){const t=n[JM];if(t&&t.has(e)){const r=t.size-1;r?t.delete(e):n[JM]=null,n.observerRemoved&&n.observerRemoved(r,e)}}var Ohe=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),zP=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rWe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,_Q=new RegExp(`(${zP.source})(%|[a-z]+)`,"i"),iWe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,tk=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Fhe=n=>{const[e,t]=sWe(n);if(!e||uV())return n;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(t&&t.startsWith("--")){const s=window.getComputedStyle(document.documentElement).getPropertyValue(t);return s||n}else{if(t&&tk.test(t))return Fhe(t);if(t)return t}return n},sWe=n=>{const e=tk.exec(n);if(!e)return[,];const[,t,r]=e;return[t,r]},KN,oWe=(n,e,t,r,s)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(r)}, ${s})`,Nhe=n=>{KN||(KN=_0?new RegExp(`(${Object.keys(_0).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(o=>eD(o).replace(tk,Fhe).replace(rWe,vQ).replace(KN,vQ)),t=e.map(o=>o.match(zP).map(Number)),s=t[0].map((o,l)=>t.map(c=>{if(!(l in c))throw Error('The arity of each "output" value must be equal');return c[l]})).map(o=>ZM({...n,output:o}));return o=>{var a;const l=!_Q.test(e[0])&&((a=e.find(d=>_Q.test(d)))==null?void 0:a.replace(zP,""));let c=0;return e[0].replace(zP,()=>`${s[c++](o)}${l||""}`).replace(iWe,oWe)}},zhe="react-spring: ",Uhe=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${zhe}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},aWe=Uhe(console.warn);function lWe(){aWe(`${zhe}The "interpolate" function is deprecated in v9 (use "to" instead)`)}Uhe(console.warn);function Ghe(n){return aa.str(n)&&(n[0]=="#"||/\d/.test(n)||!uV()&&tk.test(n)||n in(_0||{}))}var Vhe=uV()?_e.useEffect:_e.useLayoutEffect,cWe=()=>{const n=_e.useRef(!1);return Vhe(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function uWe(){const n=_e.useState()[1],e=cWe();return()=>{e.current&&n(Math.random())}}function hWe(n,e){const[t]=_e.useState(()=>({inputs:e,result:n()})),r=_e.useRef(),s=r.current;let o=s;return o?e&&o.inputs&&dWe(e,o.inputs)||(o={inputs:e,result:n()}):o=t,_e.useEffect(()=>{r.current=o,s==t&&(t.inputs=t.result=void 0)},[o]),o.result}function dWe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var fWe=n=>_e.useEffect(n,pWe),pWe=[],QM=Symbol.for("Animated:node"),mWe=n=>!!n&&n[QM]===n,pV=n=>n&&n[QM],Hhe=(n,e)=>F7e(n,QM,e),mV=n=>n&&n[QM]&&n[QM].getPayload(),jhe=class{constructor(){Hhe(this,this)}getPayload(){return this.payload||[]}},nk=class extends jhe{constructor(n){super(),this._value=n,this.done=!0,this.durationProgress=0,aa.num(this._value)&&(this.lastPosition=this._value)}static create(n){return new nk(n)}getPayload(){return[this]}getValue(){return this._value}setValue(n,e){return aa.num(n)&&(this.lastPosition=n,e&&(n=Math.round(n/e)*e,this.done&&(this.lastPosition=n))),this._value===n?!1:(this._value=n,!0)}reset(){const{done:n}=this;this.done=!1,aa.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,n&&(this.lastVelocity=null),this.v0=null)}},gV=class extends nk{constructor(n){super(0),this._string=null,this._toString=ZM({output:[n,n]})}static create(n){return new gV(n)}getValue(){const n=this._string;return n??(this._string=this._toString(this._value))}setValue(n){if(aa.str(n)){if(n==this._string)return!1;this._string=n,this._value=1}else if(super.setValue(n))this._string=null;else return!1;return!0}reset(n){n&&(this._toString=ZM({output:[this.getValue(),n]})),this._value=0,super.reset()}},tD={dependencies:null},vV=class extends jhe{constructor(n){super(),this.source=n,this.setValue(n)}getValue(n){const e={};return gU(this.source,(t,r)=>{mWe(t)?e[r]=t.getValue(n):QL(t)?e[r]=eD(t):n||(e[r]=t)}),e}setValue(n){this.source=n,this.payload=this._makePayload(n)}reset(){this.payload&&qm(this.payload,n=>n.reset())}_makePayload(n){if(n){const e=new Set;return gU(n,this._addToPayload,e),Array.from(e)}}_addToPayload(n){tD.dependencies&&QL(n)&&tD.dependencies.add(n);const e=mV(n);e&&qm(e,t=>this.add(t))}},Whe=class extends vV{constructor(n){super(n)}static create(n){return new Whe(n)}getValue(){return this.source.map(n=>n.getValue())}setValue(n){const e=this.getPayload();return n.length==e.length?e.map((t,r)=>t.setValue(n[r])).some(Boolean):(super.setValue(n.map(gWe)),!0)}};function gWe(n){return(Ghe(n)?gV:nk).create(n)}function vWe(n){const e=pV(n);return e?e.constructor:aa.arr(n)?Whe:Ghe(n)?gV:nk}var yQ=(n,e)=>{const t=!aa.fun(n)||n.prototype&&n.prototype.isReactComponent;return _e.forwardRef((r,s)=>{const o=_e.useRef(null),l=t&&_e.useCallback(A=>{o.current=xWe(s,A)},[s]),[c,a]=yWe(r,e),d=uWe(),f=()=>{const A=o.current;if(t&&!A)return;(A?e.applyAnimatedValues(A,c.getValue(!0)):!1)===!1&&d()},m=new _We(f,a),_=_e.useRef();Vhe(()=>(_.current=m,qm(a,A=>khe(A,m)),()=>{_.current&&(qm(_.current.deps,A=>yU(A,_.current)),fs.cancel(_.current.update))})),_e.useEffect(f,[]),fWe(()=>()=>{const A=_.current;qm(A.deps,I=>yU(I,A))});const x=e.getComponentProps(c.getValue());return _e.createElement(n,{...x,ref:l})})},_We=class{constructor(n,e){this.update=n,this.deps=e}eventObserved(n){n.type=="change"&&fs.write(this.update)}};function yWe(n,e){const t=new Set;return tD.dependencies=t,n.style&&(n={...n,style:e.createAnimatedStyle(n.style)}),n=new vV(n),tD.dependencies=null,[n,t]}function xWe(n,e){return n&&(aa.fun(n)?n(e):n.current=e),e}var xQ=Symbol.for("AnimatedComponent"),bWe=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=s=>new vV(s),getComponentProps:r=s=>s}={})=>{const s={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:r},o=l=>{const c=bQ(l)||"Anonymous";return aa.str(l)?l=o[l]||(o[l]=yQ(l,s)):l=l[xQ]||(l[xQ]=yQ(l,s)),l.displayName=`Animated(${c})`,l};return gU(n,(l,c)=>{aa.arr(n)&&(c=bQ(l)),o[c]=o(l)}),{animated:o}},bQ=n=>aa.str(n)?n:n&&aa.str(n.displayName)?n.displayName:aa.fun(n)&&n.name||null,wQ=n=>n instanceof $he,wWe=1,$he=class extends tWe{constructor(){super(...arguments),this.id=wWe++,this._priority=0}get priority(){return this._priority}set priority(n){this._priority!=n&&(this._priority=n,this._onPriorityChange(n))}get(){const n=pV(this);return n&&n.getValue()}to(...n){return Rw.to(this,n)}interpolate(...n){return lWe(),Rw.to(this,n)}toJSON(){return this.get()}observerAdded(n){n==1&&this._attach()}observerRemoved(n){n==0&&this._detach()}_attach(){}_detach(){}_onChange(n,e=!1){_U(this,{type:"change",parent:this,value:n,idle:e})}_onPriorityChange(n){this.idle||fV.sort(this),_U(this,{type:"priority",parent:this,priority:n})}},_V=({children:n,...e})=>{const t=_e.useContext(nD),r=e.pause||!!t.pause,s=e.immediate||!!t.immediate;e=hWe(()=>({pause:r,immediate:s}),[r,s]);const{Provider:o}=nD;return _e.createElement(o,{value:e},n)},nD=SWe(_V,{});_V.Provider=nD.Provider;_V.Consumer=nD.Consumer;function SWe(n,e){return Object.assign(n,_e.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}var AWe=class extends $he{constructor(n,e){super(),this.source=n,this.idle=!0,this._active=new Set,this.calc=ZM(...e);const t=this._get(),r=vWe(t);Hhe(this,r.create(t))}advance(n){const e=this._get(),t=this.get();N7e(e,t)||(pV(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&SQ(this._active)&&JN(this)}_get(){const n=aa.arr(this.source)?this.source.map(eD):iP(eD(this.source));return this.calc(...n)}_start(){this.idle&&!SQ(this._active)&&(this.idle=!1,qm(mV(this),n=>{n.done=!1}),Rw.skipAnimation?(fs.batchedUpdates(()=>this.advance()),JN(this)):fV.start(this))}_attach(){let n=1;qm(iP(this.source),e=>{QL(e)&&khe(e,this),wQ(e)&&(e.idle||this._active.add(e),n=Math.max(n,e.priority+1))}),this.priority=n,this._start()}_detach(){qm(iP(this.source),n=>{QL(n)&&yU(n,this)}),this._active.clear(),JN(this)}eventObserved(n){n.type=="change"?n.idle?this.advance():(this._active.add(n.parent),this._start()):n.type=="idle"?this._active.delete(n.parent):n.type=="priority"&&(this.priority=iP(this.source).reduce((e,t)=>Math.max(e,(wQ(t)?t.priority:0)+1),0))}};function TWe(n){return n.idle!==!1}function SQ(n){return!n.size||Array.from(n).every(TWe)}function JN(n){n.idle||(n.idle=!0,qm(mV(n),e=>{e.done=!0}),_U(n,{type:"idle",parent:n}))}Rw.assign({createStringInterpolator:Nhe,to:(n,e)=>new AWe(n,e)});var MWe=["primitive"].concat(Object.keys(Zre).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));Rw.assign({createStringInterpolator:Nhe,colors:V7e,frameLoop:"demand"});YAe(()=>{fs.advance()});var CWe=bWe(MWe,{applyAnimatedValues:wy}),EWe=CWe.animated;const IWe="/about_portfolio/assets/island-BN767CUw.glb",PWe=({isRotating:n,setIsRotating:e,setCurrentStage:t,...r})=>{const s=_e.useRef(),{gl:o,viewport:l}=mie(),{nodes:c,materials:a}=fg(IWe),d=_e.useRef(0),f=_e.useRef(0),m=.95,_=C=>{C.stopPropagation(),C.preventDefault(),e(!0);const L=C.touches?C.touches[0].clientX:C.clientX;d.current=L},x=C=>{C.stopPropagation(),C.preventDefault(),e(!1)},A=C=>{if(C.stopPropagation(),C.preventDefault(),n){const L=C.touches?C.touches[0].clientX:C.clientX,O=(L-d.current)/l.width;s.current.rotation.y+=O*.01*Math.PI,d.current=L,f.current=O*.01*Math.PI}},I=C=>{C.key==="ArrowLeft"?(n||e(!0),s.current.rotation.y+=.01*Math.PI,f.current=.0125):C.key==="ArrowRight"&&(n||e(!0),s.current.rotation.y-=.01*Math.PI,f.current=-.0125)},E=C=>{(C.key==="ArrowLeft"||C.key==="ArrowRight")&&e(!1)};return MC(()=>{if(!n)f.current*=m,Math.abs(f.current)<.001&&(f.current=0),s.current.rotation.y+=f.current;else{const L=(s.current.rotation.y%(2*Math.PI)+2*Math.PI)%(2*Math.PI);switch(!0){case(L>=5.45&&L<=5.85):t(4);break;case(L>=.85&&L<=1.3):t(3);break;case(L>=2.4&&L<=2.6):t(2);break;case(L>=4.25&&L<=4.75):t(1);break;default:t(null)}}}),_e.useEffect(()=>{const C=o.domElement;return C.addEventListener("pointerdown",_),C.addEventListener("pointerup",x),C.addEventListener("pointermove",A),document.addEventListener("keydown",I),document.addEventListener("keyup",E),()=>{C.removeEventListener("pointerdown",_),C.removeEventListener("pointerup",x),C.removeEventListener("pointermove",A),document.removeEventListener("keydown",I),document.removeEventListener("keyup",E)}},[o,_,x,A]),pe.jsxs(EWe.group,{ref:s,...r,children:[pe.jsx("mesh",{geometry:c.polySurface944_tree_body_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.polySurface945_tree1_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.polySurface946_tree2_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.polySurface947_tree1_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.polySurface948_tree_body_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.polySurface949_tree_body_0.geometry,material:a.PaletteMaterial001}),pe.jsx("mesh",{geometry:c.pCube11_rocks1_0.geometry,material:a.PaletteMaterial001})]})},RWe="/about_portfolio/assets/plane-Dk3bBBjR.glb",LWe=({isRotating:n,...e})=>{const t=_e.useRef(),{scene:r,animations:s}=fg(RWe),{actions:o}=iG(s,t);return _e.useEffect(()=>{n?o["Take 001"].play():o["Take 001"].stop()},[o,n]),pe.jsx("mesh",{...e,ref:t,children:pe.jsx("primitive",{object:r})})},DWe="/about_portfolio/assets/sky-B0A1kvoP.glb",BWe=({isRotating:n})=>{const e=fg(DWe),t=_e.useRef();return MC((r,s)=>{n&&(t.current.rotation.y+=.15*s)}),pe.jsx("mesh",{ref:t,children:pe.jsx("primitive",{object:e.scene})})},kWe=()=>{const n=_e.useRef(new Audio(R7e));n.current.volume=.4,n.current.loop=!0;const[e,t]=_e.useState(!1),[r,s]=_e.useState(1),[o,l]=_e.useState(!1);_e.useEffect(()=>(o&&n.current.play(),()=>{n.current.pause()}),[o]);const c=()=>{let A=null,I=[0,7.5,-43],E=[.1,4.7,0];return window.innerWidth<768?A=[.2,.2,.2]:A=[.4,.4,.4],[A,I,E]},[a,d,f]=c(),m=()=>{let A,I;return window.innerWidth<768?(A=[1.5,1.5,1.5],I=[2,0,-1]):(A=[3,3,3],I=[8,0,-4]),[A,I]},[_,x]=m();return pe.jsxs("section",{className:"w-full h-screen relative",children:[pe.jsxs("div",{className:"absolute top-28 left-0 right-0 z-10 flex items-center justify-center",children:[r&&pe.jsx(L7e,{currentStage:r})," "]}),pe.jsx(wie,{className:`w-full h-screen bg-transparent ${e?"cursor-grabbing":"cursor-grab"} `,camera:{near:.1,far:1e3},children:pe.jsxs(_e.Suspense,{fallback:pe.jsx(sG,{}),children:[pe.jsx("directionalLight",{position:[1,1,1],intensity:2}),pe.jsx("ambientLight",{intensity:.5}),pe.jsx("hemisphereLight",{skyColor:"#b1e1ff",groundColor:"#000000",intensity:1}),pe.jsx(D4e,{}),pe.jsx(LWe,{scale:_,position:x,isRotating:e,rotation:[10,0,10]}),pe.jsx(BWe,{isRotating:e}),pe.jsx(PWe,{position:d,scale:a,rotation:f,isRotating:e,setIsRotating:t,setCurrentStage:s}),pe.jsx(F4e,{rotation:[.1,90,0],position:[0,-10,-80],scale:[.6,.6,.6]})]})}),pe.jsx("div",{className:"absolute bottom-2 left-2",children:pe.jsx("img",{src:o?wMe:bMe,alt:"sound",className:"w-10 h-10 cursor-pointer object-contain",onClick:()=>l(!o)})})]})},OWe=()=>{const{t:n}=kw();return pe.jsxs("section",{className:"max-container",children:[pe.jsxs("h1",{className:"head-text",children:[n("projects.fr"),pe.jsxs("span",{className:"blue-gradient_text font-semibold drop-shadow",children:[" ",n("projects.ed")]})]}),pe.jsx("div",{className:"mt-5 flex flex-col gap-3 text-slate-500",children:pe.jsx("p",{children:n("projects.basicIntro")})}),pe.jsx("div",{className:"flex flex-wrap my-20 gap-16",children:s7e.map(e=>pe.jsxs("div",{className:"lg:w=[400px] w-full",children:[pe.jsxs("div",{className:"block-container w-12 h-12",children:[pe.jsx("div",{className:`btn-back rounded-xl ${e.theme}`}),pe.jsx("div",{className:"btn-front rounded-xl flex justify-center items-center",children:pe.jsx("img",{src:e.iconUrl,alt:"Project Icon",className:"w-1/2 h-1/2 object-contain"})})]}),pe.jsxs("div",{className:"mt-5 flex flex-col",children:[pe.jsx("h4",{className:"text-2xl font-poppins font-semibold",children:e.name}),pe.jsx("p",{className:"whitespace-pre-wrap mt-2 text-slate-500",children:e.description}),pe.jsxs("div",{className:"mt-5 flex items-center gap-2 font-poppins",children:[pe.jsx(Dm,{to:e.link,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-blue-600",children:"Live Link"}),pe.jsx("img",{src:Lie,alt:"arrow",className:"w-4 h-4 object-contain"})]})]})]},e.name))}),pe.jsxs("div",{className:"py-16",children:[pe.jsx("h3",{className:"subhead-text",children:""}),pe.jsx("div",{className:"mt-2 flex flex-col gap-3 text-slate-500 "}),pe.jsx("div",{className:"mt-12 flex",children:pe.jsx(ZL.VerticalTimeline,{children:n7e.map(e=>pe.jsxs(ZL.VerticalTimelineElement,{date:e.date,icon:pe.jsx("div",{className:"flex justify-center items-center w-full h-full",children:pe.jsx("img",{src:e.icon,alt:e.company_name,className:"w-[60%] h-[60%] object-contain"})}),iconStyle:{background:e.iconBg},contentStyle:{borderBottom:"8px",borderStyle:"solid",borderBottomColor:e.mainColor,boxShadow:"none"},children:[pe.jsxs("div",{children:[pe.jsx("h3",{className:"text-black text-xl font-poppins font-semibold",children:e.title}),pe.jsx("p",{className:"text-black-500 font-medium font-base",style:{margin:0},children:e.company_name})]}),pe.jsx("ul",{className:"my-5 list-disc ml-5 space-y-2",children:e.points.map((t,r)=>pe.jsx("li",{className:"text-black-500/50 font-normal pl-1 text-sm",children:t},`experience-point-${r}`))})]},e.company_name))})})]}),pe.jsx("hr",{className:"border-slate-200"}),pe.jsx(iV,{})]})},FWe=()=>{const{i18n:n}=kw(),e=s=>{n.changeLanguage(s),r(s==="zh")},[t,r]=_e.useState(!0);return pe.jsx("button",{className:"fixed bottom-5 right-5 rounded-lg bg-white items-center justify-center flex font-bold shadow-md px-3 py-2",onClick:()=>e(t?"en":"zh"),children:pe.jsx("p",{className:"blue-gradient_text",children:t?"Change to English":""})})},NWe=()=>pe.jsxs("main",{className:"bg-slate-300/20 h-full",children:[pe.jsxs(C0e,{basename:"/about_portfolio",children:[pe.jsx(gMe,{}),pe.jsx(_e.Suspense,{fallback:pe.jsx(sG,{}),children:pe.jsxs(x0e,{children:[pe.jsx(Od,{path:"/",element:pe.jsx(kWe,{})}),pe.jsx(Od,{path:"/about",element:pe.jsx(b7e,{})}),pe.jsx(Od,{path:"/projects",element:pe.jsx(OWe,{})}),pe.jsx(Od,{path:"/arts",element:pe.jsx(w7e,{})}),phe.map((n,e)=>pe.jsx(Od,{path:n.path,element:pe.jsx(n.component,{})},e)),mhe.map((n,e)=>pe.jsx(Od,{path:n.path,element:pe.jsx(n.component,{})},e)),vhe.map((n,e)=>pe.jsx(Od,{path:n.path,element:pe.jsx(n.component,{})},e)),_he.map((n,e)=>pe.jsx(Od,{path:n.path,element:pe.jsx(n.component,{})},e)),ghe.map((n,e)=>pe.jsx(Od,{path:n.path,element:pe.jsx(n.component,{})},e)),pe.jsx(Od,{path:"/contact",element:pe.jsx(P7e,{})})]})})]}),pe.jsx(FWe,{})]}),zWe="Hello, I am",UWe="Shealin",GWe="a graduate student from Nanjing, China (currently...)",VWe="+86-15651736857",HWe="you_yxt@163.com",jWe="communist",WWe={main:"Urban Geography, Traffic Planning and Analysis, Story Maps, AR Maps",gis:"GIS developer: QGISGeoserverPostgreSQL&PostGIS",fe:"Front End 3Dhtml&css&js, nodejs, react; BootStrap, ECharts; ThreeJS, Cesium, WebGL",ar:"ARVuforiaU3DMapbox SDK for UnityLua",future:"I have a background in GIS, Augmented Reality and front end, so this is like the perfect place for me."},$We={title:"Student life",info:"I have a lot of experiences in studying and researching, and I am constantly improving myself...",btnText:"Learn more"},XWe={title:"Projects",info:"I have written interesting projects by myself, and have worked with multiple teams...",btnText:"View projects",fr:"My",ed:"Projects and Internship",basicIntro:"I've embarked on numerous projects throughout the years, but these are the ones I hold closest to my heart. Many of them are open-source, so if you come across something that piques your interest, feel free to explore the codebase and contribute your ideas for further enhancements. You collaboration is highly valued!"},qWe={title:"Contact",info:"If you are interested in me, please feel free to contact me...",btnText:"Let's talk"},YWe={title:"Gallery"},ZWe={greeting:zWe,name:UWe,basicInfo:GWe,concat:VWe,email:HWe,policy:jWe,research:WWe,aboutMe:$We,projects:XWe,contact:qWe,gallery:YWe},KWe="",JWe="",QWe="/+86-15651736857",e$e="you_yxt@163.com",t$e="(...)",n$e="",r$e={main:"AR",gis:"GISArcGIS/QGISGeoserverPostgreSQL&PostGIS",fe:"3Dhtml&css&js, nodejs, react; BootStrap, ECharts; ThreeJS, Cesium, WebGL",ar:"ARVuforiaU3DMapbox SDK for UnityLua",future:""},i$e={title:"",info:"...",btnText:""},s$e={title:"",info:"...",btnText:"",fr:"",ed:"",basicIntro:""},o$e={title:"",info:"?",btnText:""},a$e={title:""},l$e={greeting:KWe,name:JWe,concat:QWe,email:e$e,basicInfo:t$e,policy:n$e,research:r$e,aboutMe:i$e,projects:s$e,contact:o$e,gallery:a$e},AQ=()=>{const n=new MutationObserver(()=>{document.querySelectorAll(".cesium-infoBox-iframe").forEach(t=>{t.hasAttribute("data-sandbox-fixed")||(t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation"),t.setAttribute("data-sandbox-fixed","true"))})});return n.observe(document.body,{childList:!0,subtree:!0}),n},c$e=()=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",AQ):AQ()};Pl.init({interpolation:{escapeValue:!1},lng:"zh",resources:{en:{translation:ZWe},zh:{translation:l$e}}});c$e();e4.createRoot(document.getElementById("root")).render(pe.jsx(Lve,{i18n:Pl,children:pe.jsx(NWe,{})}))});export default u$e();
