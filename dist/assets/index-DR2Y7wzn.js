var sde=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var K7e=sde(tA=>{function ode(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var ade=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function SL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function lde(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var _J={exports:{}},AL={},yJ={exports:{}},qi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ET=Symbol.for("react.element"),cde=Symbol.for("react.portal"),ude=Symbol.for("react.fragment"),hde=Symbol.for("react.strict_mode"),fde=Symbol.for("react.profiler"),dde=Symbol.for("react.provider"),pde=Symbol.for("react.context"),mde=Symbol.for("react.forward_ref"),gde=Symbol.for("react.suspense"),vde=Symbol.for("react.memo"),_de=Symbol.for("react.lazy"),YV=Symbol.iterator;function yde(n){return n===null||typeof n!="object"?null:(n=YV&&n[YV]||n["@@iterator"],typeof n=="function"?n:null)}var xJ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bJ=Object.assign,wJ={};function dw(n,e,t){this.props=n,this.context=e,this.refs=wJ,this.updater=t||xJ}dw.prototype.isReactComponent={};dw.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};dw.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function SJ(){}SJ.prototype=dw.prototype;function Lz(n,e,t){this.props=n,this.context=e,this.refs=wJ,this.updater=t||xJ}var Dz=Lz.prototype=new SJ;Dz.constructor=Lz;bJ(Dz,dw.prototype);Dz.isPureReactComponent=!0;var KV=Array.isArray,AJ=Object.prototype.hasOwnProperty,Bz={current:null},TJ={key:!0,ref:!0,__self:!0,__source:!0};function MJ(n,e,t){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)AJ.call(e,r)&&!TJ.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var o=Array(l),h=0;h<l;h++)o[h]=arguments[h+2];i.children=o}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:ET,type:n,key:s,ref:a,props:i,_owner:Bz.current}}function xde(n,e){return{$$typeof:ET,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function kz(n){return typeof n=="object"&&n!==null&&n.$$typeof===ET}function bde(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var JV=/\/+/g;function O4(n,e){return typeof n=="object"&&n!==null&&n.key!=null?bde(""+n.key):e.toString(36)}function DI(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case ET:case cde:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+O4(a,0):r,KV(i)?(t="",n!=null&&(t=n.replace(JV,"$&/")+"/"),DI(i,e,t,"",function(h){return h})):i!=null&&(kz(i)&&(i=xde(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(JV,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",KV(n))for(var l=0;l<n.length;l++){s=n[l];var o=r+O4(s,l);a+=DI(s,e,t,o,i)}else if(o=yde(n),typeof o=="function")for(n=o.call(n),l=0;!(s=n.next()).done;)s=s.value,o=r+O4(s,l++),a+=DI(s,e,t,o,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function cC(n,e,t){if(n==null)return n;var r=[],i=0;return DI(n,r,"","",function(s){return e.call(t,s,i++)}),r}function wde(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Lc={current:null},BI={transition:null},Sde={ReactCurrentDispatcher:Lc,ReactCurrentBatchConfig:BI,ReactCurrentOwner:Bz};qi.Children={map:cC,forEach:function(n,e,t){cC(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return cC(n,function(){e++}),e},toArray:function(n){return cC(n,function(e){return e})||[]},only:function(n){if(!kz(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};qi.Component=dw;qi.Fragment=ude;qi.Profiler=fde;qi.PureComponent=Lz;qi.StrictMode=hde;qi.Suspense=gde;qi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sde;qi.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=bJ({},n.props),i=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Bz.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(o in e)AJ.call(e,o)&&!TJ.hasOwnProperty(o)&&(r[o]=e[o]===void 0&&l!==void 0?l[o]:e[o])}var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){l=Array(o);for(var h=0;h<o;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ET,type:n.type,key:i,ref:s,props:r,_owner:a}};qi.createContext=function(n){return n={$$typeof:pde,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:dde,_context:n},n.Consumer=n};qi.createElement=MJ;qi.createFactory=function(n){var e=MJ.bind(null,n);return e.type=n,e};qi.createRef=function(){return{current:null}};qi.forwardRef=function(n){return{$$typeof:mde,render:n}};qi.isValidElement=kz;qi.lazy=function(n){return{$$typeof:_de,_payload:{_status:-1,_result:n},_init:wde}};qi.memo=function(n,e){return{$$typeof:vde,type:n,compare:e===void 0?null:e}};qi.startTransition=function(n){var e=BI.transition;BI.transition={};try{n()}finally{BI.transition=e}};qi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};qi.useCallback=function(n,e){return Lc.current.useCallback(n,e)};qi.useContext=function(n){return Lc.current.useContext(n)};qi.useDebugValue=function(){};qi.useDeferredValue=function(n){return Lc.current.useDeferredValue(n)};qi.useEffect=function(n,e){return Lc.current.useEffect(n,e)};qi.useId=function(){return Lc.current.useId()};qi.useImperativeHandle=function(n,e,t){return Lc.current.useImperativeHandle(n,e,t)};qi.useInsertionEffect=function(n,e){return Lc.current.useInsertionEffect(n,e)};qi.useLayoutEffect=function(n,e){return Lc.current.useLayoutEffect(n,e)};qi.useMemo=function(n,e){return Lc.current.useMemo(n,e)};qi.useReducer=function(n,e,t){return Lc.current.useReducer(n,e,t)};qi.useRef=function(n){return Lc.current.useRef(n)};qi.useState=function(n){return Lc.current.useState(n)};qi.useSyncExternalStore=function(n,e,t){return Lc.current.useSyncExternalStore(n,e,t)};qi.useTransition=function(){return Lc.current.useTransition()};qi.version="18.2.0";yJ.exports=qi;var Ae=yJ.exports;const $l=SL(Ae),dR=ode({__proto__:null,default:$l},[Ae]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ade=Ae,Tde=Symbol.for("react.element"),Mde=Symbol.for("react.fragment"),Cde=Object.prototype.hasOwnProperty,Ede=Ade.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ide={key:!0,ref:!0,__self:!0,__source:!0};function CJ(n,e,t){var r,i={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Cde.call(e,r)&&!Ide.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Tde,type:n,key:s,ref:a,props:i,_owner:Ede.current}}AL.Fragment=Mde;AL.jsx=CJ;AL.jsxs=CJ;_J.exports=AL;var me=_J.exports,vO={},EJ={exports:{}},Uu={},IJ={exports:{}},RJ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ye,$e){var Ve=ye.length;ye.push($e);e:for(;0<Ve;){var _t=Ve-1>>>1,wt=ye[_t];if(0<i(wt,$e))ye[_t]=$e,ye[Ve]=wt,Ve=_t;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var $e=ye[0],Ve=ye.pop();if(Ve!==$e){ye[0]=Ve;e:for(var _t=0,wt=ye.length,Vt=wt>>>1;_t<Vt;){var lt=2*(_t+1)-1,Ht=ye[lt],Qt=lt+1,rn=ye[Qt];if(0>i(Ht,Ve))Qt<wt&&0>i(rn,Ht)?(ye[_t]=rn,ye[Qt]=Ve,_t=Qt):(ye[_t]=Ht,ye[lt]=Ve,_t=lt);else if(Qt<wt&&0>i(rn,Ve))ye[_t]=rn,ye[Qt]=Ve,_t=Qt;else break e}}return $e}function i(ye,$e){var Ve=ye.sortIndex-$e.sortIndex;return Ve!==0?Ve:ye.id-$e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var o=[],h=[],d=1,m=null,v=3,y=!1,S=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(ye){for(var $e=t(h);$e!==null;){if($e.callback===null)r(h);else if($e.startTime<=ye)r(h),$e.sortIndex=$e.expirationTime,e(o,$e);else break;$e=t(h)}}function H(ye){if(E=!1,k(ye),!S)if(t(o)!==null)S=!0,Le(q);else{var $e=t(h);$e!==null&&ot(H,$e.startTime-ye)}}function q(ye,$e){S=!1,E&&(E=!1,C(re),re=-1),y=!0;var Ve=v;try{for(k($e),m=t(o);m!==null&&(!(m.expirationTime>$e)||ye&&!fe());){var _t=m.callback;if(typeof _t=="function"){m.callback=null,v=m.priorityLevel;var wt=_t(m.expirationTime<=$e);$e=n.unstable_now(),typeof wt=="function"?m.callback=wt:m===t(o)&&r(o),k($e)}else r(o);m=t(o)}if(m!==null)var Vt=!0;else{var lt=t(h);lt!==null&&ot(H,lt.startTime-$e),Vt=!1}return Vt}finally{m=null,v=Ve,y=!1}}var Z=!1,ee=null,re=-1,se=5,ae=-1;function fe(){return!(n.unstable_now()-ae<se)}function Se(){if(ee!==null){var ye=n.unstable_now();ae=ye;var $e=!0;try{$e=ee(!0,ye)}finally{$e?Ce():(Z=!1,ee=null)}}else Z=!1}var Ce;if(typeof L=="function")Ce=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,je=Ie.port2;Ie.port1.onmessage=Se,Ce=function(){je.postMessage(null)}}else Ce=function(){M(Se,0)};function Le(ye){ee=ye,Z||(Z=!0,Ce())}function ot(ye,$e){re=M(function(){ye(n.unstable_now())},$e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Le(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(o)},n.unstable_next=function(ye){switch(v){case 1:case 2:case 3:var $e=3;break;default:$e=v}var Ve=v;v=$e;try{return ye()}finally{v=Ve}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,$e){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ve=v;v=ye;try{return $e()}finally{v=Ve}},n.unstable_scheduleCallback=function(ye,$e,Ve){var _t=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?_t+Ve:_t):Ve=_t,ye){case 1:var wt=-1;break;case 2:wt=250;break;case 5:wt=1073741823;break;case 4:wt=1e4;break;default:wt=5e3}return wt=Ve+wt,ye={id:d++,callback:$e,priorityLevel:ye,startTime:Ve,expirationTime:wt,sortIndex:-1},Ve>_t?(ye.sortIndex=Ve,e(h,ye),t(o)===null&&ye===t(h)&&(E?(C(re),re=-1):E=!0,ot(H,Ve-_t))):(ye.sortIndex=wt,e(o,ye),S||y||(S=!0,Le(q))),ye},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(ye){var $e=v;return function(){var Ve=v;v=$e;try{return ye.apply(this,arguments)}finally{v=Ve}}}})(RJ);IJ.exports=RJ;var Rde=IJ.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PJ=Ae,Nu=Rde;function Zn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var LJ=new Set,xA={};function d1(n,e){jb(n,e),jb(n+"Capture",e)}function jb(n,e){for(xA[n]=e,n=0;n<e.length;n++)LJ.add(e[n])}var zm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_O=Object.prototype.hasOwnProperty,Pde=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QV={},eH={};function Lde(n){return _O.call(eH,n)?!0:_O.call(QV,n)?!1:Pde.test(n)?eH[n]=!0:(QV[n]=!0,!1)}function Dde(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Bde(n,e,t,r){if(e===null||typeof e>"u"||Dde(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dc(n,e,t,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Al={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Al[n]=new Dc(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Al[e]=new Dc(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Al[n]=new Dc(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Al[n]=new Dc(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Al[n]=new Dc(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Al[n]=new Dc(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Al[n]=new Dc(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Al[n]=new Dc(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Al[n]=new Dc(n,5,!1,n.toLowerCase(),null,!1,!1)});var Oz=/[\-:]([a-z])/g;function Fz(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Oz,Fz);Al[e]=new Dc(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Oz,Fz);Al[e]=new Dc(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Oz,Fz);Al[e]=new Dc(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Al[n]=new Dc(n,1,!1,n.toLowerCase(),null,!1,!1)});Al.xlinkHref=new Dc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Al[n]=new Dc(n,1,!1,n.toLowerCase(),null,!0,!0)});function Nz(n,e,t,r){var i=Al.hasOwnProperty(e)?Al[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bde(e,t,i,r)&&(t=null),r||i===null?Lde(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var eg=PJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uC=Symbol.for("react.element"),tb=Symbol.for("react.portal"),nb=Symbol.for("react.fragment"),zz=Symbol.for("react.strict_mode"),yO=Symbol.for("react.profiler"),DJ=Symbol.for("react.provider"),BJ=Symbol.for("react.context"),Uz=Symbol.for("react.forward_ref"),xO=Symbol.for("react.suspense"),bO=Symbol.for("react.suspense_list"),Gz=Symbol.for("react.memo"),R0=Symbol.for("react.lazy"),kJ=Symbol.for("react.offscreen"),tH=Symbol.iterator;function g2(n){return n===null||typeof n!="object"?null:(n=tH&&n[tH]||n["@@iterator"],typeof n=="function"?n:null)}var jo=Object.assign,F4;function mS(n){if(F4===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);F4=e&&e[1]||""}return`
`+F4+n}var N4=!1;function z4(n,e){if(!n||N4)return"";N4=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){r=h}n.call(e.prototype)}else{try{throw Error()}catch(h){r=h}n()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var o=`
`+i[a].replace(" at new "," at ");return n.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",n.displayName)),o}while(1<=a&&0<=l);break}}}finally{N4=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?mS(n):""}function kde(n){switch(n.tag){case 5:return mS(n.type);case 16:return mS("Lazy");case 13:return mS("Suspense");case 19:return mS("SuspenseList");case 0:case 2:case 15:return n=z4(n.type,!1),n;case 11:return n=z4(n.type.render,!1),n;case 1:return n=z4(n.type,!0),n;default:return""}}function wO(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case nb:return"Fragment";case tb:return"Portal";case yO:return"Profiler";case zz:return"StrictMode";case xO:return"Suspense";case bO:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case BJ:return(n.displayName||"Context")+".Consumer";case DJ:return(n._context.displayName||"Context")+".Provider";case Uz:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Gz:return e=n.displayName||null,e!==null?e:wO(n.type)||"Memo";case R0:e=n._payload,n=n._init;try{return wO(n(e))}catch{}}return null}function Ode(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wO(e);case 8:return e===zz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function lv(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function OJ(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Fde(n){var e=OJ(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function hC(n){n._valueTracker||(n._valueTracker=Fde(n))}function FJ(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=OJ(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function pR(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function SO(n,e){var t=e.checked;return jo({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function nH(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=lv(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NJ(n,e){e=e.checked,e!=null&&Nz(n,"checked",e,!1)}function AO(n,e){NJ(n,e);var t=lv(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?TO(n,e.type,t):e.hasOwnProperty("defaultValue")&&TO(n,e.type,lv(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function rH(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function TO(n,e,t){(e!=="number"||pR(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var gS=Array.isArray;function Tb(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+lv(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function MO(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Zn(91));return jo({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function iH(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Zn(92));if(gS(t)){if(1<t.length)throw Error(Zn(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:lv(t)}}function zJ(n,e){var t=lv(e.value),r=lv(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function sH(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function UJ(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function CO(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?UJ(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var fC,GJ=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(fC=fC||document.createElement("div"),fC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=fC.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function bA(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var BS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nde=["Webkit","ms","Moz","O"];Object.keys(BS).forEach(function(n){Nde.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),BS[e]=BS[n]})});function VJ(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||BS.hasOwnProperty(n)&&BS[n]?(""+e).trim():e+"px"}function HJ(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=VJ(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var zde=jo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function EO(n,e){if(e){if(zde[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Zn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Zn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Zn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Zn(62))}}function IO(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RO=null;function Vz(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var PO=null,Mb=null,Cb=null;function oH(n){if(n=PT(n)){if(typeof PO!="function")throw Error(Zn(280));var e=n.stateNode;e&&(e=IL(e),PO(n.stateNode,n.type,e))}}function jJ(n){Mb?Cb?Cb.push(n):Cb=[n]:Mb=n}function WJ(){if(Mb){var n=Mb,e=Cb;if(Cb=Mb=null,oH(n),e)for(n=0;n<e.length;n++)oH(e[n])}}function XJ(n,e){return n(e)}function $J(){}var U4=!1;function qJ(n,e,t){if(U4)return n(e,t);U4=!0;try{return XJ(n,e,t)}finally{U4=!1,(Mb!==null||Cb!==null)&&($J(),WJ())}}function wA(n,e){var t=n.stateNode;if(t===null)return null;var r=IL(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Zn(231,e,typeof t));return t}var LO=!1;if(zm)try{var v2={};Object.defineProperty(v2,"passive",{get:function(){LO=!0}}),window.addEventListener("test",v2,v2),window.removeEventListener("test",v2,v2)}catch{LO=!1}function Ude(n,e,t,r,i,s,a,l,o){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(d){this.onError(d)}}var kS=!1,mR=null,gR=!1,DO=null,Gde={onError:function(n){kS=!0,mR=n}};function Vde(n,e,t,r,i,s,a,l,o){kS=!1,mR=null,Ude.apply(Gde,arguments)}function Hde(n,e,t,r,i,s,a,l,o){if(Vde.apply(this,arguments),kS){if(kS){var h=mR;kS=!1,mR=null}else throw Error(Zn(198));gR||(gR=!0,DO=h)}}function p1(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function ZJ(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function aH(n){if(p1(n)!==n)throw Error(Zn(188))}function jde(n){var e=n.alternate;if(!e){if(e=p1(n),e===null)throw Error(Zn(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return aH(i),n;if(s===r)return aH(i),e;s=s.sibling}throw Error(Zn(188))}if(t.return!==r.return)t=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===t){a=!0,t=i,r=s;break}if(l===r){a=!0,r=i,t=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===t){a=!0,t=s,r=i;break}if(l===r){a=!0,r=s,t=i;break}l=l.sibling}if(!a)throw Error(Zn(189))}}if(t.alternate!==r)throw Error(Zn(190))}if(t.tag!==3)throw Error(Zn(188));return t.stateNode.current===t?n:e}function YJ(n){return n=jde(n),n!==null?KJ(n):null}function KJ(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=KJ(n);if(e!==null)return e;n=n.sibling}return null}var JJ=Nu.unstable_scheduleCallback,lH=Nu.unstable_cancelCallback,Wde=Nu.unstable_shouldYield,Xde=Nu.unstable_requestPaint,da=Nu.unstable_now,$de=Nu.unstable_getCurrentPriorityLevel,Hz=Nu.unstable_ImmediatePriority,QJ=Nu.unstable_UserBlockingPriority,vR=Nu.unstable_NormalPriority,qde=Nu.unstable_LowPriority,eQ=Nu.unstable_IdlePriority,TL=null,ip=null;function Zde(n){if(ip&&typeof ip.onCommitFiberRoot=="function")try{ip.onCommitFiberRoot(TL,n,void 0,(n.current.flags&128)===128)}catch{}}var jf=Math.clz32?Math.clz32:Jde,Yde=Math.log,Kde=Math.LN2;function Jde(n){return n>>>=0,n===0?32:31-(Yde(n)/Kde|0)|0}var dC=64,pC=4194304;function vS(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function _R(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var l=a&~i;l!==0?r=vS(l):(s&=a,s!==0&&(r=vS(s)))}else a=t&~i,a!==0?r=vS(a):s!==0&&(r=vS(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-jf(e),i=1<<t,r|=n[t],e&=~i;return r}function Qde(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function epe(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-jf(s),l=1<<a,o=i[a];o===-1?(!(l&t)||l&r)&&(i[a]=Qde(l,e)):o<=e&&(n.expiredLanes|=l),s&=~l}}function BO(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function tQ(){var n=dC;return dC<<=1,!(dC&4194240)&&(dC=64),n}function G4(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function IT(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-jf(e),n[e]=t}function tpe(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-jf(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function jz(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-jf(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Fs=0;function nQ(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var rQ,Wz,iQ,sQ,oQ,kO=!1,mC=[],q0=null,Z0=null,Y0=null,SA=new Map,AA=new Map,B0=[],npe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cH(n,e){switch(n){case"focusin":case"focusout":q0=null;break;case"dragenter":case"dragleave":Z0=null;break;case"mouseover":case"mouseout":Y0=null;break;case"pointerover":case"pointerout":SA.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":AA.delete(e.pointerId)}}function _2(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=PT(e),e!==null&&Wz(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function rpe(n,e,t,r,i){switch(e){case"focusin":return q0=_2(q0,n,e,t,r,i),!0;case"dragenter":return Z0=_2(Z0,n,e,t,r,i),!0;case"mouseover":return Y0=_2(Y0,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return SA.set(s,_2(SA.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,AA.set(s,_2(AA.get(s)||null,n,e,t,r,i)),!0}return!1}function aQ(n){var e=my(n.target);if(e!==null){var t=p1(e);if(t!==null){if(e=t.tag,e===13){if(e=ZJ(t),e!==null){n.blockedOn=e,oQ(n.priority,function(){iQ(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function kI(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=OO(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);RO=r,t.target.dispatchEvent(r),RO=null}else return e=PT(t),e!==null&&Wz(e),n.blockedOn=t,!1;e.shift()}return!0}function uH(n,e,t){kI(n)&&t.delete(e)}function ipe(){kO=!1,q0!==null&&kI(q0)&&(q0=null),Z0!==null&&kI(Z0)&&(Z0=null),Y0!==null&&kI(Y0)&&(Y0=null),SA.forEach(uH),AA.forEach(uH)}function y2(n,e){n.blockedOn===e&&(n.blockedOn=null,kO||(kO=!0,Nu.unstable_scheduleCallback(Nu.unstable_NormalPriority,ipe)))}function TA(n){function e(i){return y2(i,n)}if(0<mC.length){y2(mC[0],n);for(var t=1;t<mC.length;t++){var r=mC[t];r.blockedOn===n&&(r.blockedOn=null)}}for(q0!==null&&y2(q0,n),Z0!==null&&y2(Z0,n),Y0!==null&&y2(Y0,n),SA.forEach(e),AA.forEach(e),t=0;t<B0.length;t++)r=B0[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<B0.length&&(t=B0[0],t.blockedOn===null);)aQ(t),t.blockedOn===null&&B0.shift()}var Eb=eg.ReactCurrentBatchConfig,yR=!0;function spe(n,e,t,r){var i=Fs,s=Eb.transition;Eb.transition=null;try{Fs=1,Xz(n,e,t,r)}finally{Fs=i,Eb.transition=s}}function ope(n,e,t,r){var i=Fs,s=Eb.transition;Eb.transition=null;try{Fs=4,Xz(n,e,t,r)}finally{Fs=i,Eb.transition=s}}function Xz(n,e,t,r){if(yR){var i=OO(n,e,t,r);if(i===null)K4(n,e,r,xR,t),cH(n,r);else if(rpe(i,n,e,t,r))r.stopPropagation();else if(cH(n,r),e&4&&-1<npe.indexOf(n)){for(;i!==null;){var s=PT(i);if(s!==null&&rQ(s),s=OO(n,e,t,r),s===null&&K4(n,e,r,xR,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else K4(n,e,r,null,t)}}var xR=null;function OO(n,e,t,r){if(xR=null,n=Vz(r),n=my(n),n!==null)if(e=p1(n),e===null)n=null;else if(t=e.tag,t===13){if(n=ZJ(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return xR=n,null}function lQ(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($de()){case Hz:return 1;case QJ:return 4;case vR:case qde:return 16;case eQ:return 536870912;default:return 16}default:return 16}}var N0=null,$z=null,OI=null;function cQ(){if(OI)return OI;var n,e=$z,t=e.length,r,i="value"in N0?N0.value:N0.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[s-r];r++);return OI=i.slice(n,1<r?1-r:void 0)}function FI(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function gC(){return!0}function hH(){return!1}function Gu(n){function e(t,r,i,s,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gC:hH,this.isPropagationStopped=hH,this}return jo(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=gC)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=gC)},persist:function(){},isPersistent:gC}),e}var pw={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qz=Gu(pw),RT=jo({},pw,{view:0,detail:0}),ape=Gu(RT),V4,H4,x2,ML=jo({},RT,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zz,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==x2&&(x2&&n.type==="mousemove"?(V4=n.screenX-x2.screenX,H4=n.screenY-x2.screenY):H4=V4=0,x2=n),V4)},movementY:function(n){return"movementY"in n?n.movementY:H4}}),fH=Gu(ML),lpe=jo({},ML,{dataTransfer:0}),cpe=Gu(lpe),upe=jo({},RT,{relatedTarget:0}),j4=Gu(upe),hpe=jo({},pw,{animationName:0,elapsedTime:0,pseudoElement:0}),fpe=Gu(hpe),dpe=jo({},pw,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ppe=Gu(dpe),mpe=jo({},pw,{data:0}),dH=Gu(mpe),gpe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vpe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_pe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ype(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=_pe[n])?!!e[n]:!1}function Zz(){return ype}var xpe=jo({},RT,{key:function(n){if(n.key){var e=gpe[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=FI(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?vpe[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zz,charCode:function(n){return n.type==="keypress"?FI(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?FI(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),bpe=Gu(xpe),wpe=jo({},ML,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pH=Gu(wpe),Spe=jo({},RT,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zz}),Ape=Gu(Spe),Tpe=jo({},pw,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mpe=Gu(Tpe),Cpe=jo({},ML,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Epe=Gu(Cpe),Ipe=[9,13,27,32],Yz=zm&&"CompositionEvent"in window,OS=null;zm&&"documentMode"in document&&(OS=document.documentMode);var Rpe=zm&&"TextEvent"in window&&!OS,uQ=zm&&(!Yz||OS&&8<OS&&11>=OS),mH=" ",gH=!1;function hQ(n,e){switch(n){case"keyup":return Ipe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fQ(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var rb=!1;function Ppe(n,e){switch(n){case"compositionend":return fQ(e);case"keypress":return e.which!==32?null:(gH=!0,mH);case"textInput":return n=e.data,n===mH&&gH?null:n;default:return null}}function Lpe(n,e){if(rb)return n==="compositionend"||!Yz&&hQ(n,e)?(n=cQ(),OI=$z=N0=null,rb=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uQ&&e.locale!=="ko"?null:e.data;default:return null}}var Dpe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vH(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Dpe[n.type]:e==="textarea"}function dQ(n,e,t,r){jJ(r),e=bR(e,"onChange"),0<e.length&&(t=new qz("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var FS=null,MA=null;function Bpe(n){AQ(n,0)}function CL(n){var e=ob(n);if(FJ(e))return n}function kpe(n,e){if(n==="change")return e}var pQ=!1;if(zm){var W4;if(zm){var X4="oninput"in document;if(!X4){var _H=document.createElement("div");_H.setAttribute("oninput","return;"),X4=typeof _H.oninput=="function"}W4=X4}else W4=!1;pQ=W4&&(!document.documentMode||9<document.documentMode)}function yH(){FS&&(FS.detachEvent("onpropertychange",mQ),MA=FS=null)}function mQ(n){if(n.propertyName==="value"&&CL(MA)){var e=[];dQ(e,MA,n,Vz(n)),qJ(Bpe,e)}}function Ope(n,e,t){n==="focusin"?(yH(),FS=e,MA=t,FS.attachEvent("onpropertychange",mQ)):n==="focusout"&&yH()}function Fpe(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return CL(MA)}function Npe(n,e){if(n==="click")return CL(e)}function zpe(n,e){if(n==="input"||n==="change")return CL(e)}function Upe(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var qf=typeof Object.is=="function"?Object.is:Upe;function CA(n,e){if(qf(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!_O.call(e,i)||!qf(n[i],e[i]))return!1}return!0}function xH(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function bH(n,e){var t=xH(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=xH(t)}}function gQ(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?gQ(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function vQ(){for(var n=window,e=pR();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=pR(n.document)}return e}function Kz(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Gpe(n){var e=vQ(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&gQ(t.ownerDocument.documentElement,t)){if(r!==null&&Kz(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=bH(t,s);var a=bH(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Vpe=zm&&"documentMode"in document&&11>=document.documentMode,ib=null,FO=null,NS=null,NO=!1;function wH(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;NO||ib==null||ib!==pR(r)||(r=ib,"selectionStart"in r&&Kz(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),NS&&CA(NS,r)||(NS=r,r=bR(FO,"onSelect"),0<r.length&&(e=new qz("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ib)))}function vC(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var sb={animationend:vC("Animation","AnimationEnd"),animationiteration:vC("Animation","AnimationIteration"),animationstart:vC("Animation","AnimationStart"),transitionend:vC("Transition","TransitionEnd")},$4={},_Q={};zm&&(_Q=document.createElement("div").style,"AnimationEvent"in window||(delete sb.animationend.animation,delete sb.animationiteration.animation,delete sb.animationstart.animation),"TransitionEvent"in window||delete sb.transitionend.transition);function EL(n){if($4[n])return $4[n];if(!sb[n])return n;var e=sb[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in _Q)return $4[n]=e[t];return n}var yQ=EL("animationend"),xQ=EL("animationiteration"),bQ=EL("animationstart"),wQ=EL("transitionend"),SQ=new Map,SH="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Av(n,e){SQ.set(n,e),d1(e,[n])}for(var q4=0;q4<SH.length;q4++){var Z4=SH[q4],Hpe=Z4.toLowerCase(),jpe=Z4[0].toUpperCase()+Z4.slice(1);Av(Hpe,"on"+jpe)}Av(yQ,"onAnimationEnd");Av(xQ,"onAnimationIteration");Av(bQ,"onAnimationStart");Av("dblclick","onDoubleClick");Av("focusin","onFocus");Av("focusout","onBlur");Av(wQ,"onTransitionEnd");jb("onMouseEnter",["mouseout","mouseover"]);jb("onMouseLeave",["mouseout","mouseover"]);jb("onPointerEnter",["pointerout","pointerover"]);jb("onPointerLeave",["pointerout","pointerover"]);d1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));d1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));d1("onBeforeInput",["compositionend","keypress","textInput","paste"]);d1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));d1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));d1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _S="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wpe=new Set("cancel close invalid load scroll toggle".split(" ").concat(_S));function AH(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,Hde(r,e,void 0,n),n.currentTarget=null}function AQ(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],o=l.instance,h=l.currentTarget;if(l=l.listener,o!==s&&i.isPropagationStopped())break e;AH(i,l,h),s=o}else for(a=0;a<r.length;a++){if(l=r[a],o=l.instance,h=l.currentTarget,l=l.listener,o!==s&&i.isPropagationStopped())break e;AH(i,l,h),s=o}}}if(gR)throw n=DO,gR=!1,DO=null,n}function mo(n,e){var t=e[HO];t===void 0&&(t=e[HO]=new Set);var r=n+"__bubble";t.has(r)||(TQ(e,n,2,!1),t.add(r))}function Y4(n,e,t){var r=0;e&&(r|=4),TQ(t,n,r,e)}var _C="_reactListening"+Math.random().toString(36).slice(2);function EA(n){if(!n[_C]){n[_C]=!0,LJ.forEach(function(t){t!=="selectionchange"&&(Wpe.has(t)||Y4(t,!1,n),Y4(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[_C]||(e[_C]=!0,Y4("selectionchange",!1,e))}}function TQ(n,e,t,r){switch(lQ(e)){case 1:var i=spe;break;case 4:i=ope;break;default:i=Xz}t=i.bind(null,e,t,n),i=void 0,!LO||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function K4(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var o=a.tag;if((o===3||o===4)&&(o=a.stateNode.containerInfo,o===i||o.nodeType===8&&o.parentNode===i))return;a=a.return}for(;l!==null;){if(a=my(l),a===null)return;if(o=a.tag,o===5||o===6){r=s=a;continue e}l=l.parentNode}}r=r.return}qJ(function(){var h=s,d=Vz(t),m=[];e:{var v=SQ.get(n);if(v!==void 0){var y=qz,S=n;switch(n){case"keypress":if(FI(t)===0)break e;case"keydown":case"keyup":y=bpe;break;case"focusin":S="focus",y=j4;break;case"focusout":S="blur",y=j4;break;case"beforeblur":case"afterblur":y=j4;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=fH;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=cpe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=Ape;break;case yQ:case xQ:case bQ:y=fpe;break;case wQ:y=Mpe;break;case"scroll":y=ape;break;case"wheel":y=Epe;break;case"copy":case"cut":case"paste":y=ppe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=pH}var E=(e&4)!==0,M=!E&&n==="scroll",C=E?v!==null?v+"Capture":null:v;E=[];for(var L=h,k;L!==null;){k=L;var H=k.stateNode;if(k.tag===5&&H!==null&&(k=H,C!==null&&(H=wA(L,C),H!=null&&E.push(IA(L,H,k)))),M)break;L=L.return}0<E.length&&(v=new y(v,S,null,t,d),m.push({event:v,listeners:E}))}}if(!(e&7)){e:{if(v=n==="mouseover"||n==="pointerover",y=n==="mouseout"||n==="pointerout",v&&t!==RO&&(S=t.relatedTarget||t.fromElement)&&(my(S)||S[Um]))break e;if((y||v)&&(v=d.window===d?d:(v=d.ownerDocument)?v.defaultView||v.parentWindow:window,y?(S=t.relatedTarget||t.toElement,y=h,S=S?my(S):null,S!==null&&(M=p1(S),S!==M||S.tag!==5&&S.tag!==6)&&(S=null)):(y=null,S=h),y!==S)){if(E=fH,H="onMouseLeave",C="onMouseEnter",L="mouse",(n==="pointerout"||n==="pointerover")&&(E=pH,H="onPointerLeave",C="onPointerEnter",L="pointer"),M=y==null?v:ob(y),k=S==null?v:ob(S),v=new E(H,L+"leave",y,t,d),v.target=M,v.relatedTarget=k,H=null,my(d)===h&&(E=new E(C,L+"enter",S,t,d),E.target=k,E.relatedTarget=M,H=E),M=H,y&&S)t:{for(E=y,C=S,L=0,k=E;k;k=nx(k))L++;for(k=0,H=C;H;H=nx(H))k++;for(;0<L-k;)E=nx(E),L--;for(;0<k-L;)C=nx(C),k--;for(;L--;){if(E===C||C!==null&&E===C.alternate)break t;E=nx(E),C=nx(C)}E=null}else E=null;y!==null&&TH(m,v,y,E,!1),S!==null&&M!==null&&TH(m,M,S,E,!0)}}e:{if(v=h?ob(h):window,y=v.nodeName&&v.nodeName.toLowerCase(),y==="select"||y==="input"&&v.type==="file")var q=kpe;else if(vH(v))if(pQ)q=zpe;else{q=Fpe;var Z=Ope}else(y=v.nodeName)&&y.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(q=Npe);if(q&&(q=q(n,h))){dQ(m,q,t,d);break e}Z&&Z(n,v,h),n==="focusout"&&(Z=v._wrapperState)&&Z.controlled&&v.type==="number"&&TO(v,"number",v.value)}switch(Z=h?ob(h):window,n){case"focusin":(vH(Z)||Z.contentEditable==="true")&&(ib=Z,FO=h,NS=null);break;case"focusout":NS=FO=ib=null;break;case"mousedown":NO=!0;break;case"contextmenu":case"mouseup":case"dragend":NO=!1,wH(m,t,d);break;case"selectionchange":if(Vpe)break;case"keydown":case"keyup":wH(m,t,d)}var ee;if(Yz)e:{switch(n){case"compositionstart":var re="onCompositionStart";break e;case"compositionend":re="onCompositionEnd";break e;case"compositionupdate":re="onCompositionUpdate";break e}re=void 0}else rb?hQ(n,t)&&(re="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(re="onCompositionStart");re&&(uQ&&t.locale!=="ko"&&(rb||re!=="onCompositionStart"?re==="onCompositionEnd"&&rb&&(ee=cQ()):(N0=d,$z="value"in N0?N0.value:N0.textContent,rb=!0)),Z=bR(h,re),0<Z.length&&(re=new dH(re,n,null,t,d),m.push({event:re,listeners:Z}),ee?re.data=ee:(ee=fQ(t),ee!==null&&(re.data=ee)))),(ee=Rpe?Ppe(n,t):Lpe(n,t))&&(h=bR(h,"onBeforeInput"),0<h.length&&(d=new dH("onBeforeInput","beforeinput",null,t,d),m.push({event:d,listeners:h}),d.data=ee))}AQ(m,e)})}function IA(n,e,t){return{instance:n,listener:e,currentTarget:t}}function bR(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=wA(n,t),s!=null&&r.unshift(IA(n,s,i)),s=wA(n,e),s!=null&&r.push(IA(n,s,i))),n=n.return}return r}function nx(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function TH(n,e,t,r,i){for(var s=e._reactName,a=[];t!==null&&t!==r;){var l=t,o=l.alternate,h=l.stateNode;if(o!==null&&o===r)break;l.tag===5&&h!==null&&(l=h,i?(o=wA(t,s),o!=null&&a.unshift(IA(t,o,l))):i||(o=wA(t,s),o!=null&&a.push(IA(t,o,l)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var Xpe=/\r\n?/g,$pe=/\u0000|\uFFFD/g;function MH(n){return(typeof n=="string"?n:""+n).replace(Xpe,`
`).replace($pe,"")}function yC(n,e,t){if(e=MH(e),MH(n)!==e&&t)throw Error(Zn(425))}function wR(){}var zO=null,UO=null;function GO(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var VO=typeof setTimeout=="function"?setTimeout:void 0,qpe=typeof clearTimeout=="function"?clearTimeout:void 0,CH=typeof Promise=="function"?Promise:void 0,Zpe=typeof queueMicrotask=="function"?queueMicrotask:typeof CH<"u"?function(n){return CH.resolve(null).then(n).catch(Ype)}:VO;function Ype(n){setTimeout(function(){throw n})}function J4(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),TA(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);TA(e)}function K0(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function EH(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var mw=Math.random().toString(36).slice(2),Yd="__reactFiber$"+mw,RA="__reactProps$"+mw,Um="__reactContainer$"+mw,HO="__reactEvents$"+mw,Kpe="__reactListeners$"+mw,Jpe="__reactHandles$"+mw;function my(n){var e=n[Yd];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Um]||t[Yd]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=EH(n);n!==null;){if(t=n[Yd])return t;n=EH(n)}return e}n=t,t=n.parentNode}return null}function PT(n){return n=n[Yd]||n[Um],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ob(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Zn(33))}function IL(n){return n[RA]||null}var jO=[],ab=-1;function Tv(n){return{current:n}}function vo(n){0>ab||(n.current=jO[ab],jO[ab]=null,ab--)}function ro(n,e){ab++,jO[ab]=n.current,n.current=e}var cv={},Zl=Tv(cv),lu=Tv(!1),jy=cv;function Wb(n,e){var t=n.type.contextTypes;if(!t)return cv;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function cu(n){return n=n.childContextTypes,n!=null}function SR(){vo(lu),vo(Zl)}function IH(n,e,t){if(Zl.current!==cv)throw Error(Zn(168));ro(Zl,e),ro(lu,t)}function MQ(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Zn(108,Ode(n)||"Unknown",i));return jo({},t,r)}function AR(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||cv,jy=Zl.current,ro(Zl,n),ro(lu,lu.current),!0}function RH(n,e,t){var r=n.stateNode;if(!r)throw Error(Zn(169));t?(n=MQ(n,e,jy),r.__reactInternalMemoizedMergedChildContext=n,vo(lu),vo(Zl),ro(Zl,n)):vo(lu),ro(lu,t)}var wm=null,RL=!1,Q4=!1;function CQ(n){wm===null?wm=[n]:wm.push(n)}function Qpe(n){RL=!0,CQ(n)}function Mv(){if(!Q4&&wm!==null){Q4=!0;var n=0,e=Fs;try{var t=wm;for(Fs=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}wm=null,RL=!1}catch(i){throw wm!==null&&(wm=wm.slice(n+1)),JJ(Hz,Mv),i}finally{Fs=e,Q4=!1}}return null}var lb=[],cb=0,TR=null,MR=0,_h=[],yh=0,Wy=null,Cm=1,Em="";function iy(n,e){lb[cb++]=MR,lb[cb++]=TR,TR=n,MR=e}function EQ(n,e,t){_h[yh++]=Cm,_h[yh++]=Em,_h[yh++]=Wy,Wy=n;var r=Cm;n=Em;var i=32-jf(r)-1;r&=~(1<<i),t+=1;var s=32-jf(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Cm=1<<32-jf(e)+i|t<<i|r,Em=s+n}else Cm=1<<s|t<<i|r,Em=n}function Jz(n){n.return!==null&&(iy(n,1),EQ(n,1,0))}function Qz(n){for(;n===TR;)TR=lb[--cb],lb[cb]=null,MR=lb[--cb],lb[cb]=null;for(;n===Wy;)Wy=_h[--yh],_h[yh]=null,Em=_h[--yh],_h[yh]=null,Cm=_h[--yh],_h[yh]=null}var Bu=null,Du=null,Mo=!1,Ff=null;function IQ(n,e){var t=Ah(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function PH(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Bu=n,Du=K0(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Bu=n,Du=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Wy!==null?{id:Cm,overflow:Em}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ah(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Bu=n,Du=null,!0):!1;default:return!1}}function WO(n){return(n.mode&1)!==0&&(n.flags&128)===0}function XO(n){if(Mo){var e=Du;if(e){var t=e;if(!PH(n,e)){if(WO(n))throw Error(Zn(418));e=K0(t.nextSibling);var r=Bu;e&&PH(n,e)?IQ(r,t):(n.flags=n.flags&-4097|2,Mo=!1,Bu=n)}}else{if(WO(n))throw Error(Zn(418));n.flags=n.flags&-4097|2,Mo=!1,Bu=n}}}function LH(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Bu=n}function xC(n){if(n!==Bu)return!1;if(!Mo)return LH(n),Mo=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!GO(n.type,n.memoizedProps)),e&&(e=Du)){if(WO(n))throw RQ(),Error(Zn(418));for(;e;)IQ(n,e),e=K0(e.nextSibling)}if(LH(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Zn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Du=K0(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Du=null}}else Du=Bu?K0(n.stateNode.nextSibling):null;return!0}function RQ(){for(var n=Du;n;)n=K0(n.nextSibling)}function Xb(){Du=Bu=null,Mo=!1}function e6(n){Ff===null?Ff=[n]:Ff.push(n)}var eme=eg.ReactCurrentBatchConfig;function Df(n,e){if(n&&n.defaultProps){e=jo({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var CR=Tv(null),ER=null,ub=null,t6=null;function n6(){t6=ub=ER=null}function r6(n){var e=CR.current;vo(CR),n._currentValue=e}function $O(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Ib(n,e){ER=n,t6=ub=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(iu=!0),n.firstContext=null)}function Ph(n){var e=n._currentValue;if(t6!==n)if(n={context:n,memoizedValue:e,next:null},ub===null){if(ER===null)throw Error(Zn(308));ub=n,ER.dependencies={lanes:0,firstContext:n}}else ub=ub.next=n;return e}var gy=null;function i6(n){gy===null?gy=[n]:gy.push(n)}function PQ(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,i6(e)):(t.next=i.next,i.next=t),e.interleaved=t,Gm(n,r)}function Gm(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var P0=!1;function s6(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LQ(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Bm(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function J0(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,gs&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Gm(n,t)}return i=r.interleaved,i===null?(e.next=e,i6(r)):(e.next=i.next,i.next=e),r.interleaved=e,Gm(n,t)}function NI(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,jz(n,t)}}function DH(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function IR(n,e,t,r){var i=n.updateQueue;P0=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var o=l,h=o.next;o.next=null,a===null?s=h:a.next=h,a=o;var d=n.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=h:l.next=h,d.lastBaseUpdate=o))}if(s!==null){var m=i.baseState;a=0,d=h=o=null,l=s;do{var v=l.lane,y=l.eventTime;if((r&v)===v){d!==null&&(d=d.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=n,E=l;switch(v=e,y=t,E.tag){case 1:if(S=E.payload,typeof S=="function"){m=S.call(y,m,v);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=E.payload,v=typeof S=="function"?S.call(y,m,v):S,v==null)break e;m=jo({},m,v);break e;case 2:P0=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else y={eventTime:y,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(h=d=y,o=m):d=d.next=y,a|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(d===null&&(o=m),i.baseState=o,i.firstBaseUpdate=h,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);$y|=a,n.lanes=a,n.memoizedState=m}}function BH(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(Zn(191,i));i.call(r)}}}var DQ=new PJ.Component().refs;function qO(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:jo({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var PL={isMounted:function(n){return(n=n._reactInternals)?p1(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Mc(),i=ev(n),s=Bm(r,i);s.payload=e,t!=null&&(s.callback=t),e=J0(n,s,i),e!==null&&(Wf(e,n,i,r),NI(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Mc(),i=ev(n),s=Bm(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=J0(n,s,i),e!==null&&(Wf(e,n,i,r),NI(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Mc(),r=ev(n),i=Bm(t,r);i.tag=2,e!=null&&(i.callback=e),e=J0(n,i,r),e!==null&&(Wf(e,n,r,t),NI(e,n,r))}};function kH(n,e,t,r,i,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!CA(t,r)||!CA(i,s):!0}function BQ(n,e,t){var r=!1,i=cv,s=e.contextType;return typeof s=="object"&&s!==null?s=Ph(s):(i=cu(e)?jy:Zl.current,r=e.contextTypes,s=(r=r!=null)?Wb(n,i):cv),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=PL,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function OH(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&PL.enqueueReplaceState(e,e.state,null)}function ZO(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=DQ,s6(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ph(s):(s=cu(e)?jy:Zl.current,i.context=Wb(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qO(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&PL.enqueueReplaceState(i,i.state,null),IR(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function b2(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Zn(309));var r=t.stateNode}if(!r)throw Error(Zn(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;l===DQ&&(l=i.refs={}),a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(Zn(284));if(!t._owner)throw Error(Zn(290,n))}return n}function bC(n,e){throw n=Object.prototype.toString.call(e),Error(Zn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function FH(n){var e=n._init;return e(n._payload)}function kQ(n){function e(C,L){if(n){var k=C.deletions;k===null?(C.deletions=[L],C.flags|=16):k.push(L)}}function t(C,L){if(!n)return null;for(;L!==null;)e(C,L),L=L.sibling;return null}function r(C,L){for(C=new Map;L!==null;)L.key!==null?C.set(L.key,L):C.set(L.index,L),L=L.sibling;return C}function i(C,L){return C=tv(C,L),C.index=0,C.sibling=null,C}function s(C,L,k){return C.index=k,n?(k=C.alternate,k!==null?(k=k.index,k<L?(C.flags|=2,L):k):(C.flags|=2,L)):(C.flags|=1048576,L)}function a(C){return n&&C.alternate===null&&(C.flags|=2),C}function l(C,L,k,H){return L===null||L.tag!==6?(L=o5(k,C.mode,H),L.return=C,L):(L=i(L,k),L.return=C,L)}function o(C,L,k,H){var q=k.type;return q===nb?d(C,L,k.props.children,H,k.key):L!==null&&(L.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===R0&&FH(q)===L.type)?(H=i(L,k.props),H.ref=b2(C,L,k),H.return=C,H):(H=jI(k.type,k.key,k.props,null,C.mode,H),H.ref=b2(C,L,k),H.return=C,H)}function h(C,L,k,H){return L===null||L.tag!==4||L.stateNode.containerInfo!==k.containerInfo||L.stateNode.implementation!==k.implementation?(L=a5(k,C.mode,H),L.return=C,L):(L=i(L,k.children||[]),L.return=C,L)}function d(C,L,k,H,q){return L===null||L.tag!==7?(L=Py(k,C.mode,H,q),L.return=C,L):(L=i(L,k),L.return=C,L)}function m(C,L,k){if(typeof L=="string"&&L!==""||typeof L=="number")return L=o5(""+L,C.mode,k),L.return=C,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case uC:return k=jI(L.type,L.key,L.props,null,C.mode,k),k.ref=b2(C,null,L),k.return=C,k;case tb:return L=a5(L,C.mode,k),L.return=C,L;case R0:var H=L._init;return m(C,H(L._payload),k)}if(gS(L)||g2(L))return L=Py(L,C.mode,k,null),L.return=C,L;bC(C,L)}return null}function v(C,L,k,H){var q=L!==null?L.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return q!==null?null:l(C,L,""+k,H);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case uC:return k.key===q?o(C,L,k,H):null;case tb:return k.key===q?h(C,L,k,H):null;case R0:return q=k._init,v(C,L,q(k._payload),H)}if(gS(k)||g2(k))return q!==null?null:d(C,L,k,H,null);bC(C,k)}return null}function y(C,L,k,H,q){if(typeof H=="string"&&H!==""||typeof H=="number")return C=C.get(k)||null,l(L,C,""+H,q);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case uC:return C=C.get(H.key===null?k:H.key)||null,o(L,C,H,q);case tb:return C=C.get(H.key===null?k:H.key)||null,h(L,C,H,q);case R0:var Z=H._init;return y(C,L,k,Z(H._payload),q)}if(gS(H)||g2(H))return C=C.get(k)||null,d(L,C,H,q,null);bC(L,H)}return null}function S(C,L,k,H){for(var q=null,Z=null,ee=L,re=L=0,se=null;ee!==null&&re<k.length;re++){ee.index>re?(se=ee,ee=null):se=ee.sibling;var ae=v(C,ee,k[re],H);if(ae===null){ee===null&&(ee=se);break}n&&ee&&ae.alternate===null&&e(C,ee),L=s(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae,ee=se}if(re===k.length)return t(C,ee),Mo&&iy(C,re),q;if(ee===null){for(;re<k.length;re++)ee=m(C,k[re],H),ee!==null&&(L=s(ee,L,re),Z===null?q=ee:Z.sibling=ee,Z=ee);return Mo&&iy(C,re),q}for(ee=r(C,ee);re<k.length;re++)se=y(ee,C,re,k[re],H),se!==null&&(n&&se.alternate!==null&&ee.delete(se.key===null?re:se.key),L=s(se,L,re),Z===null?q=se:Z.sibling=se,Z=se);return n&&ee.forEach(function(fe){return e(C,fe)}),Mo&&iy(C,re),q}function E(C,L,k,H){var q=g2(k);if(typeof q!="function")throw Error(Zn(150));if(k=q.call(k),k==null)throw Error(Zn(151));for(var Z=q=null,ee=L,re=L=0,se=null,ae=k.next();ee!==null&&!ae.done;re++,ae=k.next()){ee.index>re?(se=ee,ee=null):se=ee.sibling;var fe=v(C,ee,ae.value,H);if(fe===null){ee===null&&(ee=se);break}n&&ee&&fe.alternate===null&&e(C,ee),L=s(fe,L,re),Z===null?q=fe:Z.sibling=fe,Z=fe,ee=se}if(ae.done)return t(C,ee),Mo&&iy(C,re),q;if(ee===null){for(;!ae.done;re++,ae=k.next())ae=m(C,ae.value,H),ae!==null&&(L=s(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae);return Mo&&iy(C,re),q}for(ee=r(C,ee);!ae.done;re++,ae=k.next())ae=y(ee,C,re,ae.value,H),ae!==null&&(n&&ae.alternate!==null&&ee.delete(ae.key===null?re:ae.key),L=s(ae,L,re),Z===null?q=ae:Z.sibling=ae,Z=ae);return n&&ee.forEach(function(Se){return e(C,Se)}),Mo&&iy(C,re),q}function M(C,L,k,H){if(typeof k=="object"&&k!==null&&k.type===nb&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case uC:e:{for(var q=k.key,Z=L;Z!==null;){if(Z.key===q){if(q=k.type,q===nb){if(Z.tag===7){t(C,Z.sibling),L=i(Z,k.props.children),L.return=C,C=L;break e}}else if(Z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===R0&&FH(q)===Z.type){t(C,Z.sibling),L=i(Z,k.props),L.ref=b2(C,Z,k),L.return=C,C=L;break e}t(C,Z);break}else e(C,Z);Z=Z.sibling}k.type===nb?(L=Py(k.props.children,C.mode,H,k.key),L.return=C,C=L):(H=jI(k.type,k.key,k.props,null,C.mode,H),H.ref=b2(C,L,k),H.return=C,C=H)}return a(C);case tb:e:{for(Z=k.key;L!==null;){if(L.key===Z)if(L.tag===4&&L.stateNode.containerInfo===k.containerInfo&&L.stateNode.implementation===k.implementation){t(C,L.sibling),L=i(L,k.children||[]),L.return=C,C=L;break e}else{t(C,L);break}else e(C,L);L=L.sibling}L=a5(k,C.mode,H),L.return=C,C=L}return a(C);case R0:return Z=k._init,M(C,L,Z(k._payload),H)}if(gS(k))return S(C,L,k,H);if(g2(k))return E(C,L,k,H);bC(C,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,L!==null&&L.tag===6?(t(C,L.sibling),L=i(L,k),L.return=C,C=L):(t(C,L),L=o5(k,C.mode,H),L.return=C,C=L),a(C)):t(C,L)}return M}var $b=kQ(!0),OQ=kQ(!1),LT={},sp=Tv(LT),PA=Tv(LT),LA=Tv(LT);function vy(n){if(n===LT)throw Error(Zn(174));return n}function o6(n,e){switch(ro(LA,e),ro(PA,n),ro(sp,LT),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:CO(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=CO(e,n)}vo(sp),ro(sp,e)}function qb(){vo(sp),vo(PA),vo(LA)}function FQ(n){vy(LA.current);var e=vy(sp.current),t=CO(e,n.type);e!==t&&(ro(PA,n),ro(sp,t))}function a6(n){PA.current===n&&(vo(sp),vo(PA))}var Uo=Tv(0);function RR(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var e5=[];function l6(){for(var n=0;n<e5.length;n++)e5[n]._workInProgressVersionPrimary=null;e5.length=0}var zI=eg.ReactCurrentDispatcher,t5=eg.ReactCurrentBatchConfig,Xy=0,Vo=null,Ua=null,nl=null,PR=!1,zS=!1,DA=0,tme=0;function Ll(){throw Error(Zn(321))}function c6(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!qf(n[t],e[t]))return!1;return!0}function u6(n,e,t,r,i,s){if(Xy=s,Vo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zI.current=n===null||n.memoizedState===null?sme:ome,n=t(r,i),zS){s=0;do{if(zS=!1,DA=0,25<=s)throw Error(Zn(301));s+=1,nl=Ua=null,e.updateQueue=null,zI.current=ame,n=t(r,i)}while(zS)}if(zI.current=LR,e=Ua!==null&&Ua.next!==null,Xy=0,nl=Ua=Vo=null,PR=!1,e)throw Error(Zn(300));return n}function h6(){var n=DA!==0;return DA=0,n}function Zd(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nl===null?Vo.memoizedState=nl=n:nl=nl.next=n,nl}function Lh(){if(Ua===null){var n=Vo.alternate;n=n!==null?n.memoizedState:null}else n=Ua.next;var e=nl===null?Vo.memoizedState:nl.next;if(e!==null)nl=e,Ua=n;else{if(n===null)throw Error(Zn(310));Ua=n,n={memoizedState:Ua.memoizedState,baseState:Ua.baseState,baseQueue:Ua.baseQueue,queue:Ua.queue,next:null},nl===null?Vo.memoizedState=nl=n:nl=nl.next=n}return nl}function BA(n,e){return typeof e=="function"?e(n):e}function n5(n){var e=Lh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=Ua,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,o=null,h=s;do{var d=h.lane;if((Xy&d)===d)o!==null&&(o=o.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:n(r,h.action);else{var m={lane:d,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};o===null?(l=o=m,a=r):o=o.next=m,Vo.lanes|=d,$y|=d}h=h.next}while(h!==null&&h!==s);o===null?a=r:o.next=l,qf(r,e.memoizedState)||(iu=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=o,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Vo.lanes|=s,$y|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function r5(n){var e=Lh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=n(s,a.action),a=a.next;while(a!==i);qf(s,e.memoizedState)||(iu=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function NQ(){}function zQ(n,e){var t=Vo,r=Lh(),i=e(),s=!qf(r.memoizedState,i);if(s&&(r.memoizedState=i,iu=!0),r=r.queue,f6(VQ.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||nl!==null&&nl.memoizedState.tag&1){if(t.flags|=2048,kA(9,GQ.bind(null,t,r,i,e),void 0,null),rl===null)throw Error(Zn(349));Xy&30||UQ(t,e,i)}return i}function UQ(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Vo.updateQueue,e===null?(e={lastEffect:null,stores:null},Vo.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function GQ(n,e,t,r){e.value=t,e.getSnapshot=r,HQ(e)&&jQ(n)}function VQ(n,e,t){return t(function(){HQ(e)&&jQ(n)})}function HQ(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!qf(n,t)}catch{return!0}}function jQ(n){var e=Gm(n,1);e!==null&&Wf(e,n,1,-1)}function NH(n){var e=Zd();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:BA,lastRenderedState:n},e.queue=n,n=n.dispatch=ime.bind(null,Vo,n),[e.memoizedState,n]}function kA(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Vo.updateQueue,e===null?(e={lastEffect:null,stores:null},Vo.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function WQ(){return Lh().memoizedState}function UI(n,e,t,r){var i=Zd();Vo.flags|=n,i.memoizedState=kA(1|e,t,void 0,r===void 0?null:r)}function LL(n,e,t,r){var i=Lh();r=r===void 0?null:r;var s=void 0;if(Ua!==null){var a=Ua.memoizedState;if(s=a.destroy,r!==null&&c6(r,a.deps)){i.memoizedState=kA(e,t,s,r);return}}Vo.flags|=n,i.memoizedState=kA(1|e,t,s,r)}function zH(n,e){return UI(8390656,8,n,e)}function f6(n,e){return LL(2048,8,n,e)}function XQ(n,e){return LL(4,2,n,e)}function $Q(n,e){return LL(4,4,n,e)}function qQ(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function ZQ(n,e,t){return t=t!=null?t.concat([n]):null,LL(4,4,qQ.bind(null,e,n),t)}function d6(){}function YQ(n,e){var t=Lh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&c6(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function KQ(n,e){var t=Lh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&c6(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function JQ(n,e,t){return Xy&21?(qf(t,e)||(t=tQ(),Vo.lanes|=t,$y|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,iu=!0),n.memoizedState=t)}function nme(n,e){var t=Fs;Fs=t!==0&&4>t?t:4,n(!0);var r=t5.transition;t5.transition={};try{n(!1),e()}finally{Fs=t,t5.transition=r}}function QQ(){return Lh().memoizedState}function rme(n,e,t){var r=ev(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},eee(n))tee(e,t);else if(t=PQ(n,e,t,r),t!==null){var i=Mc();Wf(t,n,r,i),nee(t,e,r)}}function ime(n,e,t){var r=ev(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(eee(n))tee(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,t);if(i.hasEagerState=!0,i.eagerState=l,qf(l,a)){var o=e.interleaved;o===null?(i.next=i,i6(e)):(i.next=o.next,o.next=i),e.interleaved=i;return}}catch{}finally{}t=PQ(n,e,i,r),t!==null&&(i=Mc(),Wf(t,n,r,i),nee(t,e,r))}}function eee(n){var e=n.alternate;return n===Vo||e!==null&&e===Vo}function tee(n,e){zS=PR=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function nee(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,jz(n,t)}}var LR={readContext:Ph,useCallback:Ll,useContext:Ll,useEffect:Ll,useImperativeHandle:Ll,useInsertionEffect:Ll,useLayoutEffect:Ll,useMemo:Ll,useReducer:Ll,useRef:Ll,useState:Ll,useDebugValue:Ll,useDeferredValue:Ll,useTransition:Ll,useMutableSource:Ll,useSyncExternalStore:Ll,useId:Ll,unstable_isNewReconciler:!1},sme={readContext:Ph,useCallback:function(n,e){return Zd().memoizedState=[n,e===void 0?null:e],n},useContext:Ph,useEffect:zH,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,UI(4194308,4,qQ.bind(null,e,n),t)},useLayoutEffect:function(n,e){return UI(4194308,4,n,e)},useInsertionEffect:function(n,e){return UI(4,2,n,e)},useMemo:function(n,e){var t=Zd();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Zd();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=rme.bind(null,Vo,n),[r.memoizedState,n]},useRef:function(n){var e=Zd();return n={current:n},e.memoizedState=n},useState:NH,useDebugValue:d6,useDeferredValue:function(n){return Zd().memoizedState=n},useTransition:function(){var n=NH(!1),e=n[0];return n=nme.bind(null,n[1]),Zd().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Vo,i=Zd();if(Mo){if(t===void 0)throw Error(Zn(407));t=t()}else{if(t=e(),rl===null)throw Error(Zn(349));Xy&30||UQ(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,zH(VQ.bind(null,r,s,n),[n]),r.flags|=2048,kA(9,GQ.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Zd(),e=rl.identifierPrefix;if(Mo){var t=Em,r=Cm;t=(r&~(1<<32-jf(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=DA++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=tme++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},ome={readContext:Ph,useCallback:YQ,useContext:Ph,useEffect:f6,useImperativeHandle:ZQ,useInsertionEffect:XQ,useLayoutEffect:$Q,useMemo:KQ,useReducer:n5,useRef:WQ,useState:function(){return n5(BA)},useDebugValue:d6,useDeferredValue:function(n){var e=Lh();return JQ(e,Ua.memoizedState,n)},useTransition:function(){var n=n5(BA)[0],e=Lh().memoizedState;return[n,e]},useMutableSource:NQ,useSyncExternalStore:zQ,useId:QQ,unstable_isNewReconciler:!1},ame={readContext:Ph,useCallback:YQ,useContext:Ph,useEffect:f6,useImperativeHandle:ZQ,useInsertionEffect:XQ,useLayoutEffect:$Q,useMemo:KQ,useReducer:r5,useRef:WQ,useState:function(){return r5(BA)},useDebugValue:d6,useDeferredValue:function(n){var e=Lh();return Ua===null?e.memoizedState=n:JQ(e,Ua.memoizedState,n)},useTransition:function(){var n=r5(BA)[0],e=Lh().memoizedState;return[n,e]},useMutableSource:NQ,useSyncExternalStore:zQ,useId:QQ,unstable_isNewReconciler:!1};function Zb(n,e){try{var t="",r=e;do t+=kde(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function i5(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function YO(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var lme=typeof WeakMap=="function"?WeakMap:Map;function ree(n,e,t){t=Bm(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){BR||(BR=!0,oF=r),YO(n,e)},t}function iee(n,e,t){t=Bm(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){YO(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){YO(n,e),typeof r!="function"&&(Q0===null?Q0=new Set([this]):Q0.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function UH(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new lme;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=wme.bind(null,n,e,t),e.then(n,n))}function GH(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function VH(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Bm(-1,1),e.tag=2,J0(t,e,1))),t.lanes|=1),n)}var cme=eg.ReactCurrentOwner,iu=!1;function yc(n,e,t,r){e.child=n===null?OQ(e,null,t,r):$b(e,n.child,t,r)}function HH(n,e,t,r,i){t=t.render;var s=e.ref;return Ib(e,i),r=u6(n,e,t,r,s,i),t=h6(),n!==null&&!iu?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Vm(n,e,i)):(Mo&&t&&Jz(e),e.flags|=1,yc(n,e,r,i),e.child)}function jH(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!b6(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,see(n,e,s,r,i)):(n=jI(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:CA,t(a,r)&&n.ref===e.ref)return Vm(n,e,i)}return e.flags|=1,n=tv(s,r),n.ref=e.ref,n.return=e,e.child=n}function see(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(CA(s,r)&&n.ref===e.ref)if(iu=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(iu=!0);else return e.lanes=n.lanes,Vm(n,e,i)}return KO(n,e,t,r,i)}function oee(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ro(fb,Ru),Ru|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ro(fb,Ru),Ru|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,ro(fb,Ru),Ru|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,ro(fb,Ru),Ru|=r;return yc(n,e,i,t),e.child}function aee(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function KO(n,e,t,r,i){var s=cu(t)?jy:Zl.current;return s=Wb(e,s),Ib(e,i),t=u6(n,e,t,r,s,i),r=h6(),n!==null&&!iu?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Vm(n,e,i)):(Mo&&r&&Jz(e),e.flags|=1,yc(n,e,t,i),e.child)}function WH(n,e,t,r,i){if(cu(t)){var s=!0;AR(e)}else s=!1;if(Ib(e,i),e.stateNode===null)GI(n,e),BQ(e,t,r),ZO(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var o=a.context,h=t.contextType;typeof h=="object"&&h!==null?h=Ph(h):(h=cu(t)?jy:Zl.current,h=Wb(e,h));var d=t.getDerivedStateFromProps,m=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||o!==h)&&OH(e,a,r,h),P0=!1;var v=e.memoizedState;a.state=v,IR(e,r,a,i),o=e.memoizedState,l!==r||v!==o||lu.current||P0?(typeof d=="function"&&(qO(e,t,d,r),o=e.memoizedState),(l=P0||kH(e,t,l,r,v,o,h))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=o),a.props=r,a.state=o,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,LQ(n,e),l=e.memoizedProps,h=e.type===e.elementType?l:Df(e.type,l),a.props=h,m=e.pendingProps,v=a.context,o=t.contextType,typeof o=="object"&&o!==null?o=Ph(o):(o=cu(t)?jy:Zl.current,o=Wb(e,o));var y=t.getDerivedStateFromProps;(d=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||v!==o)&&OH(e,a,r,o),P0=!1,v=e.memoizedState,a.state=v,IR(e,r,a,i);var S=e.memoizedState;l!==m||v!==S||lu.current||P0?(typeof y=="function"&&(qO(e,t,y,r),S=e.memoizedState),(h=P0||kH(e,t,h,r,v,S,o)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,S,o),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,S,o)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),a.props=r,a.state=S,a.context=o,r=h):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),r=!1)}return JO(n,e,t,r,s,i)}function JO(n,e,t,r,i,s){aee(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&RH(e,t,!1),Vm(n,e,s);r=e.stateNode,cme.current=e;var l=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=$b(e,n.child,null,s),e.child=$b(e,null,l,s)):yc(n,e,l,s),e.memoizedState=r.state,i&&RH(e,t,!0),e.child}function lee(n){var e=n.stateNode;e.pendingContext?IH(n,e.pendingContext,e.pendingContext!==e.context):e.context&&IH(n,e.context,!1),o6(n,e.containerInfo)}function XH(n,e,t,r,i){return Xb(),e6(i),e.flags|=256,yc(n,e,t,r),e.child}var QO={dehydrated:null,treeContext:null,retryLane:0};function eF(n){return{baseLanes:n,cachePool:null,transitions:null}}function cee(n,e,t){var r=e.pendingProps,i=Uo.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),ro(Uo,i&1),n===null)return XO(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=kL(a,r,0,null),n=Py(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=eF(t),e.memoizedState=QO,n):p6(e,a));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return ume(n,e,a,r,l,i,t);if(s){s=r.fallback,a=e.mode,i=n.child,l=i.sibling;var o={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=o,e.deletions=null):(r=tv(i,o),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=tv(l,s):(s=Py(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=n.child.memoizedState,a=a===null?eF(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=QO,r}return s=n.child,n=s.sibling,r=tv(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function p6(n,e){return e=kL({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function wC(n,e,t,r){return r!==null&&e6(r),$b(e,n.child,null,t),n=p6(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ume(n,e,t,r,i,s,a){if(t)return e.flags&256?(e.flags&=-257,r=i5(Error(Zn(422))),wC(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=kL({mode:"visible",children:r.children},i,0,null),s=Py(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&$b(e,n.child,null,a),e.child.memoizedState=eF(a),e.memoizedState=QO,s);if(!(e.mode&1))return wC(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Zn(419)),r=i5(s,r,void 0),wC(n,e,a,r)}if(l=(a&n.childLanes)!==0,iu||l){if(r=rl,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Gm(n,i),Wf(r,n,i,-1))}return x6(),r=i5(Error(Zn(421))),wC(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Sme.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Du=K0(i.nextSibling),Bu=e,Mo=!0,Ff=null,n!==null&&(_h[yh++]=Cm,_h[yh++]=Em,_h[yh++]=Wy,Cm=n.id,Em=n.overflow,Wy=e),e=p6(e,r.children),e.flags|=4096,e)}function $H(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),$O(n.return,e,t)}function s5(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function uee(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(yc(n,e,r.children,t),r=Uo.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&$H(n,t,e);else if(n.tag===19)$H(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(ro(Uo,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&RR(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),s5(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&RR(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}s5(e,!0,t,null,s);break;case"together":s5(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function GI(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Vm(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),$y|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Zn(153));if(e.child!==null){for(n=e.child,t=tv(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=tv(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function hme(n,e,t){switch(e.tag){case 3:lee(e),Xb();break;case 5:FQ(e);break;case 1:cu(e.type)&&AR(e);break;case 4:o6(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ro(CR,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ro(Uo,Uo.current&1),e.flags|=128,null):t&e.child.childLanes?cee(n,e,t):(ro(Uo,Uo.current&1),n=Vm(n,e,t),n!==null?n.sibling:null);ro(Uo,Uo.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return uee(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ro(Uo,Uo.current),r)break;return null;case 22:case 23:return e.lanes=0,oee(n,e,t)}return Vm(n,e,t)}var hee,tF,fee,dee;hee=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};tF=function(){};fee=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,vy(sp.current);var s=null;switch(t){case"input":i=SO(n,i),r=SO(n,r),s=[];break;case"select":i=jo({},i,{value:void 0}),r=jo({},r,{value:void 0}),s=[];break;case"textarea":i=MO(n,i),r=MO(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=wR)}EO(t,r);var a;t=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(a in l)l.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(xA.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var o=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&o!==l&&(o!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in o)o.hasOwnProperty(a)&&l[a]!==o[a]&&(t||(t={}),t[a]=o[a])}else t||(s||(s=[]),s.push(h,t)),t=o;else h==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,l=l?l.__html:void 0,o!=null&&l!==o&&(s=s||[]).push(h,o)):h==="children"?typeof o!="string"&&typeof o!="number"||(s=s||[]).push(h,""+o):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(xA.hasOwnProperty(h)?(o!=null&&h==="onScroll"&&mo("scroll",n),s||l===o||(s=[])):(s=s||[]).push(h,o))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};dee=function(n,e,t,r){t!==r&&(e.flags|=4)};function w2(n,e){if(!Mo)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Dl(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function fme(n,e,t){var r=e.pendingProps;switch(Qz(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dl(e),null;case 1:return cu(e.type)&&SR(),Dl(e),null;case 3:return r=e.stateNode,qb(),vo(lu),vo(Zl),l6(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(xC(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ff!==null&&(cF(Ff),Ff=null))),tF(n,e),Dl(e),null;case 5:a6(e);var i=vy(LA.current);if(t=e.type,n!==null&&e.stateNode!=null)fee(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Zn(166));return Dl(e),null}if(n=vy(sp.current),xC(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Yd]=e,r[RA]=s,n=(e.mode&1)!==0,t){case"dialog":mo("cancel",r),mo("close",r);break;case"iframe":case"object":case"embed":mo("load",r);break;case"video":case"audio":for(i=0;i<_S.length;i++)mo(_S[i],r);break;case"source":mo("error",r);break;case"img":case"image":case"link":mo("error",r),mo("load",r);break;case"details":mo("toggle",r);break;case"input":nH(r,s),mo("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},mo("invalid",r);break;case"textarea":iH(r,s),mo("invalid",r)}EO(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&yC(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&yC(r.textContent,l,n),i=["children",""+l]):xA.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&mo("scroll",r)}switch(t){case"input":hC(r),rH(r,s,!0);break;case"textarea":hC(r),sH(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wR)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=UJ(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[Yd]=e,n[RA]=r,hee(n,e,!1,!1),e.stateNode=n;e:{switch(a=IO(t,r),t){case"dialog":mo("cancel",n),mo("close",n),i=r;break;case"iframe":case"object":case"embed":mo("load",n),i=r;break;case"video":case"audio":for(i=0;i<_S.length;i++)mo(_S[i],n);i=r;break;case"source":mo("error",n),i=r;break;case"img":case"image":case"link":mo("error",n),mo("load",n),i=r;break;case"details":mo("toggle",n),i=r;break;case"input":nH(n,r),i=SO(n,r),mo("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=jo({},r,{value:void 0}),mo("invalid",n);break;case"textarea":iH(n,r),i=MO(n,r),mo("invalid",n);break;default:i=r}EO(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var o=l[s];s==="style"?HJ(n,o):s==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&GJ(n,o)):s==="children"?typeof o=="string"?(t!=="textarea"||o!=="")&&bA(n,o):typeof o=="number"&&bA(n,""+o):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xA.hasOwnProperty(s)?o!=null&&s==="onScroll"&&mo("scroll",n):o!=null&&Nz(n,s,o,a))}switch(t){case"input":hC(n),rH(n,r,!1);break;case"textarea":hC(n),sH(n);break;case"option":r.value!=null&&n.setAttribute("value",""+lv(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Tb(n,!!r.multiple,s,!1):r.defaultValue!=null&&Tb(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=wR)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dl(e),null;case 6:if(n&&e.stateNode!=null)dee(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Zn(166));if(t=vy(LA.current),vy(sp.current),xC(e)){if(r=e.stateNode,t=e.memoizedProps,r[Yd]=e,(s=r.nodeValue!==t)&&(n=Bu,n!==null))switch(n.tag){case 3:yC(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&yC(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Yd]=e,e.stateNode=r}return Dl(e),null;case 13:if(vo(Uo),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Mo&&Du!==null&&e.mode&1&&!(e.flags&128))RQ(),Xb(),e.flags|=98560,s=!1;else if(s=xC(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(Zn(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Zn(317));s[Yd]=e}else Xb(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dl(e),s=!1}else Ff!==null&&(cF(Ff),Ff=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Uo.current&1?Va===0&&(Va=3):x6())),e.updateQueue!==null&&(e.flags|=4),Dl(e),null);case 4:return qb(),tF(n,e),n===null&&EA(e.stateNode.containerInfo),Dl(e),null;case 10:return r6(e.type._context),Dl(e),null;case 17:return cu(e.type)&&SR(),Dl(e),null;case 19:if(vo(Uo),s=e.memoizedState,s===null)return Dl(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)w2(s,!1);else{if(Va!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=RR(n),a!==null){for(e.flags|=128,w2(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ro(Uo,Uo.current&1|2),e.child}n=n.sibling}s.tail!==null&&da()>Yb&&(e.flags|=128,r=!0,w2(s,!1),e.lanes=4194304)}else{if(!r)if(n=RR(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),w2(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Mo)return Dl(e),null}else 2*da()-s.renderingStartTime>Yb&&t!==1073741824&&(e.flags|=128,r=!0,w2(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=da(),e.sibling=null,t=Uo.current,ro(Uo,r?t&1|2:t&1),e):(Dl(e),null);case 22:case 23:return y6(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ru&1073741824&&(Dl(e),e.subtreeFlags&6&&(e.flags|=8192)):Dl(e),null;case 24:return null;case 25:return null}throw Error(Zn(156,e.tag))}function dme(n,e){switch(Qz(e),e.tag){case 1:return cu(e.type)&&SR(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return qb(),vo(lu),vo(Zl),l6(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return a6(e),null;case 13:if(vo(Uo),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Zn(340));Xb()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return vo(Uo),null;case 4:return qb(),null;case 10:return r6(e.type._context),null;case 22:case 23:return y6(),null;case 24:return null;default:return null}}var SC=!1,Vl=!1,pme=typeof WeakSet=="function"?WeakSet:Set,Cr=null;function hb(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Qo(n,e,r)}else t.current=null}function nF(n,e,t){try{t()}catch(r){Qo(n,e,r)}}var qH=!1;function mme(n,e){if(zO=yR,n=vQ(),Kz(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,l=-1,o=-1,h=0,d=0,m=n,v=null;t:for(;;){for(var y;m!==t||i!==0&&m.nodeType!==3||(l=a+i),m!==s||r!==0&&m.nodeType!==3||(o=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(y=m.firstChild)!==null;)v=m,m=y;for(;;){if(m===n)break t;if(v===t&&++h===i&&(l=a),v===s&&++d===r&&(o=a),(y=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=y}t=l===-1||o===-1?null:{start:l,end:o}}else t=null}t=t||{start:0,end:0}}else t=null;for(UO={focusedElem:n,selectionRange:t},yR=!1,Cr=e;Cr!==null;)if(e=Cr,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Cr=n;else for(;Cr!==null;){e=Cr;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var E=S.memoizedProps,M=S.memoizedState,C=e.stateNode,L=C.getSnapshotBeforeUpdate(e.elementType===e.type?E:Df(e.type,E),M);C.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zn(163))}}catch(H){Qo(e,e.return,H)}if(n=e.sibling,n!==null){n.return=e.return,Cr=n;break}Cr=e.return}return S=qH,qH=!1,S}function US(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&nF(e,t,s)}i=i.next}while(i!==r)}}function DL(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function rF(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function pee(n){var e=n.alternate;e!==null&&(n.alternate=null,pee(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Yd],delete e[RA],delete e[HO],delete e[Kpe],delete e[Jpe])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function mee(n){return n.tag===5||n.tag===3||n.tag===4}function ZH(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||mee(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function iF(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=wR));else if(r!==4&&(n=n.child,n!==null))for(iF(n,e,t),n=n.sibling;n!==null;)iF(n,e,t),n=n.sibling}function sF(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(sF(n,e,t),n=n.sibling;n!==null;)sF(n,e,t),n=n.sibling}var vl=null,Of=!1;function o0(n,e,t){for(t=t.child;t!==null;)gee(n,e,t),t=t.sibling}function gee(n,e,t){if(ip&&typeof ip.onCommitFiberUnmount=="function")try{ip.onCommitFiberUnmount(TL,t)}catch{}switch(t.tag){case 5:Vl||hb(t,e);case 6:var r=vl,i=Of;vl=null,o0(n,e,t),vl=r,Of=i,vl!==null&&(Of?(n=vl,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):vl.removeChild(t.stateNode));break;case 18:vl!==null&&(Of?(n=vl,t=t.stateNode,n.nodeType===8?J4(n.parentNode,t):n.nodeType===1&&J4(n,t),TA(n)):J4(vl,t.stateNode));break;case 4:r=vl,i=Of,vl=t.stateNode.containerInfo,Of=!0,o0(n,e,t),vl=r,Of=i;break;case 0:case 11:case 14:case 15:if(!Vl&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&nF(t,e,a),i=i.next}while(i!==r)}o0(n,e,t);break;case 1:if(!Vl&&(hb(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Qo(t,e,l)}o0(n,e,t);break;case 21:o0(n,e,t);break;case 22:t.mode&1?(Vl=(r=Vl)||t.memoizedState!==null,o0(n,e,t),Vl=r):o0(n,e,t);break;default:o0(n,e,t)}}function YH(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new pme),e.forEach(function(r){var i=Ame.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Af(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:vl=l.stateNode,Of=!1;break e;case 3:vl=l.stateNode.containerInfo,Of=!0;break e;case 4:vl=l.stateNode.containerInfo,Of=!0;break e}l=l.return}if(vl===null)throw Error(Zn(160));gee(s,a,i),vl=null,Of=!1;var o=i.alternate;o!==null&&(o.return=null),i.return=null}catch(h){Qo(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vee(e,n),e=e.sibling}function vee(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Af(e,n),Gd(n),r&4){try{US(3,n,n.return),DL(3,n)}catch(E){Qo(n,n.return,E)}try{US(5,n,n.return)}catch(E){Qo(n,n.return,E)}}break;case 1:Af(e,n),Gd(n),r&512&&t!==null&&hb(t,t.return);break;case 5:if(Af(e,n),Gd(n),r&512&&t!==null&&hb(t,t.return),n.flags&32){var i=n.stateNode;try{bA(i,"")}catch(E){Qo(n,n.return,E)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,l=n.type,o=n.updateQueue;if(n.updateQueue=null,o!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&NJ(i,s),IO(l,a);var h=IO(l,s);for(a=0;a<o.length;a+=2){var d=o[a],m=o[a+1];d==="style"?HJ(i,m):d==="dangerouslySetInnerHTML"?GJ(i,m):d==="children"?bA(i,m):Nz(i,d,m,h)}switch(l){case"input":AO(i,s);break;case"textarea":zJ(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?Tb(i,!!s.multiple,y,!1):v!==!!s.multiple&&(s.defaultValue!=null?Tb(i,!!s.multiple,s.defaultValue,!0):Tb(i,!!s.multiple,s.multiple?[]:"",!1))}i[RA]=s}catch(E){Qo(n,n.return,E)}}break;case 6:if(Af(e,n),Gd(n),r&4){if(n.stateNode===null)throw Error(Zn(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(E){Qo(n,n.return,E)}}break;case 3:if(Af(e,n),Gd(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{TA(e.containerInfo)}catch(E){Qo(n,n.return,E)}break;case 4:Af(e,n),Gd(n);break;case 13:Af(e,n),Gd(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(v6=da())),r&4&&YH(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Vl=(h=Vl)||d,Af(e,n),Vl=h):Af(e,n),Gd(n),r&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!d&&n.mode&1)for(Cr=n,d=n.child;d!==null;){for(m=Cr=d;Cr!==null;){switch(v=Cr,y=v.child,v.tag){case 0:case 11:case 14:case 15:US(4,v,v.return);break;case 1:hb(v,v.return);var S=v.stateNode;if(typeof S.componentWillUnmount=="function"){r=v,t=v.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(E){Qo(r,t,E)}}break;case 5:hb(v,v.return);break;case 22:if(v.memoizedState!==null){JH(m);continue}}y!==null?(y.return=v,Cr=y):JH(m)}d=d.sibling}e:for(d=null,m=n;;){if(m.tag===5){if(d===null){d=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=m.stateNode,o=m.memoizedProps.style,a=o!=null&&o.hasOwnProperty("display")?o.display:null,l.style.display=VJ("display",a))}catch(E){Qo(n,n.return,E)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(E){Qo(n,n.return,E)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Af(e,n),Gd(n),r&4&&YH(n);break;case 21:break;default:Af(e,n),Gd(n)}}function Gd(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(mee(t)){var r=t;break e}t=t.return}throw Error(Zn(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(bA(i,""),r.flags&=-33);var s=ZH(n);sF(n,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=ZH(n);iF(n,l,a);break;default:throw Error(Zn(161))}}catch(o){Qo(n,n.return,o)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function gme(n,e,t){Cr=n,_ee(n)}function _ee(n,e,t){for(var r=(n.mode&1)!==0;Cr!==null;){var i=Cr,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||SC;if(!a){var l=i.alternate,o=l!==null&&l.memoizedState!==null||Vl;l=SC;var h=Vl;if(SC=a,(Vl=o)&&!h)for(Cr=i;Cr!==null;)a=Cr,o=a.child,a.tag===22&&a.memoizedState!==null?QH(i):o!==null?(o.return=a,Cr=o):QH(i);for(;s!==null;)Cr=s,_ee(s),s=s.sibling;Cr=i,SC=l,Vl=h}KH(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Cr=s):KH(n)}}function KH(n){for(;Cr!==null;){var e=Cr;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vl||DL(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vl)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Df(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&BH(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}BH(e,a,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var o=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&t.focus();break;case"img":o.src&&(t.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var d=h.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&TA(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zn(163))}Vl||e.flags&512&&rF(e)}catch(v){Qo(e,e.return,v)}}if(e===n){Cr=null;break}if(t=e.sibling,t!==null){t.return=e.return,Cr=t;break}Cr=e.return}}function JH(n){for(;Cr!==null;){var e=Cr;if(e===n){Cr=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Cr=t;break}Cr=e.return}}function QH(n){for(;Cr!==null;){var e=Cr;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{DL(4,e)}catch(o){Qo(e,t,o)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(o){Qo(e,i,o)}}var s=e.return;try{rF(e)}catch(o){Qo(e,s,o)}break;case 5:var a=e.return;try{rF(e)}catch(o){Qo(e,a,o)}}}catch(o){Qo(e,e.return,o)}if(e===n){Cr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Cr=l;break}Cr=e.return}}var vme=Math.ceil,DR=eg.ReactCurrentDispatcher,m6=eg.ReactCurrentOwner,Mh=eg.ReactCurrentBatchConfig,gs=0,rl=null,wa=null,bl=0,Ru=0,fb=Tv(0),Va=0,OA=null,$y=0,BL=0,g6=0,GS=null,eu=null,v6=0,Yb=1/0,vm=null,BR=!1,oF=null,Q0=null,AC=!1,z0=null,kR=0,VS=0,aF=null,VI=-1,HI=0;function Mc(){return gs&6?da():VI!==-1?VI:VI=da()}function ev(n){return n.mode&1?gs&2&&bl!==0?bl&-bl:eme.transition!==null?(HI===0&&(HI=tQ()),HI):(n=Fs,n!==0||(n=window.event,n=n===void 0?16:lQ(n.type)),n):1}function Wf(n,e,t,r){if(50<VS)throw VS=0,aF=null,Error(Zn(185));IT(n,t,r),(!(gs&2)||n!==rl)&&(n===rl&&(!(gs&2)&&(BL|=t),Va===4&&k0(n,bl)),uu(n,r),t===1&&gs===0&&!(e.mode&1)&&(Yb=da()+500,RL&&Mv()))}function uu(n,e){var t=n.callbackNode;epe(n,e);var r=_R(n,n===rl?bl:0);if(r===0)t!==null&&lH(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&lH(t),e===1)n.tag===0?Qpe(ej.bind(null,n)):CQ(ej.bind(null,n)),Zpe(function(){!(gs&6)&&Mv()}),t=null;else{switch(nQ(r)){case 1:t=Hz;break;case 4:t=QJ;break;case 16:t=vR;break;case 536870912:t=eQ;break;default:t=vR}t=Mee(t,yee.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function yee(n,e){if(VI=-1,HI=0,gs&6)throw Error(Zn(327));var t=n.callbackNode;if(Rb()&&n.callbackNode!==t)return null;var r=_R(n,n===rl?bl:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=OR(n,r);else{e=r;var i=gs;gs|=2;var s=bee();(rl!==n||bl!==e)&&(vm=null,Yb=da()+500,Ry(n,e));do try{xme();break}catch(l){xee(n,l)}while(!0);n6(),DR.current=s,gs=i,wa!==null?e=0:(rl=null,bl=0,e=Va)}if(e!==0){if(e===2&&(i=BO(n),i!==0&&(r=i,e=lF(n,i))),e===1)throw t=OA,Ry(n,0),k0(n,r),uu(n,da()),t;if(e===6)k0(n,r);else{if(i=n.current.alternate,!(r&30)&&!_me(i)&&(e=OR(n,r),e===2&&(s=BO(n),s!==0&&(r=s,e=lF(n,s))),e===1))throw t=OA,Ry(n,0),k0(n,r),uu(n,da()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(Zn(345));case 2:sy(n,eu,vm);break;case 3:if(k0(n,r),(r&130023424)===r&&(e=v6+500-da(),10<e)){if(_R(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Mc(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=VO(sy.bind(null,n,eu,vm),e);break}sy(n,eu,vm);break;case 4:if(k0(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-jf(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=da()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vme(r/1960))-r,10<r){n.timeoutHandle=VO(sy.bind(null,n,eu,vm),r);break}sy(n,eu,vm);break;case 5:sy(n,eu,vm);break;default:throw Error(Zn(329))}}}return uu(n,da()),n.callbackNode===t?yee.bind(null,n):null}function lF(n,e){var t=GS;return n.current.memoizedState.isDehydrated&&(Ry(n,e).flags|=256),n=OR(n,e),n!==2&&(e=eu,eu=t,e!==null&&cF(e)),n}function cF(n){eu===null?eu=n:eu.push.apply(eu,n)}function _me(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!qf(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function k0(n,e){for(e&=~g6,e&=~BL,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-jf(e),r=1<<t;n[t]=-1,e&=~r}}function ej(n){if(gs&6)throw Error(Zn(327));Rb();var e=_R(n,0);if(!(e&1))return uu(n,da()),null;var t=OR(n,e);if(n.tag!==0&&t===2){var r=BO(n);r!==0&&(e=r,t=lF(n,r))}if(t===1)throw t=OA,Ry(n,0),k0(n,e),uu(n,da()),t;if(t===6)throw Error(Zn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,sy(n,eu,vm),uu(n,da()),null}function _6(n,e){var t=gs;gs|=1;try{return n(e)}finally{gs=t,gs===0&&(Yb=da()+500,RL&&Mv())}}function qy(n){z0!==null&&z0.tag===0&&!(gs&6)&&Rb();var e=gs;gs|=1;var t=Mh.transition,r=Fs;try{if(Mh.transition=null,Fs=1,n)return n()}finally{Fs=r,Mh.transition=t,gs=e,!(gs&6)&&Mv()}}function y6(){Ru=fb.current,vo(fb)}function Ry(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,qpe(t)),wa!==null)for(t=wa.return;t!==null;){var r=t;switch(Qz(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&SR();break;case 3:qb(),vo(lu),vo(Zl),l6();break;case 5:a6(r);break;case 4:qb();break;case 13:vo(Uo);break;case 19:vo(Uo);break;case 10:r6(r.type._context);break;case 22:case 23:y6()}t=t.return}if(rl=n,wa=n=tv(n.current,null),bl=Ru=e,Va=0,OA=null,g6=BL=$y=0,eu=GS=null,gy!==null){for(e=0;e<gy.length;e++)if(t=gy[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}t.pending=r}gy=null}return n}function xee(n,e){do{var t=wa;try{if(n6(),zI.current=LR,PR){for(var r=Vo.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}PR=!1}if(Xy=0,nl=Ua=Vo=null,zS=!1,DA=0,m6.current=null,t===null||t.return===null){Va=1,OA=e,wa=null;break}e:{var s=n,a=t.return,l=t,o=e;if(e=bl,l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var h=o,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var v=d.alternate;v?(d.updateQueue=v.updateQueue,d.memoizedState=v.memoizedState,d.lanes=v.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=GH(a);if(y!==null){y.flags&=-257,VH(y,a,l,s,e),y.mode&1&&UH(s,h,e),e=y,o=h;var S=e.updateQueue;if(S===null){var E=new Set;E.add(o),e.updateQueue=E}else S.add(o);break e}else{if(!(e&1)){UH(s,h,e),x6();break e}o=Error(Zn(426))}}else if(Mo&&l.mode&1){var M=GH(a);if(M!==null){!(M.flags&65536)&&(M.flags|=256),VH(M,a,l,s,e),e6(Zb(o,l));break e}}s=o=Zb(o,l),Va!==4&&(Va=2),GS===null?GS=[s]:GS.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=ree(s,o,e);DH(s,C);break e;case 1:l=o;var L=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof L.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Q0===null||!Q0.has(k)))){s.flags|=65536,e&=-e,s.lanes|=e;var H=iee(s,l,e);DH(s,H);break e}}s=s.return}while(s!==null)}See(t)}catch(q){e=q,wa===t&&t!==null&&(wa=t=t.return);continue}break}while(!0)}function bee(){var n=DR.current;return DR.current=LR,n===null?LR:n}function x6(){(Va===0||Va===3||Va===2)&&(Va=4),rl===null||!($y&268435455)&&!(BL&268435455)||k0(rl,bl)}function OR(n,e){var t=gs;gs|=2;var r=bee();(rl!==n||bl!==e)&&(vm=null,Ry(n,e));do try{yme();break}catch(i){xee(n,i)}while(!0);if(n6(),gs=t,DR.current=r,wa!==null)throw Error(Zn(261));return rl=null,bl=0,Va}function yme(){for(;wa!==null;)wee(wa)}function xme(){for(;wa!==null&&!Wde();)wee(wa)}function wee(n){var e=Tee(n.alternate,n,Ru);n.memoizedProps=n.pendingProps,e===null?See(n):wa=e,m6.current=null}function See(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=dme(t,e),t!==null){t.flags&=32767,wa=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Va=6,wa=null;return}}else if(t=fme(t,e,Ru),t!==null){wa=t;return}if(e=e.sibling,e!==null){wa=e;return}wa=e=n}while(e!==null);Va===0&&(Va=5)}function sy(n,e,t){var r=Fs,i=Mh.transition;try{Mh.transition=null,Fs=1,bme(n,e,t,r)}finally{Mh.transition=i,Fs=r}return null}function bme(n,e,t,r){do Rb();while(z0!==null);if(gs&6)throw Error(Zn(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Zn(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(tpe(n,s),n===rl&&(wa=rl=null,bl=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||AC||(AC=!0,Mee(vR,function(){return Rb(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Mh.transition,Mh.transition=null;var a=Fs;Fs=1;var l=gs;gs|=4,m6.current=null,mme(n,t),vee(t,n),Gpe(UO),yR=!!zO,UO=zO=null,n.current=t,gme(t),Xde(),gs=l,Fs=a,Mh.transition=s}else n.current=t;if(AC&&(AC=!1,z0=n,kR=i),s=n.pendingLanes,s===0&&(Q0=null),Zde(t.stateNode),uu(n,da()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(BR)throw BR=!1,n=oF,oF=null,n;return kR&1&&n.tag!==0&&Rb(),s=n.pendingLanes,s&1?n===aF?VS++:(VS=0,aF=n):VS=0,Mv(),null}function Rb(){if(z0!==null){var n=nQ(kR),e=Mh.transition,t=Fs;try{if(Mh.transition=null,Fs=16>n?16:n,z0===null)var r=!1;else{if(n=z0,z0=null,kR=0,gs&6)throw Error(Zn(331));var i=gs;for(gs|=4,Cr=n.current;Cr!==null;){var s=Cr,a=s.child;if(Cr.flags&16){var l=s.deletions;if(l!==null){for(var o=0;o<l.length;o++){var h=l[o];for(Cr=h;Cr!==null;){var d=Cr;switch(d.tag){case 0:case 11:case 15:US(8,d,s)}var m=d.child;if(m!==null)m.return=d,Cr=m;else for(;Cr!==null;){d=Cr;var v=d.sibling,y=d.return;if(pee(d),d===h){Cr=null;break}if(v!==null){v.return=y,Cr=v;break}Cr=y}}}var S=s.alternate;if(S!==null){var E=S.child;if(E!==null){S.child=null;do{var M=E.sibling;E.sibling=null,E=M}while(E!==null)}}Cr=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Cr=a;else e:for(;Cr!==null;){if(s=Cr,s.flags&2048)switch(s.tag){case 0:case 11:case 15:US(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,Cr=C;break e}Cr=s.return}}var L=n.current;for(Cr=L;Cr!==null;){a=Cr;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,Cr=k;else e:for(a=L;Cr!==null;){if(l=Cr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:DL(9,l)}}catch(q){Qo(l,l.return,q)}if(l===a){Cr=null;break e}var H=l.sibling;if(H!==null){H.return=l.return,Cr=H;break e}Cr=l.return}}if(gs=i,Mv(),ip&&typeof ip.onPostCommitFiberRoot=="function")try{ip.onPostCommitFiberRoot(TL,n)}catch{}r=!0}return r}finally{Fs=t,Mh.transition=e}}return!1}function tj(n,e,t){e=Zb(t,e),e=ree(n,e,1),n=J0(n,e,1),e=Mc(),n!==null&&(IT(n,1,e),uu(n,e))}function Qo(n,e,t){if(n.tag===3)tj(n,n,t);else for(;e!==null;){if(e.tag===3){tj(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Q0===null||!Q0.has(r))){n=Zb(t,n),n=iee(e,n,1),e=J0(e,n,1),n=Mc(),e!==null&&(IT(e,1,n),uu(e,n));break}}e=e.return}}function wme(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Mc(),n.pingedLanes|=n.suspendedLanes&t,rl===n&&(bl&t)===t&&(Va===4||Va===3&&(bl&130023424)===bl&&500>da()-v6?Ry(n,0):g6|=t),uu(n,e)}function Aee(n,e){e===0&&(n.mode&1?(e=pC,pC<<=1,!(pC&130023424)&&(pC=4194304)):e=1);var t=Mc();n=Gm(n,e),n!==null&&(IT(n,e,t),uu(n,t))}function Sme(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Aee(n,t)}function Ame(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Zn(314))}r!==null&&r.delete(e),Aee(n,t)}var Tee;Tee=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||lu.current)iu=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return iu=!1,hme(n,e,t);iu=!!(n.flags&131072)}else iu=!1,Mo&&e.flags&1048576&&EQ(e,MR,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;GI(n,e),n=e.pendingProps;var i=Wb(e,Zl.current);Ib(e,t),i=u6(null,e,r,n,i,t);var s=h6();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cu(r)?(s=!0,AR(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,s6(e),i.updater=PL,e.stateNode=i,i._reactInternals=e,ZO(e,r,n,t),e=JO(null,e,r,!0,s,t)):(e.tag=0,Mo&&s&&Jz(e),yc(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(GI(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Mme(r),n=Df(r,n),i){case 0:e=KO(null,e,r,n,t);break e;case 1:e=WH(null,e,r,n,t);break e;case 11:e=HH(null,e,r,n,t);break e;case 14:e=jH(null,e,r,Df(r.type,n),t);break e}throw Error(Zn(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Df(r,i),KO(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Df(r,i),WH(n,e,r,i,t);case 3:e:{if(lee(e),n===null)throw Error(Zn(387));r=e.pendingProps,s=e.memoizedState,i=s.element,LQ(n,e),IR(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Zb(Error(Zn(423)),e),e=XH(n,e,r,t,i);break e}else if(r!==i){i=Zb(Error(Zn(424)),e),e=XH(n,e,r,t,i);break e}else for(Du=K0(e.stateNode.containerInfo.firstChild),Bu=e,Mo=!0,Ff=null,t=OQ(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Xb(),r===i){e=Vm(n,e,t);break e}yc(n,e,r,t)}e=e.child}return e;case 5:return FQ(e),n===null&&XO(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,a=i.children,GO(r,i)?a=null:s!==null&&GO(r,s)&&(e.flags|=32),aee(n,e),yc(n,e,a,t),e.child;case 6:return n===null&&XO(e),null;case 13:return cee(n,e,t);case 4:return o6(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=$b(e,null,r,t):yc(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Df(r,i),HH(n,e,r,i,t);case 7:return yc(n,e,e.pendingProps,t),e.child;case 8:return yc(n,e,e.pendingProps.children,t),e.child;case 12:return yc(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ro(CR,r._currentValue),r._currentValue=a,s!==null)if(qf(s.value,a)){if(s.children===i.children&&!lu.current){e=Vm(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var o=l.firstContext;o!==null;){if(o.context===r){if(s.tag===1){o=Bm(-1,t&-t),o.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var d=h.pending;d===null?o.next=o:(o.next=d.next,d.next=o),h.pending=o}}s.lanes|=t,o=s.alternate,o!==null&&(o.lanes|=t),$O(s.return,t,e),l.lanes|=t;break}o=o.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Zn(341));a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),$O(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}yc(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ib(e,t),i=Ph(i),r=r(i),e.flags|=1,yc(n,e,r,t),e.child;case 14:return r=e.type,i=Df(r,e.pendingProps),i=Df(r.type,i),jH(n,e,r,i,t);case 15:return see(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Df(r,i),GI(n,e),e.tag=1,cu(r)?(n=!0,AR(e)):n=!1,Ib(e,t),BQ(e,r,i),ZO(e,r,i,t),JO(null,e,r,!0,n,t);case 19:return uee(n,e,t);case 22:return oee(n,e,t)}throw Error(Zn(156,e.tag))};function Mee(n,e){return JJ(n,e)}function Tme(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ah(n,e,t,r){return new Tme(n,e,t,r)}function b6(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Mme(n){if(typeof n=="function")return b6(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Uz)return 11;if(n===Gz)return 14}return 2}function tv(n,e){var t=n.alternate;return t===null?(t=Ah(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function jI(n,e,t,r,i,s){var a=2;if(r=n,typeof n=="function")b6(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case nb:return Py(t.children,i,s,e);case zz:a=8,i|=8;break;case yO:return n=Ah(12,t,e,i|2),n.elementType=yO,n.lanes=s,n;case xO:return n=Ah(13,t,e,i),n.elementType=xO,n.lanes=s,n;case bO:return n=Ah(19,t,e,i),n.elementType=bO,n.lanes=s,n;case kJ:return kL(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case DJ:a=10;break e;case BJ:a=9;break e;case Uz:a=11;break e;case Gz:a=14;break e;case R0:a=16,r=null;break e}throw Error(Zn(130,n==null?n:typeof n,""))}return e=Ah(a,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Py(n,e,t,r){return n=Ah(7,n,r,e),n.lanes=t,n}function kL(n,e,t,r){return n=Ah(22,n,r,e),n.elementType=kJ,n.lanes=t,n.stateNode={isHidden:!1},n}function o5(n,e,t){return n=Ah(6,n,null,e),n.lanes=t,n}function a5(n,e,t){return e=Ah(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Cme(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=G4(0),this.expirationTimes=G4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G4(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function w6(n,e,t,r,i,s,a,l,o){return n=new Cme(n,e,t,l,o),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ah(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},s6(s),n}function Eme(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tb,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Cee(n){if(!n)return cv;n=n._reactInternals;e:{if(p1(n)!==n||n.tag!==1)throw Error(Zn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Zn(171))}if(n.tag===1){var t=n.type;if(cu(t))return MQ(n,t,e)}return e}function Eee(n,e,t,r,i,s,a,l,o){return n=w6(t,r,!0,n,i,s,a,l,o),n.context=Cee(null),t=n.current,r=Mc(),i=ev(t),s=Bm(r,i),s.callback=e??null,J0(t,s,i),n.current.lanes=i,IT(n,i,r),uu(n,r),n}function OL(n,e,t,r){var i=e.current,s=Mc(),a=ev(i);return t=Cee(t),e.context===null?e.context=t:e.pendingContext=t,e=Bm(s,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=J0(i,e,a),n!==null&&(Wf(n,i,a,s),NI(n,i,a)),a}function FR(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function nj(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function S6(n,e){nj(n,e),(n=n.alternate)&&nj(n,e)}function Ime(){return null}var Iee=typeof reportError=="function"?reportError:function(n){console.error(n)};function A6(n){this._internalRoot=n}FL.prototype.render=A6.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Zn(409));OL(n,e,null,null)};FL.prototype.unmount=A6.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;qy(function(){OL(null,n,null,null)}),e[Um]=null}};function FL(n){this._internalRoot=n}FL.prototype.unstable_scheduleHydration=function(n){if(n){var e=sQ();n={blockedOn:null,target:n,priority:e};for(var t=0;t<B0.length&&e!==0&&e<B0[t].priority;t++);B0.splice(t,0,n),t===0&&aQ(n)}};function T6(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function NL(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function rj(){}function Rme(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=FR(a);s.call(h)}}var a=Eee(e,r,n,0,null,!1,!1,"",rj);return n._reactRootContainer=a,n[Um]=a.current,EA(n.nodeType===8?n.parentNode:n),qy(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=FR(o);l.call(h)}}var o=w6(n,0,!1,null,null,!1,!1,"",rj);return n._reactRootContainer=o,n[Um]=o.current,EA(n.nodeType===8?n.parentNode:n),qy(function(){OL(e,o,t,r)}),o}function zL(n,e,t,r,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var o=FR(a);l.call(o)}}OL(e,a,n,i)}else a=Rme(t,e,n,i,r);return FR(a)}rQ=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=vS(e.pendingLanes);t!==0&&(jz(e,t|1),uu(e,da()),!(gs&6)&&(Yb=da()+500,Mv()))}break;case 13:qy(function(){var r=Gm(n,1);if(r!==null){var i=Mc();Wf(r,n,1,i)}}),S6(n,1)}};Wz=function(n){if(n.tag===13){var e=Gm(n,134217728);if(e!==null){var t=Mc();Wf(e,n,134217728,t)}S6(n,134217728)}};iQ=function(n){if(n.tag===13){var e=ev(n),t=Gm(n,e);if(t!==null){var r=Mc();Wf(t,n,e,r)}S6(n,e)}};sQ=function(){return Fs};oQ=function(n,e){var t=Fs;try{return Fs=n,e()}finally{Fs=t}};PO=function(n,e,t){switch(e){case"input":if(AO(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=IL(r);if(!i)throw Error(Zn(90));FJ(r),AO(r,i)}}}break;case"textarea":zJ(n,t);break;case"select":e=t.value,e!=null&&Tb(n,!!t.multiple,e,!1)}};XJ=_6;$J=qy;var Pme={usingClientEntryPoint:!1,Events:[PT,ob,IL,jJ,WJ,_6]},S2={findFiberByHostInstance:my,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Lme={bundleType:S2.bundleType,version:S2.version,rendererPackageName:S2.rendererPackageName,rendererConfig:S2.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:eg.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=YJ(n),n===null?null:n.stateNode},findFiberByHostInstance:S2.findFiberByHostInstance||Ime,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var TC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!TC.isDisabled&&TC.supportsFiber)try{TL=TC.inject(Lme),ip=TC}catch{}}Uu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pme;Uu.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T6(e))throw Error(Zn(200));return Eme(n,e,null,t)};Uu.createRoot=function(n,e){if(!T6(n))throw Error(Zn(299));var t=!1,r="",i=Iee;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=w6(n,1,!1,null,null,t,!1,r,i),n[Um]=e.current,EA(n.nodeType===8?n.parentNode:n),new A6(e)};Uu.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Zn(188)):(n=Object.keys(n).join(","),Error(Zn(268,n)));return n=YJ(e),n=n===null?null:n.stateNode,n};Uu.flushSync=function(n){return qy(n)};Uu.hydrate=function(n,e,t){if(!NL(e))throw Error(Zn(200));return zL(null,n,e,!0,t)};Uu.hydrateRoot=function(n,e,t){if(!T6(n))throw Error(Zn(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",a=Iee;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Eee(e,null,n,1,t??null,i,!1,s,a),n[Um]=e.current,EA(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new FL(e)};Uu.render=function(n,e,t){if(!NL(e))throw Error(Zn(200));return zL(null,n,e,!1,t)};Uu.unmountComponentAtNode=function(n){if(!NL(n))throw Error(Zn(40));return n._reactRootContainer?(qy(function(){zL(null,null,n,!1,function(){n._reactRootContainer=null,n[Um]=null})}),!0):!1};Uu.unstable_batchedUpdates=_6;Uu.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!NL(t))throw Error(Zn(200));if(n==null||n._reactInternals===void 0)throw Error(Zn(38));return zL(n,e,t,!1,r)};Uu.version="18.2.0-next-9e3b772b8-20220608";function Ree(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ree)}catch(n){console.error(n)}}Ree(),EJ.exports=Uu;var Xf=EJ.exports,Pee,ij=Xf;Pee=vO.createRoot=ij.createRoot,vO.hydrateRoot=ij.hydrateRoot;/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function FA(){return FA=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},FA.apply(this,arguments)}var U0;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(U0||(U0={}));const sj="popstate";function Dme(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:l}=r.location;return uF("",{pathname:s,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:NR(i)}return kme(e,t,null,n)}function ra(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function M6(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bme(){return Math.random().toString(36).substr(2,8)}function oj(n,e){return{usr:n.state,key:n.key,idx:e}}function uF(n,e,t,r){return t===void 0&&(t=null),FA({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?gw(e):e,{state:t,key:e&&e.key||r||Bme()})}function NR(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function gw(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function kme(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,l=U0.Pop,o=null,h=d();h==null&&(h=0,a.replaceState(FA({},a.state,{idx:h}),""));function d(){return(a.state||{idx:null}).idx}function m(){l=U0.Pop;let M=d(),C=M==null?null:M-h;h=M,o&&o({action:l,location:E.location,delta:C})}function v(M,C){l=U0.Push;let L=uF(E.location,M,C);h=d()+1;let k=oj(L,h),H=E.createHref(L);try{a.pushState(k,"",H)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;i.location.assign(H)}s&&o&&o({action:l,location:E.location,delta:1})}function y(M,C){l=U0.Replace;let L=uF(E.location,M,C);h=d();let k=oj(L,h),H=E.createHref(L);a.replaceState(k,"",H),s&&o&&o({action:l,location:E.location,delta:0})}function S(M){let C=i.location.origin!=="null"?i.location.origin:i.location.href,L=typeof M=="string"?M:NR(M);return ra(C,"No window.location.(origin|href) available to create URL for href: "+L),new URL(L,C)}let E={get action(){return l},get location(){return n(i,a)},listen(M){if(o)throw new Error("A history only accepts one active listener");return i.addEventListener(sj,m),o=M,()=>{i.removeEventListener(sj,m),o=null}},createHref(M){return e(i,M)},createURL:S,encodeLocation(M){let C=S(M);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:v,replace:y,go(M){return a.go(M)}};return E}var aj;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(aj||(aj={}));function Ome(n,e,t){t===void 0&&(t="/");let r=typeof e=="string"?gw(e):e,i=NA(r.pathname||"/",t);if(i==null)return null;let s=Lee(n);Fme(s);let a=null;for(let l=0;a==null&&l<s.length;++l)a=Xme(s[l],qme(i));return a}function Lee(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,l)=>{let o={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};o.relativePath.startsWith("/")&&(ra(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),o.relativePath=o.relativePath.slice(r.length));let h=nv([r,o.relativePath]),d=t.concat(o);s.children&&s.children.length>0&&(ra(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Lee(s.children,e,d,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:jme(h,s.index),routesMeta:d})};return n.forEach((s,a)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,a);else for(let o of Dee(s.path))i(s,a,o)}),e}function Dee(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=Dee(r.join("/")),l=[];return l.push(...a.map(o=>o===""?s:[s,o].join("/"))),i&&l.push(...a),l.map(o=>n.startsWith("/")&&o===""?"/":o)}function Fme(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Wme(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Nme=/^:\w+$/,zme=3,Ume=2,Gme=1,Vme=10,Hme=-2,lj=n=>n==="*";function jme(n,e){let t=n.split("/"),r=t.length;return t.some(lj)&&(r+=Hme),e&&(r+=Ume),t.filter(i=>!lj(i)).reduce((i,s)=>i+(Nme.test(s)?zme:s===""?Gme:Vme),r)}function Wme(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Xme(n,e){let{routesMeta:t}=n,r={},i="/",s=[];for(let a=0;a<t.length;++a){let l=t[a],o=a===t.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=hF({path:l.relativePath,caseSensitive:l.caseSensitive,end:o},h);if(!d)return null;Object.assign(r,d.params);let m=l.route;s.push({params:r,pathname:nv([i,d.pathname]),pathnameBase:Qme(nv([i,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(i=nv([i,d.pathnameBase]))}return s}function hF(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=$me(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((h,d,m)=>{let{paramName:v,isOptional:y}=d;if(v==="*"){let E=l[m]||"";a=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}const S=l[m];return y&&!S?h[v]=void 0:h[v]=Zme(S||"",v),h},{}),pathname:s,pathnameBase:a,pattern:n}}function $me(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),M6(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(a,l,o)=>(r.push({paramName:l,isOptional:o!=null}),o?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function qme(n){try{return decodeURI(n)}catch(e){return M6(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Zme(n,e){try{return decodeURIComponent(n)}catch(t){return M6(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function NA(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Yme(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?gw(n):n;return{pathname:t?t.startsWith("/")?t:Kme(t,e):e,search:ege(r),hash:tge(i)}}function Kme(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function l5(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jme(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Bee(n,e){let t=Jme(n);return e?t.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function kee(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=gw(n):(i=FA({},n),ra(!i.pathname||!i.pathname.includes("?"),l5("?","pathname","search",i)),ra(!i.pathname||!i.pathname.includes("#"),l5("#","pathname","hash",i)),ra(!i.search||!i.search.includes("#"),l5("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,l;if(a==null)l=t;else{let m=e.length-1;if(!r&&a.startsWith("..")){let v=a.split("/");for(;v[0]==="..";)v.shift(),m-=1;i.pathname=v.join("/")}l=m>=0?e[m]:"/"}let o=Yme(i,l),h=a&&a!=="/"&&a.endsWith("/"),d=(s||a===".")&&t.endsWith("/");return!o.pathname.endsWith("/")&&(h||d)&&(o.pathname+="/"),o}const nv=n=>n.join("/").replace(/\/\/+/g,"/"),Qme=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ege=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,tge=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function nge(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Oee=["post","put","patch","delete"];new Set(Oee);const rge=["get",...Oee];new Set(rge);/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zA(){return zA=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},zA.apply(this,arguments)}const UL=Ae.createContext(null),Fee=Ae.createContext(null),Cv=Ae.createContext(null),GL=Ae.createContext(null),m1=Ae.createContext({outlet:null,matches:[],isDataRoute:!1}),Nee=Ae.createContext(null);function ige(n,e){let{relative:t}=e===void 0?{}:e;DT()||ra(!1);let{basename:r,navigator:i}=Ae.useContext(Cv),{hash:s,pathname:a,search:l}=VL(n,{relative:t}),o=a;return r!=="/"&&(o=a==="/"?r:nv([r,a])),i.createHref({pathname:o,search:l,hash:s})}function DT(){return Ae.useContext(GL)!=null}function BT(){return DT()||ra(!1),Ae.useContext(GL).location}function zee(n){Ae.useContext(Cv).static||Ae.useLayoutEffect(n)}function sge(){let{isDataRoute:n}=Ae.useContext(m1);return n?_ge():oge()}function oge(){DT()||ra(!1);let n=Ae.useContext(UL),{basename:e,future:t,navigator:r}=Ae.useContext(Cv),{matches:i}=Ae.useContext(m1),{pathname:s}=BT(),a=JSON.stringify(Bee(i,t.v7_relativeSplatPath)),l=Ae.useRef(!1);return zee(()=>{l.current=!0}),Ae.useCallback(function(h,d){if(d===void 0&&(d={}),!l.current)return;if(typeof h=="number"){r.go(h);return}let m=kee(h,JSON.parse(a),s,d.relative==="path");n==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:nv([e,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[e,r,a,s,n])}function VL(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=Ae.useContext(Cv),{matches:i}=Ae.useContext(m1),{pathname:s}=BT(),a=JSON.stringify(Bee(i,r.v7_relativeSplatPath));return Ae.useMemo(()=>kee(n,JSON.parse(a),s,t==="path"),[n,a,s,t])}function age(n,e){return lge(n,e)}function lge(n,e,t,r){DT()||ra(!1);let{navigator:i}=Ae.useContext(Cv),{matches:s}=Ae.useContext(m1),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let o=a?a.pathnameBase:"/";a&&a.route;let h=BT(),d;if(e){var m;let M=typeof e=="string"?gw(e):e;o==="/"||(m=M.pathname)!=null&&m.startsWith(o)||ra(!1),d=M}else d=h;let v=d.pathname||"/",y=o==="/"?v:v.slice(o.length)||"/",S=Ome(n,{pathname:y}),E=dge(S&&S.map(M=>Object.assign({},M,{params:Object.assign({},l,M.params),pathname:nv([o,i.encodeLocation?i.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?o:nv([o,i.encodeLocation?i.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),s,t,r);return e&&E?Ae.createElement(GL.Provider,{value:{location:zA({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:U0.Pop}},E):E}function cge(){let n=vge(),e=nge(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ae.createElement(Ae.Fragment,null,Ae.createElement("h2",null,"Unexpected Application Error!"),Ae.createElement("h3",{style:{fontStyle:"italic"}},e),t?Ae.createElement("pre",{style:i},t):null,null)}const uge=Ae.createElement(cge,null);class hge extends Ae.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Ae.createElement(m1.Provider,{value:this.props.routeContext},Ae.createElement(Nee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fge(n){let{routeContext:e,match:t,children:r}=n,i=Ae.useContext(UL);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),Ae.createElement(m1.Provider,{value:e},r)}function dge(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let a=n,l=(i=t)==null?void 0:i.errors;if(l!=null){let d=a.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id]));d>=0||ra(!1),a=a.slice(0,Math.min(a.length,d+1))}let o=!1,h=-1;if(t&&r&&r.v7_partialHydration)for(let d=0;d<a.length;d++){let m=a[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=d),m.route.id){let{loaderData:v,errors:y}=t,S=m.route.loader&&v[m.route.id]===void 0&&(!y||y[m.route.id]===void 0);if(m.route.lazy||S){o=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((d,m,v)=>{let y,S=!1,E=null,M=null;t&&(y=l&&m.route.id?l[m.route.id]:void 0,E=m.route.errorElement||uge,o&&(h<0&&v===0?(S=!0,M=null):h===v&&(S=!0,M=m.route.hydrateFallbackElement||null)));let C=e.concat(a.slice(0,v+1)),L=()=>{let k;return y?k=E:S?k=M:m.route.Component?k=Ae.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=d,Ae.createElement(fge,{match:m,routeContext:{outlet:d,matches:C,isDataRoute:t!=null},children:k})};return t&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?Ae.createElement(hge,{location:t.location,revalidation:t.revalidation,component:E,error:y,children:L(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):L()},null)}var Uee=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Uee||{}),zR=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(zR||{});function pge(n){let e=Ae.useContext(UL);return e||ra(!1),e}function mge(n){let e=Ae.useContext(Fee);return e||ra(!1),e}function gge(n){let e=Ae.useContext(m1);return e||ra(!1),e}function Gee(n){let e=gge(),t=e.matches[e.matches.length-1];return t.route.id||ra(!1),t.route.id}function vge(){var n;let e=Ae.useContext(Nee),t=mge(zR.UseRouteError),r=Gee(zR.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function _ge(){let{router:n}=pge(Uee.UseNavigateStable),e=Gee(zR.UseNavigateStable),t=Ae.useRef(!1);return zee(()=>{t.current=!0}),Ae.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,zA({fromRouteId:e},s)))},[n,e])}function qd(n){ra(!1)}function yge(n){let{basename:e="/",children:t=null,location:r,navigationType:i=U0.Pop,navigator:s,static:a=!1,future:l}=n;DT()&&ra(!1);let o=e.replace(/^\/*/,"/"),h=Ae.useMemo(()=>({basename:o,navigator:s,static:a,future:zA({v7_relativeSplatPath:!1},l)}),[o,l,s,a]);typeof r=="string"&&(r=gw(r));let{pathname:d="/",search:m="",hash:v="",state:y=null,key:S="default"}=r,E=Ae.useMemo(()=>{let M=NA(d,o);return M==null?null:{location:{pathname:M,search:m,hash:v,state:y,key:S},navigationType:i}},[o,d,m,v,y,S,i]);return E==null?null:Ae.createElement(Cv.Provider,{value:h},Ae.createElement(GL.Provider,{children:t,value:E}))}function xge(n){let{children:e,location:t}=n;return age(fF(e),t)}new Promise(()=>{});function fF(n,e){e===void 0&&(e=[]);let t=[];return Ae.Children.forEach(n,(r,i)=>{if(!Ae.isValidElement(r))return;let s=[...e,i];if(r.type===Ae.Fragment){t.push.apply(t,fF(r.props.children,s));return}r.type!==qd&&ra(!1),!r.props.index||!r.props.children||ra(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=fF(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function UR(){return UR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},UR.apply(this,arguments)}function Vee(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function bge(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function wge(n,e){return n.button===0&&(!e||e==="_self")&&!bge(n)}const Sge=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],Age=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],Tge=Ae.createContext({isTransitioning:!1}),Mge="startTransition",cj=dR[Mge];function Cge(n){let{basename:e,children:t,future:r,window:i}=n,s=Ae.useRef();s.current==null&&(s.current=Dme({window:i,v5Compat:!0}));let a=s.current,[l,o]=Ae.useState({action:a.action,location:a.location}),{v7_startTransition:h}=r||{},d=Ae.useCallback(m=>{h&&cj?cj(()=>o(m)):o(m)},[o,h]);return Ae.useLayoutEffect(()=>a.listen(d),[a,d]),Ae.createElement(yge,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:a,future:r})}const Ege=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ige=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G0=Ae.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:l,target:o,to:h,preventScrollReset:d,unstable_viewTransition:m}=e,v=Vee(e,Sge),{basename:y}=Ae.useContext(Cv),S,E=!1;if(typeof h=="string"&&Ige.test(h)&&(S=h,Ege))try{let k=new URL(window.location.href),H=h.startsWith("//")?new URL(k.protocol+h):new URL(h),q=NA(H.pathname,y);H.origin===k.origin&&q!=null?h=q+H.search+H.hash:E=!0}catch{}let M=ige(h,{relative:i}),C=Pge(h,{replace:a,state:l,target:o,preventScrollReset:d,relative:i,unstable_viewTransition:m});function L(k){r&&r(k),k.defaultPrevented||C(k)}return Ae.createElement("a",UR({},v,{href:S||M,onClick:E||s?r:L,ref:t,target:o}))}),MC=Ae.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:a=!1,style:l,to:o,unstable_viewTransition:h,children:d}=e,m=Vee(e,Age),v=VL(o,{relative:m.relative}),y=BT(),S=Ae.useContext(Fee),{navigator:E}=Ae.useContext(Cv),M=S!=null&&Lge(v)&&h===!0,C=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,L=y.pathname,k=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;i||(L=L.toLowerCase(),k=k?k.toLowerCase():null,C=C.toLowerCase());const H=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let q=L===C||!a&&L.startsWith(C)&&L.charAt(H)==="/",Z=k!=null&&(k===C||!a&&k.startsWith(C)&&k.charAt(C.length)==="/"),ee={isActive:q,isPending:Z,isTransitioning:M},re=q?r:void 0,se;typeof s=="function"?se=s(ee):se=[s,q?"active":null,Z?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let ae=typeof l=="function"?l(ee):l;return Ae.createElement(G0,UR({},m,{"aria-current":re,className:se,ref:t,style:ae,to:o,unstable_viewTransition:h}),typeof d=="function"?d(ee):d)});var dF;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(dF||(dF={}));var uj;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(uj||(uj={}));function Rge(n){let e=Ae.useContext(UL);return e||ra(!1),e}function Pge(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:l}=e===void 0?{}:e,o=sge(),h=BT(),d=VL(n,{relative:a});return Ae.useCallback(m=>{if(wge(m,t)){m.preventDefault();let v=r!==void 0?r:NR(h)===NR(d);o(n,{replace:v,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:l})}},[h,o,d,r,i,t,n,s,a,l])}function Lge(n,e){e===void 0&&(e={});let t=Ae.useContext(Tge);t==null&&ra(!1);let{basename:r}=Rge(dF.useViewTransitionState),i=VL(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=NA(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=NA(t.nextLocation.pathname,r)||t.nextLocation.pathname;return hF(i.pathname,a)!=null||hF(i.pathname,s)!=null}function UA(){return UA=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},UA.apply(this,arguments)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const kT="166",oy={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ay={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Hee=0,pF=1,jee=2,Dge=3,Wee=0,HL=1,HS=2,Bf=3,Dh=0,Cc=1,wc=2,op=0,Ly=1,Kb=2,mF=3,gF=4,Xee=5,O0=100,$ee=101,qee=102,Zee=103,Yee=104,Kee=200,Jee=201,Qee=202,ete=203,GR=204,VR=205,tte=206,nte=207,rte=208,ite=209,ste=210,ote=211,ate=212,lte=213,cte=214,ute=0,hte=1,fte=2,GA=3,dte=4,pte=5,mte=6,gte=7,OT=0,vte=1,_te=2,ap=0,yte=1,xte=2,jL=3,WL=4,bte=5,wte=6,Ste=7,vF="attached",Ate="detached",XL=300,Hm=301,uv=302,VA=303,HA=304,vw=306,Bh=1e3,su=1001,Zy=1002,Sa=1003,FT=1004,Bge=1004,V0=1005,kge=1005,Eo=1006,Dy=1007,Oge=1007,ou=1008,Fge=1008,Zf=1009,C6=1010,E6=1011,Jb=1012,$L=1013,jm=1014,Ac=1015,Ch=1016,qL=1017,ZL=1018,Yy=1020,I6=35902,R6=1021,P6=1022,Wl=1023,L6=1024,D6=1025,By=1026,Ky=1027,NT=1028,zT=1029,B6=1030,YL=1031,Nge=1032,KL=1033,jS=33776,WS=33777,XS=33778,$S=33779,HR=35840,jR=35841,WR=35842,XR=35843,$R=36196,qR=37492,ZR=37496,YR=37808,KR=37809,JR=37810,QR=37811,eP=37812,tP=37813,nP=37814,rP=37815,iP=37816,sP=37817,oP=37818,aP=37819,lP=37820,cP=37821,qS=36492,uP=36494,hP=36495,k6=36283,fP=36284,dP=36285,pP=36286,Tte=2200,Mte=2201,Cte=2202,Jy=2300,hv=2301,WI=2302,_y=2400,yy=2401,jA=2402,JL=2500,O6=2501,F6=0,UT=1,Qy=2,Ete=3200,Ite=3201,Ev=0,Rte=1,Am="",To="srgb",Ha="srgb-linear",QL="display-p3",GT="display-p3-linear",WA="linear",to="srgb",XA="rec709",$A="p3",zge=0,ly=7680,Uge=7681,Gge=7682,Vge=7683,Hge=34055,jge=34056,Wge=5386,Xge=512,$ge=513,qge=514,Zge=515,Yge=516,Kge=517,Jge=518,_F=519,Pte=512,Lte=513,Dte=514,N6=515,Bte=516,kte=517,Ote=518,Fte=519,qA=35044,Qge=35048,e0e=35040,t0e=35045,n0e=35049,r0e=35041,i0e=35046,s0e=35050,o0e=35042,a0e="100",yF="300 es",Qd=2e3,ZA=2001;class vp{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const Bl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hj=1234567;const ky=Math.PI/180,Qb=180/Math.PI;function ku(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Bl[n&255]+Bl[n>>8&255]+Bl[n>>16&255]+Bl[n>>24&255]+"-"+Bl[e&255]+Bl[e>>8&255]+"-"+Bl[e>>16&15|64]+Bl[e>>24&255]+"-"+Bl[t&63|128]+Bl[t>>8&255]+"-"+Bl[t>>16&255]+Bl[t>>24&255]+Bl[r&255]+Bl[r>>8&255]+Bl[r>>16&255]+Bl[r>>24&255]).toLowerCase()}function ta(n,e,t){return Math.max(e,Math.min(t,n))}function z6(n,e){return(n%e+e)%e}function l0e(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function c0e(n,e,t){return n!==e?(t-n)/(e-n):0}function ZS(n,e,t){return(1-t)*n+t*e}function u0e(n,e,t,r){return ZS(n,e,1-Math.exp(-t*r))}function h0e(n,e=1){return e-Math.abs(z6(n,e*2)-e)}function f0e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function d0e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function p0e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function m0e(n,e){return n+Math.random()*(e-n)}function g0e(n){return n*(.5-Math.random())}function v0e(n){n!==void 0&&(hj=n);let e=hj+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function _0e(n){return n*ky}function y0e(n){return n*Qb}function x0e(n){return(n&n-1)===0&&n!==0}function b0e(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function w0e(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function S0e(n,e,t,r,i){const s=Math.cos,a=Math.sin,l=s(t/2),o=a(t/2),h=s((e+r)/2),d=a((e+r)/2),m=s((e-r)/2),v=a((e-r)/2),y=s((r-e)/2),S=a((r-e)/2);switch(i){case"XYX":n.set(l*d,o*m,o*v,l*h);break;case"YZY":n.set(o*v,l*d,o*m,l*h);break;case"ZXZ":n.set(o*m,o*v,l*d,l*h);break;case"XZX":n.set(l*d,o*S,o*y,l*h);break;case"YXY":n.set(o*y,l*d,o*S,l*h);break;case"ZYZ":n.set(o*S,o*y,l*d,l*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Sc(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Si(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const no={DEG2RAD:ky,RAD2DEG:Qb,generateUUID:ku,clamp:ta,euclideanModulo:z6,mapLinear:l0e,inverseLerp:c0e,lerp:ZS,damp:u0e,pingpong:h0e,smoothstep:f0e,smootherstep:d0e,randInt:p0e,randFloat:m0e,randFloatSpread:g0e,seededRandom:v0e,degToRad:_0e,radToDeg:y0e,isPowerOfTwo:x0e,ceilPowerOfTwo:b0e,floorPowerOfTwo:w0e,setQuaternionFromProperEuler:S0e,normalize:Si,denormalize:Sc};class nn{constructor(e=0,t=0){nn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ta(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class wi{constructor(e,t,r,i,s,a,l,o,h){wi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,l,o,h)}set(e,t,r,i,s,a,l,o,h){const d=this.elements;return d[0]=e,d[1]=i,d[2]=l,d[3]=t,d[4]=s,d[5]=o,d[6]=r,d[7]=a,d[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],l=r[3],o=r[6],h=r[1],d=r[4],m=r[7],v=r[2],y=r[5],S=r[8],E=i[0],M=i[3],C=i[6],L=i[1],k=i[4],H=i[7],q=i[2],Z=i[5],ee=i[8];return s[0]=a*E+l*L+o*q,s[3]=a*M+l*k+o*Z,s[6]=a*C+l*H+o*ee,s[1]=h*E+d*L+m*q,s[4]=h*M+d*k+m*Z,s[7]=h*C+d*H+m*ee,s[2]=v*E+y*L+S*q,s[5]=v*M+y*k+S*Z,s[8]=v*C+y*H+S*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],o=e[6],h=e[7],d=e[8];return t*a*d-t*l*h-r*s*d+r*l*o+i*s*h-i*a*o}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],o=e[6],h=e[7],d=e[8],m=d*a-l*h,v=l*o-d*s,y=h*s-a*o,S=t*m+r*v+i*y;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const E=1/S;return e[0]=m*E,e[1]=(i*h-d*r)*E,e[2]=(l*r-i*a)*E,e[3]=v*E,e[4]=(d*t-i*o)*E,e[5]=(i*s-l*t)*E,e[6]=y*E,e[7]=(r*o-h*t)*E,e[8]=(a*t-r*s)*E,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,l){const o=Math.cos(s),h=Math.sin(s);return this.set(r*o,r*h,-r*(o*a+h*l)+a+e,-i*h,i*o,-i*(-h*a+o*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(c5.makeScale(e,t)),this}rotate(e){return this.premultiply(c5.makeRotation(-e)),this}translate(e,t){return this.premultiply(c5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const c5=new wi;function Nte(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const A0e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function db(n,e){return new A0e[n](e)}function YA(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function zte(){const n=YA("canvas");return n.style.display="block",n}const fj={};function U6(n){n in fj||(fj[n]=!0,console.warn(n))}function T0e(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}const dj=new wi().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),pj=new wi().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),CC={[Ha]:{transfer:WA,primaries:XA,toReference:n=>n,fromReference:n=>n},[To]:{transfer:to,primaries:XA,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[GT]:{transfer:WA,primaries:$A,toReference:n=>n.applyMatrix3(pj),fromReference:n=>n.applyMatrix3(dj)},[QL]:{transfer:to,primaries:$A,toReference:n=>n.convertSRGBToLinear().applyMatrix3(pj),fromReference:n=>n.applyMatrix3(dj).convertLinearToSRGB()}},M0e=new Set([Ha,GT]),ms={enabled:!0,_workingColorSpace:Ha,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!M0e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=CC[e].toReference,i=CC[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return CC[n].primaries},getTransfer:function(n){return n===Am?WA:CC[n].transfer}};function Pb(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function u5(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let rx;class Ute{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{rx===void 0&&(rx=YA("canvas")),rx.width=e.width,rx.height=e.height;const r=rx.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=rx}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=YA("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Pb(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Pb(t[r]/255)*255):t[r]=Pb(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let C0e=0;class xy{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:C0e++}),this.uuid=ku(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,l=i.length;a<l;a++)i[a].isDataTexture?s.push(h5(i[a].image)):s.push(h5(i[a]))}else s=h5(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function h5(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Ute.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let E0e=0;class Xs extends vp{constructor(e=Xs.DEFAULT_IMAGE,t=Xs.DEFAULT_MAPPING,r=su,i=su,s=Eo,a=ou,l=Wl,o=Zf,h=Xs.DEFAULT_ANISOTROPY,d=Am){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:E0e++}),this.uuid=ku(),this.name="",this.source=new xy(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=o,this.offset=new nn(0,0),this.repeat=new nn(1,1),this.center=new nn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==XL)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bh:e.x=e.x-Math.floor(e.x);break;case su:e.x=e.x<0?0:1;break;case Zy:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bh:e.y=e.y-Math.floor(e.y);break;case su:e.y=e.y<0?0:1;break;case Zy:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Xs.DEFAULT_IMAGE=null;Xs.DEFAULT_MAPPING=XL;Xs.DEFAULT_ANISOTROPY=1;class Is{constructor(e=0,t=0,r=0,i=1){Is.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const o=e.elements,h=o[0],d=o[4],m=o[8],v=o[1],y=o[5],S=o[9],E=o[2],M=o[6],C=o[10];if(Math.abs(d-v)<.01&&Math.abs(m-E)<.01&&Math.abs(S-M)<.01){if(Math.abs(d+v)<.1&&Math.abs(m+E)<.1&&Math.abs(S+M)<.1&&Math.abs(h+y+C-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(h+1)/2,H=(y+1)/2,q=(C+1)/2,Z=(d+v)/4,ee=(m+E)/4,re=(S+M)/4;return k>H&&k>q?k<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(k),i=Z/r,s=ee/r):H>q?H<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(H),r=Z/i,s=re/i):q<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(q),r=ee/s,i=re/s),this.set(r,i,s,t),this}let L=Math.sqrt((M-S)*(M-S)+(m-E)*(m-E)+(v-d)*(v-d));return Math.abs(L)<.001&&(L=1),this.x=(M-S)/L,this.y=(m-E)/L,this.z=(v-d)/L,this.w=Math.acos((h+y+C-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gte extends vp{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Is(0,0,e,t),this.scissorTest=!1,this.viewport=new Is(0,0,e,t);const i={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Eo,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const s=new Xs(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const a=r.count;for(let l=0;l<a;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,i=e.textures.length;r<i;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new xy(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wl extends Gte{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class eD extends Xs{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Sa,this.minFilter=Sa,this.wrapR=su,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class I0e extends wl{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new eD(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class G6 extends Xs{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Sa,this.minFilter=Sa,this.wrapR=su,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class R0e extends wl{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new G6(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class Ta{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,l){let o=r[i+0],h=r[i+1],d=r[i+2],m=r[i+3];const v=s[a+0],y=s[a+1],S=s[a+2],E=s[a+3];if(l===0){e[t+0]=o,e[t+1]=h,e[t+2]=d,e[t+3]=m;return}if(l===1){e[t+0]=v,e[t+1]=y,e[t+2]=S,e[t+3]=E;return}if(m!==E||o!==v||h!==y||d!==S){let M=1-l;const C=o*v+h*y+d*S+m*E,L=C>=0?1:-1,k=1-C*C;if(k>Number.EPSILON){const q=Math.sqrt(k),Z=Math.atan2(q,C*L);M=Math.sin(M*Z)/q,l=Math.sin(l*Z)/q}const H=l*L;if(o=o*M+v*H,h=h*M+y*H,d=d*M+S*H,m=m*M+E*H,M===1-l){const q=1/Math.sqrt(o*o+h*h+d*d+m*m);o*=q,h*=q,d*=q,m*=q}}e[t]=o,e[t+1]=h,e[t+2]=d,e[t+3]=m}static multiplyQuaternionsFlat(e,t,r,i,s,a){const l=r[i],o=r[i+1],h=r[i+2],d=r[i+3],m=s[a],v=s[a+1],y=s[a+2],S=s[a+3];return e[t]=l*S+d*m+o*y-h*v,e[t+1]=o*S+d*v+h*m-l*y,e[t+2]=h*S+d*y+l*v-o*m,e[t+3]=d*S-l*m-o*v-h*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,l=Math.cos,o=Math.sin,h=l(r/2),d=l(i/2),m=l(s/2),v=o(r/2),y=o(i/2),S=o(s/2);switch(a){case"XYZ":this._x=v*d*m+h*y*S,this._y=h*y*m-v*d*S,this._z=h*d*S+v*y*m,this._w=h*d*m-v*y*S;break;case"YXZ":this._x=v*d*m+h*y*S,this._y=h*y*m-v*d*S,this._z=h*d*S-v*y*m,this._w=h*d*m+v*y*S;break;case"ZXY":this._x=v*d*m-h*y*S,this._y=h*y*m+v*d*S,this._z=h*d*S+v*y*m,this._w=h*d*m-v*y*S;break;case"ZYX":this._x=v*d*m-h*y*S,this._y=h*y*m+v*d*S,this._z=h*d*S-v*y*m,this._w=h*d*m+v*y*S;break;case"YZX":this._x=v*d*m+h*y*S,this._y=h*y*m+v*d*S,this._z=h*d*S-v*y*m,this._w=h*d*m-v*y*S;break;case"XZY":this._x=v*d*m-h*y*S,this._y=h*y*m-v*d*S,this._z=h*d*S+v*y*m,this._w=h*d*m+v*y*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],l=t[5],o=t[9],h=t[2],d=t[6],m=t[10],v=r+l+m;if(v>0){const y=.5/Math.sqrt(v+1);this._w=.25/y,this._x=(d-o)*y,this._y=(s-h)*y,this._z=(a-i)*y}else if(r>l&&r>m){const y=2*Math.sqrt(1+r-l-m);this._w=(d-o)/y,this._x=.25*y,this._y=(i+a)/y,this._z=(s+h)/y}else if(l>m){const y=2*Math.sqrt(1+l-r-m);this._w=(s-h)/y,this._x=(i+a)/y,this._y=.25*y,this._z=(o+d)/y}else{const y=2*Math.sqrt(1+m-r-l);this._w=(a-i)/y,this._x=(s+h)/y,this._y=(o+d)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ta(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,l=t._x,o=t._y,h=t._z,d=t._w;return this._x=r*d+a*l+i*h-s*o,this._y=i*d+a*o+s*l-r*h,this._z=s*d+a*h+r*o-i*l,this._w=a*d-r*l-i*o-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let l=a*e._w+r*e._x+i*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const o=1-l*l;if(o<=Number.EPSILON){const y=1-t;return this._w=y*a+t*this._w,this._x=y*r+t*this._x,this._y=y*i+t*this._y,this._z=y*s+t*this._z,this.normalize(),this}const h=Math.sqrt(o),d=Math.atan2(h,l),m=Math.sin((1-t)*d)/h,v=Math.sin(t*d)/h;return this._w=a*m+this._w*v,this._x=r*m+this._x*v,this._y=i*m+this._y*v,this._z=s*m+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ze{constructor(e=0,t=0,r=0){Ze.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(mj.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mj.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,l=e.z,o=e.w,h=2*(a*i-l*r),d=2*(l*t-s*i),m=2*(s*r-a*t);return this.x=t+o*h+a*m-l*d,this.y=r+o*d+l*h-s*m,this.z=i+o*m+s*d-a*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,l=t.y,o=t.z;return this.x=i*o-s*l,this.y=s*a-r*o,this.z=r*l-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return f5.copy(this).projectOnVector(e),this.sub(f5)}reflect(e){return this.sub(f5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ta(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const f5=new Ze,mj=new Ta;class Sl{constructor(e=new Ze(1/0,1/0,1/0),t=new Ze(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Tf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Tf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Tf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=s.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Tf):Tf.fromBufferAttribute(s,a),Tf.applyMatrix4(e.matrixWorld),this.expandByPoint(Tf);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),EC.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),EC.copy(r.boundingBox)),EC.applyMatrix4(e.matrixWorld),this.union(EC)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Tf),Tf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(A2),IC.subVectors(this.max,A2),ix.subVectors(e.a,A2),sx.subVectors(e.b,A2),ox.subVectors(e.c,A2),a0.subVectors(sx,ix),l0.subVectors(ox,sx),y_.subVectors(ix,ox);let t=[0,-a0.z,a0.y,0,-l0.z,l0.y,0,-y_.z,y_.y,a0.z,0,-a0.x,l0.z,0,-l0.x,y_.z,0,-y_.x,-a0.y,a0.x,0,-l0.y,l0.x,0,-y_.y,y_.x,0];return!d5(t,ix,sx,ox,IC)||(t=[1,0,0,0,1,0,0,0,1],!d5(t,ix,sx,ox,IC))?!1:(RC.crossVectors(a0,l0),t=[RC.x,RC.y,RC.z],d5(t,ix,sx,ox,IC))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Tf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Tf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(lm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),lm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),lm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),lm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),lm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),lm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),lm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),lm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(lm),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const lm=[new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze],Tf=new Ze,EC=new Sl,ix=new Ze,sx=new Ze,ox=new Ze,a0=new Ze,l0=new Ze,y_=new Ze,A2=new Ze,IC=new Ze,RC=new Ze,x_=new Ze;function d5(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){x_.fromArray(n,s);const l=i.x*Math.abs(x_.x)+i.y*Math.abs(x_.y)+i.z*Math.abs(x_.z),o=e.dot(x_),h=t.dot(x_),d=r.dot(x_);if(Math.max(-Math.max(o,h,d),Math.min(o,h,d))>l)return!1}return!0}const P0e=new Sl,T2=new Ze,p5=new Ze;class il{constructor(e=new Ze,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):P0e.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;T2.subVectors(e,this.center);const t=T2.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(T2,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(p5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(T2.copy(e.center).add(p5)),this.expandByPoint(T2.copy(e.center).sub(p5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const cm=new Ze,m5=new Ze,PC=new Ze,c0=new Ze,g5=new Ze,LC=new Ze,v5=new Ze;class g1{constructor(e=new Ze,t=new Ze(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cm)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=cm.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cm.copy(this.origin).addScaledVector(this.direction,t),cm.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){m5.copy(e).add(t).multiplyScalar(.5),PC.copy(t).sub(e).normalize(),c0.copy(this.origin).sub(m5);const s=e.distanceTo(t)*.5,a=-this.direction.dot(PC),l=c0.dot(this.direction),o=-c0.dot(PC),h=c0.lengthSq(),d=Math.abs(1-a*a);let m,v,y,S;if(d>0)if(m=a*o-l,v=a*l-o,S=s*d,m>=0)if(v>=-S)if(v<=S){const E=1/d;m*=E,v*=E,y=m*(m+a*v+2*l)+v*(a*m+v+2*o)+h}else v=s,m=Math.max(0,-(a*v+l)),y=-m*m+v*(v+2*o)+h;else v=-s,m=Math.max(0,-(a*v+l)),y=-m*m+v*(v+2*o)+h;else v<=-S?(m=Math.max(0,-(-a*s+l)),v=m>0?-s:Math.min(Math.max(-s,-o),s),y=-m*m+v*(v+2*o)+h):v<=S?(m=0,v=Math.min(Math.max(-s,-o),s),y=v*(v+2*o)+h):(m=Math.max(0,-(a*s+l)),v=m>0?s:Math.min(Math.max(-s,-o),s),y=-m*m+v*(v+2*o)+h);else v=a>0?-s:s,m=Math.max(0,-(a*v+l)),y=-m*m+v*(v+2*o)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,m),i&&i.copy(m5).addScaledVector(PC,v),y}intersectSphere(e,t){cm.subVectors(e.center,this.origin);const r=cm.dot(this.direction),i=cm.dot(cm)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),l=r-a,o=r+a;return o<0?null:l<0?this.at(o,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,l,o;const h=1/this.direction.x,d=1/this.direction.y,m=1/this.direction.z,v=this.origin;return h>=0?(r=(e.min.x-v.x)*h,i=(e.max.x-v.x)*h):(r=(e.max.x-v.x)*h,i=(e.min.x-v.x)*h),d>=0?(s=(e.min.y-v.y)*d,a=(e.max.y-v.y)*d):(s=(e.max.y-v.y)*d,a=(e.min.y-v.y)*d),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),m>=0?(l=(e.min.z-v.z)*m,o=(e.max.z-v.z)*m):(l=(e.max.z-v.z)*m,o=(e.min.z-v.z)*m),r>o||l>i)||((l>r||r!==r)&&(r=l),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,cm)!==null}intersectTriangle(e,t,r,i,s){g5.subVectors(t,e),LC.subVectors(r,e),v5.crossVectors(g5,LC);let a=this.direction.dot(v5),l;if(a>0){if(i)return null;l=1}else if(a<0)l=-1,a=-a;else return null;c0.subVectors(this.origin,e);const o=l*this.direction.dot(LC.crossVectors(c0,LC));if(o<0)return null;const h=l*this.direction.dot(g5.cross(c0));if(h<0||o+h>a)return null;const d=-l*c0.dot(v5);return d<0?null:this.at(d/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Gr{constructor(e,t,r,i,s,a,l,o,h,d,m,v,y,S,E,M){Gr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,l,o,h,d,m,v,y,S,E,M)}set(e,t,r,i,s,a,l,o,h,d,m,v,y,S,E,M){const C=this.elements;return C[0]=e,C[4]=t,C[8]=r,C[12]=i,C[1]=s,C[5]=a,C[9]=l,C[13]=o,C[2]=h,C[6]=d,C[10]=m,C[14]=v,C[3]=y,C[7]=S,C[11]=E,C[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/ax.setFromMatrixColumn(e,0).length(),s=1/ax.setFromMatrixColumn(e,1).length(),a=1/ax.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),l=Math.sin(r),o=Math.cos(i),h=Math.sin(i),d=Math.cos(s),m=Math.sin(s);if(e.order==="XYZ"){const v=a*d,y=a*m,S=l*d,E=l*m;t[0]=o*d,t[4]=-o*m,t[8]=h,t[1]=y+S*h,t[5]=v-E*h,t[9]=-l*o,t[2]=E-v*h,t[6]=S+y*h,t[10]=a*o}else if(e.order==="YXZ"){const v=o*d,y=o*m,S=h*d,E=h*m;t[0]=v+E*l,t[4]=S*l-y,t[8]=a*h,t[1]=a*m,t[5]=a*d,t[9]=-l,t[2]=y*l-S,t[6]=E+v*l,t[10]=a*o}else if(e.order==="ZXY"){const v=o*d,y=o*m,S=h*d,E=h*m;t[0]=v-E*l,t[4]=-a*m,t[8]=S+y*l,t[1]=y+S*l,t[5]=a*d,t[9]=E-v*l,t[2]=-a*h,t[6]=l,t[10]=a*o}else if(e.order==="ZYX"){const v=a*d,y=a*m,S=l*d,E=l*m;t[0]=o*d,t[4]=S*h-y,t[8]=v*h+E,t[1]=o*m,t[5]=E*h+v,t[9]=y*h-S,t[2]=-h,t[6]=l*o,t[10]=a*o}else if(e.order==="YZX"){const v=a*o,y=a*h,S=l*o,E=l*h;t[0]=o*d,t[4]=E-v*m,t[8]=S*m+y,t[1]=m,t[5]=a*d,t[9]=-l*d,t[2]=-h*d,t[6]=y*m+S,t[10]=v-E*m}else if(e.order==="XZY"){const v=a*o,y=a*h,S=l*o,E=l*h;t[0]=o*d,t[4]=-m,t[8]=h*d,t[1]=v*m+E,t[5]=a*d,t[9]=y*m-S,t[2]=S*m-y,t[6]=l*d,t[10]=E*m+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(L0e,e,D0e)}lookAt(e,t,r){const i=this.elements;return Cu.subVectors(e,t),Cu.lengthSq()===0&&(Cu.z=1),Cu.normalize(),u0.crossVectors(r,Cu),u0.lengthSq()===0&&(Math.abs(r.z)===1?Cu.x+=1e-4:Cu.z+=1e-4,Cu.normalize(),u0.crossVectors(r,Cu)),u0.normalize(),DC.crossVectors(Cu,u0),i[0]=u0.x,i[4]=DC.x,i[8]=Cu.x,i[1]=u0.y,i[5]=DC.y,i[9]=Cu.y,i[2]=u0.z,i[6]=DC.z,i[10]=Cu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],l=r[4],o=r[8],h=r[12],d=r[1],m=r[5],v=r[9],y=r[13],S=r[2],E=r[6],M=r[10],C=r[14],L=r[3],k=r[7],H=r[11],q=r[15],Z=i[0],ee=i[4],re=i[8],se=i[12],ae=i[1],fe=i[5],Se=i[9],Ce=i[13],Ie=i[2],je=i[6],Le=i[10],ot=i[14],ye=i[3],$e=i[7],Ve=i[11],_t=i[15];return s[0]=a*Z+l*ae+o*Ie+h*ye,s[4]=a*ee+l*fe+o*je+h*$e,s[8]=a*re+l*Se+o*Le+h*Ve,s[12]=a*se+l*Ce+o*ot+h*_t,s[1]=d*Z+m*ae+v*Ie+y*ye,s[5]=d*ee+m*fe+v*je+y*$e,s[9]=d*re+m*Se+v*Le+y*Ve,s[13]=d*se+m*Ce+v*ot+y*_t,s[2]=S*Z+E*ae+M*Ie+C*ye,s[6]=S*ee+E*fe+M*je+C*$e,s[10]=S*re+E*Se+M*Le+C*Ve,s[14]=S*se+E*Ce+M*ot+C*_t,s[3]=L*Z+k*ae+H*Ie+q*ye,s[7]=L*ee+k*fe+H*je+q*$e,s[11]=L*re+k*Se+H*Le+q*Ve,s[15]=L*se+k*Ce+H*ot+q*_t,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],l=e[5],o=e[9],h=e[13],d=e[2],m=e[6],v=e[10],y=e[14],S=e[3],E=e[7],M=e[11],C=e[15];return S*(+s*o*m-i*h*m-s*l*v+r*h*v+i*l*y-r*o*y)+E*(+t*o*y-t*h*v+s*a*v-i*a*y+i*h*d-s*o*d)+M*(+t*h*m-t*l*y-s*a*m+r*a*y+s*l*d-r*h*d)+C*(-i*l*d-t*o*m+t*l*v+i*a*m-r*a*v+r*o*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],o=e[6],h=e[7],d=e[8],m=e[9],v=e[10],y=e[11],S=e[12],E=e[13],M=e[14],C=e[15],L=m*M*h-E*v*h+E*o*y-l*M*y-m*o*C+l*v*C,k=S*v*h-d*M*h-S*o*y+a*M*y+d*o*C-a*v*C,H=d*E*h-S*m*h+S*l*y-a*E*y-d*l*C+a*m*C,q=S*m*o-d*E*o-S*l*v+a*E*v+d*l*M-a*m*M,Z=t*L+r*k+i*H+s*q;if(Z===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ee=1/Z;return e[0]=L*ee,e[1]=(E*v*s-m*M*s-E*i*y+r*M*y+m*i*C-r*v*C)*ee,e[2]=(l*M*s-E*o*s+E*i*h-r*M*h-l*i*C+r*o*C)*ee,e[3]=(m*o*s-l*v*s-m*i*h+r*v*h+l*i*y-r*o*y)*ee,e[4]=k*ee,e[5]=(d*M*s-S*v*s+S*i*y-t*M*y-d*i*C+t*v*C)*ee,e[6]=(S*o*s-a*M*s-S*i*h+t*M*h+a*i*C-t*o*C)*ee,e[7]=(a*v*s-d*o*s+d*i*h-t*v*h-a*i*y+t*o*y)*ee,e[8]=H*ee,e[9]=(S*m*s-d*E*s-S*r*y+t*E*y+d*r*C-t*m*C)*ee,e[10]=(a*E*s-S*l*s+S*r*h-t*E*h-a*r*C+t*l*C)*ee,e[11]=(d*l*s-a*m*s-d*r*h+t*m*h+a*r*y-t*l*y)*ee,e[12]=q*ee,e[13]=(d*E*i-S*m*i+S*r*v-t*E*v-d*r*M+t*m*M)*ee,e[14]=(S*l*i-a*E*i-S*r*o+t*E*o+a*r*M-t*l*M)*ee,e[15]=(a*m*i-d*l*i+d*r*o-t*m*o-a*r*v+t*l*v)*ee,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,l=e.y,o=e.z,h=s*a,d=s*l;return this.set(h*a+r,h*l-i*o,h*o+i*l,0,h*l+i*o,d*l+r,d*o-i*a,0,h*o-i*l,d*o+i*a,s*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,l=t._z,o=t._w,h=s+s,d=a+a,m=l+l,v=s*h,y=s*d,S=s*m,E=a*d,M=a*m,C=l*m,L=o*h,k=o*d,H=o*m,q=r.x,Z=r.y,ee=r.z;return i[0]=(1-(E+C))*q,i[1]=(y+H)*q,i[2]=(S-k)*q,i[3]=0,i[4]=(y-H)*Z,i[5]=(1-(v+C))*Z,i[6]=(M+L)*Z,i[7]=0,i[8]=(S+k)*ee,i[9]=(M-L)*ee,i[10]=(1-(v+E))*ee,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=ax.set(i[0],i[1],i[2]).length();const a=ax.set(i[4],i[5],i[6]).length(),l=ax.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Mf.copy(this);const h=1/s,d=1/a,m=1/l;return Mf.elements[0]*=h,Mf.elements[1]*=h,Mf.elements[2]*=h,Mf.elements[4]*=d,Mf.elements[5]*=d,Mf.elements[6]*=d,Mf.elements[8]*=m,Mf.elements[9]*=m,Mf.elements[10]*=m,t.setFromRotationMatrix(Mf),r.x=s,r.y=a,r.z=l,this}makePerspective(e,t,r,i,s,a,l=Qd){const o=this.elements,h=2*s/(t-e),d=2*s/(r-i),m=(t+e)/(t-e),v=(r+i)/(r-i);let y,S;if(l===Qd)y=-(a+s)/(a-s),S=-2*a*s/(a-s);else if(l===ZA)y=-a/(a-s),S=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return o[0]=h,o[4]=0,o[8]=m,o[12]=0,o[1]=0,o[5]=d,o[9]=v,o[13]=0,o[2]=0,o[6]=0,o[10]=y,o[14]=S,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,i,s,a,l=Qd){const o=this.elements,h=1/(t-e),d=1/(r-i),m=1/(a-s),v=(t+e)*h,y=(r+i)*d;let S,E;if(l===Qd)S=(a+s)*m,E=-2*m;else if(l===ZA)S=s*m,E=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return o[0]=2*h,o[4]=0,o[8]=0,o[12]=-v,o[1]=0,o[5]=2*d,o[9]=0,o[13]=-y,o[2]=0,o[6]=0,o[10]=E,o[14]=-S,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const ax=new Ze,Mf=new Gr,L0e=new Ze(0,0,0),D0e=new Ze(1,1,1),u0=new Ze,DC=new Ze,Cu=new Ze,gj=new Gr,vj=new Ta;class zu{constructor(e=0,t=0,r=0,i=zu.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],l=i[8],o=i[1],h=i[5],d=i[9],m=i[2],v=i[6],y=i[10];switch(t){case"XYZ":this._y=Math.asin(ta(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,y),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(v,h),this._z=0);break;case"YXZ":this._x=Math.asin(-ta(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,y),this._z=Math.atan2(o,h)):(this._y=Math.atan2(-m,s),this._z=0);break;case"ZXY":this._x=Math.asin(ta(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-m,y),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(o,s));break;case"ZYX":this._y=Math.asin(-ta(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(v,y),this._z=Math.atan2(o,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(ta(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-m,s)):(this._x=0,this._y=Math.atan2(l,y));break;case"XZY":this._z=Math.asin(-ta(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(v,h),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-d,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return gj.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gj,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vj.setFromEuler(this),this.setFromQuaternion(vj,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}zu.DEFAULT_ORDER="XYZ";class Oy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let B0e=0;const _j=new Ze,lx=new Ta,um=new Gr,BC=new Ze,M2=new Ze,k0e=new Ze,O0e=new Ta,yj=new Ze(1,0,0),xj=new Ze(0,1,0),bj=new Ze(0,0,1),wj={type:"added"},F0e={type:"removed"},cx={type:"childadded",child:null},_5={type:"childremoved",child:null};class Ri extends vp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:B0e++}),this.uuid=ku(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ri.DEFAULT_UP.clone();const e=new Ze,t=new zu,r=new Ta,i=new Ze(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Gr},normalMatrix:{value:new wi}}),this.matrix=new Gr,this.matrixWorld=new Gr,this.matrixAutoUpdate=Ri.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ri.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Oy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return lx.setFromAxisAngle(e,t),this.quaternion.multiply(lx),this}rotateOnWorldAxis(e,t){return lx.setFromAxisAngle(e,t),this.quaternion.premultiply(lx),this}rotateX(e){return this.rotateOnAxis(yj,e)}rotateY(e){return this.rotateOnAxis(xj,e)}rotateZ(e){return this.rotateOnAxis(bj,e)}translateOnAxis(e,t){return _j.copy(e).applyQuaternion(this.quaternion),this.position.add(_j.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(yj,e)}translateY(e){return this.translateOnAxis(xj,e)}translateZ(e){return this.translateOnAxis(bj,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(um.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?BC.copy(e):BC.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),M2.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?um.lookAt(M2,BC,this.up):um.lookAt(BC,M2,this.up),this.quaternion.setFromRotationMatrix(um),i&&(um.extractRotation(i.matrixWorld),lx.setFromRotationMatrix(um),this.quaternion.premultiply(lx.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(wj),cx.child=e,this.dispatchEvent(cx),cx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(F0e),_5.child=e,this.dispatchEvent(_5),_5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),um.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),um.multiply(e.parent.matrixWorld)),e.applyMatrix4(um),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(wj),cx.child=e,this.dispatchEvent(cx),cx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(M2,e,k0e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(M2,O0e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(l,o){return l[o.uuid]===void 0&&(l[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const o=l.shapes;if(Array.isArray(o))for(let h=0,d=o.length;h<d;h++){const m=o[h];s(e.shapes,m)}else s(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let o=0,h=this.material.length;o<h;o++)l.push(s(e.materials,this.material[o]));i.material=l}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let l=0;l<this.children.length;l++)i.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let l=0;l<this.animations.length;l++){const o=this.animations[l];i.animations.push(s(e.animations,o))}}if(t){const l=a(e.geometries),o=a(e.materials),h=a(e.textures),d=a(e.images),m=a(e.shapes),v=a(e.skeletons),y=a(e.animations),S=a(e.nodes);l.length>0&&(r.geometries=l),o.length>0&&(r.materials=o),h.length>0&&(r.textures=h),d.length>0&&(r.images=d),m.length>0&&(r.shapes=m),v.length>0&&(r.skeletons=v),y.length>0&&(r.animations=y),S.length>0&&(r.nodes=S)}return r.object=i,r;function a(l){const o=[];for(const h in l){const d=l[h];delete d.metadata,o.push(d)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Ri.DEFAULT_UP=new Ze(0,1,0);Ri.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ri.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Cf=new Ze,hm=new Ze,y5=new Ze,fm=new Ze,ux=new Ze,hx=new Ze,Sj=new Ze,x5=new Ze,b5=new Ze,w5=new Ze;let H0=class Xx{constructor(e=new Ze,t=new Ze,r=new Ze){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Cf.subVectors(e,t),i.cross(Cf);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Cf.subVectors(i,t),hm.subVectors(r,t),y5.subVectors(e,t);const a=Cf.dot(Cf),l=Cf.dot(hm),o=Cf.dot(y5),h=hm.dot(hm),d=hm.dot(y5),m=a*h-l*l;if(m===0)return s.set(0,0,0),null;const v=1/m,y=(h*o-l*d)*v,S=(a*d-l*o)*v;return s.set(1-y-S,S,y)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,fm)===null?!1:fm.x>=0&&fm.y>=0&&fm.x+fm.y<=1}static getInterpolation(e,t,r,i,s,a,l,o){return this.getBarycoord(e,t,r,i,fm)===null?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(s,fm.x),o.addScaledVector(a,fm.y),o.addScaledVector(l,fm.z),o)}static isFrontFacing(e,t,r,i){return Cf.subVectors(r,t),hm.subVectors(e,t),Cf.cross(hm).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Cf.subVectors(this.c,this.b),hm.subVectors(this.a,this.b),Cf.cross(hm).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xx.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xx.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return Xx.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Xx.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xx.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,l;ux.subVectors(i,r),hx.subVectors(s,r),x5.subVectors(e,r);const o=ux.dot(x5),h=hx.dot(x5);if(o<=0&&h<=0)return t.copy(r);b5.subVectors(e,i);const d=ux.dot(b5),m=hx.dot(b5);if(d>=0&&m<=d)return t.copy(i);const v=o*m-d*h;if(v<=0&&o>=0&&d<=0)return a=o/(o-d),t.copy(r).addScaledVector(ux,a);w5.subVectors(e,s);const y=ux.dot(w5),S=hx.dot(w5);if(S>=0&&y<=S)return t.copy(s);const E=y*h-o*S;if(E<=0&&h>=0&&S<=0)return l=h/(h-S),t.copy(r).addScaledVector(hx,l);const M=d*S-y*m;if(M<=0&&m-d>=0&&y-S>=0)return Sj.subVectors(s,i),l=(m-d)/(m-d+(y-S)),t.copy(i).addScaledVector(Sj,l);const C=1/(M+E+v);return a=E*C,l=v*C,t.copy(r).addScaledVector(ux,a).addScaledVector(hx,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const Vte={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},h0={h:0,s:0,l:0},kC={h:0,s:0,l:0};function S5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Vn=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=To){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ms.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=ms.workingColorSpace){return this.r=e,this.g=t,this.b=r,ms.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=ms.workingColorSpace){if(e=z6(e,1),t=ta(t,0,1),r=ta(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=S5(a,s,e+1/3),this.g=S5(a,s,e),this.b=S5(a,s,e-1/3)}return ms.toWorkingColorSpace(this,i),this}setStyle(e,t=To){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],l=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=To){const r=Vte[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pb(e.r),this.g=Pb(e.g),this.b=Pb(e.b),this}copyLinearToSRGB(e){return this.r=u5(e.r),this.g=u5(e.g),this.b=u5(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=To){return ms.fromWorkingColorSpace(kl.copy(this),e),Math.round(ta(kl.r*255,0,255))*65536+Math.round(ta(kl.g*255,0,255))*256+Math.round(ta(kl.b*255,0,255))}getHexString(e=To){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ms.workingColorSpace){ms.fromWorkingColorSpace(kl.copy(this),t);const r=kl.r,i=kl.g,s=kl.b,a=Math.max(r,i,s),l=Math.min(r,i,s);let o,h;const d=(l+a)/2;if(l===a)o=0,h=0;else{const m=a-l;switch(h=d<=.5?m/(a+l):m/(2-a-l),a){case r:o=(i-s)/m+(i<s?6:0);break;case i:o=(s-r)/m+2;break;case s:o=(r-i)/m+4;break}o/=6}return e.h=o,e.s=h,e.l=d,e}getRGB(e,t=ms.workingColorSpace){return ms.fromWorkingColorSpace(kl.copy(this),t),e.r=kl.r,e.g=kl.g,e.b=kl.b,e}getStyle(e=To){ms.fromWorkingColorSpace(kl.copy(this),e);const t=kl.r,r=kl.g,i=kl.b;return e!==To?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(h0),this.setHSL(h0.h+e,h0.s+t,h0.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(h0),e.getHSL(kC);const r=ZS(h0.h,kC.h,t),i=ZS(h0.s,kC.s,t),s=ZS(h0.l,kC.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const kl=new Vn;Vn.NAMES=Vte;let N0e=0;class yo extends vp{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:N0e++}),this.uuid=ku(),this.name="",this.type="Material",this.blending=Ly,this.side=Dh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=GR,this.blendDst=VR,this.blendEquation=O0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Vn(0,0,0),this.blendAlpha=0,this.depthFunc=GA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_F,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ly,this.stencilZFail=ly,this.stencilZPass=ly,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ly&&(r.blending=this.blending),this.side!==Dh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==GR&&(r.blendSrc=this.blendSrc),this.blendDst!==VR&&(r.blendDst=this.blendDst),this.blendEquation!==O0&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==GA&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==_F&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ly&&(r.stencilFail=this.stencilFail),this.stencilZFail!==ly&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==ly&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const l in s){const o=s[l];delete o.metadata,a.push(o)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}}class _o extends yo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zu,this.combine=OT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tm=z0e();function z0e(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let o=0;o<256;++o){const h=o-127;h<-27?(r[o]=0,r[o|256]=32768,i[o]=24,i[o|256]=24):h<-14?(r[o]=1024>>-h-14,r[o|256]=1024>>-h-14|32768,i[o]=-h-1,i[o|256]=-h-1):h<=15?(r[o]=h+15<<10,r[o|256]=h+15<<10|32768,i[o]=13,i[o|256]=13):h<128?(r[o]=31744,r[o|256]=64512,i[o]=24,i[o|256]=24):(r[o]=31744,r[o|256]=64512,i[o]=13,i[o|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let o=1;o<1024;++o){let h=o<<13,d=0;for(;!(h&8388608);)h<<=1,d-=8388608;h&=-8388609,d+=947912704,s[o]=h|d}for(let o=1024;o<2048;++o)s[o]=939524096+(o-1024<<13);for(let o=1;o<31;++o)a[o]=o<<23;a[31]=1199570944,a[32]=2147483648;for(let o=33;o<63;++o)a[o]=2147483648+(o-32<<23);a[63]=3347054592;for(let o=1;o<64;++o)o!==32&&(l[o]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:l}}function Qc(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=ta(n,-65504,65504),Tm.floatView[0]=n;const e=Tm.uint32View[0],t=e>>23&511;return Tm.baseTable[t]+((e&8388607)>>Tm.shiftTable[t])}function yS(n){const e=n>>10;return Tm.uint32View[0]=Tm.mantissaTable[Tm.offsetTable[e]+(n&1023)]+Tm.exponentTable[e],Tm.floatView[0]}const U0e={toHalfFloat:Qc,fromHalfFloat:yS},ba=new Ze,OC=new nn;class Bi{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=qA,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ac,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return U6("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)OC.fromBufferAttribute(this,t),OC.applyMatrix3(e),this.setXY(t,OC.x,OC.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.applyMatrix3(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.applyMatrix4(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.applyNormalMatrix(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.transformDirection(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Sc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Si(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Sc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Sc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Sc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Sc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array),s=Si(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==qA&&(e.usage=this.usage),e}}class G0e extends Bi{constructor(e,t,r){super(new Int8Array(e),t,r)}}class V0e extends Bi{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class H0e extends Bi{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class j0e extends Bi{constructor(e,t,r){super(new Int16Array(e),t,r)}}class V6 extends Bi{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class W0e extends Bi{constructor(e,t,r){super(new Int32Array(e),t,r)}}class H6 extends Bi{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class X0e extends Bi{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=yS(this.array[e*this.itemSize]);return this.normalized&&(t=Sc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize]=Qc(t),this}getY(e){let t=yS(this.array[e*this.itemSize+1]);return this.normalized&&(t=Sc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+1]=Qc(t),this}getZ(e){let t=yS(this.array[e*this.itemSize+2]);return this.normalized&&(t=Sc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+2]=Qc(t),this}getW(e){let t=yS(this.array[e*this.itemSize+3]);return this.normalized&&(t=Sc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Si(t,this.array)),this.array[e*this.itemSize+3]=Qc(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array)),this.array[e+0]=Qc(t),this.array[e+1]=Qc(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array)),this.array[e+0]=Qc(t),this.array[e+1]=Qc(r),this.array[e+2]=Qc(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array),s=Si(s,this.array)),this.array[e+0]=Qc(t),this.array[e+1]=Qc(r),this.array[e+2]=Qc(i),this.array[e+3]=Qc(s),this}}class ar extends Bi{constructor(e,t,r){super(new Float32Array(e),t,r)}}let $0e=0;const lh=new Gr,A5=new Ri,fx=new Ze,Eu=new Sl,C2=new Sl,tl=new Ze;class $r extends vp{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$0e++}),this.uuid=ku(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Nte(e)?H6:V6)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new wi().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return lh.makeRotationFromQuaternion(e),this.applyMatrix4(lh),this}rotateX(e){return lh.makeRotationX(e),this.applyMatrix4(lh),this}rotateY(e){return lh.makeRotationY(e),this.applyMatrix4(lh),this}rotateZ(e){return lh.makeRotationZ(e),this.applyMatrix4(lh),this}translate(e,t,r){return lh.makeTranslation(e,t,r),this.applyMatrix4(lh),this}scale(e,t,r){return lh.makeScale(e,t,r),this.applyMatrix4(lh),this}lookAt(e){return A5.lookAt(e),A5.updateMatrix(),this.applyMatrix4(A5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fx).negate(),this.translate(fx.x,fx.y,fx.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ar(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Sl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ze(-1/0,-1/0,-1/0),new Ze(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Eu.setFromBufferAttribute(s),this.morphTargetsRelative?(tl.addVectors(this.boundingBox.min,Eu.min),this.boundingBox.expandByPoint(tl),tl.addVectors(this.boundingBox.max,Eu.max),this.boundingBox.expandByPoint(tl)):(this.boundingBox.expandByPoint(Eu.min),this.boundingBox.expandByPoint(Eu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new il);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ze,1/0);return}if(e){const r=this.boundingSphere.center;if(Eu.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const l=t[s];C2.setFromBufferAttribute(l),this.morphTargetsRelative?(tl.addVectors(Eu.min,C2.min),Eu.expandByPoint(tl),tl.addVectors(Eu.max,C2.max),Eu.expandByPoint(tl)):(Eu.expandByPoint(C2.min),Eu.expandByPoint(C2.max))}Eu.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)tl.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(tl));if(t)for(let s=0,a=t.length;s<a;s++){const l=t[s],o=this.morphTargetsRelative;for(let h=0,d=l.count;h<d;h++)tl.fromBufferAttribute(l,h),o&&(fx.fromBufferAttribute(e,h),tl.add(fx)),i=Math.max(i,r.distanceToSquared(tl))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Bi(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),l=[],o=[];for(let re=0;re<r.count;re++)l[re]=new Ze,o[re]=new Ze;const h=new Ze,d=new Ze,m=new Ze,v=new nn,y=new nn,S=new nn,E=new Ze,M=new Ze;function C(re,se,ae){h.fromBufferAttribute(r,re),d.fromBufferAttribute(r,se),m.fromBufferAttribute(r,ae),v.fromBufferAttribute(s,re),y.fromBufferAttribute(s,se),S.fromBufferAttribute(s,ae),d.sub(h),m.sub(h),y.sub(v),S.sub(v);const fe=1/(y.x*S.y-S.x*y.y);isFinite(fe)&&(E.copy(d).multiplyScalar(S.y).addScaledVector(m,-y.y).multiplyScalar(fe),M.copy(m).multiplyScalar(y.x).addScaledVector(d,-S.x).multiplyScalar(fe),l[re].add(E),l[se].add(E),l[ae].add(E),o[re].add(M),o[se].add(M),o[ae].add(M))}let L=this.groups;L.length===0&&(L=[{start:0,count:e.count}]);for(let re=0,se=L.length;re<se;++re){const ae=L[re],fe=ae.start,Se=ae.count;for(let Ce=fe,Ie=fe+Se;Ce<Ie;Ce+=3)C(e.getX(Ce+0),e.getX(Ce+1),e.getX(Ce+2))}const k=new Ze,H=new Ze,q=new Ze,Z=new Ze;function ee(re){q.fromBufferAttribute(i,re),Z.copy(q);const se=l[re];k.copy(se),k.sub(q.multiplyScalar(q.dot(se))).normalize(),H.crossVectors(Z,se);const fe=H.dot(o[re])<0?-1:1;a.setXYZW(re,k.x,k.y,k.z,fe)}for(let re=0,se=L.length;re<se;++re){const ae=L[re],fe=ae.start,Se=ae.count;for(let Ce=fe,Ie=fe+Se;Ce<Ie;Ce+=3)ee(e.getX(Ce+0)),ee(e.getX(Ce+1)),ee(e.getX(Ce+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Bi(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let v=0,y=r.count;v<y;v++)r.setXYZ(v,0,0,0);const i=new Ze,s=new Ze,a=new Ze,l=new Ze,o=new Ze,h=new Ze,d=new Ze,m=new Ze;if(e)for(let v=0,y=e.count;v<y;v+=3){const S=e.getX(v+0),E=e.getX(v+1),M=e.getX(v+2);i.fromBufferAttribute(t,S),s.fromBufferAttribute(t,E),a.fromBufferAttribute(t,M),d.subVectors(a,s),m.subVectors(i,s),d.cross(m),l.fromBufferAttribute(r,S),o.fromBufferAttribute(r,E),h.fromBufferAttribute(r,M),l.add(d),o.add(d),h.add(d),r.setXYZ(S,l.x,l.y,l.z),r.setXYZ(E,o.x,o.y,o.z),r.setXYZ(M,h.x,h.y,h.z)}else for(let v=0,y=t.count;v<y;v+=3)i.fromBufferAttribute(t,v+0),s.fromBufferAttribute(t,v+1),a.fromBufferAttribute(t,v+2),d.subVectors(a,s),m.subVectors(i,s),d.cross(m),r.setXYZ(v+0,d.x,d.y,d.z),r.setXYZ(v+1,d.x,d.y,d.z),r.setXYZ(v+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)tl.fromBufferAttribute(e,t),tl.normalize(),e.setXYZ(t,tl.x,tl.y,tl.z)}toNonIndexed(){function e(l,o){const h=l.array,d=l.itemSize,m=l.normalized,v=new h.constructor(o.length*d);let y=0,S=0;for(let E=0,M=o.length;E<M;E++){l.isInterleavedBufferAttribute?y=o[E]*l.data.stride+l.offset:y=o[E]*d;for(let C=0;C<d;C++)v[S++]=h[y++]}return new Bi(v,d,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new $r,r=this.index.array,i=this.attributes;for(const l in i){const o=i[l],h=e(o,r);t.setAttribute(l,h)}const s=this.morphAttributes;for(const l in s){const o=[],h=s[l];for(let d=0,m=h.length;d<m;d++){const v=h[d],y=e(v,r);o.push(y)}t.morphAttributes[l]=o}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,o=a.length;l<o;l++){const h=a[l];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const o=this.parameters;for(const h in o)o[h]!==void 0&&(e[h]=o[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const o in r){const h=r[o];e.data.attributes[o]=h.toJSON(e.data)}const i={};let s=!1;for(const o in this.morphAttributes){const h=this.morphAttributes[o],d=[];for(let m=0,v=h.length;m<v;m++){const y=h[m];d.push(y.toJSON(e.data))}d.length>0&&(i[o]=d,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const h in i){const d=i[h];this.setAttribute(h,d.clone(t))}const s=e.morphAttributes;for(const h in s){const d=[],m=s[h];for(let v=0,y=m.length;v<y;v++)d.push(m[v].clone(t));this.morphAttributes[h]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,d=a.length;h<d;h++){const m=a[h];this.addGroup(m.start,m.count,m.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Aj=new Gr,b_=new g1,FC=new il,Tj=new Ze,dx=new Ze,px=new Ze,mx=new Ze,T5=new Ze,NC=new Ze,zC=new nn,UC=new nn,GC=new nn,Mj=new Ze,Cj=new Ze,Ej=new Ze,VC=new Ze,HC=new Ze;class Ii extends Ri{constructor(e=new $r,t=new _o){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const l=this.morphTargetInfluences;if(s&&l){NC.set(0,0,0);for(let o=0,h=s.length;o<h;o++){const d=l[o],m=s[o];d!==0&&(T5.fromBufferAttribute(m,e),a?NC.addScaledVector(T5,d):NC.addScaledVector(T5.sub(t),d))}t.add(NC)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),FC.copy(r.boundingSphere),FC.applyMatrix4(s),b_.copy(e.ray).recast(e.near),!(FC.containsPoint(b_.origin)===!1&&(b_.intersectSphere(FC,Tj)===null||b_.origin.distanceToSquared(Tj)>(e.far-e.near)**2))&&(Aj.copy(s).invert(),b_.copy(e.ray).applyMatrix4(Aj),!(r.boundingBox!==null&&b_.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,b_)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,l=s.index,o=s.attributes.position,h=s.attributes.uv,d=s.attributes.uv1,m=s.attributes.normal,v=s.groups,y=s.drawRange;if(l!==null)if(Array.isArray(a))for(let S=0,E=v.length;S<E;S++){const M=v[S],C=a[M.materialIndex],L=Math.max(M.start,y.start),k=Math.min(l.count,Math.min(M.start+M.count,y.start+y.count));for(let H=L,q=k;H<q;H+=3){const Z=l.getX(H),ee=l.getX(H+1),re=l.getX(H+2);i=jC(this,C,e,r,h,d,m,Z,ee,re),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,y.start),E=Math.min(l.count,y.start+y.count);for(let M=S,C=E;M<C;M+=3){const L=l.getX(M),k=l.getX(M+1),H=l.getX(M+2);i=jC(this,a,e,r,h,d,m,L,k,H),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}else if(o!==void 0)if(Array.isArray(a))for(let S=0,E=v.length;S<E;S++){const M=v[S],C=a[M.materialIndex],L=Math.max(M.start,y.start),k=Math.min(o.count,Math.min(M.start+M.count,y.start+y.count));for(let H=L,q=k;H<q;H+=3){const Z=H,ee=H+1,re=H+2;i=jC(this,C,e,r,h,d,m,Z,ee,re),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,y.start),E=Math.min(o.count,y.start+y.count);for(let M=S,C=E;M<C;M+=3){const L=M,k=M+1,H=M+2;i=jC(this,a,e,r,h,d,m,L,k,H),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}}}function q0e(n,e,t,r,i,s,a,l){let o;if(e.side===Cc?o=r.intersectTriangle(a,s,i,!0,l):o=r.intersectTriangle(i,s,a,e.side===Dh,l),o===null)return null;HC.copy(l),HC.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(HC);return h<t.near||h>t.far?null:{distance:h,point:HC.clone(),object:n}}function jC(n,e,t,r,i,s,a,l,o,h){n.getVertexPosition(l,dx),n.getVertexPosition(o,px),n.getVertexPosition(h,mx);const d=q0e(n,e,t,r,dx,px,mx,VC);if(d){i&&(zC.fromBufferAttribute(i,l),UC.fromBufferAttribute(i,o),GC.fromBufferAttribute(i,h),d.uv=H0.getInterpolation(VC,dx,px,mx,zC,UC,GC,new nn)),s&&(zC.fromBufferAttribute(s,l),UC.fromBufferAttribute(s,o),GC.fromBufferAttribute(s,h),d.uv1=H0.getInterpolation(VC,dx,px,mx,zC,UC,GC,new nn)),a&&(Mj.fromBufferAttribute(a,l),Cj.fromBufferAttribute(a,o),Ej.fromBufferAttribute(a,h),d.normal=H0.getInterpolation(VC,dx,px,mx,Mj,Cj,Ej,new Ze),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const m={a:l,b:o,c:h,normal:new Ze,materialIndex:0};H0.getNormal(dx,px,mx,m.normal),d.face=m}return d}class _p extends $r{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const l=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const o=[],h=[],d=[],m=[];let v=0,y=0;S("z","y","x",-1,-1,r,t,e,a,s,0),S("z","y","x",1,-1,r,t,-e,a,s,1),S("x","z","y",1,1,e,r,t,i,a,2),S("x","z","y",1,-1,e,r,-t,i,a,3),S("x","y","z",1,-1,e,t,r,i,s,4),S("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(o),this.setAttribute("position",new ar(h,3)),this.setAttribute("normal",new ar(d,3)),this.setAttribute("uv",new ar(m,2));function S(E,M,C,L,k,H,q,Z,ee,re,se){const ae=H/ee,fe=q/re,Se=H/2,Ce=q/2,Ie=Z/2,je=ee+1,Le=re+1;let ot=0,ye=0;const $e=new Ze;for(let Ve=0;Ve<Le;Ve++){const _t=Ve*fe-Ce;for(let wt=0;wt<je;wt++){const Vt=wt*ae-Se;$e[E]=Vt*L,$e[M]=_t*k,$e[C]=Ie,h.push($e.x,$e.y,$e.z),$e[E]=0,$e[M]=0,$e[C]=Z>0?1:-1,d.push($e.x,$e.y,$e.z),m.push(wt/ee),m.push(1-Ve/re),ot+=1}}for(let Ve=0;Ve<re;Ve++)for(let _t=0;_t<ee;_t++){const wt=v+_t+je*Ve,Vt=v+_t+je*(Ve+1),lt=v+(_t+1)+je*(Ve+1),Ht=v+(_t+1)+je*Ve;o.push(wt,Vt,Ht),o.push(Vt,lt,Ht),ye+=6}l.addGroup(y,ye,se),y+=ye,v+=ot}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _p(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ew(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function _c(n){const e={};for(let t=0;t<n.length;t++){const r=ew(n[t]);for(const i in r)e[i]=r[i]}return e}function Z0e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function Hte(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:ms.workingColorSpace}const Wm={clone:ew,merge:_c};var Y0e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,K0e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Io extends yo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Y0e,this.fragmentShader=K0e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ew(e.uniforms),this.uniformsGroups=Z0e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class VT extends Ri{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gr,this.projectionMatrix=new Gr,this.projectionMatrixInverse=new Gr,this.coordinateSystem=Qd}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const f0=new Ze,Ij=new nn,Rj=new nn;class ts extends VT{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Qb*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ky*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Qb*2*Math.atan(Math.tan(ky*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){f0.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(f0.x,f0.y).multiplyScalar(-e/f0.z),f0.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(f0.x,f0.y).multiplyScalar(-e/f0.z)}getViewSize(e,t){return this.getViewBounds(e,Ij,Rj),t.subVectors(Rj,Ij)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ky*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const o=a.fullWidth,h=a.fullHeight;s+=a.offsetX*i/o,t-=a.offsetY*r/h,i*=a.width/o,r*=a.height/h}const l=this.filmOffset;l!==0&&(s+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const gx=-90,vx=1;class jte extends Ri{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new ts(gx,vx,e,t);i.layers=this.layers,this.add(i);const s=new ts(gx,vx,e,t);s.layers=this.layers,this.add(s);const a=new ts(gx,vx,e,t);a.layers=this.layers,this.add(a);const l=new ts(gx,vx,e,t);l.layers=this.layers,this.add(l);const o=new ts(gx,vx,e,t);o.layers=this.layers,this.add(o);const h=new ts(gx,vx,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,l,o]=t;for(const h of t)this.remove(h);if(e===Qd)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else if(e===ZA)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,l,o,h,d]=this.children,m=e.getRenderTarget(),v=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const E=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,l),e.setRenderTarget(r,3,i),e.render(t,o),e.setRenderTarget(r,4,i),e.render(t,h),r.texture.generateMipmaps=E,e.setRenderTarget(r,5,i),e.render(t,d),e.setRenderTarget(m,v,y),e.xr.enabled=S,r.texture.needsPMREMUpdate=!0}}class HT extends Xs{constructor(e,t,r,i,s,a,l,o,h,d){e=e!==void 0?e:[],t=t!==void 0?t:Hm,super(e,t,r,i,s,a,l,o,h,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Wte extends wl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new HT(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Eo}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new _p(5,5,5),s=new Io({name:"CubemapFromEquirect",uniforms:ew(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Cc,blending:op});s.uniforms.tEquirect.value=t;const a=new Ii(i,s),l=t.minFilter;return t.minFilter===ou&&(t.minFilter=Eo),new jte(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}const M5=new Ze,J0e=new Ze,Q0e=new wi;let Sm=class{constructor(e=new Ze(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=M5.subVectors(r,t).cross(J0e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(M5),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Q0e.getNormalMatrix(e),i=this.coplanarPoint(M5).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const w_=new il,WC=new Ze;class jT{constructor(e=new Sm,t=new Sm,r=new Sm,i=new Sm,s=new Sm,a=new Sm){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(r),l[3].copy(i),l[4].copy(s),l[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Qd){const r=this.planes,i=e.elements,s=i[0],a=i[1],l=i[2],o=i[3],h=i[4],d=i[5],m=i[6],v=i[7],y=i[8],S=i[9],E=i[10],M=i[11],C=i[12],L=i[13],k=i[14],H=i[15];if(r[0].setComponents(o-s,v-h,M-y,H-C).normalize(),r[1].setComponents(o+s,v+h,M+y,H+C).normalize(),r[2].setComponents(o+a,v+d,M+S,H+L).normalize(),r[3].setComponents(o-a,v-d,M-S,H-L).normalize(),r[4].setComponents(o-l,v-m,M-E,H-k).normalize(),t===Qd)r[5].setComponents(o+l,v+m,M+E,H+k).normalize();else if(t===ZA)r[5].setComponents(l,m,E,k).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),w_.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),w_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(w_)}intersectsSprite(e){return w_.center.set(0,0,0),w_.radius=.7071067811865476,w_.applyMatrix4(e.matrixWorld),this.intersectsSphere(w_)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(WC.x=i.normal.x>0?e.max.x:e.min.x,WC.y=i.normal.y>0?e.max.y:e.min.y,WC.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(WC)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Xte(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function eve(n){const e=new WeakMap;function t(l,o){const h=l.array,d=l.usage,m=h.byteLength,v=n.createBuffer();n.bindBuffer(o,v),n.bufferData(o,h,d),l.onUploadCallback();let y;if(h instanceof Float32Array)y=n.FLOAT;else if(h instanceof Uint16Array)l.isFloat16BufferAttribute?y=n.HALF_FLOAT:y=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)y=n.SHORT;else if(h instanceof Uint32Array)y=n.UNSIGNED_INT;else if(h instanceof Int32Array)y=n.INT;else if(h instanceof Int8Array)y=n.BYTE;else if(h instanceof Uint8Array)y=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)y=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:v,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version,size:m}}function r(l,o,h){const d=o.array,m=o._updateRange,v=o.updateRanges;if(n.bindBuffer(h,l),m.count===-1&&v.length===0&&n.bufferSubData(h,0,d),v.length!==0){for(let y=0,S=v.length;y<S;y++){const E=v[y];n.bufferSubData(h,E.start*d.BYTES_PER_ELEMENT,d,E.start,E.count)}o.clearUpdateRanges()}m.count!==-1&&(n.bufferSubData(h,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count),m.count=-1),o.onUploadCallback()}function i(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function s(l){l.isInterleavedBufferAttribute&&(l=l.data);const o=e.get(l);o&&(n.deleteBuffer(o.buffer),e.delete(l))}function a(l,o){if(l.isGLBufferAttribute){const d=e.get(l);(!d||d.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);if(h===void 0)e.set(l,t(l,o));else if(h.version<l.version){if(h.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(h.buffer,l,o),h.version=l.version}}return{get:i,remove:s,update:a}}class tg extends $r{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,l=Math.floor(r),o=Math.floor(i),h=l+1,d=o+1,m=e/l,v=t/o,y=[],S=[],E=[],M=[];for(let C=0;C<d;C++){const L=C*v-a;for(let k=0;k<h;k++){const H=k*m-s;S.push(H,-L,0),E.push(0,0,1),M.push(k/l),M.push(1-C/o)}}for(let C=0;C<o;C++)for(let L=0;L<l;L++){const k=L+h*C,H=L+h*(C+1),q=L+1+h*(C+1),Z=L+1+h*C;y.push(k,H,Z),y.push(H,q,Z)}this.setIndex(y),this.setAttribute("position",new ar(S,3)),this.setAttribute("normal",new ar(E,3)),this.setAttribute("uv",new ar(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tg(e.width,e.height,e.widthSegments,e.heightSegments)}}var tve=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,nve=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rve=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ive=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sve=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,ove=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,ave=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lve=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cve=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,uve=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,hve=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,fve=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dve=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,pve=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mve=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gve=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,vve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_ve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,yve=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,xve=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bve=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,wve=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Sve=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Ave=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Tve=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Mve=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Cve=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Eve=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Ive=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Rve=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Pve="gl_FragColor = linearToOutputTexel( gl_FragColor );",Lve=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Dve=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Bve=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,kve=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Ove=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Fve=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Nve=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,zve=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Uve=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gve=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Vve=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Hve=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,jve=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Wve=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Xve=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,$ve=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,qve=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Zve=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Yve=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kve=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Jve=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Qve=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,e_e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,t_e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,n_e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,r_e=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,i_e=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,s_e=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,o_e=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,a_e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,l_e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,c_e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,u_e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,h_e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,f_e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,d_e=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,p_e=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,m_e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,g_e=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,v_e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,__e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,y_e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,x_e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,b_e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,w_e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,S_e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,A_e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,T_e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,M_e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,C_e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,E_e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,I_e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,R_e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,P_e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,L_e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,D_e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,B_e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,k_e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,O_e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,F_e=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,N_e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,z_e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,U_e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,G_e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,V_e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,H_e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,j_e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,W_e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,X_e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,$_e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,q_e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Z_e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Y_e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,K_e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,J_e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Q_e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const eye=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,tye=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rye=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sye=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,oye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aye=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,lye=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,cye=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,uye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hye=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,fye=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dye=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,mye=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gye=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vye=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_ye=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,yye=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xye=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,bye=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,wye=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Sye=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Aye=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Tye=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mye=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Cye=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Eye=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Iye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Rye=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Pye=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Lye=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Dye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Mi={alphahash_fragment:tve,alphahash_pars_fragment:nve,alphamap_fragment:rve,alphamap_pars_fragment:ive,alphatest_fragment:sve,alphatest_pars_fragment:ove,aomap_fragment:ave,aomap_pars_fragment:lve,batching_pars_vertex:cve,batching_vertex:uve,begin_vertex:hve,beginnormal_vertex:fve,bsdfs:dve,iridescence_fragment:pve,bumpmap_pars_fragment:mve,clipping_planes_fragment:gve,clipping_planes_pars_fragment:vve,clipping_planes_pars_vertex:_ve,clipping_planes_vertex:yve,color_fragment:xve,color_pars_fragment:bve,color_pars_vertex:wve,color_vertex:Sve,common:Ave,cube_uv_reflection_fragment:Tve,defaultnormal_vertex:Mve,displacementmap_pars_vertex:Cve,displacementmap_vertex:Eve,emissivemap_fragment:Ive,emissivemap_pars_fragment:Rve,colorspace_fragment:Pve,colorspace_pars_fragment:Lve,envmap_fragment:Dve,envmap_common_pars_fragment:Bve,envmap_pars_fragment:kve,envmap_pars_vertex:Ove,envmap_physical_pars_fragment:$ve,envmap_vertex:Fve,fog_vertex:Nve,fog_pars_vertex:zve,fog_fragment:Uve,fog_pars_fragment:Gve,gradientmap_pars_fragment:Vve,lightmap_pars_fragment:Hve,lights_lambert_fragment:jve,lights_lambert_pars_fragment:Wve,lights_pars_begin:Xve,lights_toon_fragment:qve,lights_toon_pars_fragment:Zve,lights_phong_fragment:Yve,lights_phong_pars_fragment:Kve,lights_physical_fragment:Jve,lights_physical_pars_fragment:Qve,lights_fragment_begin:e_e,lights_fragment_maps:t_e,lights_fragment_end:n_e,logdepthbuf_fragment:r_e,logdepthbuf_pars_fragment:i_e,logdepthbuf_pars_vertex:s_e,logdepthbuf_vertex:o_e,map_fragment:a_e,map_pars_fragment:l_e,map_particle_fragment:c_e,map_particle_pars_fragment:u_e,metalnessmap_fragment:h_e,metalnessmap_pars_fragment:f_e,morphinstance_vertex:d_e,morphcolor_vertex:p_e,morphnormal_vertex:m_e,morphtarget_pars_vertex:g_e,morphtarget_vertex:v_e,normal_fragment_begin:__e,normal_fragment_maps:y_e,normal_pars_fragment:x_e,normal_pars_vertex:b_e,normal_vertex:w_e,normalmap_pars_fragment:S_e,clearcoat_normal_fragment_begin:A_e,clearcoat_normal_fragment_maps:T_e,clearcoat_pars_fragment:M_e,iridescence_pars_fragment:C_e,opaque_fragment:E_e,packing:I_e,premultiplied_alpha_fragment:R_e,project_vertex:P_e,dithering_fragment:L_e,dithering_pars_fragment:D_e,roughnessmap_fragment:B_e,roughnessmap_pars_fragment:k_e,shadowmap_pars_fragment:O_e,shadowmap_pars_vertex:F_e,shadowmap_vertex:N_e,shadowmask_pars_fragment:z_e,skinbase_vertex:U_e,skinning_pars_vertex:G_e,skinning_vertex:V_e,skinnormal_vertex:H_e,specularmap_fragment:j_e,specularmap_pars_fragment:W_e,tonemapping_fragment:X_e,tonemapping_pars_fragment:$_e,transmission_fragment:q_e,transmission_pars_fragment:Z_e,uv_pars_fragment:Y_e,uv_pars_vertex:K_e,uv_vertex:J_e,worldpos_vertex:Q_e,background_vert:eye,background_frag:tye,backgroundCube_vert:nye,backgroundCube_frag:rye,cube_vert:iye,cube_frag:sye,depth_vert:oye,depth_frag:aye,distanceRGBA_vert:lye,distanceRGBA_frag:cye,equirect_vert:uye,equirect_frag:hye,linedashed_vert:fye,linedashed_frag:dye,meshbasic_vert:pye,meshbasic_frag:mye,meshlambert_vert:gye,meshlambert_frag:vye,meshmatcap_vert:_ye,meshmatcap_frag:yye,meshnormal_vert:xye,meshnormal_frag:bye,meshphong_vert:wye,meshphong_frag:Sye,meshphysical_vert:Aye,meshphysical_frag:Tye,meshtoon_vert:Mye,meshtoon_frag:Cye,points_vert:Eye,points_frag:Iye,shadow_vert:Rye,shadow_frag:Pye,sprite_vert:Lye,sprite_frag:Dye},hr={common:{diffuse:{value:new Vn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new wi},alphaMap:{value:null},alphaMapTransform:{value:new wi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new wi}},envmap:{envMap:{value:null},envMapRotation:{value:new wi},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new wi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new wi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new wi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new wi},normalScale:{value:new nn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new wi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new wi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new wi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new wi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Vn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new wi},alphaTest:{value:0},uvTransform:{value:new wi}},sprite:{diffuse:{value:new Vn(16777215)},opacity:{value:1},center:{value:new nn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new wi},alphaMap:{value:null},alphaMapTransform:{value:new wi},alphaTest:{value:0}}},Nf={basic:{uniforms:_c([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.fog]),vertexShader:Mi.meshbasic_vert,fragmentShader:Mi.meshbasic_frag},lambert:{uniforms:_c([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)}}]),vertexShader:Mi.meshlambert_vert,fragmentShader:Mi.meshlambert_frag},phong:{uniforms:_c([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)},specular:{value:new Vn(1118481)},shininess:{value:30}}]),vertexShader:Mi.meshphong_vert,fragmentShader:Mi.meshphong_frag},standard:{uniforms:_c([hr.common,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.roughnessmap,hr.metalnessmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Mi.meshphysical_vert,fragmentShader:Mi.meshphysical_frag},toon:{uniforms:_c([hr.common,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.gradientmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)}}]),vertexShader:Mi.meshtoon_vert,fragmentShader:Mi.meshtoon_frag},matcap:{uniforms:_c([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,{matcap:{value:null}}]),vertexShader:Mi.meshmatcap_vert,fragmentShader:Mi.meshmatcap_frag},points:{uniforms:_c([hr.points,hr.fog]),vertexShader:Mi.points_vert,fragmentShader:Mi.points_frag},dashed:{uniforms:_c([hr.common,hr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Mi.linedashed_vert,fragmentShader:Mi.linedashed_frag},depth:{uniforms:_c([hr.common,hr.displacementmap]),vertexShader:Mi.depth_vert,fragmentShader:Mi.depth_frag},normal:{uniforms:_c([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,{opacity:{value:1}}]),vertexShader:Mi.meshnormal_vert,fragmentShader:Mi.meshnormal_frag},sprite:{uniforms:_c([hr.sprite,hr.fog]),vertexShader:Mi.sprite_vert,fragmentShader:Mi.sprite_frag},background:{uniforms:{uvTransform:{value:new wi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Mi.background_vert,fragmentShader:Mi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new wi}},vertexShader:Mi.backgroundCube_vert,fragmentShader:Mi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Mi.cube_vert,fragmentShader:Mi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Mi.equirect_vert,fragmentShader:Mi.equirect_frag},distanceRGBA:{uniforms:_c([hr.common,hr.displacementmap,{referencePosition:{value:new Ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Mi.distanceRGBA_vert,fragmentShader:Mi.distanceRGBA_frag},shadow:{uniforms:_c([hr.lights,hr.fog,{color:{value:new Vn(0)},opacity:{value:1}}]),vertexShader:Mi.shadow_vert,fragmentShader:Mi.shadow_frag}};Nf.physical={uniforms:_c([Nf.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new wi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new wi},clearcoatNormalScale:{value:new nn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new wi},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new wi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new wi},sheen:{value:0},sheenColor:{value:new Vn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new wi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new wi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new wi},transmissionSamplerSize:{value:new nn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new wi},attenuationDistance:{value:0},attenuationColor:{value:new Vn(0)},specularColor:{value:new Vn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new wi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new wi},anisotropyVector:{value:new nn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new wi}}]),vertexShader:Mi.meshphysical_vert,fragmentShader:Mi.meshphysical_frag};const XC={r:0,b:0,g:0},S_=new zu,Bye=new Gr;function kye(n,e,t,r,i,s,a){const l=new Vn(0);let o=s===!0?0:1,h,d,m=null,v=0,y=null;function S(L){let k=L.isScene===!0?L.background:null;return k&&k.isTexture&&(k=(L.backgroundBlurriness>0?t:e).get(k)),k}function E(L){let k=!1;const H=S(L);H===null?C(l,o):H&&H.isColor&&(C(H,1),k=!0);const q=n.xr.getEnvironmentBlendMode();q==="additive"?r.buffers.color.setClear(0,0,0,1,a):q==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||k)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function M(L,k){const H=S(k);H&&(H.isCubeTexture||H.mapping===vw)?(d===void 0&&(d=new Ii(new _p(1,1,1),new Io({name:"BackgroundCubeMaterial",uniforms:ew(Nf.backgroundCube.uniforms),vertexShader:Nf.backgroundCube.vertexShader,fragmentShader:Nf.backgroundCube.fragmentShader,side:Cc,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(q,Z,ee){this.matrixWorld.copyPosition(ee.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(d)),S_.copy(k.backgroundRotation),S_.x*=-1,S_.y*=-1,S_.z*=-1,H.isCubeTexture&&H.isRenderTargetTexture===!1&&(S_.y*=-1,S_.z*=-1),d.material.uniforms.envMap.value=H,d.material.uniforms.flipEnvMap.value=H.isCubeTexture&&H.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=k.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(Bye.makeRotationFromEuler(S_)),d.material.toneMapped=ms.getTransfer(H.colorSpace)!==to,(m!==H||v!==H.version||y!==n.toneMapping)&&(d.material.needsUpdate=!0,m=H,v=H.version,y=n.toneMapping),d.layers.enableAll(),L.unshift(d,d.geometry,d.material,0,0,null)):H&&H.isTexture&&(h===void 0&&(h=new Ii(new tg(2,2),new Io({name:"BackgroundMaterial",uniforms:ew(Nf.background.uniforms),vertexShader:Nf.background.vertexShader,fragmentShader:Nf.background.fragmentShader,side:Dh,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=H,h.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,h.material.toneMapped=ms.getTransfer(H.colorSpace)!==to,H.matrixAutoUpdate===!0&&H.updateMatrix(),h.material.uniforms.uvTransform.value.copy(H.matrix),(m!==H||v!==H.version||y!==n.toneMapping)&&(h.material.needsUpdate=!0,m=H,v=H.version,y=n.toneMapping),h.layers.enableAll(),L.unshift(h,h.geometry,h.material,0,0,null))}function C(L,k){L.getRGB(XC,Hte(n)),r.buffers.color.setClear(XC.r,XC.g,XC.b,k,a)}return{getClearColor:function(){return l},setClearColor:function(L,k=1){l.set(L),o=k,C(l,o)},getClearAlpha:function(){return o},setClearAlpha:function(L){o=L,C(l,o)},render:E,addToRenderList:M}}function Oye(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=v(null);let s=i,a=!1;function l(ae,fe,Se,Ce,Ie){let je=!1;const Le=m(Ce,Se,fe);s!==Le&&(s=Le,h(s.object)),je=y(ae,Ce,Se,Ie),je&&S(ae,Ce,Se,Ie),Ie!==null&&e.update(Ie,n.ELEMENT_ARRAY_BUFFER),(je||a)&&(a=!1,H(ae,fe,Se,Ce),Ie!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(Ie).buffer))}function o(){return n.createVertexArray()}function h(ae){return n.bindVertexArray(ae)}function d(ae){return n.deleteVertexArray(ae)}function m(ae,fe,Se){const Ce=Se.wireframe===!0;let Ie=r[ae.id];Ie===void 0&&(Ie={},r[ae.id]=Ie);let je=Ie[fe.id];je===void 0&&(je={},Ie[fe.id]=je);let Le=je[Ce];return Le===void 0&&(Le=v(o()),je[Ce]=Le),Le}function v(ae){const fe=[],Se=[],Ce=[];for(let Ie=0;Ie<t;Ie++)fe[Ie]=0,Se[Ie]=0,Ce[Ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:Se,attributeDivisors:Ce,object:ae,attributes:{},index:null}}function y(ae,fe,Se,Ce){const Ie=s.attributes,je=fe.attributes;let Le=0;const ot=Se.getAttributes();for(const ye in ot)if(ot[ye].location>=0){const Ve=Ie[ye];let _t=je[ye];if(_t===void 0&&(ye==="instanceMatrix"&&ae.instanceMatrix&&(_t=ae.instanceMatrix),ye==="instanceColor"&&ae.instanceColor&&(_t=ae.instanceColor)),Ve===void 0||Ve.attribute!==_t||_t&&Ve.data!==_t.data)return!0;Le++}return s.attributesNum!==Le||s.index!==Ce}function S(ae,fe,Se,Ce){const Ie={},je=fe.attributes;let Le=0;const ot=Se.getAttributes();for(const ye in ot)if(ot[ye].location>=0){let Ve=je[ye];Ve===void 0&&(ye==="instanceMatrix"&&ae.instanceMatrix&&(Ve=ae.instanceMatrix),ye==="instanceColor"&&ae.instanceColor&&(Ve=ae.instanceColor));const _t={};_t.attribute=Ve,Ve&&Ve.data&&(_t.data=Ve.data),Ie[ye]=_t,Le++}s.attributes=Ie,s.attributesNum=Le,s.index=Ce}function E(){const ae=s.newAttributes;for(let fe=0,Se=ae.length;fe<Se;fe++)ae[fe]=0}function M(ae){C(ae,0)}function C(ae,fe){const Se=s.newAttributes,Ce=s.enabledAttributes,Ie=s.attributeDivisors;Se[ae]=1,Ce[ae]===0&&(n.enableVertexAttribArray(ae),Ce[ae]=1),Ie[ae]!==fe&&(n.vertexAttribDivisor(ae,fe),Ie[ae]=fe)}function L(){const ae=s.newAttributes,fe=s.enabledAttributes;for(let Se=0,Ce=fe.length;Se<Ce;Se++)fe[Se]!==ae[Se]&&(n.disableVertexAttribArray(Se),fe[Se]=0)}function k(ae,fe,Se,Ce,Ie,je,Le){Le===!0?n.vertexAttribIPointer(ae,fe,Se,Ie,je):n.vertexAttribPointer(ae,fe,Se,Ce,Ie,je)}function H(ae,fe,Se,Ce){E();const Ie=Ce.attributes,je=Se.getAttributes(),Le=fe.defaultAttributeValues;for(const ot in je){const ye=je[ot];if(ye.location>=0){let $e=Ie[ot];if($e===void 0&&(ot==="instanceMatrix"&&ae.instanceMatrix&&($e=ae.instanceMatrix),ot==="instanceColor"&&ae.instanceColor&&($e=ae.instanceColor)),$e!==void 0){const Ve=$e.normalized,_t=$e.itemSize,wt=e.get($e);if(wt===void 0)continue;const Vt=wt.buffer,lt=wt.type,Ht=wt.bytesPerElement,Qt=lt===n.INT||lt===n.UNSIGNED_INT||$e.gpuType===$L;if($e.isInterleavedBufferAttribute){const rn=$e.data,jn=rn.stride,Bn=$e.offset;if(rn.isInstancedInterleavedBuffer){for(let Tn=0;Tn<ye.locationSize;Tn++)C(ye.location+Tn,rn.meshPerAttribute);ae.isInstancedMesh!==!0&&Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=rn.meshPerAttribute*rn.count)}else for(let Tn=0;Tn<ye.locationSize;Tn++)M(ye.location+Tn);n.bindBuffer(n.ARRAY_BUFFER,Vt);for(let Tn=0;Tn<ye.locationSize;Tn++)k(ye.location+Tn,_t/ye.locationSize,lt,Ve,jn*Ht,(Bn+_t/ye.locationSize*Tn)*Ht,Qt)}else{if($e.isInstancedBufferAttribute){for(let rn=0;rn<ye.locationSize;rn++)C(ye.location+rn,$e.meshPerAttribute);ae.isInstancedMesh!==!0&&Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=$e.meshPerAttribute*$e.count)}else for(let rn=0;rn<ye.locationSize;rn++)M(ye.location+rn);n.bindBuffer(n.ARRAY_BUFFER,Vt);for(let rn=0;rn<ye.locationSize;rn++)k(ye.location+rn,_t/ye.locationSize,lt,Ve,_t*Ht,_t/ye.locationSize*rn*Ht,Qt)}}else if(Le!==void 0){const Ve=Le[ot];if(Ve!==void 0)switch(Ve.length){case 2:n.vertexAttrib2fv(ye.location,Ve);break;case 3:n.vertexAttrib3fv(ye.location,Ve);break;case 4:n.vertexAttrib4fv(ye.location,Ve);break;default:n.vertexAttrib1fv(ye.location,Ve)}}}}L()}function q(){re();for(const ae in r){const fe=r[ae];for(const Se in fe){const Ce=fe[Se];for(const Ie in Ce)d(Ce[Ie].object),delete Ce[Ie];delete fe[Se]}delete r[ae]}}function Z(ae){if(r[ae.id]===void 0)return;const fe=r[ae.id];for(const Se in fe){const Ce=fe[Se];for(const Ie in Ce)d(Ce[Ie].object),delete Ce[Ie];delete fe[Se]}delete r[ae.id]}function ee(ae){for(const fe in r){const Se=r[fe];if(Se[ae.id]===void 0)continue;const Ce=Se[ae.id];for(const Ie in Ce)d(Ce[Ie].object),delete Ce[Ie];delete Se[ae.id]}}function re(){se(),a=!0,s!==i&&(s=i,h(s.object))}function se(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:l,reset:re,resetDefaultState:se,dispose:q,releaseStatesOfGeometry:Z,releaseStatesOfProgram:ee,initAttributes:E,enableAttribute:M,disableUnusedAttributes:L}}function Fye(n,e,t){let r;function i(h){r=h}function s(h,d){n.drawArrays(r,h,d),t.update(d,r,1)}function a(h,d,m){m!==0&&(n.drawArraysInstanced(r,h,d,m),t.update(d,r,m))}function l(h,d,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,h,0,d,0,m);let y=0;for(let S=0;S<m;S++)y+=d[S];t.update(y,r,1)}function o(h,d,m,v){if(m===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let S=0;S<h.length;S++)a(h[S],d[S],v[S]);else{y.multiDrawArraysInstancedWEBGL(r,h,0,d,0,v,0,m);let S=0;for(let E=0;E<m;E++)S+=d[E];for(let E=0;E<v.length;E++)t.update(S,r,v[E])}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=l,this.renderMultiDrawInstances=o}function Nye(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(Z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(Z){return!(Z!==Wl&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(Z){const ee=Z===Ch&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Z!==Zf&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&Z!==Ac&&!ee)}function o(Z){if(Z==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return Z==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const d=o(h);d!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",d,"instead."),h=d);const m=t.logarithmicDepthBuffer===!0,v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),E=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),M=n.getParameter(n.MAX_VERTEX_ATTRIBS),C=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),k=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),H=y>0,q=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:o,textureFormatReadable:a,textureTypeReadable:l,precision:h,logarithmicDepthBuffer:m,maxTextures:v,maxVertexTextures:y,maxTextureSize:S,maxCubemapSize:E,maxAttributes:M,maxVertexUniforms:C,maxVaryings:L,maxFragmentUniforms:k,vertexTextures:H,maxSamples:q}}function zye(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Sm,l=new wi,o={value:null,needsUpdate:!1};this.uniform=o,this.numPlanes=0,this.numIntersection=0,this.init=function(m,v){const y=m.length!==0||v||r!==0||i;return i=v,r=m.length,y},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(m,v){t=d(m,v,0)},this.setState=function(m,v,y){const S=m.clippingPlanes,E=m.clipIntersection,M=m.clipShadows,C=n.get(m);if(!i||S===null||S.length===0||s&&!M)s?d(null):h();else{const L=s?0:r,k=L*4;let H=C.clippingState||null;o.value=H,H=d(S,v,k,y);for(let q=0;q!==k;++q)H[q]=t[q];C.clippingState=H,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=L}};function h(){o.value!==t&&(o.value=t,o.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(m,v,y,S){const E=m!==null?m.length:0;let M=null;if(E!==0){if(M=o.value,S!==!0||M===null){const C=y+E*4,L=v.matrixWorldInverse;l.getNormalMatrix(L),(M===null||M.length<C)&&(M=new Float32Array(C));for(let k=0,H=y;k!==E;++k,H+=4)a.copy(m[k]).applyMatrix4(L,l),a.normal.toArray(M,H),M[H+3]=a.constant}o.value=M,o.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,M}}function Uye(n){let e=new WeakMap;function t(a,l){return l===VA?a.mapping=Hm:l===HA&&(a.mapping=uv),a}function r(a){if(a&&a.isTexture){const l=a.mapping;if(l===VA||l===HA)if(e.has(a)){const o=e.get(a).texture;return t(o,a.mapping)}else{const o=a.image;if(o&&o.height>0){const h=new Wte(o.height);return h.fromEquirectangularTexture(n,a),e.set(a,h),a.addEventListener("dispose",i),t(h.texture,a.mapping)}else return null}}return a}function i(a){const l=a.target;l.removeEventListener("dispose",i);const o=e.get(l);o!==void 0&&(e.delete(l),o.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class ed extends VT{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,l=i+t,o=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,l-=d*this.view.offsetY,o=l-d*this.view.height}this.projectionMatrix.makeOrthographic(s,a,l,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const pb=4,Pj=[.125,.215,.35,.446,.526,.582],dy=20,C5=new ed,Lj=new Vn;let E5=null,I5=0,R5=0,P5=!1;const cy=(1+Math.sqrt(5))/2,_x=1/cy,Dj=[new Ze(-cy,_x,0),new Ze(cy,_x,0),new Ze(-_x,0,cy),new Ze(_x,0,cy),new Ze(0,cy,-_x),new Ze(0,cy,_x),new Ze(-1,1,-1),new Ze(1,1,-1),new Ze(-1,1,1),new Ze(1,1,1)];class xF{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){E5=this._renderer.getRenderTarget(),I5=this._renderer.getActiveCubeFace(),R5=this._renderer.getActiveMipmapLevel(),P5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Oj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=kj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(E5,I5,R5),this._renderer.xr.enabled=P5,e.scissorTest=!1,$C(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Hm||e.mapping===uv?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),E5=this._renderer.getRenderTarget(),I5=this._renderer.getActiveCubeFace(),R5=this._renderer.getActiveMipmapLevel(),P5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Eo,minFilter:Eo,generateMipmaps:!1,type:Ch,format:Wl,colorSpace:Ha,depthBuffer:!1},i=Bj(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Bj(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Gye(s)),this._blurMaterial=Vye(s,e,t)}return i}_compileMaterial(e){const t=new Ii(this._lodPlanes[0],e);this._renderer.compile(t,C5)}_sceneToCubeUV(e,t,r,i){const l=new ts(90,1,t,r),o=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,m=d.autoClear,v=d.toneMapping;d.getClearColor(Lj),d.toneMapping=ap,d.autoClear=!1;const y=new _o({name:"PMREM.Background",side:Cc,depthWrite:!1,depthTest:!1}),S=new Ii(new _p,y);let E=!1;const M=e.background;M?M.isColor&&(y.color.copy(M),e.background=null,E=!0):(y.color.copy(Lj),E=!0);for(let C=0;C<6;C++){const L=C%3;L===0?(l.up.set(0,o[C],0),l.lookAt(h[C],0,0)):L===1?(l.up.set(0,0,o[C]),l.lookAt(0,h[C],0)):(l.up.set(0,o[C],0),l.lookAt(0,0,h[C]));const k=this._cubeSize;$C(i,L*k,C>2?k:0,k,k),d.setRenderTarget(i),E&&d.render(S,l),d.render(e,l)}S.geometry.dispose(),S.material.dispose(),d.toneMapping=v,d.autoClear=m,e.background=M}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Hm||e.mapping===uv;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Oj()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=kj());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new Ii(this._lodPlanes[0],s),l=s.uniforms;l.envMap.value=e;const o=this._cubeSize;$C(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(a,C5)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),l=Dj[(i-s-1)%Dj.length];this._blur(e,s-1,s,a,l)}t.autoClear=r}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,l){const o=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,m=new Ii(this._lodPlanes[i],h),v=h.uniforms,y=this._sizeLods[r]-1,S=isFinite(s)?Math.PI/(2*y):2*Math.PI/(2*dy-1),E=s/S,M=isFinite(s)?1+Math.floor(d*E):dy;M>dy&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${dy}`);const C=[];let L=0;for(let ee=0;ee<dy;++ee){const re=ee/E,se=Math.exp(-re*re/2);C.push(se),ee===0?L+=se:ee<M&&(L+=2*se)}for(let ee=0;ee<C.length;ee++)C[ee]=C[ee]/L;v.envMap.value=e.texture,v.samples.value=M,v.weights.value=C,v.latitudinal.value=a==="latitudinal",l&&(v.poleAxis.value=l);const{_lodMax:k}=this;v.dTheta.value=S,v.mipInt.value=k-r;const H=this._sizeLods[i],q=3*H*(i>k-pb?i-k+pb:0),Z=4*(this._cubeSize-H);$C(t,q,Z,3*H,2*H),o.setRenderTarget(t),o.render(m,C5)}}function Gye(n){const e=[],t=[],r=[];let i=n;const s=n-pb+1+Pj.length;for(let a=0;a<s;a++){const l=Math.pow(2,i);t.push(l);let o=1/l;a>n-pb?o=Pj[a-n+pb-1]:a===0&&(o=0),r.push(o);const h=1/(l-2),d=-h,m=1+h,v=[d,d,m,d,m,m,d,d,m,m,d,m],y=6,S=6,E=3,M=2,C=1,L=new Float32Array(E*S*y),k=new Float32Array(M*S*y),H=new Float32Array(C*S*y);for(let Z=0;Z<y;Z++){const ee=Z%3*2/3-1,re=Z>2?0:-1,se=[ee,re,0,ee+2/3,re,0,ee+2/3,re+1,0,ee,re,0,ee+2/3,re+1,0,ee,re+1,0];L.set(se,E*S*Z),k.set(v,M*S*Z);const ae=[Z,Z,Z,Z,Z,Z];H.set(ae,C*S*Z)}const q=new $r;q.setAttribute("position",new Bi(L,E)),q.setAttribute("uv",new Bi(k,M)),q.setAttribute("faceIndex",new Bi(H,C)),e.push(q),i>pb&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function Bj(n,e,t){const r=new wl(n,e,t);return r.texture.mapping=vw,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function $C(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function Vye(n,e,t){const r=new Float32Array(dy),i=new Ze(0,1,0);return new Io({name:"SphericalGaussianBlur",defines:{n:dy,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:j6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:op,depthTest:!1,depthWrite:!1})}function kj(){return new Io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:j6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:op,depthTest:!1,depthWrite:!1})}function Oj(){return new Io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:j6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:op,depthTest:!1,depthWrite:!1})}function j6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Hye(n){let e=new WeakMap,t=null;function r(l){if(l&&l.isTexture){const o=l.mapping,h=o===VA||o===HA,d=o===Hm||o===uv;if(h||d){let m=e.get(l);const v=m!==void 0?m.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==v)return t===null&&(t=new xF(n)),m=h?t.fromEquirectangular(l,m):t.fromCubemap(l,m),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),m.texture;if(m!==void 0)return m.texture;{const y=l.image;return h&&y&&y.height>0||d&&y&&i(y)?(t===null&&(t=new xF(n)),m=h?t.fromEquirectangular(l):t.fromCubemap(l),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),l.addEventListener("dispose",s),m.texture):null}}}return l}function i(l){let o=0;const h=6;for(let d=0;d<h;d++)l[d]!==void 0&&o++;return o===h}function s(l){const o=l.target;o.removeEventListener("dispose",s);const h=e.get(o);h!==void 0&&(e.delete(o),h.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function jye(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&U6("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Wye(n,e,t,r){const i={},s=new WeakMap;function a(m){const v=m.target;v.index!==null&&e.remove(v.index);for(const S in v.attributes)e.remove(v.attributes[S]);for(const S in v.morphAttributes){const E=v.morphAttributes[S];for(let M=0,C=E.length;M<C;M++)e.remove(E[M])}v.removeEventListener("dispose",a),delete i[v.id];const y=s.get(v);y&&(e.remove(y),s.delete(v)),r.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,t.memory.geometries--}function l(m,v){return i[v.id]===!0||(v.addEventListener("dispose",a),i[v.id]=!0,t.memory.geometries++),v}function o(m){const v=m.attributes;for(const S in v)e.update(v[S],n.ARRAY_BUFFER);const y=m.morphAttributes;for(const S in y){const E=y[S];for(let M=0,C=E.length;M<C;M++)e.update(E[M],n.ARRAY_BUFFER)}}function h(m){const v=[],y=m.index,S=m.attributes.position;let E=0;if(y!==null){const L=y.array;E=y.version;for(let k=0,H=L.length;k<H;k+=3){const q=L[k+0],Z=L[k+1],ee=L[k+2];v.push(q,Z,Z,ee,ee,q)}}else if(S!==void 0){const L=S.array;E=S.version;for(let k=0,H=L.length/3-1;k<H;k+=3){const q=k+0,Z=k+1,ee=k+2;v.push(q,Z,Z,ee,ee,q)}}else return;const M=new(Nte(v)?H6:V6)(v,1);M.version=E;const C=s.get(m);C&&e.remove(C),s.set(m,M)}function d(m){const v=s.get(m);if(v){const y=m.index;y!==null&&v.version<y.version&&h(m)}else h(m);return s.get(m)}return{get:l,update:o,getWireframeAttribute:d}}function Xye(n,e,t){let r;function i(v){r=v}let s,a;function l(v){s=v.type,a=v.bytesPerElement}function o(v,y){n.drawElements(r,y,s,v*a),t.update(y,r,1)}function h(v,y,S){S!==0&&(n.drawElementsInstanced(r,y,s,v*a,S),t.update(y,r,S))}function d(v,y,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,y,0,s,v,0,S);let M=0;for(let C=0;C<S;C++)M+=y[C];t.update(M,r,1)}function m(v,y,S,E){if(S===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let C=0;C<v.length;C++)h(v[C]/a,y[C],E[C]);else{M.multiDrawElementsInstancedWEBGL(r,y,0,s,v,0,E,0,S);let C=0;for(let L=0;L<S;L++)C+=y[L];for(let L=0;L<E.length;L++)t.update(C,r,E[L])}}this.setMode=i,this.setIndex=l,this.render=o,this.renderInstances=h,this.renderMultiDraw=d,this.renderMultiDrawInstances=m}function $ye(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,l){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function qye(n,e,t){const r=new WeakMap,i=new Is;function s(a,l,o){const h=a.morphTargetInfluences,d=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,m=d!==void 0?d.length:0;let v=r.get(l);if(v===void 0||v.count!==m){let ae=function(){re.dispose(),r.delete(l),l.removeEventListener("dispose",ae)};var y=ae;v!==void 0&&v.texture.dispose();const S=l.morphAttributes.position!==void 0,E=l.morphAttributes.normal!==void 0,M=l.morphAttributes.color!==void 0,C=l.morphAttributes.position||[],L=l.morphAttributes.normal||[],k=l.morphAttributes.color||[];let H=0;S===!0&&(H=1),E===!0&&(H=2),M===!0&&(H=3);let q=l.attributes.position.count*H,Z=1;q>e.maxTextureSize&&(Z=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const ee=new Float32Array(q*Z*4*m),re=new eD(ee,q,Z,m);re.type=Ac,re.needsUpdate=!0;const se=H*4;for(let fe=0;fe<m;fe++){const Se=C[fe],Ce=L[fe],Ie=k[fe],je=q*Z*4*fe;for(let Le=0;Le<Se.count;Le++){const ot=Le*se;S===!0&&(i.fromBufferAttribute(Se,Le),ee[je+ot+0]=i.x,ee[je+ot+1]=i.y,ee[je+ot+2]=i.z,ee[je+ot+3]=0),E===!0&&(i.fromBufferAttribute(Ce,Le),ee[je+ot+4]=i.x,ee[je+ot+5]=i.y,ee[je+ot+6]=i.z,ee[je+ot+7]=0),M===!0&&(i.fromBufferAttribute(Ie,Le),ee[je+ot+8]=i.x,ee[je+ot+9]=i.y,ee[je+ot+10]=i.z,ee[je+ot+11]=Ie.itemSize===4?i.w:1)}}v={count:m,texture:re,size:new nn(q,Z)},r.set(l,v),l.addEventListener("dispose",ae)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)o.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let S=0;for(let M=0;M<h.length;M++)S+=h[M];const E=l.morphTargetsRelative?1:1-S;o.getUniforms().setValue(n,"morphTargetBaseInfluence",E),o.getUniforms().setValue(n,"morphTargetInfluences",h)}o.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),o.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}return{update:s}}function Zye(n,e,t,r){let i=new WeakMap;function s(o){const h=r.render.frame,d=o.geometry,m=e.get(o,d);if(i.get(m)!==h&&(e.update(m),i.set(m,h)),o.isInstancedMesh&&(o.hasEventListener("dispose",l)===!1&&o.addEventListener("dispose",l),i.get(o)!==h&&(t.update(o.instanceMatrix,n.ARRAY_BUFFER),o.instanceColor!==null&&t.update(o.instanceColor,n.ARRAY_BUFFER),i.set(o,h))),o.isSkinnedMesh){const v=o.skeleton;i.get(v)!==h&&(v.update(),i.set(v,h))}return m}function a(){i=new WeakMap}function l(o){const h=o.target;h.removeEventListener("dispose",l),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:a}}class W6 extends Xs{constructor(e,t,r,i,s,a,l,o,h,d=By){if(d!==By&&d!==Ky)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===By&&(r=jm),r===void 0&&d===Ky&&(r=Yy),super(null,i,s,a,l,o,d,r,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:Sa,this.minFilter=o!==void 0?o:Sa,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const $te=new Xs,Fj=new W6(1,1),qte=new eD,Zte=new G6,Yte=new HT,Nj=[],zj=[],Uj=new Float32Array(16),Gj=new Float32Array(9),Vj=new Float32Array(4);function _w(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=Nj[i];if(s===void 0&&(s=new Float32Array(i),Nj[i]=s),e!==0){r.toArray(s,0);for(let a=1,l=0;a!==e;++a)l+=t,n[a].toArray(s,l)}return s}function ja(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Wa(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function tD(n,e){let t=zj[e];t===void 0&&(t=new Int32Array(e),zj[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function Yye(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Kye(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ja(t,e))return;n.uniform2fv(this.addr,e),Wa(t,e)}}function Jye(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ja(t,e))return;n.uniform3fv(this.addr,e),Wa(t,e)}}function Qye(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ja(t,e))return;n.uniform4fv(this.addr,e),Wa(t,e)}}function e1e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ja(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Wa(t,e)}else{if(ja(t,r))return;Vj.set(r),n.uniformMatrix2fv(this.addr,!1,Vj),Wa(t,r)}}function t1e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ja(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Wa(t,e)}else{if(ja(t,r))return;Gj.set(r),n.uniformMatrix3fv(this.addr,!1,Gj),Wa(t,r)}}function n1e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ja(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Wa(t,e)}else{if(ja(t,r))return;Uj.set(r),n.uniformMatrix4fv(this.addr,!1,Uj),Wa(t,r)}}function r1e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function i1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ja(t,e))return;n.uniform2iv(this.addr,e),Wa(t,e)}}function s1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ja(t,e))return;n.uniform3iv(this.addr,e),Wa(t,e)}}function o1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ja(t,e))return;n.uniform4iv(this.addr,e),Wa(t,e)}}function a1e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function l1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ja(t,e))return;n.uniform2uiv(this.addr,e),Wa(t,e)}}function c1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ja(t,e))return;n.uniform3uiv(this.addr,e),Wa(t,e)}}function u1e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ja(t,e))return;n.uniform4uiv(this.addr,e),Wa(t,e)}}function h1e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(Fj.compareFunction=N6,s=Fj):s=$te,t.setTexture2D(e||s,i)}function f1e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||Zte,i)}function d1e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||Yte,i)}function p1e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||qte,i)}function m1e(n){switch(n){case 5126:return Yye;case 35664:return Kye;case 35665:return Jye;case 35666:return Qye;case 35674:return e1e;case 35675:return t1e;case 35676:return n1e;case 5124:case 35670:return r1e;case 35667:case 35671:return i1e;case 35668:case 35672:return s1e;case 35669:case 35673:return o1e;case 5125:return a1e;case 36294:return l1e;case 36295:return c1e;case 36296:return u1e;case 35678:case 36198:case 36298:case 36306:case 35682:return h1e;case 35679:case 36299:case 36307:return f1e;case 35680:case 36300:case 36308:case 36293:return d1e;case 36289:case 36303:case 36311:case 36292:return p1e}}function g1e(n,e){n.uniform1fv(this.addr,e)}function v1e(n,e){const t=_w(e,this.size,2);n.uniform2fv(this.addr,t)}function _1e(n,e){const t=_w(e,this.size,3);n.uniform3fv(this.addr,t)}function y1e(n,e){const t=_w(e,this.size,4);n.uniform4fv(this.addr,t)}function x1e(n,e){const t=_w(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function b1e(n,e){const t=_w(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function w1e(n,e){const t=_w(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function S1e(n,e){n.uniform1iv(this.addr,e)}function A1e(n,e){n.uniform2iv(this.addr,e)}function T1e(n,e){n.uniform3iv(this.addr,e)}function M1e(n,e){n.uniform4iv(this.addr,e)}function C1e(n,e){n.uniform1uiv(this.addr,e)}function E1e(n,e){n.uniform2uiv(this.addr,e)}function I1e(n,e){n.uniform3uiv(this.addr,e)}function R1e(n,e){n.uniform4uiv(this.addr,e)}function P1e(n,e,t){const r=this.cache,i=e.length,s=tD(t,i);ja(r,s)||(n.uniform1iv(this.addr,s),Wa(r,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||$te,s[a])}function L1e(n,e,t){const r=this.cache,i=e.length,s=tD(t,i);ja(r,s)||(n.uniform1iv(this.addr,s),Wa(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||Zte,s[a])}function D1e(n,e,t){const r=this.cache,i=e.length,s=tD(t,i);ja(r,s)||(n.uniform1iv(this.addr,s),Wa(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||Yte,s[a])}function B1e(n,e,t){const r=this.cache,i=e.length,s=tD(t,i);ja(r,s)||(n.uniform1iv(this.addr,s),Wa(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||qte,s[a])}function k1e(n){switch(n){case 5126:return g1e;case 35664:return v1e;case 35665:return _1e;case 35666:return y1e;case 35674:return x1e;case 35675:return b1e;case 35676:return w1e;case 5124:case 35670:return S1e;case 35667:case 35671:return A1e;case 35668:case 35672:return T1e;case 35669:case 35673:return M1e;case 5125:return C1e;case 36294:return E1e;case 36295:return I1e;case 36296:return R1e;case 35678:case 36198:case 36298:case 36306:case 35682:return P1e;case 35679:case 36299:case 36307:return L1e;case 35680:case 36300:case 36308:case 36293:return D1e;case 36289:case 36303:case 36311:case 36292:return B1e}}class O1e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=m1e(t.type)}}class F1e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=k1e(t.type)}}class N1e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const l=i[s];l.setValue(e,t[l.id],r)}}}const L5=/(\w+)(\])?(\[|\.)?/g;function Hj(n,e){n.seq.push(e),n.map[e.id]=e}function z1e(n,e,t){const r=n.name,i=r.length;for(L5.lastIndex=0;;){const s=L5.exec(r),a=L5.lastIndex;let l=s[1];const o=s[2]==="]",h=s[3];if(o&&(l=l|0),h===void 0||h==="["&&a+2===i){Hj(t,h===void 0?new O1e(l,n,e):new F1e(l,n,e));break}else{let m=t.map[l];m===void 0&&(m=new N1e(l),Hj(t,m)),t=m}}}class XI{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);z1e(s,a,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const l=t[s],o=r[l.id];o.needsUpdate!==!1&&l.setValue(e,o.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function jj(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const U1e=37297;let G1e=0;function V1e(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const l=a+1;r.push(`${l===e?">":" "} ${l}: ${t[a]}`)}return r.join(`
`)}function H1e(n){const e=ms.getPrimaries(ms.workingColorSpace),t=ms.getPrimaries(n);let r;switch(e===t?r="":e===$A&&t===XA?r="LinearDisplayP3ToLinearSRGB":e===XA&&t===$A&&(r="LinearSRGBToLinearDisplayP3"),n){case Ha:case GT:return[r,"LinearTransferOETF"];case To:case QL:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function Wj(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+V1e(n.getShaderSource(e),a)}else return i}function j1e(n,e){const t=H1e(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function W1e(n,e){let t;switch(e){case yte:t="Linear";break;case xte:t="Reinhard";break;case jL:t="OptimizedCineon";break;case WL:t="ACESFilmic";break;case wte:t="AgX";break;case Ste:t="Neutral";break;case bte:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function X1e(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(xS).join(`
`)}function $1e(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function q1e(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:l}}return t}function xS(n){return n!==""}function Xj(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $j(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Z1e=/^[ \t]*#include +<([\w\d./]+)>/gm;function bF(n){return n.replace(Z1e,K1e)}const Y1e=new Map;function K1e(n,e){let t=Mi[e];if(t===void 0){const r=Y1e.get(e);if(r!==void 0)t=Mi[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return bF(t)}const J1e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function qj(n){return n.replace(J1e,Q1e)}function Q1e(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function Zj(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function exe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===HL?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===HS?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Bf&&(e="SHADOWMAP_TYPE_VSM"),e}function txe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Hm:case uv:e="ENVMAP_TYPE_CUBE";break;case vw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function nxe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case uv:e="ENVMAP_MODE_REFRACTION";break}return e}function rxe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case OT:e="ENVMAP_BLENDING_MULTIPLY";break;case vte:e="ENVMAP_BLENDING_MIX";break;case _te:e="ENVMAP_BLENDING_ADD";break}return e}function ixe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function sxe(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,l=t.fragmentShader;const o=exe(t),h=txe(t),d=nxe(t),m=rxe(t),v=ixe(t),y=X1e(t),S=$1e(s),E=i.createProgram();let M,C,L=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(xS).join(`
`),M.length>0&&(M+=`
`),C=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(xS).join(`
`),C.length>0&&(C+=`
`)):(M=[Zj(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+o:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(xS).join(`
`),C=[Zj(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",t.envMap?"#define "+m:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+o:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ap?"#define TONE_MAPPING":"",t.toneMapping!==ap?Mi.tonemapping_pars_fragment:"",t.toneMapping!==ap?W1e("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Mi.colorspace_pars_fragment,j1e("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(xS).join(`
`)),a=bF(a),a=Xj(a,t),a=$j(a,t),l=bF(l),l=Xj(l,t),l=$j(l,t),a=qj(a),l=qj(l),t.isRawShaderMaterial!==!0&&(L=`#version 300 es
`,M=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,C=["#define varying in",t.glslVersion===yF?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===yF?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+C);const k=L+M+a,H=L+C+l,q=jj(i,i.VERTEX_SHADER,k),Z=jj(i,i.FRAGMENT_SHADER,H);i.attachShader(E,q),i.attachShader(E,Z),t.index0AttributeName!==void 0?i.bindAttribLocation(E,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(E,0,"position"),i.linkProgram(E);function ee(fe){if(n.debug.checkShaderErrors){const Se=i.getProgramInfoLog(E).trim(),Ce=i.getShaderInfoLog(q).trim(),Ie=i.getShaderInfoLog(Z).trim();let je=!0,Le=!0;if(i.getProgramParameter(E,i.LINK_STATUS)===!1)if(je=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,E,q,Z);else{const ot=Wj(i,q,"vertex"),ye=Wj(i,Z,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(E,i.VALIDATE_STATUS)+`

Material Name: `+fe.name+`
Material Type: `+fe.type+`

Program Info Log: `+Se+`
`+ot+`
`+ye)}else Se!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Se):(Ce===""||Ie==="")&&(Le=!1);Le&&(fe.diagnostics={runnable:je,programLog:Se,vertexShader:{log:Ce,prefix:M},fragmentShader:{log:Ie,prefix:C}})}i.deleteShader(q),i.deleteShader(Z),re=new XI(i,E),se=q1e(i,E)}let re;this.getUniforms=function(){return re===void 0&&ee(this),re};let se;this.getAttributes=function(){return se===void 0&&ee(this),se};let ae=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ae===!1&&(ae=i.getProgramParameter(E,U1e)),ae},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(E),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=G1e++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=q,this.fragmentShader=Z,this}let oxe=0;class axe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new lxe(e),t.set(e,r)),r}}class lxe{constructor(e){this.id=oxe++,this.code=e,this.usedTimes=0}}function cxe(n,e,t,r,i,s,a){const l=new Oy,o=new axe,h=new Set,d=[],m=i.logarithmicDepthBuffer,v=i.vertexTextures;let y=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(se){return h.add(se),se===0?"uv":`uv${se}`}function M(se,ae,fe,Se,Ce){const Ie=Se.fog,je=Ce.geometry,Le=se.isMeshStandardMaterial?Se.environment:null,ot=(se.isMeshStandardMaterial?t:e).get(se.envMap||Le),ye=ot&&ot.mapping===vw?ot.image.height:null,$e=S[se.type];se.precision!==null&&(y=i.getMaxPrecision(se.precision),y!==se.precision&&console.warn("THREE.WebGLProgram.getParameters:",se.precision,"not supported, using",y,"instead."));const Ve=je.morphAttributes.position||je.morphAttributes.normal||je.morphAttributes.color,_t=Ve!==void 0?Ve.length:0;let wt=0;je.morphAttributes.position!==void 0&&(wt=1),je.morphAttributes.normal!==void 0&&(wt=2),je.morphAttributes.color!==void 0&&(wt=3);let Vt,lt,Ht,Qt;if($e){const hi=Nf[$e];Vt=hi.vertexShader,lt=hi.fragmentShader}else Vt=se.vertexShader,lt=se.fragmentShader,o.update(se),Ht=o.getVertexShaderID(se),Qt=o.getFragmentShaderID(se);const rn=n.getRenderTarget(),jn=Ce.isInstancedMesh===!0,Bn=Ce.isBatchedMesh===!0,Tn=!!se.map,Pe=!!se.matcap,qe=!!ot,mn=!!se.aoMap,cn=!!se.lightMap,St=!!se.bumpMap,Jt=!!se.normalMap,kn=!!se.displacementMap,Gn=!!se.emissiveMap,sn=!!se.metalnessMap,at=!!se.roughnessMap,Ue=se.anisotropy>0,$t=se.clearcoat>0,An=se.dispersion>0,Sn=se.iridescence>0,jt=se.sheen>0,mr=se.transmission>0,Un=Ue&&!!se.anisotropyMap,tr=$t&&!!se.clearcoatMap,Sr=$t&&!!se.clearcoatNormalMap,Ln=$t&&!!se.clearcoatRoughnessMap,ir=Sn&&!!se.iridescenceMap,ui=Sn&&!!se.iridescenceThicknessMap,Fr=jt&&!!se.sheenColorMap,or=jt&&!!se.sheenRoughnessMap,Nr=!!se.specularMap,Hr=!!se.specularColorMap,yi=!!se.specularIntensityMap,Fe=mr&&!!se.transmissionMap,Lt=mr&&!!se.thicknessMap,Kt=!!se.gradientMap,un=!!se.alphaMap,En=se.alphaTest>0,Ar=!!se.alphaHash,Vr=!!se.extensions;let hs=ap;se.toneMapped&&(rn===null||rn.isXRRenderTarget===!0)&&(hs=n.toneMapping);const Ps={shaderID:$e,shaderType:se.type,shaderName:se.name,vertexShader:Vt,fragmentShader:lt,defines:se.defines,customVertexShaderID:Ht,customFragmentShaderID:Qt,isRawShaderMaterial:se.isRawShaderMaterial===!0,glslVersion:se.glslVersion,precision:y,batching:Bn,batchingColor:Bn&&Ce._colorsTexture!==null,instancing:jn,instancingColor:jn&&Ce.instanceColor!==null,instancingMorph:jn&&Ce.morphTexture!==null,supportsVertexTextures:v,outputColorSpace:rn===null?n.outputColorSpace:rn.isXRRenderTarget===!0?rn.texture.colorSpace:Ha,alphaToCoverage:!!se.alphaToCoverage,map:Tn,matcap:Pe,envMap:qe,envMapMode:qe&&ot.mapping,envMapCubeUVHeight:ye,aoMap:mn,lightMap:cn,bumpMap:St,normalMap:Jt,displacementMap:v&&kn,emissiveMap:Gn,normalMapObjectSpace:Jt&&se.normalMapType===Rte,normalMapTangentSpace:Jt&&se.normalMapType===Ev,metalnessMap:sn,roughnessMap:at,anisotropy:Ue,anisotropyMap:Un,clearcoat:$t,clearcoatMap:tr,clearcoatNormalMap:Sr,clearcoatRoughnessMap:Ln,dispersion:An,iridescence:Sn,iridescenceMap:ir,iridescenceThicknessMap:ui,sheen:jt,sheenColorMap:Fr,sheenRoughnessMap:or,specularMap:Nr,specularColorMap:Hr,specularIntensityMap:yi,transmission:mr,transmissionMap:Fe,thicknessMap:Lt,gradientMap:Kt,opaque:se.transparent===!1&&se.blending===Ly&&se.alphaToCoverage===!1,alphaMap:un,alphaTest:En,alphaHash:Ar,combine:se.combine,mapUv:Tn&&E(se.map.channel),aoMapUv:mn&&E(se.aoMap.channel),lightMapUv:cn&&E(se.lightMap.channel),bumpMapUv:St&&E(se.bumpMap.channel),normalMapUv:Jt&&E(se.normalMap.channel),displacementMapUv:kn&&E(se.displacementMap.channel),emissiveMapUv:Gn&&E(se.emissiveMap.channel),metalnessMapUv:sn&&E(se.metalnessMap.channel),roughnessMapUv:at&&E(se.roughnessMap.channel),anisotropyMapUv:Un&&E(se.anisotropyMap.channel),clearcoatMapUv:tr&&E(se.clearcoatMap.channel),clearcoatNormalMapUv:Sr&&E(se.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ln&&E(se.clearcoatRoughnessMap.channel),iridescenceMapUv:ir&&E(se.iridescenceMap.channel),iridescenceThicknessMapUv:ui&&E(se.iridescenceThicknessMap.channel),sheenColorMapUv:Fr&&E(se.sheenColorMap.channel),sheenRoughnessMapUv:or&&E(se.sheenRoughnessMap.channel),specularMapUv:Nr&&E(se.specularMap.channel),specularColorMapUv:Hr&&E(se.specularColorMap.channel),specularIntensityMapUv:yi&&E(se.specularIntensityMap.channel),transmissionMapUv:Fe&&E(se.transmissionMap.channel),thicknessMapUv:Lt&&E(se.thicknessMap.channel),alphaMapUv:un&&E(se.alphaMap.channel),vertexTangents:!!je.attributes.tangent&&(Jt||Ue),vertexColors:se.vertexColors,vertexAlphas:se.vertexColors===!0&&!!je.attributes.color&&je.attributes.color.itemSize===4,pointsUvs:Ce.isPoints===!0&&!!je.attributes.uv&&(Tn||un),fog:!!Ie,useFog:se.fog===!0,fogExp2:!!Ie&&Ie.isFogExp2,flatShading:se.flatShading===!0,sizeAttenuation:se.sizeAttenuation===!0,logarithmicDepthBuffer:m,skinning:Ce.isSkinnedMesh===!0,morphTargets:je.morphAttributes.position!==void 0,morphNormals:je.morphAttributes.normal!==void 0,morphColors:je.morphAttributes.color!==void 0,morphTargetsCount:_t,morphTextureStride:wt,numDirLights:ae.directional.length,numPointLights:ae.point.length,numSpotLights:ae.spot.length,numSpotLightMaps:ae.spotLightMap.length,numRectAreaLights:ae.rectArea.length,numHemiLights:ae.hemi.length,numDirLightShadows:ae.directionalShadowMap.length,numPointLightShadows:ae.pointShadowMap.length,numSpotLightShadows:ae.spotShadowMap.length,numSpotLightShadowsWithMaps:ae.numSpotLightShadowsWithMaps,numLightProbes:ae.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:se.dithering,shadowMapEnabled:n.shadowMap.enabled&&fe.length>0,shadowMapType:n.shadowMap.type,toneMapping:hs,decodeVideoTexture:Tn&&se.map.isVideoTexture===!0&&ms.getTransfer(se.map.colorSpace)===to,premultipliedAlpha:se.premultipliedAlpha,doubleSided:se.side===wc,flipSided:se.side===Cc,useDepthPacking:se.depthPacking>=0,depthPacking:se.depthPacking||0,index0AttributeName:se.index0AttributeName,extensionClipCullDistance:Vr&&se.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Vr&&se.extensions.multiDraw===!0||Bn)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:se.customProgramCacheKey()};return Ps.vertexUv1s=h.has(1),Ps.vertexUv2s=h.has(2),Ps.vertexUv3s=h.has(3),h.clear(),Ps}function C(se){const ae=[];if(se.shaderID?ae.push(se.shaderID):(ae.push(se.customVertexShaderID),ae.push(se.customFragmentShaderID)),se.defines!==void 0)for(const fe in se.defines)ae.push(fe),ae.push(se.defines[fe]);return se.isRawShaderMaterial===!1&&(L(ae,se),k(ae,se),ae.push(n.outputColorSpace)),ae.push(se.customProgramCacheKey),ae.join()}function L(se,ae){se.push(ae.precision),se.push(ae.outputColorSpace),se.push(ae.envMapMode),se.push(ae.envMapCubeUVHeight),se.push(ae.mapUv),se.push(ae.alphaMapUv),se.push(ae.lightMapUv),se.push(ae.aoMapUv),se.push(ae.bumpMapUv),se.push(ae.normalMapUv),se.push(ae.displacementMapUv),se.push(ae.emissiveMapUv),se.push(ae.metalnessMapUv),se.push(ae.roughnessMapUv),se.push(ae.anisotropyMapUv),se.push(ae.clearcoatMapUv),se.push(ae.clearcoatNormalMapUv),se.push(ae.clearcoatRoughnessMapUv),se.push(ae.iridescenceMapUv),se.push(ae.iridescenceThicknessMapUv),se.push(ae.sheenColorMapUv),se.push(ae.sheenRoughnessMapUv),se.push(ae.specularMapUv),se.push(ae.specularColorMapUv),se.push(ae.specularIntensityMapUv),se.push(ae.transmissionMapUv),se.push(ae.thicknessMapUv),se.push(ae.combine),se.push(ae.fogExp2),se.push(ae.sizeAttenuation),se.push(ae.morphTargetsCount),se.push(ae.morphAttributeCount),se.push(ae.numDirLights),se.push(ae.numPointLights),se.push(ae.numSpotLights),se.push(ae.numSpotLightMaps),se.push(ae.numHemiLights),se.push(ae.numRectAreaLights),se.push(ae.numDirLightShadows),se.push(ae.numPointLightShadows),se.push(ae.numSpotLightShadows),se.push(ae.numSpotLightShadowsWithMaps),se.push(ae.numLightProbes),se.push(ae.shadowMapType),se.push(ae.toneMapping),se.push(ae.numClippingPlanes),se.push(ae.numClipIntersection),se.push(ae.depthPacking)}function k(se,ae){l.disableAll(),ae.supportsVertexTextures&&l.enable(0),ae.instancing&&l.enable(1),ae.instancingColor&&l.enable(2),ae.instancingMorph&&l.enable(3),ae.matcap&&l.enable(4),ae.envMap&&l.enable(5),ae.normalMapObjectSpace&&l.enable(6),ae.normalMapTangentSpace&&l.enable(7),ae.clearcoat&&l.enable(8),ae.iridescence&&l.enable(9),ae.alphaTest&&l.enable(10),ae.vertexColors&&l.enable(11),ae.vertexAlphas&&l.enable(12),ae.vertexUv1s&&l.enable(13),ae.vertexUv2s&&l.enable(14),ae.vertexUv3s&&l.enable(15),ae.vertexTangents&&l.enable(16),ae.anisotropy&&l.enable(17),ae.alphaHash&&l.enable(18),ae.batching&&l.enable(19),ae.dispersion&&l.enable(20),ae.batchingColor&&l.enable(21),se.push(l.mask),l.disableAll(),ae.fog&&l.enable(0),ae.useFog&&l.enable(1),ae.flatShading&&l.enable(2),ae.logarithmicDepthBuffer&&l.enable(3),ae.skinning&&l.enable(4),ae.morphTargets&&l.enable(5),ae.morphNormals&&l.enable(6),ae.morphColors&&l.enable(7),ae.premultipliedAlpha&&l.enable(8),ae.shadowMapEnabled&&l.enable(9),ae.doubleSided&&l.enable(10),ae.flipSided&&l.enable(11),ae.useDepthPacking&&l.enable(12),ae.dithering&&l.enable(13),ae.transmission&&l.enable(14),ae.sheen&&l.enable(15),ae.opaque&&l.enable(16),ae.pointsUvs&&l.enable(17),ae.decodeVideoTexture&&l.enable(18),ae.alphaToCoverage&&l.enable(19),se.push(l.mask)}function H(se){const ae=S[se.type];let fe;if(ae){const Se=Nf[ae];fe=Wm.clone(Se.uniforms)}else fe=se.uniforms;return fe}function q(se,ae){let fe;for(let Se=0,Ce=d.length;Se<Ce;Se++){const Ie=d[Se];if(Ie.cacheKey===ae){fe=Ie,++fe.usedTimes;break}}return fe===void 0&&(fe=new sxe(n,ae,se,s),d.push(fe)),fe}function Z(se){if(--se.usedTimes===0){const ae=d.indexOf(se);d[ae]=d[d.length-1],d.pop(),se.destroy()}}function ee(se){o.remove(se)}function re(){o.dispose()}return{getParameters:M,getProgramCacheKey:C,getUniforms:H,acquireProgram:q,releaseProgram:Z,releaseShaderCache:ee,programs:d,dispose:re}}function uxe(){let n=new WeakMap;function e(s){let a=n.get(s);return a===void 0&&(a={},n.set(s,a)),a}function t(s){n.delete(s)}function r(s,a,l){n.get(s)[a]=l}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function hxe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Yj(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Kj(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(m,v,y,S,E,M){let C=n[e];return C===void 0?(C={id:m.id,object:m,geometry:v,material:y,groupOrder:S,renderOrder:m.renderOrder,z:E,group:M},n[e]=C):(C.id=m.id,C.object=m,C.geometry=v,C.material=y,C.groupOrder=S,C.renderOrder=m.renderOrder,C.z=E,C.group=M),e++,C}function l(m,v,y,S,E,M){const C=a(m,v,y,S,E,M);y.transmission>0?r.push(C):y.transparent===!0?i.push(C):t.push(C)}function o(m,v,y,S,E,M){const C=a(m,v,y,S,E,M);y.transmission>0?r.unshift(C):y.transparent===!0?i.unshift(C):t.unshift(C)}function h(m,v){t.length>1&&t.sort(m||hxe),r.length>1&&r.sort(v||Yj),i.length>1&&i.sort(v||Yj)}function d(){for(let m=e,v=n.length;m<v;m++){const y=n[m];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:l,unshift:o,finish:d,sort:h}}function fxe(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new Kj,n.set(r,[a])):i>=s.length?(a=new Kj,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function dxe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ze,color:new Vn};break;case"SpotLight":t={position:new Ze,direction:new Ze,color:new Vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ze,color:new Vn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ze,skyColor:new Vn,groundColor:new Vn};break;case"RectAreaLight":t={color:new Vn,position:new Ze,halfWidth:new Ze,halfHeight:new Ze};break}return n[e.id]=t,t}}}function pxe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let mxe=0;function gxe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function vxe(n){const e=new dxe,t=pxe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)r.probe.push(new Ze);const i=new Ze,s=new Gr,a=new Gr;function l(h){let d=0,m=0,v=0;for(let se=0;se<9;se++)r.probe[se].set(0,0,0);let y=0,S=0,E=0,M=0,C=0,L=0,k=0,H=0,q=0,Z=0,ee=0;h.sort(gxe);for(let se=0,ae=h.length;se<ae;se++){const fe=h[se],Se=fe.color,Ce=fe.intensity,Ie=fe.distance,je=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)d+=Se.r*Ce,m+=Se.g*Ce,v+=Se.b*Ce;else if(fe.isLightProbe){for(let Le=0;Le<9;Le++)r.probe[Le].addScaledVector(fe.sh.coefficients[Le],Ce);ee++}else if(fe.isDirectionalLight){const Le=e.get(fe);if(Le.color.copy(fe.color).multiplyScalar(fe.intensity),fe.castShadow){const ot=fe.shadow,ye=t.get(fe);ye.shadowIntensity=ot.intensity,ye.shadowBias=ot.bias,ye.shadowNormalBias=ot.normalBias,ye.shadowRadius=ot.radius,ye.shadowMapSize=ot.mapSize,r.directionalShadow[y]=ye,r.directionalShadowMap[y]=je,r.directionalShadowMatrix[y]=fe.shadow.matrix,L++}r.directional[y]=Le,y++}else if(fe.isSpotLight){const Le=e.get(fe);Le.position.setFromMatrixPosition(fe.matrixWorld),Le.color.copy(Se).multiplyScalar(Ce),Le.distance=Ie,Le.coneCos=Math.cos(fe.angle),Le.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),Le.decay=fe.decay,r.spot[E]=Le;const ot=fe.shadow;if(fe.map&&(r.spotLightMap[q]=fe.map,q++,ot.updateMatrices(fe),fe.castShadow&&Z++),r.spotLightMatrix[E]=ot.matrix,fe.castShadow){const ye=t.get(fe);ye.shadowIntensity=ot.intensity,ye.shadowBias=ot.bias,ye.shadowNormalBias=ot.normalBias,ye.shadowRadius=ot.radius,ye.shadowMapSize=ot.mapSize,r.spotShadow[E]=ye,r.spotShadowMap[E]=je,H++}E++}else if(fe.isRectAreaLight){const Le=e.get(fe);Le.color.copy(Se).multiplyScalar(Ce),Le.halfWidth.set(fe.width*.5,0,0),Le.halfHeight.set(0,fe.height*.5,0),r.rectArea[M]=Le,M++}else if(fe.isPointLight){const Le=e.get(fe);if(Le.color.copy(fe.color).multiplyScalar(fe.intensity),Le.distance=fe.distance,Le.decay=fe.decay,fe.castShadow){const ot=fe.shadow,ye=t.get(fe);ye.shadowIntensity=ot.intensity,ye.shadowBias=ot.bias,ye.shadowNormalBias=ot.normalBias,ye.shadowRadius=ot.radius,ye.shadowMapSize=ot.mapSize,ye.shadowCameraNear=ot.camera.near,ye.shadowCameraFar=ot.camera.far,r.pointShadow[S]=ye,r.pointShadowMap[S]=je,r.pointShadowMatrix[S]=fe.shadow.matrix,k++}r.point[S]=Le,S++}else if(fe.isHemisphereLight){const Le=e.get(fe);Le.skyColor.copy(fe.color).multiplyScalar(Ce),Le.groundColor.copy(fe.groundColor).multiplyScalar(Ce),r.hemi[C]=Le,C++}}M>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=hr.LTC_FLOAT_1,r.rectAreaLTC2=hr.LTC_FLOAT_2):(r.rectAreaLTC1=hr.LTC_HALF_1,r.rectAreaLTC2=hr.LTC_HALF_2)),r.ambient[0]=d,r.ambient[1]=m,r.ambient[2]=v;const re=r.hash;(re.directionalLength!==y||re.pointLength!==S||re.spotLength!==E||re.rectAreaLength!==M||re.hemiLength!==C||re.numDirectionalShadows!==L||re.numPointShadows!==k||re.numSpotShadows!==H||re.numSpotMaps!==q||re.numLightProbes!==ee)&&(r.directional.length=y,r.spot.length=E,r.rectArea.length=M,r.point.length=S,r.hemi.length=C,r.directionalShadow.length=L,r.directionalShadowMap.length=L,r.pointShadow.length=k,r.pointShadowMap.length=k,r.spotShadow.length=H,r.spotShadowMap.length=H,r.directionalShadowMatrix.length=L,r.pointShadowMatrix.length=k,r.spotLightMatrix.length=H+q-Z,r.spotLightMap.length=q,r.numSpotLightShadowsWithMaps=Z,r.numLightProbes=ee,re.directionalLength=y,re.pointLength=S,re.spotLength=E,re.rectAreaLength=M,re.hemiLength=C,re.numDirectionalShadows=L,re.numPointShadows=k,re.numSpotShadows=H,re.numSpotMaps=q,re.numLightProbes=ee,r.version=mxe++)}function o(h,d){let m=0,v=0,y=0,S=0,E=0;const M=d.matrixWorldInverse;for(let C=0,L=h.length;C<L;C++){const k=h[C];if(k.isDirectionalLight){const H=r.directional[m];H.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(M),m++}else if(k.isSpotLight){const H=r.spot[y];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),H.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(M),y++}else if(k.isRectAreaLight){const H=r.rectArea[S];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),a.identity(),s.copy(k.matrixWorld),s.premultiply(M),a.extractRotation(s),H.halfWidth.set(k.width*.5,0,0),H.halfHeight.set(0,k.height*.5,0),H.halfWidth.applyMatrix4(a),H.halfHeight.applyMatrix4(a),S++}else if(k.isPointLight){const H=r.point[v];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),v++}else if(k.isHemisphereLight){const H=r.hemi[E];H.direction.setFromMatrixPosition(k.matrixWorld),H.direction.transformDirection(M),E++}}}return{setup:l,setupView:o,state:r}}function Jj(n){const e=new vxe(n),t=[],r=[];function i(d){h.camera=d,t.length=0,r.length=0}function s(d){t.push(d)}function a(d){r.push(d)}function l(){e.setup(t)}function o(d){e.setupView(t,d)}const h={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:h,setupLights:l,setupLightsView:o,pushLight:s,pushShadow:a}}function _xe(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let l;return a===void 0?(l=new Jj(n),e.set(i,[l])):s>=a.length?(l=new Jj(n),a.push(l)):l=a[s],l}function r(){e=new WeakMap}return{get:t,dispose:r}}class X6 extends yo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Ete,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class $6 extends yo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const yxe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,xxe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function bxe(n,e,t){let r=new jT;const i=new nn,s=new nn,a=new Is,l=new X6({depthPacking:Ite}),o=new $6,h={},d=t.maxTextureSize,m={[Dh]:Cc,[Cc]:Dh,[wc]:wc},v=new Io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new nn},radius:{value:4}},vertexShader:yxe,fragmentShader:xxe}),y=v.clone();y.defines.HORIZONTAL_PASS=1;const S=new $r;S.setAttribute("position",new Bi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new Ii(S,v),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=HL;let C=this.type;this.render=function(Z,ee,re){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||Z.length===0)return;const se=n.getRenderTarget(),ae=n.getActiveCubeFace(),fe=n.getActiveMipmapLevel(),Se=n.state;Se.setBlending(op),Se.buffers.color.setClear(1,1,1,1),Se.buffers.depth.setTest(!0),Se.setScissorTest(!1);const Ce=C!==Bf&&this.type===Bf,Ie=C===Bf&&this.type!==Bf;for(let je=0,Le=Z.length;je<Le;je++){const ot=Z[je],ye=ot.shadow;if(ye===void 0){console.warn("THREE.WebGLShadowMap:",ot,"has no shadow.");continue}if(ye.autoUpdate===!1&&ye.needsUpdate===!1)continue;i.copy(ye.mapSize);const $e=ye.getFrameExtents();if(i.multiply($e),s.copy(ye.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/$e.x),i.x=s.x*$e.x,ye.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/$e.y),i.y=s.y*$e.y,ye.mapSize.y=s.y)),ye.map===null||Ce===!0||Ie===!0){const _t=this.type!==Bf?{minFilter:Sa,magFilter:Sa}:{};ye.map!==null&&ye.map.dispose(),ye.map=new wl(i.x,i.y,_t),ye.map.texture.name=ot.name+".shadowMap",ye.camera.updateProjectionMatrix()}n.setRenderTarget(ye.map),n.clear();const Ve=ye.getViewportCount();for(let _t=0;_t<Ve;_t++){const wt=ye.getViewport(_t);a.set(s.x*wt.x,s.y*wt.y,s.x*wt.z,s.y*wt.w),Se.viewport(a),ye.updateMatrices(ot,_t),r=ye.getFrustum(),H(ee,re,ye.camera,ot,this.type)}ye.isPointLightShadow!==!0&&this.type===Bf&&L(ye,re),ye.needsUpdate=!1}C=this.type,M.needsUpdate=!1,n.setRenderTarget(se,ae,fe)};function L(Z,ee){const re=e.update(E);v.defines.VSM_SAMPLES!==Z.blurSamples&&(v.defines.VSM_SAMPLES=Z.blurSamples,y.defines.VSM_SAMPLES=Z.blurSamples,v.needsUpdate=!0,y.needsUpdate=!0),Z.mapPass===null&&(Z.mapPass=new wl(i.x,i.y)),v.uniforms.shadow_pass.value=Z.map.texture,v.uniforms.resolution.value=Z.mapSize,v.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.mapPass),n.clear(),n.renderBufferDirect(ee,null,re,v,E,null),y.uniforms.shadow_pass.value=Z.mapPass.texture,y.uniforms.resolution.value=Z.mapSize,y.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.map),n.clear(),n.renderBufferDirect(ee,null,re,y,E,null)}function k(Z,ee,re,se){let ae=null;const fe=re.isPointLight===!0?Z.customDistanceMaterial:Z.customDepthMaterial;if(fe!==void 0)ae=fe;else if(ae=re.isPointLight===!0?o:l,n.localClippingEnabled&&ee.clipShadows===!0&&Array.isArray(ee.clippingPlanes)&&ee.clippingPlanes.length!==0||ee.displacementMap&&ee.displacementScale!==0||ee.alphaMap&&ee.alphaTest>0||ee.map&&ee.alphaTest>0){const Se=ae.uuid,Ce=ee.uuid;let Ie=h[Se];Ie===void 0&&(Ie={},h[Se]=Ie);let je=Ie[Ce];je===void 0&&(je=ae.clone(),Ie[Ce]=je,ee.addEventListener("dispose",q)),ae=je}if(ae.visible=ee.visible,ae.wireframe=ee.wireframe,se===Bf?ae.side=ee.shadowSide!==null?ee.shadowSide:ee.side:ae.side=ee.shadowSide!==null?ee.shadowSide:m[ee.side],ae.alphaMap=ee.alphaMap,ae.alphaTest=ee.alphaTest,ae.map=ee.map,ae.clipShadows=ee.clipShadows,ae.clippingPlanes=ee.clippingPlanes,ae.clipIntersection=ee.clipIntersection,ae.displacementMap=ee.displacementMap,ae.displacementScale=ee.displacementScale,ae.displacementBias=ee.displacementBias,ae.wireframeLinewidth=ee.wireframeLinewidth,ae.linewidth=ee.linewidth,re.isPointLight===!0&&ae.isMeshDistanceMaterial===!0){const Se=n.properties.get(ae);Se.light=re}return ae}function H(Z,ee,re,se,ae){if(Z.visible===!1)return;if(Z.layers.test(ee.layers)&&(Z.isMesh||Z.isLine||Z.isPoints)&&(Z.castShadow||Z.receiveShadow&&ae===Bf)&&(!Z.frustumCulled||r.intersectsObject(Z))){Z.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,Z.matrixWorld);const Ce=e.update(Z),Ie=Z.material;if(Array.isArray(Ie)){const je=Ce.groups;for(let Le=0,ot=je.length;Le<ot;Le++){const ye=je[Le],$e=Ie[ye.materialIndex];if($e&&$e.visible){const Ve=k(Z,$e,se,ae);Z.onBeforeShadow(n,Z,ee,re,Ce,Ve,ye),n.renderBufferDirect(re,null,Ce,Ve,Z,ye),Z.onAfterShadow(n,Z,ee,re,Ce,Ve,ye)}}}else if(Ie.visible){const je=k(Z,Ie,se,ae);Z.onBeforeShadow(n,Z,ee,re,Ce,je,null),n.renderBufferDirect(re,null,Ce,je,Z,null),Z.onAfterShadow(n,Z,ee,re,Ce,je,null)}}const Se=Z.children;for(let Ce=0,Ie=Se.length;Ce<Ie;Ce++)H(Se[Ce],ee,re,se,ae)}function q(Z){Z.target.removeEventListener("dispose",q);for(const re in h){const se=h[re],ae=Z.target.uuid;ae in se&&(se[ae].dispose(),delete se[ae])}}}function wxe(n){function e(){let Fe=!1;const Lt=new Is;let Kt=null;const un=new Is(0,0,0,0);return{setMask:function(En){Kt!==En&&!Fe&&(n.colorMask(En,En,En,En),Kt=En)},setLocked:function(En){Fe=En},setClear:function(En,Ar,Vr,hs,Ps){Ps===!0&&(En*=hs,Ar*=hs,Vr*=hs),Lt.set(En,Ar,Vr,hs),un.equals(Lt)===!1&&(n.clearColor(En,Ar,Vr,hs),un.copy(Lt))},reset:function(){Fe=!1,Kt=null,un.set(-1,0,0,0)}}}function t(){let Fe=!1,Lt=null,Kt=null,un=null;return{setTest:function(En){En?Qt(n.DEPTH_TEST):rn(n.DEPTH_TEST)},setMask:function(En){Lt!==En&&!Fe&&(n.depthMask(En),Lt=En)},setFunc:function(En){if(Kt!==En){switch(En){case ute:n.depthFunc(n.NEVER);break;case hte:n.depthFunc(n.ALWAYS);break;case fte:n.depthFunc(n.LESS);break;case GA:n.depthFunc(n.LEQUAL);break;case dte:n.depthFunc(n.EQUAL);break;case pte:n.depthFunc(n.GEQUAL);break;case mte:n.depthFunc(n.GREATER);break;case gte:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Kt=En}},setLocked:function(En){Fe=En},setClear:function(En){un!==En&&(n.clearDepth(En),un=En)},reset:function(){Fe=!1,Lt=null,Kt=null,un=null}}}function r(){let Fe=!1,Lt=null,Kt=null,un=null,En=null,Ar=null,Vr=null,hs=null,Ps=null;return{setTest:function(hi){Fe||(hi?Qt(n.STENCIL_TEST):rn(n.STENCIL_TEST))},setMask:function(hi){Lt!==hi&&!Fe&&(n.stencilMask(hi),Lt=hi)},setFunc:function(hi,Tt,xe){(Kt!==hi||un!==Tt||En!==xe)&&(n.stencilFunc(hi,Tt,xe),Kt=hi,un=Tt,En=xe)},setOp:function(hi,Tt,xe){(Ar!==hi||Vr!==Tt||hs!==xe)&&(n.stencilOp(hi,Tt,xe),Ar=hi,Vr=Tt,hs=xe)},setLocked:function(hi){Fe=hi},setClear:function(hi){Ps!==hi&&(n.clearStencil(hi),Ps=hi)},reset:function(){Fe=!1,Lt=null,Kt=null,un=null,En=null,Ar=null,Vr=null,hs=null,Ps=null}}}const i=new e,s=new t,a=new r,l=new WeakMap,o=new WeakMap;let h={},d={},m=new WeakMap,v=[],y=null,S=!1,E=null,M=null,C=null,L=null,k=null,H=null,q=null,Z=new Vn(0,0,0),ee=0,re=!1,se=null,ae=null,fe=null,Se=null,Ce=null;const Ie=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let je=!1,Le=0;const ot=n.getParameter(n.VERSION);ot.indexOf("WebGL")!==-1?(Le=parseFloat(/^WebGL (\d)/.exec(ot)[1]),je=Le>=1):ot.indexOf("OpenGL ES")!==-1&&(Le=parseFloat(/^OpenGL ES (\d)/.exec(ot)[1]),je=Le>=2);let ye=null,$e={};const Ve=n.getParameter(n.SCISSOR_BOX),_t=n.getParameter(n.VIEWPORT),wt=new Is().fromArray(Ve),Vt=new Is().fromArray(_t);function lt(Fe,Lt,Kt,un){const En=new Uint8Array(4),Ar=n.createTexture();n.bindTexture(Fe,Ar),n.texParameteri(Fe,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Fe,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Vr=0;Vr<Kt;Vr++)Fe===n.TEXTURE_3D||Fe===n.TEXTURE_2D_ARRAY?n.texImage3D(Lt,0,n.RGBA,1,1,un,0,n.RGBA,n.UNSIGNED_BYTE,En):n.texImage2D(Lt+Vr,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,En);return Ar}const Ht={};Ht[n.TEXTURE_2D]=lt(n.TEXTURE_2D,n.TEXTURE_2D,1),Ht[n.TEXTURE_CUBE_MAP]=lt(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ht[n.TEXTURE_2D_ARRAY]=lt(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ht[n.TEXTURE_3D]=lt(n.TEXTURE_3D,n.TEXTURE_3D,1,1),i.setClear(0,0,0,1),s.setClear(1),a.setClear(0),Qt(n.DEPTH_TEST),s.setFunc(GA),St(!1),Jt(pF),Qt(n.CULL_FACE),mn(op);function Qt(Fe){h[Fe]!==!0&&(n.enable(Fe),h[Fe]=!0)}function rn(Fe){h[Fe]!==!1&&(n.disable(Fe),h[Fe]=!1)}function jn(Fe,Lt){return d[Fe]!==Lt?(n.bindFramebuffer(Fe,Lt),d[Fe]=Lt,Fe===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=Lt),Fe===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=Lt),!0):!1}function Bn(Fe,Lt){let Kt=v,un=!1;if(Fe){Kt=m.get(Lt),Kt===void 0&&(Kt=[],m.set(Lt,Kt));const En=Fe.textures;if(Kt.length!==En.length||Kt[0]!==n.COLOR_ATTACHMENT0){for(let Ar=0,Vr=En.length;Ar<Vr;Ar++)Kt[Ar]=n.COLOR_ATTACHMENT0+Ar;Kt.length=En.length,un=!0}}else Kt[0]!==n.BACK&&(Kt[0]=n.BACK,un=!0);un&&n.drawBuffers(Kt)}function Tn(Fe){return y!==Fe?(n.useProgram(Fe),y=Fe,!0):!1}const Pe={[O0]:n.FUNC_ADD,[$ee]:n.FUNC_SUBTRACT,[qee]:n.FUNC_REVERSE_SUBTRACT};Pe[Zee]=n.MIN,Pe[Yee]=n.MAX;const qe={[Kee]:n.ZERO,[Jee]:n.ONE,[Qee]:n.SRC_COLOR,[GR]:n.SRC_ALPHA,[ste]:n.SRC_ALPHA_SATURATE,[rte]:n.DST_COLOR,[tte]:n.DST_ALPHA,[ete]:n.ONE_MINUS_SRC_COLOR,[VR]:n.ONE_MINUS_SRC_ALPHA,[ite]:n.ONE_MINUS_DST_COLOR,[nte]:n.ONE_MINUS_DST_ALPHA,[ote]:n.CONSTANT_COLOR,[ate]:n.ONE_MINUS_CONSTANT_COLOR,[lte]:n.CONSTANT_ALPHA,[cte]:n.ONE_MINUS_CONSTANT_ALPHA};function mn(Fe,Lt,Kt,un,En,Ar,Vr,hs,Ps,hi){if(Fe===op){S===!0&&(rn(n.BLEND),S=!1);return}if(S===!1&&(Qt(n.BLEND),S=!0),Fe!==Xee){if(Fe!==E||hi!==re){if((M!==O0||k!==O0)&&(n.blendEquation(n.FUNC_ADD),M=O0,k=O0),hi)switch(Fe){case Ly:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Kb:n.blendFunc(n.ONE,n.ONE);break;case mF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case gF:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Fe);break}else switch(Fe){case Ly:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Kb:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case mF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case gF:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Fe);break}C=null,L=null,H=null,q=null,Z.set(0,0,0),ee=0,E=Fe,re=hi}return}En=En||Lt,Ar=Ar||Kt,Vr=Vr||un,(Lt!==M||En!==k)&&(n.blendEquationSeparate(Pe[Lt],Pe[En]),M=Lt,k=En),(Kt!==C||un!==L||Ar!==H||Vr!==q)&&(n.blendFuncSeparate(qe[Kt],qe[un],qe[Ar],qe[Vr]),C=Kt,L=un,H=Ar,q=Vr),(hs.equals(Z)===!1||Ps!==ee)&&(n.blendColor(hs.r,hs.g,hs.b,Ps),Z.copy(hs),ee=Ps),E=Fe,re=!1}function cn(Fe,Lt){Fe.side===wc?rn(n.CULL_FACE):Qt(n.CULL_FACE);let Kt=Fe.side===Cc;Lt&&(Kt=!Kt),St(Kt),Fe.blending===Ly&&Fe.transparent===!1?mn(op):mn(Fe.blending,Fe.blendEquation,Fe.blendSrc,Fe.blendDst,Fe.blendEquationAlpha,Fe.blendSrcAlpha,Fe.blendDstAlpha,Fe.blendColor,Fe.blendAlpha,Fe.premultipliedAlpha),s.setFunc(Fe.depthFunc),s.setTest(Fe.depthTest),s.setMask(Fe.depthWrite),i.setMask(Fe.colorWrite);const un=Fe.stencilWrite;a.setTest(un),un&&(a.setMask(Fe.stencilWriteMask),a.setFunc(Fe.stencilFunc,Fe.stencilRef,Fe.stencilFuncMask),a.setOp(Fe.stencilFail,Fe.stencilZFail,Fe.stencilZPass)),Gn(Fe.polygonOffset,Fe.polygonOffsetFactor,Fe.polygonOffsetUnits),Fe.alphaToCoverage===!0?Qt(n.SAMPLE_ALPHA_TO_COVERAGE):rn(n.SAMPLE_ALPHA_TO_COVERAGE)}function St(Fe){se!==Fe&&(Fe?n.frontFace(n.CW):n.frontFace(n.CCW),se=Fe)}function Jt(Fe){Fe!==Hee?(Qt(n.CULL_FACE),Fe!==ae&&(Fe===pF?n.cullFace(n.BACK):Fe===jee?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):rn(n.CULL_FACE),ae=Fe}function kn(Fe){Fe!==fe&&(je&&n.lineWidth(Fe),fe=Fe)}function Gn(Fe,Lt,Kt){Fe?(Qt(n.POLYGON_OFFSET_FILL),(Se!==Lt||Ce!==Kt)&&(n.polygonOffset(Lt,Kt),Se=Lt,Ce=Kt)):rn(n.POLYGON_OFFSET_FILL)}function sn(Fe){Fe?Qt(n.SCISSOR_TEST):rn(n.SCISSOR_TEST)}function at(Fe){Fe===void 0&&(Fe=n.TEXTURE0+Ie-1),ye!==Fe&&(n.activeTexture(Fe),ye=Fe)}function Ue(Fe,Lt,Kt){Kt===void 0&&(ye===null?Kt=n.TEXTURE0+Ie-1:Kt=ye);let un=$e[Kt];un===void 0&&(un={type:void 0,texture:void 0},$e[Kt]=un),(un.type!==Fe||un.texture!==Lt)&&(ye!==Kt&&(n.activeTexture(Kt),ye=Kt),n.bindTexture(Fe,Lt||Ht[Fe]),un.type=Fe,un.texture=Lt)}function $t(){const Fe=$e[ye];Fe!==void 0&&Fe.type!==void 0&&(n.bindTexture(Fe.type,null),Fe.type=void 0,Fe.texture=void 0)}function An(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Sn(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function jt(){try{n.texSubImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function mr(){try{n.texSubImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Un(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function tr(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Sr(){try{n.texStorage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Ln(){try{n.texStorage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function ir(){try{n.texImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function ui(){try{n.texImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Fr(Fe){wt.equals(Fe)===!1&&(n.scissor(Fe.x,Fe.y,Fe.z,Fe.w),wt.copy(Fe))}function or(Fe){Vt.equals(Fe)===!1&&(n.viewport(Fe.x,Fe.y,Fe.z,Fe.w),Vt.copy(Fe))}function Nr(Fe,Lt){let Kt=o.get(Lt);Kt===void 0&&(Kt=new WeakMap,o.set(Lt,Kt));let un=Kt.get(Fe);un===void 0&&(un=n.getUniformBlockIndex(Lt,Fe.name),Kt.set(Fe,un))}function Hr(Fe,Lt){const un=o.get(Lt).get(Fe);l.get(Lt)!==un&&(n.uniformBlockBinding(Lt,un,Fe.__bindingPointIndex),l.set(Lt,un))}function yi(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},ye=null,$e={},d={},m=new WeakMap,v=[],y=null,S=!1,E=null,M=null,C=null,L=null,k=null,H=null,q=null,Z=new Vn(0,0,0),ee=0,re=!1,se=null,ae=null,fe=null,Se=null,Ce=null,wt.set(0,0,n.canvas.width,n.canvas.height),Vt.set(0,0,n.canvas.width,n.canvas.height),i.reset(),s.reset(),a.reset()}return{buffers:{color:i,depth:s,stencil:a},enable:Qt,disable:rn,bindFramebuffer:jn,drawBuffers:Bn,useProgram:Tn,setBlending:mn,setMaterial:cn,setFlipSided:St,setCullFace:Jt,setLineWidth:kn,setPolygonOffset:Gn,setScissorTest:sn,activeTexture:at,bindTexture:Ue,unbindTexture:$t,compressedTexImage2D:An,compressedTexImage3D:Sn,texImage2D:ir,texImage3D:ui,updateUBOMapping:Nr,uniformBlockBinding:Hr,texStorage2D:Sr,texStorage3D:Ln,texSubImage2D:jt,texSubImage3D:mr,compressedTexSubImage2D:Un,compressedTexSubImage3D:tr,scissor:Fr,viewport:or,reset:yi}}function Sxe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function Axe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function Txe(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function wF(n,e,t,r){const i=Mxe(r);switch(t){case R6:return n*e;case L6:return n*e;case D6:return n*e*2;case NT:return n*e/i.components*i.byteLength;case zT:return n*e/i.components*i.byteLength;case B6:return n*e*2/i.components*i.byteLength;case YL:return n*e*2/i.components*i.byteLength;case P6:return n*e*3/i.components*i.byteLength;case Wl:return n*e*4/i.components*i.byteLength;case KL:return n*e*4/i.components*i.byteLength;case jS:case WS:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case XS:case $S:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case jR:case XR:return Math.max(n,16)*Math.max(e,8)/4;case HR:case WR:return Math.max(n,8)*Math.max(e,8)/2;case $R:case qR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case ZR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case YR:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case KR:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case JR:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case QR:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case eP:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case tP:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case nP:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case rP:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case iP:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case sP:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case oP:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case aP:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case lP:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case cP:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case qS:case uP:case hP:return Math.ceil(n/4)*Math.ceil(e/4)*16;case k6:case fP:return Math.ceil(n/4)*Math.ceil(e/4)*8;case dP:case pP:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Mxe(n){switch(n){case Zf:case C6:return{byteLength:1,components:1};case Jb:case E6:case Ch:return{byteLength:2,components:1};case qL:case ZL:return{byteLength:2,components:4};case jm:case $L:case Ac:return{byteLength:4,components:1};case I6:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}const Cxe={contain:Sxe,cover:Axe,fill:Txe,getByteLength:wF};function Exe(n,e,t,r,i,s,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,o=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new nn,d=new WeakMap;let m;const v=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(at,Ue){return y?new OffscreenCanvas(at,Ue):YA("canvas")}function E(at,Ue,$t){let An=1;const Sn=sn(at);if((Sn.width>$t||Sn.height>$t)&&(An=$t/Math.max(Sn.width,Sn.height)),An<1)if(typeof HTMLImageElement<"u"&&at instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&at instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&at instanceof ImageBitmap||typeof VideoFrame<"u"&&at instanceof VideoFrame){const jt=Math.floor(An*Sn.width),mr=Math.floor(An*Sn.height);m===void 0&&(m=S(jt,mr));const Un=Ue?S(jt,mr):m;return Un.width=jt,Un.height=mr,Un.getContext("2d").drawImage(at,0,0,jt,mr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Sn.width+"x"+Sn.height+") to ("+jt+"x"+mr+")."),Un}else return"data"in at&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Sn.width+"x"+Sn.height+")."),at;return at}function M(at){return at.generateMipmaps&&at.minFilter!==Sa&&at.minFilter!==Eo}function C(at){n.generateMipmap(at)}function L(at,Ue,$t,An,Sn=!1){if(at!==null){if(n[at]!==void 0)return n[at];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+at+"'")}let jt=Ue;if(Ue===n.RED&&($t===n.FLOAT&&(jt=n.R32F),$t===n.HALF_FLOAT&&(jt=n.R16F),$t===n.UNSIGNED_BYTE&&(jt=n.R8)),Ue===n.RED_INTEGER&&($t===n.UNSIGNED_BYTE&&(jt=n.R8UI),$t===n.UNSIGNED_SHORT&&(jt=n.R16UI),$t===n.UNSIGNED_INT&&(jt=n.R32UI),$t===n.BYTE&&(jt=n.R8I),$t===n.SHORT&&(jt=n.R16I),$t===n.INT&&(jt=n.R32I)),Ue===n.RG&&($t===n.FLOAT&&(jt=n.RG32F),$t===n.HALF_FLOAT&&(jt=n.RG16F),$t===n.UNSIGNED_BYTE&&(jt=n.RG8)),Ue===n.RG_INTEGER&&($t===n.UNSIGNED_BYTE&&(jt=n.RG8UI),$t===n.UNSIGNED_SHORT&&(jt=n.RG16UI),$t===n.UNSIGNED_INT&&(jt=n.RG32UI),$t===n.BYTE&&(jt=n.RG8I),$t===n.SHORT&&(jt=n.RG16I),$t===n.INT&&(jt=n.RG32I)),Ue===n.RGB&&$t===n.UNSIGNED_INT_5_9_9_9_REV&&(jt=n.RGB9_E5),Ue===n.RGBA){const mr=Sn?WA:ms.getTransfer(An);$t===n.FLOAT&&(jt=n.RGBA32F),$t===n.HALF_FLOAT&&(jt=n.RGBA16F),$t===n.UNSIGNED_BYTE&&(jt=mr===to?n.SRGB8_ALPHA8:n.RGBA8),$t===n.UNSIGNED_SHORT_4_4_4_4&&(jt=n.RGBA4),$t===n.UNSIGNED_SHORT_5_5_5_1&&(jt=n.RGB5_A1)}return(jt===n.R16F||jt===n.R32F||jt===n.RG16F||jt===n.RG32F||jt===n.RGBA16F||jt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),jt}function k(at,Ue){let $t;return at?Ue===null||Ue===jm||Ue===Yy?$t=n.DEPTH24_STENCIL8:Ue===Ac?$t=n.DEPTH32F_STENCIL8:Ue===Jb&&($t=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Ue===null||Ue===jm||Ue===Yy?$t=n.DEPTH_COMPONENT24:Ue===Ac?$t=n.DEPTH_COMPONENT32F:Ue===Jb&&($t=n.DEPTH_COMPONENT16),$t}function H(at,Ue){return M(at)===!0||at.isFramebufferTexture&&at.minFilter!==Sa&&at.minFilter!==Eo?Math.log2(Math.max(Ue.width,Ue.height))+1:at.mipmaps!==void 0&&at.mipmaps.length>0?at.mipmaps.length:at.isCompressedTexture&&Array.isArray(at.image)?Ue.mipmaps.length:1}function q(at){const Ue=at.target;Ue.removeEventListener("dispose",q),ee(Ue),Ue.isVideoTexture&&d.delete(Ue)}function Z(at){const Ue=at.target;Ue.removeEventListener("dispose",Z),se(Ue)}function ee(at){const Ue=r.get(at);if(Ue.__webglInit===void 0)return;const $t=at.source,An=v.get($t);if(An){const Sn=An[Ue.__cacheKey];Sn.usedTimes--,Sn.usedTimes===0&&re(at),Object.keys(An).length===0&&v.delete($t)}r.remove(at)}function re(at){const Ue=r.get(at);n.deleteTexture(Ue.__webglTexture);const $t=at.source,An=v.get($t);delete An[Ue.__cacheKey],a.memory.textures--}function se(at){const Ue=r.get(at);if(at.depthTexture&&at.depthTexture.dispose(),at.isWebGLCubeRenderTarget)for(let An=0;An<6;An++){if(Array.isArray(Ue.__webglFramebuffer[An]))for(let Sn=0;Sn<Ue.__webglFramebuffer[An].length;Sn++)n.deleteFramebuffer(Ue.__webglFramebuffer[An][Sn]);else n.deleteFramebuffer(Ue.__webglFramebuffer[An]);Ue.__webglDepthbuffer&&n.deleteRenderbuffer(Ue.__webglDepthbuffer[An])}else{if(Array.isArray(Ue.__webglFramebuffer))for(let An=0;An<Ue.__webglFramebuffer.length;An++)n.deleteFramebuffer(Ue.__webglFramebuffer[An]);else n.deleteFramebuffer(Ue.__webglFramebuffer);if(Ue.__webglDepthbuffer&&n.deleteRenderbuffer(Ue.__webglDepthbuffer),Ue.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Ue.__webglMultisampledFramebuffer),Ue.__webglColorRenderbuffer)for(let An=0;An<Ue.__webglColorRenderbuffer.length;An++)Ue.__webglColorRenderbuffer[An]&&n.deleteRenderbuffer(Ue.__webglColorRenderbuffer[An]);Ue.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Ue.__webglDepthRenderbuffer)}const $t=at.textures;for(let An=0,Sn=$t.length;An<Sn;An++){const jt=r.get($t[An]);jt.__webglTexture&&(n.deleteTexture(jt.__webglTexture),a.memory.textures--),r.remove($t[An])}r.remove(at)}let ae=0;function fe(){ae=0}function Se(){const at=ae;return at>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+at+" texture units while this GPU supports only "+i.maxTextures),ae+=1,at}function Ce(at){const Ue=[];return Ue.push(at.wrapS),Ue.push(at.wrapT),Ue.push(at.wrapR||0),Ue.push(at.magFilter),Ue.push(at.minFilter),Ue.push(at.anisotropy),Ue.push(at.internalFormat),Ue.push(at.format),Ue.push(at.type),Ue.push(at.generateMipmaps),Ue.push(at.premultiplyAlpha),Ue.push(at.flipY),Ue.push(at.unpackAlignment),Ue.push(at.colorSpace),Ue.join()}function Ie(at,Ue){const $t=r.get(at);if(at.isVideoTexture&&kn(at),at.isRenderTargetTexture===!1&&at.version>0&&$t.__version!==at.version){const An=at.image;if(An===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(An.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Vt($t,at,Ue);return}}t.bindTexture(n.TEXTURE_2D,$t.__webglTexture,n.TEXTURE0+Ue)}function je(at,Ue){const $t=r.get(at);if(at.version>0&&$t.__version!==at.version){Vt($t,at,Ue);return}t.bindTexture(n.TEXTURE_2D_ARRAY,$t.__webglTexture,n.TEXTURE0+Ue)}function Le(at,Ue){const $t=r.get(at);if(at.version>0&&$t.__version!==at.version){Vt($t,at,Ue);return}t.bindTexture(n.TEXTURE_3D,$t.__webglTexture,n.TEXTURE0+Ue)}function ot(at,Ue){const $t=r.get(at);if(at.version>0&&$t.__version!==at.version){lt($t,at,Ue);return}t.bindTexture(n.TEXTURE_CUBE_MAP,$t.__webglTexture,n.TEXTURE0+Ue)}const ye={[Bh]:n.REPEAT,[su]:n.CLAMP_TO_EDGE,[Zy]:n.MIRRORED_REPEAT},$e={[Sa]:n.NEAREST,[FT]:n.NEAREST_MIPMAP_NEAREST,[V0]:n.NEAREST_MIPMAP_LINEAR,[Eo]:n.LINEAR,[Dy]:n.LINEAR_MIPMAP_NEAREST,[ou]:n.LINEAR_MIPMAP_LINEAR},Ve={[Pte]:n.NEVER,[Fte]:n.ALWAYS,[Lte]:n.LESS,[N6]:n.LEQUAL,[Dte]:n.EQUAL,[Ote]:n.GEQUAL,[Bte]:n.GREATER,[kte]:n.NOTEQUAL};function _t(at,Ue){if(Ue.type===Ac&&e.has("OES_texture_float_linear")===!1&&(Ue.magFilter===Eo||Ue.magFilter===Dy||Ue.magFilter===V0||Ue.magFilter===ou||Ue.minFilter===Eo||Ue.minFilter===Dy||Ue.minFilter===V0||Ue.minFilter===ou)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(at,n.TEXTURE_WRAP_S,ye[Ue.wrapS]),n.texParameteri(at,n.TEXTURE_WRAP_T,ye[Ue.wrapT]),(at===n.TEXTURE_3D||at===n.TEXTURE_2D_ARRAY)&&n.texParameteri(at,n.TEXTURE_WRAP_R,ye[Ue.wrapR]),n.texParameteri(at,n.TEXTURE_MAG_FILTER,$e[Ue.magFilter]),n.texParameteri(at,n.TEXTURE_MIN_FILTER,$e[Ue.minFilter]),Ue.compareFunction&&(n.texParameteri(at,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(at,n.TEXTURE_COMPARE_FUNC,Ve[Ue.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Ue.magFilter===Sa||Ue.minFilter!==V0&&Ue.minFilter!==ou||Ue.type===Ac&&e.has("OES_texture_float_linear")===!1)return;if(Ue.anisotropy>1||r.get(Ue).__currentAnisotropy){const $t=e.get("EXT_texture_filter_anisotropic");n.texParameterf(at,$t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ue.anisotropy,i.getMaxAnisotropy())),r.get(Ue).__currentAnisotropy=Ue.anisotropy}}}function wt(at,Ue){let $t=!1;at.__webglInit===void 0&&(at.__webglInit=!0,Ue.addEventListener("dispose",q));const An=Ue.source;let Sn=v.get(An);Sn===void 0&&(Sn={},v.set(An,Sn));const jt=Ce(Ue);if(jt!==at.__cacheKey){Sn[jt]===void 0&&(Sn[jt]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,$t=!0),Sn[jt].usedTimes++;const mr=Sn[at.__cacheKey];mr!==void 0&&(Sn[at.__cacheKey].usedTimes--,mr.usedTimes===0&&re(Ue)),at.__cacheKey=jt,at.__webglTexture=Sn[jt].texture}return $t}function Vt(at,Ue,$t){let An=n.TEXTURE_2D;(Ue.isDataArrayTexture||Ue.isCompressedArrayTexture)&&(An=n.TEXTURE_2D_ARRAY),Ue.isData3DTexture&&(An=n.TEXTURE_3D);const Sn=wt(at,Ue),jt=Ue.source;t.bindTexture(An,at.__webglTexture,n.TEXTURE0+$t);const mr=r.get(jt);if(jt.version!==mr.__version||Sn===!0){t.activeTexture(n.TEXTURE0+$t);const Un=ms.getPrimaries(ms.workingColorSpace),tr=Ue.colorSpace===Am?null:ms.getPrimaries(Ue.colorSpace),Sr=Ue.colorSpace===Am||Un===tr?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ue.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ue.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ue.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Sr);let Ln=E(Ue.image,!1,i.maxTextureSize);Ln=Gn(Ue,Ln);const ir=s.convert(Ue.format,Ue.colorSpace),ui=s.convert(Ue.type);let Fr=L(Ue.internalFormat,ir,ui,Ue.colorSpace,Ue.isVideoTexture);_t(An,Ue);let or;const Nr=Ue.mipmaps,Hr=Ue.isVideoTexture!==!0,yi=mr.__version===void 0||Sn===!0,Fe=jt.dataReady,Lt=H(Ue,Ln);if(Ue.isDepthTexture)Fr=k(Ue.format===Ky,Ue.type),yi&&(Hr?t.texStorage2D(n.TEXTURE_2D,1,Fr,Ln.width,Ln.height):t.texImage2D(n.TEXTURE_2D,0,Fr,Ln.width,Ln.height,0,ir,ui,null));else if(Ue.isDataTexture)if(Nr.length>0){Hr&&yi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Nr[0].width,Nr[0].height);for(let Kt=0,un=Nr.length;Kt<un;Kt++)or=Nr[Kt],Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,or.width,or.height,ir,ui,or.data):t.texImage2D(n.TEXTURE_2D,Kt,Fr,or.width,or.height,0,ir,ui,or.data);Ue.generateMipmaps=!1}else Hr?(yi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Ln.width,Ln.height),Fe&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ln.width,Ln.height,ir,ui,Ln.data)):t.texImage2D(n.TEXTURE_2D,0,Fr,Ln.width,Ln.height,0,ir,ui,Ln.data);else if(Ue.isCompressedTexture)if(Ue.isCompressedArrayTexture){Hr&&yi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Lt,Fr,Nr[0].width,Nr[0].height,Ln.depth);for(let Kt=0,un=Nr.length;Kt<un;Kt++)if(or=Nr[Kt],Ue.format!==Wl)if(ir!==null)if(Hr){if(Fe)if(Ue.layerUpdates.size>0){const En=wF(or.width,or.height,Ue.format,Ue.type);for(const Ar of Ue.layerUpdates){const Vr=or.data.subarray(Ar*En/or.data.BYTES_PER_ELEMENT,(Ar+1)*En/or.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,Ar,or.width,or.height,1,ir,Vr,0,0)}Ue.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,0,or.width,or.height,Ln.depth,ir,or.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Kt,Fr,or.width,or.height,Ln.depth,0,or.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Hr?Fe&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,0,or.width,or.height,Ln.depth,ir,ui,or.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Kt,Fr,or.width,or.height,Ln.depth,0,ir,ui,or.data)}else{Hr&&yi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Nr[0].width,Nr[0].height);for(let Kt=0,un=Nr.length;Kt<un;Kt++)or=Nr[Kt],Ue.format!==Wl?ir!==null?Hr?Fe&&t.compressedTexSubImage2D(n.TEXTURE_2D,Kt,0,0,or.width,or.height,ir,or.data):t.compressedTexImage2D(n.TEXTURE_2D,Kt,Fr,or.width,or.height,0,or.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,or.width,or.height,ir,ui,or.data):t.texImage2D(n.TEXTURE_2D,Kt,Fr,or.width,or.height,0,ir,ui,or.data)}else if(Ue.isDataArrayTexture)if(Hr){if(yi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Lt,Fr,Ln.width,Ln.height,Ln.depth),Fe)if(Ue.layerUpdates.size>0){const Kt=wF(Ln.width,Ln.height,Ue.format,Ue.type);for(const un of Ue.layerUpdates){const En=Ln.data.subarray(un*Kt/Ln.data.BYTES_PER_ELEMENT,(un+1)*Kt/Ln.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,un,Ln.width,Ln.height,1,ir,ui,En)}Ue.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ln.width,Ln.height,Ln.depth,ir,ui,Ln.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Fr,Ln.width,Ln.height,Ln.depth,0,ir,ui,Ln.data);else if(Ue.isData3DTexture)Hr?(yi&&t.texStorage3D(n.TEXTURE_3D,Lt,Fr,Ln.width,Ln.height,Ln.depth),Fe&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ln.width,Ln.height,Ln.depth,ir,ui,Ln.data)):t.texImage3D(n.TEXTURE_3D,0,Fr,Ln.width,Ln.height,Ln.depth,0,ir,ui,Ln.data);else if(Ue.isFramebufferTexture){if(yi)if(Hr)t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Ln.width,Ln.height);else{let Kt=Ln.width,un=Ln.height;for(let En=0;En<Lt;En++)t.texImage2D(n.TEXTURE_2D,En,Fr,Kt,un,0,ir,ui,null),Kt>>=1,un>>=1}}else if(Nr.length>0){if(Hr&&yi){const Kt=sn(Nr[0]);t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Kt.width,Kt.height)}for(let Kt=0,un=Nr.length;Kt<un;Kt++)or=Nr[Kt],Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,ir,ui,or):t.texImage2D(n.TEXTURE_2D,Kt,Fr,ir,ui,or);Ue.generateMipmaps=!1}else if(Hr){if(yi){const Kt=sn(Ln);t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Kt.width,Kt.height)}Fe&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ir,ui,Ln)}else t.texImage2D(n.TEXTURE_2D,0,Fr,ir,ui,Ln);M(Ue)&&C(An),mr.__version=jt.version,Ue.onUpdate&&Ue.onUpdate(Ue)}at.__version=Ue.version}function lt(at,Ue,$t){if(Ue.image.length!==6)return;const An=wt(at,Ue),Sn=Ue.source;t.bindTexture(n.TEXTURE_CUBE_MAP,at.__webglTexture,n.TEXTURE0+$t);const jt=r.get(Sn);if(Sn.version!==jt.__version||An===!0){t.activeTexture(n.TEXTURE0+$t);const mr=ms.getPrimaries(ms.workingColorSpace),Un=Ue.colorSpace===Am?null:ms.getPrimaries(Ue.colorSpace),tr=Ue.colorSpace===Am||mr===Un?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ue.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ue.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ue.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,tr);const Sr=Ue.isCompressedTexture||Ue.image[0].isCompressedTexture,Ln=Ue.image[0]&&Ue.image[0].isDataTexture,ir=[];for(let un=0;un<6;un++)!Sr&&!Ln?ir[un]=E(Ue.image[un],!0,i.maxCubemapSize):ir[un]=Ln?Ue.image[un].image:Ue.image[un],ir[un]=Gn(Ue,ir[un]);const ui=ir[0],Fr=s.convert(Ue.format,Ue.colorSpace),or=s.convert(Ue.type),Nr=L(Ue.internalFormat,Fr,or,Ue.colorSpace),Hr=Ue.isVideoTexture!==!0,yi=jt.__version===void 0||An===!0,Fe=Sn.dataReady;let Lt=H(Ue,ui);_t(n.TEXTURE_CUBE_MAP,Ue);let Kt;if(Sr){Hr&&yi&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Lt,Nr,ui.width,ui.height);for(let un=0;un<6;un++){Kt=ir[un].mipmaps;for(let En=0;En<Kt.length;En++){const Ar=Kt[En];Ue.format!==Wl?Fr!==null?Hr?Fe&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En,0,0,Ar.width,Ar.height,Fr,Ar.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En,Nr,Ar.width,Ar.height,0,Ar.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En,0,0,Ar.width,Ar.height,Fr,or,Ar.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En,Nr,Ar.width,Ar.height,0,Fr,or,Ar.data)}}}else{if(Kt=Ue.mipmaps,Hr&&yi){Kt.length>0&&Lt++;const un=sn(ir[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Lt,Nr,un.width,un.height)}for(let un=0;un<6;un++)if(Ln){Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,0,0,ir[un].width,ir[un].height,Fr,or,ir[un].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,Nr,ir[un].width,ir[un].height,0,Fr,or,ir[un].data);for(let En=0;En<Kt.length;En++){const Vr=Kt[En].image[un].image;Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En+1,0,0,Vr.width,Vr.height,Fr,or,Vr.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En+1,Nr,Vr.width,Vr.height,0,Fr,or,Vr.data)}}else{Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,0,0,Fr,or,ir[un]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,Nr,Fr,or,ir[un]);for(let En=0;En<Kt.length;En++){const Ar=Kt[En];Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En+1,0,0,Fr,or,Ar.image[un]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,En+1,Nr,Fr,or,Ar.image[un])}}}M(Ue)&&C(n.TEXTURE_CUBE_MAP),jt.__version=Sn.version,Ue.onUpdate&&Ue.onUpdate(Ue)}at.__version=Ue.version}function Ht(at,Ue,$t,An,Sn,jt){const mr=s.convert($t.format,$t.colorSpace),Un=s.convert($t.type),tr=L($t.internalFormat,mr,Un,$t.colorSpace);if(!r.get(Ue).__hasExternalTextures){const Ln=Math.max(1,Ue.width>>jt),ir=Math.max(1,Ue.height>>jt);Sn===n.TEXTURE_3D||Sn===n.TEXTURE_2D_ARRAY?t.texImage3D(Sn,jt,tr,Ln,ir,Ue.depth,0,mr,Un,null):t.texImage2D(Sn,jt,tr,Ln,ir,0,mr,Un,null)}t.bindFramebuffer(n.FRAMEBUFFER,at),Jt(Ue)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,An,Sn,r.get($t).__webglTexture,0,St(Ue)):(Sn===n.TEXTURE_2D||Sn>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Sn<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,An,Sn,r.get($t).__webglTexture,jt),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qt(at,Ue,$t){if(n.bindRenderbuffer(n.RENDERBUFFER,at),Ue.depthBuffer){const An=Ue.depthTexture,Sn=An&&An.isDepthTexture?An.type:null,jt=k(Ue.stencilBuffer,Sn),mr=Ue.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Un=St(Ue);Jt(Ue)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Un,jt,Ue.width,Ue.height):$t?n.renderbufferStorageMultisample(n.RENDERBUFFER,Un,jt,Ue.width,Ue.height):n.renderbufferStorage(n.RENDERBUFFER,jt,Ue.width,Ue.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,mr,n.RENDERBUFFER,at)}else{const An=Ue.textures;for(let Sn=0;Sn<An.length;Sn++){const jt=An[Sn],mr=s.convert(jt.format,jt.colorSpace),Un=s.convert(jt.type),tr=L(jt.internalFormat,mr,Un,jt.colorSpace),Sr=St(Ue);$t&&Jt(Ue)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Sr,tr,Ue.width,Ue.height):Jt(Ue)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Sr,tr,Ue.width,Ue.height):n.renderbufferStorage(n.RENDERBUFFER,tr,Ue.width,Ue.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function rn(at,Ue){if(Ue&&Ue.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,at),!(Ue.depthTexture&&Ue.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Ue.depthTexture).__webglTexture||Ue.depthTexture.image.width!==Ue.width||Ue.depthTexture.image.height!==Ue.height)&&(Ue.depthTexture.image.width=Ue.width,Ue.depthTexture.image.height=Ue.height,Ue.depthTexture.needsUpdate=!0),Ie(Ue.depthTexture,0);const An=r.get(Ue.depthTexture).__webglTexture,Sn=St(Ue);if(Ue.depthTexture.format===By)Jt(Ue)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,An,0,Sn):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,An,0);else if(Ue.depthTexture.format===Ky)Jt(Ue)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,An,0,Sn):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,An,0);else throw new Error("Unknown depthTexture format")}function jn(at){const Ue=r.get(at),$t=at.isWebGLCubeRenderTarget===!0;if(at.depthTexture&&!Ue.__autoAllocateDepthBuffer){if($t)throw new Error("target.depthTexture not supported in Cube render targets");rn(Ue.__webglFramebuffer,at)}else if($t){Ue.__webglDepthbuffer=[];for(let An=0;An<6;An++)t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglFramebuffer[An]),Ue.__webglDepthbuffer[An]=n.createRenderbuffer(),Qt(Ue.__webglDepthbuffer[An],at,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglFramebuffer),Ue.__webglDepthbuffer=n.createRenderbuffer(),Qt(Ue.__webglDepthbuffer,at,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Bn(at,Ue,$t){const An=r.get(at);Ue!==void 0&&Ht(An.__webglFramebuffer,at,at.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),$t!==void 0&&jn(at)}function Tn(at){const Ue=at.texture,$t=r.get(at),An=r.get(Ue);at.addEventListener("dispose",Z);const Sn=at.textures,jt=at.isWebGLCubeRenderTarget===!0,mr=Sn.length>1;if(mr||(An.__webglTexture===void 0&&(An.__webglTexture=n.createTexture()),An.__version=Ue.version,a.memory.textures++),jt){$t.__webglFramebuffer=[];for(let Un=0;Un<6;Un++)if(Ue.mipmaps&&Ue.mipmaps.length>0){$t.__webglFramebuffer[Un]=[];for(let tr=0;tr<Ue.mipmaps.length;tr++)$t.__webglFramebuffer[Un][tr]=n.createFramebuffer()}else $t.__webglFramebuffer[Un]=n.createFramebuffer()}else{if(Ue.mipmaps&&Ue.mipmaps.length>0){$t.__webglFramebuffer=[];for(let Un=0;Un<Ue.mipmaps.length;Un++)$t.__webglFramebuffer[Un]=n.createFramebuffer()}else $t.__webglFramebuffer=n.createFramebuffer();if(mr)for(let Un=0,tr=Sn.length;Un<tr;Un++){const Sr=r.get(Sn[Un]);Sr.__webglTexture===void 0&&(Sr.__webglTexture=n.createTexture(),a.memory.textures++)}if(at.samples>0&&Jt(at)===!1){$t.__webglMultisampledFramebuffer=n.createFramebuffer(),$t.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,$t.__webglMultisampledFramebuffer);for(let Un=0;Un<Sn.length;Un++){const tr=Sn[Un];$t.__webglColorRenderbuffer[Un]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,$t.__webglColorRenderbuffer[Un]);const Sr=s.convert(tr.format,tr.colorSpace),Ln=s.convert(tr.type),ir=L(tr.internalFormat,Sr,Ln,tr.colorSpace,at.isXRRenderTarget===!0),ui=St(at);n.renderbufferStorageMultisample(n.RENDERBUFFER,ui,ir,at.width,at.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Un,n.RENDERBUFFER,$t.__webglColorRenderbuffer[Un])}n.bindRenderbuffer(n.RENDERBUFFER,null),at.depthBuffer&&($t.__webglDepthRenderbuffer=n.createRenderbuffer(),Qt($t.__webglDepthRenderbuffer,at,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(jt){t.bindTexture(n.TEXTURE_CUBE_MAP,An.__webglTexture),_t(n.TEXTURE_CUBE_MAP,Ue);for(let Un=0;Un<6;Un++)if(Ue.mipmaps&&Ue.mipmaps.length>0)for(let tr=0;tr<Ue.mipmaps.length;tr++)Ht($t.__webglFramebuffer[Un][tr],at,Ue,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Un,tr);else Ht($t.__webglFramebuffer[Un],at,Ue,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Un,0);M(Ue)&&C(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(mr){for(let Un=0,tr=Sn.length;Un<tr;Un++){const Sr=Sn[Un],Ln=r.get(Sr);t.bindTexture(n.TEXTURE_2D,Ln.__webglTexture),_t(n.TEXTURE_2D,Sr),Ht($t.__webglFramebuffer,at,Sr,n.COLOR_ATTACHMENT0+Un,n.TEXTURE_2D,0),M(Sr)&&C(n.TEXTURE_2D)}t.unbindTexture()}else{let Un=n.TEXTURE_2D;if((at.isWebGL3DRenderTarget||at.isWebGLArrayRenderTarget)&&(Un=at.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Un,An.__webglTexture),_t(Un,Ue),Ue.mipmaps&&Ue.mipmaps.length>0)for(let tr=0;tr<Ue.mipmaps.length;tr++)Ht($t.__webglFramebuffer[tr],at,Ue,n.COLOR_ATTACHMENT0,Un,tr);else Ht($t.__webglFramebuffer,at,Ue,n.COLOR_ATTACHMENT0,Un,0);M(Ue)&&C(Un),t.unbindTexture()}at.depthBuffer&&jn(at)}function Pe(at){const Ue=at.textures;for(let $t=0,An=Ue.length;$t<An;$t++){const Sn=Ue[$t];if(M(Sn)){const jt=at.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,mr=r.get(Sn).__webglTexture;t.bindTexture(jt,mr),C(jt),t.unbindTexture()}}}const qe=[],mn=[];function cn(at){if(at.samples>0){if(Jt(at)===!1){const Ue=at.textures,$t=at.width,An=at.height;let Sn=n.COLOR_BUFFER_BIT;const jt=at.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,mr=r.get(at),Un=Ue.length>1;if(Un)for(let tr=0;tr<Ue.length;tr++)t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,mr.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,mr.__webglFramebuffer);for(let tr=0;tr<Ue.length;tr++){if(at.resolveDepthBuffer&&(at.depthBuffer&&(Sn|=n.DEPTH_BUFFER_BIT),at.stencilBuffer&&at.resolveStencilBuffer&&(Sn|=n.STENCIL_BUFFER_BIT)),Un){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,mr.__webglColorRenderbuffer[tr]);const Sr=r.get(Ue[tr]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Sr,0)}n.blitFramebuffer(0,0,$t,An,0,0,$t,An,Sn,n.NEAREST),o===!0&&(qe.length=0,mn.length=0,qe.push(n.COLOR_ATTACHMENT0+tr),at.depthBuffer&&at.resolveDepthBuffer===!1&&(qe.push(jt),mn.push(jt),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,mn)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,qe))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Un)for(let tr=0;tr<Ue.length;tr++){t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.RENDERBUFFER,mr.__webglColorRenderbuffer[tr]);const Sr=r.get(Ue[tr]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.TEXTURE_2D,Sr,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,mr.__webglMultisampledFramebuffer)}else if(at.depthBuffer&&at.resolveDepthBuffer===!1&&o){const Ue=at.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ue])}}}function St(at){return Math.min(i.maxSamples,at.samples)}function Jt(at){const Ue=r.get(at);return at.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Ue.__useRenderToTexture!==!1}function kn(at){const Ue=a.render.frame;d.get(at)!==Ue&&(d.set(at,Ue),at.update())}function Gn(at,Ue){const $t=at.colorSpace,An=at.format,Sn=at.type;return at.isCompressedTexture===!0||at.isVideoTexture===!0||$t!==Ha&&$t!==Am&&(ms.getTransfer($t)===to?(An!==Wl||Sn!==Zf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",$t)),Ue}function sn(at){return typeof HTMLImageElement<"u"&&at instanceof HTMLImageElement?(h.width=at.naturalWidth||at.width,h.height=at.naturalHeight||at.height):typeof VideoFrame<"u"&&at instanceof VideoFrame?(h.width=at.displayWidth,h.height=at.displayHeight):(h.width=at.width,h.height=at.height),h}this.allocateTextureUnit=Se,this.resetTextureUnits=fe,this.setTexture2D=Ie,this.setTexture2DArray=je,this.setTexture3D=Le,this.setTextureCube=ot,this.rebindTextures=Bn,this.setupRenderTarget=Tn,this.updateRenderTargetMipmap=Pe,this.updateMultisampleRenderTarget=cn,this.setupDepthRenderbuffer=jn,this.setupFrameBufferTexture=Ht,this.useMultisampledRTT=Jt}function Kte(n,e){function t(r,i=Am){let s;const a=ms.getTransfer(i);if(r===Zf)return n.UNSIGNED_BYTE;if(r===qL)return n.UNSIGNED_SHORT_4_4_4_4;if(r===ZL)return n.UNSIGNED_SHORT_5_5_5_1;if(r===I6)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===C6)return n.BYTE;if(r===E6)return n.SHORT;if(r===Jb)return n.UNSIGNED_SHORT;if(r===$L)return n.INT;if(r===jm)return n.UNSIGNED_INT;if(r===Ac)return n.FLOAT;if(r===Ch)return n.HALF_FLOAT;if(r===R6)return n.ALPHA;if(r===P6)return n.RGB;if(r===Wl)return n.RGBA;if(r===L6)return n.LUMINANCE;if(r===D6)return n.LUMINANCE_ALPHA;if(r===By)return n.DEPTH_COMPONENT;if(r===Ky)return n.DEPTH_STENCIL;if(r===NT)return n.RED;if(r===zT)return n.RED_INTEGER;if(r===B6)return n.RG;if(r===YL)return n.RG_INTEGER;if(r===KL)return n.RGBA_INTEGER;if(r===jS||r===WS||r===XS||r===$S)if(a===to)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===jS)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===WS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===XS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===$S)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===jS)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===WS)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===XS)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===$S)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===HR||r===jR||r===WR||r===XR)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===HR)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===jR)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===WR)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===XR)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===$R||r===qR||r===ZR)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===$R||r===qR)return a===to?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===ZR)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===YR||r===KR||r===JR||r===QR||r===eP||r===tP||r===nP||r===rP||r===iP||r===sP||r===oP||r===aP||r===lP||r===cP)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===YR)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===KR)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===JR)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===QR)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===eP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===tP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===nP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===rP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===iP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===sP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===oP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===aP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===lP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===cP)return a===to?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===qS||r===uP||r===hP)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===qS)return a===to?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===uP)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===hP)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===k6||r===fP||r===dP||r===pP)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===qS)return s.COMPRESSED_RED_RGTC1_EXT;if(r===fP)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===dP)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===pP)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Yy?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}class Jte extends ts{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Xl=class extends Ri{constructor(){super(),this.isGroup=!0,this.type="Group"}};const Ixe={type:"move"};class D5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ze),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const l=this._targetRay,o=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const E of e.hand.values()){const M=t.getJointPose(E,r),C=this._getHandJoint(h,E);M!==null&&(C.matrix.fromArray(M.transform.matrix),C.matrix.decompose(C.position,C.rotation,C.scale),C.matrixWorldNeedsUpdate=!0,C.jointRadius=M.radius),C.visible=M!==null}const d=h.joints["index-finger-tip"],m=h.joints["thumb-tip"],v=d.position.distanceTo(m.position),y=.02,S=.005;h.inputState.pinching&&v>y+S?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&v<=y-S&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(o.matrix.fromArray(s.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,s.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(s.linearVelocity)):o.hasLinearVelocity=!1,s.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(s.angularVelocity)):o.hasAngularVelocity=!1));l!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(l.matrix.fromArray(i.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,i.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(i.linearVelocity)):l.hasLinearVelocity=!1,i.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(i.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Ixe)))}return l!==null&&(l.visible=i!==null),o!==null&&(o.visible=s!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new Xl;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const Rxe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Pxe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Lxe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new Xs,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Io({vertexShader:Rxe,fragmentShader:Pxe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ii(new tg(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Dxe extends vp{constructor(e,t){super();const r=this;let i=null,s=1,a=null,l="local-floor",o=1,h=null,d=null,m=null,v=null,y=null,S=null;const E=new Lxe,M=t.getContextAttributes();let C=null,L=null;const k=[],H=[],q=new nn;let Z=null;const ee=new ts;ee.layers.enable(1),ee.viewport=new Is;const re=new ts;re.layers.enable(2),re.viewport=new Is;const se=[ee,re],ae=new Jte;ae.layers.enable(1),ae.layers.enable(2);let fe=null,Se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new D5,k[lt]=Ht),Ht.getTargetRaySpace()},this.getControllerGrip=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new D5,k[lt]=Ht),Ht.getGripSpace()},this.getHand=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new D5,k[lt]=Ht),Ht.getHandSpace()};function Ce(lt){const Ht=H.indexOf(lt.inputSource);if(Ht===-1)return;const Qt=k[Ht];Qt!==void 0&&(Qt.update(lt.inputSource,lt.frame,h||a),Qt.dispatchEvent({type:lt.type,data:lt.inputSource}))}function Ie(){i.removeEventListener("select",Ce),i.removeEventListener("selectstart",Ce),i.removeEventListener("selectend",Ce),i.removeEventListener("squeeze",Ce),i.removeEventListener("squeezestart",Ce),i.removeEventListener("squeezeend",Ce),i.removeEventListener("end",Ie),i.removeEventListener("inputsourceschange",je);for(let lt=0;lt<k.length;lt++){const Ht=H[lt];Ht!==null&&(H[lt]=null,k[lt].disconnect(Ht))}fe=null,Se=null,E.reset(),e.setRenderTarget(C),y=null,v=null,m=null,i=null,L=null,Vt.stop(),r.isPresenting=!1,e.setPixelRatio(Z),e.setSize(q.width,q.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(lt){s=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(lt){l=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(lt){h=lt},this.getBaseLayer=function(){return v!==null?v:y},this.getBinding=function(){return m},this.getFrame=function(){return S},this.getSession=function(){return i},this.setSession=async function(lt){if(i=lt,i!==null){if(C=e.getRenderTarget(),i.addEventListener("select",Ce),i.addEventListener("selectstart",Ce),i.addEventListener("selectend",Ce),i.addEventListener("squeeze",Ce),i.addEventListener("squeezestart",Ce),i.addEventListener("squeezeend",Ce),i.addEventListener("end",Ie),i.addEventListener("inputsourceschange",je),M.xrCompatible!==!0&&await t.makeXRCompatible(),Z=e.getPixelRatio(),e.getSize(q),i.renderState.layers===void 0){const Ht={antialias:M.antialias,alpha:!0,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:s};y=new XRWebGLLayer(i,t,Ht),i.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),L=new wl(y.framebufferWidth,y.framebufferHeight,{format:Wl,type:Zf,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil})}else{let Ht=null,Qt=null,rn=null;M.depth&&(rn=M.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ht=M.stencil?Ky:By,Qt=M.stencil?Yy:jm);const jn={colorFormat:t.RGBA8,depthFormat:rn,scaleFactor:s};m=new XRWebGLBinding(i,t),v=m.createProjectionLayer(jn),i.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),L=new wl(v.textureWidth,v.textureHeight,{format:Wl,type:Zf,depthTexture:new W6(v.textureWidth,v.textureHeight,Qt,void 0,void 0,void 0,void 0,void 0,void 0,Ht),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1})}L.isXRRenderTarget=!0,this.setFoveation(o),h=null,a=await i.requestReferenceSpace(l),Vt.setContext(i),Vt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function je(lt){for(let Ht=0;Ht<lt.removed.length;Ht++){const Qt=lt.removed[Ht],rn=H.indexOf(Qt);rn>=0&&(H[rn]=null,k[rn].disconnect(Qt))}for(let Ht=0;Ht<lt.added.length;Ht++){const Qt=lt.added[Ht];let rn=H.indexOf(Qt);if(rn===-1){for(let Bn=0;Bn<k.length;Bn++)if(Bn>=H.length){H.push(Qt),rn=Bn;break}else if(H[Bn]===null){H[Bn]=Qt,rn=Bn;break}if(rn===-1)break}const jn=k[rn];jn&&jn.connect(Qt)}}const Le=new Ze,ot=new Ze;function ye(lt,Ht,Qt){Le.setFromMatrixPosition(Ht.matrixWorld),ot.setFromMatrixPosition(Qt.matrixWorld);const rn=Le.distanceTo(ot),jn=Ht.projectionMatrix.elements,Bn=Qt.projectionMatrix.elements,Tn=jn[14]/(jn[10]-1),Pe=jn[14]/(jn[10]+1),qe=(jn[9]+1)/jn[5],mn=(jn[9]-1)/jn[5],cn=(jn[8]-1)/jn[0],St=(Bn[8]+1)/Bn[0],Jt=Tn*cn,kn=Tn*St,Gn=rn/(-cn+St),sn=Gn*-cn;Ht.matrixWorld.decompose(lt.position,lt.quaternion,lt.scale),lt.translateX(sn),lt.translateZ(Gn),lt.matrixWorld.compose(lt.position,lt.quaternion,lt.scale),lt.matrixWorldInverse.copy(lt.matrixWorld).invert();const at=Tn+Gn,Ue=Pe+Gn,$t=Jt-sn,An=kn+(rn-sn),Sn=qe*Pe/Ue*at,jt=mn*Pe/Ue*at;lt.projectionMatrix.makePerspective($t,An,Sn,jt,at,Ue),lt.projectionMatrixInverse.copy(lt.projectionMatrix).invert()}function $e(lt,Ht){Ht===null?lt.matrixWorld.copy(lt.matrix):lt.matrixWorld.multiplyMatrices(Ht.matrixWorld,lt.matrix),lt.matrixWorldInverse.copy(lt.matrixWorld).invert()}this.updateCamera=function(lt){if(i===null)return;E.texture!==null&&(lt.near=E.depthNear,lt.far=E.depthFar),ae.near=re.near=ee.near=lt.near,ae.far=re.far=ee.far=lt.far,(fe!==ae.near||Se!==ae.far)&&(i.updateRenderState({depthNear:ae.near,depthFar:ae.far}),fe=ae.near,Se=ae.far,ee.near=fe,ee.far=Se,re.near=fe,re.far=Se,ee.updateProjectionMatrix(),re.updateProjectionMatrix(),lt.updateProjectionMatrix());const Ht=lt.parent,Qt=ae.cameras;$e(ae,Ht);for(let rn=0;rn<Qt.length;rn++)$e(Qt[rn],Ht);Qt.length===2?ye(ae,ee,re):ae.projectionMatrix.copy(ee.projectionMatrix),Ve(lt,ae,Ht)};function Ve(lt,Ht,Qt){Qt===null?lt.matrix.copy(Ht.matrixWorld):(lt.matrix.copy(Qt.matrixWorld),lt.matrix.invert(),lt.matrix.multiply(Ht.matrixWorld)),lt.matrix.decompose(lt.position,lt.quaternion,lt.scale),lt.updateMatrixWorld(!0),lt.projectionMatrix.copy(Ht.projectionMatrix),lt.projectionMatrixInverse.copy(Ht.projectionMatrixInverse),lt.isPerspectiveCamera&&(lt.fov=Qb*2*Math.atan(1/lt.projectionMatrix.elements[5]),lt.zoom=1)}this.getCamera=function(){return ae},this.getFoveation=function(){if(!(v===null&&y===null))return o},this.setFoveation=function(lt){o=lt,v!==null&&(v.fixedFoveation=lt),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=lt)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(ae)};let _t=null;function wt(lt,Ht){if(d=Ht.getViewerPose(h||a),S=Ht,d!==null){const Qt=d.views;y!==null&&(e.setRenderTargetFramebuffer(L,y.framebuffer),e.setRenderTarget(L));let rn=!1;Qt.length!==ae.cameras.length&&(ae.cameras.length=0,rn=!0);for(let Bn=0;Bn<Qt.length;Bn++){const Tn=Qt[Bn];let Pe=null;if(y!==null)Pe=y.getViewport(Tn);else{const mn=m.getViewSubImage(v,Tn);Pe=mn.viewport,Bn===0&&(e.setRenderTargetTextures(L,mn.colorTexture,v.ignoreDepthValues?void 0:mn.depthStencilTexture),e.setRenderTarget(L))}let qe=se[Bn];qe===void 0&&(qe=new ts,qe.layers.enable(Bn),qe.viewport=new Is,se[Bn]=qe),qe.matrix.fromArray(Tn.transform.matrix),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),qe.projectionMatrix.fromArray(Tn.projectionMatrix),qe.projectionMatrixInverse.copy(qe.projectionMatrix).invert(),qe.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),Bn===0&&(ae.matrix.copy(qe.matrix),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale)),rn===!0&&ae.cameras.push(qe)}const jn=i.enabledFeatures;if(jn&&jn.includes("depth-sensing")){const Bn=m.getDepthInformation(Qt[0]);Bn&&Bn.isValid&&Bn.texture&&E.init(e,Bn,i.renderState)}}for(let Qt=0;Qt<k.length;Qt++){const rn=H[Qt],jn=k[Qt];rn!==null&&jn!==void 0&&jn.update(rn,Ht,h||a)}_t&&_t(lt,Ht),Ht.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ht}),S=null}const Vt=new Xte;Vt.setAnimationLoop(wt),this.setAnimationLoop=function(lt){_t=lt},this.dispose=function(){}}}const A_=new zu,Bxe=new Gr;function kxe(n,e){function t(M,C){M.matrixAutoUpdate===!0&&M.updateMatrix(),C.value.copy(M.matrix)}function r(M,C){C.color.getRGB(M.fogColor.value,Hte(n)),C.isFog?(M.fogNear.value=C.near,M.fogFar.value=C.far):C.isFogExp2&&(M.fogDensity.value=C.density)}function i(M,C,L,k,H){C.isMeshBasicMaterial||C.isMeshLambertMaterial?s(M,C):C.isMeshToonMaterial?(s(M,C),m(M,C)):C.isMeshPhongMaterial?(s(M,C),d(M,C)):C.isMeshStandardMaterial?(s(M,C),v(M,C),C.isMeshPhysicalMaterial&&y(M,C,H)):C.isMeshMatcapMaterial?(s(M,C),S(M,C)):C.isMeshDepthMaterial?s(M,C):C.isMeshDistanceMaterial?(s(M,C),E(M,C)):C.isMeshNormalMaterial?s(M,C):C.isLineBasicMaterial?(a(M,C),C.isLineDashedMaterial&&l(M,C)):C.isPointsMaterial?o(M,C,L,k):C.isSpriteMaterial?h(M,C):C.isShadowMaterial?(M.color.value.copy(C.color),M.opacity.value=C.opacity):C.isShaderMaterial&&(C.uniformsNeedUpdate=!1)}function s(M,C){M.opacity.value=C.opacity,C.color&&M.diffuse.value.copy(C.color),C.emissive&&M.emissive.value.copy(C.emissive).multiplyScalar(C.emissiveIntensity),C.map&&(M.map.value=C.map,t(C.map,M.mapTransform)),C.alphaMap&&(M.alphaMap.value=C.alphaMap,t(C.alphaMap,M.alphaMapTransform)),C.bumpMap&&(M.bumpMap.value=C.bumpMap,t(C.bumpMap,M.bumpMapTransform),M.bumpScale.value=C.bumpScale,C.side===Cc&&(M.bumpScale.value*=-1)),C.normalMap&&(M.normalMap.value=C.normalMap,t(C.normalMap,M.normalMapTransform),M.normalScale.value.copy(C.normalScale),C.side===Cc&&M.normalScale.value.negate()),C.displacementMap&&(M.displacementMap.value=C.displacementMap,t(C.displacementMap,M.displacementMapTransform),M.displacementScale.value=C.displacementScale,M.displacementBias.value=C.displacementBias),C.emissiveMap&&(M.emissiveMap.value=C.emissiveMap,t(C.emissiveMap,M.emissiveMapTransform)),C.specularMap&&(M.specularMap.value=C.specularMap,t(C.specularMap,M.specularMapTransform)),C.alphaTest>0&&(M.alphaTest.value=C.alphaTest);const L=e.get(C),k=L.envMap,H=L.envMapRotation;k&&(M.envMap.value=k,A_.copy(H),A_.x*=-1,A_.y*=-1,A_.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(A_.y*=-1,A_.z*=-1),M.envMapRotation.value.setFromMatrix4(Bxe.makeRotationFromEuler(A_)),M.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=C.reflectivity,M.ior.value=C.ior,M.refractionRatio.value=C.refractionRatio),C.lightMap&&(M.lightMap.value=C.lightMap,M.lightMapIntensity.value=C.lightMapIntensity,t(C.lightMap,M.lightMapTransform)),C.aoMap&&(M.aoMap.value=C.aoMap,M.aoMapIntensity.value=C.aoMapIntensity,t(C.aoMap,M.aoMapTransform))}function a(M,C){M.diffuse.value.copy(C.color),M.opacity.value=C.opacity,C.map&&(M.map.value=C.map,t(C.map,M.mapTransform))}function l(M,C){M.dashSize.value=C.dashSize,M.totalSize.value=C.dashSize+C.gapSize,M.scale.value=C.scale}function o(M,C,L,k){M.diffuse.value.copy(C.color),M.opacity.value=C.opacity,M.size.value=C.size*L,M.scale.value=k*.5,C.map&&(M.map.value=C.map,t(C.map,M.uvTransform)),C.alphaMap&&(M.alphaMap.value=C.alphaMap,t(C.alphaMap,M.alphaMapTransform)),C.alphaTest>0&&(M.alphaTest.value=C.alphaTest)}function h(M,C){M.diffuse.value.copy(C.color),M.opacity.value=C.opacity,M.rotation.value=C.rotation,C.map&&(M.map.value=C.map,t(C.map,M.mapTransform)),C.alphaMap&&(M.alphaMap.value=C.alphaMap,t(C.alphaMap,M.alphaMapTransform)),C.alphaTest>0&&(M.alphaTest.value=C.alphaTest)}function d(M,C){M.specular.value.copy(C.specular),M.shininess.value=Math.max(C.shininess,1e-4)}function m(M,C){C.gradientMap&&(M.gradientMap.value=C.gradientMap)}function v(M,C){M.metalness.value=C.metalness,C.metalnessMap&&(M.metalnessMap.value=C.metalnessMap,t(C.metalnessMap,M.metalnessMapTransform)),M.roughness.value=C.roughness,C.roughnessMap&&(M.roughnessMap.value=C.roughnessMap,t(C.roughnessMap,M.roughnessMapTransform)),C.envMap&&(M.envMapIntensity.value=C.envMapIntensity)}function y(M,C,L){M.ior.value=C.ior,C.sheen>0&&(M.sheenColor.value.copy(C.sheenColor).multiplyScalar(C.sheen),M.sheenRoughness.value=C.sheenRoughness,C.sheenColorMap&&(M.sheenColorMap.value=C.sheenColorMap,t(C.sheenColorMap,M.sheenColorMapTransform)),C.sheenRoughnessMap&&(M.sheenRoughnessMap.value=C.sheenRoughnessMap,t(C.sheenRoughnessMap,M.sheenRoughnessMapTransform))),C.clearcoat>0&&(M.clearcoat.value=C.clearcoat,M.clearcoatRoughness.value=C.clearcoatRoughness,C.clearcoatMap&&(M.clearcoatMap.value=C.clearcoatMap,t(C.clearcoatMap,M.clearcoatMapTransform)),C.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=C.clearcoatRoughnessMap,t(C.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),C.clearcoatNormalMap&&(M.clearcoatNormalMap.value=C.clearcoatNormalMap,t(C.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(C.clearcoatNormalScale),C.side===Cc&&M.clearcoatNormalScale.value.negate())),C.dispersion>0&&(M.dispersion.value=C.dispersion),C.iridescence>0&&(M.iridescence.value=C.iridescence,M.iridescenceIOR.value=C.iridescenceIOR,M.iridescenceThicknessMinimum.value=C.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=C.iridescenceThicknessRange[1],C.iridescenceMap&&(M.iridescenceMap.value=C.iridescenceMap,t(C.iridescenceMap,M.iridescenceMapTransform)),C.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=C.iridescenceThicknessMap,t(C.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),C.transmission>0&&(M.transmission.value=C.transmission,M.transmissionSamplerMap.value=L.texture,M.transmissionSamplerSize.value.set(L.width,L.height),C.transmissionMap&&(M.transmissionMap.value=C.transmissionMap,t(C.transmissionMap,M.transmissionMapTransform)),M.thickness.value=C.thickness,C.thicknessMap&&(M.thicknessMap.value=C.thicknessMap,t(C.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=C.attenuationDistance,M.attenuationColor.value.copy(C.attenuationColor)),C.anisotropy>0&&(M.anisotropyVector.value.set(C.anisotropy*Math.cos(C.anisotropyRotation),C.anisotropy*Math.sin(C.anisotropyRotation)),C.anisotropyMap&&(M.anisotropyMap.value=C.anisotropyMap,t(C.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=C.specularIntensity,M.specularColor.value.copy(C.specularColor),C.specularColorMap&&(M.specularColorMap.value=C.specularColorMap,t(C.specularColorMap,M.specularColorMapTransform)),C.specularIntensityMap&&(M.specularIntensityMap.value=C.specularIntensityMap,t(C.specularIntensityMap,M.specularIntensityMapTransform))}function S(M,C){C.matcap&&(M.matcap.value=C.matcap)}function E(M,C){const L=e.get(C).light;M.referencePosition.value.setFromMatrixPosition(L.matrixWorld),M.nearDistance.value=L.shadow.camera.near,M.farDistance.value=L.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Oxe(n,e,t,r){let i={},s={},a=[];const l=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function o(L,k){const H=k.program;r.uniformBlockBinding(L,H)}function h(L,k){let H=i[L.id];H===void 0&&(S(L),H=d(L),i[L.id]=H,L.addEventListener("dispose",M));const q=k.program;r.updateUBOMapping(L,q);const Z=e.render.frame;s[L.id]!==Z&&(v(L),s[L.id]=Z)}function d(L){const k=m();L.__bindingPointIndex=k;const H=n.createBuffer(),q=L.__size,Z=L.usage;return n.bindBuffer(n.UNIFORM_BUFFER,H),n.bufferData(n.UNIFORM_BUFFER,q,Z),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,k,H),H}function m(){for(let L=0;L<l;L++)if(a.indexOf(L)===-1)return a.push(L),L;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(L){const k=i[L.id],H=L.uniforms,q=L.__cache;n.bindBuffer(n.UNIFORM_BUFFER,k);for(let Z=0,ee=H.length;Z<ee;Z++){const re=Array.isArray(H[Z])?H[Z]:[H[Z]];for(let se=0,ae=re.length;se<ae;se++){const fe=re[se];if(y(fe,Z,se,q)===!0){const Se=fe.__offset,Ce=Array.isArray(fe.value)?fe.value:[fe.value];let Ie=0;for(let je=0;je<Ce.length;je++){const Le=Ce[je],ot=E(Le);typeof Le=="number"||typeof Le=="boolean"?(fe.__data[0]=Le,n.bufferSubData(n.UNIFORM_BUFFER,Se+Ie,fe.__data)):Le.isMatrix3?(fe.__data[0]=Le.elements[0],fe.__data[1]=Le.elements[1],fe.__data[2]=Le.elements[2],fe.__data[3]=0,fe.__data[4]=Le.elements[3],fe.__data[5]=Le.elements[4],fe.__data[6]=Le.elements[5],fe.__data[7]=0,fe.__data[8]=Le.elements[6],fe.__data[9]=Le.elements[7],fe.__data[10]=Le.elements[8],fe.__data[11]=0):(Le.toArray(fe.__data,Ie),Ie+=ot.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Se,fe.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function y(L,k,H,q){const Z=L.value,ee=k+"_"+H;if(q[ee]===void 0)return typeof Z=="number"||typeof Z=="boolean"?q[ee]=Z:q[ee]=Z.clone(),!0;{const re=q[ee];if(typeof Z=="number"||typeof Z=="boolean"){if(re!==Z)return q[ee]=Z,!0}else if(re.equals(Z)===!1)return re.copy(Z),!0}return!1}function S(L){const k=L.uniforms;let H=0;const q=16;for(let ee=0,re=k.length;ee<re;ee++){const se=Array.isArray(k[ee])?k[ee]:[k[ee]];for(let ae=0,fe=se.length;ae<fe;ae++){const Se=se[ae],Ce=Array.isArray(Se.value)?Se.value:[Se.value];for(let Ie=0,je=Ce.length;Ie<je;Ie++){const Le=Ce[Ie],ot=E(Le),ye=H%q;ye!==0&&q-ye<ot.boundary&&(H+=q-ye),Se.__data=new Float32Array(ot.storage/Float32Array.BYTES_PER_ELEMENT),Se.__offset=H,H+=ot.storage}}}const Z=H%q;return Z>0&&(H+=q-Z),L.__size=H,L.__cache={},this}function E(L){const k={boundary:0,storage:0};return typeof L=="number"||typeof L=="boolean"?(k.boundary=4,k.storage=4):L.isVector2?(k.boundary=8,k.storage=8):L.isVector3||L.isColor?(k.boundary=16,k.storage=12):L.isVector4?(k.boundary=16,k.storage=16):L.isMatrix3?(k.boundary=48,k.storage=48):L.isMatrix4?(k.boundary=64,k.storage=64):L.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",L),k}function M(L){const k=L.target;k.removeEventListener("dispose",M);const H=a.indexOf(k.__bindingPointIndex);a.splice(H,1),n.deleteBuffer(i[k.id]),delete i[k.id],delete s[k.id]}function C(){for(const L in i)n.deleteBuffer(i[L]);a=[],i={},s={}}return{bind:o,update:h,dispose:C}}class Yl{constructor(e={}){const{canvas:t=zte(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:l=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:h=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:m=!1}=e;this.isWebGLRenderer=!0;let v;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=r.getContextAttributes().alpha}else v=a;const y=new Uint32Array(4),S=new Int32Array(4);let E=null,M=null;const C=[],L=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=To,this.toneMapping=ap,this.toneMappingExposure=1;const k=this;let H=!1,q=0,Z=0,ee=null,re=-1,se=null;const ae=new Is,fe=new Is;let Se=null;const Ce=new Vn(0);let Ie=0,je=t.width,Le=t.height,ot=1,ye=null,$e=null;const Ve=new Is(0,0,je,Le),_t=new Is(0,0,je,Le);let wt=!1;const Vt=new jT;let lt=!1,Ht=!1;const Qt=new Gr,rn=new Ze,jn=new Is,Bn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Tn=!1;function Pe(){return ee===null?ot:1}let qe=r;function mn(Ge,yt){return t.getContext(Ge,yt)}try{const Ge={alpha:!0,depth:i,stencil:s,antialias:l,premultipliedAlpha:o,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:m};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${kT}`),t.addEventListener("webglcontextlost",Kt,!1),t.addEventListener("webglcontextrestored",un,!1),t.addEventListener("webglcontextcreationerror",En,!1),qe===null){const yt="webgl2";if(qe=mn(yt,Ge),qe===null)throw mn(yt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ge){throw console.error("THREE.WebGLRenderer: "+Ge.message),Ge}let cn,St,Jt,kn,Gn,sn,at,Ue,$t,An,Sn,jt,mr,Un,tr,Sr,Ln,ir,ui,Fr,or,Nr,Hr,yi;function Fe(){cn=new jye(qe),cn.init(),Nr=new Kte(qe,cn),St=new Nye(qe,cn,e,Nr),Jt=new wxe(qe),kn=new $ye(qe),Gn=new uxe,sn=new Exe(qe,cn,Jt,Gn,St,Nr,kn),at=new Uye(k),Ue=new Hye(k),$t=new eve(qe),Hr=new Oye(qe,$t),An=new Wye(qe,$t,kn,Hr),Sn=new Zye(qe,An,$t,kn),ui=new qye(qe,St,sn),Sr=new zye(Gn),jt=new cxe(k,at,Ue,cn,St,Hr,Sr),mr=new kxe(k,Gn),Un=new fxe,tr=new _xe(cn),ir=new kye(k,at,Ue,Jt,Sn,v,o),Ln=new bxe(k,Sn,St),yi=new Oxe(qe,kn,St,Jt),Fr=new Fye(qe,cn,kn),or=new Xye(qe,cn,kn),kn.programs=jt.programs,k.capabilities=St,k.extensions=cn,k.properties=Gn,k.renderLists=Un,k.shadowMap=Ln,k.state=Jt,k.info=kn}Fe();const Lt=new Dxe(k,qe);this.xr=Lt,this.getContext=function(){return qe},this.getContextAttributes=function(){return qe.getContextAttributes()},this.forceContextLoss=function(){const Ge=cn.get("WEBGL_lose_context");Ge&&Ge.loseContext()},this.forceContextRestore=function(){const Ge=cn.get("WEBGL_lose_context");Ge&&Ge.restoreContext()},this.getPixelRatio=function(){return ot},this.setPixelRatio=function(Ge){Ge!==void 0&&(ot=Ge,this.setSize(je,Le,!1))},this.getSize=function(Ge){return Ge.set(je,Le)},this.setSize=function(Ge,yt,Mt=!0){if(Lt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}je=Ge,Le=yt,t.width=Math.floor(Ge*ot),t.height=Math.floor(yt*ot),Mt===!0&&(t.style.width=Ge+"px",t.style.height=yt+"px"),this.setViewport(0,0,Ge,yt)},this.getDrawingBufferSize=function(Ge){return Ge.set(je*ot,Le*ot).floor()},this.setDrawingBufferSize=function(Ge,yt,Mt){je=Ge,Le=yt,ot=Mt,t.width=Math.floor(Ge*Mt),t.height=Math.floor(yt*Mt),this.setViewport(0,0,Ge,yt)},this.getCurrentViewport=function(Ge){return Ge.copy(ae)},this.getViewport=function(Ge){return Ge.copy(Ve)},this.setViewport=function(Ge,yt,Mt,Ct){Ge.isVector4?Ve.set(Ge.x,Ge.y,Ge.z,Ge.w):Ve.set(Ge,yt,Mt,Ct),Jt.viewport(ae.copy(Ve).multiplyScalar(ot).round())},this.getScissor=function(Ge){return Ge.copy(_t)},this.setScissor=function(Ge,yt,Mt,Ct){Ge.isVector4?_t.set(Ge.x,Ge.y,Ge.z,Ge.w):_t.set(Ge,yt,Mt,Ct),Jt.scissor(fe.copy(_t).multiplyScalar(ot).round())},this.getScissorTest=function(){return wt},this.setScissorTest=function(Ge){Jt.setScissorTest(wt=Ge)},this.setOpaqueSort=function(Ge){ye=Ge},this.setTransparentSort=function(Ge){$e=Ge},this.getClearColor=function(Ge){return Ge.copy(ir.getClearColor())},this.setClearColor=function(){ir.setClearColor.apply(ir,arguments)},this.getClearAlpha=function(){return ir.getClearAlpha()},this.setClearAlpha=function(){ir.setClearAlpha.apply(ir,arguments)},this.clear=function(Ge=!0,yt=!0,Mt=!0){let Ct=0;if(Ge){let It=!1;if(ee!==null){const wn=ee.texture.format;It=wn===KL||wn===YL||wn===zT}if(It){const wn=ee.texture.type,_n=wn===Zf||wn===jm||wn===Jb||wn===Yy||wn===qL||wn===ZL,zn=ir.getClearColor(),Xn=ir.getClearAlpha(),lr=zn.r,gr=zn.g,dr=zn.b;_n?(y[0]=lr,y[1]=gr,y[2]=dr,y[3]=Xn,qe.clearBufferuiv(qe.COLOR,0,y)):(S[0]=lr,S[1]=gr,S[2]=dr,S[3]=Xn,qe.clearBufferiv(qe.COLOR,0,S))}else Ct|=qe.COLOR_BUFFER_BIT}yt&&(Ct|=qe.DEPTH_BUFFER_BIT),Mt&&(Ct|=qe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),qe.clear(Ct)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Kt,!1),t.removeEventListener("webglcontextrestored",un,!1),t.removeEventListener("webglcontextcreationerror",En,!1),Un.dispose(),tr.dispose(),Gn.dispose(),at.dispose(),Ue.dispose(),Sn.dispose(),Hr.dispose(),yi.dispose(),jt.dispose(),Lt.dispose(),Lt.removeEventListener("sessionstart",xe),Lt.removeEventListener("sessionend",Ee),Xe.stop()};function Kt(Ge){Ge.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function un(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const Ge=kn.autoReset,yt=Ln.enabled,Mt=Ln.autoUpdate,Ct=Ln.needsUpdate,It=Ln.type;Fe(),kn.autoReset=Ge,Ln.enabled=yt,Ln.autoUpdate=Mt,Ln.needsUpdate=Ct,Ln.type=It}function En(Ge){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ge.statusMessage)}function Ar(Ge){const yt=Ge.target;yt.removeEventListener("dispose",Ar),Vr(yt)}function Vr(Ge){hs(Ge),Gn.remove(Ge)}function hs(Ge){const yt=Gn.get(Ge).programs;yt!==void 0&&(yt.forEach(function(Mt){jt.releaseProgram(Mt)}),Ge.isShaderMaterial&&jt.releaseShaderCache(Ge))}this.renderBufferDirect=function(Ge,yt,Mt,Ct,It,wn){yt===null&&(yt=Bn);const _n=It.isMesh&&It.matrixWorld.determinant()<0,zn=ln(Ge,yt,Mt,Ct,It);Jt.setMaterial(Ct,_n);let Xn=Mt.index,lr=1;if(Ct.wireframe===!0){if(Xn=An.getWireframeAttribute(Mt),Xn===void 0)return;lr=2}const gr=Mt.drawRange,dr=Mt.attributes.position;let fi=gr.start*lr,ki=(gr.start+gr.count)*lr;wn!==null&&(fi=Math.max(fi,wn.start*lr),ki=Math.min(ki,(wn.start+wn.count)*lr)),Xn!==null?(fi=Math.max(fi,0),ki=Math.min(ki,Xn.count)):dr!=null&&(fi=Math.max(fi,0),ki=Math.min(ki,dr.count));const Hi=ki-fi;if(Hi<0||Hi===1/0)return;Hr.setup(It,Ct,zn,Mt,Xn);let Ss,Er=Fr;if(Xn!==null&&(Ss=$t.get(Xn),Er=or,Er.setIndex(Ss)),It.isMesh)Ct.wireframe===!0?(Jt.setLineWidth(Ct.wireframeLinewidth*Pe()),Er.setMode(qe.LINES)):Er.setMode(qe.TRIANGLES);else if(It.isLine){let Qn=Ct.linewidth;Qn===void 0&&(Qn=1),Jt.setLineWidth(Qn*Pe()),It.isLineSegments?Er.setMode(qe.LINES):It.isLineLoop?Er.setMode(qe.LINE_LOOP):Er.setMode(qe.LINE_STRIP)}else It.isPoints?Er.setMode(qe.POINTS):It.isSprite&&Er.setMode(qe.TRIANGLES);if(It.isBatchedMesh)if(It._multiDrawInstances!==null)Er.renderMultiDrawInstances(It._multiDrawStarts,It._multiDrawCounts,It._multiDrawCount,It._multiDrawInstances);else if(cn.get("WEBGL_multi_draw"))Er.renderMultiDraw(It._multiDrawStarts,It._multiDrawCounts,It._multiDrawCount);else{const Qn=It._multiDrawStarts,Zi=It._multiDrawCounts,qr=It._multiDrawCount,_s=Xn?$t.get(Xn).bytesPerElement:1,Xo=Gn.get(Ct).currentProgram.getUniforms();for(let Ls=0;Ls<qr;Ls++)Xo.setValue(qe,"_gl_DrawID",Ls),Er.render(Qn[Ls]/_s,Zi[Ls])}else if(It.isInstancedMesh)Er.renderInstances(fi,Hi,It.count);else if(Mt.isInstancedBufferGeometry){const Qn=Mt._maxInstanceCount!==void 0?Mt._maxInstanceCount:1/0,Zi=Math.min(Mt.instanceCount,Qn);Er.renderInstances(fi,Hi,Zi)}else Er.render(fi,Hi)};function Ps(Ge,yt,Mt){Ge.transparent===!0&&Ge.side===wc&&Ge.forceSinglePass===!1?(Ge.side=Cc,Ge.needsUpdate=!0,Pt(Ge,yt,Mt),Ge.side=Dh,Ge.needsUpdate=!0,Pt(Ge,yt,Mt),Ge.side=wc):Pt(Ge,yt,Mt)}this.compile=function(Ge,yt,Mt=null){Mt===null&&(Mt=Ge),M=tr.get(Mt),M.init(yt),L.push(M),Mt.traverseVisible(function(It){It.isLight&&It.layers.test(yt.layers)&&(M.pushLight(It),It.castShadow&&M.pushShadow(It))}),Ge!==Mt&&Ge.traverseVisible(function(It){It.isLight&&It.layers.test(yt.layers)&&(M.pushLight(It),It.castShadow&&M.pushShadow(It))}),M.setupLights();const Ct=new Set;return Ge.traverse(function(It){const wn=It.material;if(wn)if(Array.isArray(wn))for(let _n=0;_n<wn.length;_n++){const zn=wn[_n];Ps(zn,Mt,It),Ct.add(zn)}else Ps(wn,Mt,It),Ct.add(wn)}),L.pop(),M=null,Ct},this.compileAsync=function(Ge,yt,Mt=null){const Ct=this.compile(Ge,yt,Mt);return new Promise(It=>{function wn(){if(Ct.forEach(function(_n){Gn.get(_n).currentProgram.isReady()&&Ct.delete(_n)}),Ct.size===0){It(Ge);return}setTimeout(wn,10)}cn.get("KHR_parallel_shader_compile")!==null?wn():setTimeout(wn,10)})};let hi=null;function Tt(Ge){hi&&hi(Ge)}function xe(){Xe.stop()}function Ee(){Xe.start()}const Xe=new Xte;Xe.setAnimationLoop(Tt),typeof self<"u"&&Xe.setContext(self),this.setAnimationLoop=function(Ge){hi=Ge,Lt.setAnimationLoop(Ge),Ge===null?Xe.stop():Xe.start()},Lt.addEventListener("sessionstart",xe),Lt.addEventListener("sessionend",Ee),this.render=function(Ge,yt){if(yt!==void 0&&yt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;if(Ge.matrixWorldAutoUpdate===!0&&Ge.updateMatrixWorld(),yt.parent===null&&yt.matrixWorldAutoUpdate===!0&&yt.updateMatrixWorld(),Lt.enabled===!0&&Lt.isPresenting===!0&&(Lt.cameraAutoUpdate===!0&&Lt.updateCamera(yt),yt=Lt.getCamera()),Ge.isScene===!0&&Ge.onBeforeRender(k,Ge,yt,ee),M=tr.get(Ge,L.length),M.init(yt),L.push(M),Qt.multiplyMatrices(yt.projectionMatrix,yt.matrixWorldInverse),Vt.setFromProjectionMatrix(Qt),Ht=this.localClippingEnabled,lt=Sr.init(this.clippingPlanes,Ht),E=Un.get(Ge,C.length),E.init(),C.push(E),Lt.enabled===!0&&Lt.isPresenting===!0){const wn=k.xr.getDepthSensingMesh();wn!==null&&nt(wn,yt,-1/0,k.sortObjects)}nt(Ge,yt,0,k.sortObjects),E.finish(),k.sortObjects===!0&&E.sort(ye,$e),Tn=Lt.enabled===!1||Lt.isPresenting===!1||Lt.hasDepthSensing()===!1,Tn&&ir.addToRenderList(E,Ge),this.info.render.frame++,lt===!0&&Sr.beginShadows();const Mt=M.state.shadowsArray;Ln.render(Mt,Ge,yt),lt===!0&&Sr.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ct=E.opaque,It=E.transmissive;if(M.setupLights(),yt.isArrayCamera){const wn=yt.cameras;if(It.length>0)for(let _n=0,zn=wn.length;_n<zn;_n++){const Xn=wn[_n];pt(Ct,It,Ge,Xn)}Tn&&ir.render(Ge);for(let _n=0,zn=wn.length;_n<zn;_n++){const Xn=wn[_n];Je(E,Ge,Xn,Xn.viewport)}}else It.length>0&&pt(Ct,It,Ge,yt),Tn&&ir.render(Ge),Je(E,Ge,yt);ee!==null&&(sn.updateMultisampleRenderTarget(ee),sn.updateRenderTargetMipmap(ee)),Ge.isScene===!0&&Ge.onAfterRender(k,Ge,yt),Hr.resetDefaultState(),re=-1,se=null,L.pop(),L.length>0?(M=L[L.length-1],lt===!0&&Sr.setGlobalState(k.clippingPlanes,M.state.camera)):M=null,C.pop(),C.length>0?E=C[C.length-1]:E=null};function nt(Ge,yt,Mt,Ct){if(Ge.visible===!1)return;if(Ge.layers.test(yt.layers)){if(Ge.isGroup)Mt=Ge.renderOrder;else if(Ge.isLOD)Ge.autoUpdate===!0&&Ge.update(yt);else if(Ge.isLight)M.pushLight(Ge),Ge.castShadow&&M.pushShadow(Ge);else if(Ge.isSprite){if(!Ge.frustumCulled||Vt.intersectsSprite(Ge)){Ct&&jn.setFromMatrixPosition(Ge.matrixWorld).applyMatrix4(Qt);const _n=Sn.update(Ge),zn=Ge.material;zn.visible&&E.push(Ge,_n,zn,Mt,jn.z,null)}}else if((Ge.isMesh||Ge.isLine||Ge.isPoints)&&(!Ge.frustumCulled||Vt.intersectsObject(Ge))){const _n=Sn.update(Ge),zn=Ge.material;if(Ct&&(Ge.boundingSphere!==void 0?(Ge.boundingSphere===null&&Ge.computeBoundingSphere(),jn.copy(Ge.boundingSphere.center)):(_n.boundingSphere===null&&_n.computeBoundingSphere(),jn.copy(_n.boundingSphere.center)),jn.applyMatrix4(Ge.matrixWorld).applyMatrix4(Qt)),Array.isArray(zn)){const Xn=_n.groups;for(let lr=0,gr=Xn.length;lr<gr;lr++){const dr=Xn[lr],fi=zn[dr.materialIndex];fi&&fi.visible&&E.push(Ge,_n,fi,Mt,jn.z,dr)}}else zn.visible&&E.push(Ge,_n,zn,Mt,jn.z,null)}}const wn=Ge.children;for(let _n=0,zn=wn.length;_n<zn;_n++)nt(wn[_n],yt,Mt,Ct)}function Je(Ge,yt,Mt,Ct){const It=Ge.opaque,wn=Ge.transmissive,_n=Ge.transparent;M.setupLightsView(Mt),lt===!0&&Sr.setGlobalState(k.clippingPlanes,Mt),Ct&&Jt.viewport(ae.copy(Ct)),It.length>0&&Rt(It,yt,Mt),wn.length>0&&Rt(wn,yt,Mt),_n.length>0&&Rt(_n,yt,Mt),Jt.buffers.depth.setTest(!0),Jt.buffers.depth.setMask(!0),Jt.buffers.color.setMask(!0),Jt.setPolygonOffset(!1)}function pt(Ge,yt,Mt,Ct){if((Mt.isScene===!0?Mt.overrideMaterial:null)!==null)return;M.state.transmissionRenderTarget[Ct.id]===void 0&&(M.state.transmissionRenderTarget[Ct.id]=new wl(1,1,{generateMipmaps:!0,type:cn.has("EXT_color_buffer_half_float")||cn.has("EXT_color_buffer_float")?Ch:Zf,minFilter:ou,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ms.workingColorSpace}));const wn=M.state.transmissionRenderTarget[Ct.id],_n=Ct.viewport||ae;wn.setSize(_n.z,_n.w);const zn=k.getRenderTarget();k.setRenderTarget(wn),k.getClearColor(Ce),Ie=k.getClearAlpha(),Ie<1&&k.setClearColor(16777215,.5),Tn?ir.render(Mt):k.clear();const Xn=k.toneMapping;k.toneMapping=ap;const lr=Ct.viewport;if(Ct.viewport!==void 0&&(Ct.viewport=void 0),M.setupLightsView(Ct),lt===!0&&Sr.setGlobalState(k.clippingPlanes,Ct),Rt(Ge,Mt,Ct),sn.updateMultisampleRenderTarget(wn),sn.updateRenderTargetMipmap(wn),cn.has("WEBGL_multisampled_render_to_texture")===!1){let gr=!1;for(let dr=0,fi=yt.length;dr<fi;dr++){const ki=yt[dr],Hi=ki.object,Ss=ki.geometry,Er=ki.material,Qn=ki.group;if(Er.side===wc&&Hi.layers.test(Ct.layers)){const Zi=Er.side;Er.side=Cc,Er.needsUpdate=!0,gt(Hi,Mt,Ct,Ss,Er,Qn),Er.side=Zi,Er.needsUpdate=!0,gr=!0}}gr===!0&&(sn.updateMultisampleRenderTarget(wn),sn.updateRenderTargetMipmap(wn))}k.setRenderTarget(zn),k.setClearColor(Ce,Ie),lr!==void 0&&(Ct.viewport=lr),k.toneMapping=Xn}function Rt(Ge,yt,Mt){const Ct=yt.isScene===!0?yt.overrideMaterial:null;for(let It=0,wn=Ge.length;It<wn;It++){const _n=Ge[It],zn=_n.object,Xn=_n.geometry,lr=Ct===null?_n.material:Ct,gr=_n.group;zn.layers.test(Mt.layers)&&gt(zn,yt,Mt,Xn,lr,gr)}}function gt(Ge,yt,Mt,Ct,It,wn){Ge.onBeforeRender(k,yt,Mt,Ct,It,wn),Ge.modelViewMatrix.multiplyMatrices(Mt.matrixWorldInverse,Ge.matrixWorld),Ge.normalMatrix.getNormalMatrix(Ge.modelViewMatrix),It.transparent===!0&&It.side===wc&&It.forceSinglePass===!1?(It.side=Cc,It.needsUpdate=!0,k.renderBufferDirect(Mt,yt,Ct,It,Ge,wn),It.side=Dh,It.needsUpdate=!0,k.renderBufferDirect(Mt,yt,Ct,It,Ge,wn),It.side=wc):k.renderBufferDirect(Mt,yt,Ct,It,Ge,wn),Ge.onAfterRender(k,yt,Mt,Ct,It,wn)}function Pt(Ge,yt,Mt){yt.isScene!==!0&&(yt=Bn);const Ct=Gn.get(Ge),It=M.state.lights,wn=M.state.shadowsArray,_n=It.state.version,zn=jt.getParameters(Ge,It.state,wn,yt,Mt),Xn=jt.getProgramCacheKey(zn);let lr=Ct.programs;Ct.environment=Ge.isMeshStandardMaterial?yt.environment:null,Ct.fog=yt.fog,Ct.envMap=(Ge.isMeshStandardMaterial?Ue:at).get(Ge.envMap||Ct.environment),Ct.envMapRotation=Ct.environment!==null&&Ge.envMap===null?yt.environmentRotation:Ge.envMapRotation,lr===void 0&&(Ge.addEventListener("dispose",Ar),lr=new Map,Ct.programs=lr);let gr=lr.get(Xn);if(gr!==void 0){if(Ct.currentProgram===gr&&Ct.lightsStateVersion===_n)return Bt(Ge,zn),gr}else zn.uniforms=jt.getUniforms(Ge),Ge.onBeforeCompile(zn,k),gr=jt.acquireProgram(zn,Xn),lr.set(Xn,gr),Ct.uniforms=zn.uniforms;const dr=Ct.uniforms;return(!Ge.isShaderMaterial&&!Ge.isRawShaderMaterial||Ge.clipping===!0)&&(dr.clippingPlanes=Sr.uniform),Bt(Ge,zn),Ct.needsLights=Cn(Ge),Ct.lightsStateVersion=_n,Ct.needsLights&&(dr.ambientLightColor.value=It.state.ambient,dr.lightProbe.value=It.state.probe,dr.directionalLights.value=It.state.directional,dr.directionalLightShadows.value=It.state.directionalShadow,dr.spotLights.value=It.state.spot,dr.spotLightShadows.value=It.state.spotShadow,dr.rectAreaLights.value=It.state.rectArea,dr.ltc_1.value=It.state.rectAreaLTC1,dr.ltc_2.value=It.state.rectAreaLTC2,dr.pointLights.value=It.state.point,dr.pointLightShadows.value=It.state.pointShadow,dr.hemisphereLights.value=It.state.hemi,dr.directionalShadowMap.value=It.state.directionalShadowMap,dr.directionalShadowMatrix.value=It.state.directionalShadowMatrix,dr.spotShadowMap.value=It.state.spotShadowMap,dr.spotLightMatrix.value=It.state.spotLightMatrix,dr.spotLightMap.value=It.state.spotLightMap,dr.pointShadowMap.value=It.state.pointShadowMap,dr.pointShadowMatrix.value=It.state.pointShadowMatrix),Ct.currentProgram=gr,Ct.uniformsList=null,gr}function zt(Ge){if(Ge.uniformsList===null){const yt=Ge.currentProgram.getUniforms();Ge.uniformsList=XI.seqWithValue(yt.seq,Ge.uniforms)}return Ge.uniformsList}function Bt(Ge,yt){const Mt=Gn.get(Ge);Mt.outputColorSpace=yt.outputColorSpace,Mt.batching=yt.batching,Mt.batchingColor=yt.batchingColor,Mt.instancing=yt.instancing,Mt.instancingColor=yt.instancingColor,Mt.instancingMorph=yt.instancingMorph,Mt.skinning=yt.skinning,Mt.morphTargets=yt.morphTargets,Mt.morphNormals=yt.morphNormals,Mt.morphColors=yt.morphColors,Mt.morphTargetsCount=yt.morphTargetsCount,Mt.numClippingPlanes=yt.numClippingPlanes,Mt.numIntersection=yt.numClipIntersection,Mt.vertexAlphas=yt.vertexAlphas,Mt.vertexTangents=yt.vertexTangents,Mt.toneMapping=yt.toneMapping}function ln(Ge,yt,Mt,Ct,It){yt.isScene!==!0&&(yt=Bn),sn.resetTextureUnits();const wn=yt.fog,_n=Ct.isMeshStandardMaterial?yt.environment:null,zn=ee===null?k.outputColorSpace:ee.isXRRenderTarget===!0?ee.texture.colorSpace:Ha,Xn=(Ct.isMeshStandardMaterial?Ue:at).get(Ct.envMap||_n),lr=Ct.vertexColors===!0&&!!Mt.attributes.color&&Mt.attributes.color.itemSize===4,gr=!!Mt.attributes.tangent&&(!!Ct.normalMap||Ct.anisotropy>0),dr=!!Mt.morphAttributes.position,fi=!!Mt.morphAttributes.normal,ki=!!Mt.morphAttributes.color;let Hi=ap;Ct.toneMapped&&(ee===null||ee.isXRRenderTarget===!0)&&(Hi=k.toneMapping);const Ss=Mt.morphAttributes.position||Mt.morphAttributes.normal||Mt.morphAttributes.color,Er=Ss!==void 0?Ss.length:0,Qn=Gn.get(Ct),Zi=M.state.lights;if(lt===!0&&(Ht===!0||Ge!==se)){const As=Ge===se&&Ct.id===re;Sr.setState(Ct,Ge,As)}let qr=!1;Ct.version===Qn.__version?(Qn.needsLights&&Qn.lightsStateVersion!==Zi.state.version||Qn.outputColorSpace!==zn||It.isBatchedMesh&&Qn.batching===!1||!It.isBatchedMesh&&Qn.batching===!0||It.isBatchedMesh&&Qn.batchingColor===!0&&It.colorTexture===null||It.isBatchedMesh&&Qn.batchingColor===!1&&It.colorTexture!==null||It.isInstancedMesh&&Qn.instancing===!1||!It.isInstancedMesh&&Qn.instancing===!0||It.isSkinnedMesh&&Qn.skinning===!1||!It.isSkinnedMesh&&Qn.skinning===!0||It.isInstancedMesh&&Qn.instancingColor===!0&&It.instanceColor===null||It.isInstancedMesh&&Qn.instancingColor===!1&&It.instanceColor!==null||It.isInstancedMesh&&Qn.instancingMorph===!0&&It.morphTexture===null||It.isInstancedMesh&&Qn.instancingMorph===!1&&It.morphTexture!==null||Qn.envMap!==Xn||Ct.fog===!0&&Qn.fog!==wn||Qn.numClippingPlanes!==void 0&&(Qn.numClippingPlanes!==Sr.numPlanes||Qn.numIntersection!==Sr.numIntersection)||Qn.vertexAlphas!==lr||Qn.vertexTangents!==gr||Qn.morphTargets!==dr||Qn.morphNormals!==fi||Qn.morphColors!==ki||Qn.toneMapping!==Hi||Qn.morphTargetsCount!==Er)&&(qr=!0):(qr=!0,Qn.__version=Ct.version);let _s=Qn.currentProgram;qr===!0&&(_s=Pt(Ct,yt,It));let Xo=!1,Ls=!1,fs=!1;const Pi=_s.getUniforms(),oo=Qn.uniforms;if(Jt.useProgram(_s.program)&&(Xo=!0,Ls=!0,fs=!0),Ct.id!==re&&(re=Ct.id,Ls=!0),Xo||se!==Ge){Pi.setValue(qe,"projectionMatrix",Ge.projectionMatrix),Pi.setValue(qe,"viewMatrix",Ge.matrixWorldInverse);const As=Pi.map.cameraPosition;As!==void 0&&As.setValue(qe,rn.setFromMatrixPosition(Ge.matrixWorld)),St.logarithmicDepthBuffer&&Pi.setValue(qe,"logDepthBufFC",2/(Math.log(Ge.far+1)/Math.LN2)),(Ct.isMeshPhongMaterial||Ct.isMeshToonMaterial||Ct.isMeshLambertMaterial||Ct.isMeshBasicMaterial||Ct.isMeshStandardMaterial||Ct.isShaderMaterial)&&Pi.setValue(qe,"isOrthographic",Ge.isOrthographicCamera===!0),se!==Ge&&(se=Ge,Ls=!0,fs=!0)}if(It.isSkinnedMesh){Pi.setOptional(qe,It,"bindMatrix"),Pi.setOptional(qe,It,"bindMatrixInverse");const As=It.skeleton;As&&(As.boneTexture===null&&As.computeBoneTexture(),Pi.setValue(qe,"boneTexture",As.boneTexture,sn))}It.isBatchedMesh&&(Pi.setOptional(qe,It,"batchingTexture"),Pi.setValue(qe,"batchingTexture",It._matricesTexture,sn),Pi.setOptional(qe,It,"batchingIdTexture"),Pi.setValue(qe,"batchingIdTexture",It._indirectTexture,sn),Pi.setOptional(qe,It,"batchingColorTexture"),It._colorsTexture!==null&&Pi.setValue(qe,"batchingColorTexture",It._colorsTexture,sn));const Po=Mt.morphAttributes;if((Po.position!==void 0||Po.normal!==void 0||Po.color!==void 0)&&ui.update(It,Mt,_s),(Ls||Qn.receiveShadow!==It.receiveShadow)&&(Qn.receiveShadow=It.receiveShadow,Pi.setValue(qe,"receiveShadow",It.receiveShadow)),Ct.isMeshGouraudMaterial&&Ct.envMap!==null&&(oo.envMap.value=Xn,oo.flipEnvMap.value=Xn.isCubeTexture&&Xn.isRenderTargetTexture===!1?-1:1),Ct.isMeshStandardMaterial&&Ct.envMap===null&&yt.environment!==null&&(oo.envMapIntensity.value=yt.environmentIntensity),Ls&&(Pi.setValue(qe,"toneMappingExposure",k.toneMappingExposure),Qn.needsLights&&Mn(oo,fs),wn&&Ct.fog===!0&&mr.refreshFogUniforms(oo,wn),mr.refreshMaterialUniforms(oo,Ct,ot,Le,M.state.transmissionRenderTarget[Ge.id]),XI.upload(qe,zt(Qn),oo,sn)),Ct.isShaderMaterial&&Ct.uniformsNeedUpdate===!0&&(XI.upload(qe,zt(Qn),oo,sn),Ct.uniformsNeedUpdate=!1),Ct.isSpriteMaterial&&Pi.setValue(qe,"center",It.center),Pi.setValue(qe,"modelViewMatrix",It.modelViewMatrix),Pi.setValue(qe,"normalMatrix",It.normalMatrix),Pi.setValue(qe,"modelMatrix",It.matrixWorld),Ct.isShaderMaterial||Ct.isRawShaderMaterial){const As=Ct.uniformsGroups;for(let Bc=0,Ra=As.length;Bc<Ra;Bc++){const ld=As[Bc];yi.update(ld,_s),yi.bind(ld,_s)}}return _s}function Mn(Ge,yt){Ge.ambientLightColor.needsUpdate=yt,Ge.lightProbe.needsUpdate=yt,Ge.directionalLights.needsUpdate=yt,Ge.directionalLightShadows.needsUpdate=yt,Ge.pointLights.needsUpdate=yt,Ge.pointLightShadows.needsUpdate=yt,Ge.spotLights.needsUpdate=yt,Ge.spotLightShadows.needsUpdate=yt,Ge.rectAreaLights.needsUpdate=yt,Ge.hemisphereLights.needsUpdate=yt}function Cn(Ge){return Ge.isMeshLambertMaterial||Ge.isMeshToonMaterial||Ge.isMeshPhongMaterial||Ge.isMeshStandardMaterial||Ge.isShadowMaterial||Ge.isShaderMaterial&&Ge.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return Z},this.getRenderTarget=function(){return ee},this.setRenderTargetTextures=function(Ge,yt,Mt){Gn.get(Ge.texture).__webglTexture=yt,Gn.get(Ge.depthTexture).__webglTexture=Mt;const Ct=Gn.get(Ge);Ct.__hasExternalTextures=!0,Ct.__autoAllocateDepthBuffer=Mt===void 0,Ct.__autoAllocateDepthBuffer||cn.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ct.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ge,yt){const Mt=Gn.get(Ge);Mt.__webglFramebuffer=yt,Mt.__useDefaultFramebuffer=yt===void 0},this.setRenderTarget=function(Ge,yt=0,Mt=0){ee=Ge,q=yt,Z=Mt;let Ct=!0,It=null,wn=!1,_n=!1;if(Ge){const Xn=Gn.get(Ge);Xn.__useDefaultFramebuffer!==void 0?(Jt.bindFramebuffer(qe.FRAMEBUFFER,null),Ct=!1):Xn.__webglFramebuffer===void 0?sn.setupRenderTarget(Ge):Xn.__hasExternalTextures&&sn.rebindTextures(Ge,Gn.get(Ge.texture).__webglTexture,Gn.get(Ge.depthTexture).__webglTexture);const lr=Ge.texture;(lr.isData3DTexture||lr.isDataArrayTexture||lr.isCompressedArrayTexture)&&(_n=!0);const gr=Gn.get(Ge).__webglFramebuffer;Ge.isWebGLCubeRenderTarget?(Array.isArray(gr[yt])?It=gr[yt][Mt]:It=gr[yt],wn=!0):Ge.samples>0&&sn.useMultisampledRTT(Ge)===!1?It=Gn.get(Ge).__webglMultisampledFramebuffer:Array.isArray(gr)?It=gr[Mt]:It=gr,ae.copy(Ge.viewport),fe.copy(Ge.scissor),Se=Ge.scissorTest}else ae.copy(Ve).multiplyScalar(ot).floor(),fe.copy(_t).multiplyScalar(ot).floor(),Se=wt;if(Jt.bindFramebuffer(qe.FRAMEBUFFER,It)&&Ct&&Jt.drawBuffers(Ge,It),Jt.viewport(ae),Jt.scissor(fe),Jt.setScissorTest(Se),wn){const Xn=Gn.get(Ge.texture);qe.framebufferTexture2D(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_CUBE_MAP_POSITIVE_X+yt,Xn.__webglTexture,Mt)}else if(_n){const Xn=Gn.get(Ge.texture),lr=yt||0;qe.framebufferTextureLayer(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,Xn.__webglTexture,Mt||0,lr)}re=-1},this.readRenderTargetPixels=function(Ge,yt,Mt,Ct,It,wn,_n){if(!(Ge&&Ge.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let zn=Gn.get(Ge).__webglFramebuffer;if(Ge.isWebGLCubeRenderTarget&&_n!==void 0&&(zn=zn[_n]),zn){Jt.bindFramebuffer(qe.FRAMEBUFFER,zn);try{const Xn=Ge.texture,lr=Xn.format,gr=Xn.type;if(!St.textureFormatReadable(lr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!St.textureTypeReadable(gr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}yt>=0&&yt<=Ge.width-Ct&&Mt>=0&&Mt<=Ge.height-It&&qe.readPixels(yt,Mt,Ct,It,Nr.convert(lr),Nr.convert(gr),wn)}finally{const Xn=ee!==null?Gn.get(ee).__webglFramebuffer:null;Jt.bindFramebuffer(qe.FRAMEBUFFER,Xn)}}},this.readRenderTargetPixelsAsync=async function(Ge,yt,Mt,Ct,It,wn,_n){if(!(Ge&&Ge.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let zn=Gn.get(Ge).__webglFramebuffer;if(Ge.isWebGLCubeRenderTarget&&_n!==void 0&&(zn=zn[_n]),zn){Jt.bindFramebuffer(qe.FRAMEBUFFER,zn);try{const Xn=Ge.texture,lr=Xn.format,gr=Xn.type;if(!St.textureFormatReadable(lr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!St.textureTypeReadable(gr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(yt>=0&&yt<=Ge.width-Ct&&Mt>=0&&Mt<=Ge.height-It){const dr=qe.createBuffer();qe.bindBuffer(qe.PIXEL_PACK_BUFFER,dr),qe.bufferData(qe.PIXEL_PACK_BUFFER,wn.byteLength,qe.STREAM_READ),qe.readPixels(yt,Mt,Ct,It,Nr.convert(lr),Nr.convert(gr),0),qe.flush();const fi=qe.fenceSync(qe.SYNC_GPU_COMMANDS_COMPLETE,0);await T0e(qe,fi,4);try{qe.bindBuffer(qe.PIXEL_PACK_BUFFER,dr),qe.getBufferSubData(qe.PIXEL_PACK_BUFFER,0,wn)}finally{qe.deleteBuffer(dr),qe.deleteSync(fi)}return wn}}finally{const Xn=ee!==null?Gn.get(ee).__webglFramebuffer:null;Jt.bindFramebuffer(qe.FRAMEBUFFER,Xn)}}},this.copyFramebufferToTexture=function(Ge,yt=null,Mt=0){Ge.isTexture!==!0&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),yt=arguments[0]||null,Ge=arguments[1]);const Ct=Math.pow(2,-Mt),It=Math.floor(Ge.image.width*Ct),wn=Math.floor(Ge.image.height*Ct),_n=yt!==null?yt.x:0,zn=yt!==null?yt.y:0;sn.setTexture2D(Ge,0),qe.copyTexSubImage2D(qe.TEXTURE_2D,Mt,0,0,_n,zn,It,wn),Jt.unbindTexture()},this.copyTextureToTexture=function(Ge,yt,Mt=null,Ct=null,It=0){Ge.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),Ct=arguments[0]||null,Ge=arguments[1],yt=arguments[2],It=arguments[3]||0,Mt=null);let wn,_n,zn,Xn,lr,gr;Mt!==null?(wn=Mt.max.x-Mt.min.x,_n=Mt.max.y-Mt.min.y,zn=Mt.min.x,Xn=Mt.min.y):(wn=Ge.image.width,_n=Ge.image.height,zn=0,Xn=0),Ct!==null?(lr=Ct.x,gr=Ct.y):(lr=0,gr=0);const dr=Nr.convert(yt.format),fi=Nr.convert(yt.type);sn.setTexture2D(yt,0),qe.pixelStorei(qe.UNPACK_FLIP_Y_WEBGL,yt.flipY),qe.pixelStorei(qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yt.premultiplyAlpha),qe.pixelStorei(qe.UNPACK_ALIGNMENT,yt.unpackAlignment);const ki=qe.getParameter(qe.UNPACK_ROW_LENGTH),Hi=qe.getParameter(qe.UNPACK_IMAGE_HEIGHT),Ss=qe.getParameter(qe.UNPACK_SKIP_PIXELS),Er=qe.getParameter(qe.UNPACK_SKIP_ROWS),Qn=qe.getParameter(qe.UNPACK_SKIP_IMAGES),Zi=Ge.isCompressedTexture?Ge.mipmaps[It]:Ge.image;qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Zi.width),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,Zi.height),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,zn),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,Xn),Ge.isDataTexture?qe.texSubImage2D(qe.TEXTURE_2D,It,lr,gr,wn,_n,dr,fi,Zi.data):Ge.isCompressedTexture?qe.compressedTexSubImage2D(qe.TEXTURE_2D,It,lr,gr,Zi.width,Zi.height,dr,Zi.data):qe.texSubImage2D(qe.TEXTURE_2D,It,lr,gr,wn,_n,dr,fi,Zi),qe.pixelStorei(qe.UNPACK_ROW_LENGTH,ki),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,Hi),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,Ss),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,Er),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,Qn),It===0&&yt.generateMipmaps&&qe.generateMipmap(qe.TEXTURE_2D),Jt.unbindTexture()},this.copyTextureToTexture3D=function(Ge,yt,Mt=null,Ct=null,It=0){Ge.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Mt=arguments[0]||null,Ct=arguments[1]||null,Ge=arguments[2],yt=arguments[3],It=arguments[4]||0);let wn,_n,zn,Xn,lr,gr,dr,fi,ki;const Hi=Ge.isCompressedTexture?Ge.mipmaps[It]:Ge.image;Mt!==null?(wn=Mt.max.x-Mt.min.x,_n=Mt.max.y-Mt.min.y,zn=Mt.max.z-Mt.min.z,Xn=Mt.min.x,lr=Mt.min.y,gr=Mt.min.z):(wn=Hi.width,_n=Hi.height,zn=Hi.depth,Xn=0,lr=0,gr=0),Ct!==null?(dr=Ct.x,fi=Ct.y,ki=Ct.z):(dr=0,fi=0,ki=0);const Ss=Nr.convert(yt.format),Er=Nr.convert(yt.type);let Qn;if(yt.isData3DTexture)sn.setTexture3D(yt,0),Qn=qe.TEXTURE_3D;else if(yt.isDataArrayTexture||yt.isCompressedArrayTexture)sn.setTexture2DArray(yt,0),Qn=qe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}qe.pixelStorei(qe.UNPACK_FLIP_Y_WEBGL,yt.flipY),qe.pixelStorei(qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yt.premultiplyAlpha),qe.pixelStorei(qe.UNPACK_ALIGNMENT,yt.unpackAlignment);const Zi=qe.getParameter(qe.UNPACK_ROW_LENGTH),qr=qe.getParameter(qe.UNPACK_IMAGE_HEIGHT),_s=qe.getParameter(qe.UNPACK_SKIP_PIXELS),Xo=qe.getParameter(qe.UNPACK_SKIP_ROWS),Ls=qe.getParameter(qe.UNPACK_SKIP_IMAGES);qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Hi.width),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,Hi.height),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,Xn),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,lr),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,gr),Ge.isDataTexture||Ge.isData3DTexture?qe.texSubImage3D(Qn,It,dr,fi,ki,wn,_n,zn,Ss,Er,Hi.data):yt.isCompressedArrayTexture?qe.compressedTexSubImage3D(Qn,It,dr,fi,ki,wn,_n,zn,Ss,Hi.data):qe.texSubImage3D(Qn,It,dr,fi,ki,wn,_n,zn,Ss,Er,Hi),qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Zi),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,qr),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,_s),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,Xo),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,Ls),It===0&&yt.generateMipmaps&&qe.generateMipmap(Qn),Jt.unbindTexture()},this.initRenderTarget=function(Ge){Gn.get(Ge).__webglFramebuffer===void 0&&sn.setupRenderTarget(Ge)},this.initTexture=function(Ge){Ge.isCubeTexture?sn.setTextureCube(Ge,0):Ge.isData3DTexture?sn.setTexture3D(Ge,0):Ge.isDataArrayTexture||Ge.isCompressedArrayTexture?sn.setTexture2DArray(Ge,0):sn.setTexture2D(Ge,0),Jt.unbindTexture()},this.resetState=function(){q=0,Z=0,ee=null,Jt.reset(),Hr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Qd}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===QL?"display-p3":"srgb",t.unpackColorSpace=ms.workingColorSpace===GT?"display-p3":"srgb"}}class WT{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Vn(e),this.density=t}clone(){return new WT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class yw{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Vn(e),this.near=t,this.far=r}clone(){return new yw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Tl extends Ri{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new zu,this.environmentIntensity=1,this.environmentRotation=new zu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class xw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=qA,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ku()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return U6("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ku()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ku()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const mc=new Ze;class Xm{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)mc.fromBufferAttribute(this,t),mc.applyMatrix4(e),this.setXYZ(t,mc.x,mc.y,mc.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)mc.fromBufferAttribute(this,t),mc.applyNormalMatrix(e),this.setXYZ(t,mc.x,mc.y,mc.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)mc.fromBufferAttribute(this,t),mc.transformDirection(e),this.setXYZ(t,mc.x,mc.y,mc.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Sc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Si(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Si(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Si(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Si(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Si(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Sc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Sc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Sc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Sc(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Si(t,this.array),r=Si(r,this.array),i=Si(i,this.array),s=Si(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Bi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Xm(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class nD extends yo{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let yx;const E2=new Ze,xx=new Ze,bx=new Ze,Sx=new nn,I2=new nn,Qte=new Gr,qC=new Ze,R2=new Ze,ZC=new Ze,Qj=new nn,B5=new nn,eW=new nn;class q6 extends Ri{constructor(e=new nD){if(super(),this.isSprite=!0,this.type="Sprite",yx===void 0){yx=new $r;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new xw(t,5);yx.setIndex([0,1,2,0,2,3]),yx.setAttribute("position",new Xm(r,3,0,!1)),yx.setAttribute("uv",new Xm(r,2,3,!1))}this.geometry=yx,this.material=e,this.center=new nn(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),xx.setFromMatrixScale(this.matrixWorld),Qte.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),bx.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&xx.multiplyScalar(-bx.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;YC(qC.set(-.5,-.5,0),bx,a,xx,i,s),YC(R2.set(.5,-.5,0),bx,a,xx,i,s),YC(ZC.set(.5,.5,0),bx,a,xx,i,s),Qj.set(0,0),B5.set(1,0),eW.set(1,1);let l=e.ray.intersectTriangle(qC,R2,ZC,!1,E2);if(l===null&&(YC(R2.set(-.5,.5,0),bx,a,xx,i,s),B5.set(0,1),l=e.ray.intersectTriangle(qC,ZC,R2,!1,E2),l===null))return;const o=e.ray.origin.distanceTo(E2);o<e.near||o>e.far||t.push({distance:o,point:E2.clone(),uv:H0.getInterpolation(E2,qC,R2,ZC,Qj,B5,eW,new nn),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function YC(n,e,t,r,i,s){Sx.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(I2.x=s*Sx.x-i*Sx.y,I2.y=i*Sx.x+s*Sx.y):I2.copy(Sx),n.copy(e),n.x+=I2.x,n.y+=I2.y,n.applyMatrix4(Qte)}const KC=new Ze,tW=new Ze;class ene extends Ri{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){KC.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(KC);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){KC.setFromMatrixPosition(e.matrixWorld),tW.setFromMatrixPosition(this.matrixWorld);const r=KC.distanceTo(tW)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),r>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const nW=new Ze,rW=new Is,iW=new Is,Fxe=new Ze,sW=new Gr,JC=new Ze,k5=new il,oW=new Gr,O5=new g1;class rD extends Ii{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=vF,this.bindMatrix=new Gr,this.bindMatrixInverse=new Gr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Sl),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,JC),this.boundingBox.expandByPoint(JC)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new il),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,JC),this.boundingSphere.expandByPoint(JC)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),k5.copy(this.boundingSphere),k5.applyMatrix4(i),e.ray.intersectsSphere(k5)!==!1&&(oW.copy(i).invert(),O5.copy(e.ray).applyMatrix4(oW),!(this.boundingBox!==null&&O5.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,O5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Is,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===vF?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ate?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;rW.fromBufferAttribute(i.attributes.skinIndex,e),iW.fromBufferAttribute(i.attributes.skinWeight,e),nW.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=iW.getComponent(s);if(a!==0){const l=rW.getComponent(s);sW.multiplyMatrices(r.bones[l].matrixWorld,r.boneInverses[l]),t.addScaledVector(Fxe.copy(nW).applyMatrix4(sW),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class XT extends Ri{constructor(){super(),this.isBone=!0,this.type="Bone"}}class $f extends Xs{constructor(e=null,t=1,r=1,i,s,a,l,o,h=Sa,d=Sa,m,v){super(null,a,l,o,h,d,i,s,m,v),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const aW=new Gr,Nxe=new Gr;class bw{constructor(e=[],t=[]){this.uuid=ku(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Gr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Gr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const l=e[s]?e[s].matrixWorld:Nxe;aW.multiplyMatrices(l,t[s]),aW.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new bw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new $f(t,e,e,Wl,Ac);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new XT),this.bones.push(a),this.boneInverses.push(new Gr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const l=r[i];e.boneInverses.push(l.toArray())}return e}}class fv extends Bi{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ax=new Gr,lW=new Gr,QC=[],cW=new Sl,zxe=new Gr,P2=new Ii,L2=new il;class iD extends Ii{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new fv(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,zxe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Sl),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Ax),cW.copy(e.boundingBox).applyMatrix4(Ax),this.boundingBox.union(cW)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new il),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Ax),L2.copy(e.boundingSphere).applyMatrix4(Ax),this.boundingSphere.union(L2)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,a=e*s+1;for(let l=0;l<r.length;l++)r[l]=i[a+l]}raycast(e,t){const r=this.matrixWorld,i=this.count;if(P2.geometry=this.geometry,P2.material=this.material,P2.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),L2.copy(this.boundingSphere),L2.applyMatrix4(r),e.ray.intersectsSphere(L2)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,Ax),lW.multiplyMatrices(r,Ax),P2.matrixWorld=lW,P2.raycast(e,QC);for(let a=0,l=QC.length;a<l;a++){const o=QC[a];o.instanceId=s,o.object=this,t.push(o)}QC.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new fv(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new $f(new Float32Array(i*this.count),i,this.count,NT,Ac));const s=this.morphTexture.source.data.data;let a=0;for(let h=0;h<r.length;h++)a+=r[h];const l=this.geometry.morphTargetsRelative?1:1-a,o=i*e;s[o]=l,s.set(r,o+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function Uxe(n,e){return n.z-e.z}function Gxe(n,e){return e.z-n.z}class Vxe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r){const i=this.pool,s=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const a=i[this.index];s.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=t,a.index=r}reset(){this.list.length=0,this.index=0}}const d0=new Gr,F5=new Gr,Hxe=new Gr,jxe=new Vn(1,1,1),uW=new Gr,N5=new jT,eE=new Sl,T_=new il,D2=new Ze,hW=new Ze,Wxe=new Ze,z5=new Vxe,Ol=new Ii,tE=[];function Xxe(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let a=0;a<r;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class tne extends Ii{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,r=t*2,i){super(new $r,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new $f(t,e,e,Wl,Ac);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new $f(t,e,e,zT,jm);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxIndexCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new $f(t,e,e,Wl,Ac);r.colorSpace=ms.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:l,itemSize:o,normalized:h}=a,d=new l.constructor(r*o),m=new Bi(d,o,h);t.setAttribute(s,m)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Bi(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Sl);const e=this._geometryCount,t=this.boundingBox,r=this._drawInfo;t.makeEmpty();for(let i=0;i<e;i++){if(r[i].active===!1)continue;const s=r[i].geometryIndex;this.getMatrixAt(i,d0),this.getBoundingBoxAt(s,eE).applyMatrix4(d0),t.union(eE)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new il);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,d0),this.getBoundingSphereAt(s,T_).applyMatrix4(d0),e.union(T_)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,r=this._matricesTexture,i=r.image.data;Hxe.toArray(i,t*16),r.needsUpdate=!0;const s=this._colorsTexture;return s&&(jxe.toArray(s.image.data,t*4),s.needsUpdate=!0),t}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const a=this._reservedRanges,l=this._drawRanges,o=this._bounds;this._geometryCount!==0&&(s=a[a.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const h=e.getIndex(),d=h!==null;if(d&&(r===-1?i.indexCount=h.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const m=this._geometryCount;return this._geometryCount++,a.push(i),l.push({start:d?i.indexStart:i.vertexStart,count:-1}),o.push({boxInitialized:!1,box:new Sl,sphereInitialized:!1,sphere:new il}),this.setGeometryAt(m,e),m}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),a=t.getIndex(),l=this._reservedRanges[e];if(i&&a.count>l.indexCount||t.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const o=l.vertexStart,h=l.vertexCount;for(const y in r.attributes){const S=t.getAttribute(y),E=r.getAttribute(y);Xxe(S,E,o);const M=S.itemSize;for(let C=S.count,L=h;C<L;C++){const k=o+C;for(let H=0;H<M;H++)E.setComponent(k,H,0)}E.needsUpdate=!0,E.addUpdateRange(o*M,h*M)}if(i){const y=l.indexStart;for(let S=0;S<a.count;S++)s.setX(y+S,o+a.getX(S));for(let S=a.count,E=l.indexCount;S<E;S++)s.setX(y+S,o);s.needsUpdate=!0,s.addUpdateRange(y,l.indexCount)}const d=this._bounds[e];t.boundingBox!==null?(d.box.copy(t.boundingBox),d.boxInitialized=!0):d.boxInitialized=!1,t.boundingSphere!==null?(d.sphere.copy(t.boundingSphere),d.sphereInitialized=!0):d.sphereInitialized=!1;const m=this._drawRanges[e],v=t.getAttribute("position");return m.count=i?a.count:v.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],i=r.box,s=this.geometry;if(r.boxInitialized===!1){i.makeEmpty();const a=s.index,l=s.attributes.position,o=this._drawRanges[e];for(let h=o.start,d=o.start+o.count;h<d;h++){let m=h;a&&(m=a.getX(m)),i.expandByPoint(D2.fromBufferAttribute(l,m))}r.boxInitialized=!0}return t.copy(i),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],i=r.sphere,s=this.geometry;if(r.sphereInitialized===!1){i.makeEmpty(),this.getBoundingBoxAt(e,eE),eE.getCenter(i.center);const a=s.index,l=s.attributes.position,o=this._drawRanges[e];let h=0;for(let d=o.start,m=o.start+o.count;d<m;d++){let v=d;a&&(v=a.getX(v)),D2.fromBufferAttribute(l,v),h=Math.max(h,i.center.distanceToSquared(D2))}i.radius=Math.sqrt(h),r.sphereInitialized=!0}return t.copy(i),t}setMatrixAt(e,t){const r=this._drawInfo,i=this._matricesTexture,s=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._drawInfo,i=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?null:t.fromArray(i,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const r=this._colorsTexture,i=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(i,e*4),r.needsUpdate=!0,this)}getColorAt(e,t){const r=this._colorsTexture.image.data,i=this._drawInfo;return e>=i.length||i[e].active===!1?null:t.fromArray(r,e*4)}setVisibleAt(e,t){const r=this._drawInfo;return e>=r.length||r[e].active===!1||r[e].visible===t?this:(r[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}raycast(e,t){const r=this._drawInfo,i=this._drawRanges,s=this.matrixWorld,a=this.geometry;Ol.material=this.material,Ol.geometry.index=a.index,Ol.geometry.attributes=a.attributes,Ol.geometry.boundingBox===null&&(Ol.geometry.boundingBox=new Sl),Ol.geometry.boundingSphere===null&&(Ol.geometry.boundingSphere=new il);for(let l=0,o=r.length;l<o;l++){if(!r[l].visible||!r[l].active)continue;const h=r[l].geometryIndex,d=i[h];Ol.geometry.setDrawRange(d.start,d.count),this.getMatrixAt(l,Ol.matrixWorld).premultiply(s),this.getBoundingBoxAt(h,Ol.geometry.boundingBox),this.getBoundingSphereAt(h,Ol.geometry.boundingSphere),Ol.raycast(e,tE);for(let m=0,v=tE.length;m<v;m++){const y=tE[m];y.object=this,y.batchId=l,t.push(y)}tE.length=0}Ol.material=null,Ol.geometry.index=null,Ol.geometry.attributes={},Ol.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),l=a===null?1:a.array.BYTES_PER_ELEMENT,o=this._drawInfo,h=this._multiDrawStarts,d=this._multiDrawCounts,m=this._drawRanges,v=this.perObjectFrustumCulled,y=this._indirectTexture,S=y.image.data;v&&(uW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),N5.setFromProjectionMatrix(uW,e.coordinateSystem));let E=0;if(this.sortObjects){F5.copy(this.matrixWorld).invert(),D2.setFromMatrixPosition(r.matrixWorld).applyMatrix4(F5),hW.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(F5);for(let L=0,k=o.length;L<k;L++)if(o[L].visible&&o[L].active){const H=o[L].geometryIndex;this.getMatrixAt(L,d0),this.getBoundingSphereAt(H,T_).applyMatrix4(d0);let q=!1;if(v&&(q=!N5.intersectsSphere(T_)),!q){const Z=Wxe.subVectors(T_.center,D2).dot(hW);z5.push(m[H],Z,L)}}const M=z5.list,C=this.customSort;C===null?M.sort(s.transparent?Gxe:Uxe):C.call(this,M,r);for(let L=0,k=M.length;L<k;L++){const H=M[L];h[E]=H.start*l,d[E]=H.count,S[E]=H.index,E++}z5.reset()}else for(let M=0,C=o.length;M<C;M++)if(o[M].visible&&o[M].active){const L=o[M].geometryIndex;let k=!1;if(v&&(this.getMatrixAt(M,d0),this.getBoundingSphereAt(L,T_).applyMatrix4(d0),k=!N5.intersectsSphere(T_)),!k){const H=m[L];h[E]=H.start*l,d[E]=H.count,S[E]=M,E++}}y.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class Ma extends yo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Vn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const mP=new Ze,gP=new Ze,fW=new Gr,B2=new g1,nE=new il,U5=new Ze,dW=new Ze;let Yf=class extends Ri{constructor(e=new $r,t=new Ma){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)mP.fromBufferAttribute(t,i-1),gP.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=mP.distanceTo(gP);e.setAttribute("lineDistance",new ar(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),nE.copy(r.boundingSphere),nE.applyMatrix4(i),nE.radius+=s,e.ray.intersectsSphere(nE)===!1)return;fW.copy(i).invert(),B2.copy(e.ray).applyMatrix4(fW);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),o=l*l,h=this.isLineSegments?2:1,d=r.index,v=r.attributes.position;if(d!==null){const y=Math.max(0,a.start),S=Math.min(d.count,a.start+a.count);for(let E=y,M=S-1;E<M;E+=h){const C=d.getX(E),L=d.getX(E+1),k=rE(this,e,B2,o,C,L);k&&t.push(k)}if(this.isLineLoop){const E=d.getX(S-1),M=d.getX(y),C=rE(this,e,B2,o,E,M);C&&t.push(C)}}else{const y=Math.max(0,a.start),S=Math.min(v.count,a.start+a.count);for(let E=y,M=S-1;E<M;E+=h){const C=rE(this,e,B2,o,E,E+1);C&&t.push(C)}if(this.isLineLoop){const E=rE(this,e,B2,o,S-1,y);E&&t.push(E)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}};function rE(n,e,t,r,i,s){const a=n.geometry.attributes.position;if(mP.fromBufferAttribute(a,i),gP.fromBufferAttribute(a,s),t.distanceSqToSegment(mP,gP,U5,dW)>r)return;U5.applyMatrix4(n.matrixWorld);const o=e.ray.origin.distanceTo(U5);if(!(o<e.near||o>e.far))return{distance:o,point:dW.clone().applyMatrix4(n.matrixWorld),index:i,face:null,faceIndex:null,object:n}}const pW=new Ze,mW=new Ze;class fu extends Yf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)pW.fromBufferAttribute(t,i),mW.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+pW.distanceTo(mW);e.setAttribute("lineDistance",new ar(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class sD extends Yf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class au extends yo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const gW=new Gr,SF=new g1,iE=new il,sE=new Ze;class Th extends Ri{constructor(e=new $r,t=new au){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),iE.copy(r.boundingSphere),iE.applyMatrix4(i),iE.radius+=s,e.ray.intersectsSphere(iE)===!1)return;gW.copy(i).invert(),SF.copy(e.ray).applyMatrix4(gW);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),o=l*l,h=r.index,m=r.attributes.position;if(h!==null){const v=Math.max(0,a.start),y=Math.min(h.count,a.start+a.count);for(let S=v,E=y;S<E;S++){const M=h.getX(S);sE.fromBufferAttribute(m,M),vW(sE,M,o,i,e,t,this)}}else{const v=Math.max(0,a.start),y=Math.min(m.count,a.start+a.count);for(let S=v,E=y;S<E;S++)sE.fromBufferAttribute(m,S),vW(sE,S,o,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function vW(n,e,t,r,i,s,a){const l=SF.distanceSqToPoint(n);if(l<t){const o=new Ze;SF.closestPointToPoint(n,o),o.applyMatrix4(r);const h=i.ray.origin.distanceTo(o);if(h<i.near||h>i.far)return;s.push({distance:h,distanceToRay:Math.sqrt(l),point:o,index:e,face:null,object:a})}}class nne extends Xs{constructor(e,t,r,i,s,a,l,o,h){super(e,t,r,i,s,a,l,o,h),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:Eo,this.magFilter=s!==void 0?s:Eo,this.generateMipmaps=!1;const d=this;function m(){d.needsUpdate=!0,e.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(m)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class $xe extends Xs{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Sa,this.minFilter=Sa,this.generateMipmaps=!1,this.needsUpdate=!0}}class oD extends Xs{constructor(e,t,r,i,s,a,l,o,h,d,m,v){super(null,a,l,o,h,d,i,s,m,v),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qxe extends oD{constructor(e,t,r,i,s,a){super(e,t,r,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=su,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Zxe extends oD{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,Hm),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class AF extends Xs{constructor(e,t,r,i,s,a,l,o,h){super(e,t,r,i,s,a,l,o,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class td{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let a;t?a=t:a=e*r[s-1];let l=0,o=s-1,h;for(;l<=o;)if(i=Math.floor(l+(o-l)/2),h=r[i]-a,h<0)l=i+1;else if(h>0)o=i-1;else{o=i;break}if(i=o,r[i]===a)return i/(s-1);const d=r[i],v=r[i+1]-d,y=(a-d)/v;return(i+y)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),l=this.getPoint(s),o=t||(a.isVector2?new nn:new Ze);return o.copy(l).sub(a).normalize(),o}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Ze,i=[],s=[],a=[],l=new Ze,o=new Gr;for(let y=0;y<=e;y++){const S=y/e;i[y]=this.getTangentAt(S,new Ze)}s[0]=new Ze,a[0]=new Ze;let h=Number.MAX_VALUE;const d=Math.abs(i[0].x),m=Math.abs(i[0].y),v=Math.abs(i[0].z);d<=h&&(h=d,r.set(1,0,0)),m<=h&&(h=m,r.set(0,1,0)),v<=h&&r.set(0,0,1),l.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],l),a[0].crossVectors(i[0],s[0]);for(let y=1;y<=e;y++){if(s[y]=s[y-1].clone(),a[y]=a[y-1].clone(),l.crossVectors(i[y-1],i[y]),l.length()>Number.EPSILON){l.normalize();const S=Math.acos(ta(i[y-1].dot(i[y]),-1,1));s[y].applyMatrix4(o.makeRotationAxis(l,S))}a[y].crossVectors(i[y],s[y])}if(t===!0){let y=Math.acos(ta(s[0].dot(s[e]),-1,1));y/=e,i[0].dot(l.crossVectors(s[0],s[e]))>0&&(y=-y);for(let S=1;S<=e;S++)s[S].applyMatrix4(o.makeRotationAxis(i[S],y*S)),a[S].crossVectors(i[S],s[S])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class aD extends td{constructor(e=0,t=0,r=1,i=1,s=0,a=Math.PI*2,l=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=l,this.aRotation=o}getPoint(e,t=new nn){const r=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const l=this.aStartAngle+e*s;let o=this.aX+this.xRadius*Math.cos(l),h=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const d=Math.cos(this.aRotation),m=Math.sin(this.aRotation),v=o-this.aX,y=h-this.aY;o=v*d-y*m+this.aX,h=v*m+y*d+this.aY}return r.set(o,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class rne extends aD{constructor(e,t,r,i,s,a){super(e,t,r,r,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Z6(){let n=0,e=0,t=0,r=0;function i(s,a,l,o){n=s,e=l,t=-3*s+3*a-2*l-o,r=2*s-2*a+l+o}return{initCatmullRom:function(s,a,l,o,h){i(a,l,h*(l-s),h*(o-a))},initNonuniformCatmullRom:function(s,a,l,o,h,d,m){let v=(a-s)/h-(l-s)/(h+d)+(l-a)/d,y=(l-a)/d-(o-a)/(d+m)+(o-l)/m;v*=d,y*=d,i(a,l,v,y)},calc:function(s){const a=s*s,l=a*s;return n+e*s+t*a+r*l}}}const oE=new Ze,G5=new Z6,V5=new Z6,H5=new Z6;class ine extends td{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Ze){const r=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let l=Math.floor(a),o=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:o===0&&l===s-1&&(l=s-2,o=1);let h,d;this.closed||l>0?h=i[(l-1)%s]:(oE.subVectors(i[0],i[1]).add(i[0]),h=oE);const m=i[l%s],v=i[(l+1)%s];if(this.closed||l+2<s?d=i[(l+2)%s]:(oE.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=oE),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let S=Math.pow(h.distanceToSquared(m),y),E=Math.pow(m.distanceToSquared(v),y),M=Math.pow(v.distanceToSquared(d),y);E<1e-4&&(E=1),S<1e-4&&(S=E),M<1e-4&&(M=E),G5.initNonuniformCatmullRom(h.x,m.x,v.x,d.x,S,E,M),V5.initNonuniformCatmullRom(h.y,m.y,v.y,d.y,S,E,M),H5.initNonuniformCatmullRom(h.z,m.z,v.z,d.z,S,E,M)}else this.curveType==="catmullrom"&&(G5.initCatmullRom(h.x,m.x,v.x,d.x,this.tension),V5.initCatmullRom(h.y,m.y,v.y,d.y,this.tension),H5.initCatmullRom(h.z,m.z,v.z,d.z,this.tension));return r.set(G5.calc(o),V5.calc(o),H5.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Ze().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _W(n,e,t,r,i){const s=(r-e)*.5,a=(i-t)*.5,l=n*n,o=n*l;return(2*t-2*r+s+a)*o+(-3*t+3*r-2*s-a)*l+s*n+t}function Yxe(n,e){const t=1-n;return t*t*e}function Kxe(n,e){return 2*(1-n)*n*e}function Jxe(n,e){return n*n*e}function YS(n,e,t,r){return Yxe(n,e)+Kxe(n,t)+Jxe(n,r)}function Qxe(n,e){const t=1-n;return t*t*t*e}function ebe(n,e){const t=1-n;return 3*t*t*n*e}function tbe(n,e){return 3*(1-n)*n*n*e}function nbe(n,e){return n*n*n*e}function KS(n,e,t,r,i){return Qxe(n,e)+ebe(n,t)+tbe(n,r)+nbe(n,i)}class Y6 extends td{constructor(e=new nn,t=new nn,r=new nn,i=new nn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new nn){const r=t,i=this.v0,s=this.v1,a=this.v2,l=this.v3;return r.set(KS(e,i.x,s.x,a.x,l.x),KS(e,i.y,s.y,a.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class sne extends td{constructor(e=new Ze,t=new Ze,r=new Ze,i=new Ze){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,a=this.v2,l=this.v3;return r.set(KS(e,i.x,s.x,a.x,l.x),KS(e,i.y,s.y,a.y,l.y),KS(e,i.z,s.z,a.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class K6 extends td{constructor(e=new nn,t=new nn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new nn){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new nn){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class one extends td{constructor(e=new Ze,t=new Ze){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Ze){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class J6 extends td{constructor(e=new nn,t=new nn,r=new nn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new nn){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(YS(e,i.x,s.x,a.x),YS(e,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Q6 extends td{constructor(e=new Ze,t=new Ze,r=new Ze){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(YS(e,i.x,s.x,a.x),YS(e,i.y,s.y,a.y),YS(e,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eU extends td{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new nn){const r=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),l=s-a,o=i[a===0?a:a-1],h=i[a],d=i[a>i.length-2?i.length-1:a+1],m=i[a>i.length-3?i.length-1:a+2];return r.set(_W(l,o.x,h.x,d.x,m.x),_W(l,o.y,h.y,d.y,m.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new nn().fromArray(i))}return this}}var vP=Object.freeze({__proto__:null,ArcCurve:rne,CatmullRomCurve3:ine,CubicBezierCurve:Y6,CubicBezierCurve3:sne,EllipseCurve:aD,LineCurve:K6,LineCurve3:one,QuadraticBezierCurve:J6,QuadraticBezierCurve3:Q6,SplineCurve:eU});class ane extends td{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new vP[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const a=i[s]-r,l=this.curves[s],o=l.getLength(),h=o===0?0:1-a/o;return l.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],l=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,o=a.getPoints(l);for(let h=0;h<o.length;h++){const d=o[h];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new vP[i.type]().fromJSON(i))}return this}}let KA=class extends ane{constructor(e){super(),this.type="Path",this.currentPoint=new nn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new K6(this.currentPoint.clone(),new nn(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new J6(this.currentPoint.clone(),new nn(e,t),new nn(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,a){const l=new Y6(this.currentPoint.clone(),new nn(e,t),new nn(r,i),new nn(s,a));return this.curves.push(l),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new eU(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,a){const l=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+l,t+o,r,i,s,a),this}absarc(e,t,r,i,s,a){return this.absellipse(e,t,r,r,i,s,a),this}ellipse(e,t,r,i,s,a,l,o){const h=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+h,t+d,r,i,s,a,l,o),this}absellipse(e,t,r,i,s,a,l,o){const h=new aD(e,t,r,i,s,a,l,o);if(this.curves.length>0){const m=h.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(h);const d=h.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class $T extends $r{constructor(e=[new nn(0,-.5),new nn(.5,0),new nn(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=ta(i,0,Math.PI*2);const s=[],a=[],l=[],o=[],h=[],d=1/t,m=new Ze,v=new nn,y=new Ze,S=new Ze,E=new Ze;let M=0,C=0;for(let L=0;L<=e.length-1;L++)switch(L){case 0:M=e[L+1].x-e[L].x,C=e[L+1].y-e[L].y,y.x=C*1,y.y=-M,y.z=C*0,E.copy(y),y.normalize(),o.push(y.x,y.y,y.z);break;case e.length-1:o.push(E.x,E.y,E.z);break;default:M=e[L+1].x-e[L].x,C=e[L+1].y-e[L].y,y.x=C*1,y.y=-M,y.z=C*0,S.copy(y),y.x+=E.x,y.y+=E.y,y.z+=E.z,y.normalize(),o.push(y.x,y.y,y.z),E.copy(S)}for(let L=0;L<=t;L++){const k=r+L*d*i,H=Math.sin(k),q=Math.cos(k);for(let Z=0;Z<=e.length-1;Z++){m.x=e[Z].x*H,m.y=e[Z].y,m.z=e[Z].x*q,a.push(m.x,m.y,m.z),v.x=L/t,v.y=Z/(e.length-1),l.push(v.x,v.y);const ee=o[3*Z+0]*H,re=o[3*Z+1],se=o[3*Z+0]*q;h.push(ee,re,se)}}for(let L=0;L<t;L++)for(let k=0;k<e.length-1;k++){const H=k+L*e.length,q=H,Z=H+e.length,ee=H+e.length+1,re=H+1;s.push(q,Z,re),s.push(ee,re,Z)}this.setIndex(s),this.setAttribute("position",new ar(a,3)),this.setAttribute("uv",new ar(l,2)),this.setAttribute("normal",new ar(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $T(e.points,e.segments,e.phiStart,e.phiLength)}}class lD extends $T{constructor(e=1,t=1,r=4,i=8){const s=new KA;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new lD(e.radius,e.length,e.capSegments,e.radialSegments)}}class cD extends $r{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],a=[],l=[],o=[],h=new Ze,d=new nn;a.push(0,0,0),l.push(0,0,1),o.push(.5,.5);for(let m=0,v=3;m<=t;m++,v+=3){const y=r+m/t*i;h.x=e*Math.cos(y),h.y=e*Math.sin(y),a.push(h.x,h.y,h.z),l.push(0,0,1),d.x=(a[v]/e+1)/2,d.y=(a[v+1]/e+1)/2,o.push(d.x,d.y)}for(let m=1;m<=t;m++)s.push(m,m+1,0);this.setIndex(s),this.setAttribute("position",new ar(a,3)),this.setAttribute("normal",new ar(l,3)),this.setAttribute("uv",new ar(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cD(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ww extends $r{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,l=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:l,thetaLength:o};const h=this;i=Math.floor(i),s=Math.floor(s);const d=[],m=[],v=[],y=[];let S=0;const E=[],M=r/2;let C=0;L(),a===!1&&(e>0&&k(!0),t>0&&k(!1)),this.setIndex(d),this.setAttribute("position",new ar(m,3)),this.setAttribute("normal",new ar(v,3)),this.setAttribute("uv",new ar(y,2));function L(){const H=new Ze,q=new Ze;let Z=0;const ee=(t-e)/r;for(let re=0;re<=s;re++){const se=[],ae=re/s,fe=ae*(t-e)+e;for(let Se=0;Se<=i;Se++){const Ce=Se/i,Ie=Ce*o+l,je=Math.sin(Ie),Le=Math.cos(Ie);q.x=fe*je,q.y=-ae*r+M,q.z=fe*Le,m.push(q.x,q.y,q.z),H.set(je,ee,Le).normalize(),v.push(H.x,H.y,H.z),y.push(Ce,1-ae),se.push(S++)}E.push(se)}for(let re=0;re<i;re++)for(let se=0;se<s;se++){const ae=E[se][re],fe=E[se+1][re],Se=E[se+1][re+1],Ce=E[se][re+1];d.push(ae,fe,Ce),d.push(fe,Se,Ce),Z+=6}h.addGroup(C,Z,0),C+=Z}function k(H){const q=S,Z=new nn,ee=new Ze;let re=0;const se=H===!0?e:t,ae=H===!0?1:-1;for(let Se=1;Se<=i;Se++)m.push(0,M*ae,0),v.push(0,ae,0),y.push(.5,.5),S++;const fe=S;for(let Se=0;Se<=i;Se++){const Ie=Se/i*o+l,je=Math.cos(Ie),Le=Math.sin(Ie);ee.x=se*Le,ee.y=M*ae,ee.z=se*je,m.push(ee.x,ee.y,ee.z),v.push(0,ae,0),Z.x=je*.5+.5,Z.y=Le*.5*ae+.5,y.push(Z.x,Z.y),S++}for(let Se=0;Se<i;Se++){const Ce=q+Se,Ie=fe+Se;H===!0?d.push(Ie,Ie+1,Ce):d.push(Ie+1,Ie,Ce),re+=3}h.addGroup(C,re,H===!0?1:2),C+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ww(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class uD extends ww{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,l=Math.PI*2){super(0,e,t,r,i,s,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:l}}static fromJSON(e){return new uD(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Iv extends $r{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],a=[];l(i),h(r),d(),this.setAttribute("position",new ar(s,3)),this.setAttribute("normal",new ar(s.slice(),3)),this.setAttribute("uv",new ar(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function l(L){const k=new Ze,H=new Ze,q=new Ze;for(let Z=0;Z<t.length;Z+=3)y(t[Z+0],k),y(t[Z+1],H),y(t[Z+2],q),o(k,H,q,L)}function o(L,k,H,q){const Z=q+1,ee=[];for(let re=0;re<=Z;re++){ee[re]=[];const se=L.clone().lerp(H,re/Z),ae=k.clone().lerp(H,re/Z),fe=Z-re;for(let Se=0;Se<=fe;Se++)Se===0&&re===Z?ee[re][Se]=se:ee[re][Se]=se.clone().lerp(ae,Se/fe)}for(let re=0;re<Z;re++)for(let se=0;se<2*(Z-re)-1;se++){const ae=Math.floor(se/2);se%2===0?(v(ee[re][ae+1]),v(ee[re+1][ae]),v(ee[re][ae])):(v(ee[re][ae+1]),v(ee[re+1][ae+1]),v(ee[re+1][ae]))}}function h(L){const k=new Ze;for(let H=0;H<s.length;H+=3)k.x=s[H+0],k.y=s[H+1],k.z=s[H+2],k.normalize().multiplyScalar(L),s[H+0]=k.x,s[H+1]=k.y,s[H+2]=k.z}function d(){const L=new Ze;for(let k=0;k<s.length;k+=3){L.x=s[k+0],L.y=s[k+1],L.z=s[k+2];const H=M(L)/2/Math.PI+.5,q=C(L)/Math.PI+.5;a.push(H,1-q)}S(),m()}function m(){for(let L=0;L<a.length;L+=6){const k=a[L+0],H=a[L+2],q=a[L+4],Z=Math.max(k,H,q),ee=Math.min(k,H,q);Z>.9&&ee<.1&&(k<.2&&(a[L+0]+=1),H<.2&&(a[L+2]+=1),q<.2&&(a[L+4]+=1))}}function v(L){s.push(L.x,L.y,L.z)}function y(L,k){const H=L*3;k.x=e[H+0],k.y=e[H+1],k.z=e[H+2]}function S(){const L=new Ze,k=new Ze,H=new Ze,q=new Ze,Z=new nn,ee=new nn,re=new nn;for(let se=0,ae=0;se<s.length;se+=9,ae+=6){L.set(s[se+0],s[se+1],s[se+2]),k.set(s[se+3],s[se+4],s[se+5]),H.set(s[se+6],s[se+7],s[se+8]),Z.set(a[ae+0],a[ae+1]),ee.set(a[ae+2],a[ae+3]),re.set(a[ae+4],a[ae+5]),q.copy(L).add(k).add(H).divideScalar(3);const fe=M(q);E(Z,ae+0,L,fe),E(ee,ae+2,k,fe),E(re,ae+4,H,fe)}}function E(L,k,H,q){q<0&&L.x===1&&(a[k]=L.x-1),H.x===0&&H.z===0&&(a[k]=q/2/Math.PI+.5)}function M(L){return Math.atan2(L.z,-L.x)}function C(L){return Math.atan2(-L.y,Math.sqrt(L.x*L.x+L.z*L.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Iv(e.vertices,e.indices,e.radius,e.details)}}class hD extends Iv{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hD(e.radius,e.detail)}}const aE=new Ze,lE=new Ze,j5=new Ze,cE=new H0;class lne extends $r{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(ky*t),a=e.getIndex(),l=e.getAttribute("position"),o=a?a.count:l.count,h=[0,0,0],d=["a","b","c"],m=new Array(3),v={},y=[];for(let S=0;S<o;S+=3){a?(h[0]=a.getX(S),h[1]=a.getX(S+1),h[2]=a.getX(S+2)):(h[0]=S,h[1]=S+1,h[2]=S+2);const{a:E,b:M,c:C}=cE;if(E.fromBufferAttribute(l,h[0]),M.fromBufferAttribute(l,h[1]),C.fromBufferAttribute(l,h[2]),cE.getNormal(j5),m[0]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,m[1]=`${Math.round(M.x*i)},${Math.round(M.y*i)},${Math.round(M.z*i)}`,m[2]=`${Math.round(C.x*i)},${Math.round(C.y*i)},${Math.round(C.z*i)}`,!(m[0]===m[1]||m[1]===m[2]||m[2]===m[0]))for(let L=0;L<3;L++){const k=(L+1)%3,H=m[L],q=m[k],Z=cE[d[L]],ee=cE[d[k]],re=`${H}_${q}`,se=`${q}_${H}`;se in v&&v[se]?(j5.dot(v[se].normal)<=s&&(y.push(Z.x,Z.y,Z.z),y.push(ee.x,ee.y,ee.z)),v[se]=null):re in v||(v[re]={index0:h[L],index1:h[k],normal:j5.clone()})}}for(const S in v)if(v[S]){const{index0:E,index1:M}=v[S];aE.fromBufferAttribute(l,E),lE.fromBufferAttribute(l,M),y.push(aE.x,aE.y,aE.z),y.push(lE.x,lE.y,lE.z)}this.setAttribute("position",new ar(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Fy extends KA{constructor(e){super(e),this.uuid=ku(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new KA().fromJSON(i))}return this}}const rbe={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=cne(n,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let l,o,h,d,m,v,y;if(r&&(s=lbe(n,e,s,t)),n.length>80*t){l=h=n[0],o=d=n[1];for(let S=t;S<i;S+=t)m=n[S],v=n[S+1],m<l&&(l=m),v<o&&(o=v),m>h&&(h=m),v>d&&(d=v);y=Math.max(h-l,d-o),y=y!==0?32767/y:0}return JA(s,a,t,l,o,y,0),a}};function cne(n,e,t,r,i){let s,a;if(i===ybe(n,e,t,r)>0)for(s=e;s<t;s+=r)a=yW(s,n[s],n[s+1],a);else for(s=t-r;s>=e;s-=r)a=yW(s,n[s],n[s+1],a);return a&&fD(a,a.next)&&(eT(a),a=a.next),a}function e1(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(fD(t,t.next)||Go(t.prev,t,t.next)===0)){if(eT(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function JA(n,e,t,r,i,s,a){if(!n)return;!a&&s&&dbe(n,r,i,s);let l=n,o,h;for(;n.prev!==n.next;){if(o=n.prev,h=n.next,s?sbe(n,r,i,s):ibe(n)){e.push(o.i/t|0),e.push(n.i/t|0),e.push(h.i/t|0),eT(n),n=h.next,l=h.next;continue}if(n=h,n===l){a?a===1?(n=obe(e1(n),e,t),JA(n,e,t,r,i,s,2)):a===2&&abe(n,e,t,r,i,s):JA(e1(n),e,t,r,i,s,1);break}}}function ibe(n){const e=n.prev,t=n,r=n.next;if(Go(e,t,r)>=0)return!1;const i=e.x,s=t.x,a=r.x,l=e.y,o=t.y,h=r.y,d=i<s?i<a?i:a:s<a?s:a,m=l<o?l<h?l:h:o<h?o:h,v=i>s?i>a?i:a:s>a?s:a,y=l>o?l>h?l:h:o>h?o:h;let S=r.next;for(;S!==e;){if(S.x>=d&&S.x<=v&&S.y>=m&&S.y<=y&&mb(i,l,s,o,a,h,S.x,S.y)&&Go(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function sbe(n,e,t,r){const i=n.prev,s=n,a=n.next;if(Go(i,s,a)>=0)return!1;const l=i.x,o=s.x,h=a.x,d=i.y,m=s.y,v=a.y,y=l<o?l<h?l:h:o<h?o:h,S=d<m?d<v?d:v:m<v?m:v,E=l>o?l>h?l:h:o>h?o:h,M=d>m?d>v?d:v:m>v?m:v,C=TF(y,S,e,t,r),L=TF(E,M,e,t,r);let k=n.prevZ,H=n.nextZ;for(;k&&k.z>=C&&H&&H.z<=L;){if(k.x>=y&&k.x<=E&&k.y>=S&&k.y<=M&&k!==i&&k!==a&&mb(l,d,o,m,h,v,k.x,k.y)&&Go(k.prev,k,k.next)>=0||(k=k.prevZ,H.x>=y&&H.x<=E&&H.y>=S&&H.y<=M&&H!==i&&H!==a&&mb(l,d,o,m,h,v,H.x,H.y)&&Go(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;k&&k.z>=C;){if(k.x>=y&&k.x<=E&&k.y>=S&&k.y<=M&&k!==i&&k!==a&&mb(l,d,o,m,h,v,k.x,k.y)&&Go(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;H&&H.z<=L;){if(H.x>=y&&H.x<=E&&H.y>=S&&H.y<=M&&H!==i&&H!==a&&mb(l,d,o,m,h,v,H.x,H.y)&&Go(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function obe(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!fD(i,s)&&une(i,r,r.next,s)&&QA(i,s)&&QA(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),eT(r),eT(r.next),r=n=s),r=r.next}while(r!==n);return e1(r)}function abe(n,e,t,r,i,s){let a=n;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&gbe(a,l)){let o=hne(a,l);a=e1(a,a.next),o=e1(o,o.next),JA(a,e,t,r,i,s,0),JA(o,e,t,r,i,s,0);return}l=l.next}a=a.next}while(a!==n)}function lbe(n,e,t,r){const i=[];let s,a,l,o,h;for(s=0,a=e.length;s<a;s++)l=e[s]*r,o=s<a-1?e[s+1]*r:n.length,h=cne(n,l,o,r,!1),h===h.next&&(h.steiner=!0),i.push(mbe(h));for(i.sort(cbe),s=0;s<i.length;s++)t=ube(i[s],t);return t}function cbe(n,e){return n.x-e.x}function ube(n,e){const t=hbe(n,e);if(!t)return e;const r=hne(t,n);return e1(r,r.next),e1(t,t.next)}function hbe(n,e){let t=e,r=-1/0,i;const s=n.x,a=n.y;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const v=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=s&&v>r&&(r=v,i=t.x<t.next.x?t:t.next,v===s))return i}t=t.next}while(t!==e);if(!i)return null;const l=i,o=i.x,h=i.y;let d=1/0,m;t=i;do s>=t.x&&t.x>=o&&s!==t.x&&mb(a<h?s:r,a,o,h,a<h?r:s,a,t.x,t.y)&&(m=Math.abs(a-t.y)/(s-t.x),QA(t,n)&&(m<d||m===d&&(t.x>i.x||t.x===i.x&&fbe(i,t)))&&(i=t,d=m)),t=t.next;while(t!==l);return i}function fbe(n,e){return Go(n.prev,n,e.prev)<0&&Go(e.next,n,n.next)<0}function dbe(n,e,t,r){let i=n;do i.z===0&&(i.z=TF(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,pbe(i)}function pbe(n){let e,t,r,i,s,a,l,o,h=1;do{for(t=n,n=null,s=null,a=0;t;){for(a++,r=t,l=0,e=0;e<h&&(l++,r=r.nextZ,!!r);e++);for(o=h;l>0||o>0&&r;)l!==0&&(o===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,l--):(i=r,r=r.nextZ,o--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,h*=2}while(a>1);return n}function TF(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function mbe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function mb(n,e,t,r,i,s,a,l){return(i-a)*(e-l)>=(n-a)*(s-l)&&(n-a)*(r-l)>=(t-a)*(e-l)&&(t-a)*(s-l)>=(i-a)*(r-l)}function gbe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!vbe(n,e)&&(QA(n,e)&&QA(e,n)&&_be(n,e)&&(Go(n.prev,n,e.prev)||Go(n,e.prev,e))||fD(n,e)&&Go(n.prev,n,n.next)>0&&Go(e.prev,e,e.next)>0)}function Go(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function fD(n,e){return n.x===e.x&&n.y===e.y}function une(n,e,t,r){const i=hE(Go(n,e,t)),s=hE(Go(n,e,r)),a=hE(Go(t,r,n)),l=hE(Go(t,r,e));return!!(i!==s&&a!==l||i===0&&uE(n,t,e)||s===0&&uE(n,r,e)||a===0&&uE(t,n,r)||l===0&&uE(t,e,r))}function uE(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function hE(n){return n>0?1:n<0?-1:0}function vbe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&une(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function QA(n,e){return Go(n.prev,n,n.next)<0?Go(n,e,n.next)>=0&&Go(n,n.prev,e)>=0:Go(n,e,n.prev)<0||Go(n,n.next,e)<0}function _be(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function hne(n,e){const t=new MF(n.i,n.x,n.y),r=new MF(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function yW(n,e,t,r){const i=new MF(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function eT(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function MF(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ybe(n,e,t,r){let i=0;for(let s=e,a=t-r;s<t;s+=r)i+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return i}class lp{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return lp.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];xW(e),bW(r,e);let a=e.length;t.forEach(xW);for(let o=0;o<t.length;o++)i.push(a),a+=t[o].length,bW(r,t[o]);const l=rbe.triangulate(r,i);for(let o=0;o<l.length;o+=3)s.push(l.slice(o,o+3));return s}}function xW(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function bW(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class dD extends $r{constructor(e=new Fy([new nn(.5,.5),new nn(-.5,.5),new nn(-.5,-.5),new nn(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let l=0,o=e.length;l<o;l++){const h=e[l];a(h)}this.setAttribute("position",new ar(i,3)),this.setAttribute("uv",new ar(s,2)),this.computeVertexNormals();function a(l){const o=[],h=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,m=t.depth!==void 0?t.depth:1;let v=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:y-.1,E=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const C=t.extrudePath,L=t.UVGenerator!==void 0?t.UVGenerator:xbe;let k,H=!1,q,Z,ee,re;C&&(k=C.getSpacedPoints(d),H=!0,v=!1,q=C.computeFrenetFrames(d,!1),Z=new Ze,ee=new Ze,re=new Ze),v||(M=0,y=0,S=0,E=0);const se=l.extractPoints(h);let ae=se.shape;const fe=se.holes;if(!lp.isClockWise(ae)){ae=ae.reverse();for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];lp.isClockWise(cn)&&(fe[qe]=cn.reverse())}}const Ce=lp.triangulateShape(ae,fe),Ie=ae;for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];ae=ae.concat(cn)}function je(qe,mn,cn){return mn||console.error("THREE.ExtrudeGeometry: vec does not exist"),qe.clone().addScaledVector(mn,cn)}const Le=ae.length,ot=Ce.length;function ye(qe,mn,cn){let St,Jt,kn;const Gn=qe.x-mn.x,sn=qe.y-mn.y,at=cn.x-qe.x,Ue=cn.y-qe.y,$t=Gn*Gn+sn*sn,An=Gn*Ue-sn*at;if(Math.abs(An)>Number.EPSILON){const Sn=Math.sqrt($t),jt=Math.sqrt(at*at+Ue*Ue),mr=mn.x-sn/Sn,Un=mn.y+Gn/Sn,tr=cn.x-Ue/jt,Sr=cn.y+at/jt,Ln=((tr-mr)*Ue-(Sr-Un)*at)/(Gn*Ue-sn*at);St=mr+Gn*Ln-qe.x,Jt=Un+sn*Ln-qe.y;const ir=St*St+Jt*Jt;if(ir<=2)return new nn(St,Jt);kn=Math.sqrt(ir/2)}else{let Sn=!1;Gn>Number.EPSILON?at>Number.EPSILON&&(Sn=!0):Gn<-Number.EPSILON?at<-Number.EPSILON&&(Sn=!0):Math.sign(sn)===Math.sign(Ue)&&(Sn=!0),Sn?(St=-sn,Jt=Gn,kn=Math.sqrt($t)):(St=Gn,Jt=sn,kn=Math.sqrt($t/2))}return new nn(St/kn,Jt/kn)}const $e=[];for(let qe=0,mn=Ie.length,cn=mn-1,St=qe+1;qe<mn;qe++,cn++,St++)cn===mn&&(cn=0),St===mn&&(St=0),$e[qe]=ye(Ie[qe],Ie[cn],Ie[St]);const Ve=[];let _t,wt=$e.concat();for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];_t=[];for(let St=0,Jt=cn.length,kn=Jt-1,Gn=St+1;St<Jt;St++,kn++,Gn++)kn===Jt&&(kn=0),Gn===Jt&&(Gn=0),_t[St]=ye(cn[St],cn[kn],cn[Gn]);Ve.push(_t),wt=wt.concat(_t)}for(let qe=0;qe<M;qe++){const mn=qe/M,cn=y*Math.cos(mn*Math.PI/2),St=S*Math.sin(mn*Math.PI/2)+E;for(let Jt=0,kn=Ie.length;Jt<kn;Jt++){const Gn=je(Ie[Jt],$e[Jt],St);rn(Gn.x,Gn.y,-cn)}for(let Jt=0,kn=fe.length;Jt<kn;Jt++){const Gn=fe[Jt];_t=Ve[Jt];for(let sn=0,at=Gn.length;sn<at;sn++){const Ue=je(Gn[sn],_t[sn],St);rn(Ue.x,Ue.y,-cn)}}}const Vt=S+E;for(let qe=0;qe<Le;qe++){const mn=v?je(ae[qe],wt[qe],Vt):ae[qe];H?(ee.copy(q.normals[0]).multiplyScalar(mn.x),Z.copy(q.binormals[0]).multiplyScalar(mn.y),re.copy(k[0]).add(ee).add(Z),rn(re.x,re.y,re.z)):rn(mn.x,mn.y,0)}for(let qe=1;qe<=d;qe++)for(let mn=0;mn<Le;mn++){const cn=v?je(ae[mn],wt[mn],Vt):ae[mn];H?(ee.copy(q.normals[qe]).multiplyScalar(cn.x),Z.copy(q.binormals[qe]).multiplyScalar(cn.y),re.copy(k[qe]).add(ee).add(Z),rn(re.x,re.y,re.z)):rn(cn.x,cn.y,m/d*qe)}for(let qe=M-1;qe>=0;qe--){const mn=qe/M,cn=y*Math.cos(mn*Math.PI/2),St=S*Math.sin(mn*Math.PI/2)+E;for(let Jt=0,kn=Ie.length;Jt<kn;Jt++){const Gn=je(Ie[Jt],$e[Jt],St);rn(Gn.x,Gn.y,m+cn)}for(let Jt=0,kn=fe.length;Jt<kn;Jt++){const Gn=fe[Jt];_t=Ve[Jt];for(let sn=0,at=Gn.length;sn<at;sn++){const Ue=je(Gn[sn],_t[sn],St);H?rn(Ue.x,Ue.y+k[d-1].y,k[d-1].x+cn):rn(Ue.x,Ue.y,m+cn)}}}lt(),Ht();function lt(){const qe=i.length/3;if(v){let mn=0,cn=Le*mn;for(let St=0;St<ot;St++){const Jt=Ce[St];jn(Jt[2]+cn,Jt[1]+cn,Jt[0]+cn)}mn=d+M*2,cn=Le*mn;for(let St=0;St<ot;St++){const Jt=Ce[St];jn(Jt[0]+cn,Jt[1]+cn,Jt[2]+cn)}}else{for(let mn=0;mn<ot;mn++){const cn=Ce[mn];jn(cn[2],cn[1],cn[0])}for(let mn=0;mn<ot;mn++){const cn=Ce[mn];jn(cn[0]+Le*d,cn[1]+Le*d,cn[2]+Le*d)}}r.addGroup(qe,i.length/3-qe,0)}function Ht(){const qe=i.length/3;let mn=0;Qt(Ie,mn),mn+=Ie.length;for(let cn=0,St=fe.length;cn<St;cn++){const Jt=fe[cn];Qt(Jt,mn),mn+=Jt.length}r.addGroup(qe,i.length/3-qe,1)}function Qt(qe,mn){let cn=qe.length;for(;--cn>=0;){const St=cn;let Jt=cn-1;Jt<0&&(Jt=qe.length-1);for(let kn=0,Gn=d+M*2;kn<Gn;kn++){const sn=Le*kn,at=Le*(kn+1),Ue=mn+St+sn,$t=mn+Jt+sn,An=mn+Jt+at,Sn=mn+St+at;Bn(Ue,$t,An,Sn)}}}function rn(qe,mn,cn){o.push(qe),o.push(mn),o.push(cn)}function jn(qe,mn,cn){Tn(qe),Tn(mn),Tn(cn);const St=i.length/3,Jt=L.generateTopUV(r,i,St-3,St-2,St-1);Pe(Jt[0]),Pe(Jt[1]),Pe(Jt[2])}function Bn(qe,mn,cn,St){Tn(qe),Tn(mn),Tn(St),Tn(mn),Tn(cn),Tn(St);const Jt=i.length/3,kn=L.generateSideWallUV(r,i,Jt-6,Jt-3,Jt-2,Jt-1);Pe(kn[0]),Pe(kn[1]),Pe(kn[3]),Pe(kn[1]),Pe(kn[2]),Pe(kn[3])}function Tn(qe){i.push(o[qe*3+0]),i.push(o[qe*3+1]),i.push(o[qe*3+2])}function Pe(qe){s.push(qe.x),s.push(qe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return bbe(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const l=t[e.shapes[s]];r.push(l)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new vP[i.type]().fromJSON(i)),new dD(r,e.options)}}const xbe={generateTopUV:function(n,e,t,r,i){const s=e[t*3],a=e[t*3+1],l=e[r*3],o=e[r*3+1],h=e[i*3],d=e[i*3+1];return[new nn(s,a),new nn(l,o),new nn(h,d)]},generateSideWallUV:function(n,e,t,r,i,s){const a=e[t*3],l=e[t*3+1],o=e[t*3+2],h=e[r*3],d=e[r*3+1],m=e[r*3+2],v=e[i*3],y=e[i*3+1],S=e[i*3+2],E=e[s*3],M=e[s*3+1],C=e[s*3+2];return Math.abs(l-d)<Math.abs(a-h)?[new nn(a,1-o),new nn(h,1-m),new nn(v,1-S),new nn(E,1-C)]:[new nn(l,1-o),new nn(d,1-m),new nn(y,1-S),new nn(M,1-C)]}};function bbe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class t1 extends Iv{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new t1(e.radius,e.detail)}}class qT extends Iv{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new qT(e.radius,e.detail)}}class pD extends $r{constructor(e=.5,t=1,r=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:a},r=Math.max(3,r),i=Math.max(1,i);const l=[],o=[],h=[],d=[];let m=e;const v=(t-e)/i,y=new Ze,S=new nn;for(let E=0;E<=i;E++){for(let M=0;M<=r;M++){const C=s+M/r*a;y.x=m*Math.cos(C),y.y=m*Math.sin(C),o.push(y.x,y.y,y.z),h.push(0,0,1),S.x=(y.x/t+1)/2,S.y=(y.y/t+1)/2,d.push(S.x,S.y)}m+=v}for(let E=0;E<i;E++){const M=E*(r+1);for(let C=0;C<r;C++){const L=C+M,k=L,H=L+r+1,q=L+r+2,Z=L+1;l.push(k,H,Z),l.push(H,q,Z)}}this.setIndex(l),this.setAttribute("position",new ar(o,3)),this.setAttribute("normal",new ar(h,3)),this.setAttribute("uv",new ar(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pD(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class mD extends $r{constructor(e=new Fy([new nn(0,.5),new nn(-.5,-.5),new nn(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],a=[];let l=0,o=0;if(Array.isArray(e)===!1)h(e);else for(let d=0;d<e.length;d++)h(e[d]),this.addGroup(l,o,d),l+=o,o=0;this.setIndex(r),this.setAttribute("position",new ar(i,3)),this.setAttribute("normal",new ar(s,3)),this.setAttribute("uv",new ar(a,2));function h(d){const m=i.length/3,v=d.extractPoints(t);let y=v.shape;const S=v.holes;lp.isClockWise(y)===!1&&(y=y.reverse());for(let M=0,C=S.length;M<C;M++){const L=S[M];lp.isClockWise(L)===!0&&(S[M]=L.reverse())}const E=lp.triangulateShape(y,S);for(let M=0,C=S.length;M<C;M++){const L=S[M];y=y.concat(L)}for(let M=0,C=y.length;M<C;M++){const L=y[M];i.push(L.x,L.y,0),s.push(0,0,1),a.push(L.x,L.y)}for(let M=0,C=E.length;M<C;M++){const L=E[M],k=L[0]+m,H=L[1]+m,q=L[2]+m;r.push(k,H,q),o+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return wbe(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];r.push(a)}return new mD(r,e.curveSegments)}}function wbe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class km extends $r{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:l},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const o=Math.min(a+l,Math.PI);let h=0;const d=[],m=new Ze,v=new Ze,y=[],S=[],E=[],M=[];for(let C=0;C<=r;C++){const L=[],k=C/r;let H=0;C===0&&a===0?H=.5/t:C===r&&o===Math.PI&&(H=-.5/t);for(let q=0;q<=t;q++){const Z=q/t;m.x=-e*Math.cos(i+Z*s)*Math.sin(a+k*l),m.y=e*Math.cos(a+k*l),m.z=e*Math.sin(i+Z*s)*Math.sin(a+k*l),S.push(m.x,m.y,m.z),v.copy(m).normalize(),E.push(v.x,v.y,v.z),M.push(Z+H,1-k),L.push(h++)}d.push(L)}for(let C=0;C<r;C++)for(let L=0;L<t;L++){const k=d[C][L+1],H=d[C][L],q=d[C+1][L],Z=d[C+1][L+1];(C!==0||a>0)&&y.push(k,H,Z),(C!==r-1||o<Math.PI)&&y.push(H,q,Z)}this.setIndex(y),this.setAttribute("position",new ar(S,3)),this.setAttribute("normal",new ar(E,3)),this.setAttribute("uv",new ar(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new km(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class gD extends Iv{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new gD(e.radius,e.detail)}}class ZT extends $r{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],o=[],h=[],d=new Ze,m=new Ze,v=new Ze;for(let y=0;y<=r;y++)for(let S=0;S<=i;S++){const E=S/i*s,M=y/r*Math.PI*2;m.x=(e+t*Math.cos(M))*Math.cos(E),m.y=(e+t*Math.cos(M))*Math.sin(E),m.z=t*Math.sin(M),l.push(m.x,m.y,m.z),d.x=e*Math.cos(E),d.y=e*Math.sin(E),v.subVectors(m,d).normalize(),o.push(v.x,v.y,v.z),h.push(S/i),h.push(y/r)}for(let y=1;y<=r;y++)for(let S=1;S<=i;S++){const E=(i+1)*y+S-1,M=(i+1)*(y-1)+S-1,C=(i+1)*(y-1)+S,L=(i+1)*y+S;a.push(E,M,L),a.push(M,C,L)}this.setIndex(a),this.setAttribute("position",new ar(l,3)),this.setAttribute("normal",new ar(o,3)),this.setAttribute("uv",new ar(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ZT(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class vD extends $r{constructor(e=1,t=.4,r=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:a},r=Math.floor(r),i=Math.floor(i);const l=[],o=[],h=[],d=[],m=new Ze,v=new Ze,y=new Ze,S=new Ze,E=new Ze,M=new Ze,C=new Ze;for(let k=0;k<=r;++k){const H=k/r*s*Math.PI*2;L(H,s,a,e,y),L(H+.01,s,a,e,S),M.subVectors(S,y),C.addVectors(S,y),E.crossVectors(M,C),C.crossVectors(E,M),E.normalize(),C.normalize();for(let q=0;q<=i;++q){const Z=q/i*Math.PI*2,ee=-t*Math.cos(Z),re=t*Math.sin(Z);m.x=y.x+(ee*C.x+re*E.x),m.y=y.y+(ee*C.y+re*E.y),m.z=y.z+(ee*C.z+re*E.z),o.push(m.x,m.y,m.z),v.subVectors(m,y).normalize(),h.push(v.x,v.y,v.z),d.push(k/r),d.push(q/i)}}for(let k=1;k<=r;k++)for(let H=1;H<=i;H++){const q=(i+1)*(k-1)+(H-1),Z=(i+1)*k+(H-1),ee=(i+1)*k+H,re=(i+1)*(k-1)+H;l.push(q,Z,re),l.push(Z,ee,re)}this.setIndex(l),this.setAttribute("position",new ar(o,3)),this.setAttribute("normal",new ar(h,3)),this.setAttribute("uv",new ar(d,2));function L(k,H,q,Z,ee){const re=Math.cos(k),se=Math.sin(k),ae=q/H*k,fe=Math.cos(ae);ee.x=Z*(2+fe)*.5*re,ee.y=Z*(2+fe)*se*.5,ee.z=Z*Math.sin(ae)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vD(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class _D extends $r{constructor(e=new Q6(new Ze(-1,-1,0),new Ze(-1,1,0),new Ze(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new Ze,o=new Ze,h=new nn;let d=new Ze;const m=[],v=[],y=[],S=[];E(),this.setIndex(S),this.setAttribute("position",new ar(m,3)),this.setAttribute("normal",new ar(v,3)),this.setAttribute("uv",new ar(y,2));function E(){for(let k=0;k<t;k++)M(k);M(s===!1?t:0),L(),C()}function M(k){d=e.getPointAt(k/t,d);const H=a.normals[k],q=a.binormals[k];for(let Z=0;Z<=i;Z++){const ee=Z/i*Math.PI*2,re=Math.sin(ee),se=-Math.cos(ee);o.x=se*H.x+re*q.x,o.y=se*H.y+re*q.y,o.z=se*H.z+re*q.z,o.normalize(),v.push(o.x,o.y,o.z),l.x=d.x+r*o.x,l.y=d.y+r*o.y,l.z=d.z+r*o.z,m.push(l.x,l.y,l.z)}}function C(){for(let k=1;k<=t;k++)for(let H=1;H<=i;H++){const q=(i+1)*(k-1)+(H-1),Z=(i+1)*k+(H-1),ee=(i+1)*k+H,re=(i+1)*(k-1)+H;S.push(q,Z,re),S.push(Z,ee,re)}}function L(){for(let k=0;k<=t;k++)for(let H=0;H<=i;H++)h.x=k/t,h.y=H/i,y.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new _D(new vP[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class fne extends $r{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new Ze,s=new Ze;if(e.index!==null){const a=e.attributes.position,l=e.index;let o=e.groups;o.length===0&&(o=[{start:0,count:l.count,materialIndex:0}]);for(let h=0,d=o.length;h<d;++h){const m=o[h],v=m.start,y=m.count;for(let S=v,E=v+y;S<E;S+=3)for(let M=0;M<3;M++){const C=l.getX(S+M),L=l.getX(S+(M+1)%3);i.fromBufferAttribute(a,C),s.fromBufferAttribute(a,L),wW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let l=0,o=a.count/3;l<o;l++)for(let h=0;h<3;h++){const d=3*l+h,m=3*l+(h+1)%3;i.fromBufferAttribute(a,d),s.fromBufferAttribute(a,m),wW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new ar(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function wW(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var SW=Object.freeze({__proto__:null,BoxGeometry:_p,CapsuleGeometry:lD,CircleGeometry:cD,ConeGeometry:uD,CylinderGeometry:ww,DodecahedronGeometry:hD,EdgesGeometry:lne,ExtrudeGeometry:dD,IcosahedronGeometry:t1,LatheGeometry:$T,OctahedronGeometry:qT,PlaneGeometry:tg,PolyhedronGeometry:Iv,RingGeometry:pD,ShapeGeometry:mD,SphereGeometry:km,TetrahedronGeometry:gD,TorusGeometry:ZT,TorusKnotGeometry:vD,TubeGeometry:_D,WireframeGeometry:fne});class dne extends yo{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Vn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class pne extends Io{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class fp extends yo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Vn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zu,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Wo extends fp{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new nn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ta(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Vn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Vn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Vn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class YT extends yo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Vn(16777215),this.specular=new Vn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zu,this.combine=OT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mne extends yo{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Vn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class gne extends yo{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class KT extends yo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zu,this.combine=OT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vne extends yo{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ev,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class tU extends Ma{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function by(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function _ne(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function yne(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function CF(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,a=0;a!==r;++s){const l=t[s]*e;for(let o=0;o!==e;++o)i[a++]=n[l+o]}return i}function nU(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(e.push(s.time),t.push.apply(t,a)),s=n[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do a=s[r],a!==void 0&&(e.push(s.time),t.push(a)),s=n[i++];while(s!==void 0)}function Sbe(n,e,t,r,i=30){const s=n.clone();s.name=e;const a=[];for(let o=0;o<s.tracks.length;++o){const h=s.tracks[o],d=h.getValueSize(),m=[],v=[];for(let y=0;y<h.times.length;++y){const S=h.times[y]*i;if(!(S<t||S>=r)){m.push(h.times[y]);for(let E=0;E<d;++E)v.push(h.values[y*d+E])}}m.length!==0&&(h.times=by(m,h.times.constructor),h.values=by(v,h.values.constructor),a.push(h))}s.tracks=a;let l=1/0;for(let o=0;o<s.tracks.length;++o)l>s.tracks[o].times[0]&&(l=s.tracks[o].times[0]);for(let o=0;o<s.tracks.length;++o)s.tracks[o].shift(-1*l);return s.resetDuration(),s}function Abe(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let a=0;a<i;++a){const l=t.tracks[a],o=l.ValueTypeName;if(o==="bool"||o==="string")continue;const h=n.tracks.find(function(C){return C.name===l.name&&C.ValueTypeName===o});if(h===void 0)continue;let d=0;const m=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);let v=0;const y=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=y/3);const S=l.times.length-1;let E;if(s<=l.times[0]){const C=d,L=m-d;E=l.values.slice(C,L)}else if(s>=l.times[S]){const C=S*m+d,L=C+m-d;E=l.values.slice(C,L)}else{const C=l.createInterpolant(),L=d,k=m-d;C.evaluate(s),E=C.resultBuffer.slice(L,k)}o==="quaternion"&&new Ta().fromArray(E).normalize().conjugate().toArray(E);const M=h.times.length;for(let C=0;C<M;++C){const L=C*y+v;if(o==="quaternion")Ta.multiplyQuaternionsFlat(h.values,L,E,0,h.values,L);else{const k=y-v*2;for(let H=0;H<k;++H)h.values[L+H]-=E[H]}}}return n.blendMode=O6,n}const Tbe={convertArray:by,isTypedArray:_ne,getKeyframeOrder:yne,sortedArray:CF,flattenJSON:nU,subclip:Sbe,makeClipAdditive:Abe};class v1{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let a;n:{r:if(!(e<i)){for(let l=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===l)break;if(s=i,i=t[++r],e<i)break t}a=t.length;break n}if(!(e>=s)){const l=t[1];e<l&&(r=2,s=l);for(let o=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=s,s=t[--r-1],e>=s)break t}a=r,r=0;break n}break e}for(;r<a;){const l=r+a>>>1;e<t[l]?a=l:r=l+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=r[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class xne extends v1{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_y,endingEnd:_y}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,a=e+1,l=i[s],o=i[a];if(l===void 0)switch(this.getSettings_().endingStart){case yy:s=e,l=2*t-r;break;case jA:s=i.length-2,l=t+i[s]-i[s+1];break;default:s=e,l=r}if(o===void 0)switch(this.getSettings_().endingEnd){case yy:a=e,o=2*r-t;break;case jA:a=1,o=r+i[1]-i[0];break;default:a=e-1,o=t}const h=(r-t)*.5,d=this.valueSize;this._weightPrev=h/(t-l),this._weightNext=h/(o-r),this._offsetPrev=s*d,this._offsetNext=a*d}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,o=e*l,h=o-l,d=this._offsetPrev,m=this._offsetNext,v=this._weightPrev,y=this._weightNext,S=(r-t)/(i-t),E=S*S,M=E*S,C=-v*M+2*v*E-v*S,L=(1+v)*M+(-1.5-2*v)*E+(-.5+v)*S+1,k=(-1-y)*M+(1.5+y)*E+.5*S,H=y*M-y*E;for(let q=0;q!==l;++q)s[q]=C*a[d+q]+L*a[h+q]+k*a[o+q]+H*a[m+q];return s}}class rU extends v1{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,o=e*l,h=o-l,d=(r-t)/(i-t),m=1-d;for(let v=0;v!==l;++v)s[v]=a[h+v]*m+a[o+v]*d;return s}}class bne extends v1{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class nd{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=by(t,this.TimeBufferType),this.values=by(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:by(e.times,Array),values:by(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new bne(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new rU(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new xne(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Jy:t=this.InterpolantFactoryMethodDiscrete;break;case hv:t=this.InterpolantFactoryMethodLinear;break;case WI:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jy;case this.InterpolantFactoryMethodLinear:return hv;case this.InterpolantFactoryMethodSmooth:return WI}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,a=i-1;for(;s!==i&&r[s]<e;)++s;for(;a!==-1&&r[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const l=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*l,a*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==s;l++){const o=r[l];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,o),e=!1;break}if(a!==null&&a>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,o,a),e=!1;break}a=o}if(i!==void 0&&_ne(i))for(let l=0,o=i.length;l!==o;++l){const h=i[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===WI,s=e.length-1;let a=1;for(let l=1;l<s;++l){let o=!1;const h=e[l],d=e[l+1];if(h!==d&&(l!==1||h!==e[0]))if(i)o=!0;else{const m=l*r,v=m-r,y=m+r;for(let S=0;S!==r;++S){const E=t[m+S];if(E!==t[v+S]||E!==t[y+S]){o=!0;break}}}if(o){if(l!==a){e[a]=e[l];const m=l*r,v=a*r;for(let y=0;y!==r;++y)t[v+y]=t[m+y]}++a}}if(s>0){e[a]=e[s];for(let l=s*r,o=a*r,h=0;h!==r;++h)t[o+h]=t[l+h];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}nd.prototype.TimeBufferType=Float32Array;nd.prototype.ValueBufferType=Float32Array;nd.prototype.DefaultInterpolation=hv;class _1 extends nd{constructor(e,t,r){super(e,t,r)}}_1.prototype.ValueTypeName="bool";_1.prototype.ValueBufferType=Array;_1.prototype.DefaultInterpolation=Jy;_1.prototype.InterpolantFactoryMethodLinear=void 0;_1.prototype.InterpolantFactoryMethodSmooth=void 0;class iU extends nd{}iU.prototype.ValueTypeName="color";class $m extends nd{}$m.prototype.ValueTypeName="number";class wne extends v1{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,o=(r-t)/(i-t);let h=e*l;for(let d=h+l;h!==d;h+=4)Ta.slerpFlat(s,0,a,h-l,a,h,o);return s}}class qm extends nd{InterpolantFactoryMethodLinear(e){return new wne(this.times,this.values,this.getValueSize(),e)}}qm.prototype.ValueTypeName="quaternion";qm.prototype.InterpolantFactoryMethodSmooth=void 0;class y1 extends nd{constructor(e,t,r){super(e,t,r)}}y1.prototype.ValueTypeName="string";y1.prototype.ValueBufferType=Array;y1.prototype.DefaultInterpolation=Jy;y1.prototype.InterpolantFactoryMethodLinear=void 0;y1.prototype.InterpolantFactoryMethodSmooth=void 0;class Zm extends nd{}Zm.prototype.ValueTypeName="vector";class n1{constructor(e="",t=-1,r=[],i=JL){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=ku(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,l=r.length;a!==l;++a)t.push(Cbe(r[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=r.length;s!==a;++s)t.push(nd.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,a=[];for(let l=0;l<s;l++){let o=[],h=[];o.push((l+s-1)%s,l,(l+1)%s),h.push(0,1,0);const d=yne(o);o=CF(o,1,d),h=CF(h,1,d),!i&&o[0]===0&&(o.push(s),h.push(h[0])),a.push(new $m(".morphTargetInfluences["+t[l].name+"]",o,h).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,o=e.length;l<o;l++){const h=e[l],d=h.name.match(s);if(d&&d.length>1){const m=d[1];let v=i[m];v||(i[m]=v=[]),v.push(h)}}const a=[];for(const l in i)a.push(this.CreateFromMorphTargetSequence(l,i[l],t,r));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(m,v,y,S,E){if(y.length!==0){const M=[],C=[];nU(y,M,C,S),M.length!==0&&E.push(new m(v,M,C))}},i=[],s=e.name||"default",a=e.fps||30,l=e.blendMode;let o=e.length||-1;const h=e.hierarchy||[];for(let m=0;m<h.length;m++){const v=h[m].keys;if(!(!v||v.length===0))if(v[0].morphTargets){const y={};let S;for(S=0;S<v.length;S++)if(v[S].morphTargets)for(let E=0;E<v[S].morphTargets.length;E++)y[v[S].morphTargets[E]]=-1;for(const E in y){const M=[],C=[];for(let L=0;L!==v[S].morphTargets.length;++L){const k=v[S];M.push(k.time),C.push(k.morphTarget===E?1:0)}i.push(new $m(".morphTargetInfluence["+E+"]",M,C))}o=y.length*a}else{const y=".bones["+t[m].name+"]";r(Zm,y+".position",v,"pos",i),r(qm,y+".quaternion",v,"rot",i),r(Zm,y+".scale",v,"scl",i)}}return i.length===0?null:new this(s,o,i,l)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Mbe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $m;case"vector":case"vector2":case"vector3":case"vector4":return Zm;case"color":return iU;case"quaternion":return qm;case"bool":case"boolean":return _1;case"string":return y1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Cbe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Mbe(n.type);if(n.times===void 0){const t=[],r=[];nU(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Im={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class JT{constructor(e,t,r){const i=this;let s=!1,a=0,l=0,o;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(d){l++,s===!1&&i.onStart!==void 0&&i.onStart(d,a,l),s=!0},this.itemEnd=function(d){a++,i.onProgress!==void 0&&i.onProgress(d,a,l),a===l&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return o?o(d):d},this.setURLModifier=function(d){return o=d,this},this.addHandler=function(d,m){return h.push(d,m),this},this.removeHandler=function(d){const m=h.indexOf(d);return m!==-1&&h.splice(m,2),this},this.getHandler=function(d){for(let m=0,v=h.length;m<v;m+=2){const y=h[m],S=h[m+1];if(y.global&&(y.lastIndex=0),y.test(d))return S}return null}}}const sU=new JT;let Ia=class{constructor(e){this.manager=e!==void 0?e:sU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Ia.DEFAULT_MATERIAL_NAME="__DEFAULT";const dm={};class Ebe extends Error{constructor(e,t){super(e),this.response=t}}class Xa extends Ia{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Im.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(dm[e]!==void 0){dm[e].push({onLoad:t,onProgress:r,onError:i});return}dm[e]=[],dm[e].push({onLoad:t,onProgress:r,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,o=this.responseType;fetch(a).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const d=dm[e],m=h.body.getReader(),v=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),y=v?parseInt(v):0,S=y!==0;let E=0;const M=new ReadableStream({start(C){L();function L(){m.read().then(({done:k,value:H})=>{if(k)C.close();else{E+=H.byteLength;const q=new ProgressEvent("progress",{lengthComputable:S,loaded:E,total:y});for(let Z=0,ee=d.length;Z<ee;Z++){const re=d[Z];re.onProgress&&re.onProgress(q)}C.enqueue(H),L()}},k=>{C.error(k)})}}});return new Response(M)}else throw new Ebe(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(o){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(d=>new DOMParser().parseFromString(d,l));case"json":return h.json();default:if(l===void 0)return h.text();{const m=/charset="?([^;"\s]*)"?/i.exec(l),v=m&&m[1]?m[1].toLowerCase():void 0,y=new TextDecoder(v);return h.arrayBuffer().then(S=>y.decode(S))}}}).then(h=>{Im.add(e,h);const d=dm[e];delete dm[e];for(let m=0,v=d.length;m<v;m++){const y=d[m];y.onLoad&&y.onLoad(h)}}).catch(h=>{const d=dm[e];if(d===void 0)throw this.manager.itemError(e),h;delete dm[e];for(let m=0,v=d.length;m<v;m++){const y=d[m];y.onError&&y.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Ibe extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Xa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(o){i?i(o):console.error(o),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=n1.parse(e[r]);t.push(i)}return t}}class Rbe extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=[],l=new oD,o=new Xa(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(s.withCredentials);let h=0;function d(m){o.load(e[m],function(v){const y=s.parse(v,!0);a[m]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},h+=1,h===6&&(y.mipmapCount===1&&(l.minFilter=Eo),l.image=a,l.format=y.format,l.needsUpdate=!0,t&&t(l))},r,i)}if(Array.isArray(e))for(let m=0,v=e.length;m<v;++m)d(m);else o.load(e,function(m){const v=s.parse(m,!0);if(v.isCubemap){const y=v.mipmaps.length/v.mipmapCount;for(let S=0;S<y;S++){a[S]={mipmaps:[]};for(let E=0;E<v.mipmapCount;E++)a[S].mipmaps.push(v.mipmaps[S*v.mipmapCount+E]),a[S].format=v.format,a[S].width=v.width,a[S].height=v.height}l.image=a}else l.image.width=v.width,l.image.height=v.height,l.mipmaps=v.mipmaps;v.mipmapCount===1&&(l.minFilter=Eo),l.format=v.format,l.needsUpdate=!0,t&&t(l)},r,i);return l}}class tT extends Ia{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Im.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const l=YA("img");function o(){d(),Im.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(m){d(),i&&i(m),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){l.removeEventListener("load",o,!1),l.removeEventListener("error",h,!1)}return l.addEventListener("load",o,!1),l.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(e),l.src=e,l}}class Sne extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=new HT;s.colorSpace=To;const a=new tT(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let l=0;function o(h){a.load(e[h],function(d){s.images[h]=d,l++,l===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let h=0;h<e.length;++h)o(h);return s}}class Pbe extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new $f,l=new Xa(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(s.withCredentials),l.load(e,function(o){let h;try{h=s.parse(o)}catch(d){if(i!==void 0)i(d);else{console.error(d);return}}h.image!==void 0?a.image=h.image:h.data!==void 0&&(a.image.width=h.width,a.image.height=h.height,a.image.data=h.data),a.wrapS=h.wrapS!==void 0?h.wrapS:su,a.wrapT=h.wrapT!==void 0?h.wrapT:su,a.magFilter=h.magFilter!==void 0?h.magFilter:Eo,a.minFilter=h.minFilter!==void 0?h.minFilter:Eo,a.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(a.colorSpace=h.colorSpace),h.flipY!==void 0&&(a.flipY=h.flipY),h.format!==void 0&&(a.format=h.format),h.type!==void 0&&(a.type=h.type),h.mipmaps!==void 0&&(a.mipmaps=h.mipmaps,a.minFilter=ou),h.mipmapCount===1&&(a.minFilter=Eo),h.generateMipmaps!==void 0&&(a.generateMipmaps=h.generateMipmaps),a.needsUpdate=!0,t&&t(a,h)},r,i),a}}class Kf extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=new Xs,a=new tT(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){s.image=l,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class Rv extends Ri{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Vn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class Ane extends Rv{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Vn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const W5=new Gr,AW=new Ze,TW=new Ze;class oU{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new nn(512,512),this.map=null,this.mapPass=null,this.matrix=new Gr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new jT,this._frameExtents=new nn(1,1),this._viewportCount=1,this._viewports=[new Is(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;AW.setFromMatrixPosition(e.matrixWorld),t.position.copy(AW),TW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(TW),t.updateMatrixWorld(),W5.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(W5),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(W5)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Lbe extends oU{constructor(){super(new ts(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=Qb*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class yD extends Rv{constructor(e,t,r=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.distance=r,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Lbe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const MW=new Gr,k2=new Ze,X5=new Ze;class Dbe extends oU{constructor(){super(new ts(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new nn(4,2),this._viewportCount=6,this._viewports=[new Is(2,1,1,1),new Is(0,1,1,1),new Is(3,1,1,1),new Is(1,1,1,1),new Is(3,0,1,1),new Is(1,0,1,1)],this._cubeDirections=[new Ze(1,0,0),new Ze(-1,0,0),new Ze(0,0,1),new Ze(0,0,-1),new Ze(0,1,0),new Ze(0,-1,0)],this._cubeUps=[new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,0,1),new Ze(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),k2.setFromMatrixPosition(e.matrixWorld),r.position.copy(k2),X5.copy(r.position),X5.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(X5),r.updateMatrixWorld(),i.makeTranslation(-k2.x,-k2.y,-k2.z),MW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MW)}}class rv extends Rv{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Dbe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Bbe extends oU{constructor(){super(new ed(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Pv extends Rv{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.shadow=new Bbe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class x1 extends Rv{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Tne extends Rv{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Mne{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ze)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],1.092548*(r*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(r*s)),t.addScaledVector(a[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*r),t.addScaledVector(a[4],2*.429043*r*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*r*s),t.addScaledVector(a[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class Cne extends Rv{constructor(e=new Mne,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class xD extends Ia{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,a=new Xa(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(o){i?i(o):console.error(o),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=xD.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Vn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=r(a.value);break;case"c":i.uniforms[s].value=new Vn().setHex(a.value);break;case"v2":i.uniforms[s].value=new nn().fromArray(a.value);break;case"v3":i.uniforms[s].value=new Ze().fromArray(a.value);break;case"v4":i.uniforms[s].value=new Is().fromArray(a.value);break;case"m3":i.uniforms[s].value=new wi().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Gr().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new nn().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new nn().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:dne,SpriteMaterial:nD,RawShaderMaterial:pne,ShaderMaterial:Io,PointsMaterial:au,MeshPhysicalMaterial:Wo,MeshStandardMaterial:fp,MeshPhongMaterial:YT,MeshToonMaterial:mne,MeshNormalMaterial:gne,MeshLambertMaterial:KT,MeshDepthMaterial:X6,MeshDistanceMaterial:$6,MeshBasicMaterial:_o,MeshMatcapMaterial:vne,LineDashedMaterial:tU,LineBasicMaterial:Ma,Material:yo};return new t[e]}}class hu{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Ene extends $r{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Ine extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Xa(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(o){i?i(o):console.error(o),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(y,S){if(t[S]!==void 0)return t[S];const M=y.interleavedBuffers[S],C=s(y,M.buffer),L=db(M.type,C),k=new xw(L,M.stride);return k.uuid=M.uuid,t[S]=k,k}function s(y,S){if(r[S]!==void 0)return r[S];const M=y.arrayBuffers[S],C=new Uint32Array(M).buffer;return r[S]=C,C}const a=e.isInstancedBufferGeometry?new Ene:new $r,l=e.data.index;if(l!==void 0){const y=db(l.type,l.array);a.setIndex(new Bi(y,1))}const o=e.data.attributes;for(const y in o){const S=o[y];let E;if(S.isInterleavedBufferAttribute){const M=i(e.data,S.data);E=new Xm(M,S.itemSize,S.offset,S.normalized)}else{const M=db(S.type,S.array),C=S.isInstancedBufferAttribute?fv:Bi;E=new C(M,S.itemSize,S.normalized)}S.name!==void 0&&(E.name=S.name),S.usage!==void 0&&E.setUsage(S.usage),a.setAttribute(y,E)}const h=e.data.morphAttributes;if(h)for(const y in h){const S=h[y],E=[];for(let M=0,C=S.length;M<C;M++){const L=S[M];let k;if(L.isInterleavedBufferAttribute){const H=i(e.data,L.data);k=new Xm(H,L.itemSize,L.offset,L.normalized)}else{const H=db(L.type,L.array);k=new Bi(H,L.itemSize,L.normalized)}L.name!==void 0&&(k.name=L.name),E.push(k)}a.morphAttributes[y]=E}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const m=e.data.groups||e.data.drawcalls||e.data.offsets;if(m!==void 0)for(let y=0,S=m.length;y!==S;++y){const E=m[y];a.addGroup(E.start,E.count,E.materialIndex)}const v=e.data.boundingSphere;if(v!==void 0){const y=new Ze;v.center!==void 0&&y.fromArray(v.center),a.boundingSphere=new il(y,v.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class kbe extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=this.path===""?hu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const l=new Xa(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(o){let h=null;try{h=JSON.parse(o)}catch(m){i!==void 0&&i(m),console.error("THREE:ObjectLoader: Can't parse "+e+".",m.message);return}const d=h.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?hu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Xa(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),l=JSON.parse(a),o=l.metadata;if(o===void 0||o.type===void 0||o.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(l)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(h)}),l=this.parseTextures(e.textures,a),o=this.parseMaterials(e.materials,l),h=this.parseObject(e.object,s,o,l,r),d=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,d),this.bindLightTargets(h),t!==void 0){let m=!1;for(const v in a)if(a[v].data instanceof HTMLImageElement){m=!0;break}m===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),l=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,i,l,a,t),h=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,h),this.bindLightTargets(o),o}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new Fy().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const l=new bw().fromJSON(e[s],i);r[l.uuid]=l}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new Ine;for(let s=0,a=e.length;s<a;s++){let l;const o=e[s];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":l=i.parse(o);break;default:o.type in SW?l=SW[o.type].fromJSON(o,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}l.uuid=o.uuid,o.name!==void 0&&(l.name=o.name),o.userData!==void 0&&(l.userData=o.userData),r[o.uuid]=l}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new xD;s.setTextures(t);for(let a=0,l=e.length;a<l;a++){const o=e[a];r[o.uuid]===void 0&&(r[o.uuid]=s.parse(o)),i[o.uuid]=r[o.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=n1.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function a(o){return r.manager.itemStart(o),s.load(o,function(){r.manager.itemEnd(o)},void 0,function(){r.manager.itemError(o),r.manager.itemEnd(o)})}function l(o){if(typeof o=="string"){const h=o,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:r.resourcePath+h;return a(d)}else return o.data?{data:db(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){const o=new JT(t);s=new tT(o),s.setCrossOrigin(this.crossOrigin);for(let h=0,d=e.length;h<d;h++){const m=e[h],v=m.url;if(Array.isArray(v)){const y=[];for(let S=0,E=v.length;S<E;S++){const M=v[S],C=l(M);C!==null&&(C instanceof HTMLImageElement?y.push(C):y.push(new $f(C.data,C.width,C.height)))}i[m.uuid]=new xy(y)}else{const y=l(m.url);i[m.uuid]=new xy(y)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(a){if(typeof a=="string"){const l=a,o=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await i.loadAsync(o)}else return a.data?{data:db(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new tT(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,l=e.length;a<l;a++){const o=e[a],h=o.url;if(Array.isArray(h)){const d=[];for(let m=0,v=h.length;m<v;m++){const y=h[m],S=await s(y);S!==null&&(S instanceof HTMLImageElement?d.push(S):d.push(new $f(S.data,S.width,S.height)))}r[o.uuid]=new xy(d)}else{const d=await s(o.url);r[o.uuid]=new xy(d)}}}return r}parseTextures(e,t){function r(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const l=e[s];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const o=t[l.image],h=o.data;let d;Array.isArray(h)?(d=new HT,h.length===6&&(d.needsUpdate=!0)):(h&&h.data?d=new $f:d=new Xs,h&&(d.needsUpdate=!0)),d.source=o,d.uuid=l.uuid,l.name!==void 0&&(d.name=l.name),l.mapping!==void 0&&(d.mapping=r(l.mapping,Obe)),l.channel!==void 0&&(d.channel=l.channel),l.offset!==void 0&&d.offset.fromArray(l.offset),l.repeat!==void 0&&d.repeat.fromArray(l.repeat),l.center!==void 0&&d.center.fromArray(l.center),l.rotation!==void 0&&(d.rotation=l.rotation),l.wrap!==void 0&&(d.wrapS=r(l.wrap[0],CW),d.wrapT=r(l.wrap[1],CW)),l.format!==void 0&&(d.format=l.format),l.internalFormat!==void 0&&(d.internalFormat=l.internalFormat),l.type!==void 0&&(d.type=l.type),l.colorSpace!==void 0&&(d.colorSpace=l.colorSpace),l.minFilter!==void 0&&(d.minFilter=r(l.minFilter,EW)),l.magFilter!==void 0&&(d.magFilter=r(l.magFilter,EW)),l.anisotropy!==void 0&&(d.anisotropy=l.anisotropy),l.flipY!==void 0&&(d.flipY=l.flipY),l.generateMipmaps!==void 0&&(d.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(d.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(d.compareFunction=l.compareFunction),l.userData!==void 0&&(d.userData=l.userData),i[l.uuid]=d}return i}parseObject(e,t,r,i,s){let a;function l(v){return t[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",v),t[v]}function o(v){if(v!==void 0){if(Array.isArray(v)){const y=[];for(let S=0,E=v.length;S<E;S++){const M=v[S];r[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),y.push(r[M])}return y}return r[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),r[v]}}function h(v){return i[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",v),i[v]}let d,m;switch(e.type){case"Scene":a=new Tl,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Vn(e.background):a.background=h(e.background)),e.environment!==void 0&&(a.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new yw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new WT(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new ts(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new ed(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new x1(e.color,e.intensity);break;case"DirectionalLight":a=new Pv(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new rv(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Tne(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new yD(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new Ane(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new Cne().fromJSON(e);break;case"SkinnedMesh":d=l(e.geometry),m=o(e.material),a=new rD(d,m),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":d=l(e.geometry),m=o(e.material),a=new Ii(d,m);break;case"InstancedMesh":d=l(e.geometry),m=o(e.material);const v=e.count,y=e.instanceMatrix,S=e.instanceColor;a=new iD(d,m,v),a.instanceMatrix=new fv(new Float32Array(y.array),16),S!==void 0&&(a.instanceColor=new fv(new Float32Array(S.array),S.itemSize));break;case"BatchedMesh":d=l(e.geometry),m=o(e.material),a=new tne(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,m),a.geometry=d,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(E=>{const M=new Sl;M.min.fromArray(E.boxMin),M.max.fromArray(E.boxMax);const C=new il;return C.radius=E.sphereRadius,C.center.fromArray(E.sphereCenter),{boxInitialized:E.boxInitialized,box:M,sphereInitialized:E.sphereInitialized,sphere:C}}),a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=h(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=h(e.colorsTexture.uuid));break;case"LOD":a=new ene;break;case"Line":a=new Yf(l(e.geometry),o(e.material));break;case"LineLoop":a=new sD(l(e.geometry),o(e.material));break;case"LineSegments":a=new fu(l(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new Th(l(e.geometry),o(e.material));break;case"Sprite":a=new q6(o(e.material));break;case"Group":a=new Xl;break;case"Bone":a=new XT;break;default:a=new Ri}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const v=e.children;for(let y=0;y<v.length;y++)a.add(this.parseObject(v[y],t,r,i,s))}if(e.animations!==void 0){const v=e.animations;for(let y=0;y<v.length;y++){const S=v[y];a.animations.push(s[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const v=e.levels;for(let y=0;y<v.length;y++){const S=v[y],E=a.getObjectByProperty("uuid",S.object);E!==void 0&&a.addLevel(E,S.distance,S.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,i=e.getObjectByProperty("uuid",r);i!==void 0?t.target=i:t.target=new Ri}})}}const Obe={UVMapping:XL,CubeReflectionMapping:Hm,CubeRefractionMapping:uv,EquirectangularReflectionMapping:VA,EquirectangularRefractionMapping:HA,CubeUVReflectionMapping:vw},CW={RepeatWrapping:Bh,ClampToEdgeWrapping:su,MirroredRepeatWrapping:Zy},EW={NearestFilter:Sa,NearestMipmapNearestFilter:FT,NearestMipmapLinearFilter:V0,LinearFilter:Eo,LinearMipmapNearestFilter:Dy,LinearMipmapLinearFilter:ou};class aU extends Ia{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Im.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(h=>{t&&t(h),s.manager.itemEnd(e)}).catch(h=>{i&&i(h)});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;const o=fetch(e,l).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){return Im.add(e,h),t&&t(h),s.manager.itemEnd(e),h}).catch(function(h){i&&i(h),Im.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Im.add(e,o),s.manager.itemStart(e)}}let fE;class lU{static getContext(){return fE===void 0&&(fE=new(window.AudioContext||window.webkitAudioContext)),fE}static setContext(e){fE=e}}class Rne extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Xa(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{const h=o.slice(0);lU.getContext().decodeAudioData(h,function(m){t(m)}).catch(l)}catch(h){l(h)}},r,i);function l(o){i?i(o):console.error(o),s.manager.itemError(e)}}}const IW=new Gr,RW=new Gr,M_=new Gr;class Fbe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ts,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ts,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,M_.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(ky*t.fov*.5)/t.zoom;let l,o;RW.elements[12]=-i,IW.elements[12]=i,l=-a*t.aspect+s,o=a*t.aspect+s,M_.elements[0]=2*t.near/(o-l),M_.elements[8]=(o+l)/(o-l),this.cameraL.projectionMatrix.copy(M_),l=-a*t.aspect-s,o=a*t.aspect-s,M_.elements[0]=2*t.near/(o-l),M_.elements[8]=(o+l)/(o-l),this.cameraR.projectionMatrix.copy(M_)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(RW),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(IW)}}class ng{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=PW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=PW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function PW(){return(typeof performance>"u"?Date:performance).now()}const C_=new Ze,LW=new Ta,Nbe=new Ze,E_=new Ze;class Pne extends Ri{constructor(){super(),this.type="AudioListener",this.context=lU.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ng}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(C_,LW,Nbe),E_.set(0,0,-1).applyQuaternion(LW),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(C_.x,i),t.positionY.linearRampToValueAtTime(C_.y,i),t.positionZ.linearRampToValueAtTime(C_.z,i),t.forwardX.linearRampToValueAtTime(E_.x,i),t.forwardY.linearRampToValueAtTime(E_.y,i),t.forwardZ.linearRampToValueAtTime(E_.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(C_.x,C_.y,C_.z),t.setOrientation(E_.x,E_.y,E_.z,r.x,r.y,r.z)}}let Lne=class extends Ri{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const I_=new Ze,DW=new Ta,zbe=new Ze,R_=new Ze;class Dne extends Lne{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(I_,DW,zbe),R_.set(0,0,1).applyQuaternion(DW);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(I_.x,r),t.positionY.linearRampToValueAtTime(I_.y,r),t.positionZ.linearRampToValueAtTime(I_.z,r),t.orientationX.linearRampToValueAtTime(R_.x,r),t.orientationY.linearRampToValueAtTime(R_.y,r),t.orientationZ.linearRampToValueAtTime(R_.z,r)}else t.setPosition(I_.x,I_.y,I_.z),t.setOrientation(R_.x,R_.y,R_.z)}}class Ube{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class Bne{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let l=0;l!==i;++l)r[s+l]=r[l];a=t}else{a+=t;const l=t/a;this._mixBufferRegion(r,s,0,l,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-s,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,h=t+t;o!==h;++o)if(r[o]!==r[o+t]){l.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,a=i;s!==a;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){Ta.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const a=this._workIndex*s;Ta.multiplyQuaternionsFlat(e,a,e,t,e,r),Ta.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,s){const a=1-i;for(let l=0;l!==s;++l){const o=t+l;e[o]=e[o]*a+e[r+l]*i}}_lerpAdditive(e,t,r,i,s){for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]+e[r+a]*i}}}const cU="\\[\\]\\.:\\/",Gbe=new RegExp("["+cU+"]","g"),uU="[^"+cU+"]",Vbe="[^"+cU.replace("\\.","")+"]",Hbe=/((?:WC+[\/:])*)/.source.replace("WC",uU),jbe=/(WCOD+)?/.source.replace("WCOD",Vbe),Wbe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",uU),Xbe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",uU),$be=new RegExp("^"+Hbe+jbe+Wbe+Xbe+"$"),qbe=["material","materials","bones","map"];class Zbe{constructor(e,t,r){const i=r||es.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class es{constructor(e,t,r){this.path=t,this.parsedPath=r||es.parseTrackName(t),this.node=es.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new es.Composite(e,t,r):new es(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Gbe,"")}static parseTrackName(e){const t=$be.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);qbe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let a=0;a<s.length;a++){const l=s[a];if(l.name===t||l.uuid===t)return l;const o=r(l.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=es.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let h=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===h){h=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const a=e[i];if(a===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}es.Composite=Zbe;es.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};es.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};es.prototype.GetterByBindingType=[es.prototype._getValue_direct,es.prototype._getValue_array,es.prototype._getValue_arrayElement,es.prototype._getValue_toArray];es.prototype.SetterByBindingTypeAndVersioning=[[es.prototype._setValue_direct,es.prototype._setValue_direct_setNeedsUpdate,es.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[es.prototype._setValue_array,es.prototype._setValue_array_setNeedsUpdate,es.prototype._setValue_array_setMatrixWorldNeedsUpdate],[es.prototype._setValue_arrayElement,es.prototype._setValue_arrayElement_setNeedsUpdate,es.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[es.prototype._setValue_fromArray,es.prototype._setValue_fromArray_setNeedsUpdate,es.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ybe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ku(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let l,o=e.length,h=this.nCachedObjects_;for(let d=0,m=arguments.length;d!==m;++d){const v=arguments[d],y=v.uuid;let S=t[y];if(S===void 0){S=o++,t[y]=S,e.push(v);for(let E=0,M=a;E!==M;++E)s[E].push(new es(v,r[E],i[E]))}else if(S<h){l=e[S];const E=--h,M=e[E];t[M.uuid]=S,e[S]=M,t[y]=E,e[E]=v;for(let C=0,L=a;C!==L;++C){const k=s[C],H=k[E];let q=k[S];k[S]=H,q===void 0&&(q=new es(v,r[C],i[C])),k[E]=q}}else e[S]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let a=0,l=arguments.length;a!==l;++a){const o=arguments[a],h=o.uuid,d=t[h];if(d!==void 0&&d>=s){const m=s++,v=e[m];t[v.uuid]=d,e[d]=v,t[h]=m,e[m]=o;for(let y=0,S=i;y!==S;++y){const E=r[y],M=E[m],C=E[d];E[d]=M,E[m]=C}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,a=e.length;for(let l=0,o=arguments.length;l!==o;++l){const h=arguments[l],d=h.uuid,m=t[d];if(m!==void 0)if(delete t[d],m<s){const v=--s,y=e[v],S=--a,E=e[S];t[y.uuid]=m,e[m]=y,t[E.uuid]=v,e[v]=E,e.pop();for(let M=0,C=i;M!==C;++M){const L=r[M],k=L[v],H=L[S];L[m]=k,L[v]=H,L.pop()}}else{const v=--a,y=e[v];v>0&&(t[y.uuid]=m),e[m]=y,e.pop();for(let S=0,E=i;S!==E;++S){const M=r[S];M[m]=M[v],M.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,l=this._parsedPaths,o=this._objects,h=o.length,d=this.nCachedObjects_,m=new Array(h);i=s.length,r[e]=i,a.push(e),l.push(t),s.push(m);for(let v=d,y=o.length;v!==y;++v){const S=o[v];m[v]=new es(S,e,t)}return m}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,l=a.length-1,o=a[l],h=e[l];t[h]=r,a[r]=o,a.pop(),s[r]=s[l],s.pop(),i[r]=i[l],i.pop()}}}class kne{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,a=s.length,l=new Array(a),o={endingStart:_y,endingEnd:_y};for(let h=0;h!==a;++h){const d=s[h].createInterpolant(null);l[h]=d,d.settings=o}this._interpolantSettings=o,this._interpolants=l,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Mte,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,a=s/i,l=i/s;e.warp(1,a,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,a=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=i._lendControlInterpolant(),this._timeScaleInterpolant=l);const o=l.parameterPositions,h=l.sampleValues;return o[0]=s,o[1]=s+r,h[0]=e/a,h[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const o=(e-s)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);const a=this._updateTime(t),l=this._updateWeight(e);if(l>0){const o=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case O6:for(let d=0,m=o.length;d!==m;++d)o[d].evaluate(a),h[d].accumulateAdditive(l);break;case JL:default:for(let d=0,m=o.length;d!==m;++d)o[d].evaluate(a),h[d].accumulate(i,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const a=r===Cte;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(r===Tte){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const l=Math.floor(i/t);i-=t*l,s+=Math.abs(l);const o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){const h=e<0;this._setEndings(h,!h,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=yy,i.endingEnd=yy):(e?i.endingStart=this.zeroSlopeAtStart?yy:_y:i.endingStart=jA,t?i.endingEnd=this.zeroSlopeAtEnd?yy:_y:i.endingEnd=jA)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const l=a.parameterPositions,o=a.sampleValues;return l[0]=s,o[0]=t,l[1]=s+e,o[1]=r,this}}const Kbe=new Float32Array(1);class One extends vp{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,l=e._interpolants,o=r.uuid,h=this._bindingsByRootAndName;let d=h[o];d===void 0&&(d={},h[o]=d);for(let m=0;m!==s;++m){const v=i[m],y=v.name;let S=d[y];if(S!==void 0)++S.referenceCount,a[m]=S;else{if(S=a[m],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,o,y));continue}const E=t&&t._propertyBindings[m].binding.parsedPath;S=new Bne(es.create(r,y,E),v.ValueTypeName,v.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,o,y),a[m]=S}l[m].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const l=a.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,l=a[s],o=l.knownActions,h=o[o.length-1],d=e._byClipCacheIndex;h._byClipCacheIndex=d,o[d]=h,o.pop(),e._byClipCacheIndex=null;const m=l.actionByRoot,v=(e._localRoot||this._root).uuid;delete m[v],o.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,l=a[i],o=t[t.length-1],h=e._cacheIndex;o._cacheIndex=h,t[h]=o,t.pop(),delete l[s],Object.keys(l).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new rU(new Float32Array(2),new Float32Array(2),1,Kbe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?n1.findByName(i,e):e;const l=a!==null?a.uuid:e,o=this._actionsByClip[l];let h=null;if(r===void 0&&(a!==null?r=a.blendMode:r=JL),o!==void 0){const m=o.actionByRoot[s];if(m!==void 0&&m.blendMode===r)return m;h=o.knownActions[0],a===null&&(a=h._clip)}if(a===null)return null;const d=new kne(this,a,t,r);return this._bindAction(d,h),this._addInactiveAction(d,l,s),d}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?n1.findByName(r,e):e,a=s?s.uuid:e,l=this._actionsByClip[a];return l!==void 0&&l.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let h=0;h!==r;++h)t[h]._update(i,e,s,a);const l=this._bindings,o=this._nActiveBindings;for(let h=0;h!==o;++h)l[h].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const a=s.knownActions;for(let l=0,o=a.length;l!==o;++l){const h=a[l];this._deactivateAction(h);const d=h._cacheIndex,m=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,m._cacheIndex=d,t[d]=m,t.pop(),this._removeInactiveBindingsForAction(h)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const a in r){const l=r[a].actionByRoot,o=l[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const l=s[a];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class hU{constructor(e){this.value=e}clone(){return new hU(this.value.clone===void 0?this.value:this.value.clone())}}let Jbe=0;class Qbe extends vp{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Jbe++}),this.name="",this.usage=qA,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class ewe extends xw{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class twe{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const BW=new Gr;class bD{constructor(e,t,r=0,i=1/0){this.ray=new g1(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new Oy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return BW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(BW),this}intersectObject(e,t=!0,r=[]){return EF(e,this,r,t),r.sort(kW),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)EF(e[i],this,r,t);return r.sort(kW),r}}function kW(n,e){return n.distance-e.distance}function EF(n,e,t,r){let i=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(i=!1),i===!0&&r===!0){const s=n.children;for(let a=0,l=s.length;a<l;a++)EF(s[a],e,t,!0)}}class nT{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ta(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class nwe{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const OW=new nn;class rwe{constructor(e=new nn(1/0,1/0),t=new nn(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=OW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,OW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const FW=new Ze,dE=new Ze;class iwe{constructor(e=new Ze,t=new Ze){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){FW.subVectors(e,this.start),dE.subVectors(this.end,this.start);const r=dE.dot(dE);let s=dE.dot(FW)/r;return t&&(s=ta(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const NW=new Ze;class swe extends Ri{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new $r,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,l=1,o=32;a<o;a++,l++){const h=a/o*Math.PI*2,d=l/o*Math.PI*2;i.push(Math.cos(h),Math.sin(h),1,Math.cos(d),Math.sin(d),1)}r.setAttribute("position",new ar(i,3));const s=new Ma({fog:!1,toneMapped:!1});this.cone=new fu(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),NW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(NW),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const p0=new Ze,pE=new Gr,$5=new Gr;class owe extends fu{constructor(e){const t=Fne(e),r=new $r,i=[],s=[],a=new Vn(0,0,1),l=new Vn(0,1,0);for(let h=0;h<t.length;h++){const d=t[h];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(l.r,l.g,l.b))}r.setAttribute("position",new ar(i,3)),r.setAttribute("color",new ar(s,3));const o=new Ma({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");$5.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const l=t[s];l.parent&&l.parent.isBone&&(pE.multiplyMatrices($5,l.matrixWorld),p0.setFromMatrixPosition(pE),i.setXYZ(a,p0.x,p0.y,p0.z),pE.multiplyMatrices($5,l.parent.matrixWorld),p0.setFromMatrixPosition(pE),i.setXYZ(a+1,p0.x,p0.y,p0.z),a+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Fne(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,Fne(n.children[t]));return e}class awe extends Ii{constructor(e,t,r){const i=new km(t,4,2),s=new _o({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const lwe=new Ze,zW=new Vn,UW=new Vn;class cwe extends Ri{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new qT(t);i.rotateY(Math.PI*.5),this.material=new _o({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new Bi(a,3)),this.add(new Ii(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");zW.copy(this.light.color),UW.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?zW:UW;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(lwe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class uwe extends fu{constructor(e=10,t=10,r=4473924,i=8947848){r=new Vn(r),i=new Vn(i);const s=t/2,a=e/t,l=e/2,o=[],h=[];for(let v=0,y=0,S=-l;v<=t;v++,S+=a){o.push(-l,0,S,l,0,S),o.push(S,0,-l,S,0,l);const E=v===s?r:i;E.toArray(h,y),y+=3,E.toArray(h,y),y+=3,E.toArray(h,y),y+=3,E.toArray(h,y),y+=3}const d=new $r;d.setAttribute("position",new ar(o,3)),d.setAttribute("color",new ar(h,3));const m=new Ma({vertexColors:!0,toneMapped:!1});super(d,m),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class hwe extends fu{constructor(e=10,t=16,r=8,i=64,s=4473924,a=8947848){s=new Vn(s),a=new Vn(a);const l=[],o=[];if(t>1)for(let m=0;m<t;m++){const v=m/t*(Math.PI*2),y=Math.sin(v)*e,S=Math.cos(v)*e;l.push(0,0,0),l.push(y,0,S);const E=m&1?s:a;o.push(E.r,E.g,E.b),o.push(E.r,E.g,E.b)}for(let m=0;m<r;m++){const v=m&1?s:a,y=e-e/r*m;for(let S=0;S<i;S++){let E=S/i*(Math.PI*2),M=Math.sin(E)*y,C=Math.cos(E)*y;l.push(M,0,C),o.push(v.r,v.g,v.b),E=(S+1)/i*(Math.PI*2),M=Math.sin(E)*y,C=Math.cos(E)*y,l.push(M,0,C),o.push(v.r,v.g,v.b)}}const h=new $r;h.setAttribute("position",new ar(l,3)),h.setAttribute("color",new ar(o,3));const d=new Ma({vertexColors:!0,toneMapped:!1});super(h,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const GW=new Ze,mE=new Ze,VW=new Ze;class fwe extends Ri{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new $r;i.setAttribute("position",new ar([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Ma({fog:!1,toneMapped:!1});this.lightPlane=new Yf(i,s),this.add(this.lightPlane),i=new $r,i.setAttribute("position",new ar([0,0,0,0,0,1],3)),this.targetLine=new Yf(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),GW.setFromMatrixPosition(this.light.matrixWorld),mE.setFromMatrixPosition(this.light.target.matrixWorld),VW.subVectors(mE,GW),this.lightPlane.lookAt(mE),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(mE),this.targetLine.scale.z=VW.length()}}const gE=new Ze,Jo=new VT;class dwe extends fu{constructor(e){const t=new $r,r=new Ma({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(S,E){o(S),o(E)}function o(S){i.push(0,0,0),s.push(0,0,0),a[S]===void 0&&(a[S]=[]),a[S].push(i.length/3-1)}t.setAttribute("position",new ar(i,3)),t.setAttribute("color",new ar(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const h=new Vn(16755200),d=new Vn(16711680),m=new Vn(43775),v=new Vn(16777215),y=new Vn(3355443);this.setColors(h,d,m,v,y)}setColors(e,t,r,i,s){const l=this.geometry.getAttribute("color");l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,t.r,t.g,t.b),l.setXYZ(25,t.r,t.g,t.b),l.setXYZ(26,t.r,t.g,t.b),l.setXYZ(27,t.r,t.g,t.b),l.setXYZ(28,t.r,t.g,t.b),l.setXYZ(29,t.r,t.g,t.b),l.setXYZ(30,t.r,t.g,t.b),l.setXYZ(31,t.r,t.g,t.b),l.setXYZ(32,r.r,r.g,r.b),l.setXYZ(33,r.r,r.g,r.b),l.setXYZ(34,r.r,r.g,r.b),l.setXYZ(35,r.r,r.g,r.b),l.setXYZ(36,r.r,r.g,r.b),l.setXYZ(37,r.r,r.g,r.b),l.setXYZ(38,i.r,i.g,i.b),l.setXYZ(39,i.r,i.g,i.b),l.setXYZ(40,s.r,s.g,s.b),l.setXYZ(41,s.r,s.g,s.b),l.setXYZ(42,s.r,s.g,s.b),l.setXYZ(43,s.r,s.g,s.b),l.setXYZ(44,s.r,s.g,s.b),l.setXYZ(45,s.r,s.g,s.b),l.setXYZ(46,s.r,s.g,s.b),l.setXYZ(47,s.r,s.g,s.b),l.setXYZ(48,s.r,s.g,s.b),l.setXYZ(49,s.r,s.g,s.b),l.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;Jo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ha("c",t,e,Jo,0,0,-1),ha("t",t,e,Jo,0,0,1),ha("n1",t,e,Jo,-r,-i,-1),ha("n2",t,e,Jo,r,-i,-1),ha("n3",t,e,Jo,-r,i,-1),ha("n4",t,e,Jo,r,i,-1),ha("f1",t,e,Jo,-r,-i,1),ha("f2",t,e,Jo,r,-i,1),ha("f3",t,e,Jo,-r,i,1),ha("f4",t,e,Jo,r,i,1),ha("u1",t,e,Jo,r*.7,i*1.1,-1),ha("u2",t,e,Jo,-r*.7,i*1.1,-1),ha("u3",t,e,Jo,0,i*2,-1),ha("cf1",t,e,Jo,-r,0,1),ha("cf2",t,e,Jo,r,0,1),ha("cf3",t,e,Jo,0,-i,1),ha("cf4",t,e,Jo,0,i,1),ha("cn1",t,e,Jo,-r,0,-1),ha("cn2",t,e,Jo,r,0,-1),ha("cn3",t,e,Jo,0,-i,-1),ha("cn4",t,e,Jo,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ha(n,e,t,r,i,s,a){gE.set(i,s,a).unproject(r);const l=e[n];if(l!==void 0){const o=t.getAttribute("position");for(let h=0,d=l.length;h<d;h++)o.setXYZ(l[h],gE.x,gE.y,gE.z)}}const vE=new Sl;class pwe extends fu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new $r;s.setIndex(new Bi(r,1)),s.setAttribute("position",new Bi(i,3)),super(s,new Ma({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&vE.setFromObject(this.object),vE.isEmpty())return;const t=vE.min,r=vE.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mwe extends fu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new $r;s.setIndex(new Bi(r,1)),s.setAttribute("position",new ar(i,3)),super(s,new Ma({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class gwe extends Yf{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new $r;a.setAttribute("position",new ar(s,3)),a.computeBoundingSphere(),super(a,new Ma({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],o=new $r;o.setAttribute("position",new ar(l,3)),o.computeBoundingSphere(),this.add(new Ii(o,new _o({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const HW=new Ze;let _E,q5;class vwe extends Ri{constructor(e=new Ze(0,0,1),t=new Ze(0,0,0),r=1,i=16776960,s=r*.2,a=s*.2){super(),this.type="ArrowHelper",_E===void 0&&(_E=new $r,_E.setAttribute("position",new ar([0,0,0,0,1,0],3)),q5=new ww(0,.5,1,5,1),q5.translate(0,-.5,0)),this.position.copy(t),this.line=new Yf(_E,new Ma({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ii(q5,new _o({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{HW.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(HW,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class _we extends fu{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new $r;i.setAttribute("position",new ar(t,3)),i.setAttribute("color",new ar(r,3));const s=new Ma({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new Vn,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ywe{constructor(){this.type="ShapePath",this.color=new Vn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new KA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,a){return this.currentPath.bezierCurveTo(e,t,r,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(C){const L=[];for(let k=0,H=C.length;k<H;k++){const q=C[k],Z=new Fy;Z.curves=q.curves,L.push(Z)}return L}function r(C,L){const k=L.length;let H=!1;for(let q=k-1,Z=0;Z<k;q=Z++){let ee=L[q],re=L[Z],se=re.x-ee.x,ae=re.y-ee.y;if(Math.abs(ae)>Number.EPSILON){if(ae<0&&(ee=L[Z],se=-se,re=L[q],ae=-ae),C.y<ee.y||C.y>re.y)continue;if(C.y===ee.y){if(C.x===ee.x)return!0}else{const fe=ae*(C.x-ee.x)-se*(C.y-ee.y);if(fe===0)return!0;if(fe<0)continue;H=!H}}else{if(C.y!==ee.y)continue;if(re.x<=C.x&&C.x<=ee.x||ee.x<=C.x&&C.x<=re.x)return!0}}return H}const i=lp.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,l,o;const h=[];if(s.length===1)return l=s[0],o=new Fy,o.curves=l.curves,h.push(o),h;let d=!i(s[0].getPoints());d=e?!d:d;const m=[],v=[];let y=[],S=0,E;v[S]=void 0,y[S]=[];for(let C=0,L=s.length;C<L;C++)l=s[C],E=l.getPoints(),a=i(E),a=e?!a:a,a?(!d&&v[S]&&S++,v[S]={s:new Fy,p:E},v[S].s.curves=l.curves,d&&S++,y[S]=[]):y[S].push({h:l,p:E[0]});if(!v[0])return t(s);if(v.length>1){let C=!1,L=0;for(let k=0,H=v.length;k<H;k++)m[k]=[];for(let k=0,H=v.length;k<H;k++){const q=y[k];for(let Z=0;Z<q.length;Z++){const ee=q[Z];let re=!0;for(let se=0;se<v.length;se++)r(ee.p,v[se].p)&&(k!==se&&L++,re?(re=!1,m[se].push(ee)):C=!0);re&&m[k].push(ee)}}L>0&&C===!1&&(y=m)}let M;for(let C=0,L=v.length;C<L;C++){o=v[C].s,h.push(o),M=y[C];for(let k=0,H=M.length;k<H;k++)o.holes.push(M[k].h)}return h}}class xwe extends wl{constructor(e=1,t=1,r=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:r}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:kT}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=kT);const Nne=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:WL,AddEquation:O0,AddOperation:_te,AdditiveAnimationBlendMode:O6,AdditiveBlending:Kb,AgXToneMapping:wte,AlphaFormat:R6,AlwaysCompare:Fte,AlwaysDepth:hte,AlwaysStencilFunc:_F,AmbientLight:x1,AnimationAction:kne,AnimationClip:n1,AnimationLoader:Ibe,AnimationMixer:One,AnimationObjectGroup:Ybe,AnimationUtils:Tbe,ArcCurve:rne,ArrayCamera:Jte,ArrowHelper:vwe,AttachedBindMode:vF,Audio:Lne,AudioAnalyser:Ube,AudioContext:lU,AudioListener:Pne,AudioLoader:Rne,AxesHelper:_we,BackSide:Cc,BasicDepthPacking:Ete,BasicShadowMap:Wee,BatchedMesh:tne,Bone:XT,BooleanKeyframeTrack:_1,Box2:rwe,Box3:Sl,Box3Helper:mwe,BoxGeometry:_p,BoxHelper:pwe,BufferAttribute:Bi,BufferGeometry:$r,BufferGeometryLoader:Ine,ByteType:C6,Cache:Im,Camera:VT,CameraHelper:dwe,CanvasTexture:AF,CapsuleGeometry:lD,CatmullRomCurve3:ine,CineonToneMapping:jL,CircleGeometry:cD,ClampToEdgeWrapping:su,Clock:ng,Color:Vn,ColorKeyframeTrack:iU,ColorManagement:ms,CompressedArrayTexture:qxe,CompressedCubeTexture:Zxe,CompressedTexture:oD,CompressedTextureLoader:Rbe,ConeGeometry:uD,ConstantAlphaFactor:lte,ConstantColorFactor:ote,CubeCamera:jte,CubeReflectionMapping:Hm,CubeRefractionMapping:uv,CubeTexture:HT,CubeTextureLoader:Sne,CubeUVReflectionMapping:vw,CubicBezierCurve:Y6,CubicBezierCurve3:sne,CubicInterpolant:xne,CullFaceBack:pF,CullFaceFront:jee,CullFaceFrontBack:Dge,CullFaceNone:Hee,Curve:td,CurvePath:ane,CustomBlending:Xee,CustomToneMapping:bte,CylinderGeometry:ww,Cylindrical:nwe,Data3DTexture:G6,DataArrayTexture:eD,DataTexture:$f,DataTextureLoader:Pbe,DataUtils:U0e,DecrementStencilOp:Vge,DecrementWrapStencilOp:jge,DefaultLoadingManager:sU,DepthFormat:By,DepthStencilFormat:Ky,DepthTexture:W6,DetachedBindMode:Ate,DirectionalLight:Pv,DirectionalLightHelper:fwe,DiscreteInterpolant:bne,DisplayP3ColorSpace:QL,DodecahedronGeometry:hD,DoubleSide:wc,DstAlphaFactor:tte,DstColorFactor:rte,DynamicCopyUsage:s0e,DynamicDrawUsage:Qge,DynamicReadUsage:n0e,EdgesGeometry:lne,EllipseCurve:aD,EqualCompare:Dte,EqualDepth:dte,EqualStencilFunc:qge,EquirectangularReflectionMapping:VA,EquirectangularRefractionMapping:HA,Euler:zu,EventDispatcher:vp,ExtrudeGeometry:dD,FileLoader:Xa,Float16BufferAttribute:X0e,Float32BufferAttribute:ar,FloatType:Ac,Fog:yw,FogExp2:WT,FramebufferTexture:$xe,FrontSide:Dh,Frustum:jT,GLBufferAttribute:twe,GLSL1:a0e,GLSL3:yF,GreaterCompare:Bte,GreaterDepth:mte,GreaterEqualCompare:Ote,GreaterEqualDepth:pte,GreaterEqualStencilFunc:Jge,GreaterStencilFunc:Yge,GridHelper:uwe,Group:Xl,HalfFloatType:Ch,HemisphereLight:Ane,HemisphereLightHelper:cwe,IcosahedronGeometry:t1,ImageBitmapLoader:aU,ImageLoader:tT,ImageUtils:Ute,IncrementStencilOp:Gge,IncrementWrapStencilOp:Hge,InstancedBufferAttribute:fv,InstancedBufferGeometry:Ene,InstancedInterleavedBuffer:ewe,InstancedMesh:iD,Int16BufferAttribute:j0e,Int32BufferAttribute:W0e,Int8BufferAttribute:G0e,IntType:$L,InterleavedBuffer:xw,InterleavedBufferAttribute:Xm,Interpolant:v1,InterpolateDiscrete:Jy,InterpolateLinear:hv,InterpolateSmooth:WI,InvertStencilOp:Wge,KeepStencilOp:ly,KeyframeTrack:nd,LOD:ene,LatheGeometry:$T,Layers:Oy,LessCompare:Lte,LessDepth:fte,LessEqualCompare:N6,LessEqualDepth:GA,LessEqualStencilFunc:Zge,LessStencilFunc:$ge,Light:Rv,LightProbe:Cne,Line:Yf,Line3:iwe,LineBasicMaterial:Ma,LineCurve:K6,LineCurve3:one,LineDashedMaterial:tU,LineLoop:sD,LineSegments:fu,LinearDisplayP3ColorSpace:GT,LinearFilter:Eo,LinearInterpolant:rU,LinearMipMapLinearFilter:Fge,LinearMipMapNearestFilter:Oge,LinearMipmapLinearFilter:ou,LinearMipmapNearestFilter:Dy,LinearSRGBColorSpace:Ha,LinearToneMapping:yte,LinearTransfer:WA,Loader:Ia,LoaderUtils:hu,LoadingManager:JT,LoopOnce:Tte,LoopPingPong:Cte,LoopRepeat:Mte,LuminanceAlphaFormat:D6,LuminanceFormat:L6,MOUSE:oy,Material:yo,MaterialLoader:xD,MathUtils:no,Matrix3:wi,Matrix4:Gr,MaxEquation:Yee,Mesh:Ii,MeshBasicMaterial:_o,MeshDepthMaterial:X6,MeshDistanceMaterial:$6,MeshLambertMaterial:KT,MeshMatcapMaterial:vne,MeshNormalMaterial:gne,MeshPhongMaterial:YT,MeshPhysicalMaterial:Wo,MeshStandardMaterial:fp,MeshToonMaterial:mne,MinEquation:Zee,MirroredRepeatWrapping:Zy,MixOperation:vte,MultiplyBlending:gF,MultiplyOperation:OT,NearestFilter:Sa,NearestMipMapLinearFilter:kge,NearestMipMapNearestFilter:Bge,NearestMipmapLinearFilter:V0,NearestMipmapNearestFilter:FT,NeutralToneMapping:Ste,NeverCompare:Pte,NeverDepth:ute,NeverStencilFunc:Xge,NoBlending:op,NoColorSpace:Am,NoToneMapping:ap,NormalAnimationBlendMode:JL,NormalBlending:Ly,NotEqualCompare:kte,NotEqualDepth:gte,NotEqualStencilFunc:Kge,NumberKeyframeTrack:$m,Object3D:Ri,ObjectLoader:kbe,ObjectSpaceNormalMap:Rte,OctahedronGeometry:qT,OneFactor:Jee,OneMinusConstantAlphaFactor:cte,OneMinusConstantColorFactor:ate,OneMinusDstAlphaFactor:nte,OneMinusDstColorFactor:ite,OneMinusSrcAlphaFactor:VR,OneMinusSrcColorFactor:ete,OrthographicCamera:ed,P3Primaries:$A,PCFShadowMap:HL,PCFSoftShadowMap:HS,PMREMGenerator:xF,Path:KA,PerspectiveCamera:ts,Plane:Sm,PlaneGeometry:tg,PlaneHelper:gwe,PointLight:rv,PointLightHelper:awe,Points:Th,PointsMaterial:au,PolarGridHelper:hwe,PolyhedronGeometry:Iv,PositionalAudio:Dne,PropertyBinding:es,PropertyMixer:Bne,QuadraticBezierCurve:J6,QuadraticBezierCurve3:Q6,Quaternion:Ta,QuaternionKeyframeTrack:qm,QuaternionLinearInterpolant:wne,RED_GREEN_RGTC2_Format:dP,RED_RGTC1_Format:k6,REVISION:kT,RGBADepthPacking:Ite,RGBAFormat:Wl,RGBAIntegerFormat:KL,RGBA_ASTC_10x10_Format:aP,RGBA_ASTC_10x5_Format:iP,RGBA_ASTC_10x6_Format:sP,RGBA_ASTC_10x8_Format:oP,RGBA_ASTC_12x10_Format:lP,RGBA_ASTC_12x12_Format:cP,RGBA_ASTC_4x4_Format:YR,RGBA_ASTC_5x4_Format:KR,RGBA_ASTC_5x5_Format:JR,RGBA_ASTC_6x5_Format:QR,RGBA_ASTC_6x6_Format:eP,RGBA_ASTC_8x5_Format:tP,RGBA_ASTC_8x6_Format:nP,RGBA_ASTC_8x8_Format:rP,RGBA_BPTC_Format:qS,RGBA_ETC2_EAC_Format:ZR,RGBA_PVRTC_2BPPV1_Format:XR,RGBA_PVRTC_4BPPV1_Format:WR,RGBA_S3TC_DXT1_Format:WS,RGBA_S3TC_DXT3_Format:XS,RGBA_S3TC_DXT5_Format:$S,RGBFormat:P6,RGBIntegerFormat:Nge,RGB_BPTC_SIGNED_Format:uP,RGB_BPTC_UNSIGNED_Format:hP,RGB_ETC1_Format:$R,RGB_ETC2_Format:qR,RGB_PVRTC_2BPPV1_Format:jR,RGB_PVRTC_4BPPV1_Format:HR,RGB_S3TC_DXT1_Format:jS,RGFormat:B6,RGIntegerFormat:YL,RawShaderMaterial:pne,Ray:g1,Raycaster:bD,Rec709Primaries:XA,RectAreaLight:Tne,RedFormat:NT,RedIntegerFormat:zT,ReinhardToneMapping:xte,RenderTarget:Gte,RepeatWrapping:Bh,ReplaceStencilOp:Uge,ReverseSubtractEquation:qee,RingGeometry:pD,SIGNED_RED_GREEN_RGTC2_Format:pP,SIGNED_RED_RGTC1_Format:fP,SRGBColorSpace:To,SRGBTransfer:to,Scene:Tl,ShaderChunk:Mi,ShaderLib:Nf,ShaderMaterial:Io,ShadowMaterial:dne,Shape:Fy,ShapeGeometry:mD,ShapePath:ywe,ShapeUtils:lp,ShortType:E6,Skeleton:bw,SkeletonHelper:owe,SkinnedMesh:rD,Source:xy,Sphere:il,SphereGeometry:km,Spherical:nT,SphericalHarmonics3:Mne,SplineCurve:eU,SpotLight:yD,SpotLightHelper:swe,Sprite:q6,SpriteMaterial:nD,SrcAlphaFactor:GR,SrcAlphaSaturateFactor:ste,SrcColorFactor:Qee,StaticCopyUsage:i0e,StaticDrawUsage:qA,StaticReadUsage:t0e,StereoCamera:Fbe,StreamCopyUsage:o0e,StreamDrawUsage:e0e,StreamReadUsage:r0e,StringKeyframeTrack:y1,SubtractEquation:$ee,SubtractiveBlending:mF,TOUCH:ay,TangentSpaceNormalMap:Ev,TetrahedronGeometry:gD,Texture:Xs,TextureLoader:Kf,TextureUtils:Cxe,TorusGeometry:ZT,TorusKnotGeometry:vD,Triangle:H0,TriangleFanDrawMode:Qy,TriangleStripDrawMode:UT,TrianglesDrawMode:F6,TubeGeometry:_D,UVMapping:XL,Uint16BufferAttribute:V6,Uint32BufferAttribute:H6,Uint8BufferAttribute:V0e,Uint8ClampedBufferAttribute:H0e,Uniform:hU,UniformsGroup:Qbe,UniformsLib:hr,UniformsUtils:Wm,UnsignedByteType:Zf,UnsignedInt248Type:Yy,UnsignedInt5999Type:I6,UnsignedIntType:jm,UnsignedShort4444Type:qL,UnsignedShort5551Type:ZL,UnsignedShortType:Jb,VSMShadowMap:Bf,Vector2:nn,Vector3:Ze,Vector4:Is,VectorKeyframeTrack:Zm,VideoTexture:nne,WebGL3DRenderTarget:R0e,WebGLArrayRenderTarget:I0e,WebGLCoordinateSystem:Qd,WebGLCubeRenderTarget:Wte,WebGLMultipleRenderTargets:xwe,WebGLRenderTarget:wl,WebGLRenderer:Yl,WebGLUtils:Kte,WebGPUCoordinateSystem:ZA,WireframeGeometry:fne,WrapAroundEnding:jA,ZeroCurvatureEnding:_y,ZeroFactor:Kee,ZeroSlopeEnding:yy,ZeroStencilOp:zge,createCanvasElement:zte},Symbol.toStringTag,{value:"Module"}));var zne={exports:{}},b1={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */b1.ConcurrentRoot=1;b1.ContinuousEventPriority=4;b1.DefaultEventPriority=16;b1.DiscreteEventPriority=1;b1.IdleEventPriority=536870912;b1.LegacyRoot=0;zne.exports=b1;var gb=zne.exports;function bwe(n){let e;const t=new Set,r=(h,d)=>{const m=typeof h=="function"?h(e):h;if(m!==e){const v=e;e=d?m:Object.assign({},e,m),t.forEach(y=>y(e,v))}},i=()=>e,s=(h,d=i,m=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let v=d(e);function y(){const S=d(e);if(!m(v,S)){const E=v;h(v=S,E)}}return t.add(y),()=>t.delete(y)},o={setState:r,getState:i,subscribe:(h,d,m)=>d||m?s(h,d,m):(t.add(h),()=>t.delete(h)),destroy:()=>t.clear()};return e=n(r,i,o),o}const wwe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),jW=wwe?Ae.useEffect:Ae.useLayoutEffect;function Swe(n){const e=typeof n=="function"?bwe(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=Ae.useReducer(M=>M+1,0),a=e.getState(),l=Ae.useRef(a),o=Ae.useRef(r),h=Ae.useRef(i),d=Ae.useRef(!1),m=Ae.useRef();m.current===void 0&&(m.current=r(a));let v,y=!1;(l.current!==a||o.current!==r||h.current!==i||d.current)&&(v=r(a),y=!i(m.current,v)),jW(()=>{y&&(m.current=v),l.current=a,o.current=r,h.current=i,d.current=!1});const S=Ae.useRef(a);jW(()=>{const M=()=>{try{const L=e.getState(),k=o.current(L);h.current(m.current,k)||(l.current=L,m.current=k,s())}catch{d.current=!0,s()}},C=e.subscribe(M);return e.getState()!==S.current&&M(),C},[]);const E=y?v:m.current;return Ae.useDebugValue(E),E};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}var Une={exports:{}},Z5={exports:{}},Y5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WW;function Awe(){return WW||(WW=1,function(n){function e(ye,$e){var Ve=ye.length;ye.push($e);e:for(;0<Ve;){var _t=Ve-1>>>1,wt=ye[_t];if(0<i(wt,$e))ye[_t]=$e,ye[Ve]=wt,Ve=_t;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var $e=ye[0],Ve=ye.pop();if(Ve!==$e){ye[0]=Ve;e:for(var _t=0,wt=ye.length,Vt=wt>>>1;_t<Vt;){var lt=2*(_t+1)-1,Ht=ye[lt],Qt=lt+1,rn=ye[Qt];if(0>i(Ht,Ve))Qt<wt&&0>i(rn,Ht)?(ye[_t]=rn,ye[Qt]=Ve,_t=Qt):(ye[_t]=Ht,ye[lt]=Ve,_t=lt);else if(Qt<wt&&0>i(rn,Ve))ye[_t]=rn,ye[Qt]=Ve,_t=Qt;else break e}}return $e}function i(ye,$e){var Ve=ye.sortIndex-$e.sortIndex;return Ve!==0?Ve:ye.id-$e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var o=[],h=[],d=1,m=null,v=3,y=!1,S=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(ye){for(var $e=t(h);$e!==null;){if($e.callback===null)r(h);else if($e.startTime<=ye)r(h),$e.sortIndex=$e.expirationTime,e(o,$e);else break;$e=t(h)}}function H(ye){if(E=!1,k(ye),!S)if(t(o)!==null)S=!0,Le(q);else{var $e=t(h);$e!==null&&ot(H,$e.startTime-ye)}}function q(ye,$e){S=!1,E&&(E=!1,C(re),re=-1),y=!0;var Ve=v;try{for(k($e),m=t(o);m!==null&&(!(m.expirationTime>$e)||ye&&!fe());){var _t=m.callback;if(typeof _t=="function"){m.callback=null,v=m.priorityLevel;var wt=_t(m.expirationTime<=$e);$e=n.unstable_now(),typeof wt=="function"?m.callback=wt:m===t(o)&&r(o),k($e)}else r(o);m=t(o)}if(m!==null)var Vt=!0;else{var lt=t(h);lt!==null&&ot(H,lt.startTime-$e),Vt=!1}return Vt}finally{m=null,v=Ve,y=!1}}var Z=!1,ee=null,re=-1,se=5,ae=-1;function fe(){return!(n.unstable_now()-ae<se)}function Se(){if(ee!==null){var ye=n.unstable_now();ae=ye;var $e=!0;try{$e=ee(!0,ye)}finally{$e?Ce():(Z=!1,ee=null)}}else Z=!1}var Ce;if(typeof L=="function")Ce=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,je=Ie.port2;Ie.port1.onmessage=Se,Ce=function(){je.postMessage(null)}}else Ce=function(){M(Se,0)};function Le(ye){ee=ye,Z||(Z=!0,Ce())}function ot(ye,$e){re=M(function(){ye(n.unstable_now())},$e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Le(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(o)},n.unstable_next=function(ye){switch(v){case 1:case 2:case 3:var $e=3;break;default:$e=v}var Ve=v;v=$e;try{return ye()}finally{v=Ve}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,$e){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ve=v;v=ye;try{return $e()}finally{v=Ve}},n.unstable_scheduleCallback=function(ye,$e,Ve){var _t=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?_t+Ve:_t):Ve=_t,ye){case 1:var wt=-1;break;case 2:wt=250;break;case 5:wt=1073741823;break;case 4:wt=1e4;break;default:wt=5e3}return wt=Ve+wt,ye={id:d++,callback:$e,priorityLevel:ye,startTime:Ve,expirationTime:wt,sortIndex:-1},Ve>_t?(ye.sortIndex=Ve,e(h,ye),t(o)===null&&ye===t(h)&&(E?(C(re),re=-1):E=!0,ot(H,Ve-_t))):(ye.sortIndex=wt,e(o,ye),S||y||(S=!0,Le(q))),ye},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(ye){var $e=v;return function(){var Ve=v;v=$e;try{return ye.apply(this,arguments)}finally{v=Ve}}}}(Y5)),Y5}var XW;function Twe(){return XW||(XW=1,Z5.exports=Awe()),Z5.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mwe=function(e){var t={},r=Ae,i=Twe(),s=Object.assign;function a(D){for(var O="https://reactjs.org/docs/error-decoder.html?invariant="+D,Y=1;Y<arguments.length;Y++)O+="&args[]="+encodeURIComponent(arguments[Y]);return"Minified React error #"+D+"; visit "+O+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,o=Symbol.for("react.element"),h=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),S=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),q=Symbol.iterator;function Z(D){return D===null||typeof D!="object"?null:(D=q&&D[q]||D["@@iterator"],typeof D=="function"?D:null)}function ee(D){if(D==null)return null;if(typeof D=="function")return D.displayName||D.name||null;if(typeof D=="string")return D;switch(D){case d:return"Fragment";case h:return"Portal";case v:return"Profiler";case m:return"StrictMode";case M:return"Suspense";case C:return"SuspenseList"}if(typeof D=="object")switch(D.$$typeof){case S:return(D.displayName||"Context")+".Consumer";case y:return(D._context.displayName||"Context")+".Provider";case E:var O=D.render;return D=D.displayName,D||(D=O.displayName||O.name||"",D=D!==""?"ForwardRef("+D+")":"ForwardRef"),D;case L:return O=D.displayName||null,O!==null?O:ee(D.type)||"Memo";case k:O=D._payload,D=D._init;try{return ee(D(O))}catch{}}return null}function re(D){var O=D.type;switch(D.tag){case 24:return"Cache";case 9:return(O.displayName||"Context")+".Consumer";case 10:return(O._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return D=O.render,D=D.displayName||D.name||"",O.displayName||(D!==""?"ForwardRef("+D+")":"ForwardRef");case 7:return"Fragment";case 5:return O;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ee(O);case 8:return O===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof O=="function")return O.displayName||O.name||null;if(typeof O=="string")return O}return null}function se(D){var O=D,Y=D;if(D.alternate)for(;O.return;)O=O.return;else{D=O;do O=D,O.flags&4098&&(Y=O.return),D=O.return;while(D)}return O.tag===3?Y:null}function ae(D){if(se(D)!==D)throw Error(a(188))}function fe(D){var O=D.alternate;if(!O){if(O=se(D),O===null)throw Error(a(188));return O!==D?null:D}for(var Y=D,ie=O;;){var pe=Y.return;if(pe===null)break;var Te=pe.alternate;if(Te===null){if(ie=pe.return,ie!==null){Y=ie;continue}break}if(pe.child===Te.child){for(Te=pe.child;Te;){if(Te===Y)return ae(pe),D;if(Te===ie)return ae(pe),O;Te=Te.sibling}throw Error(a(188))}if(Y.return!==ie.return)Y=pe,ie=Te;else{for(var dt=!1,Ot=pe.child;Ot;){if(Ot===Y){dt=!0,Y=pe,ie=Te;break}if(Ot===ie){dt=!0,ie=pe,Y=Te;break}Ot=Ot.sibling}if(!dt){for(Ot=Te.child;Ot;){if(Ot===Y){dt=!0,Y=Te,ie=pe;break}if(Ot===ie){dt=!0,ie=Te,Y=pe;break}Ot=Ot.sibling}if(!dt)throw Error(a(189))}}if(Y.alternate!==ie)throw Error(a(190))}if(Y.tag!==3)throw Error(a(188));return Y.stateNode.current===Y?D:O}function Se(D){return D=fe(D),D!==null?Ce(D):null}function Ce(D){if(D.tag===5||D.tag===6)return D;for(D=D.child;D!==null;){var O=Ce(D);if(O!==null)return O;D=D.sibling}return null}function Ie(D){if(D.tag===5||D.tag===6)return D;for(D=D.child;D!==null;){if(D.tag!==4){var O=Ie(D);if(O!==null)return O}D=D.sibling}return null}var je=Array.isArray,Le=e.getPublicInstance,ot=e.getRootHostContext,ye=e.getChildHostContext,$e=e.prepareForCommit,Ve=e.resetAfterCommit,_t=e.createInstance,wt=e.appendInitialChild,Vt=e.finalizeInitialChildren,lt=e.prepareUpdate,Ht=e.shouldSetTextContent,Qt=e.createTextInstance,rn=e.scheduleTimeout,jn=e.cancelTimeout,Bn=e.noTimeout,Tn=e.isPrimaryRenderer,Pe=e.supportsMutation,qe=e.supportsPersistence,mn=e.supportsHydration,cn=e.getInstanceFromNode,St=e.preparePortalMount,Jt=e.getCurrentEventPriority,kn=e.detachDeletedInstance,Gn=e.supportsMicrotasks,sn=e.scheduleMicrotask,at=e.supportsTestSelectors,Ue=e.findFiberRoot,$t=e.getBoundingRect,An=e.getTextContent,Sn=e.isHiddenSubtree,jt=e.matchAccessibilityRole,mr=e.setFocusIfFocusable,Un=e.setupIntersectionObserver,tr=e.appendChild,Sr=e.appendChildToContainer,Ln=e.commitTextUpdate,ir=e.commitMount,ui=e.commitUpdate,Fr=e.insertBefore,or=e.insertInContainerBefore,Nr=e.removeChild,Hr=e.removeChildFromContainer,yi=e.resetTextContent,Fe=e.hideInstance,Lt=e.hideTextInstance,Kt=e.unhideInstance,un=e.unhideTextInstance,En=e.clearContainer,Ar=e.cloneInstance,Vr=e.createContainerChildSet,hs=e.appendChildToContainerChildSet,Ps=e.finalizeContainerChildren,hi=e.replaceContainerChildren,Tt=e.cloneHiddenInstance,xe=e.cloneHiddenTextInstance,Ee=e.canHydrateInstance,Xe=e.canHydrateTextInstance,nt=e.canHydrateSuspenseInstance,Je=e.isSuspenseInstancePending,pt=e.isSuspenseInstanceFallback,Rt=e.registerSuspenseInstanceRetry,gt=e.getNextHydratableSibling,Pt=e.getFirstHydratableChild,zt=e.getFirstHydratableChildWithinContainer,Bt=e.getFirstHydratableChildWithinSuspenseInstance,ln=e.hydrateInstance,Mn=e.hydrateTextInstance,Cn=e.hydrateSuspenseInstance,Ge=e.getNextHydratableInstanceAfterSuspenseInstance,yt=e.commitHydratedContainer,Mt=e.commitHydratedSuspenseInstance,Ct=e.clearSuspenseBoundary,It=e.clearSuspenseBoundaryFromContainer,wn=e.shouldDeleteUnhydratedTailInstances,_n=e.didNotMatchHydratedContainerTextInstance,zn=e.didNotMatchHydratedTextInstance,Xn;function lr(D){if(Xn===void 0)try{throw Error()}catch(Y){var O=Y.stack.trim().match(/\n( *(at )?)/);Xn=O&&O[1]||""}return`
`+Xn+D}var gr=!1;function dr(D,O){if(!D||gr)return"";gr=!0;var Y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(O)if(O=function(){throw Error()},Object.defineProperty(O.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(O,[])}catch(Wn){var ie=Wn}Reflect.construct(D,[],O)}else{try{O.call()}catch(Wn){ie=Wn}D.call(O.prototype)}else{try{throw Error()}catch(Wn){ie=Wn}D()}}catch(Wn){if(Wn&&ie&&typeof Wn.stack=="string"){for(var pe=Wn.stack.split(`
`),Te=ie.stack.split(`
`),dt=pe.length-1,Ot=Te.length-1;1<=dt&&0<=Ot&&pe[dt]!==Te[Ot];)Ot--;for(;1<=dt&&0<=Ot;dt--,Ot--)if(pe[dt]!==Te[Ot]){if(dt!==1||Ot!==1)do if(dt--,Ot--,0>Ot||pe[dt]!==Te[Ot]){var vn=`
`+pe[dt].replace(" at new "," at ");return D.displayName&&vn.includes("<anonymous>")&&(vn=vn.replace("<anonymous>",D.displayName)),vn}while(1<=dt&&0<=Ot);break}}}finally{gr=!1,Error.prepareStackTrace=Y}return(D=D?D.displayName||D.name:"")?lr(D):""}var fi=Object.prototype.hasOwnProperty,ki=[],Hi=-1;function Ss(D){return{current:D}}function Er(D){0>Hi||(D.current=ki[Hi],ki[Hi]=null,Hi--)}function Qn(D,O){Hi++,ki[Hi]=D.current,D.current=O}var Zi={},qr=Ss(Zi),_s=Ss(!1),Xo=Zi;function Ls(D,O){var Y=D.type.contextTypes;if(!Y)return Zi;var ie=D.stateNode;if(ie&&ie.__reactInternalMemoizedUnmaskedChildContext===O)return ie.__reactInternalMemoizedMaskedChildContext;var pe={},Te;for(Te in Y)pe[Te]=O[Te];return ie&&(D=D.stateNode,D.__reactInternalMemoizedUnmaskedChildContext=O,D.__reactInternalMemoizedMaskedChildContext=pe),pe}function fs(D){return D=D.childContextTypes,D!=null}function Pi(){Er(_s),Er(qr)}function oo(D,O,Y){if(qr.current!==Zi)throw Error(a(168));Qn(qr,O),Qn(_s,Y)}function Po(D,O,Y){var ie=D.stateNode;if(O=O.childContextTypes,typeof ie.getChildContext!="function")return Y;ie=ie.getChildContext();for(var pe in ie)if(!(pe in O))throw Error(a(108,re(D)||"Unknown",pe));return s({},Y,ie)}function As(D){return D=(D=D.stateNode)&&D.__reactInternalMemoizedMergedChildContext||Zi,Xo=qr.current,Qn(qr,D),Qn(_s,_s.current),!0}function Bc(D,O,Y){var ie=D.stateNode;if(!ie)throw Error(a(169));Y?(D=Po(D,O,Xo),ie.__reactInternalMemoizedMergedChildContext=D,Er(_s),Er(qr),Qn(qr,D)):Er(_s),Qn(_s,Y)}var Ra=Math.clz32?Math.clz32:og,ld=Math.log,kc=Math.LN2;function og(D){return D>>>=0,D===0?32:31-(ld(D)/kc|0)|0}var Ap=64,ag=4194304;function $o(D){switch(D&-D){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return D&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return D&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return D}}function Kl(D,O){var Y=D.pendingLanes;if(Y===0)return 0;var ie=0,pe=D.suspendedLanes,Te=D.pingedLanes,dt=Y&268435455;if(dt!==0){var Ot=dt&~pe;Ot!==0?ie=$o(Ot):(Te&=dt,Te!==0&&(ie=$o(Te)))}else dt=Y&~pe,dt!==0?ie=$o(dt):Te!==0&&(ie=$o(Te));if(ie===0)return 0;if(O!==0&&O!==ie&&!(O&pe)&&(pe=ie&-ie,Te=O&-O,pe>=Te||pe===16&&(Te&4194240)!==0))return O;if(ie&4&&(ie|=Y&16),O=D.entangledLanes,O!==0)for(D=D.entanglements,O&=ie;0<O;)Y=31-Ra(O),pe=1<<Y,ie|=D[Y],O&=~pe;return ie}function Tp(D,O){switch(D){case 1:case 2:case 4:return O+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return O+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cd(D,O){for(var Y=D.suspendedLanes,ie=D.pingedLanes,pe=D.expirationTimes,Te=D.pendingLanes;0<Te;){var dt=31-Ra(Te),Ot=1<<dt,vn=pe[dt];vn===-1?(!(Ot&Y)||Ot&ie)&&(pe[dt]=Tp(Ot,O)):vn<=O&&(D.expiredLanes|=Ot),Te&=~Ot}}function Mp(D){return D=D.pendingLanes&-1073741825,D!==0?D:D&1073741824?1073741824:0}function Vu(D){for(var O=[],Y=0;31>Y;Y++)O.push(D);return O}function Gh(D,O,Y){D.pendingLanes|=O,O!==536870912&&(D.suspendedLanes=0,D.pingedLanes=0),D=D.eventTimes,O=31-Ra(O),D[O]=Y}function si(D,O){var Y=D.pendingLanes&~O;D.pendingLanes=O,D.suspendedLanes=0,D.pingedLanes=0,D.expiredLanes&=O,D.mutableReadLanes&=O,D.entangledLanes&=O,O=D.entanglements;var ie=D.eventTimes;for(D=D.expirationTimes;0<Y;){var pe=31-Ra(Y),Te=1<<pe;O[pe]=0,ie[pe]=-1,D[pe]=-1,Y&=~Te}}function Cp(D,O){var Y=D.entangledLanes|=O;for(D=D.entanglements;Y;){var ie=31-Ra(Y),pe=1<<ie;pe&O|D[ie]&O&&(D[ie]|=O),Y&=~pe}}var vr=0;function T1(D){return D&=-D,1<D?4<D?D&268435455?16:536870912:4:1}var cr=i.unstable_scheduleCallback,ud=i.unstable_cancelCallback,Vh=i.unstable_shouldYield,hd=i.unstable_requestPaint,xs=i.unstable_now,fd=i.unstable_ImmediatePriority,Jl=i.unstable_UserBlockingPriority,On=i.unstable_NormalPriority,ei=i.unstable_IdlePriority,Zr=null,Us=null;function ga(D){if(Us&&typeof Us.onCommitFiberRoot=="function")try{Us.onCommitFiberRoot(Zr,D,void 0,(D.current.flags&128)===128)}catch{}}function ni(D,O){return D===O&&(D!==0||1/D===1/O)||D!==D&&O!==O}var al=typeof Object.is=="function"?Object.is:ni,$a=null,pu=!1,sa=!1;function Ts(D){$a===null?$a=[D]:$a.push(D)}function M1(D){pu=!0,Ts(D)}function Pa(){if(!sa&&$a!==null){sa=!0;var D=0,O=vr;try{var Y=$a;for(vr=1;D<Y.length;D++){var ie=Y[D];do ie=ie(!0);while(ie!==null)}$a=null,pu=!1}catch(pe){throw $a!==null&&($a=$a.slice(D+1)),cr(fd,Pa),pe}finally{vr=O,sa=!1}}return null}var dd=l.ReactCurrentBatchConfig;function ll(D,O){if(al(D,O))return!0;if(typeof D!="object"||D===null||typeof O!="object"||O===null)return!1;var Y=Object.keys(D),ie=Object.keys(O);if(Y.length!==ie.length)return!1;for(ie=0;ie<Y.length;ie++){var pe=Y[ie];if(!fi.call(O,pe)||!al(D[pe],O[pe]))return!1}return!0}function lg(D){switch(D.tag){case 5:return lr(D.type);case 16:return lr("Lazy");case 13:return lr("Suspense");case 19:return lr("SuspenseList");case 0:case 2:case 15:return D=dr(D.type,!1),D;case 11:return D=dr(D.type.render,!1),D;case 1:return D=dr(D.type,!0),D;default:return""}}function Gs(D,O){if(D&&D.defaultProps){O=s({},O),D=D.defaultProps;for(var Y in D)O[Y]===void 0&&(O[Y]=D[Y]);return O}return O}var Lo=Ss(null),qo=null,Hh=null,Oc=null;function Ds(){Oc=Hh=qo=null}function va(D,O,Y){Tn?(Qn(Lo,O._currentValue),O._currentValue=Y):(Qn(Lo,O._currentValue2),O._currentValue2=Y)}function cl(D){var O=Lo.current;Er(Lo),Tn?D._currentValue=O:D._currentValue2=O}function qs(D,O,Y){for(;D!==null;){var ie=D.alternate;if((D.childLanes&O)!==O?(D.childLanes|=O,ie!==null&&(ie.childLanes|=O)):ie!==null&&(ie.childLanes&O)!==O&&(ie.childLanes|=O),D===Y)break;D=D.return}}function Hu(D,O){qo=D,Oc=Hh=null,D=D.dependencies,D!==null&&D.firstContext!==null&&(D.lanes&O&&(bo=!0),D.firstContext=null)}function Zs(D){var O=Tn?D._currentValue:D._currentValue2;if(Oc!==D)if(D={context:D,memoizedValue:O,next:null},Hh===null){if(qo===null)throw Error(a(308));Hh=D,qo.dependencies={lanes:0,firstContext:D}}else Hh=Hh.next=D;return O}var La=null,qa=!1;function mu(D){D.updateQueue={baseState:D.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ep(D,O){D=D.updateQueue,O.updateQueue===D&&(O.updateQueue={baseState:D.baseState,firstBaseUpdate:D.firstBaseUpdate,lastBaseUpdate:D.lastBaseUpdate,shared:D.shared,effects:D.effects})}function oa(D,O){return{eventTime:D,lane:O,tag:0,payload:null,callback:null,next:null}}function ju(D,O){var Y=D.updateQueue;Y!==null&&(Y=Y.shared,Ks!==null&&D.mode&1&&!(di&2)?(D=Y.interleaved,D===null?(O.next=O,La===null?La=[Y]:La.push(Y)):(O.next=D.next,D.next=O),Y.interleaved=O):(D=Y.pending,D===null?O.next=O:(O.next=D.next,D.next=O),Y.pending=O))}function Ip(D,O,Y){if(O=O.updateQueue,O!==null&&(O=O.shared,(Y&4194240)!==0)){var ie=O.lanes;ie&=D.pendingLanes,Y|=ie,O.lanes=Y,Cp(D,Y)}}function Da(D,O){var Y=D.updateQueue,ie=D.alternate;if(ie!==null&&(ie=ie.updateQueue,Y===ie)){var pe=null,Te=null;if(Y=Y.firstBaseUpdate,Y!==null){do{var dt={eventTime:Y.eventTime,lane:Y.lane,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null};Te===null?pe=Te=dt:Te=Te.next=dt,Y=Y.next}while(Y!==null);Te===null?pe=Te=O:Te=Te.next=O}else pe=Te=O;Y={baseState:ie.baseState,firstBaseUpdate:pe,lastBaseUpdate:Te,shared:ie.shared,effects:ie.effects},D.updateQueue=Y;return}D=Y.lastBaseUpdate,D===null?Y.firstBaseUpdate=O:D.next=O,Y.lastBaseUpdate=O}function cg(D,O,Y,ie){var pe=D.updateQueue;qa=!1;var Te=pe.firstBaseUpdate,dt=pe.lastBaseUpdate,Ot=pe.shared.pending;if(Ot!==null){pe.shared.pending=null;var vn=Ot,Wn=vn.next;vn.next=null,dt===null?Te=Wn:dt.next=Wn,dt=vn;var br=D.alternate;br!==null&&(br=br.updateQueue,Ot=br.lastBaseUpdate,Ot!==dt&&(Ot===null?br.firstBaseUpdate=Wn:Ot.next=Wn,br.lastBaseUpdate=vn))}if(Te!==null){var ai=pe.baseState;dt=0,br=Wn=vn=null,Ot=Te;do{var zr=Ot.lane,ps=Ot.eventTime;if((ie&zr)===zr){br!==null&&(br=br.next={eventTime:ps,lane:0,tag:Ot.tag,payload:Ot.payload,callback:Ot.callback,next:null});e:{var Ir=D,uo=Ot;switch(zr=O,ps=Y,uo.tag){case 1:if(Ir=uo.payload,typeof Ir=="function"){ai=Ir.call(ps,ai,zr);break e}ai=Ir;break e;case 3:Ir.flags=Ir.flags&-65537|128;case 0:if(Ir=uo.payload,zr=typeof Ir=="function"?Ir.call(ps,ai,zr):Ir,zr==null)break e;ai=s({},ai,zr);break e;case 2:qa=!0}}Ot.callback!==null&&Ot.lane!==0&&(D.flags|=64,zr=pe.effects,zr===null?pe.effects=[Ot]:zr.push(Ot))}else ps={eventTime:ps,lane:zr,tag:Ot.tag,payload:Ot.payload,callback:Ot.callback,next:null},br===null?(Wn=br=ps,vn=ai):br=br.next=ps,dt|=zr;if(Ot=Ot.next,Ot===null){if(Ot=pe.shared.pending,Ot===null)break;zr=Ot,Ot=zr.next,zr.next=null,pe.lastBaseUpdate=zr,pe.shared.pending=null}}while(!0);if(br===null&&(vn=ai),pe.baseState=vn,pe.firstBaseUpdate=Wn,pe.lastBaseUpdate=br,O=pe.shared.interleaved,O!==null){pe=O;do dt|=pe.lane,pe=pe.next;while(pe!==O)}else Te===null&&(pe.shared.lanes=0);uf|=dt,D.lanes=dt,D.memoizedState=ai}}function Rp(D,O,Y){if(D=O.effects,O.effects=null,D!==null)for(O=0;O<D.length;O++){var ie=D[O],pe=ie.callback;if(pe!==null){if(ie.callback=null,ie=Y,typeof pe!="function")throw Error(a(191,pe));pe.call(ie)}}}var Fv=new r.Component().refs;function Wu(D,O,Y,ie){O=D.memoizedState,Y=Y(ie,O),Y=Y==null?O:s({},O,Y),D.memoizedState=Y,D.lanes===0&&(D.updateQueue.baseState=Y)}var gu={isMounted:function(D){return(D=D._reactInternals)?se(D)===D:!1},enqueueSetState:function(D,O,Y){D=D._reactInternals;var ie=Js(),pe=uc(D),Te=oa(ie,pe);Te.payload=O,Y!=null&&(Te.callback=Y),ju(D,Te),O=Qa(D,pe,ie),O!==null&&Ip(O,D,pe)},enqueueReplaceState:function(D,O,Y){D=D._reactInternals;var ie=Js(),pe=uc(D),Te=oa(ie,pe);Te.tag=1,Te.payload=O,Y!=null&&(Te.callback=Y),ju(D,Te),O=Qa(D,pe,ie),O!==null&&Ip(O,D,pe)},enqueueForceUpdate:function(D,O){D=D._reactInternals;var Y=Js(),ie=uc(D),pe=oa(Y,ie);pe.tag=2,O!=null&&(pe.callback=O),ju(D,pe),O=Qa(D,ie,Y),O!==null&&Ip(O,D,ie)}};function C1(D,O,Y,ie,pe,Te,dt){return D=D.stateNode,typeof D.shouldComponentUpdate=="function"?D.shouldComponentUpdate(ie,Te,dt):O.prototype&&O.prototype.isPureReactComponent?!ll(Y,ie)||!ll(pe,Te):!0}function pd(D,O,Y){var ie=!1,pe=Zi,Te=O.contextType;return typeof Te=="object"&&Te!==null?Te=Zs(Te):(pe=fs(O)?Xo:qr.current,ie=O.contextTypes,Te=(ie=ie!=null)?Ls(D,pe):Zi),O=new O(Y,Te),D.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=gu,D.stateNode=O,O._reactInternals=D,ie&&(D=D.stateNode,D.__reactInternalMemoizedUnmaskedChildContext=pe,D.__reactInternalMemoizedMaskedChildContext=Te),O}function Xu(D,O,Y,ie){D=O.state,typeof O.componentWillReceiveProps=="function"&&O.componentWillReceiveProps(Y,ie),typeof O.UNSAFE_componentWillReceiveProps=="function"&&O.UNSAFE_componentWillReceiveProps(Y,ie),O.state!==D&&gu.enqueueReplaceState(O,O.state,null)}function Nv(D,O,Y,ie){var pe=D.stateNode;pe.props=Y,pe.state=D.memoizedState,pe.refs=Fv,mu(D);var Te=O.contextType;typeof Te=="object"&&Te!==null?pe.context=Zs(Te):(Te=fs(O)?Xo:qr.current,pe.context=Ls(D,Te)),pe.state=D.memoizedState,Te=O.getDerivedStateFromProps,typeof Te=="function"&&(Wu(D,O,Te,Y),pe.state=D.memoizedState),typeof O.getDerivedStateFromProps=="function"||typeof pe.getSnapshotBeforeUpdate=="function"||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(O=pe.state,typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount(),O!==pe.state&&gu.enqueueReplaceState(pe,pe.state,null),cg(D,Y,pe,ie),pe.state=D.memoizedState),typeof pe.componentDidMount=="function"&&(D.flags|=4194308)}var Ql=[],jh=0,Wh=null,_a=0,Mr=[],$n=0,vu=null,pr=1,ec="";function tc(D,O){Ql[jh++]=_a,Ql[jh++]=Wh,Wh=D,_a=O}function _r(D,O,Y){Mr[$n++]=pr,Mr[$n++]=ec,Mr[$n++]=vu,vu=D;var ie=pr;D=ec;var pe=32-Ra(ie)-1;ie&=~(1<<pe),Y+=1;var Te=32-Ra(O)+pe;if(30<Te){var dt=pe-pe%5;Te=(ie&(1<<dt)-1).toString(32),ie>>=dt,pe-=dt,pr=1<<32-Ra(O)+pe|Y<<pe|ie,ec=Te+D}else pr=1<<Te|Y<<pe|ie,ec=D}function Pp(D){D.return!==null&&(tc(D,1),_r(D,1,0))}function md(D){for(;D===Wh;)Wh=Ql[--jh],Ql[jh]=null,_a=Ql[--jh],Ql[jh]=null;for(;D===vu;)vu=Mr[--$n],Mr[$n]=null,ec=Mr[--$n],Mr[$n]=null,pr=Mr[--$n],Mr[$n]=null}var Ba=null,xo=null,ns=!1,ao=!1,Za=null;function Xh(D,O){var Y=el(5,null,null,0);Y.elementType="DELETED",Y.stateNode=O,Y.return=D,O=D.deletions,O===null?(D.deletions=[Y],D.flags|=16):O.push(Y)}function $h(D,O){switch(D.tag){case 5:return O=Ee(O,D.type,D.pendingProps),O!==null?(D.stateNode=O,Ba=D,xo=Pt(O),!0):!1;case 6:return O=Xe(O,D.pendingProps),O!==null?(D.stateNode=O,Ba=D,xo=null,!0):!1;case 13:if(O=nt(O),O!==null){var Y=vu!==null?{id:pr,overflow:ec}:null;return D.memoizedState={dehydrated:O,treeContext:Y,retryLane:1073741824},Y=el(18,null,null,0),Y.stateNode=O,Y.return=D,D.child=Y,Ba=D,xo=null,!0}return!1;default:return!1}}function gd(D){return(D.mode&1)!==0&&(D.flags&128)===0}function nc(D){if(ns){var O=xo;if(O){var Y=O;if(!$h(D,O)){if(gd(D))throw Error(a(418));O=gt(Y);var ie=Ba;O&&$h(D,O)?Xh(ie,Y):(D.flags=D.flags&-4097|2,ns=!1,Ba=D)}}else{if(gd(D))throw Error(a(418));D.flags=D.flags&-4097|2,ns=!1,Ba=D}}}function ys(D){for(D=D.return;D!==null&&D.tag!==5&&D.tag!==3&&D.tag!==13;)D=D.return;Ba=D}function qh(D){if(!mn||D!==Ba)return!1;if(!ns)return ys(D),ns=!0,!1;if(D.tag!==3&&(D.tag!==5||wn(D.type)&&!Ht(D.type,D.memoizedProps))){var O=xo;if(O){if(gd(D)){for(D=xo;D;)D=gt(D);throw Error(a(418))}for(;O;)Xh(D,O),O=gt(O)}}if(ys(D),D.tag===13){if(!mn)throw Error(a(316));if(D=D.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));xo=Ge(D)}else xo=Ba?gt(D.stateNode):null;return!0}function yn(){mn&&(xo=Ba=null,ao=ns=!1)}function ug(D){Za===null?Za=[D]:Za.push(D)}function Fc(D,O,Y){if(D=Y.ref,D!==null&&typeof D!="function"&&typeof D!="object"){if(Y._owner){if(Y=Y._owner,Y){if(Y.tag!==1)throw Error(a(309));var ie=Y.stateNode}if(!ie)throw Error(a(147,D));var pe=ie,Te=""+D;return O!==null&&O.ref!==null&&typeof O.ref=="function"&&O.ref._stringRef===Te?O.ref:(O=function(dt){var Ot=pe.refs;Ot===Fv&&(Ot=pe.refs={}),dt===null?delete Ot[Te]:Ot[Te]=dt},O._stringRef=Te,O)}if(typeof D!="string")throw Error(a(284));if(!Y._owner)throw Error(a(290,D))}return D}function Zh(D,O){throw D=Object.prototype.toString.call(O),Error(a(31,D==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":D))}function Lp(D){var O=D._init;return O(D._payload)}function Dp(D){function O(Xt,Nt){if(D){var on=Xt.deletions;on===null?(Xt.deletions=[Nt],Xt.flags|=16):on.push(Nt)}}function Y(Xt,Nt){if(!D)return null;for(;Nt!==null;)O(Xt,Nt),Nt=Nt.sibling;return null}function ie(Xt,Nt){for(Xt=new Map;Nt!==null;)Nt.key!==null?Xt.set(Nt.key,Nt):Xt.set(Nt.index,Nt),Nt=Nt.sibling;return Xt}function pe(Xt,Nt){return Xt=Au(Xt,Nt),Xt.index=0,Xt.sibling=null,Xt}function Te(Xt,Nt,on){return Xt.index=on,D?(on=Xt.alternate,on!==null?(on=on.index,on<Nt?(Xt.flags|=2,Nt):on):(Xt.flags|=2,Nt)):(Xt.flags|=1048576,Nt)}function dt(Xt){return D&&Xt.alternate===null&&(Xt.flags|=2),Xt}function Ot(Xt,Nt,on,rr){return Nt===null||Nt.tag!==6?(Nt=im(on,Xt.mode,rr),Nt.return=Xt,Nt):(Nt=pe(Nt,on),Nt.return=Xt,Nt)}function vn(Xt,Nt,on,rr){var Rr=on.type;return Rr===d?br(Xt,Nt,on.props.children,rr,on.key):Nt!==null&&(Nt.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===k&&Lp(Rr)===Nt.type)?(rr=pe(Nt,on.props),rr.ref=Fc(Xt,Nt,on),rr.return=Xt,rr):(rr=nm(on.type,on.key,on.props,null,Xt.mode,rr),rr.ref=Fc(Xt,Nt,on),rr.return=Xt,rr)}function Wn(Xt,Nt,on,rr){return Nt===null||Nt.tag!==4||Nt.stateNode.containerInfo!==on.containerInfo||Nt.stateNode.implementation!==on.implementation?(Nt=l_(on,Xt.mode,rr),Nt.return=Xt,Nt):(Nt=pe(Nt,on.children||[]),Nt.return=Xt,Nt)}function br(Xt,Nt,on,rr,Rr){return Nt===null||Nt.tag!==7?(Nt=rh(on,Xt.mode,rr,Rr),Nt.return=Xt,Nt):(Nt=pe(Nt,on),Nt.return=Xt,Nt)}function ai(Xt,Nt,on){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number")return Nt=im(""+Nt,Xt.mode,on),Nt.return=Xt,Nt;if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case o:return on=nm(Nt.type,Nt.key,Nt.props,null,Xt.mode,on),on.ref=Fc(Xt,null,Nt),on.return=Xt,on;case h:return Nt=l_(Nt,Xt.mode,on),Nt.return=Xt,Nt;case k:var rr=Nt._init;return ai(Xt,rr(Nt._payload),on)}if(je(Nt)||Z(Nt))return Nt=rh(Nt,Xt.mode,on,null),Nt.return=Xt,Nt;Zh(Xt,Nt)}return null}function zr(Xt,Nt,on,rr){var Rr=Nt!==null?Nt.key:null;if(typeof on=="string"&&on!==""||typeof on=="number")return Rr!==null?null:Ot(Xt,Nt,""+on,rr);if(typeof on=="object"&&on!==null){switch(on.$$typeof){case o:return on.key===Rr?vn(Xt,Nt,on,rr):null;case h:return on.key===Rr?Wn(Xt,Nt,on,rr):null;case k:return Rr=on._init,zr(Xt,Nt,Rr(on._payload),rr)}if(je(on)||Z(on))return Rr!==null?null:br(Xt,Nt,on,rr,null);Zh(Xt,on)}return null}function ps(Xt,Nt,on,rr,Rr){if(typeof rr=="string"&&rr!==""||typeof rr=="number")return Xt=Xt.get(on)||null,Ot(Nt,Xt,""+rr,Rr);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case o:return Xt=Xt.get(rr.key===null?on:rr.key)||null,vn(Nt,Xt,rr,Rr);case h:return Xt=Xt.get(rr.key===null?on:rr.key)||null,Wn(Nt,Xt,rr,Rr);case k:var gi=rr._init;return ps(Xt,Nt,on,gi(rr._payload),Rr)}if(je(rr)||Z(rr))return Xt=Xt.get(on)||null,br(Nt,Xt,rr,Rr,null);Zh(Nt,rr)}return null}function Ir(Xt,Nt,on,rr){for(var Rr=null,gi=null,li=Nt,Ni=Nt=0,b=null;li!==null&&Ni<on.length;Ni++){li.index>Ni?(b=li,li=null):b=li.sibling;var u=zr(Xt,li,on[Ni],rr);if(u===null){li===null&&(li=b);break}D&&li&&u.alternate===null&&O(Xt,li),Nt=Te(u,Nt,Ni),gi===null?Rr=u:gi.sibling=u,gi=u,li=b}if(Ni===on.length)return Y(Xt,li),ns&&tc(Xt,Ni),Rr;if(li===null){for(;Ni<on.length;Ni++)li=ai(Xt,on[Ni],rr),li!==null&&(Nt=Te(li,Nt,Ni),gi===null?Rr=li:gi.sibling=li,gi=li);return ns&&tc(Xt,Ni),Rr}for(li=ie(Xt,li);Ni<on.length;Ni++)b=ps(li,Xt,Ni,on[Ni],rr),b!==null&&(D&&b.alternate!==null&&li.delete(b.key===null?Ni:b.key),Nt=Te(b,Nt,Ni),gi===null?Rr=b:gi.sibling=b,gi=b);return D&&li.forEach(function(p){return O(Xt,p)}),ns&&tc(Xt,Ni),Rr}function uo(Xt,Nt,on,rr){var Rr=Z(on);if(typeof Rr!="function")throw Error(a(150));if(on=Rr.call(on),on==null)throw Error(a(151));for(var gi=Rr=null,li=Nt,Ni=Nt=0,b=null,u=on.next();li!==null&&!u.done;Ni++,u=on.next()){li.index>Ni?(b=li,li=null):b=li.sibling;var p=zr(Xt,li,u.value,rr);if(p===null){li===null&&(li=b);break}D&&li&&p.alternate===null&&O(Xt,li),Nt=Te(p,Nt,Ni),gi===null?Rr=p:gi.sibling=p,gi=p,li=b}if(u.done)return Y(Xt,li),ns&&tc(Xt,Ni),Rr;if(li===null){for(;!u.done;Ni++,u=on.next())u=ai(Xt,u.value,rr),u!==null&&(Nt=Te(u,Nt,Ni),gi===null?Rr=u:gi.sibling=u,gi=u);return ns&&tc(Xt,Ni),Rr}for(li=ie(Xt,li);!u.done;Ni++,u=on.next())u=ps(li,Xt,Ni,u.value,rr),u!==null&&(D&&u.alternate!==null&&li.delete(u.key===null?Ni:u.key),Nt=Te(u,Nt,Ni),gi===null?Rr=u:gi.sibling=u,gi=u);return D&&li.forEach(function(w){return O(Xt,w)}),ns&&tc(Xt,Ni),Rr}function ho(Xt,Nt,on,rr){if(typeof on=="object"&&on!==null&&on.type===d&&on.key===null&&(on=on.props.children),typeof on=="object"&&on!==null){switch(on.$$typeof){case o:e:{for(var Rr=on.key,gi=Nt;gi!==null;){if(gi.key===Rr){if(Rr=on.type,Rr===d){if(gi.tag===7){Y(Xt,gi.sibling),Nt=pe(gi,on.props.children),Nt.return=Xt,Xt=Nt;break e}}else if(gi.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===k&&Lp(Rr)===gi.type){Y(Xt,gi.sibling),Nt=pe(gi,on.props),Nt.ref=Fc(Xt,gi,on),Nt.return=Xt,Xt=Nt;break e}Y(Xt,gi);break}else O(Xt,gi);gi=gi.sibling}on.type===d?(Nt=rh(on.props.children,Xt.mode,rr,on.key),Nt.return=Xt,Xt=Nt):(rr=nm(on.type,on.key,on.props,null,Xt.mode,rr),rr.ref=Fc(Xt,Nt,on),rr.return=Xt,Xt=rr)}return dt(Xt);case h:e:{for(gi=on.key;Nt!==null;){if(Nt.key===gi)if(Nt.tag===4&&Nt.stateNode.containerInfo===on.containerInfo&&Nt.stateNode.implementation===on.implementation){Y(Xt,Nt.sibling),Nt=pe(Nt,on.children||[]),Nt.return=Xt,Xt=Nt;break e}else{Y(Xt,Nt);break}else O(Xt,Nt);Nt=Nt.sibling}Nt=l_(on,Xt.mode,rr),Nt.return=Xt,Xt=Nt}return dt(Xt);case k:return gi=on._init,ho(Xt,Nt,gi(on._payload),rr)}if(je(on))return Ir(Xt,Nt,on,rr);if(Z(on))return uo(Xt,Nt,on,rr);Zh(Xt,on)}return typeof on=="string"&&on!==""||typeof on=="number"?(on=""+on,Nt!==null&&Nt.tag===6?(Y(Xt,Nt.sibling),Nt=pe(Nt,on),Nt.return=Xt,Xt=Nt):(Y(Xt,Nt),Nt=im(on,Xt.mode,rr),Nt.return=Xt,Xt=Nt),dt(Xt)):Y(Xt,Nt)}return ho}var Ya=Dp(!0),hg=Dp(!1),aa={},ka=Ss(aa),Nc=Ss(aa),Yh=Ss(aa);function rc(D){if(D===aa)throw Error(a(174));return D}function Oa(D,O){Qn(Yh,O),Qn(Nc,D),Qn(ka,aa),D=ot(O),Er(ka),Qn(ka,D)}function Kh(){Er(ka),Er(Nc),Er(Yh)}function fg(D){var O=rc(Yh.current),Y=rc(ka.current);O=ye(Y,D.type,O),Y!==O&&(Qn(Nc,D),Qn(ka,O))}function Bp(D){Nc.current===D&&(Er(ka),Er(Nc))}var Ms=Ss(0);function kp(D){for(var O=D;O!==null;){if(O.tag===13){var Y=O.memoizedState;if(Y!==null&&(Y=Y.dehydrated,Y===null||Je(Y)||pt(Y)))return O}else if(O.tag===19&&O.memoizedProps.revealOrder!==void 0){if(O.flags&128)return O}else if(O.child!==null){O.child.return=O,O=O.child;continue}if(O===D)break;for(;O.sibling===null;){if(O.return===null||O.return===D)return null;O=O.return}O.sibling.return=O.return,O=O.sibling}return null}var dg=[];function pg(){for(var D=0;D<dg.length;D++){var O=dg[D];Tn?O._workInProgressVersionPrimary=null:O._workInProgressVersionSecondary=null}dg.length=0}var Op=l.ReactCurrentDispatcher,Ka=l.ReactCurrentBatchConfig,Jh=0,Cs=null,Do=null,Ys=null,_u=!1,yu=!1,$u=0,qu=0;function Vs(){throw Error(a(321))}function Kr(D,O){if(O===null)return!1;for(var Y=0;Y<O.length&&Y<D.length;Y++)if(!al(D[Y],O[Y]))return!1;return!0}function Zu(D,O,Y,ie,pe,Te){if(Jh=Te,Cs=O,O.memoizedState=null,O.updateQueue=null,O.lanes=0,Op.current=D===null||D.memoizedState===null?$v:Gp,D=Y(ie,pe),yu){Te=0;do{if(yu=!1,$u=0,25<=Te)throw Error(a(301));Te+=1,Ys=Do=null,O.updateQueue=null,Op.current=Tg,D=Y(ie,pe)}while(yu)}if(Op.current=tf,O=Do!==null&&Do.next!==null,Jh=0,Ys=Do=Cs=null,_u=!1,O)throw Error(a(300));return D}function Qh(){var D=$u!==0;return $u=0,D}function Ml(){var D={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ys===null?Cs.memoizedState=Ys=D:Ys=Ys.next=D,Ys}function ul(){if(Do===null){var D=Cs.alternate;D=D!==null?D.memoizedState:null}else D=Do.next;var O=Ys===null?Cs.memoizedState:Ys.next;if(O!==null)Ys=O,Do=D;else{if(D===null)throw Error(a(310));Do=D,D={memoizedState:Do.memoizedState,baseState:Do.baseState,baseQueue:Do.baseQueue,queue:Do.queue,next:null},Ys===null?Cs.memoizedState=Ys=D:Ys=Ys.next=D}return Ys}function ic(D,O){return typeof O=="function"?O(D):O}function xi(D){var O=ul(),Y=O.queue;if(Y===null)throw Error(a(311));Y.lastRenderedReducer=D;var ie=Do,pe=ie.baseQueue,Te=Y.pending;if(Te!==null){if(pe!==null){var dt=pe.next;pe.next=Te.next,Te.next=dt}ie.baseQueue=pe=Te,Y.pending=null}if(pe!==null){Te=pe.next,ie=ie.baseState;var Ot=dt=null,vn=null,Wn=Te;do{var br=Wn.lane;if((Jh&br)===br)vn!==null&&(vn=vn.next={lane:0,action:Wn.action,hasEagerState:Wn.hasEagerState,eagerState:Wn.eagerState,next:null}),ie=Wn.hasEagerState?Wn.eagerState:D(ie,Wn.action);else{var ai={lane:br,action:Wn.action,hasEagerState:Wn.hasEagerState,eagerState:Wn.eagerState,next:null};vn===null?(Ot=vn=ai,dt=ie):vn=vn.next=ai,Cs.lanes|=br,uf|=br}Wn=Wn.next}while(Wn!==null&&Wn!==Te);vn===null?dt=ie:vn.next=Ot,al(ie,O.memoizedState)||(bo=!0),O.memoizedState=ie,O.baseState=dt,O.baseQueue=vn,Y.lastRenderedState=ie}if(D=Y.interleaved,D!==null){pe=D;do Te=pe.lane,Cs.lanes|=Te,uf|=Te,pe=pe.next;while(pe!==D)}else pe===null&&(Y.lanes=0);return[O.memoizedState,Y.dispatch]}function vd(D){var O=ul(),Y=O.queue;if(Y===null)throw Error(a(311));Y.lastRenderedReducer=D;var ie=Y.dispatch,pe=Y.pending,Te=O.memoizedState;if(pe!==null){Y.pending=null;var dt=pe=pe.next;do Te=D(Te,dt.action),dt=dt.next;while(dt!==pe);al(Te,O.memoizedState)||(bo=!0),O.memoizedState=Te,O.baseQueue===null&&(O.baseState=Te),Y.lastRenderedState=Te}return[Te,ie]}function zv(){}function mg(D,O){var Y=Cs,ie=ul(),pe=O(),Te=!al(ie.memoizedState,pe);if(Te&&(ie.memoizedState=pe,bo=!0),ie=ie.queue,ef(Uv.bind(null,Y,ie,D),[D]),ie.getSnapshot!==O||Te||Ys!==null&&Ys.memoizedState.tag&1){if(Y.flags|=2048,zc(9,_d.bind(null,Y,ie,pe,O),void 0,null),Ks===null)throw Error(a(349));Jh&30||Fp(Y,O,pe)}return pe}function Fp(D,O,Y){D.flags|=16384,D={getSnapshot:O,value:Y},O=Cs.updateQueue,O===null?(O={lastEffect:null,stores:null},Cs.updateQueue=O,O.stores=[D]):(Y=O.stores,Y===null?O.stores=[D]:Y.push(D))}function _d(D,O,Y,ie){O.value=Y,O.getSnapshot=ie,Gv(O)&&Qa(D,1,-1)}function Uv(D,O,Y){return Y(function(){Gv(O)&&Qa(D,1,-1)})}function Gv(D){var O=D.getSnapshot;D=D.value;try{var Y=O();return!al(D,Y)}catch{return!0}}function gg(D){var O=Ml();return typeof D=="function"&&(D=D()),O.memoizedState=O.baseState=D,D={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ic,lastRenderedState:D},O.queue=D,D=D.dispatch=Xv.bind(null,Cs,D),[O.memoizedState,D]}function zc(D,O,Y,ie){return D={tag:D,create:O,destroy:Y,deps:ie,next:null},O=Cs.updateQueue,O===null?(O={lastEffect:null,stores:null},Cs.updateQueue=O,O.lastEffect=D.next=D):(Y=O.lastEffect,Y===null?O.lastEffect=D.next=D:(ie=Y.next,Y.next=D,D.next=ie,O.lastEffect=D)),D}function Vv(){return ul().memoizedState}function vg(D,O,Y,ie){var pe=Ml();Cs.flags|=D,pe.memoizedState=zc(1|O,Y,void 0,ie===void 0?null:ie)}function _g(D,O,Y,ie){var pe=ul();ie=ie===void 0?null:ie;var Te=void 0;if(Do!==null){var dt=Do.memoizedState;if(Te=dt.destroy,ie!==null&&Kr(ie,dt.deps)){pe.memoizedState=zc(O,Y,Te,ie);return}}Cs.flags|=D,pe.memoizedState=zc(1|O,Y,Te,ie)}function Hv(D,O){return vg(8390656,8,D,O)}function ef(D,O){return _g(2048,8,D,O)}function yg(D,O){return _g(4,2,D,O)}function xg(D,O){return _g(4,4,D,O)}function bg(D,O){if(typeof O=="function")return D=D(),O(D),function(){O(null)};if(O!=null)return D=D(),O.current=D,function(){O.current=null}}function jv(D,O,Y){return Y=Y!=null?Y.concat([D]):null,_g(4,4,bg.bind(null,O,D),Y)}function wg(){}function E1(D,O){var Y=ul();O=O===void 0?null:O;var ie=Y.memoizedState;return ie!==null&&O!==null&&Kr(O,ie[1])?ie[0]:(Y.memoizedState=[D,O],D)}function yd(D,O){var Y=ul();O=O===void 0?null:O;var ie=Y.memoizedState;return ie!==null&&O!==null&&Kr(O,ie[1])?ie[0]:(D=D(),Y.memoizedState=[D,O],D)}function Np(D,O){var Y=vr;vr=Y!==0&&4>Y?Y:4,D(!0);var ie=Ka.transition;Ka.transition={};try{D(!1),O()}finally{vr=Y,Ka.transition=ie}}function Wv(){return ul().memoizedState}function hl(D,O,Y){var ie=uc(D);Y={lane:ie,action:Y,hasEagerState:!1,eagerState:null,next:null},zp(D)?Up(O,Y):(Sg(D,O,Y),Y=Js(),D=Qa(D,ie,Y),D!==null&&Ag(D,O,ie))}function Xv(D,O,Y){var ie=uc(D),pe={lane:ie,action:Y,hasEagerState:!1,eagerState:null,next:null};if(zp(D))Up(O,pe);else{Sg(D,O,pe);var Te=D.alternate;if(D.lanes===0&&(Te===null||Te.lanes===0)&&(Te=O.lastRenderedReducer,Te!==null))try{var dt=O.lastRenderedState,Ot=Te(dt,Y);if(pe.hasEagerState=!0,pe.eagerState=Ot,al(Ot,dt))return}catch{}finally{}Y=Js(),D=Qa(D,ie,Y),D!==null&&Ag(D,O,ie)}}function zp(D){var O=D.alternate;return D===Cs||O!==null&&O===Cs}function Up(D,O){yu=_u=!0;var Y=D.pending;Y===null?O.next=O:(O.next=Y.next,Y.next=O),D.pending=O}function Sg(D,O,Y){Ks!==null&&D.mode&1&&!(di&2)?(D=O.interleaved,D===null?(Y.next=Y,La===null?La=[O]:La.push(O)):(Y.next=D.next,D.next=Y),O.interleaved=Y):(D=O.pending,D===null?Y.next=Y:(Y.next=D.next,D.next=Y),O.pending=Y)}function Ag(D,O,Y){if(Y&4194240){var ie=O.lanes;ie&=D.pendingLanes,Y|=ie,O.lanes=Y,Cp(D,Y)}}var tf={readContext:Zs,useCallback:Vs,useContext:Vs,useEffect:Vs,useImperativeHandle:Vs,useInsertionEffect:Vs,useLayoutEffect:Vs,useMemo:Vs,useReducer:Vs,useRef:Vs,useState:Vs,useDebugValue:Vs,useDeferredValue:Vs,useTransition:Vs,useMutableSource:Vs,useSyncExternalStore:Vs,useId:Vs,unstable_isNewReconciler:!1},$v={readContext:Zs,useCallback:function(D,O){return Ml().memoizedState=[D,O===void 0?null:O],D},useContext:Zs,useEffect:Hv,useImperativeHandle:function(D,O,Y){return Y=Y!=null?Y.concat([D]):null,vg(4194308,4,bg.bind(null,O,D),Y)},useLayoutEffect:function(D,O){return vg(4194308,4,D,O)},useInsertionEffect:function(D,O){return vg(4,2,D,O)},useMemo:function(D,O){var Y=Ml();return O=O===void 0?null:O,D=D(),Y.memoizedState=[D,O],D},useReducer:function(D,O,Y){var ie=Ml();return O=Y!==void 0?Y(O):O,ie.memoizedState=ie.baseState=O,D={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:D,lastRenderedState:O},ie.queue=D,D=D.dispatch=hl.bind(null,Cs,D),[ie.memoizedState,D]},useRef:function(D){var O=Ml();return D={current:D},O.memoizedState=D},useState:gg,useDebugValue:wg,useDeferredValue:function(D){var O=gg(D),Y=O[0],ie=O[1];return Hv(function(){var pe=Ka.transition;Ka.transition={};try{ie(D)}finally{Ka.transition=pe}},[D]),Y},useTransition:function(){var D=gg(!1),O=D[0];return D=Np.bind(null,D[1]),Ml().memoizedState=D,[O,D]},useMutableSource:function(){},useSyncExternalStore:function(D,O,Y){var ie=Cs,pe=Ml();if(ns){if(Y===void 0)throw Error(a(407));Y=Y()}else{if(Y=O(),Ks===null)throw Error(a(349));Jh&30||Fp(ie,O,Y)}pe.memoizedState=Y;var Te={value:Y,getSnapshot:O};return pe.queue=Te,Hv(Uv.bind(null,ie,Te,D),[D]),ie.flags|=2048,zc(9,_d.bind(null,ie,Te,Y,O),void 0,null),Y},useId:function(){var D=Ml(),O=Ks.identifierPrefix;if(ns){var Y=ec,ie=pr;Y=(ie&~(1<<32-Ra(ie)-1)).toString(32)+Y,O=":"+O+"R"+Y,Y=$u++,0<Y&&(O+="H"+Y.toString(32)),O+=":"}else Y=qu++,O=":"+O+"r"+Y.toString(32)+":";return D.memoizedState=O},unstable_isNewReconciler:!1},Gp={readContext:Zs,useCallback:E1,useContext:Zs,useEffect:ef,useImperativeHandle:jv,useInsertionEffect:yg,useLayoutEffect:xg,useMemo:yd,useReducer:xi,useRef:Vv,useState:function(){return xi(ic)},useDebugValue:wg,useDeferredValue:function(D){var O=xi(ic),Y=O[0],ie=O[1];return ef(function(){var pe=Ka.transition;Ka.transition={};try{ie(D)}finally{Ka.transition=pe}},[D]),Y},useTransition:function(){var D=xi(ic)[0],O=ul().memoizedState;return[D,O]},useMutableSource:zv,useSyncExternalStore:mg,useId:Wv,unstable_isNewReconciler:!1},Tg={readContext:Zs,useCallback:E1,useContext:Zs,useEffect:ef,useImperativeHandle:jv,useInsertionEffect:yg,useLayoutEffect:xg,useMemo:yd,useReducer:vd,useRef:Vv,useState:function(){return vd(ic)},useDebugValue:wg,useDeferredValue:function(D){var O=vd(ic),Y=O[0],ie=O[1];return ef(function(){var pe=Ka.transition;Ka.transition={};try{ie(D)}finally{Ka.transition=pe}},[D]),Y},useTransition:function(){var D=vd(ic)[0],O=ul().memoizedState;return[D,O]},useMutableSource:zv,useSyncExternalStore:mg,useId:Wv,unstable_isNewReconciler:!1};function Vp(D,O){try{var Y="",ie=O;do Y+=lg(ie),ie=ie.return;while(ie);var pe=Y}catch(Te){pe=`
Error generating stack: `+Te.message+`
`+Te.stack}return{value:D,source:O,stack:pe}}function Mg(D,O){try{console.error(O.value)}catch(Y){setTimeout(function(){throw Y})}}var xd=typeof WeakMap=="function"?WeakMap:Map;function I1(D,O,Y){Y=oa(-1,Y),Y.tag=3,Y.payload={element:null};var ie=O.value;return Y.callback=function(){Ja||(Ja=!0,i_=ie),Mg(D,O)},Y}function qv(D,O,Y){Y=oa(-1,Y),Y.tag=3;var ie=D.type.getDerivedStateFromError;if(typeof ie=="function"){var pe=O.value;Y.payload=function(){return ie(pe)},Y.callback=function(){Mg(D,O)}}var Te=D.stateNode;return Te!==null&&typeof Te.componentDidCatch=="function"&&(Y.callback=function(){Mg(D,O),typeof ie!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var dt=O.stack;this.componentDidCatch(O.value,{componentStack:dt!==null?dt:""})}),Y}function Zv(D,O,Y){var ie=D.pingCache;if(ie===null){ie=D.pingCache=new xd;var pe=new Set;ie.set(O,pe)}else pe=ie.get(O),pe===void 0&&(pe=new Set,ie.set(O,pe));pe.has(Y)||(pe.add(Y),D=Vg.bind(null,D,O,Y),O.then(D,D))}function nf(D){do{var O;if((O=D.tag===13)&&(O=D.memoizedState,O=O!==null?O.dehydrated!==null:!0),O)return D;D=D.return}while(D!==null);return null}function Yv(D,O,Y,ie,pe){return D.mode&1?(D.flags|=65536,D.lanes=pe,D):(D===O?D.flags|=65536:(D.flags|=128,Y.flags|=131072,Y.flags&=-52805,Y.tag===1&&(Y.alternate===null?Y.tag=17:(O=oa(-1,1),O.tag=2,ju(Y,O))),Y.lanes|=1),D)}function sc(D){D.flags|=4}function Cg(D,O){if(D!==null&&D.child===O.child)return!0;if(O.flags&16)return!1;for(D=O.child;D!==null;){if(D.flags&12854||D.subtreeFlags&12854)return!1;D=D.sibling}return!0}var xu,Yu,bu,Hp;if(Pe)xu=function(D,O){for(var Y=O.child;Y!==null;){if(Y.tag===5||Y.tag===6)wt(D,Y.stateNode);else if(Y.tag!==4&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===O)break;for(;Y.sibling===null;){if(Y.return===null||Y.return===O)return;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}},Yu=function(){},bu=function(D,O,Y,ie,pe){if(D=D.memoizedProps,D!==ie){var Te=O.stateNode,dt=rc(ka.current);Y=lt(Te,Y,D,ie,pe,dt),(O.updateQueue=Y)&&sc(O)}},Hp=function(D,O,Y,ie){Y!==ie&&sc(O)};else if(qe){xu=function(D,O,Y,ie){for(var pe=O.child;pe!==null;){if(pe.tag===5){var Te=pe.stateNode;Y&&ie&&(Te=Tt(Te,pe.type,pe.memoizedProps,pe)),wt(D,Te)}else if(pe.tag===6)Te=pe.stateNode,Y&&ie&&(Te=xe(Te,pe.memoizedProps,pe)),wt(D,Te);else if(pe.tag!==4){if(pe.tag===22&&pe.memoizedState!==null)Te=pe.child,Te!==null&&(Te.return=pe),xu(D,pe,!0,!0);else if(pe.child!==null){pe.child.return=pe,pe=pe.child;continue}}if(pe===O)break;for(;pe.sibling===null;){if(pe.return===null||pe.return===O)return;pe=pe.return}pe.sibling.return=pe.return,pe=pe.sibling}};var Eg=function(D,O,Y,ie){for(var pe=O.child;pe!==null;){if(pe.tag===5){var Te=pe.stateNode;Y&&ie&&(Te=Tt(Te,pe.type,pe.memoizedProps,pe)),hs(D,Te)}else if(pe.tag===6)Te=pe.stateNode,Y&&ie&&(Te=xe(Te,pe.memoizedProps,pe)),hs(D,Te);else if(pe.tag!==4){if(pe.tag===22&&pe.memoizedState!==null)Te=pe.child,Te!==null&&(Te.return=pe),Eg(D,pe,!0,!0);else if(pe.child!==null){pe.child.return=pe,pe=pe.child;continue}}if(pe===O)break;for(;pe.sibling===null;){if(pe.return===null||pe.return===O)return;pe=pe.return}pe.sibling.return=pe.return,pe=pe.sibling}};Yu=function(D,O){var Y=O.stateNode;if(!Cg(D,O)){D=Y.containerInfo;var ie=Vr(D);Eg(ie,O,!1,!1),Y.pendingChildren=ie,sc(O),Ps(D,ie)}},bu=function(D,O,Y,ie,pe){var Te=D.stateNode,dt=D.memoizedProps;if((D=Cg(D,O))&&dt===ie)O.stateNode=Te;else{var Ot=O.stateNode,vn=rc(ka.current),Wn=null;dt!==ie&&(Wn=lt(Ot,Y,dt,ie,pe,vn)),D&&Wn===null?O.stateNode=Te:(Te=Ar(Te,Wn,Y,dt,ie,O,D,Ot),Vt(Te,Y,ie,pe,vn)&&sc(O),O.stateNode=Te,D?sc(O):xu(Te,O,!1,!1))}},Hp=function(D,O,Y,ie){Y!==ie?(D=rc(Yh.current),Y=rc(ka.current),O.stateNode=Qt(ie,D,Y,O),sc(O)):O.stateNode=D.stateNode}}else Yu=function(){},bu=function(){},Hp=function(){};function rf(D,O){if(!ns)switch(D.tailMode){case"hidden":O=D.tail;for(var Y=null;O!==null;)O.alternate!==null&&(Y=O),O=O.sibling;Y===null?D.tail=null:Y.sibling=null;break;case"collapsed":Y=D.tail;for(var ie=null;Y!==null;)Y.alternate!==null&&(ie=Y),Y=Y.sibling;ie===null?O||D.tail===null?D.tail=null:D.tail.sibling=null:ie.sibling=null}}function Zo(D){var O=D.alternate!==null&&D.alternate.child===D.child,Y=0,ie=0;if(O)for(var pe=D.child;pe!==null;)Y|=pe.lanes|pe.childLanes,ie|=pe.subtreeFlags&14680064,ie|=pe.flags&14680064,pe.return=D,pe=pe.sibling;else for(pe=D.child;pe!==null;)Y|=pe.lanes|pe.childLanes,ie|=pe.subtreeFlags,ie|=pe.flags,pe.return=D,pe=pe.sibling;return D.subtreeFlags|=ie,D.childLanes=Y,O}function sf(D,O,Y){var ie=O.pendingProps;switch(md(O),O.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zo(O),null;case 1:return fs(O.type)&&Pi(),Zo(O),null;case 3:return ie=O.stateNode,Kh(),Er(_s),Er(qr),pg(),ie.pendingContext&&(ie.context=ie.pendingContext,ie.pendingContext=null),(D===null||D.child===null)&&(qh(O)?sc(O):D===null||D.memoizedState.isDehydrated&&!(O.flags&256)||(O.flags|=1024,Za!==null&&(Pd(Za),Za=null))),Yu(D,O),Zo(O),null;case 5:Bp(O),Y=rc(Yh.current);var pe=O.type;if(D!==null&&O.stateNode!=null)bu(D,O,pe,ie,Y),D.ref!==O.ref&&(O.flags|=512,O.flags|=2097152);else{if(!ie){if(O.stateNode===null)throw Error(a(166));return Zo(O),null}if(D=rc(ka.current),qh(O)){if(!mn)throw Error(a(175));D=ln(O.stateNode,O.type,O.memoizedProps,Y,D,O,!ao),O.updateQueue=D,D!==null&&sc(O)}else{var Te=_t(pe,ie,Y,D,O);xu(Te,O,!1,!1),O.stateNode=Te,Vt(Te,pe,ie,Y,D)&&sc(O)}O.ref!==null&&(O.flags|=512,O.flags|=2097152)}return Zo(O),null;case 6:if(D&&O.stateNode!=null)Hp(D,O,D.memoizedProps,ie);else{if(typeof ie!="string"&&O.stateNode===null)throw Error(a(166));if(D=rc(Yh.current),Y=rc(ka.current),qh(O)){if(!mn)throw Error(a(176));if(D=O.stateNode,ie=O.memoizedProps,(Y=Mn(D,ie,O,!ao))&&(pe=Ba,pe!==null))switch(Te=(pe.mode&1)!==0,pe.tag){case 3:_n(pe.stateNode.containerInfo,D,ie,Te);break;case 5:zn(pe.type,pe.memoizedProps,pe.stateNode,D,ie,Te)}Y&&sc(O)}else O.stateNode=Qt(ie,D,Y,O)}return Zo(O),null;case 13:if(Er(Ms),ie=O.memoizedState,ns&&xo!==null&&O.mode&1&&!(O.flags&128)){for(D=xo;D;)D=gt(D);return yn(),O.flags|=98560,O}if(ie!==null&&ie.dehydrated!==null){if(ie=qh(O),D===null){if(!ie)throw Error(a(318));if(!mn)throw Error(a(344));if(D=O.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));Cn(D,O)}else yn(),!(O.flags&128)&&(O.memoizedState=null),O.flags|=4;return Zo(O),null}return Za!==null&&(Pd(Za),Za=null),O.flags&128?(O.lanes=Y,O):(ie=ie!==null,Y=!1,D===null?qh(O):Y=D.memoizedState!==null,ie&&!Y&&(O.child.flags|=8192,O.mode&1&&(D===null||Ms.current&1?Oo===0&&(Oo=3):wo())),O.updateQueue!==null&&(O.flags|=4),Zo(O),null);case 4:return Kh(),Yu(D,O),D===null&&St(O.stateNode.containerInfo),Zo(O),null;case 10:return cl(O.type._context),Zo(O),null;case 17:return fs(O.type)&&Pi(),Zo(O),null;case 19:if(Er(Ms),pe=O.memoizedState,pe===null)return Zo(O),null;if(ie=(O.flags&128)!==0,Te=pe.rendering,Te===null)if(ie)rf(pe,!1);else{if(Oo!==0||D!==null&&D.flags&128)for(D=O.child;D!==null;){if(Te=kp(D),Te!==null){for(O.flags|=128,rf(pe,!1),D=Te.updateQueue,D!==null&&(O.updateQueue=D,O.flags|=4),O.subtreeFlags=0,D=Y,ie=O.child;ie!==null;)Y=ie,pe=D,Y.flags&=14680066,Te=Y.alternate,Te===null?(Y.childLanes=0,Y.lanes=pe,Y.child=null,Y.subtreeFlags=0,Y.memoizedProps=null,Y.memoizedState=null,Y.updateQueue=null,Y.dependencies=null,Y.stateNode=null):(Y.childLanes=Te.childLanes,Y.lanes=Te.lanes,Y.child=Te.child,Y.subtreeFlags=0,Y.deletions=null,Y.memoizedProps=Te.memoizedProps,Y.memoizedState=Te.memoizedState,Y.updateQueue=Te.updateQueue,Y.type=Te.type,pe=Te.dependencies,Y.dependencies=pe===null?null:{lanes:pe.lanes,firstContext:pe.firstContext}),ie=ie.sibling;return Qn(Ms,Ms.current&1|2),O.child}D=D.sibling}pe.tail!==null&&xs()>th&&(O.flags|=128,ie=!0,rf(pe,!1),O.lanes=4194304)}else{if(!ie)if(D=kp(Te),D!==null){if(O.flags|=128,ie=!0,D=D.updateQueue,D!==null&&(O.updateQueue=D,O.flags|=4),rf(pe,!0),pe.tail===null&&pe.tailMode==="hidden"&&!Te.alternate&&!ns)return Zo(O),null}else 2*xs()-pe.renderingStartTime>th&&Y!==1073741824&&(O.flags|=128,ie=!0,rf(pe,!1),O.lanes=4194304);pe.isBackwards?(Te.sibling=O.child,O.child=Te):(D=pe.last,D!==null?D.sibling=Te:O.child=Te,pe.last=Te)}return pe.tail!==null?(O=pe.tail,pe.rendering=O,pe.tail=O.sibling,pe.renderingStartTime=xs(),O.sibling=null,D=Ms.current,Qn(Ms,ie?D&1|2:D&1),O):(Zo(O),null);case 22:case 23:return nh(),ie=O.memoizedState!==null,D!==null&&D.memoizedState!==null!==ie&&(O.flags|=8192),ie&&O.mode&1?ko&1073741824&&(Zo(O),Pe&&O.subtreeFlags&6&&(O.flags|=8192)):Zo(O),null;case 24:return null;case 25:return null}throw Error(a(156,O.tag))}var R1=l.ReactCurrentOwner,bo=!1;function la(D,O,Y,ie){O.child=D===null?hg(O,null,Y,ie):Ya(O,D.child,Y,ie)}function jp(D,O,Y,ie,pe){Y=Y.render;var Te=O.ref;return Hu(O,pe),ie=Zu(D,O,Y,ie,Te,pe),Y=Qh(),D!==null&&!bo?(O.updateQueue=D.updateQueue,O.flags&=-2053,D.lanes&=~pe,Cl(D,O,pe)):(ns&&Y&&Pp(O),O.flags|=1,la(D,O,ie,pe),O.child)}function Ig(D,O,Y,ie,pe){if(D===null){var Te=Y.type;return typeof Te=="function"&&!Wg(Te)&&Te.defaultProps===void 0&&Y.compare===null&&Y.defaultProps===void 0?(O.tag=15,O.type=Te,Kv(D,O,Te,ie,pe)):(D=nm(Y.type,null,ie,O,O.mode,pe),D.ref=O.ref,D.return=O,O.child=D)}if(Te=D.child,!(D.lanes&pe)){var dt=Te.memoizedProps;if(Y=Y.compare,Y=Y!==null?Y:ll,Y(dt,ie)&&D.ref===O.ref)return Cl(D,O,pe)}return O.flags|=1,D=Au(Te,ie),D.ref=O.ref,D.return=O,O.child=D}function Kv(D,O,Y,ie,pe){if(D!==null&&ll(D.memoizedProps,ie)&&D.ref===O.ref)if(bo=!1,(D.lanes&pe)!==0)D.flags&131072&&(bo=!0);else return O.lanes=D.lanes,Cl(D,O,pe);return Pg(D,O,Y,ie,pe)}function Rg(D,O,Y){var ie=O.pendingProps,pe=ie.children,Te=D!==null?D.memoizedState:null;if(ie.mode==="hidden")if(!(O.mode&1))O.memoizedState={baseLanes:0,cachePool:null},Qn(lc,ko),ko|=Y;else if(Y&1073741824)O.memoizedState={baseLanes:0,cachePool:null},ie=Te!==null?Te.baseLanes:Y,Qn(lc,ko),ko|=ie;else return D=Te!==null?Te.baseLanes|Y:Y,O.lanes=O.childLanes=1073741824,O.memoizedState={baseLanes:D,cachePool:null},O.updateQueue=null,Qn(lc,ko),ko|=D,null;else Te!==null?(ie=Te.baseLanes|Y,O.memoizedState=null):ie=Y,Qn(lc,ko),ko|=ie;return la(D,O,pe,Y),O.child}function Wp(D,O){var Y=O.ref;(D===null&&Y!==null||D!==null&&D.ref!==Y)&&(O.flags|=512,O.flags|=2097152)}function Pg(D,O,Y,ie,pe){var Te=fs(Y)?Xo:qr.current;return Te=Ls(O,Te),Hu(O,pe),Y=Zu(D,O,Y,ie,Te,pe),ie=Qh(),D!==null&&!bo?(O.updateQueue=D.updateQueue,O.flags&=-2053,D.lanes&=~pe,Cl(D,O,pe)):(ns&&ie&&Pp(O),O.flags|=1,la(D,O,Y,pe),O.child)}function Jv(D,O,Y,ie,pe){if(fs(Y)){var Te=!0;As(O)}else Te=!1;if(Hu(O,pe),O.stateNode===null)D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),pd(O,Y,ie),Nv(O,Y,ie,pe),ie=!0;else if(D===null){var dt=O.stateNode,Ot=O.memoizedProps;dt.props=Ot;var vn=dt.context,Wn=Y.contextType;typeof Wn=="object"&&Wn!==null?Wn=Zs(Wn):(Wn=fs(Y)?Xo:qr.current,Wn=Ls(O,Wn));var br=Y.getDerivedStateFromProps,ai=typeof br=="function"||typeof dt.getSnapshotBeforeUpdate=="function";ai||typeof dt.UNSAFE_componentWillReceiveProps!="function"&&typeof dt.componentWillReceiveProps!="function"||(Ot!==ie||vn!==Wn)&&Xu(O,dt,ie,Wn),qa=!1;var zr=O.memoizedState;dt.state=zr,cg(O,ie,dt,pe),vn=O.memoizedState,Ot!==ie||zr!==vn||_s.current||qa?(typeof br=="function"&&(Wu(O,Y,br,ie),vn=O.memoizedState),(Ot=qa||C1(O,Y,Ot,ie,zr,vn,Wn))?(ai||typeof dt.UNSAFE_componentWillMount!="function"&&typeof dt.componentWillMount!="function"||(typeof dt.componentWillMount=="function"&&dt.componentWillMount(),typeof dt.UNSAFE_componentWillMount=="function"&&dt.UNSAFE_componentWillMount()),typeof dt.componentDidMount=="function"&&(O.flags|=4194308)):(typeof dt.componentDidMount=="function"&&(O.flags|=4194308),O.memoizedProps=ie,O.memoizedState=vn),dt.props=ie,dt.state=vn,dt.context=Wn,ie=Ot):(typeof dt.componentDidMount=="function"&&(O.flags|=4194308),ie=!1)}else{dt=O.stateNode,Ep(D,O),Ot=O.memoizedProps,Wn=O.type===O.elementType?Ot:Gs(O.type,Ot),dt.props=Wn,ai=O.pendingProps,zr=dt.context,vn=Y.contextType,typeof vn=="object"&&vn!==null?vn=Zs(vn):(vn=fs(Y)?Xo:qr.current,vn=Ls(O,vn));var ps=Y.getDerivedStateFromProps;(br=typeof ps=="function"||typeof dt.getSnapshotBeforeUpdate=="function")||typeof dt.UNSAFE_componentWillReceiveProps!="function"&&typeof dt.componentWillReceiveProps!="function"||(Ot!==ai||zr!==vn)&&Xu(O,dt,ie,vn),qa=!1,zr=O.memoizedState,dt.state=zr,cg(O,ie,dt,pe);var Ir=O.memoizedState;Ot!==ai||zr!==Ir||_s.current||qa?(typeof ps=="function"&&(Wu(O,Y,ps,ie),Ir=O.memoizedState),(Wn=qa||C1(O,Y,Wn,ie,zr,Ir,vn)||!1)?(br||typeof dt.UNSAFE_componentWillUpdate!="function"&&typeof dt.componentWillUpdate!="function"||(typeof dt.componentWillUpdate=="function"&&dt.componentWillUpdate(ie,Ir,vn),typeof dt.UNSAFE_componentWillUpdate=="function"&&dt.UNSAFE_componentWillUpdate(ie,Ir,vn)),typeof dt.componentDidUpdate=="function"&&(O.flags|=4),typeof dt.getSnapshotBeforeUpdate=="function"&&(O.flags|=1024)):(typeof dt.componentDidUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=4),typeof dt.getSnapshotBeforeUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=1024),O.memoizedProps=ie,O.memoizedState=Ir),dt.props=ie,dt.state=Ir,dt.context=vn,ie=Wn):(typeof dt.componentDidUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=4),typeof dt.getSnapshotBeforeUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=1024),ie=!1)}return of(D,O,Y,ie,Te,pe)}function of(D,O,Y,ie,pe,Te){Wp(D,O);var dt=(O.flags&128)!==0;if(!ie&&!dt)return pe&&Bc(O,Y,!1),Cl(D,O,Te);ie=O.stateNode,R1.current=O;var Ot=dt&&typeof Y.getDerivedStateFromError!="function"?null:ie.render();return O.flags|=1,D!==null&&dt?(O.child=Ya(O,D.child,null,Te),O.child=Ya(O,null,Ot,Te)):la(D,O,Ot,Te),O.memoizedState=ie.state,pe&&Bc(O,Y,!0),O.child}function P1(D){var O=D.stateNode;O.pendingContext?oo(D,O.pendingContext,O.pendingContext!==O.context):O.context&&oo(D,O.context,!1),Oa(D,O.containerInfo)}function Qv(D,O,Y,ie,pe){return yn(),ug(pe),O.flags|=256,la(D,O,Y,ie),O.child}var Xp={dehydrated:null,treeContext:null,retryLane:0};function Lg(D){return{baseLanes:D,cachePool:null}}function $p(D,O,Y){var ie=O.pendingProps,pe=Ms.current,Te=!1,dt=(O.flags&128)!==0,Ot;if((Ot=dt)||(Ot=D!==null&&D.memoizedState===null?!1:(pe&2)!==0),Ot?(Te=!0,O.flags&=-129):(D===null||D.memoizedState!==null)&&(pe|=1),Qn(Ms,pe&1),D===null)return nc(O),D=O.memoizedState,D!==null&&(D=D.dehydrated,D!==null)?(O.mode&1?pt(D)?O.lanes=8:O.lanes=1073741824:O.lanes=1,null):(pe=ie.children,D=ie.fallback,Te?(ie=O.mode,Te=O.child,pe={mode:"hidden",children:pe},!(ie&1)&&Te!==null?(Te.childLanes=0,Te.pendingProps=pe):Te=rm(pe,ie,0,null),D=rh(D,ie,Y,null),Te.return=O,D.return=O,Te.sibling=D,O.child=Te,O.child.memoizedState=Lg(Y),O.memoizedState=Xp,D):bd(O,pe));if(pe=D.memoizedState,pe!==null){if(Ot=pe.dehydrated,Ot!==null){if(dt)return O.flags&256?(O.flags&=-257,fl(D,O,Y,Error(a(422)))):O.memoizedState!==null?(O.child=D.child,O.flags|=128,null):(Te=ie.fallback,pe=O.mode,ie=rm({mode:"visible",children:ie.children},pe,0,null),Te=rh(Te,pe,Y,null),Te.flags|=2,ie.return=O,Te.return=O,ie.sibling=Te,O.child=ie,O.mode&1&&Ya(O,D.child,null,Y),O.child.memoizedState=Lg(Y),O.memoizedState=Xp,Te);if(!(O.mode&1))O=fl(D,O,Y,null);else if(pt(Ot))O=fl(D,O,Y,Error(a(419)));else if(ie=(Y&D.childLanes)!==0,bo||ie){if(ie=Ks,ie!==null){switch(Y&-Y){case 4:Te=2;break;case 16:Te=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Te=32;break;case 536870912:Te=268435456;break;default:Te=0}ie=Te&(ie.suspendedLanes|Y)?0:Te,ie!==0&&ie!==pe.retryLane&&(pe.retryLane=ie,Qa(D,ie,-1))}wo(),O=fl(D,O,Y,Error(a(421)))}else Je(Ot)?(O.flags|=128,O.child=D.child,O=O1.bind(null,D),Rt(Ot,O),O=null):(Y=pe.treeContext,mn&&(xo=Bt(Ot),Ba=O,ns=!0,Za=null,ao=!1,Y!==null&&(Mr[$n++]=pr,Mr[$n++]=ec,Mr[$n++]=vu,pr=Y.id,ec=Y.overflow,vu=O)),O=bd(O,O.pendingProps.children),O.flags|=4096);return O}return Te?(ie=Dg(D,O,ie.children,ie.fallback,Y),Te=O.child,pe=D.child.memoizedState,Te.memoizedState=pe===null?Lg(Y):{baseLanes:pe.baseLanes|Y,cachePool:null},Te.childLanes=D.childLanes&~Y,O.memoizedState=Xp,ie):(Y=wd(D,O,ie.children,Y),O.memoizedState=null,Y)}return Te?(ie=Dg(D,O,ie.children,ie.fallback,Y),Te=O.child,pe=D.child.memoizedState,Te.memoizedState=pe===null?Lg(Y):{baseLanes:pe.baseLanes|Y,cachePool:null},Te.childLanes=D.childLanes&~Y,O.memoizedState=Xp,ie):(Y=wd(D,O,ie.children,Y),O.memoizedState=null,Y)}function bd(D,O){return O=rm({mode:"visible",children:O},D.mode,0,null),O.return=D,D.child=O}function wd(D,O,Y,ie){var pe=D.child;return D=pe.sibling,Y=Au(pe,{mode:"visible",children:Y}),!(O.mode&1)&&(Y.lanes=ie),Y.return=O,Y.sibling=null,D!==null&&(ie=O.deletions,ie===null?(O.deletions=[D],O.flags|=16):ie.push(D)),O.child=Y}function Dg(D,O,Y,ie,pe){var Te=O.mode;D=D.child;var dt=D.sibling,Ot={mode:"hidden",children:Y};return!(Te&1)&&O.child!==D?(Y=O.child,Y.childLanes=0,Y.pendingProps=Ot,O.deletions=null):(Y=Au(D,Ot),Y.subtreeFlags=D.subtreeFlags&14680064),dt!==null?ie=Au(dt,ie):(ie=rh(ie,Te,pe,null),ie.flags|=2),ie.return=O,Y.return=O,Y.sibling=ie,O.child=Y,ie}function fl(D,O,Y,ie){return ie!==null&&ug(ie),Ya(O,D.child,null,Y),D=bd(O,O.pendingProps.children),D.flags|=2,O.memoizedState=null,D}function e_(D,O,Y){D.lanes|=O;var ie=D.alternate;ie!==null&&(ie.lanes|=O),qs(D.return,O,Y)}function Sd(D,O,Y,ie,pe){var Te=D.memoizedState;Te===null?D.memoizedState={isBackwards:O,rendering:null,renderingStartTime:0,last:ie,tail:Y,tailMode:pe}:(Te.isBackwards=O,Te.rendering=null,Te.renderingStartTime=0,Te.last=ie,Te.tail=Y,Te.tailMode=pe)}function qp(D,O,Y){var ie=O.pendingProps,pe=ie.revealOrder,Te=ie.tail;if(la(D,O,ie.children,Y),ie=Ms.current,ie&2)ie=ie&1|2,O.flags|=128;else{if(D!==null&&D.flags&128)e:for(D=O.child;D!==null;){if(D.tag===13)D.memoizedState!==null&&e_(D,Y,O);else if(D.tag===19)e_(D,Y,O);else if(D.child!==null){D.child.return=D,D=D.child;continue}if(D===O)break e;for(;D.sibling===null;){if(D.return===null||D.return===O)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}ie&=1}if(Qn(Ms,ie),!(O.mode&1))O.memoizedState=null;else switch(pe){case"forwards":for(Y=O.child,pe=null;Y!==null;)D=Y.alternate,D!==null&&kp(D)===null&&(pe=Y),Y=Y.sibling;Y=pe,Y===null?(pe=O.child,O.child=null):(pe=Y.sibling,Y.sibling=null),Sd(O,!1,pe,Y,Te);break;case"backwards":for(Y=null,pe=O.child,O.child=null;pe!==null;){if(D=pe.alternate,D!==null&&kp(D)===null){O.child=pe;break}D=pe.sibling,pe.sibling=Y,Y=pe,pe=D}Sd(O,!0,Y,null,Te);break;case"together":Sd(O,!1,null,null,void 0);break;default:O.memoizedState=null}return O.child}function Cl(D,O,Y){if(D!==null&&(O.dependencies=D.dependencies),uf|=O.lanes,!(Y&O.childLanes))return null;if(D!==null&&O.child!==D.child)throw Error(a(153));if(O.child!==null){for(D=O.child,Y=Au(D,D.pendingProps),O.child=Y,Y.return=O;D.sibling!==null;)D=D.sibling,Y=Y.sibling=Au(D,D.pendingProps),Y.return=O;Y.sibling=null}return O.child}function t_(D,O,Y){switch(O.tag){case 3:P1(O),yn();break;case 5:fg(O);break;case 1:fs(O.type)&&As(O);break;case 4:Oa(O,O.stateNode.containerInfo);break;case 10:va(O,O.type._context,O.memoizedProps.value);break;case 13:var ie=O.memoizedState;if(ie!==null)return ie.dehydrated!==null?(Qn(Ms,Ms.current&1),O.flags|=128,null):Y&O.child.childLanes?$p(D,O,Y):(Qn(Ms,Ms.current&1),D=Cl(D,O,Y),D!==null?D.sibling:null);Qn(Ms,Ms.current&1);break;case 19:if(ie=(Y&O.childLanes)!==0,D.flags&128){if(ie)return qp(D,O,Y);O.flags|=128}var pe=O.memoizedState;if(pe!==null&&(pe.rendering=null,pe.tail=null,pe.lastEffect=null),Qn(Ms,Ms.current),ie)break;return null;case 22:case 23:return O.lanes=0,Rg(D,O,Y)}return Cl(D,O,Y)}function L1(D,O){switch(md(O),O.tag){case 1:return fs(O.type)&&Pi(),D=O.flags,D&65536?(O.flags=D&-65537|128,O):null;case 3:return Kh(),Er(_s),Er(qr),pg(),D=O.flags,D&65536&&!(D&128)?(O.flags=D&-65537|128,O):null;case 5:return Bp(O),null;case 13:if(Er(Ms),D=O.memoizedState,D!==null&&D.dehydrated!==null){if(O.alternate===null)throw Error(a(340));yn()}return D=O.flags,D&65536?(O.flags=D&-65537|128,O):null;case 19:return Er(Ms),null;case 4:return Kh(),null;case 10:return cl(O.type._context),null;case 22:case 23:return nh(),null;case 24:return null;default:return null}}var Uc=!1,El=!1,Fn=typeof WeakSet=="function"?WeakSet:Set,sr=null;function Zp(D,O){var Y=D.ref;if(Y!==null)if(typeof Y=="function")try{Y(null)}catch(ie){ca(D,O,ie)}else Y.current=null}function ya(D,O,Y){try{Y()}catch(ie){ca(D,O,ie)}}var Ku=!1;function Yn(D,O){for($e(D.containerInfo),sr=O;sr!==null;)if(D=sr,O=D.child,(D.subtreeFlags&1028)!==0&&O!==null)O.return=D,sr=O;else for(;sr!==null;){D=sr;try{var Y=D.alternate;if(D.flags&1024)switch(D.tag){case 0:case 11:case 15:break;case 1:if(Y!==null){var ie=Y.memoizedProps,pe=Y.memoizedState,Te=D.stateNode,dt=Te.getSnapshotBeforeUpdate(D.elementType===D.type?ie:Gs(D.type,ie),pe);Te.__reactInternalSnapshotBeforeUpdate=dt}break;case 3:Pe&&En(D.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Ot){ca(D,D.return,Ot)}if(O=D.sibling,O!==null){O.return=D.return,sr=O;break}sr=D.return}return Y=Ku,Ku=!1,Y}function Gc(D,O,Y){var ie=O.updateQueue;if(ie=ie!==null?ie.lastEffect:null,ie!==null){var pe=ie=ie.next;do{if((pe.tag&D)===D){var Te=pe.destroy;pe.destroy=void 0,Te!==void 0&&ya(O,Y,Te)}pe=pe.next}while(pe!==ie)}}function Yp(D,O){if(O=O.updateQueue,O=O!==null?O.lastEffect:null,O!==null){var Y=O=O.next;do{if((Y.tag&D)===D){var ie=Y.create;Y.destroy=ie()}Y=Y.next}while(Y!==O)}}function Ad(D){var O=D.ref;if(O!==null){var Y=D.stateNode;switch(D.tag){case 5:D=Le(Y);break;default:D=Y}typeof O=="function"?O(D):O.current=D}}function Kp(D,O,Y){if(Us&&typeof Us.onCommitFiberUnmount=="function")try{Us.onCommitFiberUnmount(Zr,O)}catch{}switch(O.tag){case 0:case 11:case 14:case 15:if(D=O.updateQueue,D!==null&&(D=D.lastEffect,D!==null)){var ie=D=D.next;do{var pe=ie,Te=pe.destroy;pe=pe.tag,Te!==void 0&&(pe&2||pe&4)&&ya(O,Y,Te),ie=ie.next}while(ie!==D)}break;case 1:if(Zp(O,Y),D=O.stateNode,typeof D.componentWillUnmount=="function")try{D.props=O.memoizedProps,D.state=O.memoizedState,D.componentWillUnmount()}catch(dt){ca(O,Y,dt)}break;case 5:Zp(O,Y);break;case 4:Pe?lf(D,O,Y):qe&&qe&&(O=O.stateNode.containerInfo,Y=Vr(O),hi(O,Y))}}function Td(D,O,Y){for(var ie=O;;)if(Kp(D,ie,Y),ie.child===null||Pe&&ie.tag===4){if(ie===O)break;for(;ie.sibling===null;){if(ie.return===null||ie.return===O)return;ie=ie.return}ie.sibling.return=ie.return,ie=ie.sibling}else ie.child.return=ie,ie=ie.child}function Bg(D){var O=D.alternate;O!==null&&(D.alternate=null,Bg(O)),D.child=null,D.deletions=null,D.sibling=null,D.tag===5&&(O=D.stateNode,O!==null&&kn(O)),D.stateNode=null,D.return=null,D.dependencies=null,D.memoizedProps=null,D.memoizedState=null,D.pendingProps=null,D.stateNode=null,D.updateQueue=null}function D1(D){return D.tag===5||D.tag===3||D.tag===4}function B1(D){e:for(;;){for(;D.sibling===null;){if(D.return===null||D1(D.return))return null;D=D.return}for(D.sibling.return=D.return,D=D.sibling;D.tag!==5&&D.tag!==6&&D.tag!==18;){if(D.flags&2||D.child===null||D.tag===4)continue e;D.child.return=D,D=D.child}if(!(D.flags&2))return D.stateNode}}function Md(D){if(Pe){e:{for(var O=D.return;O!==null;){if(D1(O))break e;O=O.return}throw Error(a(160))}var Y=O;switch(Y.tag){case 5:O=Y.stateNode,Y.flags&32&&(yi(O),Y.flags&=-33),Y=B1(D),Cd(D,Y,O);break;case 3:case 4:O=Y.stateNode.containerInfo,Y=B1(D),af(D,Y,O);break;default:throw Error(a(161))}}}function af(D,O,Y){var ie=D.tag;if(ie===5||ie===6)D=D.stateNode,O?or(Y,D,O):Sr(Y,D);else if(ie!==4&&(D=D.child,D!==null))for(af(D,O,Y),D=D.sibling;D!==null;)af(D,O,Y),D=D.sibling}function Cd(D,O,Y){var ie=D.tag;if(ie===5||ie===6)D=D.stateNode,O?Fr(Y,D,O):tr(Y,D);else if(ie!==4&&(D=D.child,D!==null))for(Cd(D,O,Y),D=D.sibling;D!==null;)Cd(D,O,Y),D=D.sibling}function lf(D,O,Y){for(var ie=O,pe=!1,Te,dt;;){if(!pe){pe=ie.return;e:for(;;){if(pe===null)throw Error(a(160));switch(Te=pe.stateNode,pe.tag){case 5:dt=!1;break e;case 3:Te=Te.containerInfo,dt=!0;break e;case 4:Te=Te.containerInfo,dt=!0;break e}pe=pe.return}pe=!0}if(ie.tag===5||ie.tag===6)Td(D,ie,Y),dt?Hr(Te,ie.stateNode):Nr(Te,ie.stateNode);else if(ie.tag===18)dt?It(Te,ie.stateNode):Ct(Te,ie.stateNode);else if(ie.tag===4){if(ie.child!==null){Te=ie.stateNode.containerInfo,dt=!0,ie.child.return=ie,ie=ie.child;continue}}else if(Kp(D,ie,Y),ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===O)break;for(;ie.sibling===null;){if(ie.return===null||ie.return===O)return;ie=ie.return,ie.tag===4&&(pe=!1)}ie.sibling.return=ie.return,ie=ie.sibling}}function lo(D,O){if(Pe){switch(O.tag){case 0:case 11:case 14:case 15:Gc(3,O,O.return),Yp(3,O),Gc(5,O,O.return);return;case 1:return;case 5:var Y=O.stateNode;if(Y!=null){var ie=O.memoizedProps;D=D!==null?D.memoizedProps:ie;var pe=O.type,Te=O.updateQueue;O.updateQueue=null,Te!==null&&ui(Y,Te,pe,D,ie,O)}return;case 6:if(O.stateNode===null)throw Error(a(162));Y=O.memoizedProps,Ln(O.stateNode,D!==null?D.memoizedProps:Y,Y);return;case 3:mn&&D!==null&&D.memoizedState.isDehydrated&&yt(O.stateNode.containerInfo);return;case 12:return;case 13:oc(O);return;case 19:oc(O);return;case 17:return}throw Error(a(163))}switch(O.tag){case 0:case 11:case 14:case 15:Gc(3,O,O.return),Yp(3,O),Gc(5,O,O.return);return;case 12:return;case 13:oc(O);return;case 19:oc(O);return;case 3:mn&&D!==null&&D.memoizedState.isDehydrated&&yt(O.stateNode.containerInfo);break;case 22:case 23:return}e:if(qe){switch(O.tag){case 1:case 5:case 6:break e;case 3:case 4:O=O.stateNode,hi(O.containerInfo,O.pendingChildren);break e}throw Error(a(163))}}function oc(D){var O=D.updateQueue;if(O!==null){D.updateQueue=null;var Y=D.stateNode;Y===null&&(Y=D.stateNode=new Fn),O.forEach(function(ie){var pe=Hg.bind(null,D,ie);Y.has(ie)||(Y.add(ie),ie.then(pe,pe))})}}function k1(D,O){for(sr=O;sr!==null;){O=sr;var Y=O.deletions;if(Y!==null)for(var ie=0;ie<Y.length;ie++){var pe=Y[ie];try{var Te=D;Pe?lf(Te,pe,O):Td(Te,pe,O);var dt=pe.alternate;dt!==null&&(dt.return=null),pe.return=null}catch(Rr){ca(pe,O,Rr)}}if(Y=O.child,O.subtreeFlags&12854&&Y!==null)Y.return=O,sr=Y;else for(;sr!==null;){O=sr;try{var Ot=O.flags;if(Ot&32&&Pe&&yi(O.stateNode),Ot&512){var vn=O.alternate;if(vn!==null){var Wn=vn.ref;Wn!==null&&(typeof Wn=="function"?Wn(null):Wn.current=null)}}if(Ot&8192)switch(O.tag){case 13:if(O.memoizedState!==null){var br=O.alternate;(br===null||br.memoizedState===null)&&(ff=xs())}break;case 22:var ai=O.memoizedState!==null,zr=O.alternate,ps=zr!==null&&zr.memoizedState!==null;if(Y=O,Pe){e:if(ie=Y,pe=ai,Te=null,Pe)for(var Ir=ie;;){if(Ir.tag===5){if(Te===null){Te=Ir;var uo=Ir.stateNode;pe?Fe(uo):Kt(Ir.stateNode,Ir.memoizedProps)}}else if(Ir.tag===6){if(Te===null){var ho=Ir.stateNode;pe?Lt(ho):un(ho,Ir.memoizedProps)}}else if((Ir.tag!==22&&Ir.tag!==23||Ir.memoizedState===null||Ir===ie)&&Ir.child!==null){Ir.child.return=Ir,Ir=Ir.child;continue}if(Ir===ie)break;for(;Ir.sibling===null;){if(Ir.return===null||Ir.return===ie)break e;Te===Ir&&(Te=null),Ir=Ir.return}Te===Ir&&(Te=null),Ir.sibling.return=Ir.return,Ir=Ir.sibling}}if(ai&&!ps&&Y.mode&1){sr=Y;for(var Xt=Y.child;Xt!==null;){for(Y=sr=Xt;sr!==null;){ie=sr;var Nt=ie.child;switch(ie.tag){case 0:case 11:case 14:case 15:Gc(4,ie,ie.return);break;case 1:Zp(ie,ie.return);var on=ie.stateNode;if(typeof on.componentWillUnmount=="function"){var rr=ie.return;try{on.props=ie.memoizedProps,on.state=ie.memoizedState,on.componentWillUnmount()}catch(Rr){ca(ie,rr,Rr)}}break;case 5:Zp(ie,ie.return);break;case 22:if(ie.memoizedState!==null){Fg(Y);continue}}Nt!==null?(Nt.return=ie,sr=Nt):Fg(Y)}Xt=Xt.sibling}}}switch(Ot&4102){case 2:Md(O),O.flags&=-3;break;case 6:Md(O),O.flags&=-3,lo(O.alternate,O);break;case 4096:O.flags&=-4097;break;case 4100:O.flags&=-4097,lo(O.alternate,O);break;case 4:lo(O.alternate,O)}}catch(Rr){ca(O,O.return,Rr)}if(Y=O.sibling,Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}}function n_(D,O,Y){sr=D,kg(D)}function kg(D,O,Y){for(var ie=(D.mode&1)!==0;sr!==null;){var pe=sr,Te=pe.child;if(pe.tag===22&&ie){var dt=pe.memoizedState!==null||Uc;if(!dt){var Ot=pe.alternate,vn=Ot!==null&&Ot.memoizedState!==null||El;Ot=Uc;var Wn=El;if(Uc=dt,(El=vn)&&!Wn)for(sr=pe;sr!==null;)dt=sr,vn=dt.child,dt.tag===22&&dt.memoizedState!==null?Fa(pe):vn!==null?(vn.return=dt,sr=vn):Fa(pe);for(;Te!==null;)sr=Te,kg(Te),Te=Te.sibling;sr=pe,Uc=Ot,El=Wn}Og(D)}else pe.subtreeFlags&8772&&Te!==null?(Te.return=pe,sr=Te):Og(D)}}function Og(D){for(;sr!==null;){var O=sr;if(O.flags&8772){var Y=O.alternate;try{if(O.flags&8772)switch(O.tag){case 0:case 11:case 15:El||Yp(5,O);break;case 1:var ie=O.stateNode;if(O.flags&4&&!El)if(Y===null)ie.componentDidMount();else{var pe=O.elementType===O.type?Y.memoizedProps:Gs(O.type,Y.memoizedProps);ie.componentDidUpdate(pe,Y.memoizedState,ie.__reactInternalSnapshotBeforeUpdate)}var Te=O.updateQueue;Te!==null&&Rp(O,Te,ie);break;case 3:var dt=O.updateQueue;if(dt!==null){if(Y=null,O.child!==null)switch(O.child.tag){case 5:Y=Le(O.child.stateNode);break;case 1:Y=O.child.stateNode}Rp(O,dt,Y)}break;case 5:var Ot=O.stateNode;Y===null&&O.flags&4&&ir(Ot,O.type,O.memoizedProps,O);break;case 6:break;case 4:break;case 12:break;case 13:if(mn&&O.memoizedState===null){var vn=O.alternate;if(vn!==null){var Wn=vn.memoizedState;if(Wn!==null){var br=Wn.dehydrated;br!==null&&Mt(br)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(a(163))}El||O.flags&512&&Ad(O)}catch(ai){ca(O,O.return,ai)}}if(O===D){sr=null;break}if(Y=O.sibling,Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}function Fg(D){for(;sr!==null;){var O=sr;if(O===D){sr=null;break}var Y=O.sibling;if(Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}function Fa(D){for(;sr!==null;){var O=sr;try{switch(O.tag){case 0:case 11:case 15:var Y=O.return;try{Yp(4,O)}catch(vn){ca(O,Y,vn)}break;case 1:var ie=O.stateNode;if(typeof ie.componentDidMount=="function"){var pe=O.return;try{ie.componentDidMount()}catch(vn){ca(O,pe,vn)}}var Te=O.return;try{Ad(O)}catch(vn){ca(O,Te,vn)}break;case 5:var dt=O.return;try{Ad(O)}catch(vn){ca(O,dt,vn)}}}catch(vn){ca(O,O.return,vn)}if(O===D){sr=null;break}var Ot=O.sibling;if(Ot!==null){Ot.return=O.return,sr=Ot;break}sr=O.return}}var ds=0,cf=1,Ed=2,Jp=3,Qp=4;if(typeof Symbol=="function"&&Symbol.for){var Id=Symbol.for;ds=Id("selector.component"),cf=Id("selector.has_pseudo_class"),Ed=Id("selector.role"),Jp=Id("selector.test_id"),Qp=Id("selector.text")}function r_(D){var O=cn(D);if(O!=null){if(typeof O.memoizedProps["data-testname"]!="string")throw Error(a(364));return O}if(D=Ue(D),D===null)throw Error(a(362));return D.stateNode.current}function Ju(D,O){switch(O.$$typeof){case ds:if(D.type===O.value)return!0;break;case cf:e:{O=O.value,D=[D,0];for(var Y=0;Y<D.length;){var ie=D[Y++],pe=D[Y++],Te=O[pe];if(ie.tag!==5||!Sn(ie)){for(;Te!=null&&Ju(ie,Te);)pe++,Te=O[pe];if(pe===O.length){O=!0;break e}else for(ie=ie.child;ie!==null;)D.push(ie,pe),ie=ie.sibling}}O=!1}return O;case Ed:if(D.tag===5&&jt(D.stateNode,O.value))return!0;break;case Qp:if((D.tag===5||D.tag===6)&&(D=An(D),D!==null&&0<=D.indexOf(O.value)))return!0;break;case Jp:if(D.tag===5&&(D=D.memoizedProps["data-testname"],typeof D=="string"&&D.toLowerCase()===O.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Qu(D){switch(D.$$typeof){case ds:return"<"+(ee(D.value)||"Unknown")+">";case cf:return":has("+(Qu(D)||"")+")";case Ed:return'[role="'+D.value+'"]';case Qp:return'"'+D.value+'"';case Jp:return'[data-testname="'+D.value+'"]';default:throw Error(a(365))}}function gn(D,O){var Y=[];D=[D,0];for(var ie=0;ie<D.length;){var pe=D[ie++],Te=D[ie++],dt=O[Te];if(pe.tag!==5||!Sn(pe)){for(;dt!=null&&Ju(pe,dt);)Te++,dt=O[Te];if(Te===O.length)Y.push(pe);else for(pe=pe.child;pe!==null;)D.push(pe,Te),pe=pe.sibling}}return Y}function Kn(D,O){if(!at)throw Error(a(363));D=r_(D),D=gn(D,O),O=[],D=Array.from(D);for(var Y=0;Y<D.length;){var ie=D[Y++];if(ie.tag===5)Sn(ie)||O.push(ie.stateNode);else for(ie=ie.child;ie!==null;)D.push(ie),ie=ie.sibling}return O}var ac=Math.ceil,ji=l.ReactCurrentDispatcher,At=l.ReactCurrentOwner,Bs=l.ReactCurrentBatchConfig,di=0,Ks=null,rs=null,Bo=0,ko=0,lc=Ss(0),Oo=0,em=null,uf=0,hf=0,Rd=0,eh=null,Yo=null,ff=0,th=1/0;function df(){th=xs()+500}var Ja=!1,i_=null,Hs=null,Ng=!1,Il=null,Oi=0,Qr=0,zg=null,cc=-1,pf=0;function Js(){return di&6?xs():cc!==-1?cc:cc=xs()}function uc(D){return D.mode&1?di&2&&Bo!==0?Bo&-Bo:dd.transition!==null?(pf===0&&(D=Ap,Ap<<=1,!(Ap&4194240)&&(Ap=64),pf=D),pf):(D=vr,D!==0?D:Jt()):1}function Qa(D,O,Y){if(50<Qr)throw Qr=0,zg=null,Error(a(185));var ie=Rl(D,O);return ie===null?null:(Gh(ie,O,Y),(!(di&2)||ie!==Ks)&&(ie===Ks&&(!(di&2)&&(hf|=O),Oo===4&&Hc(ie,Bo)),co(ie,Y),O===1&&di===0&&!(D.mode&1)&&(df(),pu&&Pa())),ie)}function Rl(D,O){D.lanes|=O;var Y=D.alternate;for(Y!==null&&(Y.lanes|=O),Y=D,D=D.return;D!==null;)D.childLanes|=O,Y=D.alternate,Y!==null&&(Y.childLanes|=O),Y=D,D=D.return;return Y.tag===3?Y.stateNode:null}function co(D,O){var Y=D.callbackNode;cd(D,O);var ie=Kl(D,D===Ks?Bo:0);if(ie===0)Y!==null&&ud(Y),D.callbackNode=null,D.callbackPriority=0;else if(O=ie&-ie,D.callbackPriority!==O){if(Y!=null&&ud(Y),O===1)D.tag===0?M1(Ug.bind(null,D)):Ts(Ug.bind(null,D)),Gn?sn(function(){di===0&&Pa()}):cr(fd,Pa),Y=null;else{switch(T1(ie)){case 1:Y=fd;break;case 4:Y=Jl;break;case 16:Y=On;break;case 536870912:Y=ei;break;default:Y=On}Y=jg(Y,Vc.bind(null,D))}D.callbackPriority=O,D.callbackNode=Y}}function Vc(D,O){if(cc=-1,pf=0,di&6)throw Error(a(327));var Y=D.callbackNode;if(fc()&&D.callbackNode!==Y)return null;var ie=Kl(D,D===Ks?Bo:0);if(ie===0)return null;if(ie&30||ie&D.expiredLanes||O)O=Ld(D,ie);else{O=ie;var pe=di;di|=2;var Te=mf();(Ks!==D||Bo!==O)&&(df(),dl(D,O));do try{Dd();break}catch(Ot){xa(D,Ot)}while(!0);Ds(),ji.current=Te,di=pe,rs!==null?O=0:(Ks=null,Bo=0,O=Oo)}if(O!==0){if(O===2&&(pe=Mp(D),pe!==0&&(ie=pe,O=wu(D,pe))),O===1)throw Y=em,dl(D,0),Hc(D,ie),co(D,xs()),Y;if(O===6)Hc(D,ie);else{if(pe=D.current.alternate,!(ie&30)&&!s_(pe)&&(O=Ld(D,ie),O===2&&(Te=Mp(D),Te!==0&&(ie=Te,O=wu(D,Te))),O===1))throw Y=em,dl(D,0),Hc(D,ie),co(D,xs()),Y;switch(D.finishedWork=pe,D.finishedLanes=ie,O){case 0:case 1:throw Error(a(345));case 2:hc(D,Yo);break;case 3:if(Hc(D,ie),(ie&130023424)===ie&&(O=ff+500-xs(),10<O)){if(Kl(D,0)!==0)break;if(pe=D.suspendedLanes,(pe&ie)!==ie){Js(),D.pingedLanes|=D.suspendedLanes&pe;break}D.timeoutHandle=rn(hc.bind(null,D,Yo),O);break}hc(D,Yo);break;case 4:if(Hc(D,ie),(ie&4194240)===ie)break;for(O=D.eventTimes,pe=-1;0<ie;){var dt=31-Ra(ie);Te=1<<dt,dt=O[dt],dt>pe&&(pe=dt),ie&=~Te}if(ie=pe,ie=xs()-ie,ie=(120>ie?120:480>ie?480:1080>ie?1080:1920>ie?1920:3e3>ie?3e3:4320>ie?4320:1960*ac(ie/1960))-ie,10<ie){D.timeoutHandle=rn(hc.bind(null,D,Yo),ie);break}hc(D,Yo);break;case 5:hc(D,Yo);break;default:throw Error(a(329))}}}return co(D,xs()),D.callbackNode===Y?Vc.bind(null,D):null}function wu(D,O){var Y=eh;return D.current.memoizedState.isDehydrated&&(dl(D,O).flags|=256),D=Ld(D,O),D!==2&&(O=Yo,Yo=Y,O!==null&&Pd(O)),D}function Pd(D){Yo===null?Yo=D:Yo.push.apply(Yo,D)}function s_(D){for(var O=D;;){if(O.flags&16384){var Y=O.updateQueue;if(Y!==null&&(Y=Y.stores,Y!==null))for(var ie=0;ie<Y.length;ie++){var pe=Y[ie],Te=pe.getSnapshot;pe=pe.value;try{if(!al(Te(),pe))return!1}catch{return!1}}}if(Y=O.child,O.subtreeFlags&16384&&Y!==null)Y.return=O,O=Y;else{if(O===D)break;for(;O.sibling===null;){if(O.return===null||O.return===D)return!0;O=O.return}O.sibling.return=O.return,O=O.sibling}}return!0}function Hc(D,O){for(O&=~Rd,O&=~hf,D.suspendedLanes|=O,D.pingedLanes&=~O,D=D.expirationTimes;0<O;){var Y=31-Ra(O),ie=1<<Y;D[Y]=-1,O&=~ie}}function Ug(D){if(di&6)throw Error(a(327));fc();var O=Kl(D,0);if(!(O&1))return co(D,xs()),null;var Y=Ld(D,O);if(D.tag!==0&&Y===2){var ie=Mp(D);ie!==0&&(O=ie,Y=wu(D,ie))}if(Y===1)throw Y=em,dl(D,0),Hc(D,O),co(D,xs()),Y;if(Y===6)throw Error(a(345));return D.finishedWork=D.current.alternate,D.finishedLanes=O,hc(D,Yo),co(D,xs()),null}function Su(D){Il!==null&&Il.tag===0&&!(di&6)&&fc();var O=di;di|=1;var Y=Bs.transition,ie=vr;try{if(Bs.transition=null,vr=1,D)return D()}finally{vr=ie,Bs.transition=Y,di=O,!(di&6)&&Pa()}}function nh(){ko=lc.current,Er(lc)}function dl(D,O){D.finishedWork=null,D.finishedLanes=0;var Y=D.timeoutHandle;if(Y!==Bn&&(D.timeoutHandle=Bn,jn(Y)),rs!==null)for(Y=rs.return;Y!==null;){var ie=Y;switch(md(ie),ie.tag){case 1:ie=ie.type.childContextTypes,ie!=null&&Pi();break;case 3:Kh(),Er(_s),Er(qr),pg();break;case 5:Bp(ie);break;case 4:Kh();break;case 13:Er(Ms);break;case 19:Er(Ms);break;case 10:cl(ie.type._context);break;case 22:case 23:nh()}Y=Y.return}if(Ks=D,rs=D=Au(D.current,null),Bo=ko=O,Oo=0,em=null,Rd=hf=uf=0,Yo=eh=null,La!==null){for(O=0;O<La.length;O++)if(Y=La[O],ie=Y.interleaved,ie!==null){Y.interleaved=null;var pe=ie.next,Te=Y.pending;if(Te!==null){var dt=Te.next;Te.next=pe,ie.next=dt}Y.pending=ie}La=null}return D}function xa(D,O){do{var Y=rs;try{if(Ds(),Op.current=tf,_u){for(var ie=Cs.memoizedState;ie!==null;){var pe=ie.queue;pe!==null&&(pe.pending=null),ie=ie.next}_u=!1}if(Jh=0,Ys=Do=Cs=null,yu=!1,$u=0,At.current=null,Y===null||Y.return===null){Oo=1,em=O,rs=null;break}e:{var Te=D,dt=Y.return,Ot=Y,vn=O;if(O=Bo,Ot.flags|=32768,vn!==null&&typeof vn=="object"&&typeof vn.then=="function"){var Wn=vn,br=Ot,ai=br.tag;if(!(br.mode&1)&&(ai===0||ai===11||ai===15)){var zr=br.alternate;zr?(br.updateQueue=zr.updateQueue,br.memoizedState=zr.memoizedState,br.lanes=zr.lanes):(br.updateQueue=null,br.memoizedState=null)}var ps=nf(dt);if(ps!==null){ps.flags&=-257,Yv(ps,dt,Ot,Te,O),ps.mode&1&&Zv(Te,Wn,O),O=ps,vn=Wn;var Ir=O.updateQueue;if(Ir===null){var uo=new Set;uo.add(vn),O.updateQueue=uo}else Ir.add(vn);break e}else{if(!(O&1)){Zv(Te,Wn,O),wo();break e}vn=Error(a(426))}}else if(ns&&Ot.mode&1){var ho=nf(dt);if(ho!==null){!(ho.flags&65536)&&(ho.flags|=256),Yv(ho,dt,Ot,Te,O),ug(vn);break e}}Te=vn,Oo!==4&&(Oo=2),eh===null?eh=[Te]:eh.push(Te),vn=Vp(vn,Ot),Ot=dt;do{switch(Ot.tag){case 3:Ot.flags|=65536,O&=-O,Ot.lanes|=O;var Xt=I1(Ot,vn,O);Da(Ot,Xt);break e;case 1:Te=vn;var Nt=Ot.type,on=Ot.stateNode;if(!(Ot.flags&128)&&(typeof Nt.getDerivedStateFromError=="function"||on!==null&&typeof on.componentDidCatch=="function"&&(Hs===null||!Hs.has(on)))){Ot.flags|=65536,O&=-O,Ot.lanes|=O;var rr=qv(Ot,Te,O);Da(Ot,rr);break e}}Ot=Ot.return}while(Ot!==null)}Gg(Y)}catch(Rr){O=Rr,rs===Y&&Y!==null&&(rs=Y=Y.return);continue}break}while(!0)}function mf(){var D=ji.current;return ji.current=tf,D===null?tf:D}function wo(){(Oo===0||Oo===3||Oo===2)&&(Oo=4),Ks===null||!(uf&268435455)&&!(hf&268435455)||Hc(Ks,Bo)}function Ld(D,O){var Y=di;di|=2;var ie=mf();Ks===D&&Bo===O||dl(D,O);do try{o_();break}catch(pe){xa(D,pe)}while(!0);if(Ds(),di=Y,ji.current=ie,rs!==null)throw Error(a(261));return Ks=null,Bo=0,Oo}function o_(){for(;rs!==null;)jc(rs)}function Dd(){for(;rs!==null&&!Vh();)jc(rs)}function jc(D){var O=kd(D.alternate,D,ko);D.memoizedProps=D.pendingProps,O===null?Gg(D):rs=O,At.current=null}function Gg(D){var O=D;do{var Y=O.alternate;if(D=O.return,O.flags&32768){if(Y=L1(Y,O),Y!==null){Y.flags&=32767,rs=Y;return}if(D!==null)D.flags|=32768,D.subtreeFlags=0,D.deletions=null;else{Oo=6,rs=null;return}}else if(Y=sf(Y,O,ko),Y!==null){rs=Y;return}if(O=O.sibling,O!==null){rs=O;return}rs=O=D}while(O!==null);Oo===0&&(Oo=5)}function hc(D,O){var Y=vr,ie=Bs.transition;try{Bs.transition=null,vr=1,a_(D,O,Y)}finally{Bs.transition=ie,vr=Y}return null}function a_(D,O,Y){do fc();while(Il!==null);if(di&6)throw Error(a(327));var ie=D.finishedWork,pe=D.finishedLanes;if(ie===null)return null;if(D.finishedWork=null,D.finishedLanes=0,ie===D.current)throw Error(a(177));D.callbackNode=null,D.callbackPriority=0;var Te=ie.lanes|ie.childLanes;if(si(D,Te),D===Ks&&(rs=Ks=null,Bo=0),!(ie.subtreeFlags&2064)&&!(ie.flags&2064)||Ng||(Ng=!0,jg(On,function(){return fc(),null})),Te=(ie.flags&15990)!==0,ie.subtreeFlags&15990||Te){Te=Bs.transition,Bs.transition=null;var dt=vr;vr=1;var Ot=di;di|=4,At.current=null,Yn(D,ie),k1(D,ie),Ve(D.containerInfo),D.current=ie,n_(ie),hd(),di=Ot,vr=dt,Bs.transition=Te}else D.current=ie;if(Ng&&(Ng=!1,Il=D,Oi=pe),Te=D.pendingLanes,Te===0&&(Hs=null),ga(ie.stateNode),co(D,xs()),O!==null)for(Y=D.onRecoverableError,ie=0;ie<O.length;ie++)Y(O[ie]);if(Ja)throw Ja=!1,D=i_,i_=null,D;return Oi&1&&D.tag!==0&&fc(),Te=D.pendingLanes,Te&1?D===zg?Qr++:(Qr=0,zg=D):Qr=0,Pa(),null}function fc(){if(Il!==null){var D=T1(Oi),O=Bs.transition,Y=vr;try{if(Bs.transition=null,vr=16>D?16:D,Il===null)var ie=!1;else{if(D=Il,Il=null,Oi=0,di&6)throw Error(a(331));var pe=di;for(di|=4,sr=D.current;sr!==null;){var Te=sr,dt=Te.child;if(sr.flags&16){var Ot=Te.deletions;if(Ot!==null){for(var vn=0;vn<Ot.length;vn++){var Wn=Ot[vn];for(sr=Wn;sr!==null;){var br=sr;switch(br.tag){case 0:case 11:case 15:Gc(8,br,Te)}var ai=br.child;if(ai!==null)ai.return=br,sr=ai;else for(;sr!==null;){br=sr;var zr=br.sibling,ps=br.return;if(Bg(br),br===Wn){sr=null;break}if(zr!==null){zr.return=ps,sr=zr;break}sr=ps}}}var Ir=Te.alternate;if(Ir!==null){var uo=Ir.child;if(uo!==null){Ir.child=null;do{var ho=uo.sibling;uo.sibling=null,uo=ho}while(uo!==null)}}sr=Te}}if(Te.subtreeFlags&2064&&dt!==null)dt.return=Te,sr=dt;else e:for(;sr!==null;){if(Te=sr,Te.flags&2048)switch(Te.tag){case 0:case 11:case 15:Gc(9,Te,Te.return)}var Xt=Te.sibling;if(Xt!==null){Xt.return=Te.return,sr=Xt;break e}sr=Te.return}}var Nt=D.current;for(sr=Nt;sr!==null;){dt=sr;var on=dt.child;if(dt.subtreeFlags&2064&&on!==null)on.return=dt,sr=on;else e:for(dt=Nt;sr!==null;){if(Ot=sr,Ot.flags&2048)try{switch(Ot.tag){case 0:case 11:case 15:Yp(9,Ot)}}catch(Rr){ca(Ot,Ot.return,Rr)}if(Ot===dt){sr=null;break e}var rr=Ot.sibling;if(rr!==null){rr.return=Ot.return,sr=rr;break e}sr=Ot.return}}if(di=pe,Pa(),Us&&typeof Us.onPostCommitFiberRoot=="function")try{Us.onPostCommitFiberRoot(Zr,D)}catch{}ie=!0}return ie}finally{vr=Y,Bs.transition=O}}return!1}function Bd(D,O,Y){O=Vp(Y,O),O=I1(D,O,1),ju(D,O),O=Js(),D=Rl(D,1),D!==null&&(Gh(D,1,O),co(D,O))}function ca(D,O,Y){if(D.tag===3)Bd(D,D,Y);else for(;O!==null;){if(O.tag===3){Bd(O,D,Y);break}else if(O.tag===1){var ie=O.stateNode;if(typeof O.type.getDerivedStateFromError=="function"||typeof ie.componentDidCatch=="function"&&(Hs===null||!Hs.has(ie))){D=Vp(Y,D),D=qv(O,D,1),ju(O,D),D=Js(),O=Rl(O,1),O!==null&&(Gh(O,1,D),co(O,D));break}}O=O.return}}function Vg(D,O,Y){var ie=D.pingCache;ie!==null&&ie.delete(O),O=Js(),D.pingedLanes|=D.suspendedLanes&Y,Ks===D&&(Bo&Y)===Y&&(Oo===4||Oo===3&&(Bo&130023424)===Bo&&500>xs()-ff?dl(D,0):Rd|=Y),co(D,O)}function tm(D,O){O===0&&(D.mode&1?(O=ag,ag<<=1,!(ag&130023424)&&(ag=4194304)):O=1);var Y=Js();D=Rl(D,O),D!==null&&(Gh(D,O,Y),co(D,Y))}function O1(D){var O=D.memoizedState,Y=0;O!==null&&(Y=O.retryLane),tm(D,Y)}function Hg(D,O){var Y=0;switch(D.tag){case 13:var ie=D.stateNode,pe=D.memoizedState;pe!==null&&(Y=pe.retryLane);break;case 19:ie=D.stateNode;break;default:throw Error(a(314))}ie!==null&&ie.delete(O),tm(D,Y)}var kd;kd=function(D,O,Y){if(D!==null)if(D.memoizedProps!==O.pendingProps||_s.current)bo=!0;else{if(!(D.lanes&Y)&&!(O.flags&128))return bo=!1,t_(D,O,Y);bo=!!(D.flags&131072)}else bo=!1,ns&&O.flags&1048576&&_r(O,_a,O.index);switch(O.lanes=0,O.tag){case 2:var ie=O.type;D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),D=O.pendingProps;var pe=Ls(O,qr.current);Hu(O,Y),pe=Zu(null,O,ie,D,pe,Y);var Te=Qh();return O.flags|=1,typeof pe=="object"&&pe!==null&&typeof pe.render=="function"&&pe.$$typeof===void 0?(O.tag=1,O.memoizedState=null,O.updateQueue=null,fs(ie)?(Te=!0,As(O)):Te=!1,O.memoizedState=pe.state!==null&&pe.state!==void 0?pe.state:null,mu(O),pe.updater=gu,O.stateNode=pe,pe._reactInternals=O,Nv(O,ie,D,Y),O=of(null,O,ie,!0,Te,Y)):(O.tag=0,ns&&Te&&Pp(O),la(null,O,pe,Y),O=O.child),O;case 16:ie=O.elementType;e:{switch(D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),D=O.pendingProps,pe=ie._init,ie=pe(ie._payload),O.type=ie,pe=O.tag=Xg(ie),D=Gs(ie,D),pe){case 0:O=Pg(null,O,ie,D,Y);break e;case 1:O=Jv(null,O,ie,D,Y);break e;case 11:O=jp(null,O,ie,D,Y);break e;case 14:O=Ig(null,O,ie,Gs(ie.type,D),Y);break e}throw Error(a(306,ie,""))}return O;case 0:return ie=O.type,pe=O.pendingProps,pe=O.elementType===ie?pe:Gs(ie,pe),Pg(D,O,ie,pe,Y);case 1:return ie=O.type,pe=O.pendingProps,pe=O.elementType===ie?pe:Gs(ie,pe),Jv(D,O,ie,pe,Y);case 3:e:{if(P1(O),D===null)throw Error(a(387));ie=O.pendingProps,Te=O.memoizedState,pe=Te.element,Ep(D,O),cg(O,ie,null,Y);var dt=O.memoizedState;if(ie=dt.element,mn&&Te.isDehydrated)if(Te={element:ie,isDehydrated:!1,cache:dt.cache,transitions:dt.transitions},O.updateQueue.baseState=Te,O.memoizedState=Te,O.flags&256){pe=Error(a(423)),O=Qv(D,O,ie,Y,pe);break e}else if(ie!==pe){pe=Error(a(424)),O=Qv(D,O,ie,Y,pe);break e}else for(mn&&(xo=zt(O.stateNode.containerInfo),Ba=O,ns=!0,Za=null,ao=!1),Y=hg(O,null,ie,Y),O.child=Y;Y;)Y.flags=Y.flags&-3|4096,Y=Y.sibling;else{if(yn(),ie===pe){O=Cl(D,O,Y);break e}la(D,O,ie,Y)}O=O.child}return O;case 5:return fg(O),D===null&&nc(O),ie=O.type,pe=O.pendingProps,Te=D!==null?D.memoizedProps:null,dt=pe.children,Ht(ie,pe)?dt=null:Te!==null&&Ht(ie,Te)&&(O.flags|=32),Wp(D,O),la(D,O,dt,Y),O.child;case 6:return D===null&&nc(O),null;case 13:return $p(D,O,Y);case 4:return Oa(O,O.stateNode.containerInfo),ie=O.pendingProps,D===null?O.child=Ya(O,null,ie,Y):la(D,O,ie,Y),O.child;case 11:return ie=O.type,pe=O.pendingProps,pe=O.elementType===ie?pe:Gs(ie,pe),jp(D,O,ie,pe,Y);case 7:return la(D,O,O.pendingProps,Y),O.child;case 8:return la(D,O,O.pendingProps.children,Y),O.child;case 12:return la(D,O,O.pendingProps.children,Y),O.child;case 10:e:{if(ie=O.type._context,pe=O.pendingProps,Te=O.memoizedProps,dt=pe.value,va(O,ie,dt),Te!==null)if(al(Te.value,dt)){if(Te.children===pe.children&&!_s.current){O=Cl(D,O,Y);break e}}else for(Te=O.child,Te!==null&&(Te.return=O);Te!==null;){var Ot=Te.dependencies;if(Ot!==null){dt=Te.child;for(var vn=Ot.firstContext;vn!==null;){if(vn.context===ie){if(Te.tag===1){vn=oa(-1,Y&-Y),vn.tag=2;var Wn=Te.updateQueue;if(Wn!==null){Wn=Wn.shared;var br=Wn.pending;br===null?vn.next=vn:(vn.next=br.next,br.next=vn),Wn.pending=vn}}Te.lanes|=Y,vn=Te.alternate,vn!==null&&(vn.lanes|=Y),qs(Te.return,Y,O),Ot.lanes|=Y;break}vn=vn.next}}else if(Te.tag===10)dt=Te.type===O.type?null:Te.child;else if(Te.tag===18){if(dt=Te.return,dt===null)throw Error(a(341));dt.lanes|=Y,Ot=dt.alternate,Ot!==null&&(Ot.lanes|=Y),qs(dt,Y,O),dt=Te.sibling}else dt=Te.child;if(dt!==null)dt.return=Te;else for(dt=Te;dt!==null;){if(dt===O){dt=null;break}if(Te=dt.sibling,Te!==null){Te.return=dt.return,dt=Te;break}dt=dt.return}Te=dt}la(D,O,pe.children,Y),O=O.child}return O;case 9:return pe=O.type,ie=O.pendingProps.children,Hu(O,Y),pe=Zs(pe),ie=ie(pe),O.flags|=1,la(D,O,ie,Y),O.child;case 14:return ie=O.type,pe=Gs(ie,O.pendingProps),pe=Gs(ie.type,pe),Ig(D,O,ie,pe,Y);case 15:return Kv(D,O,O.type,O.pendingProps,Y);case 17:return ie=O.type,pe=O.pendingProps,pe=O.elementType===ie?pe:Gs(ie,pe),D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),O.tag=1,fs(ie)?(D=!0,As(O)):D=!1,Hu(O,Y),pd(O,ie,pe),Nv(O,ie,pe,Y),of(null,O,ie,!0,D,Y);case 19:return qp(D,O,Y);case 22:return Rg(D,O,Y)}throw Error(a(156,O.tag))};function jg(D,O){return cr(D,O)}function F1(D,O,Y,ie){this.tag=D,this.key=Y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=O,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ie,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function el(D,O,Y,ie){return new F1(D,O,Y,ie)}function Wg(D){return D=D.prototype,!(!D||!D.isReactComponent)}function Xg(D){if(typeof D=="function")return Wg(D)?1:0;if(D!=null){if(D=D.$$typeof,D===E)return 11;if(D===L)return 14}return 2}function Au(D,O){var Y=D.alternate;return Y===null?(Y=el(D.tag,O,D.key,D.mode),Y.elementType=D.elementType,Y.type=D.type,Y.stateNode=D.stateNode,Y.alternate=D,D.alternate=Y):(Y.pendingProps=O,Y.type=D.type,Y.flags=0,Y.subtreeFlags=0,Y.deletions=null),Y.flags=D.flags&14680064,Y.childLanes=D.childLanes,Y.lanes=D.lanes,Y.child=D.child,Y.memoizedProps=D.memoizedProps,Y.memoizedState=D.memoizedState,Y.updateQueue=D.updateQueue,O=D.dependencies,Y.dependencies=O===null?null:{lanes:O.lanes,firstContext:O.firstContext},Y.sibling=D.sibling,Y.index=D.index,Y.ref=D.ref,Y}function nm(D,O,Y,ie,pe,Te){var dt=2;if(ie=D,typeof D=="function")Wg(D)&&(dt=1);else if(typeof D=="string")dt=5;else e:switch(D){case d:return rh(Y.children,pe,Te,O);case m:dt=8,pe|=8;break;case v:return D=el(12,Y,O,pe|2),D.elementType=v,D.lanes=Te,D;case M:return D=el(13,Y,O,pe),D.elementType=M,D.lanes=Te,D;case C:return D=el(19,Y,O,pe),D.elementType=C,D.lanes=Te,D;case H:return rm(Y,pe,Te,O);default:if(typeof D=="object"&&D!==null)switch(D.$$typeof){case y:dt=10;break e;case S:dt=9;break e;case E:dt=11;break e;case L:dt=14;break e;case k:dt=16,ie=null;break e}throw Error(a(130,D==null?D:typeof D,""))}return O=el(dt,Y,O,pe),O.elementType=D,O.type=ie,O.lanes=Te,O}function rh(D,O,Y,ie){return D=el(7,D,ie,O),D.lanes=Y,D}function rm(D,O,Y,ie){return D=el(22,D,ie,O),D.elementType=H,D.lanes=Y,D.stateNode={},D}function im(D,O,Y){return D=el(6,D,null,O),D.lanes=Y,D}function l_(D,O,Y){return O=el(4,D.children!==null?D.children:[],D.key,O),O.lanes=Y,O.stateNode={containerInfo:D.containerInfo,pendingChildren:null,implementation:D.implementation},O}function Ow(D,O,Y,ie,pe){this.tag=O,this.containerInfo=D,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Bn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vu(0),this.expirationTimes=Vu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vu(0),this.identifierPrefix=ie,this.onRecoverableError=pe,mn&&(this.mutableSourceEagerHydrationData=null)}function bs(D,O,Y,ie,pe,Te,dt,Ot,vn){return D=new Ow(D,O,Y,Ot,vn),O===1?(O=1,Te===!0&&(O|=8)):O=0,Te=el(3,null,null,O),D.current=Te,Te.stateNode=D,Te.memoizedState={element:ie,isDehydrated:Y,cache:null,transitions:null},mu(Te),D}function c_(D){if(!D)return Zi;D=D._reactInternals;e:{if(se(D)!==D||D.tag!==1)throw Error(a(170));var O=D;do{switch(O.tag){case 3:O=O.stateNode.context;break e;case 1:if(fs(O.type)){O=O.stateNode.__reactInternalMemoizedMergedChildContext;break e}}O=O.return}while(O!==null);throw Error(a(171))}if(D.tag===1){var Y=D.type;if(fs(Y))return Po(D,Y,O)}return O}function N1(D){var O=D._reactInternals;if(O===void 0)throw typeof D.render=="function"?Error(a(188)):(D=Object.keys(D).join(","),Error(a(268,D)));return D=Se(O),D===null?null:D.stateNode}function z1(D,O){if(D=D.memoizedState,D!==null&&D.dehydrated!==null){var Y=D.retryLane;D.retryLane=Y!==0&&Y<O?Y:O}}function gf(D,O){z1(D,O),(D=D.alternate)&&z1(D,O)}function U1(D){return D=Se(D),D===null?null:D.stateNode}function Od(){return null}return t.attemptContinuousHydration=function(D){if(D.tag===13){var O=Js();Qa(D,134217728,O),gf(D,134217728)}},t.attemptHydrationAtCurrentPriority=function(D){if(D.tag===13){var O=Js(),Y=uc(D);Qa(D,Y,O),gf(D,Y)}},t.attemptSynchronousHydration=function(D){switch(D.tag){case 3:var O=D.stateNode;if(O.current.memoizedState.isDehydrated){var Y=$o(O.pendingLanes);Y!==0&&(Cp(O,Y|1),co(O,xs()),!(di&6)&&(df(),Pa()))}break;case 13:var ie=Js();Su(function(){return Qa(D,1,ie)}),gf(D,1)}},t.batchedUpdates=function(D,O){var Y=di;di|=1;try{return D(O)}finally{di=Y,di===0&&(df(),pu&&Pa())}},t.createComponentSelector=function(D){return{$$typeof:ds,value:D}},t.createContainer=function(D,O,Y,ie,pe,Te,dt){return bs(D,O,!1,null,Y,ie,pe,Te,dt)},t.createHasPseudoClassSelector=function(D){return{$$typeof:cf,value:D}},t.createHydrationContainer=function(D,O,Y,ie,pe,Te,dt,Ot,vn){return D=bs(Y,ie,!0,D,pe,Te,dt,Ot,vn),D.context=c_(null),Y=D.current,ie=Js(),pe=uc(Y),Te=oa(ie,pe),Te.callback=O??null,ju(Y,Te),D.current.lanes=pe,Gh(D,pe,ie),co(D,ie),D},t.createPortal=function(D,O,Y){var ie=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:ie==null?null:""+ie,children:D,containerInfo:O,implementation:Y}},t.createRoleSelector=function(D){return{$$typeof:Ed,value:D}},t.createTestNameSelector=function(D){return{$$typeof:Jp,value:D}},t.createTextSelector=function(D){return{$$typeof:Qp,value:D}},t.deferredUpdates=function(D){var O=vr,Y=Bs.transition;try{return Bs.transition=null,vr=16,D()}finally{vr=O,Bs.transition=Y}},t.discreteUpdates=function(D,O,Y,ie,pe){var Te=vr,dt=Bs.transition;try{return Bs.transition=null,vr=1,D(O,Y,ie,pe)}finally{vr=Te,Bs.transition=dt,di===0&&df()}},t.findAllNodes=Kn,t.findBoundingRects=function(D,O){if(!at)throw Error(a(363));O=Kn(D,O),D=[];for(var Y=0;Y<O.length;Y++)D.push($t(O[Y]));for(O=D.length-1;0<O;O--){Y=D[O];for(var ie=Y.x,pe=ie+Y.width,Te=Y.y,dt=Te+Y.height,Ot=O-1;0<=Ot;Ot--)if(O!==Ot){var vn=D[Ot],Wn=vn.x,br=Wn+vn.width,ai=vn.y,zr=ai+vn.height;if(ie>=Wn&&Te>=ai&&pe<=br&&dt<=zr){D.splice(O,1);break}else if(ie!==Wn||Y.width!==vn.width||zr<Te||ai>dt){if(!(Te!==ai||Y.height!==vn.height||br<ie||Wn>pe)){Wn>ie&&(vn.width+=Wn-ie,vn.x=ie),br<pe&&(vn.width=pe-Wn),D.splice(O,1);break}}else{ai>Te&&(vn.height+=ai-Te,vn.y=Te),zr<dt&&(vn.height=dt-ai),D.splice(O,1);break}}}return D},t.findHostInstance=N1,t.findHostInstanceWithNoPortals=function(D){return D=fe(D),D=D!==null?Ie(D):null,D===null?null:D.stateNode},t.findHostInstanceWithWarning=function(D){return N1(D)},t.flushControlled=function(D){var O=di;di|=1;var Y=Bs.transition,ie=vr;try{Bs.transition=null,vr=1,D()}finally{vr=ie,Bs.transition=Y,di=O,di===0&&(df(),Pa())}},t.flushPassiveEffects=fc,t.flushSync=Su,t.focusWithin=function(D,O){if(!at)throw Error(a(363));for(D=r_(D),O=gn(D,O),O=Array.from(O),D=0;D<O.length;){var Y=O[D++];if(!Sn(Y)){if(Y.tag===5&&mr(Y.stateNode))return!0;for(Y=Y.child;Y!==null;)O.push(Y),Y=Y.sibling}}return!1},t.getCurrentUpdatePriority=function(){return vr},t.getFindAllNodesFailureDescription=function(D,O){if(!at)throw Error(a(363));var Y=0,ie=[];D=[r_(D),0];for(var pe=0;pe<D.length;){var Te=D[pe++],dt=D[pe++],Ot=O[dt];if((Te.tag!==5||!Sn(Te))&&(Ju(Te,Ot)&&(ie.push(Qu(Ot)),dt++,dt>Y&&(Y=dt)),dt<O.length))for(Te=Te.child;Te!==null;)D.push(Te,dt),Te=Te.sibling}if(Y<O.length){for(D=[];Y<O.length;Y++)D.push(Qu(O[Y]));return`findAllNodes was able to match part of the selector:
  `+(ie.join(" > ")+`

No matching component was found for:
  `)+D.join(" > ")}return null},t.getPublicRootInstance=function(D){if(D=D.current,!D.child)return null;switch(D.child.tag){case 5:return Le(D.child.stateNode);default:return D.child.stateNode}},t.injectIntoDevTools=function(D){if(D={bundleType:D.bundleType,version:D.version,rendererPackageName:D.rendererPackageName,rendererConfig:D.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:U1,findFiberByHostInstance:D.findFiberByHostInstance||Od,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")D=!1;else{var O=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(O.isDisabled||!O.supportsFiber)D=!0;else{try{Zr=O.inject(D),Us=O}catch{}D=!!O.checkDCE}}return D},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(D,O,Y,ie){if(!at)throw Error(a(363));D=Kn(D,O);var pe=Un(D,Y,ie).disconnect;return{disconnect:function(){pe()}}},t.registerMutableSourceForHydration=function(D,O){var Y=O._getVersion;Y=Y(O._source),D.mutableSourceEagerHydrationData==null?D.mutableSourceEagerHydrationData=[O,Y]:D.mutableSourceEagerHydrationData.push(O,Y)},t.runWithPriority=function(D,O){var Y=vr;try{return vr=D,O()}finally{vr=Y}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(D,O,Y,ie){var pe=O.current,Te=Js(),dt=uc(pe);return Y=c_(Y),O.context===null?O.context=Y:O.pendingContext=Y,O=oa(Te,dt),O.payload={element:D},ie=ie===void 0?null:ie,ie!==null&&(O.callback=ie),ju(pe,O),D=Qa(pe,dt,Te),D!==null&&Ip(D,pe,dt),dt},t};Une.exports=Mwe;var Cwe=Une.exports;const Ewe=SL(Cwe);var Gne={exports:{}},Vne={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ye,$e){var Ve=ye.length;ye.push($e);e:for(;0<Ve;){var _t=Ve-1>>>1,wt=ye[_t];if(0<i(wt,$e))ye[_t]=$e,ye[Ve]=wt,Ve=_t;else break e}}function t(ye){return ye.length===0?null:ye[0]}function r(ye){if(ye.length===0)return null;var $e=ye[0],Ve=ye.pop();if(Ve!==$e){ye[0]=Ve;e:for(var _t=0,wt=ye.length,Vt=wt>>>1;_t<Vt;){var lt=2*(_t+1)-1,Ht=ye[lt],Qt=lt+1,rn=ye[Qt];if(0>i(Ht,Ve))Qt<wt&&0>i(rn,Ht)?(ye[_t]=rn,ye[Qt]=Ve,_t=Qt):(ye[_t]=Ht,ye[lt]=Ve,_t=lt);else if(Qt<wt&&0>i(rn,Ve))ye[_t]=rn,ye[Qt]=Ve,_t=Qt;else break e}}return $e}function i(ye,$e){var Ve=ye.sortIndex-$e.sortIndex;return Ve!==0?Ve:ye.id-$e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var o=[],h=[],d=1,m=null,v=3,y=!1,S=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(ye){for(var $e=t(h);$e!==null;){if($e.callback===null)r(h);else if($e.startTime<=ye)r(h),$e.sortIndex=$e.expirationTime,e(o,$e);else break;$e=t(h)}}function H(ye){if(E=!1,k(ye),!S)if(t(o)!==null)S=!0,Le(q);else{var $e=t(h);$e!==null&&ot(H,$e.startTime-ye)}}function q(ye,$e){S=!1,E&&(E=!1,C(re),re=-1),y=!0;var Ve=v;try{for(k($e),m=t(o);m!==null&&(!(m.expirationTime>$e)||ye&&!fe());){var _t=m.callback;if(typeof _t=="function"){m.callback=null,v=m.priorityLevel;var wt=_t(m.expirationTime<=$e);$e=n.unstable_now(),typeof wt=="function"?m.callback=wt:m===t(o)&&r(o),k($e)}else r(o);m=t(o)}if(m!==null)var Vt=!0;else{var lt=t(h);lt!==null&&ot(H,lt.startTime-$e),Vt=!1}return Vt}finally{m=null,v=Ve,y=!1}}var Z=!1,ee=null,re=-1,se=5,ae=-1;function fe(){return!(n.unstable_now()-ae<se)}function Se(){if(ee!==null){var ye=n.unstable_now();ae=ye;var $e=!0;try{$e=ee(!0,ye)}finally{$e?Ce():(Z=!1,ee=null)}}else Z=!1}var Ce;if(typeof L=="function")Ce=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,je=Ie.port2;Ie.port1.onmessage=Se,Ce=function(){je.postMessage(null)}}else Ce=function(){M(Se,0)};function Le(ye){ee=ye,Z||(Z=!0,Ce())}function ot(ye,$e){re=M(function(){ye(n.unstable_now())},$e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Le(q))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(o)},n.unstable_next=function(ye){switch(v){case 1:case 2:case 3:var $e=3;break;default:$e=v}var Ve=v;v=$e;try{return ye()}finally{v=Ve}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,$e){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Ve=v;v=ye;try{return $e()}finally{v=Ve}},n.unstable_scheduleCallback=function(ye,$e,Ve){var _t=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?_t+Ve:_t):Ve=_t,ye){case 1:var wt=-1;break;case 2:wt=250;break;case 5:wt=1073741823;break;case 4:wt=1e4;break;default:wt=5e3}return wt=Ve+wt,ye={id:d++,callback:$e,priorityLevel:ye,startTime:Ve,expirationTime:wt,sortIndex:-1},Ve>_t?(ye.sortIndex=Ve,e(h,ye),t(o)===null&&ye===t(h)&&(E?(C(re),re=-1):E=!0,ot(H,Ve-_t))):(ye.sortIndex=wt,e(o,ye),S||y||(S=!0,Le(q))),ye},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(ye){var $e=v;return function(){var Ve=v;v=$e;try{return ye.apply(this,arguments)}finally{v=Ve}}}})(Vne);Gne.exports=Vne;var $W=Gne.exports;const Iwe=n=>typeof n=="object"&&typeof n.then=="function",wy=[];function Hne(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function jne(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of wy)if(Hne(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=wy.indexOf(i);s!==-1&&wy.splice(s,1)},promise:(Iwe(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(wy.push(i),!t)throw i.promise}const Rwe=(n,e,t)=>jne(n,e,!1,t),Pwe=(n,e,t)=>void jne(n,e,!0,t),Lwe=n=>{if(n===void 0||n.length===0)wy.splice(0,wy.length);else{const e=wy.find(t=>Hne(n,t.keys,t.equal));e&&e.remove()}},fU={},Dwe=n=>void Object.assign(fU,n);function Bwe(n,e){function t(d,{args:m=[],attach:v,...y},S){let E=`${d[0].toUpperCase()}${d.slice(1)}`,M;if(d==="primitive"){if(y.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const C=y.object;M=$x(C,{type:d,root:S,attach:v,primitive:!0})}else{const C=fU[E];if(!C)throw new Error(`R3F: ${E} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(m))throw new Error("R3F: The args prop must be an array!");M=$x(new C(...m),{type:d,root:S,attach:v,memoizedProps:{args:m}})}return M.__r3f.attach===void 0&&(M instanceof $r?M.__r3f.attach="geometry":M instanceof yo&&(M.__r3f.attach="material")),E!=="inject"&&Q5(M,y),M}function r(d,m){let v=!1;if(m){var y,S;(y=m.__r3f)!=null&&y.attach?J5(d,m,m.__r3f.attach):m.isObject3D&&d.isObject3D&&(d.add(m),v=!0),v||(S=d.__r3f)==null||S.objects.push(m),m.__r3f||$x(m,{}),m.__r3f.parent=d,RF(m),qx(m)}}function i(d,m,v){let y=!1;if(m){var S,E;if((S=m.__r3f)!=null&&S.attach)J5(d,m,m.__r3f.attach);else if(m.isObject3D&&d.isObject3D){m.parent=d,m.dispatchEvent({type:"added"});const M=d.children.filter(L=>L!==m),C=M.indexOf(v);d.children=[...M.slice(0,C),m,...M.slice(C)],y=!0}y||(E=d.__r3f)==null||E.objects.push(m),m.__r3f||$x(m,{}),m.__r3f.parent=d,RF(m),qx(m)}}function s(d,m,v=!1){d&&[...d].forEach(y=>a(m,y,v))}function a(d,m,v){if(m){var y,S,E;if(m.__r3f&&(m.__r3f.parent=null),(y=d.__r3f)!=null&&y.objects&&(d.__r3f.objects=d.__r3f.objects.filter(H=>H!==m)),(S=m.__r3f)!=null&&S.attach)JW(d,m,m.__r3f.attach);else if(m.isObject3D&&d.isObject3D){var M;d.remove(m),(M=m.__r3f)!=null&&M.root&&Hwe(m.__r3f.root,m)}const L=(E=m.__r3f)==null?void 0:E.primitive,k=!L&&(v===void 0?m.dispose!==null:v);if(!L){var C;s((C=m.__r3f)==null?void 0:C.objects,m,k),s(m.children,m,k)}if(delete m.__r3f,k&&m.dispose&&m.type!=="Scene"){const H=()=>{try{m.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?$W.unstable_scheduleCallback($W.unstable_IdlePriority,H):H()}qx(d)}}function l(d,m,v,y){var S;const E=(S=d.__r3f)==null?void 0:S.parent;if(!E)return;const M=t(m,v,d.__r3f.root);if(d.children){for(const C of d.children)C.__r3f&&r(M,C);d.children=d.children.filter(C=>!C.__r3f)}d.__r3f.objects.forEach(C=>r(M,C)),d.__r3f.objects=[],d.__r3f.autoRemovedBeforeAppend||a(E,d),M.parent&&(M.__r3f.autoRemovedBeforeAppend=!0),r(E,M),M.raycast&&M.__r3f.eventCount&&M.__r3f.root.getState().internal.interaction.push(M),[y,y.alternate].forEach(C=>{C!==null&&(C.stateNode=M,C.ref&&(typeof C.ref=="function"?C.ref(M):C.ref.current=M))})}const o=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Ewe({createInstance:t,removeChild:a,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,m)=>{if(!m)return;const v=d.getState().scene;v.__r3f&&(v.__r3f.root=d,r(v,m))},removeChildFromContainer:(d,m)=>{m&&a(d.getState().scene,m)},insertInContainerBefore:(d,m,v)=>{if(!m||!v)return;const y=d.getState().scene;y.__r3f&&i(y,m,v)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var m;return!!((m=d==null?void 0:d.__r3f)!=null?m:{}).handlers},prepareUpdate(d,m,v,y){var S;if(((S=d==null?void 0:d.__r3f)!=null?S:{}).primitive&&y.object&&y.object!==d)return[!0];{const{args:M=[],children:C,...L}=y,{args:k=[],children:H,...q}=v;if(!Array.isArray(M))throw new Error("R3F: the args prop must be an array!");if(M.some((ee,re)=>ee!==k[re]))return[!0];const Z=Kne(d,L,q,!0);return Z.changes.length?[!1,Z]:null}},commitUpdate(d,[m,v],y,S,E,M){m?l(d,y,E,M):Q5(d,v)},commitMount(d,m,v,y){var S;const E=(S=d.__r3f)!=null?S:{};d.raycast&&E.handlers&&E.eventCount&&d.__r3f.root.getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>$x(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var m;const{attach:v,parent:y}=(m=d.__r3f)!=null?m:{};v&&y&&JW(y,d,v),d.isObject3D&&(d.visible=!1),qx(d)},unhideInstance(d,m){var v;const{attach:y,parent:S}=(v=d.__r3f)!=null?v:{};y&&S&&J5(S,d,y),(d.isObject3D&&m.visible==null||m.visible)&&(d.visible=!0),qx(d)},createTextInstance:o,hideTextInstance:o,unhideTextInstance:o,getCurrentEventPriority:()=>e?e():gb.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&go.fun(performance.now)?performance.now:go.fun(Date.now)?Date.now:()=>0,scheduleTimeout:go.fun(setTimeout)?setTimeout:void 0,cancelTimeout:go.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Q5}}var qW,ZW;const K5=n=>"colorSpace"in n||"outputColorSpace"in n,Wne=()=>{var n;return(n=fU.ColorManagement)!=null?n:null},Xne=n=>n&&n.isOrthographicCamera,kwe=n=>n&&n.hasOwnProperty("current"),QT=typeof window<"u"&&((qW=window.document)!=null&&qW.createElement||((ZW=window.navigator)==null?void 0:ZW.product)==="ReactNative")?Ae.useLayoutEffect:Ae.useEffect;function $ne(n){const e=Ae.useRef(n);return QT(()=>void(e.current=n),[n]),e}function Owe({set:n}){return QT(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class qne extends Ae.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}qne.getDerivedStateFromError=()=>({error:!0});const Zne="__default",YW=new Map,Fwe=n=>n&&!!n.memoized&&!!n.changes;function Yne(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const O2=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},go={obj:n=>n===Object(n)&&!go.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(go.str(n)||go.num(n))return n===e;const s=go.obj(n);if(s&&r==="reference")return n===e;const a=go.arr(n);if(a&&t==="reference")return n===e;if((a||s)&&n===e)return!0;let l;for(l in n)if(!(l in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(l in i?e:n)if(!go.equ(n[l],e[l],{strict:i,objects:"reference"}))return!1}else for(l in i?e:n)if(n[l]!==e[l])return!1;if(go.und(l)){if(a&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function Nwe(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function zwe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function $x(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function IF(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,a)=>s[a],n),{target:t,key:i}}else return{target:t,key:e}}const KW=/-\d+$/;function J5(n,e,t){if(go.str(t)){if(KW.test(t)){const s=t.replace(KW,""),{target:a,key:l}=IF(n,s);Array.isArray(a[l])||(a[l]=[])}const{target:r,key:i}=IF(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function JW(n,e,t){var r,i;if(go.str(t)){const{target:s,key:a}=IF(n,t),l=e.__r3f.previousAttach;l===void 0?delete s[a]:s[a]=l}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function Kne(n,{children:e,key:t,ref:r,...i},{children:s,key:a,ref:l,...o}={},h=!1){var d;const m=(d=n==null?void 0:n.__r3f)!=null?d:{},v=Object.entries(i),y=[];if(h){const E=Object.keys(o);for(let M=0;M<E.length;M++)i.hasOwnProperty(E[M])||v.unshift([E[M],Zne+"remove"])}v.forEach(([E,M])=>{var C;if((C=n.__r3f)!=null&&C.primitive&&E==="object"||go.equ(M,o[E]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(E))return y.push([E,M,!0,[]]);let L=[];E.includes("-")&&(L=E.split("-")),y.push([E,M,!1,L]);for(const k in i){const H=i[k];k.startsWith(`${E}-`)&&y.push([k,H,!1,k.split("-")])}});const S={...i};return m.memoizedProps&&m.memoizedProps.args&&(S.args=m.memoizedProps.args),m.memoizedProps&&m.memoizedProps.attach&&(S.attach=m.memoizedProps.attach),{memoized:S,changes:y}}const Uwe=typeof process<"u"&&!1;function Q5(n,e){var t,r,i;const s=(t=n.__r3f)!=null?t:{},a=s.root,l=(r=a==null||a.getState==null?void 0:a.getState())!=null?r:{},{memoized:o,changes:h}=Fwe(e)?e:Kne(n,e),d=s.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let v=0;v<h.length;v++){let[y,S,E,M]=h[v];if(K5(n)){const H="srgb",q="srgb-linear";y==="encoding"?(y="colorSpace",S=S===3001?H:q):y==="outputEncoding"&&(y="outputColorSpace",S=S===3001?H:q)}let C=n,L=C[y];if(M.length&&(L=M.reduce((k,H)=>k[H],n),!(L&&L.set))){const[k,...H]=M.reverse();C=H.reverse().reduce((q,Z)=>q[Z],n),y=k}if(S===Zne+"remove")if(C.constructor){let k=YW.get(C.constructor);k||(k=new C.constructor,YW.set(C.constructor,k)),S=k[y]}else S=0;if(E)S?s.handlers[y]=S:delete s.handlers[y],s.eventCount=Object.keys(s.handlers).length;else if(L&&L.set&&(L.copy||L instanceof Oy)){if(Array.isArray(S))L.fromArray?L.fromArray(S):L.set(...S);else if(L.copy&&S&&S.constructor&&(Uwe?L.constructor.name===S.constructor.name:L.constructor===S.constructor))L.copy(S);else if(S!==void 0){const k=L instanceof Vn;!k&&L.setScalar?L.setScalar(S):L instanceof Oy&&S instanceof Oy?L.mask=S.mask:L.set(S),!Wne()&&!l.linear&&k&&L.convertSRGBToLinear()}}else if(C[y]=S,C[y]instanceof Xs&&C[y].format===Wl&&C[y].type===Zf){const k=C[y];K5(k)&&K5(l.gl)?k.colorSpace=l.gl.outputColorSpace:k.encoding=l.gl.outputEncoding}qx(n)}if(s.parent&&l.internal&&n.raycast&&d!==s.eventCount){const v=l.internal.interaction.indexOf(n);v>-1&&l.internal.interaction.splice(v,1),s.eventCount&&l.internal.interaction.push(n)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(i=n.__r3f)!=null&&i.parent&&RF(n),n}function qx(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function RF(n){n.onUpdate==null||n.onUpdate(n)}function Gwe(n,e){n.manual||(Xne(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function yE(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function Vwe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return gb.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return gb.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return gb.ContinuousEventPriority;default:return gb.DefaultEventPriority}}function Jne(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function Hwe(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{Jne(t.capturedMap,e,r,i)})}function jwe(n){function e(o){const{internal:h}=n.getState(),d=o.offsetX-h.initialClick[0],m=o.offsetY-h.initialClick[1];return Math.round(Math.sqrt(d*d+m*m))}function t(o){return o.filter(h=>["Move","Over","Enter","Out","Leave"].some(d=>{var m;return(m=h.__r3f)==null?void 0:m.handlers["onPointer"+d]}))}function r(o,h){const d=n.getState(),m=new Set,v=[],y=h?h(d.internal.interaction):d.internal.interaction;for(let C=0;C<y.length;C++){const L=O2(y[C]);L&&(L.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(o,d);function S(C){const L=O2(C);if(!L||!L.events.enabled||L.raycaster.camera===null)return[];if(L.raycaster.camera===void 0){var k;L.events.compute==null||L.events.compute(o,L,(k=L.previousRoot)==null?void 0:k.getState()),L.raycaster.camera===void 0&&(L.raycaster.camera=null)}return L.raycaster.camera?L.raycaster.intersectObject(C,!0):[]}let E=y.flatMap(S).sort((C,L)=>{const k=O2(C.object),H=O2(L.object);return!k||!H?C.distance-L.distance:H.events.priority-k.events.priority||C.distance-L.distance}).filter(C=>{const L=yE(C);return m.has(L)?!1:(m.add(L),!0)});d.events.filter&&(E=d.events.filter(E,d));for(const C of E){let L=C.object;for(;L;){var M;(M=L.__r3f)!=null&&M.eventCount&&v.push({...C,eventObject:L}),L=L.parent}}if("pointerId"in o&&d.internal.capturedMap.has(o.pointerId))for(let C of d.internal.capturedMap.get(o.pointerId).values())m.has(yE(C.intersection))||v.push(C.intersection);return v}function i(o,h,d,m){const v=n.getState();if(o.length){const y={stopped:!1};for(const S of o){const E=O2(S.object)||v,{raycaster:M,pointer:C,camera:L,internal:k}=E,H=new Ze(C.x,C.y,0).unproject(L),q=ae=>{var fe,Se;return(fe=(Se=k.capturedMap.get(ae))==null?void 0:Se.has(S.eventObject))!=null?fe:!1},Z=ae=>{const fe={intersection:S,target:h.target};k.capturedMap.has(ae)?k.capturedMap.get(ae).set(S.eventObject,fe):k.capturedMap.set(ae,new Map([[S.eventObject,fe]])),h.target.setPointerCapture(ae)},ee=ae=>{const fe=k.capturedMap.get(ae);fe&&Jne(k.capturedMap,S.eventObject,fe,ae)};let re={};for(let ae in h){let fe=h[ae];typeof fe!="function"&&(re[ae]=fe)}let se={...S,...re,pointer:C,intersections:o,stopped:y.stopped,delta:d,unprojectedPoint:H,ray:M.ray,camera:L,stopPropagation(){const ae="pointerId"in h&&k.capturedMap.get(h.pointerId);if((!ae||ae.has(S.eventObject))&&(se.stopped=y.stopped=!0,k.hovered.size&&Array.from(k.hovered.values()).find(fe=>fe.eventObject===S.eventObject))){const fe=o.slice(0,o.indexOf(S));s([...fe,S])}},target:{hasPointerCapture:q,setPointerCapture:Z,releasePointerCapture:ee},currentTarget:{hasPointerCapture:q,setPointerCapture:Z,releasePointerCapture:ee},nativeEvent:h};if(m(se),y.stopped===!0)break}}return o}function s(o){const{internal:h}=n.getState();for(const d of h.hovered.values())if(!o.length||!o.find(m=>m.object===d.object&&m.index===d.index&&m.instanceId===d.instanceId)){const v=d.eventObject.__r3f,y=v==null?void 0:v.handlers;if(h.hovered.delete(yE(d)),v!=null&&v.eventCount){const S={...d,intersections:o};y.onPointerOut==null||y.onPointerOut(S),y.onPointerLeave==null||y.onPointerLeave(S)}}}function a(o,h){for(let d=0;d<h.length;d++){const m=h[d].__r3f;m==null||m.handlers.onPointerMissed==null||m.handlers.onPointerMissed(o)}}function l(o){switch(o){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:d}=n.getState();"pointerId"in h&&d.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(h.pointerId)&&(d.capturedMap.delete(h.pointerId),s([]))})}}return function(d){const{onPointerMissed:m,internal:v}=n.getState();v.lastEvent.current=d;const y=o==="onPointerMove",S=o==="onClick"||o==="onContextMenu"||o==="onDoubleClick",M=r(d,y?t:void 0),C=S?e(d):0;o==="onPointerDown"&&(v.initialClick=[d.offsetX,d.offsetY],v.initialHits=M.map(k=>k.eventObject)),S&&!M.length&&C<=2&&(a(d,v.interaction),m&&m(d)),y&&s(M);function L(k){const H=k.eventObject,q=H.__r3f,Z=q==null?void 0:q.handlers;if(q!=null&&q.eventCount)if(y){if(Z.onPointerOver||Z.onPointerEnter||Z.onPointerOut||Z.onPointerLeave){const ee=yE(k),re=v.hovered.get(ee);re?re.stopped&&k.stopPropagation():(v.hovered.set(ee,k),Z.onPointerOver==null||Z.onPointerOver(k),Z.onPointerEnter==null||Z.onPointerEnter(k))}Z.onPointerMove==null||Z.onPointerMove(k)}else{const ee=Z[o];ee?(!S||v.initialHits.includes(H))&&(a(d,v.interaction.filter(re=>!v.initialHits.includes(re))),ee(k)):S&&v.initialHits.includes(H)&&a(d,v.interaction.filter(re=>!v.initialHits.includes(re)))}}i(M,d,C,L)}}return{handlePointer:l}}const Qne=n=>!!(n!=null&&n.render),ere=Ae.createContext(null),Wwe=(n,e)=>{const t=Swe((l,o)=>{const h=new Ze,d=new Ze,m=new Ze;function v(C=o().camera,L=d,k=o().size){const{width:H,height:q,top:Z,left:ee}=k,re=H/q;L instanceof Ze?m.copy(L):m.set(...L);const se=C.getWorldPosition(h).distanceTo(m);if(Xne(C))return{width:H/C.zoom,height:q/C.zoom,top:Z,left:ee,factor:1,distance:se,aspect:re};{const ae=C.fov*Math.PI/180,fe=2*Math.tan(ae/2)*se,Se=fe*(H/q);return{width:Se,height:fe,top:Z,left:ee,factor:H/Se,distance:se,aspect:re}}}let y;const S=C=>l(L=>({performance:{...L.performance,current:C}})),E=new nn;return{set:l,get:o,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(C=1)=>n(o(),C),advance:(C,L)=>e(C,L,o()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new ng,pointer:E,mouse:E,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const C=o();y&&clearTimeout(y),C.performance.current!==C.performance.min&&S(C.performance.min),y=setTimeout(()=>S(o().performance.max),C.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:C=>l(L=>({...L,events:{...L.events,...C}})),setSize:(C,L,k,H,q)=>{const Z=o().camera,ee={width:C,height:L,top:H||0,left:q||0,updateStyle:k};l(re=>({size:ee,viewport:{...re.viewport,...v(Z,d,ee)}}))},setDpr:C=>l(L=>{const k=Yne(C);return{viewport:{...L.viewport,dpr:k,initialDpr:L.viewport.initialDpr||k}}}),setFrameloop:(C="always")=>{const L=o().clock;L.stop(),L.elapsedTime=0,C!=="never"&&(L.start(),L.elapsedTime=0),l(()=>({frameloop:C}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:Ae.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(C,L,k)=>{const H=o().internal;return H.priority=H.priority+(L>0?1:0),H.subscribers.push({ref:C,priority:L,store:k}),H.subscribers=H.subscribers.sort((q,Z)=>q.priority-Z.priority),()=>{const q=o().internal;q!=null&&q.subscribers&&(q.priority=q.priority-(L>0?1:0),q.subscribers=q.subscribers.filter(Z=>Z.ref!==C))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,a=r.camera;return t.subscribe(()=>{const{camera:l,size:o,viewport:h,gl:d,set:m}=t.getState();if(o.width!==i.width||o.height!==i.height||h.dpr!==s){var v;i=o,s=h.dpr,Gwe(l,o),d.setPixelRatio(h.dpr);const y=(v=o.updateStyle)!=null?v:typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(o.width,o.height,y)}l!==a&&(a=l,m(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(l)}})))}),t.subscribe(l=>n(l)),t};function Xwe(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}let xE,tre=new Set,$we=new Set,qwe=new Set;const Zwe=n=>Xwe(n,tre);function eB(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function F2(n,e){switch(n){case"before":return eB(tre,e);case"after":return eB($we,e);case"tail":return eB(qwe,e)}}let tB,nB;function rB(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),tB=e.internal.subscribers,xE=0;xE<tB.length;xE++)nB=tB[xE],nB.ref.current(nB.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Ywe(n){let e=!1,t,r,i;function s(o){r=requestAnimationFrame(s),e=!0,t=0,F2("before",o);for(const d of n.values()){var h;i=d.store.getState(),i.internal.active&&(i.frameloop==="always"||i.internal.frames>0)&&!((h=i.gl.xr)!=null&&h.isPresenting)&&(t+=rB(o,i))}if(F2("after",o),t===0)return F2("tail",o),e=!1,cancelAnimationFrame(r)}function a(o,h=1){var d;if(!o)return n.forEach(m=>a(m.store.getState()),h);(d=o.gl.xr)!=null&&d.isPresenting||!o.internal.active||o.frameloop==="never"||(o.internal.frames=Math.min(60,o.internal.frames+h),e||(e=!0,requestAnimationFrame(s)))}function l(o,h=!0,d,m){if(h&&F2("before",o),d)rB(o,d,m);else for(const v of n.values())rB(o,v.store.getState());h&&F2("after",o)}return{loop:s,invalidate:a,advance:l}}function nre(){const n=Ae.useContext(ere);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function rre(n=t=>t,e){return nre()(n,e)}function eM(n,e=0){const t=nre(),r=t.getState().internal.subscribe,i=$ne(n);return QT(()=>r(i,e,t),[e,r,t]),null}const QW=new WeakMap;function ire(n,e){return function(t,...r){let i=QW.get(t);return i||(i=new t,QW.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((a,l)=>i.load(s,o=>{o.scene&&Object.assign(o,Nwe(o.scene)),a(o)},e,o=>l(new Error(`Could not load ${s}: ${o==null?void 0:o.message}`)))))).finally(()=>i.dispose==null?void 0:i.dispose())}}function tM(n,e,t,r){const i=Array.isArray(e)?e:[e],s=Rwe(ire(t,r),[n,...i],{equal:go.equ});return Array.isArray(e)?s:s[0]}tM.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return Pwe(ire(t),[n,...r])};tM.clear=function(n,e){const t=Array.isArray(e)?e:[e];return Lwe([n,...t])};const tw=new Map,{invalidate:eX,advance:tX}=Ywe(tw),{reconciler:_P,applyProps:uy}=Bwe(tw,Vwe),Tx={objects:"shallow",strict:!1},Kwe=(n,e)=>{const t=typeof n=="function"?n(e):n;return Qne(t)?t:new Yl({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function Jwe(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:a,updateStyle:l=t}=e;return{width:r,height:i,top:s,left:a,updateStyle:l}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:a}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:a,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function Qwe(n){const e=tw.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||Wwe(eX,tX),a=t||_P.createContainer(s,gb.ConcurrentRoot,null,!1,null,"",i,null);e||tw.set(n,{fiber:a,store:s});let l,o=!1,h;return{configure(d={}){let{gl:m,size:v,scene:y,events:S,onCreated:E,shadows:M=!1,linear:C=!1,flat:L=!1,legacy:k=!1,orthographic:H=!1,frameloop:q="always",dpr:Z=[1,2],performance:ee,raycaster:re,camera:se,onPointerMissed:ae}=d,fe=s.getState(),Se=fe.gl;fe.gl||fe.set({gl:Se=Kwe(m,n)});let Ce=fe.raycaster;Ce||fe.set({raycaster:Ce=new bD});const{params:Ie,...je}=re||{};if(go.equ(je,Ce,Tx)||uy(Ce,{...je}),go.equ(Ie,Ce.params,Tx)||uy(Ce,{params:{...Ce.params,...Ie}}),!fe.camera||fe.camera===h&&!go.equ(h,se,Tx)){h=se;const wt=se instanceof VT,Vt=wt?se:H?new ed(0,0,0,0,.1,1e3):new ts(75,0,.1,1e3);wt||(Vt.position.z=5,se&&uy(Vt,se),!fe.camera&&!(se!=null&&se.rotation)&&Vt.lookAt(0,0,0)),fe.set({camera:Vt}),Ce.camera=Vt}if(!fe.scene){let wt;y instanceof Tl?wt=y:(wt=new Tl,y&&uy(wt,y)),fe.set({scene:$x(wt)})}if(!fe.xr){var Le;const wt=(Ht,Qt)=>{const rn=s.getState();rn.frameloop!=="never"&&tX(Ht,!0,rn,Qt)},Vt=()=>{const Ht=s.getState();Ht.gl.xr.enabled=Ht.gl.xr.isPresenting,Ht.gl.xr.setAnimationLoop(Ht.gl.xr.isPresenting?wt:null),Ht.gl.xr.isPresenting||eX(Ht)},lt={connect(){const Ht=s.getState().gl;Ht.xr.addEventListener("sessionstart",Vt),Ht.xr.addEventListener("sessionend",Vt)},disconnect(){const Ht=s.getState().gl;Ht.xr.removeEventListener("sessionstart",Vt),Ht.xr.removeEventListener("sessionend",Vt)}};typeof((Le=Se.xr)==null?void 0:Le.addEventListener)=="function"&&lt.connect(),fe.set({xr:lt})}if(Se.shadowMap){const wt=Se.shadowMap.enabled,Vt=Se.shadowMap.type;if(Se.shadowMap.enabled=!!M,go.boo(M))Se.shadowMap.type=HS;else if(go.str(M)){var ot;const lt={basic:Wee,percentage:HL,soft:HS,variance:Bf};Se.shadowMap.type=(ot=lt[M])!=null?ot:HS}else go.obj(M)&&Object.assign(Se.shadowMap,M);(wt!==Se.shadowMap.enabled||Vt!==Se.shadowMap.type)&&(Se.shadowMap.needsUpdate=!0)}const ye=Wne();ye&&("enabled"in ye?ye.enabled=!k:"legacyMode"in ye&&(ye.legacyMode=k)),uy(Se,{outputEncoding:C?3e3:3001,toneMapping:L?ap:WL}),fe.legacy!==k&&fe.set(()=>({legacy:k})),fe.linear!==C&&fe.set(()=>({linear:C})),fe.flat!==L&&fe.set(()=>({flat:L})),m&&!go.fun(m)&&!Qne(m)&&!go.equ(m,Se,Tx)&&uy(Se,m),S&&!fe.events.handlers&&fe.set({events:S(s)});const _t=Jwe(n,v);return go.equ(_t,fe.size,Tx)||fe.setSize(_t.width,_t.height,_t.updateStyle,_t.top,_t.left),Z&&fe.viewport.dpr!==Yne(Z)&&fe.setDpr(Z),fe.frameloop!==q&&fe.setFrameloop(q),fe.onPointerMissed||fe.set({onPointerMissed:ae}),ee&&!go.equ(ee,fe.performance,Tx)&&fe.set(wt=>({performance:{...wt.performance,...ee}})),l=E,o=!0,this},render(d){return o||this.configure(),_P.updateContainer(Ae.createElement(e2e,{store:s,children:d,onCreated:l,rootElement:n}),a,null,()=>{}),s},unmount(){sre(n)}}}function e2e({store:n,children:e,onCreated:t,rootElement:r}){return QT(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),Ae.createElement(ere.Provider,{value:n},e)}function sre(n,e){const t=tw.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),_P.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,a,l,o;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(l=i.gl)==null||l.forceContextLoss==null||l.forceContextLoss(),(o=i.gl)!=null&&o.xr&&i.xr.disconnect(),zwe(i),tw.delete(n)}catch{}},500)})}}_P.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:Ae.version});function PF(n,e,t){var r,i,s,a,l;e==null&&(e=100);function o(){var d=Date.now()-a;d<e&&d>=0?r=setTimeout(o,e-d):(r=null,t||(l=n.apply(s,i),s=i=null))}var h=function(){s=this,i=arguments,a=Date.now();var d=t&&!r;return r||(r=setTimeout(o,e)),d&&(l=n.apply(s,i),s=i=null),l};return h.clear=function(){r&&(clearTimeout(r),r=null)},h.flush=function(){r&&(l=n.apply(s,i),s=i=null,clearTimeout(r),r=null)},h}PF.debounce=PF;var t2e=PF;const nX=SL(t2e);function n2e(n){let{debounce:e,scroll:t,polyfill:r,offsetSize:i}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const s=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,l]=Ae.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=Ae.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),h=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,m=Ae.useRef(!1);Ae.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[v,y,S]=Ae.useMemo(()=>{const L=()=>{if(!o.current.element)return;const{left:k,top:H,width:q,height:Z,bottom:ee,right:re,x:se,y:ae}=o.current.element.getBoundingClientRect(),fe={left:k,top:H,width:q,height:Z,bottom:ee,right:re,x:se,y:ae};o.current.element instanceof HTMLElement&&i&&(fe.height=o.current.element.offsetHeight,fe.width=o.current.element.offsetWidth),Object.freeze(fe),m.current&&!o2e(o.current.lastBounds,fe)&&l(o.current.lastBounds=fe)};return[L,d?nX(L,d):L,h?nX(L,h):L]},[l,i,h,d]);function E(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(L=>L.removeEventListener("scroll",S,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null)}function M(){o.current.element&&(o.current.resizeObserver=new s(S),o.current.resizeObserver.observe(o.current.element),t&&o.current.scrollContainers&&o.current.scrollContainers.forEach(L=>L.addEventListener("scroll",S,{capture:!0,passive:!0})))}const C=L=>{!L||L===o.current.element||(E(),o.current.element=L,o.current.scrollContainers=ore(L),M())};return i2e(S,!!t),r2e(y),Ae.useEffect(()=>{E(),M()},[t,S,y]),Ae.useEffect(()=>E,[]),[C,a,v]}function r2e(n){Ae.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function i2e(n,e){Ae.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function ore(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...ore(n.parentElement)]}const s2e=["x","y","top","bottom","left","right","width","height"],o2e=(n,e)=>s2e.every(t=>n[t]===e[t]);var a2e=Object.defineProperty,l2e=Object.defineProperties,c2e=Object.getOwnPropertyDescriptors,rX=Object.getOwnPropertySymbols,u2e=Object.prototype.hasOwnProperty,h2e=Object.prototype.propertyIsEnumerable,iX=(n,e,t)=>e in n?a2e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sX=(n,e)=>{for(var t in e||(e={}))u2e.call(e,t)&&iX(n,t,e[t]);if(rX)for(var t of rX(e))h2e.call(e,t)&&iX(n,t,e[t]);return n},f2e=(n,e)=>l2e(n,c2e(e));function are(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=are(r,e,t);if(i)return i;r=r.sibling}}function lre(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const dU=lre(Ae.createContext(null));class cre extends Ae.Component{render(){return Ae.createElement(dU.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:oX,ReactCurrentDispatcher:aX}=Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function d2e(){const n=Ae.useContext(dU);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ae.useId();return Ae.useMemo(()=>{for(const r of[oX==null?void 0:oX.current,n,n==null?void 0:n.alternate]){if(!r)continue;const i=are(r,!1,s=>{let a=s.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(i)return i}},[n,e])}function p2e(){var n,e;const t=d2e(),[r]=Ae.useState(()=>new Map);r.clear();let i=t;for(;i;){const s=(n=i.type)==null?void 0:n._context;s&&s!==dU&&!r.has(s)&&r.set(s,(e=aX==null?void 0:aX.current)==null?void 0:e.readContext(lre(s))),i=i.return}return r}function m2e(){const n=p2e();return Ae.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>Ae.createElement(e,null,Ae.createElement(t.Provider,f2e(sX({},r),{value:n.get(t)}))),e=>Ae.createElement(cre,sX({},e))),[n])}const iB={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function g2e(n){const{handlePointer:e}=jwe(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(iB).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(a=>({events:{...a.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([a,l])=>{const[o,h]=iB[a];t.addEventListener(o,l,{passive:h})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,a])=>{if(r&&r.connected instanceof HTMLElement){const[l]=iB[s];r.connected.removeEventListener(l,a)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const v2e=Ae.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:a=g2e,eventSource:l,eventPrefix:o,shadows:h,linear:d,flat:m,legacy:v,orthographic:y,frameloop:S,dpr:E,performance:M,raycaster:C,camera:L,scene:k,onPointerMissed:H,onCreated:q,...Z},ee){Ae.useMemo(()=>Dwe(Nne),[]);const re=m2e(),[se,ae]=n2e({scroll:!0,debounce:{scroll:50,resize:0},...r}),fe=Ae.useRef(null),Se=Ae.useRef(null);Ae.useImperativeHandle(ee,()=>fe.current);const Ce=$ne(H),[Ie,je]=Ae.useState(!1),[Le,ot]=Ae.useState(!1);if(Ie)throw Ie;if(Le)throw Le;const ye=Ae.useRef(null);QT(()=>{const Ve=fe.current;ae.width>0&&ae.height>0&&Ve&&(ye.current||(ye.current=Qwe(Ve)),ye.current.configure({gl:s,events:a,shadows:h,linear:d,flat:m,legacy:v,orthographic:y,frameloop:S,dpr:E,performance:M,raycaster:C,camera:L,scene:k,size:ae,onPointerMissed:(..._t)=>Ce.current==null?void 0:Ce.current(..._t),onCreated:_t=>{_t.events.connect==null||_t.events.connect(l?kwe(l)?l.current:l:Se.current),o&&_t.setEvents({compute:(wt,Vt)=>{const lt=wt[o+"X"],Ht=wt[o+"Y"];Vt.pointer.set(lt/Vt.size.width*2-1,-(Ht/Vt.size.height)*2+1),Vt.raycaster.setFromCamera(Vt.pointer,Vt.camera)}}),q==null||q(_t)}}),ye.current.render(Ae.createElement(re,null,Ae.createElement(qne,{set:ot},Ae.createElement(Ae.Suspense,{fallback:Ae.createElement(Owe,{set:je})},e)))))}),Ae.useEffect(()=>{const Ve=fe.current;if(Ve)return()=>sre(Ve)},[]);const $e=l?"none":"auto";return Ae.createElement("div",UA({ref:Se,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$e,...i}},Z),Ae.createElement("div",{ref:se,style:{width:"100%",height:"100%"}},Ae.createElement("canvas",{ref:fe,style:{display:"block"}},t)))}),wD=Ae.forwardRef(function(e,t){return Ae.createElement(cre,null,Ae.createElement(v2e,UA({},e,{ref:t})))}),nM=new Ze,pU=new Ze,_2e=new Ze,lX=new nn;function y2e(n,e,t){const r=nM.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,s=t.height/2;return[r.x*i+i,-(r.y*s)+s]}function x2e(n,e){const t=nM.setFromMatrixPosition(n.matrixWorld),r=pU.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),s=e.getWorldDirection(_2e);return i.angleTo(s)>Math.PI/2}function b2e(n,e,t,r){const i=nM.setFromMatrixPosition(n.matrixWorld),s=i.clone();s.project(e),lX.set(s.x,s.y),t.setFromCamera(lX,e);const a=t.intersectObjects(r,!0);if(a.length){const l=a[0].distance;return i.distanceTo(t.ray.origin)<l}return!0}function w2e(n,e){if(e instanceof ed)return e.zoom;if(e instanceof ts){const t=nM.setFromMatrixPosition(n.matrixWorld),r=pU.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function S2e(n,e,t){if(e instanceof ts||e instanceof ed){const r=nM.setFromMatrixPosition(n.matrixWorld),i=pU.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),a=(t[1]-t[0])/(e.far-e.near),l=t[1]-a*e.far;return Math.round(a*s+l)}}const LF=n=>Math.abs(n)<1e-10?0:n;function ure(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=LF(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const A2e=(n=>e=>ure(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),T2e=(n=>(e,t)=>ure(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function M2e(n){return n&&typeof n=="object"&&"current"in n}const C2e=Ae.forwardRef(({children:n,eps:e=.001,style:t,className:r,prepend:i,center:s,fullscreen:a,portal:l,distanceFactor:o,sprite:h=!1,transform:d=!1,occlude:m,onOcclude:v,castShadow:y,receiveShadow:S,material:E,geometry:M,zIndexRange:C=[16777271,0],calculatePosition:L=y2e,as:k="div",wrapperClass:H,pointerEvents:q="auto",...Z},ee)=>{const{gl:re,camera:se,scene:ae,size:fe,raycaster:Se,events:Ce,viewport:Ie}=rre(),[je]=Ae.useState(()=>document.createElement(k)),Le=Ae.useRef(),ot=Ae.useRef(null),ye=Ae.useRef(0),$e=Ae.useRef([0,0]),Ve=Ae.useRef(null),_t=Ae.useRef(null),wt=(l==null?void 0:l.current)||Ce.connected||re.domElement.parentNode,Vt=Ae.useRef(null),lt=Ae.useRef(!1),Ht=Ae.useMemo(()=>m&&m!=="blending"||Array.isArray(m)&&m.length&&M2e(m[0]),[m]);Ae.useLayoutEffect(()=>{const Tn=re.domElement;m&&m==="blending"?(Tn.style.zIndex=`${Math.floor(C[0]/2)}`,Tn.style.position="absolute",Tn.style.pointerEvents="none"):(Tn.style.zIndex=null,Tn.style.position=null,Tn.style.pointerEvents=null)},[m]),Ae.useLayoutEffect(()=>{if(ot.current){const Tn=Le.current=Pee(je);if(ae.updateMatrixWorld(),d)je.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Pe=L(ot.current,se,fe);je.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Pe[0]}px,${Pe[1]}px,0);transform-origin:0 0;`}return wt&&(i?wt.prepend(je):wt.appendChild(je)),()=>{wt&&wt.removeChild(je),Tn.unmount()}}},[wt,d]),Ae.useLayoutEffect(()=>{H&&(je.className=H)},[H]);const Qt=Ae.useMemo(()=>d?{position:"absolute",top:0,left:0,width:fe.width,height:fe.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...a&&{top:-fe.height/2,left:-fe.width/2,width:fe.width,height:fe.height},...t},[t,s,a,fe,d]),rn=Ae.useMemo(()=>({position:"absolute",pointerEvents:q}),[q]);Ae.useLayoutEffect(()=>{if(lt.current=!1,d){var Tn;(Tn=Le.current)==null||Tn.render(Ae.createElement("div",{ref:Ve,style:Qt},Ae.createElement("div",{ref:_t,style:rn},Ae.createElement("div",{ref:ee,className:r,style:t,children:n}))))}else{var Pe;(Pe=Le.current)==null||Pe.render(Ae.createElement("div",{ref:ee,style:Qt,className:r,children:n}))}});const jn=Ae.useRef(!0);eM(Tn=>{if(ot.current){se.updateMatrixWorld(),ot.current.updateWorldMatrix(!0,!1);const Pe=d?$e.current:L(ot.current,se,fe);if(d||Math.abs(ye.current-se.zoom)>e||Math.abs($e.current[0]-Pe[0])>e||Math.abs($e.current[1]-Pe[1])>e){const qe=x2e(ot.current,se);let mn=!1;Ht&&(Array.isArray(m)?mn=m.map(kn=>kn.current):m!=="blending"&&(mn=[ae]));const cn=jn.current;if(mn){const kn=b2e(ot.current,se,Se,mn);jn.current=kn&&!qe}else jn.current=!qe;cn!==jn.current&&(v?v(!jn.current):je.style.display=jn.current?"block":"none");const St=Math.floor(C[0]/2),Jt=m?Ht?[C[0],St]:[St-1,0]:C;if(je.style.zIndex=`${S2e(ot.current,se,Jt)}`,d){const[kn,Gn]=[fe.width/2,fe.height/2],sn=se.projectionMatrix.elements[5]*Gn,{isOrthographicCamera:at,top:Ue,left:$t,bottom:An,right:Sn}=se,jt=A2e(se.matrixWorldInverse),mr=at?`scale(${sn})translate(${LF(-(Sn+$t)/2)}px,${LF((Ue+An)/2)}px)`:`translateZ(${sn}px)`;let Un=ot.current.matrixWorld;h&&(Un=se.matrixWorldInverse.clone().transpose().copyPosition(Un).scale(ot.current.scale),Un.elements[3]=Un.elements[7]=Un.elements[11]=0,Un.elements[15]=1),je.style.width=fe.width+"px",je.style.height=fe.height+"px",je.style.perspective=at?"":`${sn}px`,Ve.current&&_t.current&&(Ve.current.style.transform=`${mr}${jt}translate(${kn}px,${Gn}px)`,_t.current.style.transform=T2e(Un,1/((o||10)/400)))}else{const kn=o===void 0?1:w2e(ot.current,se)*o;je.style.transform=`translate3d(${Pe[0]}px,${Pe[1]}px,0) scale(${kn})`}$e.current=Pe,ye.current=se.zoom}}if(!Ht&&Vt.current&&!lt.current)if(d){if(Ve.current){const Pe=Ve.current.children[0];if(Pe!=null&&Pe.clientWidth&&Pe!=null&&Pe.clientHeight){const{isOrthographicCamera:qe}=se;if(qe||M)Z.scale&&(Array.isArray(Z.scale)?Z.scale instanceof Ze?Vt.current.scale.copy(Z.scale.clone().divideScalar(1)):Vt.current.scale.set(1/Z.scale[0],1/Z.scale[1],1/Z.scale[2]):Vt.current.scale.setScalar(1/Z.scale));else{const mn=(o||10)/400,cn=Pe.clientWidth*mn,St=Pe.clientHeight*mn;Vt.current.scale.set(cn,St,1)}lt.current=!0}}}else{const Pe=je.children[0];if(Pe!=null&&Pe.clientWidth&&Pe!=null&&Pe.clientHeight){const qe=1/Ie.factor,mn=Pe.clientWidth*qe,cn=Pe.clientHeight*qe;Vt.current.scale.set(mn,cn,1),lt.current=!0}Vt.current.lookAt(Tn.camera.position)}});const Bn=Ae.useMemo(()=>({vertexShader:d?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[d]);return Ae.createElement("group",UA({},Z,{ref:ot}),m&&!Ht&&Ae.createElement("mesh",{castShadow:y,receiveShadow:S,ref:Vt},M||Ae.createElement("planeGeometry",null),E||Ae.createElement("shaderMaterial",{side:wc,vertexShader:Bn.vertexShader,fragmentShader:Bn.fragmentShader})))});function cX(n,e){if(e===F6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Qy||e===UT){let t=n.getIndex();if(t===null){const a=[],l=n.getAttribute("position");if(l!==void 0){for(let o=0;o<l.count;o++)a.push(o);n.setIndex(a),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(t)if(e===Qy)for(let a=1;a<=r;a++)i.push(t.getX(0)),i.push(t.getX(a)),i.push(t.getX(a+1));else for(let a=0;a<r;a++)a%2===0?(i.push(t.getX(a)),i.push(t.getX(a+1)),i.push(t.getX(a+2))):(i.push(t.getX(a+2)),i.push(t.getX(a+1)),i.push(t.getX(a)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const E2e=parseInt(kT.replace(/\D+/g,""));function yP(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,r=n.length;t<r;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Sy="srgb",Om="srgb-linear",uX=3001,I2e=3e3;let mU=class extends Ia{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new B2e(t)}),this.register(function(t){return new k2e(t)}),this.register(function(t){return new j2e(t)}),this.register(function(t){return new W2e(t)}),this.register(function(t){return new X2e(t)}),this.register(function(t){return new F2e(t)}),this.register(function(t){return new N2e(t)}),this.register(function(t){return new z2e(t)}),this.register(function(t){return new U2e(t)}),this.register(function(t){return new D2e(t)}),this.register(function(t){return new G2e(t)}),this.register(function(t){return new O2e(t)}),this.register(function(t){return new H2e(t)}),this.register(function(t){return new V2e(t)}),this.register(function(t){return new P2e(t)}),this.register(function(t){return new $2e(t)}),this.register(function(t){return new q2e(t)})}load(e,t,r,i){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const h=hu.extractUrlBase(e);a=hu.resolveURL(h,this.path)}else a=hu.extractUrlBase(e);this.manager.itemStart(e);const l=function(h){i?i(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},o=new Xa(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(h){try{s.parse(h,a,function(d){t(d),s.manager.itemEnd(e)},l)}catch(d){l(d)}},r,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const a={},l={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(yP(new Uint8Array(e.slice(0,4)))===hre){try{a[Gi.KHR_BINARY_GLTF]=new Z2e(e)}catch(d){i&&i(d);return}s=JSON.parse(a[Gi.KHR_BINARY_GLTF].content)}else s=JSON.parse(yP(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const o=new lSe(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const d=this.pluginCallbacks[h](o);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[d.name]=d,a[d.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const d=s.extensionsUsed[h],m=s.extensionsRequired||[];switch(d){case Gi.KHR_MATERIALS_UNLIT:a[d]=new L2e;break;case Gi.KHR_DRACO_MESH_COMPRESSION:a[d]=new Y2e(s,this.dracoLoader);break;case Gi.KHR_TEXTURE_TRANSFORM:a[d]=new K2e;break;case Gi.KHR_MESH_QUANTIZATION:a[d]=new J2e;break;default:m.indexOf(d)>=0&&l[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}o.setExtensions(a),o.setPlugins(l),o.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}};function R2e(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Gi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let P2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const d=new Vn(16777215);o.color!==void 0&&d.setRGB(o.color[0],o.color[1],o.color[2],Om);const m=o.range!==void 0?o.range:0;switch(o.type){case"directional":h=new Pv(d),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new rv(d),h.distance=m;break;case"spot":h=new yD(d),h.distance=m,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,h.angle=o.spot.outerConeAngle,h.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return h.position.set(0,0,0),h.decay=2,_m(h,o),o.intensity!==void 0&&(h.intensity=o.intensity),h.name=t.createUniqueName(o.name||"light_"+e),i=Promise.resolve(h),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(o){return r._getNodeRef(t.cache,l,o)})}},L2e=class{constructor(){this.name=Gi.KHR_MATERIALS_UNLIT}getMaterialType(){return _o}extendParams(e,t,r){const i=[];e.color=new Vn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Om),e.opacity=a[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Sy))}return Promise.all(i)}},D2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},B2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const l=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new nn(l,l)}return Promise.all(s)}},k2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},O2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}},F2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Vn(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=i.extensions[this.name];if(a.sheenColorFactor!==void 0){const l=a.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],Om)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Sy)),a.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}},N2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}},z2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return t.attenuationColor=new Vn().setRGB(l[0],l[1],l[2],Om),Promise.all(s)}},U2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},G2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return t.specularColor=new Vn().setRGB(l[0],l[1],l[2],Om),a.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,Sy)),Promise.all(s)}},V2e=class{constructor(e){this.parser=e,this.name=Gi.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}},H2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}},j2e=class{constructor(e){this.parser=e,this.name=Gi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}},W2e=class{constructor(e){this.parser=e,this.name=Gi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=i.images[a.source];let o=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(o=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},X2e=class{constructor(e){this.parser=e,this.name=Gi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=i.images[a.source];let o=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(o=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},$2e=class{constructor(e){this.name=Gi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const o=i.byteOffset||0,h=i.byteLength||0,d=i.count,m=i.byteStride,v=new Uint8Array(l,o,h);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(d,m,v,i.mode,i.filter).then(function(y){return y.buffer}):a.ready.then(function(){const y=new ArrayBuffer(d*m);return a.decodeGltfBuffer(new Uint8Array(y),d,m,v,i.mode,i.filter),y})})}else return null}},q2e=class{constructor(e){this.name=Gi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const h of i.primitives)if(h.mode!==dh.TRIANGLES&&h.mode!==dh.TRIANGLE_STRIP&&h.mode!==dh.TRIANGLE_FAN&&h.mode!==void 0)return null;const a=r.extensions[this.name].attributes,l=[],o={};for(const h in a)l.push(this.parser.getDependency("accessor",a[h]).then(d=>(o[h]=d,o[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(h=>{const d=h.pop(),m=d.isGroup?d.children:[d],v=h[0].count,y=[];for(const S of m){const E=new Gr,M=new Ze,C=new Ta,L=new Ze(1,1,1),k=new iD(S.geometry,S.material,v);for(let H=0;H<v;H++)o.TRANSLATION&&M.fromBufferAttribute(o.TRANSLATION,H),o.ROTATION&&C.fromBufferAttribute(o.ROTATION,H),o.SCALE&&L.fromBufferAttribute(o.SCALE,H),k.setMatrixAt(H,E.compose(M,C,L));for(const H in o)if(H==="_COLOR_0"){const q=o[H];k.instanceColor=new fv(q.array,q.itemSize,q.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&S.geometry.setAttribute(H,o[H]);Ri.prototype.copy.call(k,S),this.parser.assignFinalMaterial(k),y.push(k)}return d.isGroup?(d.clear(),d.add(...y),d):y[0]}))}};const hre="glTF",N2=12,hX={JSON:1313821514,BIN:5130562};let Z2e=class{constructor(e){this.name=Gi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,N2);if(this.header={magic:yP(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==hre)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-N2,i=new DataView(e,N2);let s=0;for(;s<r;){const a=i.getUint32(s,!0);s+=4;const l=i.getUint32(s,!0);if(s+=4,l===hX.JSON){const o=new Uint8Array(e,N2+s,a);this.content=yP(o)}else if(l===hX.BIN){const o=N2+s;this.body=e.slice(o,o+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Y2e=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Gi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,l={},o={},h={};for(const d in a){const m=DF[d]||d.toLowerCase();l[m]=a[d]}for(const d in e.attributes){const m=DF[d]||d.toLowerCase();if(a[d]!==void 0){const v=r.accessors[e.attributes[d]],y=Lb[v.componentType];h[m]=y.name,o[m]=v.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(m,v){i.decodeDracoFile(d,function(y){for(const S in y.attributes){const E=y.attributes[S],M=o[S];M!==void 0&&(E.normalized=M)}m(y)},l,h,Om,v)})})}},K2e=class{constructor(){this.name=Gi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},J2e=class{constructor(){this.name=Gi.KHR_MESH_QUANTIZATION}},fre=class extends v1{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let a=0;a!==i;a++)t[a]=r[s+a];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,o=l*2,h=l*3,d=i-t,m=(r-t)/d,v=m*m,y=v*m,S=e*h,E=S-h,M=-2*y+3*v,C=y-v,L=1-M,k=C-v+m;for(let H=0;H!==l;H++){const q=a[E+H+l],Z=a[E+H+o]*d,ee=a[S+H+l],re=a[S+H]*d;s[H]=L*q+k*Z+M*ee+C*re}return s}};const Q2e=new Ta;let eSe=class extends fre{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return Q2e.fromArray(s).normalize().toArray(s),s}};const dh={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Lb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},fX={9728:Sa,9729:Eo,9984:FT,9985:Dy,9986:V0,9987:ou},dX={33071:su,33648:Zy,10497:Bh},sB={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},DF={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...E2e>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},m0={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},tSe={CUBICSPLINE:void 0,LINEAR:hv,STEP:Jy},oB={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function nSe(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new fp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Dh})),n.DefaultMaterial}function P_(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function _m(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function rSe(n,e,t){let r=!1,i=!1,s=!1;for(let h=0,d=e.length;h<d;h++){const m=e[h];if(m.POSITION!==void 0&&(r=!0),m.NORMAL!==void 0&&(i=!0),m.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const a=[],l=[],o=[];for(let h=0,d=e.length;h<d;h++){const m=e[h];if(r){const v=m.POSITION!==void 0?t.getDependency("accessor",m.POSITION):n.attributes.position;a.push(v)}if(i){const v=m.NORMAL!==void 0?t.getDependency("accessor",m.NORMAL):n.attributes.normal;l.push(v)}if(s){const v=m.COLOR_0!==void 0?t.getDependency("accessor",m.COLOR_0):n.attributes.color;o.push(v)}}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(o)]).then(function(h){const d=h[0],m=h[1],v=h[2];return r&&(n.morphAttributes.position=d),i&&(n.morphAttributes.normal=m),s&&(n.morphAttributes.color=v),n.morphTargetsRelative=!0,n})}function iSe(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function sSe(n){let e;const t=n.extensions&&n.extensions[Gi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+aB(t.attributes):e=n.indices+":"+aB(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+aB(n.targets[r]);return e}function aB(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function BF(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function oSe(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const aSe=new Gr;let lSe=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new R2e,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new Kf(this.options.manager):this.textureLoader=new aU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xa(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(a){const l={scene:a[0][i.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:i.asset,parser:r,userData:{}};return P_(s,l,i),_m(l,i),Promise.all(r._invokeAll(function(o){return o.afterRoot&&o.afterRoot(l)})).then(function(){for(const o of l.scenes)o.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const a=t[i].joints;for(let l=0,o=a.length;l<o;l++)e[a[l]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const a=e[i];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(r[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(a,l)=>{const o=this.associations.get(a);o!=null&&this.associations.set(l,o);for(const[h,d]of a.children.entries())s(d,l.children[h])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,a){return r.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Gi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,a){r.load(hu.resolveURL(t.uri,i.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const a=sB[i.type],l=Lb[i.componentType],o=i.normalized===!0,h=new l(i.count*a);return Promise.resolve(new Bi(h,a,o))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(a){const l=a[0],o=sB[i.type],h=Lb[i.componentType],d=h.BYTES_PER_ELEMENT,m=d*o,v=i.byteOffset||0,y=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let E,M;if(y&&y!==m){const C=Math.floor(v/y),L="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+C+":"+i.count;let k=t.cache.get(L);k||(E=new h(l,C*y,i.count*y/d),k=new xw(E,y/d),t.cache.add(L,k)),M=new Xm(k,o,v%y/d,S)}else l===null?E=new h(i.count*o):E=new h(l,v,i.count*o),M=new Bi(E,o,S);if(i.sparse!==void 0){const C=sB.SCALAR,L=Lb[i.sparse.indices.componentType],k=i.sparse.indices.byteOffset||0,H=i.sparse.values.byteOffset||0,q=new L(a[1],k,i.sparse.count*C),Z=new h(a[2],H,i.sparse.count*o);l!==null&&(M=new Bi(M.array.slice(),M.itemSize,M.normalized));for(let ee=0,re=q.length;ee<re;ee++){const se=q[ee];if(M.setX(se,Z[ee*o]),o>=2&&M.setY(se,Z[ee*o+1]),o>=3&&M.setZ(se,Z[ee*o+2]),o>=4&&M.setW(se,Z[ee*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,a=t.images[s];let l=this.textureLoader;if(a.uri){const o=r.manager.getHandler(a.uri);o!==null&&(l=o)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,r){const i=this,s=this.json,a=s.textures[e],l=s.images[t],o=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const h=this.loadImageSource(t,r).then(function(d){d.flipY=!1,d.name=a.name||l.name||"",d.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(d.name=l.uri);const v=(s.samplers||{})[a.sampler]||{};return d.magFilter=fX[v.magFilter]||Eo,d.minFilter=fX[v.minFilter]||ou,d.wrapS=dX[v.wrapS]||Bh,d.wrapT=dX[v.wrapT]||Bh,i.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[o]=h,h}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(m=>m.clone());const a=i.images[e],l=self.URL||self.webkitURL;let o=a.uri||"",h=!1;if(a.bufferView!==void 0)o=r.getDependency("bufferView",a.bufferView).then(function(m){h=!0;const v=new Blob([m],{type:a.mimeType});return o=l.createObjectURL(v),o});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(o).then(function(m){return new Promise(function(v,y){let S=v;t.isImageBitmapLoader===!0&&(S=function(E){const M=new Xs(E);M.needsUpdate=!0,v(M)}),t.load(hu.resolveURL(m,s.path),S,void 0,y)})}).then(function(m){return h===!0&&l.revokeObjectURL(o),_m(m,a),m.userData.mimeType=a.mimeType||oSe(a.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),m});return this.sourceCache[e]=d,d}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(a=a.clone(),a.channel=r.texCoord),s.extensions[Gi.KHR_TEXTURE_TRANSFORM]){const l=r.extensions!==void 0?r.extensions[Gi.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const o=s.associations.get(a);a=s.extensions[Gi.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),s.associations.set(a,o)}}return i!==void 0&&(typeof i=="number"&&(i=i===uX?Sy:Om),"colorSpace"in a?a.colorSpace=i:a.encoding=i===Sy?uX:I2e),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+r.uuid;let o=this.cache.get(l);o||(o=new au,yo.prototype.copy.call(o,r),o.color.copy(r.color),o.map=r.map,o.sizeAttenuation=!1,this.cache.add(l,o)),r=o}else if(e.isLine){const l="LineBasicMaterial:"+r.uuid;let o=this.cache.get(l);o||(o=new Ma,yo.prototype.copy.call(o,r),o.color.copy(r.color),o.map=r.map,this.cache.add(l,o)),r=o}if(i||s||a){let l="ClonedMaterial:"+r.uuid+":";i&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let o=this.cache.get(l);o||(o=r.clone(),s&&(o.vertexColors=!0),a&&(o.flatShading=!0),i&&(o.normalScale&&(o.normalScale.y*=-1),o.clearcoatNormalScale&&(o.clearcoatNormalScale.y*=-1)),this.cache.add(l,o),this.associations.set(o,this.associations.get(r))),r=o}e.material=r}getMaterialType(){return fp}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let a;const l={},o=s.extensions||{},h=[];if(o[Gi.KHR_MATERIALS_UNLIT]){const m=i[Gi.KHR_MATERIALS_UNLIT];a=m.getMaterialType(),h.push(m.extendParams(l,s,t))}else{const m=s.pbrMetallicRoughness||{};if(l.color=new Vn(1,1,1),l.opacity=1,Array.isArray(m.baseColorFactor)){const v=m.baseColorFactor;l.color.setRGB(v[0],v[1],v[2],Om),l.opacity=v[3]}m.baseColorTexture!==void 0&&h.push(t.assignTexture(l,"map",m.baseColorTexture,Sy)),l.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,l.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(l,"metalnessMap",m.metallicRoughnessTexture)),h.push(t.assignTexture(l,"roughnessMap",m.metallicRoughnessTexture))),a=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,l)})))}s.doubleSided===!0&&(l.side=wc);const d=s.alphaMode||oB.OPAQUE;if(d===oB.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,d===oB.MASK&&(l.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==_o&&(h.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new nn(1,1),s.normalTexture.scale!==void 0)){const m=s.normalTexture.scale;l.normalScale.set(m,m)}if(s.occlusionTexture!==void 0&&a!==_o&&(h.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==_o){const m=s.emissiveFactor;l.emissive=new Vn().setRGB(m[0],m[1],m[2],Om)}return s.emissiveTexture!==void 0&&a!==_o&&h.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,Sy)),Promise.all(h).then(function(){const m=new a(l);return s.name&&(m.name=s.name),_m(m,s),t.associations.set(m,{materials:e}),s.extensions&&P_(i,m,s),m})}createUniqueName(e){const t=es.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(l){return r[Gi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(o){return pX(o,l,t)})}const a=[];for(let l=0,o=e.length;l<o;l++){const h=e[l],d=sSe(h),m=i[d];if(m)a.push(m.promise);else{let v;h.extensions&&h.extensions[Gi.KHR_DRACO_MESH_COMPRESSION]?v=s(h):v=pX(new $r,h,t),i[d]={primitive:h,promise:v},a.push(v)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],a=s.primitives,l=[];for(let o=0,h=a.length;o<h;o++){const d=a[o].material===void 0?nSe(this.cache):this.getDependency("material",a[o].material);l.push(d)}return l.push(t.loadGeometries(a)),Promise.all(l).then(function(o){const h=o.slice(0,o.length-1),d=o[o.length-1],m=[];for(let y=0,S=d.length;y<S;y++){const E=d[y],M=a[y];let C;const L=h[y];if(M.mode===dh.TRIANGLES||M.mode===dh.TRIANGLE_STRIP||M.mode===dh.TRIANGLE_FAN||M.mode===void 0)C=s.isSkinnedMesh===!0?new rD(E,L):new Ii(E,L),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),M.mode===dh.TRIANGLE_STRIP?C.geometry=cX(C.geometry,UT):M.mode===dh.TRIANGLE_FAN&&(C.geometry=cX(C.geometry,Qy));else if(M.mode===dh.LINES)C=new fu(E,L);else if(M.mode===dh.LINE_STRIP)C=new Yf(E,L);else if(M.mode===dh.LINE_LOOP)C=new sD(E,L);else if(M.mode===dh.POINTS)C=new Th(E,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(C.geometry.morphAttributes).length>0&&iSe(C,s),C.name=t.createUniqueName(s.name||"mesh_"+e),_m(C,s),M.extensions&&P_(i,C,M),t.assignFinalMaterial(C),m.push(C)}for(let y=0,S=m.length;y<S;y++)t.associations.set(m[y],{meshes:e,primitives:y});if(m.length===1)return s.extensions&&P_(i,m[0],s),m[0];const v=new Xl;s.extensions&&P_(i,v,s),t.associations.set(v,{meshes:e});for(let y=0,S=m.length;y<S;y++)v.add(m[y]);return v})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new ts(no.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new ed(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),_m(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),a=i,l=[],o=[];for(let h=0,d=a.length;h<d;h++){const m=a[h];if(m){l.push(m);const v=new Gr;s!==null&&v.fromArray(s.array,h*16),o.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new bw(l,o)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,a=[],l=[],o=[],h=[],d=[];for(let m=0,v=i.channels.length;m<v;m++){const y=i.channels[m],S=i.samplers[y.sampler],E=y.target,M=E.node,C=i.parameters!==void 0?i.parameters[S.input]:S.input,L=i.parameters!==void 0?i.parameters[S.output]:S.output;E.node!==void 0&&(a.push(this.getDependency("node",M)),l.push(this.getDependency("accessor",C)),o.push(this.getDependency("accessor",L)),h.push(S),d.push(E))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(o),Promise.all(h),Promise.all(d)]).then(function(m){const v=m[0],y=m[1],S=m[2],E=m[3],M=m[4],C=[];for(let L=0,k=v.length;L<k;L++){const H=v[L],q=y[L],Z=S[L],ee=E[L],re=M[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const se=r._createAnimationTracks(H,q,Z,ee,re);if(se)for(let ae=0;ae<se.length;ae++)C.push(se[ae])}return new n1(s,void 0,C)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const a=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&a.traverse(function(l){if(l.isMesh)for(let o=0,h=i.weights.length;o<h;o++)l.morphTargetInfluences[o]=i.weights[o]}),a})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),a=[],l=i.children||[];for(let h=0,d=l.length;h<d;h++)a.push(r.getDependency("node",l[h]));const o=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(a),o]).then(function(h){const d=h[0],m=h[1],v=h[2];v!==null&&d.traverse(function(y){y.isSkinnedMesh&&y.bind(v,aSe)});for(let y=0,S=m.length;y<S;y++)d.add(m[y]);return d})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?i.createUniqueName(s.name):"",l=[],o=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return o&&l.push(o),s.camera!==void 0&&l.push(i.getDependency("camera",s.camera).then(function(h){return i._getNodeRef(i.cameraCache,s.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){l.push(h)}),this.nodeCache[e]=Promise.all(l).then(function(h){let d;if(s.isBone===!0?d=new XT:h.length>1?d=new Xl:h.length===1?d=h[0]:d=new Ri,d!==h[0])for(let m=0,v=h.length;m<v;m++)d.add(h[m]);if(s.name&&(d.userData.name=s.name,d.name=a),_m(d,s),s.extensions&&P_(r,d,s),s.matrix!==void 0){const m=new Gr;m.fromArray(s.matrix),d.applyMatrix4(m)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return i.associations.has(d)||i.associations.set(d,{}),i.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new Xl;r.name&&(s.name=i.createUniqueName(r.name)),_m(s,r),r.extensions&&P_(t,s,r);const a=r.nodes||[],l=[];for(let o=0,h=a.length;o<h;o++)l.push(i.getDependency("node",a[o]));return Promise.all(l).then(function(o){for(let d=0,m=o.length;d<m;d++)s.add(o[d]);const h=d=>{const m=new Map;for(const[v,y]of i.associations)(v instanceof yo||v instanceof Xs)&&m.set(v,y);return d.traverse(v=>{const y=i.associations.get(v);y!=null&&m.set(v,y)}),m};return i.associations=h(s),s})}_createAnimationTracks(e,t,r,i,s){const a=[],l=e.name?e.name:e.uuid,o=[];m0[s.path]===m0.weights?e.traverse(function(v){v.morphTargetInfluences&&o.push(v.name?v.name:v.uuid)}):o.push(l);let h;switch(m0[s.path]){case m0.weights:h=$m;break;case m0.rotation:h=qm;break;case m0.position:case m0.scale:h=Zm;break;default:switch(r.itemSize){case 1:h=$m;break;case 2:case 3:default:h=Zm;break}break}const d=i.interpolation!==void 0?tSe[i.interpolation]:hv,m=this._getArrayFromAccessor(r);for(let v=0,y=o.length;v<y;v++){const S=new h(o[v]+"."+m0[s.path],t.array,m,d);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),a.push(S)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=BF(t.constructor),i=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof qm?eSe:fre;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function cSe(n,e,t){const r=e.attributes,i=new Sl;if(r.POSITION!==void 0){const l=t.json.accessors[r.POSITION],o=l.min,h=l.max;if(o!==void 0&&h!==void 0){if(i.set(new Ze(o[0],o[1],o[2]),new Ze(h[0],h[1],h[2])),l.normalized){const d=BF(Lb[l.componentType]);i.min.multiplyScalar(d),i.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const l=new Ze,o=new Ze;for(let h=0,d=s.length;h<d;h++){const m=s[h];if(m.POSITION!==void 0){const v=t.json.accessors[m.POSITION],y=v.min,S=v.max;if(y!==void 0&&S!==void 0){if(o.setX(Math.max(Math.abs(y[0]),Math.abs(S[0]))),o.setY(Math.max(Math.abs(y[1]),Math.abs(S[1]))),o.setZ(Math.max(Math.abs(y[2]),Math.abs(S[2]))),v.normalized){const E=BF(Lb[v.componentType]);o.multiplyScalar(E)}l.max(o)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(l)}n.boundingBox=i;const a=new il;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=a}function pX(n,e,t){const r=e.attributes,i=[];function s(a,l){return t.getDependency("accessor",a).then(function(o){n.setAttribute(l,o)})}for(const a in r){const l=DF[a]||a.toLowerCase();l in n.attributes||i.push(s(r[a],l))}if(e.indices!==void 0&&!n.index){const a=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});i.push(a)}return _m(n,e),cSe(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?rSe(n,e.targets,t):n})}const lB=new WeakMap;let uSe=class extends Ia{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Xa(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{const l={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,l).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const o in t.attributeTypes){const h=t.attributeTypes[o];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[o]=h.name)}const r=JSON.stringify(t);if(lB.has(e)){const o=lB.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,a=e.byteLength,l=this._getWorker(s,a).then(o=>(i=o,new Promise((h,d)=>{i._callbacks[s]={resolve:h,reject:d},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return l.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),lB.set(e,{key:r,promise:l}),l}_createGeometry(e){const t=new $r;e.index&&t.setIndex(new Bi(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,a=i.array,l=i.itemSize;t.setAttribute(s,new Bi(a,l))}return t}_loadLibrary(e,t){const r=new Xa(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=hSe.toString(),a=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const a=s.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function hSe(){let n,e;onmessage=function(a){const l=a.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(d){n.onModuleLoaded=function(m){d({draco:m})},DracoDecoderModule(n)});break;case"decode":const o=l.buffer,h=l.taskConfig;e.then(d=>{const m=d.draco,v=new m.Decoder,y=new m.DecoderBuffer;y.Init(new Int8Array(o),o.byteLength);try{const S=t(m,v,y,h),E=S.attributes.map(M=>M.array.buffer);S.index&&E.push(S.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:S},E)}catch(S){console.error(S),self.postMessage({type:"error",id:l.id,error:S.message})}finally{m.destroy(y),m.destroy(v)}});break}};function t(a,l,o,h){const d=h.attributeIDs,m=h.attributeTypes;let v,y;const S=l.GetEncodedGeometryType(o);if(S===a.TRIANGULAR_MESH)v=new a.Mesh,y=l.DecodeBufferToMesh(o,v);else if(S===a.POINT_CLOUD)v=new a.PointCloud,y=l.DecodeBufferToPointCloud(o,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const E={index:null,attributes:[]};for(const M in d){const C=self[m[M]];let L,k;if(h.useUniqueIDs)k=d[M],L=l.GetAttributeByUniqueId(v,k);else{if(k=l.GetAttributeId(v,a[d[M]]),k===-1)continue;L=l.GetAttribute(v,k)}E.attributes.push(i(a,l,v,M,C,L))}return S===a.TRIANGULAR_MESH&&(E.index=r(a,l,v)),a.destroy(v),E}function r(a,l,o){const d=o.num_faces()*3,m=d*4,v=a._malloc(m);l.GetTrianglesUInt32Array(o,m,v);const y=new Uint32Array(a.HEAPF32.buffer,v,d).slice();return a._free(v),{array:y,itemSize:1}}function i(a,l,o,h,d,m){const v=m.num_components(),S=o.num_points()*v,E=S*d.BYTES_PER_ELEMENT,M=s(a,d),C=a._malloc(E);l.GetAttributeDataArrayForAllPoints(o,m,M,E,C);const L=new d(a.HEAPF32.buffer,C,S).slice();return a._free(C),{name:h,array:L,itemSize:v}}function s(a,l){switch(l){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let bE;const cB=()=>{if(bE)return bE;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=n;WebAssembly.validate(t)&&(i=e);let s;const a=WebAssembly.instantiate(l(i),{}).then(m=>{s=m.instance,s.exports.__wasm_call_ctors()});function l(m){const v=new Uint8Array(m.length);for(let S=0;S<m.length;++S){const E=m.charCodeAt(S);v[S]=E>96?E-71:E>64?E-65:E>47?E+4:E>46?63:62}let y=0;for(let S=0;S<m.length;++S)v[y++]=v[S]<60?r[v[S]]:(v[S]-60)*64+v[++S];return v.buffer.slice(0,y)}function o(m,v,y,S,E,M){const C=s.exports.sbrk,L=y+3&-4,k=C(L*S),H=C(E.length),q=new Uint8Array(s.exports.memory.buffer);q.set(E,H);const Z=m(k,y,S,H,E.length);if(Z===0&&M&&M(k,L,S),v.set(q.subarray(k,k+y*S)),C(k-C(0)),Z!==0)throw new Error(`Malformed buffer data: ${Z}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},d={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return bE={ready:a,supported:!0,decodeVertexBuffer(m,v,y,S,E){o(s.exports.meshopt_decodeVertexBuffer,m,v,y,S,s.exports[h[E]])},decodeIndexBuffer(m,v,y,S){o(s.exports.meshopt_decodeIndexBuffer,m,v,y,S)},decodeIndexSequence(m,v,y,S){o(s.exports.meshopt_decodeIndexSequence,m,v,y,S)},decodeGltfBuffer(m,v,y,S,E,M){o(s.exports[d[E]],m,v,y,S,s.exports[h[M]])}},bE};let wE=null,dre="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function pre(n,e,t){return r=>{t&&t(r),n&&(wE||(wE=new uSe),wE.setDecoderPath(typeof n=="string"?n:dre),r.setDRACOLoader(wE)),e&&r.setMeshoptDecoder(typeof cB=="function"?cB():cB)}}function rg(n,e=!0,t=!0,r){return tM(mU,n,pre(e,t,r))}rg.preload=(n,e=!0,t=!0,r)=>tM.preload(mU,n,pre(e,t,r));rg.clear=n=>tM.clear(mU,n);rg.setDecoderPath=n=>{dre=n};function gU(n,e){const t=Ae.useRef(),[r]=Ae.useState(()=>e?e instanceof Ri?{current:e}:e:t),[i]=Ae.useState(()=>new One(void 0));Ae.useLayoutEffect(()=>{e&&(r.current=e instanceof Ri?e:e.current),i._root=r.current});const s=Ae.useRef({}),a=Ae.useMemo(()=>{const l={};return n.forEach(o=>Object.defineProperty(l,o.name,{enumerable:!0,get(){if(r.current)return s.current[o.name]||(s.current[o.name]=i.clipAction(o,r.current))},configurable:!0})),{ref:r,clips:n,actions:l,names:n.map(o=>o.name),mixer:i}},[n]);return eM((l,o)=>i.update(o)),Ae.useEffect(()=>{const l=r.current;return()=>{s.current={},i.stopAllAction(),Object.values(a.actions).forEach(o=>{l&&i.uncacheAction(o,l)})}},[n]),a}var mre={exports:{}},fSe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",dSe=fSe,pSe=dSe;function gre(){}function vre(){}vre.resetWarningCache=gre;var mSe=function(){function n(r,i,s,a,l,o){if(o!==pSe){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:vre,resetWarningCache:gre};return t.PropTypes=t,t};mre.exports=mSe();var _re=mre.exports;const vU=()=>me.jsx(C2e,{children:me.jsx("div",{className:"flex justify-center items-center ",children:me.jsx("div",{className:"w-20 h-20 border-4 border-opacity-20 border-blue-500 border-t-indigo-800 rounded-full animate-spin"})})}),gSe=()=>me.jsxs("header",{className:"header",children:[me.jsx(MC,{to:"/",className:"w-10 h-10 rounded-lg bg-white items-center justify-center flex font-bold shadow-md",children:me.jsx("p",{className:"blue-gradient_text",children:"AH"})}),me.jsxs("nav",{className:"flex text-lg gap-7 font-medium shadow-text",children:[me.jsx(MC,{to:"/about",className:({isActive:n})=>n?"text-blue-500":"text-black",children:"About"}),me.jsx(MC,{to:"/projects",className:({isActive:n})=>n?"text-blue-500":"text-black",children:"Projects"}),me.jsx(MC,{to:"/arts",className:({isActive:n})=>n?"text-blue-500":"text-black",children:"Gallery"})]})]}),vSe="data:image/svg+xml,%3csvg%20width='50'%20height='50'%20viewBox='0%200%2050%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.03125%2044.9219L2.92969%200H46.9727L42.9688%2044.9219L25%2050'%20fill='%23264DE4'/%3e%3cpath%20d='M25%203.61328V46.0938L39.5508%2042.0898L42.9688%203.61328'%20fill='%232965F1'/%3e%3cpath%20d='M11.1328%209.17969H25V14.6484H11.6211M12.1094%2020.3125H25V25.8789H12.5977M12.8906%2028.6133H18.3594L18.75%2033.0078L25%2034.668V40.4297L13.5742%2037.3047'%20fill='%23EBEBEB'/%3e%3cpath%20d='M25%2020.3125V25.8789H31.7383L31.0547%2033.0078L25%2034.668V40.4297L36.2305%2037.3047L38.7695%209.17969H25V14.6484H32.8125L32.2754%2020.3125H25Z'%20fill='white'/%3e%3c/svg%3e",_Se="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M49%2038.2998C47.254%2038.7303%2046.174%2038.3187%2045.205%2036.908L38.314%2027.6642L37.318%2026.3844L29.2705%2036.9385C28.351%2038.2082%2027.3865%2038.7608%2025.6705%2038.3114L35.9755%2024.8995L26.3815%2012.7849C28.0315%2012.4737%2029.1715%2012.6322%2030.184%2014.0647L37.3315%2023.4234L44.5315%2014.1156C45.454%2012.846%2046.4455%2012.3632%2048.1015%2012.8315L44.3815%2017.6133L39.3415%2023.976C38.7415%2024.7032%2038.824%2025.2006%2039.376%2025.903L49%2038.2998ZM1.012%2024.6756L1.855%2020.6558C4.15%2012.7006%2013.555%209.39485%2020.041%2014.3105C23.8315%2017.2017%2024.7735%2021.2913%2024.586%2025.8725H3.22C2.899%2034.1186%209.0205%2039.0953%2016.825%2036.5561C19.5625%2035.6645%2021.175%2033.5863%2021.982%2030.9859C22.3915%2029.6829%2023.0695%2029.4792%2024.3325%2029.8516C23.6875%2033.1035%2022.2325%2035.8202%2019.1575%2037.5203C14.563%2040.0654%208.005%2039.2422%204.555%2035.7053C2.5%2033.6532%201.651%2031.0528%201.27%2028.2721C1.21%2027.8126%201.09%2027.3748%201%2026.9342C1.008%2026.1818%201.012%2025.4294%201.012%2024.677V24.6756ZM3.259%2024.1229H22.567C22.441%2018.1601%2018.6115%2013.9251%2013.378%2013.8888C7.633%2013.8451%203.508%2017.9798%203.259%2024.1229Z'%20fill='black'/%3e%3c/svg%3e",ySe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21476)'%3e%3cpath%20d='M2.04529%2027.5236C0.651571%2026.1298%200.651571%2023.8702%202.04529%2022.4764L23.4764%201.04529C24.8702%20-0.348429%2027.1298%20-0.348429%2028.5236%201.04529L49.9547%2022.4764C51.3484%2023.8702%2051.3484%2026.1298%2049.9547%2027.5236L28.5236%2048.9547C27.1298%2050.3484%2024.8702%2050.3484%2023.4764%2048.9547L2.04529%2027.5236Z'%20fill='%23EE513B'/%3e%3cpath%20d='M19.1342%205L17%207.17115L22.5122%2012.7787C22.2892%2013.2653%2022.1647%2013.8081%2022.1647%2014.3805C22.1647%2016.0054%2023.1683%2017.3919%2024.5793%2017.9334V31.6509C23.1683%2032.1923%2022.1647%2033.5788%2022.1647%2035.2038C22.1647%2037.3004%2023.8354%2039%2025.8963%2039C27.9573%2039%2029.628%2037.3004%2029.628%2035.2038C29.628%2033.7307%2028.8032%2032.4533%2027.5976%2031.8242V17.9521L32.8668%2023.3124C32.6546%2023.7892%2032.5366%2024.3185%2032.5366%2024.8759C32.5366%2026.9725%2034.2074%2028.6721%2036.2683%2028.6721C38.3293%2028.6721%2040%2026.9725%2040%2024.8759C40%2022.7793%2038.3293%2021.0797%2036.2683%2021.0797C35.8678%2021.0797%2035.4821%2021.1438%2035.1204%2021.2626L29.4614%2015.5058C29.5697%2015.1503%2029.628%2014.7722%2029.628%2014.3805C29.628%2012.2839%2027.9573%2010.5842%2025.8963%2010.5842C25.5112%2010.5842%2025.1398%2010.6436%2024.7902%2010.7538L19.1342%205Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21476'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.820312)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",xSe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21481)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M25.557%200.520996C11.7523%200.520996%200.558594%2011.7575%200.558594%2025.6216C0.558594%2036.7092%207.72108%2046.1167%2017.657%2049.436C18.907%2049.6666%2019.3633%2048.8916%2019.3633%2048.2265C19.3633%2047.6304%2019.3414%2046.0523%2019.3289%2043.9581C12.3742%2045.4751%2010.907%2040.5933%2010.907%2040.5933C9.7711%2037.6944%208.13204%2036.9226%208.13204%2036.9226C5.86173%2035.3648%208.30389%2035.3962%208.30389%2035.3962C10.8117%2035.5734%2012.132%2037.983%2012.132%2037.983C14.3633%2041.8184%2017.9836%2040.7109%2019.4086%2040.0678C19.6352%2038.4457%2020.282%2037.3398%2020.9961%2036.7124C15.4445%2036.0786%209.60858%2033.9263%209.60858%2024.3087C9.60858%2021.5682%2010.582%2019.3281%2012.182%2017.5727C11.9242%2016.9374%2011.0664%2014.3867%2012.4258%2010.9309C12.4258%2010.9309%2014.5258%2010.2563%2019.3008%2013.5035C21.2961%2012.9466%2023.4336%2012.6689%2025.5602%2012.658C27.6836%2012.6689%2029.8227%2012.9466%2031.8195%2013.5035C36.5914%2010.2563%2038.6867%2010.9309%2038.6867%2010.9309C40.0508%2014.3867%2039.193%2016.9374%2038.9351%2017.5727C40.5383%2019.3281%2041.5055%2021.5682%2041.5055%2024.3087C41.5055%2033.9499%2035.6602%2036.0723%2030.0914%2036.6935C30.9883%2037.4684%2031.7883%2038.9995%2031.7883%2041.3416C31.7883%2044.697%2031.757%2047.403%2031.757%2048.2265C31.757%2048.8979%2032.2071%2049.6791%2033.4758%2049.4329C43.4024%2046.1072%2050.5586%2036.706%2050.5586%2025.6216C50.5586%2011.7575%2039.3648%200.520996%2025.557%200.520996Z'%20fill='black'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21481'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.558594)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",bSe="data:image/svg+xml,%3csvg%20width='50'%20height='50'%20viewBox='0%200%2050%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.93359%2044.9219L2.92969%200H46.9727L42.9688%2044.9219L24.9023%2050'%20fill='%23E34F26'/%3e%3cpath%20d='M25%2046.0938L39.5508%2042.0898L42.9688%203.61328H25'%20fill='%23EF652A'/%3e%3cpath%20d='M25%2020.3125H17.6758L17.1875%2014.6484H25V9.17969H11.1328L12.5977%2025.8789H25V20.3125ZM24.9023%2034.668L18.75%2033.0078L18.3594%2028.6133H12.8906L13.5742%2037.3047L24.9023%2040.4297V34.668Z'%20fill='%23EBEBEB'/%3e%3cpath%20d='M24.9023%2020.3125V25.8789H31.7383L31.0547%2033.0078L24.9023%2034.668V40.4297L36.2305%2037.3047L37.793%2020.3125H24.9023ZM24.9023%209.17969V14.6484H38.2812L38.7695%209.17969H24.9023Z'%20fill='white'/%3e%3c/svg%3e",wSe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21409)'%3e%3cpath%20d='M43%200H8C3.85786%200%200.5%203.35786%200.5%207.5V42.5C0.5%2046.6421%203.85786%2050%208%2050H43C47.1421%2050%2050.5%2046.6421%2050.5%2042.5V7.5C50.5%203.35786%2047.1421%200%2043%200Z'%20fill='%23F0DB4F'/%3e%3cpath%20d='M32.1406%2036.1328C33.1172%2037.793%2034.4844%2038.9648%2036.7305%2038.9648C38.6836%2038.9648%2039.9531%2037.9883%2039.9531%2036.6211C39.9531%2035.0586%2038.6836%2034.4727%2036.5352%2033.4961L35.3633%2033.0078C31.9453%2031.543%2029.6992%2029.7852%2029.6992%2025.9766C29.6992%2022.4609%2032.3359%2019.7266%2036.5352%2019.7266C39.5625%2019.7266%2041.7109%2020.8008%2043.1758%2023.5352L39.5625%2025.8789C38.7812%2024.4141%2037.9023%2023.8281%2036.5352%2023.8281C35.168%2023.8281%2034.2891%2024.707%2034.2891%2025.8789C34.2891%2027.2461%2035.168%2027.832%2037.2188%2028.7109L38.3906%2029.1992C42.3945%2030.957%2044.6406%2032.6172%2044.6406%2036.6211C44.6406%2040.8203%2041.3203%2043.1641%2036.8281%2043.1641C32.4336%2043.1641%2029.6016%2041.1133%2028.2344%2038.3789L32.1406%2036.1328ZM15.5391%2036.5234C16.3203%2037.793%2016.9062%2038.9648%2018.5664%2038.9648C20.1289%2038.9648%2021.1055%2038.3789%2021.1055%2036.0352V19.8242H25.793V35.8398C25.793%2040.7227%2022.9609%2042.8711%2018.7617%2042.8711C14.9531%2042.8711%2012.8047%2040.918%2011.7305%2038.5742L15.5391%2036.5234Z'%20fill='%23323330'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21409'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.5)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",SSe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21496)'%3e%3cpath%20d='M25.7715%2050C39.5786%2050%2050.7715%2038.8071%2050.7715%2025C50.7715%2011.1929%2039.5786%200%2025.7715%200C11.9644%200%200.771484%2011.1929%200.771484%2025C0.771484%2038.8071%2011.9644%2050%2025.7715%2050Z'%20fill='%2313AA52'/%3e%3cpath%20d='M32.4546%2021.9453C30.8755%2014.9761%2027.1436%2012.6846%2026.7417%2011.8091C26.3023%2011.1914%2025.857%2010.0928%2025.857%2010.0928C25.8497%2010.0742%2025.8379%2010.0415%2025.8243%2010.0098C25.7789%2010.6274%2025.7554%2010.8657%2025.1714%2011.4888C24.2671%2012.1958%2019.6275%2016.0889%2019.2501%2024.0068C18.898%2031.3916%2024.5845%2035.792%2025.3536%2036.353L25.441%2036.415V36.4097C25.4459%2036.4468%2025.6851%2038.1675%2025.8531%2039.9907H26.4556C26.597%2038.7019%2026.8089%2037.4219%2027.0904%2036.1562L27.1392%2036.1245C27.4832%2035.8779%2027.8112%2035.6096%2028.1211%2035.3213L28.1563%2035.2896C29.7911%2033.7793%2032.73%2030.2861%2032.7012%2024.7168C32.6951%2023.7878%2032.6127%2022.8608%2032.4546%2021.9453ZM25.7891%2032.1836C25.7891%2032.1836%2025.7891%2021.8262%2026.1309%2021.8281C26.3975%2021.8281%2026.7427%2035.188%2026.7427%2035.188C26.2681%2035.1309%2025.7891%2032.9893%2025.7891%2032.1836Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21496'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.771484)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",ASe="data:image/svg+xml,%3csvg%20width='50'%20height='50'%20viewBox='0%200%2050%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21469)'%3e%3cpath%20d='M50%200V25L25%2050L12.5%2037.5L25%2025L50%200Z'%20fill='%2359529D'/%3e%3cpath%20d='M50%2025V50L37.5%2037.5L50%2025Z'%20fill='%235271B4'/%3e%3cpath%20d='M25%2025L0%2050V0L25%2025Z'%20fill='%23BB4B96'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21469'%3e%3crect%20width='50'%20height='50'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",TSe="data:image/svg+xml,%3csvg%20width='50'%20height='50'%20viewBox='0%200%2050%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0%2026.7281V5.07812L18.75%2015.9031V23.1198L6.25%2015.9031V30.3365L0%2026.7281Z'%20fill='%2300B0FF'/%3e%3cpath%20d='M18.75%2015.9031L37.5%205.07812V26.7281L25%2033.9448L18.75%2030.3365L31.25%2023.1198V15.9031L18.75%2023.1198V15.9031Z'%20fill='%230081CB'/%3e%3cpath%20d='M18.75%2030.3364V37.5531L31.25%2044.7698V37.5531L18.75%2030.3364Z'%20fill='%2300B0FF'/%3e%3cpath%20d='M31.25%2044.7698L50%2033.9448V19.5115L43.75%2023.1198V30.3365L31.25%2037.5531V44.7698ZM43.75%2015.9031V8.68646L50%205.07812V12.2948L43.75%2015.9031Z'%20fill='%230081CB'/%3e%3c/svg%3e",MSe="data:image/svg+xml,%3csvg%20width='50'%20height='50'%20viewBox='0%200%2050%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0_1479_21424'%20style='mask-type:alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='50'%20height='50'%3e%3cpath%20d='M25%2050C38.8071%2050%2050%2038.8071%2050%2025C50%2011.1929%2038.8071%200%2025%200C11.1929%200%200%2011.1929%200%2025C0%2038.8071%2011.1929%2050%2025%2050Z'%20fill='black'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_1479_21424)'%3e%3cpath%20d='M25%2050C38.8071%2050%2050%2038.8071%2050%2025C50%2011.1929%2038.8071%200%2025%200C11.1929%200%200%2011.1929%200%2025C0%2038.8071%2011.1929%2050%2025%2050Z'%20fill='%23192333'/%3e%3cpath%20d='M41.53%2043.7556L19.2061%2015H15V34.9917H18.3649V19.2732L38.8886%2045.7903C39.8147%2045.1706%2040.6969%2044.4903%2041.53%2043.7556Z'%20fill='url(%23paint0_linear_1479_21424)'/%3e%3cpath%20d='M35.2786%2015H31.9453V35H35.2786V15Z'%20fill='url(%23paint1_linear_1479_21424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1479_21424'%20x1='30.2778'%20y1='32.3611'%20x2='40.1389'%20y2='44.5833'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='white'/%3e%3cstop%20offset='1'%20stop-color='white'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_1479_21424'%20x1='33.612'%20y1='15'%20x2='33.5561'%20y2='29.6875'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='white'/%3e%3cstop%20offset='1'%20stop-color='white'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",CSe="data:image/svg+xml,%3csvg%20width='45'%20height='50'%20viewBox='0%200%2045%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22.2977%2049.9072C21.6099%2049.9072%2020.968%2049.7238%2020.372%2049.4029L14.274%2045.7808C13.357%2045.2764%2013.8155%2045.093%2014.0906%2045.0013C15.3285%2044.5887%2015.5578%2044.497%2016.8416%2043.7634C16.9791%2043.6717%2017.1625%2043.7175%2017.3001%2043.8092L21.9767%2046.6061C22.1601%2046.6978%2022.3894%2046.6978%2022.5269%2046.6061L40.8209%2036.0148C41.0043%2035.9231%2041.096%2035.7397%2041.096%2035.5105V14.3738C41.096%2014.1446%2041.0043%2013.9612%2040.8209%2013.8695L22.5269%203.32409C22.3435%203.23239%2022.1143%203.23239%2021.9767%203.32409L3.68276%2013.8695C3.49936%2013.9612%203.40766%2014.1904%203.40766%2014.3738V35.5105C3.40766%2035.6939%203.49936%2035.9231%203.68276%2036.0148L8.68036%2038.9033C11.3855%2040.2788%2013.0819%2038.6741%2013.0819%2037.0694V16.2078C13.0819%2015.9327%2013.3112%2015.6576%2013.6321%2015.6576H15.9704C16.2455%2015.6576%2016.5206%2015.8869%2016.5206%2016.2078V37.0694C16.5206%2040.6915%2014.5491%2042.8005%2011.1104%2042.8005C10.0558%2042.8005%209.23055%2042.8005%206.89223%2041.6543L2.07802%2038.9033C0.885936%2038.2156%200.152344%2036.9318%200.152344%2035.5563V14.4197C0.152344%2013.0442%200.885936%2011.7604%202.07802%2011.0727L20.372%200.48142C21.5182%20-0.160473%2023.0771%20-0.160473%2024.2234%200.48142L42.5173%2011.0727C43.7094%2011.7604%2044.443%2013.0442%2044.443%2014.4197V35.5563C44.443%2036.9318%2043.7094%2038.2156%2042.5173%2038.9033L24.2234%2049.4946C23.6273%2049.7697%2022.9396%2049.9072%2022.2977%2049.9072ZM27.9372%2035.3729C19.9135%2035.3729%2018.2629%2031.705%2018.2629%2028.5872C18.2629%2028.3121%2018.4922%2028.037%2018.8131%2028.037H21.1973C21.4724%2028.037%2021.7016%2028.2204%2021.7016%2028.4955C22.0684%2030.9255%2023.123%2032.1176%2027.983%2032.1176C31.8344%2032.1176%2033.485%2031.2465%2033.485%2029.1832C33.485%2027.9911%2033.0265%2027.12%2027.0202%2026.524C22.0226%2026.0196%2018.9048%2024.9192%2018.9048%2020.9303C18.9048%2017.2165%2022.0226%2015.0157%2027.2494%2015.0157C33.1182%2015.0157%2036.0067%2017.0331%2036.3735%2021.4347C36.3735%2021.5722%2036.3276%2021.7098%2036.2359%2021.8473C36.1442%2021.939%2036.0067%2022.0307%2035.8691%2022.0307H33.485C33.2557%2022.0307%2033.0265%2021.8473%2032.9806%2021.6181C32.4304%2019.0963%2031.0091%2018.271%2027.2494%2018.271C23.0313%2018.271%2022.5269%2019.7382%2022.5269%2020.8386C22.5269%2022.1683%2023.123%2022.5809%2028.8083%2023.3145C34.4478%2024.0481%2037.1071%2025.1026%2037.1071%2029.0457C37.0612%2033.0804%2033.7601%2035.3729%2027.9372%2035.3729Z'%20fill='%23539E43'/%3e%3c/svg%3e",ESe="data:image/svg+xml,%3csvg%20width='81'%20height='80'%20viewBox='0%200%2081%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21414)'%3e%3cpath%20d='M45.458%2041.5776C46.4212%2038.9707%2045.0226%2036.0517%2042.3335%2035.0581C39.6448%2034.0647%2036.6839%2035.3729%2035.7207%2037.9798C34.7574%2040.5871%2036.1565%2043.506%2038.8452%2044.4994C41.5342%2045.493%2044.4947%2044.1848%2045.458%2041.5776Z'%20fill='%2353C1DE'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M59.6393%2036.8569C62.1641%2033.1859%2066.232%2026.1515%2062.6171%2021.9214C59.0193%2017.7103%2051.3231%2020.3888%2047.1296%2022.154C45.0896%2018.1187%2040.8104%2011.0391%2035.3144%2011.9121C29.8415%2012.7815%2028.5099%2020.6853%2028.0547%2025.1499C23.3961%2024.752%2015.221%2024.5819%2013.3277%2029.7061C11.4398%2034.8158%2017.6725%2040.2198%2021.4461%2042.9362C18.8768%2046.6453%2014.8585%2053.4365%2018.4592%2057.652C22.0844%2061.8945%2029.8773%2059.4062%2034.1115%2057.6197C36.1635%2061.7121%2040.2513%2068.6252%2045.7274%2067.7553C51.2207%2066.8827%2052.774%2059.0337%2053.2378%2054.5454C57.7432%2054.885%2065.9859%2054.8969%2067.8502%2049.851C69.7253%2044.7761%2063.3722%2039.5552%2059.6393%2036.8569ZM53.4062%2052.1383C53.4986%2049.7653%2053.3994%2047.1688%2053.1197%2044.4212C55.0466%2042.5513%2056.7633%2040.6588%2058.2117%2038.8023C60.9457%2040.7872%2066.9143%2045.2201%2065.5212%2048.9905C64.115%2052.7964%2056.9614%2052.402%2053.4062%2052.1383ZM45.2824%2065.3697C41.1967%2066.0185%2037.8496%2059.6152%2036.3318%2056.5991C38.4703%2055.5375%2040.7055%2054.2107%2042.9811%2052.661C45.7008%2053.4083%2048.3278%2053.9576%2050.7731%2054.2858C50.4413%2057.4592%2049.3862%2064.7177%2045.2824%2065.3697ZM20.3459%2056.1254C17.6606%2052.9828%2021.6084%2047.0564%2023.5%2044.3238C25.5561%2045.628%2027.901%2046.886%2030.4664%2048.0699C31.2143%2050.6853%2032.0952%2053.1607%2033.0751%2055.4057C30.4265%2056.5238%2023.0437%2059.2825%2020.3459%2056.1254ZM15.6567%2030.5667C17.0682%2026.7466%2024.4399%2027.2588%2027.8765%2027.5563C27.7639%2029.96%2027.8276%2032.5405%2028.067%2035.2146C26.1199%2037.1192%2024.3678%2039.0692%2022.8747%2040.9918C20.2045%2039.0667%2014.2445%2034.389%2015.6567%2030.5667ZM35.7592%2014.2977C39.862%2013.6461%2043.4186%2020.239%2044.902%2023.163C42.7088%2024.2269%2040.4497%2025.5261%2038.1983%2027.0198C35.549%2026.3028%2032.9576%2025.7659%2030.5178%2025.4279C30.8859%2021.8274%2031.6608%2014.9486%2035.7592%2014.2977ZM51.5018%2034.7248C53.1628%2035.5804%2054.7249%2036.4794%2056.1619%2037.404C55.1526%2038.6905%2054.0029%2040.001%2052.7349%2041.3113C52.4147%2039.1027%2052.0074%2036.9038%2051.5018%2034.7248ZM45.9385%2025.3801C46.5958%2026.9054%2047.2062%2028.563%2047.7595%2030.3211C45.649%2029.4294%2043.4988%2028.6345%2041.3159%2027.9387C42.8757%2026.9757%2044.4257%2026.1185%2045.9385%2025.3801ZM30.3849%2033.0516C30.2829%2031.2413%2030.2692%2029.4933%2030.3425%2027.8372C32.0228%2028.0745%2033.7838%2028.4116%2035.5895%2028.8408C33.7866%2030.1626%2032.0496%2031.5683%2030.3849%2033.0516ZM29.6689%2045.0176C27.9548%2044.1647%2026.3675%2043.2806%2024.9336%2042.3778C25.9718%2041.0486%2027.1437%2039.7012%2028.4252%2038.3638C28.7319%2040.5974%2029.1476%2042.8183%2029.6689%2045.0176ZM35.297%2054.3797C34.6199%2052.8169%2033.9907%2051.1325%2033.423%2049.3612C35.5517%2050.2411%2037.7149%2051.0406%2039.9084%2051.7449C38.3297%2052.7516%2036.7849%2053.6348%2035.297%2054.3797ZM50.8253%2046.548C50.959%2048.4279%2050.9976%2050.2129%2050.9381%2051.8748C49.2279%2051.6405%2047.4171%2051.2916%2045.5415%2050.8363C47.3633%2049.4795%2049.1298%2048.052%2050.8253%2046.548ZM42.4809%2050.0166C39.0937%2049.0251%2035.7715%2047.7948%2032.5445%2046.3666C31.6496%2043.0143%2031.0116%2039.6007%2030.6416%2036.165C33.1475%2033.7986%2035.8375%2031.6209%2038.6866%2029.6567C42.0822%2030.636%2045.4089%2031.8643%2048.6246%2033.3303C49.4962%2036.669%2050.1242%2040.0644%2050.5324%2043.4777C48.0113%2045.8367%2045.3104%2048.0168%2042.4809%2050.0166ZM60.7309%2023.4479C63.4277%2026.6047%2059.4203%2032.7969%2057.593%2035.4583C55.518%2034.1164%2053.2008%2032.8322%2050.7156%2031.648C49.9815%2029.026%2049.1242%2026.5718%2048.1674%2024.3682C51.2411%2023.0767%2058.0602%2020.3219%2060.7309%2023.4479Z'%20fill='%2353C1DE'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21414'%3e%3crect%20width='62'%20height='62'%20fill='white'%20transform='translate(22.2383)%20rotate(20.2782)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",ISe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M34.4442%2033.6812C36.1741%2033.5051%2037.4864%2032.039%2037.4267%2030.2795C37.3672%2028.5202%2035.8758%2027.1127%2034.0863%2027.1127H33.967C32.1177%2027.1713%2030.6863%2028.6962%2030.7459%2030.5142C30.8056%2031.3938%2031.1634%2032.1562%2031.7003%2032.684C29.6722%2036.6134%2026.5703%2039.487%2021.9177%2041.8915C18.7561%2043.5335%2015.4755%2044.1201%2012.1948%2043.7096C9.51044%2043.3577%207.42267%2042.1849%206.11017%2040.2493C4.20147%2037.3757%204.02258%2034.2674%205.63317%2031.1593C6.76659%2028.9307%208.5559%2027.2885%209.68933%2026.4674C9.45075%2025.7051%209.09276%2024.4149%208.91387%2023.4767C0.264523%2029.6345%201.15936%2037.9623%203.784%2041.8915C5.75237%2044.8238%209.74901%2046.642%2014.1631%2046.642C15.3561%2046.642%2016.5491%2046.5245%2017.7422%2046.2315C25.3775%2044.7652%2031.1636%2040.3081%2034.4442%2033.6812ZM44.9428%2026.409C40.4094%2021.1895%2033.7284%2018.3159%2026.0931%2018.3159H25.1389C24.602%2017.2602%2023.4686%2016.5563%2022.2159%2016.5563H22.0966C20.2475%2016.6151%2018.8161%2018.1398%2018.8756%2019.9579C18.9353%2021.7173%2020.4264%2023.1248%2022.2159%2023.1248H22.3352C23.6475%2023.0662%2024.7809%2022.2451%2025.2581%2021.1307H26.3317C30.8653%2021.1307%2035.16%2022.4209%2039.0375%2024.9427C42.0198%2026.8781%2044.1673%2029.3999%2045.3603%2032.4495C46.3744%2034.9126%2046.3147%2037.3171%2045.2409%2039.3698C43.5708%2042.4779%2040.7673%2044.1787%2037.0689%2044.1787C34.6828%2044.1787%2032.4163%2043.4749%2031.2231%2042.9471C30.567%2043.5335%2029.3739%2044.4718%2028.5387%2045.0585C31.1039%2046.2313%2033.7284%2046.8765%2036.2337%2046.8765C41.9602%2046.8765%2046.1955%2043.7681%2047.8061%2040.6599C49.5358%2037.2584%2049.4164%2031.3938%2044.9428%2026.409ZM14.6403%2034.6779C14.7%2036.4373%2016.1912%2037.8446%2017.9808%2037.8446H18.1002C19.9492%2037.7862%2021.3808%2036.2613%2021.3211%2034.4434C21.2616%2032.6838%2019.7702%2031.2765%2017.9808%2031.2765H17.8616C17.7422%2031.2765%2017.5631%2031.2765%2017.4441%2031.3349C14.9983%2027.3471%2013.9842%2023.0074%2014.3422%2018.3157C14.5806%2014.7969%2015.7737%2011.7472%2017.8616%209.2254C19.5912%207.05548%2022.9317%205.99987%2025.1986%205.94137C31.5214%205.824%2034.2055%2013.5652%2034.3845%2016.6735C35.16%2016.8495%2036.4723%2017.2601%2037.3672%2017.5534C36.6512%208.05278%2030.6862%203.12646%2024.96%203.12646C19.5912%203.12646%2014.6403%206.93848%2012.6717%2012.5685C9.92792%2020.0751%2011.7174%2027.2885%2015.0578%2032.9773C14.7597%2033.3877%2014.5806%2034.0327%2014.6403%2034.6779Z'%20fill='%23764ABC'/%3e%3c/svg%3e",RSe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21452)'%3e%3cpath%20d='M42.5918%200H7.5918C3.44966%200%200.0917969%203.35786%200.0917969%207.5V42.5C0.0917969%2046.6421%203.44966%2050%207.5918%2050H42.5918C46.7339%2050%2050.0918%2046.6421%2050.0918%2042.5V7.5C50.0918%203.35786%2046.7339%200%2042.5918%200Z'%20fill='%23CC6699'/%3e%3cpath%20d='M25.2871%208.59369C15.9121%2011.8163%209.85742%2018.3593%2010.4434%2022.2656C11.0293%2026.1718%2016.8887%2029.2968%2019.5254%2031.3476C16.1074%2033.1054%2011.8105%2035.7421%2011.9082%2039.1601C12.1035%2043.8476%2017.1816%2042.3827%2019.3301%2041.0156C21.4785%2039.6484%2023.627%2035.8398%2022.2598%2031.8359C25.2871%2031.0546%2027.9238%2032.0312%2028.7051%2032.6171C31.7324%2034.7656%2030.1699%2037.207%2029.0957%2037.5976C28.0215%2037.9882%2028.7051%2038.1835%2029.3887%2037.9882C30.0723%2037.7929%2031.5371%2036.8163%2031.5371%2035.1562C31.5371%2030.957%2027.0449%2029.0038%2021.4785%2030.4687C18.2559%2027.0507%2013.8613%2025.4882%2014.0566%2021.7773C14.1543%2020.4101%2014.6426%2016.8945%2023.334%2012.4999C32.0254%208.1054%2038.1777%209.86322%2037.3965%2013.8671C36.2246%2019.9218%2025.6777%2024.0234%2021.9668%2020.5077C21.7715%2020.1171%2021.0879%2019.8242%2021.4785%2020.8984C23.4316%2025.7812%2039.252%2023.5351%2039.9355%2013.1835C40.1309%207.71478%2032.2207%206.24994%2025.2871%208.59369ZM16.8887%2039.8437C14.4473%2040.6249%2014.5449%2039.0624%2014.6426%2038.4765C14.9355%2036.8163%2016.3027%2034.7656%2020.4043%2032.7148C21.5762%2036.4257%2018.9395%2039.2577%2016.8887%2039.8437Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21452'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.0917969)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",PSe="data:image/svg+xml,%3csvg%20width='49'%20height='30'%20viewBox='0%200%2049%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.25%2010C13.8833%203.33333%2017.9667%200%2024.5%200C34.3%200%2035.525%207.5%2040.425%208.75C43.6917%209.58333%2046.55%208.33333%2049%205C47.3667%2011.6667%2043.2833%2015%2036.75%2015C26.95%2015%2025.725%207.5%2020.825%206.25C17.5583%205.41667%2014.7%206.66667%2012.25%2010ZM0%2025C1.63333%2018.3333%205.71667%2015%2012.25%2015C22.05%2015%2023.275%2022.5%2028.175%2023.75C31.4417%2024.5833%2034.3%2023.3333%2036.75%2020C35.1167%2026.6667%2031.0333%2030%2024.5%2030C14.7%2030%2013.475%2022.5%208.575%2021.25C5.30833%2020.4167%202.45%2021.6667%200%2025Z'%20fill='%2344A8B3'/%3e%3c/svg%3e",LSe="data:image/svg+xml,%3csvg%20width='51'%20height='50'%20viewBox='0%200%2051%2050'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1479_21433)'%3e%3cpath%20d='M43.3789%200H8.37891C4.23677%200%200.878906%203.35786%200.878906%207.5V42.5C0.878906%2046.6421%204.23677%2050%208.37891%2050H43.3789C47.521%2050%2050.8789%2046.6421%2050.8789%2042.5V7.5C50.8789%203.35786%2047.521%200%2043.3789%200Z'%20fill='%233178C6'/%3e%3cpath%20d='M23.6328%2027.7344H29.8828V23.7305H12.4023V27.7344H18.6523V45.6055H23.6328V27.7344ZM31.8359%2044.6289C32.627%2045.0391%2033.5938%2045.3418%2034.668%2045.5469C35.7422%2045.752%2036.9141%2045.8496%2038.0859%2045.8496C39.2578%2045.8496%2040.332%2045.7422%2041.4062%2045.5176C42.4805%2045.293%2043.3594%2044.9219%2044.1406%2044.4434C44.9316%2043.9258%2045.6055%2043.2715%2045.9961%2042.3926C46.3867%2041.5137%2046.6895%2040.5371%2046.6895%2039.2676C46.6895%2038.3789%2046.5527%2037.6074%2046.2891%2036.9238C46.0254%2036.2402%2045.6445%2035.6543%2045.1172%2035.166C44.6191%2034.6484%2044.043%2034.1895%2043.3594%2033.7988C42.6758%2033.4082%2041.8945%2032.998%2041.0156%2032.627C40.3711%2032.3633%2039.8438%2032.1094%2039.2578%2031.8555C38.75%2031.6016%2038.3105%2031.3477%2037.9883%2031.0937C37.627%2030.8301%2037.3535%2030.5566%2037.1582%2030.2734C36.9629%2029.9805%2036.8652%2029.6582%2036.8652%2029.2969C36.8652%2028.9648%2036.9522%2028.6621%2037.1289%2028.3887C37.3057%2028.1152%2037.5488%2027.8906%2037.8613%2027.6953C38.1738%2027.5%2038.5645%2027.3535%2039.0332%2027.2461C39.4922%2027.1387%2040%2027.0898%2040.5957%2027.0898C41.0059%2027.0898%2041.4355%2027.1201%2041.8652%2027.1816C42.3145%2027.2432%2042.7734%2027.3379%2043.2324%2027.4648C43.6914%2027.5918%2044.1406%2027.748%2044.5996%2027.9434C45.0293%2028.1387%2045.4297%2028.3633%2045.7715%2028.6172V24.0273C45.0293%2023.7441%2044.209%2023.5293%2043.3301%2023.3926C42.4512%2023.2559%2041.4746%2023.1875%2040.3027%2023.1875C39.1309%2023.1875%2038.0566%2023.3145%2036.9824%2023.5586C35.9082%2023.8027%2035.0293%2024.1934%2034.248%2024.7305C33.457%2025.2578%2032.8809%2025.9023%2032.3926%2026.7812C31.9336%2027.6016%2031.709%2028.5391%2031.709%2029.7109C31.709%2031.1758%2032.1289%2032.4453%2032.9785%2033.4219C33.8184%2034.4961%2035.127%2035.2773%2036.7871%2036.0586C37.4609%2036.332%2038.0566%2036.6055%2038.6426%2036.8691C39.2285%2037.1328%2039.7168%2037.4062%2040.1074%2037.6895C40.5273%2037.9727%2040.8594%2038.2852%2041.084%2038.6172C41.3281%2038.9492%2041.4551%2039.3398%2041.4551%2039.7891C41.4551%2040.1016%2041.3789%2040.3945%2041.2305%2040.668C41.082%2040.9414%2040.8496%2041.1758%2040.5371%2041.3711C40.2246%2041.5664%2039.8438%2041.7227%2039.3652%2041.8398C38.9062%2041.9473%2038.3887%2042.0059%2037.7051%2042.0059C36.6309%2042.0059%2035.5566%2041.8203%2034.5801%2041.4492C33.5059%2041.0781%2032.5293%2040.5215%2031.8359%2039.9414V44.6289Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1479_21433'%3e%3crect%20width='50'%20height='50'%20fill='white'%20transform='translate(0.878906)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",yre="data:image/svg+xml,%3csvg%20width='30'%20height='26'%20viewBox='0%200%2030%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.43398%200.519531C7.04842%200.519531%204.97388%202.15491%204.41692%204.47454L3.82415%206.94336C3.61485%207.81502%202.8353%208.42956%201.93886%208.42956H1.1432C0.511828%208.42956%200%208.94138%200%209.57276V10.1213C0%2010.4497%200.26624%2010.716%200.594663%2010.716C0.923086%2010.716%201.18933%2010.9822%201.18933%2011.3106V23.7748C1.18933%2024.7176%201.95362%2025.4819%202.89644%2025.4819H3.39499C4.06246%2025.4819%204.60355%2024.9408%204.60355%2024.2734C4.60355%2023.6059%205.14464%2023.0648%205.81211%2023.0648H24.1879C24.8554%2023.0648%2025.3965%2023.6059%2025.3965%2024.2734C25.3965%2024.9408%2025.9375%2025.4819%2026.605%2025.4819H27.1026C28.045%2025.4819%2028.8089%2024.718%2028.8089%2023.7757V11.3115C28.8089%2010.9826%2029.0755%2010.716%2029.4044%2010.716C29.7334%2010.716%2030%2010.4493%2030%2010.1204V9.57276C30%208.94138%2029.4882%208.42956%2028.8568%208.42956H28.0611C27.1647%208.42956%2026.3851%207.81502%2026.1758%206.94336L25.5831%204.47455C25.0261%202.15491%2022.9516%200.519531%2020.566%200.519531H9.43398ZM6.3784%202.05753H21.1095C22.5826%202.05753%2023.8637%203.06746%2024.2075%204.49991C24.6885%206.50344%2023.1699%208.42971%2021.1095%208.42971H8.88978C6.82933%208.42971%205.31075%206.50345%205.7917%204.49992L6.37791%202.05792C6.37796%202.05769%206.37817%202.05753%206.3784%202.05753ZM2.1772%2014.1881C2.1772%2013.4422%202.92028%2012.9244%203.61999%2013.1828L6.23786%2014.1496C6.65872%2014.305%206.9382%2014.7062%206.9382%2015.1548C6.9382%2015.9007%206.19512%2016.4184%205.49542%2016.16L2.87754%2015.1933C2.45668%2015.0378%202.1772%2014.6367%202.1772%2014.1881ZM26.3776%2013.1825C27.0774%2012.9243%2027.8204%2013.4421%2027.8204%2014.188C27.8204%2014.6367%2027.541%2015.0379%2027.1201%2015.1934L24.5052%2016.1594C23.8051%2016.4181%2023.0614%2015.9001%2023.0614%2015.1537C23.0614%2014.7047%2023.3412%2014.3032%2023.7624%2014.1477L26.3776%2013.1825ZM10.3958%2019.7689C10.3958%2019.1381%2010.9073%2018.6266%2011.5381%2018.6266H18.4584C19.0892%2018.6266%2019.6007%2019.1381%2019.6007%2019.7689C19.6007%2020.3998%2019.0892%2020.9112%2018.4584%2020.9112H11.5381C10.9072%2020.9112%2010.3958%2020.3998%2010.3958%2019.7689Z'%20fill='url(%23paint0_linear_1478_17766)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_17766'%20x1='10.6108'%20y1='3.85718'%20x2='14.2717'%20y2='25.6045'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0001'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",DSe="data:image/svg+xml,%3csvg%20width='30'%20height='27'%20viewBox='0%200%2030%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M23.1209%2012.7698C23.2693%2013.028%2023.3474%2013.3207%2023.3474%2013.6186C23.3474%2013.9165%2023.2693%2014.2092%2023.1209%2014.4675L19.7823%2020.2271C19.6331%2020.4842%2019.4191%2020.6977%2019.1615%2020.8461C18.904%2020.9946%2018.612%2021.0728%2018.3147%2021.073L11.6733%2021.073C11.3781%2021.0707%2011.0886%2020.9915%2010.8333%2020.8432C10.578%2020.6948%2010.3659%2020.4825%2010.2177%2020.2271L6.87911%2014.4675C6.73069%2014.2092%206.65258%2013.9165%206.65258%2013.6186C6.65258%2013.3207%206.73069%2013.028%206.87911%2012.7698L8.72327%209.58956L12.8271%2016.6075C12.8946%2016.7277%2012.9933%2016.8274%2013.1126%2016.8963C13.232%2016.9652%2013.3677%2017.0007%2013.5055%2016.9991L16.4945%2016.9991C16.6323%2017.0007%2016.768%2016.9652%2016.8874%2016.8963C17.0067%2016.8274%2017.1054%2016.7277%2017.1729%2016.6075L18.6674%2013.9982C18.7351%2013.881%2018.7707%2013.748%2018.7707%2013.6126C18.7707%2013.4773%2018.7351%2013.3443%2018.6674%2013.2271L11.9304%201.5703C11.6966%201.16601%2011.3606%200.830295%2010.9562%200.596843C10.5517%200.363393%2010.0929%200.240408%209.62593%200.24023L9.02217%200.24023C8.48786%200.240028%207.96292%200.380525%207.50015%200.647588C7.03738%200.914653%206.65309%201.29887%206.38594%201.76159L0.408109%2012.1003C0.140762%2012.5627%20-6.08137e-07%2013.0874%20-5.84788e-07%2013.6216C-5.61439e-07%2014.1558%200.140762%2014.6805%200.408109%2015.143L6.38594%2025.4816C6.65347%2025.9438%207.03793%2026.3274%207.50067%2026.5939C7.96342%2026.8605%208.48816%2027.0005%209.02217%2027L20.9778%2027C21.5121%2027.0002%2022.0371%2026.8597%2022.4998%2026.5926C22.9626%2026.3256%2023.3469%2025.9414%2023.6141%2025.4786L29.5919%2015.14C29.8592%2014.6775%2030%2014.1528%2030%2013.6186C30%2013.0845%2029.8592%2012.5597%2029.5919%2012.0973L23.6141%201.7586C23.3469%201.29588%2022.9626%200.911664%2022.4998%200.644599C22.0371%200.377534%2021.5121%200.237039%2020.9778%200.237243L15.8967%200.237243L23.1209%2012.7698Z'%20fill='%23fff'/%3e%3c/svg%3e",BSe="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20opacity='0.4'%20d='M20.4578%206.19733L18.1703%203.90983C16.2391%201.97858%2015.2741%201.01233%2014.0203%200.653583C12.7666%200.293583%2011.4353%200.601083%208.77406%201.21608L7.23906%201.56983C4.99906%202.08608%203.87906%202.34483%203.11156%203.11108C2.34531%203.87858%202.08656%204.99858%201.57031%207.23858L1.21531%208.77358C0.601557%2011.4361%200.294057%2012.7661%200.652807%2014.0198C1.01281%2015.2736%201.97906%2016.2386%203.91031%2018.1698L6.19781%2020.4573C9.56031%2023.8211%2011.2403%2025.4998%2013.3278%2025.4998C15.4166%2025.4998%2017.0966%2023.8186%2020.4578%2020.4573C23.8216%2017.0961%2025.5003%2015.4161%2025.5003%2013.3273C25.5003%2011.2398%2023.8191%209.55858%2020.4578%206.19733Z'%20fill='%23fff'/%3e%3cpath%20d='M11.9333%2015.9103C11.0921%2015.0703%2011.0996%2013.8628%2011.6021%2012.9066C11.4774%2012.7264%2011.4197%2012.5083%2011.4391%2012.2901C11.4584%2012.0719%2011.5536%2011.8673%2011.7081%2011.7119C11.8625%2011.5566%2012.0666%2011.4602%2012.2847%2011.4396C12.5028%2011.419%2012.7212%2011.4754%2012.9021%2011.5991C13.3271%2011.3741%2013.7933%2011.2541%2014.2583%2011.2591C14.507%2011.2614%2014.7445%2011.3624%2014.9187%2011.5399C15.0929%2011.7173%2015.1894%2011.9567%2015.1871%2012.2053C15.1848%2012.454%2015.0838%2012.6915%2014.9063%2012.8657C14.7289%2013.0399%2014.4895%2013.1364%2014.2408%2013.1341C13.9514%2013.1448%2013.6779%2013.2692%2013.4796%2013.4803C12.9958%2013.9641%2013.1233%2014.4491%2013.2583%2014.5853C13.3958%2014.7216%2013.8796%2014.8478%2014.3633%2014.3641C15.3433%2013.3841%2017.0358%2013.0591%2018.1208%2014.1428C18.9621%2014.9841%2018.9546%2016.1916%2018.4508%2017.1478C18.5748%2017.328%2018.6318%2017.5458%2018.6121%2017.7636C18.5924%2017.9814%2018.4972%2018.1854%2018.3429%2018.3404C18.1887%2018.4954%2017.9851%2018.5916%2017.7674%2018.6124C17.5497%2018.6331%2017.3316%2018.5771%2017.1508%2018.4541C16.5899%2018.7617%2015.9392%2018.8643%2015.3108%2018.7441C15.1902%2018.7193%2015.0756%2018.671%2014.9736%2018.6019C14.8716%2018.5328%2014.7843%2018.4444%2014.7165%2018.3415C14.6487%2018.2387%2014.6018%2018.1235%2014.5785%2018.0025C14.5553%2017.8816%2014.5561%2017.7572%2014.5808%2017.6366C14.6056%2017.5159%2014.6539%2017.4013%2014.723%2017.2994C14.7921%2017.1974%2014.8806%2017.11%2014.9834%2017.0422C15.0862%2016.9744%2015.2014%2016.9276%2015.3224%2016.9043C15.4433%2016.881%2015.5677%2016.8818%2015.6883%2016.9066C15.9096%2016.9528%2016.2671%2016.8803%2016.5733%2016.5741C17.0583%2016.0891%2016.9308%2015.6053%2016.7946%2015.4691C16.6583%2015.3328%2016.1746%2015.2066%2015.6896%2015.6903C14.7096%2016.6703%2013.0171%2016.9953%2011.9333%2015.9103ZM10.5258%2010.8666C10.7646%2010.636%2010.9551%2010.3601%2011.0861%2010.0551C11.2171%209.75008%2011.2861%209.42203%2011.289%209.09008C11.2919%208.75813%2011.2286%208.42894%2011.1029%208.12169C10.9772%207.81445%2010.7916%207.53532%2010.5568%207.30059C10.3221%207.06586%2010.043%206.88023%209.73573%206.75453C9.42849%206.62882%209.09929%206.56557%208.76734%206.56845C8.43539%206.57134%208.10734%206.6403%207.80233%206.77133C7.49732%206.90235%207.22146%207.0928%206.99084%207.33158C6.53545%207.80309%206.28346%208.43459%206.28916%209.09008C6.29485%209.74558%206.55778%2010.3726%207.0213%2010.8361C7.48482%2011.2996%208.11185%2011.5626%208.76734%2011.5683C9.42283%2011.574%2010.0543%2011.322%2010.5258%2010.8666Z'%20fill='%23fff'/%3e%3c/svg%3e",kSe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM10.4879%2016.2086C11.1556%2018.7005%2013.717%2020.1793%2016.2089%2019.5116C18.7008%2018.8439%2020.1796%2016.2825%2019.5119%2013.7906C18.8442%2011.2987%2016.2828%209.81989%2013.7909%2010.4876C11.299%2011.1553%209.82015%2013.7167%2010.4879%2016.2086ZM8.39503%2016.7694C9.37244%2020.4171%2013.1219%2022.5819%2016.7696%2021.6045C20.4174%2020.627%2022.5821%2016.8776%2021.6047%2013.2298C20.6273%209.58209%2016.8779%207.41735%2013.2301%208.39476C9.58236%209.37218%207.41762%2013.1216%208.39503%2016.7694Z'%20fill='url(%23paint0_linear_1478_19845)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_19845'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23fff'/%3e%3cstop%20offset='0.461458'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",OSe="/about_portfolio/assets/summiz-B_i5HBJv.svg",FSe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM15.164%2012.8405L15.354%2010.3432L15.5183%208.18279C14.78%208.12663%2014.0416%208.19103%2013.3312%208.36978C12.7441%208.5175%2012.1761%208.74331%2011.643%209.0437C10.4647%209.7076%209.50982%2010.706%208.899%2011.9126C8.28818%2013.1192%208.04887%2014.4798%208.21134%2015.8224C8.37381%2017.165%208.93076%2018.4293%209.81176%2019.4553C10.6928%2020.4814%2011.8582%2021.2232%2013.1608%2021.5869C14.4634%2021.9506%2015.8446%2021.9198%2017.1297%2021.4986C18.4148%2021.0773%2019.5461%2020.2844%2020.3806%2019.2201C20.7582%2018.7386%2021.0673%2018.2113%2021.3021%2017.6533C21.5862%2016.9784%2021.7615%2016.2585%2021.8177%2015.5205L21.8178%2015.5196L19.6574%2015.3553L17.1601%2015.1653L14.9997%2015.0009L15.164%2012.8405ZM18.9617%2017.4752L14.8353%2017.1614L12.6749%2016.997L12.8392%2014.8366L13.1531%2010.7102C13.0009%2010.7757%2012.8519%2010.8495%2012.7066%2010.9313C11.9017%2011.3849%2011.2494%2012.0669%2010.8321%2012.8912C10.4148%2013.7154%2010.2513%2014.6449%2010.3623%2015.5621C10.4733%2016.4793%2010.8538%2017.343%2011.4556%2018.0439C12.0575%2018.7449%2012.8536%2019.2516%2013.7435%2019.5C14.6333%2019.7485%2015.5768%2019.7275%2016.4547%2019.4397C17.3327%2019.1519%2018.1055%2018.6103%2018.6756%2017.8832C18.7785%2017.752%2018.8739%2017.6158%2018.9617%2017.4752Z'%20fill='url(%23paint0_linear_1478_16881)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_16881'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFF'/%3e%3cstop%20offset='0.461458'%20stop-color='%23FFF'/%3e%3cstop%20offset='1'%20stop-color='%23FFF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",xre="data:image/svg+xml,%3csvg%20width='14'%20height='15'%20viewBox='0%200%2014%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.16602%207.49984H12.8327M12.8327%207.49984L6.99935%201.6665M12.8327%207.49984L6.99935%2013.3332'%20stroke='%23406AFF'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",NSe="/about_portfolio/assets/soundon-4GJHmOjh.png",zSe="/about_portfolio/assets/soundoff-B_dVLsfG.png",USe="/about_portfolio/assets/shopify-B9vYDfbe.png",GSe="/about_portfolio/assets/starbucks-Bj8Yf058.png",mX="/about_portfolio/assets/tesla-DB40m56Q.png",gX={type:"change"},uB={type:"start"},vX={type:"end"},SE=new g1,_X=new Sm,VSe=Math.cos(70*no.DEG2RAD);class Lv extends vp{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ze,this.cursor=new Ze,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:oy.ROTATE,MIDDLE:oy.DOLLY,RIGHT:oy.PAN},this.touches={ONE:ay.ROTATE,TWO:ay.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Fe){Fe.addEventListener("keydown",tr),this._domElementKeyEvents=Fe},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",tr),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(gX),r.update(),s=i.NONE},this.update=function(){const Fe=new Ze,Lt=new Ta().setFromUnitVectors(e.up,new Ze(0,1,0)),Kt=Lt.clone().invert(),un=new Ze,En=new Ta,Ar=new Ze,Vr=2*Math.PI;return function(Ps=null){const hi=r.object.position;Fe.copy(hi).sub(r.target),Fe.applyQuaternion(Lt),l.setFromVector3(Fe),r.autoRotate&&s===i.NONE&&Se(ae(Ps)),r.enableDamping?(l.theta+=o.theta*r.dampingFactor,l.phi+=o.phi*r.dampingFactor):(l.theta+=o.theta,l.phi+=o.phi);let Tt=r.minAzimuthAngle,xe=r.maxAzimuthAngle;isFinite(Tt)&&isFinite(xe)&&(Tt<-Math.PI?Tt+=Vr:Tt>Math.PI&&(Tt-=Vr),xe<-Math.PI?xe+=Vr:xe>Math.PI&&(xe-=Vr),Tt<=xe?l.theta=Math.max(Tt,Math.min(xe,l.theta)):l.theta=l.theta>(Tt+xe)/2?Math.max(Tt,l.theta):Math.min(xe,l.theta)),l.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,l.phi)),l.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor);let Ee=!1;if(r.zoomToCursor&&Z||r.object.isOrthographicCamera)l.radius=Ve(l.radius);else{const Xe=l.radius;l.radius=Ve(l.radius*h),Ee=Xe!=l.radius}if(Fe.setFromSpherical(l),Fe.applyQuaternion(Kt),hi.copy(r.target).add(Fe),r.object.lookAt(r.target),r.enableDamping===!0?(o.theta*=1-r.dampingFactor,o.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(o.set(0,0,0),d.set(0,0,0)),r.zoomToCursor&&Z){let Xe=null;if(r.object.isPerspectiveCamera){const nt=Fe.length();Xe=Ve(nt*h);const Je=nt-Xe;r.object.position.addScaledVector(H,Je),r.object.updateMatrixWorld(),Ee=!!Je}else if(r.object.isOrthographicCamera){const nt=new Ze(q.x,q.y,0);nt.unproject(r.object);const Je=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),Ee=Je!==r.object.zoom;const pt=new Ze(q.x,q.y,0);pt.unproject(r.object),r.object.position.sub(pt).add(nt),r.object.updateMatrixWorld(),Xe=Fe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Xe!==null&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Xe).add(r.object.position):(SE.origin.copy(r.object.position),SE.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(SE.direction))<VSe?e.lookAt(r.target):(_X.setFromNormalAndCoplanarPoint(r.object.up,r.target),SE.intersectPlane(_X,r.target))))}else if(r.object.isOrthographicCamera){const Xe=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),Xe!==r.object.zoom&&(r.object.updateProjectionMatrix(),Ee=!0)}return h=1,Z=!1,Ee||un.distanceToSquared(r.object.position)>a||8*(1-En.dot(r.object.quaternion))>a||Ar.distanceToSquared(r.target)>a?(r.dispatchEvent(gX),un.copy(r.object.position),En.copy(r.object.quaternion),Ar.copy(r.target),!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",ir),r.domElement.removeEventListener("pointerdown",sn),r.domElement.removeEventListener("pointercancel",Ue),r.domElement.removeEventListener("wheel",Sn),r.domElement.removeEventListener("pointermove",at),r.domElement.removeEventListener("pointerup",Ue),r.domElement.getRootNode().removeEventListener("keydown",mr,{capture:!0}),r._domElementKeyEvents!==null&&(r._domElementKeyEvents.removeEventListener("keydown",tr),r._domElementKeyEvents=null)};const r=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=i.NONE;const a=1e-6,l=new nT,o=new nT;let h=1;const d=new Ze,m=new nn,v=new nn,y=new nn,S=new nn,E=new nn,M=new nn,C=new nn,L=new nn,k=new nn,H=new Ze,q=new nn;let Z=!1;const ee=[],re={};let se=!1;function ae(Fe){return Fe!==null?2*Math.PI/60*r.autoRotateSpeed*Fe:2*Math.PI/60/60*r.autoRotateSpeed}function fe(Fe){const Lt=Math.abs(Fe*.01);return Math.pow(.95,r.zoomSpeed*Lt)}function Se(Fe){o.theta-=Fe}function Ce(Fe){o.phi-=Fe}const Ie=function(){const Fe=new Ze;return function(Kt,un){Fe.setFromMatrixColumn(un,0),Fe.multiplyScalar(-Kt),d.add(Fe)}}(),je=function(){const Fe=new Ze;return function(Kt,un){r.screenSpacePanning===!0?Fe.setFromMatrixColumn(un,1):(Fe.setFromMatrixColumn(un,0),Fe.crossVectors(r.object.up,Fe)),Fe.multiplyScalar(Kt),d.add(Fe)}}(),Le=function(){const Fe=new Ze;return function(Kt,un){const En=r.domElement;if(r.object.isPerspectiveCamera){const Ar=r.object.position;Fe.copy(Ar).sub(r.target);let Vr=Fe.length();Vr*=Math.tan(r.object.fov/2*Math.PI/180),Ie(2*Kt*Vr/En.clientHeight,r.object.matrix),je(2*un*Vr/En.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(Ie(Kt*(r.object.right-r.object.left)/r.object.zoom/En.clientWidth,r.object.matrix),je(un*(r.object.top-r.object.bottom)/r.object.zoom/En.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function ot(Fe){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?h/=Fe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ye(Fe){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?h*=Fe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function $e(Fe,Lt){if(!r.zoomToCursor)return;Z=!0;const Kt=r.domElement.getBoundingClientRect(),un=Fe-Kt.left,En=Lt-Kt.top,Ar=Kt.width,Vr=Kt.height;q.x=un/Ar*2-1,q.y=-(En/Vr)*2+1,H.set(q.x,q.y,1).unproject(r.object).sub(r.object.position).normalize()}function Ve(Fe){return Math.max(r.minDistance,Math.min(r.maxDistance,Fe))}function _t(Fe){m.set(Fe.clientX,Fe.clientY)}function wt(Fe){$e(Fe.clientX,Fe.clientX),C.set(Fe.clientX,Fe.clientY)}function Vt(Fe){S.set(Fe.clientX,Fe.clientY)}function lt(Fe){v.set(Fe.clientX,Fe.clientY),y.subVectors(v,m).multiplyScalar(r.rotateSpeed);const Lt=r.domElement;Se(2*Math.PI*y.x/Lt.clientHeight),Ce(2*Math.PI*y.y/Lt.clientHeight),m.copy(v),r.update()}function Ht(Fe){L.set(Fe.clientX,Fe.clientY),k.subVectors(L,C),k.y>0?ot(fe(k.y)):k.y<0&&ye(fe(k.y)),C.copy(L),r.update()}function Qt(Fe){E.set(Fe.clientX,Fe.clientY),M.subVectors(E,S).multiplyScalar(r.panSpeed),Le(M.x,M.y),S.copy(E),r.update()}function rn(Fe){$e(Fe.clientX,Fe.clientY),Fe.deltaY<0?ye(fe(Fe.deltaY)):Fe.deltaY>0&&ot(fe(Fe.deltaY)),r.update()}function jn(Fe){let Lt=!1;switch(Fe.code){case r.keys.UP:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Ce(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Le(0,r.keyPanSpeed),Lt=!0;break;case r.keys.BOTTOM:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Ce(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Le(0,-r.keyPanSpeed),Lt=!0;break;case r.keys.LEFT:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Se(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Le(r.keyPanSpeed,0),Lt=!0;break;case r.keys.RIGHT:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Se(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Le(-r.keyPanSpeed,0),Lt=!0;break}Lt&&(Fe.preventDefault(),r.update())}function Bn(Fe){if(ee.length===1)m.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);m.set(Kt,un)}}function Tn(Fe){if(ee.length===1)S.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);S.set(Kt,un)}}function Pe(Fe){const Lt=Hr(Fe),Kt=Fe.pageX-Lt.x,un=Fe.pageY-Lt.y,En=Math.sqrt(Kt*Kt+un*un);C.set(0,En)}function qe(Fe){r.enableZoom&&Pe(Fe),r.enablePan&&Tn(Fe)}function mn(Fe){r.enableZoom&&Pe(Fe),r.enableRotate&&Bn(Fe)}function cn(Fe){if(ee.length==1)v.set(Fe.pageX,Fe.pageY);else{const Kt=Hr(Fe),un=.5*(Fe.pageX+Kt.x),En=.5*(Fe.pageY+Kt.y);v.set(un,En)}y.subVectors(v,m).multiplyScalar(r.rotateSpeed);const Lt=r.domElement;Se(2*Math.PI*y.x/Lt.clientHeight),Ce(2*Math.PI*y.y/Lt.clientHeight),m.copy(v)}function St(Fe){if(ee.length===1)E.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);E.set(Kt,un)}M.subVectors(E,S).multiplyScalar(r.panSpeed),Le(M.x,M.y),S.copy(E)}function Jt(Fe){const Lt=Hr(Fe),Kt=Fe.pageX-Lt.x,un=Fe.pageY-Lt.y,En=Math.sqrt(Kt*Kt+un*un);L.set(0,En),k.set(0,Math.pow(L.y/C.y,r.zoomSpeed)),ot(k.y),C.copy(L);const Ar=(Fe.pageX+Lt.x)*.5,Vr=(Fe.pageY+Lt.y)*.5;$e(Ar,Vr)}function kn(Fe){r.enableZoom&&Jt(Fe),r.enablePan&&St(Fe)}function Gn(Fe){r.enableZoom&&Jt(Fe),r.enableRotate&&cn(Fe)}function sn(Fe){r.enabled!==!1&&(ee.length===0&&(r.domElement.setPointerCapture(Fe.pointerId),r.domElement.addEventListener("pointermove",at),r.domElement.addEventListener("pointerup",Ue)),!or(Fe)&&(ui(Fe),Fe.pointerType==="touch"?Sr(Fe):$t(Fe)))}function at(Fe){r.enabled!==!1&&(Fe.pointerType==="touch"?Ln(Fe):An(Fe))}function Ue(Fe){switch(Fr(Fe),ee.length){case 0:r.domElement.releasePointerCapture(Fe.pointerId),r.domElement.removeEventListener("pointermove",at),r.domElement.removeEventListener("pointerup",Ue),r.dispatchEvent(vX),s=i.NONE;break;case 1:const Lt=ee[0],Kt=re[Lt];Sr({pointerId:Lt,pageX:Kt.x,pageY:Kt.y});break}}function $t(Fe){let Lt;switch(Fe.button){case 0:Lt=r.mouseButtons.LEFT;break;case 1:Lt=r.mouseButtons.MIDDLE;break;case 2:Lt=r.mouseButtons.RIGHT;break;default:Lt=-1}switch(Lt){case oy.DOLLY:if(r.enableZoom===!1)return;wt(Fe),s=i.DOLLY;break;case oy.ROTATE:if(Fe.ctrlKey||Fe.metaKey||Fe.shiftKey){if(r.enablePan===!1)return;Vt(Fe),s=i.PAN}else{if(r.enableRotate===!1)return;_t(Fe),s=i.ROTATE}break;case oy.PAN:if(Fe.ctrlKey||Fe.metaKey||Fe.shiftKey){if(r.enableRotate===!1)return;_t(Fe),s=i.ROTATE}else{if(r.enablePan===!1)return;Vt(Fe),s=i.PAN}break;default:s=i.NONE}s!==i.NONE&&r.dispatchEvent(uB)}function An(Fe){switch(s){case i.ROTATE:if(r.enableRotate===!1)return;lt(Fe);break;case i.DOLLY:if(r.enableZoom===!1)return;Ht(Fe);break;case i.PAN:if(r.enablePan===!1)return;Qt(Fe);break}}function Sn(Fe){r.enabled===!1||r.enableZoom===!1||s!==i.NONE||(Fe.preventDefault(),r.dispatchEvent(uB),rn(jt(Fe)),r.dispatchEvent(vX))}function jt(Fe){const Lt=Fe.deltaMode,Kt={clientX:Fe.clientX,clientY:Fe.clientY,deltaY:Fe.deltaY};switch(Lt){case 1:Kt.deltaY*=16;break;case 2:Kt.deltaY*=100;break}return Fe.ctrlKey&&!se&&(Kt.deltaY*=10),Kt}function mr(Fe){Fe.key==="Control"&&(se=!0,r.domElement.getRootNode().addEventListener("keyup",Un,{passive:!0,capture:!0}))}function Un(Fe){Fe.key==="Control"&&(se=!1,r.domElement.getRootNode().removeEventListener("keyup",Un,{passive:!0,capture:!0}))}function tr(Fe){r.enabled===!1||r.enablePan===!1||jn(Fe)}function Sr(Fe){switch(Nr(Fe),ee.length){case 1:switch(r.touches.ONE){case ay.ROTATE:if(r.enableRotate===!1)return;Bn(Fe),s=i.TOUCH_ROTATE;break;case ay.PAN:if(r.enablePan===!1)return;Tn(Fe),s=i.TOUCH_PAN;break;default:s=i.NONE}break;case 2:switch(r.touches.TWO){case ay.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;qe(Fe),s=i.TOUCH_DOLLY_PAN;break;case ay.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;mn(Fe),s=i.TOUCH_DOLLY_ROTATE;break;default:s=i.NONE}break;default:s=i.NONE}s!==i.NONE&&r.dispatchEvent(uB)}function Ln(Fe){switch(Nr(Fe),s){case i.TOUCH_ROTATE:if(r.enableRotate===!1)return;cn(Fe),r.update();break;case i.TOUCH_PAN:if(r.enablePan===!1)return;St(Fe),r.update();break;case i.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;kn(Fe),r.update();break;case i.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Gn(Fe),r.update();break;default:s=i.NONE}}function ir(Fe){r.enabled!==!1&&Fe.preventDefault()}function ui(Fe){ee.push(Fe.pointerId)}function Fr(Fe){delete re[Fe.pointerId];for(let Lt=0;Lt<ee.length;Lt++)if(ee[Lt]==Fe.pointerId){ee.splice(Lt,1);return}}function or(Fe){for(let Lt=0;Lt<ee.length;Lt++)if(ee[Lt]==Fe.pointerId)return!0;return!1}function Nr(Fe){let Lt=re[Fe.pointerId];Lt===void 0&&(Lt=new nn,re[Fe.pointerId]=Lt),Lt.set(Fe.pageX,Fe.pageY)}function Hr(Fe){const Lt=Fe.pointerId===ee[0]?ee[1]:ee[0];return re[Lt]}r.domElement.addEventListener("contextmenu",ir),r.domElement.addEventListener("pointerdown",sn),r.domElement.addEventListener("pointercancel",Ue),r.domElement.addEventListener("wheel",Sn,{passive:!1}),r.domElement.getRootNode().addEventListener("keydown",mr,{passive:!0,capture:!0}),this.update()}}const HSe="/about_portfolio/assets/clouds-IEtJOhG3.jpeg",jSe="/about_portfolio/assets/earth_basic-BA2kNn0Z.jpeg",WSe="/about_portfolio/assets/earth_normal-BhhqUxiB.jpeg",XSe="/about_portfolio/assets/earth_rough-BHPkAlB2.jpeg",$Se="/about_portfolio/assets/moon_basic-B595DPb7.jpeg",qSe="/about_portfolio/assets/moon_normal-BoJTEBW0.jpeg",ZSe="/about_portfolio/assets/moon_roughness-BDXd91JJ.jpeg";var JS=function(){var n=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(d){d.preventDefault(),r(++n%e.children.length)},!1);function t(d){return e.appendChild(d.dom),d}function r(d){for(var m=0;m<e.children.length;m++)e.children[m].style.display=m===d?"block":"none";n=d}var i=(performance||Date).now(),s=i,a=0,l=t(new JS.Panel("FPS","#0ff","#002")),o=t(new JS.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new JS.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:e,addPanel:t,showPanel:r,begin:function(){i=(performance||Date).now()},end:function(){a++;var d=(performance||Date).now();if(o.update(d-i,200),d>=s+1e3&&(l.update(a*1e3/(d-s),100),s=d,a=0,h)){var m=performance.memory;h.update(m.usedJSHeapSize/1048576,m.jsHeapSizeLimit/1048576)}return d},update:function(){i=this.end()},domElement:e,setMode:r}};JS.Panel=function(n,e,t){var r=1/0,i=0,s=Math.round,a=s(window.devicePixelRatio||1),l=80*a,o=48*a,h=3*a,d=2*a,m=3*a,v=15*a,y=74*a,S=30*a,E=document.createElement("canvas");E.width=l,E.height=o,E.style.cssText="width:80px;height:48px";var M=E.getContext("2d");return M.font="bold "+9*a+"px Helvetica,Arial,sans-serif",M.textBaseline="top",M.fillStyle=t,M.fillRect(0,0,l,o),M.fillStyle=e,M.fillText(n,h,d),M.fillRect(m,v,y,S),M.fillStyle=t,M.globalAlpha=.9,M.fillRect(m,v,y,S),{dom:E,update:function(C,L){r=Math.min(r,C),i=Math.max(i,C),M.fillStyle=t,M.globalAlpha=1,M.fillRect(0,0,l,v),M.fillStyle=e,M.fillText(s(C)+" "+n+" ("+s(r)+"-"+s(i)+")",h,d),M.drawImage(E,m+a,v,y-a,S,m,v,y-a,S),M.fillRect(m+y-a,v,a,S),M.fillStyle=t,M.globalAlpha=.9,M.fillRect(m+y-a,v,a,s((1-C/L)*S))}}};const YSe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null),t=Ae.useRef(null),r=Ae.useRef(null),i=Ae.useRef(null),s=Ae.useRef(null),a=Ae.useRef(null),l=Ae.useRef(null);let o=null,h=null,d=null,m=null,v=new Kf;Ae.useEffect(()=>(S(),o=new JS,o.showPanel(0),document.body.appendChild(o.dom),window.addEventListener("resize",y),()=>{document.body.removeChild(o.dom),window.removeEventListener("resize",y)}),[]);const y=()=>{r.current&&e.current&&(r.current.aspect=window.innerWidth/window.innerHeight,r.current.updateProjectionMatrix(),e.current.setSize(window.innerWidth,window.innerHeight))},S=()=>{const H=new Yl({canvas:n.current,antialias:!0});H.setPixelRatio(window.devicePixelRatio),H.setSize(window.innerWidth,window.innerHeight),H.setPixelRatio(Math.min(window.devicePixelRatio,2)),H.shadowMap.enabled=!0,H.toneMapping=jL,e.current=H;const q=new Tl;t.current=q;const Z=96,ee=window.innerWidth/window.innerHeight,re=new ed(-Z*ee,Z*ee,Z,-Z,1,1e3);re.position.set(0,20,200),re.lookAt(new Ze(0,0,0)),r.current=re;const se=new Lv(re,H.domElement);se.enableDamping=!0,i.current=se,E(q),M(q),C(q),k()},E=H=>{const q=new Pv(16777215,1.2);q.position.set(-10,10,5),q.castShadow=!0,q.shadow.mapSize.width=512,q.shadow.mapSize.height=512,q.shadow.camera.top=10,q.shadow.camera.bottom=-5,q.shadow.camera.left=-5,q.shadow.camera.right=10,H.add(q);const Z=new x1(16777215,.8);H.add(Z)},M=H=>{h=new Xl;const q=new Ii(new km(10,64,64),new fp({map:v.load(jSe),normalMap:v.load(WSe),roughnessMap:v.load(XSe),normalScale:new nn(10,10),metalness:.1}));q.rotation.y=-Math.PI,m=new Ii(new km(10.6,64,64),new KT({alphaMap:v.load(HSe),transparent:!0,opacity:.4,depthTest:!0})),h.add(q),l.current=m,h.add(m),h.scale.set(6,6,6),a.current=h,H.add(h)},C=H=>{d=new Ii(new km(2,32,32),new fp({map:v.load($Se),normalMap:v.load(qSe),roughnessMap:v.load(ZSe),normalScale:new nn(10,10),metalness:.1})),d.position.set(-120,0,-120),d.scale.set(6,6,6),s.current=d,H.add(d)},L=new ng,k=()=>{if(!e.current||!t.current||!r.current)return;const H=L.getElapsedTime();h&&(h.rotation.y+=.002),m&&(m.rotation.y+=.004),m&&(m.rotation.x+=.002),o&&o.update(),i.current&&i.current.update(),d&&(d.position.x=Math.sin(H*.5)*-120),d&&(d.position.z=Math.cos(H*.5)*-120),e.current.render(t.current,r.current),requestAnimationFrame(k)};return me.jsx("div",{className:"earth_page",children:me.jsx("canvas",{ref:n,className:"webgl"})})};function KSe(n){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function vb(n,e){var t=n.__state.conversionName.toString(),r=Math.round(n.r),i=Math.round(n.g),s=Math.round(n.b),a=n.a,l=Math.round(n.h),o=n.s.toFixed(1),h=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var d=n.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}else{if(t==="CSS_RGB")return"rgb("+r+","+i+","+s+")";if(t==="CSS_RGBA")return"rgba("+r+","+i+","+s+","+a+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+r+","+i+","+s+"]";if(t==="RGBA_ARRAY")return"["+r+","+i+","+s+","+a+"]";if(t==="RGB_OBJ")return"{r:"+r+",g:"+i+",b:"+s+"}";if(t==="RGBA_OBJ")return"{r:"+r+",g:"+i+",b:"+s+",a:"+a+"}";if(t==="HSV_OBJ")return"{h:"+l+",s:"+o+",v:"+h+"}";if(t==="HSVA_OBJ")return"{h:"+l+",s:"+o+",v:"+h+",a:"+a+"}"}return"unknown format"}var yX=Array.prototype.forEach,z2=Array.prototype.slice,Pn={BREAK:{},extend:function(e){return this.each(z2.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(i){this.isUndefined(t[i])||(e[i]=t[i])}).bind(this))},this),e},defaults:function(e){return this.each(z2.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(i){this.isUndefined(e[i])&&(e[i]=t[i])}).bind(this))},this),e},compose:function(){var e=z2.call(arguments);return function(){for(var t=z2.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e){if(yX&&e.forEach&&e.forEach===yX)e.forEach(t,r);else if(e.length===e.length+0){var i=void 0,s=void 0;for(i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i)===this.BREAK)return}else for(var a in e)if(t.call(r,e[a],a)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var i=void 0;return function(){var s=this,a=arguments;function l(){i=null,r||e.apply(s,a)}var o=r||!i;clearTimeout(i),i=setTimeout(l,t),o&&e.apply(s,a)}},toArray:function(e){return e.toArray?e.toArray():z2.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},JSe=[{litmus:Pn.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:vb},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:vb},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:vb},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:vb}}},{litmus:Pn.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Pn.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Pn.isObject,conversions:{RGBA_OBJ:{read:function(e){return Pn.isNumber(e.r)&&Pn.isNumber(e.g)&&Pn.isNumber(e.b)&&Pn.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return Pn.isNumber(e.r)&&Pn.isNumber(e.g)&&Pn.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return Pn.isNumber(e.h)&&Pn.isNumber(e.s)&&Pn.isNumber(e.v)&&Pn.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return Pn.isNumber(e.h)&&Pn.isNumber(e.s)&&Pn.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],U2=void 0,AE=void 0,kF=function(){AE=!1;var e=arguments.length>1?Pn.toArray(arguments):arguments[0];return Pn.each(JSe,function(t){if(t.litmus(e))return Pn.each(t.conversions,function(r,i){if(U2=r.read(e),AE===!1&&U2!==!1)return AE=U2,U2.conversionName=i,U2.conversion=r,Pn.BREAK}),Pn.BREAK}),AE},xX=void 0,xP={hsv_to_rgb:function(e,t,r){var i=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),a=r*(1-t),l=r*(1-s*t),o=r*(1-(1-s)*t),h=[[r,o,a],[l,r,a],[a,r,o],[a,l,r],[o,a,r],[r,a,l]][i];return{r:h[0]*255,g:h[1]*255,b:h[2]*255}},rgb_to_hsv:function(e,t,r){var i=Math.min(e,t,r),s=Math.max(e,t,r),a=s-i,l=void 0,o=void 0;if(s!==0)o=a/s;else return{h:NaN,s:0,v:0};return e===s?l=(t-r)/a:t===s?l=2+(r-e)/a:l=4+(e-t)/a,l/=6,l<0&&(l+=1),{h:l*360,s:o,v:s/255}},rgb_to_hex:function(e,t,r){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,r),i},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,r){return r<<(xX=t*8)|e&~(255<<xX)}},QSe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},rd=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},id=function(){function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),dv=function n(e,t,r){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:n(s,t,r)}else{if("value"in i)return i.value;var a=i.get;return a===void 0?void 0:a.call(r)}},Dv=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},Bv=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},sl=function(){function n(){if(rd(this,n),this.__state=kF.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return id(n,[{key:"toString",value:function(){return vb(this)}},{key:"toHexString",value:function(){return vb(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function _U(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(sl.recalculateRGB(this,e,t),this.__state[e])},set:function(i){this.__state.space!=="RGB"&&(sl.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=i}})}function yU(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(sl.recalculateHSV(this),this.__state[e])},set:function(r){this.__state.space!=="HSV"&&(sl.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=r}})}sl.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=xP.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")Pn.extend(n.__state,xP.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};sl.recalculateHSV=function(n){var e=xP.rgb_to_hsv(n.r,n.g,n.b);Pn.extend(n.__state,{s:e.s,v:e.v}),Pn.isNaN(e.h)?Pn.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};sl.COMPONENTS=["r","g","b","h","s","v","hex","a"];_U(sl.prototype,"r",2);_U(sl.prototype,"g",1);_U(sl.prototype,"b",0);yU(sl.prototype,"h");yU(sl.prototype,"s");yU(sl.prototype,"v");Object.defineProperty(sl.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(sl.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=xP.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var w1=function(){function n(e,t){rd(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return id(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),eAe={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},bre={};Pn.each(eAe,function(n,e){Pn.each(n,function(t){bre[t]=e})});var tAe=/(\d+(\.\d+)?)px/;function Vd(n){if(n==="0"||Pn.isUndefined(n))return 0;var e=n.match(tAe);return Pn.isNull(e)?0:parseFloat(e[1])}var an={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var i=r,s=t;Pn.isUndefined(s)&&(s=!0),Pn.isUndefined(i)&&(i=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,i){var s=r||{},a=bre[t];if(!a)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(a);switch(a){case"MouseEvents":{var o=s.x||s.clientX||0,h=s.y||s.clientY||0;l.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,o,h,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var d=l.initKeyboardEvent||l.initKeyEvent;Pn.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),d(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break}default:{l.initEvent(t,s.bubbles||!1,s.cancelable||!0);break}}Pn.defaults(l,i),e.dispatchEvent(l)},bind:function(e,t,r,i){var s=i||!1;return e.addEventListener?e.addEventListener(t,r,s):e.attachEvent&&e.attachEvent("on"+t,r),an},unbind:function(e,t,r,i){var s=i||!1;return e.removeEventListener?e.removeEventListener(t,r,s):e.detachEvent&&e.detachEvent("on"+t,r),an},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);r.indexOf(t)===-1&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return an},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),i=r.indexOf(t);i!==-1&&(r.splice(i,1),e.className=r.join(" "))}else e.className=void 0;return an},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return Vd(t["border-left-width"])+Vd(t["border-right-width"])+Vd(t["padding-left"])+Vd(t["padding-right"])+Vd(t.width)},getHeight:function(e){var t=getComputedStyle(e);return Vd(t["border-top-width"])+Vd(t["border-bottom-width"])+Vd(t["padding-top"])+Vd(t["padding-bottom"])+Vd(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent;while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},wre=function(n){Dv(e,n);function e(t,r){rd(this,e);var i=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i;i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox");function a(){s.setValue(!s.__prev)}return an.bind(i.__checkbox,"change",a,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return id(e,[{key:"setValue",value:function(r){var i=dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w1),nAe=function(n){Dv(e,n);function e(t,r,i){rd(this,e);var s=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=i,l=s;if(s.__select=document.createElement("select"),Pn.isArray(a)){var o={};Pn.each(a,function(h){o[h]=h}),a=o}return Pn.each(a,function(h,d){var m=document.createElement("option");m.innerHTML=d,m.setAttribute("value",h),l.__select.appendChild(m)}),s.updateDisplay(),an.bind(s.__select,"change",function(){var h=this.options[this.selectedIndex].value;l.setValue(h)}),s.domElement.appendChild(s.__select),s}return id(e,[{key:"setValue",value:function(r){var i=dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return an.isActive(this.__select)?this:(this.__select.value=this.getValue(),dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(w1),rAe=function(n){Dv(e,n);function e(t,r){rd(this,e);var i=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i;function a(){s.setValue(s.__input.value)}function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),an.bind(i.__input,"keyup",a),an.bind(i.__input,"change",a),an.bind(i.__input,"blur",l),an.bind(i.__input,"keydown",function(o){o.keyCode===13&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return id(e,[{key:"updateDisplay",value:function(){return an.isActive(this.__input)||(this.__input.value=this.getValue()),dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w1);function bX(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var Sre=function(n){Dv(e,n);function e(t,r,i){rd(this,e);var s=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=i||{};return s.__min=a.min,s.__max=a.max,s.__step=a.step,Pn.isUndefined(s.__step)?s.initialValue===0?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=bX(s.__impliedStep),s}return id(e,[{key:"setValue",value:function(r){var i=r;return this.__min!==void 0&&i<this.__min?i=this.__min:this.__max!==void 0&&i>this.__max&&(i=this.__max),this.__step!==void 0&&i%this.__step!==0&&(i=Math.round(i/this.__step)*this.__step),dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(r){return this.__min=r,this}},{key:"max",value:function(r){return this.__max=r,this}},{key:"step",value:function(r){return this.__step=r,this.__impliedStep=r,this.__precision=bX(r),this}}]),e}(w1);function iAe(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var bP=function(n){Dv(e,n);function e(t,r,i){rd(this,e);var s=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,i));s.__truncationSuspended=!1;var a=s,l=void 0;function o(){var S=parseFloat(a.__input.value);Pn.isNaN(S)||a.setValue(S)}function h(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function d(){h()}function m(S){var E=l-S.clientY;a.setValue(a.getValue()+E*a.__impliedStep),l=S.clientY}function v(){an.unbind(window,"mousemove",m),an.unbind(window,"mouseup",v),h()}function y(S){an.bind(window,"mousemove",m),an.bind(window,"mouseup",v),l=S.clientY}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),an.bind(s.__input,"change",o),an.bind(s.__input,"blur",d),an.bind(s.__input,"mousedown",y),an.bind(s.__input,"keydown",function(S){S.keyCode===13&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1,h())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return id(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():iAe(this.getValue(),this.__precision),dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Sre);function wX(n,e,t,r,i){return r+(i-r)*((n-e)/(t-e))}var OF=function(n){Dv(e,n);function e(t,r,i,s,a){rd(this,e);var l=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:i,max:s,step:a})),o=l;l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),an.bind(l.__background,"mousedown",h),an.bind(l.__background,"touchstart",v),an.addClass(l.__background,"slider"),an.addClass(l.__foreground,"slider-fg");function h(E){document.activeElement.blur(),an.bind(window,"mousemove",d),an.bind(window,"mouseup",m),d(E)}function d(E){E.preventDefault();var M=o.__background.getBoundingClientRect();return o.setValue(wX(E.clientX,M.left,M.right,o.__min,o.__max)),!1}function m(){an.unbind(window,"mousemove",d),an.unbind(window,"mouseup",m),o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function v(E){E.touches.length===1&&(an.bind(window,"touchmove",y),an.bind(window,"touchend",S),y(E))}function y(E){var M=E.touches[0].clientX,C=o.__background.getBoundingClientRect();o.setValue(wX(M,C.left,C.right,o.__min,o.__max))}function S(){an.unbind(window,"touchmove",y),an.unbind(window,"touchend",S),o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return id(e,[{key:"updateDisplay",value:function(){var r=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=r*100+"%",dv(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Sre),Are=function(n){Dv(e,n);function e(t,r,i){rd(this,e);var s=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=s;return s.__button=document.createElement("div"),s.__button.innerHTML=i===void 0?"Fire":i,an.bind(s.__button,"click",function(l){return l.preventDefault(),a.fire(),!1}),an.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return id(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(w1),FF=function(n){Dv(e,n);function e(t,r){rd(this,e);var i=Bv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));i.__color=new sl(i.getValue()),i.__temp=new sl(0);var s=i;i.domElement=document.createElement("div"),an.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",an.bind(i.__input,"keydown",function(E){E.keyCode===13&&m.call(this)}),an.bind(i.__input,"blur",m),an.bind(i.__selector,"mousedown",function(){an.addClass(this,"drag").bind(window,"mouseup",function(){an.removeClass(s.__selector,"drag")})}),an.bind(i.__selector,"touchstart",function(){an.addClass(this,"drag").bind(window,"touchend",function(){an.removeClass(s.__selector,"drag")})});var a=document.createElement("div");Pn.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Pn.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Pn.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Pn.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Pn.extend(a.style,{width:"100%",height:"100%",background:"none"}),SX(a,"top","rgba(0,0,0,0)","#000"),Pn.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),oAe(i.__hue_field),Pn.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),an.bind(i.__saturation_field,"mousedown",l),an.bind(i.__saturation_field,"touchstart",l),an.bind(i.__field_knob,"mousedown",l),an.bind(i.__field_knob,"touchstart",l),an.bind(i.__hue_field,"mousedown",o),an.bind(i.__hue_field,"touchstart",o);function l(E){y(E),an.bind(window,"mousemove",y),an.bind(window,"touchmove",y),an.bind(window,"mouseup",h),an.bind(window,"touchend",h)}function o(E){S(E),an.bind(window,"mousemove",S),an.bind(window,"touchmove",S),an.bind(window,"mouseup",d),an.bind(window,"touchend",d)}function h(){an.unbind(window,"mousemove",y),an.unbind(window,"touchmove",y),an.unbind(window,"mouseup",h),an.unbind(window,"touchend",h),v()}function d(){an.unbind(window,"mousemove",S),an.unbind(window,"touchmove",S),an.unbind(window,"mouseup",d),an.unbind(window,"touchend",d),v()}function m(){var E=kF(this.value);E!==!1?(s.__color.__state=E,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function v(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}i.__saturation_field.appendChild(a),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay();function y(E){E.type.indexOf("touch")===-1&&E.preventDefault();var M=s.__saturation_field.getBoundingClientRect(),C=E.touches&&E.touches[0]||E,L=C.clientX,k=C.clientY,H=(L-M.left)/(M.right-M.left),q=1-(k-M.top)/(M.bottom-M.top);return q>1?q=1:q<0&&(q=0),H>1?H=1:H<0&&(H=0),s.__color.v=q,s.__color.s=H,s.setValue(s.__color.toOriginal()),!1}function S(E){E.type.indexOf("touch")===-1&&E.preventDefault();var M=s.__hue_field.getBoundingClientRect(),C=E.touches&&E.touches[0]||E,L=C.clientY,k=1-(L-M.top)/(M.bottom-M.top);return k>1?k=1:k<0&&(k=0),s.__color.h=k*360,s.setValue(s.__color.toOriginal()),!1}return i}return id(e,[{key:"updateDisplay",value:function(){var r=kF(this.getValue());if(r!==!1){var i=!1;Pn.each(sl.COMPONENTS,function(l){if(!Pn.isUndefined(r[l])&&!Pn.isUndefined(this.__color.__state[l])&&r[l]!==this.__color.__state[l])return i=!0,{}},this),i&&Pn.extend(this.__color.__state,r)}Pn.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,a=255-s;Pn.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,SX(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Pn.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}}]),e}(w1),sAe=["-moz-","-o-","-webkit-","-ms-",""];function SX(n,e,t,r){n.style.background="",Pn.each(sAe,function(i){n.style.cssText+="background: "+i+"linear-gradient("+e+", "+t+" 0%, "+r+" 100%); "})}function oAe(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var aAe={load:function(e,t){var r=t||document,i=r.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,r.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var r=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var s=r.getElementsByTagName("head")[0];try{s.appendChild(i)}catch{}}},lAe=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,cAe=function(e,t){var r=e[t];return Pn.isArray(arguments[2])||Pn.isObject(arguments[2])?new nAe(e,t,arguments[2]):Pn.isNumber(r)?Pn.isNumber(arguments[2])&&Pn.isNumber(arguments[3])?Pn.isNumber(arguments[4])?new OF(e,t,arguments[2],arguments[3],arguments[4]):new OF(e,t,arguments[2],arguments[3]):Pn.isNumber(arguments[4])?new bP(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new bP(e,t,{min:arguments[2],max:arguments[3]}):Pn.isString(r)?new rAe(e,t):Pn.isFunction(r)?new Are(e,t,""):Pn.isBoolean(r)?new wre(e,t):null};function uAe(n){setTimeout(n,1e3/60)}var hAe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||uAe,fAe=function(){function n(){rd(this,n),this.backgroundElement=document.createElement("div"),Pn.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),an.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Pn.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;an.bind(this.backgroundElement,"click",function(){e.hide()})}return id(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Pn.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,r=function i(){t.domElement.style.display="none",t.backgroundElement.style.display="none",an.unbind(t.domElement,"webkitTransitionEnd",i),an.unbind(t.domElement,"transitionend",i),an.unbind(t.domElement,"oTransitionEnd",i)};an.bind(this.domElement,"webkitTransitionEnd",r),an.bind(this.domElement,"transitionend",r),an.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-an.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-an.getHeight(this.domElement)/2+"px"}}]),n}(),dAe=KSe(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);aAe.inject(dAe);var AX="dg",TX=72,MX=20,rT="Default",bS=function(){try{return!!window.localStorage}catch{return!1}}(),QS=void 0,CX=!0,Zx=void 0,hB=!1,Tre=[],io=function n(e){var t=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),an.addClass(this.domElement,AX),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Pn.defaults(r,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),r=Pn.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Pn.isUndefined(r.load)?r.load={preset:rT}:r.preset&&(r.load.preset=r.preset),Pn.isUndefined(r.parent)&&r.hideable&&Tre.push(this),r.resizable=Pn.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Pn.isUndefined(r.scrollable)&&(r.scrollable=!0);var i=bS&&localStorage.getItem(Yx(this,"isLocal"))==="true",s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:r.load.preset},set:function(v){t.parent?t.getRoot().preset=v:r.load.preset=v,vAe(this),t.revert()}},width:{get:function(){return r.width},set:function(v){r.width=v,UF(t,v)}},name:{get:function(){return r.name},set:function(v){r.name=v,a&&(a.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(v){r.closed=v,r.closed?an.addClass(t.__ul,n.CLASS_CLOSED):an.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=v?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(v){bS&&(i=v,v?an.bind(window,"unload",s):an.unbind(window,"unload",s),localStorage.setItem(Yx(t,"isLocal"),v))}}}),Pn.isUndefined(r.parent)){if(this.closed=r.closed||!1,an.addClass(this.domElement,n.CLASS_MAIN),an.makeSelectable(this.domElement,!1),bS&&i){t.useLocalStorage=!0;var l=localStorage.getItem(Yx(this,"gui"));l&&(r.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,an.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),r.closeOnTop?(an.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(an.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),an.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{r.closed===void 0&&(r.closed=!0);var o=document.createTextNode(r.name);an.addClass(o,"controller-name"),a=xU(t,o);var h=function(v){return v.preventDefault(),t.closed=!t.closed,!1};an.addClass(this.__ul,n.CLASS_CLOSED),an.addClass(a,"title"),an.bind(a,"click",h),r.closed||(this.closed=!1)}r.autoPlace&&(Pn.isUndefined(r.parent)&&(CX&&(Zx=document.createElement("div"),an.addClass(Zx,AX),an.addClass(Zx,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Zx),CX=!1),Zx.appendChild(this.domElement),an.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||UF(t,r.width)),this.__resizeHandler=function(){t.onResizeDebounced()},an.bind(window,"resize",this.__resizeHandler),an.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),an.bind(this.__ul,"transitionend",this.__resizeHandler),an.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&gAe(this),s=function(){bS&&localStorage.getItem(Yx(t,"isLocal"))==="true"&&localStorage.setItem(Yx(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=s;function d(){var m=t.getRoot();m.width+=1,Pn.defer(function(){m.width-=1})}r.parent||d()};io.toggleHide=function(){hB=!hB,Pn.each(Tre,function(n){n.domElement.style.display=hB?"none":""})};io.CLASS_AUTO_PLACE="a";io.CLASS_AUTO_PLACE_CONTAINER="ac";io.CLASS_MAIN="main";io.CLASS_CONTROLLER_ROW="cr";io.CLASS_TOO_TALL="taller-than-window";io.CLASS_CLOSED="closed";io.CLASS_CLOSE_BUTTON="close-button";io.CLASS_CLOSE_TOP="close-top";io.CLASS_CLOSE_BOTTOM="close-bottom";io.CLASS_DRAG="drag";io.DEFAULT_WIDTH=245;io.TEXT_CLOSED="Close Controls";io.TEXT_OPEN="Open Controls";io._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===TX||n.keyCode===TX)&&io.toggleHide()};an.bind(window,"keydown",io._keydownHandler,!1);Pn.extend(io.prototype,{add:function(e,t){return eA(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return eA(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Pn.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Zx.removeChild(this.domElement);var e=this;Pn.each(this.__folders,function(t){e.removeFolder(t)}),an.unbind(window,"keydown",io._keydownHandler,!1),EX(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new io(t);this.__folders[e]=r;var i=xU(this,r.domElement);return an.addClass(i,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],EX(e);var t=this;Pn.each(e.__folders,function(r){e.removeFolder(r)}),Pn.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=an.getOffset(e.__ul).top,r=0;Pn.each(e.__ul.childNodes,function(i){e.autoPlace&&i===e.__save_row||(r+=an.getHeight(i))}),window.innerHeight-t-MX<r?(an.addClass(e.domElement,io.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-MX+"px"):(an.removeClass(e.domElement,io.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Pn.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Pn.debounce(function(){this.onResize()},50),remember:function(){if(Pn.isUndefined(QS)&&(QS=new fAe,QS.domElement.innerHTML=lAe),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Pn.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&mAe(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&UF(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=TE(this)),e.folders={},Pn.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=TE(this),NF(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[rT]=TE(this,!0)),this.load.remembered[e]=TE(this),this.preset=e,zF(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Pn.each(this.__controllers,function(t){this.getRoot().load.remembered?Mre(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Pn.each(this.__folders,function(t){t.revert(t)}),e||NF(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&Cre(this.__listening)},updateDisplay:function(){Pn.each(this.__controllers,function(e){e.updateDisplay()}),Pn.each(this.__folders,function(e){e.updateDisplay()})}});function xU(n,e,t){var r=document.createElement("li");return e&&r.appendChild(e),t?n.__ul.insertBefore(r,t):n.__ul.appendChild(r),n.onResize(),r}function EX(n){an.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&an.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function NF(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function pAe(n,e,t){if(t.__li=e,t.__gui=n,Pn.extend(t,{options:function(a){if(arguments.length>1){var l=t.__li.nextElementSibling;return t.remove(),eA(n,t.object,t.property,{before:l,factoryArgs:[Pn.toArray(arguments)]})}if(Pn.isArray(a)||Pn.isObject(a)){var o=t.__li.nextElementSibling;return t.remove(),eA(n,t.object,t.property,{before:o,factoryArgs:[a]})}},name:function(a){return t.__li.firstElementChild.firstElementChild.innerHTML=a,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof OF){var r=new bP(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Pn.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var a=t[s],l=r[s];t[s]=r[s]=function(){var o=Array.prototype.slice.call(arguments);return l.apply(r,o),a.apply(t,o)}}),an.addClass(e,"has-slider"),t.domElement.insertBefore(r.domElement,t.domElement.firstElementChild)}else if(t instanceof bP){var i=function(a){if(Pn.isNumber(t.__min)&&Pn.isNumber(t.__max)){var l=t.__li.firstElementChild.firstElementChild.innerHTML,o=t.__gui.__listening.indexOf(t)>-1;t.remove();var h=eA(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return h.name(l),o&&h.listen(),h}return a};t.min=Pn.compose(i,t.min),t.max=Pn.compose(i,t.max)}else t instanceof wre?(an.bind(e,"click",function(){an.fakeEvent(t.__checkbox,"click")}),an.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof Are?(an.bind(e,"click",function(){an.fakeEvent(t.__button,"click")}),an.bind(e,"mouseover",function(){an.addClass(t.__button,"hover")}),an.bind(e,"mouseout",function(){an.removeClass(t.__button,"hover")})):t instanceof FF&&(an.addClass(e,"color"),t.updateDisplay=Pn.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=Pn.compose(function(s){return n.getRoot().__preset_select&&t.isModified()&&NF(n.getRoot(),!0),s},t.setValue)}function Mre(n,e){var t=n.getRoot(),r=t.__rememberedObjects.indexOf(e.object);if(r!==-1){var i=t.__rememberedObjectIndecesToControllers[r];if(i===void 0&&(i={},t.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,a=void 0;if(s[n.preset])a=s[n.preset];else if(s[rT])a=s[rT];else return;if(a[r]&&a[r][e.property]!==void 0){var l=a[r][e.property];e.initialValue=l,e.setValue(l)}}}}function eA(n,e,t,r){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var i=void 0;if(r.color)i=new FF(e,t);else{var s=[e,t].concat(r.factoryArgs);i=cAe.apply(n,s)}r.before instanceof w1&&(r.before=r.before.__li),Mre(n,i),an.addClass(i.domElement,"c");var a=document.createElement("span");an.addClass(a,"property-name"),a.innerHTML=i.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(i.domElement);var o=xU(n,l,r.before);return an.addClass(o,io.CLASS_CONTROLLER_ROW),i instanceof FF?an.addClass(o,"color"):an.addClass(o,QSe(i.getValue())),pAe(n,o,i),n.__controllers.push(i),i}function Yx(n,e){return document.location.href+"."+e}function zF(n,e,t){var r=document.createElement("option");r.innerHTML=e,r.value=e,n.__preset_select.appendChild(r),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function IX(n,e){e.style.display=n.useLocalStorage?"block":"none"}function mAe(n){var e=n.__save_row=document.createElement("li");an.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),an.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",an.addClass(t,"button gears");var r=document.createElement("span");r.innerHTML="Save",an.addClass(r,"button"),an.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",an.addClass(i,"button"),an.addClass(i,"save-as");var s=document.createElement("span");s.innerHTML="Revert",an.addClass(s,"button"),an.addClass(s,"revert");var a=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?Pn.each(n.load.remembered,function(m,v){zF(n,v,v===n.preset)}):zF(n,rT,!1),an.bind(a,"change",function(){for(var m=0;m<n.__preset_select.length;m++)n.__preset_select[m].innerHTML=n.__preset_select[m].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(r),e.appendChild(i),e.appendChild(s),bS){var l=document.getElementById("dg-local-explain"),o=document.getElementById("dg-local-storage"),h=document.getElementById("dg-save-locally");h.style.display="block",localStorage.getItem(Yx(n,"isLocal"))==="true"&&o.setAttribute("checked","checked"),IX(n,l),an.bind(o,"change",function(){n.useLocalStorage=!n.useLocalStorage,IX(n,l)})}var d=document.getElementById("dg-new-constructor");an.bind(d,"keydown",function(m){m.metaKey&&(m.which===67||m.keyCode===67)&&QS.hide()}),an.bind(t,"click",function(){d.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),QS.show(),d.focus(),d.select()}),an.bind(r,"click",function(){n.save()}),an.bind(i,"click",function(){var m=prompt("Enter a new preset name.");m&&n.saveAs(m)}),an.bind(s,"click",function(){n.revert()})}function gAe(n){var e=void 0;n.__resize_handle=document.createElement("div"),Pn.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(s){return s.preventDefault(),n.width+=e-s.clientX,n.onResize(),e=s.clientX,!1}function r(){an.removeClass(n.__closeButton,io.CLASS_DRAG),an.unbind(window,"mousemove",t),an.unbind(window,"mouseup",r)}function i(s){return s.preventDefault(),e=s.clientX,an.addClass(n.__closeButton,io.CLASS_DRAG),an.bind(window,"mousemove",t),an.bind(window,"mouseup",r),!1}an.bind(n.__resize_handle,"mousedown",i),an.bind(n.__closeButton,"mousedown",i),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function UF(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function TE(n,e){var t={};return Pn.each(n.__rememberedObjects,function(r,i){var s={},a=n.__rememberedObjectIndecesToControllers[i];Pn.each(a,function(l,o){s[o]=e?l.initialValue:l.getValue()}),t[i]=s}),t}function vAe(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function Cre(n){n.length!==0&&hAe.call(window,function(){Cre(n)}),Pn.each(n,function(e){e.updateDisplay()})}var _Ae=io,ep=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-ep.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?ep.Bounce.In(n*2)*.5:ep.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),_b=function(){return performance.now()},Ere=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){e===void 0&&(e=_b()),t===void 0&&(t=!1);var r=Object.keys(this._tweens);if(r.length===0)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++){var s=this._tweens[r[i]],a=!t;s&&s.update(e,a)===!1&&!t&&delete this._tweens[r[i]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Ay={Linear:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),s=Ay.Utils.Linear;return e<0?s(n[0],n[1],r):e>1?s(n[t],n[t-1],t-r):s(n[i],n[i+1>t?t:i+1],r-i)},Bezier:function(n,e){for(var t=0,r=n.length-1,i=Math.pow,s=Ay.Utils.Bernstein,a=0;a<=r;a++)t+=i(1-e,r-a)*i(e,a)*n[a]*s(r,a);return t},CatmullRom:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),s=Ay.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(i=Math.floor(r=t*(1+e))),s(n[(i-1+t)%t],n[i],n[(i+1)%t],n[(i+2)%t],r-i)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-r)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],r-t)-n[t]):s(n[i?i-1:0],n[i],n[t<i+1?t:i+1],n[t<i+2?t:i+2],r-i)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Ay.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var r=e;r>1;r--)t*=r;return n[e]=t,t}}(),CatmullRom:function(n,e,t,r,i){var s=(t-n)*.5,a=(r-e)*.5,l=i*i,o=i*l;return(2*e-2*t+s+a)*o+(-3*e+3*t-2*s-a)*l+s*i+e}}},bU=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),GF=new Ere,wS=function(){function n(e,t){t===void 0&&(t=GF),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ep.Linear.None,this._interpolationFunction=Ay.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=bU.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=_b()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var s in this._valuesEnd)i[s]=this._valuesEnd[s];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,r,i,s){for(var a in r){var l=e[a],o=Array.isArray(l),h=o?"array":typeof l,d=!o&&Array.isArray(r[a]);if(!(h==="undefined"||h==="function")){if(d){var m=r[a];if(m.length===0)continue;for(var v=[l],y=0,S=m.length;y<S;y+=1){var E=this._handleRelativeValue(l,m[y]);if(isNaN(E)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}v.push(E)}d&&(r[a]=v)}if((h==="object"||o)&&l&&!d){t[a]=o?[]:{};var M=l;for(var C in M)t[a][C]=M[C];i[a]=o?[]:{};var m=r[a];if(!this._isDynamic){var L={};for(var C in m)L[C]=m[C];r[a]=m=L}this._setupProperties(M,t[a],m,i[a],s)}else(typeof t[a]>"u"||s)&&(t[a]=l),o||(t[a]*=1),d?i[a]=r[a].slice().reverse():i[a]=t[a]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return e===void 0&&(e=_b()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},n.prototype.resume=function(e){return e===void 0&&(e=_b()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e===void 0&&(e=GF),this._group=e,this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=ep.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Ay.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r=this,i;if(e===void 0&&(e=_b()),t===void 0&&(t=!0),this._isPaused)return!0;var s,a=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>a)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,o=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),h=this._duration+this._repeat*o,d=function(){if(r._duration===0||l>h)return 1;var M=Math.trunc(l/o),C=l-M*o,L=Math.min(C/r._duration,1);return L===0&&l===r._duration?1:L},m=d(),v=this._easingFunction(m);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,v),this._onUpdateCallback&&this._onUpdateCallback(this._object,m),this._duration===0||l>=this._duration)if(this._repeat>0){var y=Math.min(Math.trunc((l-this._duration)/o)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=y);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=o*y,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var S=0,E=this._chainedTweens.length;S<E;S++)this._chainedTweens[S].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,r,i){for(var s in r)if(t[s]!==void 0){var a=t[s]||0,l=r[s],o=Array.isArray(e[s]),h=Array.isArray(l),d=!o&&h;d?e[s]=this._interpolationFunction(l,i):typeof l=="object"&&l?this._updateProperties(e[s],a,l,i):(l=this._handleRelativeValue(a,l),typeof l=="number"&&(e[s]=a+(l-a)*i))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];typeof r=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n}(),yAe="23.1.1",xAe=bU.nextId,dp=GF,bAe=dp.getAll.bind(dp),wAe=dp.removeAll.bind(dp),SAe=dp.add.bind(dp),SS=dp.remove.bind(dp),Ire=dp.update.bind(dp),tA={Easing:ep,Group:Ere,Interpolation:Ay,now:_b,Sequence:bU,nextId:xAe,Tween:wS,VERSION:yAe,getAll:bAe,removeAll:wAe,add:SAe,remove:SS,update:Ire};const Rre={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class kv{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const AAe=new ed(-1,1,1,-1,0,1);class TAe extends $r{constructor(){super(),this.setAttribute("position",new ar([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ar([0,2,0,0,2,0],2))}}const MAe=new TAe;class rM{constructor(e){this._mesh=new Ii(MAe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,AAe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class CAe extends kv{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Io?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Wm.clone(e.uniforms),this.material=new Io({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new rM(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class RX extends kv{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let a,l;this.inverse?(a=0,l=1):(a=1,l=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,a,4294967295),s.buffers.stencil.setClear(l),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class EAe extends kv{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class SD{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const r=e.getSize(new nn);this._width=r.width,this._height=r.height,t=new wl(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Ch}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new CAe(Rre),this.copyPass.material.blending=op,this.clock=new ng}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,s=this.passes.length;i<s;i++){const a=this.passes[i];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),a.needsSwap){if(r){const l=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}RX!==void 0&&(a instanceof RX?r=!0:a instanceof EAe&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new nn);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}const IAe={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};class RAe extends kv{constructor(e=64){super();const t=IAe;this.uniforms=Wm.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Io({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new rM(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=no.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=no.randFloat(-1,1),this.uniforms.seed_y.value=no.randFloat(-1,1),this.uniforms.distortion_x.value=no.randFloat(0,1),this.uniforms.distortion_y.value=no.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=no.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=no.randFloat(0,1),this.uniforms.distortion_y.value=no.randFloat(0,1),this.uniforms.seed_x.value=no.randFloat(-.3,.3),this.uniforms.seed_y.value=no.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=no.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),r=e*e;for(let s=0;s<r;s++){const a=no.randFloat(0,1);t[s]=a}const i=new $f(t,e,e,NT,Ac);return i.needsUpdate=!0,i}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class AD extends kv{constructor(e,t,r=null,i=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Vn}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let s,a;this.overrideMaterial!==null&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=a),e.autoClear=i}}function PAe(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),i=new Set(Object.keys(n[0].morphAttributes)),s={},a={},l=n[0].morphTargetsRelative,o=new $r;let h=0;for(let d=0;d<n.length;++d){const m=n[d];let v=0;if(t!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const y in m.attributes){if(!r.has(y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+y+'" attribute exists among all geometries, or in none of them.'),null;s[y]===void 0&&(s[y]=[]),s[y].push(m.attributes[y]),v++}if(v!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(l!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const y in m.morphAttributes){if(!i.has(y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;a[y]===void 0&&(a[y]=[]),a[y].push(m.morphAttributes[y])}if(e){let y;if(t)y=m.index.count;else if(m.attributes.position!==void 0)y=m.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;o.addGroup(h,y,d),h+=y}}if(t){let d=0;const m=[];for(let v=0;v<n.length;++v){const y=n[v].index;for(let S=0;S<y.count;++S)m.push(y.getX(S)+d);d+=n[v].attributes.position.count}o.setIndex(m)}for(const d in s){const m=PX(s[d]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" attribute."),null;o.setAttribute(d,m)}for(const d in a){const m=a[d][0].length;if(m===0)break;o.morphAttributes=o.morphAttributes||{},o.morphAttributes[d]=[];for(let v=0;v<m;++v){const y=[];for(let E=0;E<a[d].length;++E)y.push(a[d][E][v]);const S=PX(y);if(!S)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" morphAttribute."),null;o.morphAttributes[d].push(S)}}return o}function PX(n){let e,t,r,i=-1,s=0;for(let h=0;h<n.length;++h){const d=n[h];if(e===void 0&&(e=d.array.constructor),e!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=d.itemSize),t!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=d.normalized),r!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(i===-1&&(i=d.gpuType),i!==d.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=d.count*t}const a=new e(s),l=new Bi(a,t,r);let o=0;for(let h=0;h<n.length;++h){const d=n[h];if(d.isInterleavedBufferAttribute){const m=o/t;for(let v=0,y=d.count;v<y;v++)for(let S=0;S<t;S++){const E=d.getComponent(v,S);l.setComponent(v+m,S,E)}}else a.set(d.array,o);o+=d.count*t}return i!==void 0&&(l.gpuType=i),l}function LX(n,e){if(e===F6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Qy||e===UT){let t=n.getIndex();if(t===null){const a=[],l=n.getAttribute("position");if(l!==void 0){for(let o=0;o<l.count;o++)a.push(o);n.setIndex(a),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(e===Qy)for(let a=1;a<=r;a++)i.push(t.getX(0)),i.push(t.getX(a)),i.push(t.getX(a+1));else for(let a=0;a<r;a++)a%2===0?(i.push(t.getX(a)),i.push(t.getX(a+1)),i.push(t.getX(a+2))):(i.push(t.getX(a+2)),i.push(t.getX(a+1)),i.push(t.getX(a)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const LAe={1:"",2:"",3:"",4:"",5:"",6:"",7:""},fB=["37.5","","","","","","","","","","","","Yeah","hard"],DAe=[{value:5024.33,desc:"Distance"},{value:"0.22245%",desc:"oxygen level"},{value:205.24,desc:"Temperature"}],BAe={backgroundColor:"transparent",color:["#03c03c","#00e6f6","#8ae66e","#ff013c","#f9f002"],textStyle:{color:"#f9f002"},title:{text:"Kepler-90 Planetary System",textStyle:{color:"#f9f002",fontWeight:"normal"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0,borderColor:"#f9f002",show:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"],color:"#f9f002"}],yAxis:[{type:"value",color:"#f9f002"}],series:[{name:"Email",type:"line",stack:"Total",emphasis:{focus:"series"},data:[120,132,101,134,90,230,210],showSymbol:!1},{name:"Union Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[220,182,191,234,290,330,310]},{name:"Video Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[150,232,201,154,190,330,410]},{name:"Direct",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[320,332,301,334,390,330,320]},{name:"Search Engine",type:"line",stack:"Total",label:{show:!0,position:"top"},areaStyle:{},emphasis:{focus:"series"},data:[820,932,901,934,1290,1330,2400]}]},kAe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#000000"},series:[{name:"Kepler-90 Planetary system",type:"pie",radius:[25,100],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:4},data:[{value:40,name:"Kepler-90a"},{value:38,name:"Kepler-90b"},{value:32,name:"Kepler-90c"},{value:30,name:"Kepler-90i"},{value:28,name:"Kepler-90m"},{value:26,name:"Kepler-90s"},{value:22,name:"Kepler-90t"},{value:18,name:"Kepler-90z"}],label:{color:"#000000"}}]},OAe={backgroundColor:"transparent",color:["#f9f002","#00e6f6","#8ae66e","#ff013c"],dataset:{source:[["product","2012","2013","2014","2015","2016","2017"],["90a",86.5,92.1,85.7,83.1,73.4,55.1],["90i",41.1,30.4,65.1,53.3,83.8,98.7],["90t",24.1,67.2,79.5,86.4,65.2,82.5],["90z",55.2,67.1,69.2,72.4,53.9,39.1]]},series:[{type:"pie",radius:"20%",center:["25%","30%"],encode:{itemName:"product",value:"2012"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","30%"],encode:{itemName:"product",value:"2013"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["25%","75%"],encode:{itemName:"product",value:"2014"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","75%"],encode:{itemName:"product",value:"2015"},label:{color:"#f9f002"}}]},FAe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#f9f002"},radiusAxis:{type:"category",data:["v","w","x","y","z"],z:10},angleAxis:{max:2,startAngle:30,splitLine:{show:!1}},polar:{},series:[{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"Without Round Cap",itemStyle:{borderColor:"red",opacity:.8,borderWidth:1}},{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"With Round Cap",roundCap:!0,itemStyle:{borderColor:"green",opacity:.8,borderWidth:1}}]},NAe={backgroundColor:"transparent",textStyle:{color:"#000000"},title:{text:"Cyberpunk 2077 Fantastic",textStyle:{color:"#000000"}},color:["#80FFA5","#00DDFF","#37A2FF","#FF0087","#FFBF00"],tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"]}],yAxis:[{type:"value"}],series:[{name:"Line 1",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(128, 255, 165)"},{offset:1,color:"rgb(1, 191, 236)"}]}},emphasis:{focus:"series"},data:[140,232,101,264,90,340,250]},{name:"Line 2",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(77, 119, 255)"}]}},emphasis:{focus:"series"},data:[120,282,111,234,220,340,310]},{name:"Line 3",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(55, 162, 255)"},{offset:1,color:"rgb(116, 21, 219)"}]}},emphasis:{focus:"series"},data:[320,132,201,334,190,130,220]},{name:"Line 4",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 0, 135)"},{offset:1,color:"rgb(135, 0, 157)"}]}},emphasis:{focus:"series"},data:[220,402,231,134,190,230,120]},{name:"Line 5",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,label:{show:!0,position:"top"},areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 191, 0)"},{offset:1,color:"rgb(224, 62, 76)"}]}},emphasis:{focus:"series"},data:[220,302,181,234,210,290,150]}]},zAe="/about_portfolio/assets/earth-BrwlGRgR.jpg";var UAe=`precision mediump float;\r
uniform float actionRatio;\r
uniform float lineLength;\r
uniform vec3 diffuse;\r
uniform float opacity;\r
uniform float dashSize;\r
uniform float totalSize;\r
varying float vLineDistance;

#include <clipping_planes_pars_fragment>\r
#include <color_pars_fragment>\r
#include <common>\r
#include <fog_pars_fragment>\r
#include <logdepthbuf_pars_fragment>

vec3 linearTosRGB(vec3 color) { return pow(color, vec3(1.0 / 2.2)); }

vec3 gammaCorrect(vec3 color) {\r
  const float gamma = 2.2;\r
  return pow(color, vec3(1.0 / gamma));\r
}

void main() {\r
#include <clipping_planes_fragment>

  float halfDash = dashSize * 0.5;\r
  float currPos = (lineLength + dashSize) * actionRatio;\r
  float d = (vLineDistance + halfDash) - currPos;\r
  if (abs(d) > halfDash)\r
    discard; 

  float grad = ((vLineDistance + halfDash) - (currPos - halfDash)) / halfDash;\r
  vec3 outgoingLight = vec3(0.0);\r
  vec4 diffuseColor = vec4(diffuse, grad);\r
  
  
  
  gl_FragColor = diffuseColor;

#include <color_fragment>

#include <fog_fragment>\r
#include <logdepthbuf_fragment>

#include <premultiplied_alpha_fragment>\r
#include <tonemapping_fragment>\r
}`;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var VF=function(n,e){return VF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},VF(n,e)};function Hn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");VF(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var GAe=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),VAe=function(){function n(){this.browser=new GAe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),mi=new VAe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(mi.wxa=!0,mi.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?mi.worker=!0:typeof navigator>"u"||navigator.userAgent.indexOf("Node.js")===0?(mi.node=!0,mi.svgSupported=!0):HAe(navigator.userAgent,mi);function HAe(n,e){var t=e.browser,r=n.match(/Firefox\/([\d.]+)/),i=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),s=n.match(/Edge?\/([\d.]+)/),a=/micromessenger/i.test(n);r&&(t.firefox=!0,t.version=r[1]),i&&(t.ie=!0,t.version=i[1]),s&&(t.edge=!0,t.version=s[1],t.newEdge=+s[1].split(".")[0]>18),a&&(t.weChat=!0),e.svgSupported=typeof SVGRect<"u",e.touchEventsSupported="ontouchstart"in window&&!t.ie&&!t.edge,e.pointerEventsSupported="onpointerdown"in window&&(t.edge||t.ie&&+t.version>=11),e.domSupported=typeof document<"u";var l=document.documentElement.style;e.transform3dSupported=(t.ie&&"transition"in l||t.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in l)&&!("OTransition"in l),e.transformSupported=e.transform3dSupported||t.ie&&+t.version>=9}var wU=12,jAe="sans-serif",r1=wU+"px "+jAe,WAe=20,XAe=100,$Ae="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function qAe(n){var e={};if(typeof JSON>"u")return e;for(var t=0;t<n.length;t++){var r=String.fromCharCode(t+32),i=(n.charCodeAt(t)-WAe)/XAe;e[r]=i}return e}var ZAe=qAe($Ae),Sw={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,e;return function(t,r){if(!n){var i=Sw.createCanvas();n=i&&i.getContext("2d")}if(n)return e!==r&&(e=n.font=r||r1),n.measureText(t);t=t||"",r=r||r1;var s=/((?:\d+)?\.?\d*)px/.exec(r),a=s&&+s[1]||wU,l=0;if(r.indexOf("mono")>=0)l=a*t.length;else for(var o=0;o<t.length;o++){var h=ZAe[t[o]];l+=h==null?a:h*a}return{width:l}}}(),loadImage:function(n,e,t){var r=new Image;return r.onload=e,r.onerror=t,r.src=n,r}},Pre=pv(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,e){return n["[object "+e+"]"]=!0,n},{}),Lre=pv(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,e){return n["[object "+e+"Array]"]=!0,n},{}),Aw=Object.prototype.toString,TD=Array.prototype,YAe=TD.forEach,KAe=TD.filter,SU=TD.slice,JAe=TD.map,DX=(function(){}).constructor,ME=DX?DX.prototype:null,AU="__proto__",QAe=2311;function Dre(){return QAe++}function TU(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];typeof console<"u"&&console.error.apply(console,n)}function _i(n){if(n==null||typeof n!="object")return n;var e=n,t=Aw.call(n);if(t==="[object Array]"){if(!rA(n)){e=[];for(var r=0,i=n.length;r<i;r++)e[r]=_i(n[r])}}else if(Lre[t]){if(!rA(n)){var s=n.constructor;if(s.from)e=s.from(n);else{e=new s(n.length);for(var r=0,i=n.length;r<i;r++)e[r]=n[r]}}}else if(!Pre[t]&&!rA(n)&&!nw(n)){e={};for(var a in n)n.hasOwnProperty(a)&&a!==AU&&(e[a]=_i(n[a]))}return e}function Di(n,e,t){if(!Xr(e)||!Xr(n))return t?_i(e):n;for(var r in e)if(e.hasOwnProperty(r)&&r!==AU){var i=n[r],s=e[r];Xr(s)&&Xr(i)&&!fr(s)&&!fr(i)&&!nw(s)&&!nw(i)&&!BX(s)&&!BX(i)&&!rA(s)&&!rA(i)?Di(i,s,t):(t||!(r in n))&&(n[r]=_i(e[r]))}return n}function Jn(n,e){if(Object.assign)Object.assign(n,e);else for(var t in e)e.hasOwnProperty(t)&&t!==AU&&(n[t]=e[t]);return n}function ti(n,e,t){for(var r=so(e),i=0;i<r.length;i++){var s=r[i];n[s]==null&&(n[s]=e[s])}return n}function Xi(n,e){if(n){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t}return-1}function eTe(n,e){var t=n.prototype;function r(){}r.prototype=e.prototype,n.prototype=new r;for(var i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i]);n.prototype.constructor=n,n.superClass=e}function sd(n,e,t){if(n="prototype"in n?n.prototype:n,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var s=r[i];s!=="constructor"&&n[s]==null&&(n[s]=e[s])}else ti(n,e)}function Ic(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function it(n,e,t){if(n&&e)if(n.forEach&&n.forEach===YAe)n.forEach(e,t);else if(n.length===+n.length)for(var r=0,i=n.length;r<i;r++)e.call(t,n[r],r,n);else for(var s in n)n.hasOwnProperty(s)&&e.call(t,n[s],s,n)}function xr(n,e,t){if(!n)return[];if(!e)return MU(n);if(n.map&&n.map===JAe)return n.map(e,t);for(var r=[],i=0,s=n.length;i<s;i++)r.push(e.call(t,n[i],i,n));return r}function pv(n,e,t,r){if(n&&e){for(var i=0,s=n.length;i<s;i++)t=e.call(r,t,n[i],i,n);return t}}function na(n,e,t){if(!n)return[];if(!e)return MU(n);if(n.filter&&n.filter===KAe)return n.filter(e,t);for(var r=[],i=0,s=n.length;i<s;i++)e.call(t,n[i],i,n)&&r.push(n[i]);return r}function so(n){if(!n)return[];if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e}function tTe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return function(){return n.apply(e,t.concat(SU.call(arguments)))}}var zs=ME&&ci(ME.bind)?ME.call.bind(ME.bind):tTe;function vs(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){return n.apply(this,e.concat(SU.call(arguments)))}}function fr(n){return Array.isArray?Array.isArray(n):Aw.call(n)==="[object Array]"}function ci(n){return typeof n=="function"}function Dr(n){return typeof n=="string"}function HF(n){return Aw.call(n)==="[object String]"}function Rs(n){return typeof n=="number"}function Xr(n){var e=typeof n;return e==="function"||!!n&&e==="object"}function BX(n){return!!Pre[Aw.call(n)]}function du(n){return!!Lre[Aw.call(n)]}function nw(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function MD(n){return n.colorStops!=null}function nTe(n){return n.image!=null}function rTe(n){return Aw.call(n)==="[object RegExp]"}function wP(n){return n!==n}function iT(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=0,r=n.length;t<r;t++)if(n[t]!=null)return n[t]}function Ei(n,e){return n??e}function nA(n,e,t){return n??e??t}function MU(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return SU.apply(n,e)}function Bre(n){if(typeof n=="number")return[n,n,n,n];var e=n.length;return e===2?[n[0],n[1],n[0],n[1]]:e===3?[n[0],n[1],n[2],n[1]]:n}function pp(n,e){if(!n)throw new Error(e)}function tp(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var kre="__ec_primitive__";function SP(n){n[kre]=!0}function rA(n){return n[kre]}var iTe=function(){function n(){this.data={}}return n.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.get=function(e){return this.data[e]},n.prototype.set=function(e,t){return this.data[e]=t,this},n.prototype.keys=function(){return so(this.data)},n.prototype.forEach=function(e){var t=this.data;for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},n}(),Ore=typeof Map=="function";function sTe(){return Ore?new Map:new iTe}var oTe=function(){function n(e){var t=fr(e);this.data=sTe();var r=this;e instanceof n?e.each(i):e&&it(e,i);function i(s,a){t?r.set(s,a):r.set(a,s)}}return n.prototype.hasKey=function(e){return this.data.has(e)},n.prototype.get=function(e){return this.data.get(e)},n.prototype.set=function(e,t){return this.data.set(e,t),t},n.prototype.each=function(e,t){this.data.forEach(function(r,i){e.call(t,r,i)})},n.prototype.keys=function(){var e=this.data.keys();return Ore?Array.from(e):e},n.prototype.removeKey=function(e){this.data.delete(e)},n}();function ii(n){return new oTe(n)}function aTe(n,e){for(var t=new n.constructor(n.length+e.length),r=0;r<n.length;r++)t[r]=n[r];for(var i=n.length,r=0;r<e.length;r++)t[r+i]=e[r];return t}function CD(n,e){var t;if(Object.create)t=Object.create(n);else{var r=function(){};r.prototype=n,t=new r}return e&&Jn(t,e),t}function Fre(n){var e=n.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function Ym(n,e){return n.hasOwnProperty(e)}function Ec(){}var lTe=180/Math.PI;function Tw(n,e){return n==null&&(n=0),e==null&&(e=0),[n,e]}function cTe(n){return[n[0],n[1]]}function kX(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function uTe(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function hTe(n){return Math.sqrt(fTe(n))}function fTe(n){return n[0]*n[0]+n[1]*n[1]}function dB(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function dTe(n,e){var t=hTe(e);return t===0?(n[0]=0,n[1]=0):(n[0]=e[0]/t,n[1]=e[1]/t),n}function jF(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var WF=jF;function pTe(n,e){return(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])}var Db=pTe;function $I(n,e,t,r){return n[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n}function Eh(n,e,t){var r=e[0],i=e[1];return n[0]=t[0]*r+t[2]*i+t[4],n[1]=t[1]*r+t[3]*i+t[5],n}function yb(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function xb(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}var Mx=function(){function n(e,t){this.target=e,this.topTarget=t&&t.topTarget}return n}(),mTe=function(){function n(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new Mx(t,e),"dragstart",e.event))},n.prototype._drag=function(e){var t=this._draggingTarget;if(t){var r=e.offsetX,i=e.offsetY,s=r-this._x,a=i-this._y;this._x=r,this._y=i,t.drift(s,a,e),this.handler.dispatchToElement(new Mx(t,e),"drag",e.event);var l=this.handler.findHover(r,i,t).target,o=this._dropTarget;this._dropTarget=l,t!==l&&(o&&l!==o&&this.handler.dispatchToElement(new Mx(o,e),"dragleave",e.event),l&&l!==o&&this.handler.dispatchToElement(new Mx(l,e),"dragenter",e.event))}},n.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new Mx(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new Mx(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},n}(),od=function(){function n(e){e&&(this._$eventProcessor=e)}return n.prototype.on=function(e,t,r,i){this._$handlers||(this._$handlers={});var s=this._$handlers;if(typeof t=="function"&&(i=r,r=t,t=null),!r||!e)return this;var a=this._$eventProcessor;t!=null&&a&&a.normalizeQuery&&(t=a.normalizeQuery(t)),s[e]||(s[e]=[]);for(var l=0;l<s[e].length;l++)if(s[e][l].h===r)return this;var o={h:r,query:t,ctx:i||this,callAtLast:r.zrEventfulCallAtLast},h=s[e].length-1,d=s[e][h];return d&&d.callAtLast?s[e].splice(h,0,o):s[e].push(o),this},n.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},n.prototype.off=function(e,t){var r=this._$handlers;if(!r)return this;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var i=[],s=0,a=r[e].length;s<a;s++)r[e][s].h!==t&&i.push(r[e][s]);r[e]=i}r[e]&&r[e].length===0&&delete r[e]}else delete r[e];return this},n.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],s=this._$eventProcessor;if(i)for(var a=t.length,l=i.length,o=0;o<l;o++){var h=i[o];if(!(s&&s.filter&&h.query!=null&&!s.filter(e,h.query)))switch(a){case 0:h.h.call(h.ctx);break;case 1:h.h.call(h.ctx,t[0]);break;case 2:h.h.call(h.ctx,t[0],t[1]);break;default:h.h.apply(h.ctx,t);break}}return s&&s.afterTrigger&&s.afterTrigger(e),this},n.prototype.triggerWithContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],s=this._$eventProcessor;if(i)for(var a=t.length,l=t[a-1],o=i.length,h=0;h<o;h++){var d=i[h];if(!(s&&s.filter&&d.query!=null&&!s.filter(e,d.query)))switch(a){case 0:d.h.call(l);break;case 1:d.h.call(l,t[0]);break;case 2:d.h.call(l,t[0],t[1]);break;default:d.h.apply(l,t.slice(1,a-1));break}}return s&&s.afterTrigger&&s.afterTrigger(e),this},n}(),gTe=Math.log(2);function XF(n,e,t,r,i,s){var a=r+"-"+i,l=n.length;if(s.hasOwnProperty(a))return s[a];if(e===1){var o=Math.round(Math.log((1<<l)-1&~i)/gTe);return n[t][o]}for(var h=r|1<<t,d=t+1;r&1<<d;)d++;for(var m=0,v=0,y=0;v<l;v++){var S=1<<v;S&i||(m+=(y%2?-1:1)*n[t][v]*XF(n,e-1,d,h,i|S,s),y++)}return s[a]=m,m}function OX(n,e){var t=[[n[0],n[1],1,0,0,0,-e[0]*n[0],-e[0]*n[1]],[0,0,0,n[0],n[1],1,-e[1]*n[0],-e[1]*n[1]],[n[2],n[3],1,0,0,0,-e[2]*n[2],-e[2]*n[3]],[0,0,0,n[2],n[3],1,-e[3]*n[2],-e[3]*n[3]],[n[4],n[5],1,0,0,0,-e[4]*n[4],-e[4]*n[5]],[0,0,0,n[4],n[5],1,-e[5]*n[4],-e[5]*n[5]],[n[6],n[7],1,0,0,0,-e[6]*n[6],-e[6]*n[7]],[0,0,0,n[6],n[7],1,-e[7]*n[6],-e[7]*n[7]]],r={},i=XF(t,8,0,0,0,r);if(i!==0){for(var s=[],a=0;a<8;a++)for(var l=0;l<8;l++)s[l]==null&&(s[l]=0),s[l]+=((a+l)%2?-1:1)*XF(t,7,a===0?1:0,1<<a,1<<l,r)/i*e[a];return function(o,h,d){var m=h*s[6]+d*s[7]+1;o[0]=(h*s[0]+d*s[1]+s[2])/m,o[1]=(h*s[3]+d*s[4]+s[5])/m}}}var FX="___zrEVENTSAVED",pB=[];function vTe(n,e,t,r,i){return $F(pB,e,r,i,!0)&&$F(n,t,pB[0],pB[1])}function $F(n,e,t,r,i){if(e.getBoundingClientRect&&mi.domSupported&&!Nre(e)){var s=e[FX]||(e[FX]={}),a=_Te(e,s),l=yTe(a,s,i);if(l)return l(n,t,r),!0}return!1}function _Te(n,e){var t=e.markers;if(t)return t;t=e.markers=[];for(var r=["left","right"],i=["top","bottom"],s=0;s<4;s++){var a=document.createElement("div"),l=a.style,o=s%2,h=(s>>1)%2;l.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[o]+":0",i[h]+":0",r[1-o]+":auto",i[1-h]+":auto",""].join("!important;"),n.appendChild(a),t.push(a)}return t}function yTe(n,e,t){for(var r=t?"invTrans":"trans",i=e[r],s=e.srcCoords,a=[],l=[],o=!0,h=0;h<4;h++){var d=n[h].getBoundingClientRect(),m=2*h,v=d.left,y=d.top;a.push(v,y),o=o&&s&&v===s[m]&&y===s[m+1],l.push(n[h].offsetLeft,n[h].offsetTop)}return o&&i?i:(e.srcCoords=a,e[r]=t?OX(l,a):OX(a,l))}function Nre(n){return n.nodeName.toUpperCase()==="CANVAS"}var xTe=/([&<>"'])/g,bTe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Pu(n){return n==null?"":(n+"").replace(xTe,function(e,t){return bTe[t]})}var wTe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,mB=[],STe=mi.browser.firefox&&+mi.browser.version.split(".")[0]<39;function qF(n,e,t,r){return t=t||{},r?NX(n,e,t):STe&&e.layerX!=null&&e.layerX!==e.offsetX?(t.zrX=e.layerX,t.zrY=e.layerY):e.offsetX!=null?(t.zrX=e.offsetX,t.zrY=e.offsetY):NX(n,e,t),t}function NX(n,e,t){if(mi.domSupported&&n.getBoundingClientRect){var r=e.clientX,i=e.clientY;if(Nre(n)){var s=n.getBoundingClientRect();t.zrX=r-s.left,t.zrY=i-s.top;return}else if($F(mB,n,r,i)){t.zrX=mB[0],t.zrY=mB[1];return}}t.zrX=t.zrY=0}function CU(n){return n||window.event}function ph(n,e,t){if(e=CU(e),e.zrX!=null)return e;var r=e.type,i=r&&r.indexOf("touch")>=0;if(i){var a=r!=="touchend"?e.targetTouches[0]:e.changedTouches[0];a&&qF(n,a,e,t)}else{qF(n,e,e,t);var s=ATe(e);e.zrDelta=s?s/120:-(e.detail||0)/3}var l=e.button;return e.which==null&&l!==void 0&&wTe.test(e.type)&&(e.which=l&1?1:l&2?3:l&4?2:0),e}function ATe(n){var e=n.wheelDelta;if(e)return e;var t=n.deltaX,r=n.deltaY;if(t==null||r==null)return e;var i=Math.abs(r!==0?r:t),s=r>0?-1:r<0?1:t>0?-1:1;return 3*i*s}function ZF(n,e,t,r){n.addEventListener(e,t,r)}function TTe(n,e,t,r){n.removeEventListener(e,t,r)}var zre=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0},MTe=function(){function n(){this._track=[]}return n.prototype.recognize=function(e,t,r){return this._doTrack(e,t,r),this._recognize(e)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(e,t,r){var i=e.touches;if(i){for(var s={points:[],touches:[],target:t,event:e},a=0,l=i.length;a<l;a++){var o=i[a],h=qF(r,o,{});s.points.push([h.zrX,h.zrY]),s.touches.push(o)}this._track.push(s)}},n.prototype._recognize=function(e){for(var t in gB)if(gB.hasOwnProperty(t)){var r=gB[t](this._track,e);if(r)return r}},n}();function zX(n){var e=n[1][0]-n[0][0],t=n[1][1]-n[0][1];return Math.sqrt(e*e+t*t)}function CTe(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var gB={pinch:function(n,e){var t=n.length;if(t){var r=(n[t-1]||{}).points,i=(n[t-2]||{}).points||r;if(i&&i.length>1&&r&&r.length>1){var s=zX(r)/zX(i);!isFinite(s)&&(s=1),e.pinchScale=s;var a=CTe(r);return e.pinchX=a[0],e.pinchY=a[1],{type:"pinch",target:n[0].target,event:e}}}}};function Ny(){return[1,0,0,1,0,0]}function EU(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function ETe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Bb(n,e,t){var r=e[0]*t[0]+e[2]*t[1],i=e[1]*t[0]+e[3]*t[1],s=e[0]*t[2]+e[2]*t[3],a=e[1]*t[2]+e[3]*t[3],l=e[0]*t[4]+e[2]*t[5]+e[4],o=e[1]*t[4]+e[3]*t[5]+e[5];return n[0]=r,n[1]=i,n[2]=s,n[3]=a,n[4]=l,n[5]=o,n}function AP(n,e,t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4]+t[0],n[5]=e[5]+t[1],n}function ED(n,e,t,r){r===void 0&&(r=[0,0]);var i=e[0],s=e[2],a=e[4],l=e[1],o=e[3],h=e[5],d=Math.sin(t),m=Math.cos(t);return n[0]=i*m+l*d,n[1]=-i*d+l*m,n[2]=s*m+o*d,n[3]=-s*d+m*o,n[4]=m*(a-r[0])+d*(h-r[1])+r[0],n[5]=m*(h-r[1])-d*(a-r[0])+r[1],n}function ITe(n,e,t){var r=t[0],i=t[1];return n[0]=e[0]*r,n[1]=e[1]*i,n[2]=e[2]*r,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*i,n}function ID(n,e){var t=e[0],r=e[2],i=e[4],s=e[1],a=e[3],l=e[5],o=t*a-s*r;return o?(o=1/o,n[0]=a*o,n[1]=-s*o,n[2]=-r*o,n[3]=t*o,n[4]=(r*l-a*i)*o,n[5]=(s*i-t*l)*o,n):null}var Jr=function(){function n(e,t){this.x=e||0,this.y=t||0}return n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(e,t){return this.x=e,this.y=t,this},n.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},n.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},n.prototype.scale=function(e){this.x*=e,this.y*=e},n.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},n.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},n.prototype.dot=function(e){return this.x*e.x+this.y*e.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},n.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},n.prototype.distanceSquare=function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(e){if(e){var t=this.x,r=this.y;return this.x=e[0]*t+e[2]*r+e[4],this.y=e[1]*t+e[3]*r+e[5],this}},n.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},n.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},n.set=function(e,t,r){e.x=t,e.y=r},n.copy=function(e,t){e.x=t.x,e.y=t.y},n.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.lenSquare=function(e){return e.x*e.x+e.y*e.y},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.add=function(e,t,r){e.x=t.x+r.x,e.y=t.y+r.y},n.sub=function(e,t,r){e.x=t.x-r.x,e.y=t.y-r.y},n.scale=function(e,t,r){e.x=t.x*r,e.y=t.y*r},n.scaleAndAdd=function(e,t,r,i){e.x=t.x+r.x*i,e.y=t.y+r.y*i},n.lerp=function(e,t,r,i){var s=1-i;e.x=s*t.x+i*r.x,e.y=s*t.y+i*r.y},n}(),CE=Math.min,EE=Math.max,L_=new Jr,D_=new Jr,B_=new Jr,k_=new Jr,G2=new Jr,V2=new Jr,RTe=function(){function n(e,t,r,i){r<0&&(e=e+r,r=-r),i<0&&(t=t+i,i=-i),this.x=e,this.y=t,this.width=r,this.height=i}return n.prototype.union=function(e){var t=CE(e.x,this.x),r=CE(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=EE(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=EE(e.y+e.height,this.y+this.height)-r:this.height=e.height,this.x=t,this.y=r},n.prototype.applyTransform=function(e){n.applyTransform(this,this,e)},n.prototype.calculateTransform=function(e){var t=this,r=e.width/t.width,i=e.height/t.height,s=Ny();return AP(s,s,[-t.x,-t.y]),ITe(s,s,[r,i]),AP(s,s,[e.x,e.y]),s},n.prototype.intersect=function(e,t){if(!e)return!1;e instanceof n||(e=n.create(e));var r=this,i=r.x,s=r.x+r.width,a=r.y,l=r.y+r.height,o=e.x,h=e.x+e.width,d=e.y,m=e.y+e.height,v=!(s<o||h<i||l<d||m<a);if(t){var y=1/0,S=0,E=Math.abs(s-o),M=Math.abs(h-i),C=Math.abs(l-d),L=Math.abs(m-a),k=Math.min(E,M),H=Math.min(C,L);s<o||h<i?k>S&&(S=k,E<M?Jr.set(V2,-E,0):Jr.set(V2,M,0)):k<y&&(y=k,E<M?Jr.set(G2,E,0):Jr.set(G2,-M,0)),l<d||m<a?H>S&&(S=H,C<L?Jr.set(V2,0,-C):Jr.set(V2,0,L)):k<y&&(y=k,C<L?Jr.set(G2,0,C):Jr.set(G2,0,-L))}return t&&Jr.copy(t,v?G2:V2),v},n.prototype.contain=function(e,t){var r=this;return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(e){n.copy(this,e)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(e){return new n(e.x,e.y,e.width,e.height)},n.copy=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},n.applyTransform=function(e,t,r){if(!r){e!==t&&n.copy(e,t);return}if(r[1]<1e-5&&r[1]>-1e-5&&r[2]<1e-5&&r[2]>-1e-5){var i=r[0],s=r[3],a=r[4],l=r[5];e.x=t.x*i+a,e.y=t.y*s+l,e.width=t.width*i,e.height=t.height*s,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}L_.x=B_.x=t.x,L_.y=k_.y=t.y,D_.x=k_.x=t.x+t.width,D_.y=B_.y=t.y+t.height,L_.transform(r),k_.transform(r),D_.transform(r),B_.transform(r),e.x=CE(L_.x,D_.x,B_.x,k_.x),e.y=CE(L_.y,D_.y,B_.y,k_.y);var o=EE(L_.x,D_.x,B_.x,k_.x),h=EE(L_.y,D_.y,B_.y,k_.y);e.width=o-e.x,e.height=h-e.y},n}();const cs=RTe;var Ure="silent";function PTe(n,e,t){return{type:n,event:t,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:t.zrX,offsetY:t.zrY,gestureEvent:t.gestureEvent,pinchX:t.pinchX,pinchY:t.pinchY,pinchScale:t.pinchScale,wheelDelta:t.zrDelta,zrByTouch:t.zrByTouch,which:t.which,stop:LTe}}function LTe(){zre(this.event)}var DTe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.handler=null,t}return e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(od),H2=function(){function n(e,t){this.x=e,this.y=t}return n}(),BTe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],vB=new cs(0,0,0,0),Gre=function(n){Hn(e,n);function e(t,r,i,s,a){var l=n.call(this)||this;return l._hovered=new H2(0,0),l.storage=t,l.painter=r,l.painterRoot=s,l._pointerSize=a,i=i||new DTe,l.proxy=null,l.setHandlerProxy(i),l._draggingMgr=new mTe(l),l}return e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(it(BTe,function(r){t.on&&t.on(r,this[r],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var r=t.zrX,i=t.zrY,s=Vre(this,r,i),a=this._hovered,l=a.target;l&&!l.__zr&&(a=this.findHover(a.x,a.y),l=a.target);var o=this._hovered=s?new H2(r,i):this.findHover(r,i),h=o.target,d=this.proxy;d.setCursor&&d.setCursor(h?h.cursor:"default"),l&&h!==l&&this.dispatchToElement(a,"mouseout",t),this.dispatchToElement(o,"mousemove",t),h&&h!==l&&this.dispatchToElement(o,"mouseover",t)},e.prototype.mouseout=function(t){var r=t.zrEventControl;r!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",t),r!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this._hovered=new H2(0,0)},e.prototype.dispatch=function(t,r){var i=this[t];i&&i.call(this,r)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var r=this.proxy;r.setCursor&&r.setCursor(t)},e.prototype.dispatchToElement=function(t,r,i){t=t||{};var s=t.target;if(!(s&&s.silent)){for(var a="on"+r,l=PTe(r,t,i);s&&(s[a]&&(l.cancelBubble=!!s[a].call(s,l)),s.trigger(r,l),s=s.__hostTarget?s.__hostTarget:s.parent,!l.cancelBubble););l.cancelBubble||(this.trigger(r,l),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(o){typeof o[a]=="function"&&o[a].call(o,l),o.trigger&&o.trigger(r,l)}))}},e.prototype.findHover=function(t,r,i){var s=this.storage.getDisplayList(),a=new H2(t,r);if(UX(s,a,t,r,i),this._pointerSize&&!a.target){for(var l=[],o=this._pointerSize,h=o/2,d=new cs(t-h,r-h,o,o),m=s.length-1;m>=0;m--){var v=s[m];v!==i&&!v.ignore&&!v.ignoreCoarsePointer&&(!v.parent||!v.parent.ignoreCoarsePointer)&&(vB.copy(v.getBoundingRect()),v.transform&&vB.applyTransform(v.transform),vB.intersect(d)&&l.push(v))}if(l.length)for(var y=4,S=Math.PI/12,E=Math.PI*2,M=0;M<h;M+=y)for(var C=0;C<E;C+=S){var L=t+M*Math.cos(C),k=r+M*Math.sin(C);if(UX(l,a,L,k,i),a.target)return a}}return a},e.prototype.processGesture=function(t,r){this._gestureMgr||(this._gestureMgr=new MTe);var i=this._gestureMgr;r==="start"&&i.clear();var s=i.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if(r==="end"&&i.clear(),s){var a=s.type;t.gestureEvent=a;var l=new H2;l.target=s.target,this.dispatchToElement(l,a,s.event)}},e}(od);it(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){Gre.prototype[n]=function(e){var t=e.zrX,r=e.zrY,i=Vre(this,t,r),s,a;if((n!=="mouseup"||!i)&&(s=this.findHover(t,r),a=s.target),n==="mousedown")this._downEl=a,this._downPoint=[e.zrX,e.zrY],this._upEl=a;else if(n==="mouseup")this._upEl=a;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||WF(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(s,n,e)}});function kTe(n,e,t){if(n[n.rectHover?"rectContain":"contain"](e,t)){for(var r=n,i=void 0,s=!1;r;){if(r.ignoreClip&&(s=!0),!s){var a=r.getClipPath();if(a&&!a.contain(e,t))return!1}r.silent&&(i=!0);var l=r.__hostTarget;r=l||r.parent}return i?Ure:!0}return!1}function UX(n,e,t,r,i){for(var s=n.length-1;s>=0;s--){var a=n[s],l=void 0;if(a!==i&&!a.ignore&&(l=kTe(a,t,r))&&(!e.topTarget&&(e.topTarget=a),l!==Ure)){e.target=a;break}}}function Vre(n,e,t){var r=n.painter;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var Hre=32,j2=7;function OTe(n){for(var e=0;n>=Hre;)e|=n&1,n>>=1;return n+e}function GX(n,e,t,r){var i=e+1;if(i===t)return 1;if(r(n[i++],n[e])<0){for(;i<t&&r(n[i],n[i-1])<0;)i++;FTe(n,e,i)}else for(;i<t&&r(n[i],n[i-1])>=0;)i++;return i-e}function FTe(n,e,t){for(t--;e<t;){var r=n[e];n[e++]=n[t],n[t--]=r}}function VX(n,e,t,r,i){for(r===e&&r++;r<t;r++){for(var s=n[r],a=e,l=r,o;a<l;)o=a+l>>>1,i(s,n[o])<0?l=o:a=o+1;var h=r-a;switch(h){case 3:n[a+3]=n[a+2];case 2:n[a+2]=n[a+1];case 1:n[a+1]=n[a];break;default:for(;h>0;)n[a+h]=n[a+h-1],h--}n[a]=s}}function _B(n,e,t,r,i,s){var a=0,l=0,o=1;if(s(n,e[t+i])>0){for(l=r-i;o<l&&s(n,e[t+i+o])>0;)a=o,o=(o<<1)+1,o<=0&&(o=l);o>l&&(o=l),a+=i,o+=i}else{for(l=i+1;o<l&&s(n,e[t+i-o])<=0;)a=o,o=(o<<1)+1,o<=0&&(o=l);o>l&&(o=l);var h=a;a=i-o,o=i-h}for(a++;a<o;){var d=a+(o-a>>>1);s(n,e[t+d])>0?a=d+1:o=d}return o}function yB(n,e,t,r,i,s){var a=0,l=0,o=1;if(s(n,e[t+i])<0){for(l=i+1;o<l&&s(n,e[t+i-o])<0;)a=o,o=(o<<1)+1,o<=0&&(o=l);o>l&&(o=l);var h=a;a=i-o,o=i-h}else{for(l=r-i;o<l&&s(n,e[t+i+o])>=0;)a=o,o=(o<<1)+1,o<=0&&(o=l);o>l&&(o=l),a+=i,o+=i}for(a++;a<o;){var d=a+(o-a>>>1);s(n,e[t+d])<0?o=d:a=d+1}return o}function NTe(n,e){var t=j2,r,i,s=0,a=[];r=[],i=[];function l(y,S){r[s]=y,i[s]=S,s+=1}function o(){for(;s>1;){var y=s-2;if(y>=1&&i[y-1]<=i[y]+i[y+1]||y>=2&&i[y-2]<=i[y]+i[y-1])i[y-1]<i[y+1]&&y--;else if(i[y]>i[y+1])break;d(y)}}function h(){for(;s>1;){var y=s-2;y>0&&i[y-1]<i[y+1]&&y--,d(y)}}function d(y){var S=r[y],E=i[y],M=r[y+1],C=i[y+1];i[y]=E+C,y===s-3&&(r[y+1]=r[y+2],i[y+1]=i[y+2]),s--;var L=yB(n[M],n,S,E,0,e);S+=L,E-=L,E!==0&&(C=_B(n[S+E-1],n,M,C,C-1,e),C!==0&&(E<=C?m(S,E,M,C):v(S,E,M,C)))}function m(y,S,E,M){var C=0;for(C=0;C<S;C++)a[C]=n[y+C];var L=0,k=E,H=y;if(n[H++]=n[k++],--M===0){for(C=0;C<S;C++)n[H+C]=a[L+C];return}if(S===1){for(C=0;C<M;C++)n[H+C]=n[k+C];n[H+M]=a[L];return}for(var q=t,Z,ee,re;;){Z=0,ee=0,re=!1;do if(e(n[k],a[L])<0){if(n[H++]=n[k++],ee++,Z=0,--M===0){re=!0;break}}else if(n[H++]=a[L++],Z++,ee=0,--S===1){re=!0;break}while((Z|ee)<q);if(re)break;do{if(Z=yB(n[k],a,L,S,0,e),Z!==0){for(C=0;C<Z;C++)n[H+C]=a[L+C];if(H+=Z,L+=Z,S-=Z,S<=1){re=!0;break}}if(n[H++]=n[k++],--M===0){re=!0;break}if(ee=_B(a[L],n,k,M,0,e),ee!==0){for(C=0;C<ee;C++)n[H+C]=n[k+C];if(H+=ee,k+=ee,M-=ee,M===0){re=!0;break}}if(n[H++]=a[L++],--S===1){re=!0;break}q--}while(Z>=j2||ee>=j2);if(re)break;q<0&&(q=0),q+=2}if(t=q,t<1&&(t=1),S===1){for(C=0;C<M;C++)n[H+C]=n[k+C];n[H+M]=a[L]}else{if(S===0)throw new Error;for(C=0;C<S;C++)n[H+C]=a[L+C]}}function v(y,S,E,M){var C=0;for(C=0;C<M;C++)a[C]=n[E+C];var L=y+S-1,k=M-1,H=E+M-1,q=0,Z=0;if(n[H--]=n[L--],--S===0){for(q=H-(M-1),C=0;C<M;C++)n[q+C]=a[C];return}if(M===1){for(H-=S,L-=S,Z=H+1,q=L+1,C=S-1;C>=0;C--)n[Z+C]=n[q+C];n[H]=a[k];return}for(var ee=t;;){var re=0,se=0,ae=!1;do if(e(a[k],n[L])<0){if(n[H--]=n[L--],re++,se=0,--S===0){ae=!0;break}}else if(n[H--]=a[k--],se++,re=0,--M===1){ae=!0;break}while((re|se)<ee);if(ae)break;do{if(re=S-yB(a[k],n,y,S,S-1,e),re!==0){for(H-=re,L-=re,S-=re,Z=H+1,q=L+1,C=re-1;C>=0;C--)n[Z+C]=n[q+C];if(S===0){ae=!0;break}}if(n[H--]=a[k--],--M===1){ae=!0;break}if(se=M-_B(n[L],a,0,M,M-1,e),se!==0){for(H-=se,k-=se,M-=se,Z=H+1,q=k+1,C=0;C<se;C++)n[Z+C]=a[q+C];if(M<=1){ae=!0;break}}if(n[H--]=n[L--],--S===0){ae=!0;break}ee--}while(re>=j2||se>=j2);if(ae)break;ee<0&&(ee=0),ee+=2}if(t=ee,t<1&&(t=1),M===1){for(H-=S,L-=S,Z=H+1,q=L+1,C=S-1;C>=0;C--)n[Z+C]=n[q+C];n[H]=a[k]}else{if(M===0)throw new Error;for(q=H-(M-1),C=0;C<M;C++)n[q+C]=a[C]}}return{mergeRuns:o,forceMergeRuns:h,pushRun:l}}function qI(n,e,t,r){t||(t=0),r||(r=n.length);var i=r-t;if(!(i<2)){var s=0;if(i<Hre){s=GX(n,t,r,e),VX(n,t,r,t+s,e);return}var a=NTe(n,e),l=OTe(i);do{if(s=GX(n,t,r,e),s<l){var o=i;o>l&&(o=l),VX(n,t,t+o,t+s,e),s=o}a.pushRun(t,s),a.mergeRuns(),i-=s,t+=s}while(i!==0);a.forceMergeRuns()}}var Lu=1,AS=2,Kx=4,HX=!1;function xB(){HX||(HX=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function jX(n,e){return n.zlevel===e.zlevel?n.z===e.z?n.z2-e.z2:n.z-e.z:n.zlevel-e.zlevel}var zTe=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=jX}return n.prototype.traverse=function(e,t){for(var r=0;r<this._roots.length;r++)this._roots[r].traverse(e,t)},n.prototype.getDisplayList=function(e,t){t=t||!1;var r=this._displayList;return(e||!r.length)&&this.updateDisplayList(t),r},n.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,r=this._displayList,i=0,s=t.length;i<s;i++)this._updateAndAddDisplayable(t[i],null,e);r.length=this._displayListLen,qI(r,jX)},n.prototype._updateAndAddDisplayable=function(e,t,r){if(!(e.ignore&&!r)){e.beforeUpdate(),e.update(),e.afterUpdate();var i=e.getClipPath();if(e.ignoreClip)t=null;else if(i){t?t=t.slice():t=[];for(var s=i,a=e;s;)s.parent=a,s.updateTransform(),t.push(s),a=s,s=s.getClipPath()}if(e.childrenRef){for(var l=e.childrenRef(),o=0;o<l.length;o++){var h=l[o];e.__dirty&&(h.__dirty|=Lu),this._updateAndAddDisplayable(h,t,r)}e.__dirty=0}else{var d=e;t&&t.length?d.__clipPaths=t:d.__clipPaths&&d.__clipPaths.length>0&&(d.__clipPaths=[]),isNaN(d.z)&&(xB(),d.z=0),isNaN(d.z2)&&(xB(),d.z2=0),isNaN(d.zlevel)&&(xB(),d.zlevel=0),this._displayList[this._displayListLen++]=d}var m=e.getDecalElement&&e.getDecalElement();m&&this._updateAndAddDisplayable(m,t,r);var v=e.getTextGuideLine();v&&this._updateAndAddDisplayable(v,t,r);var y=e.getTextContent();y&&this._updateAndAddDisplayable(y,t,r)}},n.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},n.prototype.delRoot=function(e){if(e instanceof Array){for(var t=0,r=e.length;t<r;t++)this.delRoot(e[t]);return}var i=Xi(this._roots,e);i>=0&&this._roots.splice(i,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}(),TP;TP=mi.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};var iA={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)))},elasticOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*n)*Math.sin((n-e)*(2*Math.PI)/r)+1)},elasticInOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),(n*=2)<1?-.5*(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)):t*Math.pow(2,-10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)*.5+1)},backIn:function(n){var e=1.70158;return n*n*((e+1)*n-e)},backOut:function(n){var e=1.70158;return--n*n*((e+1)*n+e)+1},backInOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)},bounceIn:function(n){return 1-iA.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?iA.bounceIn(n*2)*.5:iA.bounceOut(n*2-1)*.5+.5}},IE=Math.pow,iv=Math.sqrt,MP=1e-8,jre=1e-4,WX=iv(3),RE=1/3,Kd=Tw(),xh=Tw(),kb=Tw();function j0(n){return n>-MP&&n<MP}function Wre(n){return n>MP||n<-MP}function Ga(n,e,t,r,i){var s=1-i;return s*s*(s*n+3*i*e)+i*i*(i*r+3*s*t)}function XX(n,e,t,r,i){var s=1-i;return 3*(((e-n)*s+2*(t-e)*i)*s+(r-t)*i*i)}function CP(n,e,t,r,i,s){var a=r+3*(e-t)-n,l=3*(t-e*2+n),o=3*(e-n),h=n-i,d=l*l-3*a*o,m=l*o-9*a*h,v=o*o-3*l*h,y=0;if(j0(d)&&j0(m))if(j0(l))s[0]=0;else{var S=-o/l;S>=0&&S<=1&&(s[y++]=S)}else{var E=m*m-4*d*v;if(j0(E)){var M=m/d,S=-l/a+M,C=-M/2;S>=0&&S<=1&&(s[y++]=S),C>=0&&C<=1&&(s[y++]=C)}else if(E>0){var L=iv(E),k=d*l+1.5*a*(-m+L),H=d*l+1.5*a*(-m-L);k<0?k=-IE(-k,RE):k=IE(k,RE),H<0?H=-IE(-H,RE):H=IE(H,RE);var S=(-l-(k+H))/(3*a);S>=0&&S<=1&&(s[y++]=S)}else{var q=(2*d*l-3*a*m)/(2*iv(d*d*d)),Z=Math.acos(q)/3,ee=iv(d),re=Math.cos(Z),S=(-l-2*ee*re)/(3*a),C=(-l+ee*(re+WX*Math.sin(Z)))/(3*a),se=(-l+ee*(re-WX*Math.sin(Z)))/(3*a);S>=0&&S<=1&&(s[y++]=S),C>=0&&C<=1&&(s[y++]=C),se>=0&&se<=1&&(s[y++]=se)}}return y}function Xre(n,e,t,r,i){var s=6*t-12*e+6*n,a=9*e+3*r-3*n-9*t,l=3*e-3*n,o=0;if(j0(a)){if(Wre(s)){var h=-l/s;h>=0&&h<=1&&(i[o++]=h)}}else{var d=s*s-4*a*l;if(j0(d))i[0]=-s/(2*a);else if(d>0){var m=iv(d),h=(-s+m)/(2*a),v=(-s-m)/(2*a);h>=0&&h<=1&&(i[o++]=h),v>=0&&v<=1&&(i[o++]=v)}}return o}function mv(n,e,t,r,i,s){var a=(e-n)*i+n,l=(t-e)*i+e,o=(r-t)*i+t,h=(l-a)*i+a,d=(o-l)*i+l,m=(d-h)*i+h;s[0]=n,s[1]=a,s[2]=h,s[3]=m,s[4]=m,s[5]=d,s[6]=o,s[7]=r}function $re(n,e,t,r,i,s,a,l,o,h,d){var m,v=.005,y=1/0,S,E,M,C;Kd[0]=o,Kd[1]=h;for(var L=0;L<1;L+=.05)xh[0]=Ga(n,t,i,a,L),xh[1]=Ga(e,r,s,l,L),M=Db(Kd,xh),M<y&&(m=L,y=M);y=1/0;for(var k=0;k<32&&!(v<jre);k++)S=m-v,E=m+v,xh[0]=Ga(n,t,i,a,S),xh[1]=Ga(e,r,s,l,S),M=Db(xh,Kd),S>=0&&M<y?(m=S,y=M):(kb[0]=Ga(n,t,i,a,E),kb[1]=Ga(e,r,s,l,E),C=Db(kb,Kd),E<=1&&C<y?(m=E,y=C):v*=.5);return d&&(d[0]=Ga(n,t,i,a,m),d[1]=Ga(e,r,s,l,m)),iv(y)}function UTe(n,e,t,r,i,s,a,l,o){for(var h=n,d=e,m=0,v=1/o,y=1;y<=o;y++){var S=y*v,E=Ga(n,t,i,a,S),M=Ga(e,r,s,l,S),C=E-h,L=M-d;m+=Math.sqrt(C*C+L*L),h=E,d=M}return m}function Ul(n,e,t,r){var i=1-r;return i*(i*n+2*r*e)+r*r*t}function $X(n,e,t,r){return 2*((1-r)*(e-n)+r*(t-e))}function GTe(n,e,t,r,i){var s=n-2*e+t,a=2*(e-n),l=n-r,o=0;if(j0(s)){if(Wre(a)){var h=-l/a;h>=0&&h<=1&&(i[o++]=h)}}else{var d=a*a-4*s*l;if(j0(d)){var h=-a/(2*s);h>=0&&h<=1&&(i[o++]=h)}else if(d>0){var m=iv(d),h=(-a+m)/(2*s),v=(-a-m)/(2*s);h>=0&&h<=1&&(i[o++]=h),v>=0&&v<=1&&(i[o++]=v)}}return o}function qre(n,e,t){var r=n+t-2*e;return r===0?.5:(n-e)/r}function EP(n,e,t,r,i){var s=(e-n)*r+n,a=(t-e)*r+e,l=(a-s)*r+s;i[0]=n,i[1]=s,i[2]=l,i[3]=l,i[4]=a,i[5]=t}function Zre(n,e,t,r,i,s,a,l,o){var h,d=.005,m=1/0;Kd[0]=a,Kd[1]=l;for(var v=0;v<1;v+=.05){xh[0]=Ul(n,t,i,v),xh[1]=Ul(e,r,s,v);var y=Db(Kd,xh);y<m&&(h=v,m=y)}m=1/0;for(var S=0;S<32&&!(d<jre);S++){var E=h-d,M=h+d;xh[0]=Ul(n,t,i,E),xh[1]=Ul(e,r,s,E);var y=Db(xh,Kd);if(E>=0&&y<m)h=E,m=y;else{kb[0]=Ul(n,t,i,M),kb[1]=Ul(e,r,s,M);var C=Db(kb,Kd);M<=1&&C<m?(h=M,m=C):d*=.5}}return o&&(o[0]=Ul(n,t,i,h),o[1]=Ul(e,r,s,h)),iv(m)}function VTe(n,e,t,r,i,s,a){for(var l=n,o=e,h=0,d=1/a,m=1;m<=a;m++){var v=m*d,y=Ul(n,t,i,v),S=Ul(e,r,s,v),E=y-l,M=S-o;h+=Math.sqrt(E*E+M*M),l=y,o=S}return h}var HTe=/cubic-bezier\(([0-9,\.e ]+)\)/;function Yre(n){var e=n&&HTe.exec(n);if(e){var t=e[1].split(","),r=+tp(t[0]),i=+tp(t[1]),s=+tp(t[2]),a=+tp(t[3]);if(isNaN(r+i+s+a))return;var l=[];return function(o){return o<=0?0:o>=1?1:CP(0,r,s,1,o,l)&&Ga(0,i,a,1,l[0])}}}var jTe=function(){function n(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||Ec,this.ondestroy=e.ondestroy||Ec,this.onrestart=e.onrestart||Ec,e.easing&&this.setEasing(e.easing)}return n.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),this._paused){this._pausedTime+=t;return}var r=this._life,i=e-this._startTime-this._pausedTime,s=i/r;s<0&&(s=0),s=Math.min(s,1);var a=this.easingFunc,l=a?a(s):s;if(this.onframe(l),s===1)if(this.loop){var o=i%r;this._startTime=e-o,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(e){this.easing=e,this.easingFunc=ci(e)?e:iA[e]||Yre(e)},n}(),Kre=function(){function n(e){this.value=e}return n}(),WTe=function(){function n(){this._len=0}return n.prototype.insert=function(e){var t=new Kre(e);return this.insertEntry(t),t},n.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},n.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),iM=function(){function n(e){this._list=new WTe,this._maxSize=10,this._map={},this._maxSize=e}return n.prototype.put=function(e,t){var r=this._list,i=this._map,s=null;if(i[e]==null){var a=r.len(),l=this._lastRemovedEntry;if(a>=this._maxSize&&a>0){var o=r.head;r.remove(o),delete i[o.key],s=o.value,this._lastRemovedEntry=o}l?l.value=t:l=new Kre(t),l.key=e,r.insertEntry(l),i[e]=l}return s},n.prototype.get=function(e){var t=this._map[e],r=this._list;if(t!=null)return t!==r.tail&&(r.remove(t),r.insertEntry(t)),t.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}(),qX={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function sv(n){return n=Math.round(n),n<0?0:n>255?255:n}function YF(n){return n<0?0:n>1?1:n}function bB(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?sv(parseFloat(e)/100*255):sv(parseInt(e,10))}function sA(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?YF(parseFloat(e)/100):YF(parseFloat(e))}function wB(n,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?n+(e-n)*t*6:t*2<1?e:t*3<2?n+(e-n)*(2/3-t)*6:n}function PE(n,e,t){return n+(e-n)*t}function fh(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function KF(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}var Jre=new iM(20),LE=null;function Cx(n,e){LE&&KF(LE,e),LE=Jre.put(n,LE||e.slice())}function Fm(n,e){if(n){e=e||[];var t=Jre.get(n);if(t)return KF(e,t);n=n+"";var r=n.replace(/ /g,"").toLowerCase();if(r in qX)return KF(e,qX[r]),Cx(n,e),e;var i=r.length;if(r.charAt(0)==="#"){if(i===4||i===5){var s=parseInt(r.slice(1,4),16);if(!(s>=0&&s<=4095)){fh(e,0,0,0,1);return}return fh(e,(s&3840)>>4|(s&3840)>>8,s&240|(s&240)>>4,s&15|(s&15)<<4,i===5?parseInt(r.slice(4),16)/15:1),Cx(n,e),e}else if(i===7||i===9){var s=parseInt(r.slice(1,7),16);if(!(s>=0&&s<=16777215)){fh(e,0,0,0,1);return}return fh(e,(s&16711680)>>16,(s&65280)>>8,s&255,i===9?parseInt(r.slice(7),16)/255:1),Cx(n,e),e}return}var a=r.indexOf("("),l=r.indexOf(")");if(a!==-1&&l+1===i){var o=r.substr(0,a),h=r.substr(a+1,l-(a+1)).split(","),d=1;switch(o){case"rgba":if(h.length!==4)return h.length===3?fh(e,+h[0],+h[1],+h[2],1):fh(e,0,0,0,1);d=sA(h.pop());case"rgb":if(h.length>=3)return fh(e,bB(h[0]),bB(h[1]),bB(h[2]),h.length===3?d:sA(h[3])),Cx(n,e),e;fh(e,0,0,0,1);return;case"hsla":if(h.length!==4){fh(e,0,0,0,1);return}return h[3]=sA(h[3]),ZX(h,e),Cx(n,e),e;case"hsl":if(h.length!==3){fh(e,0,0,0,1);return}return ZX(h,e),Cx(n,e),e;default:return}}fh(e,0,0,0,1)}}function ZX(n,e){var t=(parseFloat(n[0])%360+360)%360/360,r=sA(n[1]),i=sA(n[2]),s=i<=.5?i*(r+1):i+r-i*r,a=i*2-s;return e=e||[],fh(e,sv(wB(a,s,t+1/3)*255),sv(wB(a,s,t)*255),sv(wB(a,s,t-1/3)*255),1),n.length===4&&(e[3]=n[3]),e}function YX(n,e){var t=Fm(n);if(t){for(var r=0;r<3;r++)t[r]=t[r]*(1-e)|0,t[r]>255?t[r]=255:t[r]<0&&(t[r]=0);return RD(t,t.length===4?"rgba":"rgb")}}function XTe(n,e,t){if(!(!(e&&e.length)||!(n>=0&&n<=1))){var r=n*(e.length-1),i=Math.floor(r),s=Math.ceil(r),a=Fm(e[i]),l=Fm(e[s]),o=r-i,h=RD([sv(PE(a[0],l[0],o)),sv(PE(a[1],l[1],o)),sv(PE(a[2],l[2],o)),YF(PE(a[3],l[3],o))],"rgba");return t?{color:h,leftIndex:i,rightIndex:s,value:r}:h}}function RD(n,e){if(!(!n||!n.length)){var t=n[0]+","+n[1]+","+n[2];return(e==="rgba"||e==="hsva"||e==="hsla")&&(t+=","+n[3]),e+"("+t+")"}}function IP(n,e){var t=Fm(n);return t?(.299*t[0]+.587*t[1]+.114*t[2])*t[3]/255+(1-t[3])*e:0}var KX=new iM(100);function JX(n){if(Dr(n)){var e=KX.get(n);return e||(e=YX(n,-.1),KX.put(n,e)),e}else if(MD(n)){var t=Jn({},n);return t.colorStops=xr(n.colorStops,function(r){return{offset:r.offset,color:YX(r.color,-.1)}}),t}return n}function $Te(n){return n.type==="linear"}function qTe(n){return n.type==="radial"}(function(){return mi.hasGlobalWindow&&ci(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}})();var JF=Array.prototype.slice;function ym(n,e,t){return(e-n)*t+n}function SB(n,e,t,r){for(var i=e.length,s=0;s<i;s++)n[s]=ym(e[s],t[s],r);return n}function ZTe(n,e,t,r){for(var i=e.length,s=i&&e[0].length,a=0;a<i;a++){n[a]||(n[a]=[]);for(var l=0;l<s;l++)n[a][l]=ym(e[a][l],t[a][l],r)}return n}function DE(n,e,t,r){for(var i=e.length,s=0;s<i;s++)n[s]=e[s]+t[s]*r;return n}function QX(n,e,t,r){for(var i=e.length,s=i&&e[0].length,a=0;a<i;a++){n[a]||(n[a]=[]);for(var l=0;l<s;l++)n[a][l]=e[a][l]+t[a][l]*r}return n}function YTe(n,e){for(var t=n.length,r=e.length,i=t>r?e:n,s=Math.min(t,r),a=i[s-1]||{color:[0,0,0,0],offset:0},l=s;l<Math.max(t,r);l++)i.push({offset:a.offset,color:a.color.slice()})}function KTe(n,e,t){var r=n,i=e;if(!(!r.push||!i.push)){var s=r.length,a=i.length;if(s!==a){var l=s>a;if(l)r.length=a;else for(var o=s;o<a;o++)r.push(t===1?i[o]:JF.call(i[o]))}for(var h=r[0]&&r[0].length,o=0;o<r.length;o++)if(t===1)isNaN(r[o])&&(r[o]=i[o]);else for(var d=0;d<h;d++)isNaN(r[o][d])&&(r[o][d]=i[o][d])}}function ZI(n){if(Ic(n)){var e=n.length;if(Ic(n[0])){for(var t=[],r=0;r<e;r++)t.push(JF.call(n[r]));return t}return JF.call(n)}return n}function YI(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function JTe(n){return Ic(n&&n[0])?2:1}var BE=0,KI=1,Qre=2,TS=3,QF=4,eN=5,e$=6;function t$(n){return n===QF||n===eN}function kE(n){return n===KI||n===Qre}var W2=[0,0,0,0],QTe=function(){function n(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(e,t,r){this._needsSort=!0;var i=this.keyframes,s=i.length,a=!1,l=e$,o=t;if(Ic(t)){var h=JTe(t);l=h,(h===1&&!Rs(t[0])||h===2&&!Rs(t[0][0]))&&(a=!0)}else if(Rs(t)&&!wP(t))l=BE;else if(Dr(t))if(!isNaN(+t))l=BE;else{var d=Fm(t);d&&(o=d,l=TS)}else if(MD(t)){var m=Jn({},o);m.colorStops=xr(t.colorStops,function(y){return{offset:y.offset,color:Fm(y.color)}}),$Te(t)?l=QF:qTe(t)&&(l=eN),o=m}s===0?this.valType=l:(l!==this.valType||l===e$)&&(a=!0),this.discrete=this.discrete||a;var v={time:e,value:o,rawValue:t,percent:0};return r&&(v.easing=r,v.easingFunc=ci(r)?r:iA[r]||Yre(r)),i.push(v),v},n.prototype.prepare=function(e,t){var r=this.keyframes;this._needsSort&&r.sort(function(E,M){return E.time-M.time});for(var i=this.valType,s=r.length,a=r[s-1],l=this.discrete,o=kE(i),h=t$(i),d=0;d<s;d++){var m=r[d],v=m.value,y=a.value;m.percent=m.time/e,l||(o&&d!==s-1?KTe(v,y,i):h&&YTe(v.colorStops,y.colorStops))}if(!l&&i!==eN&&t&&this.needsAnimate()&&t.needsAnimate()&&i===t.valType&&!t._finished){this._additiveTrack=t;for(var S=r[0].value,d=0;d<s;d++)i===BE?r[d].additiveValue=r[d].value-S:i===TS?r[d].additiveValue=DE([],r[d].value,S,-1):kE(i)&&(r[d].additiveValue=i===KI?DE([],r[d].value,S,-1):QX([],r[d].value,S,-1))}},n.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,i=r?"additiveValue":"value",s=this.valType,a=this.keyframes,l=a.length,o=this.propName,h=s===TS,d,m=this._lastFr,v=Math.min,y,S;if(l===1)y=S=a[0];else{if(t<0)d=0;else if(t<this._lastFrP){var E=v(m+1,l-1);for(d=E;d>=0&&!(a[d].percent<=t);d--);d=v(d,l-2)}else{for(d=m;d<l&&!(a[d].percent>t);d++);d=v(d-1,l-2)}S=a[d+1],y=a[d]}if(y&&S){this._lastFr=d,this._lastFrP=t;var M=S.percent-y.percent,C=M===0?1:v((t-y.percent)/M,1);S.easingFunc&&(C=S.easingFunc(C));var L=r?this._additiveValue:h?W2:e[o];if((kE(s)||h)&&!L&&(L=this._additiveValue=[]),this.discrete)e[o]=C<1?y.rawValue:S.rawValue;else if(kE(s))s===KI?SB(L,y[i],S[i],C):ZTe(L,y[i],S[i],C);else if(t$(s)){var k=y[i],H=S[i],q=s===QF;e[o]={type:q?"linear":"radial",x:ym(k.x,H.x,C),y:ym(k.y,H.y,C),colorStops:xr(k.colorStops,function(ee,re){var se=H.colorStops[re];return{offset:ym(ee.offset,se.offset,C),color:YI(SB([],ee.color,se.color,C))}}),global:H.global},q?(e[o].x2=ym(k.x2,H.x2,C),e[o].y2=ym(k.y2,H.y2,C)):e[o].r=ym(k.r,H.r,C)}else if(h)SB(L,y[i],S[i],C),r||(e[o]=YI(L));else{var Z=ym(y[i],S[i],C);r?this._additiveValue=Z:e[o]=Z}r&&this._addToTarget(e)}}},n.prototype._addToTarget=function(e){var t=this.valType,r=this.propName,i=this._additiveValue;t===BE?e[r]=e[r]+i:t===TS?(Fm(e[r],W2),DE(W2,W2,i,1),e[r]=YI(W2)):t===KI?DE(e[r],e[r],i,1):t===Qre&&QX(e[r],e[r],i,1)},n}(),IU=function(){function n(e,t,r,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&i){TU("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=r}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(e){this._target=e},n.prototype.when=function(e,t,r){return this.whenWithKeys(e,t,so(t),r)},n.prototype.whenWithKeys=function(e,t,r,i){for(var s=this._tracks,a=0;a<r.length;a++){var l=r[a],o=s[l];if(!o){o=s[l]=new QTe(l);var h=void 0,d=this._getAdditiveTrack(l);if(d){var m=d.keyframes,v=m[m.length-1];h=v&&v.value,d.valType===TS&&h&&(h=YI(h))}else h=this._target[l];if(h==null)continue;e>0&&o.addKeyframe(0,ZI(h),i),this._trackKeys.push(l)}o.addKeyframe(e,ZI(t[l]),i)}return this._maxTime=Math.max(this._maxTime,e),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,r=0;r<t;r++)e[r].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var r=0;r<t.length;r++)t[r].call(this)},n.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,r=0;r<t.length;r++)e[t[r]].setFinished()},n.prototype._getAdditiveTrack=function(e){var t,r=this._additiveAnimators;if(r)for(var i=0;i<r.length;i++){var s=r[i].getTrack(e);s&&(t=s)}return t},n.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,r=[],i=this._maxTime||0,s=0;s<this._trackKeys.length;s++){var a=this._trackKeys[s],l=this._tracks[a],o=this._getAdditiveTrack(a),h=l.keyframes,d=h.length;if(l.prepare(i,o),l.needsAnimate())if(!this._allowDiscrete&&l.discrete){var m=h[d-1];m&&(t._target[l.propName]=m.rawValue),l.setFinished()}else r.push(l)}if(r.length||this._force){var v=new jTe({life:i,loop:this._loop,delay:this._delay||0,onframe:function(y){t._started=2;var S=t._additiveAnimators;if(S){for(var E=!1,M=0;M<S.length;M++)if(S[M]._clip){E=!0;break}E||(t._additiveAnimators=null)}for(var M=0;M<r.length;M++)r[M].step(t._target,y);var C=t._onframeCbs;if(C)for(var M=0;M<C.length;M++)C[M](t._target,y)},ondestroy:function(){t._doneCallback()}});this._clip=v,this.animation&&this.animation.addClip(v),e&&v.setEasing(e)}else this._doneCallback();return this}},n.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},n.prototype.delay=function(e){return this._delay=e,this},n.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},n.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},n.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(e){return this._tracks[e]},n.prototype.getTracks=function(){var e=this;return xr(this._trackKeys,function(t){return e._tracks[t]})},n.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var r=this._tracks,i=this._trackKeys,s=0;s<e.length;s++){var a=r[e[s]];a&&!a.isFinished()&&(t?a.step(this._target,1):this._started===1&&a.step(this._target,0),a.setFinished())}for(var l=!0,s=0;s<i.length;s++)if(!r[i[s]].isFinished()){l=!1;break}return l&&this._abortedCallback(),l},n.prototype.saveTo=function(e,t,r){if(e){t=t||this._trackKeys;for(var i=0;i<t.length;i++){var s=t[i],a=this._tracks[s];if(!(!a||a.isFinished())){var l=a.keyframes,o=l[r?0:l.length-1];o&&(e[s]=ZI(o.rawValue))}}}},n.prototype.__changeFinalValue=function(e,t){t=t||so(e);for(var r=0;r<t.length;r++){var i=t[r],s=this._tracks[i];if(s){var a=s.keyframes;if(a.length>1){var l=a.pop();s.addKeyframe(l.time,e[i]),s.prepare(this._maxTime,s.getAdditiveTrack())}}}},n}();function bb(){return new Date().getTime()}var eMe=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r._running=!1,r._time=0,r._pausedTime=0,r._pauseStart=0,r._paused=!1,t=t||{},r.stage=t.stage||{},r}return e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._head?(this._tail.next=t,t.prev=this._tail,t.next=null,this._tail=t):this._head=this._tail=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var r=t.getClip();r&&this.addClip(r)},e.prototype.removeClip=function(t){if(t.animation){var r=t.prev,i=t.next;r?r.next=i:this._head=i,i?i.prev=r:this._tail=r,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var r=t.getClip();r&&this.removeClip(r),t.animation=null},e.prototype.update=function(t){for(var r=bb()-this._pausedTime,i=r-this._time,s=this._head;s;){var a=s.next,l=s.step(r,i);l&&(s.ondestroy(),this.removeClip(s)),s=a}this._time=r,t||(this.trigger("frame",i),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var t=this;this._running=!0;function r(){t._running&&(TP(r),!t._paused&&t.update())}TP(r)},e.prototype.start=function(){this._running||(this._time=bb(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=bb(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=bb()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var t=this._head;t;){var r=t.next;t.prev=t.next=t.animation=null,t=r}this._head=this._tail=null},e.prototype.isFinished=function(){return this._head==null},e.prototype.animate=function(t,r){r=r||{},this.start();var i=new IU(t,r.loop);return this.addAnimator(i),i},e}(od),tMe=300,AB=mi.domSupported,TB=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e=["touchstart","touchend","touchmove"],t={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},r=xr(n,function(i){var s=i.replace("mouse","pointer");return t.hasOwnProperty(s)?s:i});return{mouse:n,touch:e,pointer:r}}(),n$={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},r$=!1;function tN(n){var e=n.pointerType;return e==="pen"||e==="touch"}function nMe(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function MB(n){n&&(n.zrByTouch=!0)}function rMe(n,e){return ph(n.dom,new iMe(n,e),!0)}function eie(n,e){for(var t=e,r=!1;t&&t.nodeType!==9&&!(r=t.domBelongToZr||t!==e&&t===n.painterRoot);)t=t.parentNode;return r}var iMe=function(){function n(e,t){this.stopPropagation=Ec,this.stopImmediatePropagation=Ec,this.preventDefault=Ec,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}return n}(),Pf={mousedown:function(n){n=ph(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=ph(this.dom,n);var e=this.__mayPointerCapture;e&&(n.zrX!==e[0]||n.zrY!==e[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=ph(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=ph(this.dom,n);var e=n.toElement||n.relatedTarget;eie(this,e)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){r$=!0,n=ph(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){r$||(n=ph(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=ph(this.dom,n),MB(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),Pf.mousemove.call(this,n),Pf.mousedown.call(this,n)},touchmove:function(n){n=ph(this.dom,n),MB(n),this.handler.processGesture(n,"change"),Pf.mousemove.call(this,n)},touchend:function(n){n=ph(this.dom,n),MB(n),this.handler.processGesture(n,"end"),Pf.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<tMe&&Pf.click.call(this,n)},pointerdown:function(n){Pf.mousedown.call(this,n)},pointermove:function(n){tN(n)||Pf.mousemove.call(this,n)},pointerup:function(n){Pf.mouseup.call(this,n)},pointerout:function(n){tN(n)||Pf.mouseout.call(this,n)}};it(["click","dblclick","contextmenu"],function(n){Pf[n]=function(e){e=ph(this.dom,e),this.trigger(n,e)}});var nN={pointermove:function(n){tN(n)||nN.mousemove.call(this,n)},pointerup:function(n){nN.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),e&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function sMe(n,e){var t=e.domHandlers;mi.pointerEventsSupported?it(TB.pointer,function(r){JI(e,r,function(i){t[r].call(n,i)})}):(mi.touchEventsSupported&&it(TB.touch,function(r){JI(e,r,function(i){t[r].call(n,i),nMe(e)})}),it(TB.mouse,function(r){JI(e,r,function(i){i=CU(i),e.touching||t[r].call(n,i)})}))}function oMe(n,e){mi.pointerEventsSupported?it(n$.pointer,t):mi.touchEventsSupported||it(n$.mouse,t);function t(r){function i(s){s=CU(s),eie(n,s.target)||(s=rMe(n,s),e.domHandlers[r].call(n,s))}JI(e,r,i,{capture:!0})}}function JI(n,e,t,r){n.mounted[e]=t,n.listenerOpts[e]=r,ZF(n.domTarget,e,t,r)}function CB(n){var e=n.mounted;for(var t in e)e.hasOwnProperty(t)&&TTe(n.domTarget,t,e[t],n.listenerOpts[t]);n.mounted={}}var i$=function(){function n(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t}return n}(),aMe=function(n){Hn(e,n);function e(t,r){var i=n.call(this)||this;return i.__pointerCapturing=!1,i.dom=t,i.painterRoot=r,i._localHandlerScope=new i$(t,Pf),AB&&(i._globalHandlerScope=new i$(document,nN)),sMe(i,i._localHandlerScope),i}return e.prototype.dispose=function(){CB(this._localHandlerScope),AB&&CB(this._globalHandlerScope)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,AB&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var r=this._globalHandlerScope;t?oMe(this,r):CB(r)}},e}(od),tie=1;mi.hasGlobalWindow&&(tie=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var RP=tie,rN=.4,iN="#333",sN="#ccc",lMe="#eee",s$=EU,o$=5e-5;function O_(n){return n>o$||n<-o$}var F_=[],Ex=[],EB=Ny(),IB=Math.abs,sM=function(){function n(){}return n.prototype.getLocalTransform=function(e){return n.getLocalTransform(this,e)},n.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},n.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},n.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},n.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},n.prototype.needLocalTransform=function(){return O_(this.rotation)||O_(this.x)||O_(this.y)||O_(this.scaleX-1)||O_(this.scaleY-1)||O_(this.skewX)||O_(this.skewY)},n.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),r=this.transform;if(!(t||e)){r&&(s$(r),this.invTransform=null);return}r=r||Ny(),t?this.getLocalTransform(r):s$(r),e&&(t?Bb(r,e,r):ETe(r,e)),this.transform=r,this._resolveGlobalScaleRatio(r)},n.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(t!=null&&t!==1){this.getGlobalScale(F_);var r=F_[0]<0?-1:1,i=F_[1]<0?-1:1,s=((F_[0]-r)*t+r)/F_[0]||0,a=((F_[1]-i)*t+i)/F_[1]||0;e[0]*=s,e[1]*=s,e[2]*=a,e[3]*=a}this.invTransform=this.invTransform||Ny(),ID(this.invTransform,e)},n.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},n.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],i=Math.atan2(e[1],e[0]),s=Math.PI/2+i-Math.atan2(e[3],e[2]);r=Math.sqrt(r)*Math.cos(s),t=Math.sqrt(t),this.skewX=s,this.skewY=0,this.rotation=-i,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=r,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||Ny(),Bb(Ex,e.invTransform,t),t=Ex);var r=this.originX,i=this.originY;(r||i)&&(EB[4]=r,EB[5]=i,Bb(Ex,t,EB),Ex[4]-=r,Ex[5]-=i,t=Ex),this.setLocalTransform(t)}},n.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},n.prototype.transformCoordToLocal=function(e,t){var r=[e,t],i=this.invTransform;return i&&Eh(r,r,i),r},n.prototype.transformCoordToGlobal=function(e,t){var r=[e,t],i=this.transform;return i&&Eh(r,r,i),r},n.prototype.getLineScale=function(){var e=this.transform;return e&&IB(e[0]-1)>1e-10&&IB(e[3]-1)>1e-10?Math.sqrt(IB(e[0]*e[3]-e[2]*e[1])):1},n.prototype.copyTransform=function(e){cMe(this,e)},n.getLocalTransform=function(e,t){t=t||[];var r=e.originX||0,i=e.originY||0,s=e.scaleX,a=e.scaleY,l=e.anchorX,o=e.anchorY,h=e.rotation||0,d=e.x,m=e.y,v=e.skewX?Math.tan(e.skewX):0,y=e.skewY?Math.tan(-e.skewY):0;if(r||i||l||o){var S=r+l,E=i+o;t[4]=-S*s-v*E*a,t[5]=-E*a-y*S*s}else t[4]=t[5]=0;return t[0]=s,t[3]=a,t[1]=y*s,t[2]=v*a,h&&ED(t,t,h),t[4]+=r+d,t[5]+=i+m,t},n.initDefaultProps=function(){var e=n.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),n}(),sT=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function cMe(n,e){for(var t=0;t<sT.length;t++){var r=sT[t];n[r]=e[r]}}var a$={};function Ou(n,e){e=e||r1;var t=a$[e];t||(t=a$[e]=new iM(500));var r=t.get(n);return r==null&&(r=Sw.measureText(n,e).width,t.put(n,r)),r}function l$(n,e,t,r){var i=Ou(n,e),s=RU(e),a=MS(0,i,t),l=Jx(0,s,r),o=new cs(a,l,i,s);return o}function oM(n,e,t,r){var i=((n||"")+"").split(`
`),s=i.length;if(s===1)return l$(i[0],e,t,r);for(var a=new cs(0,0,0,0),l=0;l<i.length;l++){var o=l$(i[l],e,t,r);l===0?a.copy(o):a.union(o)}return a}function MS(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function Jx(n,e,t){return t==="middle"?n-=e/2:t==="bottom"&&(n-=e),n}function RU(n){return Ou("",n)}function gv(n,e){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*e:parseFloat(n):n}function PP(n,e,t){var r=e.position||"inside",i=e.distance!=null?e.distance:5,s=t.height,a=t.width,l=s/2,o=t.x,h=t.y,d="left",m="top";if(r instanceof Array)o+=gv(r[0],t.width),h+=gv(r[1],t.height),d=null,m=null;else switch(r){case"left":o-=i,h+=l,d="right",m="middle";break;case"right":o+=i+a,h+=l,m="middle";break;case"top":o+=a/2,h-=i,d="center",m="bottom";break;case"bottom":o+=a/2,h+=s+i,d="center";break;case"inside":o+=a/2,h+=l,d="center",m="middle";break;case"insideLeft":o+=i,h+=l,m="middle";break;case"insideRight":o+=a-i,h+=l,d="right",m="middle";break;case"insideTop":o+=a/2,h+=i,d="center";break;case"insideBottom":o+=a/2,h+=s-i,d="center",m="bottom";break;case"insideTopLeft":o+=i,h+=i;break;case"insideTopRight":o+=a-i,h+=i,d="right";break;case"insideBottomLeft":o+=i,h+=s-i,m="bottom";break;case"insideBottomRight":o+=a-i,h+=s-i,d="right",m="bottom";break}return n=n||{},n.x=o,n.y=h,n.align=d,n.verticalAlign=m,n}var RB="__zr_normal__",PB=sT.concat(["ignore"]),uMe=pv(sT,function(n,e){return n[e]=!0,n},{ignore:!1}),Ix={},hMe=new cs(0,0,0,0),PD=function(){function n(e){this.id=Dre(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return n.prototype._init=function(e){this.attr(e)},n.prototype.drift=function(e,t,r){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=e,i[5]+=t,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var r=this.textConfig,i=r.local,s=t.innerTransformable,a=void 0,l=void 0,o=!1;s.parent=i?this:null;var h=!1;if(s.copyTransform(t),r.position!=null){var d=hMe;r.layoutRect?d.copy(r.layoutRect):d.copy(this.getBoundingRect()),i||d.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Ix,r,d):PP(Ix,r,d),s.x=Ix.x,s.y=Ix.y,a=Ix.align,l=Ix.verticalAlign;var m=r.origin;if(m&&r.rotation!=null){var v=void 0,y=void 0;m==="center"?(v=d.width*.5,y=d.height*.5):(v=gv(m[0],d.width),y=gv(m[1],d.height)),h=!0,s.originX=-s.x+v+(i?0:d.x),s.originY=-s.y+y+(i?0:d.y)}}r.rotation!=null&&(s.rotation=r.rotation);var S=r.offset;S&&(s.x+=S[0],s.y+=S[1],h||(s.originX=-S[0],s.originY=-S[1]));var E=r.inside==null?typeof r.position=="string"&&r.position.indexOf("inside")>=0:r.inside,M=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),C=void 0,L=void 0,k=void 0;E&&this.canBeInsideText()?(C=r.insideFill,L=r.insideStroke,(C==null||C==="auto")&&(C=this.getInsideTextFill()),(L==null||L==="auto")&&(L=this.getInsideTextStroke(C),k=!0)):(C=r.outsideFill,L=r.outsideStroke,(C==null||C==="auto")&&(C=this.getOutsideFill()),(L==null||L==="auto")&&(L=this.getOutsideStroke(C),k=!0)),C=C||"#000",(C!==M.fill||L!==M.stroke||k!==M.autoStroke||a!==M.align||l!==M.verticalAlign)&&(o=!0,M.fill=C,M.stroke=L,M.autoStroke=k,M.align=a,M.verticalAlign=l,t.setDefaultTextStyle(M)),t.__dirty|=Lu,o&&t.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(e){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?sN:iN},n.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),r=typeof t=="string"&&Fm(t);r||(r=[255,255,255,1]);for(var i=r[3],s=this.__zr.isDarkMode(),a=0;a<3;a++)r[a]=r[a]*i+(s?0:255)*(1-i);return r[3]=1,RD(r,"rgba")},n.prototype.traverse=function(e,t){},n.prototype.attrKV=function(e,t){e==="textConfig"?this.setTextConfig(t):e==="textContent"?this.setTextContent(t):e==="clipPath"?this.setClipPath(t):e==="extra"?(this.extra=this.extra||{},Jn(this.extra,t)):this[e]=t},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(e,t){if(typeof e=="string")this.attrKV(e,t);else if(Xr(e))for(var r=e,i=so(r),s=0;s<i.length;s++){var a=i[s];this.attrKV(a,e[a])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,r=0;r<this.animators.length;r++){var i=this.animators[r],s=i.__fromStateTransition;if(!(i.getLoop()||s&&s!==RB)){var a=i.targetName,l=a?t[a]:t;i.saveTo(l)}}},n.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,PB)},n.prototype._savePrimaryToNormal=function(e,t,r){for(var i=0;i<r.length;i++){var s=r[i];e[s]!=null&&!(s in t)&&(t[s]=this[s])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(e){return this.states[e]},n.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},n.prototype.clearStates=function(e){this.useState(RB,!1,e)},n.prototype.useState=function(e,t,r,i){var s=e===RB,a=this.hasState();if(!(!a&&s)){var l=this.currentStates,o=this.stateTransition;if(!(Xi(l,e)>=0&&(t||l.length===1))){var h;if(this.stateProxy&&!s&&(h=this.stateProxy(e)),h||(h=this.states&&this.states[e]),!h&&!s){TU("State "+e+" not exists.");return}s||this.saveCurrentToNormalState(h);var d=!!(h&&h.hoverLayer||i);d&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,h,this._normalState,t,!r&&!this.__inHover&&o&&o.duration>0,o);var m=this._textContent,v=this._textGuide;return m&&m.useState(e,t,r,d),v&&v.useState(e,t,r,d),s?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!d&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Lu),h}}},n.prototype.useStates=function(e,t,r){if(!e.length)this.clearStates();else{var i=[],s=this.currentStates,a=e.length,l=a===s.length;if(l){for(var o=0;o<a;o++)if(e[o]!==s[o]){l=!1;break}}if(l)return;for(var o=0;o<a;o++){var h=e[o],d=void 0;this.stateProxy&&(d=this.stateProxy(h,e)),d||(d=this.states[h]),d&&i.push(d)}var m=i[a-1],v=!!(m&&m.hoverLayer||r);v&&this._toggleHoverLayerFlag(!0);var y=this._mergeStates(i),S=this.stateTransition;this.saveCurrentToNormalState(y),this._applyStateObj(e.join(","),y,this._normalState,!1,!t&&!this.__inHover&&S&&S.duration>0,S);var E=this._textContent,M=this._textGuide;E&&E.useStates(e,t,v),M&&M.useStates(e,t,v),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!v&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Lu)}},n.prototype.isSilent=function(){for(var e=this.silent,t=this.parent;!e&&t;){if(t.silent){e=!0;break}t=t.parent}return e},n.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},n.prototype.removeState=function(e){var t=Xi(this.currentStates,e);if(t>=0){var r=this.currentStates.slice();r.splice(t,1),this.useStates(r)}},n.prototype.replaceState=function(e,t,r){var i=this.currentStates.slice(),s=Xi(i,e),a=Xi(i,t)>=0;s>=0?a?i.splice(s,1):i[s]=t:r&&!a&&i.push(t),this.useStates(i)},n.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},n.prototype._mergeStates=function(e){for(var t={},r,i=0;i<e.length;i++){var s=e[i];Jn(t,s),s.textConfig&&(r=r||{},Jn(r,s.textConfig))}return r&&(t.textConfig=r),t},n.prototype._applyStateObj=function(e,t,r,i,s,a){var l=!(t&&i);t&&t.textConfig?(this.textConfig=Jn({},i?this.textConfig:r.textConfig),Jn(this.textConfig,t.textConfig)):l&&r.textConfig&&(this.textConfig=r.textConfig);for(var o={},h=!1,d=0;d<PB.length;d++){var m=PB[d],v=s&&uMe[m];t&&t[m]!=null?v?(h=!0,o[m]=t[m]):this[m]=t[m]:l&&r[m]!=null&&(v?(h=!0,o[m]=r[m]):this[m]=r[m])}if(!s)for(var d=0;d<this.animators.length;d++){var y=this.animators[d],S=y.targetName;y.getLoop()||y.__changeFinalValue(S?(t||r)[S]:t||r)}h&&this._transitionState(e,o,a)},n.prototype._attachComponent=function(e){if(!(e.__zr&&!e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},n.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},n.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new sM,this._attachComponent(e),this._textContent=e,this.markRedraw())},n.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),Jn(this.textConfig,e),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=Lu;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,r=this._textGuide;t&&(t.__inHover=e),r&&(r.__inHover=e)},n.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.addAnimator(t[r]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},n.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.removeAnimator(t[r]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},n.prototype.animate=function(e,t,r){var i=e?this[e]:this,s=new IU(i,t,r);return e&&(s.targetName=e),this.addAnimator(s,e),s},n.prototype.addAnimator=function(e,t){var r=this.__zr,i=this;e.during(function(){i.updateDuringAnimation(t)}).done(function(){var s=i.animators,a=Xi(s,e);a>=0&&s.splice(a,1)}),this.animators.push(e),r&&r.animation.addAnimator(e),r&&r.wakeUp()},n.prototype.updateDuringAnimation=function(e){this.markRedraw()},n.prototype.stopAnimation=function(e,t){for(var r=this.animators,i=r.length,s=[],a=0;a<i;a++){var l=r[a];!e||e===l.scope?l.stop(t):s.push(l)}return this.animators=s,this},n.prototype.animateTo=function(e,t,r){LB(this,e,t,r)},n.prototype.animateFrom=function(e,t,r){LB(this,e,t,r,!0)},n.prototype._transitionState=function(e,t,r,i){for(var s=LB(this,t,r,i),a=0;a<s.length;a++)s[a].__fromStateTransition=e},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var e=n.prototype;e.type="element",e.name="",e.ignore=e.silent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=Lu;function t(r,i,s,a){Object.defineProperty(e,r,{get:function(){if(!this[i]){var o=this[i]=[];l(this,o)}return this[i]},set:function(o){this[s]=o[0],this[a]=o[1],this[i]=o,l(this,o)}});function l(o,h){Object.defineProperty(h,0,{get:function(){return o[s]},set:function(d){o[s]=d}}),Object.defineProperty(h,1,{get:function(){return o[a]},set:function(d){o[a]=d}})}}Object.defineProperty&&(t("position","_legacyPos","x","y"),t("scale","_legacyScale","scaleX","scaleY"),t("origin","_legacyOrigin","originX","originY"))}(),n}();sd(PD,od);sd(PD,sM);function LB(n,e,t,r,i){t=t||{};var s=[];nie(n,"",n,e,t,r,s,i);var a=s.length,l=!1,o=t.done,h=t.aborted,d=function(){l=!0,a--,a<=0&&(l?o&&o():h&&h())},m=function(){a--,a<=0&&(l?o&&o():h&&h())};a||o&&o(),s.length>0&&t.during&&s[0].during(function(S,E){t.during(E)});for(var v=0;v<s.length;v++){var y=s[v];d&&y.done(d),m&&y.aborted(m),t.force&&y.duration(t.duration),y.start(t.easing)}return s}function DB(n,e,t){for(var r=0;r<t;r++)n[r]=e[r]}function fMe(n){return Ic(n[0])}function dMe(n,e,t){if(Ic(e[t]))if(Ic(n[t])||(n[t]=[]),du(e[t])){var r=e[t].length;n[t].length!==r&&(n[t]=new e[t].constructor(r),DB(n[t],e[t],r))}else{var i=e[t],s=n[t],a=i.length;if(fMe(i))for(var l=i[0].length,o=0;o<a;o++)s[o]?DB(s[o],i[o],l):s[o]=Array.prototype.slice.call(i[o]);else DB(s,i,a);s.length=i.length}else n[t]=e[t]}function pMe(n,e){return n===e||Ic(n)&&Ic(e)&&mMe(n,e)}function mMe(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function nie(n,e,t,r,i,s,a,l){for(var o=so(r),h=i.duration,d=i.delay,m=i.additive,v=i.setToFinal,y=!Xr(s),S=n.animators,E=[],M=0;M<o.length;M++){var C=o[M],L=r[C];if(L!=null&&t[C]!=null&&(y||s[C]))if(Xr(L)&&!Ic(L)&&!MD(L)){if(e){l||(t[C]=L,n.updateDuringAnimation(e));continue}nie(n,C,t[C],L,i,s&&s[C],a,l)}else E.push(C);else l||(t[C]=L,n.updateDuringAnimation(e),E.push(C))}var k=E.length;if(!m&&k)for(var H=0;H<S.length;H++){var q=S[H];if(q.targetName===e){var Z=q.stopTracks(E);if(Z){var ee=Xi(S,q);S.splice(ee,1)}}}if(i.force||(E=na(E,function(fe){return!pMe(r[fe],t[fe])}),k=E.length),k>0||i.force&&!a.length){var re=void 0,se=void 0,ae=void 0;if(l){se={},v&&(re={});for(var H=0;H<k;H++){var C=E[H];se[C]=t[C],v?re[C]=r[C]:t[C]=r[C]}}else if(v){ae={};for(var H=0;H<k;H++){var C=E[H];ae[C]=ZI(t[C]),dMe(t,r,C)}}var q=new IU(t,!1,!1,m?na(S,function(Se){return Se.targetName===e}):null);q.targetName=e,i.scope&&(q.scope=i.scope),v&&re&&q.whenWithKeys(0,re,E),ae&&q.whenWithKeys(0,ae,E),q.whenWithKeys(h??500,l?se:r,E).delay(d||0),n.addAnimator(q,e),a.push(q)}}var ma=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r.isGroup=!0,r._children=[],r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(t){return this._children[t]},e.prototype.childOfName=function(t){for(var r=this._children,i=0;i<r.length;i++)if(r[i].name===t)return r[i]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},e.prototype.addBefore=function(t,r){if(t&&t!==this&&t.parent!==this&&r&&r.parent===this){var i=this._children,s=i.indexOf(r);s>=0&&(i.splice(s,0,t),this._doAdd(t))}return this},e.prototype.replace=function(t,r){var i=Xi(this._children,t);return i>=0&&this.replaceAt(r,i),this},e.prototype.replaceAt=function(t,r){var i=this._children,s=i[r];if(t&&t!==this&&t.parent!==this&&t!==s){i[r]=t,s.parent=null;var a=this.__zr;a&&s.removeSelfFromZr(a),this._doAdd(t)}return this},e.prototype._doAdd=function(t){t.parent&&t.parent.remove(t),t.parent=this;var r=this.__zr;r&&r!==t.__zr&&t.addSelfToZr(r),r&&r.refresh()},e.prototype.remove=function(t){var r=this.__zr,i=this._children,s=Xi(i,t);return s<0?this:(i.splice(s,1),t.parent=null,r&&t.removeSelfFromZr(r),r&&r.refresh(),this)},e.prototype.removeAll=function(){for(var t=this._children,r=this.__zr,i=0;i<t.length;i++){var s=t[i];r&&s.removeSelfFromZr(r),s.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,r){for(var i=this._children,s=0;s<i.length;s++){var a=i[s];t.call(r,a,s)}return this},e.prototype.traverse=function(t,r){for(var i=0;i<this._children.length;i++){var s=this._children[i],a=t.call(r,s);s.isGroup&&!a&&s.traverse(t,r)}return this},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.removeSelfFromZr(t)}},e.prototype.getBoundingRect=function(t){for(var r=new cs(0,0,0,0),i=t||this._children,s=[],a=null,l=0;l<i.length;l++){var o=i[l];if(!(o.ignore||o.invisible)){var h=o.getBoundingRect(),d=o.getLocalTransform(s);d?(cs.applyTransform(r,h,d),a=a||r.clone(),a.union(r)):(a=a||h.clone(),a.union(h))}}return a||r},e}(PD);ma.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var QI={},rie={};function gMe(n){delete rie[n]}function vMe(n){if(!n)return!1;if(typeof n=="string")return IP(n,1)<rN;if(n.colorStops){for(var e=n.colorStops,t=0,r=e.length,i=0;i<r;i++)t+=IP(e[i].color,1);return t/=r,t<rN}return!1}var _Me=function(){function n(e,t,r){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,r=r||{},this.dom=t,this.id=e;var s=new zTe,a=r.renderer||"canvas";QI[a]||(a=so(QI)[0]),r.useDirtyRect=r.useDirtyRect==null?!1:r.useDirtyRect;var l=new QI[a](t,s,r,e),o=r.ssr||l.ssrOnly;this.storage=s,this.painter=l;var h=!mi.node&&!mi.worker&&!o?new aMe(l.getViewportRoot(),l.root):null,d=r.useCoarsePointer,m=d==null||d==="auto"?mi.touchEventsSupported:!!d,v=44,y;m&&(y=Ei(r.pointerSize,v)),this.handler=new Gre(s,l,h,l.root,y),this.animation=new eMe({stage:{update:o?null:function(){return i._flush(!0)}}}),o||this.animation.start()}return n.prototype.add=function(e){this._disposed||!e||(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},n.prototype.remove=function(e){this._disposed||!e||(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(e,t){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh())},n.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=vMe(e))},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(e){this._darkMode=e},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},n.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},n.prototype.flush=function(){this._disposed||this._flush(!1)},n.prototype._flush=function(e){var t,r=bb();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var i=bb();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-r})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},n.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},n.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},n.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},n.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},n.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},n.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},n.prototype.findHover=function(e,t){if(!this._disposed)return this.handler.findHover(e,t)},n.prototype.on=function(e,t,r){return this._disposed||this.handler.on(e,t,r),this},n.prototype.off=function(e,t){this._disposed||this.handler.off(e,t)},n.prototype.trigger=function(e,t){this._disposed||this.handler.trigger(e,t)},n.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof ma&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},n.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,gMe(this.id))},n}();function c$(n,e){var t=new _Me(Dre(),n,e);return rie[t.id]=t,t}function yMe(n,e){QI[n]=e}var u$=1e-4,iie=20;function xMe(n){return n.replace(/^\s+|\s+$/g,"")}function F0(n,e,t,r){var i=e[0],s=e[1],a=t[0],l=t[1],o=s-i,h=l-a;if(o===0)return h===0?a:(a+l)/2;if(r)if(o>0){if(n<=i)return a;if(n>=s)return l}else{if(n>=i)return a;if(n<=s)return l}else{if(n===i)return a;if(n===s)return l}return(n-i)/o*h+a}function ls(n,e){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return Dr(n)?xMe(n).match(/%$/)?parseFloat(n)/100*e:parseFloat(n):n==null?NaN:+n}function Aa(n,e,t){return e==null&&(e=10),e=Math.min(Math.max(0,e),iie),n=(+n).toFixed(e),t?n:+n}function bMe(n){return n.sort(function(e,t){return e-t}),n}function Rm(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var e=1,t=0;t<15;t++,e*=10)if(Math.round(n*e)/e===n)return t}return wMe(n)}function wMe(n){var e=n.toString().toLowerCase(),t=e.indexOf("e"),r=t>0?+e.slice(t+1):0,i=t>0?t:e.length,s=e.indexOf("."),a=s<0?0:i-1-s;return Math.max(0,a-r)}function sie(n,e){var t=Math.log,r=Math.LN10,i=Math.floor(t(n[1]-n[0])/r),s=Math.round(t(Math.abs(e[1]-e[0]))/r),a=Math.min(Math.max(-i+s,0),20);return isFinite(a)?a:20}function SMe(n,e){var t=pv(n,function(y,S){return y+(isNaN(S)?0:S)},0);if(t===0)return[];for(var r=Math.pow(10,e),i=xr(n,function(y){return(isNaN(y)?0:y)/t*r*100}),s=r*100,a=xr(i,function(y){return Math.floor(y)}),l=pv(a,function(y,S){return y+S},0),o=xr(i,function(y,S){return y-a[S]});l<s;){for(var h=Number.NEGATIVE_INFINITY,d=null,m=0,v=o.length;m<v;++m)o[m]>h&&(h=o[m],d=m);++a[d],o[d]=0,++l}return xr(a,function(y){return y/r})}function AMe(n,e){var t=Math.max(Rm(n),Rm(e)),r=n+e;return t>iie?r:Aa(r,t)}function oie(n){var e=Math.PI*2;return(n%e+e)%e}function LP(n){return n>-u$&&n<u$}var TMe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Km(n){if(n instanceof Date)return n;if(Dr(n)){var e=TMe.exec(n);if(!e)return new Date(NaN);if(e[8]){var t=+e[4]||0;return e[8].toUpperCase()!=="Z"&&(t-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,t,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}else return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function MMe(n){return Math.pow(10,PU(n))}function PU(n){if(n===0)return 0;var e=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,e)>=10&&e++,e}function aie(n,e){var t=PU(n),r=Math.pow(10,t),i=n/r,s;return i<1.5?s=1:i<2.5?s=2:i<4?s=3:i<7?s=5:s=10,n=s*r,t>=-20?+n.toFixed(t<0?-t:0):n}function vv(n){var e=parseFloat(n);return e==n&&(e!==0||!Dr(n)||n.indexOf("x")<=0)?e:NaN}function CMe(n){return!isNaN(vv(n))}function lie(){return Math.round(Math.random()*9)}function cie(n,e){return e===0?n:cie(e,n%e)}function h$(n,e){return n==null?e:e==null?n:n*e/cie(n,e)}function as(n){throw new Error(n)}function f$(n,e,t){return(e-n)*t+n}var uie="series\0",hie="\0_ec_\0";function pa(n){return n instanceof Array?n:n==null?[]:[n]}function oN(n,e,t){if(n){n[e]=n[e]||{},n.emphasis=n.emphasis||{},n.emphasis[e]=n.emphasis[e]||{};for(var r=0,i=t.length;r<i;r++){var s=t[r];!n.emphasis[e].hasOwnProperty(s)&&n[e].hasOwnProperty(s)&&(n.emphasis[e][s]=n[e][s])}}}var d$=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function aM(n){return Xr(n)&&!fr(n)&&!(n instanceof Date)?n.value:n}function EMe(n){return Xr(n)&&!(n instanceof Array)}function IMe(n,e,t){var r=t==="normalMerge",i=t==="replaceMerge",s=t==="replaceAll";n=n||[],e=(e||[]).slice();var a=ii();it(e,function(o,h){if(!Xr(o)){e[h]=null;return}});var l=RMe(n,a,t);return(r||i)&&PMe(l,n,a,e),r&&LMe(l,e),r||i?DMe(l,e,i):s&&BMe(l,e),kMe(l),l}function RMe(n,e,t){var r=[];if(t==="replaceAll")return r;for(var i=0;i<n.length;i++){var s=n[i];s&&s.id!=null&&e.set(s.id,i),r.push({existing:t==="replaceMerge"||oT(s)?null:s,newOption:null,keyInfo:null,brandNew:null})}return r}function PMe(n,e,t,r){it(r,function(i,s){if(!(!i||i.id==null)){var a=oA(i.id),l=t.get(a);if(l!=null){var o=n[l];pp(!o.newOption,'Duplicated option on id "'+a+'".'),o.newOption=i,o.existing=e[l],r[s]=null}}})}function LMe(n,e){it(e,function(t,r){if(!(!t||t.name==null))for(var i=0;i<n.length;i++){var s=n[i].existing;if(!n[i].newOption&&s&&(s.id==null||t.id==null)&&!oT(t)&&!oT(s)&&fie("name",s,t)){n[i].newOption=t,e[r]=null;return}}})}function DMe(n,e,t){it(e,function(r){if(r){for(var i,s=0;(i=n[s])&&(i.newOption||oT(i.existing)||i.existing&&r.id!=null&&!fie("id",r,i.existing));)s++;i?(i.newOption=r,i.brandNew=t):n.push({newOption:r,brandNew:t,existing:null,keyInfo:null}),s++}})}function BMe(n,e){it(e,function(t){n.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})})}function kMe(n){var e=ii();it(n,function(t){var r=t.existing;r&&e.set(r.id,t)}),it(n,function(t){var r=t.newOption;pp(!r||r.id==null||!e.get(r.id)||e.get(r.id)===t,"id duplicates: "+(r&&r.id)),r&&r.id!=null&&e.set(r.id,t),!t.keyInfo&&(t.keyInfo={})}),it(n,function(t,r){var i=t.existing,s=t.newOption,a=t.keyInfo;if(Xr(s)){if(a.name=s.name!=null?oA(s.name):i?i.name:uie+r,i)a.id=oA(i.id);else if(s.id!=null)a.id=oA(s.id);else{var l=0;do a.id="\0"+a.name+"\0"+l++;while(e.get(a.id))}e.set(a.id,t)}})}function fie(n,e,t){var r=cp(e[n],null),i=cp(t[n],null);return r!=null&&i!=null&&r===i}function oA(n){return cp(n,"")}function cp(n,e){return n==null?e:Dr(n)?n:Rs(n)||HF(n)?n+"":e}function LU(n){var e=n.name;return!!(e&&e.indexOf(uie))}function oT(n){return n&&n.id!=null&&oA(n.id).indexOf(hie)===0}function OMe(n){return hie+n}function FMe(n,e,t){it(n,function(r){var i=r.newOption;Xr(i)&&(r.keyInfo.mainType=e,r.keyInfo.subType=NMe(e,i,r.existing,t))})}function NMe(n,e,t,r){var i=e.type?e.type:t?t.subType:r.determineSubType(n,e);return i}function i1(n,e){if(e.dataIndexInside!=null)return e.dataIndexInside;if(e.dataIndex!=null)return fr(e.dataIndex)?xr(e.dataIndex,function(t){return n.indexOfRawIndex(t)}):n.indexOfRawIndex(e.dataIndex);if(e.name!=null)return fr(e.name)?xr(e.name,function(t){return n.indexOfName(t)}):n.indexOfName(e.name)}function $s(){var n="__ec_inner_"+zMe++;return function(e){return e[n]||(e[n]={})}}var zMe=lie();function aA(n,e,t){var r=DU(e,t),i=r.mainTypeSpecified,s=r.queryOptionMap,a=r.others,l=a,o=t?t.defaultMainType:null;return!i&&o&&s.set(o,{}),s.each(function(h,d){var m=lM(n,d,h,{useDefault:o===d,enableAll:t&&t.enableAll!=null?t.enableAll:!0,enableNone:t&&t.enableNone!=null?t.enableNone:!0});l[d+"Models"]=m.models,l[d+"Model"]=m.models[0]}),l}function DU(n,e){var t;if(Dr(n)){var r={};r[n+"Index"]=0,t=r}else t=n;var i=ii(),s={},a=!1;return it(t,function(l,o){if(o==="dataIndex"||o==="dataIndexInside"){s[o]=l;return}var h=o.match(/^(\w+)(Index|Id|Name)$/)||[],d=h[1],m=(h[2]||"").toLowerCase();if(!(!d||!m||e&&e.includeMainTypes&&Xi(e.includeMainTypes,d)<0)){a=a||!!d;var v=i.get(d)||i.set(d,{});v[m]=l}}),{mainTypeSpecified:a,queryOptionMap:i,others:s}}var xl={useDefault:!0,enableAll:!1,enableNone:!1},UMe={useDefault:!1,enableAll:!0,enableNone:!0};function lM(n,e,t,r){r=r||xl;var i=t.index,s=t.id,a=t.name,l={models:null,specified:i!=null||s!=null||a!=null};if(!l.specified){var o=void 0;return l.models=r.useDefault&&(o=n.getComponent(e))?[o]:[],l}return i==="none"||i===!1?(pp(r.enableNone,'`"none"` or `false` is not a valid value on index option.'),l.models=[],l):(i==="all"&&(pp(r.enableAll,'`"all"` is not a valid value on index option.'),i=s=a=null),l.models=n.queryComponents({mainType:e,index:i,id:s,name:a}),l)}function die(n,e,t){n.setAttribute?n.setAttribute(e,t):n[e]=t}function GMe(n,e){return n.getAttribute?n.getAttribute(e):n[e]}function VMe(n){return n==="auto"?mi.domSupported?"html":"richText":n||"html"}function pie(n,e,t,r,i){var s=e==null||e==="auto";if(r==null)return r;if(Rs(r)){var a=f$(t||0,r,i);return Aa(a,s?Math.max(Rm(t||0),Rm(r)):e)}else{if(Dr(r))return i<1?t:r;for(var l=[],o=t,h=r,d=Math.max(o?o.length:0,h.length),m=0;m<d;++m){var v=n.getDimensionInfo(m);if(v&&v.type==="ordinal")l[m]=(i<1&&o?o:h)[m];else{var y=o&&o[m]?o[m]:0,S=h[m],a=f$(y,S,i);l[m]=Aa(a,s?Math.max(Rm(y),Rm(S)):e)}}return l}}var HMe=".",N_="___EC__COMPONENT__CONTAINER___",mie="___EC__EXTENDED_CLASS___";function np(n){var e={main:"",sub:""};if(n){var t=n.split(HMe);e.main=t[0]||"",e.sub=t[1]||""}return e}function jMe(n){pp(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function WMe(n){return!!(n&&n[mie])}function BU(n,e){n.$constructor=n,n.extend=function(t){var r=this,i;return XMe(r)?i=function(s){Hn(a,s);function a(){return s.apply(this,arguments)||this}return a}(r):(i=function(){(t.$constructor||r).apply(this,arguments)},eTe(i,this)),Jn(i.prototype,t),i[mie]=!0,i.extend=this.extend,i.superCall=ZMe,i.superApply=YMe,i.superClass=r,i}}function XMe(n){return ci(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function gie(n,e){n.extend=e.extend}var $Me=Math.round(Math.random()*10);function qMe(n){var e=["__\0is_clz",$Me++].join("_");n.prototype[e]=!0,n.isInstance=function(t){return!!(t&&t[e])}}function ZMe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return this.superClass.prototype[e].apply(n,t)}function YMe(n,e,t){return this.superClass.prototype[e].apply(n,t)}function LD(n){var e={};n.registerClass=function(r){var i=r.type||r.prototype.type;if(i){jMe(i),r.prototype.type=i;var s=np(i);if(!s.sub)e[s.main]=r;else if(s.sub!==N_){var a=t(s);a[s.sub]=r}}return r},n.getClass=function(r,i,s){var a=e[r];if(a&&a[N_]&&(a=i?a[i]:null),s&&!a)throw new Error(i?"Component "+r+"."+(i||"")+" is used but not imported.":r+".type should be specified.");return a},n.getClassesByMainType=function(r){var i=np(r),s=[],a=e[i.main];return a&&a[N_]?it(a,function(l,o){o!==N_&&s.push(l)}):s.push(a),s},n.hasClass=function(r){var i=np(r);return!!e[i.main]},n.getAllClassMainTypes=function(){var r=[];return it(e,function(i,s){r.push(s)}),r},n.hasSubTypes=function(r){var i=np(r),s=e[i.main];return s&&s[N_]};function t(r){var i=e[r.main];return(!i||!i[N_])&&(i=e[r.main]={},i[N_]=!0),i}}function aT(n,e){for(var t=0;t<n.length;t++)n[t][1]||(n[t][1]=n[t][0]);return e=e||!1,function(r,i,s){for(var a={},l=0;l<n.length;l++){var o=n[l][1];if(!(i&&Xi(i,o)>=0||s&&Xi(s,o)<0)){var h=r.getShallow(o,e);h!=null&&(a[n[l][0]]=h)}}return a}}var KMe=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],JMe=aT(KMe),QMe=function(){function n(){}return n.prototype.getAreaStyle=function(e,t){return JMe(this,e,t)},n}(),aN=new iM(50);function eCe(n){if(typeof n=="string"){var e=aN.get(n);return e&&e.image}else return n}function vie(n,e,t,r,i){if(n)if(typeof n=="string"){if(e&&e.__zrImageSrc===n||!t)return e;var s=aN.get(n),a={hostEl:t,cb:r,cbPayload:i};return s?(e=s.image,!DD(e)&&s.pending.push(a)):(e=Sw.loadImage(n,p$,p$),e.__zrImageSrc=n,aN.put(n,e.__cachedImgObj={image:e,pending:[a]})),e}else return n;else return e}function p$(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<n.pending.length;e++){var t=n.pending[e],r=t.cb;r&&r(this,t.cbPayload),t.hostEl.dirty()}n.pending.length=0}function DD(n){return n&&n.width&&n.height}var BB=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function tCe(n,e,t,r,i){if(!e)return"";var s=(n+"").split(`
`);i=_ie(e,t,r,i);for(var a=0,l=s.length;a<l;a++)s[a]=yie(s[a],i);return s.join(`
`)}function _ie(n,e,t,r){r=r||{};var i=Jn({},r);i.font=e,t=Ei(t,"..."),i.maxIterations=Ei(r.maxIterations,2);var s=i.minChar=Ei(r.minChar,0);i.cnCharWidth=Ou("",e);var a=i.ascCharWidth=Ou("a",e);i.placeholder=Ei(r.placeholder,"");for(var l=n=Math.max(0,n-1),o=0;o<s&&l>=a;o++)l-=a;var h=Ou(t,e);return h>l&&(t="",h=0),l=n-h,i.ellipsis=t,i.ellipsisWidth=h,i.contentWidth=l,i.containerWidth=n,i}function yie(n,e){var t=e.containerWidth,r=e.font,i=e.contentWidth;if(!t)return"";var s=Ou(n,r);if(s<=t)return n;for(var a=0;;a++){if(s<=i||a>=e.maxIterations){n+=e.ellipsis;break}var l=a===0?nCe(n,i,e.ascCharWidth,e.cnCharWidth):s>0?Math.floor(n.length*i/s):0;n=n.substr(0,l),s=Ou(n,r)}return n===""&&(n=e.placeholder),n}function nCe(n,e,t,r){for(var i=0,s=0,a=n.length;s<a&&i<e;s++){var l=n.charCodeAt(s);i+=0<=l&&l<=127?t:r}return s}function rCe(n,e){n!=null&&(n+="");var t=e.overflow,r=e.padding,i=e.font,s=t==="truncate",a=RU(i),l=Ei(e.lineHeight,a),o=!!e.backgroundColor,h=e.lineOverflow==="truncate",d=e.width,m;d!=null&&(t==="break"||t==="breakAll")?m=n?xie(n,e.font,d,t==="breakAll",0).lines:[]:m=n?n.split(`
`):[];var v=m.length*l,y=Ei(e.height,v);if(v>y&&h){var S=Math.floor(y/l);m=m.slice(0,S)}if(n&&s&&d!=null)for(var E=_ie(d,i,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),M=0;M<m.length;M++)m[M]=yie(m[M],E);for(var C=y,L=0,M=0;M<m.length;M++)L=Math.max(Ou(m[M],i),L);d==null&&(d=L);var k=L;return r&&(C+=r[0]+r[2],k+=r[1]+r[3],d+=r[1]+r[3]),o&&(k=d),{lines:m,height:y,outerWidth:k,outerHeight:C,lineHeight:l,calculatedLineHeight:a,contentWidth:L,contentHeight:v,width:d}}var iCe=function(){function n(){}return n}(),m$=function(){function n(e){this.tokens=[],e&&(this.tokens=e)}return n}(),sCe=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return n}();function oCe(n,e){var t=new sCe;if(n!=null&&(n+=""),!n)return t;for(var r=e.width,i=e.height,s=e.overflow,a=(s==="break"||s==="breakAll")&&r!=null?{width:r,accumWidth:0,breakAll:s==="breakAll"}:null,l=BB.lastIndex=0,o;(o=BB.exec(n))!=null;){var h=o.index;h>l&&kB(t,n.substring(l,h),e,a),kB(t,o[2],e,a,o[1]),l=BB.lastIndex}l<n.length&&kB(t,n.substring(l,n.length),e,a);var d=[],m=0,v=0,y=e.padding,S=s==="truncate",E=e.lineOverflow==="truncate";function M(ye,$e,Ve){ye.width=$e,ye.lineHeight=Ve,m+=Ve,v=Math.max(v,$e)}e:for(var C=0;C<t.lines.length;C++){for(var L=t.lines[C],k=0,H=0,q=0;q<L.tokens.length;q++){var Z=L.tokens[q],ee=Z.styleName&&e.rich[Z.styleName]||{},re=Z.textPadding=ee.padding,se=re?re[1]+re[3]:0,ae=Z.font=ee.font||e.font;Z.contentHeight=RU(ae);var fe=Ei(ee.height,Z.contentHeight);if(Z.innerHeight=fe,re&&(fe+=re[0]+re[2]),Z.height=fe,Z.lineHeight=nA(ee.lineHeight,e.lineHeight,fe),Z.align=ee&&ee.align||e.align,Z.verticalAlign=ee&&ee.verticalAlign||"middle",E&&i!=null&&m+Z.lineHeight>i){q>0?(L.tokens=L.tokens.slice(0,q),M(L,H,k),t.lines=t.lines.slice(0,C+1)):t.lines=t.lines.slice(0,C);break e}var Se=ee.width,Ce=Se==null||Se==="auto";if(typeof Se=="string"&&Se.charAt(Se.length-1)==="%")Z.percentWidth=Se,d.push(Z),Z.contentWidth=Ou(Z.text,ae);else{if(Ce){var Ie=ee.backgroundColor,je=Ie&&Ie.image;je&&(je=eCe(je),DD(je)&&(Z.width=Math.max(Z.width,je.width*fe/je.height)))}var Le=S&&r!=null?r-H:null;Le!=null&&Le<Z.width?!Ce||Le<se?(Z.text="",Z.width=Z.contentWidth=0):(Z.text=tCe(Z.text,Le-se,ae,e.ellipsis,{minChar:e.truncateMinChar}),Z.width=Z.contentWidth=Ou(Z.text,ae)):Z.contentWidth=Ou(Z.text,ae)}Z.width+=se,H+=Z.width,ee&&(k=Math.max(k,Z.lineHeight))}M(L,H,k)}t.outerWidth=t.width=Ei(r,v),t.outerHeight=t.height=Ei(i,m),t.contentHeight=m,t.contentWidth=v,y&&(t.outerWidth+=y[1]+y[3],t.outerHeight+=y[0]+y[2]);for(var C=0;C<d.length;C++){var Z=d[C],ot=Z.percentWidth;Z.width=parseInt(ot,10)/100*t.width}return t}function kB(n,e,t,r,i){var s=e==="",a=i&&t.rich[i]||{},l=n.lines,o=a.font||t.font,h=!1,d,m;if(r){var v=a.padding,y=v?v[1]+v[3]:0;if(a.width!=null&&a.width!=="auto"){var S=gv(a.width,r.width)+y;l.length>0&&S+r.accumWidth>r.width&&(d=e.split(`
`),h=!0),r.accumWidth=S}else{var E=xie(e,o,r.width,r.breakAll,r.accumWidth);r.accumWidth=E.accumWidth+y,m=E.linesWidths,d=E.lines}}else d=e.split(`
`);for(var M=0;M<d.length;M++){var C=d[M],L=new iCe;if(L.styleName=i,L.text=C,L.isLineHolder=!C&&!s,typeof a.width=="number"?L.width=a.width:L.width=m?m[M]:Ou(C,o),!M&&!h){var k=(l[l.length-1]||(l[0]=new m$)).tokens,H=k.length;H===1&&k[0].isLineHolder?k[0]=L:(C||!H||s)&&k.push(L)}else l.push(new m$([L]))}}function aCe(n){var e=n.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}var lCe=pv(",&?/;] ".split(""),function(n,e){return n[e]=!0,n},{});function cCe(n){return aCe(n)?!!lCe[n]:!0}function xie(n,e,t,r,i){for(var s=[],a=[],l="",o="",h=0,d=0,m=0;m<n.length;m++){var v=n.charAt(m);if(v===`
`){o&&(l+=o,d+=h),s.push(l),a.push(d),l="",o="",h=0,d=0;continue}var y=Ou(v,e),S=r?!1:!cCe(v);if(s.length?d+y>t:i+d+y>t){d?(l||o)&&(S?(l||(l=o,o="",h=0,d=h),s.push(l),a.push(d-h),o+=v,h+=y,l="",d=h):(o&&(l+=o,o="",h=0),s.push(l),a.push(d),l=v,d=y)):S?(s.push(o),a.push(h),o=v,h=y):(s.push(v),a.push(y));continue}d+=y,S?(o+=v,h+=y):(o&&(l+=o,o="",h=0),l+=v)}return!s.length&&!l&&(l=n,o="",h=0),o&&(l+=o),l&&(s.push(l),a.push(d)),s.length===1&&(d+=i),{accumWidth:d,lines:s,linesWidths:a}}var lN="__zr_style_"+Math.round(Math.random()*10),zy={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},BD={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};zy[lN]=!0;var g$=["z","z2","invisible"],uCe=["invisible"],hCe=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype._init=function(t){for(var r=so(t),i=0;i<r.length;i++){var s=r[i];s==="style"?this.useStyle(t[s]):n.prototype.attrKV.call(this,s,t[s])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,r,i,s){var a=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&fCe(this,t,r)||a&&!a[0]&&!a[3])return!1;if(i&&this.__clipPaths){for(var l=0;l<this.__clipPaths.length;++l)if(this.__clipPaths[l].isZeroArea())return!1}if(s&&this.parent)for(var o=this.parent;o;){if(o.ignore)return!1;o=o.parent}return!0},e.prototype.contain=function(t,r){return this.rectContain(t,r)},e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.rectContain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect();return s.contain(i[0],i[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var r=this.transform,i=this.getBoundingRect(),s=this.style,a=s.shadowBlur||0,l=s.shadowOffsetX||0,o=s.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new cs(0,0,0,0)),r?cs.applyTransform(t,i,r):t.copy(i),(a||l||o)&&(t.width+=a*2+Math.abs(l),t.height+=a*2+Math.abs(o),t.x=Math.min(t.x,t.x+l-a),t.y=Math.min(t.y,t.y+o-a));var h=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-h),t.y=Math.floor(t.y-h),t.width=Math.ceil(t.width+1+h*2),t.height=Math.ceil(t.height+1+h*2))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new cs(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(t,r){t!=="style"?n.prototype.attrKV.call(this,t,r):this.style?this.setStyle(r):this.useStyle(r)},e.prototype.setStyle=function(t,r){return typeof t=="string"?this.style[t]=r:Jn(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=AS,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(this.__dirty&AS)},e.prototype.styleUpdated=function(){this.__dirty&=~AS},e.prototype.createStyle=function(t){return CD(zy,t)},e.prototype.useStyle=function(t){t[lN]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[lN]},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.style&&!r.style&&(r.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,r,g$)},e.prototype._applyStateObj=function(t,r,i,s,a,l){n.prototype._applyStateObj.call(this,t,r,i,s,a,l);var o=!(r&&s),h;if(r&&r.style?a?s?h=r.style:(h=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(h,r.style)):(h=this._mergeStyle(this.createStyle(),s?this.style:i.style),this._mergeStyle(h,r.style)):o&&(h=i.style),h)if(a){var d=this.style;if(this.style=this.createStyle(o?{}:d),o)for(var m=so(d),v=0;v<m.length;v++){var y=m[v];y in h&&(h[y]=h[y],this.style[y]=d[y])}for(var S=so(h),v=0;v<S.length;v++){var y=S[v];this.style[y]=this.style[y]}this._transitionState(t,{style:h},l,this.getAnimationStyleProps())}else this.useStyle(h);for(var E=this.__inHover?uCe:g$,v=0;v<E.length;v++){var y=E[v];r&&r[y]!=null?this[y]=r[y]:o&&i[y]!=null&&(this[y]=i[y])}},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,s=0;s<t.length;s++){var a=t[s];a.style&&(i=i||{},this._mergeStyle(i,a.style))}return i&&(r.style=i),r},e.prototype._mergeStyle=function(t,r){return Jn(t,r),t},e.prototype.getAnimationStyleProps=function(){return BD},e.initDefaultProps=function(){var t=e.prototype;t.type="displayable",t.invisible=!1,t.z=0,t.z2=0,t.zlevel=0,t.culling=!1,t.cursor="pointer",t.rectHover=!1,t.incremental=!1,t._rect=null,t.dirtyRectTolerance=0,t.__dirty=Lu|AS}(),e}(PD),OB=new cs(0,0,0,0),FB=new cs(0,0,0,0);function fCe(n,e,t){return OB.copy(n.getBoundingRect()),n.transform&&OB.applyTransform(n.transform),FB.width=e,FB.height=t,!OB.intersect(FB)}const Mw=hCe;var tu=Math.min,nu=Math.max,NB=Math.sin,zB=Math.cos,z_=Math.PI*2,OE=Tw(),FE=Tw(),NE=Tw();function bie(n,e,t){if(n.length!==0){for(var r=n[0],i=r[0],s=r[0],a=r[1],l=r[1],o=1;o<n.length;o++)r=n[o],i=tu(i,r[0]),s=nu(s,r[0]),a=tu(a,r[1]),l=nu(l,r[1]);e[0]=i,e[1]=a,t[0]=s,t[1]=l}}function v$(n,e,t,r,i,s){i[0]=tu(n,t),i[1]=tu(e,r),s[0]=nu(n,t),s[1]=nu(e,r)}var _$=[],y$=[];function dCe(n,e,t,r,i,s,a,l,o,h){var d=Xre,m=Ga,v=d(n,t,i,a,_$);o[0]=1/0,o[1]=1/0,h[0]=-1/0,h[1]=-1/0;for(var y=0;y<v;y++){var S=m(n,t,i,a,_$[y]);o[0]=tu(S,o[0]),h[0]=nu(S,h[0])}v=d(e,r,s,l,y$);for(var y=0;y<v;y++){var E=m(e,r,s,l,y$[y]);o[1]=tu(E,o[1]),h[1]=nu(E,h[1])}o[0]=tu(n,o[0]),h[0]=nu(n,h[0]),o[0]=tu(a,o[0]),h[0]=nu(a,h[0]),o[1]=tu(e,o[1]),h[1]=nu(e,h[1]),o[1]=tu(l,o[1]),h[1]=nu(l,h[1])}function pCe(n,e,t,r,i,s,a,l){var o=qre,h=Ul,d=nu(tu(o(n,t,i),1),0),m=nu(tu(o(e,r,s),1),0),v=h(n,t,i,d),y=h(e,r,s,m);a[0]=tu(n,i,v),a[1]=tu(e,s,y),l[0]=nu(n,i,v),l[1]=nu(e,s,y)}function mCe(n,e,t,r,i,s,a,l,o){var h=yb,d=xb,m=Math.abs(i-s);if(m%z_<1e-4&&m>1e-4){l[0]=n-t,l[1]=e-r,o[0]=n+t,o[1]=e+r;return}if(OE[0]=zB(i)*t+n,OE[1]=NB(i)*r+e,FE[0]=zB(s)*t+n,FE[1]=NB(s)*r+e,h(l,OE,FE),d(o,OE,FE),i=i%z_,i<0&&(i=i+z_),s=s%z_,s<0&&(s=s+z_),i>s&&!a?s+=z_:i<s&&a&&(i+=z_),a){var v=s;s=i,i=v}for(var y=0;y<s;y+=Math.PI/2)y>i&&(NE[0]=zB(y)*t+n,NE[1]=NB(y)*r+e,h(l,NE,l),d(o,NE,o))}var Es={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},U_=[],G_=[],Hd=[],g0=[],jd=[],Wd=[],UB=Math.min,GB=Math.max,V_=Math.cos,H_=Math.sin,pm=Math.abs,cN=Math.PI,E0=cN*2,VB=typeof Float32Array<"u",X2=[];function HB(n){var e=Math.round(n/cN*1e8)/1e8;return e%2*cN}function wie(n,e){var t=HB(n[0]);t<0&&(t+=E0);var r=t-n[0],i=n[1];i+=r,!e&&i-t>=E0?i=t+E0:e&&t-i>=E0?i=t-E0:!e&&t>i?i=t+(E0-HB(t-i)):e&&t<i&&(i=t-(E0-HB(i-t))),n[0]=t,n[1]=i}var Jm=function(){function n(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(e,t,r){r=r||0,r>0&&(this._ux=pm(r/RP/e)||0,this._uy=pm(r/RP/t)||0)},n.prototype.setDPR=function(e){this.dpr=e},n.prototype.setContext=function(e){this._ctx=e},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(Es.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},n.prototype.lineTo=function(e,t){var r=pm(e-this._xi),i=pm(t-this._yi),s=r>this._ux||i>this._uy;if(this.addData(Es.L,e,t),this._ctx&&s&&this._ctx.lineTo(e,t),s)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var a=r*r+i*i;a>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=a)}return this},n.prototype.bezierCurveTo=function(e,t,r,i,s,a){return this._drawPendingPt(),this.addData(Es.C,e,t,r,i,s,a),this._ctx&&this._ctx.bezierCurveTo(e,t,r,i,s,a),this._xi=s,this._yi=a,this},n.prototype.quadraticCurveTo=function(e,t,r,i){return this._drawPendingPt(),this.addData(Es.Q,e,t,r,i),this._ctx&&this._ctx.quadraticCurveTo(e,t,r,i),this._xi=r,this._yi=i,this},n.prototype.arc=function(e,t,r,i,s,a){this._drawPendingPt(),X2[0]=i,X2[1]=s,wie(X2,a),i=X2[0],s=X2[1];var l=s-i;return this.addData(Es.A,e,t,r,r,i,l,0,a?0:1),this._ctx&&this._ctx.arc(e,t,r,i,s,a),this._xi=V_(s)*r+e,this._yi=H_(s)*r+t,this},n.prototype.arcTo=function(e,t,r,i,s){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,r,i,s),this},n.prototype.rect=function(e,t,r,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,r,i),this.addData(Es.R,e,t,r,i),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(Es.Z);var e=this._ctx,t=this._x0,r=this._y0;return e&&e.closePath(),this._xi=t,this._yi=r,this},n.prototype.fill=function(e){e&&e.fill(),this.toStatic()},n.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(e){var t=e.length;!(this.data&&this.data.length===t)&&VB&&(this.data=new Float32Array(t));for(var r=0;r<t;r++)this.data[r]=e[r];this._len=t},n.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var t=e.length,r=0,i=this._len,s=0;s<t;s++)r+=e[s].len();VB&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+r));for(var s=0;s<t;s++)for(var a=e[s].data,l=0;l<a.length;l++)this.data[i++]=a[l];this._len=i},n.prototype.addData=function(e,t,r,i,s,a,l,o,h){if(this._saveData){var d=this.data;this._len+arguments.length>d.length&&(this._expandData(),d=this.data);for(var m=0;m<arguments.length;m++)d[this._len++]=arguments[m]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,VB&&this._len>11&&(this.data=new Float32Array(e)))}},n.prototype.getBoundingRect=function(){Hd[0]=Hd[1]=jd[0]=jd[1]=Number.MAX_VALUE,g0[0]=g0[1]=Wd[0]=Wd[1]=-Number.MAX_VALUE;var e=this.data,t=0,r=0,i=0,s=0,a;for(a=0;a<this._len;){var l=e[a++],o=a===1;switch(o&&(t=e[a],r=e[a+1],i=t,s=r),l){case Es.M:t=i=e[a++],r=s=e[a++],jd[0]=i,jd[1]=s,Wd[0]=i,Wd[1]=s;break;case Es.L:v$(t,r,e[a],e[a+1],jd,Wd),t=e[a++],r=e[a++];break;case Es.C:dCe(t,r,e[a++],e[a++],e[a++],e[a++],e[a],e[a+1],jd,Wd),t=e[a++],r=e[a++];break;case Es.Q:pCe(t,r,e[a++],e[a++],e[a],e[a+1],jd,Wd),t=e[a++],r=e[a++];break;case Es.A:var h=e[a++],d=e[a++],m=e[a++],v=e[a++],y=e[a++],S=e[a++]+y;a+=1;var E=!e[a++];o&&(i=V_(y)*m+h,s=H_(y)*v+d),mCe(h,d,m,v,y,S,E,jd,Wd),t=V_(S)*m+h,r=H_(S)*v+d;break;case Es.R:i=t=e[a++],s=r=e[a++];var M=e[a++],C=e[a++];v$(i,s,i+M,s+C,jd,Wd);break;case Es.Z:t=i,r=s;break}yb(Hd,Hd,jd),xb(g0,g0,Wd)}return a===0&&(Hd[0]=Hd[1]=g0[0]=g0[1]=0),new cs(Hd[0],Hd[1],g0[0]-Hd[0],g0[1]-Hd[1])},n.prototype._calculateLength=function(){var e=this.data,t=this._len,r=this._ux,i=this._uy,s=0,a=0,l=0,o=0;this._pathSegLen||(this._pathSegLen=[]);for(var h=this._pathSegLen,d=0,m=0,v=0;v<t;){var y=e[v++],S=v===1;S&&(s=e[v],a=e[v+1],l=s,o=a);var E=-1;switch(y){case Es.M:s=l=e[v++],a=o=e[v++];break;case Es.L:{var M=e[v++],C=e[v++],L=M-s,k=C-a;(pm(L)>r||pm(k)>i||v===t-1)&&(E=Math.sqrt(L*L+k*k),s=M,a=C);break}case Es.C:{var H=e[v++],q=e[v++],M=e[v++],C=e[v++],Z=e[v++],ee=e[v++];E=UTe(s,a,H,q,M,C,Z,ee,10),s=Z,a=ee;break}case Es.Q:{var H=e[v++],q=e[v++],M=e[v++],C=e[v++];E=VTe(s,a,H,q,M,C,10),s=M,a=C;break}case Es.A:var re=e[v++],se=e[v++],ae=e[v++],fe=e[v++],Se=e[v++],Ce=e[v++],Ie=Ce+Se;v+=1,S&&(l=V_(Se)*ae+re,o=H_(Se)*fe+se),E=GB(ae,fe)*UB(E0,Math.abs(Ce)),s=V_(Ie)*ae+re,a=H_(Ie)*fe+se;break;case Es.R:{l=s=e[v++],o=a=e[v++];var je=e[v++],Le=e[v++];E=je*2+Le*2;break}case Es.Z:{var L=l-s,k=o-a;E=Math.sqrt(L*L+k*k),s=l,a=o;break}}E>=0&&(h[m++]=E,d+=E)}return this._pathLen=d,d},n.prototype.rebuildPath=function(e,t){var r=this.data,i=this._ux,s=this._uy,a=this._len,l,o,h,d,m,v,y=t<1,S,E,M=0,C=0,L,k=0,H,q;if(!(y&&(this._pathSegLen||this._calculateLength(),S=this._pathSegLen,E=this._pathLen,L=t*E,!L)))e:for(var Z=0;Z<a;){var ee=r[Z++],re=Z===1;switch(re&&(h=r[Z],d=r[Z+1],l=h,o=d),ee!==Es.L&&k>0&&(e.lineTo(H,q),k=0),ee){case Es.M:l=h=r[Z++],o=d=r[Z++],e.moveTo(h,d);break;case Es.L:{m=r[Z++],v=r[Z++];var se=pm(m-h),ae=pm(v-d);if(se>i||ae>s){if(y){var fe=S[C++];if(M+fe>L){var Se=(L-M)/fe;e.lineTo(h*(1-Se)+m*Se,d*(1-Se)+v*Se);break e}M+=fe}e.lineTo(m,v),h=m,d=v,k=0}else{var Ce=se*se+ae*ae;Ce>k&&(H=m,q=v,k=Ce)}break}case Es.C:{var Ie=r[Z++],je=r[Z++],Le=r[Z++],ot=r[Z++],ye=r[Z++],$e=r[Z++];if(y){var fe=S[C++];if(M+fe>L){var Se=(L-M)/fe;mv(h,Ie,Le,ye,Se,U_),mv(d,je,ot,$e,Se,G_),e.bezierCurveTo(U_[1],G_[1],U_[2],G_[2],U_[3],G_[3]);break e}M+=fe}e.bezierCurveTo(Ie,je,Le,ot,ye,$e),h=ye,d=$e;break}case Es.Q:{var Ie=r[Z++],je=r[Z++],Le=r[Z++],ot=r[Z++];if(y){var fe=S[C++];if(M+fe>L){var Se=(L-M)/fe;EP(h,Ie,Le,Se,U_),EP(d,je,ot,Se,G_),e.quadraticCurveTo(U_[1],G_[1],U_[2],G_[2]);break e}M+=fe}e.quadraticCurveTo(Ie,je,Le,ot),h=Le,d=ot;break}case Es.A:var Ve=r[Z++],_t=r[Z++],wt=r[Z++],Vt=r[Z++],lt=r[Z++],Ht=r[Z++],Qt=r[Z++],rn=!r[Z++],jn=wt>Vt?wt:Vt,Bn=pm(wt-Vt)>.001,Tn=lt+Ht,Pe=!1;if(y){var fe=S[C++];M+fe>L&&(Tn=lt+Ht*(L-M)/fe,Pe=!0),M+=fe}if(Bn&&e.ellipse?e.ellipse(Ve,_t,wt,Vt,Qt,lt,Tn,rn):e.arc(Ve,_t,jn,lt,Tn,rn),Pe)break e;re&&(l=V_(lt)*wt+Ve,o=H_(lt)*Vt+_t),h=V_(Tn)*wt+Ve,d=H_(Tn)*Vt+_t;break;case Es.R:l=h=r[Z],o=d=r[Z+1],m=r[Z++],v=r[Z++];var qe=r[Z++],mn=r[Z++];if(y){var fe=S[C++];if(M+fe>L){var cn=L-M;e.moveTo(m,v),e.lineTo(m+UB(cn,qe),v),cn-=qe,cn>0&&e.lineTo(m+qe,v+UB(cn,mn)),cn-=mn,cn>0&&e.lineTo(m+GB(qe-cn,0),v+mn),cn-=qe,cn>0&&e.lineTo(m,v+GB(mn-cn,0));break e}M+=fe}e.rect(m,v,qe,mn);break;case Es.Z:if(y){var fe=S[C++];if(M+fe>L){var Se=(L-M)/fe;e.lineTo(h*(1-Se)+l*Se,d*(1-Se)+o*Se);break e}M+=fe}e.closePath(),h=l,d=o}}},n.prototype.clone=function(){var e=new n,t=this.data;return e.data=t.slice?t.slice():Array.prototype.slice.call(t),e._len=this._len,e},n.CMD=Es,n.initDefaultProps=function(){var e=n.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}(),n}();function Rx(n,e,t,r,i,s,a){if(i===0)return!1;var l=i,o=0,h=n;if(a>e+l&&a>r+l||a<e-l&&a<r-l||s>n+l&&s>t+l||s<n-l&&s<t-l)return!1;if(n!==t)o=(e-r)/(n-t),h=(n*r-t*e)/(n-t);else return Math.abs(s-n)<=l/2;var d=o*s-a+h,m=d*d/(o*o+1);return m<=l/2*l/2}function gCe(n,e,t,r,i,s,a,l,o,h,d){if(o===0)return!1;var m=o;if(d>e+m&&d>r+m&&d>s+m&&d>l+m||d<e-m&&d<r-m&&d<s-m&&d<l-m||h>n+m&&h>t+m&&h>i+m&&h>a+m||h<n-m&&h<t-m&&h<i-m&&h<a-m)return!1;var v=$re(n,e,t,r,i,s,a,l,h,d,null);return v<=m/2}function vCe(n,e,t,r,i,s,a,l,o){if(a===0)return!1;var h=a;if(o>e+h&&o>r+h&&o>s+h||o<e-h&&o<r-h&&o<s-h||l>n+h&&l>t+h&&l>i+h||l<n-h&&l<t-h&&l<i-h)return!1;var d=Zre(n,e,t,r,i,s,l,o,null);return d<=h/2}var x$=Math.PI*2;function Pm(n){return n%=x$,n<0&&(n+=x$),n}var $2=Math.PI*2;function _Ce(n,e,t,r,i,s,a,l,o){if(a===0)return!1;var h=a;l-=n,o-=e;var d=Math.sqrt(l*l+o*o);if(d-h>t||d+h<t)return!1;if(Math.abs(r-i)%$2<1e-4)return!0;if(s){var m=r;r=Pm(i),i=Pm(m)}else r=Pm(r),i=Pm(i);r>i&&(i+=$2);var v=Math.atan2(o,l);return v<0&&(v+=$2),v>=r&&v<=i||v+$2>=r&&v+$2<=i}function j_(n,e,t,r,i,s){if(s>e&&s>r||s<e&&s<r||r===e)return 0;var a=(s-e)/(r-e),l=r<e?1:-1;(a===1||a===0)&&(l=r<e?.5:-.5);var o=a*(t-n)+n;return o===i?1/0:o>i?l:0}var v0=Jm.CMD,W_=Math.PI*2,yCe=1e-4;function xCe(n,e){return Math.abs(n-e)<yCe}var xc=[-1,-1,-1],vh=[-1,-1];function bCe(){var n=vh[0];vh[0]=vh[1],vh[1]=n}function wCe(n,e,t,r,i,s,a,l,o,h){if(h>e&&h>r&&h>s&&h>l||h<e&&h<r&&h<s&&h<l)return 0;var d=CP(e,r,s,l,h,xc);if(d===0)return 0;for(var m=0,v=-1,y=void 0,S=void 0,E=0;E<d;E++){var M=xc[E],C=M===0||M===1?.5:1,L=Ga(n,t,i,a,M);L<o||(v<0&&(v=Xre(e,r,s,l,vh),vh[1]<vh[0]&&v>1&&bCe(),y=Ga(e,r,s,l,vh[0]),v>1&&(S=Ga(e,r,s,l,vh[1]))),v===2?M<vh[0]?m+=y<e?C:-C:M<vh[1]?m+=S<y?C:-C:m+=l<S?C:-C:M<vh[0]?m+=y<e?C:-C:m+=l<y?C:-C)}return m}function SCe(n,e,t,r,i,s,a,l){if(l>e&&l>r&&l>s||l<e&&l<r&&l<s)return 0;var o=GTe(e,r,s,l,xc);if(o===0)return 0;var h=qre(e,r,s);if(h>=0&&h<=1){for(var d=0,m=Ul(e,r,s,h),v=0;v<o;v++){var y=xc[v]===0||xc[v]===1?.5:1,S=Ul(n,t,i,xc[v]);S<a||(xc[v]<h?d+=m<e?y:-y:d+=s<m?y:-y)}return d}else{var y=xc[0]===0||xc[0]===1?.5:1,S=Ul(n,t,i,xc[0]);return S<a?0:s<e?y:-y}}function ACe(n,e,t,r,i,s,a,l){if(l-=e,l>t||l<-t)return 0;var o=Math.sqrt(t*t-l*l);xc[0]=-o,xc[1]=o;var h=Math.abs(r-i);if(h<1e-4)return 0;if(h>=W_-1e-4){r=0,i=W_;var d=s?1:-1;return a>=xc[0]+n&&a<=xc[1]+n?d:0}if(r>i){var m=r;r=i,i=m}r<0&&(r+=W_,i+=W_);for(var v=0,y=0;y<2;y++){var S=xc[y];if(S+n>a){var E=Math.atan2(l,S),d=s?1:-1;E<0&&(E=W_+E),(E>=r&&E<=i||E+W_>=r&&E+W_<=i)&&(E>Math.PI/2&&E<Math.PI*1.5&&(d=-d),v+=d)}}return v}function Sie(n,e,t,r,i){for(var s=n.data,a=n.len(),l=0,o=0,h=0,d=0,m=0,v,y,S=0;S<a;){var E=s[S++],M=S===1;switch(E===v0.M&&S>1&&(t||(l+=j_(o,h,d,m,r,i))),M&&(o=s[S],h=s[S+1],d=o,m=h),E){case v0.M:d=s[S++],m=s[S++],o=d,h=m;break;case v0.L:if(t){if(Rx(o,h,s[S],s[S+1],e,r,i))return!0}else l+=j_(o,h,s[S],s[S+1],r,i)||0;o=s[S++],h=s[S++];break;case v0.C:if(t){if(gCe(o,h,s[S++],s[S++],s[S++],s[S++],s[S],s[S+1],e,r,i))return!0}else l+=wCe(o,h,s[S++],s[S++],s[S++],s[S++],s[S],s[S+1],r,i)||0;o=s[S++],h=s[S++];break;case v0.Q:if(t){if(vCe(o,h,s[S++],s[S++],s[S],s[S+1],e,r,i))return!0}else l+=SCe(o,h,s[S++],s[S++],s[S],s[S+1],r,i)||0;o=s[S++],h=s[S++];break;case v0.A:var C=s[S++],L=s[S++],k=s[S++],H=s[S++],q=s[S++],Z=s[S++];S+=1;var ee=!!(1-s[S++]);v=Math.cos(q)*k+C,y=Math.sin(q)*H+L,M?(d=v,m=y):l+=j_(o,h,v,y,r,i);var re=(r-C)*H/k+C;if(t){if(_Ce(C,L,H,q,q+Z,ee,e,re,i))return!0}else l+=ACe(C,L,H,q,q+Z,ee,re,i);o=Math.cos(q+Z)*k+C,h=Math.sin(q+Z)*H+L;break;case v0.R:d=o=s[S++],m=h=s[S++];var se=s[S++],ae=s[S++];if(v=d+se,y=m+ae,t){if(Rx(d,m,v,m,e,r,i)||Rx(v,m,v,y,e,r,i)||Rx(v,y,d,y,e,r,i)||Rx(d,y,d,m,e,r,i))return!0}else l+=j_(v,m,v,y,r,i),l+=j_(d,y,d,m,r,i);break;case v0.Z:if(t){if(Rx(o,h,d,m,e,r,i))return!0}else l+=j_(o,h,d,m,r,i);o=d,h=m;break}}return!t&&!xCe(h,m)&&(l+=j_(o,h,d,m,r,i)||0),l!==0}function TCe(n,e,t){return Sie(n,0,!1,e,t)}function MCe(n,e,t,r){return Sie(n,e,!0,t,r)}var Aie=ti({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},zy),CCe={style:ti({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},BD.style)},jB=sT.concat(["invisible","culling","z","z2","zlevel","parent"]),$i=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.update=function(){var t=this;n.prototype.update.call(this);var r=this.style;if(r.decal){var i=this._decalEl=this._decalEl||new e;i.buildPath===e.prototype.buildPath&&(i.buildPath=function(o){t.buildPath(o,t.shape)}),i.silent=!0;var s=i.style;for(var a in r)s[a]!==r[a]&&(s[a]=r[a]);s.fill=r.fill?r.decal:null,s.decal=null,s.shadowColor=null,r.strokeFirst&&(s.stroke=null);for(var l=0;l<jB.length;++l)i[jB[l]]=this[jB[l]];i.__dirty|=Lu}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(t){var r=so(t);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var s=0;s<r.length;s++){var a=r[s],l=t[a];a==="style"?this.style?Jn(this.style,l):this.useStyle(l):a==="shape"?Jn(this.shape,l):n.prototype.attrKV.call(this,a,l)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if(t!=="none"){if(Dr(t)){var r=IP(t,0);return r>.5?iN:r>.2?lMe:sN}else if(t)return sN}return iN},e.prototype.getInsideTextStroke=function(t){var r=this.style.fill;if(Dr(r)){var i=this.__zr,s=!!(i&&i.isDarkMode()),a=IP(t,0)<rN;if(s===a)return r}},e.prototype.buildPath=function(t,r,i){},e.prototype.pathUpdated=function(){this.__dirty&=~Kx},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new Jm(!1)},e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return!(r==null||r==="none"||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.getBoundingRect=function(){var t=this._rect,r=this.style,i=!t;if(i){var s=!1;this.path||(s=!0,this.createPathProxy());var a=this.path;(s||this.__dirty&Kx)&&(a.beginPath(),this.buildPath(a,this.shape,!1),this.pathUpdated()),t=a.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var l=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||i){l.copy(t);var o=r.strokeNoScale?this.getLineScale():1,h=r.lineWidth;if(!this.hasFill()){var d=this.strokeContainThreshold;h=Math.max(h,d??4)}o>1e-10&&(l.width+=h/o,l.height+=h/o,l.x-=h/o/2,l.y-=h/o/2)}return l}return t},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect(),a=this.style;if(t=i[0],r=i[1],s.contain(t,r)){var l=this.path;if(this.hasStroke()){var o=a.lineWidth,h=a.strokeNoScale?this.getLineScale():1;if(h>1e-10&&(this.hasFill()||(o=Math.max(o,this.strokeContainThreshold)),MCe(l,o/h,t,r)))return!0}if(this.hasFill())return TCe(l,t,r)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=Kx,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():t==="shape"?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(t,r){t==="shape"?this.setShape(r):n.prototype.attrKV.call(this,t,r)},e.prototype.setShape=function(t,r){var i=this.shape;return i||(i=this.shape={}),typeof t=="string"?i[t]=r:Jn(i,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(this.__dirty&Kx)},e.prototype.createStyle=function(t){return CD(Aie,t)},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.shape&&!r.shape&&(r.shape=Jn({},this.shape))},e.prototype._applyStateObj=function(t,r,i,s,a,l){n.prototype._applyStateObj.call(this,t,r,i,s,a,l);var o=!(r&&s),h;if(r&&r.shape?a?s?h=r.shape:(h=Jn({},i.shape),Jn(h,r.shape)):(h=Jn({},s?this.shape:i.shape),Jn(h,r.shape)):o&&(h=i.shape),h)if(a){this.shape=Jn({},this.shape);for(var d={},m=so(h),v=0;v<m.length;v++){var y=m[v];typeof h[y]=="object"?this.shape[y]=h[y]:d[y]=h[y]}this._transitionState(t,{shape:d},l)}else this.shape=h,this.dirtyShape()},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,s=0;s<t.length;s++){var a=t[s];a.shape&&(i=i||{},this._mergeStyle(i,a.shape))}return i&&(r.shape=i),r},e.prototype.getAnimationStyleProps=function(){return CCe},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var r=function(s){Hn(a,s);function a(l){var o=s.call(this,l)||this;return t.init&&t.init.call(o,l),o}return a.prototype.getDefaultStyle=function(){return _i(t.style)},a.prototype.getDefaultShape=function(){return _i(t.shape)},a}(e);for(var i in t)typeof t[i]=="function"&&(r.prototype[i]=t[i]);return r},e.initDefaultProps=function(){var t=e.prototype;t.type="path",t.strokeContainThreshold=5,t.segmentIgnoreThreshold=0,t.subPixelOptimize=!1,t.autoBatch=!1,t.__dirty=Lu|AS|Kx}(),e}(Mw),ECe=ti({strokeFirst:!0,font:r1,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Aie),DP=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return r!=null&&r!=="none"&&t.lineWidth>0},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.createStyle=function(t){return CD(ECe,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t=this.style;if(!this._rect){var r=t.text;r!=null?r+="":r="";var i=oM(r,t.font,t.textAlign,t.textBaseline);if(i.x+=t.x||0,i.y+=t.y||0,this.hasStroke()){var s=t.lineWidth;i.x-=s/2,i.y-=s/2,i.width+=s,i.height+=s}this._rect=i}return this._rect},e.initDefaultProps=function(){var t=e.prototype;t.dirtyRectTolerance=10}(),e}(Mw);DP.prototype.type="tspan";var ICe=ti({x:0,y:0},zy),RCe={style:ti({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},BD.style)};function PCe(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var Ov=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.createStyle=function(t){return CD(ICe,t)},e.prototype._getSize=function(t){var r=this.style,i=r[t];if(i!=null)return i;var s=PCe(r.image)?r.image:this.__image;if(!s)return 0;var a=t==="width"?"height":"width",l=r[a];return l==null?s[t]:s[t]/s[a]*l},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return RCe},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new cs(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Mw);Ov.prototype.type="image";function LCe(n,e){var t=e.x,r=e.y,i=e.width,s=e.height,a=e.r,l,o,h,d;i<0&&(t=t+i,i=-i),s<0&&(r=r+s,s=-s),typeof a=="number"?l=o=h=d=a:a instanceof Array?a.length===1?l=o=h=d=a[0]:a.length===2?(l=h=a[0],o=d=a[1]):a.length===3?(l=a[0],o=d=a[1],h=a[2]):(l=a[0],o=a[1],h=a[2],d=a[3]):l=o=h=d=0;var m;l+o>i&&(m=l+o,l*=i/m,o*=i/m),h+d>i&&(m=h+d,h*=i/m,d*=i/m),o+h>s&&(m=o+h,o*=s/m,h*=s/m),l+d>s&&(m=l+d,l*=s/m,d*=s/m),n.moveTo(t+l,r),n.lineTo(t+i-o,r),o!==0&&n.arc(t+i-o,r+o,o,-Math.PI/2,0),n.lineTo(t+i,r+s-h),h!==0&&n.arc(t+i-h,r+s-h,h,0,Math.PI/2),n.lineTo(t+d,r+s),d!==0&&n.arc(t+d,r+s-d,d,Math.PI/2,Math.PI),n.lineTo(t,r+l),l!==0&&n.arc(t+l,r+l,l,Math.PI,Math.PI*1.5)}var wb=Math.round;function Tie(n,e,t){if(e){var r=e.x1,i=e.x2,s=e.y1,a=e.y2;n.x1=r,n.x2=i,n.y1=s,n.y2=a;var l=t&&t.lineWidth;return l&&(wb(r*2)===wb(i*2)&&(n.x1=n.x2=Ty(r,l,!0)),wb(s*2)===wb(a*2)&&(n.y1=n.y2=Ty(s,l,!0))),n}}function Mie(n,e,t){if(e){var r=e.x,i=e.y,s=e.width,a=e.height;n.x=r,n.y=i,n.width=s,n.height=a;var l=t&&t.lineWidth;return l&&(n.x=Ty(r,l,!0),n.y=Ty(i,l,!0),n.width=Math.max(Ty(r+s,l,!1)-n.x,s===0?0:1),n.height=Math.max(Ty(i+a,l,!1)-n.y,a===0?0:1)),n}}function Ty(n,e,t){if(!e)return n;var r=wb(n*2);return(r+wb(e))%2===0?r/2:(r+(t?1:-1))/2}var DCe=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),BCe={},Ho=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new DCe},e.prototype.buildPath=function(t,r){var i,s,a,l;if(this.subPixelOptimize){var o=Mie(BCe,r,this.style);i=o.x,s=o.y,a=o.width,l=o.height,o.r=r.r,r=o}else i=r.x,s=r.y,a=r.width,l=r.height;r.r?LCe(t,r):t.rect(i,s,a,l)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}($i);Ho.prototype.type="rect";var b$={fill:"#000"},w$=2,kCe={style:ti({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},BD.style)},Ea=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r.type="text",r._children=[],r._defaultStyle=b$,r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var r=this._children[t];r.zlevel=this.zlevel,r.z=this.z,r.z2=this.z2,r.culling=this.culling,r.cursor=this.cursor,r.invisible=this.invisible}},e.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):n.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(t){var r=this.innerTransformable;return r?r.getLocalTransform(t):n.prototype.getLocalTransform.call(this,t)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){this._childCursor=0,UCe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=t},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new cs(0,0,0,0),r=this._children,i=[],s=null,a=0;a<r.length;a++){var l=r[a],o=l.getBoundingRect(),h=l.getLocalTransform(i);h?(t.copy(o),t.applyTransform(h),s=s||t.clone(),s.union(t)):(s=s||o.clone(),s.union(o))}this._rect=s||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||b$},e.prototype.setTextContent=function(t){},e.prototype._mergeStyle=function(t,r){if(!r)return t;var i=r.rich,s=t.rich||i&&{};return Jn(t,r),i&&s?(this._mergeRich(s,i),t.rich=s):s&&(t.rich=s),t},e.prototype._mergeRich=function(t,r){for(var i=so(r),s=0;s<i.length;s++){var a=i[s];t[a]=t[a]||{},Jn(t[a],r[a])}},e.prototype.getAnimationStyleProps=function(){return kCe},e.prototype._getOrCreateChild=function(t){var r=this._children[this._childCursor];return(!r||!(r instanceof t))&&(r=new t),this._children[this._childCursor++]=r,r.__zr=this.__zr,r.parent=this,r},e.prototype._updatePlainTexts=function(){var t=this.style,r=t.font||r1,i=t.padding,s=I$(t),a=rCe(s,t),l=WB(t),o=!!t.backgroundColor,h=a.outerHeight,d=a.outerWidth,m=a.contentWidth,v=a.lines,y=a.lineHeight,S=this._defaultStyle,E=t.x||0,M=t.y||0,C=t.align||S.align||"left",L=t.verticalAlign||S.verticalAlign||"top",k=E,H=Jx(M,a.contentHeight,L);if(l||i){var q=MS(E,d,C),Z=Jx(M,h,L);l&&this._renderBackground(t,t,q,Z,d,h)}H+=y/2,i&&(k=E$(E,C,i),L==="top"?H+=i[0]:L==="bottom"&&(H-=i[2]));for(var ee=0,re=!1,se=C$("fill"in t?t.fill:(re=!0,S.fill)),ae=M$("stroke"in t?t.stroke:!o&&(!S.autoStroke||re)?(ee=w$,S.stroke):null),fe=t.textShadowBlur>0,Se=t.width!=null&&(t.overflow==="truncate"||t.overflow==="break"||t.overflow==="breakAll"),Ce=a.calculatedLineHeight,Ie=0;Ie<v.length;Ie++){var je=this._getOrCreateChild(DP),Le=je.createStyle();je.useStyle(Le),Le.text=v[Ie],Le.x=k,Le.y=H,C&&(Le.textAlign=C),Le.textBaseline="middle",Le.opacity=t.opacity,Le.strokeFirst=!0,fe&&(Le.shadowBlur=t.textShadowBlur||0,Le.shadowColor=t.textShadowColor||"transparent",Le.shadowOffsetX=t.textShadowOffsetX||0,Le.shadowOffsetY=t.textShadowOffsetY||0),Le.stroke=ae,Le.fill=se,ae&&(Le.lineWidth=t.lineWidth||ee,Le.lineDash=t.lineDash,Le.lineDashOffset=t.lineDashOffset||0),Le.font=r,A$(Le,t),H+=y,Se&&je.setBoundingRect(new cs(MS(Le.x,t.width,Le.textAlign),Jx(Le.y,Ce,Le.textBaseline),m,Ce))}},e.prototype._updateRichTexts=function(){var t=this.style,r=I$(t),i=oCe(r,t),s=i.width,a=i.outerWidth,l=i.outerHeight,o=t.padding,h=t.x||0,d=t.y||0,m=this._defaultStyle,v=t.align||m.align,y=t.verticalAlign||m.verticalAlign,S=MS(h,a,v),E=Jx(d,l,y),M=S,C=E;o&&(M+=o[3],C+=o[0]);var L=M+s;WB(t)&&this._renderBackground(t,t,S,E,a,l);for(var k=!!t.backgroundColor,H=0;H<i.lines.length;H++){for(var q=i.lines[H],Z=q.tokens,ee=Z.length,re=q.lineHeight,se=q.width,ae=0,fe=M,Se=L,Ce=ee-1,Ie=void 0;ae<ee&&(Ie=Z[ae],!Ie.align||Ie.align==="left");)this._placeToken(Ie,t,re,C,fe,"left",k),se-=Ie.width,fe+=Ie.width,ae++;for(;Ce>=0&&(Ie=Z[Ce],Ie.align==="right");)this._placeToken(Ie,t,re,C,Se,"right",k),se-=Ie.width,Se-=Ie.width,Ce--;for(fe+=(s-(fe-M)-(L-Se)-se)/2;ae<=Ce;)Ie=Z[ae],this._placeToken(Ie,t,re,C,fe+Ie.width/2,"center",k),fe+=Ie.width,ae++;C+=re}},e.prototype._placeToken=function(t,r,i,s,a,l,o){var h=r.rich[t.styleName]||{};h.text=t.text;var d=t.verticalAlign,m=s+i/2;d==="top"?m=s+t.height/2:d==="bottom"&&(m=s+i-t.height/2);var v=!t.isLineHolder&&WB(h);v&&this._renderBackground(h,r,l==="right"?a-t.width:l==="center"?a-t.width/2:a,m-t.height/2,t.width,t.height);var y=!!h.backgroundColor,S=t.textPadding;S&&(a=E$(a,l,S),m-=t.height/2-S[0]-t.innerHeight/2);var E=this._getOrCreateChild(DP),M=E.createStyle();E.useStyle(M);var C=this._defaultStyle,L=!1,k=0,H=C$("fill"in h?h.fill:"fill"in r?r.fill:(L=!0,C.fill)),q=M$("stroke"in h?h.stroke:"stroke"in r?r.stroke:!y&&!o&&(!C.autoStroke||L)?(k=w$,C.stroke):null),Z=h.textShadowBlur>0||r.textShadowBlur>0;M.text=t.text,M.x=a,M.y=m,Z&&(M.shadowBlur=h.textShadowBlur||r.textShadowBlur||0,M.shadowColor=h.textShadowColor||r.textShadowColor||"transparent",M.shadowOffsetX=h.textShadowOffsetX||r.textShadowOffsetX||0,M.shadowOffsetY=h.textShadowOffsetY||r.textShadowOffsetY||0),M.textAlign=l,M.textBaseline="middle",M.font=t.font||r1,M.opacity=nA(h.opacity,r.opacity,1),A$(M,h),q&&(M.lineWidth=nA(h.lineWidth,r.lineWidth,k),M.lineDash=Ei(h.lineDash,r.lineDash),M.lineDashOffset=r.lineDashOffset||0,M.stroke=q),H&&(M.fill=H);var ee=t.contentWidth,re=t.contentHeight;E.setBoundingRect(new cs(MS(M.x,ee,M.textAlign),Jx(M.y,re,M.textBaseline),ee,re))},e.prototype._renderBackground=function(t,r,i,s,a,l){var o=t.backgroundColor,h=t.borderWidth,d=t.borderColor,m=o&&o.image,v=o&&!m,y=t.borderRadius,S=this,E,M;if(v||t.lineHeight||h&&d){E=this._getOrCreateChild(Ho),E.useStyle(E.createStyle()),E.style.fill=null;var C=E.shape;C.x=i,C.y=s,C.width=a,C.height=l,C.r=y,E.dirtyShape()}if(v){var L=E.style;L.fill=o||null,L.fillOpacity=Ei(t.fillOpacity,1)}else if(m){M=this._getOrCreateChild(Ov),M.onload=function(){S.dirtyStyle()};var k=M.style;k.image=o.image,k.x=i,k.y=s,k.width=a,k.height=l}if(h&&d){var L=E.style;L.lineWidth=h,L.stroke=d,L.strokeOpacity=Ei(t.strokeOpacity,1),L.lineDash=t.borderDash,L.lineDashOffset=t.borderDashOffset||0,E.strokeContainThreshold=0,E.hasFill()&&E.hasStroke()&&(L.strokeFirst=!0,L.lineWidth*=2)}var H=(E||M).style;H.shadowBlur=t.shadowBlur||0,H.shadowColor=t.shadowColor||"transparent",H.shadowOffsetX=t.shadowOffsetX||0,H.shadowOffsetY=t.shadowOffsetY||0,H.opacity=nA(t.opacity,r.opacity,1)},e.makeFont=function(t){var r="";return zCe(t)&&(r=[t.fontStyle,t.fontWeight,NCe(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),r&&tp(r)||t.textFont||t.font},e}(Mw),OCe={left:!0,right:1,center:1},FCe={top:1,bottom:1,middle:1},S$=["fontStyle","fontWeight","fontSize","fontFamily"];function NCe(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?wU+"px":n+"px"}function A$(n,e){for(var t=0;t<S$.length;t++){var r=S$[t],i=e[r];i!=null&&(n[r]=i)}}function zCe(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function UCe(n){return T$(n),it(n.rich,T$),n}function T$(n){if(n){n.font=Ea.makeFont(n);var e=n.align;e==="middle"&&(e="center"),n.align=e==null||OCe[e]?e:"left";var t=n.verticalAlign;t==="center"&&(t="middle"),n.verticalAlign=t==null||FCe[t]?t:"top";var r=n.padding;r&&(n.padding=Bre(n.padding))}}function M$(n,e){return n==null||e<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function C$(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function E$(n,e,t){return e==="right"?n-t[1]:e==="center"?n+t[3]/2-t[1]/2:n+t[3]}function I$(n){var e=n.text;return e!=null&&(e+=""),e}function WB(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}var Wi=$s(),GCe=function(n,e,t,r){if(r){var i=Wi(r);i.dataIndex=t,i.dataType=e,i.seriesIndex=n,i.ssrType="chart",r.type==="group"&&r.traverse(function(s){var a=Wi(s);a.seriesIndex=n,a.dataIndex=t,a.dataType=e,a.ssrType="chart"})}},R$=1,P$={},Cie=$s(),kU=$s(),OU=0,kD=1,OD=2,kh=["emphasis","blur","select"],BP=["normal","emphasis","blur","select"],VCe=10,HCe=9,Uy="highlight",eR="downplay",lA="select",tR="unselect",cA="toggleSelect";function Px(n){return n!=null&&n!=="none"}function FD(n,e,t){n.onHoverStateChange&&(n.hoverState||0)!==t&&n.onHoverStateChange(e),n.hoverState=t}function Eie(n){FD(n,"emphasis",OD)}function Iie(n){n.hoverState===OD&&FD(n,"normal",OU)}function FU(n){FD(n,"blur",kD)}function Rie(n){n.hoverState===kD&&FD(n,"normal",OU)}function jCe(n){n.selected=!0}function WCe(n){n.selected=!1}function L$(n,e,t){e(n,t)}function ig(n,e,t){L$(n,e,t),n.isGroup&&n.traverse(function(r){L$(r,e,t)})}function D$(n,e){switch(e){case"emphasis":n.hoverState=OD;break;case"normal":n.hoverState=OU;break;case"blur":n.hoverState=kD;break;case"select":n.selected=!0}}function XCe(n,e,t,r){for(var i=n.style,s={},a=0;a<e.length;a++){var l=e[a],o=i[l];s[l]=o??(r&&r[l])}for(var a=0;a<n.animators.length;a++){var h=n.animators[a];h.__fromStateTransition&&h.__fromStateTransition.indexOf(t)<0&&h.targetName==="style"&&h.saveTo(s,e)}return s}function $Ce(n,e,t,r){var i=t&&Xi(t,"select")>=0,s=!1;if(n instanceof $i){var a=Cie(n),l=i&&a.selectFill||a.normalFill,o=i&&a.selectStroke||a.normalStroke;if(Px(l)||Px(o)){r=r||{};var h=r.style||{};h.fill==="inherit"?(s=!0,r=Jn({},r),h=Jn({},h),h.fill=l):!Px(h.fill)&&Px(l)?(s=!0,r=Jn({},r),h=Jn({},h),h.fill=JX(l)):!Px(h.stroke)&&Px(o)&&(s||(r=Jn({},r),h=Jn({},h)),h.stroke=JX(o)),r.style=h}}if(r&&r.z2==null){s||(r=Jn({},r));var d=n.z2EmphasisLift;r.z2=n.z2+(d??VCe)}return r}function qCe(n,e,t){if(t&&t.z2==null){t=Jn({},t);var r=n.z2SelectLift;t.z2=n.z2+(r??HCe)}return t}function ZCe(n,e,t){var r=Xi(n.currentStates,e)>=0,i=n.style.opacity,s=r?null:XCe(n,["opacity"],e,{opacity:1});t=t||{};var a=t.style||{};return a.opacity==null&&(t=Jn({},t),a=Jn({opacity:r?i:s.opacity*.1},a),t.style=a),t}function XB(n,e){var t=this.states[n];if(this.style){if(n==="emphasis")return $Ce(this,n,e,t);if(n==="blur")return ZCe(this,n,t);if(n==="select")return qCe(this,n,t)}return t}function YCe(n){n.stateProxy=XB;var e=n.getTextContent(),t=n.getTextGuideLine();e&&(e.stateProxy=XB),t&&(t.stateProxy=XB)}function B$(n,e){!Bie(n,e)&&!n.__highByOuter&&ig(n,Eie)}function k$(n,e){!Bie(n,e)&&!n.__highByOuter&&ig(n,Iie)}function rw(n,e){n.__highByOuter|=1<<(e||0),ig(n,Eie)}function iw(n,e){!(n.__highByOuter&=~(1<<(e||0)))&&ig(n,Iie)}function KCe(n){ig(n,FU)}function Pie(n){ig(n,Rie)}function Lie(n){ig(n,jCe)}function Die(n){ig(n,WCe)}function Bie(n,e){return n.__highDownSilentOnTouch&&e.zrByTouch}function kie(n){var e=n.getModel(),t=[],r=[];e.eachComponent(function(i,s){var a=kU(s),l=i==="series",o=l?n.getViewOfSeriesModel(s):n.getViewOfComponentModel(s);!l&&r.push(o),a.isBlured&&(o.group.traverse(function(h){Rie(h)}),l&&t.push(s)),a.isBlured=!1}),it(r,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(t,!1,e)})}function uN(n,e,t,r){var i=r.getModel();t=t||"coordinateSystem";function s(h,d){for(var m=0;m<d.length;m++){var v=h.getItemGraphicEl(d[m]);v&&Pie(v)}}if(n!=null&&!(!e||e==="none")){var a=i.getSeriesByIndex(n),l=a.coordinateSystem;l&&l.master&&(l=l.master);var o=[];i.eachSeries(function(h){var d=a===h,m=h.coordinateSystem;m&&m.master&&(m=m.master);var v=m&&l?m===l:d;if(!(t==="series"&&!d||t==="coordinateSystem"&&!v||e==="series"&&d)){var y=r.getViewOfSeriesModel(h);if(y.group.traverse(function(M){M.__highByOuter&&d&&e==="self"||FU(M)}),Ic(e))s(h.getData(),e);else if(Xr(e))for(var S=so(e),E=0;E<S.length;E++)s(h.getData(S[E]),e[S[E]]);o.push(h),kU(h).isBlured=!0}}),i.eachComponent(function(h,d){if(h!=="series"){var m=r.getViewOfComponentModel(d);m&&m.toggleBlurSeries&&m.toggleBlurSeries(o,!0,i)}})}}function hN(n,e,t){if(!(n==null||e==null)){var r=t.getModel().getComponent(n,e);if(r){kU(r).isBlured=!0;var i=t.getViewOfComponentModel(r);!i||!i.focusBlurEnabled||i.group.traverse(function(s){FU(s)})}}}function JCe(n,e,t){var r=n.seriesIndex,i=n.getData(e.dataType);if(i){var s=i1(i,e);s=(fr(s)?s[0]:s)||0;var a=i.getItemGraphicEl(s);if(!a)for(var l=i.count(),o=0;!a&&o<l;)a=i.getItemGraphicEl(o++);if(a){var h=Wi(a);uN(r,h.focus,h.blurScope,t)}else{var d=n.get(["emphasis","focus"]),m=n.get(["emphasis","blurScope"]);d!=null&&uN(r,d,m,t)}}}function NU(n,e,t,r){var i={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||e==null||t==null)return i;var s=r.getModel().getComponent(n,e);if(!s)return i;var a=r.getViewOfComponentModel(s);if(!a||!a.findHighDownDispatchers)return i;for(var l=a.findHighDownDispatchers(t),o,h=0;h<l.length;h++)if(Wi(l[h]).focus==="self"){o=!0;break}return{focusSelf:o,dispatchers:l}}function QCe(n,e,t){var r=Wi(n),i=NU(r.componentMainType,r.componentIndex,r.componentHighDownName,t),s=i.dispatchers,a=i.focusSelf;s?(a&&hN(r.componentMainType,r.componentIndex,t),it(s,function(l){return B$(l,e)})):(uN(r.seriesIndex,r.focus,r.blurScope,t),r.focus==="self"&&hN(r.componentMainType,r.componentIndex,t),B$(n,e))}function eEe(n,e,t){kie(t);var r=Wi(n),i=NU(r.componentMainType,r.componentIndex,r.componentHighDownName,t).dispatchers;i?it(i,function(s){return k$(s,e)}):k$(n,e)}function tEe(n,e,t){if(pN(e)){var r=e.dataType,i=n.getData(r),s=i1(i,e);fr(s)||(s=[s]),n[e.type===cA?"toggleSelect":e.type===lA?"select":"unselect"](s,r)}}function O$(n){var e=n.getAllData();it(e,function(t){var r=t.data,i=t.type;r.eachItemGraphicEl(function(s,a){n.isSelected(a,i)?Lie(s):Die(s)})})}function nEe(n){var e=[];return n.eachSeries(function(t){var r=t.getAllData();it(r,function(i){i.data;var s=i.type,a=t.getSelectedDataIndices();if(a.length>0){var l={dataIndex:a,seriesIndex:t.seriesIndex};s!=null&&(l.dataType=s),e.push(l)}})}),e}function fN(n,e,t){Oie(n,!0),ig(n,YCe),iEe(n,e,t)}function rEe(n){Oie(n,!1)}function lT(n,e,t,r){r?rEe(n):fN(n,e,t)}function iEe(n,e,t){var r=Wi(n);e!=null?(r.focus=e,r.blurScope=t):r.focus&&(r.focus=null)}var F$=["emphasis","blur","select"],sEe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function kP(n,e,t,r){t=t||"itemStyle";for(var i=0;i<F$.length;i++){var s=F$[i],a=e.getModel([s,t]),l=n.ensureState(s);l.style=a[sEe[t]]()}}function Oie(n,e){var t=e===!1,r=n;n.highDownSilentOnTouch&&(r.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!t||r.__highDownDispatcher)&&(r.__highByOuter=r.__highByOuter||0,r.__highDownDispatcher=!t)}function dN(n){return!!(n&&n.__highDownDispatcher)}function oEe(n){var e=P$[n];return e==null&&R$<=32&&(e=P$[n]=R$++),e}function pN(n){var e=n.type;return e===lA||e===tR||e===cA}function N$(n){var e=n.type;return e===Uy||e===eR}function aEe(n){var e=Cie(n);e.normalFill=n.style.fill,e.normalStroke=n.style.stroke;var t=n.states.select||{};e.selectFill=t.style&&t.style.fill||null,e.selectStroke=t.style&&t.style.stroke||null}var Lx=Jm.CMD,lEe=[[],[],[]],z$=Math.sqrt,cEe=Math.atan2;function Fie(n,e){if(e){var t=n.data,r=n.len(),i,s,a,l,o,h,d=Lx.M,m=Lx.C,v=Lx.L,y=Lx.R,S=Lx.A,E=Lx.Q;for(a=0,l=0;a<r;){switch(i=t[a++],l=a,s=0,i){case d:s=1;break;case v:s=1;break;case m:s=3;break;case E:s=2;break;case S:var M=e[4],C=e[5],L=z$(e[0]*e[0]+e[1]*e[1]),k=z$(e[2]*e[2]+e[3]*e[3]),H=cEe(-e[1]/k,e[0]/L);t[a]*=L,t[a++]+=M,t[a]*=k,t[a++]+=C,t[a++]*=L,t[a++]*=k,t[a++]+=H,t[a++]+=H,a+=2,l=a;break;case y:h[0]=t[a++],h[1]=t[a++],Eh(h,h,e),t[l++]=h[0],t[l++]=h[1],h[0]+=t[a++],h[1]+=t[a++],Eh(h,h,e),t[l++]=h[0],t[l++]=h[1]}for(o=0;o<s;o++){var q=lEe[o];q[0]=t[a++],q[1]=t[a++],Eh(q,q,e),t[l++]=q[0],t[l++]=q[1]}}n.increaseVersion()}}var $B=Math.sqrt,zE=Math.sin,UE=Math.cos,q2=Math.PI;function U$(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function mN(n,e){return(n[0]*e[0]+n[1]*e[1])/(U$(n)*U$(e))}function G$(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(mN(n,e))}function V$(n,e,t,r,i,s,a,l,o,h,d){var m=o*(q2/180),v=UE(m)*(n-t)/2+zE(m)*(e-r)/2,y=-1*zE(m)*(n-t)/2+UE(m)*(e-r)/2,S=v*v/(a*a)+y*y/(l*l);S>1&&(a*=$B(S),l*=$B(S));var E=(i===s?-1:1)*$B((a*a*(l*l)-a*a*(y*y)-l*l*(v*v))/(a*a*(y*y)+l*l*(v*v)))||0,M=E*a*y/l,C=E*-l*v/a,L=(n+t)/2+UE(m)*M-zE(m)*C,k=(e+r)/2+zE(m)*M+UE(m)*C,H=G$([1,0],[(v-M)/a,(y-C)/l]),q=[(v-M)/a,(y-C)/l],Z=[(-1*v-M)/a,(-1*y-C)/l],ee=G$(q,Z);if(mN(q,Z)<=-1&&(ee=q2),mN(q,Z)>=1&&(ee=0),ee<0){var re=Math.round(ee/q2*1e6)/1e6;ee=q2*2+re%2*q2}d.addData(h,L,k,a,l,H,ee,m,s)}var uEe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,hEe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function fEe(n){var e=new Jm;if(!n)return e;var t=0,r=0,i=t,s=r,a,l=Jm.CMD,o=n.match(uEe);if(!o)return e;for(var h=0;h<o.length;h++){for(var d=o[h],m=d.charAt(0),v=void 0,y=d.match(hEe)||[],S=y.length,E=0;E<S;E++)y[E]=parseFloat(y[E]);for(var M=0;M<S;){var C=void 0,L=void 0,k=void 0,H=void 0,q=void 0,Z=void 0,ee=void 0,re=t,se=r,ae=void 0,fe=void 0;switch(m){case"l":t+=y[M++],r+=y[M++],v=l.L,e.addData(v,t,r);break;case"L":t=y[M++],r=y[M++],v=l.L,e.addData(v,t,r);break;case"m":t+=y[M++],r+=y[M++],v=l.M,e.addData(v,t,r),i=t,s=r,m="l";break;case"M":t=y[M++],r=y[M++],v=l.M,e.addData(v,t,r),i=t,s=r,m="L";break;case"h":t+=y[M++],v=l.L,e.addData(v,t,r);break;case"H":t=y[M++],v=l.L,e.addData(v,t,r);break;case"v":r+=y[M++],v=l.L,e.addData(v,t,r);break;case"V":r=y[M++],v=l.L,e.addData(v,t,r);break;case"C":v=l.C,e.addData(v,y[M++],y[M++],y[M++],y[M++],y[M++],y[M++]),t=y[M-2],r=y[M-1];break;case"c":v=l.C,e.addData(v,y[M++]+t,y[M++]+r,y[M++]+t,y[M++]+r,y[M++]+t,y[M++]+r),t+=y[M-2],r+=y[M-1];break;case"S":C=t,L=r,ae=e.len(),fe=e.data,a===l.C&&(C+=t-fe[ae-4],L+=r-fe[ae-3]),v=l.C,re=y[M++],se=y[M++],t=y[M++],r=y[M++],e.addData(v,C,L,re,se,t,r);break;case"s":C=t,L=r,ae=e.len(),fe=e.data,a===l.C&&(C+=t-fe[ae-4],L+=r-fe[ae-3]),v=l.C,re=t+y[M++],se=r+y[M++],t+=y[M++],r+=y[M++],e.addData(v,C,L,re,se,t,r);break;case"Q":re=y[M++],se=y[M++],t=y[M++],r=y[M++],v=l.Q,e.addData(v,re,se,t,r);break;case"q":re=y[M++]+t,se=y[M++]+r,t+=y[M++],r+=y[M++],v=l.Q,e.addData(v,re,se,t,r);break;case"T":C=t,L=r,ae=e.len(),fe=e.data,a===l.Q&&(C+=t-fe[ae-4],L+=r-fe[ae-3]),t=y[M++],r=y[M++],v=l.Q,e.addData(v,C,L,t,r);break;case"t":C=t,L=r,ae=e.len(),fe=e.data,a===l.Q&&(C+=t-fe[ae-4],L+=r-fe[ae-3]),t+=y[M++],r+=y[M++],v=l.Q,e.addData(v,C,L,t,r);break;case"A":k=y[M++],H=y[M++],q=y[M++],Z=y[M++],ee=y[M++],re=t,se=r,t=y[M++],r=y[M++],v=l.A,V$(re,se,t,r,Z,ee,k,H,q,v,e);break;case"a":k=y[M++],H=y[M++],q=y[M++],Z=y[M++],ee=y[M++],re=t,se=r,t+=y[M++],r+=y[M++],v=l.A,V$(re,se,t,r,Z,ee,k,H,q,v,e);break}}(m==="z"||m==="Z")&&(v=l.Z,e.addData(v),t=i,r=s),a=v}return e.toStatic(),e}var Nie=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.applyTransform=function(t){},e}($i);function zie(n){return n.setData!=null}function Uie(n,e){var t=fEe(n),r=Jn({},e);return r.buildPath=function(i){if(zie(i)){i.setData(t.data);var s=i.getContext();s&&i.rebuildPath(s,1)}else{var s=i;t.rebuildPath(s,1)}},r.applyTransform=function(i){Fie(t,i),this.dirtyShape()},r}function dEe(n,e){return new Nie(Uie(n,e))}function pEe(n,e){var t=Uie(n,e),r=function(i){Hn(s,i);function s(a){var l=i.call(this,a)||this;return l.applyTransform=t.applyTransform,l.buildPath=t.buildPath,l}return s}(Nie);return r}function mEe(n,e){for(var t=[],r=n.length,i=0;i<r;i++){var s=n[i];t.push(s.getUpdatedPathProxy(!0))}var a=new $i(e);return a.createPathProxy(),a.buildPath=function(l){if(zie(l)){l.appendPath(t);var o=l.getContext();o&&l.rebuildPath(o,1)}},a}function zU(n,e){e=e||{};var t=new $i;return n.shape&&t.setShape(n.shape),t.setStyle(n.style),e.bakeTransform?Fie(t.path,n.getComputedTransform()):e.toLocal?t.setLocalTransform(n.getComputedTransform()):t.copyTransform(n),t.buildPath=n.buildPath,t.applyTransform=t.applyTransform,t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel,t}var gEe=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),Gie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new gEe},e.prototype.buildPath=function(t,r){t.moveTo(r.cx+r.r,r.cy),t.arc(r.cx,r.cy,r.r,0,Math.PI*2)},e}($i);Gie.prototype.type="circle";const ND=Gie;var vEe=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),Vie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new vEe},e.prototype.buildPath=function(t,r){var i=.5522848,s=r.cx,a=r.cy,l=r.rx,o=r.ry,h=l*i,d=o*i;t.moveTo(s-l,a),t.bezierCurveTo(s-l,a-d,s-h,a-o,s,a-o),t.bezierCurveTo(s+h,a-o,s+l,a-d,s+l,a),t.bezierCurveTo(s+l,a+d,s+h,a+o,s,a+o),t.bezierCurveTo(s-h,a+o,s-l,a+d,s-l,a),t.closePath()},e}($i);Vie.prototype.type="ellipse";const Hie=Vie;var jie=Math.PI,qB=jie*2,X_=Math.sin,Dx=Math.cos,_Ee=Math.acos,Fl=Math.atan2,H$=Math.abs,uA=Math.sqrt,CS=Math.max,Xd=Math.min,Rf=1e-4;function yEe(n,e,t,r,i,s,a,l){var o=t-n,h=r-e,d=a-i,m=l-s,v=m*o-d*h;if(!(v*v<Rf))return v=(d*(e-s)-m*(n-i))/v,[n+v*o,e+v*h]}function GE(n,e,t,r,i,s,a){var l=n-t,o=e-r,h=(a?s:-s)/uA(l*l+o*o),d=h*o,m=-h*l,v=n+d,y=e+m,S=t+d,E=r+m,M=(v+S)/2,C=(y+E)/2,L=S-v,k=E-y,H=L*L+k*k,q=i-s,Z=v*E-S*y,ee=(k<0?-1:1)*uA(CS(0,q*q*H-Z*Z)),re=(Z*k-L*ee)/H,se=(-Z*L-k*ee)/H,ae=(Z*k+L*ee)/H,fe=(-Z*L+k*ee)/H,Se=re-M,Ce=se-C,Ie=ae-M,je=fe-C;return Se*Se+Ce*Ce>Ie*Ie+je*je&&(re=ae,se=fe),{cx:re,cy:se,x0:-d,y0:-m,x1:re*(i/q-1),y1:se*(i/q-1)}}function xEe(n){var e;if(fr(n)){var t=n.length;if(!t)return n;t===1?e=[n[0],n[0],0,0]:t===2?e=[n[0],n[0],n[1],n[1]]:t===3?e=n.concat(n[2]):e=n}else e=[n,n,n,n];return e}function bEe(n,e){var t,r=CS(e.r,0),i=CS(e.r0||0,0),s=r>0,a=i>0;if(!(!s&&!a)){if(s||(r=i,i=0),i>r){var l=r;r=i,i=l}var o=e.startAngle,h=e.endAngle;if(!(isNaN(o)||isNaN(h))){var d=e.cx,m=e.cy,v=!!e.clockwise,y=H$(h-o),S=y>qB&&y%qB;if(S>Rf&&(y=S),!(r>Rf))n.moveTo(d,m);else if(y>qB-Rf)n.moveTo(d+r*Dx(o),m+r*X_(o)),n.arc(d,m,r,o,h,!v),i>Rf&&(n.moveTo(d+i*Dx(h),m+i*X_(h)),n.arc(d,m,i,h,o,v));else{var E=void 0,M=void 0,C=void 0,L=void 0,k=void 0,H=void 0,q=void 0,Z=void 0,ee=void 0,re=void 0,se=void 0,ae=void 0,fe=void 0,Se=void 0,Ce=void 0,Ie=void 0,je=r*Dx(o),Le=r*X_(o),ot=i*Dx(h),ye=i*X_(h),$e=y>Rf;if($e){var Ve=e.cornerRadius;Ve&&(t=xEe(Ve),E=t[0],M=t[1],C=t[2],L=t[3]);var _t=H$(r-i)/2;if(k=Xd(_t,C),H=Xd(_t,L),q=Xd(_t,E),Z=Xd(_t,M),se=ee=CS(k,H),ae=re=CS(q,Z),(ee>Rf||re>Rf)&&(fe=r*Dx(h),Se=r*X_(h),Ce=i*Dx(o),Ie=i*X_(o),y<jie)){var wt=yEe(je,Le,Ce,Ie,fe,Se,ot,ye);if(wt){var Vt=je-wt[0],lt=Le-wt[1],Ht=fe-wt[0],Qt=Se-wt[1],rn=1/X_(_Ee((Vt*Ht+lt*Qt)/(uA(Vt*Vt+lt*lt)*uA(Ht*Ht+Qt*Qt)))/2),jn=uA(wt[0]*wt[0]+wt[1]*wt[1]);se=Xd(ee,(r-jn)/(rn+1)),ae=Xd(re,(i-jn)/(rn-1))}}}if(!$e)n.moveTo(d+je,m+Le);else if(se>Rf){var Bn=Xd(C,se),Tn=Xd(L,se),Pe=GE(Ce,Ie,je,Le,r,Bn,v),qe=GE(fe,Se,ot,ye,r,Tn,v);n.moveTo(d+Pe.cx+Pe.x0,m+Pe.cy+Pe.y0),se<ee&&Bn===Tn?n.arc(d+Pe.cx,m+Pe.cy,se,Fl(Pe.y0,Pe.x0),Fl(qe.y0,qe.x0),!v):(Bn>0&&n.arc(d+Pe.cx,m+Pe.cy,Bn,Fl(Pe.y0,Pe.x0),Fl(Pe.y1,Pe.x1),!v),n.arc(d,m,r,Fl(Pe.cy+Pe.y1,Pe.cx+Pe.x1),Fl(qe.cy+qe.y1,qe.cx+qe.x1),!v),Tn>0&&n.arc(d+qe.cx,m+qe.cy,Tn,Fl(qe.y1,qe.x1),Fl(qe.y0,qe.x0),!v))}else n.moveTo(d+je,m+Le),n.arc(d,m,r,o,h,!v);if(!(i>Rf)||!$e)n.lineTo(d+ot,m+ye);else if(ae>Rf){var Bn=Xd(E,ae),Tn=Xd(M,ae),Pe=GE(ot,ye,fe,Se,i,-Tn,v),qe=GE(je,Le,Ce,Ie,i,-Bn,v);n.lineTo(d+Pe.cx+Pe.x0,m+Pe.cy+Pe.y0),ae<re&&Bn===Tn?n.arc(d+Pe.cx,m+Pe.cy,ae,Fl(Pe.y0,Pe.x0),Fl(qe.y0,qe.x0),!v):(Tn>0&&n.arc(d+Pe.cx,m+Pe.cy,Tn,Fl(Pe.y0,Pe.x0),Fl(Pe.y1,Pe.x1),!v),n.arc(d,m,i,Fl(Pe.cy+Pe.y1,Pe.cx+Pe.x1),Fl(qe.cy+qe.y1,qe.cx+qe.x1),v),Bn>0&&n.arc(d+qe.cx,m+qe.cy,Bn,Fl(qe.y1,qe.x1),Fl(qe.y0,qe.x0),!v))}else n.lineTo(d+ot,m+ye),n.arc(d,m,i,h,o,v)}n.closePath()}}}var wEe=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),Oh=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new wEe},e.prototype.buildPath=function(t,r){bEe(t,r)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}($i);Oh.prototype.type="sector";var SEe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),Wie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new SEe},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,a=Math.PI*2;t.moveTo(i+r.r,s),t.arc(i,s,r.r,0,a,!1),t.moveTo(i+r.r0,s),t.arc(i,s,r.r0,0,a,!0)},e}($i);Wie.prototype.type="ring";const UU=Wie;function AEe(n,e,t,r){var i=[],s=[],a=[],l=[],o,h,d,m;if(r){d=[1/0,1/0],m=[-1/0,-1/0];for(var v=0,y=n.length;v<y;v++)yb(d,d,n[v]),xb(m,m,n[v]);yb(d,d,r[0]),xb(m,m,r[1])}for(var v=0,y=n.length;v<y;v++){var S=n[v];if(t)o=n[v?v-1:y-1],h=n[(v+1)%y];else if(v===0||v===y-1){i.push(cTe(n[v]));continue}else o=n[v-1],h=n[v+1];uTe(s,h,o),dB(s,s,e);var E=jF(S,o),M=jF(S,h),C=E+M;C!==0&&(E/=C,M/=C),dB(a,s,-E),dB(l,s,M);var L=kX([],S,a),k=kX([],S,l);r&&(xb(L,L,d),yb(L,L,m),xb(k,k,d),yb(k,k,m)),i.push(L),i.push(k)}return t&&i.push(i.shift()),i}function Xie(n,e,t){var r=e.smooth,i=e.points;if(i&&i.length>=2){if(r){var s=AEe(i,r,t,e.smoothConstraint);n.moveTo(i[0][0],i[0][1]);for(var a=i.length,l=0;l<(t?a:a-1);l++){var o=s[l*2],h=s[l*2+1],d=i[(l+1)%a];n.bezierCurveTo(o[0],o[1],h[0],h[1],d[0],d[1])}}else{n.moveTo(i[0][0],i[0][1]);for(var l=1,m=i.length;l<m;l++)n.lineTo(i[l][0],i[l][1])}t&&n.closePath()}}var TEe=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),$ie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new TEe},e.prototype.buildPath=function(t,r){Xie(t,r,!0)},e}($i);$ie.prototype.type="polygon";const zD=$ie;var MEe=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),Cw=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new MEe},e.prototype.buildPath=function(t,r){Xie(t,r,!1)},e}($i);Cw.prototype.type="polyline";var CEe={},EEe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),qie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new EEe},e.prototype.buildPath=function(t,r){var i,s,a,l;if(this.subPixelOptimize){var o=Tie(CEe,r,this.style);i=o.x1,s=o.y1,a=o.x2,l=o.y2}else i=r.x1,s=r.y1,a=r.x2,l=r.y2;var h=r.percent;h!==0&&(t.moveTo(i,s),h<1&&(a=i*(1-h)+a*h,l=s*(1-h)+l*h),t.lineTo(a,l))},e.prototype.pointAt=function(t){var r=this.shape;return[r.x1*(1-t)+r.x2*t,r.y1*(1-t)+r.y2*t]},e}($i);qie.prototype.type="line";const Gf=qie;var Yc=[],IEe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function j$(n,e,t){var r=n.cpx2,i=n.cpy2;return r!=null||i!=null?[(t?XX:Ga)(n.x1,n.cpx1,n.cpx2,n.x2,e),(t?XX:Ga)(n.y1,n.cpy1,n.cpy2,n.y2,e)]:[(t?$X:Ul)(n.x1,n.cpx1,n.x2,e),(t?$X:Ul)(n.y1,n.cpy1,n.y2,e)]}var Zie=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new IEe},e.prototype.buildPath=function(t,r){var i=r.x1,s=r.y1,a=r.x2,l=r.y2,o=r.cpx1,h=r.cpy1,d=r.cpx2,m=r.cpy2,v=r.percent;v!==0&&(t.moveTo(i,s),d==null||m==null?(v<1&&(EP(i,o,a,v,Yc),o=Yc[1],a=Yc[2],EP(s,h,l,v,Yc),h=Yc[1],l=Yc[2]),t.quadraticCurveTo(o,h,a,l)):(v<1&&(mv(i,o,d,a,v,Yc),o=Yc[1],d=Yc[2],a=Yc[3],mv(s,h,m,l,v,Yc),h=Yc[1],m=Yc[2],l=Yc[3]),t.bezierCurveTo(o,h,d,m,a,l)))},e.prototype.pointAt=function(t){return j$(this.shape,t,!1)},e.prototype.tangentAt=function(t){var r=j$(this.shape,t,!0);return dTe(r,r)},e}($i);Zie.prototype.type="bezier-curve";const Yie=Zie;var REe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),UD=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new REe},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,a=Math.max(r.r,0),l=r.startAngle,o=r.endAngle,h=r.clockwise,d=Math.cos(l),m=Math.sin(l);t.moveTo(d*a+i,m*a+s),t.arc(i,s,a,l,o,!h)},e}($i);UD.prototype.type="arc";var PEe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="compound",t}return e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,r=this.shapeChanged(),i=0;i<t.length;i++)r=r||t[i].shapeChanged();r&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],r=this.getGlobalScale(),i=0;i<t.length;i++)t[i].path||t[i].createPathProxy(),t[i].path.setScale(r[0],r[1],t[i].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,r){for(var i=r.paths||[],s=0;s<i.length;s++)i[s].buildPath(t,i[s].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],r=0;r<t.length;r++)t[r].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),$i.prototype.getBoundingRect.call(this)},e}($i);const LEe=PEe;var Kie=function(){function n(e){this.colorStops=e||[]}return n.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},n}(),DEe=function(n){Hn(e,n);function e(t,r,i,s,a,l){var o=n.call(this,a)||this;return o.x=t??0,o.y=r??0,o.x2=i??1,o.y2=s??0,o.type="linear",o.global=l||!1,o}return e}(Kie);const Jie=DEe;var BEe=function(n){Hn(e,n);function e(t,r,i,s,a){var l=n.call(this,s)||this;return l.x=t??.5,l.y=r??.5,l.r=i??.5,l.type="radial",l.global=a||!1,l}return e}(Kie);const kEe=BEe;var $_=[0,0],q_=[0,0],VE=new Jr,HE=new Jr,OEe=function(){function n(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var r=0;r<4;r++)this._corners[r]=new Jr;for(var r=0;r<2;r++)this._axes[r]=new Jr;e&&this.fromBoundingRect(e,t)}return n.prototype.fromBoundingRect=function(e,t){var r=this._corners,i=this._axes,s=e.x,a=e.y,l=s+e.width,o=a+e.height;if(r[0].set(s,a),r[1].set(l,a),r[2].set(l,o),r[3].set(s,o),t)for(var h=0;h<4;h++)r[h].transform(t);Jr.sub(i[0],r[1],r[0]),Jr.sub(i[1],r[3],r[0]),i[0].normalize(),i[1].normalize();for(var h=0;h<2;h++)this._origin[h]=i[h].dot(r[0])},n.prototype.intersect=function(e,t){var r=!0,i=!t;return VE.set(1/0,1/0),HE.set(0,0),!this._intersectCheckOneSide(this,e,VE,HE,i,1)&&(r=!1,i)||!this._intersectCheckOneSide(e,this,VE,HE,i,-1)&&(r=!1,i)||i||Jr.copy(t,r?VE:HE),r},n.prototype._intersectCheckOneSide=function(e,t,r,i,s,a){for(var l=!0,o=0;o<2;o++){var h=this._axes[o];if(this._getProjMinMaxOnAxis(o,e._corners,$_),this._getProjMinMaxOnAxis(o,t._corners,q_),$_[1]<q_[0]||$_[0]>q_[1]){if(l=!1,s)return l;var d=Math.abs(q_[0]-$_[1]),m=Math.abs($_[0]-q_[1]);Math.min(d,m)>i.len()&&(d<m?Jr.scale(i,h,-d*a):Jr.scale(i,h,m*a))}else if(r){var d=Math.abs(q_[0]-$_[1]),m=Math.abs($_[0]-q_[1]);Math.min(d,m)<r.len()&&(d<m?Jr.scale(r,h,d*a):Jr.scale(r,h,-m*a))}}return l},n.prototype._getProjMinMaxOnAxis=function(e,t,r){for(var i=this._axes[e],s=this._origin,a=t[0].dot(i)+s[e],l=a,o=a,h=1;h<t.length;h++){var d=t[h].dot(i)+s[e];l=Math.min(d,l),o=Math.max(d,o)}r[0]=l,r[1]=o},n}();const OP=OEe;var FEe=[],NEe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,r){r?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,r){r=r||!1;for(var i=0;i<t.length;i++)this.addDisplayable(t[i],r)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var r=this._cursor;r<this._displayables.length;r++)t&&t(this._displayables[r]);for(var r=0;r<this._temporaryDisplayables.length;r++)t&&t(this._temporaryDisplayables[r])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){var r=this._displayables[t];r.parent=this,r.update(),r.parent=null}for(var t=0;t<this._temporaryDisplayables.length;t++){var r=this._temporaryDisplayables[t];r.parent=this,r.update(),r.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new cs(1/0,1/0,-1/0,-1/0),r=0;r<this._displayables.length;r++){var i=this._displayables[r],s=i.getBoundingRect().clone();i.needLocalTransform()&&s.applyTransform(i.getLocalTransform(FEe)),t.union(s)}this._rect=t}return this._rect},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect();if(s.contain(i[0],i[1]))for(var a=0;a<this._displayables.length;a++){var l=this._displayables[a];if(l.contain(t,r))return!0}return!1},e}(Mw);const zEe=NEe;var Qie=$s();function GD(n,e,t,r,i){var s;if(e&&e.ecModel){var a=e.ecModel.getUpdatePayload();s=a&&a.animation}var l=e&&e.isAnimationEnabled(),o=n==="update";if(l){var h=void 0,d=void 0,m=void 0;r?(h=Ei(r.duration,200),d=Ei(r.easing,"cubicOut"),m=0):(h=e.getShallow(o?"animationDurationUpdate":"animationDuration"),d=e.getShallow(o?"animationEasingUpdate":"animationEasing"),m=e.getShallow(o?"animationDelayUpdate":"animationDelay")),s&&(s.duration!=null&&(h=s.duration),s.easing!=null&&(d=s.easing),s.delay!=null&&(m=s.delay)),ci(m)&&(m=m(t,i)),ci(h)&&(h=h(t));var v={duration:h||0,delay:m,easing:d};return v}else return null}function GU(n,e,t,r,i,s,a){var l=!1,o;ci(i)?(a=s,s=i,i=null):Xr(i)&&(s=i.cb,a=i.during,l=i.isFrom,o=i.removeOpt,i=i.dataIndex);var h=n==="leave";h||e.stopAnimation("leave");var d=GD(n,r,i,h?o||{}:null,r&&r.getAnimationDelayParams?r.getAnimationDelayParams(e,i):null);if(d&&d.duration>0){var m=d.duration,v=d.delay,y=d.easing,S={duration:m,delay:v||0,easing:y,done:s,force:!!s||!!a,setToFinal:!h,scope:n,during:a};l?e.animateFrom(t,S):e.animateTo(t,S)}else e.stopAnimation(),!l&&e.attr(t),a&&a(1),s&&s()}function ol(n,e,t,r,i,s){GU("update",n,e,t,r,i,s)}function ql(n,e,t,r,i,s){GU("enter",n,e,t,r,i,s)}function Ob(n){if(!n.__zr)return!0;for(var e=0;e<n.animators.length;e++){var t=n.animators[e];if(t.scope==="leave")return!0}return!1}function FP(n,e,t,r,i,s){Ob(n)||GU("leave",n,e,t,r,i,s)}function W$(n,e,t,r){n.removeTextContent(),n.removeTextGuideLine(),FP(n,{style:{opacity:0}},e,t,r)}function NP(n,e,t){function r(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(i){i.isGroup||W$(i,e,t,r)}):W$(n,e,t,r)}function VU(n){Qie(n).oldStyle=n.style}function UEe(n){return Qie(n).oldStyle}var zP=Math.max,UP=Math.min,gN={};function GEe(n){return $i.extend(n)}var VEe=pEe;function HEe(n,e){return VEe(n,e)}function ad(n,e){gN[n]=e}function jEe(n){if(gN.hasOwnProperty(n))return gN[n]}function HU(n,e,t,r){var i=dEe(n,e);return t&&(r==="center"&&(t=tse(t,i.getBoundingRect())),nse(i,t)),i}function ese(n,e,t){var r=new Ov({style:{image:n,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(i){if(t==="center"){var s={width:i.width,height:i.height};r.setStyle(tse(e,s))}}});return r}function tse(n,e){var t=e.width/e.height,r=n.height*t,i;r<=n.width?i=n.height:(r=n.width,i=r/t);var s=n.x+n.width/2,a=n.y+n.height/2;return{x:s-r/2,y:a-i/2,width:r,height:i}}var Mm=mEe;function nse(n,e){if(n.applyTransform){var t=n.getBoundingRect(),r=t.calculateTransform(e);n.applyTransform(r)}}function cT(n,e){return Tie(n,n,{lineWidth:e}),n}function WEe(n){return Mie(n.shape,n.shape,n.style),n}var XEe=Ty;function jU(n,e){for(var t=EU([]);n&&n!==e;)Bb(t,n.getLocalTransform(),t),n=n.parent;return t}function VD(n,e,t){return e&&!Ic(e)&&(e=sM.getLocalTransform(e)),t&&(e=ID([],e)),Eh([],n,e)}function rse(n,e,t){var r=e[4]===0||e[5]===0||e[0]===0?1:Math.abs(2*e[4]/e[0]),i=e[4]===0||e[5]===0||e[2]===0?1:Math.abs(2*e[4]/e[2]),s=[n==="left"?-r:n==="right"?r:0,n==="top"?-i:n==="bottom"?i:0];return s=VD(s,e,t),Math.abs(s[0])>Math.abs(s[1])?s[0]>0?"right":"left":s[1]>0?"bottom":"top"}function X$(n){return!n.isGroup}function $Ee(n){return n.shape!=null}function WU(n,e,t){if(!n||!e)return;function r(a){var l={};return a.traverse(function(o){X$(o)&&o.anid&&(l[o.anid]=o)}),l}function i(a){var l={x:a.x,y:a.y,rotation:a.rotation};return $Ee(a)&&(l.shape=Jn({},a.shape)),l}var s=r(n);e.traverse(function(a){if(X$(a)&&a.anid){var l=s[a.anid];if(l){var o=i(a);a.attr(i(l)),ol(a,o,t,Wi(a).dataIndex)}}})}function ise(n,e){return xr(n,function(t){var r=t[0];r=zP(r,e.x),r=UP(r,e.x+e.width);var i=t[1];return i=zP(i,e.y),i=UP(i,e.y+e.height),[r,i]})}function qEe(n,e){var t=zP(n.x,e.x),r=UP(n.x+n.width,e.x+e.width),i=zP(n.y,e.y),s=UP(n.y+n.height,e.y+e.height);if(r>=t&&s>=i)return{x:t,y:i,width:r-t,height:s-i}}function HD(n,e,t){var r=Jn({rectHover:!0},e),i=r.style={strokeNoScale:!0};if(t=t||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(i.image=n.slice(8),ti(i,t),new Ov(r)):HU(n.replace("path://",""),r,t,"center")}function ZEe(n,e,t,r,i){for(var s=0,a=i[i.length-1];s<i.length;s++){var l=i[s];if(sse(n,e,t,r,l[0],l[1],a[0],a[1]))return!0;a=l}}function sse(n,e,t,r,i,s,a,l){var o=t-n,h=r-e,d=a-i,m=l-s,v=ZB(d,m,o,h);if(YEe(v))return!1;var y=n-i,S=e-s,E=ZB(y,S,o,h)/v;if(E<0||E>1)return!1;var M=ZB(y,S,d,m)/v;return!(M<0||M>1)}function ZB(n,e,t,r){return n*r-t*e}function YEe(n){return n<=1e-6&&n>=-1e-6}function jD(n){var e=n.itemTooltipOption,t=n.componentModel,r=n.itemName,i=Dr(e)?{formatter:e}:e,s=t.mainType,a=t.componentIndex,l={componentType:s,name:r,$vars:["name"]};l[s+"Index"]=a;var o=n.formatterParamsExtra;o&&it(so(o),function(d){Ym(l,d)||(l[d]=o[d],l.$vars.push(d))});var h=Wi(n.el);h.componentMainType=s,h.componentIndex=a,h.tooltipConfig={name:r,option:ti({content:r,encodeHTMLContent:!0,formatterParams:l},i)}}function $$(n,e){var t;n.isGroup&&(t=e(n)),t||n.traverse(e)}function WD(n,e){if(n)if(fr(n))for(var t=0;t<n.length;t++)$$(n[t],e);else $$(n,e)}ad("circle",ND);ad("ellipse",Hie);ad("sector",Oh);ad("ring",UU);ad("polygon",zD);ad("polyline",Cw);ad("rect",Ho);ad("line",Gf);ad("bezierCurve",Yie);ad("arc",UD);const XU=Object.freeze(Object.defineProperty({__proto__:null,Arc:UD,BezierCurve:Yie,BoundingRect:cs,Circle:ND,CompoundPath:LEe,Ellipse:Hie,Group:ma,Image:Ov,IncrementalDisplayable:zEe,Line:Gf,LinearGradient:Jie,OrientedBoundingRect:OP,Path:$i,Point:Jr,Polygon:zD,Polyline:Cw,RadialGradient:kEe,Rect:Ho,Ring:UU,Sector:Oh,Text:Ea,applyTransform:VD,clipPointsByRect:ise,clipRectByRect:qEe,createIcon:HD,extendPath:HEe,extendShape:GEe,getShapeClass:jEe,getTransform:jU,groupTransition:WU,initProps:ql,isElementRemoved:Ob,lineLineIntersect:sse,linePolygonIntersect:ZEe,makeImage:ese,makePath:HU,mergePath:Mm,registerShape:ad,removeElement:FP,removeElementWithFadeOut:NP,resizePath:nse,setTooltipConfig:jD,subPixelOptimize:XEe,subPixelOptimizeLine:cT,subPixelOptimizeRect:WEe,transformDirection:rse,traverseElements:WD,updateProps:ol},Symbol.toStringTag,{value:"Module"}));var XD={};function ose(n,e){for(var t=0;t<kh.length;t++){var r=kh[t],i=e[r],s=n.ensureState(r);s.style=s.style||{},s.style.text=i}var a=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:e.normal}),n.useStates(a,!0)}function vN(n,e,t){var r=n.labelFetcher,i=n.labelDataIndex,s=n.labelDimIndex,a=e.normal,l;r&&(l=r.getFormattedLabel(i,"normal",null,s,a&&a.get("formatter"),t!=null?{interpolatedValue:t}:null)),l==null&&(l=ci(n.defaultText)?n.defaultText(i,n,t):n.defaultText);for(var o={normal:l},h=0;h<kh.length;h++){var d=kh[h],m=e[d];o[d]=Ei(r?r.getFormattedLabel(i,d,null,s,m&&m.get("formatter")):null,l)}return o}function cM(n,e,t,r){t=t||XD;for(var i=n instanceof Ea,s=!1,a=0;a<BP.length;a++){var l=e[BP[a]];if(l&&l.getShallow("show")){s=!0;break}}var o=i?n:n.getTextContent();if(s){i||(o||(o=new Ea,n.setTextContent(o)),n.stateProxy&&(o.stateProxy=n.stateProxy));var h=vN(t,e),d=e.normal,m=!!d.getShallow("show"),v=Qm(d,r&&r.normal,t,!1,!i);v.text=h.normal,i||n.setTextConfig(q$(d,t,!1));for(var a=0;a<kh.length;a++){var y=kh[a],l=e[y];if(l){var S=o.ensureState(y),E=!!Ei(l.getShallow("show"),m);if(E!==m&&(S.ignore=!E),S.style=Qm(l,r&&r[y],t,!0,!i),S.style.text=h[y],!i){var M=n.ensureState(y);M.textConfig=q$(l,t,!0)}}}o.silent=!!d.getShallow("silent"),o.style.x!=null&&(v.x=o.style.x),o.style.y!=null&&(v.y=o.style.y),o.ignore=!m,o.useStyle(v),o.dirty(),t.enableTextSetter&&(Ew(o).setLabelText=function(C){var L=vN(t,e,C);ose(o,L)})}else o&&(o.ignore=!0);n.dirty()}function uM(n,e){e=e||"label";for(var t={normal:n.getModel(e)},r=0;r<kh.length;r++){var i=kh[r];t[i]=n.getModel([i,e])}return t}function Qm(n,e,t,r,i){var s={};return KEe(s,n,t,r,i),e&&Jn(s,e),s}function q$(n,e,t){e=e||{};var r={},i,s=n.getShallow("rotate"),a=Ei(n.getShallow("distance"),t?null:5),l=n.getShallow("offset");return i=n.getShallow("position")||(t?null:"inside"),i==="outside"&&(i=e.defaultOutsidePosition||"top"),i!=null&&(r.position=i),l!=null&&(r.offset=l),s!=null&&(s*=Math.PI/180,r.rotation=s),a!=null&&(r.distance=a),r.outsideFill=n.get("color")==="inherit"?e.inheritColor||null:"auto",r}function KEe(n,e,t,r,i){t=t||XD;var s=e.ecModel,a=s&&s.option.textStyle,l=JEe(e),o;if(l){o={};for(var h in l)if(l.hasOwnProperty(h)){var d=e.getModel(["rich",h]);J$(o[h]={},d,a,t,r,i,!1,!0)}}o&&(n.rich=o);var m=e.get("overflow");m&&(n.overflow=m);var v=e.get("minMargin");v!=null&&(n.margin=v),J$(n,e,a,t,r,i,!0,!1)}function JEe(n){for(var e;n&&n!==n.ecModel;){var t=(n.option||XD).rich;if(t){e=e||{};for(var r=so(t),i=0;i<r.length;i++){var s=r[i];e[s]=1}}n=n.parentModel}return e}var Z$=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Y$=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],K$=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function J$(n,e,t,r,i,s,a,l){t=!i&&t||XD;var o=r&&r.inheritColor,h=e.getShallow("color"),d=e.getShallow("textBorderColor"),m=Ei(e.getShallow("opacity"),t.opacity);(h==="inherit"||h==="auto")&&(o?h=o:h=null),(d==="inherit"||d==="auto")&&(o?d=o:d=null),s||(h=h||t.color,d=d||t.textBorderColor),h!=null&&(n.fill=h),d!=null&&(n.stroke=d);var v=Ei(e.getShallow("textBorderWidth"),t.textBorderWidth);v!=null&&(n.lineWidth=v);var y=Ei(e.getShallow("textBorderType"),t.textBorderType);y!=null&&(n.lineDash=y);var S=Ei(e.getShallow("textBorderDashOffset"),t.textBorderDashOffset);S!=null&&(n.lineDashOffset=S),!i&&m==null&&!l&&(m=r&&r.defaultOpacity),m!=null&&(n.opacity=m),!i&&!s&&n.fill==null&&r.inheritColor&&(n.fill=r.inheritColor);for(var E=0;E<Z$.length;E++){var M=Z$[E],C=Ei(e.getShallow(M),t[M]);C!=null&&(n[M]=C)}for(var E=0;E<Y$.length;E++){var M=Y$[E],C=e.getShallow(M);C!=null&&(n[M]=C)}if(n.verticalAlign==null){var L=e.getShallow("baseline");L!=null&&(n.verticalAlign=L)}if(!a||!r.disableBox){for(var E=0;E<K$.length;E++){var M=K$[E],C=e.getShallow(M);C!=null&&(n[M]=C)}var k=e.getShallow("borderType");k!=null&&(n.borderDash=k),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&o&&(n.backgroundColor=o),(n.borderColor==="auto"||n.borderColor==="inherit")&&o&&(n.borderColor=o)}}function ase(n,e){var t=e&&e.getModel("textStyle");return tp([n.fontStyle||t&&t.getShallow("fontStyle")||"",n.fontWeight||t&&t.getShallow("fontWeight")||"",(n.fontSize||t&&t.getShallow("fontSize")||12)+"px",n.fontFamily||t&&t.getShallow("fontFamily")||"sans-serif"].join(" "))}var Ew=$s();function QEe(n,e,t,r){if(n){var i=Ew(n);i.prevValue=i.value,i.value=t;var s=e.normal;i.valueAnimation=s.get("valueAnimation"),i.valueAnimation&&(i.precision=s.get("precision"),i.defaultInterpolatedText=r,i.statesModels=e)}}function eIe(n,e,t,r,i){var s=Ew(n);if(!s.valueAnimation||s.prevValue===s.value)return;var a=s.defaultInterpolatedText,l=Ei(s.interpolatedValue,s.prevValue),o=s.value;function h(d){var m=pie(t,s.precision,l,o,d);s.interpolatedValue=d===1?null:m;var v=vN({labelDataIndex:e,labelFetcher:i,defaultText:a?a(m):m+""},s.statesModels,m);ose(n,v)}n.percent=0,(s.prevValue==null?ql:ol)(n,{percent:1},r,e,null,h)}var tIe=["textStyle","color"],YB=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],KB=new Ea,nIe=function(){function n(){}return n.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(tIe):null)},n.prototype.getFont=function(){return ase({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},r=0;r<YB.length;r++)t[YB[r]]=this.getShallow(YB[r]);return KB.useStyle(t),KB.update(),KB.getBoundingRect()},n}(),lse=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],rIe=aT(lse),iIe=function(){function n(){}return n.prototype.getLineStyle=function(e){return rIe(this,e)},n}(),cse=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],sIe=aT(cse),oIe=function(){function n(){}return n.prototype.getItemStyle=function(e,t){return sIe(this,e,t)},n}(),Ro=function(){function n(e,t,r){this.parentModel=t,this.ecModel=r,this.option=e}return n.prototype.init=function(e,t,r){},n.prototype.mergeOption=function(e,t){Di(this.option,e,!0)},n.prototype.get=function(e,t){return e==null?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},n.prototype.getShallow=function(e,t){var r=this.option,i=r==null?r:r[e];if(i==null&&!t){var s=this.parentModel;s&&(i=s.getShallow(e))}return i},n.prototype.getModel=function(e,t){var r=e!=null,i=r?this.parsePath(e):null,s=r?this._doGet(i):this.option;return t=t||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new n(s,t,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var e=this.constructor;return new e(_i(this.option))},n.prototype.parsePath=function(e){return typeof e=="string"?e.split("."):e},n.prototype.resolveParentPath=function(e){return e},n.prototype.isAnimationEnabled=function(){if(!mi.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(e,t){var r=this.option;if(!e)return r;for(var i=0;i<e.length&&!(e[i]&&(r=r&&typeof r=="object"?r[e[i]]:null,r==null));i++);return r==null&&t&&(r=t._doGet(this.resolveParentPath(e),t.parentModel)),r},n}();BU(Ro);qMe(Ro);sd(Ro,iIe);sd(Ro,oIe);sd(Ro,QMe);sd(Ro,nIe);var aIe=Math.round(Math.random()*10);function hM(n){return[n||"",aIe++].join("_")}function lIe(n){var e={};n.registerSubTypeDefaulter=function(t,r){var i=np(t);e[i.main]=r},n.determineSubType=function(t,r){var i=r.type;if(!i){var s=np(t).main;n.hasSubTypes(t)&&e[s]&&(i=e[s](r))}return i}}function cIe(n,e){n.topologicalTravel=function(s,a,l,o){if(!s.length)return;var h=t(a),d=h.graph,m=h.noEntryList,v={};for(it(s,function(L){v[L]=!0});m.length;){var y=m.pop(),S=d[y],E=!!v[y];E&&(l.call(o,y,S.originalDeps.slice()),delete v[y]),it(S.successor,E?C:M)}it(v,function(){var L="";throw new Error(L)});function M(L){d[L].entryCount--,d[L].entryCount===0&&m.push(L)}function C(L){v[L]=!0,M(L)}};function t(s){var a={},l=[];return it(s,function(o){var h=r(a,o),d=h.originalDeps=e(o),m=i(d,s);h.entryCount=m.length,h.entryCount===0&&l.push(o),it(m,function(v){Xi(h.predecessor,v)<0&&h.predecessor.push(v);var y=r(a,v);Xi(y.successor,v)<0&&y.successor.push(o)})}),{graph:a,noEntryList:l}}function r(s,a){return s[a]||(s[a]={predecessor:[],successor:[]}),s[a]}function i(s,a){var l=[];return it(s,function(o){Xi(a,o)>=0&&l.push(o)}),l}}function use(n,e){return Di(Di({},n,!0),e,!0)}const uIe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},hIe={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var GP="ZH",$U="EN",Fb=$U,nR={},qU={},hse=mi.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage||Fb).toUpperCase();return n.indexOf(GP)>-1?GP:Fb}():Fb;function fse(n,e){n=n.toUpperCase(),qU[n]=new Ro(e),nR[n]=e}function fIe(n){if(Dr(n)){var e=nR[n.toUpperCase()]||{};return n===GP||n===$U?_i(e):Di(_i(e),_i(nR[Fb]),!1)}else return Di(_i(n),_i(nR[Fb]),!1)}function dIe(n){return qU[n]}function pIe(){return qU[Fb]}fse($U,uIe);fse(GP,hIe);var ZU=1e3,YU=ZU*60,hA=YU*60,wh=hA*24,Q$=wh*365,ES={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},jE="{yyyy}-{MM}-{dd}",eq={year:"{yyyy}",month:"{yyyy}-{MM}",day:jE,hour:jE+" "+ES.hour,minute:jE+" "+ES.minute,second:jE+" "+ES.second,millisecond:ES.none},JB=["year","month","day","hour","minute","second","millisecond"],dse=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function _0(n,e){return n+="","0000".substr(0,e-n.length)+n}function Nb(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function mIe(n){return n===Nb(n)}function gIe(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function $D(n,e,t,r){var i=Km(n),s=i[KU(t)](),a=i[zb(t)]()+1,l=Math.floor((a-1)/3)+1,o=i[qD(t)](),h=i["get"+(t?"UTC":"")+"Day"](),d=i[uT(t)](),m=(d-1)%12+1,v=i[ZD(t)](),y=i[YD(t)](),S=i[KD(t)](),E=d>=12?"pm":"am",M=E.toUpperCase(),C=r instanceof Ro?r:dIe(r||hse)||pIe(),L=C.getModel("time"),k=L.get("month"),H=L.get("monthAbbr"),q=L.get("dayOfWeek"),Z=L.get("dayOfWeekAbbr");return(e||"").replace(/{a}/g,E+"").replace(/{A}/g,M+"").replace(/{yyyy}/g,s+"").replace(/{yy}/g,_0(s%100+"",2)).replace(/{Q}/g,l+"").replace(/{MMMM}/g,k[a-1]).replace(/{MMM}/g,H[a-1]).replace(/{MM}/g,_0(a,2)).replace(/{M}/g,a+"").replace(/{dd}/g,_0(o,2)).replace(/{d}/g,o+"").replace(/{eeee}/g,q[h]).replace(/{ee}/g,Z[h]).replace(/{e}/g,h+"").replace(/{HH}/g,_0(d,2)).replace(/{H}/g,d+"").replace(/{hh}/g,_0(m+"",2)).replace(/{h}/g,m+"").replace(/{mm}/g,_0(v,2)).replace(/{m}/g,v+"").replace(/{ss}/g,_0(y,2)).replace(/{s}/g,y+"").replace(/{SSS}/g,_0(S,3)).replace(/{S}/g,S+"")}function vIe(n,e,t,r,i){var s=null;if(Dr(t))s=t;else if(ci(t))s=t(n.value,e,{level:n.level});else{var a=Jn({},ES);if(n.level>0)for(var l=0;l<JB.length;++l)a[JB[l]]="{primary|"+a[JB[l]]+"}";var o=t?t.inherit===!1?t:ti(t,a):a,h=pse(n.value,i);if(o[h])s=o[h];else if(o.inherit){for(var d=dse.indexOf(h),l=d-1;l>=0;--l)if(o[h]){s=o[h];break}s=s||a.none}if(fr(s)){var m=n.level==null?0:n.level>=0?n.level:s.length+n.level;m=Math.min(m,s.length-1),s=s[m]}}return $D(new Date(n.value),s,i,r)}function pse(n,e){var t=Km(n),r=t[zb(e)]()+1,i=t[qD(e)](),s=t[uT(e)](),a=t[ZD(e)](),l=t[YD(e)](),o=t[KD(e)](),h=o===0,d=h&&l===0,m=d&&a===0,v=m&&s===0,y=v&&i===1,S=y&&r===1;return S?"year":y?"month":v?"day":m?"hour":d?"minute":h?"second":"millisecond"}function tq(n,e,t){var r=Rs(n)?Km(n):n;switch(e=e||pse(n,t),e){case"year":return r[KU(t)]();case"half-year":return r[zb(t)]()>=6?1:0;case"quarter":return Math.floor((r[zb(t)]()+1)/4);case"month":return r[zb(t)]();case"day":return r[qD(t)]();case"half-day":return r[uT(t)]()/24;case"hour":return r[uT(t)]();case"minute":return r[ZD(t)]();case"second":return r[YD(t)]();case"millisecond":return r[KD(t)]()}}function KU(n){return n?"getUTCFullYear":"getFullYear"}function zb(n){return n?"getUTCMonth":"getMonth"}function qD(n){return n?"getUTCDate":"getDate"}function uT(n){return n?"getUTCHours":"getHours"}function ZD(n){return n?"getUTCMinutes":"getMinutes"}function YD(n){return n?"getUTCSeconds":"getSeconds"}function KD(n){return n?"getUTCMilliseconds":"getMilliseconds"}function _Ie(n){return n?"setUTCFullYear":"setFullYear"}function mse(n){return n?"setUTCMonth":"setMonth"}function gse(n){return n?"setUTCDate":"setDate"}function vse(n){return n?"setUTCHours":"setHours"}function _se(n){return n?"setUTCMinutes":"setMinutes"}function yse(n){return n?"setUTCSeconds":"setSeconds"}function xse(n){return n?"setUTCMilliseconds":"setMilliseconds"}function bse(n){if(!CMe(n))return Dr(n)?n:"-";var e=(n+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function wse(n,e){return n=(n||"").toLowerCase().replace(/-(.)/g,function(t,r){return r.toUpperCase()}),e&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var JD=Bre;function _N(n,e,t){var r="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(d){return d&&tp(d)?d:"-"}function s(d){return!!(d!=null&&!isNaN(d)&&isFinite(d))}var a=e==="time",l=n instanceof Date;if(a||l){var o=a?Km(n):n;if(isNaN(+o)){if(l)return"-"}else return $D(o,r,t)}if(e==="ordinal")return HF(n)?i(n):Rs(n)&&s(n)?n+"":"-";var h=vv(n);return s(h)?bse(h):HF(n)?i(n):typeof n=="boolean"?n+"":"-"}var nq=["a","b","c","d","e","f","g"],QB=function(n,e){return"{"+n+(e??"")+"}"};function Sse(n,e,t){fr(e)||(e=[e]);var r=e.length;if(!r)return"";for(var i=e[0].$vars||[],s=0;s<i.length;s++){var a=nq[s];n=n.replace(QB(a),QB(a,0))}for(var l=0;l<r;l++)for(var o=0;o<i.length;o++){var h=e[l][i[o]];n=n.replace(QB(nq[o],l),t?Pu(h):h)}return n}function yIe(n,e){var t=Dr(n)?{color:n,extraCssText:e}:n||{},r=t.color,i=t.type;e=t.extraCssText;var s=t.renderMode||"html";if(!r)return"";if(s==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Pu(r)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Pu(r)+";"+(e||"")+'"></span>';var a=t.markerId||"markerX";return{renderMode:s,content:"{"+a+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:r}:{width:10,height:10,borderRadius:5,backgroundColor:r}}}function s1(n,e){return e=e||"transparent",Dr(n)?n:Xr(n)&&n.colorStops&&(n.colorStops[0]||{}).color||e}function rq(n,e){if(e==="_blank"||e==="blank"){var t=window.open();t.opener=null,t.location.href=n}else window.open(n,e)}var rR=it,xIe=["left","right","top","bottom","width","height"],WE=[["width","left","right"],["height","top","bottom"]];function JU(n,e,t,r,i){var s=0,a=0;r==null&&(r=1/0),i==null&&(i=1/0);var l=0;e.eachChild(function(o,h){var d=o.getBoundingRect(),m=e.childAt(h+1),v=m&&m.getBoundingRect(),y,S;if(n==="horizontal"){var E=d.width+(v?-v.x+d.x:0);y=s+E,y>r||o.newline?(s=0,y=E,a+=l+t,l=d.height):l=Math.max(l,d.height)}else{var M=d.height+(v?-v.y+d.y:0);S=a+M,S>i||o.newline?(s+=l+t,a=0,S=M,l=d.width):l=Math.max(l,d.width)}o.newline||(o.x=s,o.y=a,o.markRedraw(),n==="horizontal"?s=y+t:a=S+t)})}var Ub=JU;vs(JU,"vertical");vs(JU,"horizontal");function _v(n,e,t){t=JD(t||0);var r=e.width,i=e.height,s=ls(n.left,r),a=ls(n.top,i),l=ls(n.right,r),o=ls(n.bottom,i),h=ls(n.width,r),d=ls(n.height,i),m=t[2]+t[0],v=t[1]+t[3],y=n.aspect;switch(isNaN(h)&&(h=r-l-v-s),isNaN(d)&&(d=i-o-m-a),y!=null&&(isNaN(h)&&isNaN(d)&&(y>r/i?h=r*.8:d=i*.8),isNaN(h)&&(h=y*d),isNaN(d)&&(d=h/y)),isNaN(s)&&(s=r-l-h-v),isNaN(a)&&(a=i-o-d-m),n.left||n.right){case"center":s=r/2-h/2-t[3];break;case"right":s=r-h-v;break}switch(n.top||n.bottom){case"middle":case"center":a=i/2-d/2-t[0];break;case"bottom":a=i-d-m;break}s=s||0,a=a||0,isNaN(h)&&(h=r-v-s-(l||0)),isNaN(d)&&(d=i-m-a-(o||0));var S=new cs(s+t[3],a+t[0],h,d);return S.margin=t,S}function bIe(n,e,t,r,i,s){s=s||n,s.x=n.x,s.y=n.y;var a;if(a=n.getBoundingRect(),n.needLocalTransform()){var l=n.getLocalTransform();a=a.clone(),a.applyTransform(l)}var o=_v(ti({width:a.width,height:a.height},e),t,r),h=o.x-a.x,d=o.y-a.y;return s.x+=h,s.y+=d,s===n&&n.markRedraw(),!0}function hT(n){var e=n.layoutMode||n.constructor.layoutMode;return Xr(e)?e:e?{type:e}:null}function sw(n,e,t){var r=t&&t.ignoreSize;!fr(r)&&(r=[r,r]);var i=a(WE[0],0),s=a(WE[1],1);h(WE[0],n,i),h(WE[1],n,s);function a(d,m){var v={},y=0,S={},E=0,M=2;if(rR(d,function(k){S[k]=n[k]}),rR(d,function(k){l(e,k)&&(v[k]=S[k]=e[k]),o(v,k)&&y++,o(S,k)&&E++}),r[m])return o(e,d[1])?S[d[2]]=null:o(e,d[2])&&(S[d[1]]=null),S;if(E===M||!y)return S;if(y>=M)return v;for(var C=0;C<d.length;C++){var L=d[C];if(!l(v,L)&&l(n,L)){v[L]=n[L];break}}return v}function l(d,m){return d.hasOwnProperty(m)}function o(d,m){return d[m]!=null&&d[m]!=="auto"}function h(d,m,v){rR(d,function(y){m[y]=v[y]})}}function QD(n){return wIe({},n)}function wIe(n,e){return e&&n&&rR(xIe,function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n}var SIe=$s(),os=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this,t,r,i)||this;return s.uid=hM("ec_cpt_model"),s}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=hT(this),s=i?QD(t):{},a=r.getTheme();Di(t,a.get(this.mainType)),Di(t,this.getDefaultOption()),i&&sw(t,s,i)},e.prototype.mergeOption=function(t,r){Di(this.option,t,!0);var i=hT(this);i&&sw(this.option,t,i)},e.prototype.optionUpdated=function(t,r){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!WMe(t))return t.defaultOption;var r=SIe(this);if(!r.defaultOption){for(var i=[],s=t;s;){var a=s.prototype.defaultOption;a&&i.push(a),s=s.superClass}for(var l={},o=i.length-1;o>=0;o--)l=Di(l,i[o],!0);r.defaultOption=l}return r.defaultOption},e.prototype.getReferringComponents=function(t,r){var i=t+"Index",s=t+"Id";return lM(this.ecModel,t,{index:this.get(i,!0),id:this.get(s,!0)},r)},e.prototype.getBoxLayoutParams=function(){var t=this;return{left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")}},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(t){this.option.zlevel=t},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}(Ro);gie(os,Ro);LD(os);lIe(os);cIe(os,AIe);function AIe(n){var e=[];return it(os.getClassesByMainType(n),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=xr(e,function(t){return np(t).main}),n!=="dataset"&&Xi(e,"dataset")<=0&&e.unshift("dataset"),e}var Ase="";typeof navigator<"u"&&(Ase=navigator.platform||"");var Bx="rgba(0, 0, 0, 0.2)";const TIe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Bx,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Bx,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Bx,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Bx,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Bx,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Bx,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:Ase.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var Tse=ii(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),Fh="original",Rc="arrayRows",Nh="objectRows",yp="keyedColumns",ov="typedArray",Mse="unknown",up="column",Iw="row",_l={Must:1,Might:2,Not:3},Cse=$s();function MIe(n){Cse(n).datasetMap=ii()}function CIe(n,e,t){var r={},i=QU(e);if(!i||!n)return r;var s=[],a=[],l=e.ecModel,o=Cse(l).datasetMap,h=i.uid+"_"+t.seriesLayoutBy,d,m;n=n.slice(),it(n,function(E,M){var C=Xr(E)?E:n[M]={name:E};C.type==="ordinal"&&d==null&&(d=M,m=S(C)),r[C.name]=[]});var v=o.get(h)||o.set(h,{categoryWayDim:m,valueWayDim:0});it(n,function(E,M){var C=E.name,L=S(E);if(d==null){var k=v.valueWayDim;y(r[C],k,L),y(a,k,L),v.valueWayDim+=L}else if(d===M)y(r[C],0,L),y(s,0,L);else{var k=v.categoryWayDim;y(r[C],k,L),y(a,k,L),v.categoryWayDim+=L}});function y(E,M,C){for(var L=0;L<C;L++)E.push(M+L)}function S(E){var M=E.dimsDef;return M?M.length:1}return s.length&&(r.itemName=s),a.length&&(r.seriesName=a),r}function EIe(n,e,t){var r={},i=QU(n);if(!i)return r;var s=e.sourceFormat,a=e.dimensionsDefine,l;(s===Nh||s===yp)&&it(a,function(d,m){(Xr(d)?d.name:d)==="name"&&(l=m)});var o=function(){for(var d={},m={},v=[],y=0,S=Math.min(5,t);y<S;y++){var E=Ise(e.data,s,e.seriesLayoutBy,a,e.startIndex,y);v.push(E);var M=E===_l.Not;if(M&&d.v==null&&y!==l&&(d.v=y),(d.n==null||d.n===d.v||!M&&v[d.n]===_l.Not)&&(d.n=y),C(d)&&v[d.n]!==_l.Not)return d;M||(E===_l.Might&&m.v==null&&y!==l&&(m.v=y),(m.n==null||m.n===m.v)&&(m.n=y))}function C(L){return L.v!=null&&L.n!=null}return C(d)?d:C(m)?m:null}();if(o){r.value=[o.v];var h=l??o.n;r.itemName=[h],r.seriesName=[h]}return r}function QU(n){var e=n.get("data",!0);if(!e)return lM(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},xl).models[0]}function IIe(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:lM(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},xl).models}function Ese(n,e){return Ise(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,e)}function Ise(n,e,t,r,i,s){var a,l=5;if(du(n))return _l.Not;var o,h;if(r){var d=r[s];Xr(d)?(o=d.name,h=d.type):Dr(d)&&(o=d)}if(h!=null)return h==="ordinal"?_l.Must:_l.Not;if(e===Rc){var m=n;if(t===Iw){for(var v=m[s],y=0;y<(v||[]).length&&y<l;y++)if((a=H(v[i+y]))!=null)return a}else for(var y=0;y<m.length&&y<l;y++){var S=m[i+y];if(S&&(a=H(S[s]))!=null)return a}}else if(e===Nh){var E=n;if(!o)return _l.Not;for(var y=0;y<E.length&&y<l;y++){var M=E[y];if(M&&(a=H(M[o]))!=null)return a}}else if(e===yp){var C=n;if(!o)return _l.Not;var v=C[o];if(!v||du(v))return _l.Not;for(var y=0;y<v.length&&y<l;y++)if((a=H(v[y]))!=null)return a}else if(e===Fh)for(var L=n,y=0;y<L.length&&y<l;y++){var M=L[y],k=aM(M);if(!fr(k))return _l.Not;if((a=H(k[s]))!=null)return a}function H(q){var Z=Dr(q);if(q!=null&&Number.isFinite(Number(q))&&q!=="")return Z?_l.Might:_l.Not;if(Z&&q!=="-")return _l.Must}return _l.Not}var yN=ii();function RIe(n,e){pp(yN.get(n)==null&&e),yN.set(n,e)}function PIe(n,e,t){var r=yN.get(e);if(!r)return t;var i=r(n);return i?t.concat(i):t}var iq=$s();$s();var e8=function(){function n(){}return n.prototype.getColorFromPalette=function(e,t,r){var i=pa(this.get("color",!0)),s=this.get("colorLayer",!0);return DIe(this,iq,i,s,e,t,r)},n.prototype.clearColorPalette=function(){BIe(this,iq)},n}();function LIe(n,e){for(var t=n.length,r=0;r<t;r++)if(n[r].length>e)return n[r];return n[t-1]}function DIe(n,e,t,r,i,s,a){s=s||n;var l=e(s),o=l.paletteIdx||0,h=l.paletteNameMap=l.paletteNameMap||{};if(h.hasOwnProperty(i))return h[i];var d=a==null||!r?t:LIe(r,a);if(d=d||t,!(!d||!d.length)){var m=d[o];return i&&(h[i]=m),l.paletteIdx=(o+1)%d.length,m}}function BIe(n,e){e(n).paletteIdx=0,e(n).paletteNameMap={}}var XE,Z2,sq,oq="\0_ec_inner",kIe=1,t8=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t,r,i,s,a,l){s=s||{},this.option=null,this._theme=new Ro(s),this._locale=new Ro(a),this._optionManager=l},e.prototype.setOption=function(t,r,i){var s=cq(r);this._optionManager.setOption(t,i,s),this._resetOption(null,s)},e.prototype.resetOption=function(t,r){return this._resetOption(t,cq(r))},e.prototype._resetOption=function(t,r){var i=!1,s=this._optionManager;if(!t||t==="recreate"){var a=s.mountOption(t==="recreate");!this.option||t==="recreate"?sq(this,a):(this.restoreData(),this._mergeOption(a,r)),i=!0}if((t==="timeline"||t==="media")&&this.restoreData(),!t||t==="recreate"||t==="timeline"){var l=s.getTimelineOption(this);l&&(i=!0,this._mergeOption(l,r))}if(!t||t==="recreate"||t==="media"){var o=s.getMediaOption(this);o.length&&it(o,function(h){i=!0,this._mergeOption(h,r)},this)}return i},e.prototype.mergeOption=function(t){this._mergeOption(t,null)},e.prototype._mergeOption=function(t,r){var i=this.option,s=this._componentsMap,a=this._componentsCount,l=[],o=ii(),h=r&&r.replaceMergeMainTypeMap;MIe(this),it(t,function(m,v){m!=null&&(os.hasClass(v)?v&&(l.push(v),o.set(v,!0)):i[v]=i[v]==null?_i(m):Di(i[v],m,!0))}),h&&h.each(function(m,v){os.hasClass(v)&&!o.get(v)&&(l.push(v),o.set(v,!0))}),os.topologicalTravel(l,os.getAllClassMainTypes(),d,this);function d(m){var v=PIe(this,m,pa(t[m])),y=s.get(m),S=y?h&&h.get(m)?"replaceMerge":"normalMerge":"replaceAll",E=IMe(y,v,S);FMe(E,m,os),i[m]=null,s.set(m,null),a.set(m,0);var M=[],C=[],L=0,k;it(E,function(H,q){var Z=H.existing,ee=H.newOption;if(!ee)Z&&(Z.mergeOption({},this),Z.optionUpdated({},!1));else{var re=m==="series",se=os.getClass(m,H.keyInfo.subType,!re);if(!se)return;if(m==="tooltip"){if(k)return;k=!0}if(Z&&Z.constructor===se)Z.name=H.keyInfo.name,Z.mergeOption(ee,this),Z.optionUpdated(ee,!1);else{var ae=Jn({componentIndex:q},H.keyInfo);Z=new se(ee,this,this,ae),Jn(Z,ae),H.brandNew&&(Z.__requireNewView=!0),Z.init(ee,this,this),Z.optionUpdated(null,!0)}}Z?(M.push(Z.option),C.push(Z),L++):(M.push(void 0),C.push(void 0))},this),i[m]=M,s.set(m,C),a.set(m,L),m==="series"&&XE(this)}this._seriesIndices||XE(this)},e.prototype.getOption=function(){var t=_i(this.option);return it(t,function(r,i){if(os.hasClass(i)){for(var s=pa(r),a=s.length,l=!1,o=a-1;o>=0;o--)s[o]&&!oT(s[o])?l=!0:(s[o]=null,!l&&a--);s.length=a,t[i]=s}}),delete t[oq],t},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(t){this._payload=t},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(t,r){var i=this._componentsMap.get(t);if(i){var s=i[r||0];if(s)return s;if(r==null){for(var a=0;a<i.length;a++)if(i[a])return i[a]}}},e.prototype.queryComponents=function(t){var r=t.mainType;if(!r)return[];var i=t.index,s=t.id,a=t.name,l=this._componentsMap.get(r);if(!l||!l.length)return[];var o;return i!=null?(o=[],it(pa(i),function(h){l[h]&&o.push(l[h])})):s!=null?o=aq("id",s,l):a!=null?o=aq("name",a,l):o=na(l,function(h){return!!h}),lq(o,t)},e.prototype.findComponents=function(t){var r=t.query,i=t.mainType,s=l(r),a=s?this.queryComponents(s):na(this._componentsMap.get(i),function(h){return!!h});return o(lq(a,t));function l(h){var d=i+"Index",m=i+"Id",v=i+"Name";return h&&(h[d]!=null||h[m]!=null||h[v]!=null)?{mainType:i,index:h[d],id:h[m],name:h[v]}:null}function o(h){return t.filter?na(h,t.filter):h}},e.prototype.eachComponent=function(t,r,i){var s=this._componentsMap;if(ci(t)){var a=r,l=t;s.each(function(m,v){for(var y=0;m&&y<m.length;y++){var S=m[y];S&&l.call(a,v,S,S.componentIndex)}})}else for(var o=Dr(t)?s.get(t):Xr(t)?this.findComponents(t):null,h=0;o&&h<o.length;h++){var d=o[h];d&&r.call(i,d,d.componentIndex)}},e.prototype.getSeriesByName=function(t){var r=cp(t,null);return na(this._componentsMap.get("series"),function(i){return!!i&&r!=null&&i.name===r})},e.prototype.getSeriesByIndex=function(t){return this._componentsMap.get("series")[t]},e.prototype.getSeriesByType=function(t){return na(this._componentsMap.get("series"),function(r){return!!r&&r.subType===t})},e.prototype.getSeries=function(){return na(this._componentsMap.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(t,r){Z2(this),it(this._seriesIndices,function(i){var s=this._componentsMap.get("series")[i];t.call(r,s,i)},this)},e.prototype.eachRawSeries=function(t,r){it(this._componentsMap.get("series"),function(i){i&&t.call(r,i,i.componentIndex)})},e.prototype.eachSeriesByType=function(t,r,i){Z2(this),it(this._seriesIndices,function(s){var a=this._componentsMap.get("series")[s];a.subType===t&&r.call(i,a,s)},this)},e.prototype.eachRawSeriesByType=function(t,r,i){return it(this.getSeriesByType(t),r,i)},e.prototype.isSeriesFiltered=function(t){return Z2(this),this._seriesIndicesMap.get(t.componentIndex)==null},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(t,r){Z2(this);var i=[];it(this._seriesIndices,function(s){var a=this._componentsMap.get("series")[s];t.call(r,a,s)&&i.push(s)},this),this._seriesIndices=i,this._seriesIndicesMap=ii(i)},e.prototype.restoreData=function(t){XE(this);var r=this._componentsMap,i=[];r.each(function(s,a){os.hasClass(a)&&i.push(a)}),os.topologicalTravel(i,os.getAllClassMainTypes(),function(s){it(r.get(s),function(a){a&&(s!=="series"||!OIe(a,t))&&a.restoreData()})})},e.internalField=function(){XE=function(t){var r=t._seriesIndices=[];it(t._componentsMap.get("series"),function(i){i&&r.push(i.componentIndex)}),t._seriesIndicesMap=ii(r)},Z2=function(t){},sq=function(t,r){t.option={},t.option[oq]=kIe,t._componentsMap=ii({series:[]}),t._componentsCount=ii();var i=r.aria;Xr(i)&&i.enabled==null&&(i.enabled=!0),FIe(r,t._theme.option),Di(r,TIe,!1),t._mergeOption(r,null)}}(),e}(Ro);function OIe(n,e){if(e){var t=e.seriesIndex,r=e.seriesId,i=e.seriesName;return t!=null&&n.componentIndex!==t||r!=null&&n.id!==r||i!=null&&n.name!==i}}function FIe(n,e){var t=n.color&&!n.colorLayer;it(e,function(r,i){i==="colorLayer"&&t||os.hasClass(i)||(typeof r=="object"?n[i]=n[i]?Di(n[i],r,!1):_i(r):n[i]==null&&(n[i]=r))})}function aq(n,e,t){if(fr(e)){var r=ii();return it(e,function(s){if(s!=null){var a=cp(s,null);a!=null&&r.set(s,!0)}}),na(t,function(s){return s&&r.get(s[n])})}else{var i=cp(e,null);return na(t,function(s){return s&&i!=null&&s[n]===i})}}function lq(n,e){return e.hasOwnProperty("subType")?na(n,function(t){return t&&t.subType===e.subType}):n}function cq(n){var e=ii();return n&&it(pa(n.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}sd(t8,e8);var NIe=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],Rse=function(){function n(e){it(NIe,function(t){this[t]=zs(e[t],e)},this)}return n}(),ek={},n8=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(e,t){var r=[];it(ek,function(i,s){var a=i.create(e,t);r=r.concat(a||[])}),this._coordinateSystems=r},n.prototype.update=function(e,t){it(this._coordinateSystems,function(r){r.update&&r.update(e,t)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(e,t){ek[e]=t},n.get=function(e){return ek[e]},n}(),zIe=/^(min|max)?(.+)$/,UIe=function(){function n(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return n.prototype.setOption=function(e,t,r){e&&(it(pa(e.series),function(a){a&&a.data&&du(a.data)&&SP(a.data)}),it(pa(e.dataset),function(a){a&&a.source&&du(a.source)&&SP(a.source)})),e=_i(e);var i=this._optionBackup,s=GIe(e,t,!i);this._newBaseOption=s.baseOption,i?(s.timelineOptions.length&&(i.timelineOptions=s.timelineOptions),s.mediaList.length&&(i.mediaList=s.mediaList),s.mediaDefault&&(i.mediaDefault=s.mediaDefault)):this._optionBackup=s},n.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],_i(e?t.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(e){var t,r=this._timelineOptions;if(r.length){var i=e.getComponent("timeline");i&&(t=_i(r[i.getCurrentIndex()]))}return t},n.prototype.getMediaOption=function(e){var t=this._api.getWidth(),r=this._api.getHeight(),i=this._mediaList,s=this._mediaDefault,a=[],l=[];if(!i.length&&!s)return l;for(var o=0,h=i.length;o<h;o++)VIe(i[o].query,t,r)&&a.push(o);return!a.length&&s&&(a=[-1]),a.length&&!jIe(a,this._currentMediaIndices)&&(l=xr(a,function(d){return _i(d===-1?s.option:i[d].option)})),this._currentMediaIndices=a,l},n}();function GIe(n,e,t){var r=[],i,s,a=n.baseOption,l=n.timeline,o=n.options,h=n.media,d=!!n.media,m=!!(o||l||a&&a.timeline);a?(s=a,s.timeline||(s.timeline=l)):((m||d)&&(n.options=n.media=null),s=n),d&&fr(h)&&it(h,function(y){y&&y.option&&(y.query?r.push(y):i||(i=y))}),v(s),it(o,function(y){return v(y)}),it(r,function(y){return v(y.option)});function v(y){it(e,function(S){S(y,t)})}return{baseOption:s,timelineOptions:o||[],mediaDefault:i,mediaList:r}}function VIe(n,e,t){var r={width:e,height:t,aspectratio:e/t},i=!0;return it(n,function(s,a){var l=a.match(zIe);if(!(!l||!l[1]||!l[2])){var o=l[1],h=l[2].toLowerCase();HIe(r[h],s,o)||(i=!1)}}),i}function HIe(n,e,t){return t==="min"?n>=e:t==="max"?n<=e:n===e}function jIe(n,e){return n.join(",")===e.join(",")}var Ef=it,fT=Xr,uq=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function tk(n){var e=n&&n.itemStyle;if(e)for(var t=0,r=uq.length;t<r;t++){var i=uq[t],s=e.normal,a=e.emphasis;s&&s[i]&&(n[i]=n[i]||{},n[i].normal?Di(n[i].normal,s[i]):n[i].normal=s[i],s[i]=null),a&&a[i]&&(n[i]=n[i]||{},n[i].emphasis?Di(n[i].emphasis,a[i]):n[i].emphasis=a[i],a[i]=null)}}function Gl(n,e,t){if(n&&n[e]&&(n[e].normal||n[e].emphasis)){var r=n[e].normal,i=n[e].emphasis;r&&(t?(n[e].normal=n[e].emphasis=null,ti(n[e],r)):n[e]=r),i&&(n.emphasis=n.emphasis||{},n.emphasis[e]=i,i.focus&&(n.emphasis.focus=i.focus),i.blurScope&&(n.emphasis.blurScope=i.blurScope))}}function IS(n){Gl(n,"itemStyle"),Gl(n,"lineStyle"),Gl(n,"areaStyle"),Gl(n,"label"),Gl(n,"labelLine"),Gl(n,"upperLabel"),Gl(n,"edgeLabel")}function fa(n,e){var t=fT(n)&&n[e],r=fT(t)&&t.textStyle;if(r)for(var i=0,s=d$.length;i<s;i++){var a=d$[i];r.hasOwnProperty(a)&&(t[a]=r[a])}}function mh(n){n&&(IS(n),fa(n,"label"),n.emphasis&&fa(n.emphasis,"label"))}function WIe(n){if(fT(n)){tk(n),IS(n),fa(n,"label"),fa(n,"upperLabel"),fa(n,"edgeLabel"),n.emphasis&&(fa(n.emphasis,"label"),fa(n.emphasis,"upperLabel"),fa(n.emphasis,"edgeLabel"));var e=n.markPoint;e&&(tk(e),mh(e));var t=n.markLine;t&&(tk(t),mh(t));var r=n.markArea;r&&mh(r);var i=n.data;if(n.type==="graph"){i=i||n.nodes;var s=n.links||n.edges;if(s&&!du(s))for(var a=0;a<s.length;a++)mh(s[a]);it(n.categories,function(h){IS(h)})}if(i&&!du(i))for(var a=0;a<i.length;a++)mh(i[a]);if(e=n.markPoint,e&&e.data)for(var l=e.data,a=0;a<l.length;a++)mh(l[a]);if(t=n.markLine,t&&t.data)for(var o=t.data,a=0;a<o.length;a++)fr(o[a])?(mh(o[a][0]),mh(o[a][1])):mh(o[a]);n.type==="gauge"?(fa(n,"axisLabel"),fa(n,"title"),fa(n,"detail")):n.type==="treemap"?(Gl(n.breadcrumb,"itemStyle"),it(n.levels,function(h){IS(h)})):n.type==="tree"&&IS(n.leaves)}}function mm(n){return fr(n)?n:n?[n]:[]}function hq(n){return(fr(n)?n[0]:n)||{}}function XIe(n,e){Ef(mm(n.series),function(r){fT(r)&&WIe(r)});var t=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&t.push("valueAxis","categoryAxis","logAxis","timeAxis"),Ef(t,function(r){Ef(mm(n[r]),function(i){i&&(fa(i,"axisLabel"),fa(i.axisPointer,"label"))})}),Ef(mm(n.parallel),function(r){var i=r&&r.parallelAxisDefault;fa(i,"axisLabel"),fa(i&&i.axisPointer,"label")}),Ef(mm(n.calendar),function(r){Gl(r,"itemStyle"),fa(r,"dayLabel"),fa(r,"monthLabel"),fa(r,"yearLabel")}),Ef(mm(n.radar),function(r){fa(r,"name"),r.name&&r.axisName==null&&(r.axisName=r.name,delete r.name),r.nameGap!=null&&r.axisNameGap==null&&(r.axisNameGap=r.nameGap,delete r.nameGap)}),Ef(mm(n.geo),function(r){fT(r)&&(mh(r),Ef(mm(r.regions),function(i){mh(i)}))}),Ef(mm(n.timeline),function(r){mh(r),Gl(r,"label"),Gl(r,"itemStyle"),Gl(r,"controlStyle",!0);var i=r.data;fr(i)&&it(i,function(s){Xr(s)&&(Gl(s,"label"),Gl(s,"itemStyle"))})}),Ef(mm(n.toolbox),function(r){Gl(r,"iconStyle"),Ef(r.feature,function(i){Gl(i,"iconStyle")})}),fa(hq(n.axisPointer),"label"),fa(hq(n.tooltip).axisPointer,"label")}function $Ie(n,e){for(var t=e.split(","),r=n,i=0;i<t.length&&(r=r&&r[t[i]],r!=null);i++);return r}function qIe(n,e,t,r){for(var i=e.split(","),s=n,a,l=0;l<i.length-1;l++)a=i[l],s[a]==null&&(s[a]={}),s=s[a];s[i[l]]==null&&(s[i[l]]=t)}function fq(n){n&&it(ZIe,function(e){e[0]in n&&!(e[1]in n)&&(n[e[1]]=n[e[0]])})}var ZIe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],YIe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],nk=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function Y2(n){var e=n&&n.itemStyle;if(e)for(var t=0;t<nk.length;t++){var r=nk[t][1],i=nk[t][0];e[r]!=null&&(e[i]=e[r])}}function dq(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function pq(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function KIe(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function Pse(n,e){if(n)for(var t=0;t<n.length;t++)e(n[t]),n[t]&&Pse(n[t].children,e)}function Lse(n,e){XIe(n,e),n.series=pa(n.series),it(n.series,function(t){if(Xr(t)){var r=t.type;if(r==="line")t.clipOverflow!=null&&(t.clip=t.clipOverflow);else if(r==="pie"||r==="gauge"){t.clockWise!=null&&(t.clockwise=t.clockWise),dq(t.label);var i=t.data;if(i&&!du(i))for(var s=0;s<i.length;s++)dq(i[s]);t.hoverOffset!=null&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if(r==="gauge"){var a=$Ie(t,"pointer.color");a!=null&&qIe(t,"itemStyle.color",a)}else if(r==="bar"){Y2(t),Y2(t.backgroundStyle),Y2(t.emphasis);var i=t.data;if(i&&!du(i))for(var s=0;s<i.length;s++)typeof i[s]=="object"&&(Y2(i[s]),Y2(i[s]&&i[s].emphasis))}else if(r==="sunburst"){var l=t.highlightPolicy;l&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=l)),pq(t),Pse(t.data,pq)}else r==="graph"||r==="sankey"?KIe(t):r==="map"&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&ti(t,t.mapLocation));t.hoverAnimation!=null&&(t.emphasis=t.emphasis||{},t.emphasis&&t.emphasis.scale==null&&(t.emphasis.scale=t.hoverAnimation)),fq(t)}}),n.dataRange&&(n.visualMap=n.dataRange),it(YIe,function(t){var r=n[t];r&&(fr(r)||(r=[r]),it(r,function(i){fq(i)}))})}function JIe(n){var e=ii();n.eachSeries(function(t){var r=t.get("stack");if(r){var i=e.get(r)||e.set(r,[]),s=t.getData(),a={stackResultDimension:s.getCalculationInfo("stackResultDimension"),stackedOverDimension:s.getCalculationInfo("stackedOverDimension"),stackedDimension:s.getCalculationInfo("stackedDimension"),stackedByDimension:s.getCalculationInfo("stackedByDimension"),isStackedByIndex:s.getCalculationInfo("isStackedByIndex"),data:s,seriesModel:t};if(!a.stackedDimension||!(a.isStackedByIndex||a.stackedByDimension))return;i.length&&s.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(a)}}),e.each(QIe)}function QIe(n){it(n,function(e,t){var r=[],i=[NaN,NaN],s=[e.stackResultDimension,e.stackedOverDimension],a=e.data,l=e.isStackedByIndex,o=e.seriesModel.get("stackStrategy")||"samesign";a.modify(s,function(h,d,m){var v=a.get(e.stackedDimension,m);if(isNaN(v))return i;var y,S;l?S=a.getRawIndex(m):y=a.get(e.stackedByDimension,m);for(var E=NaN,M=t-1;M>=0;M--){var C=n[M];if(l||(S=C.data.rawIndexOf(C.stackedByDimension,y)),S>=0){var L=C.data.getByRawIndex(C.stackResultDimension,S);if(o==="all"||o==="positive"&&L>0||o==="negative"&&L<0||o==="samesign"&&v>=0&&L>0||o==="samesign"&&v<=0&&L<0){v=AMe(v,L),E=L;break}}}return r[0]=v,r[1]=E,r})})}var e3=function(){function n(e){this.data=e.data||(e.sourceFormat===yp?{}:[]),this.sourceFormat=e.sourceFormat||Mse,this.seriesLayoutBy=e.seriesLayoutBy||up,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var r=0;r<t.length;r++){var i=t[r];i.type==null&&Ese(this,r)===_l.Must&&(i.type="ordinal")}}return n}();function r8(n){return n instanceof e3}function xN(n,e,t){t=t||Bse(n);var r=e.seriesLayoutBy,i=tRe(n,t,r,e.sourceHeader,e.dimensions),s=new e3({data:n,sourceFormat:t,seriesLayoutBy:r,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:_i(e)});return s}function Dse(n){return new e3({data:n,sourceFormat:du(n)?ov:Fh})}function eRe(n){return new e3({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:_i(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function Bse(n){var e=Mse;if(du(n))e=ov;else if(fr(n)){n.length===0&&(e=Rc);for(var t=0,r=n.length;t<r;t++){var i=n[t];if(i!=null){if(fr(i)||du(i)){e=Rc;break}else if(Xr(i)){e=Nh;break}}}}else if(Xr(n)){for(var s in n)if(Ym(n,s)&&Ic(n[s])){e=yp;break}}return e}function tRe(n,e,t,r,i){var s,a;if(!n)return{dimensionsDefine:mq(i),startIndex:a,dimensionsDetectedCount:s};if(e===Rc){var l=n;r==="auto"||r==null?gq(function(h){h!=null&&h!=="-"&&(Dr(h)?a==null&&(a=1):a=0)},t,l,10):a=Rs(r)?r:r?1:0,!i&&a===1&&(i=[],gq(function(h,d){i[d]=h!=null?h+"":""},t,l,1/0)),s=i?i.length:t===Iw?l.length:l[0]?l[0].length:null}else if(e===Nh)i||(i=nRe(n));else if(e===yp)i||(i=[],it(n,function(h,d){i.push(d)}));else if(e===Fh){var o=aM(n[0]);s=fr(o)&&o.length||1}return{startIndex:a,dimensionsDefine:mq(i),dimensionsDetectedCount:s}}function nRe(n){for(var e=0,t;e<n.length&&!(t=n[e++]););if(t)return so(t)}function mq(n){if(n){var e=ii();return xr(n,function(t,r){t=Xr(t)?t:{name:t};var i={name:t.name,displayName:t.displayName,type:t.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var s=e.get(i.name);return s?i.name+="-"+s.count++:e.set(i.name,{count:1}),i})}}function gq(n,e,t,r){if(e===Iw)for(var i=0;i<t.length&&i<r;i++)n(t[i]?t[i][0]:null,i);else for(var s=t[0]||[],i=0;i<s.length&&i<r;i++)n(s[i],i)}function kse(n){var e=n.sourceFormat;return e===Nh||e===yp}var Z_,Y_,K_,vq,_q,Ose=function(){function n(e,t){var r=r8(e)?e:Dse(e);this._source=r;var i=this._data=r.data;r.sourceFormat===ov&&(this._offset=0,this._dimSize=t,this._data=i),_q(this,i,r)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(e,t){},n.prototype.appendData=function(e){},n.prototype.clean=function(){},n.protoInitialize=function(){var e=n.prototype;e.pure=!1,e.persistent=!0}(),n.internalField=function(){var e;_q=function(a,l,o){var h=o.sourceFormat,d=o.seriesLayoutBy,m=o.startIndex,v=o.dimensionsDefine,y=vq[i8(h,d)];if(Jn(a,y),h===ov)a.getItem=t,a.count=i,a.fillStorage=r;else{var S=Fse(h,d);a.getItem=zs(S,null,l,m,v);var E=Nse(h,d);a.count=zs(E,null,l,m,v)}};var t=function(a,l){a=a-this._offset,l=l||[];for(var o=this._data,h=this._dimSize,d=h*a,m=0;m<h;m++)l[m]=o[d+m];return l},r=function(a,l,o,h){for(var d=this._data,m=this._dimSize,v=0;v<m;v++){for(var y=h[v],S=y[0]==null?1/0:y[0],E=y[1]==null?-1/0:y[1],M=l-a,C=o[v],L=0;L<M;L++){var k=d[L*m+v];C[a+L]=k,k<S&&(S=k),k>E&&(E=k)}y[0]=S,y[1]=E}},i=function(){return this._data?this._data.length/this._dimSize:0};vq=(e={},e[Rc+"_"+up]={pure:!0,appendData:s},e[Rc+"_"+Iw]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[Nh]={pure:!0,appendData:s},e[yp]={pure:!0,appendData:function(a){var l=this._data;it(a,function(o,h){for(var d=l[h]||(l[h]=[]),m=0;m<(o||[]).length;m++)d.push(o[m])})}},e[Fh]={appendData:s},e[ov]={persistent:!1,pure:!0,appendData:function(a){this._data=a},clean:function(){this._offset+=this.count(),this._data=null}},e);function s(a){for(var l=0;l<a.length;l++)this._data.push(a[l])}}(),n}(),yq=function(n,e,t,r){return n[r]},rRe=(Z_={},Z_[Rc+"_"+up]=function(n,e,t,r){return n[r+e]},Z_[Rc+"_"+Iw]=function(n,e,t,r,i){r+=e;for(var s=i||[],a=n,l=0;l<a.length;l++){var o=a[l];s[l]=o?o[r]:null}return s},Z_[Nh]=yq,Z_[yp]=function(n,e,t,r,i){for(var s=i||[],a=0;a<t.length;a++){var l=t[a].name,o=n[l];s[a]=o?o[r]:null}return s},Z_[Fh]=yq,Z_);function Fse(n,e){var t=rRe[i8(n,e)];return t}var xq=function(n,e,t){return n.length},iRe=(Y_={},Y_[Rc+"_"+up]=function(n,e,t){return Math.max(0,n.length-e)},Y_[Rc+"_"+Iw]=function(n,e,t){var r=n[0];return r?Math.max(0,r.length-e):0},Y_[Nh]=xq,Y_[yp]=function(n,e,t){var r=t[0].name,i=n[r];return i?i.length:0},Y_[Fh]=xq,Y_);function Nse(n,e){var t=iRe[i8(n,e)];return t}var rk=function(n,e,t){return n[e]},sRe=(K_={},K_[Rc]=rk,K_[Nh]=function(n,e,t){return n[t]},K_[yp]=rk,K_[Fh]=function(n,e,t){var r=aM(n);return r instanceof Array?r[e]:r},K_[ov]=rk,K_);function zse(n){var e=sRe[n];return e}function i8(n,e){return n===Rc?n+"_"+e:n}function ow(n,e,t){if(n){var r=n.getRawDataItem(e);if(r!=null){var i=n.getStore(),s=i.getSource().sourceFormat;if(t!=null){var a=n.getDimensionIndex(t),l=i.getDimensionProperty(a);return zse(s)(r,a,l)}else{var o=r;return s===Fh&&(o=aM(r)),o}}}}var oRe=/\{@(.+?)\}/g,aRe=function(){function n(){}return n.prototype.getDataParams=function(e,t){var r=this.getData(t),i=this.getRawValue(e,t),s=r.getRawIndex(e),a=r.getName(e),l=r.getRawDataItem(e),o=r.getItemVisual(e,"style"),h=o&&o[r.getItemVisual(e,"drawType")||"fill"],d=o&&o.stroke,m=this.mainType,v=m==="series",y=r.userOutput&&r.userOutput.get();return{componentType:m,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:v?this.subType:null,seriesIndex:this.seriesIndex,seriesId:v?this.id:null,seriesName:v?this.name:null,name:a,dataIndex:s,data:l,dataType:t,value:i,color:h,borderColor:d,dimensionNames:y?y.fullDimensions:null,encode:y?y.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(e,t,r,i,s,a){t=t||"normal";var l=this.getData(r),o=this.getDataParams(e,r);if(a&&(o.value=a.interpolatedValue),i!=null&&fr(o.value)&&(o.value=o.value[i]),!s){var h=l.getItemModel(e);s=h.get(t==="normal"?["label","formatter"]:[t,"label","formatter"])}if(ci(s))return o.status=t,o.dimensionIndex=i,s(o);if(Dr(s)){var d=Sse(s,o);return d.replace(oRe,function(m,v){var y=v.length,S=v;S.charAt(0)==="["&&S.charAt(y-1)==="]"&&(S=+S.slice(1,y-1));var E=ow(l,e,S);if(a&&fr(a.interpolatedValue)){var M=l.getDimensionIndex(S);M>=0&&(E=a.interpolatedValue[M])}return E!=null?E+"":""})}},n.prototype.getRawValue=function(e,t){return ow(this.getData(t),e)},n.prototype.formatTooltip=function(e,t,r){},n}();function bq(n){var e,t;return Xr(n)?n.type&&(t=n):e=n,{text:e,frag:t}}function fA(n){return new lRe(n)}var lRe=function(){function n(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return n.prototype.perform=function(e){var t=this._upstream,r=e&&e.skip;if(this._dirty&&t){var i=this.context;i.data=i.outputData=t.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var s;this._plan&&!r&&(s=this._plan(this.context));var a=d(this._modBy),l=this._modDataCount||0,o=d(e&&e.modBy),h=e&&e.modDataCount||0;(a!==o||l!==h)&&(s="reset");function d(L){return!(L>=1)&&(L=1),L}var m;(this._dirty||s==="reset")&&(this._dirty=!1,m=this._doReset(r)),this._modBy=o,this._modDataCount=h;var v=e&&e.step;if(t?this._dueEnd=t._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var y=this._dueIndex,S=Math.min(v!=null?this._dueIndex+v:1/0,this._dueEnd);if(!r&&(m||y<S)){var E=this._progress;if(fr(E))for(var M=0;M<E.length;M++)this._doProgress(E[M],y,S,o,h);else this._doProgress(E,y,S,o,h)}this._dueIndex=S;var C=this._settedOutputEnd!=null?this._settedOutputEnd:S;this._outputDueEnd=C}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(e,t,r,i,s){wq.reset(t,r,i,s),this._callingProgress=e,this._callingProgress({start:t,end:r,count:r-t,next:wq.next},this.context)},n.prototype._doReset=function(e){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var t,r;!e&&this._reset&&(t=this._reset(this.context),t&&t.progress&&(r=t.forceFirstProgress,t=t.progress),fr(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),r},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},n}(),wq=function(){var n,e,t,r,i,s={reset:function(o,h,d,m){e=o,n=h,t=d,r=m,i=Math.ceil(r/t),s.next=t>1&&r>0?l:a}};return s;function a(){return e<n?e++:null}function l(){var o=e%i*t+Math.ceil(e/i),h=e>=n?null:o<r?o:e;return e++,h}}();function iR(n,e){var t=e&&e.type;return t==="ordinal"?n:(t==="time"&&!Rs(n)&&n!=null&&n!=="-"&&(n=+Km(n)),n==null||n===""?NaN:Number(n))}var cRe=ii({number:function(n){return parseFloat(n)},time:function(n){return+Km(n)},trim:function(n){return Dr(n)?tp(n):n}});function Use(n){return cRe.get(n)}var Gse={lt:function(n,e){return n<e},lte:function(n,e){return n<=e},gt:function(n,e){return n>e},gte:function(n,e){return n>=e}},uRe=function(){function n(e,t){if(!Rs(t)){var r="";as(r)}this._opFn=Gse[e],this._rvalFloat=vv(t)}return n.prototype.evaluate=function(e){return Rs(e)?this._opFn(e,this._rvalFloat):this._opFn(vv(e),this._rvalFloat)},n}(),Vse=function(){function n(e,t){var r=e==="desc";this._resultLT=r?1:-1,t==null&&(t=r?"min":"max"),this._incomparable=t==="min"?-1/0:1/0}return n.prototype.evaluate=function(e,t){var r=Rs(e)?e:vv(e),i=Rs(t)?t:vv(t),s=isNaN(r),a=isNaN(i);if(s&&(r=this._incomparable),a&&(i=this._incomparable),s&&a){var l=Dr(e),o=Dr(t);l&&(r=o?e:0),o&&(i=l?t:0)}return r<i?this._resultLT:r>i?-this._resultLT:0},n}(),hRe=function(){function n(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=vv(t)}return n.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var r=typeof e;r!==this._rvalTypeof&&(r==="number"||this._rvalTypeof==="number")&&(t=vv(e)===this._rvalFloat)}return this._isEQ?t:!t},n}();function fRe(n,e){return n==="eq"||n==="ne"?new hRe(n==="eq",e):Ym(Gse,n)?new uRe(n,e):null}var dRe=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(e){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(e){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(e,t){},n.prototype.retrieveValueFromItem=function(e,t){},n.prototype.convertValue=function(e,t){return iR(e,t)},n}();function pRe(n,e){var t=new dRe,r=n.data,i=t.sourceFormat=n.sourceFormat,s=n.startIndex,a="";n.seriesLayoutBy!==up&&as(a);var l=[],o={},h=n.dimensionsDefine;if(h)it(h,function(E,M){var C=E.name,L={index:M,name:C,displayName:E.displayName};if(l.push(L),C!=null){var k="";Ym(o,C)&&as(k),o[C]=L}});else for(var d=0;d<n.dimensionsDetectedCount;d++)l.push({index:d});var m=Fse(i,up);e.__isBuiltIn&&(t.getRawDataItem=function(E){return m(r,s,l,E)},t.getRawData=zs(mRe,null,n)),t.cloneRawData=zs(gRe,null,n);var v=Nse(i,up);t.count=zs(v,null,r,s,l);var y=zse(i);t.retrieveValue=function(E,M){var C=m(r,s,l,E);return S(C,M)};var S=t.retrieveValueFromItem=function(E,M){if(E!=null){var C=l[M];if(C)return y(E,M,C.name)}};return t.getDimensionInfo=zs(vRe,null,l,o),t.cloneAllDimensionInfo=zs(_Re,null,l),t}function mRe(n){var e=n.sourceFormat;if(!s8(e)){var t="";as(t)}return n.data}function gRe(n){var e=n.sourceFormat,t=n.data;if(!s8(e)){var r="";as(r)}if(e===Rc){for(var i=[],s=0,a=t.length;s<a;s++)i.push(t[s].slice());return i}else if(e===Nh){for(var i=[],s=0,a=t.length;s<a;s++)i.push(Jn({},t[s]));return i}}function vRe(n,e,t){if(t!=null){if(Rs(t)||!isNaN(t)&&!Ym(e,t))return n[t];if(Ym(e,t))return e[t]}}function _Re(n){return _i(n)}var Hse=ii();function yRe(n){n=_i(n);var e=n.type,t="";e||as(t);var r=e.split(":");r.length!==2&&as(t);var i=!1;r[0]==="echarts"&&(e=r[1],i=!0),n.__isBuiltIn=i,Hse.set(e,n)}function xRe(n,e,t){var r=pa(n),i=r.length,s="";i||as(s);for(var a=0,l=i;a<l;a++){var o=r[a];e=bRe(o,e),a!==l-1&&(e.length=Math.max(e.length,1))}return e}function bRe(n,e,t,r){var i="";e.length||as(i),Xr(n)||as(i);var s=n.type,a=Hse.get(s);a||as(i);var l=xr(e,function(h){return pRe(h,a)}),o=pa(a.transform({upstream:l[0],upstreamList:l,config:_i(n.config)}));return xr(o,function(h,d){var m="";Xr(h)||as(m),h.data||as(m);var v=Bse(h.data);s8(v)||as(m);var y,S=e[0];if(S&&d===0&&!h.dimensions){var E=S.startIndex;E&&(h.data=S.data.slice(0,E).concat(h.data)),y={seriesLayoutBy:up,sourceHeader:E,dimensions:S.metaRawOption.dimensions}}else y={seriesLayoutBy:up,sourceHeader:0,dimensions:h.dimensions};return xN(h.data,y,null)})}function s8(n){return n===Rc||n===Nh}var t3="undefined",wRe=typeof Uint32Array===t3?Array:Uint32Array,SRe=typeof Uint16Array===t3?Array:Uint16Array,jse=typeof Int32Array===t3?Array:Int32Array,Sq=typeof Float64Array===t3?Array:Float64Array,Wse={float:Sq,int:jse,ordinal:Array,number:Array,time:Sq},ik;function K2(n){return n>65535?wRe:SRe}function kx(){return[1/0,-1/0]}function ARe(n){var e=n.constructor;return e===Array?n.slice():new e(n)}function Aq(n,e,t,r,i){var s=Wse[t||"float"];if(i){var a=n[e],l=a&&a.length;if(l!==r){for(var o=new s(r),h=0;h<l;h++)o[h]=a[h];n[e]=o}}else n[e]=new s(r)}var bN=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=ii()}return n.prototype.initData=function(e,t,r){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=e.getSource(),s=this.defaultDimValueGetter=ik[i.sourceFormat];this._dimValueGetter=r||s,this._rawExtent=[],kse(i),this._dimensions=xr(t,function(a){return{type:a.type,property:a.property}}),this._initDataFromProvider(0,e.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(e,t){var r=this._calcDimNameToIdx,i=this._dimensions,s=r.get(e);if(s!=null){if(i[s].type===t)return s}else s=i.length;return i[s]={type:t},r.set(e,s),this._chunks[s]=new Wse[t||"float"](this._rawCount),this._rawExtent[s]=kx(),s},n.prototype.collectOrdinalMeta=function(e,t){var r=this._chunks[e],i=this._dimensions[e],s=this._rawExtent,a=i.ordinalOffset||0,l=r.length;a===0&&(s[e]=kx());for(var o=s[e],h=a;h<l;h++){var d=r[h]=t.parseAndCollect(r[h]);isNaN(d)||(o[0]=Math.min(d,o[0]),o[1]=Math.max(d,o[1]))}i.ordinalMeta=t,i.ordinalOffset=l,i.type="ordinal"},n.prototype.getOrdinalMeta=function(e){var t=this._dimensions[e],r=t.ordinalMeta;return r},n.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},n.prototype.appendData=function(e){var t=this._provider,r=this.count();t.appendData(e);var i=t.count();return t.persistent||(i+=r),r<i&&this._initDataFromProvider(r,i,!0),[r,i]},n.prototype.appendValues=function(e,t){for(var r=this._chunks,i=this._dimensions,s=i.length,a=this._rawExtent,l=this.count(),o=l+Math.max(e.length,t||0),h=0;h<s;h++){var d=i[h];Aq(r,h,d.type,o,!0)}for(var m=[],v=l;v<o;v++)for(var y=v-l,S=0;S<s;S++){var d=i[S],E=ik.arrayRows.call(this,e[y]||m,d.property,y,S);r[S][v]=E;var M=a[S];E<M[0]&&(M[0]=E),E>M[1]&&(M[1]=E)}return this._rawCount=this._count=o,{start:l,end:o}},n.prototype._initDataFromProvider=function(e,t,r){for(var i=this._provider,s=this._chunks,a=this._dimensions,l=a.length,o=this._rawExtent,h=xr(a,function(L){return L.property}),d=0;d<l;d++){var m=a[d];o[d]||(o[d]=kx()),Aq(s,d,m.type,t,r)}if(i.fillStorage)i.fillStorage(e,t,s,o);else for(var v=[],y=e;y<t;y++){v=i.getItem(y,v);for(var S=0;S<l;S++){var E=s[S],M=this._dimValueGetter(v,h[S],y,S);E[y]=M;var C=o[S];M<C[0]&&(C[0]=M),M>C[1]&&(C[1]=M)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=t,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var r=this._chunks[e];return r?r[this.getRawIndex(t)]:NaN},n.prototype.getValues=function(e,t){var r=[],i=[];if(t==null){t=e,e=[];for(var s=0;s<this._dimensions.length;s++)i.push(s)}else i=e;for(var s=0,a=i.length;s<a;s++)r.push(this.get(i[s],t));return r},n.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var r=this._chunks[e];return r?r[t]:NaN},n.prototype.getSum=function(e){var t=this._chunks[e],r=0;if(t)for(var i=0,s=this.count();i<s;i++){var a=this.get(e,i);isNaN(a)||(r+=a)}return r},n.prototype.getMedian=function(e){var t=[];this.each([e],function(s){isNaN(s)||t.push(s)});var r=t.sort(function(s,a){return s-a}),i=this.count();return i===0?0:i%2===1?r[(i-1)/2]:(r[i/2]+r[i/2-1])/2},n.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,r=t[e];if(r!=null&&r<this._count&&r===e)return e;for(var i=0,s=this._count-1;i<=s;){var a=(i+s)/2|0;if(t[a]<e)i=a+1;else if(t[a]>e)s=a-1;else return a}return-1},n.prototype.indicesOfNearest=function(e,t,r){var i=this._chunks,s=i[e],a=[];if(!s)return a;r==null&&(r=1/0);for(var l=1/0,o=-1,h=0,d=0,m=this.count();d<m;d++){var v=this.getRawIndex(d),y=t-s[v],S=Math.abs(y);S<=r&&((S<l||S===l&&y>=0&&o<0)&&(l=S,o=y,h=0),y===o&&(a[h++]=d))}return a.length=h,a},n.prototype.getIndices=function(){var e,t=this._indices;if(t){var r=t.constructor,i=this._count;if(r===Array){e=new r(i);for(var s=0;s<i;s++)e[s]=t[s]}else e=new r(t.buffer,0,i)}else{var r=K2(this._rawCount);e=new r(this.count());for(var s=0;s<e.length;s++)e[s]=s}return e},n.prototype.filter=function(e,t){if(!this._count)return this;for(var r=this.clone(),i=r.count(),s=K2(r._rawCount),a=new s(i),l=[],o=e.length,h=0,d=e[0],m=r._chunks,v=0;v<i;v++){var y=void 0,S=r.getRawIndex(v);if(o===0)y=t(v);else if(o===1){var E=m[d][S];y=t(E,v)}else{for(var M=0;M<o;M++)l[M]=m[e[M]][S];l[M]=v,y=t.apply(null,l)}y&&(a[h++]=S)}return h<i&&(r._indices=a),r._count=h,r._extent=[],r._updateGetRawIdx(),r},n.prototype.selectRange=function(e){var t=this.clone(),r=t._count;if(!r)return this;var i=so(e),s=i.length;if(!s)return this;var a=t.count(),l=K2(t._rawCount),o=new l(a),h=0,d=i[0],m=e[d][0],v=e[d][1],y=t._chunks,S=!1;if(!t._indices){var E=0;if(s===1){for(var M=y[i[0]],C=0;C<r;C++){var L=M[C];(L>=m&&L<=v||isNaN(L))&&(o[h++]=E),E++}S=!0}else if(s===2){for(var M=y[i[0]],k=y[i[1]],H=e[i[1]][0],q=e[i[1]][1],C=0;C<r;C++){var L=M[C],Z=k[C];(L>=m&&L<=v||isNaN(L))&&(Z>=H&&Z<=q||isNaN(Z))&&(o[h++]=E),E++}S=!0}}if(!S)if(s===1)for(var C=0;C<a;C++){var ee=t.getRawIndex(C),L=y[i[0]][ee];(L>=m&&L<=v||isNaN(L))&&(o[h++]=ee)}else for(var C=0;C<a;C++){for(var re=!0,ee=t.getRawIndex(C),se=0;se<s;se++){var ae=i[se],L=y[ae][ee];(L<e[ae][0]||L>e[ae][1])&&(re=!1)}re&&(o[h++]=t.getRawIndex(C))}return h<a&&(t._indices=o),t._count=h,t._extent=[],t._updateGetRawIdx(),t},n.prototype.map=function(e,t){var r=this.clone(e);return this._updateDims(r,e,t),r},n.prototype.modify=function(e,t){this._updateDims(this,e,t)},n.prototype._updateDims=function(e,t,r){for(var i=e._chunks,s=[],a=t.length,l=e.count(),o=[],h=e._rawExtent,d=0;d<t.length;d++)h[t[d]]=kx();for(var m=0;m<l;m++){for(var v=e.getRawIndex(m),y=0;y<a;y++)o[y]=i[t[y]][v];o[a]=m;var S=r&&r.apply(null,o);if(S!=null){typeof S!="object"&&(s[0]=S,S=s);for(var d=0;d<S.length;d++){var E=t[d],M=S[d],C=h[E],L=i[E];L&&(L[v]=M),M<C[0]&&(C[0]=M),M>C[1]&&(C[1]=M)}}}},n.prototype.lttbDownSample=function(e,t){var r=this.clone([e],!0),i=r._chunks,s=i[e],a=this.count(),l=0,o=Math.floor(1/t),h=this.getRawIndex(0),d,m,v,y=new(K2(this._rawCount))(Math.min((Math.ceil(a/o)+2)*2,a));y[l++]=h;for(var S=1;S<a-1;S+=o){for(var E=Math.min(S+o,a-1),M=Math.min(S+o*2,a),C=(M+E)/2,L=0,k=E;k<M;k++){var H=this.getRawIndex(k),q=s[H];isNaN(q)||(L+=q)}L/=M-E;var Z=S,ee=Math.min(S+o,a),re=S-1,se=s[h];d=-1,v=Z;for(var ae=-1,fe=0,k=Z;k<ee;k++){var H=this.getRawIndex(k),q=s[H];if(isNaN(q)){fe++,ae<0&&(ae=H);continue}m=Math.abs((re-C)*(q-se)-(re-k)*(L-se)),m>d&&(d=m,v=H)}fe>0&&fe<ee-Z&&(y[l++]=Math.min(ae,v),v=Math.max(ae,v)),y[l++]=v,h=v}return y[l++]=this.getRawIndex(a-1),r._count=l,r._indices=y,r.getRawIndex=this._getRawIdx,r},n.prototype.downSample=function(e,t,r,i){for(var s=this.clone([e],!0),a=s._chunks,l=[],o=Math.floor(1/t),h=a[e],d=this.count(),m=s._rawExtent[e]=kx(),v=new(K2(this._rawCount))(Math.ceil(d/o)),y=0,S=0;S<d;S+=o){o>d-S&&(o=d-S,l.length=o);for(var E=0;E<o;E++){var M=this.getRawIndex(S+E);l[E]=h[M]}var C=r(l),L=this.getRawIndex(Math.min(S+i(l,C)||0,d-1));h[L]=C,C<m[0]&&(m[0]=C),C>m[1]&&(m[1]=C),v[y++]=L}return s._count=y,s._indices=v,s._updateGetRawIdx(),s},n.prototype.each=function(e,t){if(this._count)for(var r=e.length,i=this._chunks,s=0,a=this.count();s<a;s++){var l=this.getRawIndex(s);switch(r){case 0:t(s);break;case 1:t(i[e[0]][l],s);break;case 2:t(i[e[0]][l],i[e[1]][l],s);break;default:for(var o=0,h=[];o<r;o++)h[o]=i[e[o]][l];h[o]=s,t.apply(null,h)}}},n.prototype.getDataExtent=function(e){var t=this._chunks[e],r=kx();if(!t)return r;var i=this.count(),s=!this._indices,a;if(s)return this._rawExtent[e].slice();if(a=this._extent[e],a)return a.slice();a=r;for(var l=a[0],o=a[1],h=0;h<i;h++){var d=this.getRawIndex(h),m=t[d];m<l&&(l=m),m>o&&(o=m)}return a=[l,o],this._extent[e]=a,a},n.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var r=[],i=this._chunks,s=0;s<i.length;s++)r.push(i[s][t]);return r},n.prototype.clone=function(e,t){var r=new n,i=this._chunks,s=e&&pv(e,function(l,o){return l[o]=!0,l},{});if(s)for(var a=0;a<i.length;a++)r._chunks[a]=s[a]?ARe(i[a]):i[a];else r._chunks=i;return this._copyCommonProps(r),t||(r._indices=this._cloneIndices()),r._updateGetRawIdx(),r},n.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=_i(this._extent),e._rawExtent=_i(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var r=this._indices.length;t=new e(r);for(var i=0;i<r;i++)t[i]=this._indices[i]}else t=new e(this._indices);return t}return null},n.prototype._getRawIdxIdentity=function(e){return e},n.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function e(t,r,i,s){return iR(t[s],this._dimensions[s])}ik={arrayRows:e,objectRows:function(t,r,i,s){return iR(t[r],this._dimensions[s])},keyedColumns:e,original:function(t,r,i,s){var a=t&&(t.value==null?t:t.value);return iR(a instanceof Array?a[s]:a,this._dimensions[s])},typedArray:function(t,r,i,s){return t[s]}}}(),n}(),Xse=function(){function n(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var e=this._sourceHost,t=this._getUpstreamSourceManagers(),r=!!t.length,i,s;if($E(e)){var a=e,l=void 0,o=void 0,h=void 0;if(r){var d=t[0];d.prepareSource(),h=d.getSource(),l=h.data,o=h.sourceFormat,s=[d._getVersionSign()]}else l=a.get("data",!0),o=du(l)?ov:Fh,s=[];var m=this._getSourceMetaRawOption()||{},v=h&&h.metaRawOption||{},y=Ei(m.seriesLayoutBy,v.seriesLayoutBy)||null,S=Ei(m.sourceHeader,v.sourceHeader),E=Ei(m.dimensions,v.dimensions),M=y!==v.seriesLayoutBy||!!S!=!!v.sourceHeader||E;i=M?[xN(l,{seriesLayoutBy:y,sourceHeader:S,dimensions:E},o)]:[]}else{var C=e;if(r){var L=this._applyTransform(t);i=L.sourceList,s=L.upstreamSignList}else{var k=C.get("source",!0);i=[xN(k,this._getSourceMetaRawOption(),null)],s=[]}}this._setLocalSource(i,s)},n.prototype._applyTransform=function(e){var t=this._sourceHost,r=t.get("transform",!0),i=t.get("fromTransformResult",!0);if(i!=null){var s="";e.length!==1&&Mq(s)}var a,l=[],o=[];return it(e,function(h){h.prepareSource();var d=h.getSource(i||0),m="";i!=null&&!d&&Mq(m),l.push(d),o.push(h._getVersionSign())}),r?a=xRe(r,l,{datasetIndex:t.componentIndex}):i!=null&&(a=[eRe(l[0])]),{sourceList:a,upstreamSignList:o}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var r=e[t];if(r._isDirty()||this._upstreamSignList[t]!==r._getVersionSign())return!0}},n.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var r=this._getUpstreamSourceManagers();return r[0]&&r[0].getSource(e)}return t},n.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},n.prototype._innerGetDataStore=function(e,t,r){var i=0,s=this._storeList,a=s[i];a||(a=s[i]={});var l=a[r];if(!l){var o=this._getUpstreamSourceManagers()[0];$E(this._sourceHost)&&o?l=o._innerGetDataStore(e,t,r):(l=new bN,l.initData(new Ose(t,e.length),e)),a[r]=l}return l},n.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if($E(e)){var t=QU(e);return t?[t.getSourceManager()]:[]}else return xr(IIe(e),function(r){return r.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var e=this._sourceHost,t,r,i;if($E(e))t=e.get("seriesLayoutBy",!0),r=e.get("sourceHeader",!0),i=e.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var s=e;t=s.get("seriesLayoutBy",!0),r=s.get("sourceHeader",!0),i=s.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:r,dimensions:i}},n}();function Tq(n){var e=n.option.transform;e&&SP(n.option.transform)}function $E(n){return n.mainType==="series"}function Mq(n){throw new Error(n)}var $se="line-height:1";function qse(n,e){var t=n.color||"#6e7079",r=n.fontSize||12,i=n.fontWeight||"400",s=n.color||"#464646",a=n.fontSize||14,l=n.fontWeight||"900";return e==="html"?{nameStyle:"font-size:"+Pu(r+"")+"px;color:"+Pu(t)+";font-weight:"+Pu(i+""),valueStyle:"font-size:"+Pu(a+"")+"px;color:"+Pu(s)+";font-weight:"+Pu(l+"")}:{nameStyle:{fontSize:r,fill:t,fontWeight:i},valueStyle:{fontSize:a,fill:s,fontWeight:l}}}var TRe=[0,10,20,30],MRe=["",`
`,`

`,`


`];function dT(n,e){return e.type=n,e}function wN(n){return n.type==="section"}function Zse(n){return wN(n)?CRe:ERe}function Yse(n){if(wN(n)){var e=0,t=n.blocks.length,r=t>1||t>0&&!n.noHeader;return it(n.blocks,function(i){var s=Yse(i);s>=e&&(e=s+ +(r&&(!s||wN(i)&&!i.noHeader)))}),e}return 0}function CRe(n,e,t,r){var i=e.noHeader,s=IRe(Yse(e)),a=[],l=e.blocks||[];pp(!l||fr(l)),l=l||[];var o=n.orderMode;if(e.sortBlocks&&o){l=l.slice();var h={valueAsc:"asc",valueDesc:"desc"};if(Ym(h,o)){var d=new Vse(h[o],null);l.sort(function(S,E){return d.evaluate(S.sortParam,E.sortParam)})}else o==="seriesDesc"&&l.reverse()}it(l,function(S,E){var M=e.valueFormatter,C=Zse(S)(M?Jn(Jn({},n),{valueFormatter:M}):n,S,E>0?s.html:0,r);C!=null&&a.push(C)});var m=n.renderMode==="richText"?a.join(s.richText):SN(a.join(""),i?t:s.html);if(i)return m;var v=_N(e.header,"ordinal",n.useUTC),y=qse(r,n.renderMode).nameStyle;return n.renderMode==="richText"?Kse(n,v,y)+s.richText+m:SN('<div style="'+y+";"+$se+';">'+Pu(v)+"</div>"+m,t)}function ERe(n,e,t,r){var i=n.renderMode,s=e.noName,a=e.noValue,l=!e.markerType,o=e.name,h=n.useUTC,d=e.valueFormatter||n.valueFormatter||function(H){return H=fr(H)?H:[H],xr(H,function(q,Z){return _N(q,fr(y)?y[Z]:y,h)})};if(!(s&&a)){var m=l?"":n.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",i),v=s?"":_N(o,"ordinal",h),y=e.valueType,S=a?[]:d(e.value,e.dataIndex),E=!l||!s,M=!l&&s,C=qse(r,i),L=C.nameStyle,k=C.valueStyle;return i==="richText"?(l?"":m)+(s?"":Kse(n,v,L))+(a?"":LRe(n,S,E,M,k)):SN((l?"":m)+(s?"":RRe(v,!l,L))+(a?"":PRe(S,E,M,k)),t)}}function Cq(n,e,t,r,i,s){if(n){var a=Zse(n),l={useUTC:i,renderMode:t,orderMode:r,markupStyleCreator:e,valueFormatter:n.valueFormatter};return a(l,n,0,s)}}function IRe(n){return{html:TRe[n],richText:MRe[n]}}function SN(n,e){var t='<div style="clear:both"></div>',r="margin: "+e+"px 0 0";return'<div style="'+r+";"+$se+';">'+n+t+"</div>"}function RRe(n,e,t){var r=e?"margin-left:2px":"";return'<span style="'+t+";"+r+'">'+Pu(n)+"</span>"}function PRe(n,e,t,r){var i=t?"10px":"20px",s=e?"float:right;margin-left:"+i:"";return n=fr(n)?n:[n],'<span style="'+s+";"+r+'">'+xr(n,function(a){return Pu(a)}).join("&nbsp;&nbsp;")+"</span>"}function Kse(n,e,t){return n.markupStyleCreator.wrapRichTextStyle(e,t)}function LRe(n,e,t,r,i){var s=[i],a=r?10:20;return t&&s.push({padding:[0,0,0,a],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(fr(e)?e.join("  "):e,s)}function DRe(n,e){var t=n.getData().getItemVisual(e,"style"),r=t[n.visualDrawType];return s1(r)}function Jse(n,e){var t=n.get("padding");return t??(e==="richText"?[8,10]:10)}var sk=function(){function n(){this.richTextStyles={},this._nextStyleNameId=lie()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(e,t,r){var i=r==="richText"?this._generateStyleName():null,s=yIe({color:t,type:e,renderMode:r,markerId:i});return Dr(s)?s:(this.richTextStyles[i]=s.style,s.content)},n.prototype.wrapRichTextStyle=function(e,t){var r={};fr(t)?it(t,function(s){return Jn(r,s)}):Jn(r,t);var i=this._generateStyleName();return this.richTextStyles[i]=r,"{"+i+"|"+e+"}"},n}();function BRe(n){var e=n.series,t=n.dataIndex,r=n.multipleSeries,i=e.getData(),s=i.mapDimensionsAll("defaultedTooltip"),a=s.length,l=e.getRawValue(t),o=fr(l),h=DRe(e,t),d,m,v,y;if(a>1||o&&!a){var S=kRe(l,e,t,s,h);d=S.inlineValues,m=S.inlineValueTypes,v=S.blocks,y=S.inlineValues[0]}else if(a){var E=i.getDimensionInfo(s[0]);y=d=ow(i,t,s[0]),m=E.type}else y=d=o?l[0]:l;var M=LU(e),C=M&&e.name||"",L=i.getName(t),k=r?C:L;return dT("section",{header:C,noHeader:r||!M,sortParam:y,blocks:[dT("nameValue",{markerType:"item",markerColor:h,name:k,noName:!tp(k),value:d,valueType:m,dataIndex:t})].concat(v||[])})}function kRe(n,e,t,r,i){var s=e.getData(),a=pv(n,function(m,v,y){var S=s.getDimensionInfo(y);return m=m||S&&S.tooltip!==!1&&S.displayName!=null},!1),l=[],o=[],h=[];r.length?it(r,function(m){d(ow(s,t,m),m)}):it(n,d);function d(m,v){var y=s.getDimensionInfo(v);!y||y.otherDims.tooltip===!1||(a?h.push(dT("nameValue",{markerType:"subItem",markerColor:i,name:y.displayName,value:m,valueType:y.type})):(l.push(m),o.push(y.type)))}return{inlineValues:l,inlineValueTypes:o,blocks:h}}var y0=$s();function qE(n,e){return n.getName(e)||n.getId(e)}var sR="__universalTransitionEnabled",Jf=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}return e.prototype.init=function(t,r,i){this.seriesIndex=this.componentIndex,this.dataTask=fA({count:FRe,reset:NRe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,i);var s=y0(this).sourceManager=new Xse(this);s.prepareSource();var a=this.getInitialData(t,i);Iq(a,this),this.dataTask.context.data=a,y0(this).dataBeforeProcessed=a,Eq(this),this._initSelectedMapFromData(a)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=hT(this),s=i?QD(t):{},a=this.subType;os.hasClass(a)&&(a+="Series"),Di(t,r.getTheme().get(this.subType)),Di(t,this.getDefaultOption()),oN(t,"label",["show"]),this.fillDataTextStyle(t.data),i&&sw(t,s,i)},e.prototype.mergeOption=function(t,r){t=Di(this.option,t,!0),this.fillDataTextStyle(t.data);var i=hT(this);i&&sw(this.option,t,i);var s=y0(this).sourceManager;s.dirty(),s.prepareSource();var a=this.getInitialData(t,r);Iq(a,this),this.dataTask.dirty(),this.dataTask.context.data=a,y0(this).dataBeforeProcessed=a,Eq(this),this._initSelectedMapFromData(a)},e.prototype.fillDataTextStyle=function(t){if(t&&!du(t))for(var r=["show"],i=0;i<t.length;i++)t[i]&&t[i].label&&oN(t[i],"label",r)},e.prototype.getInitialData=function(t,r){},e.prototype.appendData=function(t){var r=this.getRawData();r.appendData(t.data)},e.prototype.getData=function(t){var r=AN(this);if(r){var i=r.context.data;return t==null||!i.getLinkedData?i:i.getLinkedData(t)}else return y0(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var r=AN(this);if(r){var i=r.context;i.outputData=t,r!==this.dataTask&&(i.data=t)}y0(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return ii(t)},e.prototype.getSourceManager=function(){return y0(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return y0(this).dataBeforeProcessed},e.prototype.getColorBy=function(){var t=this.get("colorBy");return t||"series"},e.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.formatTooltip=function(t,r,i){return BRe({series:this,dataIndex:t,multipleSeries:r})},e.prototype.isAnimationEnabled=function(){var t=this.ecModel;if(mi.node&&!(t&&t.ssr))return!1;var r=this.getShallow("animation");return r&&this.getData().count()>this.getShallow("animationThreshold")&&(r=!1),!!r},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,r,i){var s=this.ecModel,a=e8.prototype.getColorFromPalette.call(this,t,r,i);return a||(a=s.getColorFromPalette(t,r,i)),a},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,r){this._innerSelect(this.getData(r),t)},e.prototype.unselect=function(t,r){var i=this.option.selectedMap;if(i){var s=this.option.selectedMode,a=this.getData(r);if(s==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var l=0;l<t.length;l++){var o=t[l],h=qE(a,o);i[h]=!1,this._selectedDataIndicesMap[h]=-1}}},e.prototype.toggleSelect=function(t,r){for(var i=[],s=0;s<t.length;s++)i[0]=t[s],this.isSelected(t[s],r)?this.unselect(i,r):this.select(i,r)},e.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var t=this._selectedDataIndicesMap,r=so(t),i=[],s=0;s<r.length;s++){var a=t[r[s]];a>=0&&i.push(a)}return i},e.prototype.isSelected=function(t,r){var i=this.option.selectedMap;if(!i)return!1;var s=this.getData(r);return(i==="all"||i[qE(s,t)])&&!s.getItemModel(t).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this[sR])return!0;var t=this.option.universalTransition;return t?t===!0?!0:t&&t.enabled:!1},e.prototype._innerSelect=function(t,r){var i,s,a=this.option,l=a.selectedMode,o=r.length;if(!(!l||!o)){if(l==="series")a.selectedMap="all";else if(l==="multiple"){Xr(a.selectedMap)||(a.selectedMap={});for(var h=a.selectedMap,d=0;d<o;d++){var m=r[d],v=qE(t,m);h[v]=!0,this._selectedDataIndicesMap[v]=t.getRawIndex(m)}}else if(l==="single"||l===!0){var y=r[o-1],v=qE(t,y);a.selectedMap=(i={},i[v]=!0,i),this._selectedDataIndicesMap=(s={},s[v]=t.getRawIndex(y),s)}}},e.prototype._initSelectedMapFromData=function(t){if(!this.option.selectedMap){var r=[];t.hasItemOption&&t.each(function(i){var s=t.getRawDataItem(i);s&&s.selected&&r.push(i)}),r.length>0&&this._innerSelect(t,r)}},e.registerClass=function(t){return os.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(os);sd(Jf,aRe);sd(Jf,e8);gie(Jf,os);function Eq(n){var e=n.name;LU(n)||(n.name=ORe(n)||e)}function ORe(n){var e=n.getRawData(),t=e.mapDimensionsAll("seriesName"),r=[];return it(t,function(i){var s=e.getDimensionInfo(i);s.displayName&&r.push(s.displayName)}),r.join(" ")}function FRe(n){return n.model.getRawData().count()}function NRe(n){var e=n.model;return e.setData(e.getRawData().cloneShallow()),zRe}function zRe(n,e){e.outputData&&n.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Iq(n,e){it(aTe(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(t){n.wrapMethod(t,vs(URe,e))})}function URe(n,e){var t=AN(n);return t&&t.setOutputEnd((e||this).count()),e}function AN(n){var e=(n.ecModel||{}).scheduler,t=e&&e.getPipeline(n.uid);if(t){var r=t.currentTask;if(r){var i=r.agentStubMap;i&&(r=i.get(n.uid))}return r}}var Pc=function(){function n(){this.group=new ma,this.uid=hM("viewComponent")}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){},n.prototype.updateLayout=function(e,t,r,i){},n.prototype.updateVisual=function(e,t,r,i){},n.prototype.toggleBlurSeries=function(e,t,r){},n.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},n}();BU(Pc);LD(Pc);function o8(){var n=$s();return function(e){var t=n(e),r=e.pipelineContext,i=!!t.large,s=!!t.progressiveRender,a=t.large=!!(r&&r.large),l=t.progressiveRender=!!(r&&r.progressiveRender);return(i!==a||s!==l)&&"reset"}}var Qse=$s(),GRe=o8(),Ih=function(){function n(){this.group=new ma,this.uid=hM("viewChart"),this.renderTask=fA({plan:VRe,reset:HRe}),this.renderTask.context={view:this}}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.highlight=function(e,t,r,i){var s=e.getData(i&&i.dataType);s&&Pq(s,i,"emphasis")},n.prototype.downplay=function(e,t,r,i){var s=e.getData(i&&i.dataType);s&&Pq(s,i,"normal")},n.prototype.remove=function(e,t){this.group.removeAll()},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateLayout=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateVisual=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.eachRendered=function(e){WD(this.group,e)},n.markUpdateMethod=function(e,t){Qse(e).updateMethod=t},n.protoInitialize=function(){var e=n.prototype;e.type="chart"}(),n}();function Rq(n,e,t){n&&dN(n)&&(e==="emphasis"?rw:iw)(n,t)}function Pq(n,e,t){var r=i1(n,e),i=e&&e.highlightKey!=null?oEe(e.highlightKey):null;r!=null?it(pa(r),function(s){Rq(n.getItemGraphicEl(s),t,i)}):n.eachItemGraphicEl(function(s){Rq(s,t,i)})}BU(Ih);LD(Ih);function VRe(n){return GRe(n.model)}function HRe(n){var e=n.model,t=n.ecModel,r=n.api,i=n.payload,s=e.pipelineContext.progressiveRender,a=n.view,l=i&&Qse(i).updateMethod,o=s?"incrementalPrepareRender":l&&a[l]?l:"render";return o!=="render"&&a[o](e,t,r,i),jRe[o]}var jRe={incrementalPrepareRender:{progress:function(n,e){e.view.incrementalRender(n,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(n,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},VP="\0__throttleOriginMethod",Lq="\0__throttleRate",Dq="\0__throttleType";function a8(n,e,t){var r,i=0,s=0,a=null,l,o,h,d;e=e||0;function m(){s=new Date().getTime(),a=null,n.apply(o,h||[])}var v=function(){for(var y=[],S=0;S<arguments.length;S++)y[S]=arguments[S];r=new Date().getTime(),o=this,h=y;var E=d||e,M=d||t;d=null,l=r-(M?i:s)-E,clearTimeout(a),M?a=setTimeout(m,E):l>=0?m():a=setTimeout(m,-l),i=r};return v.clear=function(){a&&(clearTimeout(a),a=null)},v.debounceNextCall=function(y){d=y},v}function eoe(n,e,t,r){var i=n[e];if(i){var s=i[VP]||i,a=i[Dq],l=i[Lq];if(l!==t||a!==r){if(t==null||!r)return n[e]=s;i=n[e]=a8(s,t,r==="debounce"),i[VP]=s,i[Dq]=r,i[Lq]=t}return i}}function TN(n,e){var t=n[e];t&&t[VP]&&(t.clear&&t.clear(),n[e]=t[VP])}var Bq=$s(),kq={itemStyle:aT(cse,!0),lineStyle:aT(lse,!0)},WRe={lineStyle:"stroke",itemStyle:"fill"};function toe(n,e){var t=n.visualStyleMapper||kq[e];return t||(console.warn("Unknown style type '"+e+"'."),kq.itemStyle)}function noe(n,e){var t=n.visualDrawType||WRe[e];return t||(console.warn("Unknown style type '"+e+"'."),"fill")}var XRe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=n.getModel(r),s=toe(n,r),a=s(i),l=i.getShallow("decal");l&&(t.setVisual("decal",l),l.dirty=!0);var o=noe(n,r),h=a[o],d=ci(h)?h:null,m=a.fill==="auto"||a.stroke==="auto";if(!a[o]||d||m){var v=n.getColorFromPalette(n.name,null,e.getSeriesCount());a[o]||(a[o]=v,t.setVisual("colorFromPalette",!0)),a.fill=a.fill==="auto"||ci(a.fill)?v:a.fill,a.stroke=a.stroke==="auto"||ci(a.stroke)?v:a.stroke}if(t.setVisual("style",a),t.setVisual("drawType",o),!e.isSeriesFiltered(n)&&d)return t.setVisual("colorFromPalette",!1),{dataEach:function(y,S){var E=n.getDataParams(S),M=Jn({},a);M[o]=d(E),y.setItemVisual(S,"style",M)}}}},J2=new Ro,$Re={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!(n.ignoreStyleOnData||e.isSeriesFiltered(n))){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=toe(n,r),s=t.getVisual("drawType");return{dataEach:t.hasItemOption?function(a,l){var o=a.getRawDataItem(l);if(o&&o[r]){J2.option=o[r];var h=i(J2),d=a.ensureUniqueItemVisual(l,"style");Jn(d,h),J2.option.decal&&(a.setItemVisual(l,"decal",J2.option.decal),J2.option.decal.dirty=!0),s in h&&a.setItemVisual(l,"colorFromPalette",!1)}}:null}}}},qRe={performRawSeries:!0,overallReset:function(n){var e=ii();n.eachSeries(function(t){var r=t.getColorBy();if(!t.isColorBySeries()){var i=t.type+"-"+r,s=e.get(i);s||(s={},e.set(i,s)),Bq(t).scope=s}}),n.eachSeries(function(t){if(!(t.isColorBySeries()||n.isSeriesFiltered(t))){var r=t.getRawData(),i={},s=t.getData(),a=Bq(t).scope,l=t.visualStyleAccessPath||"itemStyle",o=noe(t,l);s.each(function(h){var d=s.getRawIndex(h);i[d]=h}),r.each(function(h){var d=i[h],m=s.getItemVisual(d,"colorFromPalette");if(m){var v=s.ensureUniqueItemVisual(d,"style"),y=r.getName(h)||h+"",S=r.count();v[o]=t.getColorFromPalette(y,a,S)}})}})}},ZE=Math.PI;function ZRe(n,e){e=e||{},ti(e,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var t=new ma,r=new Ho({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});t.add(r);var i=new Ea({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),s=new Ho({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});t.add(s);var a;return e.showSpinner&&(a=new UD({shape:{startAngle:-ZE/2,endAngle:-ZE/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001}),a.animateShape(!0).when(1e3,{endAngle:ZE*3/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:ZE*3/2}).delay(300).start("circularInOut"),t.add(a)),t.resize=function(){var l=i.getBoundingRect().width,o=e.showSpinner?e.spinnerRadius:0,h=(n.getWidth()-o*2-(e.showSpinner&&l?10:0)-l)/2-(e.showSpinner&&l?0:5+l/2)+(e.showSpinner?0:l/2)+(l?0:o),d=n.getHeight()/2;e.showSpinner&&a.setShape({cx:h,cy:d}),s.setShape({x:h-o,y:d-o,width:o*2,height:o*2}),r.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},t.resize(),t}var roe=function(){function n(e,t,r,i){this._stageTaskMap=ii(),this.ecInstance=e,this.api=t,r=this._dataProcessorHandlers=r.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=r.concat(i)}return n.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(r){var i=r.overallTask;i&&i.dirty()})},n.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var r=this._pipelineMap.get(e.__pipeline.id),i=r.context,s=!t&&r.progressiveEnabled&&(!i||i.progressiveRender)&&e.__idxInPipeline>r.blockIndex,a=s?r.step:null,l=i&&i.modDataCount,o=l!=null?Math.ceil(l/a):null;return{step:a,modBy:o,modDataCount:l}}},n.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},n.prototype.updateStreamModes=function(e,t){var r=this._pipelineMap.get(e.uid),i=e.getData(),s=i.count(),a=r.progressiveEnabled&&t.incrementalPrepareRender&&s>=r.threshold,l=e.get("large")&&s>=e.get("largeThreshold"),o=e.get("progressiveChunkMode")==="mod"?s:null;e.pipelineContext=r.context={progressiveRender:a,modDataCount:o,large:l}},n.prototype.restorePipelines=function(e){var t=this,r=t._pipelineMap=ii();e.eachSeries(function(i){var s=i.getProgressive(),a=i.uid;r.set(a,{id:a,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:s&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(s||700),count:0}),t._pipe(i,i.dataTask)})},n.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),r=this.api;it(this._allHandlers,function(i){var s=e.get(i.uid)||e.set(i.uid,{}),a="";pp(!(i.reset&&i.overallReset),a),i.reset&&this._createSeriesStageTask(i,s,t,r),i.overallReset&&this._createOverallStageTask(i,s,t,r)},this)},n.prototype.prepareView=function(e,t,r,i){var s=e.renderTask,a=s.context;a.model=t,a.ecModel=r,a.api=i,s.__block=!e.incrementalPrepareRender,this._pipe(t,s)},n.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},n.prototype.performVisualTasks=function(e,t,r){this._performStageTasks(this._visualHandlers,e,t,r)},n.prototype._performStageTasks=function(e,t,r,i){i=i||{};var s=!1,a=this;it(e,function(o,h){if(!(i.visualType&&i.visualType!==o.visualType)){var d=a._stageTaskMap.get(o.uid),m=d.seriesTaskMap,v=d.overallTask;if(v){var y,S=v.agentStubMap;S.each(function(M){l(i,M)&&(M.dirty(),y=!0)}),y&&v.dirty(),a.updatePayload(v,r);var E=a.getPerformArgs(v,i.block);S.each(function(M){M.perform(E)}),v.perform(E)&&(s=!0)}else m&&m.each(function(M,C){l(i,M)&&M.dirty();var L=a.getPerformArgs(M,i.block);L.skip=!o.performRawSeries&&t.isSeriesFiltered(M.context.model),a.updatePayload(M,r),M.perform(L)&&(s=!0)})}});function l(o,h){return o.setDirty&&(!o.dirtyMap||o.dirtyMap.get(h.__pipeline.id))}this.unfinished=s||this.unfinished},n.prototype.performSeriesTasks=function(e){var t;e.eachSeries(function(r){t=r.dataTask.perform()||t}),this.unfinished=t||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})},n.prototype.updatePayload=function(e,t){t!=="remain"&&(e.context.payload=t)},n.prototype._createSeriesStageTask=function(e,t,r,i){var s=this,a=t.seriesTaskMap,l=t.seriesTaskMap=ii(),o=e.seriesType,h=e.getTargetSeries;e.createOnAllSeries?r.eachRawSeries(d):o?r.eachRawSeriesByType(o,d):h&&h(r,i).each(d);function d(m){var v=m.uid,y=l.set(v,a&&a.get(v)||fA({plan:ePe,reset:tPe,count:rPe}));y.context={model:m,ecModel:r,api:i,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:s},s._pipe(m,y)}},n.prototype._createOverallStageTask=function(e,t,r,i){var s=this,a=t.overallTask=t.overallTask||fA({reset:YRe});a.context={ecModel:r,api:i,overallReset:e.overallReset,scheduler:s};var l=a.agentStubMap,o=a.agentStubMap=ii(),h=e.seriesType,d=e.getTargetSeries,m=!0,v=!1,y="";pp(!e.createOnAllSeries,y),h?r.eachRawSeriesByType(h,S):d?d(r,i).each(S):(m=!1,it(r.getSeries(),S));function S(E){var M=E.uid,C=o.set(M,l&&l.get(M)||(v=!0,fA({reset:KRe,onDirty:QRe})));C.context={model:E,overallProgress:m},C.agent=a,C.__block=m,s._pipe(E,C)}v&&a.dirty()},n.prototype._pipe=function(e,t){var r=e.uid,i=this._pipelineMap.get(r);!i.head&&(i.head=t),i.tail&&i.tail.pipe(t),i.tail=t,t.__idxInPipeline=i.count++,t.__pipeline=i},n.wrapStageHandler=function(e,t){return ci(e)&&(e={overallReset:e,seriesType:iPe(e)}),e.uid=hM("stageHandler"),t&&(e.visualType=t),e},n}();function YRe(n){n.overallReset(n.ecModel,n.api,n.payload)}function KRe(n){return n.overallProgress&&JRe}function JRe(){this.agent.dirty(),this.getDownstream().dirty()}function QRe(){this.agent&&this.agent.dirty()}function ePe(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function tPe(n){n.useClearVisual&&n.data.clearAllVisual();var e=n.resetDefines=pa(n.reset(n.model,n.ecModel,n.api,n.payload));return e.length>1?xr(e,function(t,r){return ioe(r)}):nPe}var nPe=ioe(0);function ioe(n){return function(e,t){var r=t.data,i=t.resetDefines[n];if(i&&i.dataEach)for(var s=e.start;s<e.end;s++)i.dataEach(r,s);else i&&i.progress&&i.progress(e,r)}}function rPe(n){return n.data.count()}function iPe(n){HP=null;try{n(pT,soe)}catch{}return HP}var pT={},soe={},HP;ooe(pT,t8);ooe(soe,Rse);pT.eachSeriesByType=pT.eachRawSeriesByType=function(n){HP=n};pT.eachComponent=function(n){n.mainType==="series"&&n.subType&&(HP=n.subType)};function ooe(n,e){for(var t in e.prototype)n[t]=Ec}var Oq=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const sPe={color:Oq,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Oq]};var vc="#B9B8CE",Fq="#100C2A",YE=function(){return{axisLine:{lineStyle:{color:vc}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},Nq=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],aoe={darkMode:!0,color:Nq,backgroundColor:Fq,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:vc}},textStyle:{color:vc},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:vc}},dataZoom:{borderColor:"#71708A",textStyle:{color:vc},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:vc}},timeline:{lineStyle:{color:vc},label:{color:vc},controlStyle:{color:vc,borderColor:vc}},calendar:{itemStyle:{color:Fq},dayLabel:{color:vc},monthLabel:{color:vc},yearLabel:{color:vc}},timeAxis:YE(),logAxis:YE(),valueAxis:YE(),categoryAxis:YE(),line:{symbol:"circle"},graph:{color:Nq},gauge:{title:{color:vc},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:vc},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};aoe.categoryAxis.splitLine.show=!1;var oPe=function(){function n(){}return n.prototype.normalizeQuery=function(e){var t={},r={},i={};if(Dr(e)){var s=np(e);t.mainType=s.main||null,t.subType=s.sub||null}else{var a=["Index","Name","Id"],l={name:1,dataIndex:1,dataType:1};it(e,function(o,h){for(var d=!1,m=0;m<a.length;m++){var v=a[m],y=h.lastIndexOf(v);if(y>0&&y===h.length-v.length){var S=h.slice(0,y);S!=="data"&&(t.mainType=S,t[v.toLowerCase()]=o,d=!0)}}l.hasOwnProperty(h)&&(r[h]=o,d=!0),d||(i[h]=o)})}return{cptQuery:t,dataQuery:r,otherQuery:i}},n.prototype.filter=function(e,t){var r=this.eventInfo;if(!r)return!0;var i=r.targetEl,s=r.packedEvent,a=r.model,l=r.view;if(!a||!l)return!0;var o=t.cptQuery,h=t.dataQuery;return d(o,a,"mainType")&&d(o,a,"subType")&&d(o,a,"index","componentIndex")&&d(o,a,"name")&&d(o,a,"id")&&d(h,s,"name")&&d(h,s,"dataIndex")&&d(h,s,"dataType")&&(!l.filterForExposedEvent||l.filterForExposedEvent(e,t.otherQuery,i,s));function d(m,v,y,S){return m[y]==null||v[S||y]===m[y]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),MN=["symbol","symbolSize","symbolRotate","symbolOffset"],zq=MN.concat(["symbolKeepAspect"]),aPe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData();if(n.legendIcon&&t.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var r={},i={},s=!1,a=0;a<MN.length;a++){var l=MN[a],o=n.get(l);ci(o)?(s=!0,i[l]=o):r[l]=o}if(r.symbol=r.symbol||n.defaultSymbol,t.setVisual(Jn({legendIcon:n.legendIcon||r.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},r)),e.isSeriesFiltered(n))return;var h=so(i);function d(m,v){for(var y=n.getRawValue(v),S=n.getDataParams(v),E=0;E<h.length;E++){var M=h[E];m.setItemVisual(v,M,i[M](y,S))}}return{dataEach:s?d:null}}},lPe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!n.hasSymbolVisual||e.isSeriesFiltered(n))return;var t=n.getData();function r(i,s){for(var a=i.getItemModel(s),l=0;l<zq.length;l++){var o=zq[l],h=a.getShallow(o,!0);h!=null&&i.setItemVisual(s,o,h)}}return{dataEach:t.hasItemOption?r:null}}};function cPe(n,e,t){switch(t){case"color":var r=n.getItemVisual(e,"style");return r[n.getVisual("drawType")];case"opacity":return n.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(e,t)}}function uPe(n,e){switch(e){case"color":var t=n.getVisual("style");return t[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(e)}}function hPe(n,e){function t(r,i){var s=[];return r.eachComponent({mainType:"series",subType:n,query:i},function(a){s.push(a.seriesIndex)}),s}it([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(r){e(r[0],function(i,s,a){i=Jn({},i),a.dispatchAction(Jn(i,{type:r[1],seriesIndex:t(s,i)}))})})}function Ox(n,e,t,r,i){var s=n+e;t.isSilent(s)||r.eachComponent({mainType:"series",subType:"pie"},function(a){for(var l=a.seriesIndex,o=a.option.selectedMap,h=i.selected,d=0;d<h.length;d++)if(h[d].seriesIndex===l){var m=a.getData(),v=i1(m,i.fromActionPayload);t.trigger(s,{type:s,seriesId:a.id,name:fr(v)?m.getName(v[0]):m.getName(v),selected:Dr(o)?o:Jn({},o)})}})}function fPe(n,e,t){n.on("selectchanged",function(r){var i=t.getModel();r.isFromClick?(Ox("map","selectchanged",e,i,r),Ox("pie","selectchanged",e,i,r)):r.fromAction==="select"?(Ox("map","selected",e,i,r),Ox("pie","selected",e,i,r)):r.fromAction==="unselect"&&(Ox("map","unselected",e,i,r),Ox("pie","unselected",e,i,r))})}function RS(n,e,t){for(var r;n&&!(e(n)&&(r=n,t));)n=n.__hostTarget||n.parent;return r}var dPe=Math.round(Math.random()*9),pPe=typeof Object.defineProperty=="function",mPe=function(){function n(){this._id="__ec_inner_"+dPe++}return n.prototype.get=function(e){return this._guard(e)[this._id]},n.prototype.set=function(e,t){var r=this._guard(e);return pPe?Object.defineProperty(r,this._id,{value:t,enumerable:!1,configurable:!0}):r[this._id]=t,this},n.prototype.delete=function(e){return this.has(e)?(delete this._guard(e)[this._id],!0):!1},n.prototype.has=function(e){return!!this._guard(e)[this._id]},n.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},n}(),gPe=$i.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,s=e.height/2;n.moveTo(t,r-s),n.lineTo(t+i,r+s),n.lineTo(t-i,r+s),n.closePath()}}),vPe=$i.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,s=e.height/2;n.moveTo(t,r-s),n.lineTo(t+i,r),n.lineTo(t,r+s),n.lineTo(t-i,r),n.closePath()}}),_Pe=$i.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.x,r=e.y,i=e.width/5*3,s=Math.max(i,e.height),a=i/2,l=a*a/(s-a),o=r-s+a+l,h=Math.asin(l/a),d=Math.cos(h)*a,m=Math.sin(h),v=Math.cos(h),y=a*.6,S=a*.7;n.moveTo(t-d,o+l),n.arc(t,o,a,Math.PI-h,Math.PI*2+h),n.bezierCurveTo(t+d-m*y,o+l+v*y,t,r-S,t,r),n.bezierCurveTo(t,r-S,t-d+m*y,o+l+v*y,t-d,o+l),n.closePath()}}),yPe=$i.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.height,r=e.width,i=e.x,s=e.y,a=r/3*2;n.moveTo(i,s),n.lineTo(i+a,s+t),n.lineTo(i,s+t/4*3),n.lineTo(i-a,s+t),n.lineTo(i,s),n.closePath()}}),xPe={line:Gf,rect:Ho,roundRect:Ho,square:Ho,circle:ND,diamond:vPe,pin:_Pe,arrow:yPe,triangle:gPe},bPe={line:function(n,e,t,r,i){i.x1=n,i.y1=e+r/2,i.x2=n+t,i.y2=e+r/2},rect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r},roundRect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r,i.r=Math.min(t,r)/4},square:function(n,e,t,r,i){var s=Math.min(t,r);i.x=n,i.y=e,i.width=s,i.height=s},circle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.r=Math.min(t,r)/2},diamond:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r},pin:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},arrow:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},triangle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r}},CN={};it(xPe,function(n,e){CN[e]=new n});var wPe=$i.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,e,t){var r=PP(n,e,t),i=this.shape;return i&&i.symbolType==="pin"&&e.position==="inside"&&(r.y=t.y+t.height*.4),r},buildPath:function(n,e,t){var r=e.symbolType;if(r!=="none"){var i=CN[r];i||(r="rect",i=CN[r]),bPe[r](e.x,e.y,e.width,e.height,i.shape),i.buildPath(n,i.shape,t)}}});function SPe(n,e){if(this.type!=="image"){var t=this.style;this.__isEmptyBrush?(t.stroke=n,t.fill=e||"#fff",t.lineWidth=2):this.shape.symbolType==="line"?t.stroke=n:t.fill=n,this.markRedraw()}}function aw(n,e,t,r,i,s,a){var l=n.indexOf("empty")===0;l&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var o;return n.indexOf("image://")===0?o=ese(n.slice(8),new cs(e,t,r,i),a?"center":"cover"):n.indexOf("path://")===0?o=HU(n.slice(7),{},new cs(e,t,r,i),a?"center":"cover"):o=new wPe({shape:{symbolType:n,x:e,y:t,width:r,height:i}}),o.__isEmptyBrush=l,o.setColor=SPe,s&&o.setColor(s),o}function APe(n){return fr(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function loe(n,e){if(n!=null)return fr(n)||(n=[n,n]),[ls(n[0],e[0])||0,ls(Ei(n[1],n[0]),e[1])||0]}function My(n){return isFinite(n)}function TPe(n,e,t){var r=e.x==null?0:e.x,i=e.x2==null?1:e.x2,s=e.y==null?0:e.y,a=e.y2==null?0:e.y2;e.global||(r=r*t.width+t.x,i=i*t.width+t.x,s=s*t.height+t.y,a=a*t.height+t.y),r=My(r)?r:0,i=My(i)?i:1,s=My(s)?s:0,a=My(a)?a:0;var l=n.createLinearGradient(r,s,i,a);return l}function MPe(n,e,t){var r=t.width,i=t.height,s=Math.min(r,i),a=e.x==null?.5:e.x,l=e.y==null?.5:e.y,o=e.r==null?.5:e.r;e.global||(a=a*r+t.x,l=l*i+t.y,o=o*s),a=My(a)?a:.5,l=My(l)?l:.5,o=o>=0&&My(o)?o:.5;var h=n.createRadialGradient(a,l,0,a,l,o);return h}function EN(n,e,t){for(var r=e.type==="radial"?MPe(n,e,t):TPe(n,e,t),i=e.colorStops,s=0;s<i.length;s++)r.addColorStop(i[s].offset,i[s].color);return r}function CPe(n,e){if(n===e||!n&&!e)return!1;if(!n||!e||n.length!==e.length)return!0;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!0;return!1}function KE(n){return parseInt(n,10)}function JE(n,e,t){var r=["width","height"][e],i=["clientWidth","clientHeight"][e],s=["paddingLeft","paddingTop"][e],a=["paddingRight","paddingBottom"][e];if(t[r]!=null&&t[r]!=="auto")return parseFloat(t[r]);var l=document.defaultView.getComputedStyle(n);return(n[i]||KE(l[r])||KE(n.style[r]))-(KE(l[s])||0)-(KE(l[a])||0)|0}function EPe(n,e){return!n||n==="solid"||!(e>0)?null:n==="dashed"?[4*e,2*e]:n==="dotted"?[e]:Rs(n)?[n]:fr(n)?n:null}function coe(n){var e=n.style,t=e.lineDash&&e.lineWidth>0&&EPe(e.lineDash,e.lineWidth),r=e.lineDashOffset;if(t){var i=e.strokeNoScale&&n.getLineScale?n.getLineScale():1;i&&i!==1&&(t=xr(t,function(s){return s/i}),r/=i)}return[t,r]}var IPe=new Jm(!0);function jP(n){var e=n.stroke;return!(e==null||e==="none"||!(n.lineWidth>0))}function Uq(n){return typeof n=="string"&&n!=="none"}function WP(n){var e=n.fill;return e!=null&&e!=="none"}function Gq(n,e){if(e.fillOpacity!=null&&e.fillOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.fillOpacity*e.opacity,n.fill(),n.globalAlpha=t}else n.fill()}function Vq(n,e){if(e.strokeOpacity!=null&&e.strokeOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.strokeOpacity*e.opacity,n.stroke(),n.globalAlpha=t}else n.stroke()}function IN(n,e,t){var r=vie(e.image,e.__image,t);if(DD(r)){var i=n.createPattern(r,e.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var s=new DOMMatrix;s.translateSelf(e.x||0,e.y||0),s.rotateSelf(0,0,(e.rotation||0)*lTe),s.scaleSelf(e.scaleX||1,e.scaleY||1),i.setTransform(s)}return i}}function RPe(n,e,t,r){var i,s=jP(t),a=WP(t),l=t.strokePercent,o=l<1,h=!e.path;(!e.silent||o)&&h&&e.createPathProxy();var d=e.path||IPe,m=e.__dirty;if(!r){var v=t.fill,y=t.stroke,S=a&&!!v.colorStops,E=s&&!!y.colorStops,M=a&&!!v.image,C=s&&!!y.image,L=void 0,k=void 0,H=void 0,q=void 0,Z=void 0;(S||E)&&(Z=e.getBoundingRect()),S&&(L=m?EN(n,v,Z):e.__canvasFillGradient,e.__canvasFillGradient=L),E&&(k=m?EN(n,y,Z):e.__canvasStrokeGradient,e.__canvasStrokeGradient=k),M&&(H=m||!e.__canvasFillPattern?IN(n,v,e):e.__canvasFillPattern,e.__canvasFillPattern=H),C&&(q=m||!e.__canvasStrokePattern?IN(n,y,e):e.__canvasStrokePattern,e.__canvasStrokePattern=H),S?n.fillStyle=L:M&&(H?n.fillStyle=H:a=!1),E?n.strokeStyle=k:C&&(q?n.strokeStyle=q:s=!1)}var ee=e.getGlobalScale();d.setScale(ee[0],ee[1],e.segmentIgnoreThreshold);var re,se;n.setLineDash&&t.lineDash&&(i=coe(e),re=i[0],se=i[1]);var ae=!0;(h||m&Kx)&&(d.setDPR(n.dpr),o?d.setContext(null):(d.setContext(n),ae=!1),d.reset(),e.buildPath(d,e.shape,r),d.toStatic(),e.pathUpdated()),ae&&d.rebuildPath(n,o?l:1),re&&(n.setLineDash(re),n.lineDashOffset=se),r||(t.strokeFirst?(s&&Vq(n,t),a&&Gq(n,t)):(a&&Gq(n,t),s&&Vq(n,t))),re&&n.setLineDash([])}function PPe(n,e,t){var r=e.__image=vie(t.image,e.__image,e,e.onload);if(!(!r||!DD(r))){var i=t.x||0,s=t.y||0,a=e.getWidth(),l=e.getHeight(),o=r.width/r.height;if(a==null&&l!=null?a=l*o:l==null&&a!=null?l=a/o:a==null&&l==null&&(a=r.width,l=r.height),t.sWidth&&t.sHeight){var h=t.sx||0,d=t.sy||0;n.drawImage(r,h,d,t.sWidth,t.sHeight,i,s,a,l)}else if(t.sx&&t.sy){var h=t.sx,d=t.sy,m=a-h,v=l-d;n.drawImage(r,h,d,m,v,i,s,a,l)}else n.drawImage(r,i,s,a,l)}}function LPe(n,e,t){var r,i=t.text;if(i!=null&&(i+=""),i){n.font=t.font||r1,n.textAlign=t.textAlign,n.textBaseline=t.textBaseline;var s=void 0,a=void 0;n.setLineDash&&t.lineDash&&(r=coe(e),s=r[0],a=r[1]),s&&(n.setLineDash(s),n.lineDashOffset=a),t.strokeFirst?(jP(t)&&n.strokeText(i,t.x,t.y),WP(t)&&n.fillText(i,t.x,t.y)):(WP(t)&&n.fillText(i,t.x,t.y),jP(t)&&n.strokeText(i,t.x,t.y)),s&&n.setLineDash([])}}var Hq=["shadowBlur","shadowOffsetX","shadowOffsetY"],jq=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function uoe(n,e,t,r,i){var s=!1;if(!r&&(t=t||{},e===t))return!1;if(r||e.opacity!==t.opacity){ru(n,i),s=!0;var a=Math.max(Math.min(e.opacity,1),0);n.globalAlpha=isNaN(a)?zy.opacity:a}(r||e.blend!==t.blend)&&(s||(ru(n,i),s=!0),n.globalCompositeOperation=e.blend||zy.blend);for(var l=0;l<Hq.length;l++){var o=Hq[l];(r||e[o]!==t[o])&&(s||(ru(n,i),s=!0),n[o]=n.dpr*(e[o]||0))}return(r||e.shadowColor!==t.shadowColor)&&(s||(ru(n,i),s=!0),n.shadowColor=e.shadowColor||zy.shadowColor),s}function Wq(n,e,t,r,i){var s=mT(e,i.inHover),a=r?null:t&&mT(t,i.inHover)||{};if(s===a)return!1;var l=uoe(n,s,a,r,i);if((r||s.fill!==a.fill)&&(l||(ru(n,i),l=!0),Uq(s.fill)&&(n.fillStyle=s.fill)),(r||s.stroke!==a.stroke)&&(l||(ru(n,i),l=!0),Uq(s.stroke)&&(n.strokeStyle=s.stroke)),(r||s.opacity!==a.opacity)&&(l||(ru(n,i),l=!0),n.globalAlpha=s.opacity==null?1:s.opacity),e.hasStroke()){var o=s.lineWidth,h=o/(s.strokeNoScale&&e.getLineScale?e.getLineScale():1);n.lineWidth!==h&&(l||(ru(n,i),l=!0),n.lineWidth=h)}for(var d=0;d<jq.length;d++){var m=jq[d],v=m[0];(r||s[v]!==a[v])&&(l||(ru(n,i),l=!0),n[v]=s[v]||m[1])}return l}function DPe(n,e,t,r,i){return uoe(n,mT(e,i.inHover),t&&mT(t,i.inHover),r,i)}function hoe(n,e){var t=e.transform,r=n.dpr||1;t?n.setTransform(r*t[0],r*t[1],r*t[2],r*t[3],r*t[4],r*t[5]):n.setTransform(r,0,0,r,0,0)}function BPe(n,e,t){for(var r=!1,i=0;i<n.length;i++){var s=n[i];r=r||s.isZeroArea(),hoe(e,s),e.beginPath(),s.buildPath(e,s.shape),e.clip()}t.allClipped=r}function kPe(n,e){return n&&e?n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]||n[4]!==e[4]||n[5]!==e[5]:!(!n&&!e)}var Xq=1,$q=2,qq=3,Zq=4;function OPe(n){var e=WP(n),t=jP(n);return!(n.lineDash||!(+e^+t)||e&&typeof n.fill!="string"||t&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function ru(n,e){e.batchFill&&n.fill(),e.batchStroke&&n.stroke(),e.batchFill="",e.batchStroke=""}function mT(n,e){return e&&n.__hoverStyle||n.style}function foe(n,e){Cy(n,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Cy(n,e,t,r){var i=e.transform;if(!e.shouldBePainted(t.viewWidth,t.viewHeight,!1,!1)){e.__dirty&=~Lu,e.__isRendered=!1;return}var s=e.__clipPaths,a=t.prevElClipPaths,l=!1,o=!1;if((!a||CPe(s,a))&&(a&&a.length&&(ru(n,t),n.restore(),o=l=!0,t.prevElClipPaths=null,t.allClipped=!1,t.prevEl=null),s&&s.length&&(ru(n,t),n.save(),BPe(s,n,t),l=!0),t.prevElClipPaths=s),t.allClipped){e.__isRendered=!1;return}e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var h=t.prevEl;h||(o=l=!0);var d=e instanceof $i&&e.autoBatch&&OPe(e.style);l||kPe(i,h.transform)?(ru(n,t),hoe(n,e)):d||ru(n,t);var m=mT(e,t.inHover);e instanceof $i?(t.lastDrawType!==Xq&&(o=!0,t.lastDrawType=Xq),Wq(n,e,h,o,t),(!d||!t.batchFill&&!t.batchStroke)&&n.beginPath(),RPe(n,e,m,d),d&&(t.batchFill=m.fill||"",t.batchStroke=m.stroke||"")):e instanceof DP?(t.lastDrawType!==qq&&(o=!0,t.lastDrawType=qq),Wq(n,e,h,o,t),LPe(n,e,m)):e instanceof Ov?(t.lastDrawType!==$q&&(o=!0,t.lastDrawType=$q),DPe(n,e,h,o,t),PPe(n,e,m)):e.getTemporalDisplayables&&(t.lastDrawType!==Zq&&(o=!0,t.lastDrawType=Zq),FPe(n,e,t)),d&&r&&ru(n,t),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),t.prevEl=e,e.__dirty=0,e.__isRendered=!0}function FPe(n,e,t){var r=e.getDisplayables(),i=e.getTemporalDisplayables();n.save();var s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:t.viewWidth,viewHeight:t.viewHeight,inHover:t.inHover},a,l;for(a=e.getCursor(),l=r.length;a<l;a++){var o=r[a];o.beforeBrush&&o.beforeBrush(),o.innerBeforeBrush(),Cy(n,o,s,a===l-1),o.innerAfterBrush(),o.afterBrush&&o.afterBrush(),s.prevEl=o}for(var h=0,d=i.length;h<d;h++){var o=i[h];o.beforeBrush&&o.beforeBrush(),o.innerBeforeBrush(),Cy(n,o,s,h===d-1),o.innerAfterBrush(),o.afterBrush&&o.afterBrush(),s.prevEl=o}e.clearTemporalDisplayables(),e.notClear=!0,n.restore()}var ok=new mPe,Yq=new iM(100),Kq=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function RN(n,e){if(n==="none")return null;var t=e.getDevicePixelRatio(),r=e.getZr(),i=r.painter.type==="svg";n.dirty&&ok.delete(n);var s=ok.get(n);if(s)return s;var a=ti(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});a.backgroundColor==="none"&&(a.backgroundColor=null);var l={repeat:"repeat"};return o(l),l.rotation=a.rotation,l.scaleX=l.scaleY=i?1:1/t,ok.set(n,l),n.dirty=!1,l;function o(h){for(var d=[t],m=!0,v=0;v<Kq.length;++v){var y=a[Kq[v]];if(y!=null&&!fr(y)&&!Dr(y)&&!Rs(y)&&typeof y!="boolean"){m=!1;break}d.push(y)}var S;if(m){S=d.join(",")+(i?"-svg":"");var E=Yq.get(S);E&&(i?h.svgElement=E:h.image=E)}var M=poe(a.dashArrayX),C=NPe(a.dashArrayY),L=doe(a.symbol),k=zPe(M),H=moe(C),q=!i&&Sw.createCanvas(),Z=i&&{tag:"g",attrs:{},key:"dcl",children:[]},ee=se(),re;q&&(q.width=ee.width*t,q.height=ee.height*t,re=q.getContext("2d")),ae(),m&&Yq.put(S,q||Z),h.image=q,h.svgElement=Z,h.svgWidth=ee.width,h.svgHeight=ee.height;function se(){for(var fe=1,Se=0,Ce=k.length;Se<Ce;++Se)fe=h$(fe,k[Se]);for(var Ie=1,Se=0,Ce=L.length;Se<Ce;++Se)Ie=h$(Ie,L[Se].length);fe*=Ie;var je=H*k.length*L.length;return{width:Math.max(1,Math.min(fe,a.maxTileWidth)),height:Math.max(1,Math.min(je,a.maxTileHeight))}}function ae(){re&&(re.clearRect(0,0,q.width,q.height),a.backgroundColor&&(re.fillStyle=a.backgroundColor,re.fillRect(0,0,q.width,q.height)));for(var fe=0,Se=0;Se<C.length;++Se)fe+=C[Se];if(fe<=0)return;for(var Ce=-H,Ie=0,je=0,Le=0;Ce<ee.height;){if(Ie%2===0){for(var ot=je/2%L.length,ye=0,$e=0,Ve=0;ye<ee.width*2;){for(var _t=0,Se=0;Se<M[Le].length;++Se)_t+=M[Le][Se];if(_t<=0)break;if($e%2===0){var wt=(1-a.symbolSize)*.5,Vt=ye+M[Le][$e]*wt,lt=Ce+C[Ie]*wt,Ht=M[Le][$e]*a.symbolSize,Qt=C[Ie]*a.symbolSize,rn=Ve/2%L[ot].length;jn(Vt,lt,Ht,Qt,L[ot][rn])}ye+=M[Le][$e],++Ve,++$e,$e===M[Le].length&&($e=0)}++Le,Le===M.length&&(Le=0)}Ce+=C[Ie],++je,++Ie,Ie===C.length&&(Ie=0)}function jn(Bn,Tn,Pe,qe,mn){var cn=i?1:t,St=aw(mn,Bn*cn,Tn*cn,Pe*cn,qe*cn,a.color,a.symbolKeepAspect);if(i){var Jt=r.painter.renderOneToVNode(St);Jt&&Z.children.push(Jt)}else foe(re,St)}}}}function doe(n){if(!n||n.length===0)return[["rect"]];if(Dr(n))return[[n]];for(var e=!0,t=0;t<n.length;++t)if(!Dr(n[t])){e=!1;break}if(e)return doe([n]);for(var r=[],t=0;t<n.length;++t)Dr(n[t])?r.push([n[t]]):r.push(n[t]);return r}function poe(n){if(!n||n.length===0)return[[0,0]];if(Rs(n)){var e=Math.ceil(n);return[[e,e]]}for(var t=!0,r=0;r<n.length;++r)if(!Rs(n[r])){t=!1;break}if(t)return poe([n]);for(var i=[],r=0;r<n.length;++r)if(Rs(n[r])){var e=Math.ceil(n[r]);i.push([e,e])}else{var e=xr(n[r],function(l){return Math.ceil(l)});e.length%2===1?i.push(e.concat(e)):i.push(e)}return i}function NPe(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(Rs(n)){var e=Math.ceil(n);return[e,e]}var t=xr(n,function(r){return Math.ceil(r)});return n.length%2?t.concat(t):t}function zPe(n){return xr(n,function(e){return moe(e)})}function moe(n){for(var e=0,t=0;t<n.length;++t)e+=n[t];return n.length%2===1?e*2:e}function UPe(n,e){n.eachRawSeries(function(t){if(!n.isSeriesFiltered(t)){var r=t.getData();r.hasItemVisual()&&r.each(function(a){var l=r.getItemVisual(a,"decal");if(l){var o=r.ensureUniqueItemVisual(a,"style");o.decal=RN(l,e)}});var i=r.getVisual("decal");if(i){var s=r.getVisual("style");s.decal=RN(i,e)}}})}var Lf=new od,goe={};function GPe(n,e){goe[n]=e}function VPe(n){return goe[n]}var HPe=1,jPe=800,WPe=900,XPe=1e3,$Pe=2e3,qPe=5e3,voe=1e3,ZPe=1100,l8=2e3,_oe=3e3,YPe=4e3,n3=4500,KPe=4600,JPe=5e3,QPe=6e3,yoe=7e3,eLe={PROCESSOR:{FILTER:XPe,SERIES_FILTER:jPe,STATISTIC:qPe},VISUAL:{LAYOUT:voe,PROGRESSIVE_LAYOUT:ZPe,GLOBAL:l8,CHART:_oe,POST_CHART_LAYOUT:KPe,COMPONENT:YPe,BRUSH:JPe,CHART_ITEM:n3,ARIA:QPe,DECAL:yoe}},Nl="__flagInMainProcess",Kc="__pendingUpdate",ak="__needsUpdateStatus",Jq=/^[a-zA-Z0-9_]+$/,lk="__connectUpdateStatus",Qq=0,tLe=1,nLe=2;function xoe(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.isDisposed()){this.id;return}return woe(this,n,e)}}function boe(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return woe(this,n,e)}}function woe(n,e,t){return t[0]=t[0]&&t[0].toLowerCase(),od.prototype[e].apply(n,t)}var Soe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(od),Aoe=Soe.prototype;Aoe.on=boe("on");Aoe.off=boe("off");var Fx,ck,QE,x0,uk,hk,fk,Q2,eS,eZ,tZ,dk,nZ,eI,rZ,Toe,ch,iZ,Moe=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this,new oPe)||this;s._chartsViews=[],s._chartsMap={},s._componentsViews=[],s._componentsMap={},s._pendingActions=[],i=i||{},Dr(r)&&(r=Coe[r]),s._dom=t;var a="canvas",l="auto",o=!1;i.ssr;var h=s._zr=c$(t,{renderer:i.renderer||a,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Ei(i.useDirtyRect,o),useCoarsePointer:Ei(i.useCoarsePointer,l),pointerSize:i.pointerSize});s._ssr=i.ssr,s._throttledZrFlush=a8(zs(h.flush,h),17),r=_i(r),r&&Lse(r,!0),s._theme=r,s._locale=fIe(i.locale||hse),s._coordSysMgr=new n8;var d=s._api=rZ(s);function m(v,y){return v.__prio-y.__prio}return qI($P,m),qI(PN,m),s._scheduler=new roe(s,d,PN,$P),s._messageCenter=new Soe,s._initEvents(),s.resize=zs(s.resize,s),h.animation.on("frame",s._onframe,s),eZ(h,s),tZ(h,s),SP(s),s}return e.prototype._onframe=function(){if(!this._disposed){iZ(this);var t=this._scheduler;if(this[Kc]){var r=this[Kc].silent;this[Nl]=!0;try{Fx(this),x0.update.call(this,null,this[Kc].updateParams)}catch(o){throw this[Nl]=!1,this[Kc]=null,o}this._zr.flush(),this[Nl]=!1,this[Kc]=null,Q2.call(this,r),eS.call(this,r)}else if(t.unfinished){var i=HPe,s=this._model,a=this._api;t.unfinished=!1;do{var l=+new Date;t.performSeriesTasks(s),t.performDataProcessorTasks(s),hk(this,s),t.performVisualTasks(s),eI(this,this._model,a,"remain",{}),i-=+new Date-l}while(i>0&&t.unfinished);t.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.isSSR=function(){return this._ssr},e.prototype.setOption=function(t,r,i){if(!this[Nl]){if(this._disposed){this.id;return}var s,a,l;if(Xr(r)&&(i=r.lazyUpdate,s=r.silent,a=r.replaceMerge,l=r.transition,r=r.notMerge),this[Nl]=!0,!this._model||r){var o=new UIe(this._api),h=this._theme,d=this._model=new t8;d.scheduler=this._scheduler,d.ssr=this._ssr,d.init(null,null,null,h,this._locale,o)}this._model.setOption(t,{replaceMerge:a},LN);var m={seriesTransition:l,optionChanged:!0};if(i)this[Kc]={silent:s,updateParams:m},this[Nl]=!1,this.getZr().wakeUp();else{try{Fx(this),x0.update.call(this,null,m)}catch(v){throw this[Kc]=null,this[Nl]=!1,v}this._ssr||this._zr.flush(),this[Kc]=null,this[Nl]=!1,Q2.call(this,s),eS.call(this,s)}}},e.prototype.setTheme=function(){},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||mi.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){return this.renderToCanvas(t)},e.prototype.renderToCanvas=function(t){t=t||{};var r=this._zr.painter;return r.getRenderedCanvas({backgroundColor:t.backgroundColor||this._model.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(t){t=t||{};var r=this._zr.painter;return r.renderToString({useViewBox:t.useViewBox})},e.prototype.getSvgDataURL=function(){if(mi.svgSupported){var t=this._zr,r=t.storage.getDisplayList();return it(r,function(i){i.stopAnimation(null,!0)}),t.painter.toDataURL()}},e.prototype.getDataURL=function(t){if(this._disposed){this.id;return}t=t||{};var r=t.excludeComponents,i=this._model,s=[],a=this;it(r,function(o){i.eachComponent({mainType:o},function(h){var d=a._componentsMap[h.__viewId];d.group.ignore||(s.push(d),d.group.ignore=!0)})});var l=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return it(s,function(o){o.group.ignore=!1}),l},e.prototype.getConnectedDataURL=function(t){if(this._disposed){this.id;return}var r=t.type==="svg",i=this.group,s=Math.min,a=Math.max,l=1/0;if(sZ[i]){var o=l,h=l,d=-l,m=-l,v=[],y=t&&t.pixelRatio||this.getDevicePixelRatio();it(pA,function(k,H){if(k.group===i){var q=r?k.getZr().painter.getSvgDom().innerHTML:k.renderToCanvas(_i(t)),Z=k.getDom().getBoundingClientRect();o=s(Z.left,o),h=s(Z.top,h),d=a(Z.right,d),m=a(Z.bottom,m),v.push({dom:q,left:Z.left,top:Z.top})}}),o*=y,h*=y,d*=y,m*=y;var S=d-o,E=m-h,M=Sw.createCanvas(),C=c$(M,{renderer:r?"svg":"canvas"});if(C.resize({width:S,height:E}),r){var L="";return it(v,function(k){var H=k.left-o,q=k.top-h;L+='<g transform="translate('+H+","+q+')">'+k.dom+"</g>"}),C.painter.getSvgRoot().innerHTML=L,t.connectedBackgroundColor&&C.painter.setBackgroundColor(t.connectedBackgroundColor),C.refreshImmediately(),C.painter.toDataURL()}else return t.connectedBackgroundColor&&C.add(new Ho({shape:{x:0,y:0,width:S,height:E},style:{fill:t.connectedBackgroundColor}})),it(v,function(k){var H=new Ov({style:{x:k.left*y-o,y:k.top*y-h,image:k.dom}});C.add(H)}),C.refreshImmediately(),M.toDataURL("image/"+(t&&t.type||"png"))}else return this.getDataURL(t)},e.prototype.convertToPixel=function(t,r){return uk(this,"convertToPixel",t,r)},e.prototype.convertFromPixel=function(t,r){return uk(this,"convertFromPixel",t,r)},e.prototype.containPixel=function(t,r){if(this._disposed){this.id;return}var i=this._model,s,a=aA(i,t);return it(a,function(l,o){o.indexOf("Models")>=0&&it(l,function(h){var d=h.coordinateSystem;if(d&&d.containPoint)s=s||!!d.containPoint(r);else if(o==="seriesModels"){var m=this._chartsMap[h.__viewId];m&&m.containPoint&&(s=s||m.containPoint(r,h))}},this)},this),!!s},e.prototype.getVisual=function(t,r){var i=this._model,s=aA(i,t,{defaultMainType:"series"}),a=s.seriesModel,l=a.getData(),o=s.hasOwnProperty("dataIndexInside")?s.dataIndexInside:s.hasOwnProperty("dataIndex")?l.indexOfRawIndex(s.dataIndex):null;return o!=null?cPe(l,o,r):uPe(l,r)},e.prototype.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]},e.prototype._initEvents=function(){var t=this;it(rLe,function(r){var i=function(s){var a=t.getModel(),l=s.target,o,h=r==="globalout";if(h?o={}:l&&RS(l,function(S){var E=Wi(S);if(E&&E.dataIndex!=null){var M=E.dataModel||a.getSeriesByIndex(E.seriesIndex);return o=M&&M.getDataParams(E.dataIndex,E.dataType,l)||{},!0}else if(E.eventData)return o=Jn({},E.eventData),!0},!0),o){var d=o.componentType,m=o.componentIndex;(d==="markLine"||d==="markPoint"||d==="markArea")&&(d="series",m=o.seriesIndex);var v=d&&m!=null&&a.getComponent(d,m),y=v&&t[v.mainType==="series"?"_chartsMap":"_componentsMap"][v.__viewId];o.event=s,o.type=r,t._$eventProcessor.eventInfo={targetEl:l,packedEvent:o,model:v,view:y},t.trigger(r,o)}};i.zrEventfulCallAtLast=!0,t._zr.on(r,i,t)}),it(dA,function(r,i){t._messageCenter.on(i,function(s){this.trigger(i,s)},t)}),it(["selectchanged"],function(r){t._messageCenter.on(r,function(i){this.trigger(r,i)},t)}),fPe(this._messageCenter,this,this._api)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var t=this.getDom();t&&die(this.getDom(),u8,"");var r=this,i=r._api,s=r._model;it(r._componentsViews,function(a){a.dispose(s,i)}),it(r._chartsViews,function(a){a.dispose(s,i)}),r._zr.dispose(),r._dom=r._model=r._chartsMap=r._componentsMap=r._chartsViews=r._componentsViews=r._scheduler=r._api=r._zr=r._throttledZrFlush=r._theme=r._coordSysMgr=r._messageCenter=null,delete pA[r.id]},e.prototype.resize=function(t){if(!this[Nl]){if(this._disposed){this.id;return}this._zr.resize(t);var r=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!r){var i=r.resetOption("media"),s=t&&t.silent;this[Kc]&&(s==null&&(s=this[Kc].silent),i=!0,this[Kc]=null),this[Nl]=!0;try{i&&Fx(this),x0.update.call(this,{type:"resize",animation:Jn({duration:0},t&&t.animation)})}catch(a){throw this[Nl]=!1,a}this[Nl]=!1,Q2.call(this,s),eS.call(this,s)}}},e.prototype.showLoading=function(t,r){if(this._disposed){this.id;return}if(Xr(t)&&(r=t,t=""),t=t||"default",this.hideLoading(),!!DN[t]){var i=DN[t](this._api,r),s=this._zr;this._loadingFX=i,s.add(i)}},e.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},e.prototype.makeActionFromEvent=function(t){var r=Jn({},t);return r.type=dA[t.type],r},e.prototype.dispatchAction=function(t,r){if(this._disposed){this.id;return}if(Xr(r)||(r={silent:!!r}),!!XP[t.type]&&this._model){if(this[Nl]){this._pendingActions.push(t);return}var i=r.silent;fk.call(this,t,i);var s=r.flush;s?this._zr.flush():s!==!1&&mi.browser.weChat&&this._throttledZrFlush(),Q2.call(this,i),eS.call(this,i)}},e.prototype.updateLabelLayout=function(){Lf.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this._disposed){this.id;return}var r=t.seriesIndex,i=this.getModel(),s=i.getSeriesByIndex(r);s.appendData(t),this._scheduler.unfinished=!0,this.getZr().wakeUp()},e.internalField=function(){Fx=function(m){var v=m._scheduler;v.restorePipelines(m._model),v.prepareStageTasks(),ck(m,!0),ck(m,!1),v.plan()},ck=function(m,v){for(var y=m._model,S=m._scheduler,E=v?m._componentsViews:m._chartsViews,M=v?m._componentsMap:m._chartsMap,C=m._zr,L=m._api,k=0;k<E.length;k++)E[k].__alive=!1;v?y.eachComponent(function(Z,ee){Z!=="series"&&H(ee)}):y.eachSeries(H);function H(Z){var ee=Z.__requireNewView;Z.__requireNewView=!1;var re="_ec_"+Z.id+"_"+Z.type,se=!ee&&M[re];if(!se){var ae=np(Z.type),fe=v?Pc.getClass(ae.main,ae.sub):Ih.getClass(ae.sub);se=new fe,se.init(y,L),M[re]=se,E.push(se),C.add(se.group)}Z.__viewId=se.__id=re,se.__alive=!0,se.__model=Z,se.group.__ecComponentInfo={mainType:Z.mainType,index:Z.componentIndex},!v&&S.prepareView(se,Z,y,L)}for(var k=0;k<E.length;){var q=E[k];q.__alive?k++:(!v&&q.renderTask.dispose(),C.remove(q.group),q.dispose(y,L),E.splice(k,1),M[q.__id]===q&&delete M[q.__id],q.__id=q.group.__ecComponentInfo=null)}},QE=function(m,v,y,S,E){var M=m._model;if(M.setUpdatePayload(y),!S){it([].concat(m._componentsViews).concat(m._chartsViews),q);return}var C={};C[S+"Id"]=y[S+"Id"],C[S+"Index"]=y[S+"Index"],C[S+"Name"]=y[S+"Name"];var L={mainType:S,query:C};E&&(L.subType=E);var k=y.excludeSeriesId,H;k!=null&&(H=ii(),it(pa(k),function(Z){var ee=cp(Z,null);ee!=null&&H.set(ee,!0)})),M&&M.eachComponent(L,function(Z){var ee=H&&H.get(Z.id)!=null;if(!ee)if(N$(y))if(Z instanceof Jf)y.type===Uy&&!y.notBlur&&!Z.get(["emphasis","disabled"])&&JCe(Z,y,m._api);else{var re=NU(Z.mainType,Z.componentIndex,y.name,m._api),se=re.focusSelf,ae=re.dispatchers;y.type===Uy&&se&&!y.notBlur&&hN(Z.mainType,Z.componentIndex,m._api),ae&&it(ae,function(fe){y.type===Uy?rw(fe):iw(fe)})}else pN(y)&&Z instanceof Jf&&(tEe(Z,y,m._api),O$(Z),ch(m))},m),M&&M.eachComponent(L,function(Z){var ee=H&&H.get(Z.id)!=null;ee||q(m[S==="series"?"_chartsMap":"_componentsMap"][Z.__viewId])},m);function q(Z){Z&&Z.__alive&&Z[v]&&Z[v](Z.__model,M,m._api,y)}},x0={prepareAndUpdate:function(m){Fx(this),x0.update.call(this,m,{optionChanged:m.newOption!=null})},update:function(m,v){var y=this._model,S=this._api,E=this._zr,M=this._coordSysMgr,C=this._scheduler;if(y){y.setUpdatePayload(m),C.restoreData(y,m),C.performSeriesTasks(y),M.create(y,S),C.performDataProcessorTasks(y,m),hk(this,y),M.update(y,S),t(y),C.performVisualTasks(y,m),dk(this,y,S,m,v);var L=y.get("backgroundColor")||"transparent",k=y.get("darkMode");E.setBackgroundColor(L),k!=null&&k!=="auto"&&E.setDarkMode(k),Lf.trigger("afterupdate",y,S)}},updateTransform:function(m){var v=this,y=this._model,S=this._api;if(y){y.setUpdatePayload(m);var E=[];y.eachComponent(function(C,L){if(C!=="series"){var k=v.getViewOfComponentModel(L);if(k&&k.__alive)if(k.updateTransform){var H=k.updateTransform(L,y,S,m);H&&H.update&&E.push(k)}else E.push(k)}});var M=ii();y.eachSeries(function(C){var L=v._chartsMap[C.__viewId];if(L.updateTransform){var k=L.updateTransform(C,y,S,m);k&&k.update&&M.set(C.uid,1)}else M.set(C.uid,1)}),t(y),this._scheduler.performVisualTasks(y,m,{setDirty:!0,dirtyMap:M}),eI(this,y,S,m,{},M),Lf.trigger("afterupdate",y,S)}},updateView:function(m){var v=this._model;v&&(v.setUpdatePayload(m),Ih.markUpdateMethod(m,"updateView"),t(v),this._scheduler.performVisualTasks(v,m,{setDirty:!0}),dk(this,v,this._api,m,{}),Lf.trigger("afterupdate",v,this._api))},updateVisual:function(m){var v=this,y=this._model;y&&(y.setUpdatePayload(m),y.eachSeries(function(S){S.getData().clearAllVisual()}),Ih.markUpdateMethod(m,"updateVisual"),t(y),this._scheduler.performVisualTasks(y,m,{visualType:"visual",setDirty:!0}),y.eachComponent(function(S,E){if(S!=="series"){var M=v.getViewOfComponentModel(E);M&&M.__alive&&M.updateVisual(E,y,v._api,m)}}),y.eachSeries(function(S){var E=v._chartsMap[S.__viewId];E.updateVisual(S,y,v._api,m)}),Lf.trigger("afterupdate",y,this._api))},updateLayout:function(m){x0.update.call(this,m)}},uk=function(m,v,y,S){if(m._disposed){m.id;return}for(var E=m._model,M=m._coordSysMgr.getCoordinateSystems(),C,L=aA(E,y),k=0;k<M.length;k++){var H=M[k];if(H[v]&&(C=H[v](E,L,S))!=null)return C}},hk=function(m,v){var y=m._chartsMap,S=m._scheduler;v.eachSeries(function(E){S.updateStreamModes(E,y[E.__viewId])})},fk=function(m,v){var y=this,S=this.getModel(),E=m.type,M=m.escapeConnect,C=XP[E],L=C.actionInfo,k=(L.update||"update").split(":"),H=k.pop(),q=k[0]!=null&&np(k[0]);this[Nl]=!0;var Z=[m],ee=!1;m.batch&&(ee=!0,Z=xr(m.batch,function(Ie){return Ie=ti(Jn({},Ie),m),Ie.batch=null,Ie}));var re=[],se,ae=pN(m),fe=N$(m);if(fe&&kie(this._api),it(Z,function(Ie){if(se=C.action(Ie,y._model,y._api),se=se||Jn({},Ie),se.type=L.event||se.type,re.push(se),fe){var je=DU(m),Le=je.queryOptionMap,ot=je.mainTypeSpecified,ye=ot?Le.keys()[0]:"series";QE(y,H,Ie,ye),ch(y)}else ae?(QE(y,H,Ie,"series"),ch(y)):q&&QE(y,H,Ie,q.main,q.sub)}),H!=="none"&&!fe&&!ae&&!q)try{this[Kc]?(Fx(this),x0.update.call(this,m),this[Kc]=null):x0[H].call(this,m)}catch(Ie){throw this[Nl]=!1,Ie}if(ee?se={type:L.event||E,escapeConnect:M,batch:re}:se=re[0],this[Nl]=!1,!v){var Se=this._messageCenter;if(Se.trigger(se.type,se),ae){var Ce={type:"selectchanged",escapeConnect:M,selected:nEe(S),isFromClick:m.isFromClick||!1,fromAction:m.type,fromActionPayload:m};Se.trigger(Ce.type,Ce)}}},Q2=function(m){for(var v=this._pendingActions;v.length;){var y=v.shift();fk.call(this,y,m)}},eS=function(m){!m&&this.trigger("updated")},eZ=function(m,v){m.on("rendered",function(y){v.trigger("rendered",y),m.animation.isFinished()&&!v[Kc]&&!v._scheduler.unfinished&&!v._pendingActions.length&&v.trigger("finished")})},tZ=function(m,v){m.on("mouseover",function(y){var S=y.target,E=RS(S,dN);E&&(QCe(E,y,v._api),ch(v))}).on("mouseout",function(y){var S=y.target,E=RS(S,dN);E&&(eEe(E,y,v._api),ch(v))}).on("click",function(y){var S=y.target,E=RS(S,function(L){return Wi(L).dataIndex!=null},!0);if(E){var M=E.selected?"unselect":"select",C=Wi(E);v._api.dispatchAction({type:M,dataType:C.dataType,dataIndexInside:C.dataIndex,seriesIndex:C.seriesIndex,isFromClick:!0})}})};function t(m){m.clearColorPalette(),m.eachSeries(function(v){v.clearColorPalette()})}function r(m){var v=[],y=[],S=!1;if(m.eachComponent(function(L,k){var H=k.get("zlevel")||0,q=k.get("z")||0,Z=k.getZLevelKey();S=S||!!Z,(L==="series"?y:v).push({zlevel:H,z:q,idx:k.componentIndex,type:L,key:Z})}),S){var E=v.concat(y),M,C;qI(E,function(L,k){return L.zlevel===k.zlevel?L.z-k.z:L.zlevel-k.zlevel}),it(E,function(L){var k=m.getComponent(L.type,L.idx),H=L.zlevel,q=L.key;M!=null&&(H=Math.max(M,H)),q?(H===M&&q!==C&&H++,C=q):C&&(H===M&&H++,C=""),M=H,k.setZLevel(H)})}}dk=function(m,v,y,S,E){r(v),nZ(m,v,y,S,E),it(m._chartsViews,function(M){M.__alive=!1}),eI(m,v,y,S,E),it(m._chartsViews,function(M){M.__alive||M.remove(v,y)})},nZ=function(m,v,y,S,E,M){it(M||m._componentsViews,function(C){var L=C.__model;h(L,C),C.render(L,v,y,S),l(L,C),d(L,C)})},eI=function(m,v,y,S,E,M){var C=m._scheduler;E=Jn(E||{},{updatedSeries:v.getSeries()}),Lf.trigger("series:beforeupdate",v,y,E);var L=!1;v.eachSeries(function(k){var H=m._chartsMap[k.__viewId];H.__alive=!0;var q=H.renderTask;C.updatePayload(q,S),h(k,H),M&&M.get(k.uid)&&q.dirty(),q.perform(C.getPerformArgs(q))&&(L=!0),H.group.silent=!!k.get("silent"),a(k,H),O$(k)}),C.unfinished=L||C.unfinished,Lf.trigger("series:layoutlabels",v,y,E),Lf.trigger("series:transition",v,y,E),v.eachSeries(function(k){var H=m._chartsMap[k.__viewId];l(k,H),d(k,H)}),s(m,v),Lf.trigger("series:afterupdate",v,y,E)},ch=function(m){m[ak]=!0,m.getZr().wakeUp()},iZ=function(m){m[ak]&&(m.getZr().storage.traverse(function(v){Ob(v)||i(v)}),m[ak]=!1)};function i(m){for(var v=[],y=m.currentStates,S=0;S<y.length;S++){var E=y[S];E==="emphasis"||E==="blur"||E==="select"||v.push(E)}m.selected&&m.states.select&&v.push("select"),m.hoverState===OD&&m.states.emphasis?v.push("emphasis"):m.hoverState===kD&&m.states.blur&&v.push("blur"),m.useStates(v)}function s(m,v){var y=m._zr,S=y.storage,E=0;S.traverse(function(M){M.isGroup||E++}),E>v.get("hoverLayerThreshold")&&!mi.node&&!mi.worker&&v.eachSeries(function(M){if(!M.preventUsingHoverLayer){var C=m._chartsMap[M.__viewId];C.__alive&&C.eachRendered(function(L){L.states.emphasis&&(L.states.emphasis.hoverLayer=!0)})}})}function a(m,v){var y=m.get("blendMode")||null;v.eachRendered(function(S){S.isGroup||(S.style.blend=y)})}function l(m,v){if(!m.preventAutoZ){var y=m.get("z")||0,S=m.get("zlevel")||0;v.eachRendered(function(E){return o(E,y,S,-1/0),!0})}}function o(m,v,y,S){var E=m.getTextContent(),M=m.getTextGuideLine(),C=m.isGroup;if(C)for(var L=m.childrenRef(),k=0;k<L.length;k++)S=Math.max(o(L[k],v,y,S),S);else m.z=v,m.zlevel=y,S=Math.max(m.z2,S);if(E&&(E.z=v,E.zlevel=y,isFinite(S)&&(E.z2=S+2)),M){var H=m.textGuideLineConfig;M.z=v,M.zlevel=y,isFinite(S)&&(M.z2=S+(H&&H.showAbove?1:-1))}return S}function h(m,v){v.eachRendered(function(y){if(!Ob(y)){var S=y.getTextContent(),E=y.getTextGuideLine();y.stateTransition&&(y.stateTransition=null),S&&S.stateTransition&&(S.stateTransition=null),E&&E.stateTransition&&(E.stateTransition=null),y.hasState()?(y.prevStates=y.currentStates,y.clearStates()):y.prevStates&&(y.prevStates=null)}})}function d(m,v){var y=m.getModel("stateAnimation"),S=m.isAnimationEnabled(),E=y.get("duration"),M=E>0?{duration:E,delay:y.get("delay"),easing:y.get("easing")}:null;v.eachRendered(function(C){if(C.states&&C.states.emphasis){if(Ob(C))return;if(C instanceof $i&&aEe(C),C.__dirty){var L=C.prevStates;L&&C.useStates(L)}if(S){C.stateTransition=M;var k=C.getTextContent(),H=C.getTextGuideLine();k&&(k.stateTransition=M),H&&(H.stateTransition=M)}C.__dirty&&i(C)}})}rZ=function(m){return new(function(v){Hn(y,v);function y(){return v!==null&&v.apply(this,arguments)||this}return y.prototype.getCoordinateSystems=function(){return m._coordSysMgr.getCoordinateSystems()},y.prototype.getComponentByElement=function(S){for(;S;){var E=S.__ecComponentInfo;if(E!=null)return m._model.getComponent(E.mainType,E.index);S=S.parent}},y.prototype.enterEmphasis=function(S,E){rw(S,E),ch(m)},y.prototype.leaveEmphasis=function(S,E){iw(S,E),ch(m)},y.prototype.enterBlur=function(S){KCe(S),ch(m)},y.prototype.leaveBlur=function(S){Pie(S),ch(m)},y.prototype.enterSelect=function(S){Lie(S),ch(m)},y.prototype.leaveSelect=function(S){Die(S),ch(m)},y.prototype.getModel=function(){return m.getModel()},y.prototype.getViewOfComponentModel=function(S){return m.getViewOfComponentModel(S)},y.prototype.getViewOfSeriesModel=function(S){return m.getViewOfSeriesModel(S)},y}(Rse))(m)},Toe=function(m){function v(y,S){for(var E=0;E<y.length;E++){var M=y[E];M[lk]=S}}it(dA,function(y,S){m._messageCenter.on(S,function(E){if(sZ[m.group]&&m[lk]!==Qq){if(E&&E.escapeConnect)return;var M=m.makeActionFromEvent(E),C=[];it(pA,function(L){L!==m&&L.group===m.group&&C.push(L)}),v(C,Qq),it(C,function(L){L[lk]!==tLe&&L.dispatchAction(M)}),v(C,nLe)}})})}}(),e}(od),c8=Moe.prototype;c8.on=xoe("on");c8.off=xoe("off");c8.one=function(n,e,t){var r=this;function i(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];e&&e.apply&&e.apply(this,s),r.off(n,i)}this.on.call(this,n,i,t)};var rLe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],XP={},dA={},PN=[],LN=[],$P=[],Coe={},DN={},pA={},sZ={},iLe=+new Date-0,u8="_echarts_instance_";function sLe(n,e,t){{var r=oLe(n);if(r)return r}var i=new Moe(n,e,t);return i.id="ec_"+iLe++,pA[i.id]=i,die(n,u8,i.id),Toe(i),Lf.trigger("afterinit",i),i}function oLe(n){return pA[GMe(n,u8)]}function Eoe(n,e){Coe[n]=e}function Ioe(n){Xi(LN,n)<0&&LN.push(n)}function Roe(n,e){f8(PN,n,e,$Pe)}function aLe(n){h8("afterinit",n)}function lLe(n){h8("afterupdate",n)}function h8(n,e){Lf.on(n,e)}function xp(n,e,t){ci(e)&&(t=e,e="");var r=Xr(n)?n.type:[n,n={event:e}][0];n.event=(n.event||r).toLowerCase(),e=n.event,!dA[e]&&(pp(Jq.test(r)&&Jq.test(e)),XP[r]||(XP[r]={action:t,actionInfo:n}),dA[e]=r)}function cLe(n,e){n8.register(n,e)}function uLe(n,e){f8($P,n,e,voe,"layout")}function S1(n,e){f8($P,n,e,_oe,"visual")}var oZ=[];function f8(n,e,t,r,i){if((ci(e)||Xr(e))&&(t=e,e=r),!(Xi(oZ,t)>=0)){oZ.push(t);var s=roe.wrapStageHandler(t,i);s.__prio=e,s.__raw=t,n.push(s)}}function Poe(n,e){DN[n]=e}function hLe(n,e,t){var r=VPe("registerMap");r&&r(n,e,t)}var fLe=yRe;S1(l8,XRe);S1(n3,$Re);S1(n3,qRe);S1(l8,aPe);S1(n3,lPe);S1(yoe,UPe);Ioe(Lse);Roe(WPe,JIe);Poe("default",ZRe);xp({type:Uy,event:Uy,update:Uy},Ec);xp({type:eR,event:eR,update:eR},Ec);xp({type:lA,event:lA,update:lA},Ec);xp({type:tR,event:tR,update:tR},Ec);xp({type:cA,event:cA,update:cA},Ec);Eoe("light",sPe);Eoe("dark",aoe);function tS(n){return n==null?0:n.length||1}function aZ(n){return n}var gT=function(){function n(e,t,r,i,s,a){this._old=e,this._new=t,this._oldKeyGetter=r||aZ,this._newKeyGetter=i||aZ,this.context=s,this._diffModeMultiple=a==="multiple"}return n.prototype.add=function(e){return this._add=e,this},n.prototype.update=function(e){return this._update=e,this},n.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},n.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},n.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},n.prototype.remove=function(e){return this._remove=e,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var e=this._old,t=this._new,r={},i=new Array(e.length),s=new Array(t.length);this._initIndexMap(e,null,i,"_oldKeyGetter"),this._initIndexMap(t,r,s,"_newKeyGetter");for(var a=0;a<e.length;a++){var l=i[a],o=r[l],h=tS(o);if(h>1){var d=o.shift();o.length===1&&(r[l]=o[0]),this._update&&this._update(d,a)}else h===1?(r[l]=null,this._update&&this._update(o,a)):this._remove&&this._remove(a)}this._performRestAdd(s,r)},n.prototype._executeMultiple=function(){var e=this._old,t=this._new,r={},i={},s=[],a=[];this._initIndexMap(e,r,s,"_oldKeyGetter"),this._initIndexMap(t,i,a,"_newKeyGetter");for(var l=0;l<s.length;l++){var o=s[l],h=r[o],d=i[o],m=tS(h),v=tS(d);if(m>1&&v===1)this._updateManyToOne&&this._updateManyToOne(d,h),i[o]=null;else if(m===1&&v>1)this._updateOneToMany&&this._updateOneToMany(d,h),i[o]=null;else if(m===1&&v===1)this._update&&this._update(d,h),i[o]=null;else if(m>1&&v>1)this._updateManyToMany&&this._updateManyToMany(d,h),i[o]=null;else if(m>1)for(var y=0;y<m;y++)this._remove&&this._remove(h[y]);else this._remove&&this._remove(h)}this._performRestAdd(a,i)},n.prototype._performRestAdd=function(e,t){for(var r=0;r<e.length;r++){var i=e[r],s=t[i],a=tS(s);if(a>1)for(var l=0;l<a;l++)this._add&&this._add(s[l]);else a===1&&this._add&&this._add(s);t[i]=null}},n.prototype._initIndexMap=function(e,t,r,i){for(var s=this._diffModeMultiple,a=0;a<e.length;a++){var l="_ec_"+this[i](e[a],a);if(s||(r[a]=l),!!t){var o=t[l],h=tS(o);h===0?(t[l]=a,s&&r.push(l)):h===1?t[l]=[o,a]:o.push(a)}}},n}(),dLe=function(){function n(e,t){this._encode=e,this._schema=t}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function pLe(n,e){var t={},r=t.encode={},i=ii(),s=[],a=[],l={};it(n.dimensions,function(v){var y=n.getDimensionInfo(v),S=y.coordDim;if(S){var E=y.coordDimIndex;pk(r,S)[E]=v,y.isExtraCoord||(i.set(S,1),gLe(y.type)&&(s[0]=v),pk(l,S)[E]=n.getDimensionIndex(y.name)),y.defaultTooltip&&a.push(v)}Tse.each(function(M,C){var L=pk(r,C),k=y.otherDims[C];k!=null&&k!==!1&&(L[k]=y.name)})});var o=[],h={};i.each(function(v,y){var S=r[y];h[y]=S[0],o=o.concat(S)}),t.dataDimsOnCoord=o,t.dataDimIndicesOnCoord=xr(o,function(v){return n.getDimensionInfo(v).storeDimIndex}),t.encodeFirstDimNotExtra=h;var d=r.label;d&&d.length&&(s=d.slice());var m=r.tooltip;return m&&m.length?a=m.slice():a.length||(a=s.slice()),r.defaultedLabel=s,r.defaultedTooltip=a,t.userOutput=new dLe(l,e),t}function pk(n,e){return n.hasOwnProperty(e)||(n[e]=[]),n[e]}function mLe(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function gLe(n){return!(n==="ordinal"||n==="time")}var oR=function(){function n(e){this.otherDims={},e!=null&&Jn(this,e)}return n}(),vLe=$s(),_Le={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},Loe=function(){function n(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=koe(this.source)))},n.prototype.getSourceDimensionIndex=function(e){return Ei(this._dimNameMap.get(e),-1)},n.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},n.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=kse(this.source),r=!Ooe(e),i="",s=[],a=0,l=0;a<e;a++){var o=void 0,h=void 0,d=void 0,m=this.dimensions[l];if(m&&m.storeDimIndex===a)o=t?m.name:null,h=m.type,d=m.ordinalMeta,l++;else{var v=this.getSourceDimension(a);v&&(o=t?v.name:null,h=v.type)}s.push({property:o,type:h,ordinalMeta:d}),t&&o!=null&&(!m||!m.isCalculationCoord)&&(i+=r?o.replace(/\`/g,"`1").replace(/\$/g,"`2"):o),i+="$",i+=_Le[h]||"f",d&&(i+=d.uid),i+="$"}var y=this.source,S=[y.seriesLayoutBy,y.startIndex,i].join("$$");return{dimensions:s,hash:S}},n.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,r=0;t<this._fullDimCount;t++){var i=void 0,s=this.dimensions[r];if(s&&s.storeDimIndex===t)s.isCalculationCoord||(i=s.name),r++;else{var a=this.getSourceDimension(t);a&&(i=a.name)}e.push(i)}return e},n.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function Doe(n){return n instanceof Loe}function Boe(n){for(var e=ii(),t=0;t<(n||[]).length;t++){var r=n[t],i=Xr(r)?r.name:r;i!=null&&e.get(i)==null&&e.set(i,t)}return e}function koe(n){var e=vLe(n);return e.dimNameMap||(e.dimNameMap=Boe(n.dimensionsDefine))}function Ooe(n){return n>30}var nS=Xr,b0=xr,yLe=typeof Int32Array>"u"?Array:Int32Array,xLe="e\0\0",lZ=-1,bLe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],wLe=["_approximateExtent"],cZ,tI,rS,iS,mk,nI,gk,Foe=function(){function n(e,t){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var r,i=!1;Doe(e)?(r=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(i=!0,r=e),r=r||["x","y"];for(var s={},a=[],l={},o=!1,h={},d=0;d<r.length;d++){var m=r[d],v=Dr(m)?new oR({name:m}):m instanceof oR?m:new oR(m),y=v.name;v.type=v.type||"float",v.coordDim||(v.coordDim=y,v.coordDimIndex=0);var S=v.otherDims=v.otherDims||{};a.push(y),s[y]=v,h[y]!=null&&(o=!0),v.createInvertedIndices&&(l[y]=[]),S.itemName===0&&(this._nameDimIdx=d),S.itemId===0&&(this._idDimIdx=d),i&&(v.storeDimIndex=d)}if(this.dimensions=a,this._dimInfos=s,this._initGetDimensionInfo(o),this.hostModel=t,this._invertedIndicesMap=l,this._dimOmitted){var E=this._dimIdxToName=ii();it(a,function(M){E.set(s[M].storeDimIndex,M)})}}return n.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(t==null)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var r=this._dimIdxToName.get(t);if(r!=null)return r;var i=this._schema.getSourceDimension(t);if(i)return i.name},n.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(t!=null)return t;if(e==null)return-1;var r=this._getDimInfo(e);return r?r.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},n.prototype._recognizeDimIndex=function(e){if(Rs(e)||e!=null&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},n.prototype._getStoreDimIndex=function(e){var t=this.getDimensionIndex(e);return t},n.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},n.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(r){return t.hasOwnProperty(r)?t[r]:void 0}:function(r){return t[r]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(e,t){var r=this._dimSummary;if(t==null)return r.encodeFirstDimNotExtra[e];var i=r.encode[e];return i?i[t]:null},n.prototype.mapDimensionsAll=function(e){var t=this._dimSummary,r=t.encode[e];return(r||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(e,t,r){var i=this,s;if(e instanceof bN&&(s=e),!s){var a=this.dimensions,l=r8(e)||Ic(e)?new Ose(e,a.length):e;s=new bN;var o=b0(a,function(h){return{type:i._dimInfos[h].type,property:h}});s.initData(l,o,r)}this._store=s,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,s.count()),this._dimSummary=pLe(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},n.prototype.appendValues=function(e,t){var r=this._store.appendValues(e,t.length),i=r.start,s=r.end,a=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var l=i;l<s;l++){var o=l-i;this._nameList[l]=t[o],a&&gk(this,l)}},n.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,r=0;r<t.length;r++){var i=this._dimInfos[t[r]];i.ordinalMeta&&e.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return this._idDimIdx==null&&e.getSource().sourceFormat!==ov&&!e.fillStorage},n.prototype._doInit=function(e,t){if(!(e>=t)){var r=this._store,i=r.getProvider();this._updateOrdinalMeta();var s=this._nameList,a=this._idList,l=i.getSource().sourceFormat,o=l===Fh;if(o&&!i.pure)for(var h=[],d=e;d<t;d++){var m=i.getItem(d,h);if(!this.hasItemOption&&EMe(m)&&(this.hasItemOption=!0),m){var v=m.name;s[d]==null&&v!=null&&(s[d]=cp(v,null));var y=m.id;a[d]==null&&y!=null&&(a[d]=cp(y,null))}}if(this._shouldMakeIdFromName())for(var d=e;d<t;d++)gk(this,d);cZ(this)}},n.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},n.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},n.prototype.setCalculationInfo=function(e,t){nS(e)?Jn(this._calculationInfo,e):this._calculationInfo[e]=t},n.prototype.getName=function(e){var t=this.getRawIndex(e),r=this._nameList[t];return r==null&&this._nameDimIdx!=null&&(r=rS(this,this._nameDimIdx,t)),r==null&&(r=""),r},n.prototype._getCategory=function(e,t){var r=this._store.get(e,t),i=this._store.getOrdinalMeta(e);return i?i.categories[r]:r},n.prototype.getId=function(e){return tI(this,this.getRawIndex(e))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.get(i.storeDimIndex,t)},n.prototype.getByRawIndex=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.getByRawIndex(i.storeDimIndex,t)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},n.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},n.prototype.getValues=function(e,t){var r=this,i=this._store;return fr(e)?i.getValues(b0(e,function(s){return r._getStoreDimIndex(s)}),t):i.getValues(e)},n.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,r=0,i=t.length;r<i;r++)if(isNaN(this._store.get(t[r],e)))return!1;return!0},n.prototype.indexOfName=function(e){for(var t=0,r=this._store.count();t<r;t++)if(this.getName(t)===e)return t;return-1},n.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},n.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},n.prototype.rawIndexOf=function(e,t){var r=e&&this._invertedIndicesMap[e],i=r[t];return i==null||isNaN(i)?lZ:i},n.prototype.indicesOfNearest=function(e,t,r){return this._store.indicesOfNearest(this._getStoreDimIndex(e),t,r)},n.prototype.each=function(e,t,r){ci(e)&&(r=t,t=e,e=[]);var i=r||this,s=b0(iS(e),this._getStoreDimIndex,this);this._store.each(s,i?zs(t,i):t)},n.prototype.filterSelf=function(e,t,r){ci(e)&&(r=t,t=e,e=[]);var i=r||this,s=b0(iS(e),this._getStoreDimIndex,this);return this._store=this._store.filter(s,i?zs(t,i):t),this},n.prototype.selectRange=function(e){var t=this,r={},i=so(e);return it(i,function(s){var a=t._getStoreDimIndex(s);r[a]=e[s]}),this._store=this._store.selectRange(r),this},n.prototype.mapArray=function(e,t,r){ci(e)&&(r=t,t=e,e=[]),r=r||this;var i=[];return this.each(e,function(){i.push(t&&t.apply(this,arguments))},r),i},n.prototype.map=function(e,t,r,i){var s=r||i||this,a=b0(iS(e),this._getStoreDimIndex,this),l=nI(this);return l._store=this._store.map(a,s?zs(t,s):t),l},n.prototype.modify=function(e,t,r,i){var s=r||i||this,a=b0(iS(e),this._getStoreDimIndex,this);this._store.modify(a,s?zs(t,s):t)},n.prototype.downSample=function(e,t,r,i){var s=nI(this);return s._store=this._store.downSample(this._getStoreDimIndex(e),t,r,i),s},n.prototype.lttbDownSample=function(e,t){var r=nI(this);return r._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),r},n.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},n.prototype.getItemModel=function(e){var t=this.hostModel,r=this.getRawDataItem(e);return new Ro(r,t,t&&t.ecModel)},n.prototype.diff=function(e){var t=this;return new gT(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(r){return tI(e,r)},function(r){return tI(t,r)})},n.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},n.prototype.setVisual=function(e,t){this._visual=this._visual||{},nS(e)?Jn(this._visual,e):this._visual[e]=t},n.prototype.getItemVisual=function(e,t){var r=this._itemVisuals[e],i=r&&r[t];return i??this.getVisual(t)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(e,t){var r=this._itemVisuals,i=r[e];i||(i=r[e]={});var s=i[t];return s==null&&(s=this.getVisual(t),fr(s)?s=s.slice():nS(s)&&(s=Jn({},s)),i[t]=s),s},n.prototype.setItemVisual=function(e,t,r){var i=this._itemVisuals[e]||{};this._itemVisuals[e]=i,nS(t)?Jn(i,t):i[t]=r},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(e,t){nS(e)?Jn(this._layout,e):this._layout[e]=t},n.prototype.getLayout=function(e){return this._layout[e]},n.prototype.getItemLayout=function(e){return this._itemLayouts[e]},n.prototype.setItemLayout=function(e,t,r){this._itemLayouts[e]=r?Jn(this._itemLayouts[e]||{},t):t},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(e,t){var r=this.hostModel&&this.hostModel.seriesIndex;GCe(r,this.dataType,e,t),this._graphicEls[e]=t},n.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},n.prototype.eachItemGraphicEl=function(e,t){it(this._graphicEls,function(r,i){r&&e&&e.call(t,r,i)})},n.prototype.cloneShallow=function(e){return e||(e=new n(this._schema?this._schema:b0(this.dimensions,this._getDimInfo,this),this.hostModel)),mk(e,this),e._store=this._store,e},n.prototype.wrapMethod=function(e,t){var r=this[e];ci(r)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var i=r.apply(this,arguments);return t.apply(this,[i].concat(MU(arguments)))})},n.internalField=function(){cZ=function(e){var t=e._invertedIndicesMap;it(t,function(r,i){var s=e._dimInfos[i],a=s.ordinalMeta,l=e._store;if(a){r=t[i]=new yLe(a.categories.length);for(var o=0;o<r.length;o++)r[o]=lZ;for(var o=0;o<l.count();o++)r[l.get(s.storeDimIndex,o)]=o}})},rS=function(e,t,r){return cp(e._getCategory(t,r),null)},tI=function(e,t){var r=e._idList[t];return r==null&&e._idDimIdx!=null&&(r=rS(e,e._idDimIdx,t)),r==null&&(r=xLe+t),r},iS=function(e){return fr(e)||(e=e!=null?[e]:[]),e},nI=function(e){var t=new n(e._schema?e._schema:b0(e.dimensions,e._getDimInfo,e),e.hostModel);return mk(t,e),t},mk=function(e,t){it(bLe.concat(t.__wrappedMethods||[]),function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e.__wrappedMethods=t.__wrappedMethods,it(wLe,function(r){e[r]=_i(t[r])}),e._calculationInfo=Jn({},t._calculationInfo)},gk=function(e,t){var r=e._nameList,i=e._idList,s=e._nameDimIdx,a=e._idDimIdx,l=r[t],o=i[t];if(l==null&&s!=null&&(r[t]=l=rS(e,s,t)),o==null&&a!=null&&(i[t]=o=rS(e,a,t)),o==null&&l!=null){var h=e._nameRepeatCount,d=h[l]=(h[l]||0)+1;o=l,d>1&&(o+="__ec__"+d),i[t]=o}}}(),n}();function Noe(n,e){r8(n)||(n=Dse(n)),e=e||{};var t=e.coordDimensions||[],r=e.dimensionsDefine||n.dimensionsDefine||[],i=ii(),s=[],a=ALe(n,t,r,e.dimensionsCount),l=e.canOmitUnusedDimensions&&Ooe(a),o=r===n.dimensionsDefine,h=o?koe(n):Boe(r),d=e.encodeDefine;!d&&e.encodeDefaulter&&(d=e.encodeDefaulter(n,a));for(var m=ii(d),v=new jse(a),y=0;y<v.length;y++)v[y]=-1;function S(se){var ae=v[se];if(ae<0){var fe=r[se],Se=Xr(fe)?fe:{name:fe},Ce=new oR,Ie=Se.name;Ie!=null&&h.get(Ie)!=null&&(Ce.name=Ce.displayName=Ie),Se.type!=null&&(Ce.type=Se.type),Se.displayName!=null&&(Ce.displayName=Se.displayName);var je=s.length;return v[se]=je,Ce.storeDimIndex=se,s.push(Ce),Ce}return s[ae]}if(!l)for(var y=0;y<a;y++)S(y);m.each(function(se,ae){var fe=pa(se).slice();if(fe.length===1&&!Dr(fe[0])&&fe[0]<0){m.set(ae,!1);return}var Se=m.set(ae,[]);it(fe,function(Ce,Ie){var je=Dr(Ce)?h.get(Ce):Ce;je!=null&&je<a&&(Se[Ie]=je,M(S(je),ae,Ie))})});var E=0;it(t,function(se){var ae,fe,Se,Ce;if(Dr(se))ae=se,Ce={};else{Ce=se,ae=Ce.name;var Ie=Ce.ordinalMeta;Ce.ordinalMeta=null,Ce=Jn({},Ce),Ce.ordinalMeta=Ie,fe=Ce.dimsDef,Se=Ce.otherDims,Ce.name=Ce.coordDim=Ce.coordDimIndex=Ce.dimsDef=Ce.otherDims=null}var je=m.get(ae);if(je!==!1){if(je=pa(je),!je.length)for(var Le=0;Le<(fe&&fe.length||1);Le++){for(;E<a&&S(E).coordDim!=null;)E++;E<a&&je.push(E++)}it(je,function(ot,ye){var $e=S(ot);if(o&&Ce.type!=null&&($e.type=Ce.type),M(ti($e,Ce),ae,ye),$e.name==null&&fe){var Ve=fe[ye];!Xr(Ve)&&(Ve={name:Ve}),$e.name=$e.displayName=Ve.name,$e.defaultTooltip=Ve.defaultTooltip}Se&&ti($e.otherDims,Se)})}});function M(se,ae,fe){Tse.get(ae)!=null?se.otherDims[ae]=fe:(se.coordDim=ae,se.coordDimIndex=fe,i.set(ae,!0))}var C=e.generateCoord,L=e.generateCoordCount,k=L!=null;L=C?L||1:0;var H=C||"value";function q(se){se.name==null&&(se.name=se.coordDim)}if(l)it(s,function(se){q(se)}),s.sort(function(se,ae){return se.storeDimIndex-ae.storeDimIndex});else for(var Z=0;Z<a;Z++){var ee=S(Z),re=ee.coordDim;re==null&&(ee.coordDim=TLe(H,i,k),ee.coordDimIndex=0,(!C||L<=0)&&(ee.isExtraCoord=!0),L--),q(ee),ee.type==null&&(Ese(n,Z)===_l.Must||ee.isExtraCoord&&(ee.otherDims.itemName!=null||ee.otherDims.seriesName!=null))&&(ee.type="ordinal")}return SLe(s),new Loe({source:n,dimensions:s,fullDimensionCount:a,dimensionOmitted:l})}function SLe(n){for(var e=ii(),t=0;t<n.length;t++){var r=n[t],i=r.name,s=e.get(i)||0;s>0&&(r.name=i+(s-1)),s++,e.set(i,s)}}function ALe(n,e,t,r){var i=Math.max(n.dimensionsDetectedCount||1,e.length,t.length,r||0);return it(e,function(s){var a;Xr(s)&&(a=s.dimsDef)&&(i=Math.max(i,a.length))}),i}function TLe(n,e,t){if(t||e.hasKey(n)){for(var r=0;e.hasKey(n+r);)r++;n+=r}return e.set(n,!0),n}var MLe=function(){function n(e){this.coordSysDims=[],this.axisMap=ii(),this.categoryAxisMap=ii(),this.coordSysName=e}return n}();function CLe(n){var e=n.get("coordinateSystem"),t=new MLe(e),r=ELe[e];if(r)return r(n,t,t.axisMap,t.categoryAxisMap),t}var ELe={cartesian2d:function(n,e,t,r){var i=n.getReferringComponents("xAxis",xl).models[0],s=n.getReferringComponents("yAxis",xl).models[0];e.coordSysDims=["x","y"],t.set("x",i),t.set("y",s),Nx(i)&&(r.set("x",i),e.firstCategoryDimIndex=0),Nx(s)&&(r.set("y",s),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(n,e,t,r){var i=n.getReferringComponents("singleAxis",xl).models[0];e.coordSysDims=["single"],t.set("single",i),Nx(i)&&(r.set("single",i),e.firstCategoryDimIndex=0)},polar:function(n,e,t,r){var i=n.getReferringComponents("polar",xl).models[0],s=i.findAxisModel("radiusAxis"),a=i.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",s),t.set("angle",a),Nx(s)&&(r.set("radius",s),e.firstCategoryDimIndex=0),Nx(a)&&(r.set("angle",a),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(n,e,t,r){e.coordSysDims=["lng","lat"]},parallel:function(n,e,t,r){var i=n.ecModel,s=i.getComponent("parallel",n.get("parallelIndex")),a=e.coordSysDims=s.dimensions.slice();it(s.parallelAxisIndex,function(l,o){var h=i.getComponent("parallelAxis",l),d=a[o];t.set(d,h),Nx(h)&&(r.set(d,h),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=o))})}};function Nx(n){return n.get("type")==="category"}function ILe(n,e,t){t=t||{};var r=t.byIndex,i=t.stackedCoordDimension,s,a,l;RLe(e)?s=e:(a=e.schema,s=a.dimensions,l=e.store);var o=!!(n&&n.get("stack")),h,d,m,v;if(it(s,function(L,k){Dr(L)&&(s[k]=L={name:L}),o&&!L.isExtraCoord&&(!r&&!h&&L.ordinalMeta&&(h=L),!d&&L.type!=="ordinal"&&L.type!=="time"&&(!i||i===L.coordDim)&&(d=L))}),d&&!r&&!h&&(r=!0),d){m="__\0ecstackresult_"+n.id,v="__\0ecstackedover_"+n.id,h&&(h.createInvertedIndices=!0);var y=d.coordDim,S=d.type,E=0;it(s,function(L){L.coordDim===y&&E++});var M={name:m,coordDim:y,coordDimIndex:E,type:S,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:s.length},C={name:v,coordDim:v,coordDimIndex:E+1,type:S,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:s.length+1};a?(l&&(M.storeDimIndex=l.ensureCalculationDimension(v,S),C.storeDimIndex=l.ensureCalculationDimension(m,S)),a.appendCalculationDimension(M),a.appendCalculationDimension(C)):(s.push(M),s.push(C))}return{stackedDimension:d&&d.name,stackedByDimension:h&&h.name,isStackedByIndex:r,stackedOverDimension:v,stackResultDimension:m}}function RLe(n){return!Doe(n.schema)}function o1(n,e){return!!e&&e===n.getCalculationInfo("stackedDimension")}function PLe(n,e){return o1(n,e)?n.getCalculationInfo("stackResultDimension"):e}function LLe(n,e){var t=n.get("coordinateSystem"),r=n8.get(t),i;return e&&e.coordSysDims&&(i=xr(e.coordSysDims,function(s){var a={name:s},l=e.axisMap.get(s);if(l){var o=l.get("type");a.type=mLe(o)}return a})),i||(i=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),i}function DLe(n,e,t){var r,i;return t&&it(n,function(s,a){var l=s.coordDim,o=t.categoryAxisMap.get(l);o&&(r==null&&(r=a),s.ordinalMeta=o.getOrdinalMeta(),e&&(s.createInvertedIndices=!0)),s.otherDims.itemName!=null&&(i=!0)}),!i&&r!=null&&(n[r].otherDims.itemName=0),r}function d8(n,e,t){t=t||{};var r=e.getSourceManager(),i,s=!1;i=r.getSource(),s=i.sourceFormat===Fh;var a=CLe(e),l=LLe(e,a),o=t.useEncodeDefaulter,h=ci(o)?o:o?vs(CIe,l,e):null,d={coordDimensions:l,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:h,canOmitUnusedDimensions:!s},m=Noe(i,d),v=DLe(m.dimensions,t.createInvertedIndices,a),y=s?null:r.getSharedDataStore(m),S=ILe(e,{schema:m,store:y}),E=new Foe(m,e);E.setCalculationInfo(S);var M=v!=null&&BLe(i)?function(C,L,k,H){return H===v?k:this.defaultDimValueGetter(C,L,k,H)}:null;return E.hasItemOption=!1,E.initData(s?i:y,null,M),E}function BLe(n){if(n.sourceFormat===Fh){var e=kLe(n.data||[]);return!fr(aM(e))}}function kLe(n){for(var e=0;e<n.length&&n[e]==null;)e++;return n[e]}var bp=function(){function n(e){this._setting=e||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(e){return this._setting[e]},n.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},n.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(e,t){var r=this._extent;isNaN(e)||(r[0]=e),isNaN(t)||(r[1]=t)},n.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(e){this._isBlank=e},n}();LD(bp);var OLe=0,BN=function(){function n(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++OLe}return n.createByAxisModel=function(e){var t=e.option,r=t.data,i=r&&xr(r,FLe);return new n({categories:i,needCollect:!i,deduplication:t.dedplication!==!1})},n.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},n.prototype.parseAndCollect=function(e){var t,r=this._needCollect;if(!Dr(e)&&!r)return e;if(r&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var i=this._getOrCreateMap();return t=i.get(e),t==null&&(r?(t=this.categories.length,this.categories[t]=e,i.set(e,t)):t=NaN),t},n.prototype._getOrCreateMap=function(){return this._map||(this._map=ii(this.categories))},n}();function FLe(n){return Xr(n)&&n.value!=null?n.value:n+""}function kN(n){return n.type==="interval"||n.type==="log"}function NLe(n,e,t,r){var i={},s=n[1]-n[0],a=i.interval=aie(s/e);t!=null&&a<t&&(a=i.interval=t),r!=null&&a>r&&(a=i.interval=r);var l=i.intervalPrecision=zoe(a),o=i.niceTickExtent=[Aa(Math.ceil(n[0]/a)*a,l),Aa(Math.floor(n[1]/a)*a,l)];return zLe(o,n),i}function vk(n){var e=Math.pow(10,PU(n)),t=n/e;return t?t===2?t=3:t===3?t=5:t*=2:t=1,Aa(t*e)}function zoe(n){return Rm(n)+2}function uZ(n,e,t){n[e]=Math.max(Math.min(n[e],t[1]),t[0])}function zLe(n,e){!isFinite(n[0])&&(n[0]=e[0]),!isFinite(n[1])&&(n[1]=e[1]),uZ(n,0,e),uZ(n,1,e),n[0]>n[1]&&(n[0]=n[1])}function r3(n,e){return n>=e[0]&&n<=e[1]}function i3(n,e){return e[1]===e[0]?.5:(n-e[0])/(e[1]-e[0])}function s3(n,e){return n*(e[1]-e[0])+e[0]}var p8=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;r.type="ordinal";var i=r.getSetting("ordinalMeta");return i||(i=new BN({})),fr(i)&&(i=new BN({categories:xr(i,function(s){return Xr(s)?s.value:s})})),r._ordinalMeta=i,r._extent=r.getSetting("extent")||[0,i.categories.length-1],r}return e.prototype.parse=function(t){return t==null?NaN:Dr(t)?this._ordinalMeta.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return t=this.parse(t),r3(t,this._extent)&&this._ordinalMeta.categories[t]!=null},e.prototype.normalize=function(t){return t=this._getTickNumber(this.parse(t)),i3(t,this._extent)},e.prototype.scale=function(t){return t=Math.round(s3(t,this._extent)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],r=this._extent,i=r[0];i<=r[1];)t.push({value:i}),i++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(t==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var r=t.ordinalNumbers,i=this._ordinalNumbersByTick=[],s=this._ticksByOrdinalNumber=[],a=0,l=this._ordinalMeta.categories.length,o=Math.min(l,r.length);a<o;++a){var h=r[a];i[a]=h,s[h]=a}for(var d=0;a<l;++a){for(;s[d]!=null;)d++;i.push(d),s[d]=a}},e.prototype._getTickNumber=function(t){var r=this._ticksByOrdinalNumber;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getRawOrdinalNumber=function(t){var r=this._ordinalNumbersByTick;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var r=this.getRawOrdinalNumber(t.value),i=this._ordinalMeta.categories[r];return i==null?"":i+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.isInExtentRange=function(t){return t=this._getTickNumber(t),this._extent[0]<=t&&this._extent[1]>=t},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(bp);bp.registerClass(p8);var J_=Aa,Rw=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return r3(t,this._extent)},e.prototype.normalize=function(t){return i3(t,this._extent)},e.prototype.scale=function(t){return s3(t,this._extent)},e.prototype.setExtent=function(t,r){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(r)||(i[1]=parseFloat(r))},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1]),this.setExtent(r[0],r[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=zoe(t)},e.prototype.getTicks=function(t){var r=this._interval,i=this._extent,s=this._niceExtent,a=this._intervalPrecision,l=[];if(!r)return l;var o=1e4;i[0]<s[0]&&(t?l.push({value:J_(s[0]-r,a)}):l.push({value:i[0]}));for(var h=s[0];h<=s[1]&&(l.push({value:h}),h=J_(h+r,a),h!==l[l.length-1].value);)if(l.length>o)return[];var d=l.length?l[l.length-1].value:s[1];return i[1]>d&&(t?l.push({value:J_(d+r,a)}):l.push({value:i[1]})),l},e.prototype.getMinorTicks=function(t){for(var r=this.getTicks(!0),i=[],s=this.getExtent(),a=1;a<r.length;a++){for(var l=r[a],o=r[a-1],h=0,d=[],m=l.value-o.value,v=m/t;h<t-1;){var y=J_(o.value+(h+1)*v);y>s[0]&&y<s[1]&&d.push(y),h++}i.push(d)}return i},e.prototype.getLabel=function(t,r){if(t==null)return"";var i=r&&r.precision;i==null?i=Rm(t.value)||0:i==="auto"&&(i=this._intervalPrecision);var s=J_(t.value,i,!0);return bse(s)},e.prototype.calcNiceTicks=function(t,r,i){t=t||5;var s=this._extent,a=s[1]-s[0];if(isFinite(a)){a<0&&(a=-a,s.reverse());var l=NLe(s,t,r,i);this._intervalPrecision=l.intervalPrecision,this._interval=l.interval,this._niceExtent=l.niceTickExtent}},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1])if(r[0]!==0){var i=Math.abs(r[0]);t.fixMax||(r[1]+=i/2),r[0]-=i/2}else r[1]=1;var s=r[1]-r[0];isFinite(s)||(r[0]=0,r[1]=1),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval);var a=this._interval;t.fixMin||(r[0]=J_(Math.floor(r[0]/a)*a)),t.fixMax||(r[1]=J_(Math.ceil(r[1]/a)*a))},e.prototype.setNiceExtent=function(t,r){this._niceExtent=[t,r]},e.type="interval",e}(bp);bp.registerClass(Rw);var Uoe=typeof Float32Array<"u",ULe=Uoe?Float32Array:Array;function Lm(n){return fr(n)?Uoe?new Float32Array(n):n:new ULe(n)}var GLe="__ec_stack_";function m8(n){return n.get("stack")||GLe+n.seriesIndex}function g8(n){return n.dim+n.index}function Goe(n,e){var t=[];return e.eachSeriesByType(n,function(r){Hoe(r)&&t.push(r)}),t}function VLe(n){var e={};it(n,function(o){var h=o.coordinateSystem,d=h.getBaseAxis();if(!(d.type!=="time"&&d.type!=="value"))for(var m=o.getData(),v=d.dim+"_"+d.index,y=m.getDimensionIndex(m.mapDimension(d.dim)),S=m.getStore(),E=0,M=S.count();E<M;++E){var C=S.get(y,E);e[v]?e[v].push(C):e[v]=[C]}});var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(i){i.sort(function(o,h){return o-h});for(var s=null,a=1;a<i.length;++a){var l=i[a]-i[a-1];l>0&&(s=s===null?l:Math.min(s,l))}t[r]=s}}return t}function Voe(n){var e=VLe(n),t=[];return it(n,function(r){var i=r.coordinateSystem,s=i.getBaseAxis(),a=s.getExtent(),l;if(s.type==="category")l=s.getBandWidth();else if(s.type==="value"||s.type==="time"){var o=s.dim+"_"+s.index,h=e[o],d=Math.abs(a[1]-a[0]),m=s.scale.getExtent(),v=Math.abs(m[1]-m[0]);l=h?d/v*h:d}else{var y=r.getData();l=Math.abs(a[1]-a[0])/y.count()}var S=ls(r.get("barWidth"),l),E=ls(r.get("barMaxWidth"),l),M=ls(r.get("barMinWidth")||(joe(r)?.5:1),l),C=r.get("barGap"),L=r.get("barCategoryGap");t.push({bandWidth:l,barWidth:S,barMaxWidth:E,barMinWidth:M,barGap:C,barCategoryGap:L,axisKey:g8(s),stackId:m8(r)})}),HLe(t)}function HLe(n){var e={};it(n,function(r,i){var s=r.axisKey,a=r.bandWidth,l=e[s]||{bandWidth:a,remainedWidth:a,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},o=l.stacks;e[s]=l;var h=r.stackId;o[h]||l.autoWidthCount++,o[h]=o[h]||{width:0,maxWidth:0};var d=r.barWidth;d&&!o[h].width&&(o[h].width=d,d=Math.min(l.remainedWidth,d),l.remainedWidth-=d);var m=r.barMaxWidth;m&&(o[h].maxWidth=m);var v=r.barMinWidth;v&&(o[h].minWidth=v);var y=r.barGap;y!=null&&(l.gap=y);var S=r.barCategoryGap;S!=null&&(l.categoryGap=S)});var t={};return it(e,function(r,i){t[i]={};var s=r.stacks,a=r.bandWidth,l=r.categoryGap;if(l==null){var o=so(s).length;l=Math.max(35-o*4,15)+"%"}var h=ls(l,a),d=ls(r.gap,1),m=r.remainedWidth,v=r.autoWidthCount,y=(m-h)/(v+(v-1)*d);y=Math.max(y,0),it(s,function(C){var L=C.maxWidth,k=C.minWidth;if(C.width){var H=C.width;L&&(H=Math.min(H,L)),k&&(H=Math.max(H,k)),C.width=H,m-=H+d*H,v--}else{var H=y;L&&L<H&&(H=Math.min(L,m)),k&&k>H&&(H=k),H!==y&&(C.width=H,m-=H+d*H,v--)}}),y=(m-h)/(v+(v-1)*d),y=Math.max(y,0);var S=0,E;it(s,function(C,L){C.width||(C.width=y),E=C,S+=C.width*(1+d)}),E&&(S-=E.width*d);var M=-S/2;it(s,function(C,L){t[i][L]=t[i][L]||{bandWidth:a,offset:M,width:C.width},M+=C.width*(1+d)})}),t}function jLe(n,e,t){if(n&&e){var r=n[g8(e)];return r!=null&&t!=null?r[m8(t)]:r}}function WLe(n,e){var t=Goe(n,e),r=Voe(t);it(t,function(i){var s=i.getData(),a=i.coordinateSystem,l=a.getBaseAxis(),o=m8(i),h=r[g8(l)][o],d=h.offset,m=h.width;s.setLayout({bandWidth:h.bandWidth,offset:d,size:m})})}function XLe(n){return{seriesType:n,plan:o8(),reset:function(e){if(Hoe(e)){var t=e.getData(),r=e.coordinateSystem,i=r.getBaseAxis(),s=r.getOtherAxis(i),a=t.getDimensionIndex(t.mapDimension(s.dim)),l=t.getDimensionIndex(t.mapDimension(i.dim)),o=e.get("showBackground",!0),h=t.mapDimension(s.dim),d=t.getCalculationInfo("stackResultDimension"),m=o1(t,h)&&!!t.getCalculationInfo("stackedOnSeries"),v=s.isHorizontal(),y=$Le(i,s),S=joe(e),E=e.get("barMinHeight")||0,M=d&&t.getDimensionIndex(d),C=t.getLayout("size"),L=t.getLayout("offset");return{progress:function(k,H){for(var q=k.count,Z=S&&Lm(q*3),ee=S&&o&&Lm(q*3),re=S&&Lm(q),se=r.master.getRect(),ae=v?se.width:se.height,fe,Se=H.getStore(),Ce=0;(fe=k.next())!=null;){var Ie=Se.get(m?M:a,fe),je=Se.get(l,fe),Le=y,ot=void 0;m&&(ot=+Ie-Se.get(a,fe));var ye=void 0,$e=void 0,Ve=void 0,_t=void 0;if(v){var wt=r.dataToPoint([Ie,je]);if(m){var Vt=r.dataToPoint([ot,je]);Le=Vt[0]}ye=Le,$e=wt[1]+L,Ve=wt[0]-Le,_t=C,Math.abs(Ve)<E&&(Ve=(Ve<0?-1:1)*E)}else{var wt=r.dataToPoint([je,Ie]);if(m){var Vt=r.dataToPoint([je,ot]);Le=Vt[1]}ye=wt[0]+L,$e=Le,Ve=C,_t=wt[1]-Le,Math.abs(_t)<E&&(_t=(_t<=0?-1:1)*E)}S?(Z[Ce]=ye,Z[Ce+1]=$e,Z[Ce+2]=v?Ve:_t,ee&&(ee[Ce]=v?se.x:ye,ee[Ce+1]=v?$e:se.y,ee[Ce+2]=ae),re[fe]=fe):H.setItemLayout(fe,{x:ye,y:$e,width:Ve,height:_t}),Ce+=3}S&&H.setLayout({largePoints:Z,largeDataIndices:re,largeBackgroundPoints:ee,valueAxisHorizontal:v})}}}}}}function Hoe(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function joe(n){return n.pipelineContext&&n.pipelineContext.large}function $Le(n,e){var t=e.model.get("startValue");return t||(t=0),e.toGlobalCoord(e.dataToCoord(e.type==="log"?t>0?t:1:t))}var qLe=function(n,e,t,r){for(;t<r;){var i=t+r>>>1;n[i][1]<e?t=i+1:r=i}return t},Woe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="time",r}return e.prototype.getLabel=function(t){var r=this.getSetting("useUTC");return $D(t.value,eq[gIe(Nb(this._minLevelUnit))]||eq.second,r,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,r,i){var s=this.getSetting("useUTC"),a=this.getSetting("locale");return vIe(t,r,i,a,s)},e.prototype.getTicks=function(){var t=this._interval,r=this._extent,i=[];if(!t)return i;i.push({value:r[0],level:0});var s=this.getSetting("useUTC"),a=tDe(this._minLevelUnit,this._approxInterval,s,r);return i=i.concat(a),i.push({value:r[1],level:0}),i},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1]&&(r[0]-=wh,r[1]+=wh),r[1]===-1/0&&r[0]===1/0){var i=new Date;r[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),r[0]=r[1]-wh}this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.calcNiceTicks=function(t,r,i){t=t||10;var s=this._extent,a=s[1]-s[0];this._approxInterval=a/t,r!=null&&this._approxInterval<r&&(this._approxInterval=r),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var l=rI.length,o=Math.min(qLe(rI,this._approxInterval,0,l),l-1);this._interval=rI[o][1],this._minLevelUnit=rI[Math.max(o-1,0)][0]},e.prototype.parse=function(t){return Rs(t)?t:+Km(t)},e.prototype.contain=function(t){return r3(this.parse(t),this._extent)},e.prototype.normalize=function(t){return i3(this.parse(t),this._extent)},e.prototype.scale=function(t){return s3(t,this._extent)},e.type="time",e}(Rw),rI=[["second",ZU],["minute",YU],["hour",hA],["quarter-day",hA*6],["half-day",hA*12],["day",wh*1.2],["half-week",wh*3.5],["week",wh*7],["month",wh*31],["quarter",wh*95],["half-year",Q$/2],["year",Q$]];function ZLe(n,e,t,r){var i=Km(e),s=Km(t),a=function(S){return tq(i,S,r)===tq(s,S,r)},l=function(){return a("year")},o=function(){return l()&&a("month")},h=function(){return o()&&a("day")},d=function(){return h()&&a("hour")},m=function(){return d()&&a("minute")},v=function(){return m()&&a("second")},y=function(){return v()&&a("millisecond")};switch(n){case"year":return l();case"month":return o();case"day":return h();case"hour":return d();case"minute":return m();case"second":return v();case"millisecond":return y()}}function YLe(n,e){return n/=wh,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function KLe(n){var e=30*wh;return n/=e,n>6?6:n>3?3:n>2?2:1}function JLe(n){return n/=hA,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function hZ(n,e){return n/=e?YU:ZU,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function QLe(n){return aie(n)}function eDe(n,e,t){var r=new Date(n);switch(Nb(e)){case"year":case"month":r[mse(t)](0);case"day":r[gse(t)](1);case"hour":r[vse(t)](0);case"minute":r[_se(t)](0);case"second":r[yse(t)](0),r[xse(t)](0)}return r.getTime()}function tDe(n,e,t,r){var i=1e4,s=dse,a=0;function l(ae,fe,Se,Ce,Ie,je,Le){for(var ot=new Date(fe),ye=fe,$e=ot[Ce]();ye<Se&&ye<=r[1];)Le.push({value:ye}),$e+=ae,ot[Ie]($e),ye=ot.getTime();Le.push({value:ye,notAdd:!0})}function o(ae,fe,Se){var Ce=[],Ie=!fe.length;if(!ZLe(Nb(ae),r[0],r[1],t)){Ie&&(fe=[{value:eDe(new Date(r[0]),ae,t)},{value:r[1]}]);for(var je=0;je<fe.length-1;je++){var Le=fe[je].value,ot=fe[je+1].value;if(Le!==ot){var ye=void 0,$e=void 0,Ve=void 0,_t=!1;switch(ae){case"year":ye=Math.max(1,Math.round(e/wh/365)),$e=KU(t),Ve=_Ie(t);break;case"half-year":case"quarter":case"month":ye=KLe(e),$e=zb(t),Ve=mse(t);break;case"week":case"half-week":case"day":ye=YLe(e),$e=qD(t),Ve=gse(t),_t=!0;break;case"half-day":case"quarter-day":case"hour":ye=JLe(e),$e=uT(t),Ve=vse(t);break;case"minute":ye=hZ(e,!0),$e=ZD(t),Ve=_se(t);break;case"second":ye=hZ(e,!1),$e=YD(t),Ve=yse(t);break;case"millisecond":ye=QLe(e),$e=KD(t),Ve=xse(t);break}l(ye,Le,ot,$e,Ve,_t,Ce),ae==="year"&&Se.length>1&&je===0&&Se.unshift({value:Se[0].value-ye})}}for(var je=0;je<Ce.length;je++)Se.push(Ce[je]);return Ce}}for(var h=[],d=[],m=0,v=0,y=0;y<s.length&&a++<i;++y){var S=Nb(s[y]);if(mIe(s[y])){o(s[y],h[h.length-1]||[],d);var E=s[y+1]?Nb(s[y+1]):null;if(S!==E){if(d.length){v=m,d.sort(function(ae,fe){return ae.value-fe.value});for(var M=[],C=0;C<d.length;++C){var L=d[C].value;(C===0||d[C-1].value!==L)&&(M.push(d[C]),L>=r[0]&&L<=r[1]&&m++)}var k=(r[1]-r[0])/e;if(m>k*1.5&&v>k/1.5||(h.push(M),m>k||n===s[y]))break}d=[]}}}for(var H=na(xr(h,function(ae){return na(ae,function(fe){return fe.value>=r[0]&&fe.value<=r[1]&&!fe.notAdd})}),function(ae){return ae.length>0}),q=[],Z=H.length-1,y=0;y<H.length;++y)for(var ee=H[y],re=0;re<ee.length;++re)q.push({value:ee[re].value,level:Z-y});q.sort(function(ae,fe){return ae.value-fe.value});for(var se=[],y=0;y<q.length;++y)(y===0||q[y].value!==q[y-1].value)&&se.push(q[y]);return se}bp.registerClass(Woe);var fZ=bp.prototype,mA=Rw.prototype,nDe=Aa,rDe=Math.floor,iDe=Math.ceil,iI=Math.pow,If=Math.log,v8=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new Rw,t._interval=0,t}return e.prototype.getTicks=function(t){var r=this._originalScale,i=this._extent,s=r.getExtent(),a=mA.getTicks.call(this,t);return xr(a,function(l){var o=l.value,h=Aa(iI(this.base,o));return h=o===i[0]&&this._fixMin?sI(h,s[0]):h,h=o===i[1]&&this._fixMax?sI(h,s[1]):h,{value:h}},this)},e.prototype.setExtent=function(t,r){var i=If(this.base);t=If(Math.max(0,t))/i,r=If(Math.max(0,r))/i,mA.setExtent.call(this,t,r)},e.prototype.getExtent=function(){var t=this.base,r=fZ.getExtent.call(this);r[0]=iI(t,r[0]),r[1]=iI(t,r[1]);var i=this._originalScale,s=i.getExtent();return this._fixMin&&(r[0]=sI(r[0],s[0])),this._fixMax&&(r[1]=sI(r[1],s[1])),r},e.prototype.unionExtent=function(t){this._originalScale.unionExtent(t);var r=this.base;t[0]=If(t[0])/If(r),t[1]=If(t[1])/If(r),fZ.unionExtent.call(this,t)},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.calcNiceTicks=function(t){t=t||10;var r=this._extent,i=r[1]-r[0];if(!(i===1/0||i<=0)){var s=MMe(i),a=t/i*s;for(a<=.5&&(s*=10);!isNaN(s)&&Math.abs(s)<1&&Math.abs(s)>0;)s*=10;var l=[Aa(iDe(r[0]/s)*s),Aa(rDe(r[1]/s)*s)];this._interval=s,this._niceExtent=l}},e.prototype.calcNiceExtent=function(t){mA.calcNiceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return t=If(t)/If(this.base),r3(t,this._extent)},e.prototype.normalize=function(t){return t=If(t)/If(this.base),i3(t,this._extent)},e.prototype.scale=function(t){return t=s3(t,this._extent),iI(this.base,t)},e.type="log",e}(bp),Xoe=v8.prototype;Xoe.getMinorTicks=mA.getMinorTicks;Xoe.getLabel=mA.getLabel;function sI(n,e){return nDe(n,Rm(e))}bp.registerClass(v8);var sDe=function(){function n(e,t,r){this._prepareParams(e,t,r)}return n.prototype._prepareParams=function(e,t,r){r[1]<r[0]&&(r=[NaN,NaN]),this._dataMin=r[0],this._dataMax=r[1];var i=this._isOrdinal=e.type==="ordinal";this._needCrossZero=e.type==="interval"&&t.getNeedCrossZero&&t.getNeedCrossZero();var s=t.get("min",!0);s==null&&(s=t.get("startValue",!0));var a=this._modelMinRaw=s;ci(a)?this._modelMinNum=oI(e,a({min:r[0],max:r[1]})):a!=="dataMin"&&(this._modelMinNum=oI(e,a));var l=this._modelMaxRaw=t.get("max",!0);if(ci(l)?this._modelMaxNum=oI(e,l({min:r[0],max:r[1]})):l!=="dataMax"&&(this._modelMaxNum=oI(e,l)),i)this._axisDataLen=t.getCategories().length;else{var o=t.get("boundaryGap"),h=fr(o)?o:[o||0,o||0];typeof h[0]=="boolean"||typeof h[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[gv(h[0],1),gv(h[1],1)]}},n.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,r=this._dataMax,i=this._axisDataLen,s=this._boundaryGapInner,a=e?null:r-t||Math.abs(t),l=this._modelMinRaw==="dataMin"?t:this._modelMinNum,o=this._modelMaxRaw==="dataMax"?r:this._modelMaxNum,h=l!=null,d=o!=null;l==null&&(l=e?i?0:NaN:t-s[0]*a),o==null&&(o=e?i?i-1:NaN:r+s[1]*a),(l==null||!isFinite(l))&&(l=NaN),(o==null||!isFinite(o))&&(o=NaN);var m=wP(l)||wP(o)||e&&!i;this._needCrossZero&&(l>0&&o>0&&!h&&(l=0),l<0&&o<0&&!d&&(o=0));var v=this._determinedMin,y=this._determinedMax;return v!=null&&(l=v,h=!0),y!=null&&(o=y,d=!0),{min:l,max:o,minFixed:h,maxFixed:d,isBlank:m}},n.prototype.modifyDataMinMax=function(e,t){this[aDe[e]]=t},n.prototype.setDeterminedMinMax=function(e,t){var r=oDe[e];this[r]=t},n.prototype.freeze=function(){this.frozen=!0},n}(),oDe={min:"_determinedMin",max:"_determinedMax"},aDe={min:"_dataMin",max:"_dataMax"};function $oe(n,e,t){var r=n.rawExtentInfo;return r||(r=new sDe(n,e,t),n.rawExtentInfo=r,r)}function oI(n,e){return e==null?null:wP(e)?NaN:n.parse(e)}function qoe(n,e){var t=n.type,r=$oe(n,e,n.getExtent()).calculate();n.setBlank(r.isBlank);var i=r.min,s=r.max,a=e.ecModel;if(a&&t==="time"){var l=Goe("bar",a),o=!1;if(it(l,function(m){o=o||m.getBaseAxis()===e.axis}),o){var h=Voe(l),d=lDe(i,s,e,h);i=d.min,s=d.max}}return{extent:[i,s],fixMin:r.minFixed,fixMax:r.maxFixed}}function lDe(n,e,t,r){var i=t.axis.getExtent(),s=i[1]-i[0],a=jLe(r,t.axis);if(a===void 0)return{min:n,max:e};var l=1/0;it(a,function(y){l=Math.min(y.offset,l)});var o=-1/0;it(a,function(y){o=Math.max(y.offset+y.width,o)}),l=Math.abs(l),o=Math.abs(o);var h=l+o,d=e-n,m=1-(l+o)/s,v=d/m-d;return e+=v*(o/h),n-=v*(l/h),{min:n,max:e}}function qP(n,e){var t=e,r=qoe(n,t),i=r.extent,s=t.get("splitNumber");n instanceof v8&&(n.base=t.get("logBase"));var a=n.type,l=t.get("interval"),o=a==="interval"||a==="time";n.setExtent(i[0],i[1]),n.calcNiceExtent({splitNumber:s,fixMin:r.fixMin,fixMax:r.fixMax,minInterval:o?t.get("minInterval"):null,maxInterval:o?t.get("maxInterval"):null}),l!=null&&n.setInterval&&n.setInterval(l)}function Zoe(n,e){if(e=e||n.get("type"),e)switch(e){case"category":return new p8({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new Woe({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(bp.getClass(e)||Rw)}}function cDe(n){var e=n.scale.getExtent(),t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function Pw(n){var e=n.getLabelModel().get("formatter"),t=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(r){return function(i,s){return n.scale.getFormattedLabel(i,s,r)}}(e):Dr(e)?function(r){return function(i){var s=n.scale.getLabel(i),a=r.replace("{value}",s??"");return a}}(e):ci(e)?function(r){return function(i,s){return t!=null&&(s=i.value-t),r(_8(n,i),s,i.level!=null?{level:i.level}:null)}}(e):function(r){return n.scale.getLabel(r)}}function _8(n,e){return n.type==="category"?n.scale.getLabel(e):e.value}function uDe(n){var e=n.model,t=n.scale;if(!(!e.get(["axisLabel","show"])||t.isBlank())){var r,i,s=t.getExtent();t instanceof p8?i=t.count():(r=t.getTicks(),i=r.length);var a=n.getLabelModel(),l=Pw(n),o,h=1;i>40&&(h=Math.ceil(i/40));for(var d=0;d<i;d+=h){var m=r?r[d]:{value:s[0]+d},v=l(m,d),y=a.getTextRect(v),S=hDe(y,a.get("rotate")||0);o?o.union(S):o=S}return o}}function hDe(n,e){var t=e*Math.PI/180,r=n.width,i=n.height,s=r*Math.abs(Math.cos(t))+Math.abs(i*Math.sin(t)),a=r*Math.abs(Math.sin(t))+Math.abs(i*Math.cos(t)),l=new cs(n.x,n.y,s,a);return l}function y8(n){var e=n.get("interval");return e??"auto"}function Yoe(n){return n.type==="category"&&y8(n.getLabelModel())===0}function ZP(n,e){var t={};return it(n.mapDimensionsAll(e),function(r){t[PLe(n,r)]=!0}),so(t)}function fDe(n,e,t){e&&it(ZP(e,t),function(r){var i=e.getApproximateExtent(r);i[0]<n[0]&&(n[0]=i[0]),i[1]>n[1]&&(n[1]=i[1])})}var Koe=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var e=this.option;return!e.scale},n.prototype.getCoordSysModel=function(){},n}(),dZ=[],dDe={registerPreprocessor:Ioe,registerProcessor:Roe,registerPostInit:aLe,registerPostUpdate:lLe,registerUpdateLifecycle:h8,registerAction:xp,registerCoordinateSystem:cLe,registerLayout:uLe,registerVisual:S1,registerTransform:fLe,registerLoading:Poe,registerMap:hLe,registerImpl:GPe,PRIORITY:eLe,ComponentModel:os,ComponentView:Pc,SeriesModel:Jf,ChartView:Ih,registerComponentModel:function(n){os.registerClass(n)},registerComponentView:function(n){Pc.registerClass(n)},registerSeriesModel:function(n){Jf.registerClass(n)},registerChartView:function(n){Ih.registerClass(n)},registerSubTypeDefaulter:function(n,e){os.registerSubTypeDefaulter(n,e)},registerPainter:function(n,e){yMe(n,e)}};function mp(n){if(fr(n)){it(n,function(e){mp(e)});return}Xi(dZ,n)>=0||(dZ.push(n),ci(n)&&(n={install:n}),n.install(dDe))}var vT=$s();function Joe(n,e){var t=xr(e,function(r){return n.scale.parse(r)});return n.type==="time"&&t.length>0&&(t.sort(),t.unshift(t[0]),t.push(t[t.length-1])),t}function pDe(n){var e=n.getLabelModel().get("customValues");if(e){var t=Pw(n);return{labels:Joe(n,e).map(function(r){var i={value:r};return{formattedLabel:t(i),rawLabel:n.scale.getLabel(i),tickValue:r}})}}return n.type==="category"?gDe(n):_De(n)}function mDe(n,e){var t=n.getTickModel().get("customValues");return t?{ticks:Joe(n,t)}:n.type==="category"?vDe(n,e):{ticks:xr(n.scale.getTicks(),function(r){return r.value})}}function gDe(n){var e=n.getLabelModel(),t=Qoe(n,e);return!e.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:t.labelCategoryInterval}:t}function Qoe(n,e){var t=eae(n,"labels"),r=y8(e),i=tae(t,r);if(i)return i;var s,a;return ci(r)?s=iae(n,r):(a=r==="auto"?yDe(n):r,s=rae(n,a)),nae(t,r,{labels:s,labelCategoryInterval:a})}function vDe(n,e){var t=eae(n,"ticks"),r=y8(e),i=tae(t,r);if(i)return i;var s,a;if((!e.get("show")||n.scale.isBlank())&&(s=[]),ci(r))s=iae(n,r,!0);else if(r==="auto"){var l=Qoe(n,n.getLabelModel());a=l.labelCategoryInterval,s=xr(l.labels,function(o){return o.tickValue})}else a=r,s=rae(n,a,!0);return nae(t,r,{ticks:s,tickCategoryInterval:a})}function _De(n){var e=n.scale.getTicks(),t=Pw(n);return{labels:xr(e,function(r,i){return{level:r.level,formattedLabel:t(r,i),rawLabel:n.scale.getLabel(r),tickValue:r.value}})}}function eae(n,e){return vT(n)[e]||(vT(n)[e]=[])}function tae(n,e){for(var t=0;t<n.length;t++)if(n[t].key===e)return n[t].value}function nae(n,e,t){return n.push({key:e,value:t}),t}function yDe(n){var e=vT(n).autoInterval;return e??(vT(n).autoInterval=n.calculateCategoryInterval())}function xDe(n){var e=bDe(n),t=Pw(n),r=(e.axisRotate-e.labelRotate)/180*Math.PI,i=n.scale,s=i.getExtent(),a=i.count();if(s[1]-s[0]<1)return 0;var l=1;a>40&&(l=Math.max(1,Math.floor(a/40)));for(var o=s[0],h=n.dataToCoord(o+1)-n.dataToCoord(o),d=Math.abs(h*Math.cos(r)),m=Math.abs(h*Math.sin(r)),v=0,y=0;o<=s[1];o+=l){var S=0,E=0,M=oM(t({value:o}),e.font,"center","top");S=M.width*1.3,E=M.height*1.3,v=Math.max(v,S,7),y=Math.max(y,E,7)}var C=v/d,L=y/m;isNaN(C)&&(C=1/0),isNaN(L)&&(L=1/0);var k=Math.max(0,Math.floor(Math.min(C,L))),H=vT(n.model),q=n.getExtent(),Z=H.lastAutoInterval,ee=H.lastTickCount;return Z!=null&&ee!=null&&Math.abs(Z-k)<=1&&Math.abs(ee-a)<=1&&Z>k&&H.axisExtent0===q[0]&&H.axisExtent1===q[1]?k=Z:(H.lastTickCount=a,H.lastAutoInterval=k,H.axisExtent0=q[0],H.axisExtent1=q[1]),k}function bDe(n){var e=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}function rae(n,e,t){var r=Pw(n),i=n.scale,s=i.getExtent(),a=n.getLabelModel(),l=[],o=Math.max((e||0)+1,1),h=s[0],d=i.count();h!==0&&o>1&&d/o>2&&(h=Math.round(Math.ceil(h/o)*o));var m=Yoe(n),v=a.get("showMinLabel")||m,y=a.get("showMaxLabel")||m;v&&h!==s[0]&&E(s[0]);for(var S=h;S<=s[1];S+=o)E(S);y&&S-o!==s[1]&&E(s[1]);function E(M){var C={value:M};l.push(t?M:{formattedLabel:r(C),rawLabel:i.getLabel(C),tickValue:M})}return l}function iae(n,e,t){var r=n.scale,i=Pw(n),s=[];return it(r.getTicks(),function(a){var l=r.getLabel(a),o=a.value;e(a.value,l)&&s.push(t?o:{formattedLabel:i(a),rawLabel:l,tickValue:o})}),s}var pZ=[0,1],A1=function(){function n(e,t,r){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=r||[0,0]}return n.prototype.contain=function(e){var t=this._extent,r=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]);return e>=r&&e<=i},n.prototype.containData=function(e){return this.scale.contain(e)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(e){return sie(e||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(e,t){var r=this._extent;r[0]=e,r[1]=t},n.prototype.dataToCoord=function(e,t){var r=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&i.type==="ordinal"&&(r=r.slice(),mZ(r,i.count())),F0(e,pZ,r,t)},n.prototype.coordToData=function(e,t){var r=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(r=r.slice(),mZ(r,i.count()));var s=F0(e,r,pZ,t);return this.scale.scale(s)},n.prototype.pointToData=function(e,t){},n.prototype.getTicksCoords=function(e){e=e||{};var t=e.tickModel||this.getTickModel(),r=mDe(this,t),i=r.ticks,s=xr(i,function(l){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(l):l),tickValue:l}},this),a=t.get("alignWithLabel");return wDe(this,s,a,e.clamp),s},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var e=this.model.getModel("minorTick"),t=e.get("splitNumber");t>0&&t<100||(t=5);var r=this.scale.getMinorTicks(t),i=xr(r,function(s){return xr(s,function(a){return{coord:this.dataToCoord(a),tickValue:a}},this)},this);return i},n.prototype.getViewLabels=function(){return pDe(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),r=t[1]-t[0]+(this.onBand?1:0);r===0&&(r=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/r},n.prototype.calculateCategoryInterval=function(){return xDe(this)},n}();function mZ(n,e){var t=n[1]-n[0],r=e,i=t/r/2;n[0]+=i,n[1]-=i}function wDe(n,e,t,r){var i=e.length;if(!n.onBand||t||!i)return;var s=n.getExtent(),a,l;if(i===1)e[0].coord=s[0],a=e[1]={coord:s[1]};else{var o=e[i-1].tickValue-e[0].tickValue,h=(e[i-1].coord-e[0].coord)/o;it(e,function(y){y.coord-=h/2});var d=n.scale.getExtent();l=1+d[1]-e[i-1].tickValue,a={coord:e[i-1].coord+h*l},e.push(a)}var m=s[0]>s[1];v(e[0].coord,s[0])&&(r?e[0].coord=s[0]:e.shift()),r&&v(s[0],e[0].coord)&&e.unshift({coord:s[0]}),v(s[1],a.coord)&&(r?a.coord=s[1]:e.pop()),r&&v(a.coord,s[1])&&e.push({coord:s[1]});function v(y,S){return y=Aa(y),S=Aa(S),m?y>S:y<S}}var sS=Math.PI*2,Q_=Jm.CMD,SDe=["top","right","bottom","left"];function ADe(n,e,t,r,i){var s=t.width,a=t.height;switch(n){case"top":r.set(t.x+s/2,t.y-e),i.set(0,-1);break;case"bottom":r.set(t.x+s/2,t.y+a+e),i.set(0,1);break;case"left":r.set(t.x-e,t.y+a/2),i.set(-1,0);break;case"right":r.set(t.x+s+e,t.y+a/2),i.set(1,0);break}}function TDe(n,e,t,r,i,s,a,l,o){a-=n,l-=e;var h=Math.sqrt(a*a+l*l);a/=h,l/=h;var d=a*t+n,m=l*t+e;if(Math.abs(r-i)%sS<1e-4)return o[0]=d,o[1]=m,h-t;if(s){var v=r;r=Pm(i),i=Pm(v)}else r=Pm(r),i=Pm(i);r>i&&(i+=sS);var y=Math.atan2(l,a);if(y<0&&(y+=sS),y>=r&&y<=i||y+sS>=r&&y+sS<=i)return o[0]=d,o[1]=m,h-t;var S=t*Math.cos(r)+n,E=t*Math.sin(r)+e,M=t*Math.cos(i)+n,C=t*Math.sin(i)+e,L=(S-a)*(S-a)+(E-l)*(E-l),k=(M-a)*(M-a)+(C-l)*(C-l);return L<k?(o[0]=S,o[1]=E,Math.sqrt(L)):(o[0]=M,o[1]=C,Math.sqrt(k))}function YP(n,e,t,r,i,s,a,l){var o=i-n,h=s-e,d=t-n,m=r-e,v=Math.sqrt(d*d+m*m);d/=v,m/=v;var y=o*d+h*m,S=y/v;l&&(S=Math.min(Math.max(S,0),1)),S*=v;var E=a[0]=n+S*d,M=a[1]=e+S*m;return Math.sqrt((E-i)*(E-i)+(M-s)*(M-s))}function sae(n,e,t,r,i,s,a){t<0&&(n=n+t,t=-t),r<0&&(e=e+r,r=-r);var l=n+t,o=e+r,h=a[0]=Math.min(Math.max(i,n),l),d=a[1]=Math.min(Math.max(s,e),o);return Math.sqrt((h-i)*(h-i)+(d-s)*(d-s))}var kf=[];function MDe(n,e,t){var r=sae(e.x,e.y,e.width,e.height,n.x,n.y,kf);return t.set(kf[0],kf[1]),r}function CDe(n,e,t){for(var r=0,i=0,s=0,a=0,l,o,h=1/0,d=e.data,m=n.x,v=n.y,y=0;y<d.length;){var S=d[y++];y===1&&(r=d[y],i=d[y+1],s=r,a=i);var E=h;switch(S){case Q_.M:s=d[y++],a=d[y++],r=s,i=a;break;case Q_.L:E=YP(r,i,d[y],d[y+1],m,v,kf,!0),r=d[y++],i=d[y++];break;case Q_.C:E=$re(r,i,d[y++],d[y++],d[y++],d[y++],d[y],d[y+1],m,v,kf),r=d[y++],i=d[y++];break;case Q_.Q:E=Zre(r,i,d[y++],d[y++],d[y],d[y+1],m,v,kf),r=d[y++],i=d[y++];break;case Q_.A:var M=d[y++],C=d[y++],L=d[y++],k=d[y++],H=d[y++],q=d[y++];y+=1;var Z=!!(1-d[y++]);l=Math.cos(H)*L+M,o=Math.sin(H)*k+C,y<=1&&(s=l,a=o);var ee=(m-M)*k/L+M;E=TDe(M,C,k,H,H+q,Z,ee,v,kf),r=Math.cos(H+q)*L+M,i=Math.sin(H+q)*k+C;break;case Q_.R:s=r=d[y++],a=i=d[y++];var re=d[y++],se=d[y++];E=sae(s,a,re,se,m,v,kf);break;case Q_.Z:E=YP(r,i,s,a,m,v,kf,!0),r=s,i=a;break}E<h&&(h=E,t.set(kf[0],kf[1]))}return h}var Vf=new Jr,Os=new Jr,ea=new Jr,rp=new Jr,Jd=new Jr;function gZ(n,e){if(n){var t=n.getTextGuideLine(),r=n.getTextContent();if(r&&t){var i=n.textGuideLineConfig||{},s=[[0,0],[0,0],[0,0]],a=i.candidates||SDe,l=r.getBoundingRect().clone();l.applyTransform(r.getComputedTransform());var o=1/0,h=i.anchor,d=n.getComputedTransform(),m=d&&ID([],d),v=e.get("length2")||0;h&&ea.copy(h);for(var y=0;y<a.length;y++){var S=a[y];ADe(S,0,l,Vf,rp),Jr.scaleAndAdd(Os,Vf,rp,v),Os.transform(m);var E=n.getBoundingRect(),M=h?h.distance(Os):n instanceof $i?CDe(Os,n.path,ea):MDe(Os,E,ea);M<o&&(o=M,Os.transform(d),ea.transform(d),ea.toArray(s[0]),Os.toArray(s[1]),Vf.toArray(s[2]))}oae(s,e.get("minTurnAngle")),t.setShape({points:s})}}}var KP=[],bc=new Jr;function oae(n,e){if(e<=180&&e>0){e=e/180*Math.PI,Vf.fromArray(n[0]),Os.fromArray(n[1]),ea.fromArray(n[2]),Jr.sub(rp,Vf,Os),Jr.sub(Jd,ea,Os);var t=rp.len(),r=Jd.len();if(!(t<.001||r<.001)){rp.scale(1/t),Jd.scale(1/r);var i=rp.dot(Jd),s=Math.cos(e);if(s<i){var a=YP(Os.x,Os.y,ea.x,ea.y,Vf.x,Vf.y,KP,!1);bc.fromArray(KP),bc.scaleAndAdd(Jd,a/Math.tan(Math.PI-e));var l=ea.x!==Os.x?(bc.x-Os.x)/(ea.x-Os.x):(bc.y-Os.y)/(ea.y-Os.y);if(isNaN(l))return;l<0?Jr.copy(bc,Os):l>1&&Jr.copy(bc,ea),bc.toArray(n[1])}}}}function EDe(n,e,t){if(t<=180&&t>0){t=t/180*Math.PI,Vf.fromArray(n[0]),Os.fromArray(n[1]),ea.fromArray(n[2]),Jr.sub(rp,Os,Vf),Jr.sub(Jd,ea,Os);var r=rp.len(),i=Jd.len();if(!(r<.001||i<.001)){rp.scale(1/r),Jd.scale(1/i);var s=rp.dot(e),a=Math.cos(t);if(s<a){var l=YP(Os.x,Os.y,ea.x,ea.y,Vf.x,Vf.y,KP,!1);bc.fromArray(KP);var o=Math.PI/2,h=Math.acos(Jd.dot(e)),d=o+h-t;if(d>=o)Jr.copy(bc,ea);else{bc.scaleAndAdd(Jd,l/Math.tan(Math.PI/2-d));var m=ea.x!==Os.x?(bc.x-Os.x)/(ea.x-Os.x):(bc.y-Os.y)/(ea.y-Os.y);if(isNaN(m))return;m<0?Jr.copy(bc,Os):m>1&&Jr.copy(bc,ea)}bc.toArray(n[1])}}}}function _k(n,e,t,r){var i=t==="normal",s=i?n:n.ensureState(t);s.ignore=e;var a=r.get("smooth");a&&a===!0&&(a=.3),s.shape=s.shape||{},a>0&&(s.shape.smooth=a);var l=r.getModel("lineStyle").getLineStyle();i?n.useStyle(l):s.style=l}function IDe(n,e){var t=e.smooth,r=e.points;if(r)if(n.moveTo(r[0][0],r[0][1]),t>0&&r.length>=3){var i=WF(r[0],r[1]),s=WF(r[1],r[2]);if(!i||!s){n.lineTo(r[1][0],r[1][1]),n.lineTo(r[2][0],r[2][1]);return}var a=Math.min(i,s)*t,l=$I([],r[1],r[0],a/i),o=$I([],r[1],r[2],a/s),h=$I([],l,o,.5);n.bezierCurveTo(l[0],l[1],l[0],l[1],h[0],h[1]),n.bezierCurveTo(o[0],o[1],o[0],o[1],r[2][0],r[2][1])}else for(var d=1;d<r.length;d++)n.lineTo(r[d][0],r[d][1])}function aae(n,e,t){var r=n.getTextGuideLine(),i=n.getTextContent();if(!i){r&&n.removeTextGuideLine();return}for(var s=e.normal,a=s.get("show"),l=i.ignore,o=0;o<BP.length;o++){var h=BP[o],d=e[h],m=h==="normal";if(d){var v=d.get("show"),y=m?l:Ei(i.states[h]&&i.states[h].ignore,l);if(y||!Ei(v,a)){var S=m?r:r&&r.states[h];S&&(S.ignore=!0),r&&_k(r,!0,h,d);continue}r||(r=new Cw,n.setTextGuideLine(r),!m&&(l||!a)&&_k(r,!0,"normal",e.normal),n.stateProxy&&(r.stateProxy=n.stateProxy)),_k(r,!1,h,d)}}if(r){ti(r.style,t),r.style.fill=null;var E=s.get("showAbove"),M=n.textGuideLineConfig=n.textGuideLineConfig||{};M.showAbove=E||!1,r.buildPath=IDe}}function lae(n,e){e=e||"labelLine";for(var t={normal:n.getModel(e)},r=0;r<kh.length;r++){var i=kh[r];t[i]=n.getModel([i,e])}return t}function cae(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.defaultAttr.ignore){var i=r.label,s=i.getComputedTransform(),a=i.getBoundingRect(),l=!s||s[1]<1e-5&&s[2]<1e-5,o=i.style.margin||0,h=a.clone();h.applyTransform(s),h.x-=o/2,h.y-=o/2,h.width+=o,h.height+=o;var d=l?new OP(a,s):null;e.push({label:i,labelLine:r.labelLine,rect:h,localRect:a,obb:d,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:l,transform:s})}}return e}function uae(n,e,t,r,i,s){var a=n.length;if(a<2)return;n.sort(function(re,se){return re.rect[e]-se.rect[e]});for(var l=0,o,h=!1,d=0,m=0;m<a;m++){var v=n[m],y=v.rect;o=y[e]-l,o<0&&(y[e]-=o,v.label[e]-=o,h=!0);var S=Math.max(-o,0);d+=S,l=y[e]+y[t]}d>0&&s&&q(-d/a,0,a);var E=n[0],M=n[a-1],C,L;k(),C<0&&Z(-C,.8),L<0&&Z(L,.8),k(),H(C,L,1),H(L,C,-1),k(),C<0&&ee(-C),L<0&&ee(L);function k(){C=E.rect[e]-r,L=i-M.rect[e]-M.rect[t]}function H(re,se,ae){if(re<0){var fe=Math.min(se,-re);if(fe>0){q(fe*ae,0,a);var Se=fe+re;Se<0&&Z(-Se*ae,1)}else Z(-re*ae,1)}}function q(re,se,ae){re!==0&&(h=!0);for(var fe=se;fe<ae;fe++){var Se=n[fe],Ce=Se.rect;Ce[e]+=re,Se.label[e]+=re}}function Z(re,se){for(var ae=[],fe=0,Se=1;Se<a;Se++){var Ce=n[Se-1].rect,Ie=Math.max(n[Se].rect[e]-Ce[e]-Ce[t],0);ae.push(Ie),fe+=Ie}if(fe){var je=Math.min(Math.abs(re)/fe,se);if(re>0)for(var Se=0;Se<a-1;Se++){var Le=ae[Se]*je;q(Le,0,Se+1)}else for(var Se=a-1;Se>0;Se--){var Le=ae[Se-1]*je;q(-Le,Se,a)}}}function ee(re){var se=re<0?-1:1;re=Math.abs(re);for(var ae=Math.ceil(re/(a-1)),fe=0;fe<a-1;fe++)if(se>0?q(ae,0,fe+1):q(-ae,a-fe-1,a),re-=ae,re<=0)return}return h}function RDe(n,e,t,r){return uae(n,"x","width",e,t,r)}function hae(n,e,t,r){return uae(n,"y","height",e,t,r)}function fae(n){var e=[];n.sort(function(E,M){return M.priority-E.priority});var t=new cs(0,0,0,0);function r(E){if(!E.ignore){var M=E.ensureState("emphasis");M.ignore==null&&(M.ignore=!1)}E.ignore=!0}for(var i=0;i<n.length;i++){var s=n[i],a=s.axisAligned,l=s.localRect,o=s.transform,h=s.label,d=s.labelLine;t.copy(s.rect),t.width-=.1,t.height-=.1,t.x+=.05,t.y+=.05;for(var m=s.obb,v=!1,y=0;y<e.length;y++){var S=e[y];if(t.intersect(S.rect)){if(a&&S.axisAligned){v=!0;break}if(S.obb||(S.obb=new OP(S.localRect,S.transform)),m||(m=new OP(l,o)),m.intersect(S.obb)){v=!0;break}}}v?(r(h),d&&r(d)):(h.attr("ignore",s.defaultAttr.ignore),d&&d.attr("ignore",s.defaultAttr.labelGuideIgnore),e.push(s))}}function PDe(n){if(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t].slice());return e}}function LDe(n,e){var t=n.label,r=e&&e.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:t.style.align,verticalAlign:t.style.verticalAlign,labelLinePoints:PDe(r&&r.shape.points)}}var vZ=["align","verticalAlign","width","height","fontSize"],gc=new sM,yk=$s(),DDe=$s();function aI(n,e,t){for(var r=0;r<t.length;r++){var i=t[r];e[i]!=null&&(n[i]=e[i])}}var lI=["x","y","rotation"],BDe=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(e,t,r,i,s){var a=i.style,l=i.__hostTarget,o=l.textConfig||{},h=i.getComputedTransform(),d=i.getBoundingRect().plain();cs.applyTransform(d,d,h),h?gc.setLocalTransform(h):(gc.x=gc.y=gc.rotation=gc.originX=gc.originY=0,gc.scaleX=gc.scaleY=1),gc.rotation=Pm(gc.rotation);var m=i.__hostTarget,v;if(m){v=m.getBoundingRect().plain();var y=m.getComputedTransform();cs.applyTransform(v,v,y)}var S=v&&m.getTextGuideLine();this._labelList.push({label:i,labelLine:S,seriesModel:r,dataIndex:e,dataType:t,layoutOption:s,computedLayoutOption:null,rect:d,hostRect:v,priority:v?v.width*v.height:0,defaultAttr:{ignore:i.ignore,labelGuideIgnore:S&&S.ignore,x:gc.x,y:gc.y,scaleX:gc.scaleX,scaleY:gc.scaleY,rotation:gc.rotation,style:{x:a.x,y:a.y,align:a.align,verticalAlign:a.verticalAlign,width:a.width,height:a.height,fontSize:a.fontSize},cursor:i.cursor,attachedPos:o.position,attachedRot:o.rotation}})},n.prototype.addLabelsOfSeries=function(e){var t=this;this._chartViewList.push(e);var r=e.__model,i=r.get("labelLayout");(ci(i)||so(i).length)&&e.group.traverse(function(s){if(s.ignore)return!0;var a=s.getTextContent(),l=Wi(s);a&&!a.disableLabelLayout&&t._addLabel(l.dataIndex,l.dataType,r,a,i)})},n.prototype.updateLayoutConfig=function(e){var t=e.getWidth(),r=e.getHeight();function i(k,H){return function(){gZ(k,H)}}for(var s=0;s<this._labelList.length;s++){var a=this._labelList[s],l=a.label,o=l.__hostTarget,h=a.defaultAttr,d=void 0;ci(a.layoutOption)?d=a.layoutOption(LDe(a,o)):d=a.layoutOption,d=d||{},a.computedLayoutOption=d;var m=Math.PI/180;o&&o.setTextConfig({local:!1,position:d.x!=null||d.y!=null?null:h.attachedPos,rotation:d.rotate!=null?d.rotate*m:h.attachedRot,offset:[d.dx||0,d.dy||0]});var v=!1;if(d.x!=null?(l.x=ls(d.x,t),l.setStyle("x",0),v=!0):(l.x=h.x,l.setStyle("x",h.style.x)),d.y!=null?(l.y=ls(d.y,r),l.setStyle("y",0),v=!0):(l.y=h.y,l.setStyle("y",h.style.y)),d.labelLinePoints){var y=o.getTextGuideLine();y&&(y.setShape({points:d.labelLinePoints}),v=!1)}var S=yk(l);S.needsUpdateLabelLine=v,l.rotation=d.rotate!=null?d.rotate*m:h.rotation,l.scaleX=h.scaleX,l.scaleY=h.scaleY;for(var E=0;E<vZ.length;E++){var M=vZ[E];l.setStyle(M,d[M]!=null?d[M]:h.style[M])}if(d.draggable){if(l.draggable=!0,l.cursor="move",o){var C=a.seriesModel;if(a.dataIndex!=null){var L=a.seriesModel.getData(a.dataType);C=L.getItemModel(a.dataIndex)}l.on("drag",i(o,C.getModel("labelLine")))}}else l.off("drag"),l.cursor=h.cursor}},n.prototype.layout=function(e){var t=e.getWidth(),r=e.getHeight(),i=cae(this._labelList),s=na(i,function(o){return o.layoutOption.moveOverlap==="shiftX"}),a=na(i,function(o){return o.layoutOption.moveOverlap==="shiftY"});RDe(s,0,t),hae(a,0,r);var l=na(i,function(o){return o.layoutOption.hideOverlap});fae(l)},n.prototype.processLabelsOverall=function(){var e=this;it(this._chartViewList,function(t){var r=t.__model,i=t.ignoreLabelLineUpdate,s=r.isAnimationEnabled();t.group.traverse(function(a){if(a.ignore&&!a.forceLabelAnimation)return!0;var l=!i,o=a.getTextContent();!l&&o&&(l=yk(o).needsUpdateLabelLine),l&&e._updateLabelLine(a,r),s&&e._animateLabels(a,r)})})},n.prototype._updateLabelLine=function(e,t){var r=e.getTextContent(),i=Wi(e),s=i.dataIndex;if(r&&s!=null){var a=t.getData(i.dataType),l=a.getItemModel(s),o={},h=a.getItemVisual(s,"style");if(h){var d=a.getVisual("drawType");o.stroke=h[d]}var m=l.getModel("labelLine");aae(e,lae(l),o),gZ(e,m)}},n.prototype._animateLabels=function(e,t){var r=e.getTextContent(),i=e.getTextGuideLine();if(r&&(e.forceLabelAnimation||!r.ignore&&!r.invisible&&!e.disableLabelAnimation&&!Ob(e))){var s=yk(r),a=s.oldLayout,l=Wi(e),o=l.dataIndex,h={x:r.x,y:r.y,rotation:r.rotation},d=t.getData(l.dataType);if(a){r.attr(a);var v=e.prevStates;v&&(Xi(v,"select")>=0&&r.attr(s.oldLayoutSelect),Xi(v,"emphasis")>=0&&r.attr(s.oldLayoutEmphasis)),ol(r,h,t,o)}else if(r.attr(h),!Ew(r).valueAnimation){var m=Ei(r.style.opacity,1);r.style.opacity=0,ql(r,{style:{opacity:m}},t,o)}if(s.oldLayout=h,r.states.select){var y=s.oldLayoutSelect={};aI(y,h,lI),aI(y,r.states.select,lI)}if(r.states.emphasis){var S=s.oldLayoutEmphasis={};aI(S,h,lI),aI(S,r.states.emphasis,lI)}eIe(r,o,d,t,t)}if(i&&!i.ignore&&!i.invisible){var s=DDe(i),a=s.oldLayout,E={points:i.shape.points};a?(i.attr({shape:a}),ol(i,{shape:E},t)):(i.setShape(E),i.style.strokePercent=0,ql(i,{style:{strokePercent:1}},t)),s.oldLayout=E}},n}(),xk=$s();function kDe(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){var i=xk(t).labelManager;i||(i=xk(t).labelManager=new BDe),i.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(e,t,r){var i=xk(t).labelManager;r.updatedSeries.forEach(function(s){i.addLabelsOfSeries(t.getViewOfSeriesModel(s))}),i.updateLayoutConfig(t),i.layout(t),i.processLabelsOverall()})}var ODe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.hasSymbolVisual=!0,t}return e.prototype.getInitialData=function(t){return d8(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var r=new ma,i=aw("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);r.add(i),i.setStyle(t.lineStyle);var s=this.getData().getVisual("symbol"),a=this.getData().getVisual("symbolRotate"),l=s==="none"?"circle":s,o=t.itemHeight*.8,h=aw(l,(t.itemWidth-o)/2,(t.itemHeight-o)/2,o,o,t.itemStyle.fill);r.add(h),h.setStyle(t.itemStyle);var d=t.iconRotate==="inherit"?a:t.iconRotate||0;return h.rotation=d*Math.PI/180,h.setOrigin([t.itemWidth/2,t.itemHeight/2]),l.indexOf("empty")>-1&&(h.style.stroke=h.style.fill,h.style.fill="#fff",h.style.lineWidth=2),r},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(Jf);function x8(n,e){var t=n.mapDimensionsAll("defaultedLabel"),r=t.length;if(r===1){var i=ow(n,e,t[0]);return i!=null?i+"":null}else if(r){for(var s=[],a=0;a<t.length;a++)s.push(ow(n,e,t[a]));return s.join(" ")}}function dae(n,e){var t=n.mapDimensionsAll("defaultedLabel");if(!fr(e))return e+"";for(var r=[],i=0;i<t.length;i++){var s=n.getDimensionIndex(t[i]);s>=0&&r.push(e[s])}return r.join(" ")}var b8=function(n){Hn(e,n);function e(t,r,i,s){var a=n.call(this)||this;return a.updateData(t,r,i,s),a}return e.prototype._createSymbol=function(t,r,i,s,a){this.removeAll();var l=aw(t,-1,-1,2,2,null,a);l.attr({z2:100,culling:!0,scaleX:s[0]/2,scaleY:s[1]/2}),l.drift=FDe,this._symbolType=t,this.add(l)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){rw(this.childAt(0))},e.prototype.downplay=function(){iw(this.childAt(0))},e.prototype.setZ=function(t,r){var i=this.childAt(0);i.zlevel=t,i.z=r},e.prototype.setDraggable=function(t,r){var i=this.childAt(0);i.draggable=t,i.cursor=!r&&t?"move":i.cursor},e.prototype.updateData=function(t,r,i,s){this.silent=!1;var a=t.getItemVisual(r,"symbol")||"circle",l=t.hostModel,o=e.getSymbolSize(t,r),h=a!==this._symbolType,d=s&&s.disableAnimation;if(h){var m=t.getItemVisual(r,"symbolKeepAspect");this._createSymbol(a,t,r,o,m)}else{var v=this.childAt(0);v.silent=!1;var y={scaleX:o[0]/2,scaleY:o[1]/2};d?v.attr(y):ol(v,y,l,r),VU(v)}if(this._updateCommon(t,r,o,i,s),h){var v=this.childAt(0);if(!d){var y={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:v.style.opacity}};v.scaleX=v.scaleY=0,v.style.opacity=0,ql(v,y,l,r)}}d&&this.childAt(0).stopAnimation("leave")},e.prototype._updateCommon=function(t,r,i,s,a){var l=this.childAt(0),o=t.hostModel,h,d,m,v,y,S,E,M,C;if(s&&(h=s.emphasisItemStyle,d=s.blurItemStyle,m=s.selectItemStyle,v=s.focus,y=s.blurScope,E=s.labelStatesModels,M=s.hoverScale,C=s.cursorStyle,S=s.emphasisDisabled),!s||t.hasItemOption){var L=s&&s.itemModel?s.itemModel:t.getItemModel(r),k=L.getModel("emphasis");h=k.getModel("itemStyle").getItemStyle(),m=L.getModel(["select","itemStyle"]).getItemStyle(),d=L.getModel(["blur","itemStyle"]).getItemStyle(),v=k.get("focus"),y=k.get("blurScope"),S=k.get("disabled"),E=uM(L),M=k.getShallow("scale"),C=L.getShallow("cursor")}var H=t.getItemVisual(r,"symbolRotate");l.attr("rotation",(H||0)*Math.PI/180||0);var q=loe(t.getItemVisual(r,"symbolOffset"),i);q&&(l.x=q[0],l.y=q[1]),C&&l.attr("cursor",C);var Z=t.getItemVisual(r,"style"),ee=Z.fill;if(l instanceof Ov){var re=l.style;l.useStyle(Jn({image:re.image,x:re.x,y:re.y,width:re.width,height:re.height},Z))}else l.__isEmptyBrush?l.useStyle(Jn({},Z)):l.useStyle(Z),l.style.decal=null,l.setColor(ee,a&&a.symbolInnerColor),l.style.strokeNoScale=!0;var se=t.getItemVisual(r,"liftZ"),ae=this._z2;se!=null?ae==null&&(this._z2=l.z2,l.z2+=se):ae!=null&&(l.z2=ae,this._z2=null);var fe=a&&a.useNameLabel;cM(l,E,{labelFetcher:o,labelDataIndex:r,defaultText:Se,inheritColor:ee,defaultOpacity:Z.opacity});function Se(je){return fe?t.getName(je):x8(t,je)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var Ce=l.ensureState("emphasis");Ce.style=h,l.ensureState("select").style=m,l.ensureState("blur").style=d;var Ie=M==null||M===!0?Math.max(1.1,3/this._sizeY):isFinite(M)&&M>0?+M:1;Ce.scaleX=this._sizeX*Ie,Ce.scaleY=this._sizeY*Ie,this.setSymbolScale(1),lT(this,v,y,S)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,r,i){var s=this.childAt(0),a=Wi(this).dataIndex,l=i&&i.animation;if(this.silent=s.silent=!0,i&&i.fadeLabel){var o=s.getTextContent();o&&FP(o,{style:{opacity:0}},r,{dataIndex:a,removeOpt:l,cb:function(){s.removeTextContent()}})}else s.removeTextContent();FP(s,{style:{opacity:0},scaleX:0,scaleY:0},r,{dataIndex:a,cb:t,removeOpt:l})},e.getSymbolSize=function(t,r){return APe(t.getItemVisual(r,"symbolSize"))},e}(ma);function FDe(n,e){this.parent.drift(n,e)}function bk(n,e,t,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(t))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&n.getItemVisual(t,"symbol")!=="none"}function _Z(n){return n!=null&&!Xr(n)&&(n={isIgnore:n}),n||{}}function yZ(n){var e=n.hostModel,t=e.getModel("emphasis");return{emphasisItemStyle:t.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:t.get("focus"),blurScope:t.get("blurScope"),emphasisDisabled:t.get("disabled"),hoverScale:t.get("scale"),labelStatesModels:uM(e),cursorStyle:e.get("cursor")}}var NDe=function(){function n(e){this.group=new ma,this._SymbolCtor=e||b8}return n.prototype.updateData=function(e,t){this._progressiveEls=null,t=_Z(t);var r=this.group,i=e.hostModel,s=this._data,a=this._SymbolCtor,l=t.disableAnimation,o=yZ(e),h={disableAnimation:l},d=t.getSymbolPoint||function(m){return e.getItemLayout(m)};s||r.removeAll(),e.diff(s).add(function(m){var v=d(m);if(bk(e,v,m,t)){var y=new a(e,m,o,h);y.setPosition(v),e.setItemGraphicEl(m,y),r.add(y)}}).update(function(m,v){var y=s.getItemGraphicEl(v),S=d(m);if(!bk(e,S,m,t)){r.remove(y);return}var E=e.getItemVisual(m,"symbol")||"circle",M=y&&y.getSymbolType&&y.getSymbolType();if(!y||M&&M!==E)r.remove(y),y=new a(e,m,o,h),y.setPosition(S);else{y.updateData(e,m,o,h);var C={x:S[0],y:S[1]};l?y.attr(C):ol(y,C,i)}r.add(y),e.setItemGraphicEl(m,y)}).remove(function(m){var v=s.getItemGraphicEl(m);v&&v.fadeOut(function(){r.remove(v)},i)}).execute(),this._getSymbolPoint=d,this._data=e},n.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(r,i){var s=e._getSymbolPoint(i);r.setPosition(s),r.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=yZ(e),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(e,t,r){this._progressiveEls=[],r=_Z(r);function i(o){o.isGroup||(o.incremental=!0,o.ensureState("emphasis").hoverLayer=!0)}for(var s=e.start;s<e.end;s++){var a=t.getItemLayout(s);if(bk(t,a,s,r)){var l=new this._SymbolCtor(t,s,this._seriesScope);l.traverse(i),l.setPosition(a),this.group.add(l),t.setItemGraphicEl(s,l),this._progressiveEls.push(l)}}},n.prototype.eachRendered=function(e){WD(this._progressiveEls||this.group,e)},n.prototype.remove=function(e){var t=this.group,r=this._data;r&&e?r.eachItemGraphicEl(function(i){i.fadeOut(function(){t.remove(i)},r.hostModel)}):t.removeAll()},n}();function pae(n,e,t){var r=n.getBaseAxis(),i=n.getOtherAxis(r),s=zDe(i,t),a=r.dim,l=i.dim,o=e.mapDimension(l),h=e.mapDimension(a),d=l==="x"||l==="radius"?1:0,m=xr(n.dimensions,function(S){return e.mapDimension(S)}),v=!1,y=e.getCalculationInfo("stackResultDimension");return o1(e,m[0])&&(v=!0,m[0]=y),o1(e,m[1])&&(v=!0,m[1]=y),{dataDimsForPoint:m,valueStart:s,valueAxisDim:l,baseAxisDim:a,stacked:!!v,valueDim:o,baseDim:h,baseDataOffset:d,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function zDe(n,e){var t=0,r=n.scale.getExtent();return e==="start"?t=r[0]:e==="end"?t=r[1]:Rs(e)&&!isNaN(e)?t=e:r[0]>0?t=r[0]:r[1]<0&&(t=r[1]),t}function mae(n,e,t,r){var i=NaN;n.stacked&&(i=t.get(t.getCalculationInfo("stackedOverDimension"),r)),isNaN(i)&&(i=n.valueStart);var s=n.baseDataOffset,a=[];return a[s]=t.get(n.baseDim,r),a[1-s]=i,e.dataToPoint(a)}function UDe(n,e){var t=[];return e.diff(n).add(function(r){t.push({cmd:"+",idx:r})}).update(function(r,i){t.push({cmd:"=",idx:i,idx1:r})}).remove(function(r){t.push({cmd:"-",idx:r})}).execute(),t}function GDe(n,e,t,r,i,s,a,l){for(var o=UDe(n,e),h=[],d=[],m=[],v=[],y=[],S=[],E=[],M=pae(i,e,a),C=n.getLayout("points")||[],L=e.getLayout("points")||[],k=0;k<o.length;k++){var H=o[k],q=!0,Z=void 0,ee=void 0;switch(H.cmd){case"=":Z=H.idx*2,ee=H.idx1*2;var re=C[Z],se=C[Z+1],ae=L[ee],fe=L[ee+1];(isNaN(re)||isNaN(se))&&(re=ae,se=fe),h.push(re,se),d.push(ae,fe),m.push(t[Z],t[Z+1]),v.push(r[ee],r[ee+1]),E.push(e.getRawIndex(H.idx1));break;case"+":var Se=H.idx,Ce=M.dataDimsForPoint,Ie=i.dataToPoint([e.get(Ce[0],Se),e.get(Ce[1],Se)]);ee=Se*2,h.push(Ie[0],Ie[1]),d.push(L[ee],L[ee+1]);var je=mae(M,i,e,Se);m.push(je[0],je[1]),v.push(r[ee],r[ee+1]),E.push(e.getRawIndex(Se));break;case"-":q=!1}q&&(y.push(H),S.push(S.length))}S.sort(function(Ht,Qt){return E[Ht]-E[Qt]});for(var Le=h.length,ot=Lm(Le),ye=Lm(Le),$e=Lm(Le),Ve=Lm(Le),_t=[],k=0;k<S.length;k++){var wt=S[k],Vt=k*2,lt=wt*2;ot[Vt]=h[lt],ot[Vt+1]=h[lt+1],ye[Vt]=d[lt],ye[Vt+1]=d[lt+1],$e[Vt]=m[lt],$e[Vt+1]=m[lt+1],Ve[Vt]=v[lt],Ve[Vt+1]=v[lt+1],_t[k]=y[wt]}return{current:ot,next:ye,stackedOnCurrent:$e,stackedOnNext:Ve,status:_t}}var w0=Math.min,S0=Math.max;function Gy(n,e){return isNaN(n)||isNaN(e)}function ON(n,e,t,r,i,s,a,l,o){for(var h,d,m,v,y,S,E=t,M=0;M<r;M++){var C=e[E*2],L=e[E*2+1];if(E>=i||E<0)break;if(Gy(C,L)){if(o){E+=s;continue}break}if(E===t)n[s>0?"moveTo":"lineTo"](C,L),m=C,v=L;else{var k=C-h,H=L-d;if(k*k+H*H<.5){E+=s;continue}if(a>0){for(var q=E+s,Z=e[q*2],ee=e[q*2+1];Z===C&&ee===L&&M<r;)M++,q+=s,E+=s,Z=e[q*2],ee=e[q*2+1],C=e[E*2],L=e[E*2+1],k=C-h,H=L-d;var re=M+1;if(o)for(;Gy(Z,ee)&&re<r;)re++,q+=s,Z=e[q*2],ee=e[q*2+1];var se=.5,ae=0,fe=0,Se=void 0,Ce=void 0;if(re>=r||Gy(Z,ee))y=C,S=L;else{ae=Z-h,fe=ee-d;var Ie=C-h,je=Z-C,Le=L-d,ot=ee-L,ye=void 0,$e=void 0;if(l==="x"){ye=Math.abs(Ie),$e=Math.abs(je);var Ve=ae>0?1:-1;y=C-Ve*ye*a,S=L,Se=C+Ve*$e*a,Ce=L}else if(l==="y"){ye=Math.abs(Le),$e=Math.abs(ot);var _t=fe>0?1:-1;y=C,S=L-_t*ye*a,Se=C,Ce=L+_t*$e*a}else ye=Math.sqrt(Ie*Ie+Le*Le),$e=Math.sqrt(je*je+ot*ot),se=$e/($e+ye),y=C-ae*a*(1-se),S=L-fe*a*(1-se),Se=C+ae*a*se,Ce=L+fe*a*se,Se=w0(Se,S0(Z,C)),Ce=w0(Ce,S0(ee,L)),Se=S0(Se,w0(Z,C)),Ce=S0(Ce,w0(ee,L)),ae=Se-C,fe=Ce-L,y=C-ae*ye/$e,S=L-fe*ye/$e,y=w0(y,S0(h,C)),S=w0(S,S0(d,L)),y=S0(y,w0(h,C)),S=S0(S,w0(d,L)),ae=C-y,fe=L-S,Se=C+ae*$e/ye,Ce=L+fe*$e/ye}n.bezierCurveTo(m,v,y,S,C,L),m=Se,v=Ce}else n.lineTo(C,L)}h=C,d=L,E+=s}return M}var gae=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),VDe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polyline",r}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new gae},e.prototype.buildPath=function(t,r){var i=r.points,s=0,a=i.length/2;if(r.connectNulls){for(;a>0&&Gy(i[a*2-2],i[a*2-1]);a--);for(;s<a&&Gy(i[s*2],i[s*2+1]);s++);}for(;s<a;)s+=ON(t,i,s,a,a,1,r.smooth,r.smoothMonotone,r.connectNulls)+1},e.prototype.getPointOn=function(t,r){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,s=i.data,a=Jm.CMD,l,o,h=r==="x",d=[],m=0;m<s.length;){var v=s[m++],y=void 0,S=void 0,E=void 0,M=void 0,C=void 0,L=void 0,k=void 0;switch(v){case a.M:l=s[m++],o=s[m++];break;case a.L:if(y=s[m++],S=s[m++],k=h?(t-l)/(y-l):(t-o)/(S-o),k<=1&&k>=0){var H=h?(S-o)*k+o:(y-l)*k+l;return h?[t,H]:[H,t]}l=y,o=S;break;case a.C:y=s[m++],S=s[m++],E=s[m++],M=s[m++],C=s[m++],L=s[m++];var q=h?CP(l,y,E,C,t,d):CP(o,S,M,L,t,d);if(q>0)for(var Z=0;Z<q;Z++){var ee=d[Z];if(ee<=1&&ee>=0){var H=h?Ga(o,S,M,L,ee):Ga(l,y,E,C,ee);return h?[t,H]:[H,t]}}l=C,o=L;break}}},e}($i),HDe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(gae),jDe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polygon",r}return e.prototype.getDefaultShape=function(){return new HDe},e.prototype.buildPath=function(t,r){var i=r.points,s=r.stackedOnPoints,a=0,l=i.length/2,o=r.smoothMonotone;if(r.connectNulls){for(;l>0&&Gy(i[l*2-2],i[l*2-1]);l--);for(;a<l&&Gy(i[a*2],i[a*2+1]);a++);}for(;a<l;){var h=ON(t,i,a,l,l,1,r.smooth,o,r.connectNulls);ON(t,s,a+h-1,h,l,-1,r.stackedOnSmooth,o,r.connectNulls),a+=h+1,t.closePath()}},e}($i);function vae(n,e,t,r,i){var s=n.getArea(),a=s.x,l=s.y,o=s.width,h=s.height,d=t.get(["lineStyle","width"])||2;a-=d/2,l-=d/2,o+=d,h+=d,o=Math.ceil(o),a!==Math.floor(a)&&(a=Math.floor(a),o++);var m=new Ho({shape:{x:a,y:l,width:o,height:h}});if(e){var v=n.getBaseAxis(),y=v.isHorizontal(),S=v.inverse;y?(S&&(m.shape.x+=o),m.shape.width=0):(S||(m.shape.y+=h),m.shape.height=0);var E=ci(i)?function(M){i(M,m)}:null;ql(m,{shape:{width:o,height:h,x:a,y:l}},t,null,r,E)}return m}function _ae(n,e,t){var r=n.getArea(),i=Aa(r.r0,1),s=Aa(r.r,1),a=new Oh({shape:{cx:Aa(n.cx,1),cy:Aa(n.cy,1),r0:i,r:s,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});if(e){var l=n.getBaseAxis().dim==="angle";l?a.shape.endAngle=r.startAngle:a.shape.r=i,ql(a,{shape:{endAngle:r.endAngle,r:s}},t)}return a}function WDe(n,e,t,r,i){if(n){if(n.type==="polar")return _ae(n,e,t);if(n.type==="cartesian2d")return vae(n,e,t,r,i)}else return null;return null}function w8(n,e){return n.type===e}function xZ(n,e){if(n.length===e.length){for(var t=0;t<n.length;t++)if(n[t]!==e[t])return;return!0}}function bZ(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,s=0;s<n.length;){var a=n[s++],l=n[s++];isNaN(a)||(e=Math.min(a,e),r=Math.max(a,r)),isNaN(l)||(t=Math.min(l,t),i=Math.max(l,i))}return[[e,t],[r,i]]}function wZ(n,e){var t=bZ(n),r=t[0],i=t[1],s=bZ(e),a=s[0],l=s[1];return Math.max(Math.abs(r[0]-a[0]),Math.abs(r[1]-a[1]),Math.abs(i[0]-l[0]),Math.abs(i[1]-l[1]))}function SZ(n){return Rs(n)?n:n?.5:0}function XDe(n,e,t){if(!t.valueDim)return[];for(var r=e.count(),i=Lm(r*2),s=0;s<r;s++){var a=mae(t,n,e,s);i[s*2]=a[0],i[s*2+1]=a[1]}return i}function A0(n,e,t,r){var i=e.getBaseAxis(),s=i.dim==="x"||i.dim==="radius"?0:1,a=[],l=0,o=[],h=[],d=[],m=[];if(r){for(l=0;l<n.length;l+=2)!isNaN(n[l])&&!isNaN(n[l+1])&&m.push(n[l],n[l+1]);n=m}for(l=0;l<n.length-2;l+=2)switch(d[0]=n[l+2],d[1]=n[l+3],h[0]=n[l],h[1]=n[l+1],a.push(h[0],h[1]),t){case"end":o[s]=d[s],o[1-s]=h[1-s],a.push(o[0],o[1]);break;case"middle":var v=(h[s]+d[s])/2,y=[];o[s]=y[s]=v,o[1-s]=h[1-s],y[1-s]=d[1-s],a.push(o[0],o[1]),a.push(y[0],y[1]);break;default:o[s]=h[s],o[1-s]=d[1-s],a.push(o[0],o[1])}return a.push(n[l++],n[l++]),a}function $De(n,e){var t=[],r=n.length,i,s;function a(d,m,v){var y=d.coord,S=(v-y)/(m.coord-y),E=XTe(S,[d.color,m.color]);return{coord:v,color:E}}for(var l=0;l<r;l++){var o=n[l],h=o.coord;if(h<0)i=o;else if(h>e){s?t.push(a(s,o,e)):i&&t.push(a(i,o,0),a(i,o,e));break}else i&&(t.push(a(i,o,0)),i=null),t.push(o),s=o}return t}function qDe(n,e,t){var r=n.getVisual("visualMeta");if(!(!r||!r.length||!n.count())&&e.type==="cartesian2d"){for(var i,s,a=r.length-1;a>=0;a--){var l=n.getDimensionInfo(r[a].dimension);if(i=l&&l.coordDim,i==="x"||i==="y"){s=r[a];break}}if(s){var o=e.getAxis(i),h=xr(s.stops,function(k){return{coord:o.toGlobalCoord(o.dataToCoord(k.value)),color:k.color}}),d=h.length,m=s.outerColors.slice();d&&h[0].coord>h[d-1].coord&&(h.reverse(),m.reverse());var v=$De(h,i==="x"?t.getWidth():t.getHeight()),y=v.length;if(!y&&d)return h[0].coord<0?m[1]?m[1]:h[d-1].color:m[0]?m[0]:h[0].color;var S=10,E=v[0].coord-S,M=v[y-1].coord+S,C=M-E;if(C<.001)return"transparent";it(v,function(k){k.offset=(k.coord-E)/C}),v.push({offset:y?v[y-1].offset:.5,color:m[1]||"transparent"}),v.unshift({offset:y?v[0].offset:.5,color:m[0]||"transparent"});var L=new Jie(0,0,0,0,v,!0);return L[i]=E,L[i+"2"]=M,L}}}function ZDe(n,e,t){var r=n.get("showAllSymbol"),i=r==="auto";if(!(r&&!i)){var s=t.getAxesByScale("ordinal")[0];if(s&&!(i&&YDe(s,e))){var a=e.mapDimension(s.dim),l={};return it(s.getViewLabels(),function(o){var h=s.scale.getRawOrdinalNumber(o.tickValue);l[h]=1}),function(o){return!l.hasOwnProperty(e.get(a,o))}}}}function YDe(n,e){var t=n.getExtent(),r=Math.abs(t[1]-t[0])/n.scale.count();isNaN(r)&&(r=0);for(var i=e.count(),s=Math.max(1,Math.round(i/5)),a=0;a<i;a+=s)if(b8.getSymbolSize(e,a)[n.isHorizontal()?1:0]*1.5>r)return!1;return!0}function KDe(n,e){return isNaN(n)||isNaN(e)}function JDe(n){for(var e=n.length/2;e>0&&KDe(n[e*2-2],n[e*2-1]);e--);return e-1}function AZ(n,e){return[n[e*2],n[e*2+1]]}function QDe(n,e,t){for(var r=n.length/2,i=t==="x"?0:1,s,a,l=0,o=-1,h=0;h<r;h++)if(a=n[h*2+i],!(isNaN(a)||isNaN(n[h*2+1-i]))){if(h===0){s=a;continue}if(s<=e&&a>=e||s>=e&&a<=e){o=h;break}l=h,s=a}return{range:[l,o],t:(e-s)/(a-s)}}function yae(n){if(n.get(["endLabel","show"]))return!0;for(var e=0;e<kh.length;e++)if(n.get([kh[e],"endLabel","show"]))return!0;return!1}function wk(n,e,t,r){if(w8(e,"cartesian2d")){var i=r.getModel("endLabel"),s=i.get("valueAnimation"),a=r.getData(),l={lastFrameIndex:0},o=yae(r)?function(y,S){n._endLabelOnDuring(y,S,a,l,s,i,e)}:null,h=e.getBaseAxis().isHorizontal(),d=vae(e,t,r,function(){var y=n._endLabel;y&&t&&l.originalX!=null&&y.attr({x:l.originalX,y:l.originalY})},o);if(!r.get("clip",!0)){var m=d.shape,v=Math.max(m.width,m.height);h?(m.y-=v,m.height+=v*2):(m.x-=v,m.width+=v*2)}return o&&o(1,d),d}else return _ae(e,t,r)}function e3e(n,e){var t=e.getBaseAxis(),r=t.isHorizontal(),i=t.inverse,s=r?i?"right":"left":"center",a=r?"middle":i?"top":"bottom";return{normal:{align:n.get("align")||s,verticalAlign:n.get("verticalAlign")||a}}}var t3e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(){var t=new ma,r=new NDe;this.group.add(r.group),this._symbolDraw=r,this._lineGroup=t},e.prototype.render=function(t,r,i){var s=this,a=t.coordinateSystem,l=this.group,o=t.getData(),h=t.getModel("lineStyle"),d=t.getModel("areaStyle"),m=o.getLayout("points")||[],v=a.type==="polar",y=this._coordSys,S=this._symbolDraw,E=this._polyline,M=this._polygon,C=this._lineGroup,L=!r.ssr&&t.get("animation"),k=!d.isEmpty(),H=d.get("origin"),q=pae(a,o,H),Z=k&&XDe(a,o,q),ee=t.get("showSymbol"),re=t.get("connectNulls"),se=ee&&!v&&ZDe(t,o,a),ae=this._data;ae&&ae.eachItemGraphicEl(function(Qt,rn){Qt.__temp&&(l.remove(Qt),ae.setItemGraphicEl(rn,null))}),ee||S.remove(),l.add(C);var fe=v?!1:t.get("step"),Se;a&&a.getArea&&t.get("clip",!0)&&(Se=a.getArea(),Se.width!=null?(Se.x-=.1,Se.y-=.1,Se.width+=.2,Se.height+=.2):Se.r0&&(Se.r0-=.5,Se.r+=.5)),this._clipShapeForSymbol=Se;var Ce=qDe(o,a,i)||o.getVisual("style")[o.getVisual("drawType")];if(!(E&&y.type===a.type&&fe===this._step))ee&&S.updateData(o,{isIgnore:se,clipShape:Se,disableAnimation:!0,getSymbolPoint:function(Qt){return[m[Qt*2],m[Qt*2+1]]}}),L&&this._initSymbolLabelAnimation(o,a,Se),fe&&(m=A0(m,a,fe,re),Z&&(Z=A0(Z,a,fe,re))),E=this._newPolyline(m),k?M=this._newPolygon(m,Z):M&&(C.remove(M),M=this._polygon=null),v||this._initOrUpdateEndLabel(t,a,s1(Ce)),C.setClipPath(wk(this,a,!0,t));else{k&&!M?M=this._newPolygon(m,Z):M&&!k&&(C.remove(M),M=this._polygon=null),v||this._initOrUpdateEndLabel(t,a,s1(Ce));var Ie=C.getClipPath();if(Ie){var je=wk(this,a,!1,t);ql(Ie,{shape:je.shape},t)}else C.setClipPath(wk(this,a,!0,t));ee&&S.updateData(o,{isIgnore:se,clipShape:Se,disableAnimation:!0,getSymbolPoint:function(Qt){return[m[Qt*2],m[Qt*2+1]]}}),(!xZ(this._stackedOnPoints,Z)||!xZ(this._points,m))&&(L?this._doUpdateAnimation(o,Z,a,i,fe,H,re):(fe&&(m=A0(m,a,fe,re),Z&&(Z=A0(Z,a,fe,re))),E.setShape({points:m}),M&&M.setShape({points:m,stackedOnPoints:Z})))}var Le=t.getModel("emphasis"),ot=Le.get("focus"),ye=Le.get("blurScope"),$e=Le.get("disabled");if(E.useStyle(ti(h.getLineStyle(),{fill:"none",stroke:Ce,lineJoin:"bevel"})),kP(E,t,"lineStyle"),E.style.lineWidth>0&&t.get(["emphasis","lineStyle","width"])==="bolder"){var Ve=E.getState("emphasis").style;Ve.lineWidth=+E.style.lineWidth+1}Wi(E).seriesIndex=t.seriesIndex,lT(E,ot,ye,$e);var _t=SZ(t.get("smooth")),wt=t.get("smoothMonotone");if(E.setShape({smooth:_t,smoothMonotone:wt,connectNulls:re}),M){var Vt=o.getCalculationInfo("stackedOnSeries"),lt=0;M.useStyle(ti(d.getAreaStyle(),{fill:Ce,opacity:.7,lineJoin:"bevel",decal:o.getVisual("style").decal})),Vt&&(lt=SZ(Vt.get("smooth"))),M.setShape({smooth:_t,stackedOnSmooth:lt,smoothMonotone:wt,connectNulls:re}),kP(M,t,"areaStyle"),Wi(M).seriesIndex=t.seriesIndex,lT(M,ot,ye,$e)}var Ht=function(Qt){s._changePolyState(Qt)};o.eachItemGraphicEl(function(Qt){Qt&&(Qt.onHoverStateChange=Ht)}),this._polyline.onHoverStateChange=Ht,this._data=o,this._coordSys=a,this._stackedOnPoints=Z,this._points=m,this._step=fe,this._valueOrigin=H,t.get("triggerLineEvent")&&(this.packEventData(t,E),M&&this.packEventData(t,M))},e.prototype.packEventData=function(t,r){Wi(r).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,r,i,s){var a=t.getData(),l=i1(a,s);if(this._changePolyState("emphasis"),!(l instanceof Array)&&l!=null&&l>=0){var o=a.getLayout("points"),h=a.getItemGraphicEl(l);if(!h){var d=o[l*2],m=o[l*2+1];if(isNaN(d)||isNaN(m)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(d,m))return;var v=t.get("zlevel")||0,y=t.get("z")||0;h=new b8(a,l),h.x=d,h.y=m,h.setZ(v,y);var S=h.getSymbolPath().getTextContent();S&&(S.zlevel=v,S.z=y,S.z2=this._polyline.z2+1),h.__temp=!0,a.setItemGraphicEl(l,h),h.stopSymbolAnimation(!0),this.group.add(h)}h.highlight()}else Ih.prototype.highlight.call(this,t,r,i,s)},e.prototype.downplay=function(t,r,i,s){var a=t.getData(),l=i1(a,s);if(this._changePolyState("normal"),l!=null&&l>=0){var o=a.getItemGraphicEl(l);o&&(o.__temp?(a.setItemGraphicEl(l,null),this.group.remove(o)):o.downplay())}else Ih.prototype.downplay.call(this,t,r,i,s)},e.prototype._changePolyState=function(t){var r=this._polygon;D$(this._polyline,t),r&&D$(r,t)},e.prototype._newPolyline=function(t){var r=this._polyline;return r&&this._lineGroup.remove(r),r=new VDe({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(r),this._polyline=r,r},e.prototype._newPolygon=function(t,r){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new jDe({shape:{points:t,stackedOnPoints:r},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},e.prototype._initSymbolLabelAnimation=function(t,r,i){var s,a,l=r.getBaseAxis(),o=l.inverse;r.type==="cartesian2d"?(s=l.isHorizontal(),a=!1):r.type==="polar"&&(s=l.dim==="angle",a=!0);var h=t.hostModel,d=h.get("animationDuration");ci(d)&&(d=d(null));var m=h.get("animationDelay")||0,v=ci(m)?m(null):m;t.eachItemGraphicEl(function(y,S){var E=y;if(E){var M=[y.x,y.y],C=void 0,L=void 0,k=void 0;if(i)if(a){var H=i,q=r.pointToCoord(M);s?(C=H.startAngle,L=H.endAngle,k=-q[1]/180*Math.PI):(C=H.r0,L=H.r,k=q[0])}else{var Z=i;s?(C=Z.x,L=Z.x+Z.width,k=y.x):(C=Z.y+Z.height,L=Z.y,k=y.y)}var ee=L===C?0:(k-C)/(L-C);o&&(ee=1-ee);var re=ci(m)?m(S):d*ee+v,se=E.getSymbolPath(),ae=se.getTextContent();E.attr({scaleX:0,scaleY:0}),E.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:re}),ae&&ae.animateFrom({style:{opacity:0}},{duration:300,delay:re}),se.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(t,r,i){var s=t.getModel("endLabel");if(yae(t)){var a=t.getData(),l=this._polyline,o=a.getLayout("points");if(!o){l.removeTextContent(),this._endLabel=null;return}var h=this._endLabel;h||(h=this._endLabel=new Ea({z2:200}),h.ignoreClip=!0,l.setTextContent(this._endLabel),l.disableLabelAnimation=!0);var d=JDe(o);d>=0&&(cM(l,uM(t,"endLabel"),{inheritColor:i,labelFetcher:t,labelDataIndex:d,defaultText:function(m,v,y){return y!=null?dae(a,y):x8(a,m)},enableTextSetter:!0},e3e(s,r)),l.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(t,r,i,s,a,l,o){var h=this._endLabel,d=this._polyline;if(h){t<1&&s.originalX==null&&(s.originalX=h.x,s.originalY=h.y);var m=i.getLayout("points"),v=i.hostModel,y=v.get("connectNulls"),S=l.get("precision"),E=l.get("distance")||0,M=o.getBaseAxis(),C=M.isHorizontal(),L=M.inverse,k=r.shape,H=L?C?k.x:k.y+k.height:C?k.x+k.width:k.y,q=(C?E:0)*(L?-1:1),Z=(C?0:-E)*(L?-1:1),ee=C?"x":"y",re=QDe(m,H,ee),se=re.range,ae=se[1]-se[0],fe=void 0;if(ae>=1){if(ae>1&&!y){var Se=AZ(m,se[0]);h.attr({x:Se[0]+q,y:Se[1]+Z}),a&&(fe=v.getRawValue(se[0]))}else{var Se=d.getPointOn(H,ee);Se&&h.attr({x:Se[0]+q,y:Se[1]+Z});var Ce=v.getRawValue(se[0]),Ie=v.getRawValue(se[1]);a&&(fe=pie(i,S,Ce,Ie,re.t))}s.lastFrameIndex=se[0]}else{var je=t===1||s.lastFrameIndex>0?se[0]:0,Se=AZ(m,je);a&&(fe=v.getRawValue(je)),h.attr({x:Se[0]+q,y:Se[1]+Z})}if(a){var Le=Ew(h);typeof Le.setLabelText=="function"&&Le.setLabelText(fe)}}},e.prototype._doUpdateAnimation=function(t,r,i,s,a,l,o){var h=this._polyline,d=this._polygon,m=t.hostModel,v=GDe(this._data,t,this._stackedOnPoints,r,this._coordSys,i,this._valueOrigin),y=v.current,S=v.stackedOnCurrent,E=v.next,M=v.stackedOnNext;if(a&&(y=A0(v.current,i,a,o),S=A0(v.stackedOnCurrent,i,a,o),E=A0(v.next,i,a,o),M=A0(v.stackedOnNext,i,a,o)),wZ(y,E)>3e3||d&&wZ(S,M)>3e3){h.stopAnimation(),h.setShape({points:E}),d&&(d.stopAnimation(),d.setShape({points:E,stackedOnPoints:M}));return}h.shape.__points=v.current,h.shape.points=y;var C={shape:{points:E}};v.current!==y&&(C.shape.__points=v.next),h.stopAnimation(),ol(h,C,m),d&&(d.setShape({points:y,stackedOnPoints:S}),d.stopAnimation(),ol(d,{shape:{stackedOnPoints:M}},m),h.shape.points!==d.shape.points&&(d.shape.points=h.shape.points));for(var L=[],k=v.status,H=0;H<k.length;H++){var q=k[H].cmd;if(q==="="){var Z=t.getItemGraphicEl(k[H].idx1);Z&&L.push({el:Z,ptIdx:H})}}h.animators&&h.animators.length&&h.animators[0].during(function(){d&&d.dirtyShape();for(var ee=h.shape.__points,re=0;re<L.length;re++){var se=L[re].el,ae=L[re].ptIdx*2;se.x=ee[ae],se.y=ee[ae+1],se.markRedraw()}})},e.prototype.remove=function(t){var r=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(s,a){s.__temp&&(r.remove(s),i.setItemGraphicEl(a,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Ih);function n3e(n,e){return{seriesType:n,plan:o8(),reset:function(t){var r=t.getData(),i=t.coordinateSystem;if(t.pipelineContext,!!i){var s=xr(i.dimensions,function(m){return r.mapDimension(m)}).slice(0,2),a=s.length,l=r.getCalculationInfo("stackResultDimension");o1(r,s[0])&&(s[0]=l),o1(r,s[1])&&(s[1]=l);var o=r.getStore(),h=r.getDimensionIndex(s[0]),d=r.getDimensionIndex(s[1]);return a&&{progress:function(m,v){for(var y=m.end-m.start,S=Lm(y*a),E=[],M=[],C=m.start,L=0;C<m.end;C++){var k=void 0;if(a===1){var H=o.get(h,C);k=i.dataToPoint(H,null,M)}else E[0]=o.get(h,C),E[1]=o.get(d,C),k=i.dataToPoint(E,null,M);S[L++]=k[0],S[L++]=k[1]}v.setLayout("points",S)}}}}}}var r3e={average:function(n){for(var e=0,t=0,r=0;r<n.length;r++)isNaN(n[r])||(e+=n[r],t++);return t===0?NaN:e/t},sum:function(n){for(var e=0,t=0;t<n.length;t++)e+=n[t]||0;return e},max:function(n){for(var e=-1/0,t=0;t<n.length;t++)n[t]>e&&(e=n[t]);return isFinite(e)?e:NaN},min:function(n){for(var e=1/0,t=0;t<n.length;t++)n[t]<e&&(e=n[t]);return isFinite(e)?e:NaN},minmax:function(n){for(var e=-1/0,t=-1/0,r=0;r<n.length;r++){var i=n[r],s=Math.abs(i);s>e&&(e=s,t=i)}return isFinite(t)?t:NaN},nearest:function(n){return n[0]}},i3e=function(n){return Math.round(n.length/2)};function xae(n){return{seriesType:n,reset:function(e,t,r){var i=e.getData(),s=e.get("sampling"),a=e.coordinateSystem,l=i.count();if(l>10&&a.type==="cartesian2d"&&s){var o=a.getBaseAxis(),h=a.getOtherAxis(o),d=o.getExtent(),m=r.getDevicePixelRatio(),v=Math.abs(d[1]-d[0])*(m||1),y=Math.round(l/v);if(isFinite(y)&&y>1){s==="lttb"&&e.setData(i.lttbDownSample(i.mapDimension(h.dim),1/y));var S=void 0;Dr(s)?S=r3e[s]:ci(s)&&(S=s),S&&e.setData(i.downSample(i.mapDimension(h.dim),1/y,S,i3e))}}}}}function s3e(n){n.registerChartView(t3e),n.registerSeriesModel(ODe),n.registerLayout(n3e("line")),n.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),r=e.getModel("lineStyle").getLineStyle();r&&!r.stroke&&(r.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",r)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,xae("line"))}var FN=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(t,r){return d8(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t,r,i){var s=this.coordinateSystem;if(s&&s.clampData){var a=s.clampData(t),l=s.dataToPoint(a);if(i)it(s.getAxes(),function(v,y){if(v.type==="category"&&r!=null){var S=v.getTicksCoords(),E=v.getTickModel().get("alignWithLabel"),M=a[y],C=r[y]==="x1"||r[y]==="y1";if(C&&!E&&(M+=1),S.length<2)return;if(S.length===2){l[y]=v.toGlobalCoord(v.getExtent()[C?1:0]);return}for(var L=void 0,k=void 0,H=1,q=0;q<S.length;q++){var Z=S[q].coord,ee=q===S.length-1?S[q-1].tickValue+H:S[q].tickValue;if(ee===M){k=Z;break}else if(ee<M)L=Z;else if(L!=null&&ee>M){k=(Z+L)/2;break}q===1&&(H=ee-S[0].tickValue)}k==null&&(L?L&&(k=S[S.length-1].coord):k=S[0].coord),l[y]=v.toGlobalCoord(k)}});else{var o=this.getData(),h=o.getLayout("offset"),d=o.getLayout("size"),m=s.getBaseAxis().isHorizontal()?0:1;l[m]+=h+d/2}return l}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(Jf);Jf.registerClass(FN);var o3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(){return d8(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),r=this.get("largeThreshold");return r>t&&(t=r),t},e.prototype.brushSelector=function(t,r,i){return i.rect(r.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=use(FN.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(FN),a3e=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),TZ=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="sausage",r}return e.prototype.getDefaultShape=function(){return new a3e},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,a=Math.max(r.r0||0,0),l=Math.max(r.r,0),o=(l-a)*.5,h=a+o,d=r.startAngle,m=r.endAngle,v=r.clockwise,y=Math.PI*2,S=v?m-d<y:d-m<y;S||(d=m-(v?y:-y));var E=Math.cos(d),M=Math.sin(d),C=Math.cos(m),L=Math.sin(m);S?(t.moveTo(E*a+i,M*a+s),t.arc(E*h+i,M*h+s,o,-Math.PI+d,d,!v)):t.moveTo(E*l+i,M*l+s),t.arc(i,s,l,d,m,!v),t.arc(C*h+i,L*h+s,o,m-Math.PI*2,m-Math.PI,!v),a!==0&&t.arc(i,s,a,m,d,v)},e}($i);function l3e(n,e){e=e||{};var t=e.isRoundCap;return function(r,i,s){var a=i.position;if(!a||a instanceof Array)return PP(r,i,s);var l=n(a),o=i.distance!=null?i.distance:5,h=this.shape,d=h.cx,m=h.cy,v=h.r,y=h.r0,S=(v+y)/2,E=h.startAngle,M=h.endAngle,C=(E+M)/2,L=t?Math.abs(v-y)/2:0,k=Math.cos,H=Math.sin,q=d+v*k(E),Z=m+v*H(E),ee="left",re="top";switch(l){case"startArc":q=d+(y-o)*k(C),Z=m+(y-o)*H(C),ee="center",re="top";break;case"insideStartArc":q=d+(y+o)*k(C),Z=m+(y+o)*H(C),ee="center",re="bottom";break;case"startAngle":q=d+S*k(E)+cI(E,o+L,!1),Z=m+S*H(E)+uI(E,o+L,!1),ee="right",re="middle";break;case"insideStartAngle":q=d+S*k(E)+cI(E,-o+L,!1),Z=m+S*H(E)+uI(E,-o+L,!1),ee="left",re="middle";break;case"middle":q=d+S*k(C),Z=m+S*H(C),ee="center",re="middle";break;case"endArc":q=d+(v+o)*k(C),Z=m+(v+o)*H(C),ee="center",re="bottom";break;case"insideEndArc":q=d+(v-o)*k(C),Z=m+(v-o)*H(C),ee="center",re="top";break;case"endAngle":q=d+S*k(M)+cI(M,o+L,!0),Z=m+S*H(M)+uI(M,o+L,!0),ee="left",re="middle";break;case"insideEndAngle":q=d+S*k(M)+cI(M,-o+L,!0),Z=m+S*H(M)+uI(M,-o+L,!0),ee="right",re="middle";break;default:return PP(r,i,s)}return r=r||{},r.x=q,r.y=Z,r.align=ee,r.verticalAlign=re,r}}function c3e(n,e,t,r){if(Rs(r)){n.setTextConfig({rotation:r});return}else if(fr(e)){n.setTextConfig({rotation:0});return}var i=n.shape,s=i.clockwise?i.startAngle:i.endAngle,a=i.clockwise?i.endAngle:i.startAngle,l=(s+a)/2,o,h=t(e);switch(h){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":o=l;break;case"startAngle":case"insideStartAngle":o=s;break;case"endAngle":case"insideEndAngle":o=a;break;default:n.setTextConfig({rotation:0});return}var d=Math.PI*1.5-o;h==="middle"&&d>Math.PI/2&&d<Math.PI*1.5&&(d-=Math.PI),n.setTextConfig({rotation:d})}function cI(n,e,t){return e*Math.sin(n)*(t?-1:1)}function uI(n,e,t){return e*Math.cos(n)*(t?1:-1)}function PS(n,e,t){var r=n.get("borderRadius");if(r==null)return t?{cornerRadius:0}:null;fr(r)||(r=[r,r,r,r]);var i=Math.abs(e.r||0-e.r0||0);return{cornerRadius:xr(r,function(s){return gv(s,i)})}}var Sk=Math.max,Ak=Math.min;function u3e(n,e){var t=n.getArea&&n.getArea();if(w8(n,"cartesian2d")){var r=n.getBaseAxis();if(r.type!=="category"||!r.onBand){var i=e.getLayout("bandWidth");r.isHorizontal()?(t.x-=i,t.width+=i*2):(t.y-=i,t.height+=i*2)}}return t}var h3e=function(n){Hn(e,n);function e(){var t=n.call(this)||this;return t.type=e.type,t._isFirstFrame=!0,t}return e.prototype.render=function(t,r,i,s){this._model=t,this._removeOnRenderedListener(i),this._updateDrawMode(t);var a=t.get("coordinateSystem");(a==="cartesian2d"||a==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(t,r,i):this._renderNormal(t,r,i,s))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,r){this._progressiveEls=[],this._incrementalRenderLarge(t,r)},e.prototype.eachRendered=function(t){WD(this._progressiveEls||this.group,t)},e.prototype._updateDrawMode=function(t){var r=t.pipelineContext.large;(this._isLargeDraw==null||r!==this._isLargeDraw)&&(this._isLargeDraw=r,this._clear())},e.prototype._renderNormal=function(t,r,i,s){var a=this.group,l=t.getData(),o=this._data,h=t.coordinateSystem,d=h.getBaseAxis(),m;h.type==="cartesian2d"?m=d.isHorizontal():h.type==="polar"&&(m=d.dim==="angle");var v=t.isAnimationEnabled()?t:null,y=f3e(t,h);y&&this._enableRealtimeSort(y,l,i);var S=t.get("clip",!0)||y,E=u3e(h,l);a.removeClipPath();var M=t.get("roundCap",!0),C=t.get("showBackground",!0),L=t.getModel("backgroundStyle"),k=L.get("borderRadius")||0,H=[],q=this._backgroundEls,Z=s&&s.isInitSort,ee=s&&s.type==="changeAxisOrder";function re(fe){var Se=hI[h.type](l,fe),Ce=y3e(h,m,Se);return Ce.useStyle(L.getItemStyle()),h.type==="cartesian2d"?Ce.setShape("r",k):Ce.setShape("cornerRadius",k),H[fe]=Ce,Ce}l.diff(o).add(function(fe){var Se=l.getItemModel(fe),Ce=hI[h.type](l,fe,Se);if(C&&re(fe),!(!l.hasValue(fe)||!RZ[h.type](Ce))){var Ie=!1;S&&(Ie=MZ[h.type](E,Ce));var je=CZ[h.type](t,l,fe,Ce,m,v,d.model,!1,M);y&&(je.forceLabelAnimation=!0),PZ(je,l,fe,Se,Ce,t,m,h.type==="polar"),Z?je.attr({shape:Ce}):y?EZ(y,v,je,Ce,fe,m,!1,!1):ql(je,{shape:Ce},t,fe),l.setItemGraphicEl(fe,je),a.add(je),je.ignore=Ie}}).update(function(fe,Se){var Ce=l.getItemModel(fe),Ie=hI[h.type](l,fe,Ce);if(C){var je=void 0;q.length===0?je=re(Se):(je=q[Se],je.useStyle(L.getItemStyle()),h.type==="cartesian2d"?je.setShape("r",k):je.setShape("cornerRadius",k),H[fe]=je);var Le=hI[h.type](l,fe),ot=wae(m,Le,h);ol(je,{shape:ot},v,fe)}var ye=o.getItemGraphicEl(Se);if(!l.hasValue(fe)||!RZ[h.type](Ie)){a.remove(ye);return}var $e=!1;if(S&&($e=MZ[h.type](E,Ie),$e&&a.remove(ye)),ye?VU(ye):ye=CZ[h.type](t,l,fe,Ie,m,v,d.model,!!ye,M),y&&(ye.forceLabelAnimation=!0),ee){var Ve=ye.getTextContent();if(Ve){var _t=Ew(Ve);_t.prevValue!=null&&(_t.prevValue=_t.value)}}else PZ(ye,l,fe,Ce,Ie,t,m,h.type==="polar");Z?ye.attr({shape:Ie}):y?EZ(y,v,ye,Ie,fe,m,!0,ee):ol(ye,{shape:Ie},t,fe,null),l.setItemGraphicEl(fe,ye),ye.ignore=$e,a.add(ye)}).remove(function(fe){var Se=o.getItemGraphicEl(fe);Se&&NP(Se,t,fe)}).execute();var se=this._backgroundGroup||(this._backgroundGroup=new ma);se.removeAll();for(var ae=0;ae<H.length;++ae)se.add(H[ae]);a.add(se),this._backgroundEls=H,this._data=l},e.prototype._renderLarge=function(t,r,i){this._clear(),DZ(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,r){this._removeBackground(),DZ(r,this.group,this._progressiveEls,!0)},e.prototype._updateLargeClip=function(t){var r=t.get("clip",!0)&&WDe(t.coordinateSystem,!1,t),i=this.group;r?i.setClipPath(r):i.removeClipPath()},e.prototype._enableRealtimeSort=function(t,r,i){var s=this;if(r.count()){var a=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(r,t,i),this._isFirstFrame=!1;else{var l=function(o){var h=r.getItemGraphicEl(o),d=h&&h.shape;return d&&Math.abs(a.isHorizontal()?d.height:d.width)||0};this._onRendered=function(){s._updateSortWithinSameData(r,l,a,i)},i.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,r,i){var s=[];return t.each(t.mapDimension(r.dim),function(a,l){var o=i(l);o=o??NaN,s.push({dataIndex:l,mappedValue:o,ordinalNumber:a})}),s.sort(function(a,l){return l.mappedValue-a.mappedValue}),{ordinalNumbers:xr(s,function(a){return a.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(t,r,i){for(var s=i.scale,a=t.mapDimension(i.dim),l=Number.MAX_VALUE,o=0,h=s.getOrdinalMeta().categories.length;o<h;++o){var d=t.rawIndexOf(a,s.getRawOrdinalNumber(o)),m=d<0?Number.MIN_VALUE:r(t.indexOfRawIndex(d));if(m>l)return!0;l=m}return!1},e.prototype._isOrderDifferentInView=function(t,r){for(var i=r.scale,s=i.getExtent(),a=Math.max(0,s[0]),l=Math.min(s[1],i.getOrdinalMeta().categories.length-1);a<=l;++a)if(t.ordinalNumbers[a]!==i.getRawOrdinalNumber(a))return!0},e.prototype._updateSortWithinSameData=function(t,r,i,s){if(this._isOrderChangedWithinSameData(t,r,i)){var a=this._dataSort(t,i,r);this._isOrderDifferentInView(a,i)&&(this._removeOnRenderedListener(s),s.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:a}))}},e.prototype._dispatchInitSort=function(t,r,i){var s=r.baseAxis,a=this._dataSort(t,s,function(l){return t.get(t.mapDimension(r.otherAxis.dim),l)});i.dispatchAction({type:"changeAxisOrder",componentType:s.dim+"Axis",isInitSort:!0,axisId:s.index,sortInfo:a})},e.prototype.remove=function(t,r){this._clear(this._model),this._removeOnRenderedListener(r)},e.prototype.dispose=function(t,r){this._removeOnRenderedListener(r)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var r=this.group,i=this._data;t&&t.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(s){NP(s,t,Wi(s).dataIndex)})):r.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Ih),MZ={cartesian2d:function(n,e){var t=e.width<0?-1:1,r=e.height<0?-1:1;t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height);var i=n.x+n.width,s=n.y+n.height,a=Sk(e.x,n.x),l=Ak(e.x+e.width,i),o=Sk(e.y,n.y),h=Ak(e.y+e.height,s),d=l<a,m=h<o;return e.x=d&&a>i?l:a,e.y=m&&o>s?h:o,e.width=d?0:l-a,e.height=m?0:h-o,t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height),d||m},polar:function(n,e){var t=e.r0<=e.r?1:-1;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}var i=Ak(e.r,n.r),s=Sk(e.r0,n.r0);e.r=i,e.r0=s;var a=i-s<0;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}return a}},CZ={cartesian2d:function(n,e,t,r,i,s,a,l,o){var h=new Ho({shape:Jn({},r),z2:1});if(h.__dataIndex=t,h.name="item",s){var d=h.shape,m=i?"height":"width";d[m]=0}return h},polar:function(n,e,t,r,i,s,a,l,o){var h=!i&&o?TZ:Oh,d=new h({shape:r,z2:1});d.name="item";var m=bae(i);if(d.calculateTextPosition=l3e(m,{isRoundCap:h===TZ}),s){var v=d.shape,y=i?"r":"endAngle",S={};v[y]=i?r.r0:r.startAngle,S[y]=r[y],(l?ol:ql)(d,{shape:S},s)}return d}};function f3e(n,e){var t=n.get("realtimeSort",!0),r=e.getBaseAxis();if(t&&r.type==="category"&&e.type==="cartesian2d")return{baseAxis:r,otherAxis:e.getOtherAxis(r)}}function EZ(n,e,t,r,i,s,a,l){var o,h;s?(h={x:r.x,width:r.width},o={y:r.y,height:r.height}):(h={y:r.y,height:r.height},o={x:r.x,width:r.width}),l||(a?ol:ql)(t,{shape:o},e,i,null);var d=e?n.baseAxis.model:null;(a?ol:ql)(t,{shape:h},d,i)}function IZ(n,e){for(var t=0;t<e.length;t++)if(!isFinite(n[e[t]]))return!0;return!1}var d3e=["x","y","width","height"],p3e=["cx","cy","r","startAngle","endAngle"],RZ={cartesian2d:function(n){return!IZ(n,d3e)},polar:function(n){return!IZ(n,p3e)}},hI={cartesian2d:function(n,e,t){var r=n.getItemLayout(e),i=t?g3e(t,r):0,s=r.width>0?1:-1,a=r.height>0?1:-1;return{x:r.x+s*i/2,y:r.y+a*i/2,width:r.width-s*i,height:r.height-a*i}},polar:function(n,e,t){var r=n.getItemLayout(e);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}}};function m3e(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function bae(n){return function(e){var t=e?"Arc":"Angle";return function(r){switch(r){case"start":case"insideStart":case"end":case"insideEnd":return r+t;default:return r}}}(n)}function PZ(n,e,t,r,i,s,a,l){var o=e.getItemVisual(t,"style");if(l){if(!s.get("roundCap")){var d=n.shape,m=PS(r.getModel("itemStyle"),d,!0);Jn(d,m),n.setShape(d)}}else{var h=r.get(["itemStyle","borderRadius"])||0;n.setShape("r",h)}n.useStyle(o);var v=r.getShallow("cursor");v&&n.attr("cursor",v);var y=l?a?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":a?i.height>=0?"bottom":"top":i.width>=0?"right":"left",S=uM(r);cM(n,S,{labelFetcher:s,labelDataIndex:t,defaultText:x8(s.getData(),t),inheritColor:o.fill,defaultOpacity:o.opacity,defaultOutsidePosition:y});var E=n.getTextContent();if(l&&E){var M=r.get(["label","position"]);n.textConfig.inside=M==="middle"?!0:null,c3e(n,M==="outside"?y:M,bae(a),r.get(["label","rotate"]))}QEe(E,S,s.getRawValue(t),function(L){return dae(e,L)});var C=r.getModel(["emphasis"]);lT(n,C.get("focus"),C.get("blurScope"),C.get("disabled")),kP(n,r),m3e(i)&&(n.style.fill="none",n.style.stroke="none",it(n.states,function(L){L.style&&(L.style.fill=L.style.stroke="none")}))}function g3e(n,e){var t=n.get(["itemStyle","borderColor"]);if(!t||t==="none")return 0;var r=n.get(["itemStyle","borderWidth"])||0,i=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),s=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(r,i,s)}var v3e=function(){function n(){}return n}(),LZ=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="largeBar",r}return e.prototype.getDefaultShape=function(){return new v3e},e.prototype.buildPath=function(t,r){for(var i=r.points,s=this.baseDimIdx,a=1-this.baseDimIdx,l=[],o=[],h=this.barWidth,d=0;d<i.length;d+=3)o[s]=h,o[a]=i[d+2],l[s]=i[d+s],l[a]=i[d+a],t.rect(l[0],l[1],o[0],o[1])},e}($i);function DZ(n,e,t,r){var i=n.getData(),s=i.getLayout("valueAxisHorizontal")?1:0,a=i.getLayout("largeDataIndices"),l=i.getLayout("size"),o=n.getModel("backgroundStyle"),h=i.getLayout("largeBackgroundPoints");if(h){var d=new LZ({shape:{points:h},incremental:!!r,silent:!0,z2:0});d.baseDimIdx=s,d.largeDataIndices=a,d.barWidth=l,d.useStyle(o.getItemStyle()),e.add(d),t&&t.push(d)}var m=new LZ({shape:{points:i.getLayout("largePoints")},incremental:!!r,ignoreCoarsePointer:!0,z2:1});m.baseDimIdx=s,m.largeDataIndices=a,m.barWidth=l,e.add(m),m.useStyle(i.getVisual("style")),Wi(m).seriesIndex=n.seriesIndex,n.get("silent")||(m.on("mousedown",BZ),m.on("mousemove",BZ)),t&&t.push(m)}var BZ=a8(function(n){var e=this,t=_3e(e,n.offsetX,n.offsetY);Wi(e).dataIndex=t>=0?t:null},30,!1);function _3e(n,e,t){for(var r=n.baseDimIdx,i=1-r,s=n.shape.points,a=n.largeDataIndices,l=[],o=[],h=n.barWidth,d=0,m=s.length/3;d<m;d++){var v=d*3;if(o[r]=h,o[i]=s[v+2],l[r]=s[v+r],l[i]=s[v+i],o[i]<0&&(l[i]+=o[i],o[i]=-o[i]),e>=l[0]&&e<=l[0]+o[0]&&t>=l[1]&&t<=l[1]+o[1])return a[d]}return-1}function wae(n,e,t){if(w8(t,"cartesian2d")){var r=e,i=t.getArea();return{x:n?r.x:i.x,y:n?i.y:r.y,width:n?r.width:i.width,height:n?i.height:r.height}}else{var i=t.getArea(),s=e;return{cx:i.cx,cy:i.cy,r0:n?i.r0:s.r0,r:n?i.r:s.r,startAngle:n?s.startAngle:0,endAngle:n?s.endAngle:Math.PI*2}}}function y3e(n,e,t){var r=n.type==="polar"?Oh:Ho;return new r({shape:wae(e,t,n),silent:!0,z2:0})}function x3e(n){n.registerChartView(h3e),n.registerSeriesModel(o3e),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,vs(WLe,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,XLe("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,xae("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,t){var r=e.componentType||"series";t.eachComponent({mainType:r,query:e},function(i){e.sortInfo&&i.axis.setCategorySortInfo(e.sortInfo)})})}var kZ=Math.PI*2,fI=Math.PI/180;function Sae(n,e){return _v(n.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function Aae(n,e){var t=Sae(n,e),r=n.get("center"),i=n.get("radius");fr(i)||(i=[0,i]);var s=ls(t.width,e.getWidth()),a=ls(t.height,e.getHeight()),l=Math.min(s,a),o=ls(i[0],l/2),h=ls(i[1],l/2),d,m,v=n.coordinateSystem;if(v){var y=v.dataToPoint(r);d=y[0]||0,m=y[1]||0}else fr(r)||(r=[r,r]),d=ls(r[0],s)+t.x,m=ls(r[1],a)+t.y;return{cx:d,cy:m,r0:o,r:h}}function b3e(n,e,t){e.eachSeriesByType(n,function(r){var i=r.getData(),s=i.mapDimension("value"),a=Sae(r,t),l=Aae(r,t),o=l.cx,h=l.cy,d=l.r,m=l.r0,v=-r.get("startAngle")*fI,y=r.get("endAngle"),S=r.get("padAngle")*fI;y=y==="auto"?v-kZ:-y*fI;var E=r.get("minAngle")*fI,M=E+S,C=0;i.each(s,function(ot){!isNaN(ot)&&C++});var L=i.getSum(s),k=Math.PI/(L||C)*2,H=r.get("clockwise"),q=r.get("roseType"),Z=r.get("stillShowZeroSum"),ee=i.getDataExtent(s);ee[0]=0;var re=H?1:-1,se=[v,y],ae=re*S/2;wie(se,!H),v=se[0],y=se[1];var fe=Tae(r);fe.startAngle=v,fe.endAngle=y,fe.clockwise=H;var Se=Math.abs(y-v),Ce=Se,Ie=0,je=v;if(i.setLayout({viewRect:a,r:d}),i.each(s,function(ot,ye){var $e;if(isNaN(ot)){i.setItemLayout(ye,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:H,cx:o,cy:h,r0:m,r:q?NaN:d});return}q!=="area"?$e=L===0&&Z?k:ot*k:$e=Se/C,$e<M?($e=M,Ce-=M):Ie+=ot;var Ve=je+re*$e,_t=0,wt=0;S>$e?(_t=je+re*$e/2,wt=_t):(_t=je+ae,wt=Ve-ae),i.setItemLayout(ye,{angle:$e,startAngle:_t,endAngle:wt,clockwise:H,cx:o,cy:h,r0:m,r:q?F0(ot,ee,[m,d]):d}),je=Ve}),Ce<kZ&&C)if(Ce<=.001){var Le=Se/C;i.each(s,function(ot,ye){if(!isNaN(ot)){var $e=i.getItemLayout(ye);$e.angle=Le;var Ve=0,_t=0;Le<S?(Ve=v+re*(ye+1/2)*Le,_t=Ve):(Ve=v+re*ye*Le+ae,_t=v+re*(ye+1)*Le-ae),$e.startAngle=Ve,$e.endAngle=_t}})}else k=Ce/Ie,je=v,i.each(s,function(ot,ye){if(!isNaN(ot)){var $e=i.getItemLayout(ye),Ve=$e.angle===M?M:ot*k,_t=0,wt=0;Ve<S?(_t=je+re*Ve/2,wt=_t):(_t=je+ae,wt=je+re*Ve-ae),$e.startAngle=_t,$e.endAngle=wt,je+=re*Ve}})})}var Tae=$s();function w3e(n){return{seriesType:n,reset:function(e,t){var r=t.findComponents({mainType:"legend"});if(!(!r||!r.length)){var i=e.getData();i.filterSelf(function(s){for(var a=i.getName(s),l=0;l<r.length;l++)if(!r[l].isSelected(a))return!1;return!0})}}}}var S3e=Math.PI/180;function OZ(n,e,t,r,i,s,a,l,o,h){if(n.length<2)return;function d(E){for(var M=E.rB,C=M*M,L=0;L<E.list.length;L++){var k=E.list[L],H=Math.abs(k.label.y-t),q=r+k.len,Z=q*q,ee=Math.sqrt((1-Math.abs(H*H/C))*Z),re=e+(ee+k.len2)*i,se=re-k.label.x,ae=k.targetTextWidth-se*i;Mae(k,ae,!0),k.label.x=re}}function m(E){for(var M={list:[],maxY:0},C={list:[],maxY:0},L=0;L<E.length;L++)if(E[L].labelAlignTo==="none"){var k=E[L],H=k.label.y>t?C:M,q=Math.abs(k.label.y-t);if(q>=H.maxY){var Z=k.label.x-e-k.len2*i,ee=r+k.len,re=Math.abs(Z)<ee?Math.sqrt(q*q/(1-Z*Z/ee/ee)):ee;H.rB=re,H.maxY=q}H.list.push(k)}d(M),d(C)}for(var v=n.length,y=0;y<v;y++)if(n[y].position==="outer"&&n[y].labelAlignTo==="labelLine"){var S=n[y].label.x-h;n[y].linePoints[1][0]+=S,n[y].label.x=h}hae(n,o,o+a)&&m(n)}function A3e(n,e,t,r,i,s,a,l){for(var o=[],h=[],d=Number.MAX_VALUE,m=-Number.MAX_VALUE,v=0;v<n.length;v++){var y=n[v].label;Tk(n[v])||(y.x<e?(d=Math.min(d,y.x),o.push(n[v])):(m=Math.max(m,y.x),h.push(n[v])))}for(var v=0;v<n.length;v++){var S=n[v];if(!Tk(S)&&S.linePoints){if(S.labelStyleWidth!=null)continue;var y=S.label,E=S.linePoints,M=void 0;S.labelAlignTo==="edge"?y.x<e?M=E[2][0]-S.labelDistance-a-S.edgeDistance:M=a+i-S.edgeDistance-E[2][0]-S.labelDistance:S.labelAlignTo==="labelLine"?y.x<e?M=d-a-S.bleedMargin:M=a+i-m-S.bleedMargin:y.x<e?M=y.x-a-S.bleedMargin:M=a+i-y.x-S.bleedMargin,S.targetTextWidth=M,Mae(S,M)}}OZ(h,e,t,r,1,i,s,a,l,m),OZ(o,e,t,r,-1,i,s,a,l,d);for(var v=0;v<n.length;v++){var S=n[v];if(!Tk(S)&&S.linePoints){var y=S.label,E=S.linePoints,C=S.labelAlignTo==="edge",L=y.style.padding,k=L?L[1]+L[3]:0,H=y.style.backgroundColor?0:k,q=S.rect.width+H,Z=E[1][0]-E[2][0];C?y.x<e?E[2][0]=a+S.edgeDistance+q+S.labelDistance:E[2][0]=a+i-S.edgeDistance-q-S.labelDistance:(y.x<e?E[2][0]=y.x+S.labelDistance:E[2][0]=y.x-S.labelDistance,E[1][0]=E[2][0]+Z),E[1][1]=E[2][1]=y.y}}}function Mae(n,e,t){if(t===void 0&&(t=!1),n.labelStyleWidth==null){var r=n.label,i=r.style,s=n.rect,a=i.backgroundColor,l=i.padding,o=l?l[1]+l[3]:0,h=i.overflow,d=s.width+(a?0:o);if(e<d||t){var m=s.height;if(h&&h.match("break")){r.setStyle("backgroundColor",null),r.setStyle("width",e-o);var v=r.getBoundingRect();r.setStyle("width",Math.ceil(v.width)),r.setStyle("backgroundColor",a)}else{var y=e-o,S=e<d?y:t?y>n.unconstrainedWidth?null:y:null;r.setStyle("width",S)}var E=r.getBoundingRect();s.width=E.width;var M=(r.style.margin||0)+2.1;s.height=E.height+M,s.y-=(s.height-m)/2}}}function Tk(n){return n.position==="center"}function T3e(n){var e=n.getData(),t=[],r,i,s=!1,a=(n.get("minShowLabelAngle")||0)*S3e,l=e.getLayout("viewRect"),o=e.getLayout("r"),h=l.width,d=l.x,m=l.y,v=l.height;function y(Z){Z.ignore=!0}function S(Z){if(!Z.ignore)return!0;for(var ee in Z.states)if(Z.states[ee].ignore===!1)return!0;return!1}e.each(function(Z){var ee=e.getItemGraphicEl(Z),re=ee.shape,se=ee.getTextContent(),ae=ee.getTextGuideLine(),fe=e.getItemModel(Z),Se=fe.getModel("label"),Ce=Se.get("position")||fe.get(["emphasis","label","position"]),Ie=Se.get("distanceToLabelLine"),je=Se.get("alignTo"),Le=ls(Se.get("edgeDistance"),h),ot=Se.get("bleedMargin"),ye=fe.getModel("labelLine"),$e=ye.get("length");$e=ls($e,h);var Ve=ye.get("length2");if(Ve=ls(Ve,h),Math.abs(re.endAngle-re.startAngle)<a){it(se.states,y),se.ignore=!0,ae&&(it(ae.states,y),ae.ignore=!0);return}if(S(se)){var _t=(re.startAngle+re.endAngle)/2,wt=Math.cos(_t),Vt=Math.sin(_t),lt,Ht,Qt,rn;r=re.cx,i=re.cy;var jn=Ce==="inside"||Ce==="inner";if(Ce==="center")lt=re.cx,Ht=re.cy,rn="center";else{var Bn=(jn?(re.r+re.r0)/2*wt:re.r*wt)+r,Tn=(jn?(re.r+re.r0)/2*Vt:re.r*Vt)+i;if(lt=Bn+wt*3,Ht=Tn+Vt*3,!jn){var Pe=Bn+wt*($e+o-re.r),qe=Tn+Vt*($e+o-re.r),mn=Pe+(wt<0?-1:1)*Ve,cn=qe;je==="edge"?lt=wt<0?d+Le:d+h-Le:lt=mn+(wt<0?-Ie:Ie),Ht=cn,Qt=[[Bn,Tn],[Pe,qe],[mn,cn]]}rn=jn?"center":je==="edge"?wt>0?"right":"left":wt>0?"left":"right"}var St=Math.PI,Jt=0,kn=Se.get("rotate");if(Rs(kn))Jt=kn*(St/180);else if(Ce==="center")Jt=0;else if(kn==="radial"||kn===!0){var Gn=wt<0?-_t+St:-_t;Jt=Gn}else if(kn==="tangential"&&Ce!=="outside"&&Ce!=="outer"){var sn=Math.atan2(wt,Vt);sn<0&&(sn=St*2+sn);var at=Vt>0;at&&(sn=St+sn),Jt=sn-St}if(s=!!Jt,se.x=lt,se.y=Ht,se.rotation=Jt,se.setStyle({verticalAlign:"middle"}),jn){se.setStyle({align:rn});var An=se.states.select;An&&(An.x+=se.x,An.y+=se.y)}else{var Ue=se.getBoundingRect().clone();Ue.applyTransform(se.getComputedTransform());var $t=(se.style.margin||0)+2.1;Ue.y-=$t/2,Ue.height+=$t,t.push({label:se,labelLine:ae,position:Ce,len:$e,len2:Ve,minTurnAngle:ye.get("minTurnAngle"),maxSurfaceAngle:ye.get("maxSurfaceAngle"),surfaceNormal:new Jr(wt,Vt),linePoints:Qt,textAlign:rn,labelDistance:Ie,labelAlignTo:je,edgeDistance:Le,bleedMargin:ot,rect:Ue,unconstrainedWidth:Ue.width,labelStyleWidth:se.style.width})}ee.setTextConfig({inside:jn})}}),!s&&n.get("avoidLabelOverlap")&&A3e(t,r,i,o,h,v,d,m);for(var E=0;E<t.length;E++){var M=t[E],C=M.label,L=M.labelLine,k=isNaN(C.x)||isNaN(C.y);if(C){C.setStyle({align:M.textAlign}),k&&(it(C.states,y),C.ignore=!0);var H=C.states.select;H&&(H.x+=C.x,H.y+=C.y)}if(L){var q=M.linePoints;k||!q?(it(L.states,y),L.ignore=!0):(oae(q,M.minTurnAngle),EDe(q,M.surfaceNormal,M.maxSurfaceAngle),L.setShape({points:q}),C.__hostTarget.textGuideLineConfig={anchor:new Jr(q[0][0],q[0][1])})}}}var M3e=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this)||this;s.z2=2;var a=new Ea;return s.setTextContent(a),s.updateData(t,r,i,!0),s}return e.prototype.updateData=function(t,r,i,s){var a=this,l=t.hostModel,o=t.getItemModel(r),h=o.getModel("emphasis"),d=t.getItemLayout(r),m=Jn(PS(o.getModel("itemStyle"),d,!0),d);if(isNaN(m.startAngle)){a.setShape(m);return}if(s){a.setShape(m);var v=l.getShallow("animationType");l.ecModel.ssr?(ql(a,{scaleX:0,scaleY:0},l,{dataIndex:r,isFrom:!0}),a.originX=m.cx,a.originY=m.cy):v==="scale"?(a.shape.r=d.r0,ql(a,{shape:{r:d.r}},l,r)):i!=null?(a.setShape({startAngle:i,endAngle:i}),ql(a,{shape:{startAngle:d.startAngle,endAngle:d.endAngle}},l,r)):(a.shape.endAngle=d.startAngle,ol(a,{shape:{endAngle:d.endAngle}},l,r))}else VU(a),ol(a,{shape:m},l,r);a.useStyle(t.getItemVisual(r,"style")),kP(a,o);var y=(d.startAngle+d.endAngle)/2,S=l.get("selectedOffset"),E=Math.cos(y)*S,M=Math.sin(y)*S,C=o.getShallow("cursor");C&&a.attr("cursor",C),this._updateLabel(l,t,r),a.ensureState("emphasis").shape=Jn({r:d.r+(h.get("scale")&&h.get("scaleSize")||0)},PS(h.getModel("itemStyle"),d)),Jn(a.ensureState("select"),{x:E,y:M,shape:PS(o.getModel(["select","itemStyle"]),d)}),Jn(a.ensureState("blur"),{shape:PS(o.getModel(["blur","itemStyle"]),d)});var L=a.getTextGuideLine(),k=a.getTextContent();L&&Jn(L.ensureState("select"),{x:E,y:M}),Jn(k.ensureState("select"),{x:E,y:M}),lT(this,h.get("focus"),h.get("blurScope"),h.get("disabled"))},e.prototype._updateLabel=function(t,r,i){var s=this,a=r.getItemModel(i),l=a.getModel("labelLine"),o=r.getItemVisual(i,"style"),h=o&&o.fill,d=o&&o.opacity;cM(s,uM(a),{labelFetcher:r.hostModel,labelDataIndex:i,inheritColor:h,defaultOpacity:d,defaultText:t.getFormattedLabel(i,"normal")||r.getName(i)});var m=s.getTextContent();s.setTextConfig({position:null,rotation:null}),m.attr({z2:10});var v=t.get(["label","position"]);if(v!=="outside"&&v!=="outer")s.removeTextGuideLine();else{var y=this.getTextGuideLine();y||(y=new Cw,this.setTextGuideLine(y)),aae(this,lae(a),{stroke:h,opacity:nA(l.get(["lineStyle","opacity"]),d,1)})}},e}(Oh),C3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return e.prototype.render=function(t,r,i,s){var a=t.getData(),l=this._data,o=this.group,h;if(!l&&a.count()>0){for(var d=a.getItemLayout(0),m=1;isNaN(d&&d.startAngle)&&m<a.count();++m)d=a.getItemLayout(m);d&&(h=d.startAngle)}if(this._emptyCircleSector&&o.remove(this._emptyCircleSector),a.count()===0&&t.get("showEmptyCircle")){var v=Tae(t),y=new Oh({shape:Jn(Aae(t,i),v)});y.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=y,o.add(y)}a.diff(l).add(function(S){var E=new M3e(a,S,h);a.setItemGraphicEl(S,E),o.add(E)}).update(function(S,E){var M=l.getItemGraphicEl(E);M.updateData(a,S,h),M.off("click"),o.add(M),a.setItemGraphicEl(S,M)}).remove(function(S){var E=l.getItemGraphicEl(S);NP(E,t,S)}).execute(),T3e(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=a)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,r){var i=r.getData(),s=i.getItemLayout(0);if(s){var a=t[0]-s.cx,l=t[1]-s.cy,o=Math.sqrt(a*a+l*l);return o<=s.r&&o>=s.r0}},e.type="pie",e}(Ih);function E3e(n,e,t){e=fr(e)&&{coordDimensions:e}||Jn({encodeDefine:n.getEncode()},e);var r=n.getSource(),i=Noe(r,e).dimensions,s=new Foe(i,n);return s.initData(r,t),s}var I3e=function(){function n(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return n.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},n.prototype.containName=function(e){var t=this._getRawData();return t.indexOfName(e)>=0},n.prototype.indexOfName=function(e){var t=this._getDataWithEncodedVisual();return t.indexOfName(e)},n.prototype.getItemVisual=function(e,t){var r=this._getDataWithEncodedVisual();return r.getItemVisual(e,t)},n}(),R3e=$s(),P3e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new I3e(zs(this.getData,this),zs(this.getRawData,this)),this._defaultLabelLine(t)},e.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return E3e(this,{coordDimensions:["value"],encodeDefaulter:vs(EIe,this)})},e.prototype.getDataParams=function(t){var r=this.getData(),i=R3e(r),s=i.seats;if(!s){var a=[];r.each(r.mapDimension("value"),function(o){a.push(o)}),s=i.seats=SMe(a,r.hostModel.get("percentPrecision"))}var l=n.prototype.getDataParams.call(this,t);return l.percent=s[t]||0,l.$vars.push("percent"),l},e.prototype._defaultLabelLine=function(t){oN(t,"labelLine",["show"]);var r=t.labelLine,i=t.emphasis.labelLine;r.show=r.show&&t.label.show,i.show=i.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(Jf);function L3e(n){return{seriesType:n,reset:function(e,t){var r=e.getData();r.filterSelf(function(i){var s=r.mapDimension("value"),a=r.get(s,i);return!(Rs(a)&&!isNaN(a)&&a<0)})}}}function D3e(n){n.registerChartView(C3e),n.registerSeriesModel(P3e),hPe("pie",n.registerAction),n.registerLayout(vs(b3e,"pie")),n.registerProcessor(w3e("pie")),n.registerProcessor(L3e("pie"))}var B3e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(os),NN=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",xl).models[0]},e.type="cartesian2dAxis",e}(os);sd(NN,Koe);var Cae={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},k3e=Di({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},Cae),S8=Di({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},Cae),O3e=Di({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},S8),F3e=ti({logBase:10},S8);const N3e={category:k3e,value:S8,time:O3e,log:F3e};var z3e={value:1,category:1,time:1,log:1};function JP(n,e,t,r){it(z3e,function(i,s){var a=Di(Di({},N3e[s],!0),r,!0),l=function(o){Hn(h,o);function h(){var d=o!==null&&o.apply(this,arguments)||this;return d.type=e+"Axis."+s,d}return h.prototype.mergeDefaultAndTheme=function(d,m){var v=hT(this),y=v?QD(d):{},S=m.getTheme();Di(d,S.get(s+"Axis")),Di(d,this.getDefaultOption()),d.type=FZ(d),v&&sw(d,y,v)},h.prototype.optionUpdated=function(){var d=this.option;d.type==="category"&&(this.__ordinalMeta=BN.createByAxisModel(this))},h.prototype.getCategories=function(d){var m=this.option;if(m.type==="category")return d?m.data:this.__ordinalMeta.categories},h.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},h.type=e+"Axis."+s,h.defaultOption=a,h}(t);n.registerComponentModel(l)}),n.registerSubTypeDefaulter(e+"Axis",FZ)}function FZ(n){return n.type||(n.data?"category":"value")}var U3e=function(){function n(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return n.prototype.getAxis=function(e){return this._axes[e]},n.prototype.getAxes=function(){return xr(this._dimList,function(e){return this._axes[e]},this)},n.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),na(this.getAxes(),function(t){return t.scale.type===e})},n.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},n}(),zN=["x","y"];function NZ(n){return n.type==="interval"||n.type==="time"}var G3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=zN,t}return e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,r=this.getAxis("y").scale;if(!(!NZ(t)||!NZ(r))){var i=t.getExtent(),s=r.getExtent(),a=this.dataToPoint([i[0],s[0]]),l=this.dataToPoint([i[1],s[1]]),o=i[1]-i[0],h=s[1]-s[0];if(!(!o||!h)){var d=(l[0]-a[0])/o,m=(l[1]-a[1])/h,v=a[0]-i[0]*d,y=a[1]-s[0]*m,S=this._transform=[d,0,0,m,v,y];this._invTransform=ID([],S)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var r=this.getAxis("x"),i=this.getAxis("y");return r.contain(r.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,r){var i=this.dataToPoint(t),s=this.dataToPoint(r),a=this.getArea(),l=new cs(i[0],i[1],s[0]-i[0],s[1]-i[1]);return a.intersect(l)},e.prototype.dataToPoint=function(t,r,i){i=i||[];var s=t[0],a=t[1];if(this._transform&&s!=null&&isFinite(s)&&a!=null&&isFinite(a))return Eh(i,t,this._transform);var l=this.getAxis("x"),o=this.getAxis("y");return i[0]=l.toGlobalCoord(l.dataToCoord(s,r)),i[1]=o.toGlobalCoord(o.dataToCoord(a,r)),i},e.prototype.clampData=function(t,r){var i=this.getAxis("x").scale,s=this.getAxis("y").scale,a=i.getExtent(),l=s.getExtent(),o=i.parse(t[0]),h=s.parse(t[1]);return r=r||[],r[0]=Math.min(Math.max(Math.min(a[0],a[1]),o),Math.max(a[0],a[1])),r[1]=Math.min(Math.max(Math.min(l[0],l[1]),h),Math.max(l[0],l[1])),r},e.prototype.pointToData=function(t,r){var i=[];if(this._invTransform)return Eh(i,t,this._invTransform);var s=this.getAxis("x"),a=this.getAxis("y");return i[0]=s.coordToData(s.toLocalCoord(t[0]),r),i[1]=a.coordToData(a.toLocalCoord(t[1]),r),i},e.prototype.getOtherAxis=function(t){return this.getAxis(t.dim==="x"?"y":"x")},e.prototype.getArea=function(t){t=t||0;var r=this.getAxis("x").getGlobalExtent(),i=this.getAxis("y").getGlobalExtent(),s=Math.min(r[0],r[1])-t,a=Math.min(i[0],i[1])-t,l=Math.max(r[0],r[1])-s+t,o=Math.max(i[0],i[1])-a+t;return new cs(s,a,l,o)},e}(U3e),V3e=function(n){Hn(e,n);function e(t,r,i,s,a){var l=n.call(this,t,r,i)||this;return l.index=0,l.type=s||"value",l.position=a||"bottom",l}return e.prototype.isHorizontal=function(){var t=this.position;return t==="top"||t==="bottom"},e.prototype.getGlobalExtent=function(t){var r=this.getExtent();return r[0]=this.toGlobalCoord(r[0]),r[1]=this.toGlobalCoord(r[1]),t&&r[0]>r[1]&&r.reverse(),r},e.prototype.pointToData=function(t,r){return this.coordToData(this.toLocalCoord(t[this.dim==="x"?0:1]),r)},e.prototype.setCategorySortInfo=function(t){if(this.type!=="category")return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(A1);function UN(n,e,t){t=t||{};var r=n.coordinateSystem,i=e.axis,s={},a=i.getAxesOnZeroOf()[0],l=i.position,o=a?"onZero":l,h=i.dim,d=r.getRect(),m=[d.x,d.x+d.width,d.y,d.y+d.height],v={left:0,right:1,top:0,bottom:1,onZero:2},y=e.get("offset")||0,S=h==="x"?[m[2]-y,m[3]+y]:[m[0]-y,m[1]+y];if(a){var E=a.toGlobalCoord(a.dataToCoord(0));S[v.onZero]=Math.max(Math.min(E,S[1]),S[0])}s.position=[h==="y"?S[v[o]]:m[0],h==="x"?S[v[o]]:m[3]],s.rotation=Math.PI/2*(h==="x"?0:1);var M={top:-1,bottom:1,left:-1,right:1};s.labelDirection=s.tickDirection=s.nameDirection=M[l],s.labelOffset=a?S[v[l]]-S[v.onZero]:0,e.get(["axisTick","inside"])&&(s.tickDirection=-s.tickDirection),iT(t.labelInside,e.get(["axisLabel","inside"]))&&(s.labelDirection=-s.labelDirection);var C=e.get(["axisLabel","rotate"]);return s.labelRotate=o==="top"?-C:C,s.z2=1,s}function zZ(n){return n.get("coordinateSystem")==="cartesian2d"}function UZ(n){var e={xAxisModel:null,yAxisModel:null};return it(e,function(t,r){var i=r.replace(/Model$/,""),s=n.getReferringComponents(i,xl).models[0];e[r]=s}),e}var Mk=Math.log;function H3e(n,e,t){var r=Rw.prototype,i=r.getTicks.call(t),s=r.getTicks.call(t,!0),a=i.length-1,l=r.getInterval.call(t),o=qoe(n,e),h=o.extent,d=o.fixMin,m=o.fixMax;if(n.type==="log"){var v=Mk(n.base);h=[Mk(h[0])/v,Mk(h[1])/v]}n.setExtent(h[0],h[1]),n.calcNiceExtent({splitNumber:a,fixMin:d,fixMax:m});var y=r.getExtent.call(n);d&&(h[0]=y[0]),m&&(h[1]=y[1]);var S=r.getInterval.call(n),E=h[0],M=h[1];if(d&&m)S=(M-E)/a;else if(d)for(M=h[0]+S*a;M<h[1]&&isFinite(M)&&isFinite(h[1]);)S=vk(S),M=h[0]+S*a;else if(m)for(E=h[1]-S*a;E>h[0]&&isFinite(E)&&isFinite(h[0]);)S=vk(S),E=h[1]-S*a;else{var C=n.getTicks().length-1;C>a&&(S=vk(S));var L=S*a;M=Math.ceil(h[1]/S)*S,E=Aa(M-L),E<0&&h[0]>=0?(E=0,M=Aa(L)):M>0&&h[1]<=0&&(M=0,E=-Aa(L))}var k=(i[0].value-s[0].value)/l,H=(i[a].value-s[a].value)/l;r.setExtent.call(n,E+S*k,M+S*H),r.setInterval.call(n,S),(k||H)&&r.setNiceExtent.call(n,E+S,M-S)}var j3e=function(){function n(e,t,r){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=zN,this._initCartesian(e,t,r),this.model=e}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(e,t){var r=this._axesMap;this._updateScale(e,this.model);function i(a){var l,o=so(a),h=o.length;if(h){for(var d=[],m=h-1;m>=0;m--){var v=+o[m],y=a[v],S=y.model,E=y.scale;kN(E)&&S.get("alignTicks")&&S.get("interval")==null?d.push(y):(qP(E,S),kN(E)&&(l=y))}d.length&&(l||(l=d.pop(),qP(l.scale,l.model)),it(d,function(M){H3e(M.scale,M.model,l.scale)}))}}i(r.x),i(r.y);var s={};it(r.x,function(a){GZ(r,"y",a,s)}),it(r.y,function(a){GZ(r,"x",a,s)}),this.resize(this.model,t)},n.prototype.resize=function(e,t,r){var i=e.getBoxLayoutParams(),s=!r&&e.get("containLabel"),a=_v(i,{width:t.getWidth(),height:t.getHeight()});this._rect=a;var l=this._axesList;o(),s&&(it(l,function(h){if(!h.model.get(["axisLabel","inside"])){var d=uDe(h);if(d){var m=h.isHorizontal()?"height":"width",v=h.model.get(["axisLabel","margin"]);a[m]-=d[m]+v,h.position==="top"?a.y+=d.height+v:h.position==="left"&&(a.x+=d.width+v)}}}),o()),it(this._coordsList,function(h){h.calcAffineTransform()});function o(){it(l,function(h){var d=h.isHorizontal(),m=d?[0,a.width]:[0,a.height],v=h.inverse?1:0;h.setExtent(m[v],m[1-v]),W3e(h,d?a.x:a.y)})}},n.prototype.getAxis=function(e,t){var r=this._axesMap[e];if(r!=null)return r[t||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(e,t){if(e!=null&&t!=null){var r="x"+e+"y"+t;return this._coordsMap[r]}Xr(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,s=this._coordsList;i<s.length;i++)if(s[i].getAxis("x").index===e||s[i].getAxis("y").index===t)return s[i]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.dataToPoint(r):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(r)):null},n.prototype.convertFromPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.pointToData(r):i.axis?i.axis.coordToData(i.axis.toLocalCoord(r)):null},n.prototype._findConvertTarget=function(e){var t=e.seriesModel,r=e.xAxisModel||t&&t.getReferringComponents("xAxis",xl).models[0],i=e.yAxisModel||t&&t.getReferringComponents("yAxis",xl).models[0],s=e.gridModel,a=this._coordsList,l,o;if(t)l=t.coordinateSystem,Xi(a,l)<0&&(l=null);else if(r&&i)l=this.getCartesian(r.componentIndex,i.componentIndex);else if(r)o=this.getAxis("x",r.componentIndex);else if(i)o=this.getAxis("y",i.componentIndex);else if(s){var h=s.coordinateSystem;h===this&&(l=this._coordsList[0])}return{cartesian:l,axis:o}},n.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},n.prototype._initCartesian=function(e,t,r){var i=this,s=this,a={left:!1,right:!1,top:!1,bottom:!1},l={x:{},y:{}},o={x:0,y:0};if(t.eachComponent("xAxis",h("x"),this),t.eachComponent("yAxis",h("y"),this),!o.x||!o.y){this._axesMap={},this._axesList=[];return}this._axesMap=l,it(l.x,function(d,m){it(l.y,function(v,y){var S="x"+m+"y"+y,E=new G3e(S);E.master=i,E.model=e,i._coordsMap[S]=E,i._coordsList.push(E),E.addAxis(d),E.addAxis(v)})});function h(d){return function(m,v){if(Ck(m,e)){var y=m.get("position");d==="x"?y!=="top"&&y!=="bottom"&&(y=a.bottom?"top":"bottom"):y!=="left"&&y!=="right"&&(y=a.left?"right":"left"),a[y]=!0;var S=new V3e(d,Zoe(m),[0,0],m.get("type"),y),E=S.type==="category";S.onBand=E&&m.get("boundaryGap"),S.inverse=m.get("inverse"),m.axis=S,S.model=m,S.grid=s,S.index=v,s._axesList.push(S),l[d][v]=S,o[d]++}}}},n.prototype._updateScale=function(e,t){it(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var s=i.model.get("categorySortInfo");i.scale.setSortInfo(s)}}),e.eachSeries(function(i){if(zZ(i)){var s=UZ(i),a=s.xAxisModel,l=s.yAxisModel;if(!Ck(a,t)||!Ck(l,t))return;var o=this.getCartesian(a.componentIndex,l.componentIndex),h=i.getData(),d=o.getAxis("x"),m=o.getAxis("y");r(h,d),r(h,m)}},this);function r(i,s){it(ZP(i,s.dim),function(a){s.scale.unionExtentFromData(i,a)})}},n.prototype.getTooltipAxes=function(e){var t=[],r=[];return it(this.getCartesians(),function(i){var s=e!=null&&e!=="auto"?i.getAxis(e):i.getBaseAxis(),a=i.getOtherAxis(s);Xi(t,s)<0&&t.push(s),Xi(r,a)<0&&r.push(a)}),{baseAxes:t,otherAxes:r}},n.create=function(e,t){var r=[];return e.eachComponent("grid",function(i,s){var a=new n(i,e,t);a.name="grid_"+s,a.resize(i,t,!0),i.coordinateSystem=a,r.push(a)}),e.eachSeries(function(i){if(zZ(i)){var s=UZ(i),a=s.xAxisModel,l=s.yAxisModel,o=a.getCoordSysModel(),h=o.coordinateSystem;i.coordinateSystem=h.getCartesian(a.componentIndex,l.componentIndex)}}),r},n.dimensions=zN,n}();function Ck(n,e){return n.getCoordSysModel()===e}function GZ(n,e,t,r){t.getAxesOnZeroOf=function(){return s?[s]:[]};var i=n[e],s,a=t.model,l=a.get(["axisLine","onZero"]),o=a.get(["axisLine","onZeroAxisIndex"]);if(!l)return;if(o!=null)VZ(i[o])&&(s=i[o]);else for(var h in i)if(i.hasOwnProperty(h)&&VZ(i[h])&&!r[d(i[h])]){s=i[h];break}s&&(r[d(s)]=!0);function d(m){return m.dim+"_"+m.index}}function VZ(n){return n&&n.type!=="category"&&n.type!=="time"&&cDe(n)}function W3e(n,e){var t=n.getExtent(),r=t[0]+t[1];n.toGlobalCoord=n.dim==="x"?function(i){return i+e}:function(i){return r-i+e},n.toLocalCoord=n.dim==="x"?function(i){return i-e}:function(i){return r-i+e}}var W0=Math.PI,Rh=function(){function n(e,t){this.group=new ma,this.opt=t,this.axisModel=e,ti(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var r=new ma({x:t.position[0],y:t.position[1],rotation:t.rotation});r.updateTransform(),this._transformGroup=r}return n.prototype.hasBuilder=function(e){return!!HZ[e]},n.prototype.add=function(e){HZ[e](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(e,t,r){var i=oie(t-e),s,a;return LP(i)?(a=r>0?"top":"bottom",s="center"):LP(i-W0)?(a=r>0?"bottom":"top",s="center"):(a="middle",i>0&&i<W0?s=r>0?"right":"left":s=r>0?"left":"right"),{rotation:i,textAlign:s,textVerticalAlign:a}},n.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},n.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},n}(),HZ={axisLine:function(n,e,t,r){var i=e.get(["axisLine","show"]);if(i==="auto"&&n.handleAutoShown&&(i=n.handleAutoShown("axisLine")),!!i){var s=e.axis.getExtent(),a=r.transform,l=[s[0],0],o=[s[1],0],h=l[0]>o[0];a&&(Eh(l,l,a),Eh(o,o,a));var d=Jn({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),m=new Gf({shape:{x1:l[0],y1:l[1],x2:o[0],y2:o[1]},style:d,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});cT(m.shape,m.style.lineWidth),m.anid="line",t.add(m);var v=e.get(["axisLine","symbol"]);if(v!=null){var y=e.get(["axisLine","symbolSize"]);Dr(v)&&(v=[v,v]),(Dr(y)||Rs(y))&&(y=[y,y]);var S=loe(e.get(["axisLine","symbolOffset"])||0,y),E=y[0],M=y[1];it([{rotate:n.rotation+Math.PI/2,offset:S[0],r:0},{rotate:n.rotation-Math.PI/2,offset:S[1],r:Math.sqrt((l[0]-o[0])*(l[0]-o[0])+(l[1]-o[1])*(l[1]-o[1]))}],function(C,L){if(v[L]!=="none"&&v[L]!=null){var k=aw(v[L],-E/2,-M/2,E,M,d.stroke,!0),H=C.r+C.offset,q=h?o:l;k.attr({rotation:C.rotate,x:q[0]+H*Math.cos(n.rotation),y:q[1]-H*Math.sin(n.rotation),silent:!0,z2:11}),t.add(k)}})}}},axisTickLabel:function(n,e,t,r){var i=q3e(t,r,e,n),s=Y3e(t,r,e,n);if($3e(e,s,i),Z3e(t,r,e,n.tickDirection),e.get(["axisLabel","hideOverlap"])){var a=cae(xr(s,function(l){return{label:l,priority:l.z2,defaultAttr:{ignore:l.ignore}}}));fae(a)}},axisName:function(n,e,t,r){var i=iT(n.axisName,e.get("name"));if(i){var s=e.get("nameLocation"),a=n.nameDirection,l=e.getModel("nameTextStyle"),o=e.get("nameGap")||0,h=e.axis.getExtent(),d=h[0]>h[1]?-1:1,m=[s==="start"?h[0]-d*o:s==="end"?h[1]+d*o:(h[0]+h[1])/2,WZ(s)?n.labelOffset+a*o:0],v,y=e.get("nameRotate");y!=null&&(y=y*W0/180);var S;WZ(s)?v=Rh.innerTextLayout(n.rotation,y??n.rotation,a):(v=X3e(n.rotation,s,y||0,h),S=n.axisNameAvailableWidth,S!=null&&(S=Math.abs(S/Math.sin(v.rotation)),!isFinite(S)&&(S=null)));var E=l.getFont(),M=e.get("nameTruncate",!0)||{},C=M.ellipsis,L=iT(n.nameTruncateMaxWidth,M.maxWidth,S),k=new Ea({x:m[0],y:m[1],rotation:v.rotation,silent:Rh.isLabelSilent(e),style:Qm(l,{text:i,font:E,overflow:"truncate",width:L,ellipsis:C,fill:l.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:l.get("align")||v.textAlign,verticalAlign:l.get("verticalAlign")||v.textVerticalAlign}),z2:1});if(jD({el:k,componentModel:e,itemName:i}),k.__fullText=i,k.anid="name",e.get("triggerEvent")){var H=Rh.makeAxisEventDataBase(e);H.targetType="axisName",H.name=i,Wi(k).eventData=H}r.add(k),k.updateTransform(),t.add(k),k.decomposeTransform()}}};function X3e(n,e,t,r){var i=oie(t-n),s,a,l=r[0]>r[1],o=e==="start"&&!l||e!=="start"&&l;return LP(i-W0/2)?(a=o?"bottom":"top",s="center"):LP(i-W0*1.5)?(a=o?"top":"bottom",s="center"):(a="middle",i<W0*1.5&&i>W0/2?s=o?"left":"right":s=o?"right":"left"),{rotation:i,textAlign:s,textVerticalAlign:a}}function $3e(n,e,t){if(!Yoe(n.axis)){var r=n.get(["axisLabel","showMinLabel"]),i=n.get(["axisLabel","showMaxLabel"]);e=e||[],t=t||[];var s=e[0],a=e[1],l=e[e.length-1],o=e[e.length-2],h=t[0],d=t[1],m=t[t.length-1],v=t[t.length-2];r===!1?(uh(s),uh(h)):jZ(s,a)&&(r?(uh(a),uh(d)):(uh(s),uh(h))),i===!1?(uh(l),uh(m)):jZ(o,l)&&(i?(uh(o),uh(v)):(uh(l),uh(m)))}}function uh(n){n&&(n.ignore=!0)}function jZ(n,e){var t=n&&n.getBoundingRect().clone(),r=e&&e.getBoundingRect().clone();if(!(!t||!r)){var i=EU([]);return ED(i,i,-n.rotation),t.applyTransform(Bb([],i,n.getLocalTransform())),r.applyTransform(Bb([],i,e.getLocalTransform())),t.intersect(r)}}function WZ(n){return n==="middle"||n==="center"}function Eae(n,e,t,r,i){for(var s=[],a=[],l=[],o=0;o<n.length;o++){var h=n[o].coord;a[0]=h,a[1]=0,l[0]=h,l[1]=t,e&&(Eh(a,a,e),Eh(l,l,e));var d=new Gf({shape:{x1:a[0],y1:a[1],x2:l[0],y2:l[1]},style:r,z2:2,autoBatch:!0,silent:!0});cT(d.shape,d.style.lineWidth),d.anid=i+"_"+n[o].tickValue,s.push(d)}return s}function q3e(n,e,t,r){var i=t.axis,s=t.getModel("axisTick"),a=s.get("show");if(a==="auto"&&r.handleAutoShown&&(a=r.handleAutoShown("axisTick")),!(!a||i.scale.isBlank())){for(var l=s.getModel("lineStyle"),o=r.tickDirection*s.get("length"),h=i.getTicksCoords(),d=Eae(h,e.transform,o,ti(l.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}),"ticks"),m=0;m<d.length;m++)n.add(d[m]);return d}}function Z3e(n,e,t,r){var i=t.axis,s=t.getModel("minorTick");if(!(!s.get("show")||i.scale.isBlank())){var a=i.getMinorTicksCoords();if(a.length)for(var l=s.getModel("lineStyle"),o=r*s.get("length"),h=ti(l.getLineStyle(),ti(t.getModel("axisTick").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})),d=0;d<a.length;d++)for(var m=Eae(a[d],e.transform,o,h,"minorticks_"+d),v=0;v<m.length;v++)n.add(m[v])}}function Y3e(n,e,t,r){var i=t.axis,s=iT(r.axisLabelShow,t.get(["axisLabel","show"]));if(!(!s||i.scale.isBlank())){var a=t.getModel("axisLabel"),l=a.get("margin"),o=i.getViewLabels(),h=(iT(r.labelRotate,a.get("rotate"))||0)*W0/180,d=Rh.innerTextLayout(r.rotation,h,r.labelDirection),m=t.getCategories&&t.getCategories(!0),v=[],y=Rh.isLabelSilent(t),S=t.get("triggerEvent");return it(o,function(E,M){var C=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(E.tickValue):E.tickValue,L=E.formattedLabel,k=E.rawLabel,H=a;if(m&&m[C]){var q=m[C];Xr(q)&&q.textStyle&&(H=new Ro(q.textStyle,a,t.ecModel))}var Z=H.getTextColor()||t.get(["axisLine","lineStyle","color"]),ee=i.dataToCoord(C),re=H.getShallow("align",!0)||d.textAlign,se=Ei(H.getShallow("alignMinLabel",!0),re),ae=Ei(H.getShallow("alignMaxLabel",!0),re),fe=H.getShallow("verticalAlign",!0)||H.getShallow("baseline",!0)||d.textVerticalAlign,Se=Ei(H.getShallow("verticalAlignMinLabel",!0),fe),Ce=Ei(H.getShallow("verticalAlignMaxLabel",!0),fe),Ie=new Ea({x:ee,y:r.labelOffset+r.labelDirection*l,rotation:d.rotation,silent:y,z2:10+(E.level||0),style:Qm(H,{text:L,align:M===0?se:M===o.length-1?ae:re,verticalAlign:M===0?Se:M===o.length-1?Ce:fe,fill:ci(Z)?Z(i.type==="category"?k:i.type==="value"?C+"":C,M):Z})});if(Ie.anid="label_"+C,S){var je=Rh.makeAxisEventDataBase(t);je.targetType="axisLabel",je.value=k,je.tickIndex=M,i.type==="category"&&(je.dataIndex=C),Wi(Ie).eventData=je}e.add(Ie),Ie.updateTransform(),v.push(Ie),n.add(Ie),Ie.decomposeTransform()}),v}}function K3e(n,e){var t={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return J3e(t,n,e),t.seriesInvolved&&e4e(t,n),t}function J3e(n,e,t){var r=e.getComponent("tooltip"),i=e.getComponent("axisPointer"),s=i.get("link",!0)||[],a=[];it(t.getCoordinateSystems(),function(l){if(!l.axisPointerEnabled)return;var o=_T(l.model),h=n.coordSysAxesInfo[o]={};n.coordSysMap[o]=l;var d=l.model,m=d.getModel("tooltip",r);if(it(l.getAxes(),vs(E,!1,null)),l.getTooltipAxes&&r&&m.get("show")){var v=m.get("trigger")==="axis",y=m.get(["axisPointer","type"])==="cross",S=l.getTooltipAxes(m.get(["axisPointer","axis"]));(v||y)&&it(S.baseAxes,vs(E,y?"cross":!0,v)),y&&it(S.otherAxes,vs(E,"cross",!1))}function E(M,C,L){var k=L.model.getModel("axisPointer",i),H=k.get("show");if(!(!H||H==="auto"&&!M&&!GN(k))){C==null&&(C=k.get("triggerTooltip")),k=M?Q3e(L,m,i,e,M,C):k;var q=k.get("snap"),Z=k.get("triggerEmphasis"),ee=_T(L.model),re=C||q||L.type==="category",se=n.axesInfo[ee]={key:ee,axis:L,coordSys:l,axisPointerModel:k,triggerTooltip:C,triggerEmphasis:Z,involveSeries:re,snap:q,useHandle:GN(k),seriesModels:[],linkGroup:null};h[ee]=se,n.seriesInvolved=n.seriesInvolved||re;var ae=t4e(s,L);if(ae!=null){var fe=a[ae]||(a[ae]={axesInfo:{}});fe.axesInfo[ee]=se,fe.mapper=s[ae].mapper,se.linkGroup=fe}}}})}function Q3e(n,e,t,r,i,s){var a=e.getModel("axisPointer"),l=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],o={};it(l,function(v){o[v]=_i(a.get(v))}),o.snap=n.type!=="category"&&!!s,a.get("type")==="cross"&&(o.type="line");var h=o.label||(o.label={});if(h.show==null&&(h.show=!1),i==="cross"){var d=a.get(["label","show"]);if(h.show=d??!0,!s){var m=o.lineStyle=a.get("crossStyle");m&&ti(h,m.textStyle)}}return n.model.getModel("axisPointer",new Ro(o,t,r))}function e4e(n,e){e.eachSeries(function(t){var r=t.coordinateSystem,i=t.get(["tooltip","trigger"],!0),s=t.get(["tooltip","show"],!0);!r||i==="none"||i===!1||i==="item"||s===!1||t.get(["axisPointer","show"],!0)===!1||it(n.coordSysAxesInfo[_T(r.model)],function(a){var l=a.axis;r.getAxis(l.dim)===l&&(a.seriesModels.push(t),a.seriesDataCount==null&&(a.seriesDataCount=0),a.seriesDataCount+=t.getData().count())})})}function t4e(n,e){for(var t=e.model,r=e.dim,i=0;i<n.length;i++){var s=n[i]||{};if(Ek(s[r+"AxisId"],t.id)||Ek(s[r+"AxisIndex"],t.componentIndex)||Ek(s[r+"AxisName"],t.name))return i}}function Ek(n,e){return n==="all"||fr(n)&&Xi(n,e)>=0||n===e}function n4e(n){var e=A8(n);if(e){var t=e.axisPointerModel,r=e.axis.scale,i=t.option,s=t.get("status"),a=t.get("value");a!=null&&(a=r.parse(a));var l=GN(t);s==null&&(i.status=l?"show":"hide");var o=r.getExtent().slice();o[0]>o[1]&&o.reverse(),(a==null||a>o[1])&&(a=o[1]),a<o[0]&&(a=o[0]),i.value=a,l&&(i.status=e.axis.scale.isBlank()?"hide":"show")}}function A8(n){var e=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[_T(n)]}function r4e(n){var e=A8(n);return e&&e.axisPointerModel}function GN(n){return!!n.get(["handle","show"])}function _T(n){return n.type+"||"+n.id}var XZ={},fM=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,s){this.axisPointerClass&&n4e(t),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,i,!0)},e.prototype.updateAxisPointer=function(t,r,i,s){this._doUpdateAxisPointerClass(t,i,!1)},e.prototype.remove=function(t,r){var i=this._axisPointer;i&&i.remove(r)},e.prototype.dispose=function(t,r){this._disposeAxisPointer(r),n.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(t,r,i){var s=e.getAxisPointerClass(this.axisPointerClass);if(s){var a=r4e(t);a?(this._axisPointer||(this._axisPointer=new s)).render(t,a,r,i):this._disposeAxisPointer(r)}},e.prototype._disposeAxisPointer=function(t){this._axisPointer&&this._axisPointer.dispose(t),this._axisPointer=null},e.registerAxisPointerClass=function(t,r){XZ[t]=r},e.getAxisPointerClass=function(t){return t&&XZ[t]},e.type="axis",e}(Pc),VN=$s();function i4e(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var s=t.getModel("splitArea"),a=s.getModel("areaStyle"),l=a.get("color"),o=r.coordinateSystem.getRect(),h=i.getTicksCoords({tickModel:s,clamp:!0});if(h.length){var d=l.length,m=VN(n).splitAreaColors,v=ii(),y=0;if(m)for(var S=0;S<h.length;S++){var E=m.get(h[S].tickValue);if(E!=null){y=(E+(d-1)*S)%d;break}}var M=i.toGlobalCoord(h[0].coord),C=a.getAreaStyle();l=fr(l)?l:[l];for(var S=1;S<h.length;S++){var L=i.toGlobalCoord(h[S].coord),k=void 0,H=void 0,q=void 0,Z=void 0;i.isHorizontal()?(k=M,H=o.y,q=L-k,Z=o.height,M=k+q):(k=o.x,H=M,q=o.width,Z=L-H,M=H+Z);var ee=h[S-1].tickValue;ee!=null&&v.set(ee,y),e.add(new Ho({anid:ee!=null?"area_"+ee:null,shape:{x:k,y:H,width:q,height:Z},style:ti({fill:l[y]},C),autoBatch:!0,silent:!0})),y=(y+1)%d}VN(n).splitAreaColors=v}}}function s4e(n){VN(n).splitAreaColors=null}var o4e=["axisLine","axisTickLabel","axisName"],a4e=["splitArea","splitLine","minorSplitLine"],Iae=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="CartesianAxisPointer",t}return e.prototype.render=function(t,r,i,s){this.group.removeAll();var a=this._axisGroup;if(this._axisGroup=new ma,this.group.add(this._axisGroup),!!t.get("show")){var l=t.getCoordSysModel(),o=UN(l,t),h=new Rh(t,Jn({handleAutoShown:function(m){for(var v=l.coordinateSystem.getCartesians(),y=0;y<v.length;y++)if(kN(v[y].getOtherAxis(t.axis).scale))return!0;return!1}},o));it(o4e,h.add,h),this._axisGroup.add(h.getGroup()),it(a4e,function(m){t.get([m,"show"])&&l4e[m](this,this._axisGroup,t,l)},this);var d=s&&s.type==="changeAxisOrder"&&s.isInitSort;d||WU(a,this._axisGroup,t),n.prototype.render.call(this,t,r,i,s)}},e.prototype.remove=function(){s4e(this)},e.type="cartesianAxis",e}(fM),l4e={splitLine:function(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var s=t.getModel("splitLine"),a=s.getModel("lineStyle"),l=a.get("color");l=fr(l)?l:[l];for(var o=r.coordinateSystem.getRect(),h=i.isHorizontal(),d=0,m=i.getTicksCoords({tickModel:s}),v=[],y=[],S=a.getLineStyle(),E=0;E<m.length;E++){var M=i.toGlobalCoord(m[E].coord);h?(v[0]=M,v[1]=o.y,y[0]=M,y[1]=o.y+o.height):(v[0]=o.x,v[1]=M,y[0]=o.x+o.width,y[1]=M);var C=d++%l.length,L=m[E].tickValue,k=new Gf({anid:L!=null?"line_"+m[E].tickValue:null,autoBatch:!0,shape:{x1:v[0],y1:v[1],x2:y[0],y2:y[1]},style:ti({stroke:l[C]},S),silent:!0});cT(k.shape,S.lineWidth),e.add(k)}}},minorSplitLine:function(n,e,t,r){var i=t.axis,s=t.getModel("minorSplitLine"),a=s.getModel("lineStyle"),l=r.coordinateSystem.getRect(),o=i.isHorizontal(),h=i.getMinorTicksCoords();if(h.length)for(var d=[],m=[],v=a.getLineStyle(),y=0;y<h.length;y++)for(var S=0;S<h[y].length;S++){var E=i.toGlobalCoord(h[y][S].coord);o?(d[0]=E,d[1]=l.y,m[0]=E,m[1]=l.y+l.height):(d[0]=l.x,d[1]=E,m[0]=l.x+l.width,m[1]=E);var M=new Gf({anid:"minor_line_"+h[y][S].tickValue,autoBatch:!0,shape:{x1:d[0],y1:d[1],x2:m[0],y2:m[1]},style:v,silent:!0});cT(M.shape,v.lineWidth),e.add(M)}},splitArea:function(n,e,t,r){i4e(n,e,t,r)}},Rae=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="xAxis",e}(Iae),c4e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=Rae.type,t}return e.type="yAxis",e}(Iae),u4e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="grid",t}return e.prototype.render=function(t,r){this.group.removeAll(),t.get("show")&&this.group.add(new Ho({shape:t.coordinateSystem.getRect(),style:ti({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(Pc),$Z={offset:0};function h4e(n){n.registerComponentView(u4e),n.registerComponentModel(B3e),n.registerCoordinateSystem("cartesian2d",j3e),JP(n,"x",NN,$Z),JP(n,"y",NN,$Z),n.registerComponentView(Rae),n.registerComponentView(c4e),n.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}var qZ="\0_ec_interaction_mutex";function f4e(n,e,t){var r=Pae(n);r[e]=t}function d4e(n,e,t){var r=Pae(n),i=r[e];i===t&&(r[e]=null)}function Pae(n){return n[qZ]||(n[qZ]={})}xp({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Ec);var p4e={axisPointer:1,tooltip:1,brush:1};function m4e(n,e,t){var r=e.getComponentByElement(n.topTarget),i=r&&r.coordinateSystem;return r&&r!==t&&!p4e.hasOwnProperty(r.mainType)&&i&&i.model!==t}function Lae(n,e,t,r,i,s){n=n||0;var a=t[1]-t[0];if(i!=null&&(i=zx(i,[0,a])),s!=null&&(s=Math.max(s,i??0)),r==="all"){var l=Math.abs(e[1]-e[0]);l=zx(l,[0,a]),i=s=zx(l,[i,s]),r=0}e[0]=zx(e[0],t),e[1]=zx(e[1],t);var o=Ik(e,r);e[r]+=n;var h=i||0,d=t.slice();o.sign<0?d[0]+=h:d[1]-=h,e[r]=zx(e[r],d);var m;return m=Ik(e,r),i!=null&&(m.sign!==o.sign||m.span<i)&&(e[1-r]=e[r]+o.sign*i),m=Ik(e,r),s!=null&&m.span>s&&(e[1-r]=e[r]+m.sign*s),e}function Ik(n,e){var t=n[e]-n[1-e];return{span:Math.abs(t),sign:t>0?-1:t<0?1:e?-1:1}}function zx(n,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,n))}var a1=!0,yT=Math.min,lw=Math.max,g4e=Math.pow,v4e=1e4,_4e=6,y4e=6,ZZ="globalPan",x4e={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},b4e={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},YZ={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},w4e=0,S4e=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r._track=[],r._covers=[],r._handlers={},r._zr=t,r.group=new ma,r._uid="brushController_"+w4e++,it(R4e,function(i,s){this._handlers[s]=zs(i,this)},r),r}return e.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},e.prototype._doEnableBrush=function(t){var r=this._zr;this._enableGlobalPan||f4e(r,ZZ,this._uid),it(this._handlers,function(i,s){r.on(s,i)}),this._brushType=t.brushType,this._brushOption=Di(_i(YZ),t,!0)},e.prototype._doDisableBrush=function(){var t=this._zr;d4e(t,ZZ,this._uid),it(this._handlers,function(r,i){t.off(i,r)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(t){if(t&&t.length){var r=this._panels={};it(t,function(i){r[i.panelId]=_i(i)})}else this._panels=null;return this},e.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var r=this.group;return this._zr.add(r),r.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=r.getLocalTransform(),this},e.prototype.updateCovers=function(t){t=xr(t,function(v){return Di(_i(YZ),v,!0)});var r="\0-brush-index-",i=this._covers,s=this._covers=[],a=this,l=this._creatingCover;return new gT(i,t,h,o).add(d).update(d).remove(m).execute(),this;function o(v,y){return(v.id!=null?v.id:r+y)+"-"+v.brushType}function h(v,y){return o(v.__brushOption,y)}function d(v,y){var S=t[v];if(y!=null&&i[y]===l)s[v]=i[y];else{var E=s[v]=y!=null?(i[y].__brushOption=S,i[y]):Bae(a,Dae(a,S));T8(a,E)}}function m(v){i[v]!==l&&a.group.remove(i[v])}},e.prototype.unmount=function(){return this.enableBrush(!1),HN(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(od);function Dae(n,e){var t=o3[e.brushType].createCover(n,e);return t.__brushOption=e,Oae(t,e),n.group.add(t),t}function Bae(n,e){var t=M8(e);return t.endCreating&&(t.endCreating(n,e),Oae(e,e.__brushOption)),e}function kae(n,e){var t=e.__brushOption;M8(e).updateCoverShape(n,e,t.range,t)}function Oae(n,e){var t=e.z;t==null&&(t=v4e),n.traverse(function(r){r.z=t,r.z2=t})}function T8(n,e){M8(e).updateCommon(n,e),kae(n,e)}function M8(n){return o3[n.__brushOption.brushType]}function C8(n,e,t){var r=n._panels;if(!r)return a1;var i,s=n._transform;return it(r,function(a){a.isTargetByCursor(e,t,s)&&(i=a)}),i}function Fae(n,e){var t=n._panels;if(!t)return a1;var r=e.__brushOption.panelId;return r!=null?t[r]:a1}function HN(n){var e=n._covers,t=e.length;return it(e,function(r){n.group.remove(r)},n),e.length=0,!!t}function l1(n,e){var t=xr(n._covers,function(r){var i=r.__brushOption,s=_i(i.range);return{brushType:i.brushType,panelId:i.panelId,range:s}});n.trigger("brush",{areas:t,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function A4e(n){var e=n._track;if(!e.length)return!1;var t=e[e.length-1],r=e[0],i=t[0]-r[0],s=t[1]-r[1],a=g4e(i*i+s*s,.5);return a>_4e}function Nae(n){var e=n.length-1;return e<0&&(e=0),[n[0],n[e]]}function zae(n,e,t,r){var i=new ma;return i.add(new Ho({name:"main",style:E8(t),silent:!0,draggable:!0,cursor:"move",drift:vs(KZ,n,e,i,["n","s","w","e"]),ondragend:vs(l1,e,{isEnd:!0})})),it(r,function(s){i.add(new Ho({name:s.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:vs(KZ,n,e,i,s),ondragend:vs(l1,e,{isEnd:!0})}))}),i}function Uae(n,e,t,r){var i=r.brushStyle.lineWidth||0,s=lw(i,y4e),a=t[0][0],l=t[1][0],o=a-i/2,h=l-i/2,d=t[0][1],m=t[1][1],v=d-s+i/2,y=m-s+i/2,S=d-a,E=m-l,M=S+i,C=E+i;gm(n,e,"main",a,l,S,E),r.transformable&&(gm(n,e,"w",o,h,s,C),gm(n,e,"e",v,h,s,C),gm(n,e,"n",o,h,M,s),gm(n,e,"s",o,y,M,s),gm(n,e,"nw",o,h,s,s),gm(n,e,"ne",v,h,s,s),gm(n,e,"sw",o,y,s,s),gm(n,e,"se",v,y,s,s))}function jN(n,e){var t=e.__brushOption,r=t.transformable,i=e.childAt(0);i.useStyle(E8(t)),i.attr({silent:!r,cursor:r?"move":"default"}),it([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(s){var a=e.childOfName(s.join("")),l=s.length===1?WN(n,s[0]):M4e(n,s);a&&a.attr({silent:!r,invisible:!r,cursor:r?b4e[l]+"-resize":null})})}function gm(n,e,t,r,i,s,a){var l=e.childOfName(t);l&&l.setShape(E4e(I8(n,e,[[r,i],[r+s,i+a]])))}function E8(n){return ti({strokeNoScale:!0},n.brushStyle)}function Gae(n,e,t,r){var i=[yT(n,t),yT(e,r)],s=[lw(n,t),lw(e,r)];return[[i[0],s[0]],[i[1],s[1]]]}function T4e(n){return jU(n.group)}function WN(n,e){var t={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},i=rse(t[e],T4e(n));return r[i]}function M4e(n,e){var t=[WN(n,e[0]),WN(n,e[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function KZ(n,e,t,r,i,s){var a=t.__brushOption,l=n.toRectRange(a.range),o=Vae(e,i,s);it(r,function(h){var d=x4e[h];l[d[0]][d[1]]+=o[d[0]]}),a.range=n.fromRectRange(Gae(l[0][0],l[1][0],l[0][1],l[1][1])),T8(e,t),l1(e,{isEnd:!1})}function C4e(n,e,t,r){var i=e.__brushOption.range,s=Vae(n,t,r);it(i,function(a){a[0]+=s[0],a[1]+=s[1]}),T8(n,e),l1(n,{isEnd:!1})}function Vae(n,e,t){var r=n.group,i=r.transformCoordToLocal(e,t),s=r.transformCoordToLocal(0,0);return[i[0]-s[0],i[1]-s[1]]}function I8(n,e,t){var r=Fae(n,e);return r&&r!==a1?r.clipPath(t,n._transform):_i(t)}function E4e(n){var e=yT(n[0][0],n[1][0]),t=yT(n[0][1],n[1][1]),r=lw(n[0][0],n[1][0]),i=lw(n[0][1],n[1][1]);return{x:e,y:t,width:r-e,height:i-t}}function I4e(n,e,t){if(!(!n._brushType||P4e(n,e.offsetX,e.offsetY))){var r=n._zr,i=n._covers,s=C8(n,e,t);if(!n._dragging)for(var a=0;a<i.length;a++){var l=i[a].__brushOption;if(s&&(s===a1||l.panelId===s.panelId)&&o3[l.brushType].contain(i[a],t[0],t[1]))return}s&&r.setCursorStyle("crosshair")}}function XN(n){var e=n.event;e.preventDefault&&e.preventDefault()}function $N(n,e,t){return n.childOfName("main").contain(e,t)}function Hae(n,e,t,r){var i=n._creatingCover,s=n._creatingPanel,a=n._brushOption,l;if(n._track.push(t.slice()),A4e(n)||i){if(s&&!i){a.brushMode==="single"&&HN(n);var o=_i(a);o.brushType=JZ(o.brushType,s),o.panelId=s===a1?null:s.panelId,i=n._creatingCover=Dae(n,o),n._covers.push(i)}if(i){var h=o3[JZ(n._brushType,s)],d=i.__brushOption;d.range=h.getCreatingRange(I8(n,i,n._track)),r&&(Bae(n,i),h.updateCommon(n,i)),kae(n,i),l={isEnd:r}}}else r&&a.brushMode==="single"&&a.removeOnClick&&C8(n,e,t)&&HN(n)&&(l={isEnd:r,removeOnClick:!0});return l}function JZ(n,e){return n==="auto"?e.defaultBrushType:n}var R4e={mousedown:function(n){if(this._dragging)QZ(this,n);else if(!n.target||!n.target.draggable){XN(n);var e=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var t=this._creatingPanel=C8(this,n,e);t&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(n){var e=n.offsetX,t=n.offsetY,r=this.group.transformCoordToLocal(e,t);if(I4e(this,n,r),this._dragging){XN(n);var i=Hae(this,n,r,!1);i&&l1(this,i)}},mouseup:function(n){QZ(this,n)}};function QZ(n,e){if(n._dragging){XN(e);var t=e.offsetX,r=e.offsetY,i=n.group.transformCoordToLocal(t,r),s=Hae(n,e,i,!0);n._dragging=!1,n._track=[],n._creatingCover=null,s&&l1(n,s)}}function P4e(n,e,t){var r=n._zr;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var o3={lineX:eY(0),lineY:eY(1),rect:{createCover:function(n,e){function t(r){return r}return zae({toRectRange:t,fromRectRange:t},n,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var e=Nae(n);return Gae(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(n,e,t,r){Uae(n,e,t,r)},updateCommon:jN,contain:$N},polygon:{createCover:function(n,e){var t=new ma;return t.add(new Cw({name:"main",style:E8(e),silent:!0})),t},getCreatingRange:function(n){return n},endCreating:function(n,e){e.remove(e.childAt(0)),e.add(new zD({name:"main",draggable:!0,drift:vs(C4e,n,e),ondragend:vs(l1,n,{isEnd:!0})}))},updateCoverShape:function(n,e,t,r){e.childAt(0).setShape({points:I8(n,e,t)})},updateCommon:jN,contain:$N}};function eY(n){return{createCover:function(e,t){return zae({toRectRange:function(r){var i=[r,[0,100]];return n&&i.reverse(),i},fromRectRange:function(r){return r[n]}},e,t,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(e){var t=Nae(e),r=yT(t[0][n],t[1][n]),i=lw(t[0][n],t[1][n]);return[r,i]},updateCoverShape:function(e,t,r,i){var s,a=Fae(e,t);if(a!==a1&&a.getLinearBrushOtherExtent)s=a.getLinearBrushOtherExtent(n);else{var l=e._zr;s=[0,[l.getWidth(),l.getHeight()][1-n]]}var o=[r,s];n&&o.reverse(),Uae(e,t,o,i)},updateCommon:jN,contain:$N}}function L4e(n){return n=R8(n),function(e){return ise(e,n)}}function D4e(n,e){return n=R8(n),function(t){var r=e??t,i=r?n.width:n.height,s=r?n.x:n.y;return[s,s+(i||0)]}}function B4e(n,e,t){var r=R8(n);return function(i,s){return r.contain(s[0],s[1])&&!m4e(i,e,t)}}function R8(n){return cs.create(n)}var py=$s(),tY=_i,Rk=zs,jae=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(e,t,r,i){var s=t.get("value"),a=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=r,!(!i&&this._lastValue===s&&this._lastStatus===a)){this._lastValue=s,this._lastStatus=a;var l=this._group,o=this._handle;if(!a||a==="hide"){l&&l.hide(),o&&o.hide();return}l&&l.show(),o&&o.show();var h={};this.makeElOption(h,s,e,t,r);var d=h.graphicKey;d!==this._lastGraphicKey&&this.clear(r),this._lastGraphicKey=d;var m=this._moveAnimation=this.determineAnimation(e,t);if(!l)l=this._group=new ma,this.createPointerEl(l,h,e,t),this.createLabelEl(l,h,e,t),r.getZr().add(l);else{var v=vs(nY,t,m);this.updatePointerEl(l,h,v),this.updateLabelEl(l,h,v,t)}iY(l,t,!0),this._renderHandle(s)}},n.prototype.remove=function(e){this.clear(e)},n.prototype.dispose=function(e){this.clear(e)},n.prototype.determineAnimation=function(e,t){var r=t.get("animation"),i=e.axis,s=i.type==="category",a=t.get("snap");if(!a&&!s)return!1;if(r==="auto"||r==null){var l=this.animationThreshold;if(s&&i.getBandWidth()>l)return!0;if(a){var o=A8(e).seriesDataCount,h=i.getExtent();return Math.abs(h[0]-h[1])/o>l}return!1}return r===!0},n.prototype.makeElOption=function(e,t,r,i,s){},n.prototype.createPointerEl=function(e,t,r,i){var s=t.pointer;if(s){var a=py(e).pointerEl=new XU[s.type](tY(t.pointer));e.add(a)}},n.prototype.createLabelEl=function(e,t,r,i){if(t.label){var s=py(e).labelEl=new Ea(tY(t.label));e.add(s),rY(s,i)}},n.prototype.updatePointerEl=function(e,t,r){var i=py(e).pointerEl;i&&t.pointer&&(i.setStyle(t.pointer.style),r(i,{shape:t.pointer.shape}))},n.prototype.updateLabelEl=function(e,t,r,i){var s=py(e).labelEl;s&&(s.setStyle(t.label.style),r(s,{x:t.label.x,y:t.label.y}),rY(s,i))},n.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var t=this._axisPointerModel,r=this._api.getZr(),i=this._handle,s=t.getModel("handle"),a=t.get("status");if(!s.get("show")||!a||a==="hide"){i&&r.remove(i),this._handle=null;return}var l;this._handle||(l=!0,i=this._handle=HD(s.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(h){zre(h.event)},onmousedown:Rk(this._onHandleDragMove,this,0,0),drift:Rk(this._onHandleDragMove,this),ondragend:Rk(this._onHandleDragEnd,this)}),r.add(i)),iY(i,t,!1),i.setStyle(s.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var o=s.get("size");fr(o)||(o=[o,o]),i.scaleX=o[0]/2,i.scaleY=o[1]/2,eoe(this,"_doDispatchAxisPointer",s.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,l)}},n.prototype._moveHandleToValue=function(e,t){nY(this._axisPointerModel,!t&&this._moveAnimation,this._handle,Pk(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(e,t){var r=this._handle;if(r){this._dragging=!0;var i=this.updateHandleTransform(Pk(r),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=i,r.stopAnimation(),r.attr(Pk(i)),py(r).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var t=this._payloadInfo,r=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:r.axis.dim,axisIndex:r.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),r=this._group,i=this._handle;t&&r&&(this._lastGraphicKey=null,r&&t.remove(r),i&&t.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),TN(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}},n}();function nY(n,e,t,r){Wae(py(t).lastProp,r)||(py(t).lastProp=r,e?ol(t,r,n):(t.stopAnimation(),t.attr(r)))}function Wae(n,e){if(Xr(n)&&Xr(e)){var t=!0;return it(e,function(r,i){t=t&&Wae(n[i],r)}),!!t}else return n===e}function rY(n,e){n[e.get(["label","show"])?"show":"hide"]()}function Pk(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function iY(n,e,t){var r=e.get("z"),i=e.get("zlevel");n&&n.traverse(function(s){s.type!=="group"&&(r!=null&&(s.z=r),i!=null&&(s.zlevel=i),s.silent=t)})}function Xae(n){var e=n.get("type"),t=n.getModel(e+"Style"),r;return e==="line"?(r=t.getLineStyle(),r.fill=null):e==="shadow"&&(r=t.getAreaStyle(),r.stroke=null),r}function $ae(n,e,t,r,i){var s=t.get("value"),a=qae(s,e.axis,e.ecModel,t.get("seriesDataIndices"),{precision:t.get(["label","precision"]),formatter:t.get(["label","formatter"])}),l=t.getModel("label"),o=JD(l.get("padding")||0),h=l.getFont(),d=oM(a,h),m=i.position,v=d.width+o[1]+o[3],y=d.height+o[0]+o[2],S=i.align;S==="right"&&(m[0]-=v),S==="center"&&(m[0]-=v/2);var E=i.verticalAlign;E==="bottom"&&(m[1]-=y),E==="middle"&&(m[1]-=y/2),k4e(m,v,y,r);var M=l.get("backgroundColor");(!M||M==="auto")&&(M=e.get(["axisLine","lineStyle","color"])),n.label={x:m[0],y:m[1],style:Qm(l,{text:a,font:h,fill:l.getTextColor(),padding:o,backgroundColor:M}),z2:10}}function k4e(n,e,t,r){var i=r.getWidth(),s=r.getHeight();n[0]=Math.min(n[0]+e,i)-e,n[1]=Math.min(n[1]+t,s)-t,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function qae(n,e,t,r,i){n=e.scale.parse(n);var s=e.scale.getLabel({value:n},{precision:i.precision}),a=i.formatter;if(a){var l={value:_8(e,{value:n}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};it(r,function(o){var h=t.getSeriesByIndex(o.seriesIndex),d=o.dataIndexInside,m=h&&h.getDataParams(d);m&&l.seriesData.push(m)}),Dr(a)?s=a.replace("{value}",s):ci(a)&&(s=a(l))}return s}function Zae(n,e,t){var r=Ny();return ED(r,r,t.rotation),AP(r,r,t.position),VD([n.dataToCoord(e),(t.labelOffset||0)+(t.labelDirection||1)*(t.labelMargin||0)],r)}function O4e(n,e,t,r,i,s){var a=Rh.innerTextLayout(t.rotation,0,t.labelDirection);t.labelMargin=i.get(["label","margin"]),$ae(e,r,i,s,{position:Zae(r.axis,n,t),align:a.textAlign,verticalAlign:a.textVerticalAlign})}function Yae(n,e,t){return t=t||0,{x1:n[t],y1:n[1-t],x2:e[t],y2:e[1-t]}}function F4e(n,e,t){return t=t||0,{x:n[t],y:n[1-t],width:e[t],height:e[1-t]}}function sY(n,e,t,r,i,s){return{cx:n,cy:e,r0:t,r,startAngle:i,endAngle:s,clockwise:!0}}var N4e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,s,a){var l=i.axis,o=l.grid,h=s.get("type"),d=oY(o,l).getOtherAxis(l).getGlobalExtent(),m=l.toGlobalCoord(l.dataToCoord(r,!0));if(h&&h!=="none"){var v=Xae(s),y=z4e[h](l,m,d);y.style=v,t.graphicKey=y.type,t.pointer=y}var S=UN(o.model,i);O4e(r,t,S,i,s,a)},e.prototype.getHandleTransform=function(t,r,i){var s=UN(r.axis.grid.model,r,{labelInside:!1});s.labelMargin=i.get(["handle","margin"]);var a=Zae(r.axis,t,s);return{x:a[0],y:a[1],rotation:s.rotation+(s.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,r,i,s){var a=i.axis,l=a.grid,o=a.getGlobalExtent(!0),h=oY(l,a).getOtherAxis(a).getGlobalExtent(),d=a.dim==="x"?0:1,m=[t.x,t.y];m[d]+=r[d],m[d]=Math.min(o[1],m[d]),m[d]=Math.max(o[0],m[d]);var v=(h[1]+h[0])/2,y=[v,v];y[d]=m[d];var S=[{verticalAlign:"middle"},{align:"center"}];return{x:m[0],y:m[1],rotation:t.rotation,cursorPoint:y,tooltipOption:S[d]}},e}(jae);function oY(n,e){var t={};return t[e.dim+"AxisIndex"]=e.index,n.getCartesian(t)}var z4e={line:function(n,e,t){var r=Yae([e,t[0]],[e,t[1]],aY(n));return{type:"Line",subPixelOptimize:!0,shape:r}},shadow:function(n,e,t){var r=Math.max(1,n.getBandWidth()),i=t[1]-t[0];return{type:"Rect",shape:F4e([e-r/2,t[0]],[r,i],aY(n))}}};function aY(n){return n.dim==="x"?0:1}var U4e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}(os),Dm=$s(),G4e=it;function Kae(n,e,t){if(!mi.node){var r=e.getZr();Dm(r).records||(Dm(r).records={}),V4e(r,e);var i=Dm(r).records[n]||(Dm(r).records[n]={});i.handler=t}}function V4e(n,e){if(Dm(n).initialized)return;Dm(n).initialized=!0,t("click",vs(lY,"click")),t("mousemove",vs(lY,"mousemove")),t("globalout",j4e);function t(r,i){n.on(r,function(s){var a=W4e(e);G4e(Dm(n).records,function(l){l&&i(l,s,a.dispatchAction)}),H4e(a.pendings,e)})}}function H4e(n,e){var t=n.showTip.length,r=n.hideTip.length,i;t?i=n.showTip[t-1]:r&&(i=n.hideTip[r-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}function j4e(n,e,t){n.handler("leave",null,t)}function lY(n,e,t,r){e.handler(n,t,r)}function W4e(n){var e={showTip:[],hideTip:[]},t=function(r){var i=e[r.type];i?i.push(r):(r.dispatchAction=t,n.dispatchAction(r))};return{dispatchAction:t,pendings:e}}function qN(n,e){if(!mi.node){var t=e.getZr(),r=(Dm(t).records||{})[n];r&&(Dm(t).records[n]=null)}}var X4e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){var s=r.getComponent("tooltip"),a=t.get("triggerOn")||s&&s.get("triggerOn")||"mousemove|click";Kae("axisPointer",i,function(l,o,h){a!=="none"&&(l==="leave"||a.indexOf(l)>=0)&&h({type:"updateAxisPointer",currTrigger:l,x:o&&o.offsetX,y:o&&o.offsetY})})},e.prototype.remove=function(t,r){qN("axisPointer",r)},e.prototype.dispose=function(t,r){qN("axisPointer",r)},e.type="axisPointer",e}(Pc);function Jae(n,e){var t=[],r=n.seriesIndex,i;if(r==null||!(i=e.getSeriesByIndex(r)))return{point:[]};var s=i.getData(),a=i1(s,n);if(a==null||a<0||fr(a))return{point:[]};var l=s.getItemGraphicEl(a),o=i.coordinateSystem;if(i.getTooltipPosition)t=i.getTooltipPosition(a)||[];else if(o&&o.dataToPoint)if(n.isStacked){var h=o.getBaseAxis(),d=o.getOtherAxis(h),m=d.dim,v=h.dim,y=m==="x"||m==="radius"?1:0,S=s.mapDimension(v),E=[];E[y]=s.get(S,a),E[1-y]=s.get(s.getCalculationInfo("stackResultDimension"),a),t=o.dataToPoint(E)||[]}else t=o.dataToPoint(s.getValues(xr(o.dimensions,function(C){return s.mapDimension(C)}),a))||[];else if(l){var M=l.getBoundingRect().clone();M.applyTransform(l.transform),t=[M.x+M.width/2,M.y+M.height/2]}return{point:t,el:l}}var cY=$s();function $4e(n,e,t){var r=n.currTrigger,i=[n.x,n.y],s=n,a=n.dispatchAction||zs(t.dispatchAction,t),l=e.getComponent("axisPointer").coordSysAxesInfo;if(l){aR(i)&&(i=Jae({seriesIndex:s.seriesIndex,dataIndex:s.dataIndex},e).point);var o=aR(i),h=s.axesInfo,d=l.axesInfo,m=r==="leave"||aR(i),v={},y={},S={list:[],map:{}},E={showPointer:vs(Z4e,y),showTooltip:vs(Y4e,S)};it(l.coordSysMap,function(C,L){var k=o||C.containPoint(i);it(l.coordSysAxesInfo[L],function(H,q){var Z=H.axis,ee=e5e(h,H);if(!m&&k&&(!h||ee)){var re=ee&&ee.value;re==null&&!o&&(re=Z.pointToData(i)),re!=null&&uY(H,re,E,!1,v)}})});var M={};return it(d,function(C,L){var k=C.linkGroup;k&&!y[L]&&it(k.axesInfo,function(H,q){var Z=y[q];if(H!==C&&Z){var ee=Z.value;k.mapper&&(ee=C.axis.scale.parse(k.mapper(ee,hY(H),hY(C)))),M[C.key]=ee}})}),it(M,function(C,L){uY(d[L],C,E,!0,v)}),K4e(y,d,v),J4e(S,i,n,a),Q4e(d,a,t),v}}function uY(n,e,t,r,i){var s=n.axis;if(!(s.scale.isBlank()||!s.containData(e))){if(!n.involveSeries){t.showPointer(n,e);return}var a=q4e(e,n),l=a.payloadBatch,o=a.snapToValue;l[0]&&i.seriesIndex==null&&Jn(i,l[0]),!r&&n.snap&&s.containData(o)&&o!=null&&(e=o),t.showPointer(n,e,l),t.showTooltip(n,a,o)}}function q4e(n,e){var t=e.axis,r=t.dim,i=n,s=[],a=Number.MAX_VALUE,l=-1;return it(e.seriesModels,function(o,h){var d=o.getData().mapDimensionsAll(r),m,v;if(o.getAxisTooltipData){var y=o.getAxisTooltipData(d,n,t);v=y.dataIndices,m=y.nestestValue}else{if(v=o.getData().indicesOfNearest(d[0],n,t.type==="category"?.5:null),!v.length)return;m=o.getData().get(d[0],v[0])}if(!(m==null||!isFinite(m))){var S=n-m,E=Math.abs(S);E<=a&&((E<a||S>=0&&l<0)&&(a=E,l=S,i=m,s.length=0),it(v,function(M){s.push({seriesIndex:o.seriesIndex,dataIndexInside:M,dataIndex:o.getData().getRawIndex(M)})}))}}),{payloadBatch:s,snapToValue:i}}function Z4e(n,e,t,r){n[e.key]={value:t,payloadBatch:r}}function Y4e(n,e,t,r){var i=t.payloadBatch,s=e.axis,a=s.model,l=e.axisPointerModel;if(!(!e.triggerTooltip||!i.length)){var o=e.coordSys.model,h=_T(o),d=n.map[h];d||(d=n.map[h]={coordSysId:o.id,coordSysIndex:o.componentIndex,coordSysType:o.type,coordSysMainType:o.mainType,dataByAxis:[]},n.list.push(d)),d.dataByAxis.push({axisDim:s.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:r,valueLabelOpt:{precision:l.get(["label","precision"]),formatter:l.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function K4e(n,e,t){var r=t.axesInfo=[];it(e,function(i,s){var a=i.axisPointerModel.option,l=n[s];l?(!i.useHandle&&(a.status="show"),a.value=l.value,a.seriesDataIndices=(l.payloadBatch||[]).slice()):!i.useHandle&&(a.status="hide"),a.status==="show"&&r.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:a.value})})}function J4e(n,e,t,r){if(aR(e)||!n.list.length){r({type:"hideTip"});return}var i=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:t.tooltipOption,position:t.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:n.list})}function Q4e(n,e,t){var r=t.getZr(),i="axisPointerLastHighlights",s=cY(r)[i]||{},a=cY(r)[i]={};it(n,function(h,d){var m=h.axisPointerModel.option;m.status==="show"&&h.triggerEmphasis&&it(m.seriesDataIndices,function(v){var y=v.seriesIndex+" | "+v.dataIndex;a[y]=v})});var l=[],o=[];it(s,function(h,d){!a[d]&&o.push(h)}),it(a,function(h,d){!s[d]&&l.push(h)}),o.length&&t.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:o}),l.length&&t.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:l})}function e5e(n,e){for(var t=0;t<(n||[]).length;t++){var r=n[t];if(e.axis.dim===r.axisDim&&e.axis.model.componentIndex===r.axisIndex)return r}}function hY(n){var e=n.axis.model,t={},r=t.axisDim=n.axis.dim;return t.axisIndex=t[r+"AxisIndex"]=e.componentIndex,t.axisName=t[r+"AxisName"]=e.name,t.axisId=t[r+"AxisId"]=e.id,t}function aR(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function P8(n){fM.registerAxisPointerClass("CartesianAxisPointer",N4e),n.registerComponentModel(U4e),n.registerComponentView(X4e),n.registerPreprocessor(function(e){if(e){(!e.axisPointer||e.axisPointer.length===0)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!fr(t)&&(e.axisPointer.link=[t])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=K3e(e,t)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},$4e)}function t5e(n){mp(h4e),mp(P8)}var n5e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,s,a){var l=i.axis;l.dim==="angle"&&(this.animationThreshold=Math.PI/18);var o=l.polar,h=o.getOtherAxis(l),d=h.getExtent(),m=l.dataToCoord(r),v=s.get("type");if(v&&v!=="none"){var y=Xae(s),S=i5e[v](l,o,m,d);S.style=y,t.graphicKey=S.type,t.pointer=S}var E=s.get(["label","margin"]),M=r5e(r,i,s,o,E);$ae(t,i,s,a,M)},e}(jae);function r5e(n,e,t,r,i){var s=e.axis,a=s.dataToCoord(n),l=r.getAngleAxis().getExtent()[0];l=l/180*Math.PI;var o=r.getRadiusAxis().getExtent(),h,d,m;if(s.dim==="radius"){var v=Ny();ED(v,v,l),AP(v,v,[r.cx,r.cy]),h=VD([a,-i],v);var y=e.getModel("axisLabel").get("rotate")||0,S=Rh.innerTextLayout(l,y*Math.PI/180,-1);d=S.textAlign,m=S.textVerticalAlign}else{var E=o[1];h=r.coordToPoint([E+i,a]);var M=r.cx,C=r.cy;d=Math.abs(h[0]-M)/E<.3?"center":h[0]>M?"left":"right",m=Math.abs(h[1]-C)/E<.3?"middle":h[1]>C?"top":"bottom"}return{position:h,align:d,verticalAlign:m}}var i5e={line:function(n,e,t,r){return n.dim==="angle"?{type:"Line",shape:Yae(e.coordToPoint([r[0],t]),e.coordToPoint([r[1],t]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:t}}},shadow:function(n,e,t,r){var i=Math.max(1,n.getBandWidth()),s=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:sY(e.cx,e.cy,r[0],r[1],(-t-i/2)*s,(-t+i/2)*s)}:{type:"Sector",shape:sY(e.cx,e.cy,t-i/2,t+i/2,0,Math.PI*2)}}},s5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.findAxisModel=function(t){var r,i=this.ecModel;return i.eachComponent(t,function(s){s.getCoordSysModel()===this&&(r=s)},this),r},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={z:0,center:["50%","50%"],radius:"80%"},e}(os),L8=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",xl).models[0]},e.type="polarAxis",e}(os);sd(L8,Koe);var o5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="angleAxis",e}(L8),a5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="radiusAxis",e}(L8),D8=function(n){Hn(e,n);function e(t,r){return n.call(this,"radius",t,r)||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e}(A1);D8.prototype.dataToRadius=A1.prototype.dataToCoord;D8.prototype.radiusToData=A1.prototype.coordToData;var l5e=$s(),B8=function(n){Hn(e,n);function e(t,r){return n.call(this,"angle",t,r||[0,360])||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e.prototype.calculateCategoryInterval=function(){var t=this,r=t.getLabelModel(),i=t.scale,s=i.getExtent(),a=i.count();if(s[1]-s[0]<1)return 0;var l=s[0],o=t.dataToCoord(l+1)-t.dataToCoord(l),h=Math.abs(o),d=oM(l==null?"":l+"",r.getFont(),"center","top"),m=Math.max(d.height,7),v=m/h;isNaN(v)&&(v=1/0);var y=Math.max(0,Math.floor(v)),S=l5e(t.model),E=S.lastAutoInterval,M=S.lastTickCount;return E!=null&&M!=null&&Math.abs(E-y)<=1&&Math.abs(M-a)<=1&&E>y?y=E:(S.lastTickCount=a,S.lastAutoInterval=y),y},e}(A1);B8.prototype.dataToAngle=A1.prototype.dataToCoord;B8.prototype.angleToData=A1.prototype.coordToData;var Qae=["radius","angle"],c5e=function(){function n(e){this.dimensions=Qae,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new D8,this._angleAxis=new B8,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},n.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},n.prototype.getAxis=function(e){var t="_"+e+"Axis";return this[t]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(e){var t=[],r=this._angleAxis,i=this._radiusAxis;return r.scale.type===e&&t.push(r),i.scale.type===e&&t.push(i),t},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(e){var t=e!=null&&e!=="auto"?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},n.prototype.dataToPoint=function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},n.prototype.pointToData=function(e,t){var r=this.pointToCoord(e);return[this._radiusAxis.radiusToData(r[0],t),this._angleAxis.angleToData(r[1],t)]},n.prototype.pointToCoord=function(e){var t=e[0]-this.cx,r=e[1]-this.cy,i=this.getAngleAxis(),s=i.getExtent(),a=Math.min(s[0],s[1]),l=Math.max(s[0],s[1]);i.inverse?a=l-360:l=a+360;var o=Math.sqrt(t*t+r*r);t/=o,r/=o;for(var h=Math.atan2(-r,t)/Math.PI*180,d=h<a?1:-1;h<a||h>l;)h+=d*360;return[o,h]},n.prototype.coordToPoint=function(e){var t=e[0],r=e[1]/180*Math.PI,i=Math.cos(r)*t+this.cx,s=-Math.sin(r)*t+this.cy;return[i,s]},n.prototype.getArea=function(){var e=this.getAngleAxis(),t=this.getRadiusAxis(),r=t.getExtent().slice();r[0]>r[1]&&r.reverse();var i=e.getExtent(),s=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:r[0],r:r[1],startAngle:-i[0]*s,endAngle:-i[1]*s,clockwise:e.inverse,contain:function(a,l){var o=a-this.cx,h=l-this.cy,d=o*o+h*h-1e-4,m=this.r,v=this.r0;return d<=m*m&&d>=v*v}}},n.prototype.convertToPixel=function(e,t,r){var i=fY(t);return i===this?this.dataToPoint(r):null},n.prototype.convertFromPixel=function(e,t,r){var i=fY(t);return i===this?this.pointToData(r):null},n}();function fY(n){var e=n.seriesModel,t=n.polarModel;return t&&t.coordinateSystem||e&&e.coordinateSystem}const u5e=c5e;function h5e(n,e,t){var r=e.get("center"),i=t.getWidth(),s=t.getHeight();n.cx=ls(r[0],i),n.cy=ls(r[1],s);var a=n.getRadiusAxis(),l=Math.min(i,s)/2,o=e.get("radius");o==null?o=[0,"100%"]:fr(o)||(o=[0,o]);var h=[ls(o[0],l),ls(o[1],l)];a.inverse?a.setExtent(h[1],h[0]):a.setExtent(h[0],h[1])}function f5e(n,e){var t=this,r=t.getAngleAxis(),i=t.getRadiusAxis();if(r.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),n.eachSeries(function(l){if(l.coordinateSystem===t){var o=l.getData();it(ZP(o,"radius"),function(h){i.scale.unionExtentFromData(o,h)}),it(ZP(o,"angle"),function(h){r.scale.unionExtentFromData(o,h)})}}),qP(r.scale,r.model),qP(i.scale,i.model),r.type==="category"&&!r.onBand){var s=r.getExtent(),a=360/r.scale.count();r.inverse?s[1]+=a:s[1]-=a,r.setExtent(s[0],s[1])}}function d5e(n){return n.mainType==="angleAxis"}function dY(n,e){var t;if(n.type=e.get("type"),n.scale=Zoe(e),n.onBand=e.get("boundaryGap")&&n.type==="category",n.inverse=e.get("inverse"),d5e(e)){n.inverse=n.inverse!==e.get("clockwise");var r=e.get("startAngle"),i=(t=e.get("endAngle"))!==null&&t!==void 0?t:r+(n.inverse?-360:360);n.setExtent(r,i)}e.axis=n,n.model=e}var p5e={dimensions:Qae,create:function(n,e){var t=[];return n.eachComponent("polar",function(r,i){var s=new u5e(i+"");s.update=f5e;var a=s.getRadiusAxis(),l=s.getAngleAxis(),o=r.findAxisModel("radiusAxis"),h=r.findAxisModel("angleAxis");dY(a,o),dY(l,h),h5e(s,r,e),t.push(s),r.coordinateSystem=s,s.model=r}),n.eachSeries(function(r){if(r.get("coordinateSystem")==="polar"){var i=r.getReferringComponents("polar",xl).models[0];r.coordinateSystem=i.coordinateSystem}}),t}},m5e=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function dI(n,e,t){e[1]>e[0]&&(e=e.slice().reverse());var r=n.coordToPoint([e[0],t]),i=n.coordToPoint([e[1],t]);return{x1:r[0],y1:r[1],x2:i[0],y2:i[1]}}function pI(n){var e=n.getRadiusAxis();return e.inverse?0:1}function pY(n){var e=n[0],t=n[n.length-1];e&&t&&Math.abs(Math.abs(e.coord-t.coord)-360)<1e-4&&n.pop()}var g5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=t.axis,s=i.polar,a=s.getRadiusAxis().getExtent(),l=i.getTicksCoords(),o=i.getMinorTicksCoords(),h=xr(i.getViewLabels(),function(d){d=_i(d);var m=i.scale,v=m.type==="ordinal"?m.getRawOrdinalNumber(d.tickValue):d.tickValue;return d.coord=i.dataToCoord(v),d});pY(h),pY(l),it(m5e,function(d){t.get([d,"show"])&&(!i.scale.isBlank()||d==="axisLine")&&v5e[d](this.group,t,s,l,o,a,h)},this)}},e.type="angleAxis",e}(fM),v5e={axisLine:function(n,e,t,r,i,s){var a=e.getModel(["axisLine","lineStyle"]),l=t.getAngleAxis(),o=Math.PI/180,h=l.getExtent(),d=pI(t),m=d?0:1,v,y=Math.abs(h[1]-h[0])===360?"Circle":"Arc";s[m]===0?v=new XU[y]({shape:{cx:t.cx,cy:t.cy,r:s[d],startAngle:-h[0]*o,endAngle:-h[1]*o,clockwise:l.inverse},style:a.getLineStyle(),z2:1,silent:!0}):v=new UU({shape:{cx:t.cx,cy:t.cy,r:s[d],r0:s[m]},style:a.getLineStyle(),z2:1,silent:!0}),v.style.fill=null,n.add(v)},axisTick:function(n,e,t,r,i,s){var a=e.getModel("axisTick"),l=(a.get("inside")?-1:1)*a.get("length"),o=s[pI(t)],h=xr(r,function(d){return new Gf({shape:dI(t,[o,o+l],d.coord)})});n.add(Mm(h,{style:ti(a.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,e,t,r,i,s){if(i.length){for(var a=e.getModel("axisTick"),l=e.getModel("minorTick"),o=(a.get("inside")?-1:1)*l.get("length"),h=s[pI(t)],d=[],m=0;m<i.length;m++)for(var v=0;v<i[m].length;v++)d.push(new Gf({shape:dI(t,[h,h+o],i[m][v].coord)}));n.add(Mm(d,{style:ti(l.getModel("lineStyle").getLineStyle(),ti(a.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,e,t,r,i,s,a){var l=e.getCategories(!0),o=e.getModel("axisLabel"),h=o.get("margin"),d=e.get("triggerEvent");it(a,function(m,v){var y=o,S=m.tickValue,E=s[pI(t)],M=t.coordToPoint([E+h,m.coord]),C=t.cx,L=t.cy,k=Math.abs(M[0]-C)/E<.3?"center":M[0]>C?"left":"right",H=Math.abs(M[1]-L)/E<.3?"middle":M[1]>L?"top":"bottom";if(l&&l[S]){var q=l[S];Xr(q)&&q.textStyle&&(y=new Ro(q.textStyle,o,o.ecModel))}var Z=new Ea({silent:Rh.isLabelSilent(e),style:Qm(y,{x:M[0],y:M[1],fill:y.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:m.formattedLabel,align:k,verticalAlign:H})});if(n.add(Z),d){var ee=Rh.makeAxisEventDataBase(e);ee.targetType="axisLabel",ee.value=m.rawLabel,Wi(Z).eventData=ee}},this)},splitLine:function(n,e,t,r,i,s){var a=e.getModel("splitLine"),l=a.getModel("lineStyle"),o=l.get("color"),h=0;o=o instanceof Array?o:[o];for(var d=[],m=0;m<r.length;m++){var v=h++%o.length;d[v]=d[v]||[],d[v].push(new Gf({shape:dI(t,s,r[m].coord)}))}for(var m=0;m<d.length;m++)n.add(Mm(d[m],{style:ti({stroke:o[m%o.length]},l.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(n,e,t,r,i,s){if(i.length){for(var a=e.getModel("minorSplitLine"),l=a.getModel("lineStyle"),o=[],h=0;h<i.length;h++)for(var d=0;d<i[h].length;d++)o.push(new Gf({shape:dI(t,s,i[h][d].coord)}));n.add(Mm(o,{style:l.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(n,e,t,r,i,s){if(r.length){var a=e.getModel("splitArea"),l=a.getModel("areaStyle"),o=l.get("color"),h=0;o=o instanceof Array?o:[o];for(var d=[],m=Math.PI/180,v=-r[0].coord*m,y=Math.min(s[0],s[1]),S=Math.max(s[0],s[1]),E=e.get("clockwise"),M=1,C=r.length;M<=C;M++){var L=M===C?r[0].coord:r[M].coord,k=h++%o.length;d[k]=d[k]||[],d[k].push(new Oh({shape:{cx:t.cx,cy:t.cy,r0:y,r:S,startAngle:v,endAngle:-L*m,clockwise:E},silent:!0})),v=-L*m}for(var M=0;M<d.length;M++)n.add(Mm(d[M],{style:ti({fill:o[M%o.length]},l.getAreaStyle()),silent:!0}))}}},_5e=["axisLine","axisTickLabel","axisName"],y5e=["splitLine","splitArea","minorSplitLine"],x5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=this._axisGroup,s=this._axisGroup=new ma;this.group.add(s);var a=t.axis,l=a.polar,o=l.getAngleAxis(),h=a.getTicksCoords(),d=a.getMinorTicksCoords(),m=o.getExtent()[0],v=a.getExtent(),y=w5e(l,t,m),S=new Rh(t,y);it(_5e,S.add,S),s.add(S.getGroup()),WU(i,s,t),it(y5e,function(E){t.get([E,"show"])&&!a.scale.isBlank()&&b5e[E](this.group,t,l,m,v,h,d)},this)}},e.type="radiusAxis",e}(fM),b5e={splitLine:function(n,e,t,r,i,s){var a=e.getModel("splitLine"),l=a.getModel("lineStyle"),o=l.get("color"),h=0,d=t.getAngleAxis(),m=Math.PI/180,v=d.getExtent(),y=Math.abs(v[1]-v[0])===360?"Circle":"Arc";o=o instanceof Array?o:[o];for(var S=[],E=0;E<s.length;E++){var M=h++%o.length;S[M]=S[M]||[],S[M].push(new XU[y]({shape:{cx:t.cx,cy:t.cy,r:Math.max(s[E].coord,0),startAngle:-v[0]*m,endAngle:-v[1]*m,clockwise:d.inverse}}))}for(var E=0;E<S.length;E++)n.add(Mm(S[E],{style:ti({stroke:o[E%o.length],fill:null},l.getLineStyle()),silent:!0}))},minorSplitLine:function(n,e,t,r,i,s,a){if(a.length){for(var l=e.getModel("minorSplitLine"),o=l.getModel("lineStyle"),h=[],d=0;d<a.length;d++)for(var m=0;m<a[d].length;m++)h.push(new ND({shape:{cx:t.cx,cy:t.cy,r:a[d][m].coord}}));n.add(Mm(h,{style:ti({fill:null},o.getLineStyle()),silent:!0}))}},splitArea:function(n,e,t,r,i,s){if(s.length){var a=e.getModel("splitArea"),l=a.getModel("areaStyle"),o=l.get("color"),h=0;o=o instanceof Array?o:[o];for(var d=[],m=s[0].coord,v=1;v<s.length;v++){var y=h++%o.length;d[y]=d[y]||[],d[y].push(new Oh({shape:{cx:t.cx,cy:t.cy,r0:m,r:s[v].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),m=s[v].coord}for(var v=0;v<d.length;v++)n.add(Mm(d[v],{style:ti({fill:o[v%o.length]},l.getAreaStyle()),silent:!0}))}}};function w5e(n,e,t){return{position:[n.cx,n.cy],rotation:t/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}function ele(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function tle(n,e){return e.dim+n.model.componentIndex}function S5e(n,e,t){var r={},i=A5e(na(e.getSeriesByType(n),function(s){return!e.isSeriesFiltered(s)&&s.coordinateSystem&&s.coordinateSystem.type==="polar"}));e.eachSeriesByType(n,function(s){if(s.coordinateSystem.type==="polar"){var a=s.getData(),l=s.coordinateSystem,o=l.getBaseAxis(),h=tle(l,o),d=ele(s),m=i[h][d],v=m.offset,y=m.width,S=l.getOtherAxis(o),E=s.coordinateSystem.cx,M=s.coordinateSystem.cy,C=s.get("barMinHeight")||0,L=s.get("barMinAngle")||0;r[d]=r[d]||[];for(var k=a.mapDimension(S.dim),H=a.mapDimension(o.dim),q=o1(a,k),Z=o.dim!=="radius"||!s.get("roundCap",!0),ee=S.model,re=ee.get("startValue"),se=S.dataToCoord(re||0),ae=0,fe=a.count();ae<fe;ae++){var Se=a.get(k,ae),Ce=a.get(H,ae),Ie=Se>=0?"p":"n",je=se;q&&(r[d][Ce]||(r[d][Ce]={p:se,n:se}),je=r[d][Ce][Ie]);var Le=void 0,ot=void 0,ye=void 0,$e=void 0;if(S.dim==="radius"){var Ve=S.dataToCoord(Se)-se,_t=o.dataToCoord(Ce);Math.abs(Ve)<C&&(Ve=(Ve<0?-1:1)*C),Le=je,ot=je+Ve,ye=_t-v,$e=ye-y,q&&(r[d][Ce][Ie]=ot)}else{var wt=S.dataToCoord(Se,Z)-se,Vt=o.dataToCoord(Ce);Math.abs(wt)<L&&(wt=(wt<0?-1:1)*L),Le=Vt+v,ot=Le+y,ye=je,$e=je+wt,q&&(r[d][Ce][Ie]=$e)}a.setItemLayout(ae,{cx:E,cy:M,r0:Le,r:ot,startAngle:-ye*Math.PI/180,endAngle:-$e*Math.PI/180,clockwise:ye>=$e})}}})}function A5e(n){var e={};it(n,function(r,i){var s=r.getData(),a=r.coordinateSystem,l=a.getBaseAxis(),o=tle(a,l),h=l.getExtent(),d=l.type==="category"?l.getBandWidth():Math.abs(h[1]-h[0])/s.count(),m=e[o]||{bandWidth:d,remainedWidth:d,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},v=m.stacks;e[o]=m;var y=ele(r);v[y]||m.autoWidthCount++,v[y]=v[y]||{width:0,maxWidth:0};var S=ls(r.get("barWidth"),d),E=ls(r.get("barMaxWidth"),d),M=r.get("barGap"),C=r.get("barCategoryGap");S&&!v[y].width&&(S=Math.min(m.remainedWidth,S),v[y].width=S,m.remainedWidth-=S),E&&(v[y].maxWidth=E),M!=null&&(m.gap=M),C!=null&&(m.categoryGap=C)});var t={};return it(e,function(r,i){t[i]={};var s=r.stacks,a=r.bandWidth,l=ls(r.categoryGap,a),o=ls(r.gap,1),h=r.remainedWidth,d=r.autoWidthCount,m=(h-l)/(d+(d-1)*o);m=Math.max(m,0),it(s,function(E,M){var C=E.maxWidth;C&&C<m&&(C=Math.min(C,h),E.width&&(C=Math.min(C,E.width)),h-=C,E.width=C,d--)}),m=(h-l)/(d+(d-1)*o),m=Math.max(m,0);var v=0,y;it(s,function(E,M){E.width||(E.width=m),y=E,v+=E.width*(1+o)}),y&&(v-=y.width*o);var S=-v/2;it(s,function(E,M){t[i][M]=t[i][M]||{offset:S,width:E.width},S+=E.width*(1+o)})}),t}var T5e={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},M5e={splitNumber:5},C5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="polar",e}(Pc);function E5e(n){mp(P8),fM.registerAxisPointerClass("PolarAxisPointer",n5e),n.registerCoordinateSystem("polar",p5e),n.registerComponentModel(s5e),n.registerComponentView(C5e),JP(n,"angle",o5e,T5e),JP(n,"radius",a5e,M5e),n.registerComponentView(g5e),n.registerComponentView(x5e),n.registerLayout(vs(S5e,"bar"))}var mY=["x","y","radius","angle","single"],I5e=["cartesian2d","polar","singleAxis"];function R5e(n){var e=n.get("coordinateSystem");return Xi(I5e,e)>=0}function Sb(n){return n+"Axis"}function P5e(n,e){var t=ii(),r=[],i=ii();n.eachComponent({mainType:"dataZoom",query:e},function(d){i.get(d.uid)||l(d)});var s;do s=!1,n.eachComponent("dataZoom",a);while(s);function a(d){!i.get(d.uid)&&o(d)&&(l(d),s=!0)}function l(d){i.set(d.uid,!0),r.push(d),h(d)}function o(d){var m=!1;return d.eachTargetAxis(function(v,y){var S=t.get(v);S&&S[y]&&(m=!0)}),m}function h(d){d.eachTargetAxis(function(m,v){(t.get(m)||t.set(m,[]))[v]=!0})}return r}var Lk=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},n}(),L5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._autoThrottle=!0,t._noTarget=!0,t._rangePropMode=["percent","percent"],t}return e.prototype.init=function(t,r,i){var s=gY(t);this.settledOption=s,this.mergeDefaultAndTheme(t,i),this._doInit(s)},e.prototype.mergeOption=function(t){var r=gY(t);Di(this.option,t,!0),Di(this.settledOption,r,!0),this._doInit(r)},e.prototype._doInit=function(t){var r=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var i=this.settledOption;it([["start","startValue"],["end","endValue"]],function(s,a){this._rangePropMode[a]==="value"&&(r[s[0]]=i[s[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),r=this._targetAxisInfoMap=ii(),i=this._fillSpecifiedTargetAxis(r);i?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(r,this._orient)),this._noTarget=!0,r.each(function(s){s.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(t){var r=!1;return it(mY,function(i){var s=this.getReferringComponents(Sb(i),UMe);if(s.specified){r=!0;var a=new Lk;it(s.models,function(l){a.add(l.componentIndex)}),t.set(i,a)}},this),r},e.prototype._fillAutoTargetAxisByOrient=function(t,r){var i=this.ecModel,s=!0;if(s){var a=r==="vertical"?"y":"x",l=i.findComponents({mainType:a+"Axis"});o(l,a)}if(s){var l=i.findComponents({mainType:"singleAxis",filter:function(d){return d.get("orient",!0)===r}});o(l,"single")}function o(h,d){var m=h[0];if(m){var v=new Lk;if(v.add(m.componentIndex),t.set(d,v),s=!1,d==="x"||d==="y"){var y=m.getReferringComponents("grid",xl).models[0];y&&it(h,function(S){m.componentIndex!==S.componentIndex&&y===S.getReferringComponents("grid",xl).models[0]&&v.add(S.componentIndex)})}}}s&&it(mY,function(h){if(s){var d=i.findComponents({mainType:Sb(h),filter:function(v){return v.get("type",!0)==="category"}});if(d[0]){var m=new Lk;m.add(d[0].componentIndex),t.set(h,m),s=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis(function(r){!t&&(t=r)},this),t==="y"?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var r=this.ecModel.option;this.option.throttle=r.animation&&r.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var r=this._rangePropMode,i=this.get("rangeMode");it([["start","startValue"],["end","endValue"]],function(s,a){var l=t[s[0]]!=null,o=t[s[1]]!=null;l&&!o?r[a]="percent":!l&&o?r[a]="value":i?r[a]=i[a]:l&&(r[a]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis(function(r,i){t==null&&(t=this.ecModel.getComponent(Sb(r),i))},this),t},e.prototype.eachTargetAxis=function(t,r){this._targetAxisInfoMap.each(function(i,s){it(i.indexList,function(a){t.call(r,s,a)})})},e.prototype.getAxisProxy=function(t,r){var i=this.getAxisModel(t,r);if(i)return i.__dzAxisProxy},e.prototype.getAxisModel=function(t,r){var i=this._targetAxisInfoMap.get(t);if(i&&i.indexMap[r])return this.ecModel.getComponent(Sb(t),r)},e.prototype.setRawRange=function(t){var r=this.option,i=this.settledOption;it([["start","startValue"],["end","endValue"]],function(s){(t[s[0]]!=null||t[s[1]]!=null)&&(r[s[0]]=i[s[0]]=t[s[0]],r[s[1]]=i[s[1]]=t[s[1]])},this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var r=this.option;it(["start","startValue","end","endValue"],function(i){r[i]=t[i]})},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,r){if(t==null&&r==null){var i=this.findRepresentativeAxisProxy();if(i)return i.getDataValueWindow()}else return this.getAxisProxy(t,r).getDataValueWindow()},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var r,i=this._targetAxisInfoMap.keys(),s=0;s<i.length;s++)for(var a=i[s],l=this._targetAxisInfoMap.get(a),o=0;o<l.indexList.length;o++){var h=this.getAxisProxy(a,l.indexList[o]);if(h.hostedBy(this))return h;r||(r=h)}return r},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={z:4,filterMode:"filter",start:0,end:100},e}(os);function gY(n){var e={};return it(["start","end","startValue","endValue","throttle"],function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e}var D5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(L5e),B5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,s){this.dataZoomModel=t,this.ecModel=r,this.api=i},e.type="dataZoom",e}(Pc),k5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(B5e),Qx=it,vY=bMe,O5e=function(){function n(e,t,r,i){this._dimName=e,this._axisIndex=t,this.ecModel=i,this._dataZoomModel=r}return n.prototype.hostedBy=function(e){return this._dataZoomModel===e},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(t){if(R5e(t)){var r=Sb(this._dimName),i=t.getReferringComponents(r,xl).models[0];i&&this._axisIndex===i.componentIndex&&e.push(t)}},this),e},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return _i(this._minMaxSpan)},n.prototype.calculateDataWindow=function(e){var t=this._dataExtent,r=this.getAxisModel(),i=r.axis.scale,s=this._dataZoomModel.getRangePropMode(),a=[0,100],l=[],o=[],h;Qx(["start","end"],function(v,y){var S=e[v],E=e[v+"Value"];s[y]==="percent"?(S==null&&(S=a[y]),E=i.parse(F0(S,a,t))):(h=!0,E=E==null?t[y]:i.parse(E),S=F0(E,t,a)),o[y]=E==null||isNaN(E)?t[y]:E,l[y]=S==null||isNaN(S)?a[y]:S}),vY(o),vY(l);var d=this._minMaxSpan;h?m(o,l,t,a,!1):m(l,o,a,t,!0);function m(v,y,S,E,M){var C=M?"Span":"ValueSpan";Lae(0,v,S,"all",d["min"+C],d["max"+C]);for(var L=0;L<2;L++)y[L]=F0(v[L],S,E,!0),M&&(y[L]=i.parse(y[L]))}return{valueWindow:o,percentWindow:l}},n.prototype.reset=function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=F5e(this,this._dimName,t),this._updateMinMaxSpan();var r=this.calculateDataWindow(e.settledOption);this._valueWindow=r.valueWindow,this._percentWindow=r.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(e,t){if(e!==this._dataZoomModel)return;var r=this._dimName,i=this.getTargetSeriesModels(),s=e.get("filterMode"),a=this._valueWindow;if(s==="none")return;Qx(i,function(o){var h=o.getData(),d=h.mapDimensionsAll(r);if(d.length){if(s==="weakFilter"){var m=h.getStore(),v=xr(d,function(y){return h.getDimensionIndex(y)},h);h.filterSelf(function(y){for(var S,E,M,C=0;C<d.length;C++){var L=m.get(v[C],y),k=!isNaN(L),H=L<a[0],q=L>a[1];if(k&&!H&&!q)return!0;k&&(M=!0),H&&(S=!0),q&&(E=!0)}return M&&S&&E})}else Qx(d,function(y){if(s==="empty")o.setData(h=h.map(y,function(E){return l(E)?E:NaN}));else{var S={};S[y]=a,h.selectRange(S)}});Qx(d,function(y){h.setApproximateExtent(a,y)})}});function l(o){return o>=a[0]&&o<=a[1]}},n.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},t=this._dataZoomModel,r=this._dataExtent;Qx(["min","max"],function(i){var s=t.get(i+"Span"),a=t.get(i+"ValueSpan");a!=null&&(a=this.getAxisModel().axis.scale.parse(a)),a!=null?s=F0(r[0]+a,r,[0,100],!0):s!=null&&(a=F0(s,[0,100],r,!0)-r[0]),e[i+"Span"]=s,e[i+"ValueSpan"]=a},this)},n.prototype._setAxisModel=function(){var e=this.getAxisModel(),t=this._percentWindow,r=this._valueWindow;if(t){var i=sie(r,[0,500]);i=Math.min(i,20);var s=e.axis.scale.rawExtentInfo;t[0]!==0&&s.setDeterminedMinMax("min",+r[0].toFixed(i)),t[1]!==100&&s.setDeterminedMinMax("max",+r[1].toFixed(i)),s.freeze()}},n}();function F5e(n,e,t){var r=[1/0,-1/0];Qx(t,function(a){fDe(r,a.getData(),e)});var i=n.getAxisModel(),s=$oe(i.axis.scale,i,r).calculate();return[s.min,s.max]}var N5e={getTargetSeries:function(n){function e(i){n.eachComponent("dataZoom",function(s){s.eachTargetAxis(function(a,l){var o=n.getComponent(Sb(a),l);i(a,l,o,s)})})}e(function(i,s,a,l){a.__dzAxisProxy=null});var t=[];e(function(i,s,a,l){a.__dzAxisProxy||(a.__dzAxisProxy=new O5e(i,s,l,n),t.push(a.__dzAxisProxy))});var r=ii();return it(t,function(i){it(i.getTargetSeriesModels(),function(s){r.set(s.uid,s)})}),r},overallReset:function(n,e){n.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).reset(t)}),t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).filterData(t,e)})}),n.eachComponent("dataZoom",function(t){var r=t.findRepresentativeAxisProxy();if(r){var i=r.getDataPercentWindow(),s=r.getDataValueWindow();t.setCalculatedRange({start:i[0],end:i[1],startValue:s[0],endValue:s[1]})}})}};function z5e(n){n.registerAction("dataZoom",function(e,t){var r=P5e(t,e);it(r,function(i){i.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}var _Y=!1;function U5e(n){_Y||(_Y=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,N5e),z5e(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function G5e(n){n.registerComponentModel(D5e),n.registerComponentView(k5e),U5e(n)}var zf=function(){function n(){}return n}(),nle={};function oS(n,e){nle[n]=e}function rle(n){return nle[n]}var V5e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;it(this.option.feature,function(r,i){var s=rle(i);s&&(s.getDefaultOption&&(s.defaultOption=s.getDefaultOption(t)),Di(r,s.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}(os);function H5e(n,e,t){var r=e.getBoxLayoutParams(),i=e.get("padding"),s={width:t.getWidth(),height:t.getHeight()},a=_v(r,s,i);Ub(e.get("orient"),n,e.get("itemGap"),a.width,a.height),bIe(n,r,s,i)}function ile(n,e){var t=JD(e.get("padding")),r=e.getItemStyle(["color","opacity"]);return r.fill=e.get("backgroundColor"),n=new Ho({shape:{x:n.x-t[3],y:n.y-t[0],width:n.width+t[1]+t[3],height:n.height+t[0]+t[2],r:e.get("borderRadius")},style:r,silent:!0,z2:-1}),n}var j5e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,s){var a=this.group;if(a.removeAll(),!t.get("show"))return;var l=+t.get("itemSize"),o=t.get("orient")==="vertical",h=t.get("feature")||{},d=this._features||(this._features={}),m=[];it(h,function(S,E){m.push(E)}),new gT(this._featureNames||[],m).add(v).update(v).remove(vs(v,null)).execute(),this._featureNames=m;function v(S,E){var M=m[S],C=m[E],L=h[M],k=new Ro(L,t,t.ecModel),H;if(s&&s.newTitle!=null&&s.featureName===M&&(L.title=s.newTitle),M&&!C){if(W5e(M))H={onclick:k.option.onclick,featureName:M};else{var q=rle(M);if(!q)return;H=new q}d[M]=H}else if(H=d[C],!H)return;H.uid=hM("toolbox-feature"),H.model=k,H.ecModel=r,H.api=i;var Z=H instanceof zf;if(!M&&C){Z&&H.dispose&&H.dispose(r,i);return}if(!k.get("show")||Z&&H.unusable){Z&&H.remove&&H.remove(r,i);return}y(k,H,M),k.setIconStatus=function(ee,re){var se=this.option,ae=this.iconPaths;se.iconStatus=se.iconStatus||{},se.iconStatus[ee]=re,ae[ee]&&(re==="emphasis"?rw:iw)(ae[ee])},H instanceof zf&&H.render&&H.render(k,r,i,s)}function y(S,E,M){var C=S.getModel("iconStyle"),L=S.getModel(["emphasis","iconStyle"]),k=E instanceof zf&&E.getIcons?E.getIcons():S.get("icon"),H=S.get("title")||{},q,Z;Dr(k)?(q={},q[M]=k):q=k,Dr(H)?(Z={},Z[M]=H):Z=H;var ee=S.iconPaths={};it(q,function(re,se){var ae=HD(re,{},{x:-l/2,y:-l/2,width:l,height:l});ae.setStyle(C.getItemStyle());var fe=ae.ensureState("emphasis");fe.style=L.getItemStyle();var Se=new Ea({style:{text:Z[se],align:L.get("textAlign"),borderRadius:L.get("textBorderRadius"),padding:L.get("textPadding"),fill:null,font:ase({fontStyle:L.get("textFontStyle"),fontFamily:L.get("textFontFamily"),fontSize:L.get("textFontSize"),fontWeight:L.get("textFontWeight")},r)},ignore:!0});ae.setTextContent(Se),jD({el:ae,componentModel:t,itemName:se,formatterParamsExtra:{title:Z[se]}}),ae.__title=Z[se],ae.on("mouseover",function(){var Ce=L.getItemStyle(),Ie=o?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";Se.setStyle({fill:L.get("textFill")||Ce.fill||Ce.stroke||"#000",backgroundColor:L.get("textBackgroundColor")}),ae.setTextConfig({position:L.get("textPosition")||Ie}),Se.ignore=!t.get("showTitle"),i.enterEmphasis(this)}).on("mouseout",function(){S.get(["iconStatus",se])!=="emphasis"&&i.leaveEmphasis(this),Se.hide()}),(S.get(["iconStatus",se])==="emphasis"?rw:iw)(ae),a.add(ae),ae.on("click",zs(E.onclick,E,r,i,se)),ee[se]=ae})}H5e(a,t,i),a.add(ile(a.getBoundingRect(),t)),o||a.eachChild(function(S){var E=S.__title,M=S.ensureState("emphasis"),C=M.textConfig||(M.textConfig={}),L=S.getTextContent(),k=L&&L.ensureState("emphasis");if(k&&!ci(k)&&E){var H=k.style||(k.style={}),q=oM(E,Ea.makeFont(H)),Z=S.x+a.x,ee=S.y+a.y+l,re=!1;ee+q.height>i.getHeight()&&(C.position="top",re=!0);var se=re?-5-q.height:l+10;Z+q.width/2>i.getWidth()?(C.position=["100%",se],H.align="right"):Z-q.width/2<0&&(C.position=[0,se],H.align="left")}})},e.prototype.updateView=function(t,r,i,s){it(this._features,function(a){a instanceof zf&&a.updateView&&a.updateView(a.model,r,i,s)})},e.prototype.remove=function(t,r){it(this._features,function(i){i instanceof zf&&i.remove&&i.remove(t,r)}),this.group.removeAll()},e.prototype.dispose=function(t,r){it(this._features,function(i){i instanceof zf&&i.dispose&&i.dispose(t,r)})},e.type="toolbox",e}(Pc);function W5e(n){return n.indexOf("my")===0}var X5e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){var i=this.model,s=i.get("name")||t.get("title.0.text")||"echarts",a=r.getZr().painter.getType()==="svg",l=a?"svg":i.get("type",!0)||"png",o=r.getConnectedDataURL({type:l,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")}),h=mi.browser;if(typeof MouseEvent=="function"&&(h.newEdge||!h.ie&&!h.edge)){var d=document.createElement("a");d.download=s+"."+l,d.target="_blank",d.href=o;var m=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});d.dispatchEvent(m)}else if(window.navigator.msSaveOrOpenBlob||a){var v=o.split(","),y=v[0].indexOf("base64")>-1,S=a?decodeURIComponent(v[1]):v[1];y&&(S=window.atob(S));var E=s+"."+l;if(window.navigator.msSaveOrOpenBlob){for(var M=S.length,C=new Uint8Array(M);M--;)C[M]=S.charCodeAt(M);var L=new Blob([C]);window.navigator.msSaveOrOpenBlob(L,E)}else{var k=document.createElement("iframe");document.body.appendChild(k);var H=k.contentWindow,q=H.document;q.open("image/svg+xml","replace"),q.write(S),q.close(),H.focus(),q.execCommand("SaveAs",!0,E),document.body.removeChild(k)}}else{var Z=i.get("lang"),ee='<body style="margin:0;"><img src="'+o+'" style="max-width:100%;" title="'+(Z&&Z[0]||"")+'" /></body>',re=window.open();re.document.write(ee),re.document.title=s}},e.getDefaultOption=function(t){var r={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return r},e}(zf),yY="__ec_magicType_stack__",$5e=[["line","bar"],["stack"]],q5e=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getIcons=function(){var t=this.model,r=t.get("icon"),i={};return it(t.get("type"),function(s){r[s]&&(i[s]=r[s])}),i},e.getDefaultOption=function(t){var r={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return r},e.prototype.onclick=function(t,r,i){var s=this.model,a=s.get(["seriesIndex",i]);if(xY[i]){var l={series:[]},o=function(m){var v=m.subType,y=m.id,S=xY[i](v,y,m,s);S&&(ti(S,m.option),l.series.push(S));var E=m.coordinateSystem;if(E&&E.type==="cartesian2d"&&(i==="line"||i==="bar")){var M=E.getAxesByScale("ordinal")[0];if(M){var C=M.dim,L=C+"Axis",k=m.getReferringComponents(L,xl).models[0],H=k.componentIndex;l[L]=l[L]||[];for(var q=0;q<=H;q++)l[L][H]=l[L][H]||{};l[L][H].boundaryGap=i==="bar"}}};it($5e,function(m){Xi(m,i)>=0&&it(m,function(v){s.setIconStatus(v,"normal")})}),s.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:a==null?null:{seriesIndex:a}},o);var h,d=i;i==="stack"&&(h=Di({stack:s.option.title.tiled,tiled:s.option.title.stack},s.option.title),s.get(["iconStatus",i])!=="emphasis"&&(d="tiled")),r.dispatchAction({type:"changeMagicType",currentType:d,newOption:l,newTitle:h,featureName:"magicType"})}},e}(zf),xY={line:function(n,e,t,r){if(n==="bar")return Di({id:e,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","line"])||{},!0)},bar:function(n,e,t,r){if(n==="line")return Di({id:e,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","bar"])||{},!0)},stack:function(n,e,t,r){var i=t.get("stack")===yY;if(n==="line"||n==="bar")return r.setIconStatus("stack",i?"normal":"emphasis"),Di({id:e,stack:i?"":yY},r.get(["option","stack"])||{},!0)}};xp({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,e){e.mergeOption(n.newOption)});var a3=new Array(60).join("-"),cw="	";function Z5e(n){var e={},t=[],r=[];return n.eachRawSeries(function(i){var s=i.coordinateSystem;if(s&&(s.type==="cartesian2d"||s.type==="polar")){var a=s.getBaseAxis();if(a.type==="category"){var l=a.dim+"_"+a.index;e[l]||(e[l]={categoryAxis:a,valueAxis:s.getOtherAxis(a),series:[]},r.push({axisDim:a.dim,axisIndex:a.index})),e[l].series.push(i)}else t.push(i)}else t.push(i)}),{seriesGroupByCategoryAxis:e,other:t,meta:r}}function Y5e(n){var e=[];return it(n,function(t,r){var i=t.categoryAxis,s=t.valueAxis,a=s.dim,l=[" "].concat(xr(t.series,function(y){return y.name})),o=[i.model.getCategories()];it(t.series,function(y){var S=y.getRawData();o.push(y.getRawData().mapArray(S.mapDimension(a),function(E){return E}))});for(var h=[l.join(cw)],d=0;d<o[0].length;d++){for(var m=[],v=0;v<o.length;v++)m.push(o[v][d]);h.push(m.join(cw))}e.push(h.join(`
`))}),e.join(`

`+a3+`

`)}function K5e(n){return xr(n,function(e){var t=e.getRawData(),r=[e.name],i=[];return t.each(t.dimensions,function(){for(var s=arguments.length,a=arguments[s-1],l=t.getName(a),o=0;o<s-1;o++)i[o]=arguments[o];r.push((l?l+cw:"")+i.join(cw))}),r.join(`
`)}).join(`

`+a3+`

`)}function J5e(n){var e=Z5e(n);return{value:na([Y5e(e.seriesGroupByCategoryAxis),K5e(e.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+a3+`

`),meta:e.meta}}function QP(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Q5e(n){var e=n.slice(0,n.indexOf(`
`));if(e.indexOf(cw)>=0)return!0}var ZN=new RegExp("["+cw+"]+","g");function eBe(n){for(var e=n.split(/\n+/g),t=QP(e.shift()).split(ZN),r=[],i=xr(t,function(o){return{name:o,data:[]}}),s=0;s<e.length;s++){var a=QP(e[s]).split(ZN);r.push(a.shift());for(var l=0;l<a.length;l++)i[l]&&(i[l].data[s]=a[l])}return{series:i,categories:r}}function tBe(n){for(var e=n.split(/\n+/g),t=QP(e.shift()),r=[],i=0;i<e.length;i++){var s=QP(e[i]);if(s){var a=s.split(ZN),l="",o=void 0,h=!1;isNaN(a[0])?(h=!0,l=a[0],a=a.slice(1),r[i]={name:l,value:[]},o=r[i].value):o=r[i]=[];for(var d=0;d<a.length;d++)o.push(+a[d]);o.length===1&&(h?r[i].value=o[0]:r[i]=o[0])}}return{name:t,data:r}}function nBe(n,e){var t=n.split(new RegExp(`
*`+a3+`
*`,"g")),r={series:[]};return it(t,function(i,s){if(Q5e(i)){var a=eBe(i),l=e[s],o=l.axisDim+"Axis";l&&(r[o]=r[o]||[],r[o][l.axisIndex]={data:a.categories},r.series=r.series.concat(a.series))}else{var a=tBe(i);r.series.push(a)}}),r}var rBe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){setTimeout(function(){r.dispatchAction({type:"hideTip"})});var i=r.getDom(),s=this.model;this._dom&&i.removeChild(this._dom);var a=document.createElement("div");a.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",a.style.backgroundColor=s.get("backgroundColor")||"#fff";var l=document.createElement("h4"),o=s.get("lang")||[];l.innerHTML=o[0]||s.get("title"),l.style.cssText="margin:10px 20px",l.style.color=s.get("textColor");var h=document.createElement("div"),d=document.createElement("textarea");h.style.cssText="overflow:auto";var m=s.get("optionToContent"),v=s.get("contentToOption"),y=J5e(t);if(ci(m)){var S=m(r.getOption());Dr(S)?h.innerHTML=S:nw(S)&&h.appendChild(S)}else{d.readOnly=s.get("readOnly");var E=d.style;E.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",E.color=s.get("textColor"),E.borderColor=s.get("textareaBorderColor"),E.backgroundColor=s.get("textareaColor"),d.value=y.value,h.appendChild(d)}var M=y.meta,C=document.createElement("div");C.style.cssText="position:absolute;bottom:5px;left:0;right:0";var L="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",k=document.createElement("div"),H=document.createElement("div");L+=";background-color:"+s.get("buttonColor"),L+=";color:"+s.get("buttonTextColor");var q=this;function Z(){i.removeChild(a),q._dom=null}ZF(k,"click",Z),ZF(H,"click",function(){if(v==null&&m!=null||v!=null&&m==null){Z();return}var ee;try{ci(v)?ee=v(h,r.getOption()):ee=nBe(d.value,M)}catch(re){throw Z(),new Error("Data view format error "+re)}ee&&r.dispatchAction({type:"changeDataView",newOption:ee}),Z()}),k.innerHTML=o[1],H.innerHTML=o[2],H.style.cssText=k.style.cssText=L,!s.get("readOnly")&&C.appendChild(H),C.appendChild(k),a.appendChild(l),a.appendChild(h),a.appendChild(C),h.style.height=i.clientHeight-80+"px",i.appendChild(a),this._dom=a},e.prototype.remove=function(t,r){this._dom&&r.getDom().removeChild(this._dom)},e.prototype.dispose=function(t,r){this.remove(t,r)},e.getDefaultOption=function(t){var r={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return r},e}(zf);function iBe(n,e){return xr(n,function(t,r){var i=e&&e[r];if(Xr(i)&&!fr(i)){var s=Xr(t)&&!fr(t);s||(t={value:t});var a=i.name!=null&&t.name==null;return t=ti(t,i),a&&delete t.name,t}else return t})}xp({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,e){var t=[];it(n.newOption.series,function(r){var i=e.getSeriesByName(r.name)[0];if(!i)t.push(Jn({type:"scatter"},r));else{var s=i.get("data");t.push({name:r.name,data:iBe(r.data,s)})}}),e.mergeOption(ti({series:t},n.newOption))});var sle=it,ole=$s();function sBe(n,e){var t=k8(n);sle(e,function(r,i){for(var s=t.length-1;s>=0;s--){var a=t[s];if(a[i])break}if(s<0){var l=n.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(l){var o=l.getPercentRange();t[0][i]={dataZoomId:i,start:o[0],end:o[1]}}}}),t.push(e)}function oBe(n){var e=k8(n),t=e[e.length-1];e.length>1&&e.pop();var r={};return sle(t,function(i,s){for(var a=e.length-1;a>=0;a--)if(i=e[a][s],i){r[s]=i;break}}),r}function aBe(n){ole(n).snapshots=null}function lBe(n){return k8(n).length}function k8(n){var e=ole(n);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var cBe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){aBe(t),r.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(t){var r={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return r},e}(zf);xp({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,e){e.resetOption("recreate")});var uBe=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],ale=function(){function n(e,t,r){var i=this;this._targetInfoList=[];var s=bY(t,e);it(hBe,function(a,l){(!r||!r.include||Xi(r.include,l)>=0)&&a(s,i._targetInfoList)})}return n.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,function(r,i,s){if((r.coordRanges||(r.coordRanges=[])).push(i),!r.coordRange){r.coordRange=i;var a=Dk[r.brushType](0,s,i);r.__rangeOffset={offset:TY[r.brushType](a.values,r.range,[1,1]),xyMinMax:a.xyMinMax}}}),e},n.prototype.matchOutputRanges=function(e,t,r){it(e,function(i){var s=this.findTargetInfo(i,t);s&&s!==!0&&it(s.coordSyses,function(a){var l=Dk[i.brushType](1,a,i.range,!0);r(i,l.values,a,t)})},this)},n.prototype.setInputRanges=function(e,t){it(e,function(r){var i=this.findTargetInfo(r,t);if(r.range=r.range||[],i&&i!==!0){r.panelId=i.panelId;var s=Dk[r.brushType](0,i.coordSys,r.coordRange),a=r.__rangeOffset;r.range=a?TY[r.brushType](s.values,a.offset,fBe(s.xyMinMax,a.xyMinMax)):s.values}},this)},n.prototype.makePanelOpts=function(e,t){return xr(this._targetInfoList,function(r){var i=r.getPanelRect();return{panelId:r.panelId,defaultBrushType:t?t(r):null,clipPath:L4e(i),isTargetByCursor:B4e(i,e,r.coordSysModel),getLinearBrushOtherExtent:D4e(i)}})},n.prototype.controlSeries=function(e,t,r){var i=this.findTargetInfo(e,r);return i===!0||i&&Xi(i.coordSyses,t.coordinateSystem)>=0},n.prototype.findTargetInfo=function(e,t){for(var r=this._targetInfoList,i=bY(t,e),s=0;s<r.length;s++){var a=r[s],l=e.panelId;if(l){if(a.panelId===l)return a}else for(var o=0;o<wY.length;o++)if(wY[o](i,a))return a}return!0},n}();function YN(n){return n[0]>n[1]&&n.reverse(),n}function bY(n,e){return aA(n,e,{includeMainTypes:uBe})}var hBe={grid:function(n,e){var t=n.xAxisModels,r=n.yAxisModels,i=n.gridModels,s=ii(),a={},l={};!t&&!r&&!i||(it(t,function(o){var h=o.axis.grid.model;s.set(h.id,h),a[h.id]=!0}),it(r,function(o){var h=o.axis.grid.model;s.set(h.id,h),l[h.id]=!0}),it(i,function(o){s.set(o.id,o),a[o.id]=!0,l[o.id]=!0}),s.each(function(o){var h=o.coordinateSystem,d=[];it(h.getCartesians(),function(m,v){(Xi(t,m.getAxis("x").model)>=0||Xi(r,m.getAxis("y").model)>=0)&&d.push(m)}),e.push({panelId:"grid--"+o.id,gridModel:o,coordSysModel:o,coordSys:d[0],coordSyses:d,getPanelRect:SY.grid,xAxisDeclared:a[o.id],yAxisDeclared:l[o.id]})}))},geo:function(n,e){it(n.geoModels,function(t){var r=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:r,coordSyses:[r],getPanelRect:SY.geo})})}},wY=[function(n,e){var t=n.xAxisModel,r=n.yAxisModel,i=n.gridModel;return!i&&t&&(i=t.axis.grid.model),!i&&r&&(i=r.axis.grid.model),i&&i===e.gridModel},function(n,e){var t=n.geoModel;return t&&t===e.geoModel}],SY={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,e=n.getBoundingRect().clone();return e.applyTransform(jU(n)),e}},Dk={lineX:vs(AY,0),lineY:vs(AY,1),rect:function(n,e,t,r){var i=n?e.pointToData([t[0][0],t[1][0]],r):e.dataToPoint([t[0][0],t[1][0]],r),s=n?e.pointToData([t[0][1],t[1][1]],r):e.dataToPoint([t[0][1],t[1][1]],r),a=[YN([i[0],s[0]]),YN([i[1],s[1]])];return{values:a,xyMinMax:a}},polygon:function(n,e,t,r){var i=[[1/0,-1/0],[1/0,-1/0]],s=xr(t,function(a){var l=n?e.pointToData(a,r):e.dataToPoint(a,r);return i[0][0]=Math.min(i[0][0],l[0]),i[1][0]=Math.min(i[1][0],l[1]),i[0][1]=Math.max(i[0][1],l[0]),i[1][1]=Math.max(i[1][1],l[1]),l});return{values:s,xyMinMax:i}}};function AY(n,e,t,r){var i=t.getAxis(["x","y"][n]),s=YN(xr([0,1],function(l){return e?i.coordToData(i.toLocalCoord(r[l]),!0):i.toGlobalCoord(i.dataToCoord(r[l]))})),a=[];return a[n]=s,a[1-n]=[NaN,NaN],{values:s,xyMinMax:a}}var TY={lineX:vs(MY,0),lineY:vs(MY,1),rect:function(n,e,t){return[[n[0][0]-t[0]*e[0][0],n[0][1]-t[0]*e[0][1]],[n[1][0]-t[1]*e[1][0],n[1][1]-t[1]*e[1][1]]]},polygon:function(n,e,t){return xr(n,function(r,i){return[r[0]-t[0]*e[i][0],r[1]-t[1]*e[i][1]]})}};function MY(n,e,t,r){return[e[0]-r[n]*t[0],e[1]-r[n]*t[1]]}function fBe(n,e){var t=CY(n),r=CY(e),i=[t[0]/r[0],t[1]/r[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}function CY(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var KN=it,dBe=OMe("toolbox-dataZoom_"),pBe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,s){this._brushController||(this._brushController=new S4e(i.getZr()),this._brushController.on("brush",zs(this._onBrush,this)).mount()),vBe(t,r,this,s,i),gBe(t,r)},e.prototype.onclick=function(t,r,i){mBe[i].call(this)},e.prototype.remove=function(t,r){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(t,r){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(t){var r=t.areas;if(!t.isEnd||!r.length)return;var i={},s=this.ecModel;this._brushController.updateCovers([]);var a=new ale(O8(this.model),s,{include:["grid"]});a.matchOutputRanges(r,s,function(h,d,m){if(m.type==="cartesian2d"){var v=h.brushType;v==="rect"?(l("x",m,d[0]),l("y",m,d[1])):l({lineX:"x",lineY:"y"}[v],m,d)}}),sBe(s,i),this._dispatchZoomAction(i);function l(h,d,m){var v=d.getAxis(h),y=v.model,S=o(h,y,s),E=S.findRepresentativeAxisProxy(y).getMinMaxSpan();(E.minValueSpan!=null||E.maxValueSpan!=null)&&(m=Lae(0,m.slice(),v.scale.getExtent(),0,E.minValueSpan,E.maxValueSpan)),S&&(i[S.id]={dataZoomId:S.id,startValue:m[0],endValue:m[1]})}function o(h,d,m){var v;return m.eachComponent({mainType:"dataZoom",subType:"select"},function(y){var S=y.getAxisModel(h,d.componentIndex);S&&(v=y)}),v}},e.prototype._dispatchZoomAction=function(t){var r=[];KN(t,function(i,s){r.push(_i(i))}),r.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:r})},e.getDefaultOption=function(t){var r={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return r},e}(zf),mBe={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction(oBe(this.ecModel))}};function O8(n){var e={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}function gBe(n,e){n.setIconStatus("back",lBe(e)>1?"emphasis":"normal")}function vBe(n,e,t,r,i){var s=t._isZoomActive;r&&r.type==="takeGlobalCursor"&&(s=r.key==="dataZoomSelect"?r.dataZoomSelectActive:!1),t._isZoomActive=s,n.setIconStatus("zoom",s?"emphasis":"normal");var a=new ale(O8(n),e,{include:["grid"]}),l=a.makePanelOpts(i,function(o){return o.xAxisDeclared&&!o.yAxisDeclared?"lineX":!o.xAxisDeclared&&o.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(l).enableBrush(s&&l.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}RIe("dataZoom",function(n){var e=n.getComponent("toolbox",0),t=["feature","dataZoom"];if(!e||e.get(t)==null)return;var r=e.getModel(t),i=[],s=O8(r),a=aA(n,s);KN(a.xAxisModels,function(o){return l(o,"xAxis","xAxisIndex")}),KN(a.yAxisModels,function(o){return l(o,"yAxis","yAxisIndex")});function l(o,h,d){var m=o.componentIndex,v={type:"select",$fromToolbox:!0,filterMode:r.get("filterMode",!0)||"filter",id:dBe+h+m};v[d]=m,i.push(v)}return i});function _Be(n){n.registerComponentModel(V5e),n.registerComponentView(j5e),oS("saveAsImage",X5e),oS("magicType",q5e),oS("dataView",rBe),oS("dataZoom",pBe),oS("restore",cBe),mp(G5e)}var yBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(os);function lle(n){var e=n.get("confine");return e!=null?!!e:n.get("renderMode")==="richText"}function cle(n){if(mi.domSupported){for(var e=document.documentElement.style,t=0,r=n.length;t<r;t++)if(n[t]in e)return n[t]}}var ule=cle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xBe=cle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function hle(n,e){if(!n)return e;e=wse(e,!0);var t=n.indexOf(e);return n=t===-1?e:"-"+n.slice(0,t)+"-"+e,n.toLowerCase()}function bBe(n,e){var t=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return t?t[e]:null}var wBe=hle(xBe,"transition"),F8=hle(ule,"transform"),SBe="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(mi.transform3dSupported?"will-change:transform;":"");function ABe(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function TBe(n,e,t){if(!Dr(t)||t==="inside")return"";var r=n.get("backgroundColor"),i=n.get("borderWidth");e=s1(e);var s=ABe(t),a=Math.max(Math.round(i)*1.5,6),l="",o=F8+":",h;Xi(["left","right"],s)>-1?(l+="top:50%",o+="translateY(-50%) rotate("+(h=s==="left"?-225:-45)+"deg)"):(l+="left:50%",o+="translateX(-50%) rotate("+(h=s==="top"?225:45)+"deg)");var d=h*Math.PI/180,m=a+i,v=m*Math.abs(Math.cos(d))+m*Math.abs(Math.sin(d)),y=Math.round(((v-Math.SQRT2*i)/2+Math.SQRT2*i-(v-m)/2)*100)/100;l+=";"+s+":-"+y+"px";var S=e+" solid "+i+"px;",E=["position:absolute;width:"+a+"px;height:"+a+"px;z-index:-1;",l+";"+o+";","border-bottom:"+S,"border-right:"+S,"background-color:"+r+";"];return'<div style="'+E.join("")+'"></div>'}function MBe(n,e){var t="cubic-bezier(0.23,1,0.32,1)",r=" "+n/2+"s "+t,i="opacity"+r+",visibility"+r;return e||(r=" "+n+"s "+t,i+=mi.transformSupported?","+F8+r:",left"+r+",top"+r),wBe+":"+i}function EY(n,e,t){var r=n.toFixed(0)+"px",i=e.toFixed(0)+"px";if(!mi.transformSupported)return t?"top:"+i+";left:"+r+";":[["top",i],["left",r]];var s=mi.transform3dSupported,a="translate"+(s?"3d":"")+"("+r+","+i+(s?",0":"")+")";return t?"top:0;left:0;"+F8+":"+a+";":[["top",0],["left",0],[ule,a]]}function CBe(n){var e=[],t=n.get("fontSize"),r=n.getTextColor();r&&e.push("color:"+r),e.push("font:"+n.getFont()),t&&e.push("line-height:"+Math.round(t*3/2)+"px");var i=n.get("textShadowColor"),s=n.get("textShadowBlur")||0,a=n.get("textShadowOffsetX")||0,l=n.get("textShadowOffsetY")||0;return i&&s&&e.push("text-shadow:"+a+"px "+l+"px "+s+"px "+i),it(["decoration","align"],function(o){var h=n.get(o);h&&e.push("text-"+o+":"+h)}),e.join(";")}function EBe(n,e,t){var r=[],i=n.get("transitionDuration"),s=n.get("backgroundColor"),a=n.get("shadowBlur"),l=n.get("shadowColor"),o=n.get("shadowOffsetX"),h=n.get("shadowOffsetY"),d=n.getModel("textStyle"),m=Jse(n,"html"),v=o+"px "+h+"px "+a+"px "+l;return r.push("box-shadow:"+v),e&&i&&r.push(MBe(i,t)),s&&r.push("background-color:"+s),it(["width","color","radius"],function(y){var S="border-"+y,E=wse(S),M=n.get(E);M!=null&&r.push(S+":"+M+(y==="color"?"":"px"))}),r.push(CBe(d)),m!=null&&r.push("padding:"+JD(m).join("px ")+"px"),r.join(";")+";"}function IY(n,e,t,r,i){var s=e&&e.painter;if(t){var a=s&&s.getViewportRoot();a&&vTe(n,a,t,r,i)}else{n[0]=r,n[1]=i;var l=s&&s.getViewportRootOffset();l&&(n[0]+=l.offsetLeft,n[1]+=l.offsetTop)}n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var IBe=function(){function n(e,t){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,mi.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var i=this._zr=e.getZr(),s=t.appendTo,a=s&&(Dr(s)?document.querySelector(s):nw(s)?s:ci(s)&&s(e.getDom()));IY(this._styleCoord,i,a,e.getWidth()/2,e.getHeight()/2),(a||e.getDom()).appendChild(r),this._api=e,this._container=a;var l=this;r.onmouseenter=function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0},r.onmousemove=function(o){if(o=o||window.event,!l._enterable){var h=i.handler,d=i.painter.getViewportRoot();ph(d,o,!0),h.dispatch("mousemove",o)}},r.onmouseleave=function(){l._inContent=!1,l._enterable&&l._show&&l.hideLater(l._hideDelay)}}return n.prototype.update=function(e){if(!this._container){var t=this._api.getDom(),r=bBe(t,"position"),i=t.style;i.position!=="absolute"&&r!=="absolute"&&(i.position="relative")}var s=e.get("alwaysShowContent");s&&this._moveIfResized(),this._alwaysShowContent=s,this.el.className=e.get("className")||""},n.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var r=this.el,i=r.style,s=this._styleCoord;r.innerHTML?i.cssText=SBe+EBe(e,!this._firstShow,this._longHide)+EY(s[0],s[1],!0)+("border-color:"+s1(t)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(e,t,r,i,s){var a=this.el;if(e==null){a.innerHTML="";return}var l="";if(Dr(s)&&r.get("trigger")==="item"&&!lle(r)&&(l=TBe(r,i,s)),Dr(e))a.innerHTML=e+l;else if(e){a.innerHTML="",fr(e)||(e=[e]);for(var o=0;o<e.length;o++)nw(e[o])&&e[o].parentNode!==a&&a.appendChild(e[o]);if(l&&a.childNodes.length){var h=document.createElement("div");h.innerHTML=l,a.appendChild(h)}}},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},n.prototype.moveTo=function(e,t){var r=this._styleCoord;if(IY(r,this._zr,this._container,e,t),r[0]!=null&&r[1]!=null){var i=this.el.style,s=EY(r[0],r[1]);it(s,function(a){i[a[0]]=a[1]})}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",mi.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(zs(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var e=this.el.parentNode;e&&e.removeChild(this.el),this.el=this._container=null},n}(),RBe=function(){function n(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),PY(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return n.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(e,t,r,i,s){var a=this;Xr(e)&&as(""),this.el&&this._zr.remove(this.el);var l=r.getModel("textStyle");this.el=new Ea({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:l.get("textShadowColor"),fill:r.get(["textStyle","color"]),padding:Jse(r,"richText"),verticalAlign:"top",align:"left"},z:r.get("z")}),it(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(h){a.el.style[h]=r.get(h)}),it(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(h){a.el.style[h]=l.get(h)||0}),this._zr.add(this.el);var o=this;this.el.on("mouseover",function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0}),this.el.on("mouseout",function(){o._enterable&&o._show&&o.hideLater(o._hideDelay),o._inContent=!1})},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),r=RY(e.style);return[t.width+r.left+r.right,t.height+r.top+r.bottom]},n.prototype.moveTo=function(e,t){var r=this.el;if(r){var i=this._styleCoord;PY(i,this._zr,e,t),e=i[0],t=i[1];var s=r.style,a=I0(s.borderWidth||0),l=RY(s);r.x=e+a+l.left,r.y=t+a+l.top,r.markRedraw()}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(zs(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function I0(n){return Math.max(0,n)}function RY(n){var e=I0(n.shadowBlur||0),t=I0(n.shadowOffsetX||0),r=I0(n.shadowOffsetY||0);return{left:I0(e-t),right:I0(e+t),top:I0(e-r),bottom:I0(e+r)}}function PY(n,e,t,r){n[0]=t,n[1]=r,n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var PBe=new Ho({shape:{x:-1,y:-1,width:2,height:2}}),LBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,r){if(!(mi.node||!r.getDom())){var i=t.getComponent("tooltip"),s=this._renderMode=VMe(i.get("renderMode"));this._tooltipContent=s==="richText"?new RBe(r):new IBe(r,{appendTo:i.get("appendToBody",!0)?"body":i.get("appendTo",!0)})}},e.prototype.render=function(t,r,i){if(!(mi.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=t,this._ecModel=r,this._api=i;var s=this._tooltipContent;s.update(t),s.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&t.get("transitionDuration")?eoe(this,"_updatePosition",50,"fixRate"):TN(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel,r=t.get("triggerOn");Kae("itemTooltip",this._api,zs(function(i,s,a){r!=="none"&&(r.indexOf(i)>=0?this._tryShow(s,a):i==="leave"&&this._hide(a))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,r=this._ecModel,i=this._api,s=t.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&s!=="none"&&s!=="click"){var a=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&a.manuallyShowTip(t,r,i,{x:a._lastX,y:a._lastY,dataByCoordSys:a._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,r,i,s){if(!(s.from===this.uid||mi.node||!i.getDom())){var a=LY(s,i);this._ticket="";var l=s.dataByCoordSys,o=OBe(s,r,i);if(o){var h=o.el.getBoundingRect().clone();h.applyTransform(o.el.transform),this._tryShow({offsetX:h.x+h.width/2,offsetY:h.y+h.height/2,target:o.el,position:s.position,positionDefault:"bottom"},a)}else if(s.tooltip&&s.x!=null&&s.y!=null){var d=PBe;d.x=s.x,d.y=s.y,d.update(),Wi(d).tooltipConfig={name:null,option:s.tooltip},this._tryShow({offsetX:s.x,offsetY:s.y,target:d},a)}else if(l)this._tryShow({offsetX:s.x,offsetY:s.y,position:s.position,dataByCoordSys:l,tooltipOption:s.tooltipOption},a);else if(s.seriesIndex!=null){if(this._manuallyAxisShowTip(t,r,i,s))return;var m=Jae(s,r),v=m.point[0],y=m.point[1];v!=null&&y!=null&&this._tryShow({offsetX:v,offsetY:y,target:m.el,position:s.position,positionDefault:"bottom"},a)}else s.x!=null&&s.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:s.x,y:s.y}),this._tryShow({offsetX:s.x,offsetY:s.y,position:s.position,target:i.getZr().findHover(s.x,s.y).target},a))}},e.prototype.manuallyHideTip=function(t,r,i,s){var a=this._tooltipContent;this._tooltipModel&&a.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,s.from!==this.uid&&this._hide(LY(s,i))},e.prototype._manuallyAxisShowTip=function(t,r,i,s){var a=s.seriesIndex,l=s.dataIndex,o=r.getComponent("axisPointer").coordSysAxesInfo;if(!(a==null||l==null||o==null)){var h=r.getSeriesByIndex(a);if(h){var d=h.getData(),m=aS([d.getItemModel(l),h,(h.coordinateSystem||{}).model],this._tooltipModel);if(m.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:a,dataIndex:l,position:s.position}),!0}}},e.prototype._tryShow=function(t,r){var i=t.target,s=this._tooltipModel;if(s){this._lastX=t.offsetX,this._lastY=t.offsetY;var a=t.dataByCoordSys;if(a&&a.length)this._showAxisTooltip(a,t);else if(i){var l=Wi(i);if(l.ssrType==="legend")return;this._lastDataByCoordSys=null;var o,h;RS(i,function(d){if(Wi(d).dataIndex!=null)return o=d,!0;if(Wi(d).tooltipConfig!=null)return h=d,!0},!0),o?this._showSeriesItemTooltip(t,o,r):h?this._showComponentItemTooltip(t,h,r):this._hide(r)}else this._lastDataByCoordSys=null,this._hide(r)}},e.prototype._showOrMove=function(t,r){var i=t.get("showDelay");r=zs(r,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(r,i):r()},e.prototype._showAxisTooltip=function(t,r){var i=this._ecModel,s=this._tooltipModel,a=[r.offsetX,r.offsetY],l=aS([r.tooltipOption],s),o=this._renderMode,h=[],d=dT("section",{blocks:[],noHeader:!0}),m=[],v=new sk;it(t,function(L){it(L.dataByAxis,function(k){var H=i.getComponent(k.axisDim+"Axis",k.axisIndex),q=k.value;if(!(!H||q==null)){var Z=qae(q,H.axis,i,k.seriesDataIndices,k.valueLabelOpt),ee=dT("section",{header:Z,noHeader:!tp(Z),sortBlocks:!0,blocks:[]});d.blocks.push(ee),it(k.seriesDataIndices,function(re){var se=i.getSeriesByIndex(re.seriesIndex),ae=re.dataIndexInside,fe=se.getDataParams(ae);if(!(fe.dataIndex<0)){fe.axisDim=k.axisDim,fe.axisIndex=k.axisIndex,fe.axisType=k.axisType,fe.axisId=k.axisId,fe.axisValue=_8(H.axis,{value:q}),fe.axisValueLabel=Z,fe.marker=v.makeTooltipMarker("item",s1(fe.color),o);var Se=bq(se.formatTooltip(ae,!0,null)),Ce=Se.frag;if(Ce){var Ie=aS([se],s).get("valueFormatter");ee.blocks.push(Ie?Jn({valueFormatter:Ie},Ce):Ce)}Se.text&&m.push(Se.text),h.push(fe)}})}})}),d.blocks.reverse(),m.reverse();var y=r.position,S=l.get("order"),E=Cq(d,v,o,S,i.get("useUTC"),l.get("textStyle"));E&&m.unshift(E);var M=o==="richText"?`

`:"<br/>",C=m.join(M);this._showOrMove(l,function(){this._updateContentNotChangedOnAxis(t,h)?this._updatePosition(l,y,a[0],a[1],this._tooltipContent,h):this._showTooltipContent(l,C,h,Math.random()+"",a[0],a[1],y,null,v)})},e.prototype._showSeriesItemTooltip=function(t,r,i){var s=this._ecModel,a=Wi(r),l=a.seriesIndex,o=s.getSeriesByIndex(l),h=a.dataModel||o,d=a.dataIndex,m=a.dataType,v=h.getData(m),y=this._renderMode,S=t.positionDefault,E=aS([v.getItemModel(d),h,o&&(o.coordinateSystem||{}).model],this._tooltipModel,S?{position:S}:null),M=E.get("trigger");if(!(M!=null&&M!=="item")){var C=h.getDataParams(d,m),L=new sk;C.marker=L.makeTooltipMarker("item",s1(C.color),y);var k=bq(h.formatTooltip(d,!1,m)),H=E.get("order"),q=E.get("valueFormatter"),Z=k.frag,ee=Z?Cq(q?Jn({valueFormatter:q},Z):Z,L,y,H,s.get("useUTC"),E.get("textStyle")):k.text,re="item_"+h.name+"_"+d;this._showOrMove(E,function(){this._showTooltipContent(E,ee,C,re,t.offsetX,t.offsetY,t.position,t.target,L)}),i({type:"showTip",dataIndexInside:d,dataIndex:v.getRawIndex(d),seriesIndex:l,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,r,i){var s=this._renderMode==="html",a=Wi(r),l=a.tooltipConfig,o=l.option||{},h=o.encodeHTMLContent;if(Dr(o)){var d=o;o={content:d,formatter:d},h=!0}h&&s&&o.content&&(o=_i(o),o.content=Pu(o.content));var m=[o],v=this._ecModel.getComponent(a.componentMainType,a.componentIndex);v&&m.push(v),m.push({formatter:o.content});var y=t.positionDefault,S=aS(m,this._tooltipModel,y?{position:y}:null),E=S.get("content"),M=Math.random()+"",C=new sk;this._showOrMove(S,function(){var L=_i(S.get("formatterParams")||{});this._showTooltipContent(S,E,L,M,t.offsetX,t.offsetY,t.position,r,C)}),i({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,r,i,s,a,l,o,h,d){if(this._ticket="",!(!t.get("showContent")||!t.get("show"))){var m=this._tooltipContent;m.setEnterable(t.get("enterable"));var v=t.get("formatter");o=o||t.get("position");var y=r,S=this._getNearestPoint([a,l],i,t.get("trigger"),t.get("borderColor")),E=S.color;if(v)if(Dr(v)){var M=t.ecModel.get("useUTC"),C=fr(i)?i[0]:i,L=C&&C.axisType&&C.axisType.indexOf("time")>=0;y=v,L&&(y=$D(C.axisValue,y,M)),y=Sse(y,i,!0)}else if(ci(v)){var k=zs(function(H,q){H===this._ticket&&(m.setContent(q,d,t,E,o),this._updatePosition(t,o,a,l,m,i,h))},this);this._ticket=s,y=v(i,s,k)}else y=v;m.setContent(y,d,t,E,o),m.show(t,E),this._updatePosition(t,o,a,l,m,i,h)}},e.prototype._getNearestPoint=function(t,r,i,s){if(i==="axis"||fr(r))return{color:s||(this._renderMode==="html"?"#fff":"none")};if(!fr(r))return{color:s||r.color||r.borderColor}},e.prototype._updatePosition=function(t,r,i,s,a,l,o){var h=this._api.getWidth(),d=this._api.getHeight();r=r||t.get("position");var m=a.getSize(),v=t.get("align"),y=t.get("verticalAlign"),S=o&&o.getBoundingRect().clone();if(o&&S.applyTransform(o.transform),ci(r)&&(r=r([i,s],l,a.el,S,{viewSize:[h,d],contentSize:m.slice()})),fr(r))i=ls(r[0],h),s=ls(r[1],d);else if(Xr(r)){var E=r;E.width=m[0],E.height=m[1];var M=_v(E,{width:h,height:d});i=M.x,s=M.y,v=null,y=null}else if(Dr(r)&&o){var C=kBe(r,S,m,t.get("borderWidth"));i=C[0],s=C[1]}else{var C=DBe(i,s,a,h,d,v?null:20,y?null:20);i=C[0],s=C[1]}if(v&&(i-=DY(v)?m[0]/2:v==="right"?m[0]:0),y&&(s-=DY(y)?m[1]/2:y==="bottom"?m[1]:0),lle(t)){var C=BBe(i,s,a,h,d);i=C[0],s=C[1]}a.moveTo(i,s)},e.prototype._updateContentNotChangedOnAxis=function(t,r){var i=this._lastDataByCoordSys,s=this._cbParamsList,a=!!i&&i.length===t.length;return a&&it(i,function(l,o){var h=l.dataByAxis||[],d=t[o]||{},m=d.dataByAxis||[];a=a&&h.length===m.length,a&&it(h,function(v,y){var S=m[y]||{},E=v.seriesDataIndices||[],M=S.seriesDataIndices||[];a=a&&v.value===S.value&&v.axisType===S.axisType&&v.axisId===S.axisId&&E.length===M.length,a&&it(E,function(C,L){var k=M[L];a=a&&C.seriesIndex===k.seriesIndex&&C.dataIndex===k.dataIndex}),s&&it(v.seriesDataIndices,function(C){var L=C.seriesIndex,k=r[L],H=s[L];k&&H&&H.data!==k.data&&(a=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=r,!!a},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,r){mi.node||!r.getDom()||(TN(this,"_updatePosition"),this._tooltipContent.dispose(),qN("itemTooltip",r))},e.type="tooltip",e}(Pc);function aS(n,e,t){var r=e.ecModel,i;t?(i=new Ro(t,r,r),i=new Ro(e.option,i,r)):i=e;for(var s=n.length-1;s>=0;s--){var a=n[s];a&&(a instanceof Ro&&(a=a.get("tooltip",!0)),Dr(a)&&(a={formatter:a}),a&&(i=new Ro(a,i,r)))}return i}function LY(n,e){return n.dispatchAction||zs(e.dispatchAction,e)}function DBe(n,e,t,r,i,s,a){var l=t.getSize(),o=l[0],h=l[1];return s!=null&&(n+o+s+2>r?n-=o+s:n+=s),a!=null&&(e+h+a>i?e-=h+a:e+=a),[n,e]}function BBe(n,e,t,r,i){var s=t.getSize(),a=s[0],l=s[1];return n=Math.min(n+a,r)-a,e=Math.min(e+l,i)-l,n=Math.max(n,0),e=Math.max(e,0),[n,e]}function kBe(n,e,t,r){var i=t[0],s=t[1],a=Math.ceil(Math.SQRT2*r)+8,l=0,o=0,h=e.width,d=e.height;switch(n){case"inside":l=e.x+h/2-i/2,o=e.y+d/2-s/2;break;case"top":l=e.x+h/2-i/2,o=e.y-s-a;break;case"bottom":l=e.x+h/2-i/2,o=e.y+d+a;break;case"left":l=e.x-i-a,o=e.y+d/2-s/2;break;case"right":l=e.x+h+a,o=e.y+d/2-s/2}return[l,o]}function DY(n){return n==="center"||n==="middle"}function OBe(n,e,t){var r=DU(n).queryOptionMap,i=r.keys()[0];if(!(!i||i==="series")){var s=lM(e,i,r.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),a=s.models[0];if(a){var l=t.getViewOfComponentModel(a),o;if(l.group.traverse(function(h){var d=Wi(h).tooltipConfig;if(d&&d.name===n.name)return o=h,!0}),o)return{componentMainType:i,componentIndex:a.componentIndex,el:o}}}}function FBe(n){mp(P8),n.registerComponentModel(yBe),n.registerComponentView(LBe),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Ec),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Ec)}var NBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}(os),zBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){if(this.group.removeAll(),!!t.get("show")){var s=this.group,a=t.getModel("textStyle"),l=t.getModel("subtextStyle"),o=t.get("textAlign"),h=Ei(t.get("textBaseline"),t.get("textVerticalAlign")),d=new Ea({style:Qm(a,{text:t.get("text"),fill:a.getTextColor()},{disableBox:!0}),z2:10}),m=d.getBoundingRect(),v=t.get("subtext"),y=new Ea({style:Qm(l,{text:v,fill:l.getTextColor(),y:m.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),S=t.get("link"),E=t.get("sublink"),M=t.get("triggerEvent",!0);d.silent=!S&&!M,y.silent=!E&&!M,S&&d.on("click",function(){rq(S,"_"+t.get("target"))}),E&&y.on("click",function(){rq(E,"_"+t.get("subtarget"))}),Wi(d).eventData=Wi(y).eventData=M?{componentType:"title",componentIndex:t.componentIndex}:null,s.add(d),v&&s.add(y);var C=s.getBoundingRect(),L=t.getBoxLayoutParams();L.width=C.width,L.height=C.height;var k=_v(L,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));o||(o=t.get("left")||t.get("right"),o==="middle"&&(o="center"),o==="right"?k.x+=k.width:o==="center"&&(k.x+=k.width/2)),h||(h=t.get("top")||t.get("bottom"),h==="center"&&(h="middle"),h==="bottom"?k.y+=k.height:h==="middle"&&(k.y+=k.height/2),h=h||"top"),s.x=k.x,s.y=k.y,s.markRedraw();var H={align:o,verticalAlign:h};d.setStyle(H),y.setStyle(H),C=s.getBoundingRect();var q=k.margin,Z=t.getItemStyle(["color","opacity"]);Z.fill=t.get("backgroundColor");var ee=new Ho({shape:{x:C.x-q[3],y:C.y-q[0],width:C.width+q[1]+q[3],height:C.height+q[0]+q[2],r:t.get("borderRadius")},style:Z,subPixelOptimize:!0,silent:!0});s.add(ee)}},e.type="title",e}(Pc);function UBe(n){n.registerComponentModel(NBe),n.registerComponentView(zBe)}var GBe=function(n,e){if(e==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(e==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},JN=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),this._updateSelector(t)},e.prototype._updateSelector=function(t){var r=t.selector,i=this.ecModel;r===!0&&(r=t.selector=["all","inverse"]),fr(r)&&it(r,function(s,a){Dr(s)&&(s={type:s}),r[a]=Di(s,GBe(i,s.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var r=!1,i=0;i<t.length;i++){var s=t[i].get("name");if(this.isSelected(s)){this.select(s),r=!0;break}}!r&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var r=[],i=[];t.eachRawSeries(function(o){var h=o.name;i.push(h);var d;if(o.legendVisualProvider){var m=o.legendVisualProvider,v=m.getAllNames();t.isSeriesFiltered(o)||(i=i.concat(v)),v.length?r=r.concat(v):d=!0}else d=!0;d&&LU(o)&&r.push(o.name)}),this._availableNames=i;var s=this.get("data")||r,a=ii(),l=xr(s,function(o){return(Dr(o)||Rs(o))&&(o={name:o}),a.get(o.name)?null:(a.set(o.name,!0),new Ro(o,this,this.ecModel))},this);this._data=na(l,function(o){return!!o})},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var r=this.option.selected,i=this.get("selectedMode");if(i==="single"){var s=this._data;it(s,function(a){r[a.get("name")]=!1})}r[t]=!0},e.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var r=this.option.selected;r.hasOwnProperty(t)||(r[t]=!0),this[r[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,r=this.option.selected;it(t,function(i){r[i.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this._data,r=this.option.selected;it(t,function(i){var s=i.get("name",!0);r.hasOwnProperty(s)||(r[s]=!0),r[s]=!r[s]})},e.prototype.isSelected=function(t){var r=this.option.selected;return!(r.hasOwnProperty(t)&&!r[t])&&Xi(this._availableNames,t)>=0},e.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(os),Ux=vs,QN=it,mI=ma,fle=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!1,t}return e.prototype.init=function(){this.group.add(this._contentGroup=new mI),this.group.add(this._selectorGroup=new mI),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,r,i){var s=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var a=t.get("align"),l=t.get("orient");(!a||a==="auto")&&(a=t.get("left")==="right"&&l==="vertical"?"right":"left");var o=t.get("selector",!0),h=t.get("selectorPosition",!0);o&&(!h||h==="auto")&&(h=l==="horizontal"?"end":"start"),this.renderInner(a,t,r,i,o,l,h);var d=t.getBoxLayoutParams(),m={width:i.getWidth(),height:i.getHeight()},v=t.get("padding"),y=_v(d,m,v),S=this.layoutInner(t,a,y,s,o,h),E=_v(ti({width:S.width,height:S.height},d),m,v);this.group.x=E.x-S.x,this.group.y=E.y-S.y,this.group.markRedraw(),this.group.add(this._backgroundEl=ile(S,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,r,i,s,a,l,o){var h=this.getContentGroup(),d=ii(),m=r.get("selectedMode"),v=[];i.eachRawSeries(function(y){!y.get("legendHoverLink")&&v.push(y.id)}),QN(r.getData(),function(y,S){var E=y.get("name");if(!this.newlineDisabled&&(E===""||E===`
`)){var M=new mI;M.newline=!0,h.add(M);return}var C=i.getSeriesByName(E)[0];if(!d.get(E))if(C){var L=C.getData(),k=L.getVisual("legendLineStyle")||{},H=L.getVisual("legendIcon"),q=L.getVisual("style"),Z=this._createItem(C,E,S,y,r,t,k,q,H,m,s);Z.on("click",Ux(BY,E,null,s,v)).on("mouseover",Ux(ez,C.name,null,s,v)).on("mouseout",Ux(tz,C.name,null,s,v)),i.ssr&&Z.eachChild(function(ee){var re=Wi(ee);re.seriesIndex=C.seriesIndex,re.dataIndex=S,re.ssrType="legend"}),d.set(E,!0)}else i.eachRawSeries(function(ee){if(!d.get(E)&&ee.legendVisualProvider){var re=ee.legendVisualProvider;if(!re.containName(E))return;var se=re.indexOfName(E),ae=re.getItemVisual(se,"style"),fe=re.getItemVisual(se,"legendIcon"),Se=Fm(ae.fill);Se&&Se[3]===0&&(Se[3]=.2,ae=Jn(Jn({},ae),{fill:RD(Se,"rgba")}));var Ce=this._createItem(ee,E,S,y,r,t,{},ae,fe,m,s);Ce.on("click",Ux(BY,null,E,s,v)).on("mouseover",Ux(ez,null,E,s,v)).on("mouseout",Ux(tz,null,E,s,v)),i.ssr&&Ce.eachChild(function(Ie){var je=Wi(Ie);je.seriesIndex=ee.seriesIndex,je.dataIndex=S,je.ssrType="legend"}),d.set(E,!0)}},this)},this),a&&this._createSelector(a,r,s,l,o)},e.prototype._createSelector=function(t,r,i,s,a){var l=this.getSelectorGroup();QN(t,function(h){var d=h.type,m=new Ea({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:d==="all"?"legendAllSelect":"legendInverseSelect"})}});l.add(m);var v=r.getModel("selectorLabel"),y=r.getModel(["emphasis","selectorLabel"]);cM(m,{normal:v,emphasis:y},{defaultText:h.title}),fN(m)})},e.prototype._createItem=function(t,r,i,s,a,l,o,h,d,m,v){var y=t.visualDrawType,S=a.get("itemWidth"),E=a.get("itemHeight"),M=a.isSelected(r),C=s.get("symbolRotate"),L=s.get("symbolKeepAspect"),k=s.get("icon");d=k||d||"roundRect";var H=VBe(d,s,o,h,y,M,v),q=new mI,Z=s.getModel("textStyle");if(ci(t.getLegendIcon)&&(!k||k==="inherit"))q.add(t.getLegendIcon({itemWidth:S,itemHeight:E,icon:d,iconRotate:C,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}));else{var ee=k==="inherit"&&t.getData().getVisual("symbol")?C==="inherit"?t.getData().getVisual("symbolRotate"):C:0;q.add(HBe({itemWidth:S,itemHeight:E,icon:d,iconRotate:ee,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}))}var re=l==="left"?S+5:-5,se=l,ae=a.get("formatter"),fe=r;Dr(ae)&&ae?fe=ae.replace("{name}",r??""):ci(ae)&&(fe=ae(r));var Se=M?Z.getTextColor():s.get("inactiveColor");q.add(new Ea({style:Qm(Z,{text:fe,x:re,y:E/2,fill:Se,align:se,verticalAlign:"middle"},{inheritColor:Se})}));var Ce=new Ho({shape:q.getBoundingRect(),style:{fill:"transparent"}}),Ie=s.getModel("tooltip");return Ie.get("show")&&jD({el:Ce,componentModel:a,itemName:r,itemTooltipOption:Ie.option}),q.add(Ce),q.eachChild(function(je){je.silent=!0}),Ce.silent=!m,this.getContentGroup().add(q),fN(q),q.__legendDataIndex=i,q},e.prototype.layoutInner=function(t,r,i,s,a,l){var o=this.getContentGroup(),h=this.getSelectorGroup();Ub(t.get("orient"),o,t.get("itemGap"),i.width,i.height);var d=o.getBoundingRect(),m=[-d.x,-d.y];if(h.markRedraw(),o.markRedraw(),a){Ub("horizontal",h,t.get("selectorItemGap",!0));var v=h.getBoundingRect(),y=[-v.x,-v.y],S=t.get("selectorButtonGap",!0),E=t.getOrient().index,M=E===0?"width":"height",C=E===0?"height":"width",L=E===0?"y":"x";l==="end"?y[E]+=d[M]+S:m[E]+=v[M]+S,y[1-E]+=d[C]/2-v[C]/2,h.x=y[0],h.y=y[1],o.x=m[0],o.y=m[1];var k={x:0,y:0};return k[M]=d[M]+S+v[M],k[C]=Math.max(d[C],v[C]),k[L]=Math.min(0,v[L]+y[1-E]),k}else return o.x=m[0],o.y=m[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(Pc);function VBe(n,e,t,r,i,s,a){function l(M,C){M.lineWidth==="auto"&&(M.lineWidth=C.lineWidth>0?2:0),QN(M,function(L,k){M[k]==="inherit"&&(M[k]=C[k])})}var o=e.getModel("itemStyle"),h=o.getItemStyle(),d=n.lastIndexOf("empty",0)===0?"fill":"stroke",m=o.getShallow("decal");h.decal=!m||m==="inherit"?r.decal:RN(m,a),h.fill==="inherit"&&(h.fill=r[i]),h.stroke==="inherit"&&(h.stroke=r[d]),h.opacity==="inherit"&&(h.opacity=(i==="fill"?r:t).opacity),l(h,r);var v=e.getModel("lineStyle"),y=v.getLineStyle();if(l(y,t),h.fill==="auto"&&(h.fill=r.fill),h.stroke==="auto"&&(h.stroke=r.fill),y.stroke==="auto"&&(y.stroke=r.fill),!s){var S=e.get("inactiveBorderWidth"),E=h[d];h.lineWidth=S==="auto"?r.lineWidth>0&&E?2:0:h.lineWidth,h.fill=e.get("inactiveColor"),h.stroke=e.get("inactiveBorderColor"),y.stroke=v.get("inactiveColor"),y.lineWidth=v.get("inactiveWidth")}return{itemStyle:h,lineStyle:y}}function HBe(n){var e=n.icon||"roundRect",t=aw(e,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),e.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill="#fff",t.style.lineWidth=2),t}function BY(n,e,t,r){tz(n,e,t,r),t.dispatchAction({type:"legendToggleSelect",name:n??e}),ez(n,e,t,r)}function dle(n){for(var e=n.getZr().storage.getDisplayList(),t,r=0,i=e.length;r<i&&!(t=e[r].states.emphasis);)r++;return t&&t.hoverLayer}function ez(n,e,t,r){dle(t)||t.dispatchAction({type:"highlight",seriesName:n,name:e,excludeSeriesId:r})}function tz(n,e,t,r){dle(t)||t.dispatchAction({type:"downplay",seriesName:n,name:e,excludeSeriesId:r})}function jBe(n){var e=n.findComponents({mainType:"legend"});e&&e.length&&n.filterSeries(function(t){for(var r=0;r<e.length;r++)if(!e[r].isSelected(t.name))return!1;return!0})}function lS(n,e,t){var r={},i=n==="toggleSelected",s;return t.eachComponent("legend",function(a){i&&s!=null?a[s?"select":"unSelect"](e.name):n==="allSelect"||n==="inverseSelect"?a[n]():(a[n](e.name),s=a.isSelected(e.name));var l=a.getData();it(l,function(o){var h=o.get("name");if(!(h===`
`||h==="")){var d=a.isSelected(h);r.hasOwnProperty(h)?r[h]=r[h]&&d:r[h]=d}})}),n==="allSelect"||n==="inverseSelect"?{selected:r}:{name:e.name,selected:r}}function WBe(n){n.registerAction("legendToggleSelect","legendselectchanged",vs(lS,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",vs(lS,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",vs(lS,"inverseSelect")),n.registerAction("legendSelect","legendselected",vs(lS,"select")),n.registerAction("legendUnSelect","legendunselected",vs(lS,"unSelect"))}function ple(n){n.registerComponentModel(JN),n.registerComponentView(fle),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,jBe),n.registerSubTypeDefaulter("legend",function(){return"plain"}),WBe(n)}var XBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(t,r,i){var s=QD(t);n.prototype.init.call(this,t,r,i),kY(this,t,s)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),kY(this,this.option,t)},e.type="legend.scroll",e.defaultOption=use(JN.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(JN);function kY(n,e,t){var r=n.getOrient(),i=[1,1];i[r.index]=0,sw(e,t,{type:"box",ignoreSize:!!i})}var OY=ma,Bk=["width","height"],kk=["x","y"],$Be=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!0,t._currentIndex=0,t}return e.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new OY),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new OY)},e.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(t,r,i,s,a,l,o){var h=this;n.prototype.renderInner.call(this,t,r,i,s,a,l,o);var d=this._controllerGroup,m=r.get("pageIconSize",!0),v=fr(m)?m:[m,m];S("pagePrev",0);var y=r.getModel("pageTextStyle");d.add(new Ea({name:"pageText",style:{text:"xx/xx",fill:y.getTextColor(),font:y.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),S("pageNext",1);function S(E,M){var C=E+"DataIndex",L=HD(r.get("pageIcons",!0)[r.getOrient().name][M],{onclick:zs(h._pageGo,h,C,r,s)},{x:-v[0]/2,y:-v[1]/2,width:v[0],height:v[1]});L.name=E,d.add(L)}},e.prototype.layoutInner=function(t,r,i,s,a,l){var o=this.getSelectorGroup(),h=t.getOrient().index,d=Bk[h],m=kk[h],v=Bk[1-h],y=kk[1-h];a&&Ub("horizontal",o,t.get("selectorItemGap",!0));var S=t.get("selectorButtonGap",!0),E=o.getBoundingRect(),M=[-E.x,-E.y],C=_i(i);a&&(C[d]=i[d]-E[d]-S);var L=this._layoutContentAndController(t,s,C,h,d,v,y,m);if(a){if(l==="end")M[h]+=L[d]+S;else{var k=E[d]+S;M[h]-=k,L[m]-=k}L[d]+=E[d]+S,M[1-h]+=L[y]+L[v]/2-E[v]/2,L[v]=Math.max(L[v],E[v]),L[y]=Math.min(L[y],E[y]+M[1-h]),o.x=M[0],o.y=M[1],o.markRedraw()}return L},e.prototype._layoutContentAndController=function(t,r,i,s,a,l,o,h){var d=this.getContentGroup(),m=this._containerGroup,v=this._controllerGroup;Ub(t.get("orient"),d,t.get("itemGap"),s?i.width:null,s?null:i.height),Ub("horizontal",v,t.get("pageButtonItemGap",!0));var y=d.getBoundingRect(),S=v.getBoundingRect(),E=this._showController=y[a]>i[a],M=[-y.x,-y.y];r||(M[s]=d[h]);var C=[0,0],L=[-S.x,-S.y],k=Ei(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(E){var H=t.get("pageButtonPosition",!0);H==="end"?L[s]+=i[a]-S[a]:C[s]+=S[a]+k}L[1-s]+=y[l]/2-S[l]/2,d.setPosition(M),m.setPosition(C),v.setPosition(L);var q={x:0,y:0};if(q[a]=E?i[a]:y[a],q[l]=Math.max(y[l],S[l]),q[o]=Math.min(0,S[o]+L[1-s]),m.__rectSize=i[a],E){var Z={x:0,y:0};Z[a]=Math.max(i[a]-S[a]-k,0),Z[l]=q[l],m.setClipPath(new Ho({shape:Z})),m.__rectSize=Z[a]}else v.eachChild(function(re){re.attr({invisible:!0,silent:!0})});var ee=this._getPageInfo(t);return ee.pageIndex!=null&&ol(d,{x:ee.contentPosition[0],y:ee.contentPosition[1]},E?t:null),this._updatePageInfoView(t,ee),q},e.prototype._pageGo=function(t,r,i){var s=this._getPageInfo(r)[t];s!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:s,legendId:r.id})},e.prototype._updatePageInfoView=function(t,r){var i=this._controllerGroup;it(["pagePrev","pageNext"],function(d){var m=d+"DataIndex",v=r[m]!=null,y=i.childOfName(d);y&&(y.setStyle("fill",v?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),y.cursor=v?"pointer":"default")});var s=i.childOfName("pageText"),a=t.get("pageFormatter"),l=r.pageIndex,o=l!=null?l+1:0,h=r.pageCount;s&&a&&s.setStyle("text",Dr(a)?a.replace("{current}",o==null?"":o+"").replace("{total}",h==null?"":h+""):a({current:o,total:h}))},e.prototype._getPageInfo=function(t){var r=t.get("scrollDataIndex",!0),i=this.getContentGroup(),s=this._containerGroup.__rectSize,a=t.getOrient().index,l=Bk[a],o=kk[a],h=this._findTargetItemIndex(r),d=i.children(),m=d[h],v=d.length,y=v?1:0,S={contentPosition:[i.x,i.y],pageCount:y,pageIndex:y-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!m)return S;var E=H(m);S.contentPosition[a]=-E.s;for(var M=h+1,C=E,L=E,k=null;M<=v;++M)k=H(d[M]),(!k&&L.e>C.s+s||k&&!q(k,C.s))&&(L.i>C.i?C=L:C=k,C&&(S.pageNextDataIndex==null&&(S.pageNextDataIndex=C.i),++S.pageCount)),L=k;for(var M=h-1,C=E,L=E,k=null;M>=-1;--M)k=H(d[M]),(!k||!q(L,k.s))&&C.i<L.i&&(L=C,S.pagePrevDataIndex==null&&(S.pagePrevDataIndex=C.i),++S.pageCount,++S.pageIndex),C=k;return S;function H(Z){if(Z){var ee=Z.getBoundingRect(),re=ee[o]+Z[o];return{s:re,e:re+ee[l],i:Z.__legendDataIndex}}}function q(Z,ee){return Z.e>=ee&&Z.s<=ee+s}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var r,i=this.getContentGroup(),s;return i.eachChild(function(a,l){var o=a.__legendDataIndex;s==null&&o!=null&&(s=l),o===t&&(r=l)}),r??s},e.type="legend.scroll",e}(fle);function qBe(n){n.registerAction("legendScroll","legendscroll",function(e,t){var r=e.scrollDataIndex;r!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(i){i.setScrollDataIndex(r)})})}function ZBe(n){mp(ple),n.registerComponentModel(XBe),n.registerComponentView($Be),qBe(n)}function YBe(n){mp(ple),mp(ZBe)}var FY={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},KBe=function(){function n(e){var t=this._condVal=Dr(e)?new RegExp(e):rTe(e)?e:null;if(t==null){var r="";as(r)}}return n.prototype.evaluate=function(e){var t=typeof e;return Dr(t)?this._condVal.test(e):Rs(t)?this._condVal.test(e+""):!1},n}(),JBe=function(){function n(){}return n.prototype.evaluate=function(){return this.value},n}(),QBe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(!e[t].evaluate())return!1;return!0},n}(),eke=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(e[t].evaluate())return!0;return!1},n}(),tke=function(){function n(){}return n.prototype.evaluate=function(){return!this.child.evaluate()},n}(),nke=function(){function n(){}return n.prototype.evaluate=function(){for(var e=!!this.valueParser,t=this.getValue,r=t(this.valueGetterParam),i=e?this.valueParser(r):null,s=0;s<this.subCondList.length;s++)if(!this.subCondList[s].evaluate(e?i:r))return!1;return!0},n}();function N8(n,e){if(n===!0||n===!1){var t=new JBe;return t.value=n,t}var r="";return mle(n)||as(r),n.and?NY("and",n,e):n.or?NY("or",n,e):n.not?rke(n,e):ike(n,e)}function NY(n,e,t){var r=e[n],i="";fr(r)||as(i),r.length||as(i);var s=n==="and"?new QBe:new eke;return s.children=xr(r,function(a){return N8(a,t)}),s.children.length||as(i),s}function rke(n,e){var t=n.not,r="";mle(t)||as(r);var i=new tke;return i.child=N8(t,e),i.child||as(r),i}function ike(n,e){for(var t="",r=e.prepareGetValue(n),i=[],s=so(n),a=n.parser,l=a?Use(a):null,o=0;o<s.length;o++){var h=s[o];if(!(h==="parser"||e.valueGetterAttrMap.get(h))){var d=Ym(FY,h)?FY[h]:h,m=n[h],v=l?l(m):m,y=fRe(d,v)||d==="reg"&&new KBe(v);y||as(t),i.push(y)}}i.length||as(t);var S=new nke;return S.valueGetterParam=r,S.valueParser=l,S.getValue=e.getValue,S.subCondList=i,S}function mle(n){return Xr(n)&&!Ic(n)}var ske=function(){function n(e,t){this._cond=N8(e,t)}return n.prototype.evaluate=function(){return this._cond.evaluate()},n}();function oke(n,e){return new ske(n,e)}var ake={type:"echarts:filter",transform:function(n){for(var e=n.upstream,t,r=oke(n.config,{valueGetterAttrMap:ii({dimension:!0}),prepareGetValue:function(l){var o="",h=l.dimension;Ym(l,"dimension")||as(o);var d=e.getDimensionInfo(h);return d||as(o),{dimIdx:d.index}},getValue:function(l){return e.retrieveValueFromItem(t,l.dimIdx)}}),i=[],s=0,a=e.count();s<a;s++)t=e.getRawDataItem(s),r.evaluate()&&i.push(t);return{data:i}}},lke={type:"echarts:sort",transform:function(n){var e=n.upstream,t=n.config,r="",i=pa(t);i.length||as(r);var s=[];it(i,function(d){var m=d.dimension,v=d.order,y=d.parser,S=d.incomparable;if(m==null&&as(r),v!=="asc"&&v!=="desc"&&as(r),S&&S!=="min"&&S!=="max"){var E="";as(E)}if(v!=="asc"&&v!=="desc"){var M="";as(M)}var C=e.getDimensionInfo(m);C||as(r);var L=y?Use(y):null;y&&!L&&as(r),s.push({dimIdx:C.index,parser:L,comparator:new Vse(v,S)})});var a=e.sourceFormat;a!==Rc&&a!==Nh&&as(r);for(var l=[],o=0,h=e.count();o<h;o++)l.push(e.getRawDataItem(o));return l.sort(function(d,m){for(var v=0;v<s.length;v++){var y=s[v],S=e.retrieveValueFromItem(d,y.dimIdx),E=e.retrieveValueFromItem(m,y.dimIdx);y.parser&&(S=y.parser(S),E=y.parser(E));var M=y.comparator.evaluate(S,E);if(M!==0)return M}return 0}),{data:l}}};function cke(n){n.registerTransform(ake),n.registerTransform(lke)}var uke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.prototype.init=function(t,r,i){n.prototype.init.call(this,t,r,i),this._sourceManager=new Xse(this),Tq(this)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),Tq(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:up},e}(os),hke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.type="dataset",e}(Pc);function fke(n){n.registerComponentModel(uke),n.registerComponentView(hke)}var $d=Jm.CMD;function Ab(n,e){return Math.abs(n-e)<1e-5}function nz(n){var e=n.data,t=n.len(),r=[],i,s=0,a=0,l=0,o=0;function h(Ce,Ie){i&&i.length>2&&r.push(i),i=[Ce,Ie]}function d(Ce,Ie,je,Le){Ab(Ce,je)&&Ab(Ie,Le)||i.push(Ce,Ie,je,Le,je,Le)}function m(Ce,Ie,je,Le,ot,ye){var $e=Math.abs(Ie-Ce),Ve=Math.tan($e/4)*4/3,_t=Ie<Ce?-1:1,wt=Math.cos(Ce),Vt=Math.sin(Ce),lt=Math.cos(Ie),Ht=Math.sin(Ie),Qt=wt*ot+je,rn=Vt*ye+Le,jn=lt*ot+je,Bn=Ht*ye+Le,Tn=ot*Ve*_t,Pe=ye*Ve*_t;i.push(Qt-Tn*Vt,rn+Pe*wt,jn+Tn*Ht,Bn-Pe*lt,jn,Bn)}for(var v,y,S,E,M=0;M<t;){var C=e[M++],L=M===1;switch(L&&(s=e[M],a=e[M+1],l=s,o=a,(C===$d.L||C===$d.C||C===$d.Q)&&(i=[l,o])),C){case $d.M:s=l=e[M++],a=o=e[M++],h(l,o);break;case $d.L:v=e[M++],y=e[M++],d(s,a,v,y),s=v,a=y;break;case $d.C:i.push(e[M++],e[M++],e[M++],e[M++],s=e[M++],a=e[M++]);break;case $d.Q:v=e[M++],y=e[M++],S=e[M++],E=e[M++],i.push(s+2/3*(v-s),a+2/3*(y-a),S+2/3*(v-S),E+2/3*(y-E),S,E),s=S,a=E;break;case $d.A:var k=e[M++],H=e[M++],q=e[M++],Z=e[M++],ee=e[M++],re=e[M++]+ee;M+=1;var se=!e[M++];v=Math.cos(ee)*q+k,y=Math.sin(ee)*Z+H,L?(l=v,o=y,h(l,o)):d(s,a,v,y),s=Math.cos(re)*q+k,a=Math.sin(re)*Z+H;for(var ae=(se?-1:1)*Math.PI/2,fe=ee;se?fe>re:fe<re;fe+=ae){var Se=se?Math.max(fe+ae,re):Math.min(fe+ae,re);m(fe,Se,k,H,q,Z)}break;case $d.R:l=s=e[M++],o=a=e[M++],v=l+e[M++],y=o+e[M++],h(v,o),d(v,o,v,y),d(v,y,l,y),d(l,y,l,o),d(l,o,v,o);break;case $d.Z:i&&d(s,a,l,o),s=l,a=o;break}}return i&&i.length>2&&r.push(i),r}function rz(n,e,t,r,i,s,a,l,o,h){if(Ab(n,t)&&Ab(e,r)&&Ab(i,a)&&Ab(s,l)){o.push(a,l);return}var d=2/h,m=d*d,v=a-n,y=l-e,S=Math.sqrt(v*v+y*y);v/=S,y/=S;var E=t-n,M=r-e,C=i-a,L=s-l,k=E*E+M*M,H=C*C+L*L;if(k<m&&H<m){o.push(a,l);return}var q=v*E+y*M,Z=-v*C-y*L,ee=k-q*q,re=H-Z*Z;if(ee<m&&q>=0&&re<m&&Z>=0){o.push(a,l);return}var se=[],ae=[];mv(n,t,i,a,.5,se),mv(e,r,s,l,.5,ae),rz(se[0],ae[0],se[1],ae[1],se[2],ae[2],se[3],ae[3],o,h),rz(se[4],ae[4],se[5],ae[5],se[6],ae[6],se[7],ae[7],o,h)}function dke(n,e){var t=nz(n),r=[];e=e||1;for(var i=0;i<t.length;i++){var s=t[i],a=[],l=s[0],o=s[1];a.push(l,o);for(var h=2;h<s.length;){var d=s[h++],m=s[h++],v=s[h++],y=s[h++],S=s[h++],E=s[h++];rz(l,o,d,m,v,y,S,E,a,e),l=S,o=E}r.push(a)}return r}function gle(n,e,t){var r=n[e],i=n[1-e],s=Math.abs(r/i),a=Math.ceil(Math.sqrt(s*t)),l=Math.floor(t/a);l===0&&(l=1,a=t);for(var o=[],h=0;h<a;h++)o.push(l);var d=a*l,m=t-d;if(m>0)for(var h=0;h<m;h++)o[h%a]+=1;return o}function zY(n,e,t){for(var r=n.r0,i=n.r,s=n.startAngle,a=n.endAngle,l=Math.abs(a-s),o=l*i,h=i-r,d=o>Math.abs(h),m=gle([o,h],d?0:1,e),v=(d?l:h)/m.length,y=0;y<m.length;y++)for(var S=(d?h:l)/m[y],E=0;E<m[y];E++){var M={};d?(M.startAngle=s+v*y,M.endAngle=s+v*(y+1),M.r0=r+S*E,M.r=r+S*(E+1)):(M.startAngle=s+S*E,M.endAngle=s+S*(E+1),M.r0=r+v*y,M.r=r+v*(y+1)),M.clockwise=n.clockwise,M.cx=n.cx,M.cy=n.cy,t.push(M)}}function pke(n,e,t){for(var r=n.width,i=n.height,s=r>i,a=gle([r,i],s?0:1,e),l=s?"width":"height",o=s?"height":"width",h=s?"x":"y",d=s?"y":"x",m=n[l]/a.length,v=0;v<a.length;v++)for(var y=n[o]/a[v],S=0;S<a[v];S++){var E={};E[h]=v*m,E[d]=S*y,E[l]=m,E[o]=y,E.x+=n.x,E.y+=n.y,t.push(E)}}function UY(n,e,t,r){return n*r-t*e}function mke(n,e,t,r,i,s,a,l){var o=t-n,h=r-e,d=a-i,m=l-s,v=UY(d,m,o,h);if(Math.abs(v)<1e-6)return null;var y=n-i,S=e-s,E=UY(y,S,d,m)/v;return E<0||E>1?null:new Jr(E*o+n,E*h+e)}function gke(n,e,t){var r=new Jr;Jr.sub(r,t,e),r.normalize();var i=new Jr;Jr.sub(i,n,e);var s=i.dot(r);return s}function Gx(n,e){var t=n[n.length-1];t&&t[0]===e[0]&&t[1]===e[1]||n.push(e)}function vke(n,e,t){for(var r=n.length,i=[],s=0;s<r;s++){var a=n[s],l=n[(s+1)%r],o=mke(a[0],a[1],l[0],l[1],e.x,e.y,t.x,t.y);o&&i.push({projPt:gke(o,e,t),pt:o,idx:s})}if(i.length<2)return[{points:n},{points:n}];i.sort(function(M,C){return M.projPt-C.projPt});var h=i[0],d=i[i.length-1];if(d.idx<h.idx){var m=h;h=d,d=m}for(var v=[h.pt.x,h.pt.y],y=[d.pt.x,d.pt.y],S=[v],E=[y],s=h.idx+1;s<=d.idx;s++)Gx(S,n[s].slice());Gx(S,y),Gx(S,v);for(var s=d.idx+1;s<=h.idx+r;s++)Gx(E,n[s%r].slice());return Gx(E,v),Gx(E,y),[{points:S},{points:E}]}function GY(n){var e=n.points,t=[],r=[];bie(e,t,r);var i=new cs(t[0],t[1],r[0]-t[0],r[1]-t[1]),s=i.width,a=i.height,l=i.x,o=i.y,h=new Jr,d=new Jr;return s>a?(h.x=d.x=l+s/2,h.y=o,d.y=o+a):(h.y=d.y=o+a/2,h.x=l,d.x=l+s),vke(e,h,d)}function eL(n,e,t,r){if(t===1)r.push(e);else{var i=Math.floor(t/2),s=n(e);eL(n,s[0],i,r),eL(n,s[1],t-i,r)}return r}function _ke(n,e){for(var t=[],r=0;r<e;r++)t.push(zU(n));return t}function yke(n,e){e.setStyle(n.style),e.z=n.z,e.z2=n.z2,e.zlevel=n.zlevel}function xke(n){for(var e=[],t=0;t<n.length;)e.push([n[t++],n[t++]]);return e}function bke(n,e){var t=[],r=n.shape,i;switch(n.type){case"rect":pke(r,e,t),i=Ho;break;case"sector":zY(r,e,t),i=Oh;break;case"circle":zY({r0:0,r:r.r,startAngle:0,endAngle:Math.PI*2,cx:r.cx,cy:r.cy},e,t),i=Oh;break;default:var s=n.getComputedTransform(),a=s?Math.sqrt(Math.max(s[0]*s[0]+s[1]*s[1],s[2]*s[2]+s[3]*s[3])):1,l=xr(dke(n.getUpdatedPathProxy(),a),function(C){return xke(C)}),o=l.length;if(o===0)eL(GY,{points:l[0]},e,t);else if(o===e)for(var h=0;h<o;h++)t.push({points:l[h]});else{var d=0,m=xr(l,function(C){var L=[],k=[];bie(C,L,k);var H=(k[1]-L[1])*(k[0]-L[0]);return d+=H,{poly:C,area:H}});m.sort(function(C,L){return L.area-C.area});for(var v=e,h=0;h<o;h++){var y=m[h];if(v<=0)break;var S=h===o-1?v:Math.ceil(y.area/d*e);S<0||(eL(GY,{points:y.poly},S,t),v-=S)}}i=zD;break}if(!i)return _ke(n,e);for(var E=[],h=0;h<t.length;h++){var M=new i;M.setShape(t[h]),yke(n,M),E.push(M)}return E}function wke(n,e){var t=n.length,r=e.length;if(t===r)return[n,e];for(var i=[],s=[],a=t<r?n:e,l=Math.min(t,r),o=Math.abs(r-t)/6,h=(l-2)/6,d=Math.ceil(o/h)+1,m=[a[0],a[1]],v=o,y=2;y<l;){var S=a[y-2],E=a[y-1],M=a[y++],C=a[y++],L=a[y++],k=a[y++],H=a[y++],q=a[y++];if(v<=0){m.push(M,C,L,k,H,q);continue}for(var Z=Math.min(v,d-1)+1,ee=1;ee<=Z;ee++){var re=ee/Z;mv(S,M,L,H,re,i),mv(E,C,k,q,re,s),S=i[3],E=s[3],m.push(i[1],s[1],i[2],s[2],S,E),M=i[5],C=s[5],L=i[6],k=s[6]}v-=Z-1}return a===n?[m,e]:[n,m]}function VY(n,e){for(var t=n.length,r=n[t-2],i=n[t-1],s=[],a=0;a<e.length;)s[a++]=r,s[a++]=i;return s}function Ske(n,e){for(var t,r,i,s=[],a=[],l=0;l<Math.max(n.length,e.length);l++){var o=n[l],h=e[l],d=void 0,m=void 0;o?h?(t=wke(o,h),d=t[0],m=t[1],r=d,i=m):(m=VY(i||o,o),d=o):(d=VY(r||h,h),m=h),s.push(d),a.push(m)}return[s,a]}function HY(n){for(var e=0,t=0,r=0,i=n.length,s=0,a=i-2;s<i;a=s,s+=2){var l=n[a],o=n[a+1],h=n[s],d=n[s+1],m=l*d-h*o;e+=m,t+=(l+h)*m,r+=(o+d)*m}return e===0?[n[0]||0,n[1]||0]:[t/e/3,r/e/3,e]}function Ake(n,e,t,r){for(var i=(n.length-2)/6,s=1/0,a=0,l=n.length,o=l-2,h=0;h<i;h++){for(var d=h*6,m=0,v=0;v<l;v+=2){var y=v===0?d:(d+v-2)%o+2,S=n[y]-t[0],E=n[y+1]-t[1],M=e[v]-r[0],C=e[v+1]-r[1],L=M-S,k=C-E;m+=L*L+k*k}m<s&&(s=m,a=h)}return a}function Tke(n){for(var e=[],t=n.length,r=0;r<t;r+=2)e[r]=n[t-r-2],e[r+1]=n[t-r-1];return e}function Mke(n,e,t,r){for(var i=[],s,a=0;a<n.length;a++){var l=n[a],o=e[a],h=HY(l),d=HY(o);s==null&&(s=h[2]<0!=d[2]<0);var m=[],v=[],y=0,S=1/0,E=[],M=l.length;s&&(l=Tke(l));for(var C=Ake(l,o,h,d)*6,L=M-2,k=0;k<L;k+=2){var H=(C+k)%L+2;m[k+2]=l[H]-h[0],m[k+3]=l[H+1]-h[1]}m[0]=l[C]-h[0],m[1]=l[C+1]-h[1];for(var q=r/t,Z=-r/2;Z<=r/2;Z+=q){for(var ee=Math.sin(Z),re=Math.cos(Z),se=0,k=0;k<l.length;k+=2){var ae=m[k],fe=m[k+1],Se=o[k]-d[0],Ce=o[k+1]-d[1],Ie=Se*re-Ce*ee,je=Se*ee+Ce*re;E[k]=Ie,E[k+1]=je;var Le=Ie-ae,ot=je-fe;se+=Le*Le+ot*ot}if(se<S){S=se,y=Z;for(var ye=0;ye<E.length;ye++)v[ye]=E[ye]}}i.push({from:m,to:v,fromCp:h,toCp:d,rotation:-y})}return i}function tL(n){return n.__isCombineMorphing}var vle="__mOriginal_";function nL(n,e,t){var r=vle+e,i=n[r]||n[e];n[r]||(n[r]=n[e]);var s=t.replace,a=t.after,l=t.before;n[e]=function(){var o=arguments,h;return l&&l.apply(this,o),s?h=s.apply(this,o):h=i.apply(this,o),a&&a.apply(this,o),h}}function gA(n,e){var t=vle+e;n[t]&&(n[e]=n[t],n[t]=null)}function jY(n,e){for(var t=0;t<n.length;t++)for(var r=n[t],i=0;i<r.length;){var s=r[i],a=r[i+1];r[i++]=e[0]*s+e[2]*a+e[4],r[i++]=e[1]*s+e[3]*a+e[5]}}function _le(n,e){var t=n.getUpdatedPathProxy(),r=e.getUpdatedPathProxy(),i=Ske(nz(t),nz(r)),s=i[0],a=i[1],l=n.getComputedTransform(),o=e.getComputedTransform();function h(){this.transform=null}l&&jY(s,l),o&&jY(a,o),nL(e,"updateTransform",{replace:h}),e.transform=null;var d=Mke(s,a,10,Math.PI),m=[];nL(e,"buildPath",{replace:function(v){for(var y=e.__morphT,S=1-y,E=[],M=0;M<d.length;M++){var C=d[M],L=C.from,k=C.to,H=C.rotation*y,q=C.fromCp,Z=C.toCp,ee=Math.sin(H),re=Math.cos(H);$I(E,q,Z,y);for(var se=0;se<L.length;se+=2){var ae=L[se],fe=L[se+1],Se=k[se],Ce=k[se+1],Ie=ae*S+Se*y,je=fe*S+Ce*y;m[se]=Ie*re-je*ee+E[0],m[se+1]=Ie*ee+je*re+E[1]}var Le=m[0],ot=m[1];v.moveTo(Le,ot);for(var se=2;se<L.length;){var Se=m[se++],Ce=m[se++],ye=m[se++],$e=m[se++],Ve=m[se++],_t=m[se++];Le===Se&&ot===Ce&&ye===Ve&&$e===_t?v.lineTo(Ve,_t):v.bezierCurveTo(Se,Ce,ye,$e,Ve,_t),Le=Ve,ot=_t}}}})}function z8(n,e,t){if(!n||!e)return e;var r=t.done,i=t.during;_le(n,e),e.__morphT=0;function s(){gA(e,"buildPath"),gA(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape()}return e.animateTo({__morphT:1},ti({during:function(a){e.dirtyShape(),i&&i(a)},done:function(){s(),r&&r()}},t)),e}function Cke(n,e,t,r,i,s){var a=16;n=i===t?0:Math.round(32767*(n-t)/(i-t)),e=s===r?0:Math.round(32767*(e-r)/(s-r));for(var l=0,o,h=(1<<a)/2;h>0;h/=2){var d=0,m=0;(n&h)>0&&(d=1),(e&h)>0&&(m=1),l+=h*h*(3*d^m),m===0&&(d===1&&(n=h-1-n,e=h-1-e),o=n,n=e,e=o)}return l}function rL(n){var e=1/0,t=1/0,r=-1/0,i=-1/0,s=xr(n,function(l){var o=l.getBoundingRect(),h=l.getComputedTransform(),d=o.x+o.width/2+(h?h[4]:0),m=o.y+o.height/2+(h?h[5]:0);return e=Math.min(d,e),t=Math.min(m,t),r=Math.max(d,r),i=Math.max(m,i),[d,m]}),a=xr(s,function(l,o){return{cp:l,z:Cke(l[0],l[1],e,t,r,i),path:n[o]}});return a.sort(function(l,o){return l.z-o.z}).map(function(l){return l.path})}function yle(n){return bke(n.path,n.count)}function iz(){return{fromIndividuals:[],toIndividuals:[],count:0}}function Eke(n,e,t){var r=[];function i(q){for(var Z=0;Z<q.length;Z++){var ee=q[Z];tL(ee)?i(ee.childrenRef()):ee instanceof $i&&r.push(ee)}}i(n);var s=r.length;if(!s)return iz();var a=t.dividePath||yle,l=a({path:e,count:s});if(l.length!==s)return console.error("Invalid morphing: unmatched splitted path"),iz();r=rL(r),l=rL(l);for(var o=t.done,h=t.during,d=t.individualDelay,m=new sM,v=0;v<s;v++){var y=r[v],S=l[v];S.parent=e,S.copyTransform(m),d||_le(y,S)}e.__isCombineMorphing=!0,e.childrenRef=function(){return l};function E(q){for(var Z=0;Z<l.length;Z++)l[Z].addSelfToZr(q)}nL(e,"addSelfToZr",{after:function(q){E(q)}}),nL(e,"removeSelfFromZr",{after:function(q){for(var Z=0;Z<l.length;Z++)l[Z].removeSelfFromZr(q)}});function M(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,gA(e,"addSelfToZr"),gA(e,"removeSelfFromZr")}var C=l.length;if(d)for(var L=C,k=function(){L--,L===0&&(M(),o&&o())},v=0;v<C;v++){var H=d?ti({delay:(t.delay||0)+d(v,C,r[v],l[v]),done:k},t):t;z8(r[v],l[v],H)}else e.__morphT=0,e.animateTo({__morphT:1},ti({during:function(q){for(var Z=0;Z<C;Z++){var ee=l[Z];ee.__morphT=e.__morphT,ee.dirtyShape()}h&&h(q)},done:function(){M();for(var q=0;q<n.length;q++)gA(n[q],"updateTransform");o&&o()}},t));return e.__zr&&E(e.__zr),{fromIndividuals:r,toIndividuals:l,count:C}}function Ike(n,e,t){var r=e.length,i=[],s=t.dividePath||yle;function a(y){for(var S=0;S<y.length;S++){var E=y[S];tL(E)?a(E.childrenRef()):E instanceof $i&&i.push(E)}}if(tL(n)){a(n.childrenRef());var l=i.length;if(l<r)for(var o=0,h=l;h<r;h++)i.push(zU(i[o++%l]));i.length=r}else{i=s({path:n,count:r});for(var d=n.getComputedTransform(),h=0;h<i.length;h++)i[h].setLocalTransform(d);if(i.length!==r)return console.error("Invalid morphing: unmatched splitted path"),iz()}i=rL(i),e=rL(e);for(var m=t.individualDelay,h=0;h<r;h++){var v=m?ti({delay:(t.delay||0)+m(h,r,i[h],e[h])},t):t;z8(i[h],e[h],v)}return{fromIndividuals:i,toIndividuals:e,count:e.length}}function WY(n){return fr(n[0])}function XY(n,e){for(var t=[],r=n.length,i=0;i<r;i++)t.push({one:n[i],many:[]});for(var i=0;i<e.length;i++){var s=e[i].length,a=void 0;for(a=0;a<s;a++)t[a%r].many.push(e[i][a])}for(var l=0,i=r-1;i>=0;i--)if(!t[i].many.length){var o=t[l].many;if(o.length<=1)if(l)l=0;else return t;var s=o.length,h=Math.ceil(s/2);t[i].many=o.slice(h,s),t[l].many=o.slice(0,h),l++}return t}var Rke={clone:function(n){for(var e=[],t=1-Math.pow(1-n.path.style.opacity,1/n.count),r=0;r<n.count;r++){var i=zU(n.path);i.setStyle("opacity",t),e.push(i)}return e},split:null};function Ok(n,e,t,r,i,s){if(!n.length||!e.length)return;var a=GD("update",r,i);if(!(a&&a.duration>0))return;var l=r.getModel("universalTransition").get("delay"),o=Object.assign({setToFinal:!0},a),h,d;WY(n)&&(h=n,d=e),WY(e)&&(h=e,d=n);function m(C,L,k,H,q){var Z=C.many,ee=C.one;if(Z.length===1&&!q){var re=L?Z[0]:ee,se=L?ee:Z[0];if(tL(re))m({many:[re],one:se},!0,k,H,!0);else{var ae=l?ti({delay:l(k,H)},o):o;z8(re,se,ae),s(re,se,re,se,ae)}}else for(var fe=ti({dividePath:Rke[t],individualDelay:l&&function(ot,ye,$e,Ve){return l(ot+k,H)}},o),Se=L?Eke(Z,ee,fe):Ike(ee,Z,fe),Ce=Se.fromIndividuals,Ie=Se.toIndividuals,je=Ce.length,Le=0;Le<je;Le++){var ae=l?ti({delay:l(Le,je)},o):o;s(Ce[Le],Ie[Le],L?Z[Le]:C.one,L?C.one:Z[Le],ae)}}for(var v=h?h===n:n.length>e.length,y=h?XY(d,h):XY(v?e:n,[v?n:e]),S=0,E=0;E<y.length;E++)S+=y[E].many.length;for(var M=0,E=0;E<y.length;E++)m(y[E],v,M,S),M+=y[E].many.length}function hy(n){if(!n)return[];if(fr(n)){for(var e=[],t=0;t<n.length;t++)e.push(hy(n[t]));return e}var r=[];return n.traverse(function(i){i instanceof $i&&!i.disableMorphing&&!i.invisible&&!i.ignore&&r.push(i)}),r}var xle=1e4,Pke=0,$Y=1,qY=2,Lke=$s();function Dke(n,e){for(var t=n.dimensions,r=0;r<t.length;r++){var i=n.getDimensionInfo(t[r]);if(i&&i.otherDims[e]===0)return t[r]}}function Bke(n,e,t){var r=n.getDimensionInfo(t),i=r&&r.ordinalMeta;if(r){var s=n.get(r.name,e);return i&&i.categories[s]||s+""}}function ZY(n,e,t,r){var i=r?"itemChildGroupId":"itemGroupId",s=Dke(n,i);if(s){var a=Bke(n,e,s);return a}var l=n.getRawDataItem(e),o=r?"childGroupId":"groupId";if(l&&l[o])return l[o]+"";if(!r)return t||n.getId(e)}function YY(n){var e=[];return it(n,function(t){var r=t.data,i=t.dataGroupId;if(!(r.count()>xle))for(var s=r.getIndices(),a=0;a<s.length;a++)e.push({data:r,groupId:ZY(r,a,i,!1),childGroupId:ZY(r,a,i,!0),divide:t.divide,dataIndex:a})}),e}function Fk(n,e,t){n.traverse(function(r){r instanceof $i&&ql(r,{style:{opacity:0}},e,{dataIndex:t,isFrom:!0})})}function Nk(n){if(n.parent){var e=n.getComputedTransform();n.setLocalTransform(e),n.parent.remove(n)}}function Vx(n){n.stopAnimation(),n.isGroup&&n.traverse(function(e){e.stopAnimation()})}function kke(n,e,t){var r=GD("update",t,e);r&&n.traverse(function(i){if(i instanceof Mw){var s=UEe(i);s&&i.animateFrom({style:s},r)}})}function Oke(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++){var i=n[r],s=e[r];if(i.data.getId(i.dataIndex)!==s.data.getId(s.dataIndex))return!1}return!0}function ble(n,e,t){var r=YY(n),i=YY(e);function s(k,H,q,Z,ee){(q||k)&&H.animateFrom({style:q&&q!==k?Jn(Jn({},q.style),k.style):k.style},ee)}var a=!1,l=Pke,o=ii(),h=ii();r.forEach(function(k){k.groupId&&o.set(k.groupId,!0),k.childGroupId&&h.set(k.childGroupId,!0)});for(var d=0;d<i.length;d++){var m=i[d].groupId;if(h.get(m)){l=$Y;break}var v=i[d].childGroupId;if(v&&o.get(v)){l=qY;break}}function y(k,H){return function(q){var Z=q.data,ee=q.dataIndex;return H?Z.getId(ee):k?l===$Y?q.childGroupId:q.groupId:l===qY?q.childGroupId:q.groupId}}var S=Oke(r,i),E={};if(!S)for(var d=0;d<i.length;d++){var M=i[d],C=M.data.getItemGraphicEl(M.dataIndex);C&&(E[C.id]=!0)}function L(k,H){var q=r[H],Z=i[k],ee=Z.data.hostModel,re=q.data.getItemGraphicEl(q.dataIndex),se=Z.data.getItemGraphicEl(Z.dataIndex);if(re===se){se&&kke(se,Z.dataIndex,ee);return}re&&E[re.id]||se&&(Vx(se),re?(Vx(re),Nk(re),a=!0,Ok(hy(re),hy(se),Z.divide,ee,k,s)):Fk(se,ee,k))}new gT(r,i,y(!0,S),y(!1,S),null,"multiple").update(L).updateManyToOne(function(k,H){var q=i[k],Z=q.data,ee=Z.hostModel,re=Z.getItemGraphicEl(q.dataIndex),se=na(xr(H,function(ae){return r[ae].data.getItemGraphicEl(r[ae].dataIndex)}),function(ae){return ae&&ae!==re&&!E[ae.id]});re&&(Vx(re),se.length?(it(se,function(ae){Vx(ae),Nk(ae)}),a=!0,Ok(hy(se),hy(re),q.divide,ee,k,s)):Fk(re,ee,q.dataIndex))}).updateOneToMany(function(k,H){var q=r[H],Z=q.data.getItemGraphicEl(q.dataIndex);if(!(Z&&E[Z.id])){var ee=na(xr(k,function(se){return i[se].data.getItemGraphicEl(i[se].dataIndex)}),function(se){return se&&se!==Z}),re=i[k[0]].data.hostModel;ee.length&&(it(ee,function(se){return Vx(se)}),Z?(Vx(Z),Nk(Z),a=!0,Ok(hy(Z),hy(ee),q.divide,re,k[0],s)):it(ee,function(se){return Fk(se,re,k[0])}))}}).updateManyToMany(function(k,H){new gT(H,k,function(q){return r[q].data.getId(r[q].dataIndex)},function(q){return i[q].data.getId(i[q].dataIndex)}).update(function(q,Z){L(k[q],H[Z])}).execute()}).execute(),a&&it(e,function(k){var H=k.data,q=H.hostModel,Z=q&&t.getViewOfSeriesModel(q),ee=GD("update",q,0);Z&&q.isAnimationEnabled()&&ee&&ee.duration>0&&Z.group.traverse(function(re){re instanceof $i&&!re.animators.length&&re.animateFrom({style:{opacity:0}},ee)})})}function KY(n){var e=n.getModel("universalTransition").get("seriesKey");return e||n.id}function JY(n){return fr(n)?n.sort().join(","):n}function L0(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function Fke(n,e){var t=ii(),r=ii(),i=ii();return it(n.oldSeries,function(s,a){var l=n.oldDataGroupIds[a],o=n.oldData[a],h=KY(s),d=JY(h);r.set(d,{dataGroupId:l,data:o}),fr(h)&&it(h,function(m){i.set(m,{key:d,dataGroupId:l,data:o})})}),it(e.updatedSeries,function(s){if(s.isUniversalTransitionEnabled()&&s.isAnimationEnabled()){var a=s.get("dataGroupId"),l=s.getData(),o=KY(s),h=JY(o),d=r.get(h);if(d)t.set(h,{oldSeries:[{dataGroupId:d.dataGroupId,divide:L0(d.data),data:d.data}],newSeries:[{dataGroupId:a,divide:L0(l),data:l}]});else if(fr(o)){var m=[];it(o,function(S){var E=r.get(S);E.data&&m.push({dataGroupId:E.dataGroupId,divide:L0(E.data),data:E.data})}),m.length&&t.set(h,{oldSeries:m,newSeries:[{dataGroupId:a,data:l,divide:L0(l)}]})}else{var v=i.get(o);if(v){var y=t.get(v.key);y||(y={oldSeries:[{dataGroupId:v.dataGroupId,data:v.data,divide:L0(v.data)}],newSeries:[]},t.set(v.key,y)),y.newSeries.push({dataGroupId:a,data:l,divide:L0(l)})}}}}),t}function QY(n,e){for(var t=0;t<n.length;t++){var r=e.seriesIndex!=null&&e.seriesIndex===n[t].seriesIndex||e.seriesId!=null&&e.seriesId===n[t].id;if(r)return t}}function Nke(n,e,t,r){var i=[],s=[];it(pa(n.from),function(a){var l=QY(e.oldSeries,a);l>=0&&i.push({dataGroupId:e.oldDataGroupIds[l],data:e.oldData[l],divide:L0(e.oldData[l]),groupIdDim:a.dimension})}),it(pa(n.to),function(a){var l=QY(t.updatedSeries,a);if(l>=0){var o=t.updatedSeries[l].getData();s.push({dataGroupId:e.oldDataGroupIds[l],data:o,divide:L0(o),groupIdDim:a.dimension})}}),i.length>0&&s.length>0&&ble(i,s,r)}function zke(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){it(pa(r.seriesTransition),function(i){it(pa(i.to),function(s){for(var a=r.updatedSeries,l=0;l<a.length;l++)(s.seriesIndex!=null&&s.seriesIndex===a[l].seriesIndex||s.seriesId!=null&&s.seriesId===a[l].id)&&(a[l][sR]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(e,t,r){var i=Lke(t);if(i.oldSeries&&r.updatedSeries&&r.optionChanged){var s=r.seriesTransition;if(s)it(pa(s),function(y){Nke(y,i,r,t)});else{var a=Fke(i,r);it(a.keys(),function(y){var S=a.get(y);ble(S.oldSeries,S.newSeries,t)})}it(r.updatedSeries,function(y){y[sR]&&(y[sR]=!1)})}for(var l=e.getSeries(),o=i.oldSeries=[],h=i.oldDataGroupIds=[],d=i.oldData=[],m=0;m<l.length;m++){var v=l[m].getData();v.count()<xle&&(o.push(l[m]),h.push(l[m].get("dataGroupId")),d.push(v))}})}function eK(n,e,t){var r=Sw.createCanvas(),i=e.getWidth(),s=e.getHeight(),a=r.style;return a&&(a.position="absolute",a.left="0",a.top="0",a.width=i+"px",a.height=s+"px",r.setAttribute("data-zr-dom-id",n)),r.width=i*t,r.height=s*t,r}var zk=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this)||this;s.motionBlur=!1,s.lastFrameAlpha=.7,s.dpr=1,s.virtual=!1,s.config={},s.incremental=!1,s.zlevel=0,s.maxRepaintRectCount=5,s.__dirty=!0,s.__firstTimePaint=!0,s.__used=!1,s.__drawIndex=0,s.__startIndex=0,s.__endIndex=0,s.__prevStartIndex=null,s.__prevEndIndex=null;var a;i=i||RP,typeof t=="string"?a=eK(t,r,i):Xr(t)&&(a=t,t=a.id),s.id=t,s.dom=a;var l=a.style;return l&&(Fre(a),a.onselectstart=function(){return!1},l.padding="0",l.margin="0",l.borderWidth="0"),s.painter=r,s.dpr=i,s}return e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=eK("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),t!==1&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,r,i,s){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var a=[],l=this.maxRepaintRectCount,o=!1,h=new cs(0,0,0,0);function d(L){if(!(!L.isFinite()||L.isZero()))if(a.length===0){var k=new cs(0,0,0,0);k.copy(L),a.push(k)}else{for(var H=!1,q=1/0,Z=0,ee=0;ee<a.length;++ee){var re=a[ee];if(re.intersect(L)){var se=new cs(0,0,0,0);se.copy(re),se.union(L),a[ee]=se,H=!0;break}else if(o){h.copy(L),h.union(re);var ae=L.width*L.height,fe=re.width*re.height,Se=h.width*h.height,Ce=Se-ae-fe;Ce<q&&(q=Ce,Z=ee)}}if(o&&(a[Z].union(L),H=!0),!H){var k=new cs(0,0,0,0);k.copy(L),a.push(k)}o||(o=a.length>=l)}}for(var m=this.__startIndex;m<this.__endIndex;++m){var v=t[m];if(v){var y=v.shouldBePainted(i,s,!0,!0),S=v.__isRendered&&(v.__dirty&Lu||!y)?v.getPrevPaintRect():null;S&&d(S);var E=y&&(v.__dirty&Lu||!v.__isRendered)?v.getPaintRect():null;E&&d(E)}}for(var m=this.__prevStartIndex;m<this.__prevEndIndex;++m){var v=r[m],y=v&&v.shouldBePainted(i,s,!0,!0);if(v&&(!y||!v.__zr)&&v.__isRendered){var S=v.getPrevPaintRect();S&&d(S)}}var M;do{M=!1;for(var m=0;m<a.length;){if(a[m].isZero()){a.splice(m,1);continue}for(var C=m+1;C<a.length;)a[m].intersect(a[C])?(M=!0,a[m].union(a[C]),a.splice(C,1)):C++;m++}}while(M);return this._paintRects=a,a},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(t,r){var i=this.dpr,s=this.dom,a=s.style,l=this.domBack;a&&(a.width=t+"px",a.height=r+"px"),s.width=t*i,s.height=r*i,l&&(l.width=t*i,l.height=r*i,i!==1&&this.ctxBack.scale(i,i))},e.prototype.clear=function(t,r,i){var s=this.dom,a=this.ctx,l=s.width,o=s.height;r=r||this.clearColor;var h=this.motionBlur&&!t,d=this.lastFrameAlpha,m=this.dpr,v=this;h&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(s,0,0,l/m,o/m));var y=this.domBack;function S(E,M,C,L){if(a.clearRect(E,M,C,L),r&&r!=="transparent"){var k=void 0;if(MD(r)){var H=r.global||r.__width===C&&r.__height===L;k=H&&r.__canvasGradient||EN(a,r,{x:0,y:0,width:C,height:L}),r.__canvasGradient=k,r.__width=C,r.__height=L}else nTe(r)&&(r.scaleX=r.scaleX||m,r.scaleY=r.scaleY||m,k=IN(a,r,{dirty:function(){v.setUnpainted(),v.painter.refresh()}}));a.save(),a.fillStyle=k||r,a.fillRect(E,M,C,L),a.restore()}h&&(a.save(),a.globalAlpha=d,a.drawImage(y,E,M,C,L),a.restore())}!i||h?S(0,0,l,o):i.length&&it(i,function(E){S(E.x*m,E.y*m,E.width*m,E.height*m)})},e}(od),tK=1e5,ey=314159,gI=.01,Uke=.001;function Gke(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function Vke(n,e){var t=document.createElement("div");return t.style.cssText=["position:relative","width:"+n+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",t}var Hke=function(){function n(e,t,r,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var s=!e.nodeName||e.nodeName.toUpperCase()==="CANVAS";this._opts=r=Jn({},r||{}),this.dpr=r.devicePixelRatio||RP,this._singleCanvas=s,this.root=e;var a=e.style;a&&(Fre(e),e.innerHTML=""),this.storage=t;var l=this._zlevelList;this._prevDisplayList=[];var o=this._layers;if(s){var d=e,m=d.width,v=d.height;r.width!=null&&(m=r.width),r.height!=null&&(v=r.height),this.dpr=r.devicePixelRatio||1,d.width=m*this.dpr,d.height=v*this.dpr,this._width=m,this._height=v;var y=new zk(d,this,this.dpr);y.__builtin__=!0,y.initContext(),o[ey]=y,y.zlevel=ey,l.push(ey),this._domRoot=e}else{this._width=JE(e,0,r),this._height=JE(e,1,r);var h=this._domRoot=Vke(this._width,this._height);e.appendChild(h)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},n.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),r=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,r,e,this._redrawId);for(var s=0;s<i.length;s++){var a=i[s],l=this._layers[a];if(!l.__builtin__&&l.refresh){var o=s===0?this._backgroundColor:null;l.refresh(o)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(e){var t=e.length,r=this._hoverlayer;if(r&&r.clear(),!!t){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},s,a=0;a<t;a++){var l=e[a];l.__inHover&&(r||(r=this._hoverlayer=this.getLayer(tK)),s||(s=r.ctx,s.save()),Cy(s,l,i,a===t-1))}s&&s.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(tK)},n.prototype.paintOne=function(e,t){foe(e,t)},n.prototype._paintList=function(e,t,r,i){if(this._redrawId===i){r=r||!1,this._updateLayerStatus(e);var s=this._doPaintList(e,t,r),a=s.finished,l=s.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),l&&this._paintHoverList(e),a)this.eachLayer(function(h){h.afterBrush&&h.afterBrush()});else{var o=this;TP(function(){o._paintList(e,t,r,i)})}}},n.prototype._compositeManually=function(){var e=this.getLayer(ey).ctx,t=this._domRoot.width,r=this._domRoot.height;e.clearRect(0,0,t,r),this.eachBuiltinLayer(function(i){i.virtual&&e.drawImage(i.dom,0,0,t,r)})},n.prototype._doPaintList=function(e,t,r){for(var i=this,s=[],a=this._opts.useDirtyRect,l=0;l<this._zlevelList.length;l++){var o=this._zlevelList[l],h=this._layers[o];h.__builtin__&&h!==this._hoverlayer&&(h.__dirty||r)&&s.push(h)}for(var d=!0,m=!1,v=function(E){var M=s[E],C=M.ctx,L=a&&M.createRepaintRects(e,t,y._width,y._height),k=r?M.__startIndex:M.__drawIndex,H=!r&&M.incremental&&Date.now,q=H&&Date.now(),Z=M.zlevel===y._zlevelList[0]?y._backgroundColor:null;if(M.__startIndex===M.__endIndex)M.clear(!1,Z,L);else if(k===M.__startIndex){var ee=e[k];(!ee.incremental||!ee.notClear||r)&&M.clear(!1,Z,L)}k===-1&&(console.error("For some unknown reason. drawIndex is -1"),k=M.__startIndex);var re,se=function(Ce){var Ie={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(re=k;re<M.__endIndex;re++){var je=e[re];if(je.__inHover&&(m=!0),i._doPaintEl(je,M,a,Ce,Ie,re===M.__endIndex-1),H){var Le=Date.now()-q;if(Le>15)break}}Ie.prevElClipPaths&&C.restore()};if(L)if(L.length===0)re=M.__endIndex;else for(var ae=y.dpr,fe=0;fe<L.length;++fe){var Se=L[fe];C.save(),C.beginPath(),C.rect(Se.x*ae,Se.y*ae,Se.width*ae,Se.height*ae),C.clip(),se(Se),C.restore()}else C.save(),se(),C.restore();M.__drawIndex=re,M.__drawIndex<M.__endIndex&&(d=!1)},y=this,S=0;S<s.length;S++)v(S);return mi.wxa&&it(this._layers,function(E){E&&E.ctx&&E.ctx.draw&&E.ctx.draw()}),{finished:d,needsRefreshHover:m}},n.prototype._doPaintEl=function(e,t,r,i,s,a){var l=t.ctx;if(r){var o=e.getPaintRect();(!i||o&&o.intersect(i))&&(Cy(l,e,s,a),e.setPrevPaintRect(o))}else Cy(l,e,s,a)},n.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=ey);var r=this._layers[e];return r||(r=new zk("zr_"+e,this,this.dpr),r.zlevel=e,r.__builtin__=!0,this._layerConfig[e]?Di(r,this._layerConfig[e],!0):this._layerConfig[e-gI]&&Di(r,this._layerConfig[e-gI],!0),t&&(r.virtual=t),this.insertLayer(e,r),r.initContext()),r},n.prototype.insertLayer=function(e,t){var r=this._layers,i=this._zlevelList,s=i.length,a=this._domRoot,l=null,o=-1;if(!r[e]&&Gke(t)){if(s>0&&e>i[0]){for(o=0;o<s-1&&!(i[o]<e&&i[o+1]>e);o++);l=r[i[o]]}if(i.splice(o+1,0,e),r[e]=t,!t.virtual)if(l){var h=l.dom;h.nextSibling?a.insertBefore(t.dom,h.nextSibling):a.appendChild(t.dom)}else a.firstChild?a.insertBefore(t.dom,a.firstChild):a.appendChild(t.dom);t.painter||(t.painter=this)}},n.prototype.eachLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i];e.call(t,this._layers[s],s)}},n.prototype.eachBuiltinLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i],a=this._layers[s];a.__builtin__&&e.call(t,a,s)}},n.prototype.eachOtherLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i],a=this._layers[s];a.__builtin__||e.call(t,a,s)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(e){this.eachBuiltinLayer(function(m,v){m.__dirty=m.__used=!1});function t(m){s&&(s.__endIndex!==m&&(s.__dirty=!0),s.__endIndex=m)}if(this._singleCanvas)for(var r=1;r<e.length;r++){var i=e[r];if(i.zlevel!==e[r-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var s=null,a=0,l,o;for(o=0;o<e.length;o++){var i=e[o],h=i.zlevel,d=void 0;l!==h&&(l=h,a=0),i.incremental?(d=this.getLayer(h+Uke,this._needsManuallyCompositing),d.incremental=!0,a=1):d=this.getLayer(h+(a>0?gI:0),this._needsManuallyCompositing),d.__builtin__||TU("ZLevel "+h+" has been used by unkown layer "+d.id),d!==s&&(d.__used=!0,d.__startIndex!==o&&(d.__dirty=!0),d.__startIndex=o,d.incremental?d.__drawIndex=-1:d.__drawIndex=o,t(o),s=d),i.__dirty&Lu&&!i.__inHover&&(d.__dirty=!0,d.incremental&&d.__drawIndex<0&&(d.__drawIndex=o))}t(o),this.eachBuiltinLayer(function(m,v){!m.__used&&m.getElementCount()>0&&(m.__dirty=!0,m.__startIndex=m.__endIndex=m.__drawIndex=0),m.__dirty&&m.__drawIndex<0&&(m.__drawIndex=m.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(e){e.clear()},n.prototype.setBackgroundColor=function(e){this._backgroundColor=e,it(this._layers,function(t){t.setUnpainted()})},n.prototype.configLayer=function(e,t){if(t){var r=this._layerConfig;r[e]?Di(r[e],t,!0):r[e]=t;for(var i=0;i<this._zlevelList.length;i++){var s=this._zlevelList[i];if(s===e||s===e+gI){var a=this._layers[s];Di(a,r[e],!0)}}}},n.prototype.delLayer=function(e){var t=this._layers,r=this._zlevelList,i=t[e];i&&(i.dom.parentNode.removeChild(i.dom),delete t[e],r.splice(Xi(r,e),1))},n.prototype.resize=function(e,t){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var i=this._opts,s=this.root;if(e!=null&&(i.width=e),t!=null&&(i.height=t),e=JE(s,0,i),t=JE(s,1,i),r.style.display="",this._width!==e||t!==this._height){r.style.width=e+"px",r.style.height=t+"px";for(var a in this._layers)this._layers.hasOwnProperty(a)&&this._layers[a].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(e==null||t==null)return;this._width=e,this._height=t,this.getLayer(ey).resize(e,t)}return this},n.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[ey].dom;var t=new zk("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var r=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var i=t.dom.width,s=t.dom.height;this.eachLayer(function(m){m.__builtin__?r.drawImage(m.dom,0,0,i,s):m.renderToCanvas&&(r.save(),m.renderToCanvas(r),r.restore())})}else for(var a={inHover:!1,viewWidth:this._width,viewHeight:this._height},l=this.storage.getDisplayList(!0),o=0,h=l.length;o<h;o++){var d=l[o];Cy(r,d,a,o===h-1)}return t.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();function jke(n){n.registerPainter("canvas",Hke)}mp([UBe,FBe,t5e,fke,cke,E5e,YBe,_Be,s3e,D3e,x3e,kDe,zke,jke]);const Wke=()=>{let n=null,e=null,t=null,r=null,i=null,s=null,a=Ae.useRef(null),l=[],o=[],h={colors:{base:"#f9f002",gradInner:"#8ae66e",gradOuter:"#03c03c"},reset:()=>{r.reset()}},d={impacts:{value:l},maxSize:{value:.04},minSize:{value:.025},waveHeight:{value:.1},scaling:{value:1},gradInner:{value:new Vn(h.colors.gradInner)},gradOuter:{value:new Vn(h.colors.gradOuter)}},m=10,v=null;const[y,S]=Ae.useState(LAe[new Date().getDay()]),[E,M]=Ae.useState(new Date().toLocaleTimeString()),[C,L]=Ae.useState(!1),[k,H]=Ae.useState(fB[0]),[q,Z]=Ae.useState(!1),ee=Ae.useRef(q),re=new bD,se=new nn;Ae.useEffect(()=>{ae(),Le();for(let wt=0;wt<m;wt++)l.push({impactPosition:new Ze().random().subScalar(.5).setLength(5),impactMaxRadius:5*no.randFloat(.5,.75),impactRatio:0,prevPosition:new Ze().random().subScalar(.5).setLength(5),trailRatio:{value:0},trailLength:{value:0}}),Se(wt);return Ie(),ot(),ye(),window.addEventListener("resize",$e),window.addEventListener("dblclick",Ve,!1),()=>{window.removeEventListener("resize",$e),window.removeEventListener("dblclick",Ve,!1),v&&clearInterval(v)}},[]),Ae.useEffect(()=>{ee.current=q},[q]);const ae=()=>{n=new Tl,e=new ts(45,window.innerWidth/window.innerHeight,.1,50),e.position.set(0,0,15.5),n.add(e),t=new Yl({canvas:a.current,antialias:!0,alpha:!0}),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.render(n,e),r=new Lv(e,t.domElement),r.enableDamping=!0,r.enablePan=!1,s=new SD(t),s.addPass(new AD(n,e)),s.addPass(new RAe)},fe=()=>{let wt=5,Vt=75e3,lt=Math.PI*(3-Math.sqrt(5)),Ht=2/Vt,Qt=1-Ht/2,rn=0,jn=0,Bn=new Ze,Tn=new nT,Pe=new Ri,qe=[],mn=new Kf().load(zAe);for(let Jt=0;Jt<Vt;Jt++){jn=Math.sqrt(1-Qt*Qt),Bn.set(jn*Math.cos(rn),Qt,-jn*Math.sin(rn)).multiplyScalar(wt),Tn.setFromVector3(Bn),rn=rn+lt,Qt=Qt-Ht,Pe.lookAt(Bn),Pe.updateMatrix();let kn=new tg(1,1);kn.applyMatrix4(Pe.matrix),kn.translate(Bn.x,Bn.y,Bn.z);let Gn=[Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z];kn.setAttribute("center",new ar(Gn,3));let sn=new nn((Tn.theta+Math.PI)/(2*Math.PI),1-Tn.phi/Math.PI),at=[sn.x,sn.y,sn.x,sn.y,sn.x,sn.y,sn.x,sn.y];kn.setAttribute("baseUv",new ar(at,2)),qe.push(kn)}let cn=PAe(qe),St=new _o({color:new Vn(h.colors.base),onBeforeCompile:Jt=>{Jt.uniforms.impacts=d.impacts,Jt.uniforms.maxSize=d.maxSize,Jt.uniforms.minSize=d.minSize,Jt.uniforms.waveHeight=d.waveHeight,Jt.uniforms.scaling=d.scaling,Jt.uniforms.gradInner=d.gradInner,Jt.uniforms.gradOuter=d.gradOuter,Jt.uniforms.tex={value:mn},Jt.vertexShader=`
            struct impact {
              vec3 impactPosition;
              float impactMaxRadius;
              float impactRatio;
            };
            uniform impact impacts[${m}];
            uniform sampler2D tex;
            uniform float maxSize;
            uniform float minSize;
            uniform float waveHeight;
            uniform float scaling;

            attribute vec3 center;
            attribute vec2 baseUv;

            varying float vFinalStep;
            varying float vMap;

            ${Jt.vertexShader}
          `.replace("#include <begin_vertex>",`#include <begin_vertex>
            float finalStep = 0.0;
            for (int i = 0; i < ${m};i++){
              float dist = distance(center, impacts[i].impactPosition);
              float curRadius = impacts[i].impactMaxRadius * impacts[i].impactRatio;
              float sstep = smoothstep(0., curRadius, dist) - smoothstep(curRadius - ( 0.25 * impacts[i].impactRatio ), curRadius, dist);
              sstep *= 1. - impacts[i].impactRatio;
              finalStep += sstep;
            }
            finalStep = clamp(finalStep, 0., 1.);
            vFinalStep = finalStep;

            float map = texture(tex, baseUv).g;
            vMap = map;
            float pSize = map < 0.5 ? maxSize : minSize;
            float scale = scaling;

            transformed = (position - center) * pSize * mix(1., scale * 1.25, finalStep) + center; // scale on wave
            transformed += normal * finalStep * waveHeight; // lift on wave
            `),Jt.fragmentShader=`
            uniform vec3 gradInner;
            uniform vec3 gradOuter;
            varying float vFinalStep;
            varying float vMap;
            ${Jt.fragmentShader}
            `.replace("vec4 diffuseColor = vec4( diffuse, opacity );",`
            // shaping the point, pretty much from The Book of Shaders
            vec2 hUv = (vUv - 0.5);
            int N = 8;
            float a = atan(hUv.x,hUv.y); 
            float r = PI2/float(N);
            float d = cos(floor(.5+a/r)*r-a)*length(hUv);
            float f = cos(PI / float(N)) * 0.5;
            if (d > f) discard;

            vec3 grad = mix(gradInner, gradOuter, clamp( d / f, 0., 1.)); // gradient
            vec3 diffuseMap = diffuse * ((vMap > 0.5) ? 0.5 : 1.);
            vec3 col = mix(diffuseMap, grad, vFinalStep); // color on wave
            if (!gl_FrontFacing) col *= 0.25; // moderate the color on backside
            vec4 diffuseColor = vec4( col , opacity );
            `)}});St.defines={USE_UV:""},i=new Ii(cn,St),i.rotation.y=Math.PI,o.forEach(Jt=>i.add(Jt)),i.position.set(0,-.4,0),n.add(i)};function Se(wt){let Vt=new Array(300).fill(0),lt=new $r;lt.setAttribute("position",new ar(Vt,3));let Ht=new tU({color:h.colors.gradOuter,transparent:!0,onBeforeCompile:rn=>{rn.uniforms.actionRatio=l[wt].trailRatio,rn.uniforms.lineLength=l[wt].trailLength,rn.fragmentShader=UAe}}),Qt=new Yf(lt,Ht);Qt.userData.idx=wt,Ce(Qt,l[wt].prevPosition,l[wt].impactPosition),o.push(Qt)}const Ce=(wt,Vt,lt,Ht,Qt)=>{let rn=wt.geometry.attributes.position,jn=rn.count-1,Bn=1,Tn=1,Pe=Vt.length(),qe=Vt.angleTo(lt),cn=Pe*qe/Math.PI,St=cn/2/Bn,Jt=Tn/cn,kn=Pe+St,Gn=new Ze().copy(Vt).setLength(kn),sn=new Ze().copy(Vt).negate().setLength(St),at=new H0(Vt,lt,new Ze),Ue=new Ze;at.getNormal(Ue);let $t=new Ze,An=new Ze,Sn=new Ze,jt=new Ze;for(let mr=0;mr<=jn;mr++){let Un=mr/jn,tr=Un*qe;$t.copy(Gn).applyAxisAngle(Ue,tr),An.copy(sn).applyAxisAngle(Ue,tr+Math.PI*2*Un*Bn),Sn.addVectors($t,An);let Sr=(Sn.length()-Pe)*Jt+Pe;jt.copy(Sn).setLength(Sr),rn.setXYZ(mr,jt.x,jt.y,jt.z)}rn.needsUpdate=!0,wt.computeLineDistances(),wt.geometry.attributes.lineDistance.needsUpdate=!0,l[wt.userData.idx].trailLength.value=wt.geometry.attributes.lineDistance.array[99],wt.material.dashSize=3},Ie=()=>{let wt=[];for(let Vt=0;Vt<m;Vt++)wt.push({runTween:()=>{let lt=o[Vt],rn=lt.geometry.attributes.lineDistance.array[99]/3,jn=new tA.Tween({value:0}).to({value:1},rn*1e3).onUpdate(Tn=>{l[Vt].trailRatio.value=Tn.value});var Bn=new tA.Tween({value:0}).to({value:1},no.randInt(2500,5e3)).onUpdate(Tn=>{d.impacts.value[Vt].impactRatio=Tn.value}).onComplete(Tn=>{l[Vt].prevPosition.copy(l[Vt].impactPosition),l[Vt].impactPosition.random().subScalar(.5).setLength(5),Ce(lt,l[Vt].prevPosition,l[Vt].impactPosition),d.impacts.value[Vt].impactMaxRadius=5*no.randFloat(.5,.75),wt[Vt].runTween()});jn.chain(Bn),jn.start()}});wt.forEach(Vt=>Vt.runTween()),fe()};let je=Array.from({length:5}).map(()=>Ae.useRef(null));const Le=()=>{const wt=[BAe,kAe,OAe,FAe,NAe];je.map(lt=>lt.current&&sLe(lt.current,"dark")).forEach((lt,Ht)=>{lt&&lt.setOption(wt[Ht])})},ot=()=>{tA.update(),i.rotation.y+=.001,t&&n&&e&&t.render(n,e),requestAnimationFrame(ot),ee.current&&s.render()},ye=()=>{v=setInterval(()=>{let wt=new Date,Vt=wt.getHours(),lt=wt.getMinutes(),Ht=wt.getSeconds();M(`${Vt<10?"0"+Vt:Vt}:${lt<10?"0"+lt:lt}:${Ht<10?"0"+Ht:Ht}`)},1e3)},$e=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),s.setSize(window.innerWidth,window.innerHeight)},Ve=wt=>{se.x=wt.clientX/window.innerWidth*2-1,se.y=-wt.clientY/window.innerHeight*2+1,re.setFromCamera(se,e),re.intersectObjects(i.children).length>0&&(L(!0),H(fB[no.randInt(0,fB.length-1)]))},_t=()=>{Z(!q)};return me.jsx("div",{className:"earth-digital bg-black h-screen w-full overflow-hidden select-none",children:me.jsxs("div",{className:"p-0 m-0 box-border",children:[me.jsx("canvas",{ref:a,className:"relative z-1 cursor-pointer"}),me.jsxs("div",{className:"fixed h-40 w-48 z-10 left-1/2 top-1/2 tips-modal",style:{display:C?"block":"none"},children:[me.jsx("div",{className:"tips",children:me.jsx("p",{className:"w-full",children:k})}),me.jsx("i",{className:"close",onClick:()=>L(!1),children:"CLOSE"})]}),me.jsxs("header",{className:"hud header w-full left-0 top-0",children:[me.jsx("div",{className:"left",children:me.jsxs("p",{className:"date",children:[me.jsx("span",{className:"text",children:`${y} `}),me.jsx("span",{className:"text",children:E})]})}),me.jsx("div",{className:"middle"}),me.jsx("div",{className:"right",children:me.jsx("p",{className:"date",children:me.jsx("span",{className:"text",children:"Kepler-90 +491818.58"})})})]}),me.jsx("div",{className:"logo-pic",title:"Cyberpunk 2077"}),me.jsxs("aside",{className:"hud aside left",children:[me.jsxs("div",{className:"box box_0 inverse",children:[me.jsx("div",{className:"cover"}),me.jsxs("div",{className:"info",children:[me.jsxs("p",{className:"text",children:[me.jsx("b",{children:"Cyberpunk"}),' is a subgenre of science fiction in a dystopian futuristic setting that tends to focus on a "combination of lowlife and high tech", featuring futuristic technological and scientific achievements, such as artificial intelligence and cybernetics, juxtaposed with societal collapse or decay.'," "]}),me.jsx("button",{className:"startBtn",onClick:_t,children:"START"})]})]}),me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:je[0]})}),me.jsx("div",{className:"box inverse dotted",children:me.jsx("div",{className:"chart",ref:je[1]})})]}),me.jsxs("aside",{className:"hud aside right",children:[me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:je[2]})}),me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:je[3]})}),me.jsx("div",{className:"box inverse dotted",children:me.jsx("div",{className:"chart",ref:je[4]})})]}),me.jsx("footer",{className:"hud footer",children:DAe.map(wt=>me.jsxs("div",{className:"square",children:[me.jsx("div",{className:"radar"}),me.jsxs("div",{className:"text",children:[me.jsx("p",{className:"title",children:wt.value}),me.jsx("p",{className:"desc",children:wt.desc})]})]}))}),me.jsx("section",{className:"background",children:"section"})]})})},Xke="/about_portfolio/assets/bird-D9YInZSw.glb",$ke=()=>{const n=Ae.useRef(),{scene:e,animations:t}=rg(Xke),{actions:r}=gU(t,n);return Ae.useEffect(()=>{r["Take 001"].play()},[]),eM(({clock:i,camera:s})=>{n.current.position.y=Math.sin(i.elapsedTime)*.2+2,n.current.position.x>s.position.x+10?n.current.rotation.y=Math.PI:n.current.position.x<s.position.x-10&&(n.current.rotation.y=0),n.current.rotation.y===0?(n.current.position.x+=.01,n.current.position.z-=.01):(n.current.position.x-=.01,n.current.position.z+=.01)}),me.jsx("mesh",{ref:n,position:[-5,2,1],scale:[.003,.003,.003],children:me.jsx("primitive",{object:e})})},qke="/about_portfolio/assets/fox-W5Giziuq.glb",wle=({currentAnimation:n,...e})=>{const t=Ae.useRef(),{nodes:r,materials:i,animations:s}=rg(qke),{actions:a}=gU(s,t);return Ae.useEffect(()=>{console.log(a),Object.values(a).forEach(l=>{l.stop()}),a[n]&&a[n].play()},[a,n]),me.jsx("group",{ref:t,...e,dispose:null,children:me.jsxs("group",{name:"Sketchfab_Scene",children:[me.jsx("primitive",{object:r.GLTF_created_0_rootJoint}),me.jsx("skinnedMesh",{name:"Object_7",geometry:r.Object_7.geometry,material:i.PaletteMaterial001,skeleton:r.Object_7.skeleton}),me.jsx("skinnedMesh",{name:"Object_8",geometry:r.Object_8.geometry,material:i.PaletteMaterial001,skeleton:r.Object_8.skeleton}),me.jsx("skinnedMesh",{name:"Object_9",geometry:r.Object_9.geometry,material:i.PaletteMaterial001,skeleton:r.Object_9.skeleton}),me.jsx("skinnedMesh",{name:"Object_10",geometry:r.Object_10.geometry,material:i.PaletteMaterial001,skeleton:r.Object_10.skeleton}),me.jsx("skinnedMesh",{name:"Object_11",geometry:r.Object_11.geometry,material:i.PaletteMaterial001,skeleton:r.Object_11.skeleton})]})})},Zke=()=>me.jsx("section",{className:"absolute w-full h-full",children:me.jsxs(wD,{camera:{position:[0,0,5],fov:75,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3},children:[me.jsx("ambientLight",{intensity:.5}),me.jsx("directionalLight",{intensity:2.5,position:[0,0,1]}),me.jsx(wle,{currentAnimation:"idle",position:[.5,0,0],rotation:[12.6,-.5,0],scale:[.6,.6,.6]})]})}),Yke="/about_portfolio/gltfModels/world_2d/world_2d.gltf",Kke=({...n})=>{const t=rg(Yke).scene;return me.jsx("mesh",{...n,children:me.jsx("primitive",{object:t})})},Jke=()=>me.jsx("section",{className:"absolute w-full h-full",children:me.jsxs(wD,{camera:{fov:75,aspect:window.innerWidth/window.innerHeight,near:.1,far:100,position:[0,0,5]},children:[me.jsx("ambientLight",{intensity:.5}),me.jsx("directionalLight",{intensity:2.5,position:[0,0,1]}),me.jsxs("group",{children:[me.jsxs("mesh",{position:[-2,0,0],children:[me.jsx("meshNormalMaterial",{}),me.jsx("boxGeometry",{args:[1,1,1]})]}),me.jsxs("mesh",{position:[2,0,0],children:[me.jsx("meshNormalMaterial",{}),me.jsx("boxGeometry",{args:[1,1,1]})]})]})]})});class Qke extends Ia{constructor(e){super(e)}load(e,t,r,i){const s=this,a=this.path===""?hu.extractUrlBase(e):this.path,l=new Xa(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(o){try{t(s.parse(o,a))}catch(h){i?i(h):console.error(h),s.manager.itemError(e)}},r,i)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const r=e.split(`
`);let i={};const s=/\s+/,a={};for(let o=0;o<r.length;o++){let h=r[o];if(h=h.trim(),h.length===0||h.charAt(0)==="#")continue;const d=h.indexOf(" ");let m=d>=0?h.substring(0,d):h;m=m.toLowerCase();let v=d>=0?h.substring(d+1):"";if(v=v.trim(),m==="newmtl")i={name:v},a[v]=i;else if(m==="ka"||m==="kd"||m==="ks"||m==="ke"){const y=v.split(s,3);i[m]=[parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])]}else i[m]=v}const l=new eOe(this.resourcePath||t,this.materialOptions);return l.setCrossOrigin(this.crossOrigin),l.setManager(this.manager),l.setMaterials(a),l}}class eOe{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:Dh,this.wrap=this.options.wrap!==void 0?this.options.wrap:Bh}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const r in e){const i=e[r],s={};t[r]=s;for(const a in i){let l=!0,o=i[a];const h=a.toLowerCase();switch(h){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(o=[o[0]/255,o[1]/255,o[2]/255]),this.options&&this.options.ignoreZeroRGBs&&o[0]===0&&o[1]===0&&o[2]===0&&(l=!1);break}l&&(s[h]=o)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,r=this.materialsInfo[e],i={name:e,side:this.side};function s(l,o){return typeof o!="string"||o===""?"":/^https?:\/\//i.test(o)?o:l+o}function a(l,o){if(i[l])return;const h=t.getTextureParams(o,i),d=t.loadTexture(s(t.baseUrl,h.url));d.repeat.copy(h.scale),d.offset.copy(h.offset),d.wrapS=t.wrap,d.wrapT=t.wrap,(l==="map"||l==="emissiveMap")&&(d.colorSpace=To),i[l]=d}for(const l in r){const o=r[l];let h;if(o!=="")switch(l.toLowerCase()){case"kd":i.color=new Vn().fromArray(o).convertSRGBToLinear();break;case"ks":i.specular=new Vn().fromArray(o).convertSRGBToLinear();break;case"ke":i.emissive=new Vn().fromArray(o).convertSRGBToLinear();break;case"map_kd":a("map",o);break;case"map_ks":a("specularMap",o);break;case"map_ke":a("emissiveMap",o);break;case"norm":a("normalMap",o);break;case"map_bump":case"bump":a("bumpMap",o);break;case"map_d":a("alphaMap",o),i.transparent=!0;break;case"ns":i.shininess=parseFloat(o);break;case"d":h=parseFloat(o),h<1&&(i.opacity=h,i.transparent=!0);break;case"tr":h=parseFloat(o),this.options&&this.options.invertTrProperty&&(h=1-h),h>0&&(i.opacity=1-h,i.transparent=!0);break}}return this.materials[e]=new YT(i),this.materials[e]}getTextureParams(e,t){const r={scale:new nn(1,1),offset:new nn(0,0)},i=e.split(/\s+/);let s;return s=i.indexOf("-bm"),s>=0&&(t.bumpScale=parseFloat(i[s+1]),i.splice(s,2)),s=i.indexOf("-s"),s>=0&&(r.scale.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),s=i.indexOf("-o"),s>=0&&(r.offset.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),r.url=i.join(" ").trim(),r}loadTexture(e,t,r,i,s){const a=this.manager!==void 0?this.manager:sU;let l=a.getHandler(e);l===null&&(l=new Kf(a)),l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin);const o=l.load(e,r,i,s);return t!==void 0&&(o.mapping=t),o}}const tOe=/^[og]\s*(.+)?/,nOe=/^mtllib /,rOe=/^usemtl /,iOe=/^usemap /,nK=/\s+/,rK=new Ze,Uk=new Ze,iK=new Ze,sK=new Ze,hh=new Ze,vI=new Vn;function sOe(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(i,s){const a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);const l={index:this.materials.length,name:i||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:a!==void 0?a.smooth:this.smooth,groupStart:a!==void 0?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(o){const h={index:typeof o=="number"?o:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return h.clone=this.clone.bind(h),h}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(i){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),i&&this.materials.length>1)for(let a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return i&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseNormalIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseUVIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/2)*2},addVertex:function(e,t,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[t+0],i[t+1],i[t+2]),s.push(i[r+0],i[r+1],i[r+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[t+0],i[t+1],i[t+2]),s.push(i[r+0],i[r+1],i[r+2])},addFaceNormal:function(e,t,r){const i=this.vertices,s=this.object.geometry.normals;rK.fromArray(i,e),Uk.fromArray(i,t),iK.fromArray(i,r),hh.subVectors(iK,Uk),sK.subVectors(rK,Uk),hh.cross(sK),hh.normalize(),s.push(hh.x,hh.y,hh.z),s.push(hh.x,hh.y,hh.z),s.push(hh.x,hh.y,hh.z)},addColor:function(e,t,r){const i=this.colors,s=this.object.geometry.colors;i[e]!==void 0&&s.push(i[e+0],i[e+1],i[e+2]),i[t]!==void 0&&s.push(i[t+0],i[t+1],i[t+2]),i[r]!==void 0&&s.push(i[r+0],i[r+1],i[r+2])},addUV:function(e,t,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[t+0],i[t+1]),s.push(i[r+0],i[r+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,i,s,a,l,o,h){const d=this.vertices.length;let m=this.parseVertexIndex(e,d),v=this.parseVertexIndex(t,d),y=this.parseVertexIndex(r,d);if(this.addVertex(m,v,y),this.addColor(m,v,y),l!==void 0&&l!==""){const S=this.normals.length;m=this.parseNormalIndex(l,S),v=this.parseNormalIndex(o,S),y=this.parseNormalIndex(h,S),this.addNormal(m,v,y)}else this.addFaceNormal(m,v,y);if(i!==void 0&&i!==""){const S=this.uvs.length;m=this.parseUVIndex(i,S),v=this.parseUVIndex(s,S),y=this.parseUVIndex(a,S),this.addUV(m,v,y),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let r=0,i=e.length;r<i;r++){const s=this.parseVertexIndex(e[r],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(let s=0,a=e.length;s<a;s++)this.addVertexLine(this.parseVertexIndex(e[s],r));for(let s=0,a=t.length;s<a;s++)this.addUVLine(this.parseUVIndex(t[s],i))}};return n.startObject("",!1),n}class oOe extends Ia{constructor(e){super(e),this.materials=null}load(e,t,r,i){const s=this,a=new Xa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{t(s.parse(l))}catch(o){i?i(o):console.error(o),s.manager.itemError(e)}},r,i)}setMaterials(e){return this.materials=e,this}parse(e){const t=new sOe;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const r=e.split(`
`);let i=[];for(let l=0,o=r.length;l<o;l++){const h=r[l].trimStart();if(h.length===0)continue;const d=h.charAt(0);if(d!=="#")if(d==="v"){const m=h.split(nK);switch(m[0]){case"v":t.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7?(vI.setRGB(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])).convertSRGBToLinear(),t.colors.push(vI.r,vI.g,vI.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":t.uvs.push(parseFloat(m[1]),parseFloat(m[2]));break}}else if(d==="f"){const v=h.slice(1).trim().split(nK),y=[];for(let E=0,M=v.length;E<M;E++){const C=v[E];if(C.length>0){const L=C.split("/");y.push(L)}}const S=y[0];for(let E=1,M=y.length-1;E<M;E++){const C=y[E],L=y[E+1];t.addFace(S[0],C[0],L[0],S[1],C[1],L[1],S[2],C[2],L[2])}}else if(d==="l"){const m=h.substring(1).trim().split(" ");let v=[];const y=[];if(h.indexOf("/")===-1)v=m;else for(let S=0,E=m.length;S<E;S++){const M=m[S].split("/");M[0]!==""&&v.push(M[0]),M[1]!==""&&y.push(M[1])}t.addLineGeometry(v,y)}else if(d==="p"){const v=h.slice(1).trim().split(" ");t.addPointGeometry(v)}else if((i=tOe.exec(h))!==null){const m=(" "+i[0].slice(1).trim()).slice(1);t.startObject(m)}else if(rOe.test(h))t.object.startMaterial(h.substring(7).trim(),t.materialLibraries);else if(nOe.test(h))t.materialLibraries.push(h.substring(7).trim());else if(iOe.test(h))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(d==="s"){if(i=h.split(" "),i.length>1){const v=i[1].trim().toLowerCase();t.object.smooth=v!=="0"&&v!=="off"}else t.object.smooth=!0;const m=t.object.currentMaterial();m&&(m.smooth=t.object.smooth)}else{if(h==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+h+'"')}}t.finalize();const s=new Xl;if(s.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let l=0,o=t.objects.length;l<o;l++){const h=t.objects[l],d=h.geometry,m=h.materials,v=d.type==="Line",y=d.type==="Points";let S=!1;if(d.vertices.length===0)continue;const E=new $r;E.setAttribute("position",new ar(d.vertices,3)),d.normals.length>0&&E.setAttribute("normal",new ar(d.normals,3)),d.colors.length>0&&(S=!0,E.setAttribute("color",new ar(d.colors,3))),d.hasUVIndices===!0&&E.setAttribute("uv",new ar(d.uvs,2));const M=[];for(let L=0,k=m.length;L<k;L++){const H=m[L],q=H.name+"_"+H.smooth+"_"+S;let Z=t.materials[q];if(this.materials!==null){if(Z=this.materials.create(H.name),v&&Z&&!(Z instanceof Ma)){const ee=new Ma;yo.prototype.copy.call(ee,Z),ee.color.copy(Z.color),Z=ee}else if(y&&Z&&!(Z instanceof au)){const ee=new au({size:10,sizeAttenuation:!1});yo.prototype.copy.call(ee,Z),ee.color.copy(Z.color),ee.map=Z.map,Z=ee}}Z===void 0&&(v?Z=new Ma:y?Z=new au({size:1,sizeAttenuation:!1}):Z=new YT,Z.name=H.name,Z.flatShading=!H.smooth,Z.vertexColors=S,t.materials[q]=Z),M.push(Z)}let C;if(M.length>1){for(let L=0,k=m.length;L<k;L++){const H=m[L];E.addGroup(H.groupStart,H.groupCount,L)}v?C=new fu(E,M):y?C=new Th(E,M):C=new Ii(E,M)}else v?C=new fu(E,M[0]):y?C=new Th(E,M[0]):C=new Ii(E,M[0]);C.name=h.name,s.add(C)}else if(t.vertices.length>0){const l=new au({size:1,sizeAttenuation:!1}),o=new $r;o.setAttribute("position",new ar(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(o.setAttribute("color",new ar(t.colors,3)),l.vertexColors=!0);const h=new Th(o,l);s.add(h)}return s}}const aOe="/about_portfolio/gltfModels/earth_star/earth.mtl",lOe="/about_portfolio/gltfModels/earth_star/earth.obj",cOe=()=>{let n=null,e=null,t=null,r=null,i,s,a=null,l=0,o=Ae.useRef(null),h=()=>{let m={width:o.current.clientWidth,height:o.current.clientHeight};e=new ts(70,m.width/m.height,.01,1e3),e.position.set(50,20,200),e.lookAt(0,0,0),n=new Tl,n.fog=new yw(1710618,1,1e3),n.background=new Vn(1710618),t=new x1(14609919,3),r=new Yl({canvas:o.current,alpha:!0,antialias:!0}),r.setSize(m.width,m.height);let v=new Lv(e,r.domElement);v.enableDamping=!0;let y=new ZT(100,4,2,120),S=new _o({color:4237823,wireframe:!0});a=new Ii(y,S),a.rotation.x=Math.PI/2,a.rotation.y=-.1*(Math.PI/2);let E=new t1(12,0),M=new KT({color:16776192});s=new Ii(E,M),i=new Xl;for(let k=0;k<500;k++){let H=new t1(Math.random()*3,0),q=new _o({color:16777215}),Z=new Ii(H,q);Z.position.set((Math.random()-.5)*800,(Math.random()-.5)*800,(Math.random()-.5)*800),Z.rotation.set(Math.random()*2*Math.PI,Math.random()*2*Math.PI,Math.random()*2*Math.PI),i.add(Z)}let C=new Qke,L=new oOe;C.load(aOe,k=>{k.preload(),k.side=wc,L.setMaterials(k),L.load(lOe,H=>{H.scale.set(80,80,80),H.children.map((q,Z)=>{const ee=q.material.name;q.material=k.materials[ee],q.name==="Earth_Sphere"?(q.visible=!0,H.add(new Ii(q.geometry,q.material))):q.material.opacity=.1}),n.add(H)})}),n.add(t),n.add(a),n.add(s),n.add(i),r.render(n,e)},d=()=>{let m=new Ze(0,0,1);l+=Math.random()*.8;let v=Math.PI*l/180;a&&a.rotateOnAxis(m,Math.PI/400),s.position.set(140*Math.cos(v),100*Math.sin(v),80*Math.sin(v)),s.rotation.x+=.01,s.rotation.y+=.01,s.rotation.z-=.01,i.rotation.y+=9e-4,i.rotation.z-=9e-4,requestAnimationFrame(d),r.render(n,e)};return Ae.useEffect(()=>{h(),d()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:o,className:"w-full h-full"})})},uOe="/about_portfolio/assets/statue-C3oCcb_2.glb",Gk=new WeakMap;class U8 extends Ia{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Xa(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{this.parse(a,t,i)},r,i)}parse(e,t,r=()=>{}){this.decodeDracoFile(e,t,null,null,To,r).catch(r)}decodeDracoFile(e,t,r,i,s=Ha,a=()=>{}){const l={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:s};return this.decodeGeometry(e,l).then(t).catch(a)}decodeGeometry(e,t){const r=JSON.stringify(t);if(Gk.has(e)){const o=Gk.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,a=e.byteLength,l=this._getWorker(s,a).then(o=>(i=o,new Promise((h,d)=>{i._callbacks[s]={resolve:h,reject:d},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return l.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),Gk.set(e,{key:r,promise:l}),l}_createGeometry(e){const t=new $r;e.index&&t.setIndex(new Bi(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,a=i.array,l=i.itemSize,o=new Bi(a,l);s==="color"&&(this._assignVertexColorSpace(o,i.vertexColorSpace),o.normalized=!(a instanceof Float32Array)),t.setAttribute(s,o)}return t}_assignVertexColorSpace(e,t){if(t!==To)return;const r=new Vn;for(let i=0,s=e.count;i<s;i++)r.fromBufferAttribute(e,i).convertSRGBToLinear(),e.setXYZ(i,r.r,r.g,r.b)}_loadLibrary(e,t){const r=new Xa(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=hOe.toString(),a=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const a=s.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function hOe(){let n,e;onmessage=function(a){const l=a.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(d){n.onModuleLoaded=function(m){d({draco:m})},DracoDecoderModule(n)});break;case"decode":const o=l.buffer,h=l.taskConfig;e.then(d=>{const m=d.draco,v=new m.Decoder;try{const y=t(m,v,new Int8Array(o),h),S=y.attributes.map(E=>E.array.buffer);y.index&&S.push(y.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:y},S)}catch(y){console.error(y),self.postMessage({type:"error",id:l.id,error:y.message})}finally{m.destroy(v)}});break}};function t(a,l,o,h){const d=h.attributeIDs,m=h.attributeTypes;let v,y;const S=l.GetEncodedGeometryType(o);if(S===a.TRIANGULAR_MESH)v=new a.Mesh,y=l.DecodeArrayToMesh(o,o.byteLength,v);else if(S===a.POINT_CLOUD)v=new a.PointCloud,y=l.DecodeArrayToPointCloud(o,o.byteLength,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const E={index:null,attributes:[]};for(const M in d){const C=self[m[M]];let L,k;if(h.useUniqueIDs)k=d[M],L=l.GetAttributeByUniqueId(v,k);else{if(k=l.GetAttributeId(v,a[d[M]]),k===-1)continue;L=l.GetAttribute(v,k)}const H=i(a,l,v,M,C,L);M==="color"&&(H.vertexColorSpace=h.vertexColorSpace),E.attributes.push(H)}return S===a.TRIANGULAR_MESH&&(E.index=r(a,l,v)),a.destroy(v),E}function r(a,l,o){const d=o.num_faces()*3,m=d*4,v=a._malloc(m);l.GetTrianglesUInt32Array(o,m,v);const y=new Uint32Array(a.HEAPF32.buffer,v,d).slice();return a._free(v),{array:y,itemSize:1}}function i(a,l,o,h,d,m){const v=m.num_components(),S=o.num_points()*v,E=S*d.BYTES_PER_ELEMENT,M=s(a,d),C=a._malloc(E);l.GetAttributeDataArrayForAllPoints(o,m,M,E,C);const L=new d(a.HEAPF32.buffer,C,S).slice();return a._free(C),{name:h,array:L,itemSize:v}}function s(a,l){switch(l){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}class l3 extends Ia{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new gOe(t)}),this.register(function(t){return new vOe(t)}),this.register(function(t){return new MOe(t)}),this.register(function(t){return new COe(t)}),this.register(function(t){return new EOe(t)}),this.register(function(t){return new yOe(t)}),this.register(function(t){return new xOe(t)}),this.register(function(t){return new bOe(t)}),this.register(function(t){return new wOe(t)}),this.register(function(t){return new mOe(t)}),this.register(function(t){return new SOe(t)}),this.register(function(t){return new _Oe(t)}),this.register(function(t){return new TOe(t)}),this.register(function(t){return new AOe(t)}),this.register(function(t){return new dOe(t)}),this.register(function(t){return new IOe(t)}),this.register(function(t){return new ROe(t)})}load(e,t,r,i){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const h=hu.extractUrlBase(e);a=hu.resolveURL(h,this.path)}else a=hu.extractUrlBase(e);this.manager.itemStart(e);const l=function(h){i?i(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},o=new Xa(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(h){try{s.parse(h,a,function(d){t(d),s.manager.itemEnd(e)},l)}catch(d){l(d)}},r,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const a={},l={},o=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(o.decode(new Uint8Array(e,0,4))===Sle){try{a[Vi.KHR_BINARY_GLTF]=new POe(e)}catch(m){i&&i(m);return}s=JSON.parse(a[Vi.KHR_BINARY_GLTF].content)}else s=JSON.parse(o.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new jOe(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const m=this.pluginCallbacks[d](h);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[m.name]=m,a[m.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const m=s.extensionsUsed[d],v=s.extensionsRequired||[];switch(m){case Vi.KHR_MATERIALS_UNLIT:a[m]=new pOe;break;case Vi.KHR_DRACO_MESH_COMPRESSION:a[m]=new LOe(s,this.dracoLoader);break;case Vi.KHR_TEXTURE_TRANSFORM:a[m]=new DOe;break;case Vi.KHR_MESH_QUANTIZATION:a[m]=new BOe;break;default:v.indexOf(m)>=0&&l[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}h.setExtensions(a),h.setPlugins(l),h.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function fOe(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Vi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class dOe{constructor(e){this.parser=e,this.name=Vi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const d=new Vn(16777215);o.color!==void 0&&d.setRGB(o.color[0],o.color[1],o.color[2],Ha);const m=o.range!==void 0?o.range:0;switch(o.type){case"directional":h=new Pv(d),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new rv(d),h.distance=m;break;case"spot":h=new yD(d),h.distance=m,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,h.angle=o.spot.outerConeAngle,h.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return h.position.set(0,0,0),h.decay=2,xm(h,o),o.intensity!==void 0&&(h.intensity=o.intensity),h.name=t.createUniqueName(o.name||"light_"+e),i=Promise.resolve(h),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(o){return r._getNodeRef(t.cache,l,o)})}}class pOe{constructor(){this.name=Vi.KHR_MATERIALS_UNLIT}getMaterialType(){return _o}extendParams(e,t,r){const i=[];e.color=new Vn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Ha),e.opacity=a[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,To))}return Promise.all(i)}}class mOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class gOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const l=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new nn(l,l)}return Promise.all(s)}}class vOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class _Oe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class yOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Vn(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=i.extensions[this.name];if(a.sheenColorFactor!==void 0){const l=a.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],Ha)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,To)),a.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class xOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class bOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return t.attenuationColor=new Vn().setRGB(l[0],l[1],l[2],Ha),Promise.all(s)}}class wOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class SOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return t.specularColor=new Vn().setRGB(l[0],l[1],l[2],Ha),a.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,To)),Promise.all(s)}}class AOe{constructor(e){this.parser=e,this.name=Vi.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}}class TOe{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class MOe{constructor(e){this.parser=e,this.name=Vi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class COe{constructor(e){this.parser=e,this.name=Vi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=i.images[a.source];let o=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(o=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class EOe{constructor(e){this.parser=e,this.name=Vi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=i.images[a.source];let o=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(o=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class IOe{constructor(e){this.name=Vi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const o=i.byteOffset||0,h=i.byteLength||0,d=i.count,m=i.byteStride,v=new Uint8Array(l,o,h);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(d,m,v,i.mode,i.filter).then(function(y){return y.buffer}):a.ready.then(function(){const y=new ArrayBuffer(d*m);return a.decodeGltfBuffer(new Uint8Array(y),d,m,v,i.mode,i.filter),y})})}else return null}}class ROe{constructor(e){this.name=Vi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const h of i.primitives)if(h.mode!==gh.TRIANGLES&&h.mode!==gh.TRIANGLE_STRIP&&h.mode!==gh.TRIANGLE_FAN&&h.mode!==void 0)return null;const a=r.extensions[this.name].attributes,l=[],o={};for(const h in a)l.push(this.parser.getDependency("accessor",a[h]).then(d=>(o[h]=d,o[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(h=>{const d=h.pop(),m=d.isGroup?d.children:[d],v=h[0].count,y=[];for(const S of m){const E=new Gr,M=new Ze,C=new Ta,L=new Ze(1,1,1),k=new iD(S.geometry,S.material,v);for(let H=0;H<v;H++)o.TRANSLATION&&M.fromBufferAttribute(o.TRANSLATION,H),o.ROTATION&&C.fromBufferAttribute(o.ROTATION,H),o.SCALE&&L.fromBufferAttribute(o.SCALE,H),k.setMatrixAt(H,E.compose(M,C,L));for(const H in o)if(H==="_COLOR_0"){const q=o[H];k.instanceColor=new fv(q.array,q.itemSize,q.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&S.geometry.setAttribute(H,o[H]);Ri.prototype.copy.call(k,S),this.parser.assignFinalMaterial(k),y.push(k)}return d.isGroup?(d.clear(),d.add(...y),d):y[0]}))}}const Sle="glTF",cS=12,oK={JSON:1313821514,BIN:5130562};class POe{constructor(e){this.name=Vi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,cS),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Sle)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-cS,s=new DataView(e,cS);let a=0;for(;a<i;){const l=s.getUint32(a,!0);a+=4;const o=s.getUint32(a,!0);if(a+=4,o===oK.JSON){const h=new Uint8Array(e,cS+a,l);this.content=r.decode(h)}else if(o===oK.BIN){const h=cS+a;this.body=e.slice(h,h+l)}a+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class LOe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Vi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,l={},o={},h={};for(const d in a){const m=sz[d]||d.toLowerCase();l[m]=a[d]}for(const d in e.attributes){const m=sz[d]||d.toLowerCase();if(a[d]!==void 0){const v=r.accessors[e.attributes[d]],y=Gb[v.componentType];h[m]=y.name,o[m]=v.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(m,v){i.decodeDracoFile(d,function(y){for(const S in y.attributes){const E=y.attributes[S],M=o[S];M!==void 0&&(E.normalized=M)}m(y)},l,h,Ha,v)})})}}class DOe{constructor(){this.name=Vi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class BOe{constructor(){this.name=Vi.KHR_MESH_QUANTIZATION}}class Ale extends v1{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let a=0;a!==i;a++)t[a]=r[s+a];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,o=l*2,h=l*3,d=i-t,m=(r-t)/d,v=m*m,y=v*m,S=e*h,E=S-h,M=-2*y+3*v,C=y-v,L=1-M,k=C-v+m;for(let H=0;H!==l;H++){const q=a[E+H+l],Z=a[E+H+o]*d,ee=a[S+H+l],re=a[S+H]*d;s[H]=L*q+k*Z+M*ee+C*re}return s}}const kOe=new Ta;class OOe extends Ale{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return kOe.fromArray(s).normalize().toArray(s),s}}const gh={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Gb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},aK={9728:Sa,9729:Eo,9984:FT,9985:Dy,9986:V0,9987:ou},lK={33071:su,33648:Zy,10497:Bh},Vk={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sz={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},T0={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},FOe={CUBICSPLINE:void 0,LINEAR:hv,STEP:Jy},Hk={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function NOe(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new fp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Dh})),n.DefaultMaterial}function ty(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function xm(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function zOe(n,e,t){let r=!1,i=!1,s=!1;for(let h=0,d=e.length;h<d;h++){const m=e[h];if(m.POSITION!==void 0&&(r=!0),m.NORMAL!==void 0&&(i=!0),m.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const a=[],l=[],o=[];for(let h=0,d=e.length;h<d;h++){const m=e[h];if(r){const v=m.POSITION!==void 0?t.getDependency("accessor",m.POSITION):n.attributes.position;a.push(v)}if(i){const v=m.NORMAL!==void 0?t.getDependency("accessor",m.NORMAL):n.attributes.normal;l.push(v)}if(s){const v=m.COLOR_0!==void 0?t.getDependency("accessor",m.COLOR_0):n.attributes.color;o.push(v)}}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(o)]).then(function(h){const d=h[0],m=h[1],v=h[2];return r&&(n.morphAttributes.position=d),i&&(n.morphAttributes.normal=m),s&&(n.morphAttributes.color=v),n.morphTargetsRelative=!0,n})}function UOe(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function GOe(n){let e;const t=n.extensions&&n.extensions[Vi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+jk(t.attributes):e=n.indices+":"+jk(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+jk(n.targets[r]);return e}function jk(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function oz(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function VOe(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const HOe=new Gr;class jOe{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fOe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=-1,s=!1,a=-1;if(typeof navigator<"u"){const l=navigator.userAgent;r=/^((?!chrome|android).)*safari/i.test(l)===!0;const o=l.match(/Version\/(\d+)/);i=r&&o?parseInt(o[1],10):-1,s=l.indexOf("Firefox")>-1,a=s?l.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||r&&i<17||s&&a<98?this.textureLoader=new Kf(this.options.manager):this.textureLoader=new aU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xa(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(a){const l={scene:a[0][i.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:i.asset,parser:r,userData:{}};return ty(s,l,i),xm(l,i),Promise.all(r._invokeAll(function(o){return o.afterRoot&&o.afterRoot(l)})).then(function(){for(const o of l.scenes)o.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const a=t[i].joints;for(let l=0,o=a.length;l<o;l++)e[a[l]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const a=e[i];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(r[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(a,l)=>{const o=this.associations.get(a);o!=null&&this.associations.set(l,o);for(const[h,d]of a.children.entries())s(d,l.children[h])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,a){return r.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Vi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,a){r.load(hu.resolveURL(t.uri,i.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const a=Vk[i.type],l=Gb[i.componentType],o=i.normalized===!0,h=new l(i.count*a);return Promise.resolve(new Bi(h,a,o))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(a){const l=a[0],o=Vk[i.type],h=Gb[i.componentType],d=h.BYTES_PER_ELEMENT,m=d*o,v=i.byteOffset||0,y=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let E,M;if(y&&y!==m){const C=Math.floor(v/y),L="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+C+":"+i.count;let k=t.cache.get(L);k||(E=new h(l,C*y,i.count*y/d),k=new xw(E,y/d),t.cache.add(L,k)),M=new Xm(k,o,v%y/d,S)}else l===null?E=new h(i.count*o):E=new h(l,v,i.count*o),M=new Bi(E,o,S);if(i.sparse!==void 0){const C=Vk.SCALAR,L=Gb[i.sparse.indices.componentType],k=i.sparse.indices.byteOffset||0,H=i.sparse.values.byteOffset||0,q=new L(a[1],k,i.sparse.count*C),Z=new h(a[2],H,i.sparse.count*o);l!==null&&(M=new Bi(M.array.slice(),M.itemSize,M.normalized));for(let ee=0,re=q.length;ee<re;ee++){const se=q[ee];if(M.setX(se,Z[ee*o]),o>=2&&M.setY(se,Z[ee*o+1]),o>=3&&M.setZ(se,Z[ee*o+2]),o>=4&&M.setW(se,Z[ee*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,a=t.images[s];let l=this.textureLoader;if(a.uri){const o=r.manager.getHandler(a.uri);o!==null&&(l=o)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,r){const i=this,s=this.json,a=s.textures[e],l=s.images[t],o=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const h=this.loadImageSource(t,r).then(function(d){d.flipY=!1,d.name=a.name||l.name||"",d.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(d.name=l.uri);const v=(s.samplers||{})[a.sampler]||{};return d.magFilter=aK[v.magFilter]||Eo,d.minFilter=aK[v.minFilter]||ou,d.wrapS=lK[v.wrapS]||Bh,d.wrapT=lK[v.wrapT]||Bh,i.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[o]=h,h}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(m=>m.clone());const a=i.images[e],l=self.URL||self.webkitURL;let o=a.uri||"",h=!1;if(a.bufferView!==void 0)o=r.getDependency("bufferView",a.bufferView).then(function(m){h=!0;const v=new Blob([m],{type:a.mimeType});return o=l.createObjectURL(v),o});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(o).then(function(m){return new Promise(function(v,y){let S=v;t.isImageBitmapLoader===!0&&(S=function(E){const M=new Xs(E);M.needsUpdate=!0,v(M)}),t.load(hu.resolveURL(m,s.path),S,void 0,y)})}).then(function(m){return h===!0&&l.revokeObjectURL(o),xm(m,a),m.userData.mimeType=a.mimeType||VOe(a.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),m});return this.sourceCache[e]=d,d}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(a=a.clone(),a.channel=r.texCoord),s.extensions[Vi.KHR_TEXTURE_TRANSFORM]){const l=r.extensions!==void 0?r.extensions[Vi.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const o=s.associations.get(a);a=s.extensions[Vi.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),s.associations.set(a,o)}}return i!==void 0&&(a.colorSpace=i),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+r.uuid;let o=this.cache.get(l);o||(o=new au,yo.prototype.copy.call(o,r),o.color.copy(r.color),o.map=r.map,o.sizeAttenuation=!1,this.cache.add(l,o)),r=o}else if(e.isLine){const l="LineBasicMaterial:"+r.uuid;let o=this.cache.get(l);o||(o=new Ma,yo.prototype.copy.call(o,r),o.color.copy(r.color),o.map=r.map,this.cache.add(l,o)),r=o}if(i||s||a){let l="ClonedMaterial:"+r.uuid+":";i&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let o=this.cache.get(l);o||(o=r.clone(),s&&(o.vertexColors=!0),a&&(o.flatShading=!0),i&&(o.normalScale&&(o.normalScale.y*=-1),o.clearcoatNormalScale&&(o.clearcoatNormalScale.y*=-1)),this.cache.add(l,o),this.associations.set(o,this.associations.get(r))),r=o}e.material=r}getMaterialType(){return fp}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let a;const l={},o=s.extensions||{},h=[];if(o[Vi.KHR_MATERIALS_UNLIT]){const m=i[Vi.KHR_MATERIALS_UNLIT];a=m.getMaterialType(),h.push(m.extendParams(l,s,t))}else{const m=s.pbrMetallicRoughness||{};if(l.color=new Vn(1,1,1),l.opacity=1,Array.isArray(m.baseColorFactor)){const v=m.baseColorFactor;l.color.setRGB(v[0],v[1],v[2],Ha),l.opacity=v[3]}m.baseColorTexture!==void 0&&h.push(t.assignTexture(l,"map",m.baseColorTexture,To)),l.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,l.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(l,"metalnessMap",m.metallicRoughnessTexture)),h.push(t.assignTexture(l,"roughnessMap",m.metallicRoughnessTexture))),a=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,l)})))}s.doubleSided===!0&&(l.side=wc);const d=s.alphaMode||Hk.OPAQUE;if(d===Hk.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,d===Hk.MASK&&(l.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==_o&&(h.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new nn(1,1),s.normalTexture.scale!==void 0)){const m=s.normalTexture.scale;l.normalScale.set(m,m)}if(s.occlusionTexture!==void 0&&a!==_o&&(h.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==_o){const m=s.emissiveFactor;l.emissive=new Vn().setRGB(m[0],m[1],m[2],Ha)}return s.emissiveTexture!==void 0&&a!==_o&&h.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,To)),Promise.all(h).then(function(){const m=new a(l);return s.name&&(m.name=s.name),xm(m,s),t.associations.set(m,{materials:e}),s.extensions&&ty(i,m,s),m})}createUniqueName(e){const t=es.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(l){return r[Vi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(o){return cK(o,l,t)})}const a=[];for(let l=0,o=e.length;l<o;l++){const h=e[l],d=GOe(h),m=i[d];if(m)a.push(m.promise);else{let v;h.extensions&&h.extensions[Vi.KHR_DRACO_MESH_COMPRESSION]?v=s(h):v=cK(new $r,h,t),i[d]={primitive:h,promise:v},a.push(v)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],a=s.primitives,l=[];for(let o=0,h=a.length;o<h;o++){const d=a[o].material===void 0?NOe(this.cache):this.getDependency("material",a[o].material);l.push(d)}return l.push(t.loadGeometries(a)),Promise.all(l).then(function(o){const h=o.slice(0,o.length-1),d=o[o.length-1],m=[];for(let y=0,S=d.length;y<S;y++){const E=d[y],M=a[y];let C;const L=h[y];if(M.mode===gh.TRIANGLES||M.mode===gh.TRIANGLE_STRIP||M.mode===gh.TRIANGLE_FAN||M.mode===void 0)C=s.isSkinnedMesh===!0?new rD(E,L):new Ii(E,L),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),M.mode===gh.TRIANGLE_STRIP?C.geometry=LX(C.geometry,UT):M.mode===gh.TRIANGLE_FAN&&(C.geometry=LX(C.geometry,Qy));else if(M.mode===gh.LINES)C=new fu(E,L);else if(M.mode===gh.LINE_STRIP)C=new Yf(E,L);else if(M.mode===gh.LINE_LOOP)C=new sD(E,L);else if(M.mode===gh.POINTS)C=new Th(E,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(C.geometry.morphAttributes).length>0&&UOe(C,s),C.name=t.createUniqueName(s.name||"mesh_"+e),xm(C,s),M.extensions&&ty(i,C,M),t.assignFinalMaterial(C),m.push(C)}for(let y=0,S=m.length;y<S;y++)t.associations.set(m[y],{meshes:e,primitives:y});if(m.length===1)return s.extensions&&ty(i,m[0],s),m[0];const v=new Xl;s.extensions&&ty(i,v,s),t.associations.set(v,{meshes:e});for(let y=0,S=m.length;y<S;y++)v.add(m[y]);return v})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new ts(no.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new ed(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),xm(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),a=i,l=[],o=[];for(let h=0,d=a.length;h<d;h++){const m=a[h];if(m){l.push(m);const v=new Gr;s!==null&&v.fromArray(s.array,h*16),o.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new bw(l,o)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,a=[],l=[],o=[],h=[],d=[];for(let m=0,v=i.channels.length;m<v;m++){const y=i.channels[m],S=i.samplers[y.sampler],E=y.target,M=E.node,C=i.parameters!==void 0?i.parameters[S.input]:S.input,L=i.parameters!==void 0?i.parameters[S.output]:S.output;E.node!==void 0&&(a.push(this.getDependency("node",M)),l.push(this.getDependency("accessor",C)),o.push(this.getDependency("accessor",L)),h.push(S),d.push(E))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(o),Promise.all(h),Promise.all(d)]).then(function(m){const v=m[0],y=m[1],S=m[2],E=m[3],M=m[4],C=[];for(let L=0,k=v.length;L<k;L++){const H=v[L],q=y[L],Z=S[L],ee=E[L],re=M[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const se=r._createAnimationTracks(H,q,Z,ee,re);if(se)for(let ae=0;ae<se.length;ae++)C.push(se[ae])}return new n1(s,void 0,C)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const a=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&a.traverse(function(l){if(l.isMesh)for(let o=0,h=i.weights.length;o<h;o++)l.morphTargetInfluences[o]=i.weights[o]}),a})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),a=[],l=i.children||[];for(let h=0,d=l.length;h<d;h++)a.push(r.getDependency("node",l[h]));const o=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(a),o]).then(function(h){const d=h[0],m=h[1],v=h[2];v!==null&&d.traverse(function(y){y.isSkinnedMesh&&y.bind(v,HOe)});for(let y=0,S=m.length;y<S;y++)d.add(m[y]);return d})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?i.createUniqueName(s.name):"",l=[],o=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return o&&l.push(o),s.camera!==void 0&&l.push(i.getDependency("camera",s.camera).then(function(h){return i._getNodeRef(i.cameraCache,s.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){l.push(h)}),this.nodeCache[e]=Promise.all(l).then(function(h){let d;if(s.isBone===!0?d=new XT:h.length>1?d=new Xl:h.length===1?d=h[0]:d=new Ri,d!==h[0])for(let m=0,v=h.length;m<v;m++)d.add(h[m]);if(s.name&&(d.userData.name=s.name,d.name=a),xm(d,s),s.extensions&&ty(r,d,s),s.matrix!==void 0){const m=new Gr;m.fromArray(s.matrix),d.applyMatrix4(m)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return i.associations.has(d)||i.associations.set(d,{}),i.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new Xl;r.name&&(s.name=i.createUniqueName(r.name)),xm(s,r),r.extensions&&ty(t,s,r);const a=r.nodes||[],l=[];for(let o=0,h=a.length;o<h;o++)l.push(i.getDependency("node",a[o]));return Promise.all(l).then(function(o){for(let d=0,m=o.length;d<m;d++)s.add(o[d]);const h=d=>{const m=new Map;for(const[v,y]of i.associations)(v instanceof yo||v instanceof Xs)&&m.set(v,y);return d.traverse(v=>{const y=i.associations.get(v);y!=null&&m.set(v,y)}),m};return i.associations=h(s),s})}_createAnimationTracks(e,t,r,i,s){const a=[],l=e.name?e.name:e.uuid,o=[];T0[s.path]===T0.weights?e.traverse(function(v){v.morphTargetInfluences&&o.push(v.name?v.name:v.uuid)}):o.push(l);let h;switch(T0[s.path]){case T0.weights:h=$m;break;case T0.rotation:h=qm;break;case T0.position:case T0.scale:h=Zm;break;default:switch(r.itemSize){case 1:h=$m;break;case 2:case 3:default:h=Zm;break}break}const d=i.interpolation!==void 0?FOe[i.interpolation]:hv,m=this._getArrayFromAccessor(r);for(let v=0,y=o.length;v<y;v++){const S=new h(o[v]+"."+T0[s.path],t.array,m,d);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),a.push(S)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=oz(t.constructor),i=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof qm?OOe:Ale;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function WOe(n,e,t){const r=e.attributes,i=new Sl;if(r.POSITION!==void 0){const l=t.json.accessors[r.POSITION],o=l.min,h=l.max;if(o!==void 0&&h!==void 0){if(i.set(new Ze(o[0],o[1],o[2]),new Ze(h[0],h[1],h[2])),l.normalized){const d=oz(Gb[l.componentType]);i.min.multiplyScalar(d),i.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const l=new Ze,o=new Ze;for(let h=0,d=s.length;h<d;h++){const m=s[h];if(m.POSITION!==void 0){const v=t.json.accessors[m.POSITION],y=v.min,S=v.max;if(y!==void 0&&S!==void 0){if(o.setX(Math.max(Math.abs(y[0]),Math.abs(S[0]))),o.setY(Math.max(Math.abs(y[1]),Math.abs(S[1]))),o.setZ(Math.max(Math.abs(y[2]),Math.abs(S[2]))),v.normalized){const E=oz(Gb[v.componentType]);o.multiplyScalar(E)}l.max(o)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(l)}n.boundingBox=i;const a=new il;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=a}function cK(n,e,t){const r=e.attributes,i=[];function s(a,l){return t.getDependency("accessor",a).then(function(o){n.setAttribute(l,o)})}for(const a in r){const l=sz[a]||a.toLowerCase();l in n.attributes||i.push(s(r[a],l))}if(e.indices!==void 0&&!n.index){const a=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});i.push(a)}return ms.workingColorSpace!==Ha&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${ms.workingColorSpace}" not supported.`),xm(n,e),WOe(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?zOe(n,e.targets,t):n})}const XOe=()=>{let n=Ae.useRef(null),e=Ae.useRef(null),t,r,i,s,a,l,o=null;const h=new ng;let d=0,m=!1;const v={x:0,y:0};let y=()=>{t=new Yl({canvas:n.current,antialias:!0,alpha:!0,powerPreference:"high-performance"}),r=new Yl({canvas:e.current,antialias:!1});const L={width:n.current.clientWidth,height:n.current.clientHeight};t.autoClear=!0,t.outputColorSpace=To,t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.outputColorSpace=To,r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),i=new Tl,s=new Xl,a=new ts(35,1,1,100),l=new ts(35,1,1,100),i.add(s),a.aspect=L.width/L.height,a.position.set(19,1.54,-.1),s.add(a),l.aspect=L.width/L.height,l.position.set(3,3,3),l.rotation.set(0,1,0),i.add(l);const k=new Pv(16777215,.8);k.position.set(-100,0,-100),i.add(k),o=new rv(8978414,2.7,4,3),o.position.set(30,3,1.8),i.add(o);const H=new JT;H.onLoad=()=>{document.querySelector(".content").style.visibility="visible";let se={y:0};const ae=document.querySelector(".lds-roller"),fe=document.getElementById("loading-text-intro"),Se=new wS(se).to({y:100},900).easing(ep.Quadratic.InOut).start().onUpdate(()=>{fe.style.setProperty("transform",`translate(0,${se.y}%)`)}).onComplete(()=>{fe.parentNode.removeChild(document.getElementById("loading-text-intro")),SS(Se)}),Ce=new wS(a.position.set(0,4,2)).to({x:0,y:2.4,z:5.8},3500).easing(ep.Quadratic.InOut).start().onComplete(()=>{SS(Ce),document.querySelector(".nav-head").classList.add("ended"),document.querySelector(".description").classList.add("ended")});ae.parentNode.removeChild(ae),window.scroll(0,0)},H.onError=se=>{console.log("There was an error loading "+se)};const q=new U8;q.setDecoderPath("/draco/"),q.setDecoderConfig({type:"js"});const Z=new l3(H);Z.setDRACOLoader(q);let ee;Z.load(uOe,se=>{se.scene.traverse(ae=>{ae.isMesh&&(ee=ae.material,ae.material=new YT({shininess:100}))}),i.add(se.scene),ee.dispose(),t.renderLists.dispose()}),new IntersectionObserver(se=>{m=se[0].intersectionRatio>.05},{threshold:.05}).observe(document.querySelector(".second"))};const S=function(L){const k=document.querySelector("span");if(L.type==="mouseleave")k.style.cssText="";else{const{offsetX:H,offsetY:q}=L,{offsetWidth:Z,offsetHeight:ee}=this,re=20,se=H/Z*(re*2)-re,ae=q/ee*(re*2)-re;k.style.cssText=`transform: translate(${se}px, ${ae}px);`}},E=()=>{const L=h.getElapsedTime(),k=L-d;d=L;const H=v.y,q=v.x;o.position.y-=(H*9+o.position.y-2)*k,o.position.x+=(q*8-o.position.x)*2*k,s.position.z-=(H/3+s.position.z)*2*k,s.position.x+=(q/3-s.position.x)*2*k,Ire(),m?r.render(i,l):t.render(i,a),requestAnimationFrame(E)},M=(L,k)=>{const H=new wS(l.position).to(L,3500).easing(ep.Quadratic.InOut).start().onComplete(()=>{SS(H)}),q=new wS(l.rotation).to(k,3500).easing(ep.Quadratic.InOut).start().onComplete(()=>{SS(q)})},C=()=>{let L={width:n.current.clientWidth,height:n.current.clientHeight};t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.aspect=L.width/L.height,a.updateProjectionMatrix(),l.aspect=L.width/L.height,l.updateProjectionMatrix()};return Ae.useEffect(()=>{y(),E(),document.addEventListener("mousemove",k=>{k.preventDefault(),v.x=k.clientX/window.innerWidth-.5,v.y=k.clientY/window.innerHeight-.5,document.querySelector(".cursor").style.cssText=`left: ${k.clientX}px; top: ${k.clientY}px;`},!1);const L=document.querySelectorAll(".nav-head > .a");return L.forEach(k=>k.addEventListener("mousemove",S)),L.forEach(k=>k.addEventListener("mouseleave",S)),document.getElementById("one").addEventListener("click",()=>{document.getElementById("one").classList.add("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.remove("active"),M({x:3,y:3,z:3},{x:0,y:1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("two").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.add("active"),document.getElementById("three").classList.remove("active"),M({x:-1.4,y:2.8,z:4.4},{x:0,y:-.1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("three").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.add("active"),M({x:-4.8,y:2.9,z:3.2},{x:0,y:-.75,z:0}),document.getElementById("content").innerText=""}),window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C)}},[]),me.jsxs("div",{className:"shadow_page",children:[me.jsxs("div",{className:"lds-roller",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]}),me.jsx("div",{id:"loading-text-intro",children:me.jsx("p",{children:"Loading"})}),me.jsxs("div",{className:"content",style:{visibility:"hidden"},children:[me.jsxs("div",{className:"nav-head",children:[me.jsx("a",{href:"#",className:"a active",children:me.jsx("span",{children:"Main"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"About"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"Gallery"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"Contact"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"More"})}),me.jsx("div",{className:"cursor"})]}),me.jsxs("section",{className:"section first",children:[me.jsx("canvas",{ref:n,id:"container",className:"webgl"}),me.jsxs("div",{className:"info",children:[me.jsx("h2",{className:"name",children:"DEAGONIR"}),me.jsx("h1",{className:"title",children:"THREEJS"}),me.jsx("p",{className:"description",children:""})]})]}),me.jsxs("section",{className:"section second",children:[me.jsxs("div",{className:"second-container",children:[me.jsxs("ul",{children:[me.jsx("li",{id:"one",className:"active",children:"start"}),me.jsx("li",{id:"two",children:"running"}),me.jsx("li",{id:"three",children:"finished"})]}),me.jsx("p",{className:"text",id:"content",children:""})]}),me.jsx("canvas",{ref:e,id:"containerDetails",className:"webgl"})]})]})]})};var $Oe=`uniform vec3 iResolution; 
uniform float iTime;      \r

varying vec2 vUv;\r

#ifdef FAST_DESCENT\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -4.0));\r
const float cameraDist = 5.0;\r
const float speed = 3.0;\r
const float zoom = 2.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 2.5;\r
const float fogDensity = 0.6;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.5;\r
const float lightSpeed = 0.2;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#else\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -2.0));\r
const float cameraDist = 9.0;\r
const float speed = 1.0;\r
const float zoom = 3.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 7.0;\r
const float fogDensity = 0.7;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.0;\r
const float lightSpeed = 0.15;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#endif

const float tau = 6.283185;

float hash1(float p) {\r
  vec3 p3 = fract(p * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

float hash1(vec2 p2) {\r
  p2 = fract(p2 * vec2(5.3983, 5.4427));\r
  p2 += dot(p2.yx, p2.xy + vec2(21.5351, 14.3137));\r
  return fract(p2.x * p2.y * 95.4337);\r
}

float hash1(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

vec2 hash2(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.xx + p3.yz) * p3.zy);\r
}

vec3 hash3(vec2 p2) {\r
  vec3 p3 = fract(vec3(p2.xyx) * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yxz + 19.19);\r
  return fract((p3.xxy + p3.yzz) * p3.zyx);\r
}

vec4 hash4(vec2 p2) {\r
  vec4 p4 = fract(p2.xyxy * vec4(5.3983, 5.4427, 6.9371, 7.1283));\r
  p4 += dot(p4, p4.yxwz + 19.19);\r
  return fract((p4.xxxy + p4.yyzz + p4.zwww) * p4.wzyx);\r
}

float noise(vec2 p) {\r
  vec2 i = floor(p);\r
  vec2 f = fract(p);\r
  vec2 u = f * f * (3.0 - 2.0 * f);\r
  return mix(mix(hash1(i + vec2(0.0, 0.0)), hash1(i + vec2(1.0, 0.0)), u.x),\r
             mix(hash1(i + vec2(0.0, 1.0)), hash1(i + vec2(1.0, 1.0)), u.x),\r
             u.y);\r
}

vec4 castRay(vec3 eye, vec3 ray, vec2 center) {\r
  vec2 block = floor(eye.xy);\r
  vec3 ri = 1.0 / ray;\r
  vec3 rs = sign(ray);\r
  vec3 side = 0.5 + 0.5 * rs;\r
  vec2 ris = ri.xy * rs.xy;\r
  vec2 dis = (block - eye.xy + 0.5 + rs.xy * 0.5) * ri.xy;

  for (int i = 0; i < 16; ++i) {\r
    float d = dot(block - center, cameraDir.xy);\r
    float height = 3.0 * hash1(block) - 1.0 + 1.5 * d - 0.1 * d * d;

    vec2 lo0 = vec2(block);\r
    vec2 loX = vec2(0.45, 0.45);\r
    vec2 hi0 = vec2(block + 0.55);\r
    vec2 hiX = vec2(0.45, 0.45);

    float dist = 500.0;\r
    float face = 0.0;

    {\r
      vec4 signHash = hash4(block);\r
      vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
      float width = 0.06 + 0.1 * signHash.w;

      vec3 lo = vec3(center.x - width, 0.55, -100.0);\r
      vec3 hi = vec3(center.x + width, 0.99, center.y + width + height);

      float s = step(0.5, signHash.z);\r
      lo = vec3(block, 0.0) + mix(lo, lo.yxz, s);\r
      hi = vec3(block, 0.0) + mix(hi, hi.yxz, s);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    for (int j = 0; j < 5; ++j) {\r
      float top = height - 0.4 * float(j);\r
      vec3 lo = vec3(lo0 + loX * hash2(block, float(j)), -100.0);\r
      vec3 hi = vec3(hi0 + hiX * hash2(block, float(j) + 0.5), top);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5 && maxT < dist) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    if (dist < 400.0) {\r
      return vec4(dist, height, face, 1.0);\r
    }

    float t = eye.z * ri.z;\r
    vec3 p = eye - t * ray;\r
    vec2 g = p.xy - block;

    vec2 dim = step(dis.xy, dis.yx);\r
    dis += dim * ris;\r
    block += dim * rs.xy;\r
  }

  return vec4(100.0, 0.0, 0.0, 1.0);\r
}

vec3 window(float z, vec2 pos, vec2 id) {\r
  float windowSize = 0.03 + 0.12 * hash1(id + 0.1);\r
  float windowProb = 0.3 + 0.8 * hash1(id + 0.2);\r
  float depth = z / windowSize;\r
  float level = floor(depth);\r
  vec3 colorA = mix(windowColorA, windowColorB, hash3(id));\r
  vec3 colorB = mix(windowColorA, windowColorB, hash3(id + 0.1));\r
  vec3 color = mix(colorA, colorB, hash1(id, level));\r
  color *= 0.3 +\r
           0.7 * smoothstep(0.1, 0.5, noise(20.0 * pos + 100.0 * hash1(level)));\r
  color *=\r
      smoothstep(windowProb - 0.2, windowProb + 0.2, hash1(id, level + 0.1));\r
  return color * (0.5 - 0.5 * cos(tau * depth));\r
}

vec3 addLight(vec3 eye, vec3 ray, float res, float time, float height) {\r
  vec2 q = eye.xy + ((height - eye.z) / ray.z) * ray.xy;

  float row = floor(q.x + 0.5);\r
  time += hash1(row);\r
  float col = floor(0.125 * q.y - time);

  float pos = 0.4 + 0.4 * cos(time + tau * hash1(vec2(row, col)));\r
  vec3 lightPos = vec3(row, 8.0 * (col + time + pos), height);\r
  vec3 lightDir = vec3(0.0, 1.0, 0.0);

  
  vec3 w = eye - lightPos;\r
  float a = dot(ray, ray);\r
  float b = dot(ray, lightDir);\r
  float c = dot(lightDir, lightDir);\r
  float d = dot(ray, w);\r
  float e = dot(lightDir, w);\r
  float D = a * c - b * b;\r
  float s = (b * e - c * d) / D;\r
  float t = (a * e - b * d) / D;

  t = max(t, 0.0);\r
  float dist = distance(eye + s * ray, lightPos + t * lightDir);

  float mask = smoothstep(res + 0.1, res, s);\r
  float light =\r
      min(1.0 / pow(200.0 * dist * dist / t + 20.0 * t * t, 0.8), 2.0);\r
  float fog = exp(-fogDensity * max(s - fogOffset, 0.0));\r
  vec3 color = mix(lightColorA, lightColorB, hash3(vec2(row, col)));\r
  return mask * light * fog * color;\r
}

vec3 addSign(vec3 color, vec3 pos, float side, vec2 id) {\r
  vec4 signHash = hash4(id);\r
  float s = step(0.5, signHash.z);\r
  if ((s - 0.5) * side < 0.1)\r
    return color;

  vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
  vec2 p = mix(pos.xz, pos.yz, s);\r
  float halfWidth = 0.04 + 0.06 * signHash.w;

  float charCount = floor(1.0 + 8.0 * hash1(id + 0.5));\r
  if (center.y - p.y > 2.0 * halfWidth * (charCount + 1.0)) {\r
    center.y -= 2.0 * halfWidth * (charCount + 1.5 + 5.0 * hash1(id + 0.6));\r
    charCount = floor(2.0 + 12.0 * hash1(id + 0.7));\r
    id += 0.05;\r
  }

  vec3 signColor = mix(signColorA, signColorB, hash3(id + 0.5));\r
  vec3 outlineColor = mix(signColorA, signColorB, hash3(id + 0.6));\r
  float flash = 6.0 - 24.0 * hash1(id + 0.8);\r
  flash *= step(3.0, flash);\r
  flash = smoothstep(0.1, 0.5, 0.5 + 0.5 * cos(flash * iTime));

  vec2 halfSize = vec2(halfWidth, halfWidth * charCount);\r
  center.y -= halfSize.y;\r
  float outline = length(max(abs(p - center) - halfSize, 0.0)) / halfWidth;\r
  color *= smoothstep(0.1, 0.4, outline);

  vec2 charPos = 0.5 * (p - center + halfSize) / halfWidth;\r
  vec2 charId = id + 0.05 + 0.1 * floor(charPos);\r
  float flicker = hash1(charId);\r
  flicker = step(0.93, flicker);\r
  flicker = 1.0 - flicker * step(0.96, hash1(charId, iTime));

  float char = -3.5 + 8.0 * noise(id + 6.0 * charPos);\r
  charPos = fract(charPos);\r
  char *= smoothstep(0.0, 0.4, charPos.x) * smoothstep(1.0, 0.6, charPos.x);\r
  char *= smoothstep(0.0, 0.4, charPos.y) * smoothstep(1.0, 0.6, charPos.y);\r
  color = mix(color, signColor,\r
              flash * flicker * step(outline, 0.01) * clamp(char, 0.0, 1.0));

  outline = smoothstep(0.0, 0.2, outline) * smoothstep(0.5, 0.3, outline);\r
  return mix(color, outlineColor, flash * outline);\r
}

void main() {\r
  vec2 center = -speed * iTime * cameraDir.xy;\r
  vec3 eye = vec3(center, 0.0) - cameraDist * cameraDir;

  vec3 forward = normalize(cameraDir);\r
  vec3 right = normalize(cross(forward, vec3(0.0, 0.0, 1.0)));\r
  vec3 up = cross(right, forward);\r
  
  vec2 xy = vUv - 0.5;\r
  
  
  vec3 ray = normalize(xy.x * right + xy.y * up + zoom * forward * 0.4);

  vec4 res = castRay(eye, ray, center);\r
  vec3 p = eye + res.x * ray;

  vec2 block = floor(p.xy);\r
  vec3 color = window(p.z - res.y, p.xy, block);

  color = addSign(color, vec3(p.xy - block, p.z - res.y), res.z, block);\r
  color = mix(vec3(0.0), color, abs(res.z));

  float fog = exp(-fogDensity * max(res.x - fogOffset, 0.0));\r
  color = mix(fogColor, color, fog);

  float time = lightSpeed * iTime;\r
  color += addLight(eye.xyz, ray.xyz, res.x, time, lightHeight - 0.6);\r
  color += addLight(eye.yxz, ray.yxz, res.x, time, lightHeight - 0.4);\r
  color += addLight(vec3(-eye.xy, eye.z), vec3(-ray.xy, ray.z), res.x, time,\r
                    lightHeight - 0.2);\r
  color += addLight(vec3(-eye.yx, eye.z), vec3(-ray.yx, ray.z), res.x, time,\r
                    lightHeight);

#ifdef BLACK_AND_WHITE\r
  float c = clamp(dot(vec3(0.4, 0.3, 0.4), color), 0.0, 1.0);\r
  c = 1.0 - pow(1.0 - pow(c, 2.0), 4.0);\r
  color = vec3(c);\r
#endif

  gl_FragColor = vec4(color, 1.0);\r
}`;const qOe=()=>{let n=null,e=null,t=null,r=null,i=null,s=Ae.useRef(null);const a=()=>{r={width:s.current.clientWidth,height:s.current.clientHeight},n=new Tl,n.fog=new yw(1710618,1,1e3),n.background=new Vn(1710618),e=new ts(70,r.width/r.height,.01,1e3),e.position.set(0,0,5),n.add(e),t=new x1(14609919,3),n.add(t),i=new Yl({canvas:s.current,alpha:!0,antialias:!0}),i.setSize(r.width,r.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2));const h=new Lv(e,i.domElement);h.enableDamping=!0,n.add(h)},l=()=>{const{x:h,y:d}=i.getDrawingBufferSize(new nn),m=new Io({vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:$Oe,uniforms:{iResolution:{value:new Ze(h,d)},iTime:{value:0}}}),v=new Ii(new tg(5,5),m);v.onBeforeRender=()=>{m.uniforms.iTime.value+=.01},n.add(v)},o=()=>{i.render(n,e),requestAnimationFrame(o)};return Ae.useEffect(()=>{a(),l(),o()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-full h-full",ref:s})})},ZOe=()=>{let n=null,e=null,t=null,r=Ae.useRef(null),i,s,a;const l=()=>{i=new _p(5,5,5),s=new _o({color:16711680}),a=new Ii(i,s);let h={width:r.current.clientWidth,height:r.current.clientHeight};n=new Tl,n.add(a),e=new ts(70,h.width/h.height,.01,1e3),e.position.z=10,t=new Yl({canvas:r.current,antialias:!0}),t.setSize(h.width,h.height)},o=()=>{a&&(a.rotation.y+=.02),a&&(a.rotation.x+=.02),t.render(n,e),requestAnimationFrame(o)};return Ae.useEffect(()=>{l(),o()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-full h-full",ref:r})})},YOe="/about_portfolio/assets/cat-DI6FY0oP.mp3",KOe="/about_portfolio/assets/cow-D6Dskg5A.mp3",JOe="/about_portfolio/assets/bg-BEcaSD04.png",Tle="/about_portfolio/assets/perlinnoise-D9vz38ra.png",Mle="/about_portfolio/assets/sparknoise-C0zIzS_R.png",uK=new Ze,Wk=new nT,Xk=new Ze;class Cle{constructor(e,t){this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let r=0,i=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(m){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(m.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0},this.onPointerUp=function(m){if(this.activeLook)switch(m.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1},this.onPointerMove=function(m){this.domElement===document?(this.pointerX=m.pageX-this.viewHalfX,this.pointerY=m.pageY-this.viewHalfY):(this.pointerX=m.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=m.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(m){switch(m.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}},this.onKeyUp=function(m){switch(m.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}},this.lookAt=function(m,v,y){return m.isVector3?Xk.copy(m):Xk.set(m,v,y),this.object.lookAt(Xk),d(this),this},this.update=function(){const m=new Ze;return function(y){if(this.enabled===!1)return;if(this.heightSpeed){const q=no.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=y*(q*this.heightCoef)}else this.autoSpeedFactor=0;const S=y*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(S+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(S),this.moveLeft&&this.object.translateX(-S),this.moveRight&&this.object.translateX(S),this.moveUp&&this.object.translateY(S),this.moveDown&&this.object.translateY(-S);let E=y*this.lookSpeed;this.activeLook||(E=0);let M=1;this.constrainVertical&&(M=Math.PI/(this.verticalMax-this.verticalMin)),i-=this.pointerX*E,this.lookVertical&&(r-=this.pointerY*E*M),r=Math.max(-85,Math.min(85,r));let C=no.degToRad(90-r);const L=no.degToRad(i);this.constrainVertical&&(C=no.mapLinear(C,0,Math.PI,this.verticalMin,this.verticalMax));const k=this.object.position;m.setFromSphericalCoords(1,C,L).add(k),this.object.lookAt(m)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",hK),this.domElement.removeEventListener("pointerdown",a),this.domElement.removeEventListener("pointermove",s),this.domElement.removeEventListener("pointerup",l),window.removeEventListener("keydown",o),window.removeEventListener("keyup",h)};const s=this.onPointerMove.bind(this),a=this.onPointerDown.bind(this),l=this.onPointerUp.bind(this),o=this.onKeyDown.bind(this),h=this.onKeyUp.bind(this);this.domElement.addEventListener("contextmenu",hK),this.domElement.addEventListener("pointerdown",a),this.domElement.addEventListener("pointermove",s),this.domElement.addEventListener("pointerup",l),window.addEventListener("keydown",o),window.addEventListener("keyup",h);function d(m){const v=m.object.quaternion;uK.set(0,0,-1).applyQuaternion(v),Wk.setFromVector3(uK),r=90-no.radToDeg(Wk.phi),i=no.radToDeg(Wk.theta)}this.handleResize(),d(this)}}function hK(n){n.preventDefault()}const QOe=()=>{const n=Ae.useRef(null);let e,t,r,i=null,s={width:0,height:0};const a=()=>{s.width=window.innerWidth,s.height=window.innerHeight,t.aspect=s.width/s.height,t.updateProjectionMatrix(),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2))},l=()=>{s.width=window.innerWidth,s.height=window.innerHeight,e=new Tl,t=new ts(50,s.width/s.height,1,1e5),t.position.set(-200,25,0),t.lookAt(.1,.1,.1),e.add(t),r=new Yl({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.render(e,t);const v=new Pv(16777215,1);v.position.set(0,.5,1).normalize(),e.add(v),i=new Cle(t,r.domElement),i.movementSpeed=50,i.lookSpeed=.1,i.noFly=!0,i.lookVertical=!1},o=()=>{e.background=new Kf().load(JOe),h(KOe,Tle,0,20,-50),h(YOe,Mle,0,20,50)},h=(v,y,S,E,M)=>{let C=new Pne;t.add(C);let L=new Ii(new _p(40,40,40),new _o({map:new Kf().load(y)}));L.position.set(S,E,M),e.add(L);var k=new Dne(C),H=new Rne;H.load(v,q=>{k.setBuffer(q),k.setRefDistance(30),k.play(),k.setRolloffFactor(10),k.setLoop(!0)})},d=new ng,m=()=>{r.render(e,t),i.update(d.getDelta()),requestAnimationFrame(m)};return Ae.useEffect(()=>(l(),o(),m(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}),[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-screen h-screen",ref:n})})},eFe="/about_portfolio/assets/px-DZeywvNe.jpg",tFe="/about_portfolio/assets/nx-gXUpNenc.jpg",nFe="/about_portfolio/assets/py-DXf_Q1NF.jpg",rFe="/about_portfolio/assets/ny-Bo9il99d.jpg",iFe="/about_portfolio/assets/pz-BKu-NtuL.jpg",sFe="/about_portfolio/assets/nz-D5GMLchw.jpg",oFe="/about_portfolio/assets/iphone-D4eE8fd6.glb",aFe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);let t,r,i,s=null,a={width:0,height:0};const l=()=>{t=new Tl,a.width=window.innerWidth,a.height=window.innerHeight,r=new ts(75,a.width/a.height,.1,1e3),r.position.set(0,0,20),r.lookAt(new Ze(0,0,0)),t.add(r),i=new Yl({canvas:n.current,antialias:!0,alpha:!0}),i.setSize(a.width,a.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),i.physicallyCorrectLights=!0,i.toneMapping=WL,i.toneMappingExposure=2,i.outputColorSpace=To,s=new Cle(r,i.domElement),s.movementSpeed=30,s.lookSpeed=.1,s.noFly=!0};let o=null;const h=()=>{o=new Sne().load([eFe,tFe,nFe,rFe,iFe,sFe]),o.colorSpace=To,t.background=o,t.environment=o};let d=null,m={mesh:null,material:null,videoMaterial:null};const v=()=>{const C=new nne(e.current),L=new Wo({map:C,envMap:o});m.videoMaterial=L;const k=new U8;k.setDecoderPath("/draco/"),k.setDecoderConfig({type:"js"});const H=new l3;H.setDRACOLoader(k),H.load(oFe,q=>{q.scene&&(q.scene.traverse(Z=>{Z instanceof Ii&&Z.material instanceof fp&&(Z.material.envMap=o,Z.material.envMapIntensity=2,Z.name===""&&(m.mesh=Z,m.material=Z.material),Z.name.includes("logo")&&(Z.material.metalness=1))}),d=q.scene,d.scale.set(60,60,60),d.position.y=-5,d.rotation.y=-Math.PI,t.add(d))})},y=()=>{const C=new bD,L=new nn;window.addEventListener("click",k=>{L.x=k.clientX/a.width*2-1,L.y=-(k.clientY/a.height)*2+1,C.setFromCamera(L,r);const H=C.intersectObjects([m.mesh]);if(H.length>0){const q=H[0].object;q.material.type==="MeshStandardMaterial"?q.material=m.videoMaterial:q.material=m.material}})},S=()=>{a.width=window.innerWidth,a.height=window.innerHeight,r.aspect=a.width/a.height,r.updateProjectionMatrix(),i.setSize(a.width,a.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2))},E=new ng,M=()=>{i.render(t,r),s.update(E.getDelta()),requestAnimationFrame(M)};return Ae.useEffect(()=>(l(),h(),v(),y(),M(),window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}),[]),me.jsxs("div",{className:"w-screen h-screen",children:[me.jsx("canvas",{ref:n}),me.jsx("video",{className:"invisible fixed t-0 l-0",ref:e,src:"/src/assets/video/demo.mp4",muted:!0,autoPlay:!0,type:"mp4",loop:!0}),me.jsxs("div",{className:"w-64 h-12 bg-black-500 fixed top-0 left-1/2 -ml-32 rounded-b-md flex items-center py-3",children:[me.jsxs("svg",{className:"ml-4",width:"26",height:"26",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[me.jsx("path",{d:"M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z",fill:"none",stroke:"#FFF",strokeWidth:"4"}),me.jsx("path",{d:"M24 19H12V29H24V19Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"}),me.jsx("path",{d:"M35 18L30 22V26L35 30V18Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"})]}),me.jsx("span",{className:"text-white text-lg align-middle pl-2",children:""})]})]})},Ele=typeof document<"u"?$l.useLayoutEffect:()=>{};function lFe(n){const e=Ae.useRef(null);return Ele(()=>{e.current=n},[n]),Ae.useCallback((...t)=>{const r=e.current;return r==null?void 0:r(...t)},[])}const dM=n=>{var e;return(e=n==null?void 0:n.ownerDocument)!==null&&e!==void 0?e:document},Ey=n=>n&&"window"in n&&n.window===n?n:dM(n).defaultView||window;function cFe(n){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(t=>n.test(t.brand)))||n.test(window.navigator.userAgent)}function uFe(n){var e;return typeof window<"u"&&window.navigator!=null?n.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Ile(n){let e=null;return()=>(e==null&&(e=n()),e)}const hFe=Ile(function(){return uFe(/^Mac/i)}),fFe=Ile(function(){return cFe(/Android/i)});function dFe(n){return n.mozInputSource===0&&n.isTrusted?!0:fFe()&&n.pointerType?n.type==="click"&&n.buttons===1:n.detail===0&&!n.pointerType}class pFe{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=e}}function Rle(n){let e=Ae.useRef({isFocused:!1,observer:null});Ele(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=lFe(r=>{n==null||n(r)});return Ae.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=r.target,s=a=>{e.current.isFocused=!1,i.disabled&&t(new pFe("blur",a)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",s,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let l=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:l})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:l}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function mFe(n){let{isDisabled:e,onFocus:t,onBlur:r,onFocusChange:i}=n;const s=Ae.useCallback(o=>{if(o.target===o.currentTarget)return r&&r(o),i&&i(!1),!0},[r,i]),a=Rle(s),l=Ae.useCallback(o=>{const h=dM(o.target);o.target===o.currentTarget&&h.activeElement===o.target&&(t&&t(o),i&&i(!0),a(o))},[i,t,a]);return{focusProps:{onFocus:!e&&(t||i||r)?l:void 0,onBlur:!e&&(r||i)?s:void 0}}}let pM=null,az=new Set,vA=new Map,c1=!1,lz=!1;const gFe={Tab:!0,Escape:!0};function G8(n,e){for(let t of az)t(n,e)}function vFe(n){return!(n.metaKey||!hFe()&&n.altKey||n.ctrlKey||n.key==="Control"||n.key==="Shift"||n.key==="Meta")}function iL(n){c1=!0,vFe(n)&&(pM="keyboard",G8("keyboard",n))}function bh(n){pM="pointer",(n.type==="mousedown"||n.type==="pointerdown")&&(c1=!0,G8("pointer",n))}function Ple(n){dFe(n)&&(c1=!0,pM="virtual")}function Lle(n){n.target===window||n.target===document||(!c1&&!lz&&(pM="virtual",G8("virtual",n)),c1=!1,lz=!1)}function Dle(){c1=!1,lz=!0}function cz(n){if(typeof window>"u"||vA.get(Ey(n)))return;const e=Ey(n),t=dM(n);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){c1=!0,r.apply(this,arguments)},t.addEventListener("keydown",iL,!0),t.addEventListener("keyup",iL,!0),t.addEventListener("click",Ple,!0),e.addEventListener("focus",Lle,!0),e.addEventListener("blur",Dle,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",bh,!0),t.addEventListener("pointermove",bh,!0),t.addEventListener("pointerup",bh,!0)):(t.addEventListener("mousedown",bh,!0),t.addEventListener("mousemove",bh,!0),t.addEventListener("mouseup",bh,!0)),e.addEventListener("beforeunload",()=>{Ble(n)},{once:!0}),vA.set(e,{focus:r})}const Ble=(n,e)=>{const t=Ey(n),r=dM(n);e&&r.removeEventListener("DOMContentLoaded",e),vA.has(t)&&(t.HTMLElement.prototype.focus=vA.get(t).focus,r.removeEventListener("keydown",iL,!0),r.removeEventListener("keyup",iL,!0),r.removeEventListener("click",Ple,!0),t.removeEventListener("focus",Lle,!0),t.removeEventListener("blur",Dle,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",bh,!0),r.removeEventListener("pointermove",bh,!0),r.removeEventListener("pointerup",bh,!0)):(r.removeEventListener("mousedown",bh,!0),r.removeEventListener("mousemove",bh,!0),r.removeEventListener("mouseup",bh,!0)),vA.delete(t))};function _Fe(n){const e=dM(n);let t;return e.readyState!=="loading"?cz(n):(t=()=>{cz(n)},e.addEventListener("DOMContentLoaded",t)),()=>Ble(n,t)}typeof document<"u"&&_Fe();function kle(){return pM!=="pointer"}const yFe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function xFe(n,e,t){var r;const i=typeof window<"u"?Ey(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,s=typeof window<"u"?Ey(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,a=typeof window<"u"?Ey(t==null?void 0:t.target).HTMLElement:HTMLElement,l=typeof window<"u"?Ey(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return n=n||(t==null?void 0:t.target)instanceof i&&!yFe.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof s||(t==null?void 0:t.target)instanceof a&&(t==null?void 0:t.target.isContentEditable),!(n&&e==="keyboard"&&t instanceof l&&!gFe[t.key])}function bFe(n,e,t){cz(),Ae.useEffect(()=>{let r=(i,s)=>{xFe(!!(t!=null&&t.isTextInput),i,s)&&n(kle())};return az.add(r),()=>{az.delete(r)}},e)}function wFe(n){let{isDisabled:e,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:i}=n,s=Ae.useRef({isFocusWithin:!1}),a=Ae.useCallback(h=>{s.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(s.current.isFocusWithin=!1,t&&t(h),i&&i(!1))},[t,i,s]),l=Rle(a),o=Ae.useCallback(h=>{!s.current.isFocusWithin&&document.activeElement===h.target&&(r&&r(h),i&&i(!0),s.current.isFocusWithin=!0,l(h))},[r,i,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:o,onBlur:a}}}let sL=!1,$k=0;function uz(){sL=!0,setTimeout(()=>{sL=!1},50)}function fK(n){n.pointerType==="touch"&&uz()}function SFe(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",fK):document.addEventListener("touchend",uz),$k++,()=>{$k--,!($k>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",fK):document.removeEventListener("touchend",uz))}}function AFe(n){let{onHoverStart:e,onHoverChange:t,onHoverEnd:r,isDisabled:i}=n,[s,a]=Ae.useState(!1),l=Ae.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;Ae.useEffect(SFe,[]);let{hoverProps:o,triggerHoverEnd:h}=Ae.useMemo(()=>{let d=(y,S)=>{if(l.pointerType=S,i||S==="touch"||l.isHovered||!y.currentTarget.contains(y.target))return;l.isHovered=!0;let E=y.currentTarget;l.target=E,e&&e({type:"hoverstart",target:E,pointerType:S}),t&&t(!0),a(!0)},m=(y,S)=>{if(l.pointerType="",l.target=null,S==="touch"||!l.isHovered)return;l.isHovered=!1;let E=y.currentTarget;r&&r({type:"hoverend",target:E,pointerType:S}),t&&t(!1),a(!1)},v={};return typeof PointerEvent<"u"?(v.onPointerEnter=y=>{sL&&y.pointerType==="mouse"||d(y,y.pointerType)},v.onPointerLeave=y=>{!i&&y.currentTarget.contains(y.target)&&m(y,y.pointerType)}):(v.onTouchStart=()=>{l.ignoreEmulatedMouseEvents=!0},v.onMouseEnter=y=>{!l.ignoreEmulatedMouseEvents&&!sL&&d(y,"mouse"),l.ignoreEmulatedMouseEvents=!1},v.onMouseLeave=y=>{!i&&y.currentTarget.contains(y.target)&&m(y,"mouse")}),{hoverProps:v,triggerHoverEnd:m}},[e,t,r,i,l]);return Ae.useEffect(()=>{i&&h({currentTarget:l.target},l.pointerType)},[i]),{hoverProps:o,isHovered:s}}function TFe(n={}){let{autoFocus:e=!1,isTextInput:t,within:r}=n,i=Ae.useRef({isFocused:!1,isFocusVisible:e||kle()}),[s,a]=Ae.useState(!1),[l,o]=Ae.useState(()=>i.current.isFocused&&i.current.isFocusVisible),h=Ae.useCallback(()=>o(i.current.isFocused&&i.current.isFocusVisible),[]),d=Ae.useCallback(y=>{i.current.isFocused=y,a(y),h()},[h]);bFe(y=>{i.current.isFocusVisible=y,h()},[],{isTextInput:t});let{focusProps:m}=mFe({isDisabled:r,onFocusChange:d}),{focusWithinProps:v}=wFe({isDisabled:!r,onFocusWithinChange:d});return{isFocused:s,isFocusVisible:l,focusProps:r?v:m}}var MFe=Object.defineProperty,CFe=(n,e,t)=>e in n?MFe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qk=(n,e,t)=>(CFe(n,typeof e!="symbol"?e+"":e,t),t);let EFe=class{constructor(){qk(this,"current",this.detect()),qk(this,"handoffState","pending"),qk(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Vy=new EFe;function Lw(n){return Vy.isServer?null:n instanceof Node?n.ownerDocument:n!=null&&n.hasOwnProperty("current")&&n.current instanceof Node?n.current.ownerDocument:document}function Ole(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}function wp(){let n=[],e={addEventListener(t,r,i,s){return t.addEventListener(r,i,s),e.add(()=>t.removeEventListener(r,i,s))},requestAnimationFrame(...t){let r=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let r=setTimeout(...t);return e.add(()=>clearTimeout(r))},microTask(...t){let r={current:!0};return Ole(()=>{r.current&&t[0]()}),e.add(()=>{r.current=!1})},style(t,r,i){let s=t.style.getPropertyValue(r);return Object.assign(t.style,{[r]:i}),this.add(()=>{Object.assign(t.style,{[r]:s})})},group(t){let r=wp();return t(r),this.add(()=>r.dispose())},add(t){return n.includes(t)||n.push(t),()=>{let r=n.indexOf(t);if(r>=0)for(let i of n.splice(r,1))i()}},dispose(){for(let t of n.splice(0))t()}};return e}function c3(){let[n]=Ae.useState(wp);return Ae.useEffect(()=>()=>n.dispose(),[n]),n}let Ca=(n,e)=>{Vy.isServer?Ae.useEffect(n,e):Ae.useLayoutEffect(n,e)};function mM(n){let e=Ae.useRef(n);return Ca(()=>{e.current=n},[n]),e}let Co=function(n){let e=mM(n);return $l.useCallback((...t)=>e.current(...t),[e])};function IFe(n){let e=n.width/2,t=n.height/2;return{top:n.clientY-t,right:n.clientX+e,bottom:n.clientY+t,left:n.clientX-e}}function RFe(n,e){return!(!n||!e||n.right<e.left||n.left>e.right||n.bottom<e.top||n.top>e.bottom)}function PFe({disabled:n=!1}={}){let e=Ae.useRef(null),[t,r]=Ae.useState(!1),i=c3(),s=Co(()=>{e.current=null,r(!1),i.dispose()}),a=Co(l=>{if(i.dispose(),e.current===null){e.current=l.currentTarget,r(!0);{let o=Lw(l.currentTarget);i.addEventListener(o,"pointerup",s,!1),i.addEventListener(o,"pointermove",h=>{if(e.current){let d=IFe(h);r(RFe(d,e.current.getBoundingClientRect()))}},!1),i.addEventListener(o,"pointercancel",s,!1)}}});return{pressed:t,pressProps:n?{}:{onPointerDown:a,onPointerUp:s,onClick:s}}}let LFe=Ae.createContext(void 0);function Fle(){return Ae.useContext(LFe)}function dK(...n){return Array.from(new Set(n.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function gM(n,e,...t){if(n in e){let i=e[n];return typeof i=="function"?i(...t):i}let r=new Error(`Tried to handle "${n}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,gM),r}var hz=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(hz||{}),DFe=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(DFe||{});function zh(){let n=kFe();return Ae.useCallback(e=>BFe({mergeRefs:n,...e}),[n])}function BFe({ourProps:n,theirProps:e,slot:t,defaultTag:r,features:i,visible:s=!0,name:a,mergeRefs:l}){l=l??OFe;let o=Nle(e,n);if(s)return _I(o,t,r,a,l);let h=i??0;if(h&2){let{static:d=!1,...m}=o;if(d)return _I(m,t,r,a,l)}if(h&1){let{unmount:d=!0,...m}=o;return gM(d?0:1,{0(){return null},1(){return _I({...m,hidden:!0,style:{display:"none"}},t,r,a,l)}})}return _I(o,t,r,a,l)}function _I(n,e={},t,r,i){let{as:s=t,children:a,refName:l="ref",...o}=Zk(n,["unmount","static"]),h=n.ref!==void 0?{[l]:n.ref}:{},d=typeof a=="function"?a(e):a;"className"in o&&o.className&&typeof o.className=="function"&&(o.className=o.className(e)),o["aria-labelledby"]&&o["aria-labelledby"]===o.id&&(o["aria-labelledby"]=void 0);let m={};if(e){let v=!1,y=[];for(let[S,E]of Object.entries(e))typeof E=="boolean"&&(v=!0),E===!0&&y.push(S.replace(/([A-Z])/g,M=>`-${M.toLowerCase()}`));if(v){m["data-headlessui-state"]=y.join(" ");for(let S of y)m[`data-${S}`]=""}}if(s===Ae.Fragment&&(Object.keys(Hx(o)).length>0||Object.keys(Hx(m)).length>0))if(!Ae.isValidElement(d)||Array.isArray(d)&&d.length>1){if(Object.keys(Hx(o)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Hx(o)).concat(Object.keys(Hx(m))).map(v=>`  - ${v}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>`  - ${v}`).join(`
`)].join(`
`))}else{let v=d.props,y=v==null?void 0:v.className,S=typeof y=="function"?(...C)=>dK(y(...C),o.className):dK(y,o.className),E=S?{className:S}:{},M=Nle(d.props,Hx(Zk(o,["ref"])));for(let C in m)C in M&&delete m[C];return Ae.cloneElement(d,Object.assign({},M,m,h,{ref:i(FFe(d),h.ref)},E))}return Ae.createElement(s,Object.assign({},Zk(o,["ref"]),s!==Ae.Fragment&&h,s!==Ae.Fragment&&m),d)}function kFe(){let n=Ae.useRef([]),e=Ae.useCallback(t=>{for(let r of n.current)r!=null&&(typeof r=="function"?r(t):r.current=t)},[]);return(...t)=>{if(!t.every(r=>r==null))return n.current=t,e}}function OFe(...n){return n.every(e=>e==null)?void 0:e=>{for(let t of n)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function Nle(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])for(let r in t)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(t[r]=[i=>{var s;return(s=i==null?void 0:i.preventDefault)==null?void 0:s.call(i)}]);for(let r in t)Object.assign(e,{[r](i,...s){let a=t[r];for(let l of a){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;l(i,...s)}}});return e}function zle(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];for(let r in t)Object.assign(e,{[r](...i){let s=t[r];for(let a of s)a==null||a(...i)}});return e}function Uh(n){var e;return Object.assign(Ae.forwardRef(n),{displayName:(e=n.displayName)!=null?e:n.name})}function Hx(n){let e=Object.assign({},n);for(let t in e)e[t]===void 0&&delete e[t];return e}function Zk(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function FFe(n){return $l.version.split(".")[0]>="19"?n.props.ref:n.ref}let NFe=Ae.createContext(void 0);function zFe(){return Ae.useContext(NFe)}function UFe(n){let e=n.parentElement,t=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(t=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&GFe(t)?!1:r}function GFe(n){if(!n)return!1;let e=n.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}let Ule=Symbol();function VFe(n,e=!0){return Object.assign(n,{[Ule]:e})}function sg(...n){let e=Ae.useRef(n);Ae.useEffect(()=>{e.current=n},[n]);let t=Co(r=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return n.every(r=>r==null||(r==null?void 0:r[Ule]))?void 0:t}let V8=Ae.createContext(null);V8.displayName="DescriptionContext";function Gle(){let n=Ae.useContext(V8);if(n===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Gle),e}return n}function HFe(){let[n,e]=Ae.useState([]);return[n.length>0?n.join(" "):void 0,Ae.useMemo(()=>function(t){let r=Co(s=>(e(a=>[...a,s]),()=>e(a=>{let l=a.slice(),o=l.indexOf(s);return o!==-1&&l.splice(o,1),l}))),i=Ae.useMemo(()=>({register:r,slot:t.slot,name:t.name,props:t.props,value:t.value}),[r,t.slot,t.name,t.props,t.value]);return $l.createElement(V8.Provider,{value:i},t.children)},[e])]}let jFe="p";function WFe(n,e){let t=Ae.useId(),r=Fle(),{id:i=`headlessui-description-${t}`,...s}=n,a=Gle(),l=sg(e);Ca(()=>a.register(i),[i,a.register]);let o=r||!1,h=Ae.useMemo(()=>({...a.slot,disabled:o}),[a.slot,o]),d={ref:l,...a.props,id:i};return zh()({ourProps:d,theirProps:s,slot:h,defaultTag:jFe,name:a.name||"Description"})}let XFe=Uh(WFe);Object.assign(XFe,{});var yl=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(yl||{});let u3=Ae.createContext(null);u3.displayName="LabelContext";function H8(){let n=Ae.useContext(u3);if(n===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,H8),e}return n}function $Fe(n){var e,t,r;let i=(t=(e=Ae.useContext(u3))==null?void 0:e.value)!=null?t:void 0;return((r=void 0)!=null?r:0)>0?[i,...n].filter(Boolean).join(" "):i}function Vle({inherit:n=!1}={}){let e=$Fe(),[t,r]=Ae.useState([]),i=n?[e,...t].filter(Boolean):t;return[i.length>0?i.join(" "):void 0,Ae.useMemo(()=>function(s){let a=Co(o=>(r(h=>[...h,o]),()=>r(h=>{let d=h.slice(),m=d.indexOf(o);return m!==-1&&d.splice(m,1),d}))),l=Ae.useMemo(()=>({register:a,slot:s.slot,name:s.name,props:s.props,value:s.value}),[a,s.slot,s.name,s.props,s.value]);return $l.createElement(u3.Provider,{value:l},s.children)},[r])]}let qFe="label";function ZFe(n,e){var t;let r=Ae.useId(),i=H8(),s=zFe(),a=Fle(),{id:l=`headlessui-label-${r}`,htmlFor:o=s??((t=i.props)==null?void 0:t.htmlFor),passive:h=!1,...d}=n,m=sg(e);Ca(()=>i.register(l),[l,i.register]);let v=Co(M=>{let C=M.currentTarget;if(C instanceof HTMLLabelElement&&M.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(M),C instanceof HTMLLabelElement){let L=document.getElementById(C.htmlFor);if(L){let k=L.getAttribute("disabled");if(k==="true"||k==="")return;let H=L.getAttribute("aria-disabled");if(H==="true"||H==="")return;(L instanceof HTMLInputElement&&(L.type==="radio"||L.type==="checkbox")||L.role==="radio"||L.role==="checkbox"||L.role==="switch")&&L.click(),L.focus({preventScroll:!0})}}}),y=a||!1,S=Ae.useMemo(()=>({...i.slot,disabled:y}),[i.slot,y]),E={ref:m,...i.props,id:l,htmlFor:o,onClick:v};return h&&("onClick"in E&&(delete E.htmlFor,delete E.onClick),"onClick"in d&&delete d.onClick),zh()({ourProps:E,theirProps:d,slot:S,defaultTag:o?qFe:"div",name:i.name||"Label"})}let YFe=Uh(ZFe);Object.assign(YFe,{});function KFe(n){if(n===null)return{width:0,height:0};let{width:e,height:t}=n.getBoundingClientRect();return{width:e,height:t}}function JFe(n,e=!1){let[t,r]=Ae.useReducer(()=>({}),{}),i=Ae.useMemo(()=>KFe(n),[n,t]);return Ca(()=>{if(!n)return;let s=new ResizeObserver(r);return s.observe(n),()=>{s.disconnect()}},[n]),e?{width:`${i.width}px`,height:`${i.height}px`}:i}let QFe=class extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return t===void 0&&(t=this.factory(e),this.set(e,t)),t}};function Hle(n,e){let t=n(),r=new Set;return{getSnapshot(){return t},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...s){let a=e[i].call(t,...s);a&&(t=a,r.forEach(l=>l()))}}}function jle(n){return Ae.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getSnapshot)}let eNe=new QFe(()=>Hle(()=>[],{ADD(n){return this.includes(n)?this:[...this,n]},REMOVE(n){let e=this.indexOf(n);if(e===-1)return this;let t=this.slice();return t.splice(e,1),t}}));function j8(n,e){let t=eNe.get(e),r=Ae.useId(),i=jle(t);if(Ca(()=>{if(n)return t.dispatch("ADD",r),()=>t.dispatch("REMOVE",r)},[t,n]),!n)return!1;let s=i.indexOf(r),a=i.length;return s===-1&&(s=a,a+=1),s===a-1}let fz=new Map,_A=new Map;function pK(n){var e;let t=(e=_A.get(n))!=null?e:0;return _A.set(n,t+1),t!==0?()=>mK(n):(fz.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0,()=>mK(n))}function mK(n){var e;let t=(e=_A.get(n))!=null?e:1;if(t===1?_A.delete(n):_A.set(n,t-1),t!==1)return;let r=fz.get(n);r&&(r["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",r["aria-hidden"]),n.inert=r.inert,fz.delete(n))}function tNe(n,{allowed:e,disallowed:t}={}){let r=j8(n,"inert-others");Ca(()=>{var i,s;if(!r)return;let a=wp();for(let o of(i=t==null?void 0:t())!=null?i:[])o&&a.add(pK(o));let l=(s=e==null?void 0:e())!=null?s:[];for(let o of l){if(!o)continue;let h=Lw(o);if(!h)continue;let d=o.parentElement;for(;d&&d!==h.body;){for(let m of d.children)l.some(v=>m.contains(v))||a.add(pK(m));d=d.parentElement}}return a.dispose},[r,e,t])}function nNe(n,e,t){let r=mM(i=>{let s=i.getBoundingClientRect();s.x===0&&s.y===0&&s.width===0&&s.height===0&&t()});Ae.useEffect(()=>{if(!n)return;let i=e===null?null:e instanceof HTMLElement?e:e.current;if(!i)return;let s=wp();if(typeof ResizeObserver<"u"){let a=new ResizeObserver(()=>r.current(i));a.observe(i),s.add(()=>a.disconnect())}if(typeof IntersectionObserver<"u"){let a=new IntersectionObserver(()=>r.current(i));a.observe(i),s.add(()=>a.disconnect())}return()=>s.dispose()},[e,r,n])}let dz=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>`${n}:not([tabindex='-1'])`).join(","),rNe=["[data-autofocus]"].map(n=>`${n}:not([tabindex='-1'])`).join(",");var pz=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n[n.AutoFocus=64]="AutoFocus",n))(pz||{}),iNe=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(iNe||{}),sNe=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(sNe||{});function Wle(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(dz)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}function oNe(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(rNe)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var W8=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(W8||{});function X8(n,e=0){var t;return n===((t=Lw(n))==null?void 0:t.body)?!1:gM(e,{0(){return n.matches(dz)},1(){let r=n;for(;r!==null;){if(r.matches(dz))return!0;r=r.parentElement}return!1}})}function Xle(n){let e=Lw(n);wp().nextFrame(()=>{e&&!X8(e.activeElement,0)&&lNe(n)})}var aNe=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(aNe||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function lNe(n){n==null||n.focus({preventScroll:!0})}let cNe=["textarea","input"].join(",");function uNe(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,cNe))!=null?t:!1}function $le(n,e=t=>t){return n.slice().sort((t,r)=>{let i=e(t),s=e(r);if(i===null||s===null)return 0;let a=i.compareDocumentPosition(s);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function hNe(n,e){return fNe(Wle(),e,{relativeTo:n})}function fNe(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:i=[]}={}){let s=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n.ownerDocument,a=Array.isArray(n)?t?$le(n):n:e&64?oNe(n):Wle(n);i.length>0&&a.length>1&&(a=a.filter(y=>!i.some(S=>S!=null&&"current"in S?(S==null?void 0:S.current)===y:S===y))),r=r??s.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),o=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=e&32?{preventScroll:!0}:{},d=0,m=a.length,v;do{if(d>=m||d+m<=0)return 0;let y=o+d;if(e&16)y=(y+m)%m;else{if(y<0)return 3;if(y>=m)return 1}v=a[y],v==null||v.focus(h),d+=l}while(v!==s.activeElement);return e&6&&uNe(v)&&v.select(),2}function qle(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function dNe(){return/Android/gi.test(window.navigator.userAgent)}function pNe(){return qle()||dNe()}function uS(n,e,t,r){let i=mM(t);Ae.useEffect(()=>{if(!n)return;function s(a){i.current(a)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[n,e,r])}function mNe(n,e,t,r){let i=mM(t);Ae.useEffect(()=>{if(!n)return;function s(a){i.current(a)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[n,e,r])}const gK=30;function gNe(n,e,t){let r=j8(n,"outside-click"),i=mM(t),s=Ae.useCallback(function(o,h){if(o.defaultPrevented)return;let d=h(o);if(d===null||!d.getRootNode().contains(d)||!d.isConnected)return;let m=function v(y){return typeof y=="function"?v(y()):Array.isArray(y)||y instanceof Set?y:[y]}(e);for(let v of m)if(v!==null&&(v.contains(d)||o.composed&&o.composedPath().includes(v)))return;return!X8(d,W8.Loose)&&d.tabIndex!==-1&&o.preventDefault(),i.current(o,d)},[i,e]),a=Ae.useRef(null);uS(r,"pointerdown",o=>{var h,d;a.current=((d=(h=o.composedPath)==null?void 0:h.call(o))==null?void 0:d[0])||o.target},!0),uS(r,"mousedown",o=>{var h,d;a.current=((d=(h=o.composedPath)==null?void 0:h.call(o))==null?void 0:d[0])||o.target},!0),uS(r,"click",o=>{pNe()||a.current&&(s(o,()=>a.current),a.current=null)},!0);let l=Ae.useRef({x:0,y:0});uS(r,"touchstart",o=>{l.current.x=o.touches[0].clientX,l.current.y=o.touches[0].clientY},!0),uS(r,"touchend",o=>{let h={x:o.changedTouches[0].clientX,y:o.changedTouches[0].clientY};if(!(Math.abs(h.x-l.current.x)>=gK||Math.abs(h.y-l.current.y)>=gK))return s(o,()=>o.target instanceof HTMLElement?o.target:null)},!0),mNe(r,"blur",o=>s(o,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function $8(...n){return Ae.useMemo(()=>Lw(...n),[...n])}function vNe(n,e){return Ae.useMemo(()=>{var t;if(n.type)return n.type;let r=(t=n.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[n.type,n.as,e])}function _Ne(){let n;return{before({doc:e}){var t;let r=e.documentElement,i=(t=e.defaultView)!=null?t:window;n=Math.max(0,i.innerWidth-r.clientWidth)},after({doc:e,d:t}){let r=e.documentElement,i=Math.max(0,r.clientWidth-r.offsetWidth),s=Math.max(0,n-i);t.style(r,"paddingRight",`${s}px`)}}}function yNe(){return qle()?{before({doc:n,d:e,meta:t}){function r(i){return t.containers.flatMap(s=>s()).some(s=>s.contains(i))}e.microTask(()=>{var i;if(window.getComputedStyle(n.documentElement).scrollBehavior!=="auto"){let l=wp();l.style(n.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let s=(i=window.scrollY)!=null?i:window.pageYOffset,a=null;e.addEventListener(n,"click",l=>{if(l.target instanceof HTMLElement)try{let o=l.target.closest("a");if(!o)return;let{hash:h}=new URL(o.href),d=n.querySelector(h);d&&!r(d)&&(a=d)}catch{}},!0),e.addEventListener(n,"touchstart",l=>{if(l.target instanceof HTMLElement)if(r(l.target)){let o=l.target;for(;o.parentElement&&r(o.parentElement);)o=o.parentElement;e.style(o,"overscrollBehavior","contain")}else e.style(l.target,"touchAction","none")}),e.addEventListener(n,"touchmove",l=>{if(l.target instanceof HTMLElement){if(l.target.tagName==="INPUT")return;if(r(l.target)){let o=l.target;for(;o.parentElement&&o.dataset.headlessuiPortal!==""&&!(o.scrollHeight>o.clientHeight||o.scrollWidth>o.clientWidth);)o=o.parentElement;o.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let o=(l=window.scrollY)!=null?l:window.pageYOffset;s!==o&&window.scrollTo(0,s),a&&a.isConnected&&(a.scrollIntoView({block:"nearest"}),a=null)})})}}:{}}function xNe(){return{before({doc:n,d:e}){e.style(n.documentElement,"overflow","hidden")}}}function bNe(n){let e={};for(let t of n)Object.assign(e,t(e));return e}let Iy=Hle(()=>new Map,{PUSH(n,e){var t;let r=(t=this.get(n))!=null?t:{doc:n,count:0,d:wp(),meta:new Set};return r.count++,r.meta.add(e),this.set(n,r),this},POP(n,e){let t=this.get(n);return t&&(t.count--,t.meta.delete(e)),this},SCROLL_PREVENT({doc:n,d:e,meta:t}){let r={doc:n,d:e,meta:bNe(t)},i=[yNe(),_Ne(),xNe()];i.forEach(({before:s})=>s==null?void 0:s(r)),i.forEach(({after:s})=>s==null?void 0:s(r))},SCROLL_ALLOW({d:n}){n.dispose()},TEARDOWN({doc:n}){this.delete(n)}});Iy.subscribe(()=>{let n=Iy.getSnapshot(),e=new Map;for(let[t]of n)e.set(t,t.documentElement.style.overflow);for(let t of n.values()){let r=e.get(t.doc)==="hidden",i=t.count!==0;(i&&!r||!i&&r)&&Iy.dispatch(t.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",t),t.count===0&&Iy.dispatch("TEARDOWN",t)}});function wNe(n,e,t=()=>({containers:[]})){let r=jle(Iy),i=e?r.get(e):void 0,s=i?i.count>0:!1;return Ca(()=>{if(!(!e||!n))return Iy.dispatch("PUSH",e,t),()=>Iy.dispatch("POP",e,t)},[n,e]),s}function SNe(n,e,t=()=>[document.body]){let r=j8(n,"scroll-lock");wNe(r,e,i=>{var s;return{containers:[...(s=i.containers)!=null?s:[],t]}})}function vK(n){return[n.screenX,n.screenY]}function ANe(){let n=Ae.useRef([-1,-1]);return{wasMoved(e){let t=vK(e);return n.current[0]===t[0]&&n.current[1]===t[1]?!1:(n.current=t,!0)},update(e){n.current=vK(e)}}}function TNe(n=0){let[e,t]=Ae.useState(n),r=Ae.useCallback(o=>t(o),[e]),i=Ae.useCallback(o=>t(h=>h|o),[e]),s=Ae.useCallback(o=>(e&o)===o,[e]),a=Ae.useCallback(o=>t(h=>h&~o),[t]),l=Ae.useCallback(o=>t(h=>h^o),[t]);return{flags:e,setFlag:r,addFlag:i,hasFlag:s,removeFlag:a,toggleFlag:l}}var MNe={},_K,yK;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((_K=process==null?void 0:MNe)==null?void 0:_K.NODE_ENV)==="test"&&typeof((yK=Element==null?void 0:Element.prototype)==null?void 0:yK.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var CNe=(n=>(n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Enter=2]="Enter",n[n.Leave=4]="Leave",n))(CNe||{});function ENe(n){let e={};for(let t in n)n[t]===!0&&(e[`data-${t}`]="");return e}function INe(n,e,t,r){let[i,s]=Ae.useState(t),{hasFlag:a,addFlag:l,removeFlag:o}=TNe(n&&i?3:0),h=Ae.useRef(!1),d=Ae.useRef(!1),m=c3();return Ca(()=>{var v;if(n){if(t&&s(!0),!e){t&&l(3);return}return(v=void 0)==null||v.call(r,t),RNe(e,{inFlight:h,prepare(){d.current?d.current=!1:d.current=h.current,h.current=!0,!d.current&&(t?(l(3),o(4)):(l(4),o(2)))},run(){d.current?t?(o(3),l(4)):(o(4),l(3)):t?o(1):l(1)},done(){var y;d.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(h.current=!1,o(7),t||s(!1),(y=void 0)==null||y.call(r,t))}})}},[n,t,e,m]),n?[i,{closed:a(1),enter:a(2),leave:a(4),transition:a(2)||a(4)}]:[t,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function RNe(n,{prepare:e,run:t,done:r,inFlight:i}){let s=wp();return LNe(n,{prepare:e,inFlight:i}),s.nextFrame(()=>{t(),s.requestAnimationFrame(()=>{s.add(PNe(n,r))})}),s.dispose}function PNe(n,e){var t,r;let i=wp();if(!n)return i.dispose;let s=!1;i.add(()=>{s=!0});let a=(r=(t=n.getAnimations)==null?void 0:t.call(n).filter(l=>l instanceof CSSTransition))!=null?r:[];return a.length===0?(e(),i.dispose):(Promise.allSettled(a.map(l=>l.finished)).then(()=>{s||e()}),i.dispose)}function LNe(n,{inFlight:e,prepare:t}){if(e!=null&&e.current){t();return}let r=n.style.transition;n.style.transition="none",t(),n.offsetHeight,n.style.transition=r}function DNe(n,{container:e,accept:t,walk:r}){let i=Ae.useRef(t),s=Ae.useRef(r);Ae.useEffect(()=>{i.current=t,s.current=r},[t,r]),Ca(()=>{if(!e||!n)return;let a=Lw(e);if(!a)return;let l=i.current,o=s.current,h=Object.assign(m=>l(m),{acceptNode:l}),d=a.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,h,!1);for(;d.nextNode();)o(d.currentNode)},[e,n,i,s])}function h3(){return typeof window<"u"}function Dw(n){return Zle(n)?(n.nodeName||"").toLowerCase():"#document"}function Fu(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Sp(n){var e;return(e=(Zle(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function Zle(n){return h3()?n instanceof Node||n instanceof Fu(n).Node:!1}function Tc(n){return h3()?n instanceof Element||n instanceof Fu(n).Element:!1}function gp(n){return h3()?n instanceof HTMLElement||n instanceof Fu(n).HTMLElement:!1}function xK(n){return!h3()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Fu(n).ShadowRoot}function vM(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Qf(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function BNe(n){return["table","td","th"].includes(Dw(n))}function f3(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function q8(n){const e=Z8(),t=Tc(n)?Qf(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function kNe(n){let e=yv(n);for(;gp(e)&&!uw(e);){if(q8(e))return e;if(f3(e))return null;e=yv(e)}return null}function Z8(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function uw(n){return["html","body","#document"].includes(Dw(n))}function Qf(n){return Fu(n).getComputedStyle(n)}function d3(n){return Tc(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function yv(n){if(Dw(n)==="html")return n;const e=n.assignedSlot||n.parentNode||xK(n)&&n.host||Sp(n);return xK(e)?e.host:e}function Yle(n){const e=yv(n);return uw(e)?n.ownerDocument?n.ownerDocument.body:n.body:gp(e)&&vM(e)?e:Yle(e)}function xT(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=Yle(n),s=i===((r=n.ownerDocument)==null?void 0:r.body),a=Fu(i);if(s){const l=mz(a);return e.concat(a,a.visualViewport||[],vM(i)?i:[],l&&t?xT(l):[])}return e.concat(i,xT(i,[],t))}function mz(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ONe(){const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?n.brands.map(e=>{let{brand:t,version:r}=e;return t+"/"+r}).join(" "):navigator.userAgent}const u1=Math.min,Hl=Math.max,bT=Math.round,yI=Math.floor,hp=n=>({x:n,y:n}),FNe={left:"right",right:"left",bottom:"top",top:"bottom"},NNe={start:"end",end:"start"};function bK(n,e,t){return Hl(n,u1(e,t))}function Bw(n,e){return typeof n=="function"?n(e):n}function xv(n){return n.split("-")[0]}function _M(n){return n.split("-")[1]}function Kle(n){return n==="x"?"y":"x"}function Jle(n){return n==="y"?"height":"width"}function h1(n){return["top","bottom"].includes(xv(n))?"y":"x"}function Qle(n){return Kle(h1(n))}function zNe(n,e,t){t===void 0&&(t=!1);const r=_M(n),i=Qle(n),s=Jle(i);let a=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=oL(a)),[a,oL(a)]}function UNe(n){const e=oL(n);return[gz(n),e,gz(e)]}function gz(n){return n.replace(/start|end/g,e=>NNe[e])}function GNe(n,e,t){const r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?s:a;default:return[]}}function VNe(n,e,t,r){const i=_M(n);let s=GNe(xv(n),t==="start",r);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(gz)))),s}function oL(n){return n.replace(/left|right|bottom|top/g,e=>FNe[e])}function HNe(n){return{top:0,right:0,bottom:0,left:0,...n}}function jNe(n){return typeof n!="number"?HNe(n):{top:n,right:n,bottom:n,left:n}}function aL(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function wK(n,e,t){let{reference:r,floating:i}=n;const s=h1(e),a=Qle(e),l=Jle(a),o=xv(e),h=s==="y",d=r.x+r.width/2-i.width/2,m=r.y+r.height/2-i.height/2,v=r[l]/2-i[l]/2;let y;switch(o){case"top":y={x:d,y:r.y-i.height};break;case"bottom":y={x:d,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:m};break;case"left":y={x:r.x-i.width,y:m};break;default:y={x:r.x,y:r.y}}switch(_M(e)){case"start":y[a]-=v*(t&&h?-1:1);break;case"end":y[a]+=v*(t&&h?-1:1);break}return y}const WNe=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=t,l=s.filter(Boolean),o=await(a.isRTL==null?void 0:a.isRTL(e));let h=await a.getElementRects({reference:n,floating:e,strategy:i}),{x:d,y:m}=wK(h,r,o),v=r,y={},S=0;for(let E=0;E<l.length;E++){const{name:M,fn:C}=l[E],{x:L,y:k,data:H,reset:q}=await C({x:d,y:m,initialPlacement:r,placement:v,strategy:i,middlewareData:y,rects:h,platform:a,elements:{reference:n,floating:e}});d=L??d,m=k??m,y={...y,[M]:{...y[M],...H}},q&&S<=50&&(S++,typeof q=="object"&&(q.placement&&(v=q.placement),q.rects&&(h=q.rects===!0?await a.getElementRects({reference:n,floating:e,strategy:i}):q.rects),{x:d,y:m}=wK(h,v,o)),E=-1)}return{x:d,y:m,placement:v,strategy:i,middlewareData:y}};async function p3(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:a,elements:l,strategy:o}=n,{boundary:h="clippingAncestors",rootBoundary:d="viewport",elementContext:m="floating",altBoundary:v=!1,padding:y=0}=Bw(e,n),S=jNe(y),M=l[v?m==="floating"?"reference":"floating":m],C=aL(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(M)))==null||t?M:M.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:h,rootBoundary:d,strategy:o})),L=m==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),H=await(s.isElement==null?void 0:s.isElement(k))?await(s.getScale==null?void 0:s.getScale(k))||{x:1,y:1}:{x:1,y:1},q=aL(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:L,offsetParent:k,strategy:o}):L);return{top:(C.top-q.top+S.top)/H.y,bottom:(q.bottom-C.bottom+S.bottom)/H.y,left:(C.left-q.left+S.left)/H.x,right:(q.right-C.right+S.right)/H.x}}const XNe=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:l,platform:o,elements:h}=e,{mainAxis:d=!0,crossAxis:m=!0,fallbackPlacements:v,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:E=!0,...M}=Bw(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const C=xv(i),L=h1(l),k=xv(l)===l,H=await(o.isRTL==null?void 0:o.isRTL(h.floating)),q=v||(k||!E?[oL(l)]:UNe(l)),Z=S!=="none";!v&&Z&&q.push(...VNe(l,E,S,H));const ee=[l,...q],re=await p3(e,M),se=[];let ae=((r=s.flip)==null?void 0:r.overflows)||[];if(d&&se.push(re[C]),m){const Ie=zNe(i,a,H);se.push(re[Ie[0]],re[Ie[1]])}if(ae=[...ae,{placement:i,overflows:se}],!se.every(Ie=>Ie<=0)){var fe,Se;const Ie=(((fe=s.flip)==null?void 0:fe.index)||0)+1,je=ee[Ie];if(je)return{data:{index:Ie,overflows:ae},reset:{placement:je}};let Le=(Se=ae.filter(ot=>ot.overflows[0]<=0).sort((ot,ye)=>ot.overflows[1]-ye.overflows[1])[0])==null?void 0:Se.placement;if(!Le)switch(y){case"bestFit":{var Ce;const ot=(Ce=ae.filter(ye=>{if(Z){const $e=h1(ye.placement);return $e===L||$e==="y"}return!0}).map(ye=>[ye.placement,ye.overflows.filter($e=>$e>0).reduce(($e,Ve)=>$e+Ve,0)]).sort((ye,$e)=>ye[1]-$e[1])[0])==null?void 0:Ce[0];ot&&(Le=ot);break}case"initialPlacement":Le=l;break}if(i!==Le)return{reset:{placement:Le}}}return{}}}};async function $Ne(n,e){const{placement:t,platform:r,elements:i}=n,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=xv(t),l=_M(t),o=h1(t)==="y",h=["left","top"].includes(a)?-1:1,d=s&&o?-1:1,m=Bw(e,n);let{mainAxis:v,crossAxis:y,alignmentAxis:S}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof S=="number"&&(y=l==="end"?S*-1:S),o?{x:y*d,y:v*h}:{x:v*h,y:y*d}}const qNe=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:s,placement:a,middlewareData:l}=e,o=await $Ne(e,n);return a===((t=l.offset)==null?void 0:t.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:i+o.x,y:s+o.y,data:{...o,placement:a}}}}},ZNe=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:l={fn:M=>{let{x:C,y:L}=M;return{x:C,y:L}}},...o}=Bw(n,e),h={x:t,y:r},d=await p3(e,o),m=h1(xv(i)),v=Kle(m);let y=h[v],S=h[m];if(s){const M=v==="y"?"top":"left",C=v==="y"?"bottom":"right",L=y+d[M],k=y-d[C];y=bK(L,y,k)}if(a){const M=m==="y"?"top":"left",C=m==="y"?"bottom":"right",L=S+d[M],k=S-d[C];S=bK(L,S,k)}const E=l.fn({...e,[v]:y,[m]:S});return{...E,data:{x:E.x-t,y:E.y-r,enabled:{[v]:s,[m]:a}}}}}},YNe=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:i,rects:s,platform:a,elements:l}=e,{apply:o=()=>{},...h}=Bw(n,e),d=await p3(e,h),m=xv(i),v=_M(i),y=h1(i)==="y",{width:S,height:E}=s.floating;let M,C;m==="top"||m==="bottom"?(M=m,C=v===(await(a.isRTL==null?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(C=m,M=v==="end"?"top":"bottom");const L=E-d.top-d.bottom,k=S-d.left-d.right,H=u1(E-d[M],L),q=u1(S-d[C],k),Z=!e.middlewareData.shift;let ee=H,re=q;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(re=k),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(ee=L),Z&&!v){const ae=Hl(d.left,0),fe=Hl(d.right,0),Se=Hl(d.top,0),Ce=Hl(d.bottom,0);y?re=S-2*(ae!==0||fe!==0?ae+fe:Hl(d.left,d.right)):ee=E-2*(Se!==0||Ce!==0?Se+Ce:Hl(d.top,d.bottom))}await o({...e,availableWidth:re,availableHeight:ee});const se=await a.getDimensions(l.floating);return S!==se.width||E!==se.height?{reset:{rects:!0}}:{}}}};function ece(n){const e=Qf(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=gp(n),s=i?n.offsetWidth:t,a=i?n.offsetHeight:r,l=bT(t)!==s||bT(r)!==a;return l&&(t=s,r=a),{width:t,height:r,$:l}}function Y8(n){return Tc(n)?n:n.contextElement}function Vb(n){const e=Y8(n);if(!gp(e))return hp(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:s}=ece(e);let a=(s?bT(t.width):t.width)/r,l=(s?bT(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const KNe=hp(0);function tce(n){const e=Fu(n);return!Z8()||!e.visualViewport?KNe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function JNe(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Fu(n)?!1:e}function f1(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),s=Y8(n);let a=hp(1);e&&(r?Tc(r)&&(a=Vb(r)):a=Vb(n));const l=JNe(s,t,r)?tce(s):hp(0);let o=(i.left+l.x)/a.x,h=(i.top+l.y)/a.y,d=i.width/a.x,m=i.height/a.y;if(s){const v=Fu(s),y=r&&Tc(r)?Fu(r):r;let S=v,E=mz(S);for(;E&&r&&y!==S;){const M=Vb(E),C=E.getBoundingClientRect(),L=Qf(E),k=C.left+(E.clientLeft+parseFloat(L.paddingLeft))*M.x,H=C.top+(E.clientTop+parseFloat(L.paddingTop))*M.y;o*=M.x,h*=M.y,d*=M.x,m*=M.y,o+=k,h+=H,S=Fu(E),E=mz(S)}}return aL({width:d,height:m,x:o,y:h})}function K8(n,e){const t=d3(n).scrollLeft;return e?e.left+t:f1(Sp(n)).left+t}function nce(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:K8(n,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function QNe(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const s=i==="fixed",a=Sp(r),l=e?f3(e.floating):!1;if(r===a||l&&s)return t;let o={scrollLeft:0,scrollTop:0},h=hp(1);const d=hp(0),m=gp(r);if((m||!m&&!s)&&((Dw(r)!=="body"||vM(a))&&(o=d3(r)),gp(r))){const y=f1(r);h=Vb(r),d.x=y.x+r.clientLeft,d.y=y.y+r.clientTop}const v=a&&!m&&!s?nce(a,o,!0):hp(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-o.scrollLeft*h.x+d.x+v.x,y:t.y*h.y-o.scrollTop*h.y+d.y+v.y}}function eze(n){return Array.from(n.getClientRects())}function tze(n){const e=Sp(n),t=d3(n),r=n.ownerDocument.body,i=Hl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Hl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-t.scrollLeft+K8(n);const l=-t.scrollTop;return Qf(r).direction==="rtl"&&(a+=Hl(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:l}}function nze(n,e){const t=Fu(n),r=Sp(n),i=t.visualViewport;let s=r.clientWidth,a=r.clientHeight,l=0,o=0;if(i){s=i.width,a=i.height;const h=Z8();(!h||h&&e==="fixed")&&(l=i.offsetLeft,o=i.offsetTop)}return{width:s,height:a,x:l,y:o}}function rze(n,e){const t=f1(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,s=gp(n)?Vb(n):hp(1),a=n.clientWidth*s.x,l=n.clientHeight*s.y,o=i*s.x,h=r*s.y;return{width:a,height:l,x:o,y:h}}function SK(n,e,t){let r;if(e==="viewport")r=nze(n,t);else if(e==="document")r=tze(Sp(n));else if(Tc(e))r=rze(e,t);else{const i=tce(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return aL(r)}function rce(n,e){const t=yv(n);return t===e||!Tc(t)||uw(t)?!1:Qf(t).position==="fixed"||rce(t,e)}function ize(n,e){const t=e.get(n);if(t)return t;let r=xT(n,[],!1).filter(l=>Tc(l)&&Dw(l)!=="body"),i=null;const s=Qf(n).position==="fixed";let a=s?yv(n):n;for(;Tc(a)&&!uw(a);){const l=Qf(a),o=q8(a);!o&&l.position==="fixed"&&(i=null),(s?!o&&!i:!o&&l.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||vM(a)&&!o&&rce(n,a))?r=r.filter(d=>d!==a):i=l,a=yv(a)}return e.set(n,r),r}function sze(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const a=[...t==="clippingAncestors"?f3(e)?[]:ize(e,this._c):[].concat(t),r],l=a[0],o=a.reduce((h,d)=>{const m=SK(e,d,i);return h.top=Hl(m.top,h.top),h.right=u1(m.right,h.right),h.bottom=u1(m.bottom,h.bottom),h.left=Hl(m.left,h.left),h},SK(e,l,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}}function oze(n){const{width:e,height:t}=ece(n);return{width:e,height:t}}function aze(n,e,t){const r=gp(e),i=Sp(e),s=t==="fixed",a=f1(n,!0,s,e);let l={scrollLeft:0,scrollTop:0};const o=hp(0);if(r||!r&&!s)if((Dw(e)!=="body"||vM(i))&&(l=d3(e)),r){const v=f1(e,!0,s,e);o.x=v.x+e.clientLeft,o.y=v.y+e.clientTop}else i&&(o.x=K8(i));const h=i&&!r&&!s?nce(i,l):hp(0),d=a.left+l.scrollLeft-o.x-h.x,m=a.top+l.scrollTop-o.y-h.y;return{x:d,y:m,width:a.width,height:a.height}}function Yk(n){return Qf(n).position==="static"}function AK(n,e){if(!gp(n)||Qf(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Sp(n)===t&&(t=t.ownerDocument.body),t}function ice(n,e){const t=Fu(n);if(f3(n))return t;if(!gp(n)){let i=yv(n);for(;i&&!uw(i);){if(Tc(i)&&!Yk(i))return i;i=yv(i)}return t}let r=AK(n,e);for(;r&&BNe(r)&&Yk(r);)r=AK(r,e);return r&&uw(r)&&Yk(r)&&!q8(r)?t:r||kNe(n)||t}const lze=async function(n){const e=this.getOffsetParent||ice,t=this.getDimensions,r=await t(n.floating);return{reference:aze(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function cze(n){return Qf(n).direction==="rtl"}const uze={convertOffsetParentRelativeRectToViewportRelativeRect:QNe,getDocumentElement:Sp,getClippingRect:sze,getOffsetParent:ice,getElementRects:lze,getClientRects:eze,getDimensions:oze,getScale:Vb,isElement:Tc,isRTL:cze};function hze(n,e){let t=null,r;const i=Sp(n);function s(){var l;clearTimeout(r),(l=t)==null||l.disconnect(),t=null}function a(l,o){l===void 0&&(l=!1),o===void 0&&(o=1),s();const{left:h,top:d,width:m,height:v}=n.getBoundingClientRect();if(l||e(),!m||!v)return;const y=yI(d),S=yI(i.clientWidth-(h+m)),E=yI(i.clientHeight-(d+v)),M=yI(h),L={rootMargin:-y+"px "+-S+"px "+-E+"px "+-M+"px",threshold:Hl(0,u1(1,o))||1};let k=!0;function H(q){const Z=q[0].intersectionRatio;if(Z!==o){if(!k)return a();Z?a(!1,Z):r=setTimeout(()=>{a(!1,1e-7)},1e3)}k=!1}try{t=new IntersectionObserver(H,{...L,root:i.ownerDocument})}catch{t=new IntersectionObserver(H,L)}t.observe(n)}return a(!0),s}function fze(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:o=!1}=r,h=Y8(n),d=i||s?[...h?xT(h):[],...xT(e)]:[];d.forEach(C=>{i&&C.addEventListener("scroll",t,{passive:!0}),s&&C.addEventListener("resize",t)});const m=h&&l?hze(h,t):null;let v=-1,y=null;a&&(y=new ResizeObserver(C=>{let[L]=C;L&&L.target===h&&y&&(y.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var k;(k=y)==null||k.observe(e)})),t()}),h&&!o&&y.observe(h),y.observe(e));let S,E=o?f1(n):null;o&&M();function M(){const C=f1(n);E&&(C.x!==E.x||C.y!==E.y||C.width!==E.width||C.height!==E.height)&&t(),E=C,S=requestAnimationFrame(M)}return t(),()=>{var C;d.forEach(L=>{i&&L.removeEventListener("scroll",t),s&&L.removeEventListener("resize",t)}),m==null||m(),(C=y)==null||C.disconnect(),y=null,o&&cancelAnimationFrame(S)}}const Kk=p3,dze=qNe,pze=ZNe,mze=XNe,gze=YNe,vze=(n,e,t)=>{const r=new Map,i={platform:uze,...t},s={...i.platform,_c:r};return WNe(n,e,{...i,platform:s})};var lR=typeof document<"u"?Ae.useLayoutEffect:Ae.useEffect;function lL(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!lL(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const s=i[r];if(!(s==="_owner"&&n.$$typeof)&&!lL(n[s],e[s]))return!1}return!0}return n!==n&&e!==e}function sce(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function TK(n,e){const t=sce(n);return Math.round(e*t)/t}function Jk(n){const e=Ae.useRef(n);return lR(()=>{e.current=n}),e}function _ze(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:a}={},transform:l=!0,whileElementsMounted:o,open:h}=n,[d,m]=Ae.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[v,y]=Ae.useState(r);lL(v,r)||y(r);const[S,E]=Ae.useState(null),[M,C]=Ae.useState(null),L=Ae.useCallback(ye=>{ye!==Z.current&&(Z.current=ye,E(ye))},[]),k=Ae.useCallback(ye=>{ye!==ee.current&&(ee.current=ye,C(ye))},[]),H=s||S,q=a||M,Z=Ae.useRef(null),ee=Ae.useRef(null),re=Ae.useRef(d),se=o!=null,ae=Jk(o),fe=Jk(i),Se=Jk(h),Ce=Ae.useCallback(()=>{if(!Z.current||!ee.current)return;const ye={placement:e,strategy:t,middleware:v};fe.current&&(ye.platform=fe.current),vze(Z.current,ee.current,ye).then($e=>{const Ve={...$e,isPositioned:Se.current!==!1};Ie.current&&!lL(re.current,Ve)&&(re.current=Ve,Xf.flushSync(()=>{m(Ve)}))})},[v,e,t,fe,Se]);lR(()=>{h===!1&&re.current.isPositioned&&(re.current.isPositioned=!1,m(ye=>({...ye,isPositioned:!1})))},[h]);const Ie=Ae.useRef(!1);lR(()=>(Ie.current=!0,()=>{Ie.current=!1}),[]),lR(()=>{if(H&&(Z.current=H),q&&(ee.current=q),H&&q){if(ae.current)return ae.current(H,q,Ce);Ce()}},[H,q,Ce,ae,se]);const je=Ae.useMemo(()=>({reference:Z,floating:ee,setReference:L,setFloating:k}),[L,k]),Le=Ae.useMemo(()=>({reference:H,floating:q}),[H,q]),ot=Ae.useMemo(()=>{const ye={position:t,left:0,top:0};if(!Le.floating)return ye;const $e=TK(Le.floating,d.x),Ve=TK(Le.floating,d.y);return l?{...ye,transform:"translate("+$e+"px, "+Ve+"px)",...sce(Le.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:$e,top:Ve}},[t,l,Le.floating,d.x,d.y]);return Ae.useMemo(()=>({...d,update:Ce,refs:je,elements:Le,floatingStyles:ot}),[d,Ce,je,Le,ot])}const oce=(n,e)=>({...dze(n),options:[n,e]}),yze=(n,e)=>({...pze(n),options:[n,e]}),xze=(n,e)=>({...mze(n),options:[n,e]}),bze=(n,e)=>({...gze(n),options:[n,e]}),ace={...dR},wze=ace.useInsertionEffect,Sze=wze||(n=>n());function lce(n){const e=Ae.useRef(()=>{});return Sze(()=>{e.current=n}),Ae.useCallback(function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}var vz=typeof document<"u"?Ae.useLayoutEffect:Ae.useEffect;let MK=!1,Aze=0;const CK=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Aze++;function Tze(){const[n,e]=Ae.useState(()=>MK?CK():void 0);return vz(()=>{n==null&&e(CK())},[]),Ae.useEffect(()=>{MK=!0},[]),n}const Mze=ace.useId,Cze=Mze||Tze;function Eze(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(i=>i(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(i=>i!==t))||[])}}}const Ize=Ae.createContext(null),Rze=Ae.createContext(null),Pze=()=>{var n;return((n=Ae.useContext(Ize))==null?void 0:n.id)||null},Lze=()=>Ae.useContext(Rze),Dze="data-floating-ui-focusable";function Bze(n){const{open:e=!1,onOpenChange:t,elements:r}=n,i=Cze(),s=Ae.useRef({}),[a]=Ae.useState(()=>Eze()),l=Pze()!=null,[o,h]=Ae.useState(r.reference),d=lce((y,S,E)=>{s.current.openEvent=y?S:void 0,a.emit("openchange",{open:y,event:S,reason:E,nested:l}),t==null||t(y,S,E)}),m=Ae.useMemo(()=>({setPositionReference:h}),[]),v=Ae.useMemo(()=>({reference:o||r.reference||null,floating:r.floating||null,domReference:r.reference}),[o,r.reference,r.floating]);return Ae.useMemo(()=>({dataRef:s,open:e,onOpenChange:d,elements:v,events:a,floatingId:i,refs:m}),[e,d,v,a,i,m])}function kze(n){n===void 0&&(n={});const{nodeId:e}=n,t=Bze({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,i=r.elements,[s,a]=Ae.useState(null),[l,o]=Ae.useState(null),d=(i==null?void 0:i.domReference)||s,m=Ae.useRef(null),v=Lze();vz(()=>{d&&(m.current=d)},[d]);const y=_ze({...n,elements:{...i,...l&&{reference:l}}}),S=Ae.useCallback(k=>{const H=Tc(k)?{getBoundingClientRect:()=>k.getBoundingClientRect(),contextElement:k}:k;o(H),y.refs.setReference(H)},[y.refs]),E=Ae.useCallback(k=>{(Tc(k)||k===null)&&(m.current=k,a(k)),(Tc(y.refs.reference.current)||y.refs.reference.current===null||k!==null&&!Tc(k))&&y.refs.setReference(k)},[y.refs]),M=Ae.useMemo(()=>({...y.refs,setReference:E,setPositionReference:S,domReference:m}),[y.refs,E,S]),C=Ae.useMemo(()=>({...y.elements,domReference:d}),[y.elements,d]),L=Ae.useMemo(()=>({...y,...r,refs:M,elements:C,nodeId:e}),[y,M,C,e,r]);return vz(()=>{r.dataRef.current.floatingContext=L;const k=v==null?void 0:v.nodesRef.current.find(H=>H.id===e);k&&(k.context=L)}),Ae.useMemo(()=>({...y,context:L,refs:M,elements:C}),[y,M,C,L])}const EK="active",IK="selected";function Qk(n,e,t){const r=new Map,i=t==="item";let s=n;if(i&&n){const{[EK]:a,[IK]:l,...o}=n;s=o}return{...t==="floating"&&{tabIndex:-1,[Dze]:""},...s,...e.map(a=>{const l=a?a[t]:null;return typeof l=="function"?n?l(n):null:l}).concat(n).reduce((a,l)=>(l&&Object.entries(l).forEach(o=>{let[h,d]=o;if(!(i&&[EK,IK].includes(h)))if(h.indexOf("on")===0){if(r.has(h)||r.set(h,[]),typeof d=="function"){var m;(m=r.get(h))==null||m.push(d),a[h]=function(){for(var v,y=arguments.length,S=new Array(y),E=0;E<y;E++)S[E]=arguments[E];return(v=r.get(h))==null?void 0:v.map(M=>M(...S)).find(M=>M!==void 0)}}}else a[h]=d}),a),{})}}function Oze(n){n===void 0&&(n=[]);const e=n.map(l=>l==null?void 0:l.reference),t=n.map(l=>l==null?void 0:l.floating),r=n.map(l=>l==null?void 0:l.item),i=Ae.useCallback(l=>Qk(l,n,"reference"),e),s=Ae.useCallback(l=>Qk(l,n,"floating"),t),a=Ae.useCallback(l=>Qk(l,n,"item"),r);return Ae.useMemo(()=>({getReferenceProps:i,getFloatingProps:s,getItemProps:a}),[i,s,a])}function RK(n,e){return{...n,rects:{...n.rects,floating:{...n.rects.floating,height:e}}}}const Fze=n=>({name:"inner",options:n,async fn(e){const{listRef:t,overflowRef:r,onFallbackChange:i,offset:s=0,index:a=0,minItemsVisible:l=4,referenceOverflowThreshold:o=0,scrollRef:h,...d}=Bw(n,e),{rects:m,elements:{floating:v}}=e,y=t.current[a],S=(h==null?void 0:h.current)||v,E=v.clientTop||S.clientTop,M=v.clientTop!==0,C=S.clientTop!==0,L=v===S;if(!y)return{};const k={...e,...await oce(-y.offsetTop-v.clientTop-m.reference.height/2-y.offsetHeight/2-s).fn(e)},H=await Kk(RK(k,S.scrollHeight+E+v.clientTop),d),q=await Kk(k,{...d,elementContext:"reference"}),Z=Hl(0,H.top),ee=k.y+Z,ae=(S.scrollHeight>S.clientHeight?fe=>fe:bT)(Hl(0,S.scrollHeight+(M&&L||C?E*2:0)-Z-Hl(0,H.bottom)));if(S.style.maxHeight=ae+"px",S.scrollTop=Z,i){const fe=S.offsetHeight<y.offsetHeight*u1(l,t.current.length)-1||q.top>=-o||q.bottom>=-o;Xf.flushSync(()=>i(fe))}return r&&(r.current=await Kk(RK({...k,y:ee},S.offsetHeight+E+v.clientTop),d)),{y:ee}}});function Nze(n,e){const{open:t,elements:r}=n,{enabled:i=!0,overflowRef:s,scrollRef:a,onChange:l}=e,o=lce(l),h=Ae.useRef(!1),d=Ae.useRef(null),m=Ae.useRef(null);Ae.useEffect(()=>{if(!i)return;function y(E){if(E.ctrlKey||!S||s.current==null)return;const M=E.deltaY,C=s.current.top>=-.5,L=s.current.bottom>=-.5,k=S.scrollHeight-S.clientHeight,H=M<0?-1:1,q=M<0?"max":"min";S.scrollHeight<=S.clientHeight||(!C&&M>0||!L&&M<0?(E.preventDefault(),Xf.flushSync(()=>{o(Z=>Z+Math[q](M,k*H))})):/firefox/i.test(ONe())&&(S.scrollTop+=M))}const S=(a==null?void 0:a.current)||r.floating;if(t&&S)return S.addEventListener("wheel",y),requestAnimationFrame(()=>{d.current=S.scrollTop,s.current!=null&&(m.current={...s.current})}),()=>{d.current=null,m.current=null,S.removeEventListener("wheel",y)}},[i,t,r.floating,s,a,o]);const v=Ae.useMemo(()=>({onKeyDown(){h.current=!0},onWheel(){h.current=!1},onPointerMove(){h.current=!1},onScroll(){const y=(a==null?void 0:a.current)||r.floating;if(!(!s.current||!y||!h.current)){if(d.current!==null){const S=y.scrollTop-d.current;(s.current.bottom<-.5&&S<-1||s.current.top<-.5&&S>1)&&Xf.flushSync(()=>o(E=>E+S))}requestAnimationFrame(()=>{d.current=y.scrollTop})}}}),[r.floating,o,s,a]);return Ae.useMemo(()=>i?{floating:v}:{},[i,v])}let kw=Ae.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});kw.displayName="FloatingContext";let J8=Ae.createContext(null);J8.displayName="PlacementContext";function zze(n){return Ae.useMemo(()=>n?typeof n=="string"?{to:n}:n:null,[n])}function Uze(){return Ae.useContext(kw).setReference}function Gze(){return Ae.useContext(kw).getReferenceProps}function Vze(){let{getFloatingProps:n,slot:e}=Ae.useContext(kw);return Ae.useCallback((...t)=>Object.assign({},n(...t),{"data-anchor":e.anchor}),[n,e])}function Hze(n=null){n===!1&&(n=null),typeof n=="string"&&(n={to:n});let e=Ae.useContext(J8),t=Ae.useMemo(()=>n,[JSON.stringify(n,(i,s)=>{var a;return(a=s==null?void 0:s.outerHTML)!=null?a:s})]);Ca(()=>{e==null||e(t??null)},[e,t]);let r=Ae.useContext(kw);return Ae.useMemo(()=>[r.setFloating,n?r.styles:{}],[r.setFloating,n,r.styles])}let PK=4;function jze({children:n,enabled:e=!0}){let[t,r]=Ae.useState(null),[i,s]=Ae.useState(0),a=Ae.useRef(null),[l,o]=Ae.useState(null);Wze(l);let h=e&&t!==null&&l!==null,{to:d="bottom",gap:m=0,offset:v=0,padding:y=0,inner:S}=Xze(t,l),[E,M="center"]=d.split(" ");Ca(()=>{h&&s(0)},[h]);let{refs:C,floatingStyles:L,context:k}=kze({open:h,placement:E==="selection"?M==="center"?"bottom":`bottom-${M}`:M==="center"?`${E}`:`${E}-${M}`,strategy:"absolute",transform:!1,middleware:[oce({mainAxis:E==="selection"?0:m,crossAxis:v}),yze({padding:y}),E!=="selection"&&xze({padding:y}),E==="selection"&&S?Fze({...S,padding:y,overflowRef:a,offset:i,minItemsVisible:PK,referenceOverflowThreshold:y,onFallbackChange(fe){var Se,Ce;if(!fe)return;let Ie=k.elements.floating;if(!Ie)return;let je=parseFloat(getComputedStyle(Ie).scrollPaddingBottom)||0,Le=Math.min(PK,Ie.childElementCount),ot=0,ye=0;for(let $e of(Ce=(Se=k.elements.floating)==null?void 0:Se.childNodes)!=null?Ce:[])if($e instanceof HTMLElement){let Ve=$e.offsetTop,_t=Ve+$e.clientHeight+je,wt=Ie.scrollTop,Vt=wt+Ie.clientHeight;if(Ve>=wt&&_t<=Vt)Le--;else{ye=Math.max(0,Math.min(_t,Vt)-Math.max(Ve,wt)),ot=$e.clientHeight;break}}Le>=1&&s($e=>{let Ve=ot*Le-ye+je;return $e>=Ve?$e:Ve})}}):null,bze({padding:y,apply({availableWidth:fe,availableHeight:Se,elements:Ce}){Object.assign(Ce.floating.style,{overflow:"auto",maxWidth:`${fe}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${Se}px)`})}})].filter(Boolean),whileElementsMounted:fze}),[H=E,q=M]=k.placement.split("-");E==="selection"&&(H="selection");let Z=Ae.useMemo(()=>({anchor:[H,q].filter(Boolean).join(" ")}),[H,q]),ee=Nze(k,{overflowRef:a,onChange:s}),{getReferenceProps:re,getFloatingProps:se}=Oze([ee]),ae=Co(fe=>{o(fe),C.setFloating(fe)});return Ae.createElement(J8.Provider,{value:r},Ae.createElement(kw.Provider,{value:{setFloating:ae,setReference:C.setReference,styles:L,getReferenceProps:re,getFloatingProps:se,slot:Z}},n))}function Wze(n){Ca(()=>{if(!n)return;let e=new MutationObserver(()=>{let t=window.getComputedStyle(n).maxHeight,r=parseFloat(t);if(isNaN(r))return;let i=parseInt(t);isNaN(i)||r!==i&&(n.style.maxHeight=`${Math.ceil(r)}px`)});return e.observe(n,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[n])}function Xze(n,e){var t,r,i;let s=eO((t=n==null?void 0:n.gap)!=null?t:"var(--anchor-gap, 0)",e),a=eO((r=n==null?void 0:n.offset)!=null?r:"var(--anchor-offset, 0)",e),l=eO((i=n==null?void 0:n.padding)!=null?i:"var(--anchor-padding, 0)",e);return{...n,gap:s,offset:a,padding:l}}function eO(n,e,t=void 0){let r=c3(),i=Co((o,h)=>{if(o==null)return[t,null];if(typeof o=="number")return[o,null];if(typeof o=="string"){if(!h)return[t,null];let d=LK(o,h);return[d,m=>{let v=cce(o);{let y=v.map(S=>window.getComputedStyle(h).getPropertyValue(S));r.requestAnimationFrame(function S(){r.nextFrame(S);let E=!1;for(let[C,L]of v.entries()){let k=window.getComputedStyle(h).getPropertyValue(L);if(y[C]!==k){y[C]=k,E=!0;break}}if(!E)return;let M=LK(o,h);d!==M&&(m(M),d=M)})}return r.dispose}]}return[t,null]}),s=Ae.useMemo(()=>i(n,e)[0],[n,e]),[a=s,l]=Ae.useState();return Ca(()=>{let[o,h]=i(n,e);if(l(o),!!h)return h(l)},[n,e]),a}function cce(n){let e=/var\((.*)\)/.exec(n);if(e){let t=e[1].indexOf(",");if(t===-1)return[e[1]];let r=e[1].slice(0,t).trim(),i=e[1].slice(t+1).trim();return i?[r,...cce(i)]:[r]}return[]}function LK(n,e){let t=document.createElement("div");e.appendChild(t),t.style.setProperty("margin-top","0px","important"),t.style.setProperty("margin-top",n,"important");let r=parseFloat(window.getComputedStyle(t).marginTop)||0;return e.removeChild(t),r}let Q8=Ae.createContext(null);Q8.displayName="OpenClosedContext";var wT=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(wT||{});function $ze(){return Ae.useContext(Q8)}function qze({value:n,children:e}){return $l.createElement(Q8.Provider,{value:n},e)}function Zze(n){throw new Error("Unexpected object: "+n)}var jl=(n=>(n[n.First=0]="First",n[n.Previous=1]="Previous",n[n.Next=2]="Next",n[n.Last=3]="Last",n[n.Specific=4]="Specific",n[n.Nothing=5]="Nothing",n))(jl||{});function tO(n,e){let t=e.resolveItems();if(t.length<=0)return null;let r=e.resolveActiveIndex(),i=r??-1;switch(n.focus){case 0:{for(let s=0;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 1:{i===-1&&(i=t.length);for(let s=i-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 2:{for(let s=i+1;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 3:{for(let s=t.length-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 4:{for(let s=0;s<t.length;++s)if(e.resolveId(t[s],s,t)===n.id)return s;return r}case 5:return null;default:Zze(n)}}function Yze(n){let e=Co(n),t=Ae.useRef(!1);Ae.useEffect(()=>(t.current=!1,()=>{t.current=!0,Ole(()=>{t.current&&e()})}),[e])}function Kze(){let n=typeof document>"u";return"useSyncExternalStore"in dR?(e=>e.useSyncExternalStore)(dR)(()=>()=>{},()=>!1,()=>!n):!1}function Jze(){let n=Kze(),[e,t]=Ae.useState(Vy.isHandoffComplete);return e&&Vy.isHandoffComplete===!1&&t(!1),Ae.useEffect(()=>{e!==!0&&t(!0)},[e]),Ae.useEffect(()=>Vy.handoff(),[]),n?!1:e}let Qze=Ae.createContext(!1);function e6e(){return Ae.useContext(Qze)}function t6e(n){let e=e6e(),t=Ae.useContext(hce),r=$8(n),[i,s]=Ae.useState(()=>{var a;if(!e&&t!==null)return(a=t.current)!=null?a:null;if(Vy.isServer)return null;let l=r==null?void 0:r.getElementById("headlessui-portal-root");if(l)return l;if(r===null)return null;let o=r.createElement("div");return o.setAttribute("id","headlessui-portal-root"),r.body.appendChild(o)});return Ae.useEffect(()=>{i!==null&&(r!=null&&r.body.contains(i)||r==null||r.body.appendChild(i))},[i,r]),Ae.useEffect(()=>{e||t!==null&&s(t.current)},[t,s,e]),i}let uce=Ae.Fragment,n6e=Uh(function(n,e){let t=n,r=Ae.useRef(null),i=sg(VFe(m=>{r.current=m}),e),s=$8(r),a=t6e(r),[l]=Ae.useState(()=>{var m;return Vy.isServer?null:(m=s==null?void 0:s.createElement("div"))!=null?m:null}),o=Ae.useContext(o6e),h=Jze();Ca(()=>{!a||!l||a.contains(l)||(l.setAttribute("data-headlessui-portal",""),a.appendChild(l))},[a,l]),Ca(()=>{if(l&&o)return o.register(l)},[o,l]),Yze(()=>{var m;!a||!l||(l instanceof Node&&a.contains(l)&&a.removeChild(l),a.childNodes.length<=0&&((m=a.parentElement)==null||m.removeChild(a)))});let d=zh();return h?!a||!l?null:Xf.createPortal(d({ourProps:{ref:i},theirProps:t,slot:{},defaultTag:uce,name:"Portal"}),l):null});function r6e(n,e){let t=sg(e),{enabled:r=!0,...i}=n,s=zh();return r?$l.createElement(n6e,{...i,ref:t}):s({ourProps:{ref:t},theirProps:i,slot:{},defaultTag:uce,name:"Portal"})}let i6e=Ae.Fragment,hce=Ae.createContext(null);function s6e(n,e){let{target:t,...r}=n,i={ref:sg(e)},s=zh();return $l.createElement(hce.Provider,{value:t},s({ourProps:i,theirProps:r,defaultTag:i6e,name:"Popover.Group"}))}let o6e=Ae.createContext(null),a6e=Uh(r6e),l6e=Uh(s6e),c6e=Object.assign(a6e,{Group:l6e});function u6e(n,e){let t=Ae.useRef({left:0,top:0});if(Ca(()=>{if(!e)return;let i=e.getBoundingClientRect();i&&(t.current=i)},[n,e]),e==null||!n||e===document.activeElement)return!1;let r=e.getBoundingClientRect();return r.top!==t.current.top||r.left!==t.current.left}let DK=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function BK(n){var e,t;let r=(e=n.innerText)!=null?e:"",i=n.cloneNode(!0);if(!(i instanceof HTMLElement))return r;let s=!1;for(let l of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),s=!0;let a=s?(t=i.innerText)!=null?t:"":r;return DK.test(a)&&(a=a.replace(DK,"")),a}function h6e(n){let e=n.getAttribute("aria-label");if(typeof e=="string")return e.trim();let t=n.getAttribute("aria-labelledby");if(t){let r=t.split(" ").map(i=>{let s=document.getElementById(i);if(s){let a=s.getAttribute("aria-label");return typeof a=="string"?a.trim():BK(s).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return BK(n).trim()}function f6e(n){let e=Ae.useRef(""),t=Ae.useRef("");return Co(()=>{let r=n.current;if(!r)return"";let i=r.innerText;if(e.current===i)return t.current;let s=h6e(r).trim().toLowerCase();return e.current=i,t.current=s,s})}var d6e=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(d6e||{}),p6e=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(p6e||{}),m6e=(n=>(n[n.OpenMenu=0]="OpenMenu",n[n.CloseMenu=1]="CloseMenu",n[n.GoToItem=2]="GoToItem",n[n.Search=3]="Search",n[n.ClearSearch=4]="ClearSearch",n[n.RegisterItem=5]="RegisterItem",n[n.UnregisterItem=6]="UnregisterItem",n[n.SetButtonElement=7]="SetButtonElement",n[n.SetItemsElement=8]="SetItemsElement",n))(m6e||{});function nO(n,e=t=>t){let t=n.activeItemIndex!==null?n.items[n.activeItemIndex]:null,r=$le(e(n.items.slice()),s=>s.dataRef.current.domRef.current),i=t?r.indexOf(t):null;return i===-1&&(i=null),{items:r,activeItemIndex:i}}let g6e={1(n){return n.menuState===1?n:{...n,activeItemIndex:null,menuState:1}},0(n){return n.menuState===0?n:{...n,__demoMode:!1,menuState:0}},2:(n,e)=>{var t,r,i,s,a;if(n.menuState===1)return n;let l={...n,searchQuery:"",activationTrigger:(t=e.trigger)!=null?t:1,__demoMode:!1};if(e.focus===jl.Nothing)return{...l,activeItemIndex:null};if(e.focus===jl.Specific)return{...l,activeItemIndex:n.items.findIndex(d=>d.id===e.id)};if(e.focus===jl.Previous){let d=n.activeItemIndex;if(d!==null){let m=n.items[d].dataRef.current.domRef,v=tO(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:y=>y.id,resolveDisabled:y=>y.dataRef.current.disabled});if(v!==null){let y=n.items[v].dataRef.current.domRef;if(((r=m.current)==null?void 0:r.previousElementSibling)===y.current||((i=y.current)==null?void 0:i.previousElementSibling)===null)return{...l,activeItemIndex:v}}}}else if(e.focus===jl.Next){let d=n.activeItemIndex;if(d!==null){let m=n.items[d].dataRef.current.domRef,v=tO(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:y=>y.id,resolveDisabled:y=>y.dataRef.current.disabled});if(v!==null){let y=n.items[v].dataRef.current.domRef;if(((s=m.current)==null?void 0:s.nextElementSibling)===y.current||((a=y.current)==null?void 0:a.nextElementSibling)===null)return{...l,activeItemIndex:v}}}}let o=nO(n),h=tO(e,{resolveItems:()=>o.items,resolveActiveIndex:()=>o.activeItemIndex,resolveId:d=>d.id,resolveDisabled:d=>d.dataRef.current.disabled});return{...l,...o,activeItemIndex:h}},3:(n,e)=>{let t=n.searchQuery!==""?0:1,r=n.searchQuery+e.value.toLowerCase(),i=(n.activeItemIndex!==null?n.items.slice(n.activeItemIndex+t).concat(n.items.slice(0,n.activeItemIndex+t)):n.items).find(a=>{var l;return((l=a.dataRef.current.textValue)==null?void 0:l.startsWith(r))&&!a.dataRef.current.disabled}),s=i?n.items.indexOf(i):-1;return s===-1||s===n.activeItemIndex?{...n,searchQuery:r}:{...n,searchQuery:r,activeItemIndex:s,activationTrigger:1}},4(n){return n.searchQuery===""?n:{...n,searchQuery:"",searchActiveItemIndex:null}},5:(n,e)=>{let t=nO(n,r=>[...r,{id:e.id,dataRef:e.dataRef}]);return{...n,...t}},6:(n,e)=>{let t=nO(n,r=>{let i=r.findIndex(s=>s.id===e.id);return i!==-1&&r.splice(i,1),r});return{...n,...t,activationTrigger:1}},7:(n,e)=>n.buttonElement===e.element?n:{...n,buttonElement:e.element},8:(n,e)=>n.itemsElement===e.element?n:{...n,itemsElement:e.element}},e9=Ae.createContext(null);e9.displayName="MenuContext";function m3(n){let e=Ae.useContext(e9);if(e===null){let t=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,m3),t}return e}function v6e(n,e){return gM(e.type,g6e,n,e)}let _6e=Ae.Fragment;function y6e(n,e){let{__demoMode:t=!1,...r}=n,i=Ae.useReducer(v6e,{__demoMode:t,menuState:t?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:s,itemsElement:a,buttonElement:l},o]=i,h=sg(e);gNe(s===0,[l,a],(S,E)=>{o({type:1}),X8(E,W8.Loose)||(S.preventDefault(),l==null||l.focus())});let d=Co(()=>{o({type:1})}),m=Ae.useMemo(()=>({open:s===0,close:d}),[s,d]),v={ref:h},y=zh();return $l.createElement(jze,null,$l.createElement(e9.Provider,{value:i},$l.createElement(qze,{value:gM(s,{0:wT.Open,1:wT.Closed})},y({ourProps:v,theirProps:r,slot:m,defaultTag:_6e,name:"Menu"}))))}let x6e="button";function b6e(n,e){var t;let r=Ae.useId(),{id:i=`headlessui-menu-button-${r}`,disabled:s=!1,autoFocus:a=!1,...l}=n,[o,h]=m3("Menu.Button"),d=Gze(),m=sg(e,Uze(),Co(ee=>h({type:7,element:ee}))),v=Co(ee=>{switch(ee.key){case yl.Space:case yl.Enter:case yl.ArrowDown:ee.preventDefault(),ee.stopPropagation(),Xf.flushSync(()=>h({type:0})),h({type:2,focus:jl.First});break;case yl.ArrowUp:ee.preventDefault(),ee.stopPropagation(),Xf.flushSync(()=>h({type:0})),h({type:2,focus:jl.Last});break}}),y=Co(ee=>{switch(ee.key){case yl.Space:ee.preventDefault();break}}),S=Co(ee=>{var re;if(UFe(ee.currentTarget))return ee.preventDefault();s||(o.menuState===0?(Xf.flushSync(()=>h({type:1})),(re=o.buttonElement)==null||re.focus({preventScroll:!0})):(ee.preventDefault(),h({type:0})))}),{isFocusVisible:E,focusProps:M}=TFe({autoFocus:a}),{isHovered:C,hoverProps:L}=AFe({isDisabled:s}),{pressed:k,pressProps:H}=PFe({disabled:s}),q=Ae.useMemo(()=>({open:o.menuState===0,active:k||o.menuState===0,disabled:s,hover:C,focus:E,autofocus:a}),[o,C,E,k,s,a]),Z=zle(d(),{ref:m,id:i,type:vNe(n,o.buttonElement),"aria-haspopup":"menu","aria-controls":(t=o.itemsElement)==null?void 0:t.id,"aria-expanded":o.menuState===0,disabled:s||void 0,autoFocus:a,onKeyDown:v,onKeyUp:y,onClick:S},M,L,H);return zh()({ourProps:Z,theirProps:l,slot:q,defaultTag:x6e,name:"Menu.Button"})}let w6e="div",S6e=hz.RenderStrategy|hz.Static;function A6e(n,e){var t,r;let i=Ae.useId(),{id:s=`headlessui-menu-items-${i}`,anchor:a,portal:l=!1,modal:o=!0,transition:h=!1,...d}=n,m=zze(a),[v,y]=m3("Menu.Items"),[S,E]=Hze(m),M=Vze(),[C,L]=Ae.useState(null),k=sg(e,m?S:null,Co(ye=>y({type:8,element:ye})),L),H=$8(v.itemsElement);m&&(l=!0);let q=$ze(),[Z,ee]=INe(h,C,q!==null?(q&wT.Open)===wT.Open:v.menuState===0);nNe(Z,v.buttonElement,()=>{y({type:1})});let re=v.__demoMode?!1:o&&v.menuState===0;SNe(re,H);let se=v.__demoMode?!1:o&&v.menuState===0;tNe(se,{allowed:Ae.useCallback(()=>[v.buttonElement,v.itemsElement],[v.buttonElement,v.itemsElement])});let ae=v.menuState!==0,fe=u6e(ae,v.buttonElement)?!1:Z;Ae.useEffect(()=>{let ye=v.itemsElement;ye&&v.menuState===0&&ye!==(H==null?void 0:H.activeElement)&&ye.focus({preventScroll:!0})},[v.menuState,v.itemsElement,H]),DNe(v.menuState===0,{container:v.itemsElement,accept(ye){return ye.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:ye.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(ye){ye.setAttribute("role","none")}});let Se=c3(),Ce=Co(ye=>{var $e,Ve,_t;switch(Se.dispose(),ye.key){case yl.Space:if(v.searchQuery!=="")return ye.preventDefault(),ye.stopPropagation(),y({type:3,value:ye.key});case yl.Enter:if(ye.preventDefault(),ye.stopPropagation(),y({type:1}),v.activeItemIndex!==null){let{dataRef:wt}=v.items[v.activeItemIndex];(Ve=($e=wt.current)==null?void 0:$e.domRef.current)==null||Ve.click()}Xle(v.buttonElement);break;case yl.ArrowDown:return ye.preventDefault(),ye.stopPropagation(),y({type:2,focus:jl.Next});case yl.ArrowUp:return ye.preventDefault(),ye.stopPropagation(),y({type:2,focus:jl.Previous});case yl.Home:case yl.PageUp:return ye.preventDefault(),ye.stopPropagation(),y({type:2,focus:jl.First});case yl.End:case yl.PageDown:return ye.preventDefault(),ye.stopPropagation(),y({type:2,focus:jl.Last});case yl.Escape:ye.preventDefault(),ye.stopPropagation(),Xf.flushSync(()=>y({type:1})),(_t=v.buttonElement)==null||_t.focus({preventScroll:!0});break;case yl.Tab:ye.preventDefault(),ye.stopPropagation(),Xf.flushSync(()=>y({type:1})),hNe(v.buttonElement,ye.shiftKey?pz.Previous:pz.Next);break;default:ye.key.length===1&&(y({type:3,value:ye.key}),Se.setTimeout(()=>y({type:4}),350));break}}),Ie=Co(ye=>{switch(ye.key){case yl.Space:ye.preventDefault();break}}),je=Ae.useMemo(()=>({open:v.menuState===0}),[v.menuState]),Le=zle(m?M():{},{"aria-activedescendant":v.activeItemIndex===null||(t=v.items[v.activeItemIndex])==null?void 0:t.id,"aria-labelledby":(r=v.buttonElement)==null?void 0:r.id,id:s,onKeyDown:Ce,onKeyUp:Ie,role:"menu",tabIndex:v.menuState===0?0:void 0,ref:k,style:{...d.style,...E,"--button-width":JFe(v.buttonElement,!0).width},...ENe(ee)}),ot=zh();return $l.createElement(c6e,{enabled:l?n.static||Z:!1},ot({ourProps:Le,theirProps:d,slot:je,defaultTag:w6e,features:S6e,visible:fe,name:"Menu.Items"}))}let T6e=Ae.Fragment;function M6e(n,e){let t=Ae.useId(),{id:r=`headlessui-menu-item-${t}`,disabled:i=!1,...s}=n,[a,l]=m3("Menu.Item"),o=a.activeItemIndex!==null?a.items[a.activeItemIndex].id===r:!1,h=Ae.useRef(null),d=sg(e,h);Ca(()=>{if(!a.__demoMode&&a.menuState===0&&o&&a.activationTrigger!==0)return wp().requestAnimationFrame(()=>{var fe,Se;(Se=(fe=h.current)==null?void 0:fe.scrollIntoView)==null||Se.call(fe,{block:"nearest"})})},[a.__demoMode,h,o,a.menuState,a.activationTrigger,a.activeItemIndex]);let m=f6e(h),v=Ae.useRef({disabled:i,domRef:h,get textValue(){return m()}});Ca(()=>{v.current.disabled=i},[v,i]),Ca(()=>(l({type:5,id:r,dataRef:v}),()=>l({type:6,id:r})),[v,r]);let y=Co(()=>{l({type:1})}),S=Co(fe=>{if(i)return fe.preventDefault();l({type:1}),Xle(a.buttonElement)}),E=Co(()=>{if(i)return l({type:2,focus:jl.Nothing});l({type:2,focus:jl.Specific,id:r})}),M=ANe(),C=Co(fe=>{M.update(fe),!i&&(o||l({type:2,focus:jl.Specific,id:r,trigger:0}))}),L=Co(fe=>{M.wasMoved(fe)&&(i||o||l({type:2,focus:jl.Specific,id:r,trigger:0}))}),k=Co(fe=>{M.wasMoved(fe)&&(i||o&&l({type:2,focus:jl.Nothing}))}),[H,q]=Vle(),[Z,ee]=HFe(),re=Ae.useMemo(()=>({active:o,focus:o,disabled:i,close:y}),[o,i,y]),se={id:r,ref:d,role:"menuitem",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-labelledby":H,"aria-describedby":Z,disabled:void 0,onClick:S,onFocus:E,onPointerEnter:C,onMouseEnter:C,onPointerMove:L,onMouseMove:L,onPointerLeave:k,onMouseLeave:k},ae=zh();return $l.createElement(q,null,$l.createElement(ee,null,ae({ourProps:se,theirProps:s,slot:re,defaultTag:T6e,name:"Menu.Item"})))}let C6e="div";function E6e(n,e){let[t,r]=Vle(),i=n,s={ref:e,"aria-labelledby":t,role:"group"},a=zh();return $l.createElement(r,null,a({ourProps:s,theirProps:i,slot:{},defaultTag:C6e,name:"Menu.Section"}))}let I6e="header";function R6e(n,e){let t=Ae.useId(),{id:r=`headlessui-menu-heading-${t}`,...i}=n,s=H8();Ca(()=>s.register(r),[r,s.register]);let a={id:r,ref:e,role:"presentation",...s.props};return zh()({ourProps:a,theirProps:i,slot:{},defaultTag:I6e,name:"Menu.Heading"})}let P6e="div";function L6e(n,e){let t=n,r={ref:e,role:"separator"};return zh()({ourProps:r,theirProps:t,slot:{},defaultTag:P6e,name:"Menu.Separator"})}let D6e=Uh(y6e),t9=Uh(b6e),n9=Uh(A6e),Uf=Uh(M6e),B6e=Uh(E6e),k6e=Uh(R6e),O6e=Uh(L6e),fce=Object.assign(D6e,{Button:t9,Items:n9,Item:Uf,Section:B6e,Heading:k6e,Separator:O6e});const F6e="/about_portfolio/assets/heart--ic8Oklh.png",N6e=()=>{let n=Ae.useRef(null),e,t,r,i=null;const s=()=>{for(let E=-15;E<16;E++)for(let M=-10;M<11;M++){let C=new nD({color:Math.random()*16777215}),L=new q6(C);L.position.set(E*2,M*2,0),e.add(L)}},a=()=>{const E=new $r,M=new au({size:3,vertexColors:!0,color:16777215});let C=[],L=[];for(let H=-15;H<16;H++)for(let q=-15;q<16;q++){C.push(H*4,q*4,0);let Z=new Vn(Math.random()*16777215);L.push(Z.r,Z.g,Z.b)}E.attributes.position=new ar(C,3),E.attributes.color=new ar(L,3);const k=new Th(E,M);e.add(k)},l=()=>{const E=document.createElement("canvas");E.width=300,E.height=300;const M=E.getContext("2d");M.lineWidth=10,M.beginPath(),M.moveTo(200,150);var C=M.createLinearGradient(100,0,200,0);C.addColorStop("0","black"),C.addColorStop("0.3","magenta"),C.addColorStop("0.5","blue"),C.addColorStop("0.6","green"),C.addColorStop("0.8","yellow"),C.addColorStop("1","red"),M.strokeStyle=C,M.arc(150,150,50,0,2*Math.PI),M.stroke();const L=new AF(E);return L.needsUpdate=!0,L},o=(E,M,C,L,k)=>{const H=new $r,q=new au({size:E,transparent:M,opacity:C,sizeAttenuation:L,map:l(),color:k,depthTest:!0,depthWrite:!1});let Z=[],ee=200;for(let ae=0;ae<400;ae++){let fe=new Ze(Math.random()*ee-ee/2,Math.random()*ee-ee/2,Math.random()*ee-ee/2);Z.push(fe.x,fe.y,fe.z)}let re=new ar(Z,3);H.attributes.position=re;const se=new Th(H,q);e.add(se)},h=(E,M,C)=>{const L=new $r,k=new au({size:E,transparent:C,opacity:M,map:new Kf().load(F6e),sizeAttenuation:!0,depthTest:!0,depthWrite:!1});let H=[],q=200;for(let ee=0;ee<400;ee++){let re=new Ze(Math.random()*q-q/2,Math.random()*q-q/2,Math.random()*q-q/2);H.push(re.x,re.y,re.z)}L.attributes.position=new ar(H,3);let Z=new Th(L,k);e.add(Z)},d=()=>{const E=document.createElement("canvas");E.width=16,E.height=16;let M=E.getContext("2d"),C=M.createRadialGradient(E.width/2,E.height/2,0,E.width/2,E.height/2,E.width/2);C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.2,"rgba(0,255,255,1)"),C.addColorStop(.4,"rgba(0,0,255,1)"),C.addColorStop(1,"rgba(0,255,0,1)"),M.fillStyle=C,M.fillRect(0,0,E.width,E.height);const L=new AF(E);return L.needsUpdate=!0,L},m=()=>{const E=new km(50,32,32),M=new au({size:1,map:d(),transparent:!0,opacity:1,sizeAttenuation:!0,color:15539236,blending:Kb,depthTest:!0,depthWrite:!1}),C=new Th(E,M);e.add(C)},v=()=>{const E={width:window.innerWidth,height:window.innerHeight};e=new Tl,t=new ts(75,1,.1,1e3),e.add(t),r=new Lv(t,n.current),r.enableDamping=!0,i=new Yl({canvas:n.current}),i.setSize(E.width,E.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.aspect=E.width/E.height,t.position.z=120,t.lookAt(new Ze(0,0,0))},y=()=>{i.render(e,t),r&&r.update(),requestAnimationFrame(y)},S=E=>{switch(e.clear(),E){case 0:s();break;case 1:{a();break}case 2:o(10,!0,.6,!0,16777215);break;case 3:h(10,.6,!0);break;case 4:m();break;default:s()}};return Ae.useEffect(()=>{v(),S(0),y()},[]),me.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[me.jsx("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:me.jsx("div",{className:"mr-8 text-right",children:me.jsxs(fce,{children:[me.jsx(t9,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:"different ways to create particles"}),me.jsxs(n9,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[me.jsx(Uf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(0),children:"createParticlesBySprite"})}),me.jsx(Uf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(1),children:"createParticlesByPoints"})}),me.jsx(Uf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(2),children:"createParticlesByCanvas"})}),me.jsx(Uf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(3),children:"createParticlesByTexture"})}),me.jsx(Uf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(4),children:"createParticlesByGeometry"})})]})]})})}),me.jsx("canvas",{ref:n})]})},z6e="/about_portfolio/assets/astronaut-FRdIWehG.glb",U6e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgSURBVHgB7cmxDQAACALBj/vvrIWUJCzAtQf1VtwNlR3vKwf7lmC9zQAAAABJRU5ErkJggg==",G6e=()=>{let n=Ae.useRef(null),e=null,t=null,r=null,i=null,s=null,a=0,l=[],o={width:0,height:0};const h=()=>{t=new Yl({canvas:n.current,antialias:!0}),t.setSize(o.width,o.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),e=new Tl,r=new ts(75,o.width/o.height,.1,100),r.position.z=150,r.lookAt(new Ze(0,0,0)),e.add(r),t.render(e,r),d(),m(),v()},d=()=>{new l3().load(z6e,Z=>{i=Z.scene,i.material=new KT,i.scale.set(4e-4,4e-4,4e-4),i.position.z=-10,e.add(i)})},m=()=>{const q=new $r,Z=new au({size:10,alphaTest:.8,color:16777215,map:new Kf().load(U6e)});let ee=[];for(let re=0;re<1e3;re++){l.push(H(20,300)*Math.cos(re),H(20,300)*Math.sin(re),H(-1500,10));let se=new Vn(Math.random()*16777215);ee.push(se.r,se.g,se.b)}q.attributes.position=new ar(l,3),q.attributes.color=new ar(ee,3),s=new Th(q,Z),e.add(s)},v=()=>{e.fog=new WT(0,.005);let q=new rv(16777215,.8);q.position.set(50,50,75),e.add(q),q=new rv(16777215,.8),q.position.set(-50,-50,75),e.add(q),q=new rv(16777215,.5),q.position.set(25,50,200),e.add(q),q=new x1(16777215,.8),e.add(q)},y=()=>{s.position.x=.2*Math.cos(a),s.position.y=.2*Math.cos(a),s.position.z+=.015,r.lookAt(s.position);for(let q=0;q<l.length;q++)if((q+1)%3===0){l[q]-r.position.z>=0&&(l[q]=H(-1e3,-500)),l[q]+=2.5;let ee=new ar(l,3);s.geometry.attributes.position=ee}s.geometry.verticesNeedUpdate=!0},S=()=>{i&&(i.position.z=.08*Math.sin(a)+(r.position.z-.2),i.rotation.x+=.015,i.rotation.y+=.015,i.rotation.z+=.01)},E=()=>{let q=window.innerWidth,Z=window.innerHeight;(window.innerHeight!==Z||window.innerWidth!==q)&&(t.setSize(q,Z,!1),r.aspect=q/Z,r.updateProjectionMatrix())},M=()=>{y(),S(),E(),t.render(e,r),a+=.01,requestAnimationFrame(M)},C=()=>({onResize:()=>{o.width=window.innerWidth,o.height=window.innerHeight,t.setSize(o.width,o.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.aspect=o.width/o.height,r.updateProjectionMatrix()},onMouseMove:ee=>{let re=window.innerWidth/2,se=window.innerHeight/2,ae=-1*((re-ee.clientX)/re),fe=-1*((se-ee.clientY)/se);r&&(r.position.x=ae*5),r&&(r.position.y=fe*5),i&&(i.position.x=ae*5),i&&(i.position.y=fe*5)}}),{onResize:L,onMouseMove:k}=C(),H=(q,Z)=>q+Math.random()*(Z-q);return Ae.useEffect(()=>(o.width=window.innerWidth,o.height=window.innerHeight,h(),M(),window.addEventListener("resize",L),window.addEventListener("mousemove",k),()=>{window.removeEventListener("resize",L),window.removeEventListener("mousemove",k)}),[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:n})})},V6e={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Vn(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class bv extends kv{constructor(e,t,r,i){super(),this.strength=t!==void 0?t:1,this.radius=r,this.threshold=i,this.resolution=e!==void 0?new nn(e.x,e.y):new nn(256,256),this.clearColor=new Vn(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new wl(s,a,{type:Ch}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let m=0;m<this.nMips;m++){const v=new wl(s,a,{type:Ch});v.texture.name="UnrealBloomPass.h"+m,v.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(v);const y=new wl(s,a,{type:Ch});y.texture.name="UnrealBloomPass.v"+m,y.texture.generateMipmaps=!1,this.renderTargetsVertical.push(y),s=Math.round(s/2),a=Math.round(a/2)}const l=V6e;this.highPassUniforms=Wm.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Io({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.separableBlurMaterials=[];const o=[3,5,7,9,11];s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let m=0;m<this.nMips;m++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(o[m])),this.separableBlurMaterials[m].uniforms.invSize.value=new nn(1/s,1/a),s=Math.round(s/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const h=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=h,this.bloomTintColors=[new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const d=Rre;this.copyUniforms=Wm.clone(d.uniforms),this.blendMaterial=new Io({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:Kb,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Vn,this.oldClearAlpha=1,this.basic=new _o,this.fsQuad=new rM(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(r,i);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(r,i),this.renderTargetsVertical[s].setSize(r,i),this.separableBlurMaterials[s].uniforms.invSize.value=new nn(1/r,1/i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let l=this.renderTargetBright;for(let o=0;o<this.nMips;o++)this.fsQuad.material=this.separableBlurMaterials[o],this.separableBlurMaterials[o].uniforms.colorTexture.value=l.texture,this.separableBlurMaterials[o].uniforms.direction.value=bv.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[o]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[o].uniforms.colorTexture.value=this.renderTargetsHorizontal[o].texture,this.separableBlurMaterials[o].uniforms.direction.value=bv.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[o]),e.clear(),this.fsQuad.render(e),l=this.renderTargetsVertical[o];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=a}getSeperableBlurMaterial(e){const t=[];for(let r=0;r<e;r++)t.push(.39894*Math.exp(-.5*r*r/(e*e))/e);return new Io({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new nn(.5,.5)},direction:{value:new nn(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Io({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}bv.BlurDirectionX=new nn(1,0);bv.BlurDirectionY=new nn(0,1);const kK={name:"ConvolutionShader",defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new nn(.001953125,0)},cKernel:{value:[]}},vertexShader:`

		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float cKernel[ KERNEL_SIZE_INT ];

		uniform sampler2D tDiffuse;
		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vec2 imageCoord = vUv;
			vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );

			for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {

				sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];
				imageCoord += uImageIncrement;

			}

			gl_FragColor = sum;

		}`,buildKernel:function(n){let t=2*Math.ceil(n*3)+1;t>25&&(t=25);const r=(t-1)*.5,i=new Array(t);let s=0;for(let a=0;a<t;++a)i[a]=H6e(a-r,n),s+=i[a];for(let a=0;a<t;++a)i[a]/=s;return i}};function H6e(n,e){return Math.exp(-(n*n)/(2*e*e))}class Hy extends kv{constructor(e=1,t=25,r=4){super(),this.renderTargetX=new wl(1,1,{type:Ch}),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new wl(1,1,{type:Ch}),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=Wm.clone(xI.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Io({name:xI.name,uniforms:this.combineUniforms,vertexShader:xI.vertexShader,fragmentShader:xI.fragmentShader,blending:Kb,transparent:!0});const i=kK;this.convolutionUniforms=Wm.clone(i.uniforms),this.convolutionUniforms.uImageIncrement.value=Hy.blurX,this.convolutionUniforms.cKernel.value=kK.buildKernel(r),this.materialConvolution=new Io({name:i.name,uniforms:this.convolutionUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new rM(null)}render(e,t,r,i,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=Hy.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Hy.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}dispose(){this.renderTargetX.dispose(),this.renderTargetY.dispose(),this.materialCombine.dispose(),this.materialConvolution.dispose(),this.fsQuad.dispose()}}const xI={name:"CombineShader",uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float strength;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = strength * texel;

		}`};Hy.blurX=new nn(.001953125,0);Hy.blurY=new nn(0,.001953125);const j6e={name:"FilmShader",uniforms:{tDiffuse:{value:null},time:{value:0},intensity:{value:.5},grayscale:{value:!1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		uniform float intensity;
		uniform bool grayscale;
		uniform float time;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 base = texture2D( tDiffuse, vUv );

			float noise = rand( fract( vUv + time ) );

			vec3 color = base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );

			color = mix( base.rgb, color, intensity );

			if ( grayscale ) {

				color = vec3( luminance( color ) ); // assuming linear-srgb

			}

			gl_FragColor = vec4( color, base.a );

		}`};class W6e extends kv{constructor(e=.5,t=!1){super();const r=j6e;this.uniforms=Wm.clone(r.uniforms),this.material=new Io({name:r.name,uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.uniforms.intensity.value=e,this.uniforms.grayscale.value=t,this.fsQuad=new rM(this.material)}render(e,t,r,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=i,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const X6e=()=>{const n=Ae.useRef(null);let e,t,r,i,s=null,a={width:0,height:0},l;const o=()=>{a.width=window.innerWidth,a.height=window.innerHeight,e=new Tl,t=new ts(75,a.width/a.height,.1,100),t.position.set(1,-1,1),e.add(t),s=new Yl({canvas:n.current,antialias:!0}),s.setSize(a.width,a.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.autoClear=!1,l=new Lv(t,s.domElement),l.enableDamping=!0;const d=new _p(1,1,1),m=new _o({color:65280});i=new Ii(d,m),e.add(i);const v=new AD(e,t);new bv(new nn(a.width,a.height),1.5,.4,.85);const y=new Hy(1.5,25,4,256),S=new W6e(.35,.25,648,!1);r=new SD(s),r.renderToScreen=!0,r.addPass(v),r.addPass(y),r.addPass(S)},h=()=>{l&&l.update(),i&&(i.rotation.y+=.002),i&&(i.rotation.x+=.002),r&&r.render(),r.setSize(a.width,a.height),s.render(e,t),window.requestAnimationFrame(h)};return Ae.useEffect(()=>{o(),h()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:n})})};var $6e=`varying vec2 vUv;\r
varying vec3 vNormal;\r
varying vec3 vCamPos;

void main() {\r
  vUv = uv;\r
  vNormal = normal;\r
  vCamPos = cameraPosition;\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
}`,q6e=`#define MUN_OCTAVES 5\r
#define M_PI 3.1415926535897932384626433832795\r
precision mediump float;

varying vec3 vNormal;\r
varying vec3 vCamPos;\r
varying vec2 vUv;

uniform vec4 resolution;\r
uniform sampler2D perlinNoise;\r
uniform sampler2D sparkNoise;\r
uniform sampler2D waterTurbulence;\r
uniform sampler2D noiseText;\r
uniform float time;\r
uniform vec3 color0;\r
uniform vec3 color1;\r
uniform vec3 color2;\r
uniform vec3 color3;\r
uniform vec3 color4;\r
uniform vec3 color5;

float Rand(vec2 n) {\r
  return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r
}

float Noise(vec2 p) {\r
  vec2 ip = floor(p);\r
  vec2 u = fract(p);\r
  u = u * u * (3.0 - 2.0 * u);

  float res =\r
      mix(mix(Rand(ip), Rand(ip + vec2(1.0, 0.0)), u.x),\r
          mix(Rand(ip + vec2(0.0, 1.0)), Rand(ip + vec2(1.0, 1.0)), u.x), u.y);\r
  return res * res;\r
}

float Fbm(vec2 p) {\r
  float v = 0.0;\r
  float a = 0.5;\r
  vec2 shift = vec2(100);\r
  
  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\r
  for (int i = 0; i < MUN_OCTAVES; ++i) {\r
    v += a * Noise(p);\r
    p = rot * p * 2.0 + shift;\r
    a *= 0.5;\r
  }\r
  return v;\r
}

float SetOpacity(float r, float g, float b, float toneThreshold) {\r
  float tone = (r + g + b) / 3.0;\r
  if (tone < toneThreshold) {\r
    return 0.0;\r
  }\r
  return 1.0;\r
}

vec3 Rgbcol(vec3 col) {\r
  return vec3(col.r / 255.0, col.g / 255.0, col.b / 255.0);\r
}

vec2 Rotate(vec2 v, float a) {\r
  float s = sin(a);\r
  float c = cos(a);\r
  mat2 m = mat2(c, -s, s, c);\r
  return m * v;\r
}

vec2 UnityPolarCoordinates(vec2 uv, vec2 center, float radialScale,\r
                           float lengthScale) {\r
  vec2 delta = uv - center;\r
  float radius = length(delta) * radialScale * 2.0;\r
  float angle = atan(delta.x, delta.y) * 1.0 / 6.28 * lengthScale;\r
  return vec2(radius, angle);\r
}

void main() {\r
  
  vec2 oldUv = gl_FragCoord.xy / resolution.xy;\r
  vec2 uv = vUv;\r
  vec2 imgUv = uv;\r
  float scale = 1.0;\r
  oldUv *= 0.5 + time;\r
  oldUv.y = oldUv.y;\r
  vec2 p = oldUv * scale; 

  
  float noise = Fbm(p) * 0.04;\r
  vec4 txt = texture2D(perlinNoise, oldUv);\r
  float gradient = dot(normalize(-vCamPos), normalize(vNormal));\r
  float pct = distance(vUv, vec2(0.5));\r
  
  vec3 rgbColor0 = Rgbcol(color0);\r
  vec3 rgbColor1 = Rgbcol(color1);\r
  vec3 rgbColor2 = Rgbcol(color2);\r
  vec3 rgbColor3 = Rgbcol(color3);\r
  vec3 rgbColor4 = Rgbcol(color4);\r
  vec3 rgbColor5 = Rgbcol(color5);

  
  float y = smoothstep(0.16, 0.525, pct);\r
  vec3 backColor = mix(rgbColor0, rgbColor5, y);\r
  gl_FragColor = vec4(backColor, 1.0);

  
  vec2 center = vec2(0.5);\r
  vec2 cor = UnityPolarCoordinates(vUv, center, 1.0, 1.0);\r
  vec2 newvUv = vUv - 0.5;\r
  vec3 noiseTextvUv =\r
      texture2D(perlinNoise, mod(Rotate(newvUv * 0.15 + vec2(sin(time * 0.005),\r
                                                             cos(time * 0.005)),\r
                                        time),\r
                                 1.0))\r
          .rgb; 

  
  vec2 newUv = vec2(cor.x + time, cor.x + cor.y);\r
  vec3 noiseText1 = texture2D(perlinNoise, mod(newUv, 1.0))\r
                        .rgb; 
  vec3 noiseText2 = texture2D(sparkNoise, mod(newUv, 1.)).rgb;\r
  vec3 noiseText3 = texture2D(waterTurbulence, mod(newUv, 1.))\r
                        .rgb; 

  
  float tone0 = 1. - smoothstep(0.3, 0.6, noiseText1.r);\r
  float tone1 = smoothstep(0.3, 0.6, noiseText2.r);\r
  float tone2 = smoothstep(0.3, 0.6, noiseText3.r);

  
  float opacity0 = SetOpacity(tone0, tone0, tone0, .29);\r
  float opacity1 = SetOpacity(tone1, tone1, tone1, .49);\r
  float opacity2 = SetOpacity(tone2, tone2, tone2, .69);

  
  float gradientTone = 1. - smoothstep(0.196, 0.532, pct);\r
  vec4 circularNoise = vec4(vec3(gradientTone) * noiseTextvUv * 1.4, 1.0);\r
  float gradOpacity =\r
      SetOpacity(circularNoise.r, circularNoise.g, circularNoise.b, 0.19);

  
  vec2 uv2 = uv;\r
  float iTime = time * 0.004;\r
  uv.y += iTime / 10.0;\r
  uv.x -= (sin(iTime / 10.0) / 2.0);\r
  uv2.x += iTime / 14.0;\r
  uv2.x += (sin(iTime / 10.0) / 9.0);\r
  float result = 0.0;\r
  result +=\r
      texture2D(noiseText, mod(uv * 0.5, 1.) * 0.6 + vec2(iTime * (-0.003)))\r
          .r; 
              
  result *=\r
      texture2D(noiseText, mod(uv2 * 0.5, 1.) * 0.9 + vec2(iTime * 0.002)).b;\r
  result = pow(result, 4.0);

  
  if (opacity2 > 0.0) {\r
    gl_FragColor = vec4(rgbColor4, 0.) * vec4(opacity2);\r
  } else if (opacity1 > 0.0) {\r
    gl_FragColor = vec4(rgbColor2, 0.) * vec4(opacity1);\r
  } else if (opacity0 > 0.0) {\r
    gl_FragColor = vec4(rgbColor1, 0.) * vec4(opacity0);\r
  }\r
  gl_FragColor += vec4(108.0) * result * (y * 0.02);\r
  gl_FragColor *= vec4(gradOpacity);\r
}`;const Z6e="/about_portfolio/assets/rickAndMorty-Do2rctLy.glb",Y6e="/about_portfolio/assets/waterturbulence-D5gcttvO.png",K6e="/about_portfolio/assets/noise-CSy_EG5b.png",J6e=()=>{const n=Ae.useRef(null);let e,t,r,i=null,s={width:0,height:0},a,l,o=null,h=null;const d=()=>{s.width=window.innerWidth,s.height=window.innerHeight,e=new Tl,t=new ts(75,s.width/s.height,.1,100),t.position.set(0,1,5),e.add(t),r=new Yl({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.autoClear=!1,r.setClearAlpha(0),r.physicallyCorrectLights=!0,r.toneMapping=jL,r.toneMappingExposure=2,r.render(e,t);const M=new Pv(16777215,1);M.castShadow=!0,M.shadow.camera.far=15,M.shadow.mapSize.set(1024,1024),M.shadow.normalBias=.05,M.position.set(.25,3,-1.25),e.add(M);const C=new x1(16777215,1.2);e.add(C),i=new Lv(t,r.domElement),i.enableDamping=!0,i.enablePan=!1,i.minPolarAngle=.5,i.maxPolarAngle=2.5,i.minAzimuthAngle=-1,i.maxAzimuthAngle=1},m={exposure:2.8,bloomStrength:2.39,bloomThreshold:0,bloomRadius:.38,color0:[1,5,1],color1:[2,20,2],color2:[44,97,15],color3:[14,28,5],color4:[255,255,255],color5:[74,145,0]},v=()=>{const M=new AD(e,t),C=new bv(new nn(s.width,s.height),1.5,.4,.85);C.threshold=m.bloomThreshold,C.strength=m.bloomStrength,C.radius=m.bloomRadius,h=new SD(r),h.renderToScreen=!0,h.addPass(M),h.addPass(C)},y=()=>{const M=new tg(8,8,1,1),C=new Kf;l=new Io({uniforms:{time:{type:"f",value:0},perlinNoise:{type:"t",value:C.load(Tle)},sparkNoise:{type:"t",value:C.load(Mle)},waterTurbulence:{type:"t",value:C.load(Y6e)},noiseText:{type:"t",value:C.load(K6e)},color0:{value:new Ze(...m.color0)},color1:{value:new Ze(...m.color1)},color2:{value:new Ze(...m.color2)},color3:{value:new Ze(...m.color3)},color4:{value:new Ze(...m.color4)},color5:{value:new Ze(...m.color5)},resolution:{value:new nn(s.width,s.height)}},vertexShader:$6e,fragmentShader:q6e}),a=new Ii(M,l),a.layers.enable(1),e.add(a),v();const L=new JT;L.onLoad=()=>{};const k=new U8;k.setDecoderPath("/draco/"),k.setDecoderConfig({type:"js"});const H=new l3(L);H.setDRACOLoader(k),H.load(Z6e,q=>{q.scene&&(o=q.scene,o.scale.set(.02,.02,.02),o.position.x=-.5,o.rotation.y=Math.PI,o.layers.set(0),e.add(o))})},S=()=>{const M=new _Ae,C=M.addFolder("bloom");C.add(m,"bloomStrength",0,10).name("bloomStrength").listen(),C.add(m,"bloomRadius",.1,10).name("bloomRadius").listen(),C.open();const L=M.addFolder("Colors");L.addColor(m,"color0").name("layer0"),L.addColor(m,"color1").name("layer1"),L.addColor(m,"color2").name("layer2"),L.addColor(m,"color3").name("layer3"),L.addColor(m,"color4").name("layer4"),L.addColor(m,"color5").name("layer5"),L.open()},E=M=>{const C=new ng;l.uniforms.time.value=M/5e3,l.uniforms.color5.value=new Ze(...m.color5),l.uniforms.color4.value=new Ze(...m.color4),l.uniforms.color3.value=new Ze(...m.color3),l.uniforms.color2.value=new Ze(...m.color2),l.uniforms.color1.value=new Ze(...m.color1),l.uniforms.color0.value=new Ze(...m.color0),r.clear(),t.layers.set(1),h.render(),r.clearDepth(),t.layers.set(0),r.render(e,t);const k=C.getElapsedTime()*.5;o&&(o.rotation.x=Math.cos(k)*.2,o.rotation.z=Math.sin(k)*.1,o.position.z+=Math.cos(k)*.005);const H=Math.cos(k)*2+3;a&&a.scale.set(H,H,H),i.update(),window.requestAnimationFrame(E)};return Ae.useEffect(()=>{d(),y(),S(),E()},[]),me.jsx("div",{className:"w-screen h-screen bg-black",children:me.jsx("canvas",{ref:n})})};var Q6e=`varying vec2 vUv;

void main() {\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
  vUv = uv;\r
}`,eUe=`precision mediump float;\r
#define PI 3.1415926535897932384626433832795

varying vec2 vUv;

float random(vec2 st) {\r
  return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\r
}

vec2 rotate(vec2 uv, float rotation, vec2 mid) {\r
  return vec2(\r
      cos(rotation) * (uv.x - mid.x) - sin(rotation) * (uv.y - mid.y) + mid.x,\r
      sin(rotation) * (uv.x - mid.x) + cos(rotation) * (uv.y - mid.y) + mid.y);\r
}\r

vec2 fade(vec2 t) { return t * t * t * (t * (t * 6.0 - 15.0) + 10.0); }

vec4 permute(vec4 x) { return mod(((x * 34.0) + 1.0) * x, 289.0); }

float cnoise(vec2 P) {\r
  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\r
  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\r
  Pi = mod(Pi, 289.0); 
  vec4 ix = Pi.xzxz;\r
  vec4 iy = Pi.yyww;\r
  vec4 fx = Pf.xzxz;\r
  vec4 fy = Pf.yyww;\r
  vec4 i = permute(permute(ix) + iy);\r
  vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0; 
  vec4 gy = abs(gx) - 0.5;\r
  vec4 tx = floor(gx + 0.5);\r
  gx = gx - tx;\r
  vec2 g00 = vec2(gx.x, gy.x);\r
  vec2 g10 = vec2(gx.y, gy.y);\r
  vec2 g01 = vec2(gx.z, gy.z);\r
  vec2 g11 = vec2(gx.w, gy.w);\r
  vec4 norm =\r
      1.79284291400159 - 0.85373472095314 * vec4(dot(g00, g00), dot(g01, g01),\r
                                                 dot(g10, g10), dot(g11, g11));\r
  g00 *= norm.x;\r
  g01 *= norm.y;\r
  g10 *= norm.z;\r
  g11 *= norm.w;\r
  float n00 = dot(g00, vec2(fx.x, fy.x));\r
  float n10 = dot(g10, vec2(fx.y, fy.y));\r
  float n01 = dot(g01, vec2(fx.z, fy.z));\r
  float n11 = dot(g11, vec2(fx.w, fy.w));\r
  vec2 fade_xy = fade(Pf.xy);\r
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\r
  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\r
  return 2.3 * n_xy;\r
}

void main() {\r
  
  
  
  
  
  
  
  

  
  
  
  
  

  vec2 rotateUv = rotate(vUv, PI / 4.0, vec2(0.5));\r
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  

  

  
  
  
  
  
  
  
  
  

  
  

  
  

  
  
  
  

  
  
  

  float strength = step(0.9, sin(cnoise(vUv * 10.0) * 20.0));

  vec3 blackColor = vec3(0.0);\r
  vec3 uvColor = vec3(vUv, 0.2);\r
  vec3 mixColor = mix(blackColor, uvColor, strength);\r
  gl_FragColor = vec4(mixColor, 1.0);\r
}`;const tUe=()=>{let n,e,t=null,r={width:0,height:0},i=Ae.useRef(null),s,a,l=null;const o=()=>{r.width=window.innerWidth,r.height=window.innerHeight,n=new Tl,e=new ts(75,r.width/r.height,.1,100),e.position.set(1,-1,1),n.add(e),t=new Yl({canvas:i.current}),t.setSize(r.width,r.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.autoClear=!1,a=new Lv(e,t.domElement),a.enableDamping=!0;const d=new t1(1,64),m=new Io({vertexShader:Q6e,fragmentShader:eUe,side:wc});s=new Ii(d,m),n.add(s);const v=new AD(n,e),y=new bv(new nn(r.width,r.height),2.2,.2,0);l=new SD(t),l.renderToScreen=!0,l.addPass(v),l.addPass(y)},h=()=>{a&&a.update(),s&&(s.rotation.y+=.002),s&&(s.rotation.x+=.002),l&&l.render(),a.update(),t.render(n,e),requestAnimationFrame(h)};return Ae.useEffect(()=>{o(),h()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:i})})};var dce={exports:{}};(function(n,e){var t={};(function(r,i){n.exports=i()})(ade,function(){var r,i,s;function a(o,h){if(!r)r=h;else if(!i)i=h;else{var d="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",m={};r(m),s=h(m),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([d],{type:"text/javascript"})))}}a(["exports"],function(o){function h(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var d,m={},v={};function y(){if(d)return v;d=1,Object.defineProperty(v,"__esModule",{value:!0}),v.setMatrixArrayType=function(A){v.ARRAY_TYPE=c=A},v.toRadian=function(A){return A*_},v.equals=function(A,x){return Math.abs(A-x)<=g*Math.max(1,Math.abs(A),Math.abs(x))},v.RANDOM=v.ARRAY_TYPE=v.EPSILON=void 0;var g=1e-6;v.EPSILON=g;var c=typeof Float32Array<"u"?Float32Array:Array;v.ARRAY_TYPE=c;var f=Math.random;v.RANDOM=f;var _=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var A=0,x=arguments.length;x--;)A+=arguments[x]*arguments[x];return Math.sqrt(A)}),v}var S,E={};function M(){if(S)return E;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}S=1,Object.defineProperty(E,"__esModule",{value:!0}),E.create=function(){var x=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x},E.clone=function(x){var T=new c.ARRAY_TYPE(4);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T},E.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x},E.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x},E.fromValues=function(x,T,B,U){var j=new c.ARRAY_TYPE(4);return j[0]=x,j[1]=T,j[2]=B,j[3]=U,j},E.set=function(x,T,B,U,j){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x},E.transpose=function(x,T){if(x===T){var B=T[1];x[1]=T[2],x[2]=B}else x[0]=T[0],x[1]=T[2],x[2]=T[1],x[3]=T[3];return x},E.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=B*R-j*U;return N?(x[0]=R*(N=1/N),x[1]=-U*N,x[2]=-j*N,x[3]=B*N,x):null},E.adjoint=function(x,T){var B=T[0];return x[0]=T[3],x[1]=-T[1],x[2]=-T[2],x[3]=B,x},E.determinant=function(x){return x[0]*x[3]-x[2]*x[1]},E.multiply=_,E.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=Math.sin(B),z=Math.cos(B);return x[0]=U*z+R*V,x[1]=j*z+N*V,x[2]=U*-V+R*z,x[3]=j*-V+N*z,x},E.scale=function(x,T,B){var U=T[1],j=T[2],R=T[3],N=B[0],V=B[1];return x[0]=T[0]*N,x[1]=U*N,x[2]=j*V,x[3]=R*V,x},E.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=-B,x[3]=U,x},E.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=T[1],x},E.str=function(x){return"mat2("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+")"},E.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3])},E.LDU=function(x,T,B,U){return x[2]=U[2]/U[0],B[0]=U[0],B[1]=U[1],B[3]=U[3]-x[2]*B[1],[x,T,B]},E.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x},E.subtract=A,E.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]},E.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=T[0],V=T[1],z=T[2],G=T[3];return Math.abs(B-N)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(N))&&Math.abs(U-V)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(V))&&Math.abs(j-z)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs(z))&&Math.abs(R-G)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(G))},E.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x},E.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x},E.sub=E.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=f(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function f(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(f=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=B[0],z=B[1],G=B[2],X=B[3];return x[0]=U*V+R*z,x[1]=j*V+N*z,x[2]=U*G+R*X,x[3]=j*G+N*X,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x}return E.mul=_,E.sub=A,E}var C,L={};function k(){if(C)return L;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}C=1,Object.defineProperty(L,"__esModule",{value:!0}),L.create=function(){var x=new c.ARRAY_TYPE(6);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[4]=0,x[5]=0),x[0]=1,x[3]=1,x},L.clone=function(x){var T=new c.ARRAY_TYPE(6);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T[4]=x[4],T[5]=x[5],T},L.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x[4]=T[4],x[5]=T[5],x},L.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x[4]=0,x[5]=0,x},L.fromValues=function(x,T,B,U,j,R){var N=new c.ARRAY_TYPE(6);return N[0]=x,N[1]=T,N[2]=B,N[3]=U,N[4]=j,N[5]=R,N},L.set=function(x,T,B,U,j,R,N){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x[4]=R,x[5]=N,x},L.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=B*R-U*j;return z?(x[0]=R*(z=1/z),x[1]=-U*z,x[2]=-j*z,x[3]=B*z,x[4]=(j*V-R*N)*z,x[5]=(U*N-B*V)*z,x):null},L.determinant=function(x){return x[0]*x[3]-x[1]*x[2]},L.multiply=_,L.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=Math.sin(B),X=Math.cos(B);return x[0]=U*X+R*G,x[1]=j*X+N*G,x[2]=U*-G+R*X,x[3]=j*-G+N*X,x[4]=V,x[5]=z,x},L.scale=function(x,T,B){var U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=B[0],G=B[1];return x[0]=T[0]*z,x[1]=U*z,x[2]=j*G,x[3]=R*G,x[4]=N,x[5]=V,x},L.translate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=B[0],X=B[1];return x[0]=U,x[1]=j,x[2]=R,x[3]=N,x[4]=U*G+R*X+V,x[5]=j*G+N*X+z,x},L.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=-B,x[3]=U,x[4]=0,x[5]=0,x},L.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=T[1],x[4]=0,x[5]=0,x},L.fromTranslation=function(x,T){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x[4]=T[0],x[5]=T[1],x},L.str=function(x){return"mat2d("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+")"},L.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],1)},L.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x[4]=T[4]+B[4],x[5]=T[5]+B[5],x},L.subtract=A,L.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x[4]=T[4]*B,x[5]=T[5]*B,x},L.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x[4]=T[4]+B[4]*U,x[5]=T[5]+B[5]*U,x},L.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]&&x[4]===T[4]&&x[5]===T[5]},L.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=x[4],V=x[5],z=T[0],G=T[1],X=T[2],K=T[3],te=T[4],ce=T[5];return Math.abs(B-z)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(z))&&Math.abs(U-G)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(G))&&Math.abs(j-X)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs(X))&&Math.abs(R-K)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(K))&&Math.abs(N-te)<=c.EPSILON*Math.max(1,Math.abs(N),Math.abs(te))&&Math.abs(V-ce)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(ce))},L.sub=L.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=f(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function f(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(f=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=B[0],X=B[1],K=B[2],te=B[3],ce=B[4],he=B[5];return x[0]=U*G+R*X,x[1]=j*G+N*X,x[2]=U*K+R*te,x[3]=j*K+N*te,x[4]=U*ce+R*he+V,x[5]=j*ce+N*he+z,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x[4]=T[4]-B[4],x[5]=T[5]-B[5],x}return L.mul=_,L.sub=A,L}var H,q={};function Z(){if(H)return q;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}H=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var x=new c.ARRAY_TYPE(9);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x},q.fromMat4=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[4],x[4]=T[5],x[5]=T[6],x[6]=T[8],x[7]=T[9],x[8]=T[10],x},q.clone=function(x){var T=new c.ARRAY_TYPE(9);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T[4]=x[4],T[5]=x[5],T[6]=x[6],T[7]=x[7],T[8]=x[8],T},q.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x[4]=T[4],x[5]=T[5],x[6]=T[6],x[7]=T[7],x[8]=T[8],x},q.fromValues=function(x,T,B,U,j,R,N,V,z){var G=new c.ARRAY_TYPE(9);return G[0]=x,G[1]=T,G[2]=B,G[3]=U,G[4]=j,G[5]=R,G[6]=N,G[7]=V,G[8]=z,G},q.set=function(x,T,B,U,j,R,N,V,z,G){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x[4]=R,x[5]=N,x[6]=V,x[7]=z,x[8]=G,x},q.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=1,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},q.transpose=function(x,T){if(x===T){var B=T[1],U=T[2],j=T[5];x[1]=T[3],x[2]=T[6],x[3]=B,x[5]=T[7],x[6]=U,x[7]=j}else x[0]=T[0],x[1]=T[3],x[2]=T[6],x[3]=T[1],x[4]=T[4],x[5]=T[7],x[6]=T[2],x[7]=T[5],x[8]=T[8];return x},q.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],X=T[8],K=X*N-V*G,te=-X*R+V*z,ce=G*R-N*z,he=B*K+U*te+j*ce;return he?(x[0]=K*(he=1/he),x[1]=(-X*U+j*G)*he,x[2]=(V*U-j*N)*he,x[3]=te*he,x[4]=(X*B-j*z)*he,x[5]=(-V*B+j*R)*he,x[6]=ce*he,x[7]=(-G*B+U*z)*he,x[8]=(N*B-U*R)*he,x):null},q.adjoint=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],X=T[8];return x[0]=N*X-V*G,x[1]=j*G-U*X,x[2]=U*V-j*N,x[3]=V*z-R*X,x[4]=B*X-j*z,x[5]=j*R-B*V,x[6]=R*G-N*z,x[7]=U*z-B*G,x[8]=B*N-U*R,x},q.determinant=function(x){var T=x[3],B=x[4],U=x[5],j=x[6],R=x[7],N=x[8];return x[0]*(N*B-U*R)+x[1]*(-N*T+U*j)+x[2]*(R*T-B*j)},q.multiply=_,q.translate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],X=T[7],K=T[8],te=B[0],ce=B[1];return x[0]=U,x[1]=j,x[2]=R,x[3]=N,x[4]=V,x[5]=z,x[6]=te*U+ce*N+G,x[7]=te*j+ce*V+X,x[8]=te*R+ce*z+K,x},q.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],X=T[7],K=T[8],te=Math.sin(B),ce=Math.cos(B);return x[0]=ce*U+te*N,x[1]=ce*j+te*V,x[2]=ce*R+te*z,x[3]=ce*N-te*U,x[4]=ce*V-te*j,x[5]=ce*z-te*R,x[6]=G,x[7]=X,x[8]=K,x},q.scale=function(x,T,B){var U=B[0],j=B[1];return x[0]=U*T[0],x[1]=U*T[1],x[2]=U*T[2],x[3]=j*T[3],x[4]=j*T[4],x[5]=j*T[5],x[6]=T[6],x[7]=T[7],x[8]=T[8],x},q.fromTranslation=function(x,T){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=1,x[5]=0,x[6]=T[0],x[7]=T[1],x[8]=1,x},q.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=0,x[3]=-B,x[4]=U,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},q.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=0,x[4]=T[1],x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},q.fromMat2d=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=0,x[3]=T[2],x[4]=T[3],x[5]=0,x[6]=T[4],x[7]=T[5],x[8]=1,x},q.fromQuat=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=B+B,V=U+U,z=j+j,G=B*N,X=U*N,K=U*V,te=j*N,ce=j*V,he=j*z,ne=R*N,de=R*V,ge=R*z;return x[0]=1-K-he,x[3]=X-ge,x[6]=te+de,x[1]=X+ge,x[4]=1-G-he,x[7]=ce-ne,x[2]=te-de,x[5]=ce+ne,x[8]=1-G-K,x},q.normalFromMat4=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],X=T[8],K=T[9],te=T[10],ce=T[11],he=T[12],ne=T[13],de=T[14],ge=T[15],Me=B*V-U*N,Be=B*z-j*N,Oe=B*G-R*N,Re=U*z-j*V,Ye=U*G-R*V,ze=j*G-R*z,Qe=X*ne-K*he,ct=X*de-te*he,ht=X*ge-ce*he,ft=K*de-te*ne,mt=K*ge-ce*ne,Et=te*ge-ce*de,vt=Me*Et-Be*mt+Oe*ft+Re*ht-Ye*ct+ze*Qe;return vt?(x[0]=(V*Et-z*mt+G*ft)*(vt=1/vt),x[1]=(z*ht-N*Et-G*ct)*vt,x[2]=(N*mt-V*ht+G*Qe)*vt,x[3]=(j*mt-U*Et-R*ft)*vt,x[4]=(B*Et-j*ht+R*ct)*vt,x[5]=(U*ht-B*mt-R*Qe)*vt,x[6]=(ne*ze-de*Ye+ge*Re)*vt,x[7]=(de*Oe-he*ze-ge*Be)*vt,x[8]=(he*Ye-ne*Oe+ge*Me)*vt,x):null},q.projection=function(x,T,B){return x[0]=2/T,x[1]=0,x[2]=0,x[3]=0,x[4]=-2/B,x[5]=0,x[6]=-1,x[7]=1,x[8]=1,x},q.str=function(x){return"mat3("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+")"},q.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8])},q.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x[4]=T[4]+B[4],x[5]=T[5]+B[5],x[6]=T[6]+B[6],x[7]=T[7]+B[7],x[8]=T[8]+B[8],x},q.subtract=A,q.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x[4]=T[4]*B,x[5]=T[5]*B,x[6]=T[6]*B,x[7]=T[7]*B,x[8]=T[8]*B,x},q.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x[4]=T[4]+B[4]*U,x[5]=T[5]+B[5]*U,x[6]=T[6]+B[6]*U,x[7]=T[7]+B[7]*U,x[8]=T[8]+B[8]*U,x},q.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]&&x[4]===T[4]&&x[5]===T[5]&&x[6]===T[6]&&x[7]===T[7]&&x[8]===T[8]},q.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=x[4],V=x[5],z=x[6],G=x[7],X=x[8],K=T[0],te=T[1],ce=T[2],he=T[3],ne=T[4],de=T[5],ge=T[6],Me=T[7],Be=T[8];return Math.abs(B-K)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(U-te)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(te))&&Math.abs(j-ce)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs(ce))&&Math.abs(R-he)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(he))&&Math.abs(N-ne)<=c.EPSILON*Math.max(1,Math.abs(N),Math.abs(ne))&&Math.abs(V-de)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(de))&&Math.abs(z-ge)<=c.EPSILON*Math.max(1,Math.abs(z),Math.abs(ge))&&Math.abs(G-Me)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(Me))&&Math.abs(X-Be)<=c.EPSILON*Math.max(1,Math.abs(X),Math.abs(Be))},q.sub=q.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=f(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function f(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(f=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],X=T[7],K=T[8],te=B[0],ce=B[1],he=B[2],ne=B[3],de=B[4],ge=B[5],Me=B[6],Be=B[7],Oe=B[8];return x[0]=te*U+ce*N+he*G,x[1]=te*j+ce*V+he*X,x[2]=te*R+ce*z+he*K,x[3]=ne*U+de*N+ge*G,x[4]=ne*j+de*V+ge*X,x[5]=ne*R+de*z+ge*K,x[6]=Me*U+Be*N+Oe*G,x[7]=Me*j+Be*V+Oe*X,x[8]=Me*R+Be*z+Oe*K,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x[4]=T[4]-B[4],x[5]=T[5]-B[5],x[6]=T[6]-B[6],x[7]=T[7]-B[7],x[8]=T[8]-B[8],x}return q.mul=_,q.sub=A,q}var ee,re={};function se(){if(ee)return re;function g(R){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},g(R)}ee=1,Object.defineProperty(re,"__esModule",{value:!0}),re.create=function(){var R=new c.ARRAY_TYPE(16);return c.ARRAY_TYPE!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0),R[0]=1,R[5]=1,R[10]=1,R[15]=1,R},re.clone=function(R){var N=new c.ARRAY_TYPE(16);return N[0]=R[0],N[1]=R[1],N[2]=R[2],N[3]=R[3],N[4]=R[4],N[5]=R[5],N[6]=R[6],N[7]=R[7],N[8]=R[8],N[9]=R[9],N[10]=R[10],N[11]=R[11],N[12]=R[12],N[13]=R[13],N[14]=R[14],N[15]=R[15],N},re.copy=function(R,N){return R[0]=N[0],R[1]=N[1],R[2]=N[2],R[3]=N[3],R[4]=N[4],R[5]=N[5],R[6]=N[6],R[7]=N[7],R[8]=N[8],R[9]=N[9],R[10]=N[10],R[11]=N[11],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15],R},re.fromValues=function(R,N,V,z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe){var Re=new c.ARRAY_TYPE(16);return Re[0]=R,Re[1]=N,Re[2]=V,Re[3]=z,Re[4]=G,Re[5]=X,Re[6]=K,Re[7]=te,Re[8]=ce,Re[9]=he,Re[10]=ne,Re[11]=de,Re[12]=ge,Re[13]=Me,Re[14]=Be,Re[15]=Oe,Re},re.set=function(R,N,V,z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe,Re){return R[0]=N,R[1]=V,R[2]=z,R[3]=G,R[4]=X,R[5]=K,R[6]=te,R[7]=ce,R[8]=he,R[9]=ne,R[10]=de,R[11]=ge,R[12]=Me,R[13]=Be,R[14]=Oe,R[15]=Re,R},re.identity=_,re.transpose=function(R,N){if(R===N){var V=N[1],z=N[2],G=N[3],X=N[6],K=N[7],te=N[11];R[1]=N[4],R[2]=N[8],R[3]=N[12],R[4]=V,R[6]=N[9],R[7]=N[13],R[8]=z,R[9]=X,R[11]=N[14],R[12]=G,R[13]=K,R[14]=te}else R[0]=N[0],R[1]=N[4],R[2]=N[8],R[3]=N[12],R[4]=N[1],R[5]=N[5],R[6]=N[9],R[7]=N[13],R[8]=N[2],R[9]=N[6],R[10]=N[10],R[11]=N[14],R[12]=N[3],R[13]=N[7],R[14]=N[11],R[15]=N[15];return R},re.invert=function(R,N){var V=N[0],z=N[1],G=N[2],X=N[3],K=N[4],te=N[5],ce=N[6],he=N[7],ne=N[8],de=N[9],ge=N[10],Me=N[11],Be=N[12],Oe=N[13],Re=N[14],Ye=N[15],ze=V*te-z*K,Qe=V*ce-G*K,ct=V*he-X*K,ht=z*ce-G*te,ft=z*he-X*te,mt=G*he-X*ce,Et=ne*Oe-de*Be,vt=ne*Re-ge*Be,Ut=ne*Ye-Me*Be,Yt=de*Re-ge*Oe,Dt=de*Ye-Me*Oe,Rn=ge*Ye-Me*Re,bn=ze*Rn-Qe*Dt+ct*Yt+ht*Ut-ft*vt+mt*Et;return bn?(R[0]=(te*Rn-ce*Dt+he*Yt)*(bn=1/bn),R[1]=(G*Dt-z*Rn-X*Yt)*bn,R[2]=(Oe*mt-Re*ft+Ye*ht)*bn,R[3]=(ge*ft-de*mt-Me*ht)*bn,R[4]=(ce*Ut-K*Rn-he*vt)*bn,R[5]=(V*Rn-G*Ut+X*vt)*bn,R[6]=(Re*ct-Be*mt-Ye*Qe)*bn,R[7]=(ne*mt-ge*ct+Me*Qe)*bn,R[8]=(K*Dt-te*Ut+he*Et)*bn,R[9]=(z*Ut-V*Dt-X*Et)*bn,R[10]=(Be*ft-Oe*ct+Ye*ze)*bn,R[11]=(de*ct-ne*ft-Me*ze)*bn,R[12]=(te*vt-K*Yt-ce*Et)*bn,R[13]=(V*Yt-z*vt+G*Et)*bn,R[14]=(Oe*Qe-Be*ht-Re*ze)*bn,R[15]=(ne*ht-de*Qe+ge*ze)*bn,R):null},re.adjoint=function(R,N){var V=N[0],z=N[1],G=N[2],X=N[3],K=N[4],te=N[5],ce=N[6],he=N[7],ne=N[8],de=N[9],ge=N[10],Me=N[11],Be=N[12],Oe=N[13],Re=N[14],Ye=N[15];return R[0]=te*(ge*Ye-Me*Re)-de*(ce*Ye-he*Re)+Oe*(ce*Me-he*ge),R[1]=-(z*(ge*Ye-Me*Re)-de*(G*Ye-X*Re)+Oe*(G*Me-X*ge)),R[2]=z*(ce*Ye-he*Re)-te*(G*Ye-X*Re)+Oe*(G*he-X*ce),R[3]=-(z*(ce*Me-he*ge)-te*(G*Me-X*ge)+de*(G*he-X*ce)),R[4]=-(K*(ge*Ye-Me*Re)-ne*(ce*Ye-he*Re)+Be*(ce*Me-he*ge)),R[5]=V*(ge*Ye-Me*Re)-ne*(G*Ye-X*Re)+Be*(G*Me-X*ge),R[6]=-(V*(ce*Ye-he*Re)-K*(G*Ye-X*Re)+Be*(G*he-X*ce)),R[7]=V*(ce*Me-he*ge)-K*(G*Me-X*ge)+ne*(G*he-X*ce),R[8]=K*(de*Ye-Me*Oe)-ne*(te*Ye-he*Oe)+Be*(te*Me-he*de),R[9]=-(V*(de*Ye-Me*Oe)-ne*(z*Ye-X*Oe)+Be*(z*Me-X*de)),R[10]=V*(te*Ye-he*Oe)-K*(z*Ye-X*Oe)+Be*(z*he-X*te),R[11]=-(V*(te*Me-he*de)-K*(z*Me-X*de)+ne*(z*he-X*te)),R[12]=-(K*(de*Re-ge*Oe)-ne*(te*Re-ce*Oe)+Be*(te*ge-ce*de)),R[13]=V*(de*Re-ge*Oe)-ne*(z*Re-G*Oe)+Be*(z*ge-G*de),R[14]=-(V*(te*Re-ce*Oe)-K*(z*Re-G*Oe)+Be*(z*ce-G*te)),R[15]=V*(te*ge-ce*de)-K*(z*ge-G*de)+ne*(z*ce-G*te),R},re.determinant=function(R){var N=R[0],V=R[1],z=R[2],G=R[3],X=R[4],K=R[5],te=R[6],ce=R[7],he=R[8],ne=R[9],de=R[10],ge=R[11],Me=R[12],Be=R[13],Oe=R[14],Re=R[15];return(N*K-V*X)*(de*Re-ge*Oe)-(N*te-z*X)*(ne*Re-ge*Be)+(N*ce-G*X)*(ne*Oe-de*Be)+(V*te-z*K)*(he*Re-ge*Me)-(V*ce-G*K)*(he*Oe-de*Me)+(z*ce-G*te)*(he*Be-ne*Me)},re.multiply=A,re.translate=function(R,N,V){var z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe=V[0],Re=V[1],Ye=V[2];return N===R?(R[12]=N[0]*Oe+N[4]*Re+N[8]*Ye+N[12],R[13]=N[1]*Oe+N[5]*Re+N[9]*Ye+N[13],R[14]=N[2]*Oe+N[6]*Re+N[10]*Ye+N[14],R[15]=N[3]*Oe+N[7]*Re+N[11]*Ye+N[15]):(G=N[1],X=N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=N[8],ge=N[9],Me=N[10],Be=N[11],R[0]=z=N[0],R[1]=G,R[2]=X,R[3]=K,R[4]=te,R[5]=ce,R[6]=he,R[7]=ne,R[8]=de,R[9]=ge,R[10]=Me,R[11]=Be,R[12]=z*Oe+te*Re+de*Ye+N[12],R[13]=G*Oe+ce*Re+ge*Ye+N[13],R[14]=X*Oe+he*Re+Me*Ye+N[14],R[15]=K*Oe+ne*Re+Be*Ye+N[15]),R},re.scale=function(R,N,V){var z=V[0],G=V[1],X=V[2];return R[0]=N[0]*z,R[1]=N[1]*z,R[2]=N[2]*z,R[3]=N[3]*z,R[4]=N[4]*G,R[5]=N[5]*G,R[6]=N[6]*G,R[7]=N[7]*G,R[8]=N[8]*X,R[9]=N[9]*X,R[10]=N[10]*X,R[11]=N[11]*X,R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15],R},re.rotate=function(R,N,V,z){var G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct,ht,ft,mt,Et,vt,Ut,Yt,Dt=z[0],Rn=z[1],bn=z[2],dn=Math.hypot(Dt,Rn,bn);return dn<c.EPSILON?null:(Dt*=dn=1/dn,Rn*=dn,bn*=dn,G=Math.sin(V),X=Math.cos(V),ce=N[1],he=N[2],ne=N[3],ge=N[5],Me=N[6],Be=N[7],Re=N[9],Ye=N[10],ze=N[11],Qe=Dt*Dt*(K=1-X)+X,ft=Dt*Rn*K-bn*G,mt=Rn*Rn*K+X,Et=bn*Rn*K+Dt*G,vt=Dt*bn*K+Rn*G,Ut=Rn*bn*K-Dt*G,Yt=bn*bn*K+X,R[0]=(te=N[0])*Qe+(de=N[4])*(ct=Rn*Dt*K+bn*G)+(Oe=N[8])*(ht=bn*Dt*K-Rn*G),R[1]=ce*Qe+ge*ct+Re*ht,R[2]=he*Qe+Me*ct+Ye*ht,R[3]=ne*Qe+Be*ct+ze*ht,R[4]=te*ft+de*mt+Oe*Et,R[5]=ce*ft+ge*mt+Re*Et,R[6]=he*ft+Me*mt+Ye*Et,R[7]=ne*ft+Be*mt+ze*Et,R[8]=te*vt+de*Ut+Oe*Yt,R[9]=ce*vt+ge*Ut+Re*Yt,R[10]=he*vt+Me*Ut+Ye*Yt,R[11]=ne*vt+Be*Ut+ze*Yt,N!==R&&(R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R)},re.rotateX=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),X=N[4],K=N[5],te=N[6],ce=N[7],he=N[8],ne=N[9],de=N[10],ge=N[11];return N!==R&&(R[0]=N[0],R[1]=N[1],R[2]=N[2],R[3]=N[3],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[4]=X*G+he*z,R[5]=K*G+ne*z,R[6]=te*G+de*z,R[7]=ce*G+ge*z,R[8]=he*G-X*z,R[9]=ne*G-K*z,R[10]=de*G-te*z,R[11]=ge*G-ce*z,R},re.rotateY=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),X=N[0],K=N[1],te=N[2],ce=N[3],he=N[8],ne=N[9],de=N[10],ge=N[11];return N!==R&&(R[4]=N[4],R[5]=N[5],R[6]=N[6],R[7]=N[7],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[0]=X*G-he*z,R[1]=K*G-ne*z,R[2]=te*G-de*z,R[3]=ce*G-ge*z,R[8]=X*z+he*G,R[9]=K*z+ne*G,R[10]=te*z+de*G,R[11]=ce*z+ge*G,R},re.rotateZ=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),X=N[0],K=N[1],te=N[2],ce=N[3],he=N[4],ne=N[5],de=N[6],ge=N[7];return N!==R&&(R[8]=N[8],R[9]=N[9],R[10]=N[10],R[11]=N[11],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[0]=X*G+he*z,R[1]=K*G+ne*z,R[2]=te*G+de*z,R[3]=ce*G+ge*z,R[4]=he*G-X*z,R[5]=ne*G-K*z,R[6]=de*G-te*z,R[7]=ge*G-ce*z,R},re.fromTranslation=function(R,N){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=N[0],R[13]=N[1],R[14]=N[2],R[15]=1,R},re.fromScaling=function(R,N){return R[0]=N[0],R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=N[1],R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=N[2],R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotation=function(R,N,V){var z,G,X,K=V[0],te=V[1],ce=V[2],he=Math.hypot(K,te,ce);return he<c.EPSILON?null:(K*=he=1/he,te*=he,ce*=he,z=Math.sin(N),G=Math.cos(N),R[0]=K*K*(X=1-G)+G,R[1]=te*K*X+ce*z,R[2]=ce*K*X-te*z,R[3]=0,R[4]=K*te*X-ce*z,R[5]=te*te*X+G,R[6]=ce*te*X+K*z,R[7]=0,R[8]=K*ce*X+te*z,R[9]=te*ce*X-K*z,R[10]=ce*ce*X+G,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R)},re.fromXRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=z,R[6]=V,R[7]=0,R[8]=0,R[9]=-V,R[10]=z,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromYRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=z,R[1]=0,R[2]=-V,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=V,R[9]=0,R[10]=z,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromZRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=z,R[1]=V,R[2]=0,R[3]=0,R[4]=-V,R[5]=z,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotationTranslation=x,re.fromQuat2=function(R,N){var V=new c.ARRAY_TYPE(3),z=-N[0],G=-N[1],X=-N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=z*z+G*G+X*X+K*K;return de>0?(V[0]=2*(te*K+ne*z+ce*X-he*G)/de,V[1]=2*(ce*K+ne*G+he*z-te*X)/de,V[2]=2*(he*K+ne*X+te*G-ce*z)/de):(V[0]=2*(te*K+ne*z+ce*X-he*G),V[1]=2*(ce*K+ne*G+he*z-te*X),V[2]=2*(he*K+ne*X+te*G-ce*z)),x(R,N,V),R},re.getTranslation=function(R,N){return R[0]=N[12],R[1]=N[13],R[2]=N[14],R},re.getScaling=T,re.getRotation=function(R,N){var V=new c.ARRAY_TYPE(3);T(V,N);var z=1/V[0],G=1/V[1],X=1/V[2],K=N[0]*z,te=N[1]*G,ce=N[2]*X,he=N[4]*z,ne=N[5]*G,de=N[6]*X,ge=N[8]*z,Me=N[9]*G,Be=N[10]*X,Oe=K+ne+Be,Re=0;return Oe>0?(Re=2*Math.sqrt(Oe+1),R[3]=.25*Re,R[0]=(de-Me)/Re,R[1]=(ge-ce)/Re,R[2]=(te-he)/Re):K>ne&&K>Be?(Re=2*Math.sqrt(1+K-ne-Be),R[3]=(de-Me)/Re,R[0]=.25*Re,R[1]=(te+he)/Re,R[2]=(ge+ce)/Re):ne>Be?(Re=2*Math.sqrt(1+ne-K-Be),R[3]=(ge-ce)/Re,R[0]=(te+he)/Re,R[1]=.25*Re,R[2]=(de+Me)/Re):(Re=2*Math.sqrt(1+Be-K-ne),R[3]=(te-he)/Re,R[0]=(ge+ce)/Re,R[1]=(de+Me)/Re,R[2]=.25*Re),R},re.fromRotationTranslationScale=function(R,N,V,z){var G=N[0],X=N[1],K=N[2],te=N[3],ce=G+G,he=X+X,ne=K+K,de=G*ce,ge=G*he,Me=G*ne,Be=X*he,Oe=X*ne,Re=K*ne,Ye=te*ce,ze=te*he,Qe=te*ne,ct=z[0],ht=z[1],ft=z[2];return R[0]=(1-(Be+Re))*ct,R[1]=(ge+Qe)*ct,R[2]=(Me-ze)*ct,R[3]=0,R[4]=(ge-Qe)*ht,R[5]=(1-(de+Re))*ht,R[6]=(Oe+Ye)*ht,R[7]=0,R[8]=(Me+ze)*ft,R[9]=(Oe-Ye)*ft,R[10]=(1-(de+Be))*ft,R[11]=0,R[12]=V[0],R[13]=V[1],R[14]=V[2],R[15]=1,R},re.fromRotationTranslationScaleOrigin=function(R,N,V,z,G){var X=N[0],K=N[1],te=N[2],ce=N[3],he=X+X,ne=K+K,de=te+te,ge=X*he,Me=X*ne,Be=X*de,Oe=K*ne,Re=K*de,Ye=te*de,ze=ce*he,Qe=ce*ne,ct=ce*de,ht=z[0],ft=z[1],mt=z[2],Et=G[0],vt=G[1],Ut=G[2],Yt=(1-(Oe+Ye))*ht,Dt=(Me+ct)*ht,Rn=(Be-Qe)*ht,bn=(Me-ct)*ft,dn=(1-(ge+Ye))*ft,tn=(Re+ze)*ft,nr=(Be+Qe)*mt,In=(Re-ze)*mt,Nn=(1-(ge+Oe))*mt;return R[0]=Yt,R[1]=Dt,R[2]=Rn,R[3]=0,R[4]=bn,R[5]=dn,R[6]=tn,R[7]=0,R[8]=nr,R[9]=In,R[10]=Nn,R[11]=0,R[12]=V[0]+Et-(Yt*Et+bn*vt+nr*Ut),R[13]=V[1]+vt-(Dt*Et+dn*vt+In*Ut),R[14]=V[2]+Ut-(Rn*Et+tn*vt+Nn*Ut),R[15]=1,R},re.fromQuat=function(R,N){var V=N[0],z=N[1],G=N[2],X=N[3],K=V+V,te=z+z,ce=G+G,he=V*K,ne=z*K,de=z*te,ge=G*K,Me=G*te,Be=G*ce,Oe=X*K,Re=X*te,Ye=X*ce;return R[0]=1-de-Be,R[1]=ne+Ye,R[2]=ge-Re,R[3]=0,R[4]=ne-Ye,R[5]=1-he-Be,R[6]=Me+Oe,R[7]=0,R[8]=ge+Re,R[9]=Me-Oe,R[10]=1-he-de,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.frustum=function(R,N,V,z,G,X,K){var te=1/(V-N),ce=1/(G-z),he=1/(X-K);return R[0]=2*X*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=2*X*ce,R[6]=0,R[7]=0,R[8]=(V+N)*te,R[9]=(G+z)*ce,R[10]=(K+X)*he,R[11]=-1,R[12]=0,R[13]=0,R[14]=K*X*2*he,R[15]=0,R},re.perspectiveNO=B,re.perspectiveZO=function(R,N,V,z,G){var X,K=1/Math.tan(N/2);return R[0]=K/V,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=K,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,G!=null&&G!==1/0?(R[10]=G*(X=1/(z-G)),R[14]=G*z*X):(R[10]=-1,R[14]=-z),R},re.perspectiveFromFieldOfView=function(R,N,V,z){var G=Math.tan(N.upDegrees*Math.PI/180),X=Math.tan(N.downDegrees*Math.PI/180),K=Math.tan(N.leftDegrees*Math.PI/180),te=Math.tan(N.rightDegrees*Math.PI/180),ce=2/(K+te),he=2/(G+X);return R[0]=ce,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=he,R[6]=0,R[7]=0,R[8]=-(K-te)*ce*.5,R[9]=(G-X)*he*.5,R[10]=z/(V-z),R[11]=-1,R[12]=0,R[13]=0,R[14]=z*V/(V-z),R[15]=0,R},re.orthoNO=U,re.orthoZO=function(R,N,V,z,G,X,K){var te=1/(N-V),ce=1/(z-G),he=1/(X-K);return R[0]=-2*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ce,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=he,R[11]=0,R[12]=(N+V)*te,R[13]=(G+z)*ce,R[14]=X*he,R[15]=1,R},re.lookAt=function(R,N,V,z){var G,X,K,te,ce,he,ne,de,ge,Me,Be=N[0],Oe=N[1],Re=N[2],Ye=z[0],ze=z[1],Qe=z[2],ct=V[0],ht=V[1],ft=V[2];return Math.abs(Be-ct)<c.EPSILON&&Math.abs(Oe-ht)<c.EPSILON&&Math.abs(Re-ft)<c.EPSILON?_(R):(ne=Be-ct,de=Oe-ht,ge=Re-ft,G=ze*(ge*=Me=1/Math.hypot(ne,de,ge))-Qe*(de*=Me),X=Qe*(ne*=Me)-Ye*ge,K=Ye*de-ze*ne,(Me=Math.hypot(G,X,K))?(G*=Me=1/Me,X*=Me,K*=Me):(G=0,X=0,K=0),te=de*K-ge*X,ce=ge*G-ne*K,he=ne*X-de*G,(Me=Math.hypot(te,ce,he))?(te*=Me=1/Me,ce*=Me,he*=Me):(te=0,ce=0,he=0),R[0]=G,R[1]=te,R[2]=ne,R[3]=0,R[4]=X,R[5]=ce,R[6]=de,R[7]=0,R[8]=K,R[9]=he,R[10]=ge,R[11]=0,R[12]=-(G*Be+X*Oe+K*Re),R[13]=-(te*Be+ce*Oe+he*Re),R[14]=-(ne*Be+de*Oe+ge*Re),R[15]=1,R)},re.targetTo=function(R,N,V,z){var G=N[0],X=N[1],K=N[2],te=z[0],ce=z[1],he=z[2],ne=G-V[0],de=X-V[1],ge=K-V[2],Me=ne*ne+de*de+ge*ge;Me>0&&(ne*=Me=1/Math.sqrt(Me),de*=Me,ge*=Me);var Be=ce*ge-he*de,Oe=he*ne-te*ge,Re=te*de-ce*ne;return(Me=Be*Be+Oe*Oe+Re*Re)>0&&(Be*=Me=1/Math.sqrt(Me),Oe*=Me,Re*=Me),R[0]=Be,R[1]=Oe,R[2]=Re,R[3]=0,R[4]=de*Re-ge*Oe,R[5]=ge*Be-ne*Re,R[6]=ne*Oe-de*Be,R[7]=0,R[8]=ne,R[9]=de,R[10]=ge,R[11]=0,R[12]=G,R[13]=X,R[14]=K,R[15]=1,R},re.str=function(R){return"mat4("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+", "+R[8]+", "+R[9]+", "+R[10]+", "+R[11]+", "+R[12]+", "+R[13]+", "+R[14]+", "+R[15]+")"},re.frob=function(R){return Math.hypot(R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8],R[9],R[10],R[11],R[12],R[13],R[14],R[15])},re.add=function(R,N,V){return R[0]=N[0]+V[0],R[1]=N[1]+V[1],R[2]=N[2]+V[2],R[3]=N[3]+V[3],R[4]=N[4]+V[4],R[5]=N[5]+V[5],R[6]=N[6]+V[6],R[7]=N[7]+V[7],R[8]=N[8]+V[8],R[9]=N[9]+V[9],R[10]=N[10]+V[10],R[11]=N[11]+V[11],R[12]=N[12]+V[12],R[13]=N[13]+V[13],R[14]=N[14]+V[14],R[15]=N[15]+V[15],R},re.subtract=j,re.multiplyScalar=function(R,N,V){return R[0]=N[0]*V,R[1]=N[1]*V,R[2]=N[2]*V,R[3]=N[3]*V,R[4]=N[4]*V,R[5]=N[5]*V,R[6]=N[6]*V,R[7]=N[7]*V,R[8]=N[8]*V,R[9]=N[9]*V,R[10]=N[10]*V,R[11]=N[11]*V,R[12]=N[12]*V,R[13]=N[13]*V,R[14]=N[14]*V,R[15]=N[15]*V,R},re.multiplyScalarAndAdd=function(R,N,V,z){return R[0]=N[0]+V[0]*z,R[1]=N[1]+V[1]*z,R[2]=N[2]+V[2]*z,R[3]=N[3]+V[3]*z,R[4]=N[4]+V[4]*z,R[5]=N[5]+V[5]*z,R[6]=N[6]+V[6]*z,R[7]=N[7]+V[7]*z,R[8]=N[8]+V[8]*z,R[9]=N[9]+V[9]*z,R[10]=N[10]+V[10]*z,R[11]=N[11]+V[11]*z,R[12]=N[12]+V[12]*z,R[13]=N[13]+V[13]*z,R[14]=N[14]+V[14]*z,R[15]=N[15]+V[15]*z,R},re.exactEquals=function(R,N){return R[0]===N[0]&&R[1]===N[1]&&R[2]===N[2]&&R[3]===N[3]&&R[4]===N[4]&&R[5]===N[5]&&R[6]===N[6]&&R[7]===N[7]&&R[8]===N[8]&&R[9]===N[9]&&R[10]===N[10]&&R[11]===N[11]&&R[12]===N[12]&&R[13]===N[13]&&R[14]===N[14]&&R[15]===N[15]},re.equals=function(R,N){var V=R[0],z=R[1],G=R[2],X=R[3],K=R[4],te=R[5],ce=R[6],he=R[7],ne=R[8],de=R[9],ge=R[10],Me=R[11],Be=R[12],Oe=R[13],Re=R[14],Ye=R[15],ze=N[0],Qe=N[1],ct=N[2],ht=N[3],ft=N[4],mt=N[5],Et=N[6],vt=N[7],Ut=N[8],Yt=N[9],Dt=N[10],Rn=N[11],bn=N[12],dn=N[13],tn=N[14],nr=N[15];return Math.abs(V-ze)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(ze))&&Math.abs(z-Qe)<=c.EPSILON*Math.max(1,Math.abs(z),Math.abs(Qe))&&Math.abs(G-ct)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(ct))&&Math.abs(X-ht)<=c.EPSILON*Math.max(1,Math.abs(X),Math.abs(ht))&&Math.abs(K-ft)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ft))&&Math.abs(te-mt)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(mt))&&Math.abs(ce-Et)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Et))&&Math.abs(he-vt)<=c.EPSILON*Math.max(1,Math.abs(he),Math.abs(vt))&&Math.abs(ne-Ut)<=c.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ut))&&Math.abs(de-Yt)<=c.EPSILON*Math.max(1,Math.abs(de),Math.abs(Yt))&&Math.abs(ge-Dt)<=c.EPSILON*Math.max(1,Math.abs(ge),Math.abs(Dt))&&Math.abs(Me-Rn)<=c.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Rn))&&Math.abs(Be-bn)<=c.EPSILON*Math.max(1,Math.abs(Be),Math.abs(bn))&&Math.abs(Oe-dn)<=c.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(dn))&&Math.abs(Re-tn)<=c.EPSILON*Math.max(1,Math.abs(Re),Math.abs(tn))&&Math.abs(Ye-nr)<=c.EPSILON*Math.max(1,Math.abs(Ye),Math.abs(nr))},re.sub=re.mul=re.ortho=re.perspective=void 0;var c=function(R,N){if(R&&R.__esModule)return R;if(R===null||g(R)!=="object"&&typeof R!="function")return{default:R};var V=f(void 0);if(V&&V.has(R))return V.get(R);var z={},G=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in R)if(X!=="default"&&Object.prototype.hasOwnProperty.call(R,X)){var K=G?Object.getOwnPropertyDescriptor(R,X):null;K&&(K.get||K.set)?Object.defineProperty(z,X,K):z[X]=R[X]}return z.default=R,V&&V.set(R,z),z}(y());function f(R){if(typeof WeakMap!="function")return null;var N=new WeakMap,V=new WeakMap;return(f=function(z){return z?V:N})(R)}function _(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R}function A(R,N,V){var z=N[0],G=N[1],X=N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=N[8],ge=N[9],Me=N[10],Be=N[11],Oe=N[12],Re=N[13],Ye=N[14],ze=N[15],Qe=V[0],ct=V[1],ht=V[2],ft=V[3];return R[0]=Qe*z+ct*te+ht*de+ft*Oe,R[1]=Qe*G+ct*ce+ht*ge+ft*Re,R[2]=Qe*X+ct*he+ht*Me+ft*Ye,R[3]=Qe*K+ct*ne+ht*Be+ft*ze,R[4]=(Qe=V[4])*z+(ct=V[5])*te+(ht=V[6])*de+(ft=V[7])*Oe,R[5]=Qe*G+ct*ce+ht*ge+ft*Re,R[6]=Qe*X+ct*he+ht*Me+ft*Ye,R[7]=Qe*K+ct*ne+ht*Be+ft*ze,R[8]=(Qe=V[8])*z+(ct=V[9])*te+(ht=V[10])*de+(ft=V[11])*Oe,R[9]=Qe*G+ct*ce+ht*ge+ft*Re,R[10]=Qe*X+ct*he+ht*Me+ft*Ye,R[11]=Qe*K+ct*ne+ht*Be+ft*ze,R[12]=(Qe=V[12])*z+(ct=V[13])*te+(ht=V[14])*de+(ft=V[15])*Oe,R[13]=Qe*G+ct*ce+ht*ge+ft*Re,R[14]=Qe*X+ct*he+ht*Me+ft*Ye,R[15]=Qe*K+ct*ne+ht*Be+ft*ze,R}function x(R,N,V){var z=N[0],G=N[1],X=N[2],K=N[3],te=z+z,ce=G+G,he=X+X,ne=z*te,de=z*ce,ge=z*he,Me=G*ce,Be=G*he,Oe=X*he,Re=K*te,Ye=K*ce,ze=K*he;return R[0]=1-(Me+Oe),R[1]=de+ze,R[2]=ge-Ye,R[3]=0,R[4]=de-ze,R[5]=1-(ne+Oe),R[6]=Be+Re,R[7]=0,R[8]=ge+Ye,R[9]=Be-Re,R[10]=1-(ne+Me),R[11]=0,R[12]=V[0],R[13]=V[1],R[14]=V[2],R[15]=1,R}function T(R,N){var V=N[4],z=N[5],G=N[6],X=N[8],K=N[9],te=N[10];return R[0]=Math.hypot(N[0],N[1],N[2]),R[1]=Math.hypot(V,z,G),R[2]=Math.hypot(X,K,te),R}function B(R,N,V,z,G){var X,K=1/Math.tan(N/2);return R[0]=K/V,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=K,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,G!=null&&G!==1/0?(R[10]=(G+z)*(X=1/(z-G)),R[14]=2*G*z*X):(R[10]=-1,R[14]=-2*z),R}function U(R,N,V,z,G,X,K){var te=1/(N-V),ce=1/(z-G),he=1/(X-K);return R[0]=-2*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ce,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=2*he,R[11]=0,R[12]=(N+V)*te,R[13]=(G+z)*ce,R[14]=(K+X)*he,R[15]=1,R}function j(R,N,V){return R[0]=N[0]-V[0],R[1]=N[1]-V[1],R[2]=N[2]-V[2],R[3]=N[3]-V[3],R[4]=N[4]-V[4],R[5]=N[5]-V[5],R[6]=N[6]-V[6],R[7]=N[7]-V[7],R[8]=N[8]-V[8],R[9]=N[9]-V[9],R[10]=N[10]-V[10],R[11]=N[11]-V[11],R[12]=N[12]-V[12],R[13]=N[13]-V[13],R[14]=N[14]-V[14],R[15]=N[15]-V[15],R}return re.perspective=B,re.ortho=U,re.mul=A,re.sub=j,re}var ae,fe={},Se={};function Ce(){if(ae)return Se;function g(G){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},g(G)}ae=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=_,Se.clone=function(G){var X=new c.ARRAY_TYPE(3);return X[0]=G[0],X[1]=G[1],X[2]=G[2],X},Se.length=A,Se.fromValues=function(G,X,K){var te=new c.ARRAY_TYPE(3);return te[0]=G,te[1]=X,te[2]=K,te},Se.copy=function(G,X){return G[0]=X[0],G[1]=X[1],G[2]=X[2],G},Se.set=function(G,X,K,te){return G[0]=X,G[1]=K,G[2]=te,G},Se.add=function(G,X,K){return G[0]=X[0]+K[0],G[1]=X[1]+K[1],G[2]=X[2]+K[2],G},Se.subtract=x,Se.multiply=T,Se.divide=B,Se.ceil=function(G,X){return G[0]=Math.ceil(X[0]),G[1]=Math.ceil(X[1]),G[2]=Math.ceil(X[2]),G},Se.floor=function(G,X){return G[0]=Math.floor(X[0]),G[1]=Math.floor(X[1]),G[2]=Math.floor(X[2]),G},Se.min=function(G,X,K){return G[0]=Math.min(X[0],K[0]),G[1]=Math.min(X[1],K[1]),G[2]=Math.min(X[2],K[2]),G},Se.max=function(G,X,K){return G[0]=Math.max(X[0],K[0]),G[1]=Math.max(X[1],K[1]),G[2]=Math.max(X[2],K[2]),G},Se.round=function(G,X){return G[0]=Math.round(X[0]),G[1]=Math.round(X[1]),G[2]=Math.round(X[2]),G},Se.scale=function(G,X,K){return G[0]=X[0]*K,G[1]=X[1]*K,G[2]=X[2]*K,G},Se.scaleAndAdd=function(G,X,K,te){return G[0]=X[0]+K[0]*te,G[1]=X[1]+K[1]*te,G[2]=X[2]+K[2]*te,G},Se.distance=U,Se.squaredDistance=j,Se.squaredLength=R,Se.negate=function(G,X){return G[0]=-X[0],G[1]=-X[1],G[2]=-X[2],G},Se.inverse=function(G,X){return G[0]=1/X[0],G[1]=1/X[1],G[2]=1/X[2],G},Se.normalize=function(G,X){var K=X[0],te=X[1],ce=X[2],he=K*K+te*te+ce*ce;return he>0&&(he=1/Math.sqrt(he)),G[0]=X[0]*he,G[1]=X[1]*he,G[2]=X[2]*he,G},Se.dot=N,Se.cross=function(G,X,K){var te=X[0],ce=X[1],he=X[2],ne=K[0],de=K[1],ge=K[2];return G[0]=ce*ge-he*de,G[1]=he*ne-te*ge,G[2]=te*de-ce*ne,G},Se.lerp=function(G,X,K,te){var ce=X[0],he=X[1],ne=X[2];return G[0]=ce+te*(K[0]-ce),G[1]=he+te*(K[1]-he),G[2]=ne+te*(K[2]-ne),G},Se.hermite=function(G,X,K,te,ce,he){var ne=he*he,de=ne*(2*he-3)+1,ge=ne*(he-2)+he,Me=ne*(he-1),Be=ne*(3-2*he);return G[0]=X[0]*de+K[0]*ge+te[0]*Me+ce[0]*Be,G[1]=X[1]*de+K[1]*ge+te[1]*Me+ce[1]*Be,G[2]=X[2]*de+K[2]*ge+te[2]*Me+ce[2]*Be,G},Se.bezier=function(G,X,K,te,ce,he){var ne=1-he,de=ne*ne,ge=he*he,Me=de*ne,Be=3*he*de,Oe=3*ge*ne,Re=ge*he;return G[0]=X[0]*Me+K[0]*Be+te[0]*Oe+ce[0]*Re,G[1]=X[1]*Me+K[1]*Be+te[1]*Oe+ce[1]*Re,G[2]=X[2]*Me+K[2]*Be+te[2]*Oe+ce[2]*Re,G},Se.random=function(G,X){X=X||1;var K=2*c.RANDOM()*Math.PI,te=2*c.RANDOM()-1,ce=Math.sqrt(1-te*te)*X;return G[0]=Math.cos(K)*ce,G[1]=Math.sin(K)*ce,G[2]=te*X,G},Se.transformMat4=function(G,X,K){var te=X[0],ce=X[1],he=X[2],ne=K[3]*te+K[7]*ce+K[11]*he+K[15];return G[0]=(K[0]*te+K[4]*ce+K[8]*he+K[12])/(ne=ne||1),G[1]=(K[1]*te+K[5]*ce+K[9]*he+K[13])/ne,G[2]=(K[2]*te+K[6]*ce+K[10]*he+K[14])/ne,G},Se.transformMat3=function(G,X,K){var te=X[0],ce=X[1],he=X[2];return G[0]=te*K[0]+ce*K[3]+he*K[6],G[1]=te*K[1]+ce*K[4]+he*K[7],G[2]=te*K[2]+ce*K[5]+he*K[8],G},Se.transformQuat=function(G,X,K){var te=K[0],ce=K[1],he=K[2],ne=X[0],de=X[1],ge=X[2],Me=ce*ge-he*de,Be=he*ne-te*ge,Oe=te*de-ce*ne,Re=ce*Oe-he*Be,Ye=he*Me-te*Oe,ze=te*Be-ce*Me,Qe=2*K[3];return Be*=Qe,Oe*=Qe,Ye*=2,ze*=2,G[0]=ne+(Me*=Qe)+(Re*=2),G[1]=de+Be+Ye,G[2]=ge+Oe+ze,G},Se.rotateX=function(G,X,K,te){var ce=[],he=[];return ce[0]=X[0]-K[0],ce[1]=X[1]-K[1],ce[2]=X[2]-K[2],he[0]=ce[0],he[1]=ce[1]*Math.cos(te)-ce[2]*Math.sin(te),he[2]=ce[1]*Math.sin(te)+ce[2]*Math.cos(te),G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.rotateY=function(G,X,K,te){var ce=[],he=[];return ce[0]=X[0]-K[0],ce[1]=X[1]-K[1],ce[2]=X[2]-K[2],he[0]=ce[2]*Math.sin(te)+ce[0]*Math.cos(te),he[1]=ce[1],he[2]=ce[2]*Math.cos(te)-ce[0]*Math.sin(te),G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.rotateZ=function(G,X,K,te){var ce=[],he=[];return ce[0]=X[0]-K[0],ce[1]=X[1]-K[1],ce[2]=X[2]-K[2],he[0]=ce[0]*Math.cos(te)-ce[1]*Math.sin(te),he[1]=ce[0]*Math.sin(te)+ce[1]*Math.cos(te),he[2]=ce[2],G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.angle=function(G,X){var K=G[0],te=G[1],ce=G[2],he=X[0],ne=X[1],de=X[2],ge=Math.sqrt(K*K+te*te+ce*ce)*Math.sqrt(he*he+ne*ne+de*de),Me=ge&&N(G,X)/ge;return Math.acos(Math.min(Math.max(Me,-1),1))},Se.zero=function(G){return G[0]=0,G[1]=0,G[2]=0,G},Se.str=function(G){return"vec3("+G[0]+", "+G[1]+", "+G[2]+")"},Se.exactEquals=function(G,X){return G[0]===X[0]&&G[1]===X[1]&&G[2]===X[2]},Se.equals=function(G,X){var K=G[0],te=G[1],ce=G[2],he=X[0],ne=X[1],de=X[2];return Math.abs(K-he)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(he))&&Math.abs(te-ne)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(ne))&&Math.abs(ce-de)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(de))},Se.forEach=Se.sqrLen=Se.len=Se.sqrDist=Se.dist=Se.div=Se.mul=Se.sub=void 0;var c=function(G,X){if(G&&G.__esModule)return G;if(G===null||g(G)!=="object"&&typeof G!="function")return{default:G};var K=f(void 0);if(K&&K.has(G))return K.get(G);var te={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var he in G)if(he!=="default"&&Object.prototype.hasOwnProperty.call(G,he)){var ne=ce?Object.getOwnPropertyDescriptor(G,he):null;ne&&(ne.get||ne.set)?Object.defineProperty(te,he,ne):te[he]=G[he]}return te.default=G,K&&K.set(G,te),te}(y());function f(G){if(typeof WeakMap!="function")return null;var X=new WeakMap,K=new WeakMap;return(f=function(te){return te?K:X})(G)}function _(){var G=new c.ARRAY_TYPE(3);return c.ARRAY_TYPE!=Float32Array&&(G[0]=0,G[1]=0,G[2]=0),G}function A(G){return Math.hypot(G[0],G[1],G[2])}function x(G,X,K){return G[0]=X[0]-K[0],G[1]=X[1]-K[1],G[2]=X[2]-K[2],G}function T(G,X,K){return G[0]=X[0]*K[0],G[1]=X[1]*K[1],G[2]=X[2]*K[2],G}function B(G,X,K){return G[0]=X[0]/K[0],G[1]=X[1]/K[1],G[2]=X[2]/K[2],G}function U(G,X){return Math.hypot(X[0]-G[0],X[1]-G[1],X[2]-G[2])}function j(G,X){var K=X[0]-G[0],te=X[1]-G[1],ce=X[2]-G[2];return K*K+te*te+ce*ce}function R(G){var X=G[0],K=G[1],te=G[2];return X*X+K*K+te*te}function N(G,X){return G[0]*X[0]+G[1]*X[1]+G[2]*X[2]}Se.sub=x,Se.mul=T,Se.div=B,Se.dist=U,Se.sqrDist=j,Se.len=A,Se.sqrLen=R;var V,z=(V=_(),function(G,X,K,te,ce,he){var ne,de;for(X||(X=3),K||(K=0),de=te?Math.min(te*X+K,G.length):G.length,ne=K;ne<de;ne+=X)V[0]=G[ne],V[1]=G[ne+1],V[2]=G[ne+2],ce(V,V,he),G[ne]=V[0],G[ne+1]=V[1],G[ne+2]=V[2];return G});return Se.forEach=z,Se}var Ie,je,Le={};function ot(){if(Ie)return Le;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}Ie=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.create=_,Le.clone=function(z){var G=new c.ARRAY_TYPE(4);return G[0]=z[0],G[1]=z[1],G[2]=z[2],G[3]=z[3],G},Le.fromValues=function(z,G,X,K){var te=new c.ARRAY_TYPE(4);return te[0]=z,te[1]=G,te[2]=X,te[3]=K,te},Le.copy=function(z,G){return z[0]=G[0],z[1]=G[1],z[2]=G[2],z[3]=G[3],z},Le.set=function(z,G,X,K,te){return z[0]=G,z[1]=X,z[2]=K,z[3]=te,z},Le.add=function(z,G,X){return z[0]=G[0]+X[0],z[1]=G[1]+X[1],z[2]=G[2]+X[2],z[3]=G[3]+X[3],z},Le.subtract=A,Le.multiply=x,Le.divide=T,Le.ceil=function(z,G){return z[0]=Math.ceil(G[0]),z[1]=Math.ceil(G[1]),z[2]=Math.ceil(G[2]),z[3]=Math.ceil(G[3]),z},Le.floor=function(z,G){return z[0]=Math.floor(G[0]),z[1]=Math.floor(G[1]),z[2]=Math.floor(G[2]),z[3]=Math.floor(G[3]),z},Le.min=function(z,G,X){return z[0]=Math.min(G[0],X[0]),z[1]=Math.min(G[1],X[1]),z[2]=Math.min(G[2],X[2]),z[3]=Math.min(G[3],X[3]),z},Le.max=function(z,G,X){return z[0]=Math.max(G[0],X[0]),z[1]=Math.max(G[1],X[1]),z[2]=Math.max(G[2],X[2]),z[3]=Math.max(G[3],X[3]),z},Le.round=function(z,G){return z[0]=Math.round(G[0]),z[1]=Math.round(G[1]),z[2]=Math.round(G[2]),z[3]=Math.round(G[3]),z},Le.scale=function(z,G,X){return z[0]=G[0]*X,z[1]=G[1]*X,z[2]=G[2]*X,z[3]=G[3]*X,z},Le.scaleAndAdd=function(z,G,X,K){return z[0]=G[0]+X[0]*K,z[1]=G[1]+X[1]*K,z[2]=G[2]+X[2]*K,z[3]=G[3]+X[3]*K,z},Le.distance=B,Le.squaredDistance=U,Le.length=j,Le.squaredLength=R,Le.negate=function(z,G){return z[0]=-G[0],z[1]=-G[1],z[2]=-G[2],z[3]=-G[3],z},Le.inverse=function(z,G){return z[0]=1/G[0],z[1]=1/G[1],z[2]=1/G[2],z[3]=1/G[3],z},Le.normalize=function(z,G){var X=G[0],K=G[1],te=G[2],ce=G[3],he=X*X+K*K+te*te+ce*ce;return he>0&&(he=1/Math.sqrt(he)),z[0]=X*he,z[1]=K*he,z[2]=te*he,z[3]=ce*he,z},Le.dot=function(z,G){return z[0]*G[0]+z[1]*G[1]+z[2]*G[2]+z[3]*G[3]},Le.cross=function(z,G,X,K){var te=X[0]*K[1]-X[1]*K[0],ce=X[0]*K[2]-X[2]*K[0],he=X[0]*K[3]-X[3]*K[0],ne=X[1]*K[2]-X[2]*K[1],de=X[1]*K[3]-X[3]*K[1],ge=X[2]*K[3]-X[3]*K[2],Me=G[0],Be=G[1],Oe=G[2],Re=G[3];return z[0]=Be*ge-Oe*de+Re*ne,z[1]=-Me*ge+Oe*he-Re*ce,z[2]=Me*de-Be*he+Re*te,z[3]=-Me*ne+Be*ce-Oe*te,z},Le.lerp=function(z,G,X,K){var te=G[0],ce=G[1],he=G[2],ne=G[3];return z[0]=te+K*(X[0]-te),z[1]=ce+K*(X[1]-ce),z[2]=he+K*(X[2]-he),z[3]=ne+K*(X[3]-ne),z},Le.random=function(z,G){var X,K,te,ce,he,ne;G=G||1;do he=(X=2*c.RANDOM()-1)*X+(K=2*c.RANDOM()-1)*K;while(he>=1);do ne=(te=2*c.RANDOM()-1)*te+(ce=2*c.RANDOM()-1)*ce;while(ne>=1);var de=Math.sqrt((1-he)/ne);return z[0]=G*X,z[1]=G*K,z[2]=G*te*de,z[3]=G*ce*de,z},Le.transformMat4=function(z,G,X){var K=G[0],te=G[1],ce=G[2],he=G[3];return z[0]=X[0]*K+X[4]*te+X[8]*ce+X[12]*he,z[1]=X[1]*K+X[5]*te+X[9]*ce+X[13]*he,z[2]=X[2]*K+X[6]*te+X[10]*ce+X[14]*he,z[3]=X[3]*K+X[7]*te+X[11]*ce+X[15]*he,z},Le.transformQuat=function(z,G,X){var K=G[0],te=G[1],ce=G[2],he=X[0],ne=X[1],de=X[2],ge=X[3],Me=ge*K+ne*ce-de*te,Be=ge*te+de*K-he*ce,Oe=ge*ce+he*te-ne*K,Re=-he*K-ne*te-de*ce;return z[0]=Me*ge+Re*-he+Be*-de-Oe*-ne,z[1]=Be*ge+Re*-ne+Oe*-he-Me*-de,z[2]=Oe*ge+Re*-de+Me*-ne-Be*-he,z[3]=G[3],z},Le.zero=function(z){return z[0]=0,z[1]=0,z[2]=0,z[3]=0,z},Le.str=function(z){return"vec4("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+")"},Le.exactEquals=function(z,G){return z[0]===G[0]&&z[1]===G[1]&&z[2]===G[2]&&z[3]===G[3]},Le.equals=function(z,G){var X=z[0],K=z[1],te=z[2],ce=z[3],he=G[0],ne=G[1],de=G[2],ge=G[3];return Math.abs(X-he)<=c.EPSILON*Math.max(1,Math.abs(X),Math.abs(he))&&Math.abs(K-ne)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ne))&&Math.abs(te-de)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(de))&&Math.abs(ce-ge)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(ge))},Le.forEach=Le.sqrLen=Le.len=Le.sqrDist=Le.dist=Le.div=Le.mul=Le.sub=void 0;var c=function(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var X=f(void 0);if(X&&X.has(z))return X.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,X&&X.set(z,K),K}(y());function f(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,X=new WeakMap;return(f=function(K){return K?X:G})(z)}function _(){var z=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0,z[2]=0,z[3]=0),z}function A(z,G,X){return z[0]=G[0]-X[0],z[1]=G[1]-X[1],z[2]=G[2]-X[2],z[3]=G[3]-X[3],z}function x(z,G,X){return z[0]=G[0]*X[0],z[1]=G[1]*X[1],z[2]=G[2]*X[2],z[3]=G[3]*X[3],z}function T(z,G,X){return z[0]=G[0]/X[0],z[1]=G[1]/X[1],z[2]=G[2]/X[2],z[3]=G[3]/X[3],z}function B(z,G){return Math.hypot(G[0]-z[0],G[1]-z[1],G[2]-z[2],G[3]-z[3])}function U(z,G){var X=G[0]-z[0],K=G[1]-z[1],te=G[2]-z[2],ce=G[3]-z[3];return X*X+K*K+te*te+ce*ce}function j(z){return Math.hypot(z[0],z[1],z[2],z[3])}function R(z){var G=z[0],X=z[1],K=z[2],te=z[3];return G*G+X*X+K*K+te*te}Le.sub=A,Le.mul=x,Le.div=T,Le.dist=B,Le.sqrDist=U,Le.len=j,Le.sqrLen=R;var N,V=(N=_(),function(z,G,X,K,te,ce){var he,ne;for(G||(G=4),X||(X=0),ne=K?Math.min(K*G+X,z.length):z.length,he=X;he<ne;he+=G)N[0]=z[he],N[1]=z[he+1],N[2]=z[he+2],N[3]=z[he+3],te(N,N,ce),z[he]=N[0],z[he+1]=N[1],z[he+2]=N[2],z[he+3]=N[3];return z});return Le.forEach=V,Le}function ye(){if(je)return fe;function g(ze){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Qe){return typeof Qe}:function(Qe){return Qe&&typeof Symbol=="function"&&Qe.constructor===Symbol&&Qe!==Symbol.prototype?"symbol":typeof Qe},g(ze)}je=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.create=B,fe.identity=function(ze){return ze[0]=0,ze[1]=0,ze[2]=0,ze[3]=1,ze},fe.setAxisAngle=U,fe.getAxisAngle=function(ze,Qe){var ct=2*Math.acos(Qe[3]),ht=Math.sin(ct/2);return ht>c.EPSILON?(ze[0]=Qe[0]/ht,ze[1]=Qe[1]/ht,ze[2]=Qe[2]/ht):(ze[0]=1,ze[1]=0,ze[2]=0),ct},fe.getAngle=function(ze,Qe){var ct=X(ze,Qe);return Math.acos(2*ct*ct-1)},fe.multiply=j,fe.rotateX=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Et=Qe[3],vt=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut+Et*vt,ze[1]=ft*Ut+mt*vt,ze[2]=mt*Ut-ft*vt,ze[3]=Et*Ut-ht*vt,ze},fe.rotateY=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Et=Qe[3],vt=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut-mt*vt,ze[1]=ft*Ut+Et*vt,ze[2]=mt*Ut+ht*vt,ze[3]=Et*Ut-ft*vt,ze},fe.rotateZ=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Et=Qe[3],vt=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut+ft*vt,ze[1]=ft*Ut-ht*vt,ze[2]=mt*Ut+Et*vt,ze[3]=Et*Ut-mt*vt,ze},fe.calculateW=function(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2];return ze[0]=ct,ze[1]=ht,ze[2]=ft,ze[3]=Math.sqrt(Math.abs(1-ct*ct-ht*ht-ft*ft)),ze},fe.exp=R,fe.ln=N,fe.pow=function(ze,Qe,ct){return N(ze,Qe),G(ze,ze,ct),R(ze,ze),ze},fe.slerp=V,fe.random=function(ze){var Qe=c.RANDOM(),ct=c.RANDOM(),ht=c.RANDOM(),ft=Math.sqrt(1-Qe),mt=Math.sqrt(Qe);return ze[0]=ft*Math.sin(2*Math.PI*ct),ze[1]=ft*Math.cos(2*Math.PI*ct),ze[2]=mt*Math.sin(2*Math.PI*ht),ze[3]=mt*Math.cos(2*Math.PI*ht),ze},fe.invert=function(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Et=ct*ct+ht*ht+ft*ft+mt*mt,vt=Et?1/Et:0;return ze[0]=-ct*vt,ze[1]=-ht*vt,ze[2]=-ft*vt,ze[3]=mt*vt,ze},fe.conjugate=function(ze,Qe){return ze[0]=-Qe[0],ze[1]=-Qe[1],ze[2]=-Qe[2],ze[3]=Qe[3],ze},fe.fromMat3=z,fe.fromEuler=function(ze,Qe,ct,ht){var ft=.5*Math.PI/180;Qe*=ft,ct*=ft,ht*=ft;var mt=Math.sin(Qe),Et=Math.cos(Qe),vt=Math.sin(ct),Ut=Math.cos(ct),Yt=Math.sin(ht),Dt=Math.cos(ht);return ze[0]=mt*Ut*Dt-Et*vt*Yt,ze[1]=Et*vt*Dt+mt*Ut*Yt,ze[2]=Et*Ut*Yt-mt*vt*Dt,ze[3]=Et*Ut*Dt+mt*vt*Yt,ze},fe.str=function(ze){return"quat("+ze[0]+", "+ze[1]+", "+ze[2]+", "+ze[3]+")"},fe.setAxes=fe.sqlerp=fe.rotationTo=fe.equals=fe.exactEquals=fe.normalize=fe.sqrLen=fe.squaredLength=fe.len=fe.length=fe.lerp=fe.dot=fe.scale=fe.mul=fe.add=fe.set=fe.copy=fe.fromValues=fe.clone=void 0;var c=T(y()),f=T(Z()),_=T(Ce()),A=T(ot());function x(ze){if(typeof WeakMap!="function")return null;var Qe=new WeakMap,ct=new WeakMap;return(x=function(ht){return ht?ct:Qe})(ze)}function T(ze,Qe){if(ze&&ze.__esModule)return ze;if(ze===null||g(ze)!=="object"&&typeof ze!="function")return{default:ze};var ct=x(Qe);if(ct&&ct.has(ze))return ct.get(ze);var ht={},ft=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var mt in ze)if(mt!=="default"&&Object.prototype.hasOwnProperty.call(ze,mt)){var Et=ft?Object.getOwnPropertyDescriptor(ze,mt):null;Et&&(Et.get||Et.set)?Object.defineProperty(ht,mt,Et):ht[mt]=ze[mt]}return ht.default=ze,ct&&ct.set(ze,ht),ht}function B(){var ze=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(ze[0]=0,ze[1]=0,ze[2]=0),ze[3]=1,ze}function U(ze,Qe,ct){ct*=.5;var ht=Math.sin(ct);return ze[0]=ht*Qe[0],ze[1]=ht*Qe[1],ze[2]=ht*Qe[2],ze[3]=Math.cos(ct),ze}function j(ze,Qe,ct){var ht=Qe[0],ft=Qe[1],mt=Qe[2],Et=Qe[3],vt=ct[0],Ut=ct[1],Yt=ct[2],Dt=ct[3];return ze[0]=ht*Dt+Et*vt+ft*Yt-mt*Ut,ze[1]=ft*Dt+Et*Ut+mt*vt-ht*Yt,ze[2]=mt*Dt+Et*Yt+ht*Ut-ft*vt,ze[3]=Et*Dt-ht*vt-ft*Ut-mt*Yt,ze}function R(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Et=Math.sqrt(ct*ct+ht*ht+ft*ft),vt=Math.exp(mt),Ut=Et>0?vt*Math.sin(Et)/Et:0;return ze[0]=ct*Ut,ze[1]=ht*Ut,ze[2]=ft*Ut,ze[3]=vt*Math.cos(Et),ze}function N(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Et=Math.sqrt(ct*ct+ht*ht+ft*ft),vt=Et>0?Math.atan2(Et,mt)/Et:0;return ze[0]=ct*vt,ze[1]=ht*vt,ze[2]=ft*vt,ze[3]=.5*Math.log(ct*ct+ht*ht+ft*ft+mt*mt),ze}function V(ze,Qe,ct,ht){var ft,mt,Et,vt,Ut,Yt=Qe[0],Dt=Qe[1],Rn=Qe[2],bn=Qe[3],dn=ct[0],tn=ct[1],nr=ct[2],In=ct[3];return(mt=Yt*dn+Dt*tn+Rn*nr+bn*In)<0&&(mt=-mt,dn=-dn,tn=-tn,nr=-nr,In=-In),1-mt>c.EPSILON?(ft=Math.acos(mt),Et=Math.sin(ft),vt=Math.sin((1-ht)*ft)/Et,Ut=Math.sin(ht*ft)/Et):(vt=1-ht,Ut=ht),ze[0]=vt*Yt+Ut*dn,ze[1]=vt*Dt+Ut*tn,ze[2]=vt*Rn+Ut*nr,ze[3]=vt*bn+Ut*In,ze}function z(ze,Qe){var ct,ht=Qe[0]+Qe[4]+Qe[8];if(ht>0)ct=Math.sqrt(ht+1),ze[3]=.5*ct,ze[0]=(Qe[5]-Qe[7])*(ct=.5/ct),ze[1]=(Qe[6]-Qe[2])*ct,ze[2]=(Qe[1]-Qe[3])*ct;else{var ft=0;Qe[4]>Qe[0]&&(ft=1),Qe[8]>Qe[3*ft+ft]&&(ft=2);var mt=(ft+1)%3,Et=(ft+2)%3;ct=Math.sqrt(Qe[3*ft+ft]-Qe[3*mt+mt]-Qe[3*Et+Et]+1),ze[ft]=.5*ct,ze[3]=(Qe[3*mt+Et]-Qe[3*Et+mt])*(ct=.5/ct),ze[mt]=(Qe[3*mt+ft]+Qe[3*ft+mt])*ct,ze[Et]=(Qe[3*Et+ft]+Qe[3*ft+Et])*ct}return ze}fe.clone=A.clone,fe.fromValues=A.fromValues,fe.copy=A.copy,fe.set=A.set,fe.add=A.add,fe.mul=j;var G=A.scale;fe.scale=G;var X=A.dot;fe.dot=X,fe.lerp=A.lerp;var K=A.length;fe.length=K,fe.len=K;var te=A.squaredLength;fe.squaredLength=te,fe.sqrLen=te;var ce=A.normalize;fe.normalize=ce,fe.exactEquals=A.exactEquals,fe.equals=A.equals;var he,ne,de,ge=(he=_.create(),ne=_.fromValues(1,0,0),de=_.fromValues(0,1,0),function(ze,Qe,ct){var ht=_.dot(Qe,ct);return ht<-.999999?(_.cross(he,ne,Qe),_.len(he)<1e-6&&_.cross(he,de,Qe),_.normalize(he,he),U(ze,he,Math.PI),ze):ht>.999999?(ze[0]=0,ze[1]=0,ze[2]=0,ze[3]=1,ze):(_.cross(he,Qe,ct),ze[0]=he[0],ze[1]=he[1],ze[2]=he[2],ze[3]=1+ht,ce(ze,ze))});fe.rotationTo=ge;var Me,Be,Oe=(Me=B(),Be=B(),function(ze,Qe,ct,ht,ft,mt){return V(Me,Qe,ft,mt),V(Be,ct,ht,mt),V(ze,Me,Be,2*mt*(1-mt)),ze});fe.sqlerp=Oe;var Re,Ye=(Re=f.create(),function(ze,Qe,ct,ht){return Re[0]=ct[0],Re[3]=ct[1],Re[6]=ct[2],Re[1]=ht[0],Re[4]=ht[1],Re[7]=ht[2],Re[2]=-Qe[0],Re[5]=-Qe[1],Re[8]=-Qe[2],ce(ze,z(ze,Re))});return fe.setAxes=Ye,fe}var $e,Ve={};function _t(){if($e)return Ve;function g(V){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},g(V)}$e=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.create=function(){var V=new c.ARRAY_TYPE(8);return c.ARRAY_TYPE!=Float32Array&&(V[0]=0,V[1]=0,V[2]=0,V[4]=0,V[5]=0,V[6]=0,V[7]=0),V[3]=1,V},Ve.clone=function(V){var z=new c.ARRAY_TYPE(8);return z[0]=V[0],z[1]=V[1],z[2]=V[2],z[3]=V[3],z[4]=V[4],z[5]=V[5],z[6]=V[6],z[7]=V[7],z},Ve.fromValues=function(V,z,G,X,K,te,ce,he){var ne=new c.ARRAY_TYPE(8);return ne[0]=V,ne[1]=z,ne[2]=G,ne[3]=X,ne[4]=K,ne[5]=te,ne[6]=ce,ne[7]=he,ne},Ve.fromRotationTranslationValues=function(V,z,G,X,K,te,ce){var he=new c.ARRAY_TYPE(8);he[0]=V,he[1]=z,he[2]=G,he[3]=X;var ne=.5*K,de=.5*te,ge=.5*ce;return he[4]=ne*X+de*G-ge*z,he[5]=de*X+ge*V-ne*G,he[6]=ge*X+ne*z-de*V,he[7]=-ne*V-de*z-ge*G,he},Ve.fromRotationTranslation=T,Ve.fromTranslation=function(V,z){return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V[4]=.5*z[0],V[5]=.5*z[1],V[6]=.5*z[2],V[7]=0,V},Ve.fromRotation=function(V,z){return V[0]=z[0],V[1]=z[1],V[2]=z[2],V[3]=z[3],V[4]=0,V[5]=0,V[6]=0,V[7]=0,V},Ve.fromMat4=function(V,z){var G=f.create();_.getRotation(G,z);var X=new c.ARRAY_TYPE(3);return _.getTranslation(X,z),T(V,G,X),V},Ve.copy=B,Ve.identity=function(V){return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V[4]=0,V[5]=0,V[6]=0,V[7]=0,V},Ve.set=function(V,z,G,X,K,te,ce,he,ne){return V[0]=z,V[1]=G,V[2]=X,V[3]=K,V[4]=te,V[5]=ce,V[6]=he,V[7]=ne,V},Ve.getDual=function(V,z){return V[0]=z[4],V[1]=z[5],V[2]=z[6],V[3]=z[7],V},Ve.setDual=function(V,z){return V[4]=z[0],V[5]=z[1],V[6]=z[2],V[7]=z[3],V},Ve.getTranslation=function(V,z){var G=z[4],X=z[5],K=z[6],te=z[7],ce=-z[0],he=-z[1],ne=-z[2],de=z[3];return V[0]=2*(G*de+te*ce+X*ne-K*he),V[1]=2*(X*de+te*he+K*ce-G*ne),V[2]=2*(K*de+te*ne+G*he-X*ce),V},Ve.translate=function(V,z,G){var X=z[0],K=z[1],te=z[2],ce=z[3],he=.5*G[0],ne=.5*G[1],de=.5*G[2],ge=z[4],Me=z[5],Be=z[6],Oe=z[7];return V[0]=X,V[1]=K,V[2]=te,V[3]=ce,V[4]=ce*he+K*de-te*ne+ge,V[5]=ce*ne+te*he-X*de+Me,V[6]=ce*de+X*ne-K*he+Be,V[7]=-X*he-K*ne-te*de+Oe,V},Ve.rotateX=function(V,z,G){var X=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*X+ne*te-de*K,Be=ne*ce+ge*K+de*X-he*te,Oe=de*ce+ge*te+he*K-ne*X,Re=ge*ce-he*X-ne*K-de*te;return f.rotateX(V,z,G),V[4]=Me*(ce=V[3])+Re*(X=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Re*K+Oe*X-Me*te,V[6]=Oe*ce+Re*te+Me*K-Be*X,V[7]=Re*ce-Me*X-Be*K-Oe*te,V},Ve.rotateY=function(V,z,G){var X=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*X+ne*te-de*K,Be=ne*ce+ge*K+de*X-he*te,Oe=de*ce+ge*te+he*K-ne*X,Re=ge*ce-he*X-ne*K-de*te;return f.rotateY(V,z,G),V[4]=Me*(ce=V[3])+Re*(X=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Re*K+Oe*X-Me*te,V[6]=Oe*ce+Re*te+Me*K-Be*X,V[7]=Re*ce-Me*X-Be*K-Oe*te,V},Ve.rotateZ=function(V,z,G){var X=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*X+ne*te-de*K,Be=ne*ce+ge*K+de*X-he*te,Oe=de*ce+ge*te+he*K-ne*X,Re=ge*ce-he*X-ne*K-de*te;return f.rotateZ(V,z,G),V[4]=Me*(ce=V[3])+Re*(X=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Re*K+Oe*X-Me*te,V[6]=Oe*ce+Re*te+Me*K-Be*X,V[7]=Re*ce-Me*X-Be*K-Oe*te,V},Ve.rotateByQuatAppend=function(V,z,G){var X=G[0],K=G[1],te=G[2],ce=G[3],he=z[0],ne=z[1],de=z[2],ge=z[3];return V[0]=he*ce+ge*X+ne*te-de*K,V[1]=ne*ce+ge*K+de*X-he*te,V[2]=de*ce+ge*te+he*K-ne*X,V[3]=ge*ce-he*X-ne*K-de*te,V[4]=(he=z[4])*ce+(ge=z[7])*X+(ne=z[5])*te-(de=z[6])*K,V[5]=ne*ce+ge*K+de*X-he*te,V[6]=de*ce+ge*te+he*K-ne*X,V[7]=ge*ce-he*X-ne*K-de*te,V},Ve.rotateByQuatPrepend=function(V,z,G){var X=z[0],K=z[1],te=z[2],ce=z[3],he=G[0],ne=G[1],de=G[2],ge=G[3];return V[0]=X*ge+ce*he+K*de-te*ne,V[1]=K*ge+ce*ne+te*he-X*de,V[2]=te*ge+ce*de+X*ne-K*he,V[3]=ce*ge-X*he-K*ne-te*de,V[4]=X*(ge=G[7])+ce*(he=G[4])+K*(de=G[6])-te*(ne=G[5]),V[5]=K*ge+ce*ne+te*he-X*de,V[6]=te*ge+ce*de+X*ne-K*he,V[7]=ce*ge-X*he-K*ne-te*de,V},Ve.rotateAroundAxis=function(V,z,G,X){if(Math.abs(X)<c.EPSILON)return B(V,z);var K=Math.hypot(G[0],G[1],G[2]);X*=.5;var te=Math.sin(X),ce=te*G[0]/K,he=te*G[1]/K,ne=te*G[2]/K,de=Math.cos(X),ge=z[0],Me=z[1],Be=z[2],Oe=z[3];V[0]=ge*de+Oe*ce+Me*ne-Be*he,V[1]=Me*de+Oe*he+Be*ce-ge*ne,V[2]=Be*de+Oe*ne+ge*he-Me*ce,V[3]=Oe*de-ge*ce-Me*he-Be*ne;var Re=z[4],Ye=z[5],ze=z[6],Qe=z[7];return V[4]=Re*de+Qe*ce+Ye*ne-ze*he,V[5]=Ye*de+Qe*he+ze*ce-Re*ne,V[6]=ze*de+Qe*ne+Re*he-Ye*ce,V[7]=Qe*de-Re*ce-Ye*he-ze*ne,V},Ve.add=function(V,z,G){return V[0]=z[0]+G[0],V[1]=z[1]+G[1],V[2]=z[2]+G[2],V[3]=z[3]+G[3],V[4]=z[4]+G[4],V[5]=z[5]+G[5],V[6]=z[6]+G[6],V[7]=z[7]+G[7],V},Ve.multiply=U,Ve.scale=function(V,z,G){return V[0]=z[0]*G,V[1]=z[1]*G,V[2]=z[2]*G,V[3]=z[3]*G,V[4]=z[4]*G,V[5]=z[5]*G,V[6]=z[6]*G,V[7]=z[7]*G,V},Ve.lerp=function(V,z,G,X){var K=1-X;return j(z,G)<0&&(X=-X),V[0]=z[0]*K+G[0]*X,V[1]=z[1]*K+G[1]*X,V[2]=z[2]*K+G[2]*X,V[3]=z[3]*K+G[3]*X,V[4]=z[4]*K+G[4]*X,V[5]=z[5]*K+G[5]*X,V[6]=z[6]*K+G[6]*X,V[7]=z[7]*K+G[7]*X,V},Ve.invert=function(V,z){var G=N(z);return V[0]=-z[0]/G,V[1]=-z[1]/G,V[2]=-z[2]/G,V[3]=z[3]/G,V[4]=-z[4]/G,V[5]=-z[5]/G,V[6]=-z[6]/G,V[7]=z[7]/G,V},Ve.conjugate=function(V,z){return V[0]=-z[0],V[1]=-z[1],V[2]=-z[2],V[3]=z[3],V[4]=-z[4],V[5]=-z[5],V[6]=-z[6],V[7]=z[7],V},Ve.normalize=function(V,z){var G=N(z);if(G>0){G=Math.sqrt(G);var X=z[0]/G,K=z[1]/G,te=z[2]/G,ce=z[3]/G,he=z[4],ne=z[5],de=z[6],ge=z[7],Me=X*he+K*ne+te*de+ce*ge;V[0]=X,V[1]=K,V[2]=te,V[3]=ce,V[4]=(he-X*Me)/G,V[5]=(ne-K*Me)/G,V[6]=(de-te*Me)/G,V[7]=(ge-ce*Me)/G}return V},Ve.str=function(V){return"quat2("+V[0]+", "+V[1]+", "+V[2]+", "+V[3]+", "+V[4]+", "+V[5]+", "+V[6]+", "+V[7]+")"},Ve.exactEquals=function(V,z){return V[0]===z[0]&&V[1]===z[1]&&V[2]===z[2]&&V[3]===z[3]&&V[4]===z[4]&&V[5]===z[5]&&V[6]===z[6]&&V[7]===z[7]},Ve.equals=function(V,z){var G=V[0],X=V[1],K=V[2],te=V[3],ce=V[4],he=V[5],ne=V[6],de=V[7],ge=z[0],Me=z[1],Be=z[2],Oe=z[3],Re=z[4],Ye=z[5],ze=z[6],Qe=z[7];return Math.abs(G-ge)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(ge))&&Math.abs(X-Me)<=c.EPSILON*Math.max(1,Math.abs(X),Math.abs(Me))&&Math.abs(K-Be)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(Be))&&Math.abs(te-Oe)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(Oe))&&Math.abs(ce-Re)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Re))&&Math.abs(he-Ye)<=c.EPSILON*Math.max(1,Math.abs(he),Math.abs(Ye))&&Math.abs(ne-ze)<=c.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ze))&&Math.abs(de-Qe)<=c.EPSILON*Math.max(1,Math.abs(de),Math.abs(Qe))},Ve.sqrLen=Ve.squaredLength=Ve.len=Ve.length=Ve.dot=Ve.mul=Ve.setReal=Ve.getReal=void 0;var c=x(y()),f=x(ye()),_=x(se());function A(V){if(typeof WeakMap!="function")return null;var z=new WeakMap,G=new WeakMap;return(A=function(X){return X?G:z})(V)}function x(V,z){if(V&&V.__esModule)return V;if(V===null||g(V)!=="object"&&typeof V!="function")return{default:V};var G=A(z);if(G&&G.has(V))return G.get(V);var X={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in V)if(te!=="default"&&Object.prototype.hasOwnProperty.call(V,te)){var ce=K?Object.getOwnPropertyDescriptor(V,te):null;ce&&(ce.get||ce.set)?Object.defineProperty(X,te,ce):X[te]=V[te]}return X.default=V,G&&G.set(V,X),X}function T(V,z,G){var X=.5*G[0],K=.5*G[1],te=.5*G[2],ce=z[0],he=z[1],ne=z[2],de=z[3];return V[0]=ce,V[1]=he,V[2]=ne,V[3]=de,V[4]=X*de+K*ne-te*he,V[5]=K*de+te*ce-X*ne,V[6]=te*de+X*he-K*ce,V[7]=-X*ce-K*he-te*ne,V}function B(V,z){return V[0]=z[0],V[1]=z[1],V[2]=z[2],V[3]=z[3],V[4]=z[4],V[5]=z[5],V[6]=z[6],V[7]=z[7],V}function U(V,z,G){var X=z[0],K=z[1],te=z[2],ce=z[3],he=G[4],ne=G[5],de=G[6],ge=G[7],Me=z[4],Be=z[5],Oe=z[6],Re=z[7],Ye=G[0],ze=G[1],Qe=G[2],ct=G[3];return V[0]=X*ct+ce*Ye+K*Qe-te*ze,V[1]=K*ct+ce*ze+te*Ye-X*Qe,V[2]=te*ct+ce*Qe+X*ze-K*Ye,V[3]=ce*ct-X*Ye-K*ze-te*Qe,V[4]=X*ge+ce*he+K*de-te*ne+Me*ct+Re*Ye+Be*Qe-Oe*ze,V[5]=K*ge+ce*ne+te*he-X*de+Be*ct+Re*ze+Oe*Ye-Me*Qe,V[6]=te*ge+ce*de+X*ne-K*he+Oe*ct+Re*Qe+Me*ze-Be*Ye,V[7]=ce*ge-X*he-K*ne-te*de+Re*ct-Me*Ye-Be*ze-Oe*Qe,V}Ve.getReal=f.copy,Ve.setReal=f.copy,Ve.mul=U;var j=f.dot;Ve.dot=j;var R=f.length;Ve.length=R,Ve.len=R;var N=f.squaredLength;return Ve.squaredLength=N,Ve.sqrLen=N,Ve}var wt,Vt,lt={};function Ht(){if(wt)return lt;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}wt=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=_,lt.clone=function(z){var G=new c.ARRAY_TYPE(2);return G[0]=z[0],G[1]=z[1],G},lt.fromValues=function(z,G){var X=new c.ARRAY_TYPE(2);return X[0]=z,X[1]=G,X},lt.copy=function(z,G){return z[0]=G[0],z[1]=G[1],z},lt.set=function(z,G,X){return z[0]=G,z[1]=X,z},lt.add=function(z,G,X){return z[0]=G[0]+X[0],z[1]=G[1]+X[1],z},lt.subtract=A,lt.multiply=x,lt.divide=T,lt.ceil=function(z,G){return z[0]=Math.ceil(G[0]),z[1]=Math.ceil(G[1]),z},lt.floor=function(z,G){return z[0]=Math.floor(G[0]),z[1]=Math.floor(G[1]),z},lt.min=function(z,G,X){return z[0]=Math.min(G[0],X[0]),z[1]=Math.min(G[1],X[1]),z},lt.max=function(z,G,X){return z[0]=Math.max(G[0],X[0]),z[1]=Math.max(G[1],X[1]),z},lt.round=function(z,G){return z[0]=Math.round(G[0]),z[1]=Math.round(G[1]),z},lt.scale=function(z,G,X){return z[0]=G[0]*X,z[1]=G[1]*X,z},lt.scaleAndAdd=function(z,G,X,K){return z[0]=G[0]+X[0]*K,z[1]=G[1]+X[1]*K,z},lt.distance=B,lt.squaredDistance=U,lt.length=j,lt.squaredLength=R,lt.negate=function(z,G){return z[0]=-G[0],z[1]=-G[1],z},lt.inverse=function(z,G){return z[0]=1/G[0],z[1]=1/G[1],z},lt.normalize=function(z,G){var X=G[0],K=G[1],te=X*X+K*K;return te>0&&(te=1/Math.sqrt(te)),z[0]=G[0]*te,z[1]=G[1]*te,z},lt.dot=function(z,G){return z[0]*G[0]+z[1]*G[1]},lt.cross=function(z,G,X){var K=G[0]*X[1]-G[1]*X[0];return z[0]=z[1]=0,z[2]=K,z},lt.lerp=function(z,G,X,K){var te=G[0],ce=G[1];return z[0]=te+K*(X[0]-te),z[1]=ce+K*(X[1]-ce),z},lt.random=function(z,G){G=G||1;var X=2*c.RANDOM()*Math.PI;return z[0]=Math.cos(X)*G,z[1]=Math.sin(X)*G,z},lt.transformMat2=function(z,G,X){var K=G[0],te=G[1];return z[0]=X[0]*K+X[2]*te,z[1]=X[1]*K+X[3]*te,z},lt.transformMat2d=function(z,G,X){var K=G[0],te=G[1];return z[0]=X[0]*K+X[2]*te+X[4],z[1]=X[1]*K+X[3]*te+X[5],z},lt.transformMat3=function(z,G,X){var K=G[0],te=G[1];return z[0]=X[0]*K+X[3]*te+X[6],z[1]=X[1]*K+X[4]*te+X[7],z},lt.transformMat4=function(z,G,X){var K=G[0],te=G[1];return z[0]=X[0]*K+X[4]*te+X[12],z[1]=X[1]*K+X[5]*te+X[13],z},lt.rotate=function(z,G,X,K){var te=G[0]-X[0],ce=G[1]-X[1],he=Math.sin(K),ne=Math.cos(K);return z[0]=te*ne-ce*he+X[0],z[1]=te*he+ce*ne+X[1],z},lt.angle=function(z,G){var X=z[0],K=z[1],te=G[0],ce=G[1],he=Math.sqrt(X*X+K*K)*Math.sqrt(te*te+ce*ce);return Math.acos(Math.min(Math.max(he&&(X*te+K*ce)/he,-1),1))},lt.zero=function(z){return z[0]=0,z[1]=0,z},lt.str=function(z){return"vec2("+z[0]+", "+z[1]+")"},lt.exactEquals=function(z,G){return z[0]===G[0]&&z[1]===G[1]},lt.equals=function(z,G){var X=z[0],K=z[1],te=G[0],ce=G[1];return Math.abs(X-te)<=c.EPSILON*Math.max(1,Math.abs(X),Math.abs(te))&&Math.abs(K-ce)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ce))},lt.forEach=lt.sqrLen=lt.sqrDist=lt.dist=lt.div=lt.mul=lt.sub=lt.len=void 0;var c=function(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var X=f(void 0);if(X&&X.has(z))return X.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,X&&X.set(z,K),K}(y());function f(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,X=new WeakMap;return(f=function(K){return K?X:G})(z)}function _(){var z=new c.ARRAY_TYPE(2);return c.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0),z}function A(z,G,X){return z[0]=G[0]-X[0],z[1]=G[1]-X[1],z}function x(z,G,X){return z[0]=G[0]*X[0],z[1]=G[1]*X[1],z}function T(z,G,X){return z[0]=G[0]/X[0],z[1]=G[1]/X[1],z}function B(z,G){return Math.hypot(G[0]-z[0],G[1]-z[1])}function U(z,G){var X=G[0]-z[0],K=G[1]-z[1];return X*X+K*K}function j(z){return Math.hypot(z[0],z[1])}function R(z){var G=z[0],X=z[1];return G*G+X*X}lt.len=j,lt.sub=A,lt.mul=x,lt.div=T,lt.dist=B,lt.sqrDist=U,lt.sqrLen=R;var N,V=(N=_(),function(z,G,X,K,te,ce){var he,ne;for(G||(G=2),X||(X=0),ne=K?Math.min(K*G+X,z.length):z.length,he=X;he<ne;he+=G)N[0]=z[he],N[1]=z[he+1],te(N,N,ce),z[he]=N[0],z[he+1]=N[1];return z});return lt.forEach=V,lt}function Qt(){if(Vt)return m;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}Vt=1,Object.defineProperty(m,"__esModule",{value:!0}),m.vec4=m.vec3=m.vec2=m.quat2=m.quat=m.mat4=m.mat3=m.mat2d=m.mat2=m.glMatrix=void 0;var c=V(y());m.glMatrix=c;var f=V(M());m.mat2=f;var _=V(k());m.mat2d=_;var A=V(Z());m.mat3=A;var x=V(se());m.mat4=x;var T=V(ye());m.quat=T;var B=V(_t());m.quat2=B;var U=V(Ht());m.vec2=U;var j=V(Ce());m.vec3=j;var R=V(ot());function N(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,X=new WeakMap;return(N=function(K){return K?X:G})(z)}function V(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var X=N(G);if(X&&X.has(z))return X.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,X&&X.set(z,K),K}return m.vec4=R,m}var rn,jn,Bn,Tn,Pe=Qt(),qe=function(){if(jn)return rn;function g(c,f,_,A){this.cx=3*c,this.bx=3*(_-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*f,this.by=3*(A-f)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=f,this.p2x=_,this.p2y=A}return jn=1,rn=g,g.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,f){if(f===void 0&&(f=1e-6),c<0)return 0;if(c>1)return 1;for(var _=c,A=0;A<8;A++){var x=this.sampleCurveX(_)-c;if(Math.abs(x)<f)return _;var T=this.sampleCurveDerivativeX(_);if(Math.abs(T)<1e-6)break;_-=x/T}var B=0,U=1;for(_=c,A=0;A<20&&(x=this.sampleCurveX(_),!(Math.abs(x-c)<f));A++)c>x?B=_:U=_,_=.5*(U-B)+B;return _},solve:function(c,f){return this.sampleCurveY(this.solveCurveX(c,f))}},rn}(),mn=h(qe);function cn(){if(Tn)return Bn;function g(c,f){this.x=c,this.y=f}return Tn=1,Bn=g,g.prototype={clone:function(){return new g(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,f){return this.clone()._rotateAround(c,f)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var f=c.x-this.x,_=c.y-this.y;return f*f+_*_},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,f){return Math.atan2(this.x*f-this.y*c,this.x*c+this.y*f)},_matMult:function(c){var f=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=f,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var f=Math.cos(c),_=Math.sin(c),A=_*this.x+f*this.y;return this.x=f*this.x-_*this.y,this.y=A,this},_rotateAround:function(c,f){var _=Math.cos(c),A=Math.sin(c),x=f.y+A*(this.x-f.x)+_*(this.y-f.y);return this.x=f.x+_*(this.x-f.x)-A*(this.y-f.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},g.convert=function(c){return c instanceof g?c:Array.isArray(c)?new g(c[0],c[1]):c},Bn}var St=h(cn());function Jt(g,c){if(Array.isArray(g)){if(!Array.isArray(c)||g.length!==c.length)return!1;for(let f=0;f<g.length;f++)if(!Jt(g[f],c[f]))return!1;return!0}if(typeof g=="object"&&g!==null&&c!==null){if(typeof c!="object"||Object.keys(g).length!==Object.keys(c).length)return!1;for(const f in g)if(!Jt(g[f],c[f]))return!1;return!0}return g===c}const kn=Math.PI/180,Gn=180/Math.PI;function sn(g){return g*kn}function at(g){return g*Gn}const Ue=[[0,0],[1,0],[1,1],[0,1]];function $t(g){if(g<=0)return 0;if(g>=1)return 1;const c=g*g,f=c*g;return 4*(g<.5?f:3*(g-c)+f-.75)}function An(g,c,f,_){const A=new mn(g,c,f,_);return function(x){return A.solve(x)}}const Sn=An(.25,.1,.25,1);function jt(g,c,f){return Math.min(f,Math.max(c,g))}function mr(g,c,f){return(f=jt((f-g)/(c-g),0,1))*f*(3-2*f)}function Un(g,c,f){const _=f-c,A=((g-c)%_+_)%_+c;return A===c?f:A}function tr(g,c,f){if(!g.length)return f(null,[]);let _=g.length;const A=new Array(g.length);let x=null;g.forEach((T,B)=>{c(T,(U,j)=>{U&&(x=U),A[B]=j,--_==0&&f(x,A)})})}function Sr(g,...c){for(const f of c)for(const _ in f)g[_]=f[_];return g}let Ln=1;function ir(){return Ln++}function ui(g){return g<=1?1:Math.pow(2,Math.ceil(Math.log(g)/Math.LN2))}function Fr(g,c){g.forEach(f=>{c[f]&&(c[f]=c[f].bind(c))})}function or(g,c){return g.indexOf(c,g.length-c.length)!==-1}function Nr(g,c,f){const _={};for(const A in g)_[A]=c.call(this,g[A],A,g);return _}function Hr(g,c,f){const _={};for(const A in g)c.call(this,g[A],A,g)&&(_[A]=g[A]);return _}function yi(g){return Array.isArray(g)?g.map(yi):typeof g=="object"&&g?Nr(g,yi):g}const Fe={};function Lt(g){Fe[g]||(typeof console<"u"&&console.warn(g),Fe[g]=!0)}function Kt(g,c,f){return(f.y-g.y)*(c.x-g.x)>(c.y-g.y)*(f.x-g.x)}function un(g){let c=0;for(let f,_,A=0,x=g.length,T=x-1;A<x;T=A++)f=g[A],_=g[T],c+=(_.x-f.x)*(f.y+_.y);return c}function En([g,c,f]){const _=sn(c+90),A=sn(f);return{x:g*Math.cos(_)*Math.sin(A),y:g*Math.sin(_)*Math.sin(A),z:g*Math.cos(A),azimuthal:c,polar:f}}function Ar(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Vr(g){const c={};if(g.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(f,_,A,x)=>{const T=A||x;return c[_]=!T||T.toLowerCase(),""}),c["max-age"]){const f=parseInt(c["max-age"],10);isNaN(f)?delete c["max-age"]:c["max-age"]=f}return c}let hs,Ps=null;function hi(g,c){return[g[4*c],g[4*c+1],g[4*c+2],g[4*c+3]]}function Tt(g,c,f,_){for(;c<f;){const A=c+f>>1;g[A]<_?c=A+1:f=A}return c}function xe(g,c,f,_){for(;c<f;){const A=c+f>>1;g[A]<=_?c=A+1:f=A}return c}function Ee(g){return g>0?1/(1.001-g):1+g}function Xe(g){return g>0?1-1/(1.001-g):-g}const nt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(hs==null){const g=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{hs=t.API_URL_REGEX!=null?new RegExp(t.API_URL_REGEX):g}catch{hs=g}}return hs},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!nt.API_URL)return null;try{const g=new URL(nt.API_URL);return g.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":g.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Je(g){return nt.API_URL_REGEX.test(g)}function pt(g){return nt.API_SPRITE_REGEX.test(g)}let Rt,gt,Pt,zt,Bt,ln;function Mn(){return Rt==null&&(Rt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Rt}const Cn={now:()=>zt!==void 0?zt:performance.now(),setNow(g){zt=g},restoreNow(){zt=void 0},frame(g){const c=requestAnimationFrame(g);return{cancel:()=>cancelAnimationFrame(c)}},getImageData(g,c=0){const{width:f,height:_}=g;Bt||(Bt=document.createElement("canvas"));const A=Bt.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return(f>Bt.width||_>Bt.height)&&(Bt.width=f,Bt.height=_),A.clearRect(-c,-c,f+2*c,_+2*c),A.drawImage(g,0,0,f,_),A.getImageData(-c,-c,f+2*c,_+2*c)},resolveURL:g=>(gt||(gt=document.createElement("a")),gt.href=g,gt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Pt==null&&(Pt=window.matchMedia("(prefers-reduced-motion: reduce)")),Pt.matches)},hasCanvasFingerprintNoise(){if(ln!==void 0)return ln;if(!Mn())return ln=!1,!1;const g=new OffscreenCanvas(85,1),c=g.getContext("2d",{willReadFrequently:!0});let f=0;for(let A=0;A<g.width;++A)c.fillStyle=`rgba(${f++},${f++},${f++}, 255)`,c.fillRect(A,0,1,1);const _=c.getImageData(0,0,g.width,g.height);f=0;for(let A=0;A<_.data.length;++A)if(A%4!=3&&f++!==_.data[A])return ln=!0,!0;return ln=!1,!1}};function Ge(g,c){const f=g.indexOf("?");if(f<0)return`${g}?${new URLSearchParams(c).toString()}`;const _=new URLSearchParams(g.slice(f));for(const A in c)_.set(A,c[A]);return`${g.slice(0,f)}?${_.toString()}`}function yt(g,c={persistentParams:[]}){const f=g.indexOf("?");if(f<0)return g;const _=new URLSearchParams,A=new URLSearchParams(g.slice(f));for(const T of c.persistentParams){const B=A.get(T);B&&_.set(T,B)}const x=_.toString();return`${g.slice(0,f)}${x.length>0?`?${x}`:""}`}const Mt="mapbox-tiles";let Ct=500,It=50;const wn=["language","worldview","jobid"];let _n,zn;function Xn(){try{return caches}catch{}}function lr(){const g=Xn();g&&_n==null&&(_n=g.open(Mt))}let gr=1/0;const dr={supported:!1,testSupport:function(g){!Hi&&ki&&(Ss?Qn(g):fi=g)}};let fi,ki,Hi=!1,Ss=!1;const Er=typeof self<"u"?self:{};function Qn(g){const c=g.createTexture();g.bindTexture(g.TEXTURE_2D,c);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,ki),g.isContextLost())return;dr.supported=!0}catch{}g.deleteTexture(c),Hi=!0}Er.document&&(ki=Er.document.createElement("img"),ki.onload=function(){fi&&Qn(fi),fi=null,Ss=!0},ki.onerror=function(){Hi=!0,fi=null},ki.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Zi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Zi);class qr extends Error{constructor(c,f,_){f===401&&Je(_)&&(c+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(c),this.status=f,this.url=_}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const _s=Ar()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Xo=function(g,c){if(!(/^file:/.test(f=g.url)||/^file:/.test(_s())&&!/^\w+:/.test(f))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(_,A){const x=new AbortController,T=new Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:_s(),referrerPolicy:_.referrerPolicy,signal:x.signal});let B=!1,U=!1;const j=(R=T.url).indexOf("sku=")>0&&Je(R);var R;_.type==="json"&&T.headers.set("Accept","application/json");const N=(z,G,X)=>{if(U)return;if(z&&z.message!=="SecurityError"&&Lt(z.toString()),G&&X)return V(G);const K=Date.now();fetch(T).then(te=>{if(te.ok){const ce=j?te.clone():null;return V(te,ce,K)}return A(new qr(te.statusText,te.status,_.url))}).catch(te=>{te.name!=="AbortError"&&A(new Error(`${te.message} ${_.url}`))})},V=(z,G,X)=>{(_.type==="arrayBuffer"?z.arrayBuffer():_.type==="json"?z.json():z.text()).then(K=>{U||(G&&X&&function(te,ce,he){if(lr(),_n==null)return;const ne=Vr(ce.headers.get("Cache-Control")||"");if(ne["no-store"])return;const de={status:ce.status,statusText:ce.statusText,headers:new Headers};ce.headers.forEach((Be,Oe)=>de.headers.set(Oe,Be)),ne["max-age"]&&de.headers.set("Expires",new Date(he+1e3*ne["max-age"]).toUTCString());const ge=de.headers.get("Expires");if(!ge||new Date(ge).getTime()-he<42e4)return;let Me=yt(te.url,{persistentParams:wn});if(ce.status===206){const Be=te.headers.get("Range");if(!Be)return;de.status=200,Me=Ge(Me,{range:Be})}(function(Be,Oe){if(zn===void 0)try{new Response(new ReadableStream),zn=!0}catch{zn=!1}zn?Oe(Be.body):Be.blob().then(Oe)})(ce,Be=>{const Oe=new Response((Re=ce.status)!==200&&Re!==404&&[101,103,204,205,304].includes(Re)?null:Be,de);var Re;lr(),_n!=null&&_n.then(Ye=>Ye.put(Me,Oe)).catch(Ye=>Lt(Ye.message))})}(T,G,X),B=!0,A(null,K,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(K=>{U||A(new Error(K.message))})};return j?function(z,G){if(lr(),_n==null)return G(null);_n.then(X=>{let K=yt(z.url,{persistentParams:wn});const te=z.headers.get("Range");te&&(K=Ge(K,{range:te})),X.match(K).then(ce=>{const he=function(ne){if(!ne)return!1;const de=new Date(ne.headers.get("Expires")||0),ge=Vr(ne.headers.get("Cache-Control")||"");return de>Date.now()&&!ge["no-cache"]}(ce);X.delete(K),he&&X.put(K,ce.clone()),G(null,ce,he)}).catch(G)}).catch(G)}(T,N):N(null,null),{cancel:()=>{U=!0,B||x.abort()}}}(g,c);if(Ar()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",g,c,void 0,!0)}var f;return function(_,A){const x=new XMLHttpRequest;x.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const T in _.headers)x.setRequestHeader(T,_.headers[T]);return _.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=_.credentials==="include",x.onerror=()=>{A(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let T=x.response;if(_.type==="json")try{T=JSON.parse(x.response)}catch(B){return A(B)}A(null,T,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else A(new qr(x.statusText,x.status,_.url))},x.send(_.body),{cancel:()=>x.abort()}}(g,c)},Ls=function(g,c){return Xo(Sr(g,{type:"arrayBuffer"}),c)};function fs(g){const c=document.createElement("a");return c.href=g,c.protocol===location.protocol&&c.host===location.host}const Pi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let oo,Po;oo=[],Po=0;const As=function(g,c){if(dr.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*"),Po>=nt.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:g,callback:c,cancelled:!1,cancel(){this.cancelled=!0}};return oo.push(x),x}Po++;let f=!1;const _=()=>{if(!f)for(f=!0,Po--;oo.length&&Po<nt.MAX_PARALLEL_IMAGE_REQUESTS;){const x=oo.shift(),{requestParameters:T,callback:B,cancelled:U}=x;U||(x.cancel=As(T,B).cancel)}},A=Ls(g,(x,T,B,U)=>{_(),x?c(x):T&&(self.createImageBitmap?function(j,R){const N=new Blob([new Uint8Array(j)],{type:"image/png"});createImageBitmap(N).then(V=>{R(null,V)}).catch(V=>{R(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,(j,R)=>c(j,R,B,U)):function(j,R){const N=new Image;N.onload=()=>{R(null,N),URL.revokeObjectURL(N.src),N.onload=null,requestAnimationFrame(()=>{N.src=Pi})},N.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new Blob([new Uint8Array(j)],{type:"image/png"});N.src=j.byteLength?URL.createObjectURL(V):Pi}(T,(j,R)=>c(j,R,B,U)))});return{cancel:()=>{A.cancel(),_()}}};var Bc,Ra,ld,kc={exports:{}},og={exports:{}},Ap={exports:{}},ag=function(){if(ld)return kc.exports;ld=1;var g=(Bc||(Bc=1,og.exports=function(f,_){var A,x,T,B,U,j,R,N;for(x=f.length-(A=3&f.length),T=_,U=3432918353,j=461845907,N=0;N<x;)R=255&f.charCodeAt(N)|(255&f.charCodeAt(++N))<<8|(255&f.charCodeAt(++N))<<16|(255&f.charCodeAt(++N))<<24,++N,T=27492+(65535&(B=5*(65535&(T=(T^=R=(65535&(R=(R=(65535&R)*U+(((R>>>16)*U&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(R=0,A){case 3:R^=(255&f.charCodeAt(N+2))<<16;case 2:R^=(255&f.charCodeAt(N+1))<<8;case 1:T^=R=(65535&(R=(R=(65535&(R^=255&f.charCodeAt(N)))*U+(((R>>>16)*U&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295}return T^=f.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0}),og.exports),c=(Ra||(Ra=1,Ap.exports=function(f,_){for(var A,x=f.length,T=_^x,B=0;x>=4;)A=1540483477*(65535&(A=255&f.charCodeAt(B)|(255&f.charCodeAt(++B))<<8|(255&f.charCodeAt(++B))<<16|(255&f.charCodeAt(++B))<<24))+((1540483477*(A>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),x-=4,++B;switch(x){case 3:T^=(255&f.charCodeAt(B+2))<<16;case 2:T^=(255&f.charCodeAt(B+1))<<8;case 1:T=1540483477*(65535&(T^=255&f.charCodeAt(B)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0}),Ap.exports);return kc.exports=g,kc.exports.murmur3=g,kc.exports.murmur2=c,kc.exports}(),$o=h(ag);class Kl{constructor(c,...f){Sr(this,f[0]||{}),this.type=c}}class Tp extends Kl{constructor(c,f={}){super("error",Sr({error:c},f))}}function cd(g,c,f){f[g]&&f[g].indexOf(c)!==-1||(f[g]=f[g]||[],f[g].push(c))}function Mp(g,c,f){if(f&&f[g]){const _=f[g].indexOf(c);_!==-1&&f[g].splice(_,1)}}class Vu{on(c,f){return this._listeners=this._listeners||{},cd(c,f,this._listeners),this}off(c,f){return Mp(c,f,this._listeners),Mp(c,f,this._oneTimeListeners),this}once(c,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},cd(c,f,this._oneTimeListeners),this):new Promise(_=>this.once(c,_))}fire(c,f){const _=typeof c=="string"?new Kl(c,f):c,A=_.type;if(this.listens(A)){_.target=this;const x=this._listeners&&this._listeners[A]?this._listeners[A].slice():[];for(const U of x)U.call(this,_);const T=this._oneTimeListeners&&this._oneTimeListeners[A]?this._oneTimeListeners[A].slice():[];for(const U of T)Mp(A,U,this._oneTimeListeners),U.call(this,_);const B=this._eventedParent;B&&(Sr(_,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(_))}else _ instanceof Tp&&console.error(_.error);return this}listens(c){return!!(this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c))}setEventedParent(c,f){return this._eventedParent=c,this._eventedParentData=f,this}}var Gh,si={},Cp=function(){if(Gh)return si;Gh=1;var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(x){return(x=Math.round(x))<0?0:x>255?255:x}function f(x){return c(x[x.length-1]==="%"?parseFloat(x)/100*255:parseInt(x))}function _(x){return(T=x[x.length-1]==="%"?parseFloat(x)/100:parseFloat(x))<0?0:T>1?1:T;var T}function A(x,T,B){return B<0?B+=1:B>1&&(B-=1),6*B<1?x+(T-x)*B*6:2*B<1?T:3*B<2?x+(T-x)*(2/3-B)*6:x}try{si.parseCSSColor=function(x){var T,B=x.replace(/ /g,"").toLowerCase();if(B in g)return g[B].slice();if(B[0]==="#")return B.length===4?(T=parseInt(B.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:B.length===7&&(T=parseInt(B.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var U=B.indexOf("("),j=B.indexOf(")");if(U!==-1&&j+1===B.length){var R=B.substr(0,U),N=B.substr(U+1,j-(U+1)).split(","),V=1;switch(R){case"rgba":if(N.length!==4)return null;V=_(N.pop());case"rgb":return N.length!==3?null:[f(N[0]),f(N[1]),f(N[2]),V];case"hsla":if(N.length!==4)return null;V=_(N.pop());case"hsl":if(N.length!==3)return null;var z=(parseFloat(N[0])%360+360)%360/360,G=_(N[1]),X=_(N[2]),K=X<=.5?X*(G+1):X+G-X*G,te=2*X-K;return[c(255*A(te,K,z+1/3)),c(255*A(te,K,z)),c(255*A(te,K,z-1/3)),V];default:return null}}return null}}catch{}return si}();class vr{constructor(c,f,_,A=1){this.r=c,this.g=f,this.b=_,this.a=A}static parse(c){if(!c)return;if(c instanceof vr)return c;if(typeof c!="string")return;const f=Cp.parseCSSColor(c);return f?new vr(f[0]/255*f[3],f[1]/255*f[3],f[2]/255*f[3],f[3]):void 0}toString(){const[c,f,_,A]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(c)},${Math.round(f)},${Math.round(_)},${A})`}toRenderColor(c){const{r:f,g:_,b:A,a:x}=this;return new T1(c,f,_,A,x)}}class T1{constructor(c,f,_,A,x){if(c){const T=c.image.height,B=T*T;f=x===0?0:f/x*(T-1),_=x===0?0:_/x*(T-1),A=x===0?0:A/x*(T-1);const U=Math.floor(f),j=Math.floor(_),R=Math.floor(A),N=Math.ceil(f),V=Math.ceil(_),z=Math.ceil(A),G=f-U,X=_-j,K=A-R,te=c.image.data,ce=4*(U+j*B+R*T),he=4*(U+j*B+z*T),ne=4*(U+V*B+R*T),de=4*(U+V*B+z*T),ge=4*(N+j*B+R*T),Me=4*(N+j*B+z*T),Be=4*(N+V*B+R*T),Oe=4*(N+V*B+z*T);if(ce<0||Oe>=te.length)throw new Error("out of range");this.r=cr(cr(cr(te[ce],te[he],K),cr(te[ne],te[de],K),X),cr(cr(te[ge],te[Me],K),cr(te[Be],te[Oe],K),X),G)/255*x,this.g=cr(cr(cr(te[ce+1],te[he+1],K),cr(te[ne+1],te[de+1],K),X),cr(cr(te[ge+1],te[Me+1],K),cr(te[Be+1],te[Oe+1],K),X),G)/255*x,this.b=cr(cr(cr(te[ce+2],te[he+2],K),cr(te[ne+2],te[de+2],K),X),cr(cr(te[ge+2],te[Me+2],K),cr(te[Be+2],te[Oe+2],K),X),G)/255*x,this.a=x}else this.r=f,this.g=_,this.b=A,this.a=x}toArray(){const{r:c,g:f,b:_,a:A}=this;return A===0?[0,0,0,0]:[255*c/A,255*f/A,255*_/A,A]}toArray01(){const{r:c,g:f,b:_,a:A}=this;return A===0?[0,0,0,0]:[c/A,f/A,_/A,A]}toArray01Scaled(c){const{r:f,g:_,b:A,a:x}=this;return x===0?[0,0,0]:[f/x*c,_/x*c,A/x*c]}toArray01PremultipliedAlpha(){const{r:c,g:f,b:_,a:A}=this;return[c,f,_,A]}toArray01Linear(){const{r:c,g:f,b:_,a:A}=this;return A===0?[0,0,0,0]:[Math.pow(c/A,2.2),Math.pow(f/A,2.2),Math.pow(_/A,2.2),A]}}function cr(g,c,f){return g*(1-f)+c*f}function ud(g,c,f){return g.map((_,A)=>cr(_,c[A],f))}vr.black=new vr(0,0,0,1),vr.white=new vr(1,1,1,1),vr.transparent=new vr(0,0,0,0),vr.red=new vr(1,0,0,1),vr.blue=new vr(0,0,1,1);var Vh=Object.freeze({__proto__:null,array:ud,color:function(g,c,f){return new vr(cr(g.r,c.r,f),cr(g.g,c.g,f),cr(g.b,c.b,f),cr(g.a,c.a,f))},number:cr});function hd(g,...c){for(const f of c)for(const _ in f)g[_]=f[_];return g}class xs extends Error{constructor(c,f){super(f),this.message=f,this.key=c}}class fd{constructor(c,f=[]){this.parent=c,this.bindings={};for(const[_,A]of f)this.bindings[_]=A}concat(c){return new fd(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Jl={kind:"null"},On={kind:"number"},ei={kind:"string"},Zr={kind:"boolean"},Us={kind:"color"},ga={kind:"object"},ni={kind:"value"},al={kind:"collator"},$a={kind:"formatted"},pu={kind:"resolvedImage"};function sa(g,c){return{kind:"array",itemType:g,N:c}}function Ts(g){if(g.kind==="array"){const c=Ts(g.itemType);return typeof g.N=="number"?`array<${c}, ${g.N}>`:g.itemType.kind==="value"?"array":`array<${c}>`}return g.kind}const M1=[Jl,On,ei,Zr,Us,$a,ga,sa(ni),pu];function Pa(g,c){if(c.kind==="error")return null;if(g.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!Pa(g.itemType,c.itemType))&&(typeof g.N!="number"||g.N===c.N))return null}else{if(g.kind===c.kind)return null;if(g.kind==="value"){for(const f of M1)if(!Pa(f,c))return null}}return`Expected ${Ts(g)} but found ${Ts(c)} instead.`}function dd(g,c){return c.some(f=>f.kind===g.kind)}function ll(g,c){return c.some(f=>f==="null"?g===null:f==="array"?Array.isArray(g):f==="object"?g&&!Array.isArray(g)&&typeof g=="object":f===typeof g)}class lg{constructor(c,f,_){this.sensitivity=c?f?"variant":"case":f?"accent":"base",this.locale=_,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,f){return this.collator.compare(c,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gs{constructor(c,f,_,A,x){this.text=c.normalize?c.normalize():c,this.image=f,this.scale=_,this.fontStack=A,this.textColor=x}}class Lo{constructor(c){this.sections=c}static fromString(c){return new Lo([new Gs(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.namePrimary.length!==0)}static factory(c){return c instanceof Lo?c:Lo.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}serialize(){const c=["format"];for(const f of this.sections){if(f.image){c.push(["image",f.image.namePrimary]);continue}c.push(f.text);const _={};f.fontStack&&(_["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(_["font-scale"]=f.scale),f.textColor&&(_["text-color"]=["rgba"].concat(f.textColor.toRenderColor(null).toArray())),c.push(_)}return c}}class qo{constructor(c){this.namePrimary=c.namePrimary,c.nameSecondary&&(this.nameSecondary=c.nameSecondary),this.available=c.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(c,f){return c?new qo({namePrimary:c,nameSecondary:f,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Hh(g,c,f,_){return typeof g=="number"&&g>=0&&g<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof f=="number"&&f>=0&&f<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:`Invalid rgba value [${[g,c,f,_].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof _=="number"?[g,c,f,_]:[g,c,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Oc(g){if(g===null||typeof g=="string"||typeof g=="boolean"||typeof g=="number"||g instanceof vr||g instanceof lg||g instanceof Lo||g instanceof qo)return!0;if(Array.isArray(g)){for(const c of g)if(!Oc(c))return!1;return!0}if(typeof g=="object"){for(const c in g)if(!Oc(g[c]))return!1;return!0}return!1}function Ds(g){if(g===null)return Jl;if(typeof g=="string")return ei;if(typeof g=="boolean")return Zr;if(typeof g=="number")return On;if(g instanceof vr)return Us;if(g instanceof lg)return al;if(g instanceof Lo)return $a;if(g instanceof qo)return pu;if(Array.isArray(g)){const c=g.length;let f;for(const _ of g){const A=Ds(_);if(f){if(f===A)continue;f=ni;break}f=A}return sa(f||ni,c)}return ga}function va(g){const c=typeof g;return g===null?"":c==="string"||c==="number"||c==="boolean"?String(g):g instanceof vr||g instanceof Lo||g instanceof qo?g.toString():JSON.stringify(g)}class cl{constructor(c,f){this.type=c,this.value=f}static parse(c,f){if(c.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Oc(c[1]))return f.error("invalid value");const _=c[1];let A=Ds(_);const x=f.expectedType;return A.kind!=="array"||A.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(A=x),new cl(A,_)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Lo?this.value.serialize():this.value}}class qs{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const Hu={string:ei,number:On,boolean:Zr,object:ga};class Zs{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");let _,A=1;const x=c[0];if(x==="array"){let B,U;if(c.length>2){const j=c[1];if(typeof j!="string"||!(j in Hu)||j==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);B=Hu[j],A++}else B=ni;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return f.error('The length argument to "array" must be a positive integer literal',2);U=c[2],A++}_=sa(B,U)}else _=Hu[x];const T=[];for(;A<c.length;A++){const B=f.parse(c[A],A,ni);if(!B)return null;T.push(B)}return new Zs(_,T)}evaluate(c){for(let f=0;f<this.args.length;f++){const _=this.args[f].evaluate(c);if(!Pa(this.type,Ds(_)))return _;if(f===this.args.length-1)throw new qs(`The expression ${JSON.stringify(this.args[f].serialize())} evaluated to ${Ts(Ds(_))} but was expected to be of type ${Ts(this.type)}.`)}return null}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=this.type,f=[c.kind];if(c.kind==="array"){const _=c.itemType;if(_.kind==="string"||_.kind==="number"||_.kind==="boolean"){f.push(_.kind);const A=c.N;(typeof A=="number"||this.args.length>1)&&f.push(A)}}return f.concat(this.args.map(_=>_.serialize()))}}class La{constructor(c){this.type=$a,this.sections=c}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");const _=c[1];if(!Array.isArray(_)&&typeof _=="object")return f.error("First argument must be an image or text section.");const A=[];let x=!1;for(let T=1;T<=c.length-1;++T){const B=c[T];if(x&&typeof B=="object"&&!Array.isArray(B)){x=!1;let U=null;if(B["font-scale"]&&(U=f.parseObjectValue(B["font-scale"],T,"font-scale",On),!U))return null;let j=null;if(B["text-font"]&&(j=f.parseObjectValue(B["text-font"],T,"text-font",sa(ei)),!j))return null;let R=null;if(B["text-color"]&&(R=f.parseObjectValue(B["text-color"],T,"text-color",Us),!R))return null;const N=A[A.length-1];N.scale=U,N.font=j,N.textColor=R}else{const U=f.parse(c[T],T,ni);if(!U)return null;const j=U.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,A.push({content:U,scale:null,font:null,textColor:null})}}return new La(A)}evaluate(c){return new Lo(this.sections.map(f=>{const _=f.content.evaluate(c);return Ds(_)===pu?new Gs("",_,null,null,null):new Gs(va(_),null,f.scale?f.scale.evaluate(c):null,f.font?f.font.evaluate(c).join(","):null,f.textColor?f.textColor.evaluate(c):null)}))}eachChild(c){for(const f of this.sections)c(f.content),f.scale&&c(f.scale),f.font&&c(f.font),f.textColor&&c(f.textColor)}outputDefined(){return!1}serialize(){const c=["format"];for(const f of this.sections){c.push(f.content.serialize());const _={};f.scale&&(_["font-scale"]=f.scale.serialize()),f.font&&(_["text-font"]=f.font.serialize()),f.textColor&&(_["text-color"]=f.textColor.serialize()),c.push(_)}return c}}class qa{constructor(c,f){this.type=pu,this.inputPrimary=c,this.inputSecondary=f}static parse(c,f){if(c.length<2)return f.error("Expected two or more arguments.");const _=f.parse(c[1],1,ei);if(!_)return f.error("No image name provided.");if(c.length===2)return new qa(_);const A=f.parse(c[2],1,ei);return A?new qa(_,A):f.error("Secondary image variant is not a string.")}evaluate(c){const f=qo.fromString(this.inputPrimary.evaluate(c),this.inputSecondary?this.inputSecondary.evaluate(c):void 0);return f&&c.availableImages&&(f.available=c.availableImages.indexOf(f.namePrimary)>-1,f.nameSecondary&&f.available&&c.availableImages&&(f.available=c.availableImages.indexOf(f.nameSecondary)>-1)),f}eachChild(c){c(this.inputPrimary),this.inputSecondary&&c(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function mu(g){return g instanceof Number?"number":g instanceof String?"string":g instanceof Boolean?"boolean":Array.isArray(g)?"array":g===null?"null":typeof g}const Ep={"to-boolean":Zr,"to-color":Us,"to-number":On,"to-string":ei};class oa{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");const _=c[0],A=[];let x=Jl;if(_==="to-array"){if(!Array.isArray(c[1]))return null;const T=c[1].length;if(f.expectedType){if(f.expectedType.kind!=="array")return f.error(`Expected ${f.expectedType.kind} but found array.`);x=sa(f.expectedType.itemType,T)}else{if(!(T>0&&Oc(c[1][0])))return null;x=sa(Ds(c[1][0]),T)}for(let B=0;B<T;B++){const U=c[1][B];let j;if(mu(U)==="array")j=f.parse(U,void 0,x.itemType);else{const R=mu(U);if(R!==x.itemType.kind)return f.error(`Expected ${x.itemType.kind} but found ${R}.`);j=f.registry.literal.parse(["literal",U===void 0?null:U],f)}if(!j)return null;A.push(j)}}else{if((_==="to-boolean"||_==="to-string")&&c.length!==2)return f.error("Expected one argument.");x=Ep[_];for(let T=1;T<c.length;T++){const B=f.parse(c[T],T,ni);if(!B)return null;A.push(B)}}return new oa(x,A)}evaluate(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){let f,_;for(const A of this.args){if(f=A.evaluate(c),_=null,f instanceof vr)return f;if(typeof f=="string"){const x=c.parseColor(f);if(x)return x}else if(Array.isArray(f)&&(_=f.length<3||f.length>4?`Invalid rbga value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Hh(f[0],f[1],f[2],f[3]),!_))return new vr(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new qs(_||`Could not parse color from value '${typeof f=="string"?f:String(JSON.stringify(f))}'`)}if(this.type.kind==="number"){let f=null;for(const _ of this.args){if(f=_.evaluate(c),f===null)return 0;const A=Number(f);if(!isNaN(A))return A}throw new qs(`Could not convert ${JSON.stringify(f)} to number.`)}return this.type.kind==="formatted"?Lo.fromString(va(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?qo.fromString(va(this.args[0].evaluate(c))):this.type.kind==="array"?this.args.map(f=>f.evaluate(c)):va(this.args[0].evaluate(c))}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){if(this.type.kind==="formatted")return new La([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qa(this.args[0]).serialize();const c=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(f=>{c.push(f.serialize())}),c}}const ju=["Unknown","Point","LineString","Polygon"];class Ip{constructor(c,f){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=c,this.options=f}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ju[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(c){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,f=this.featureDistanceData.scale,{x:_,y:A}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(_*f-c[0])+this.featureDistanceData.bearing[1]*(A*f-c[1])}return 0}parseColor(c){let f=this._parseColorCache[c];return f||(f=this._parseColorCache[c]=vr.parse(c)),f}getConfig(c){return this.options?this.options.get(c):null}}class Da{constructor(c,f,_,A,x){this.name=c,this.type=f,this._evaluate=_,this.args=A,this._overloadIndex=x}evaluate(c){if(!this._evaluate){const f=Da.definitions[this.name];this._evaluate=Array.isArray(f)?f[2]:f.overloads[this._overloadIndex][1]}return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(c=>c.serialize()))}static parse(c,f){const _=c[0],A=Da.definitions[_];if(!A)return f.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(A)?A[0]:A.type,T=Array.isArray(A)?[[A[1],A[2]]]:A.overloads,B=[];let U=null,j=-1;for(const[R,N]of T){if(Array.isArray(R)&&R.length!==c.length-1)continue;B.push(R),j++,U=new zv(f.registry,f.path,null,f.scope,void 0,f._scope,f.options);const V=[];let z=!1;for(let G=1;G<c.length;G++){const X=c[G],K=Array.isArray(R)?R[G-1]:R.type,te=U.parse(X,1+V.length,K);if(!te){z=!0;break}V.push(te)}if(!z)if(Array.isArray(R)&&R.length!==V.length)U.error(`Expected ${R.length} arguments, but found ${V.length} instead.`);else{for(let G=0;G<V.length;G++){const X=Array.isArray(R)?R[G]:R.type,K=V[G];U.concat(G+1).checkSubtype(X,K.type)}if(U.errors.length===0)return new Da(_,x,N,V,j)}}if(B.length===1)f.errors.push(...U.errors);else{const R=(B.length?B:T.map(([V])=>V)).map(cg).join(" | "),N=[];for(let V=1;V<c.length;V++){const z=f.parse(c[V],1+N.length);if(!z)return null;N.push(Ts(z.type))}f.error(`Expected arguments of type ${R}, but found (${N.join(", ")}) instead.`)}return null}static register(c,f){Da.definitions=f;for(const _ in f)c[_]=Da}}function cg(g){return Array.isArray(g)?`(${g.map(Ts).join(", ")})`:`(${Ts(g.type)}...)`}class Rp{constructor(c,f,_){this.type=al,this.locale=_,this.caseSensitive=c,this.diacriticSensitive=f}static parse(c,f){if(c.length!==2)return f.error("Expected one argument.");const _=c[1];if(typeof _!="object"||Array.isArray(_))return f.error("Collator options argument must be an object.");const A=_["case-sensitive"]===void 0?f.parse(!1,1,Zr):f.parseObjectValue(_["case-sensitive"],1,"case-sensitive",Zr);if(!A)return null;const x=_["diacritic-sensitive"]===void 0?f.parse(!1,1,Zr):f.parseObjectValue(_["diacritic-sensitive"],1,"diacritic-sensitive",Zr);if(!x)return null;let T=null;return _.locale&&(T=f.parseObjectValue(_.locale,1,"locale",ei),!T)?null:new Rp(A,x,T)}evaluate(c){return new lg(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}serialize(){const c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]}}function Fv(g,c,f=0,_=g.length-1,A=gu){for(;_>f;){if(_-f>600){const U=_-f+1,j=c-f+1,R=Math.log(U),N=.5*Math.exp(2*R/3),V=.5*Math.sqrt(R*N*(U-N)/U)*(j-U/2<0?-1:1);Fv(g,c,Math.max(f,Math.floor(c-j*N/U+V)),Math.min(_,Math.floor(c+(U-j)*N/U+V)),A)}const x=g[c];let T=f,B=_;for(Wu(g,f,c),A(g[_],x)>0&&Wu(g,f,_);T<B;){for(Wu(g,T,B),T++,B--;A(g[T],x)<0;)T++;for(;A(g[B],x)>0;)B--}A(g[f],x)===0?Wu(g,f,B):(B++,Wu(g,B,_)),B<=c&&(f=B+1),c<=B&&(_=B-1)}}function Wu(g,c,f){const _=g[c];g[c]=g[f],g[f]=_}function gu(g,c){return g<c?-1:g>c?1:0}function C1(g){let c=0;for(let f,_,A=0,x=g.length,T=x-1;A<x;T=A++)f=g[A],_=g[T],c+=(_.x-f.x)*(f.y+_.y);return c}function pd(g,c){g[0]=Math.min(g[0],c[0]),g[1]=Math.min(g[1],c[1]),g[2]=Math.max(g[2],c[0]),g[3]=Math.max(g[3],c[1])}function Xu(g,c){return!(g[0]<=c[0]||g[2]>=c[2]||g[1]<=c[1]||g[3]>=c[3])}function Nv(g,c,f){const _=g[0]-c[0],A=g[1]-c[1],x=g[0]-f[0],T=g[1]-f[1];return _*T-x*A==0&&_*x<=0&&A*T<=0}function Ql(g,c,f=!1){let _=!1;for(let B=0,U=c.length;B<U;B++){const j=c[B];for(let R=0,N=j.length,V=N-1;R<N;V=R++){const z=j[V],G=j[R];if(Nv(g,z,G))return f;(x=z)[1]>(A=g)[1]!=(T=G)[1]>A[1]&&A[0]<(T[0]-x[0])*(A[1]-x[1])/(T[1]-x[1])+x[0]&&(_=!_)}}var A,x,T;return _}function jh(g,c,f,_){const A=_[0]-f[0],x=_[1]-f[1],T=(g[0]-f[0])*x-A*(g[1]-f[1]),B=(c[0]-f[0])*x-A*(c[1]-f[1]);return T>0&&B<0||T<0&&B>0}function Wh(g,c,f,_){return(A=[_[0]-f[0],_[1]-f[1]])[0]*(x=[c[0]-g[0],c[1]-g[1]])[1]-A[1]*x[0]!=0&&!(!jh(g,c,f,_)||!jh(f,_,g,c));var A,x}const _a=8192;function Mr(g,c){const f=(180+g[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g[1]*Math.PI/360)))/360,A=Math.pow(2,c.z);return[Math.round(f*A*_a),Math.round(_*A*_a)]}function $n(g,c){for(let f=0;f<c.length;f++)if(Ql(g,c[f]))return!0;return!1}function vu(g,c,f){for(const _ of f)for(let A=0,x=_.length,T=x-1;A<x;T=A++)if(Wh(g,c,_[T],_[A]))return!0;return!1}function pr(g,c){for(let f=0;f<g.length;++f)if(!Ql(g[f],c))return!1;for(let f=0;f<g.length-1;++f)if(vu(g[f],g[f+1],c))return!1;return!0}function ec(g,c){for(let f=0;f<c.length;f++)if(pr(g,c[f]))return!0;return!1}function tc(g,c,f){const _=[];for(let A=0;A<g.length;A++){const x=[];for(let T=0;T<g[A].length;T++){const B=Mr(g[A][T],f);pd(c,B),x.push(B)}_.push(x)}return _}function _r(g,c,f){const _=[];for(let A=0;A<g.length;A++){const x=tc(g[A],c,f);_.push(x)}return _}function Pp(g,c,f,_){if(g[0]<f[0]||g[0]>f[2]){const A=.5*_;let x=g[0]-f[0]>A?-_:f[0]-g[0]>A?_:0;x===0&&(x=g[0]-f[2]>A?-_:f[2]-g[0]>A?_:0),g[0]+=x}pd(c,g)}function md(g,c,f,_){const A=Math.pow(2,_.z)*_a,x=[_.x*_a,_.y*_a],T=[];if(!g)return T;for(const B of g)for(const U of B){const j=[U.x+x[0],U.y+x[1]];Pp(j,c,f,A),T.push(j)}return T}function Ba(g,c,f,_){const A=Math.pow(2,_.z)*_a,x=[_.x*_a,_.y*_a],T=[];if(!g)return T;for(const U of g){const j=[];for(const R of U){const N=[R.x+x[0],R.y+x[1]];pd(c,N),j.push(N)}T.push(j)}if(c[2]-c[0]<=A/2){(B=c)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const U of T)for(const j of U)Pp(j,c,f,A)}var B;return T}class xo{constructor(c,f){this.type=Zr,this.geojson=c,this.geometries=f}static parse(c,f){if(c.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Oc(c[1])){const _=c[1];if(_.type==="FeatureCollection")for(let A=0;A<_.features.length;++A){const x=_.features[A].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new xo(_,_.features[A].geometry)}else if(_.type==="Feature"){const A=_.geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new xo(_,_.geometry)}else if(_.type==="Polygon"||_.type==="MultiPolygon")return new xo(_,_)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(f,_){const A=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(!T)return!1;if(_.type==="Polygon"){const B=tc(_.coordinates,x,T),U=md(f.geometry(),A,x,T);if(!Xu(A,x))return!1;for(const j of U)if(!Ql(j,B))return!1}if(_.type==="MultiPolygon"){const B=_r(_.coordinates,x,T),U=md(f.geometry(),A,x,T);if(!Xu(A,x))return!1;for(const j of U)if(!$n(j,B))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(f,_){const A=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(!T)return!1;if(_.type==="Polygon"){const B=tc(_.coordinates,x,T),U=Ba(f.geometry(),A,x,T);if(!Xu(A,x))return!1;for(const j of U)if(!pr(j,B))return!1}if(_.type==="MultiPolygon"){const B=_r(_.coordinates,x,T),U=Ba(f.geometry(),A,x,T);if(!Xu(A,x))return!1;for(const j of U)if(!ec(j,B))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const ns={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ao=1/298.257223563,Za=ao*(2-ao),Xh=Math.PI/180;class $h{static fromTile(c,f,_){const A=Math.PI*(1-2*(c+.5)/Math.pow(2,f)),x=Math.atan(.5*(Math.exp(A)-Math.exp(-A)))/Xh;return new $h(x,_)}static get units(){return ns}constructor(c,f){if(c===void 0)throw new Error("No latitude given.");if(f&&!ns[f])throw new Error(`Unknown unit ${f}. Use one of: ${Object.keys(ns).join(", ")}`);const _=6378.137*Xh*(f?ns[f]:1),A=Math.cos(c*Xh),x=1/(1-Za*(1-A*A)),T=Math.sqrt(x);this.kx=_*T*A,this.ky=_*T*x*(1-Za)}distance(c,f){const _=ys(c[0]-f[0])*this.kx,A=(c[1]-f[1])*this.ky;return Math.sqrt(_*_+A*A)}bearing(c,f){const _=ys(f[0]-c[0])*this.kx;return Math.atan2(_,(f[1]-c[1])*this.ky)/Xh}destination(c,f,_){const A=_*Xh;return this.offset(c,Math.sin(A)*f,Math.cos(A)*f)}offset(c,f,_){return[c[0]+f/this.kx,c[1]+_/this.ky]}lineDistance(c){let f=0;for(let _=0;_<c.length-1;_++)f+=this.distance(c[_],c[_+1]);return f}area(c){let f=0;for(let _=0;_<c.length;_++){const A=c[_];for(let x=0,T=A.length,B=T-1;x<T;B=x++)f+=ys(A[x][0]-A[B][0])*(A[x][1]+A[B][1])*(_?-1:1)}return Math.abs(f)/2*this.kx*this.ky}along(c,f){let _=0;if(f<=0)return c[0];for(let A=0;A<c.length-1;A++){const x=c[A],T=c[A+1],B=this.distance(x,T);if(_+=B,_>f)return nc(x,T,(f-(_-B))/B)}return c[c.length-1]}pointToSegmentDistance(c,f,_){let[A,x]=f,T=ys(_[0]-A)*this.kx,B=(_[1]-x)*this.ky;if(T!==0||B!==0){const U=(ys(c[0]-A)*this.kx*T+(c[1]-x)*this.ky*B)/(T*T+B*B);U>1?(A=_[0],x=_[1]):U>0&&(A+=T/this.kx*U,x+=B/this.ky*U)}return T=ys(c[0]-A)*this.kx,B=(c[1]-x)*this.ky,Math.sqrt(T*T+B*B)}pointOnLine(c,f){let _=1/0,A=c[0][0],x=c[0][1],T=0,B=0;for(let U=0;U<c.length-1;U++){let j=c[U][0],R=c[U][1],N=ys(c[U+1][0]-j)*this.kx,V=(c[U+1][1]-R)*this.ky,z=0;N===0&&V===0||(z=(ys(f[0]-j)*this.kx*N+(f[1]-R)*this.ky*V)/(N*N+V*V),z>1?(j=c[U+1][0],R=c[U+1][1]):z>0&&(j+=N/this.kx*z,R+=V/this.ky*z)),N=ys(f[0]-j)*this.kx,V=(f[1]-R)*this.ky;const G=N*N+V*V;G<_&&(_=G,A=j,x=R,T=U,B=z)}return{point:[A,x],index:T,t:Math.max(0,Math.min(1,B))}}lineSlice(c,f,_){let A=this.pointOnLine(_,c),x=this.pointOnLine(_,f);if(A.index>x.index||A.index===x.index&&A.t>x.t){const j=A;A=x,x=j}const T=[A.point],B=A.index+1,U=x.index;!gd(_[B],T[0])&&B<=U&&T.push(_[B]);for(let j=B+1;j<=U;j++)T.push(_[j]);return gd(_[U],x.point)||T.push(x.point),T}lineSliceAlong(c,f,_){let A=0;const x=[];for(let T=0;T<_.length-1;T++){const B=_[T],U=_[T+1],j=this.distance(B,U);if(A+=j,A>c&&x.length===0&&x.push(nc(B,U,(c-(A-j))/j)),A>=f)return x.push(nc(B,U,(f-(A-j))/j)),x;A>c&&x.push(U)}return x}bufferPoint(c,f){const _=f/this.ky,A=f/this.kx;return[c[0]-A,c[1]-_,c[0]+A,c[1]+_]}bufferBBox(c,f){const _=f/this.ky,A=f/this.kx;return[c[0]-A,c[1]-_,c[2]+A,c[3]+_]}insideBBox(c,f){return ys(c[0]-f[0])>=0&&ys(c[0]-f[2])<=0&&c[1]>=f[1]&&c[1]<=f[3]}}function gd(g,c){return g[0]===c[0]&&g[1]===c[1]}function nc(g,c,f){const _=ys(c[0]-g[0]);return[g[0]+_*f,g[1]+(c[1]-g[1])*f]}function ys(g){for(;g<-180;)g+=360;for(;g>180;)g-=360;return g}class qh{constructor(c=[],f=(_,A)=>_<A?-1:_>A?1:0){if(this.data=c,this.length=this.data.length,this.compare=f,this.length>0)for(let _=(this.length>>1)-1;_>=0;_--)this._down(_)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],f=this.data.pop();return--this.length>0&&(this.data[0]=f,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:f,compare:_}=this,A=f[c];for(;c>0;){const x=c-1>>1,T=f[x];if(_(A,T)>=0)break;f[c]=T,c=x}f[c]=A}_down(c){const{data:f,compare:_}=this,A=this.length>>1,x=f[c];for(;c<A;){let T=1+(c<<1);const B=T+1;if(B<this.length&&_(f[B],f[T])<0&&(T=B),_(f[T],x)>=0)break;f[c]=f[T],c=T}f[c]=x}}var yn=8192;function ug(g,c){return c.dist-g.dist}const Fc=100,Zh=50;function Lp(g){const c=[1/0,1/0,-1/0,-1/0];if(c.length!==g.length)return!1;for(let f=0;f<c.length;f++)if(c[f]!==g[f])return!1;return!0}function Dp(g){return g[1]-g[0]+1}function Ya(g,c){const f=g[1]>=g[0]&&g[1]<c;return f||console.warn("Distance Expression: Index is out of range"),f}function hg(g,c){if(g[0]>g[1])return[null,null];const f=Dp(g);if(c){if(f===2)return[g,null];const _=Math.floor(f/2);return[[g[0],g[0]+_],[g[0]+_,g[1]]]}{if(f===1)return[g,null];const _=Math.floor(f/2)-1;return[[g[0],g[0]+_],[g[0]+_+1,g[1]]]}}function aa(g,c){const f=[1/0,1/0,-1/0,-1/0];if(!Ya(c,g.length))return f;for(let _=c[0];_<=c[1];++_)pd(f,g[_]);return f}function ka(g){const c=[1/0,1/0,-1/0,-1/0];for(let f=0;f<g.length;++f)for(let _=0;_<g[f].length;++_)pd(c,g[f][_]);return c}function Nc(g,c,f){if(Lp(g)||Lp(c))return NaN;let _=0,A=0;return g[2]<c[0]&&(_=c[0]-g[2]),g[0]>c[2]&&(_=g[0]-c[2]),g[1]>c[3]&&(A=g[1]-c[3]),g[3]<c[1]&&(A=c[1]-g[3]),f.distance([0,0],[_,A])}function Yh(g){return 360*g-180}function rc(g){return 360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90}function Oa(g,c){const f=Math.pow(2,c.z),_=(g.y/yn+c.y)/f;return[Yh((g.x/yn+c.x)/f),rc(_)]}function Kh(g,c){const f=[];for(let _=0;_<g.length;++_)f.push(Oa(g[_],c));return f}function fg(g,c,f){const _=f.pointOnLine(c,g).point;return f.distance(g,_)}function Bp(g,c,f,_,A){const x=f.slice(_[0],_[1]+1);let T=1/0;for(let B=c[0];B<=c[1];++B)if((T=Math.min(T,fg(g[B],x,A)))===0)return 0;return T}function Ms(g,c,f,_,A){const x=Math.min(A.pointToSegmentDistance(g,f,_),A.pointToSegmentDistance(c,f,_)),T=Math.min(A.pointToSegmentDistance(f,g,c),A.pointToSegmentDistance(_,g,c));return Math.min(x,T)}function kp(g,c,f,_,A){if(!Ya(c,g.length)||!Ya(_,f.length))return NaN;let x=1/0;for(let T=c[0];T<c[1];++T)for(let B=_[0];B<_[1];++B){if(Wh(g[T],g[T+1],f[B],f[B+1]))return 0;x=Math.min(x,Ms(g[T],g[T+1],f[B],f[B+1],A))}return x}function dg(g,c,f,_,A){if(!Ya(c,g.length)||!Ya(_,f.length))return NaN;let x=1/0;for(let T=c[0];T<=c[1];++T)for(let B=_[0];B<=_[1];++B)if((x=Math.min(x,A.distance(g[T],f[B])))===0)return x;return x}function pg(g,c,f){if(Ql(g,c,!0))return 0;let _=1/0;for(const A of c){const x=A.length;if(x<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(A[0]!==A[x-1]&&(_=Math.min(_,f.pointToSegmentDistance(g,A[x-1],A[0])))===0||(_=Math.min(_,fg(g,A,f)))===0)return _}return _}function Op(g,c,f,_){if(!Ya(c,g.length))return NaN;for(let x=c[0];x<=c[1];++x)if(Ql(g[x],f,!0))return 0;let A=1/0;for(let x=c[0];x<c[1];++x)for(const T of f)for(let B=0,U=T.length,j=U-1;B<U;j=B++){if(Wh(g[x],g[x+1],T[j],T[B]))return 0;A=Math.min(A,Ms(g[x],g[x+1],T[j],T[B],_))}return A}function Ka(g,c){for(const f of g)for(let _=0;_<=f.length-1;++_)if(Ql(f[_],c,!0))return!0;return!1}function Jh(g,c,f,_=1/0){const A=ka(g),x=ka(c);if(_!==1/0&&Nc(A,x,f)>=_)return _;if(Xu(A,x)){if(Ka(g,c))return 0}else if(Ka(c,g))return 0;let T=_;for(const B of g)for(let U=0,j=B.length,R=j-1;U<j;R=U++)for(const N of c)for(let V=0,z=N.length,G=z-1;V<z;G=V++){if(Wh(B[R],B[U],N[G],N[V]))return 0;T=Math.min(T,Ms(B[R],B[U],N[G],N[V],f))}return T}function Cs(g,c,f,_,A,x,T){if(x===null||T===null)return;const B=Nc(aa(_,x),aa(A,T),f);B<c&&g.push({dist:B,range1:x,range2:T})}function Do(g,c,f,_,A=1/0){let x=Math.min(_.distance(g[0],f[0][0]),A);if(x===0)return x;const T=new qh([{dist:0,range1:[0,g.length-1],range2:[0,0]}],ug),B=c?Zh:Fc,U=ka(f);for(;T.length;){const j=T.pop();if(j.dist>=x)continue;const R=j.range1;if(Dp(R)<=B){if(!Ya(R,g.length))return NaN;if(c){const N=Op(g,R,f,_);if((x=Math.min(x,N))===0)return x}else for(let N=R[0];N<=R[1];++N){const V=pg(g[N],f,_);if((x=Math.min(x,V))===0)return x}}else{const N=hg(R,c);if(N[0]!==null){const V=Nc(aa(g,N[0]),U,_);V<x&&T.push({dist:V,range1:N[0],range2:[0,0]})}if(N[1]!==null){const V=Nc(aa(g,N[1]),U,_);V<x&&T.push({dist:V,range1:N[1],range2:[0,0]})}}}return x}function Ys(g,c,f,_,A,x=1/0){let T=Math.min(x,A.distance(g[0],f[0]));if(T===0)return T;const B=new qh([{dist:0,range1:[0,g.length-1],range2:[0,f.length-1]}],ug),U=c?Zh:Fc,j=_?Zh:Fc;for(;B.length;){const R=B.pop();if(R.dist>=T)continue;const N=R.range1,V=R.range2;if(Dp(N)<=U&&Dp(V)<=j){if(!Ya(N,g.length)||!Ya(V,f.length))return NaN;if(c&&_?T=Math.min(T,kp(g,N,f,V,A)):c||_?c&&!_?T=Math.min(T,Bp(f,V,g,N,A)):!c&&_&&(T=Math.min(T,Bp(g,N,f,V,A))):T=Math.min(T,dg(g,N,f,V,A)),T===0)return T}else{const z=hg(N,c),G=hg(V,_);Cs(B,T,A,g,f,z[0],G[0]),Cs(B,T,A,g,f,z[0],G[1]),Cs(B,T,A,g,f,z[1],G[0]),Cs(B,T,A,g,f,z[1],G[1])}}return T}function _u(g,c,f,_,A=1/0){let x=A;const T=aa(g,[0,g.length-1]);for(const B of f)if(!(x!==1/0&&Nc(T,aa(B,[0,B.length-1]),_)>=x)&&(x=Math.min(x,Ys(g,c,B,!0,_,x)),x===0))return x;return x}function yu(g,c,f,_,A=1/0){let x=A;const T=aa(g,[0,g.length-1]);for(const B of f){if(x!==1/0&&Nc(T,ka(B),_)>=x)continue;const U=Do(g,c,B,_,x);if(isNaN(U))return U;if((x=Math.min(x,U))===0)return x}return x}function $u(g){return g==="Point"||g==="MultiPoint"||g==="LineString"||g==="MultiLineString"||g==="Polygon"||g==="MultiPolygon"}class qu{constructor(c,f){this.type=On,this.geojson=c,this.geometries=f}static parse(c,f){if(c.length!==2)return f.error(`'distance' expression requires either one argument, but found ' ${c.length-1} instead.`);if(Oc(c[1])){const _=c[1];if(_.type==="FeatureCollection"){for(let A=0;A<_.features.length;++A)if($u(_.features[A].geometry.type))return new qu(_,_.features[A].geometry)}else if(_.type==="Feature"){if($u(_.geometry.type))return new qu(_,_.geometry)}else if($u(_.type))return new qu(_,_)}return f.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(c){const f=c.geometry(),_=c.canonicalID();if(f!=null&&_!=null){if(c.geometryType()==="Point")return function(A,x,T){const B=[];for(const j of A)for(const R of j)B.push(Oa(R,x));const U=new $h(B[0][1],"meters");return T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString"?Ys(B,!1,T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",U):T.type==="MultiLineString"?_u(B,!1,T.coordinates,U):T.type==="Polygon"||T.type==="MultiPolygon"?yu(B,!1,T.type==="Polygon"?[T.coordinates]:T.coordinates,U):null}(f,_,this.geometries);if(c.geometryType()==="LineString")return function(A,x,T){const B=[];for(const j of A){const R=[];for(const N of j)R.push(Oa(N,x));B.push(R)}const U=new $h(B[0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return _u(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",B,U);if(T.type==="MultiLineString"){let j=1/0;for(let R=0;R<T.coordinates.length;R++){const N=_u(T.coordinates[R],!0,B,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}if(T.type==="Polygon"||T.type==="MultiPolygon"){let j=1/0;for(let R=0;R<B.length;R++){const N=yu(B[R],!0,T.type==="Polygon"?[T.coordinates]:T.coordinates,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}return null}(f,_,this.geometries);if(c.geometryType()==="Polygon")return function(A,x,T){const B=[];for(const j of function(R,N){const V=R.length;if(V<=1)return[R];const z=[];let G,X;for(let K=0;K<V;K++){const te=C1(R[K]);te!==0&&(R[K].area=Math.abs(te),X===void 0&&(X=te<0),X===te<0?(G&&z.push(G),G=[R[K]]):G.push(R[K]))}return G&&z.push(G),z}(A)){const R=[];for(let N=0;N<j.length;++N)R.push(Kh(j[N],x));B.push(R)}const U=new $h(B[0][0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return yu(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",B,U);if(T.type==="MultiLineString"){let j=1/0;for(let R=0;R<T.coordinates.length;R++){const N=yu(T.coordinates[R],!0,B,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}return T.type==="Polygon"||T.type==="MultiPolygon"?function(j,R,N){let V=1/0;for(const z of j)for(const G of R){const X=Jh(z,G,N,V);if(isNaN(X))return X;if((V=Math.min(V,X))===0)return V}return V}(T.type==="Polygon"?[T.coordinates]:T.coordinates,B,U):null}(f,_,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Vs(g,c){switch(g){case"string":return va(c);case"number":return+c;case"boolean":return!!c;case"color":return vr.parse(c);case"formatted":return Lo.fromString(va(c));case"resolvedImage":return qo.fromString(va(c))}return c}function Kr(g,c,f,_){return _!==void 0&&(g=_*Math.round(g/_)),c!==void 0&&g<c&&(g=c),f!==void 0&&g>f&&(g=f),g}class Zu{constructor(c,f,_){this.type=c,this.key=f,this.scope=_}static parse(c,f){let _=f.expectedType;if(_==null&&(_=ni),c.length<2||c.length>3)return f.error("Invalid number of arguments for 'config' expression.");const A=f.parse(c[1],1);if(!(A instanceof cl))return f.error("Key name of 'config' expression must be a string literal.");if(c.length>=3){const x=f.parse(c[2],2);return x instanceof cl?new Zu(_,va(A.value),va(x.value)):f.error("Scope of 'config' expression must be a string literal.")}return new Zu(_,va(A.value))}evaluate(c){const f=[this.key,this.scope,c.scope].filter(Boolean).join(""),_=c.getConfig(f);if(!_)return null;const{type:A,value:x,values:T,minValue:B,maxValue:U,stepValue:j}=_,R=_.default.evaluate(c);let N=R;if(x){const V=c.scope;c.scope=(V||"").split("").slice(1).join(""),N=x.evaluate(c),c.scope=V}return A&&(N=Vs(A,N)),N===void 0||B===void 0&&U===void 0&&j===void 0||(typeof N=="number"?N=Kr(N,B,U,j):Array.isArray(N)&&(N=N.map(V=>typeof V=="number"?Kr(V,B,U,j):V))),x!==void 0&&N!==void 0&&T&&!T.includes(N)&&(N=R,A&&(N=Vs(A,N))),(A&&A!==this.type||N!==void 0&&Ds(N)!==this.type)&&(N=Vs(this.type.kind,N)),N}eachChild(){}outputDefined(){return!1}serialize(){const c=["config",this.key];return this.scope&&c.concat(this.key),c}}function Qh(g){if(g instanceof Da&&(g.name==="get"&&g.args.length===1||g.name==="feature-state"||g.name==="has"&&g.args.length===1||g.name==="properties"||g.name==="geometry-type"||g.name==="id"||/^filter-/.test(g.name))||g instanceof xo||g instanceof qu)return!1;let c=!0;return g.eachChild(f=>{c&&!Qh(f)&&(c=!1)}),c}function Ml(g){if(g instanceof Da&&g.name==="feature-state")return!1;let c=!0;return g.eachChild(f=>{c&&!Ml(f)&&(c=!1)}),c}function ul(g){if(g instanceof Zu)return new Set([g.key]);let c=new Set;return g.eachChild(f=>{c=new Set([...c,...ul(f)])}),c}function ic(g,c){if(g instanceof Da&&c.indexOf(g.name)>=0)return!1;let f=!0;return g.eachChild(_=>{f&&!ic(_,c)&&(f=!1)}),f}class xi{constructor(c,f){this.type=f.type,this.name=c,this.boundExpression=f}static parse(c,f){if(c.length!==2||typeof c[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");const _=c[1];return f.scope.has(_)?new xi(_,f.scope.get(_)):f.error(`Unknown variable "${_}". Make sure "${_}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class vd{constructor(c,f=[],_,A=new fd,x=[],T,B){this.registry=c,this.path=f,this.key=f.map(U=>typeof U=="string"?`['${U}']`:`[${U}]`).join(""),this.scope=A,this.errors=x,this.expectedType=_,this._scope=T,this.options=B}parse(c,f,_,A,x={}){return f||_?this.concat(f,null,_,A)._parse(c,x):this._parse(c,x)}parseObjectValue(c,f,_,A,x,T={}){return this.concat(f,_,A,x)._parse(c,T)}_parse(c,f){function _(A,x,T){return T==="assert"?new Zs(x,[A]):T==="coerce"?new oa(x,[A]):A}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const A=typeof c[0]=="string"?this.registry[c[0]]:void 0;if(A){let x=A.parse(c,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,B=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||B.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||B.kind!=="value"&&B.kind!=="string"){if(this.checkSubtype(T,B))return null}else x=_(x,T,f.typeAnnotation||"coerce");else x=_(x,T,f.typeAnnotation||"assert")}if(!(x instanceof cl)&&x.type.kind!=="resolvedImage"&&mg(x)){const T=new Ip(this._scope,this.options);try{x=new cl(x.type,x.evaluate(T))}catch(B){return this.error(B.message),null}}return x}return oa.parse(["to-array",c],this)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,f,_,A){let x=typeof c=="number"?this.path.concat(c):this.path;x=typeof f=="string"?x.concat(f):x;const T=A?this.scope.concat(A):this.scope;return new vd(this.registry,x,_||null,T,this.errors,this._scope,this.options)}error(c,...f){const _=`${this.key}${f.map(A=>`[${A}]`).join("")}`;this.errors.push(new xs(_,c))}checkSubtype(c,f){const _=Pa(c,f);return _&&this.error(_),_}}var zv=vd;function mg(g){if(g instanceof xi)return mg(g.boundExpression);if(g instanceof Da&&g.name==="error"||g instanceof Rp||g instanceof xo||g instanceof qu||g instanceof Zu)return!1;const c=g instanceof oa||g instanceof Zs;let f=!0;return g.eachChild(_=>{f=c?f&&mg(_):f&&_ instanceof cl}),!!f&&Qh(g)&&ic(g,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Fp(g,c){const f=g.length-1;let _,A,x=0,T=f,B=0;for(;x<=T;)if(B=Math.floor((x+T)/2),_=g[B],A=g[B+1],_<=c){if(B===f||c<A)return B;x=B+1}else{if(!(_>c))throw new qs("Input is not a number.");T=B-1}return 0}class _d{constructor(c,f,_){this.type=c,this.input=f,this.labels=[],this.outputs=[];for(const[A,x]of _)this.labels.push(A),this.outputs.push(x)}static parse(c,f){if(c.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return f.error("Expected an even number of arguments.");const _=f.parse(c[1],1,On);if(!_)return null;const A=[];let x=null;f.expectedType&&f.expectedType.kind!=="value"&&(x=f.expectedType);for(let T=1;T<c.length;T+=2){const B=T===1?-1/0:c[T],U=c[T+1],j=T,R=T+1;if(typeof B!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(A.length&&A[A.length-1][0]>=B)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const N=f.parse(U,R,x);if(!N)return null;x=x||N.type,A.push([B,N])}return new _d(x,_,A)}evaluate(c){const f=this.labels,_=this.outputs;if(f.length===1)return _[0].evaluate(c);const A=this.input.evaluate(c);if(A<=f[0])return _[0].evaluate(c);const x=f.length;return A>=f[x-1]?_[x-1].evaluate(c):_[Fp(f,A)].evaluate(c)}eachChild(c){c(this.input);for(const f of this.outputs)c(f)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){const c=["step",this.input.serialize()];for(let f=0;f<this.labels.length;f++)f>0&&c.push(this.labels[f]),c.push(this.outputs[f].serialize());return c}}const Uv=.95047,Gv=1.08883,gg=4/29,zc=6/29,Vv=3*zc*zc,vg=zc*zc*zc,_g=Math.PI/180,Hv=180/Math.PI;function ef(g){return g>vg?Math.pow(g,1/3):g/Vv+gg}function yg(g){return g>zc?g*g*g:Vv*(g-gg)}function xg(g){return 255*(g<=.0031308?12.92*g:1.055*Math.pow(g,1/2.4)-.055)}function bg(g){return(g/=255)<=.04045?g/12.92:Math.pow((g+.055)/1.055,2.4)}function jv(g){const c=bg(g.r),f=bg(g.g),_=bg(g.b),A=ef((.4124564*c+.3575761*f+.1804375*_)/Uv),x=ef((.2126729*c+.7151522*f+.072175*_)/1);return{l:116*x-16,a:500*(A-x),b:200*(x-ef((.0193339*c+.119192*f+.9503041*_)/Gv)),alpha:g.a}}function wg(g){let c=(g.l+16)/116,f=isNaN(g.a)?c:c+g.a/500,_=isNaN(g.b)?c:c-g.b/200;return c=1*yg(c),f=Uv*yg(f),_=Gv*yg(_),new vr(xg(3.2404542*f-1.5371385*c-.4985314*_),xg(-.969266*f+1.8760108*c+.041556*_),xg(.0556434*f-.2040259*c+1.0572252*_),g.alpha)}function E1(g,c,f){const _=c-g;return g+f*(_>180||_<-180?_-360*Math.round(_/360):_)}const yd={forward:jv,reverse:wg,interpolate:function(g,c,f){return{l:cr(g.l,c.l,f),a:cr(g.a,c.a,f),b:cr(g.b,c.b,f),alpha:cr(g.alpha,c.alpha,f)}}},Np={forward:function(g){const{l:c,a:f,b:_}=jv(g),A=Math.atan2(_,f)*Hv;return{h:A<0?A+360:A,c:Math.sqrt(f*f+_*_),l:c,alpha:g.a}},reverse:function(g){const c=g.h*_g,f=g.c;return wg({l:g.l,a:Math.cos(c)*f,b:Math.sin(c)*f,alpha:g.alpha})},interpolate:function(g,c,f){return{h:E1(g.h,c.h,f),c:cr(g.c,c.c,f),l:cr(g.l,c.l,f),alpha:cr(g.alpha,c.alpha,f)}}};var Wv=Object.freeze({__proto__:null,hcl:Np,lab:yd});class hl{constructor(c,f,_,A,x){this.type=c,this.operator=f,this.interpolation=_,this.input=A,this.labels=[],this.outputs=[];for(const[T,B]of x)this.labels.push(T),this.outputs.push(B)}static interpolationFactor(c,f,_,A){let x=0;if(c.name==="exponential")x=Xv(f,c.base,_,A);else if(c.name==="linear")x=Xv(f,1,_,A);else if(c.name==="cubic-bezier"){const T=c.controlPoints;x=new mn(T[0],T[1],T[2],T[3]).solve(Xv(f,1,_,A))}return x}static parse(c,f){let[_,A,x,...T]=c;if(!Array.isArray(A)||A.length===0)return f.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){const j=A[1];if(typeof j!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:j}}else{if(A[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(A[0])}`,1,0);{const j=A.slice(1);if(j.length!==4||j.some(R=>typeof R!="number"||R<0||R>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:j}}}if(c.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(x=f.parse(x,2,On),!x)return null;const B=[];let U=null;_==="interpolate-hcl"||_==="interpolate-lab"?U=Us:f.expectedType&&f.expectedType.kind!=="value"&&(U=f.expectedType);for(let j=0;j<T.length;j+=2){const R=T[j],N=T[j+1],V=j+3,z=j+4;if(typeof R!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(B.length&&B[B.length-1][0]>=R)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const G=f.parse(N,z,U);if(!G)return null;U=U||G.type,B.push([R,G])}return U.kind==="number"||U.kind==="color"||U.kind==="array"&&U.itemType.kind==="number"&&typeof U.N=="number"?new hl(U,_,A,x,B):f.error(`Type ${Ts(U)} is not interpolatable.`)}evaluate(c){const f=this.labels,_=this.outputs;if(f.length===1)return _[0].evaluate(c);const A=this.input.evaluate(c);if(A<=f[0])return _[0].evaluate(c);const x=f.length;if(A>=f[x-1])return _[x-1].evaluate(c);const T=Fp(f,A),B=hl.interpolationFactor(this.interpolation,A,f[T],f[T+1]),U=_[T].evaluate(c),j=_[T+1].evaluate(c);return this.operator==="interpolate"?Vh[this.type.kind.toLowerCase()](U,j,B):this.operator==="interpolate-hcl"?Np.reverse(Np.interpolate(Np.forward(U),Np.forward(j),B)):yd.reverse(yd.interpolate(yd.forward(U),yd.forward(j),B))}eachChild(c){c(this.input);for(const f of this.outputs)c(f)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){let c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const f=[this.operator,c,this.input.serialize()];for(let _=0;_<this.labels.length;_++)f.push(this.labels[_],this.outputs[_].serialize());return f}}function Xv(g,c,f,_){const A=_-f,x=g-f;return A===0?0:c===1?x/A:(Math.pow(c,x)-1)/(Math.pow(c,A)-1)}class zp{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expectected at least one argument.");let _=null;const A=f.expectedType;A&&A.kind!=="value"&&(_=A);const x=[];for(const B of c.slice(1)){const U=f.parse(B,1+x.length,_,void 0,{typeAnnotation:"omit"});if(!U)return null;_=_||U.type,x.push(U)}const T=A&&x.some(B=>Pa(A,B.type));return new zp(T?ni:_,x)}evaluate(c){let f,_=null,A=0;for(const x of this.args){if(A++,_=x.evaluate(c),_&&_ instanceof qo&&!_.available&&(f||(f=_),_=null,A===this.args.length))return f;if(_!==null)break}return _}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=["coalesce"];return this.eachChild(f=>{c.push(f.serialize())}),c}}class Up{constructor(c,f){this.type=f.type,this.bindings=[].concat(c),this.result=f}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const f of this.bindings)c(f[1]);c(this.result)}static parse(c,f){if(c.length<4)return f.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const _=[];for(let x=1;x<c.length-1;x+=2){const T=c[x];if(typeof T!="string")return f.error(`Expected string, but found ${typeof T} instead.`,x);if(/[^a-zA-Z0-9_]/.test(T))return f.error("Variable names must contain only alphanumeric characters or '_'.",x);const B=f.parse(c[x+1],x+1);if(!B)return null;_.push([T,B])}const A=f.parse(c[c.length-1],c.length-1,f.expectedType,_);return A?new Up(_,A):null}outputDefined(){return this.result.outputDefined()}serialize(){const c=["let"];for(const[f,_]of this.bindings)c.push(f,_.serialize());return c.push(this.result.serialize()),c}}class Sg{constructor(c,f,_){this.type=c,this.index=f,this.input=_}static parse(c,f){if(c.length!==3)return f.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=f.parse(c[1],1,On),A=f.parse(c[2],2,sa(f.expectedType||ni));return _&&A?new Sg(A.type.itemType,_,A):null}evaluate(c){const f=this.index.evaluate(c),_=this.input.evaluate(c);if(f<0)throw new qs(`Array index out of bounds: ${f} < 0.`);if(f>=_.length)throw new qs(`Array index out of bounds: ${f} > ${_.length-1}.`);if(f!==Math.floor(f))throw new qs(`Array index must be an integer, but found ${f} instead.`);return _[f]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Ag{constructor(c,f){this.type=Zr,this.needle=c,this.haystack=f}static parse(c,f){if(c.length!==3)return f.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=f.parse(c[1],1,ni),A=f.parse(c[2],2,ni);return _&&A?dd(_.type,[Zr,ei,On,Jl,ni])?new Ag(_,A):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ts(_.type)} instead`):null}evaluate(c){const f=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(_==null)return!1;if(!ll(f,["boolean","string","number","null"]))throw new qs(`Expected first argument to be of type boolean, string, number or null, but found ${Ts(Ds(f))} instead.`);if(!ll(_,["string","array"]))throw new qs(`Expected second argument to be of type array or string, but found ${Ts(Ds(_))} instead.`);return _.indexOf(f)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class tf{constructor(c,f,_){this.type=On,this.needle=c,this.haystack=f,this.fromIndex=_}static parse(c,f){if(c.length<=2||c.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=f.parse(c[1],1,ni),A=f.parse(c[2],2,ni);if(!_||!A)return null;if(!dd(_.type,[Zr,ei,On,Jl,ni]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ts(_.type)} instead`);if(c.length===4){const x=f.parse(c[3],3,On);return x?new tf(_,A,x):null}return new tf(_,A)}evaluate(c){const f=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(!ll(f,["boolean","string","number","null"]))throw new qs(`Expected first argument to be of type boolean, string, number or null, but found ${Ts(Ds(f))} instead.`);if(!ll(_,["string","array"]))throw new qs(`Expected second argument to be of type array or string, but found ${Ts(Ds(_))} instead.`);if(this.fromIndex){const A=this.fromIndex.evaluate(c);return _.indexOf(f,A)}return _.indexOf(f)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class $v{constructor(c,f,_,A,x,T){this.inputType=c,this.type=f,this.input=_,this.cases=A,this.outputs=x,this.otherwise=T}static parse(c,f){if(c.length<5)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return f.error("Expected an even number of arguments.");let _,A;f.expectedType&&f.expectedType.kind!=="value"&&(A=f.expectedType);const x={},T=[];for(let j=2;j<c.length-1;j+=2){let R=c[j];const N=c[j+1];Array.isArray(R)||(R=[R]);const V=f.concat(j);if(R.length===0)return V.error("Expected at least one branch label.");for(const G of R){if(typeof G!="number"&&typeof G!="string")return V.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return V.error("Numeric branch labels must be integer values.");if(_){if(V.checkSubtype(_,Ds(G)))return null}else _=Ds(G);if(x[String(G)]!==void 0)return V.error("Branch labels must be unique.");x[String(G)]=T.length}const z=f.parse(N,j,A);if(!z)return null;A=A||z.type,T.push(z)}const B=f.parse(c[1],1,ni);if(!B)return null;const U=f.parse(c[c.length-1],c.length-1,A);return U?B.type.kind!=="value"&&f.concat(1).checkSubtype(_,B.type)?null:new $v(_,A,B,x,T,U):null}evaluate(c){const f=this.input.evaluate(c);return(Ds(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["match",this.input.serialize()],f=Object.keys(this.cases).sort(),_=[],A={};for(const T of f){const B=A[this.cases[T]];B===void 0?(A[this.cases[T]]=_.length,_.push([this.cases[T],[T]])):_[B][1].push(T)}const x=T=>this.inputType.kind==="number"?Number(T):T;for(const[T,B]of _)c.push(B.length===1?x(B[0]):B.map(x)),c.push(this.outputs[T].serialize());return c.push(this.otherwise.serialize()),c}}class Gp{constructor(c,f,_){this.type=c,this.branches=f,this.otherwise=_}static parse(c,f){if(c.length<4)return f.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return f.error("Expected an odd number of arguments.");let _;f.expectedType&&f.expectedType.kind!=="value"&&(_=f.expectedType);const A=[];for(let T=1;T<c.length-1;T+=2){const B=f.parse(c[T],T,Zr);if(!B)return null;const U=f.parse(c[T+1],T+1,_);if(!U)return null;A.push([B,U]),_=_||U.type}const x=f.parse(c[c.length-1],c.length-1,_);return x?new Gp(_,A,x):null}evaluate(c){for(const[f,_]of this.branches)if(f.evaluate(c))return _.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[f,_]of this.branches)c(f),c(_);c(this.otherwise)}outputDefined(){return this.branches.every(([c,f])=>f.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["case"];return this.eachChild(f=>{c.push(f.serialize())}),c}}class Tg{constructor(c,f,_,A){this.type=c,this.input=f,this.beginIndex=_,this.endIndex=A}static parse(c,f){if(c.length<=2||c.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=f.parse(c[1],1,ni),A=f.parse(c[2],2,On);if(!_||!A)return null;if(!dd(_.type,[sa(ni),ei,ni]))return f.error(`Expected first argument to be of type array or string, but found ${Ts(_.type)} instead`);if(c.length===4){const x=f.parse(c[3],3,On);return x?new Tg(_.type,_,A,x):null}return new Tg(_.type,_,A)}evaluate(c){const f=this.input.evaluate(c),_=this.beginIndex.evaluate(c);if(!ll(f,["string","array"]))throw new qs(`Expected first argument to be of type array or string, but found ${Ts(Ds(f))} instead.`);if(this.endIndex){const A=this.endIndex.evaluate(c);return f.slice(_,A)}return f.slice(_)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Vp(g,c){return g==="=="||g==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function Mg(g,c,f,_){return _.compare(c,f)===0}function xd(g,c,f){const _=g!=="=="&&g!=="!=";return class pce{constructor(x,T,B){this.type=Zr,this.lhs=x,this.rhs=T,this.collator=B,this.hasUntypedArgument=x.type.kind==="value"||T.type.kind==="value"}static parse(x,T){if(x.length!==3&&x.length!==4)return T.error("Expected two or three arguments.");const B=x[0];let U=T.parse(x[1],1,ni);if(!U)return null;if(!Vp(B,U.type))return T.concat(1).error(`"${B}" comparisons are not supported for type '${Ts(U.type)}'.`);let j=T.parse(x[2],2,ni);if(!j)return null;if(!Vp(B,j.type))return T.concat(2).error(`"${B}" comparisons are not supported for type '${Ts(j.type)}'.`);if(U.type.kind!==j.type.kind&&U.type.kind!=="value"&&j.type.kind!=="value")return T.error(`Cannot compare types '${Ts(U.type)}' and '${Ts(j.type)}'.`);_&&(U.type.kind==="value"&&j.type.kind!=="value"?U=new Zs(j.type,[U]):U.type.kind!=="value"&&j.type.kind==="value"&&(j=new Zs(U.type,[j])));let R=null;if(x.length===4){if(U.type.kind!=="string"&&j.type.kind!=="string"&&U.type.kind!=="value"&&j.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(R=T.parse(x[3],3,al),!R)return null}return new pce(U,j,R)}evaluate(x){const T=this.lhs.evaluate(x),B=this.rhs.evaluate(x);if(_&&this.hasUntypedArgument){const U=Ds(T),j=Ds(B);if(U.kind!==j.kind||U.kind!=="string"&&U.kind!=="number")throw new qs(`Expected arguments for "${g}" to be (string, string) or (number, number), but found (${U.kind}, ${j.kind}) instead.`)}if(this.collator&&!_&&this.hasUntypedArgument){const U=Ds(T),j=Ds(B);if(U.kind!=="string"||j.kind!=="string")return c(x,T,B)}return this.collator?f(x,T,B,this.collator.evaluate(x)):c(x,T,B)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[g];return this.eachChild(T=>{x.push(T.serialize())}),x}}}const I1=xd("==",function(g,c,f){return c===f},Mg),qv=xd("!=",function(g,c,f){return c!==f},function(g,c,f,_){return!Mg(0,c,f,_)}),Zv=xd("<",function(g,c,f){return c<f},function(g,c,f,_){return _.compare(c,f)<0}),nf=xd(">",function(g,c,f){return c>f},function(g,c,f,_){return _.compare(c,f)>0}),Yv=xd("<=",function(g,c,f){return c<=f},function(g,c,f,_){return _.compare(c,f)<=0}),sc=xd(">=",function(g,c,f){return c>=f},function(g,c,f,_){return _.compare(c,f)>=0});class Cg{constructor(c,f,_,A,x,T){this.type=ei,this.number=c,this.locale=f,this.currency=_,this.unit=A,this.minFractionDigits=x,this.maxFractionDigits=T}static parse(c,f){if(c.length!==3)return f.error("Expected two arguments.");const _=f.parse(c[1],1,On);if(!_)return null;const A=c[2];if(typeof A!="object"||Array.isArray(A))return f.error("NumberFormat options argument must be an object.");let x=null;if(A.locale&&(x=f.parseObjectValue(A.locale,2,"locale",ei),!x))return null;let T=null;if(A.currency&&(T=f.parseObjectValue(A.currency,2,"currency",ei),!T))return null;let B=null;if(A.unit&&(B=f.parseObjectValue(A.unit,2,"unit",ei),!B))return null;let U=null;if(A["min-fraction-digits"]&&(U=f.parseObjectValue(A["min-fraction-digits"],2,"min-fraction-digits",On),!U))return null;let j=null;return A["max-fraction-digits"]&&(j=f.parseObjectValue(A["max-fraction-digits"],2,"max-fraction-digits",On),!j)?null:new Cg(_,x,T,B,U,j)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(c):void 0,unit:this.unit?this.unit.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.unit&&c(this.unit),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.unit&&(c.unit=this.unit.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]}}class xu{constructor(c){this.type=On,this.input=c}static parse(c,f){if(c.length!==2)return f.error(`Expected 1 argument, but found ${c.length-1} instead.`);const _=f.parse(c[1],1);return _?_.type.kind!=="array"&&_.type.kind!=="string"&&_.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${Ts(_.type)} instead.`):new xu(_):null}evaluate(c){const f=this.input.evaluate(c);if(typeof f=="string"||Array.isArray(f))return f.length;throw new qs(`Expected value to be of type string or array, but found ${Ts(Ds(f))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}serialize(){const c=["length"];return this.eachChild(f=>{c.push(f.serialize())}),c}}function Yu(g){return function(){g=1831565813+(g|=0)|0;let c=Math.imul(g^g>>>15,1|g);return c=c+Math.imul(c^c>>>7,61|c)^c,((c^c>>>14)>>>0)/4294967296}}const bu={"==":I1,"!=":qv,">":nf,"<":Zv,">=":sc,"<=":Yv,array:Zs,at:Sg,boolean:Zs,case:Gp,coalesce:zp,collator:Rp,format:La,image:qa,in:Ag,"index-of":tf,interpolate:hl,"interpolate-hcl":hl,"interpolate-lab":hl,length:xu,let:Up,literal:cl,match:$v,number:Zs,"number-format":Cg,object:Zs,slice:Tg,step:_d,string:Zs,"to-boolean":oa,"to-color":oa,"to-number":oa,"to-string":oa,var:xi,within:xo,distance:qu,config:Zu};function Hp(g,[c,f,_,A]){c=c.evaluate(g),f=f.evaluate(g),_=_.evaluate(g);const x=A?A.evaluate(g):1,T=Hh(c,f,_,x);if(T)throw new qs(T);return new vr(c/255*x,f/255*x,_/255*x,x)}function Eg(g,[c,f,_,A]){c=c.evaluate(g),f=f.evaluate(g),_=_.evaluate(g);const x=A?A.evaluate(g):1,T=function(j,R,N,V){return typeof j=="number"&&j>=0&&j<=360?typeof R=="number"&&R>=0&&R<=100&&typeof N=="number"&&N>=0&&N<=100?V===void 0||typeof V=="number"&&V>=0&&V<=1?null:`Invalid hsla value [${[j,R,N,V].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof V=="number"?[j,R,N,V]:[j,R,N]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof V=="number"?[j,R,N,V]:[j,R,N]).join(", ")}]: 'h' must be between 0 and 360.`}(c,f,_,x);if(T)throw new qs(T);const B=`hsla(${c}, ${f}%, ${_}%, ${x})`,U=vr.parse(B);if(!U)throw new qs(`Failed to parse HSLA color: ${B}`);return U}function rf(g,c){return g in c}function Zo(g,c){const f=c[g];return f===void 0?null:f}function sf(g){return{type:g}}function R1(g){return{result:"success",value:g}}function bo(g){return{result:"error",value:g}}function la(g,c){return!!g&&!!g.parameters&&g.parameters.indexOf(c)>-1}function jp(g){return g["property-type"]==="data-driven"}function Ig(g){return la(g.expression,"measure-light")}function Kv(g){return la(g.expression,"zoom")}function Rg(g){return!!g.expression&&g.expression.interpolated}function Wp(g){return typeof g=="object"&&g!==null&&!Array.isArray(g)}function Pg(g){return g}function Jv(g,c){const f=c.type==="color",_=g.stops&&typeof g.stops[0][0]=="object",A=_||!(_||g.property!==void 0),x=g.type||(Rg(c)?"exponential":"interval");if(f&&((g=hd({},g)).stops&&(g.stops=g.stops.map(j=>[j[0],vr.parse(j[1])])),g.default=vr.parse(g.default?g.default:c.default)),g.colorSpace&&g.colorSpace!=="rgb"&&!Wv[g.colorSpace])throw new Error(`Unknown color space: ${g.colorSpace}`);let T,B,U;if(x==="exponential")T=Xp;else if(x==="interval")T=Qv;else if(x==="categorical"){T=P1,B=Object.create(null);for(const j of g.stops)B[j[0]]=j[1];U=typeof g.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);T=Lg}if(_){const j={},R=[];for(let z=0;z<g.stops.length;z++){const G=g.stops[z],X=G[0].zoom;j[X]===void 0&&(j[X]={zoom:X,type:g.type,property:g.property,default:g.default,stops:[]},R.push(X)),j[X].stops.push([G[0].value,G[1]])}const N=[];for(const z of R)N.push([j[z].zoom,Jv(j[z],c)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:hl.interpolationFactor.bind(void 0,V),zoomStops:N.map(z=>z[0]),evaluate:({zoom:z},G)=>Xp({stops:N,base:g.base},c,z).evaluate(z,G)}}if(A){const j=x==="exponential"?{name:"exponential",base:g.base!==void 0?g.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:hl.interpolationFactor.bind(void 0,j),zoomStops:g.stops.map(R=>R[0]),evaluate:({zoom:R})=>T(g,c,R,B,U)}}return{kind:"source",evaluate(j,R){const N=R&&R.properties?R.properties[g.property]:void 0;return N===void 0?of(g.default,c.default):T(g,c,N,B,U)}}}function of(g,c,f){return g!==void 0?g:c!==void 0?c:f!==void 0?f:void 0}function P1(g,c,f,_,A){return of(typeof f===A?_[f]:void 0,g.default,c.default)}function Qv(g,c,f){if(mu(f)!=="number")return of(g.default,c.default);const _=g.stops.length;if(_===1||f<=g.stops[0][0])return g.stops[0][1];if(f>=g.stops[_-1][0])return g.stops[_-1][1];const A=Fp(g.stops.map(x=>x[0]),f);return g.stops[A][1]}function Xp(g,c,f){const _=g.base!==void 0?g.base:1;if(mu(f)!=="number")return of(g.default,c.default);const A=g.stops.length;if(A===1||f<=g.stops[0][0])return g.stops[0][1];if(f>=g.stops[A-1][0])return g.stops[A-1][1];const x=Fp(g.stops.map(R=>R[0]),f),T=function(R,N,V,z){const G=z-V,X=R-V;return G===0?0:N===1?X/G:(Math.pow(N,X)-1)/(Math.pow(N,G)-1)}(f,_,g.stops[x][0],g.stops[x+1][0]),B=g.stops[x][1],U=g.stops[x+1][1];let j=Vh[c.type]||Pg;if(g.colorSpace&&g.colorSpace!=="rgb"){const R=Wv[g.colorSpace];j=(N,V)=>R.reverse(R.interpolate(R.forward(N),R.forward(V),T))}return typeof B.evaluate=="function"?{evaluate(...R){const N=B.evaluate.apply(void 0,R),V=U.evaluate.apply(void 0,R);if(N!==void 0&&V!==void 0)return j(N,V,T)}}:j(B,U,T)}function Lg(g,c,f){return c.type==="color"?f=vr.parse(f):c.type==="formatted"?f=Lo.fromString(f.toString()):c.type==="resolvedImage"?f=qo.fromString(f.toString()):mu(f)===c.type||c.type==="enum"&&c.values[f]||(f=void 0),of(f,g.default,c.default)}Da.register(bu,{error:[{kind:"error"},[ei],(g,[c])=>{throw new qs(c.evaluate(g))}],typeof:[ei,[ni],(g,[c])=>Ts(Ds(c.evaluate(g)))],"to-rgba":[sa(On,4),[Us],(g,[c])=>c.evaluate(g).toRenderColor(null).toArray()],rgb:[Us,[On,On,On],Hp],rgba:[Us,[On,On,On,On],Hp],hsl:[Us,[On,On,On],Eg],hsla:[Us,[On,On,On,On],Eg],has:{type:Zr,overloads:[[[ei],(g,[c])=>rf(c.evaluate(g),g.properties())],[[ei,ga],(g,[c,f])=>rf(c.evaluate(g),f.evaluate(g))]]},get:{type:ni,overloads:[[[ei],(g,[c])=>Zo(c.evaluate(g),g.properties())],[[ei,ga],(g,[c,f])=>Zo(c.evaluate(g),f.evaluate(g))]]},"feature-state":[ni,[ei],(g,[c])=>Zo(c.evaluate(g),g.featureState||{})],properties:[ga,[],g=>g.properties()],"geometry-type":[ei,[],g=>g.geometryType()],id:[ni,[],g=>g.id()],zoom:[On,[],g=>g.globals.zoom],pitch:[On,[],g=>g.globals.pitch||0],"distance-from-center":[On,[],g=>g.distanceFromCenter()],"measure-light":[On,[ei],(g,[c])=>g.measureLight(c.evaluate(g))],"heatmap-density":[On,[],g=>g.globals.heatmapDensity||0],"line-progress":[On,[],g=>g.globals.lineProgress||0],"raster-value":[On,[],g=>g.globals.rasterValue||0],"raster-particle-speed":[On,[],g=>g.globals.rasterParticleSpeed||0],"sky-radial-progress":[On,[],g=>g.globals.skyRadialProgress||0],accumulated:[ni,[],g=>g.globals.accumulated===void 0?null:g.globals.accumulated],"+":[On,sf(On),(g,c)=>{let f=0;for(const _ of c)f+=_.evaluate(g);return f}],"*":[On,sf(On),(g,c)=>{let f=1;for(const _ of c)f*=_.evaluate(g);return f}],"-":{type:On,overloads:[[[On,On],(g,[c,f])=>c.evaluate(g)-f.evaluate(g)],[[On],(g,[c])=>-c.evaluate(g)]]},"/":[On,[On,On],(g,[c,f])=>c.evaluate(g)/f.evaluate(g)],"%":[On,[On,On],(g,[c,f])=>c.evaluate(g)%f.evaluate(g)],ln2:[On,[],()=>Math.LN2],pi:[On,[],()=>Math.PI],e:[On,[],()=>Math.E],"^":[On,[On,On],(g,[c,f])=>Math.pow(c.evaluate(g),f.evaluate(g))],sqrt:[On,[On],(g,[c])=>Math.sqrt(c.evaluate(g))],log10:[On,[On],(g,[c])=>Math.log(c.evaluate(g))/Math.LN10],ln:[On,[On],(g,[c])=>Math.log(c.evaluate(g))],log2:[On,[On],(g,[c])=>Math.log(c.evaluate(g))/Math.LN2],sin:[On,[On],(g,[c])=>Math.sin(c.evaluate(g))],cos:[On,[On],(g,[c])=>Math.cos(c.evaluate(g))],tan:[On,[On],(g,[c])=>Math.tan(c.evaluate(g))],asin:[On,[On],(g,[c])=>Math.asin(c.evaluate(g))],acos:[On,[On],(g,[c])=>Math.acos(c.evaluate(g))],atan:[On,[On],(g,[c])=>Math.atan(c.evaluate(g))],min:[On,sf(On),(g,c)=>Math.min(...c.map(f=>f.evaluate(g)))],max:[On,sf(On),(g,c)=>Math.max(...c.map(f=>f.evaluate(g)))],abs:[On,[On],(g,[c])=>Math.abs(c.evaluate(g))],round:[On,[On],(g,[c])=>{const f=c.evaluate(g);return f<0?-Math.round(-f):Math.round(f)}],floor:[On,[On],(g,[c])=>Math.floor(c.evaluate(g))],ceil:[On,[On],(g,[c])=>Math.ceil(c.evaluate(g))],"filter-==":[Zr,[ei,ni],(g,[c,f])=>g.properties()[c.value]===f.value],"filter-id-==":[Zr,[ni],(g,[c])=>g.id()===c.value],"filter-type-==":[Zr,[ei],(g,[c])=>g.geometryType()===c.value],"filter-<":[Zr,[ei,ni],(g,[c,f])=>{const _=g.properties()[c.value],A=f.value;return typeof _==typeof A&&_<A}],"filter-id-<":[Zr,[ni],(g,[c])=>{const f=g.id(),_=c.value;return typeof f==typeof _&&f<_}],"filter->":[Zr,[ei,ni],(g,[c,f])=>{const _=g.properties()[c.value],A=f.value;return typeof _==typeof A&&_>A}],"filter-id->":[Zr,[ni],(g,[c])=>{const f=g.id(),_=c.value;return typeof f==typeof _&&f>_}],"filter-<=":[Zr,[ei,ni],(g,[c,f])=>{const _=g.properties()[c.value],A=f.value;return typeof _==typeof A&&_<=A}],"filter-id-<=":[Zr,[ni],(g,[c])=>{const f=g.id(),_=c.value;return typeof f==typeof _&&f<=_}],"filter->=":[Zr,[ei,ni],(g,[c,f])=>{const _=g.properties()[c.value],A=f.value;return typeof _==typeof A&&_>=A}],"filter-id->=":[Zr,[ni],(g,[c])=>{const f=g.id(),_=c.value;return typeof f==typeof _&&f>=_}],"filter-has":[Zr,[ni],(g,[c])=>c.value in g.properties()],"filter-has-id":[Zr,[],g=>g.id()!==null&&g.id()!==void 0],"filter-type-in":[Zr,[sa(ei)],(g,[c])=>c.value.indexOf(g.geometryType())>=0],"filter-id-in":[Zr,[sa(ni)],(g,[c])=>c.value.indexOf(g.id())>=0],"filter-in-small":[Zr,[ei,sa(ni)],(g,[c,f])=>f.value.indexOf(g.properties()[c.value])>=0],"filter-in-large":[Zr,[ei,sa(ni)],(g,[c,f])=>function(_,A,x,T){for(;x<=T;){const B=x+T>>1;if(A[B]===_)return!0;A[B]>_?T=B-1:x=B+1}return!1}(g.properties()[c.value],f.value,0,f.value.length-1)],all:{type:Zr,overloads:[[[Zr,Zr],(g,[c,f])=>c.evaluate(g)&&f.evaluate(g)],[sf(Zr),(g,c)=>{for(const f of c)if(!f.evaluate(g))return!1;return!0}]]},any:{type:Zr,overloads:[[[Zr,Zr],(g,[c,f])=>c.evaluate(g)||f.evaluate(g)],[sf(Zr),(g,c)=>{for(const f of c)if(f.evaluate(g))return!0;return!1}]]},"!":[Zr,[Zr],(g,[c])=>!c.evaluate(g)],"is-supported-script":[Zr,[ei],(g,[c])=>{const f=g.globals&&g.globals.isSupportedScript;return!f||f(c.evaluate(g))}],upcase:[ei,[ei],(g,[c])=>c.evaluate(g).toUpperCase()],downcase:[ei,[ei],(g,[c])=>c.evaluate(g).toLowerCase()],concat:[ei,sf(ni),(g,c)=>c.map(f=>va(f.evaluate(g))).join("")],"resolved-locale":[ei,[al],(g,[c])=>c.evaluate(g).resolvedLocale()],random:[On,[On,On,ni],(g,c)=>{const[f,_,A]=c.map(T=>T.evaluate(g));if(f>_||f===_)return f;let x;if(typeof A=="string")x=function(T){let B=0;if(T.length===0)return B;for(let U=0;U<T.length;U++)B=(B<<5)-B+T.charCodeAt(U),B|=0;return B}(A);else{if(typeof A!="number")throw new qs(`Invalid seed input: ${A}`);x=A}return f+Yu(x)()*(_-f)}]});class $p{constructor(c,f,_,A){this.expression=c,this._warningHistory={},this._evaluator=new Ip(_,A),this._defaultValue=f?function(x){return x.type==="color"&&(Wp(x.default)||Array.isArray(x.default))?new vr(0,0,0,0):x.type==="color"?vr.parse(x.default)||null:x.default===void 0?null:x.default}(f):null,this._enumValues=f&&f.type==="enum"?f.values:null}evaluateWithoutErrorHandling(c,f,_,A,x,T,B,U){return this._evaluator.globals=c,this._evaluator.feature=f,this._evaluator.featureState=_,this._evaluator.canonical=A||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=T,this._evaluator.featureTileCoord=B||null,this._evaluator.featureDistanceData=U||null,this.expression.evaluate(this._evaluator)}evaluate(c,f,_,A,x,T,B,U){this._evaluator.globals=c,this._evaluator.feature=f||null,this._evaluator.featureState=_||null,this._evaluator.canonical=A||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=T||null,this._evaluator.featureTileCoord=B||null,this._evaluator.featureDistanceData=U||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new qs(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${j.message}`)),this._defaultValue}}}function bd(g){return Array.isArray(g)&&g.length>0&&typeof g[0]=="string"&&g[0]in bu}function wd(g,c,f,_){const A=new zv(bu,[],c?function(T){const B={color:Us,string:ei,number:On,enum:ei,boolean:Zr,formatted:$a,resolvedImage:pu};return T.type==="array"?sa(B[T.value]||ni,T.length):B[T.type]}(c):void 0,void 0,void 0,f,_),x=A.parse(g,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?R1(new $p(x,c,f,_)):bo(A.errors)}class Dg{constructor(c,f,_){this.kind=c,this._styleExpression=f,this.isLightConstant=_,this.isStateDependent=c!=="constant"&&!Ml(f.expression),this.configDependencies=ul(f.expression)}evaluateWithoutErrorHandling(c,f,_,A,x,T){return this._styleExpression.evaluateWithoutErrorHandling(c,f,_,A,x,T)}evaluate(c,f,_,A,x,T){return this._styleExpression.evaluate(c,f,_,A,x,T)}}class fl{constructor(c,f,_,A,x){this.kind=c,this.zoomStops=_,this._styleExpression=f,this.isStateDependent=c!=="camera"&&!Ml(f.expression),this.isLightConstant=x,this.configDependencies=ul(f.expression),this.interpolationType=A}evaluateWithoutErrorHandling(c,f,_,A,x,T){return this._styleExpression.evaluateWithoutErrorHandling(c,f,_,A,x,T)}evaluate(c,f,_,A,x,T){return this._styleExpression.evaluate(c,f,_,A,x,T)}interpolationFactor(c,f,_){return this.interpolationType?hl.interpolationFactor(this.interpolationType,c,f,_):0}}function e_(g,c,f,_){if((g=wd(g,c,f,_)).result==="error")return g;const A=g.value.expression,x=Qh(A);if(!x&&!jp(c))return bo([new xs("","data expressions not supported")]);const T=ic(A,["zoom","pitch","distance-from-center"]);if(!T&&!Kv(c))return bo([new xs("","zoom expressions not supported")]);const B=ic(A,["measure-light"]);if(!B&&!Ig(c))return bo([new xs("","measure-light expression not supported")]);const U=c.expression&&c.expression.relaxZoomRestriction,j=qp(A);return j||T||U?j instanceof xs?bo([j]):j instanceof hl&&!Rg(c)?bo([new xs("",'"interpolate" expressions cannot be used with this property')]):R1(j?new fl(x?"camera":"composite",g.value,j.labels,j instanceof hl?j.interpolation:void 0,B):new Dg(x?"constant":"source",g.value,B)):bo([new xs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Sd{constructor(c,f){this._parameters=c,this._specification=f,hd(this,Jv(this._parameters,this._specification))}static deserialize(c){return new Sd(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function qp(g){let c=null;if(g instanceof Up)c=qp(g.result);else if(g instanceof zp){for(const f of g.args)if(c=qp(f),c)break}else(g instanceof _d||g instanceof hl)&&g.input instanceof Da&&g.input.name==="zoom"&&(c=g);return c instanceof xs||g.eachChild(f=>{const _=qp(f);_ instanceof xs?c=_:c&&_&&c!==_&&(c=new xs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}var Cl,t_,L1=function(){if(t_)return Cl;t_=1,Cl=c;var g=3;function c(f,_,A){var x=this.cells=[];if(f instanceof ArrayBuffer){this.arrayBuffer=f;var T=new Int32Array(this.arrayBuffer);f=T[0],this.d=(_=T[1])+2*(A=T[2]);for(var B=0;B<this.d*this.d;B++){var U=T[g+B],j=T[g+B+1];x.push(U===j?null:T.subarray(U,j))}var R=T[g+x.length+1];this.keys=T.subarray(T[g+x.length],R),this.bboxes=T.subarray(R),this.insert=this._insertReadonly}else{this.d=_+2*A;for(var N=0;N<this.d*this.d;N++)x.push([]);this.keys=[],this.bboxes=[]}this.n=_,this.extent=f,this.padding=A,this.scale=_/f,this.uid=0;var V=A/_*f;this.min=-V,this.max=f+V}return c.prototype.insert=function(f,_,A,x,T){this._forEachCell(_,A,x,T,this._insertCell,this.uid++),this.keys.push(f),this.bboxes.push(_),this.bboxes.push(A),this.bboxes.push(x),this.bboxes.push(T)},c.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},c.prototype._insertCell=function(f,_,A,x,T,B){this.cells[T].push(B)},c.prototype.query=function(f,_,A,x,T){var B=this.min,U=this.max;if(f<=B&&_<=B&&U<=A&&U<=x&&!T)return Array.prototype.slice.call(this.keys);var j=[];return this._forEachCell(f,_,A,x,this._queryCell,j,{},T),j},c.prototype._queryCell=function(f,_,A,x,T,B,U,j){var R=this.cells[T];if(R!==null)for(var N=this.keys,V=this.bboxes,z=0;z<R.length;z++){var G=R[z];if(U[G]===void 0){var X=4*G;(j?j(V[X+0],V[X+1],V[X+2],V[X+3]):f<=V[X+2]&&_<=V[X+3]&&A>=V[X+0]&&x>=V[X+1])?(U[G]=!0,B.push(N[G])):U[G]=!1}}},c.prototype._forEachCell=function(f,_,A,x,T,B,U,j){for(var R=this._convertToCellCoord(f),N=this._convertToCellCoord(_),V=this._convertToCellCoord(A),z=this._convertToCellCoord(x),G=R;G<=V;G++)for(var X=N;X<=z;X++){var K=this.d*X+G;if((!j||j(this._convertFromCellCoord(G),this._convertFromCellCoord(X),this._convertFromCellCoord(G+1),this._convertFromCellCoord(X+1)))&&T.call(this,f,_,A,x,K,B,U,j))return}},c.prototype._convertFromCellCoord=function(f){return(f-this.padding)/this.scale},c.prototype._convertToCellCoord=function(f){return Math.max(0,Math.min(this.d-1,Math.floor(f*this.scale)+this.padding))},c.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var f=this.cells,_=g+this.cells.length+1+1,A=0,x=0;x<this.cells.length;x++)A+=this.cells[x].length;var T=new Int32Array(_+A+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;for(var B=_,U=0;U<f.length;U++){var j=f[U];T[g+U]=B,T.set(j,B),B+=j.length}return T[g+f.length]=B,T.set(this.keys,B),T[g+f.length+1]=B+=this.keys.length,T.set(this.bboxes,B),B+=this.bboxes.length,T.buffer},Cl}(),Uc=h(L1);const El={};function Fn(g,c,f={}){Object.defineProperty(g,"_classRegistryKey",{value:c,writable:!1}),El[c]={klass:g,omit:f.omit||[]}}Fn(Object,"Object"),Uc.serialize=function(g,c){const f=g.toArrayBuffer();return c&&c.add(f),{buffer:f}},Uc.deserialize=function(g){return new Uc(g.buffer)},Object.defineProperty(Uc,"name",{value:"Grid"}),Fn(Uc,"Grid"),Fn(vr,"Color"),Fn(Error,"Error"),Fn(Lo,"Formatted"),Fn(Gs,"FormattedSection"),Fn(qr,"AJAXError"),Fn(qo,"ResolvedImage"),Fn(Sd,"StylePropertyFunction"),Fn($p,"StyleExpression",{omit:["_evaluator"]}),Fn(fl,"ZoomDependentExpression"),Fn(Dg,"ZoomConstantExpression"),Fn(Da,"CompoundExpression",{omit:["_evaluate"]});for(const g in bu)El[bu[g]._classRegistryKey]||Fn(bu[g],`Expression${g}`);function sr(g){return g&&typeof ArrayBuffer<"u"&&(g instanceof ArrayBuffer||g.constructor&&g.constructor.name==="ArrayBuffer")}function Zp(g){return self.ImageBitmap&&g instanceof ImageBitmap}function ya(g,c){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp)return g;if(sr(g)||Zp(g))return c&&c.add(g),g;if(ArrayBuffer.isView(g)){const f=g;return c&&c.add(f.buffer),f}if(g instanceof ImageData)return c&&c.add(g.data.buffer),g;if(Array.isArray(g)){const f=[];for(const _ of g)f.push(ya(_,c));return f}if(g instanceof Map){const f={$name:"Map"};for(const[_,A]of g.entries())f[_]=ya(A);return f}if(g instanceof Set){const f={$name:"Set"};let _=0;for(const A of g.values())f[++_]=ya(A);return f}if(typeof g=="object"){const f=g.constructor,_=f._classRegistryKey;if(!_)throw new Error(`can't serialize object of unregistered class ${_}`);const A=f.serialize?f.serialize(g,c):{};if(!f.serialize){for(const x in g)g.hasOwnProperty(x)&&(El[_].omit.indexOf(x)>=0||(A[x]=ya(g[x],c)));g instanceof Error&&(A.message=g.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return _!=="Object"&&(A.$name=_),A}throw new Error("can't serialize object of type "+typeof g)}function Ku(g){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp||sr(g)||Zp(g)||ArrayBuffer.isView(g)||g instanceof ImageData)return g;if(Array.isArray(g))return g.map(Ku);if(typeof g=="object"){const c=g.$name||"Object";if(c==="Map"){const A=new Map;for(const x of Object.keys(g))x!=="$name"&&A.set(x,Ku(g[x]));return A}if(c==="Set"){const A=new Set;for(const x of Object.keys(g))x!=="$name"&&A.add(Ku(g[x]));return A}const{klass:f}=El[c];if(!f)throw new Error(`can't deserialize unregistered class ${c}`);if(f.deserialize)return f.deserialize(g);const _=Object.create(f.prototype);for(const A of Object.keys(g))A!=="$name"&&(_[A]=Ku(g[A]));return _}throw new Error("can't deserialize object of type "+typeof g)}const Yn={"Latin-1 Supplement":g=>g>=128&&g<=255,Arabic:g=>g>=1536&&g<=1791,"Arabic Supplement":g=>g>=1872&&g<=1919,"Arabic Extended-A":g=>g>=2208&&g<=2303,"Hangul Jamo":g=>g>=4352&&g<=4607,"Unified Canadian Aboriginal Syllabics":g=>g>=5120&&g<=5759,Khmer:g=>g>=6016&&g<=6143,"Unified Canadian Aboriginal Syllabics Extended":g=>g>=6320&&g<=6399,"General Punctuation":g=>g>=8192&&g<=8303,"Letterlike Symbols":g=>g>=8448&&g<=8527,"Number Forms":g=>g>=8528&&g<=8591,"Miscellaneous Technical":g=>g>=8960&&g<=9215,"Control Pictures":g=>g>=9216&&g<=9279,"Optical Character Recognition":g=>g>=9280&&g<=9311,"Enclosed Alphanumerics":g=>g>=9312&&g<=9471,"Geometric Shapes":g=>g>=9632&&g<=9727,"Miscellaneous Symbols":g=>g>=9728&&g<=9983,"Miscellaneous Symbols and Arrows":g=>g>=11008&&g<=11263,"CJK Radicals Supplement":g=>g>=11904&&g<=12031,"Kangxi Radicals":g=>g>=12032&&g<=12255,"Ideographic Description Characters":g=>g>=12272&&g<=12287,"CJK Symbols and Punctuation":g=>g>=12288&&g<=12351,Hiragana:g=>g>=12352&&g<=12447,Katakana:g=>g>=12448&&g<=12543,Bopomofo:g=>g>=12544&&g<=12591,"Hangul Compatibility Jamo":g=>g>=12592&&g<=12687,Kanbun:g=>g>=12688&&g<=12703,"Bopomofo Extended":g=>g>=12704&&g<=12735,"CJK Strokes":g=>g>=12736&&g<=12783,"Katakana Phonetic Extensions":g=>g>=12784&&g<=12799,"Enclosed CJK Letters and Months":g=>g>=12800&&g<=13055,"CJK Compatibility":g=>g>=13056&&g<=13311,"CJK Unified Ideographs Extension A":g=>g>=13312&&g<=19903,"Yijing Hexagram Symbols":g=>g>=19904&&g<=19967,"CJK Unified Ideographs":g=>g>=19968&&g<=40959,"Yi Syllables":g=>g>=40960&&g<=42127,"Yi Radicals":g=>g>=42128&&g<=42191,"Hangul Jamo Extended-A":g=>g>=43360&&g<=43391,"Hangul Syllables":g=>g>=44032&&g<=55215,"Hangul Jamo Extended-B":g=>g>=55216&&g<=55295,"Private Use Area":g=>g>=57344&&g<=63743,"CJK Compatibility Ideographs":g=>g>=63744&&g<=64255,"Arabic Presentation Forms-A":g=>g>=64336&&g<=65023,"Vertical Forms":g=>g>=65040&&g<=65055,"CJK Compatibility Forms":g=>g>=65072&&g<=65103,"Small Form Variants":g=>g>=65104&&g<=65135,"Arabic Presentation Forms-B":g=>g>=65136&&g<=65279,"Halfwidth and Fullwidth Forms":g=>g>=65280&&g<=65519,"CJK Unified Ideographs Extension B":g=>g>=131072&&g<=173791};function Gc(g){for(const c of g)if(Kp(c.charCodeAt(0)))return!0;return!1}function Yp(g){for(const c of g)if(!Ad(c.charCodeAt(0)))return!1;return!0}function Ad(g){return!(Yn.Arabic(g)||Yn["Arabic Supplement"](g)||Yn["Arabic Extended-A"](g)||Yn["Arabic Presentation Forms-A"](g)||Yn["Arabic Presentation Forms-B"](g))}function Kp(g){return!(g!==746&&g!==747&&(g<4352||!(Yn["Bopomofo Extended"](g)||Yn.Bopomofo(g)||Yn["CJK Compatibility Forms"](g)&&!(g>=65097&&g<=65103)||Yn["CJK Compatibility Ideographs"](g)||Yn["CJK Compatibility"](g)||Yn["CJK Radicals Supplement"](g)||Yn["CJK Strokes"](g)||!(!Yn["CJK Symbols and Punctuation"](g)||g>=12296&&g<=12305||g>=12308&&g<=12319||g===12336)||Yn["CJK Unified Ideographs Extension A"](g)||Yn["CJK Unified Ideographs"](g)||Yn["Enclosed CJK Letters and Months"](g)||Yn["Hangul Compatibility Jamo"](g)||Yn["Hangul Jamo Extended-A"](g)||Yn["Hangul Jamo Extended-B"](g)||Yn["Hangul Jamo"](g)||Yn["Hangul Syllables"](g)||Yn.Hiragana(g)||Yn["Ideographic Description Characters"](g)||Yn.Kanbun(g)||Yn["Kangxi Radicals"](g)||Yn["Katakana Phonetic Extensions"](g)||Yn.Katakana(g)&&g!==12540||!(!Yn["Halfwidth and Fullwidth Forms"](g)||g===65288||g===65289||g===65293||g>=65306&&g<=65310||g===65339||g===65341||g===65343||g>=65371&&g<=65503||g===65507||g>=65512&&g<=65519)||!(!Yn["Small Form Variants"](g)||g>=65112&&g<=65118||g>=65123&&g<=65126)||Yn["Unified Canadian Aboriginal Syllabics"](g)||Yn["Unified Canadian Aboriginal Syllabics Extended"](g)||Yn["Vertical Forms"](g)||Yn["Yijing Hexagram Symbols"](g)||Yn["Yi Syllables"](g)||Yn["Yi Radicals"](g))))}function Td(g){return!(Kp(g)||function(c){return!!(Yn["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Yn["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Yn["Letterlike Symbols"](c)||Yn["Number Forms"](c)||Yn["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Yn["Control Pictures"](c)&&c!==9251||Yn["Optical Character Recognition"](c)||Yn["Enclosed Alphanumerics"](c)||Yn["Geometric Shapes"](c)||Yn["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Yn["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Yn["CJK Symbols and Punctuation"](c)||Yn.Katakana(c)||Yn["Private Use Area"](c)||Yn["CJK Compatibility Forms"](c)||Yn["Small Form Variants"](c)||Yn["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(g))}function Bg(g){return g>=1424&&g<=2303||Yn["Arabic Presentation Forms-A"](g)||Yn["Arabic Presentation Forms-B"](g)}function D1(g,c){return!(!c&&Bg(g)||g>=2304&&g<=3583||g>=3840&&g<=4255||Yn.Khmer(g))}function B1(g){for(const c of g)if(Bg(c.charCodeAt(0)))return!0;return!1}const Md="deferred",af="loading",Cd="loaded";let lf=null,lo="unavailable",oc=null;const k1=function(g){g&&typeof g=="string"&&g.indexOf("NetworkError")>-1&&(lo="error"),lf&&lf(g)};function n_(){kg.fire(new Kl("pluginStateChange",{pluginStatus:lo,pluginURL:oc}))}const kg=new Vu,Og=function(){return lo},Fg=function(){if(lo!==Md||!oc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");lo=af,n_(),oc&&Ls({url:oc},g=>{g?k1(g):(lo=Cd,n_())})},Fa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>lo===Cd||Fa.applyArabicShaping!=null,isLoading:()=>lo===af,setState(g){lo=g.pluginStatus,oc=g.pluginURL},isParsed:()=>Fa.applyArabicShaping!=null&&Fa.processBidirectionalText!=null&&Fa.processStyledBidirectionalText!=null,getPluginURL:()=>oc};class ds{constructor(c,f){this.zoom=c,f?(this.now=f.now,this.fadeDuration=f.fadeDuration,this.transition=f.transition,this.pitch=f.pitch,this.brightness=f.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(c){return function(f,_){for(const A of f)if(!D1(A.charCodeAt(0),_))return!1;return!0}(c,Fa.isLoaded())}}class cf{constructor(c,f,_,A){this.property=c,this.value=f,this.expression=function(x,T,B,U){if(Wp(x))return new Sd(x,T);if(bd(x)||Array.isArray(x)&&x.length>0){const j=e_(x,T,B,U);if(j.result==="error")throw new Error(j.value.map(R=>`${R.key}: ${R.message}`).join(", "));return j.value}{let j=x;return typeof x=="string"&&T.type==="color"&&(j=vr.parse(x)),{kind:"constant",configDependencies:new Set,evaluate:()=>j}}}(f===void 0?c.specification.default:f,c.specification,_,A)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,f,_){return this.property.possiblyEvaluate(this,c,f,_)}}class Ed{constructor(c,f,_){this.property=c,this.value=new cf(c,void 0,f,_)}transitioned(c,f){return new Qp(this.property,this.value,f,Sr({},c.transition,this.transition),c.now)}untransitioned(){return new Qp(this.property,this.value,null,{},0)}}class Jp{constructor(c,f,_){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues),this._scope=f,this._options=_,this.configDependencies=new Set}getValue(c){return yi(this._values[c].value.value)}setValue(c,f){this._values.hasOwnProperty(c)||(this._values[c]=new Ed(this._values[c].property,this._scope,this._options)),this._values[c].value=new cf(this._values[c].property,f===null?void 0:yi(f),this._scope,this._options),this._values[c].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[c].value.expression.configDependencies]))}setTransitionOrValue(c,f){f&&(this._options=f);const _=this._properties.properties;if(c)for(const A in c){const x=c[A];if(or(A,"-transition")){const T=A.slice(0,-11);_[T]&&this.setTransition(T,x)}else _.hasOwnProperty(A)&&this.setValue(A,x)}}getTransition(c){return yi(this._values[c].transition)}setTransition(c,f){this._values.hasOwnProperty(c)||(this._values[c]=new Ed(this._values[c].property)),this._values[c].transition=yi(f)||void 0}serialize(){const c={};for(const f of Object.keys(this._values)){const _=this.getValue(f);_!==void 0&&(c[f]=_);const A=this.getTransition(f);A!==void 0&&(c[`${f}-transition`]=A)}return c}transitioned(c,f){const _=new Id(this._properties);for(const A of Object.keys(this._values))_._values[A]=this._values[A].transitioned(c,f._values[A]);return _}untransitioned(){const c=new Id(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].untransitioned();return c}}class Qp{constructor(c,f,_,A,x){const T=A.delay||0,B=A.duration||0;x=x||0,this.property=c,this.value=f,this.begin=x+T,this.end=this.begin+B,c.specification.transition&&(A.delay||A.duration)&&(this.prior=_)}possiblyEvaluate(c,f,_){const A=c.now||0,x=this.value.possiblyEvaluate(c,f,_),T=this.prior;if(T){if(A>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(A<this.begin)return T.possiblyEvaluate(c,f,_);{const B=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(c,f,_),x,$t(B))}}return x}}class Id{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,f,_){const A=new Qu(this._properties);for(const x of Object.keys(this._values))A._values[x]=this._values[x].possiblyEvaluate(c,f,_);return A}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class r_{constructor(c,f,_){this._properties=c,this._values=Object.create(c.defaultPropertyValues),this._scope=f,this._options=_,this.configDependencies=new Set}getValue(c){return yi(this._values[c].value)}setValue(c,f){this._values[c]=new cf(this._values[c].property,f===null?void 0:yi(f),this._scope,this._options),this._values[c].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[c].expression.configDependencies]))}serialize(){const c={};for(const f of Object.keys(this._values)){const _=this.getValue(f);_!==void 0&&(c[f]=_)}return c}possiblyEvaluate(c,f,_){const A=new Qu(this._properties);for(const x of Object.keys(this._values))A._values[x]=this._values[x].possiblyEvaluate(c,f,_);return A}}class Ju{constructor(c,f,_){this.property=c,this.value=f,this.parameters=_}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,f,_,A){return this.property.evaluate(this.value,this.parameters,c,f,_,A)}}class Qu{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class gn{constructor(c){this.specification=c}possiblyEvaluate(c,f){return c.expression.evaluate(f)}interpolate(c,f,_){const A=Vh[this.specification.type];return A?A(c,f,_):c}}class Kn{constructor(c,f){this.specification=c,this.overrides=f}possiblyEvaluate(c,f,_,A){return new Ju(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(f,null,{},_,A)}:c.expression,f)}interpolate(c,f,_){if(c.value.kind!=="constant"||f.value.kind!=="constant")return c;if(c.value.value===void 0||f.value.value===void 0)return new Ju(this,{kind:"constant",value:void 0},c.parameters);const A=Vh[this.specification.type];return A?new Ju(this,{kind:"constant",value:A(c.value.value,f.value.value,_)},c.parameters):c}evaluate(c,f,_,A,x,T){return c.kind==="constant"?c.value:c.evaluate(f,_,A,x,T)}}class ac{constructor(c){this.specification=c}possiblyEvaluate(c,f,_,A){return!!c.expression.evaluate(f,null,{},_,A)}interpolate(){return!1}}class ji{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const f=new ds(0,{});for(const _ in c){const A=c[_];A.specification.overridable&&this.overridableProperties.push(_);const x=this.defaultPropertyValues[_]=new cf(A,void 0),T=this.defaultTransitionablePropertyValues[_]=new Ed(A);this.defaultTransitioningPropertyValues[_]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[_]=x.possiblyEvaluate(f)}}}Fn(Kn,"DataDrivenProperty"),Fn(gn,"DataConstantProperty"),Fn(ac,"ColorRampProperty");var At=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Bs(g){return g instanceof Number||g instanceof String||g instanceof Boolean?g.valueOf():g}function di(g){if(Array.isArray(g))return g.map(di);if(g instanceof Object&&!(g instanceof Number||g instanceof String||g instanceof Boolean)){const c={};for(const f in g)c[f]=di(g[f]);return c}return Bs(g)}function Ks(g){if(g===!0||g===!1)return!0;if(!Array.isArray(g)||g.length===0)return!1;switch(g[0]){case"has":return g.length>=2&&g[1]!=="$id"&&g[1]!=="$type";case"in":return g.length>=3&&(typeof g[1]!="string"||Array.isArray(g[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return g.length!==3||Array.isArray(g[1])||Array.isArray(g[2]);case"any":case"all":for(const c of g.slice(1))if(!Ks(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}function rs(g,c="",f=null,_="fill"){if(g==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ks(g)||(g=hf(g));const A=g;let x=!0;try{x=function(N){if(!lc(N))return N;let V=di(N);return ko(V),V=Bo(V),V}(A)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(A,null,2)}
        `)}const T=At[`filter_${_}`],B=wd(x,T,c,f);let U=null;if(B.result==="error")throw new Error(B.value.map(N=>`${N.key}: ${N.message}`).join(", "));U=(N,V,z)=>B.value.evaluate(N,V,{},z);let j=null,R=null;if(x!==A){const N=wd(A,T,c,f);if(N.result==="error")throw new Error(N.value.map(V=>`${V.key}: ${V.message}`).join(", "));j=(V,z,G,X,K)=>N.value.evaluate(V,z,{},G,void 0,void 0,X,K),R=!Qh(N.value.expression)}return{filter:U,dynamicFilter:j||void 0,needGeometry:uf(x),needFeature:!!R}}function Bo(g){if(!Array.isArray(g))return g;const c=function(f){if(Oo.has(f[0])){for(let _=1;_<f.length;_++)if(lc(f[_]))return!0}return f}(g);return c===!0?c:c.map(f=>Bo(f))}function ko(g){let c=!1;const f=[];if(g[0]==="case"){for(let _=1;_<g.length-1;_+=2)c=c||lc(g[_]),f.push(g[_+1]);f.push(g[g.length-1])}else if(g[0]==="match"){c=c||lc(g[1]);for(let _=2;_<g.length-1;_+=2)f.push(g[_+1]);f.push(g[g.length-1])}else if(g[0]==="step"){c=c||lc(g[1]);for(let _=1;_<g.length-1;_+=2)f.push(g[_+1])}c&&(g.length=0,g.push("any",...f));for(let _=1;_<g.length;_++)ko(g[_])}function lc(g){if(!Array.isArray(g))return!1;if((c=g[0])==="pitch"||c==="distance-from-center")return!0;var c;for(let f=1;f<g.length;f++)if(lc(g[f]))return!0;return!1}const Oo=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function em(g,c){return g<c?-1:g>c?1:0}function uf(g){if(!Array.isArray(g))return!1;if(g[0]==="within"||g[0]==="distance")return!0;for(let c=1;c<g.length;c++)if(uf(g[c]))return!0;return!1}function hf(g){if(!g)return!0;const c=g[0];return g.length<=1?c!=="any":c==="=="?Rd(g[1],g[2],"=="):c==="!="?ff(Rd(g[1],g[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Rd(g[1],g[2],c):c==="any"?(f=g.slice(1),["any"].concat(f.map(hf))):c==="all"?["all"].concat(g.slice(1).map(hf)):c==="none"?["all"].concat(g.slice(1).map(hf).map(ff)):c==="in"?eh(g[1],g.slice(2)):c==="!in"?ff(eh(g[1],g.slice(2))):c==="has"?Yo(g[1]):c!=="!has"||ff(Yo(g[1]));var f}function Rd(g,c,f){switch(g){case"$type":return[`filter-type-${f}`,c];case"$id":return[`filter-id-${f}`,c];default:return[`filter-${f}`,g,c]}}function eh(g,c){if(c.length===0)return!1;switch(g){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(f=>typeof f!=typeof c[0])?["filter-in-large",g,["literal",c.sort(em)]]:["filter-in-small",g,["literal",c]]}}function Yo(g){switch(g){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",g]}}function ff(g){return["!",g]}const th="";function df(g,c){return c?`${g}${th}${c}`:g}const Ja="-transition",i_=new Set(["fill","line","background","hillshade","raster"]);class Hs extends Vu{constructor(c,f,_,A,x){if(super(),this.id=c.id,this.fqid=df(this.id,_),this.type=c.type,this.scope=_,this.lut=A,this.options=x,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&c.type!=="sky"&&c.type!=="slot"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),c.slot&&(this.slot=c.slot),f.layout&&(this._unevaluatedLayout=new r_(f.layout,this.scope,x),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),f.paint)){this._transitionablePaint=new Jp(f.paint,this.scope,x);for(const T in c.paint)this.setPaintProperty(T,c.paint[T]);for(const T in c.layout)this.setLayoutProperty(T,c.layout[T]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qu(f.paint)}}onAdd(c){}onRemove(c){}isDraped(c){return!this.is3D()&&i_.has(this.type)}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,f){if(this.type==="custom"&&c==="visibility")return void(this.visibility=f);const _=this._unevaluatedLayout;_._properties.properties[c]&&(_.setValue(c,f),this.configDependencies=new Set([...this.configDependencies,..._.configDependencies]),c==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(c){return or(c,Ja)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,f){const _=this._transitionablePaint,A=_._properties.properties;if(or(c,Ja)){const N=c.slice(0,-11);return A[N]&&_.setTransition(N,f||void 0),!1}if(!A[c])return!1;const x=_._values[c],T=x.value.isDataDriven(),B=x.value;_.setValue(c,f),this.configDependencies=new Set([...this.configDependencies,..._.configDependencies]),this._handleSpecialPaintPropertyUpdate(c);const U=_._values[c].value,j=U.isDataDriven(),R=or(c,"pattern")||c==="line-dasharray";return j||T||R||this._handleOverridablePaintPropertyUpdate(c,B,U)}_handleSpecialPaintPropertyUpdate(c){}getProgramIds(){return null}getDefaultProgramParams(c,f,_){return null}_handleOverridablePaintPropertyUpdate(c,f,_){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,f){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,f)}serialize(){return Hr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(c,f)=>!(c===void 0||f==="layout"&&!Object.keys(c).length||f==="paint"&&!Object.keys(c).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const c in this.paint._values){const f=this.paint.get(c);if(f instanceof Ju&&jp(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}compileFilter(c){this._filterCompiled||(this._featureFilter=rs(this.filter,this.scope,c),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(c){this._stats&&(c.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(c){}queryIntersectsFeature(c,f,_,A,x,T,B,U,j){}queryIntersectsMatchingFeature(c,f,_,A){}}const Ng={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Il{constructor(c,f){this._structArray=c,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Oi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,f){return c._trim(),f&&(c.isTransferred=!0,f.add(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const f=Object.create(this.prototype);return f.arrayBuffer=c.arrayBuffer,f.length=c.length,f.capacity=c.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...c){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...c){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Qr(g,c=1){let f=0,_=0;return{members:g.map(A=>{const x=Ng[A.type].BYTES_PER_ELEMENT,T=f=zg(f,Math.max(c,x)),B=A.components||1;return _=Math.max(_,x),f+=x*B,{name:A.name,type:A.type,components:B,offset:T}}),size:zg(f,Math.max(_,c)),alignment:c}}function zg(g,c){return Math.ceil(g/c)*c}class cc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f){const _=this.length;return this.resize(_+1),this.emplace(_,c,f)}emplace(c,f,_){const A=2*c;return this.int16[A+0]=f,this.int16[A+1]=_,c}}cc.prototype.bytesPerElement=4,Fn(cc,"StructArrayLayout2i4");class pf extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,f,_)}emplace(c,f,_,A){const x=3*c;return this.int16[x+0]=f,this.int16[x+1]=_,this.int16[x+2]=A,c}}pf.prototype.bytesPerElement=6,Fn(pf,"StructArrayLayout3i6");class Js extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,f,_,A)}emplace(c,f,_,A,x){const T=4*c;return this.int16[T+0]=f,this.int16[T+1]=_,this.int16[T+2]=A,this.int16[T+3]=x,c}}Js.prototype.bytesPerElement=8,Fn(Js,"StructArrayLayout4i8");class uc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,f,_,A,x)}emplace(c,f,_,A,x,T){const B=5*c;return this.int16[B+0]=f,this.int16[B+1]=_,this.int16[B+2]=A,this.int16[B+3]=x,this.int16[B+4]=T,c}}uc.prototype.bytesPerElement=10,Fn(uc,"StructArrayLayout5i10");class Qa extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,f,_,A,x,T,B)}emplace(c,f,_,A,x,T,B,U){const j=6*c,R=12*c,N=3*c;return this.int16[j+0]=f,this.int16[j+1]=_,this.uint8[R+4]=A,this.uint8[R+5]=x,this.uint8[R+6]=T,this.uint8[R+7]=B,this.float32[N+2]=U,c}}Qa.prototype.bytesPerElement=12,Fn(Qa,"StructArrayLayout2i4ub1f12");class Rl extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,f,_,A)}emplace(c,f,_,A,x){const T=4*c;return this.float32[T+0]=f,this.float32[T+1]=_,this.float32[T+2]=A,this.float32[T+3]=x,c}}Rl.prototype.bytesPerElement=16,Fn(Rl,"StructArrayLayout4f16");class co extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,f,_)}emplace(c,f,_,A){const x=3*c;return this.float32[x+0]=f,this.float32[x+1]=_,this.float32[x+2]=A,c}}co.prototype.bytesPerElement=12,Fn(co,"StructArrayLayout3f12");class Vc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,f,_,A,x)}emplace(c,f,_,A,x,T){const B=6*c,U=3*c;return this.uint16[B+0]=f,this.uint16[B+1]=_,this.uint16[B+2]=A,this.uint16[B+3]=x,this.float32[U+2]=T,c}}Vc.prototype.bytesPerElement=12,Fn(Vc,"StructArrayLayout4ui1f12");class wu extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,f,_,A)}emplace(c,f,_,A,x){const T=4*c;return this.uint16[T+0]=f,this.uint16[T+1]=_,this.uint16[T+2]=A,this.uint16[T+3]=x,c}}wu.prototype.bytesPerElement=8,Fn(wu,"StructArrayLayout4ui8");class Pd extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,f,_,A,x,T)}emplace(c,f,_,A,x,T,B){const U=6*c;return this.int16[U+0]=f,this.int16[U+1]=_,this.int16[U+2]=A,this.int16[U+3]=x,this.int16[U+4]=T,this.int16[U+5]=B,c}}Pd.prototype.bytesPerElement=12,Fn(Pd,"StructArrayLayout6i12");class s_ extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B,U,j,R,N,V){const z=this.length;return this.resize(z+1),this.emplace(z,c,f,_,A,x,T,B,U,j,R,N,V)}emplace(c,f,_,A,x,T,B,U,j,R,N,V,z){const G=12*c;return this.int16[G+0]=f,this.int16[G+1]=_,this.int16[G+2]=A,this.int16[G+3]=x,this.uint16[G+4]=T,this.uint16[G+5]=B,this.uint16[G+6]=U,this.uint16[G+7]=j,this.int16[G+8]=R,this.int16[G+9]=N,this.int16[G+10]=V,this.int16[G+11]=z,c}}s_.prototype.bytesPerElement=24,Fn(s_,"StructArrayLayout4i4ui4i24");class Hc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,f,_,A,x,T)}emplace(c,f,_,A,x,T,B){const U=10*c,j=5*c;return this.int16[U+0]=f,this.int16[U+1]=_,this.int16[U+2]=A,this.float32[j+2]=x,this.float32[j+3]=T,this.float32[j+4]=B,c}}Hc.prototype.bytesPerElement=20,Fn(Hc,"StructArrayLayout3i3f20");class Ug extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.uint32[1*c+0]=f,c}}Ug.prototype.bytesPerElement=4,Fn(Ug,"StructArrayLayout1ul4");class Su extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f){const _=this.length;return this.resize(_+1),this.emplace(_,c,f)}emplace(c,f,_){const A=2*c;return this.uint16[A+0]=f,this.uint16[A+1]=_,c}}Su.prototype.bytesPerElement=4,Fn(Su,"StructArrayLayout2ui4");class nh extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B,U,j,R,N,V,z){const G=this.length;return this.resize(G+1),this.emplace(G,c,f,_,A,x,T,B,U,j,R,N,V,z)}emplace(c,f,_,A,x,T,B,U,j,R,N,V,z,G){const X=20*c,K=10*c;return this.int16[X+0]=f,this.int16[X+1]=_,this.int16[X+2]=A,this.int16[X+3]=x,this.int16[X+4]=T,this.float32[K+3]=B,this.float32[K+4]=U,this.float32[K+5]=j,this.float32[K+6]=R,this.int16[X+14]=N,this.uint32[K+8]=V,this.uint16[X+18]=z,this.uint16[X+19]=G,c}}nh.prototype.bytesPerElement=40,Fn(nh,"StructArrayLayout5i4f1i1ul2ui40");class dl extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,f,_,A,x,T,B)}emplace(c,f,_,A,x,T,B,U){const j=8*c;return this.int16[j+0]=f,this.int16[j+1]=_,this.int16[j+2]=A,this.int16[j+4]=x,this.int16[j+5]=T,this.int16[j+6]=B,this.int16[j+7]=U,c}}dl.prototype.bytesPerElement=16,Fn(dl,"StructArrayLayout3i2i2i16");class xa extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,f,_,A,x)}emplace(c,f,_,A,x,T){const B=4*c,U=8*c;return this.float32[B+0]=f,this.float32[B+1]=_,this.float32[B+2]=A,this.int16[U+6]=x,this.int16[U+7]=T,c}}xa.prototype.bytesPerElement=16,Fn(xa,"StructArrayLayout2f1f2i16");class mf extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,f,_,A,x,T)}emplace(c,f,_,A,x,T,B){const U=20*c,j=5*c;return this.uint8[U+0]=f,this.uint8[U+1]=_,this.float32[j+1]=A,this.float32[j+2]=x,this.float32[j+3]=T,this.float32[j+4]=B,c}}mf.prototype.bytesPerElement=20,Fn(mf,"StructArrayLayout2ub4f20");class wo extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,f,_)}emplace(c,f,_,A){const x=3*c;return this.uint16[x+0]=f,this.uint16[x+1]=_,this.uint16[x+2]=A,c}}wo.prototype.bytesPerElement=6,Fn(wo,"StructArrayLayout3ui6");class Ld extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de){const ge=this.length;return this.resize(ge+1),this.emplace(ge,c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de)}emplace(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de,ge){const Me=30*c,Be=15*c,Oe=60*c;return this.int16[Me+0]=f,this.int16[Me+1]=_,this.int16[Me+2]=A,this.float32[Be+2]=x,this.float32[Be+3]=T,this.uint16[Me+8]=B,this.uint16[Me+9]=U,this.uint32[Be+5]=j,this.uint32[Be+6]=R,this.uint32[Be+7]=N,this.uint16[Me+16]=V,this.uint16[Me+17]=z,this.uint16[Me+18]=G,this.float32[Be+10]=X,this.float32[Be+11]=K,this.uint8[Oe+48]=te,this.uint8[Oe+49]=ce,this.uint8[Oe+50]=he,this.uint32[Be+13]=ne,this.int16[Me+28]=de,this.uint8[Oe+58]=ge,c}}Ld.prototype.bytesPerElement=60,Fn(Ld,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class o_ extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct,ht,ft){const mt=this.length;return this.resize(mt+1),this.emplace(mt,c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct,ht,ft)}emplace(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te,ce,he,ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct,ht,ft,mt){const Et=20*c,vt=40*c,Ut=80*c;return this.float32[Et+0]=f,this.float32[Et+1]=_,this.int16[vt+4]=A,this.int16[vt+5]=x,this.int16[vt+6]=T,this.int16[vt+7]=B,this.int16[vt+8]=U,this.int16[vt+9]=j,this.int16[vt+10]=R,this.int16[vt+11]=N,this.int16[vt+12]=V,this.uint16[vt+13]=z,this.uint16[vt+14]=G,this.uint16[vt+15]=X,this.uint16[vt+16]=K,this.uint16[vt+17]=te,this.uint16[vt+18]=ce,this.uint16[vt+19]=he,this.uint16[vt+20]=ne,this.uint16[vt+21]=de,this.uint16[vt+22]=ge,this.uint16[vt+23]=Me,this.uint16[vt+24]=Be,this.uint16[vt+25]=Oe,this.uint16[vt+26]=Re,this.uint16[vt+27]=Ye,this.uint32[Et+14]=ze,this.float32[Et+15]=Qe,this.float32[Et+16]=ct,this.float32[Et+17]=ht,this.float32[Et+18]=ft,this.uint8[Ut+76]=mt,c}}o_.prototype.bytesPerElement=80,Fn(o_,"StructArrayLayout2f9i15ui1ul4f1ub80");class Dd extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.float32[1*c+0]=f,c}}Dd.prototype.bytesPerElement=4,Fn(Dd,"StructArrayLayout1f4");class jc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,f,_,A,x)}emplace(c,f,_,A,x,T){const B=5*c;return this.float32[B+0]=f,this.float32[B+1]=_,this.float32[B+2]=A,this.float32[B+3]=x,this.float32[B+4]=T,c}}jc.prototype.bytesPerElement=20,Fn(jc,"StructArrayLayout5f20");class Gg extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,f,_,A,x,T,B)}emplace(c,f,_,A,x,T,B,U){const j=7*c;return this.float32[j+0]=f,this.float32[j+1]=_,this.float32[j+2]=A,this.float32[j+3]=x,this.float32[j+4]=T,this.float32[j+5]=B,this.float32[j+6]=U,c}}Gg.prototype.bytesPerElement=28,Fn(Gg,"StructArrayLayout7f28");class hc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,f,_,A)}emplace(c,f,_,A,x){const T=6*c;return this.uint32[3*c+0]=f,this.uint16[T+2]=_,this.uint16[T+3]=A,this.uint16[T+4]=x,c}}hc.prototype.bytesPerElement=12,Fn(hc,"StructArrayLayout1ul3ui12");class a_ extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.uint16[1*c+0]=f,c}}a_.prototype.bytesPerElement=2,Fn(a_,"StructArrayLayout1ui2");class fc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f){const _=this.length;return this.resize(_+1),this.emplace(_,c,f)}emplace(c,f,_){const A=2*c;return this.float32[A+0]=f,this.float32[A+1]=_,c}}fc.prototype.bytesPerElement=8,Fn(fc,"StructArrayLayout2f8");class Bd extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K){const te=this.length;return this.resize(te+1),this.emplace(te,c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K)}emplace(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te){const ce=16*c;return this.float32[ce+0]=f,this.float32[ce+1]=_,this.float32[ce+2]=A,this.float32[ce+3]=x,this.float32[ce+4]=T,this.float32[ce+5]=B,this.float32[ce+6]=U,this.float32[ce+7]=j,this.float32[ce+8]=R,this.float32[ce+9]=N,this.float32[ce+10]=V,this.float32[ce+11]=z,this.float32[ce+12]=G,this.float32[ce+13]=X,this.float32[ce+14]=K,this.float32[ce+15]=te,c}}Bd.prototype.bytesPerElement=64,Fn(Bd,"StructArrayLayout16f64");class ca extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,f,_,A,x,T,B)}emplace(c,f,_,A,x,T,B,U){const j=10*c,R=5*c;return this.uint16[j+0]=f,this.uint16[j+1]=_,this.uint16[j+2]=A,this.uint16[j+3]=x,this.float32[R+2]=T,this.float32[R+3]=B,this.float32[R+4]=U,c}}ca.prototype.bytesPerElement=20,Fn(ca,"StructArrayLayout4ui3f20");class Vg extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.int16[1*c+0]=f,c}}Vg.prototype.bytesPerElement=2,Fn(Vg,"StructArrayLayout1i2");class tm extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.uint8[1*c+0]=f,c}}tm.prototype.bytesPerElement=1,Fn(tm,"StructArrayLayout1ub1");class O1 extends Il{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}O1.prototype.size=40;class Hg extends nh{get(c){return new O1(this,c)}}Fn(Hg,"CollisionBoxArray");class kd extends Il{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(c){this._structArray.uint8[this._pos1+49]=c}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(c){this._structArray.uint8[this._pos1+50]=c}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(c){this._structArray.uint32[this._pos4+13]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(c){this._structArray.uint8[this._pos1+58]=c}}kd.prototype.size=60;class jg extends Ld{get(c){return new kd(this,c)}}Fn(jg,"PlacedSymbolArray");class F1 extends Il{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(c){this._structArray.uint32[this._pos4+14]=c}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(c){this._structArray.float32[this._pos4+18]=c}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}F1.prototype.size=80;class el extends o_{get(c){return new F1(this,c)}}Fn(el,"SymbolInstanceArray");class Wg extends Dd{getoffsetX(c){return this.float32[1*c+0]}}Fn(Wg,"GlyphOffsetArray");class Xg extends cc{getx(c){return this.int16[2*c+0]}gety(c){return this.int16[2*c+1]}}Fn(Xg,"SymbolLineVertexArray");class Au extends Il{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Au.prototype.size=12;class nm extends hc{get(c){return new Au(this,c)}}Fn(nm,"FeatureIndexArray");class rh extends Su{geta_centroid_pos0(c){return this.uint16[2*c+0]}geta_centroid_pos1(c){return this.uint16[2*c+1]}}Fn(rh,"FillExtrusionCentroidArray");class rm extends Il{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}rm.prototype.size=6;class im extends pf{get(c){return new rm(this,c)}}Fn(im,"FillExtrusionWallArray");const l_=Qr([{name:"a_pos",components:2,type:"Int16"}],4),Ow=Qr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class bs{constructor(c=[]){this.segments=c}_prepareSegment(c,f,_,A){let x=this.segments[this.segments.length-1];return c>bs.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${bs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!x||x.vertexLength+c>bs.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==A)&&(x={vertexOffset:f,primitiveOffset:_,vertexLength:0,primitiveLength:0},A!==void 0&&(x.sortKey=A),this.segments.push(x)),x}prepareSegment(c,f,_,A){return this._prepareSegment(c,f.length,_.length,A)}get(){return this.segments}destroy(){for(const c of this.segments)for(const f in c.vaos)c.vaos[f].destroy()}static simpleSegment(c,f,_,A){return new bs([{vertexOffset:c,primitiveOffset:f,vertexLength:_,primitiveLength:A,vaos:{},sortKey:0}])}}function c_(g,c){return 256*(g=jt(Math.floor(g),0,255))+jt(Math.floor(c),0,255)}bs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn(bs,"SegmentVector");const N1=Qr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),z1=Qr([{name:"a_dash",components:4,type:"Uint16"}]);class gf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(c,f,_,A){this.ids.push(U1(c)),this.positions.push(f,_,A)}eachPosition(c,f){const _=U1(c);let A=0,x=this.ids.length-1;for(;A<x;){const T=A+x>>1;this.ids[T]>=_?x=T:A=T+1}for(;this.ids[A]===_;)f(this.positions[3*A],this.positions[3*A+1],this.positions[3*A+2]),A++}static serialize(c,f){const _=new Float64Array(c.ids),A=new Uint32Array(c.positions);return Od(_,A,0,_.length-1),f&&(f.add(_.buffer),f.add(A.buffer)),{ids:_,positions:A}}static deserialize(c){const f=new gf;let _;f.ids=c.ids,f.positions=c.positions;for(const A of f.ids)A!==_&&f.uniqueIds.push(A),_=A;return f.indexed=!0,f}}function U1(g){const c=+g;return!isNaN(c)&&Number.MIN_SAFE_INTEGER<=c&&c<=Number.MAX_SAFE_INTEGER?c:$o(String(g))}function Od(g,c,f,_){for(;f<_;){const A=g[f+_>>1];let x=f-1,T=_+1;for(;;){do x++;while(g[x]<A);do T--;while(g[T]>A);if(x>=T)break;D(g,x,T),D(c,3*x,3*T),D(c,3*x+1,3*T+1),D(c,3*x+2,3*T+2)}T-f<_-T?(Od(g,c,f,T),f=T+1):(Od(g,c,T+1,_),_=T)}}function D(g,c,f){const _=g[c];g[c]=g[f],g[f]=_}Fn(gf,"FeaturePositionMap");class O{constructor(c){this.gl=c.gl,this.initialized=!1}fetchUniformLocation(c,f){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(c,f),this.initialized=!0),!!this.location}set(c,f,_){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Y extends O{constructor(c){super(c),this.current=0}set(c,f,_){this.fetchUniformLocation(c,f)&&this.current!==_&&(this.current=_,this.gl.uniform1i(this.location,_))}}class ie extends O{constructor(c){super(c),this.current=0}set(c,f,_){this.fetchUniformLocation(c,f)&&this.current!==_&&(this.current=_,this.gl.uniform1f(this.location,_))}}class pe extends O{constructor(c){super(c),this.current=[0,0]}set(c,f,_){this.fetchUniformLocation(c,f)&&(_[0]===this.current[0]&&_[1]===this.current[1]||(this.current=_,this.gl.uniform2f(this.location,_[0],_[1])))}}class Te extends O{constructor(c){super(c),this.current=[0,0,0]}set(c,f,_){this.fetchUniformLocation(c,f)&&(_[0]===this.current[0]&&_[1]===this.current[1]&&_[2]===this.current[2]||(this.current=_,this.gl.uniform3f(this.location,_[0],_[1],_[2])))}}class dt extends O{constructor(c){super(c),this.current=[0,0,0,0]}set(c,f,_){this.fetchUniformLocation(c,f)&&(_[0]===this.current[0]&&_[1]===this.current[1]&&_[2]===this.current[2]&&_[3]===this.current[3]||(this.current=_,this.gl.uniform4f(this.location,_[0],_[1],_[2],_[3])))}}class Ot extends O{constructor(c){super(c),this.current=vr.transparent.toRenderColor(null)}set(c,f,_){this.fetchUniformLocation(c,f)&&(_.r===this.current.r&&_.g===this.current.g&&_.b===this.current.b&&_.a===this.current.a||(this.current=_,this.gl.uniform4f(this.location,_.r,_.g,_.b,_.a)))}}const vn=new Float32Array(16);class Wn extends O{constructor(c){super(c),this.current=vn}set(c,f,_){if(this.fetchUniformLocation(c,f)){if(_[12]!==this.current[12]||_[0]!==this.current[0])return this.current=_,void this.gl.uniformMatrix4fv(this.location,!1,_);for(let A=1;A<16;A++)if(_[A]!==this.current[A]){this.current=_,this.gl.uniformMatrix4fv(this.location,!1,_);break}}}}const br=new Float32Array(9),ai=new Float32Array(4);class zr extends O{constructor(c){super(c),this.current=ai}set(c,f,_){if(this.fetchUniformLocation(c,f)){for(let A=0;A<4;A++)if(_[A]!==this.current[A]){this.current=_,this.gl.uniformMatrix2fv(this.location,!1,_);break}}}}function ps(g){return[c_(255*g.r,255*g.g),c_(255*g.b,255*g.a)]}class Ir{constructor(c,f,_,A){this.value=c,this.uniformNames=f.map(x=>`u_${x}`),this.type=_,this.context=A}setUniform(c,f,_,A,x){const T=A.constantOr(this.value);f.set(c,x,T instanceof vr?T.toRenderColor(this.context.lut):T)}getBinding(c,f){return this.type==="color"?new Ot(c):new ie(c)}}class uo{constructor(c,f){this.uniformNames=f.map(_=>`u_${_}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(c){this.pixelRatio=c.pixelRatio||1,this.pattern=c.tl.concat(c.br)}setUniform(c,f,_,A,x){const T=x==="u_pattern"||x==="u_dash"?this.pattern:x==="u_pixel_ratio"?this.pixelRatio:null;T&&f.set(c,x,T)}getBinding(c,f){return f==="u_pattern"||f==="u_dash"?new dt(c):new ie(c)}}class ho{constructor(c,f,_,A){this.expression=c,this.type=_,this.maxValue=0,this.paintVertexAttributes=f.map(x=>({name:`a_${x}`,type:"Float32",components:_==="color"?2:1,offset:0})),this.paintVertexArray=new A}populatePaintArray(c,f,_,A,x,T,B){const U=this.paintVertexArray.length,j=this.expression.evaluate(new ds(0,{brightness:T}),f,{},x,A,B);this.paintVertexArray.resize(c),this._setPaintValue(U,c,j,this.context)}updatePaintArray(c,f,_,A,x,T,B){const U=this.expression.evaluate({zoom:0,brightness:B},_,A,void 0,x);this._setPaintValue(c,f,U,this.context)}_setPaintValue(c,f,_,A){if(this.type==="color"){const x=ps(_.toRenderColor(A.lut));for(let T=c;T<f;T++)this.paintVertexArray.emplace(T,x[0],x[1])}else{for(let x=c;x<f;x++)this.paintVertexArray.emplace(x,_);this.maxValue=Math.max(this.maxValue,Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xt{constructor(c,f,_,A,x,T){this.expression=c,this.uniformNames=f.map(B=>`u_${B}_t`),this.type=_,this.useIntegerZoom=A,this.context=x,this.maxValue=0,this.paintVertexAttributes=f.map(B=>({name:`a_${B}`,type:"Float32",components:_==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(c,f,_,A,x,T,B){const U=this.expression.evaluate(new ds(this.context.zoom,{brightness:T}),f,{},x,A,B),j=this.expression.evaluate(new ds(this.context.zoom+1,{brightness:T}),f,{},x,A,B),R=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(R,c,U,j,this.context)}updatePaintArray(c,f,_,A,x,T,B){const U=this.expression.evaluate({zoom:this.context.zoom,brightness:B},_,A,void 0,x),j=this.expression.evaluate({zoom:this.context.zoom+1,brightness:B},_,A,void 0,x);this._setPaintValue(c,f,U,j,this.context)}_setPaintValue(c,f,_,A,x){if(this.type==="color"){const T=ps(_.toRenderColor(x.lut)),B=ps(_.toRenderColor(x.lut));for(let U=c;U<f;U++)this.paintVertexArray.emplace(U,T[0],T[1],B[0],B[1])}else{for(let T=c;T<f;T++)this.paintVertexArray.emplace(T,_,A);this.maxValue=Math.max(this.maxValue,Math.abs(_),Math.abs(A))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,f,_,A,x){const T=this.useIntegerZoom?Math.floor(_.zoom):_.zoom,B=jt(this.expression.interpolationFactor(T,this.context.zoom,this.context.zoom+1),0,1);f.set(c,x,B)}getBinding(c,f){return new ie(c)}}class Nt{constructor(c,f,_,A,x){this.expression=c,this.layerId=x,this.paintVertexAttributes=(_==="array"?z1:N1).members;for(let T=0;T<f.length;++T);this.paintVertexArray=new A}populatePaintArray(c,f,_,A){const x=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValues(x,c,f.patterns&&f.patterns[this.layerId],_)}updatePaintArray(c,f,_,A,x,T,B){this._setPaintValues(c,f,_.patterns&&_.patterns[this.layerId],T)}_setPaintValues(c,f,_,A){if(!A||!_)return;const x=A[_];if(!x)return;const{tl:T,br:B,pixelRatio:U}=x;for(let j=c;j<f;j++)this.paintVertexArray.emplace(j,T[0],T[1],B[0],B[1],U)}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class on{constructor(c,f,_=()=>!0){this.binders={},this._buffers=[],this.context=f;const A=[];for(const x in c.paint._values){const T=c.paint.get(x);if(!_(x)||!(T instanceof Ju&&jp(T.property.specification)))continue;const B=gi(x,c.type),U=T.value,j=T.property.specification.type,R=!!T.property.useIntegerZoom,N=x==="line-dasharray"||x.endsWith("pattern"),V=x==="line-dasharray"&&c.layout.get("line-cap").value.kind!=="constant";if(U.kind!=="constant"||V)if(U.kind==="source"||V||N){const z=b(x,j,"source");this.binders[x]=N?new Nt(U,B,j,z,c.id):new ho(U,B,j,z),A.push(`/a_${x}`)}else{const z=b(x,j,"composite");this.binders[x]=new Xt(U,B,j,R,f,z),A.push(`/z_${x}`)}else this.binders[x]=N?new uo(U.value,B):new Ir(U.value,B,j,f),A.push(`/u_${x}`)}this.cacheKey=A.sort().join("")}getMaxValue(c){const f=this.binders[c];return f instanceof ho||f instanceof Xt?f.maxValue:0}populatePaintArrays(c,f,_,A,x,T,B){for(const U in this.binders){const j=this.binders[U];j.context=this.context,(j instanceof ho||j instanceof Xt||j instanceof Nt)&&j.populatePaintArray(c,f,_,A,x,T,B)}}setConstantPatternPositions(c){for(const f in this.binders){const _=this.binders[f];_ instanceof uo&&_.setConstantPatternPositions(c)}}updatePaintArrays(c,f,_,A,x,T,B,U){let j=!1;const R=Object.keys(c),N=R.length!==0,V=N?R:f.uniqueIds;this.context.lut=x.lut;for(const z in this.binders){const G=this.binders[z];if(G.context=this.context,(G instanceof ho||G instanceof Xt||G instanceof Nt)&&(G.expression.isStateDependent===!0||G.expression.isLightConstant===!1)){const X=x.paint.get(z);G.expression=X.value;for(const K of V){const te=c[K.toString()];f.eachPosition(K,(ce,he,ne)=>{const de=A.feature(ce);G.updatePaintArray(he,ne,de,te,T,B,U)})}if(!N)for(const K of _.uniqueIds){const te=c[K.toString()];_.eachPosition(K,(ce,he,ne)=>{const de=A.feature(ce);G.updatePaintArray(he,ne,de,te,T,B,U)})}j=!0}}return j}defines(){const c=[];for(const f in this.binders){const _=this.binders[f];(_ instanceof Ir||_ instanceof uo)&&c.push(..._.uniformNames.map(A=>`#define HAS_UNIFORM_${A}`))}return c}getBinderAttributes(){const c=[];for(const f in this.binders){const _=this.binders[f];if(_ instanceof ho||_ instanceof Xt||_ instanceof Nt)for(let A=0;A<_.paintVertexAttributes.length;A++)c.push(_.paintVertexAttributes[A].name)}return c}getBinderUniforms(){const c=[];for(const f in this.binders){const _=this.binders[f];if(_ instanceof Ir||_ instanceof uo||_ instanceof Xt)for(const A of _.uniformNames)c.push(A)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c){const f=[];for(const _ in this.binders){const A=this.binders[_];if(A instanceof Ir||A instanceof uo||A instanceof Xt)for(const x of A.uniformNames)f.push({name:x,property:_,binding:A.getBinding(c,x)})}return f}setUniforms(c,f,_,A,x){for(const{name:T,property:B,binding:U}of _)this.binders[B].setUniform(c,U,x,A.get(B),T)}updatePaintBuffers(){this._buffers=[];for(const c in this.binders){const f=this.binders[c];(f instanceof ho||f instanceof Xt||f instanceof Nt)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(c){for(const f in this.binders){const _=this.binders[f];(_ instanceof ho||_ instanceof Xt||_ instanceof Nt)&&_.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const f=this.binders[c];(f instanceof ho||f instanceof Xt||f instanceof Nt)&&f.destroy()}}}class rr{constructor(c,f,_=()=>!0){this.programConfigurations={};for(const A of c)this.programConfigurations[A.id]=new on(A,f,_);this.needsUpload=!1,this._featureMap=new gf,this._featureMapWithoutIds=new gf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(c,f,_,A,x,T,B,U){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(c,f,A,x,T,B,U);f.id!==void 0?this._featureMap.add(f.id,_,this._bufferOffset,c):(this._featureMapWithoutIds.add(this._idlessCounter,_,this._bufferOffset,c),this._idlessCounter+=1),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,f,_,A,x,T){for(const B of _)this.needsUpload=this.programConfigurations[B.id].updatePaintArrays(c,this._featureMap,this._featureMapWithoutIds,f,B,A,x,T||0)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}const Rr={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function gi(g,c){return Rr[g]||[g.replace(`${c}-`,"").replace(/-/g,"_")]}const li={"line-pattern":{source:Vc,composite:Vc},"fill-pattern":{source:Vc,composite:Vc},"fill-extrusion-pattern":{source:Vc,composite:Vc},"line-dasharray":{source:wu,composite:wu}},Ni={color:{source:fc,composite:Rl},number:{source:Dd,composite:fc}};function b(g,c,f){const _=li[g];return _&&_[f]||Ni[c][f]}Fn(Ir,"ConstantBinder"),Fn(uo,"PatternConstantBinder"),Fn(ho,"SourceExpressionBinder"),Fn(Nt,"PatternCompositeBinder"),Fn(Xt,"CompositeExpressionBinder"),Fn(on,"ProgramConfiguration",{omit:["_buffers"]}),Fn(rr,"ProgramConfigurationSet");const u=yn/Math.PI/2,p=5,w=6,I=16383,P=64,F=[P,32,16],W=-u,$=u;function J(g,c,f,_=u){return f=sn(f),[g*Math.sin(f)*_,-c*_,g*Math.cos(f)*_]}function Q(g,c,f){return J(Math.cos(sn(g)),Math.sin(sn(g)),c,f)}const oe=63710088e-1,le=2*Math.PI*oe;class ue{constructor(c,f){if(isNaN(c)||isNaN(f))throw new Error(`Invalid LngLat object: (${c}, ${f})`);if(this.lng=+c,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ue(Un(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const f=Math.PI/180,_=this.lat*f,A=c.lat*f,x=Math.sin(_)*Math.sin(A)+Math.cos(_)*Math.cos(A)*Math.cos((c.lng-this.lng)*f);return oe*Math.acos(Math.min(x,1))}toBounds(c=0){const f=360*c/40075017,_=f/Math.cos(Math.PI/180*this.lat);return new ve({lng:this.lng-_,lat:this.lat-f},{lng:this.lng+_,lat:this.lat+f})}toEcef(c){return Q(this.lat,this.lng,u+c*u/oe)}static convert(c){if(c instanceof ue)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new ue(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new ue(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ve{constructor(c,f){if(c)if(f)this.setSouthWest(c).setNorthEast(f);else if(c.length===4){const _=c;this.setSouthWest([_[0],_[1]]).setNorthEast([_[2],_[3]])}else{const _=c;this.setSouthWest(_[0]).setNorthEast(_[1])}}setNorthEast(c){return this._ne=c instanceof ue?new ue(c.lng,c.lat):ue.convert(c),this}setSouthWest(c){return this._sw=c instanceof ue?new ue(c.lng,c.lat):ue.convert(c),this}extend(c){const f=this._sw,_=this._ne;let A,x;if(c instanceof ue)A=c,x=c;else{if(!(c instanceof ve))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(ve.convert(c)):this.extend(ue.convert(c)):typeof c=="object"&&c!==null&&c.hasOwnProperty("lat")&&(c.hasOwnProperty("lon")||c.hasOwnProperty("lng"))?this.extend(ue.convert(c)):this;if(A=c._sw,x=c._ne,!A||!x)return this}return f||_?(f.lng=Math.min(A.lng,f.lng),f.lat=Math.min(A.lat,f.lat),_.lng=Math.max(x.lng,_.lng),_.lat=Math.max(x.lat,_.lat)):(this._sw=new ue(A.lng,A.lat),this._ne=new ue(x.lng,x.lat)),this}getCenter(){return new ue((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ue(this.getWest(),this.getNorth())}getSouthEast(){return new ue(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){const{lng:f,lat:_}=ue.convert(c);let A=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&A}static convert(c){if(c)return c instanceof ve?c:new ve(c)}}const _e=0,be=25.5;function we(g){return le*Math.cos(g*Math.PI/180)}function ke(g){return(180+g)/360}function Ne(g){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g*Math.PI/360)))/360}function De(g,c){return g/we(c)}function We(g){return 360*g-180}function He(g){return 360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90}function et(g,c){return g*we(He(c))}const Ke=85.051129;function tt(g){return Math.cos(sn(jt(g,-Ke,Ke)))}function ut(g,c){const f=jt(c,_e,be),_=Math.pow(2,f);return tt(g)*le/(512*_)}function st(g){return 1/Math.cos(g*Math.PI/180)}function rt(g,c=0){const f=Math.exp(Math.PI*(1-(g.y+c/yn)/(1<<g.z)*2));return 80150034*f/(f*f+1)/yn/(1<<g.z)}class xt{constructor(c,f,_=0){this.x=+c,this.y=+f,this.z=+_}static fromLngLat(c,f=0){const _=ue.convert(c);return new xt(ke(_.lng),Ne(_.lat),De(f,_.lat))}toLngLat(){return new ue(We(this.x),He(this.y))}toAltitude(){return et(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/le*st(He(this.y))}}function Ft(g,c,f,_,A,x,T,B,U){const j=(c+_)/2,R=(f+A)/2,N=new St(j,R);B(N),function(V,z,G,X,K,te){const ce=G-K,he=X-te;return Math.abs((X-z)*ce-(G-V)*he)/Math.hypot(ce,he)}(N.x,N.y,x.x,x.y,T.x,T.y)>=U?(Ft(g,c,f,j,R,x,N,B,U),Ft(g,j,R,_,A,N,T,B,U)):g.push(T)}function Zt(g,c,f){let _=g[0],A=_.x,x=_.y;c(_);const T=[_];for(let B=1;B<g.length;B++){const U=g[B],{x:j,y:R}=U;c(U),Ft(T,A,x,j,R,_,U,c,f),A=j,x=R,_=U}return T}function kt(g,c,f,_){if(_(c,f)){const A=c.add(f)._mult(.5);kt(g,c,A,_),kt(g,A,f,_)}else g.push(f)}function hn(g,c){let f=g[0];const _=[f];for(let A=1;A<g.length;A++){const x=g[A];kt(_,f,x,c),f=x}return _}const bt=Math.pow(2,14)-1,Wt=-bt-1;function Gt(g,c){const f=Math.round(g.x*c),_=Math.round(g.y*c);return g.x=jt(f,Wt,bt),g.y=jt(_,Wt,bt),(f<g.x||f>g.x+1||_<g.y||_>g.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),g}function fn(g,c,f){const _=g.loadGeometry(),A=g.extent,x=yn/A;if(c&&f&&f.projection.isReprojectedInTileSpace){const T=1<<c.z,{scale:B,x:U,y:j,projection:R}=f,N=V=>{const z=We((c.x+V.x/A)/T),G=He((c.y+V.y/A)/T),X=R.project(z,G);V.x=(X.x*B-U)*A,V.y=(X.y*B-j)*A};for(let V=0;V<_.length;V++)if(g.type!==1)_[V]=Zt(_[V],N,1);else{const z=[];for(const G of _[V])G.x<0||G.x>=A||G.y<0||G.y>=A||(N(G),z.push(G));_[V]=z}}for(const T of _)for(const B of T)Gt(B,x);return _}function pn(g,c){return{type:g.type,id:g.id,properties:g.properties,geometry:c?fn(g):[]}}function qt(g,c,f,_,A){g.emplaceBack(2*c+(_+1)/2,2*f+(A+1)/2)}function en(g,c,f){g.emplaceBack(c.x,c.y,c.z,f[0]*16384,f[1]*16384,f[2]*16384)}class er{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=c.index,this.hasPattern=!1,this.projection=c.projection,this.layoutVertexArray=new cc,this.indexArray=new wo,this.segments=new bs,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}updateFootprints(c,f){}populate(c,f,_,A){const x=this.layers[0],T=[];let B=null;x.type==="circle"&&(B=x.layout.get("circle-sort-key"));for(const{feature:j,id:R,index:N,sourceLayerIndex:V}of c){const z=this.layers[0]._featureFilter.needGeometry,G=pn(j,z);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),G,_))continue;const X=B?B.evaluate(G,{},_):void 0,K={id:R,properties:j.properties,type:j.type,sourceLayerIndex:V,index:N,geometry:z?G.geometry:fn(j,_,A),patterns:{},sortKey:X};T.push(K)}B&&T.sort((j,R)=>j.sortKey-R.sortKey);let U=null;A.projection.name==="globe"&&(this.globeExtVertexArray=new Pd,U=A.projection);for(const j of T){const{geometry:R,index:N,sourceLayerIndex:V}=j,z=c[N].feature;this.addFeature(j,R,N,f.availableImages,_,U,f.brightness),f.featureIndex.insert(z,R,N,V,this.index)}}update(c,f,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,f,T?this.stateDependentLayers:this.layers,_,A,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,l_.members),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=c.createVertexBuffer(this.globeExtVertexArray,Ow.members))),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(c,f,_,A,x,T,B){for(const U of f)for(const j of U){const R=j.x,N=j.y;if(R<0||R>=yn||N<0||N>=yn)continue;if(T){const G=T.projectTilePoint(R,N,x),X=T.upVector(x,R,N),K=this.globeExtVertexArray;en(K,G,X),en(K,G,X),en(K,G,X),en(K,G,X)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),z=V.vertexLength;qt(this.layoutVertexArray,R,N,-1,-1),qt(this.layoutVertexArray,R,N,1,-1),qt(this.layoutVertexArray,R,N,1,1),qt(this.layoutVertexArray,R,N,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+2,z+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{},A,x,B)}}function xn(g,c){for(let f=0;f<g.length;f++)if(is(c,g[f]))return!0;for(let f=0;f<c.length;f++)if(is(g,c[f]))return!0;return!!ur(g,c)}function Dn(g,c,f){return!!is(g,c)||!!Br(c,g,f)}function yr(g,c){if(g.length===1)return zi(c,g[0]);for(let f=0;f<c.length;f++){const _=c[f];for(let A=0;A<_.length;A++)if(is(g,_[A]))return!0}for(let f=0;f<g.length;f++)if(zi(c,g[f]))return!0;for(let f=0;f<c.length;f++)if(ur(g,c[f]))return!0;return!1}function qn(g,c,f){if(g.length>1){if(ur(g,c))return!0;for(let _=0;_<c.length;_++)if(Br(c[_],g,f))return!0}for(let _=0;_<g.length;_++)if(Br(g[_],c,f))return!0;return!1}function ur(g,c){if(g.length===0||c.length===0)return!1;for(let f=0;f<g.length-1;f++){const _=g[f],A=g[f+1];for(let x=0;x<c.length-1;x++)if(Ur(_,A,c[x],c[x+1]))return!0}return!1}function Ur(g,c,f,_){return Kt(g,f,_)!==Kt(c,f,_)&&Kt(g,c,f)!==Kt(g,c,_)}function Br(g,c,f){const _=f*f;if(c.length===1)return g.distSqr(c[0])<_;for(let A=1;A<c.length;A++)if(Ci(g,c[A-1],c[A])<_)return!0;return!1}function Ci(g,c,f){const _=c.distSqr(f);if(_===0)return g.distSqr(c);const A=((g.x-c.x)*(f.x-c.x)+(g.y-c.y)*(f.y-c.y))/_;return g.distSqr(A<0?c:A>1?f:f.sub(c)._mult(A)._add(c))}function zi(g,c){let f,_,A,x=!1;for(let T=0;T<g.length;T++){f=g[T];for(let B=0,U=f.length-1;B<f.length;U=B++)_=f[B],A=f[U],_.y>c.y!=A.y>c.y&&c.x<(A.x-_.x)*(c.y-_.y)/(A.y-_.y)+_.x&&(x=!x)}return x}function is(g,c){let f=!1;for(let _=0,A=g.length-1;_<g.length;A=_++){const x=g[_],T=g[A];x.y>c.y!=T.y>c.y&&c.x<(T.x-x.x)*(c.y-x.y)/(T.y-x.y)+x.x&&(f=!f)}return f}function Wc(g,c,f,_,A){for(const T of g)if(c<=T.x&&f<=T.y&&_>=T.x&&A>=T.y)return!0;const x=[new St(c,f),new St(c,A),new St(_,A),new St(_,f)];if(g.length>2){for(const T of x)if(is(g,T))return!0}for(let T=0;T<g.length-1;T++)if(Qs(g[T],g[T+1],x))return!0;return!1}function Qs(g,c,f){const _=f[0],A=f[2];if(g.x<_.x&&c.x<_.x||g.x>A.x&&c.x>A.x||g.y<_.y&&c.y<_.y||g.y>A.y&&c.y>A.y)return!1;const x=Kt(g,c,f[0]);return x!==Kt(g,c,f[1])||x!==Kt(g,c,f[2])||x!==Kt(g,c,f[3])}function Yr(g,c,f,_,A,x){let T=c.y-g.y,B=g.x-c.x;if(x=x||0){const U=T*T+B*B;if(U===0)return!0;const j=Math.sqrt(U);T/=j,B/=j}return!((f.x-g.x)*T+(f.y-g.y)*B-x<0||(_.x-g.x)*T+(_.y-g.y)*B-x<0||(A.x-g.x)*T+(A.y-g.y)*B-x<0)}function Fi(g,c,f,_,A,x,T){return!(Yr(g,c,_,A,x,T)||Yr(c,f,_,A,x,T)||Yr(f,g,_,A,x,T)||Yr(_,A,g,c,f,T)||Yr(A,x,g,c,f,T)||Yr(x,_,g,c,f,T))}function ws(g,c,f){const _=c.paint.get(g).value;return _.kind==="constant"?_.value:f.programConfigurations.get(c.id).getMaxValue(g)}function Li(g){return Math.sqrt(g[0]*g[0]+g[1]*g[1])}function kr(g,c,f,_,A){if(!c[0]&&!c[1])return g;const x=St.convert(c)._mult(A);f==="viewport"&&x._rotate(-_);const T=[];for(let B=0;B<g.length;B++)T.push(g[B].sub(x));return T}function pi(g,c,f,_){const A=St.convert(g)._mult(_);return c==="viewport"&&A._rotate(-f),A}let Ai,Ns;Fn(er,"CircleBucket",{omit:["layers"]});var eo,oi={exports:{}},Fo=(eo||(eo=1,function(g,c){(function(f){function _(x,T,B){var U=A(256*x,256*(T=Math.pow(2,B)-T-1),B),j=A(256*(x+1),256*(T+1),B);return U[0]+","+U[1]+","+j[0]+","+j[1]}function A(x,T,B){var U=2*Math.PI*6378137/256/Math.pow(2,B);return[x*U-2*Math.PI*6378137/2,T*U-2*Math.PI*6378137/2]}f.getURL=function(x,T,B,U,j,R){return R=R||{},x+"?"+["bbox="+_(B,U,j),"format="+(R.format||"image/png"),"service="+(R.service||"WMS"),"version="+(R.version||"1.1.1"),"request="+(R.request||"GetMap"),"srs="+(R.srs||"EPSG:3857"),"width="+(R.width||256),"height="+(R.height||256),"layers="+T].join("&")},f.getTileBBox=_,f.getMercCoords=A,Object.defineProperty(f,"__esModule",{value:!0})})(c)}(0,oi.exports)),oi.exports);class Ko{constructor(c,f,_){this.z=c,this.x=f,this.y=_,this.key=pl(0,c,c,f,_)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,f){const _=Fo.getTileBBox(this.x,this.y,this.z),A=function(x,T,B){let U,j="";for(let R=x;R>0;R--)U=1<<R-1,j+=(T&U?1:0)+(B&U?2:0);return j}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",_)}toString(){return`${this.z}/${this.x}/${this.y}`}}class No{constructor(c,f){this.wrap=c,this.canonical=f,this.key=pl(c,f.z,f.z,f.x,f.y)}}class Yi{constructor(c,f,_,A,x){this.overscaledZ=c,this.wrap=f,this.canonical=new Ko(_,+A,+x),this.key=f===0&&c===_?this.canonical.key:pl(f,c,_,A,x)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){const f=this.canonical.z-c;return c>this.canonical.z?new Yi(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yi(c,this.wrap,c,this.canonical.x>>f,this.canonical.y>>f)}calculateScaledKey(c,f=!0){if(this.overscaledZ===c&&f)return this.key;if(c>this.canonical.z)return pl(this.wrap*+f,c,this.canonical.z,this.canonical.x,this.canonical.y);{const _=this.canonical.z-c;return pl(this.wrap*+f,c,c,this.canonical.x>>_,this.canonical.y>>_)}}isChildOf(c){if(c.wrap!==this.wrap)return!1;const f=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.z<this.canonical.z&&c.canonical.x===this.canonical.x>>f&&c.canonical.y===this.canonical.y>>f}children(c){if(this.overscaledZ>=c)return[new Yi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const f=this.canonical.z+1,_=2*this.canonical.x,A=2*this.canonical.y;return[new Yi(f,this.wrap,f,_,A),new Yi(f,this.wrap,f,_+1,A),new Yi(f,this.wrap,f,_,A+1),new Yi(f,this.wrap,f,_+1,A+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new Yi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new Yi(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new No(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function pl(g,c,f,_,A){const x=1<<Math.min(f,22);let T=x*(A%x)+_%x;return g&&f<22&&(T+=x*x*((g<0?-2*g-1:2*g)%(1<<2*(22-f)))),16*(32*T+f)+(c-f)}const ml=[g=>{let c=g.canonical.x-1,f=g.wrap;return c<0&&(c=(1<<g.canonical.z)-1,f--),new Yi(g.overscaledZ,f,g.canonical.z,c,g.canonical.y)},g=>{let c=g.canonical.x+1,f=g.wrap;return c===1<<g.canonical.z&&(c=0,f++),new Yi(g.overscaledZ,f,g.canonical.z,c,g.canonical.y)},g=>new Yi(g.overscaledZ,g.wrap,g.canonical.z,g.canonical.x,(g.canonical.y===0?1<<g.canonical.z:g.canonical.y)-1),g=>new Yi(g.overscaledZ,g.wrap,g.canonical.z,g.canonical.x,g.canonical.y===(1<<g.canonical.z)-1?0:g.canonical.y+1)];Fn(Ko,"CanonicalTileID"),Fn(Yi,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Xc=Qr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:dc}=Xc,Pl=Qr([{name:"a_pos_3",components:3,type:"Int16"}]);var $c=Qr([{name:"a_pos",type:"Int16",components:2}]);class vf{constructor(c,f){this.pos=c,this.dir=f}intersectsPlane(c,f,_){const A=Pe.vec3.dot(f,this.dir);if(Math.abs(A)<1e-6)return!1;const x=((c[0]-this.pos[0])*f[0]+(c[1]-this.pos[1])*f[1]+(c[2]-this.pos[2])*f[2])/A;return _[0]=this.pos[0]+this.dir[0]*x,_[1]=this.pos[1]+this.dir[1]*x,_[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(c,f,_){if(Pe.vec3.equals(this.pos,c)||f===0)return _[0]=_[1]=_[2]=0,!1;const[A,x,T]=this.dir,B=this.pos[0]-c[0],U=this.pos[1]-c[1],j=this.pos[2]-c[2],R=A*A+x*x+T*T,N=2*(B*A+U*x+j*T),V=N*N-4*R*(B*B+U*U+j*j-f*f);if(V<0){const z=Math.max(-N/2,0),G=B+A*z,X=U+x*z,K=j+T*z,te=Math.hypot(G,X,K);return _[0]=G*f/te,_[1]=X*f/te,_[2]=K*f/te,!1}{const z=(-N-Math.sqrt(V))/(2*R);if(z<0){const G=Math.hypot(B,U,j);return _[0]=B*f/G,_[1]=U*f/G,_[2]=j*f/G,!1}return _[0]=B+A*z,_[1]=U+x*z,_[2]=j+T*z,!0}}}class Fd{constructor(c,f,_,A,x){this.TL=c,this.TR=f,this.BR=_,this.BL=A,this.horizon=x}static fromInvProjectionMatrix(c,f,_){const A=[-1,1,1],x=[1,1,1],T=[1,-1,1],B=[-1,-1,1],U=Pe.vec3.transformMat4(A,A,c),j=Pe.vec3.transformMat4(x,x,c),R=Pe.vec3.transformMat4(T,T,c),N=Pe.vec3.transformMat4(B,B,c);return new Fd(U,j,R,N,f/_)}}function ih(g,c,f){let _=1/0,A=-1/0;const x=[];for(const T of g){Pe.vec3.sub(x,T,c);const B=Pe.vec3.dot(x,f);_=Math.min(_,B),A=Math.max(A,B)}return[_,A]}function $g(g,c){let f=!0;for(let _=0;_<g.planes.length;_++){const A=g.planes[_];let x=0;for(let T=0;T<c.length;T++)x+=Pe.vec3.dot(A,c[T])+A[3]>=0;if(x===0)return 0;x!==c.length&&(f=!1)}return f?2:1}function qg(g,c){for(const f of g.projections){const _=ih(c,g.points[0],f.axis);if(f.projection[1]<_[0]||f.projection[0]>_[1])return 0}return 1}function G1(g,c){let f=0;const _=[0,0,0,0];for(let A=0;A<g.length;A++)_[0]=g[A][0],_[1]=g[A][1],_[2]=g[A][2],_[3]=1,Pe.vec4.dot(_,c)>=0&&f++;return f}class Zg{constructor(c,f){this.points=c||new Array(8).fill([0,0,0]),this.planes=f||new Array(6).fill([0,0,0,0]),this.bounds=Ki.fromPoints(this.points),this.projections=[],this.frustumEdges=[Pe.vec3.sub([],this.points[2],this.points[3]),Pe.vec3.sub([],this.points[0],this.points[3]),Pe.vec3.sub([],this.points[4],this.points[0]),Pe.vec3.sub([],this.points[5],this.points[1]),Pe.vec3.sub([],this.points[6],this.points[2]),Pe.vec3.sub([],this.points[7],this.points[3])];for(const _ of this.frustumEdges){const A=[0,-_[2],_[1]],x=[_[2],0,-_[0]];this.projections.push({axis:A,projection:ih(this.points,this.points[0],A)}),this.projections.push({axis:x,projection:ih(this.points,this.points[0],x)})}}static fromInvProjectionMatrix(c,f,_,A){const x=Math.pow(2,_),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(j=>{const R=Pe.vec4.transformMat4([],j,c),N=1/R[3]/f*x;return Pe.vec4.mul(R,R,[N,N,A?1/R[3]:N,N])}),B=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(j=>{const R=Pe.vec3.sub([],T[j[0]],T[j[1]]),N=Pe.vec3.sub([],T[j[2]],T[j[1]]),V=Pe.vec3.normalize([],Pe.vec3.cross([],R,N)),z=-Pe.vec3.dot(V,T[j[1]]);return V.concat(z)}),U=[];for(let j=0;j<T.length;j++)U.push([T[j][0],T[j][1],T[j][2]]);return new Zg(U,B)}intersectsPrecise(c,f,_){for(let A=0;A<f.length;A++)if(!G1(c,f[A]))return 0;for(let A=0;A<this.planes.length;A++)if(!G1(c,this.planes[A]))return 0;for(const A of _)for(const x of this.frustumEdges){const T=Pe.vec3.cross([],A,x),B=Pe.vec3.length(T);if(B===0)continue;Pe.vec3.scale(T,T,1/B);const U=ih(this.points,this.points[0],T),j=ih(c,this.points[0],T);if(U[0]>j[1]||j[0]>U[1])return 0}return 1}containsPoint(c){for(const f of this.planes){const _=f[3];if(Pe.vec3.dot([f[0],f[1],f[2]],c)+_<0)return!1}return!0}}class Ki{static fromPoints(c){const f=[1/0,1/0,1/0],_=[-1/0,-1/0,-1/0];for(const A of c)Pe.vec3.min(f,f,A),Pe.vec3.max(_,_,A);return new Ki(f,_)}static fromTileIdAndHeight(c,f,_){const A=1<<c.canonical.z,x=c.canonical.x,T=c.canonical.y;return new Ki([x/A,T/A,f],[(x+1)/A,(T+1)/A,_])}static applyTransform(c,f){const _=c.getCorners();for(let A=0;A<_.length;++A)Pe.vec3.transformMat4(_[A],_[A],f);return Ki.fromPoints(_)}static applyTransformFast(c,f){const _=[f[12],f[13],f[14]],A=[..._];for(let x=0;x<3;x++)for(let T=0;T<3;T++){const B=f[4*T+x],U=B*c.min[T],j=B*c.max[T];_[x]+=Math.min(U,j),A[x]+=Math.max(U,j)}return new Ki(_,A)}static projectAabbCorners(c,f){const _=c.getCorners();for(let A=0;A<_.length;++A)Pe.vec3.transformMat4(_[A],_[A],f);return _}constructor(c,f){this.min=c,this.max=f,this.center=Pe.vec3.scale([],Pe.vec3.add([],this.min,this.max),.5)}quadrant(c){const f=[c%2==0,c<2],_=Pe.vec3.clone(this.min),A=Pe.vec3.clone(this.max);for(let x=0;x<f.length;x++)_[x]=f[x]?this.min[x]:this.center[x],A[x]=f[x]?this.center[x]:this.max[x];return A[2]=this.max[2],new Ki(_,A)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}distanceZ(c){return Math.max(Math.min(this.max[2],c[2]),this.min[2])-c[2]}getCorners(){const c=this.min,f=this.max;return[[c[0],c[1],c[2]],[f[0],c[1],c[2]],[f[0],f[1],c[2]],[c[0],f[1],c[2]],[c[0],c[1],f[2]],[f[0],c[1],f[2]],[f[0],f[1],f[2]],[c[0],f[1],f[2]]]}intersects(c){return this.intersectsAabb(c.bounds)?$g(c,this.getCorners()):0}intersectsFlat(c){return this.intersectsAabb(c.bounds)?$g(c,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(c,f){return f||this.intersects(c)?qg(c,this.getCorners()):0}intersectsPreciseFlat(c,f){return f||this.intersectsFlat(c)?qg(c,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(c){for(let f=0;f<3;++f)if(this.min[f]>c.max[f]||c.min[f]>this.max[f])return!1;return!0}intersectsAabbXY(c){return!(this.min[0]>c.max[0]||c.min[0]>this.max[0]||this.min[1]>c.max[1]||c.min[1]>this.max[1])}encapsulate(c){for(let f=0;f<3;f++)this.min[f]=Math.min(this.min[f],c.min[f]),this.max[f]=Math.max(this.max[f],c.max[f])}encapsulatePoint(c){for(let f=0;f<3;f++)this.min[f]=Math.min(this.min[f],c[f]),this.max[f]=Math.max(this.max[f],c[f])}closestPoint(c){return[Math.max(Math.min(this.max[0],c[0]),this.min[0]),Math.max(Math.min(this.max[1],c[1]),this.min[1]),Math.max(Math.min(this.max[2],c[2]),this.min[2])]}}function sm(g){return g*u/oe}Fn(Ki,"Aabb");const S3=[new Ki([W,W,W],[$,$,$]),new Ki([W,W,W],[0,0,$]),new Ki([0,W,W],[$,0,$]),new Ki([W,0,W],[0,$,$]),new Ki([0,0,W],[$,$,$])];function wM(g,c,f,_=!0){const A=Pe.vec3.scale([],g._camera.position,g.worldSize),x=[c,f,1,1];Pe.vec4.transformMat4(x,x,g.pixelMatrixInverse),Pe.vec4.scale(x,x,1/x[3]);const T=Pe.vec3.sub([],x,A),B=Pe.vec3.normalize([],T),U=g.globeMatrix,j=[U[12],U[13],U[14]],R=Pe.vec3.sub([],j,A),N=Pe.vec3.length(R),V=Pe.vec3.normalize([],R),z=g.worldSize/(2*Math.PI),G=Pe.vec3.dot(V,B),X=Math.asin(z/N);if(X<Math.acos(G)){if(!_)return null;const Ye=[],ze=[];Pe.vec3.scale(Ye,B,N/G),Pe.vec3.normalize(ze,Pe.vec3.sub(ze,Ye,R)),Pe.vec3.normalize(B,Pe.vec3.add(B,R,Pe.vec3.scale(B,ze,Math.tan(X)*N)))}const K=[];new vf(A,B).closestPointOnSphere(j,z,K);const te=Pe.vec3.normalize([],hi(U,0)),ce=Pe.vec3.normalize([],hi(U,1)),he=Pe.vec3.normalize([],hi(U,2)),ne=Pe.vec3.dot(te,K),de=Pe.vec3.dot(ce,K),ge=Pe.vec3.dot(he,K),Me=at(Math.asin(-de/z));let Be=at(Math.atan2(ne,ge));Be=g.center.lng+function(Ye,ze){const Qe=(ze-Ye+180)%360-180;return Qe<-180?Qe+360:Qe}(g.center.lng,Be);const Oe=ke(Be),Re=jt(Ne(Me),0,1);return new xt(Oe,Re)}class Mue{constructor(c,f,_){this.a=Pe.vec3.sub([],c,_),this.b=Pe.vec3.sub([],f,_),this.center=_;const A=Pe.vec3.normalize([],this.a),x=Pe.vec3.normalize([],this.b);this.angle=Math.acos(Pe.vec3.dot(A,x))}}function A3(g,c){if(g.angle===0)return null;let f;return f=g.a[c]===0?1/g.angle*.5*Math.PI:1/g.angle*Math.atan(g.b[c]/g.a[c]/Math.sin(g.angle)-1/Math.tan(g.angle)),f<0||f>1?null:function(_,A,x,T){const B=Math.sin(x);return _*(Math.sin((1-T)*x)/B)+A*(Math.sin(T*x)/B)}(g.a[c],g.b[c],g.angle,jt(f,0,1))+g.center[c]}function Nd(g){if(g.z<=1)return S3[g.z+2*g.y+g.x];const c=T3(SM(g));return Ki.fromPoints(c)}function om(g,c,f){return Pe.vec3.scale(g,g,1-f),Pe.vec3.scaleAndAdd(g,g,c,f)}function P9(g,c,f){for(const _ of g)Pe.vec3.transformMat4(_,_,c),Pe.vec3.scale(_,_,f)}function L9(g,c,f,_){const A=c/g.worldSize,x=g.globeMatrix;if(f.z<=1){const Oe=Nd(f).getCorners();return P9(Oe,x,A),Ki.fromPoints(Oe)}const T=SM(f,_),B=T3(T,u+sm(g._tileCoverLift));P9(B,x,A);const U=Number.MAX_VALUE,j=[-U,-U,-U],R=[U,U,U];if(T.contains(g.center)){for(const Ye of B)Pe.vec3.min(R,R,Ye),Pe.vec3.max(j,j,Ye);j[2]=0;const Oe=g.point,Re=[Oe.x*A,Oe.y*A,0];return Pe.vec3.min(R,R,Re),Pe.vec3.max(j,j,Re),new Ki(R,j)}if(g._tileCoverLift>0){for(const Oe of B)Pe.vec3.min(R,R,Oe),Pe.vec3.max(j,j,Oe);return new Ki(R,j)}const N=[x[12]*A,x[13]*A,x[14]*A],V=T.getCenter(),z=jt(g.center.lat,-Ke,Ke),G=jt(V.lat,-Ke,Ke),X=ke(g.center.lng),K=Ne(z);let te=X-ke(V.lng);const ce=K-Ne(G);te>.5?te-=1:te<-.5&&(te+=1);let he=0;if(Math.abs(te)>Math.abs(ce))he=te>=0?1:3;else{he=ce>=0?0:2;const Oe=[x[4]*A,x[5]*A,x[6]*A],Re=-Math.sin(sn(ce>=0?T.getSouth():T.getNorth()))*u;Pe.vec3.scaleAndAdd(N,N,Oe,Re)}const ne=B[he],de=B[(he+1)%4],ge=new Mue(ne,de,N),Me=[A3(ge,0)||ne[0],A3(ge,1)||ne[1],A3(ge,2)||ne[2]],Be=Yg(g.zoom);if(Be>0){const Oe=function({x:Ye,y:ze,z:Qe},ct,ht,ft,mt){const Et=1/(1<<Qe);let vt=Ye*Et,Ut=vt+Et,Yt=ze*Et,Dt=Yt+Et,Rn=0;const bn=(vt+Ut)/2-ft;return bn>.5?Rn=-1:bn<-.5&&(Rn=1),vt=((vt+Rn)*ct-(ft*=ct))*ht+ft,Ut=((Ut+Rn)*ct-ft)*ht+ft,Yt=(Yt*ct-(mt*=ct))*ht+mt,Dt=(Dt*ct-mt)*ht+mt,[[vt,Dt,0],[Ut,Dt,0],[Ut,Yt,0],[vt,Yt,0]]}(f,c,g._pixelsPerMercatorPixel,X,K);for(let Ye=0;Ye<B.length;Ye++)om(B[Ye],Oe[Ye],Be);const Re=Pe.vec3.add([],Oe[he],Oe[(he+1)%4]);Pe.vec3.scale(Re,Re,.5),om(Me,Re,Be)}for(const Oe of B)Pe.vec3.min(R,R,Oe),Pe.vec3.max(j,j,Oe);return R[2]=Math.min(ne[2],de[2]),Pe.vec3.min(R,R,Me),Pe.vec3.max(j,j,Me),new Ki(R,j)}function SM({x:g,y:c,z:f},_=!1){const A=1/(1<<f),x=new ue(We(g*A),c===(1<<f)-1&&_?-90:He((c+1)*A)),T=new ue(We((g+1)*A),c===0&&_?90:He(c*A));return new ve(x,T)}function T3(g,c=u){const f=sn(g.getNorth()),_=sn(g.getSouth()),A=Math.cos(f),x=Math.cos(_),T=Math.sin(f),B=Math.sin(_),U=g.getWest(),j=g.getEast();return[J(x,B,U,c),J(x,B,j,c),J(A,T,j,c),J(A,T,U,c)]}function Fw(g,c,f,_){const A=1<<f.z,x=(g/yn+f.x)/A;return Q(He((c/yn+f.y)/A),We(x),_)}function AM({min:g,max:c}){return I/Math.max(c[0]-g[0],c[1]-g[1],c[2]-g[2])}const D9=new Float64Array(16);function TM(g){const c=AM(g),f=Pe.mat4.fromScaling(D9,[c,c,c]);return Pe.mat4.translate(f,f,Pe.vec3.negate([],g.min))}function M3(g){const c=Pe.mat4.fromTranslation(D9,g.min),f=1/AM(g);return Pe.mat4.scale(c,c,[f,f,f])}function C3(g){const c=yn/(2*Math.PI);return g/(2*Math.PI)/c}function B9(g,c){return yn/(512*Math.pow(2,g))*AM(Nd(c))}function k9(g,c,f,_,A){const x=C3(f),T=[g,c,-f/(2*Math.PI)],B=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.translate(B,B,T),Pe.mat4.scale(B,B,[x,x,x]),Pe.mat4.rotateX(B,B,sn(-A)),Pe.mat4.rotateY(B,B,sn(-_)),B}function Yg(g){return mr(p,w,g)}function O9(g,c){const f=Q(c.lat,c.lng),_=function(x){const T=Q(x._center.lat,x._center.lng),B=Pe.vec3.fromValues(0,1,0);let U=Pe.vec3.cross([],B,T);const j=Pe.mat4.fromRotation([],-x.angle,T);U=Pe.vec3.transformMat4(U,U,j),Pe.mat4.fromRotation(j,-x._pitch,U);const R=Pe.vec3.normalize([],T);return Pe.vec3.scale(R,R,sm(x.cameraToCenterDistance/x.pixelsPerMeter)),Pe.vec3.transformMat4(R,R,j),Pe.vec3.add([],T,R)}(g),A=Pe.vec3.subtract([],_,f);return Pe.vec3.angle(A,f)}function E3(g,c){return O9(g,c)>Math.PI/2*1.01}const F9=sn(85),Cue=Math.cos(F9),Eue=Math.sin(F9),Iue=Pe.mat4.create(),N9=g=>{const c=[];return g.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c};function z9(g,c,f,_,A,x,T,B,U){if(x&&g.queryGeometry.isAboveHorizon)return!1;x&&(U*=g.pixelToTileUnitsFactor);const j=g.tileID.canonical,R=f.projection.upVectorScale(j,f.center.lat,f.worldSize).metersToTile;for(const N of c)for(const V of N){const z=V.add(B),G=A&&f.elevation?f.elevation.exaggeration()*A.getElevationAt(z.x,z.y,!0):0,X=f.projection.projectTilePoint(z.x,z.y,j);if(G>0){const he=f.projection.upVector(j,z.x,z.y);X.x+=he[0]*R*G,X.y+=he[1]*R*G,X.z+=he[2]*R*G}const K=x?z:Rue(X.x,X.y,X.z,_),te=x?g.tilespaceRays.map(he=>Lue(he,G)):g.queryGeometry.screenGeometry,ce=Pe.vec4.transformMat4([],[X.x,X.y,X.z,1],_);if(!T&&x?U*=ce[3]/f.cameraToCenterDistance:T&&!x&&(U*=f.cameraToCenterDistance/ce[3]),x){const he=He((V.y/yn+j.y)/(1<<j.z));U/=f.projection.pixelsPerMeter(he,1)/De(1,he)}if(Dn(te,K,U))return!0}return!1}function Rue(g,c,f,_){const A=Pe.vec4.transformMat4([],[g,c,f,1],_);return new St(A[0]/A[3],A[1]/A[3])}const U9=Pe.vec3.fromValues(0,0,0),Pue=Pe.vec3.fromValues(0,0,1);function Lue(g,c){const f=Pe.vec3.create();return U9[2]=c,g.intersectsPlane(U9,Pue,f),new St(f[0],f[1])}class G9 extends er{}let V9,H9,j9,W9;function X9(g,{width:c,height:f},_,A){if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==c*f*_)throw new RangeError("mismatched image size")}else A=new Uint8Array(c*f*_);return g.width=c,g.height=f,g.data=A,g}function $9(g,c,f){const{width:_,height:A}=c;_===g.width&&A===g.height||(I3(g,c,{x:0,y:0},{x:0,y:0},{width:Math.min(g.width,_),height:Math.min(g.height,A)},f,null),g.width=_,g.height=A,g.data=c.data)}function I3(g,c,f,_,A,x,T,B){if(A.width===0||A.height===0)return c;if(A.width>g.width||A.height>g.height||f.x>g.width-A.width||f.y>g.height-A.height)throw new RangeError("out of range source coordinates for image copy");if(A.width>c.width||A.height>c.height||_.x>c.width-A.width||_.y>c.height-A.height)throw new RangeError("out of range destination coordinates for image copy");const U=g.data,j=c.data,R=x===4&&B;for(let N=0;N<A.height;N++){const V=((f.y+N)*g.width+f.x)*x,z=((_.y+N)*c.width+_.x)*x;if(R)for(let G=0;G<A.width;G++){const X=V+G*x+3,K=z+G*x;j[K+0]=255,j[K+1]=255,j[K+2]=255,j[K+3]=U[X]}else if(T)for(let G=0;G<A.width;G++){const X=V+G*x,K=z+G*x,te=U[X+3],ce=new vr(U[X+0]/255*te,U[X+1]/255*te,U[X+2]/255*te,te).toRenderColor(T).toArray();j[K+0]=ce[0],j[K+1]=ce[1],j[K+2]=ce[2],j[K+3]=ce[3]}else for(let G=0;G<A.width*x;G++)j[z+G]=U[V+G]}return c}Fn(G9,"HeatmapBucket",{omit:["layers"]});class Kg{constructor(c,f){X9(this,c,1,f)}resize(c){$9(this,new Kg(c),1)}clone(){return new Kg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,f,_,A,x){I3(c,f,_,A,x,1,null)}}class gl{constructor(c,f){X9(this,c,4,f)}resize(c){$9(this,new gl(c),4)}replace(c,f){f?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new gl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,f,_,A,x,T,B){I3(c,f,_,A,x,4,T,B)}}class q9{constructor(c,f){this.width=c.width,this.height=c.height,this.data=f instanceof Uint8Array?new Float32Array(f.buffer):f}}function Nw(g){const c={},f=g.resolution||256,_=g.clips?g.clips.length:1,A=g.image||new gl({width:f,height:_}),x=(T,B,U)=>{c[g.evaluationKey]=U;const j=g.expression.evaluate(c);j&&(A.data[T+B+0]=Math.floor(255*j.r/j.a),A.data[T+B+1]=Math.floor(255*j.g/j.a),A.data[T+B+2]=Math.floor(255*j.b/j.a),A.data[T+B+3]=Math.floor(255*j.a))};if(g.clips)for(let T=0,B=0;T<_;++T,B+=4*f)for(let U=0,j=0;U<f;U++,j+=4){const R=U/(f-1),{start:N,end:V}=g.clips[T];x(B,j,N*(1-R)+V*R)}else for(let T=0,B=0;T<f;T++,B+=4)x(0,B,T/(f-1));return A}Fn(Kg,"AlphaImage"),Fn(gl,"RGBAImage");const Due=Qr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bue}=Due;function zw(g,c,f=2){const _=c&&c.length,A=_?c[0]*f:g.length;let x=Z9(g,0,A,f,!0);const T=[];if(!x||x.next===x.prev)return T;let B,U,j;if(_&&(x=function(R,N,V,z){const G=[];for(let X=0,K=N.length;X<K;X++){const te=Z9(R,N[X]*z,X<K-1?N[X+1]*z:R.length,z,!1);te===te.next&&(te.steiner=!0),G.push(Vue(te))}G.sort(zue);for(let X=0;X<G.length;X++)V=Uue(G[X],V);return V}(g,c,x,f)),g.length>80*f){B=1/0,U=1/0;let R=-1/0,N=-1/0;for(let V=f;V<A;V+=f){const z=g[V],G=g[V+1];z<B&&(B=z),G<U&&(U=G),z>R&&(R=z),G>N&&(N=G)}j=Math.max(R-B,N-U),j=j!==0?32767/j:0}return Uw(x,T,f,B,U,j,0),T}function Z9(g,c,f,_,A){let x;if(A===function(T,B,U,j){let R=0;for(let N=B,V=U-j;N<U;N+=j)R+=(T[V]-T[N])*(T[N+1]+T[V+1]),V=N;return R}(g,c,f,_)>0)for(let T=c;T<f;T+=_)x=J9(T/_|0,g[T],g[T+1],x);else for(let T=f-_;T>=c;T-=_)x=J9(T/_|0,g[T],g[T+1],x);return x&&MM(x,x.next)&&(Vw(x),x=x.next),x}function u_(g,c){if(!g)return g;c||(c=g);let f,_=g;do if(f=!1,_.steiner||!MM(_,_.next)&&zo(_.prev,_,_.next)!==0)_=_.next;else{if(Vw(_),_=c=_.prev,_===_.next)break;f=!0}while(f||_!==c);return c}function Uw(g,c,f,_,A,x,T){if(!g)return;!T&&x&&function(U,j,R,N){let V=U;do V.z===0&&(V.z=R3(V.x,V.y,j,R,N)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==U);V.prevZ.nextZ=null,V.prevZ=null,function(z){let G,X=1;do{let K,te=z;z=null;let ce=null;for(G=0;te;){G++;let he=te,ne=0;for(let ge=0;ge<X&&(ne++,he=he.nextZ,he);ge++);let de=X;for(;ne>0||de>0&&he;)ne!==0&&(de===0||!he||te.z<=he.z)?(K=te,te=te.nextZ,ne--):(K=he,he=he.nextZ,de--),ce?ce.nextZ=K:z=K,K.prevZ=ce,ce=K;te=he}ce.nextZ=null,X*=2}while(G>1)}(V)}(g,_,A,x);let B=g;for(;g.prev!==g.next;){const U=g.prev,j=g.next;if(x?Oue(g,_,A,x):kue(g))c.push(U.i,g.i,j.i),Vw(g),g=j.next,B=j.next;else if((g=j)===B){T?T===1?Uw(g=Fue(u_(g),c),c,f,_,A,x,2):T===2&&Nue(g,c,f,_,A,x):Uw(u_(g),c,f,_,A,x,1);break}}}function kue(g){const c=g.prev,f=g,_=g.next;if(zo(c,f,_)>=0)return!1;const A=c.x,x=f.x,T=_.x,B=c.y,U=f.y,j=_.y,R=A<x?A<T?A:T:x<T?x:T,N=B<U?B<j?B:j:U<j?U:j,V=A>x?A>T?A:T:x>T?x:T,z=B>U?B>j?B:j:U>j?U:j;let G=_.next;for(;G!==c;){if(G.x>=R&&G.x<=V&&G.y>=N&&G.y<=z&&V1(A,B,x,U,T,j,G.x,G.y)&&zo(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function Oue(g,c,f,_){const A=g.prev,x=g,T=g.next;if(zo(A,x,T)>=0)return!1;const B=A.x,U=x.x,j=T.x,R=A.y,N=x.y,V=T.y,z=B<U?B<j?B:j:U<j?U:j,G=R<N?R<V?R:V:N<V?N:V,X=B>U?B>j?B:j:U>j?U:j,K=R>N?R>V?R:V:N>V?N:V,te=R3(z,G,c,f,_),ce=R3(X,K,c,f,_);let he=g.prevZ,ne=g.nextZ;for(;he&&he.z>=te&&ne&&ne.z<=ce;){if(he.x>=z&&he.x<=X&&he.y>=G&&he.y<=K&&he!==A&&he!==T&&V1(B,R,U,N,j,V,he.x,he.y)&&zo(he.prev,he,he.next)>=0||(he=he.prevZ,ne.x>=z&&ne.x<=X&&ne.y>=G&&ne.y<=K&&ne!==A&&ne!==T&&V1(B,R,U,N,j,V,ne.x,ne.y)&&zo(ne.prev,ne,ne.next)>=0))return!1;ne=ne.nextZ}for(;he&&he.z>=te;){if(he.x>=z&&he.x<=X&&he.y>=G&&he.y<=K&&he!==A&&he!==T&&V1(B,R,U,N,j,V,he.x,he.y)&&zo(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;ne&&ne.z<=ce;){if(ne.x>=z&&ne.x<=X&&ne.y>=G&&ne.y<=K&&ne!==A&&ne!==T&&V1(B,R,U,N,j,V,ne.x,ne.y)&&zo(ne.prev,ne,ne.next)>=0)return!1;ne=ne.nextZ}return!0}function Fue(g,c){let f=g;do{const _=f.prev,A=f.next.next;!MM(_,A)&&Y9(_,f,f.next,A)&&Gw(_,A)&&Gw(A,_)&&(c.push(_.i,f.i,A.i),Vw(f),Vw(f.next),f=g=A),f=f.next}while(f!==g);return u_(f)}function Nue(g,c,f,_,A,x){let T=g;do{let B=T.next.next;for(;B!==T.prev;){if(T.i!==B.i&&Hue(T,B)){let U=K9(T,B);return T=u_(T,T.next),U=u_(U,U.next),Uw(T,c,f,_,A,x,0),void Uw(U,c,f,_,A,x,0)}B=B.next}T=T.next}while(T!==g)}function zue(g,c){return g.x-c.x}function Uue(g,c){const f=function(A,x){let T=x;const B=A.x,U=A.y;let j,R=-1/0;do{if(U<=T.y&&U>=T.next.y&&T.next.y!==T.y){const X=T.x+(U-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(X<=B&&X>R&&(R=X,j=T.x<T.next.x?T:T.next,X===B))return j}T=T.next}while(T!==x);if(!j)return null;const N=j,V=j.x,z=j.y;let G=1/0;T=j;do{if(B>=T.x&&T.x>=V&&B!==T.x&&V1(U<z?B:R,U,V,z,U<z?R:B,U,T.x,T.y)){const X=Math.abs(U-T.y)/(B-T.x);Gw(T,A)&&(X<G||X===G&&(T.x>j.x||T.x===j.x&&Gue(j,T)))&&(j=T,G=X)}T=T.next}while(T!==N);return j}(g,c);if(!f)return c;const _=K9(f,g);return u_(_,_.next),u_(f,f.next)}function Gue(g,c){return zo(g.prev,g,c.prev)<0&&zo(c.next,g,g.next)<0}function R3(g,c,f,_,A){return(g=1431655765&((g=858993459&((g=252645135&((g=16711935&((g=(g-f)*A|0)|g<<8))|g<<4))|g<<2))|g<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-_)*A|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function Vue(g){let c=g,f=g;do(c.x<f.x||c.x===f.x&&c.y<f.y)&&(f=c),c=c.next;while(c!==g);return f}function V1(g,c,f,_,A,x,T,B){return(A-T)*(c-B)>=(g-T)*(x-B)&&(g-T)*(_-B)>=(f-T)*(c-B)&&(f-T)*(x-B)>=(A-T)*(_-B)}function Hue(g,c){return g.next.i!==c.i&&g.prev.i!==c.i&&!function(f,_){let A=f;do{if(A.i!==f.i&&A.next.i!==f.i&&A.i!==_.i&&A.next.i!==_.i&&Y9(A,A.next,f,_))return!0;A=A.next}while(A!==f);return!1}(g,c)&&(Gw(g,c)&&Gw(c,g)&&function(f,_){let A=f,x=!1;const T=(f.x+_.x)/2,B=(f.y+_.y)/2;do A.y>B!=A.next.y>B&&A.next.y!==A.y&&T<(A.next.x-A.x)*(B-A.y)/(A.next.y-A.y)+A.x&&(x=!x),A=A.next;while(A!==f);return x}(g,c)&&(zo(g.prev,g,c.prev)||zo(g,c.prev,c))||MM(g,c)&&zo(g.prev,g,g.next)>0&&zo(c.prev,c,c.next)>0)}function zo(g,c,f){return(c.y-g.y)*(f.x-c.x)-(c.x-g.x)*(f.y-c.y)}function MM(g,c){return g.x===c.x&&g.y===c.y}function Y9(g,c,f,_){const A=EM(zo(g,c,f)),x=EM(zo(g,c,_)),T=EM(zo(f,_,g)),B=EM(zo(f,_,c));return A!==x&&T!==B||!(A!==0||!CM(g,f,c))||!(x!==0||!CM(g,_,c))||!(T!==0||!CM(f,g,_))||!(B!==0||!CM(f,c,_))}function CM(g,c,f){return c.x<=Math.max(g.x,f.x)&&c.x>=Math.min(g.x,f.x)&&c.y<=Math.max(g.y,f.y)&&c.y>=Math.min(g.y,f.y)}function EM(g){return g>0?1:g<0?-1:0}function Gw(g,c){return zo(g.prev,g,g.next)<0?zo(g,c,g.next)>=0&&zo(g,g.prev,c)>=0:zo(g,c,g.prev)<0||zo(g,g.next,c)<0}function K9(g,c){const f=P3(g.i,g.x,g.y),_=P3(c.i,c.x,c.y),A=g.next,x=c.prev;return g.next=c,c.prev=g,f.next=A,A.prev=f,_.next=f,f.prev=_,x.next=_,_.prev=x,_}function J9(g,c,f,_){const A=P3(g,c,f);return _?(A.next=_.next,A.prev=_,_.next.prev=A,_.next=A):(A.prev=A,A.next=A),A}function Vw(g){g.next.prev=g.prev,g.prev.next=g.next,g.prevZ&&(g.prevZ.nextZ=g.nextZ),g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function P3(g,c,f){return{i:g,x:c,y:f,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function IM(g,c){const f=g.length;if(f<=1)return[g];const _=[];let A,x;for(let T=0;T<f;T++){const B=un(g[T]);B!==0&&(g[T].area=Math.abs(B),x===void 0&&(x=B<0),x===B<0?(A&&_.push(A),A=[g[T]]):A.push(g[T]))}if(A&&_.push(A),c>1)for(let T=0;T<_.length;T++)_[T].length<=c||(Fv(_[T],c,1,_[T].length-1,jue),_[T]=_[T].slice(0,c));return _}function jue(g,c){return c.area-g.area}function L3(g,c,f){const _=f.patternDependencies;let A=!1;for(const x of c){const T=x.paint.get(`${g}-pattern`);T.isConstant()||(A=!0);const B=T.constantOr(null);B&&(A=!0,_[B]=!0)}return A}function D3(g,c,f,_,A){const x=A.patternDependencies;for(const T of c){const B=T.paint.get(`${g}-pattern`).value;if(B.kind!=="constant"){let U=B.evaluate({zoom:_},f,{},A.availableImages);U=U&&U.name?U.name:U,x[U]=!0,f.patterns[T.id]=U}}return f}class B3{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cc,this.indexArray=new wo,this.indexArray2=new Su,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.segments=new bs,this.segments2=new bs,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.projection=c.projection}updateFootprints(c,f){}populate(c,f,_,A){this.hasPattern=L3("fill",this.layers,f);const x=this.layers[0].layout.get("fill-sort-key"),T=[];for(const{feature:B,id:U,index:j,sourceLayerIndex:R}of c){const N=this.layers[0]._featureFilter.needGeometry,V=pn(B,N);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),V,_))continue;const z=x?x.evaluate(V,{},_,f.availableImages):void 0,G={id:U,properties:B.properties,type:B.type,sourceLayerIndex:R,index:j,geometry:N?V.geometry:fn(B,_,A),patterns:{},sortKey:z};T.push(G)}x&&T.sort((B,U)=>B.sortKey-U.sortKey);for(const B of T){const{geometry:U,index:j,sourceLayerIndex:R}=B;if(this.hasPattern){const N=D3("fill",this.layers,B,this.zoom,f);this.patternFeatures.push(N)}else this.addFeature(B,U,j,_,{},f.availableImages,f.brightness);f.featureIndex.insert(c[j].feature,U,j,R,this.index)}}update(c,f,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,f,T?this.stateDependentLayers:this.layers,_,A,x)}addFeatures(c,f,_,A,x,T){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,f,_,A,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Bue),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,f,_,A,x,T=[],B){for(const U of IM(f,500)){let j=0;for(const X of U)j+=X.length;const R=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),N=R.vertexLength,V=[],z=[];for(const X of U){if(X.length===0)continue;X!==U[0]&&z.push(V.length/2);const K=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),te=K.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(te+X.length-1,te),V.push(X[0].x),V.push(X[0].y);for(let ce=1;ce<X.length;ce++)this.layoutVertexArray.emplaceBack(X[ce].x,X[ce].y),this.indexArray2.emplaceBack(te+ce-1,te+ce),V.push(X[ce].x),V.push(X[ce].y);K.vertexLength+=X.length,K.primitiveLength+=X.length}const G=zw(V,z);for(let X=0;X<G.length;X+=3)this.indexArray.emplaceBack(N+G[X],N+G[X+1],N+G[X+2]);R.vertexLength+=j,R.primitiveLength+=G.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,B)}}let Q9,e7,t7,n7;Fn(B3,"FillBucket",{omit:["layers","patternFeatures"]});class k3{constructor(c,f,_,A){if(this.triangleCount=f.length/3,this.min=new St(0,0),this.max=new St(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||c.length===0)return;const[x,T]=[c[0].clone(),c[0].clone()];for(let N=1;N<c.length;++N){const V=c[N];x.x=Math.min(x.x,V.x),x.y=Math.min(x.y,V.y),T.x=Math.max(T.x,V.x),T.y=Math.max(T.y,V.y)}if(A){const N=Math.ceil(Math.max(T.x-x.x,T.y-x.y)/A);_=Math.max(_,N)}if(_===0)return;this.min=x,this.max=T;const B=this.max.sub(this.min);B.x=Math.max(B.x,1),B.y=Math.max(B.y,1);const U=Math.max(B.x,B.y)/_;this.cellsX=Math.max(1,Math.ceil(B.x/U)),this.cellsY=Math.max(1,Math.ceil(B.y/U)),this.xScale=1/U,this.yScale=1/U;const j=[];for(let N=0;N<this.triangleCount;N++){const V=c[f[3*N+0]].sub(this.min),z=c[f[3*N+1]].sub(this.min),G=c[f[3*N+2]].sub(this.min),X=zd(Math.floor(Math.min(V.x,z.x,G.x)),this.xScale,this.cellsX),K=zd(Math.floor(Math.max(V.x,z.x,G.x)),this.xScale,this.cellsX),te=zd(Math.floor(Math.min(V.y,z.y,G.y)),this.yScale,this.cellsY),ce=zd(Math.floor(Math.max(V.y,z.y,G.y)),this.yScale,this.cellsY),he=new St(0,0),ne=new St(0,0),de=new St(0,0),ge=new St(0,0);for(let Me=te;Me<=ce;++Me){he.y=ne.y=Me*U,de.y=ge.y=(Me+1)*U;for(let Be=X;Be<=K;++Be)he.x=de.x=Be*U,ne.x=ge.x=(Be+1)*U,(Fi(V,z,G,he,ne,ge)||Fi(V,z,G,he,ge,de))&&j.push({cellIdx:Me*this.cellsX+Be,triIdx:N})}}if(j.length===0)return;j.sort((N,V)=>N.cellIdx-V.cellIdx||N.triIdx-V.triIdx);let R=0;for(;R<j.length;){const N=j[R].cellIdx,V={start:this.payload.length,len:0};for(;R<j.length&&j[R].cellIdx===N;)++V.len,this.payload.push(j[R++].triIdx);this.cells[N]=V}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(c,f){if(this.triangleCount===0||this.cells.length===0||c.x>this.max.x||this.min.x>c.x||c.y>this.max.y||this.min.y>c.y)return;const _=zd(c.x-this.min.x,this.xScale,this.cellsX),A=zd(c.y-this.min.y,this.yScale,this.cellsY),x=this.cells[A*this.cellsX+_];if(x){this._lazyInitLookup();for(let T=0;T<x.len;T++){const B=this.payload[x.start+T],U=Math.floor(B/8),j=1<<B%8;if(!(this.lookup[U]&j)&&(this.lookup[U]|=j,f.push(B),f.length===this.triangleCount))return}}}query(c,f,_){if(this.triangleCount===0||this.cells.length===0||c.x>this.max.x||this.min.x>f.x||c.y>this.max.y||this.min.y>f.y)return;this._lazyInitLookup();const A=zd(c.x-this.min.x,this.xScale,this.cellsX),x=zd(f.x-this.min.x,this.xScale,this.cellsX),T=zd(c.y-this.min.y,this.yScale,this.cellsY),B=zd(f.y-this.min.y,this.yScale,this.cellsY);for(let U=T;U<=B;U++)for(let j=A;j<=x;j++){const R=this.cells[U*this.cellsX+j];if(R)for(let N=0;N<R.len;N++){const V=this.payload[R.start+N],z=Math.floor(V/8),G=1<<V%8;if(!(this.lookup[z]&G)&&(this.lookup[z]|=G,_.push(V),_.length===this.triangleCount))return}}}}function zd(g,c,f){return Math.max(0,Math.min(f-1,Math.floor(g*c)))}Fn(k3,"TriangleGridIndex");class r7{constructor(c){this.zoom=c.zoom,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=c.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.footprints=[]}updateFootprints(c,f){for(const _ of this.footprints)f.push({footprint:_,id:c})}populate(c,f,_,A){const x=[];for(const{feature:T,id:B,index:U,sourceLayerIndex:j}of c){const R=this.layers[0]._featureFilter.needGeometry,N=pn(T,R);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),N,_))continue;const V={id:B,properties:T.properties,type:T.type,sourceLayerIndex:j,index:U,geometry:R?N.geometry:fn(T,_,A),patterns:{}};x.push(V)}for(const T of x){const{geometry:B,index:U,sourceLayerIndex:j}=T;this.addFeature(T,B,U,_,{},f.availableImages,f.brightness),f.featureIndex.insert(c[U].feature,B,U,j,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(c){}update(c,f,_,A,x){}destroy(){}addFeature(c,f,_,A,x,T=[],B){for(const U of IM(f,2)){const j=[],R=[],N=[],V=new St(1/0,1/0),z=new St(-1/0,-1/0);for(const K of U)if(K.length!==0){K!==U[0]&&N.push(R.length/2);for(let te=0;te<K.length;te++)R.push(K[te].x),R.push(K[te].y),j.push(K[te]),V.x=Math.min(V.x,K[te].x),V.y=Math.min(V.y,K[te].y),z.x=Math.max(z.x,K[te].x),z.y=Math.max(z.y,K[te].y)}const G=zw(R,N),X=new k3(j,G,8,256);this.footprints.push({vertices:j,indices:G,grid:X,min:V,max:z})}}}Fn(r7,"ClipBucket",{omit:["layers"]});const Wue=Qr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Xue=Qr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),$ue=Qr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),que=Qr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Zue=Qr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Yue=Qr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Kue}=Wue;var O3,i7,F3,s7,N3,o7,a7,RM={};function l7(){if(i7)return O3;i7=1;var g=cn();function c(A,x,T,B,U){this.properties={},this.extent=T,this.type=0,this._pbf=A,this._geometry=-1,this._keys=B,this._values=U,A.readFields(f,this,x)}function f(A,x,T){A==1?x.id=T.readVarint():A==2?function(B,U){for(var j=B.readVarint()+B.pos;B.pos<j;){var R=U._keys[B.readVarint()],N=U._values[B.readVarint()];U.properties[R]=N}}(T,x):A==3?x.type=T.readVarint():A==4&&(x._geometry=T.pos)}function _(A){for(var x,T,B=0,U=0,j=A.length,R=j-1;U<j;R=U++)B+=((T=A[R]).x-(x=A[U]).x)*(x.y+T.y);return B}return O3=c,c.types=["Unknown","Point","LineString","Polygon"],c.prototype.loadGeometry=function(){var A=this._pbf;A.pos=this._geometry;for(var x,T=A.readVarint()+A.pos,B=1,U=0,j=0,R=0,N=[];A.pos<T;){if(U<=0){var V=A.readVarint();B=7&V,U=V>>3}if(U--,B===1||B===2)j+=A.readSVarint(),R+=A.readSVarint(),B===1&&(x&&N.push(x),x=[]),x.push(new g(j,R));else{if(B!==7)throw new Error("unknown command "+B);x&&x.push(x[0].clone())}}return x&&N.push(x),N},c.prototype.bbox=function(){var A=this._pbf;A.pos=this._geometry;for(var x=A.readVarint()+A.pos,T=1,B=0,U=0,j=0,R=1/0,N=-1/0,V=1/0,z=-1/0;A.pos<x;){if(B<=0){var G=A.readVarint();T=7&G,B=G>>3}if(B--,T===1||T===2)(U+=A.readSVarint())<R&&(R=U),U>N&&(N=U),(j+=A.readSVarint())<V&&(V=j),j>z&&(z=j);else if(T!==7)throw new Error("unknown command "+T)}return[R,V,N,z]},c.prototype.toGeoJSON=function(A,x,T){var B,U,j=this.extent*Math.pow(2,T),R=this.extent*A,N=this.extent*x,V=this.loadGeometry(),z=c.types[this.type];function G(te){for(var ce=0;ce<te.length;ce++){var he=te[ce];te[ce]=[360*(he.x+R)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+N)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(B=0;B<V.length;B++)X[B]=V[B][0];G(V=X);break;case 2:for(B=0;B<V.length;B++)G(V[B]);break;case 3:for(V=function(te){var ce=te.length;if(ce<=1)return[te];for(var he,ne,de=[],ge=0;ge<ce;ge++){var Me=_(te[ge]);Me!==0&&(ne===void 0&&(ne=Me<0),ne===Me<0?(he&&de.push(he),he=[te[ge]]):he.push(te[ge]))}return he&&de.push(he),de}(V),B=0;B<V.length;B++)for(U=0;U<V[B].length;U++)G(V[B][U])}V.length===1?V=V[0]:z="Multi"+z;var K={type:"Feature",geometry:{type:z,coordinates:V},properties:this.properties};return"id"in this&&(K.id=this.id),K},O3}function c7(){if(s7)return F3;s7=1;var g=l7();function c(_,A){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=_,this._keys=[],this._values=[],this._features=[],_.readFields(f,this,A),this.length=this._features.length}function f(_,A,x){_===15?A.version=x.readVarint():_===1?A.name=x.readString():_===5?A.extent=x.readVarint():_===2?A._features.push(x.pos):_===3?A._keys.push(x.readString()):_===4&&A._values.push(function(T){for(var B=null,U=T.readVarint()+T.pos;T.pos<U;){var j=T.readVarint()>>3;B=j===1?T.readString():j===2?T.readFloat():j===3?T.readDouble():j===4?T.readVarint64():j===5?T.readVarint():j===6?T.readSVarint():j===7?T.readBoolean():null}return B}(x))}return F3=c,c.prototype.feature=function(_){if(_<0||_>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[_];var A=this._pbf.readVarint()+this._pbf.pos;return new g(this._pbf,A,this.extent,this._keys,this._values)},F3}function u7(){return a7||(a7=1,RM.VectorTile=function(){if(o7)return N3;o7=1;var g=c7();function c(f,_,A){if(f===3){var x=new g(A,A.readVarint()+A.pos);x.length&&(_[x.name]=x)}}return N3=function(f,_){this.layers=f.readFields(c,{},_)},N3}(),RM.VectorTileFeature=l7(),RM.VectorTileLayer=c7()),RM}var H1=u7();class h_ extends St{constructor(c,f,_){super(c,f),this.z=_}}class h7 extends h_{constructor(c,f,_,A){super(c,f,_),this.w=A}}function PM(g,c,f,_){const A=[],x=_===0?(T,B,U,j,R,N)=>{T.push(new St(N,U+(N-B)/(j-B)*(R-U)))}:(T,B,U,j,R,N)=>{T.push(new St(B+(N-U)/(R-U)*(j-B),N))};for(const T of g){const B=[];for(const U of T){if(U.length<=2)continue;const j=[];for(let V=0;V<U.length-1;V++){const z=U[V].x,G=U[V].y,X=U[V+1].x,K=U[V+1].y,te=_===0?z:G,ce=_===0?X:K;te<c?ce>c&&x(j,z,G,X,K,c):te>f?ce<f&&x(j,z,G,X,K,f):j.push(U[V]),ce<c&&te>=c&&x(j,z,G,X,K,c),ce>f&&te<=f&&x(j,z,G,X,K,f)}let R=U[U.length-1];const N=_===0?R.x:R.y;N>=c&&N<=f&&j.push(R),j.length&&(R=j[j.length-1],j[0].x===R.x&&j[0].y===R.y||j.push(j[0]),B.push(j))}B.length&&A.push(B)}return A}function f7(g,c,f,_){const A=f==="x"?"y":"x",x=(_-g[f])/(c[f]-g[f]);g[A]=g[A]+(c[A]-g[A])*x,g[f]=_,g.hasOwnProperty("z")&&(g.z=cr(g.z,c.z,x)),g.hasOwnProperty("w")&&(g.w=cr(g.w,c.w,x))}function d7(g,c,f,_){const A=f,x=_;for(const T of["x","y"]){let B=g,U=c;B[T]>=U[T]&&(B=c,U=g),B[T]<A&&U[T]>A&&f7(B,U,T,A),B[T]<x&&U[T]>x&&f7(U,B,T,x)}}const LM=Number.MAX_SAFE_INTEGER;function p7(g,c,f,_){return g.order<c||g.order===LM||!(g.clipMask&f)||function(A,x){return x.length!==0&&x.find(T=>T===A)===void 0}(_,g.clipScope)}function DM(g,c){return g.x-c.x||g.y-c.y}function m7(g,c){return DM(g.min,c.min)===0&&DM(g.max,c.max)===0}function z3(g,c){return!(g.min.x>c.max.x||g.max.x<c.min.x||g.min.y>c.max.y||g.max.y<c.min.y)}function U3(g,c){if(g.length!==c.length)return!1;for(let f=0;f<g.length;f++)if(g[f].sourceId!==c[f].sourceId||!m7(g[f],c[f])||g[f].order!==c[f].order||g[f].clipMask!==c[f].clipMask||!Jt(g[f].clipScope,c[f].clipScope))return!1;return!0}function g7(g,c,f){const _=1/yn,A=1/(1<<f.canonical.z),x=(c.x*_+f.canonical.x)*A+f.wrap,T=(c.y*_+f.canonical.y)*A;return{min:new St((g.x*_+f.canonical.x)*A+f.wrap,(g.y*_+f.canonical.y)*A),max:new St(x,T)}}function Jue(g,c,f){const _=1<<f.canonical.z,A=((c.x-f.wrap)*_-f.canonical.x)*yn,x=(c.y*_-f.canonical.y)*yn;return{min:new St(((g.x-f.wrap)*_-f.canonical.x)*yn,(g.y*_-f.canonical.y)*yn),max:new St(A,x)}}function v7(g,c,f,_,A,x,T){const B=g.indices,U=g.vertices,j=[];for(let R=_;R<_+A;R+=3){const N=c[f[R+0]+x],V=c[f[R+1]+x],z=c[f[R+2]+x],G=Math.min(N.x,V.x,z.x),X=Math.max(N.x,V.x,z.x),K=Math.min(N.y,V.y,z.y),te=Math.max(N.y,V.y,z.y);j.length=0,g.grid.query(new St(G,K),new St(X,te),j);for(let ce=0;ce<j.length;ce++){const he=j[ce];if(Fi(U[B[3*he+0]],U[B[3*he+1]],U[B[3*he+2]],N,V,z,T))return!0}}return!1}function _7(g,c,f,_){if(!g||!f)return!1;let A=g.vertices;if(!c.canonical.equals(_.canonical)||c.wrap!==_.wrap){if(f.vertices.length<g.vertices.length)return _7(f,_,g,c);const x=c.canonical,T=_.canonical,B=Math.pow(2,T.z-x.z);A=g.vertices.map(U=>new St((U.x+x.x*yn)*B-T.x*yn,(U.y+x.y*yn)*B-T.y*yn))}return v7(f,A,g.indices,0,g.indices.length,0,0)}function y7(g,c,f,_){const A=Math.pow(2,_.z-f.z);return new St((g+f.x*yn)*A-_.x*yn,(c+f.y*yn)*A-_.y*yn)}function x7(g,c){const f=[];c.grid.queryPoint(g,f);const _=c.indices,A=c.vertices;for(let x=0;x<f.length;x++){const T=f[x];if(is([A[_[3*T+0]],A[_[3*T+1]],A[_[3*T+2]]],g))return!0}return!1}const G3=[new St(0,0),new St(yn,0),new St(yn,yn),new St(0,yn)];function b7(g,c){const f=[];let _=[];if(!c||g.length<2)return[g];if(g.length===2)return Qs(g[0],g[1],G3)?[g]:[];for(let A=0;A<g.length+2;A++){const x=g[A%g.length],T=g[(A+1)%g.length],B=Qs(A===0?g[g.length-1]:g[(A-1)%g.length],x,G3),U=Qs(x,T,G3),j=B||U;j&&_.push(x),j&&U||_.length>0&&(_.length>1&&f.push(_),_=[])}return _.length>1&&f.push(_),f}const V3=H1.VectorTileFeature.types,Que=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],ehe=["fill-extrusion-flood-light-ground-radius"],the=Math.pow(2,13),nhe=Math.pow(2,15)-1,w7=new St(0,1),Jg=2147483648;function Hw(g,c,f,_,A,x,T,B){g.emplaceBack((c<<1)+T,(f<<1)+x,(Math.floor(_*the)<<1)+A,Math.round(B))}function jw(g,c,f){g.emplaceBack(c.x*yn,c.y*yn,f?1:0)}function BM(g,c,f,_,A,x){g.emplaceBack(c.x,c.y,(f.x<<1)+_,(f.y<<1)+A,x)}function Ww(g,c,f){g.emplaceBack(c.x,c.y,c.z,f[0]*16384,f[1]*16384,f[2]*16384)}class S7{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class A7{constructor(){this.centroidXY=new St(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new St(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new St(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new St(this.max.x-this.min.x,this.max.y-this.min.y)}}class T7{constructor(){this.acc=new St(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(c,f){c.min.x===Number.MAX_VALUE&&(c.min.x=c.max.x=f.x,c.min.y=c.max.y=f.y)}appendEdge(c,f,_){this.accCount++,this.acc._add(f);let A=!!this.borders;f.x<c.min.x?(c.min.x=f.x,A=!0):f.x>c.max.x&&(c.max.x=f.x,A=!0),f.y<c.min.y?(c.min.y=f.y,A=!0):f.y>c.max.y&&(c.max.y=f.y,A=!0),((f.x===0||f.x===yn)&&f.x===_.x)!=((f.y===0||f.y===yn)&&f.y===_.y)&&this.processBorderOverlap(f,_),A&&this.checkBorderIntersection(f,_)}checkBorderIntersection(c,f){f.x<0!=c.x<0&&this.addBorderIntersection(0,cr(f.y,c.y,(0-f.x)/(c.x-f.x))),f.x>yn!=c.x>yn&&this.addBorderIntersection(1,cr(f.y,c.y,(yn-f.x)/(c.x-f.x))),f.y<0!=c.y<0&&this.addBorderIntersection(2,cr(f.x,c.x,(0-f.y)/(c.y-f.y))),f.y>yn!=c.y>yn&&this.addBorderIntersection(3,cr(f.x,c.x,(yn-f.y)/(c.y-f.y)))}addBorderIntersection(c,f){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const _=this.borders[c];f<_[0]&&(_[0]=f),f>_[1]&&(_[1]=f)}processBorderOverlap(c,f){if(c.x===f.x){if(c.y===f.y)return;const _=c.x===0?0:1;this.addBorderIntersection(_,f.y),this.addBorderIntersection(_,c.y)}else{const _=c.y===0?2:3;this.addBorderIntersection(_,f.x),this.addBorderIntersection(_,c.x)}}centroid(){return this.accCount===0?new St(0,0):new St(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((c,f)=>c+ +(f[0]!==Number.MAX_VALUE),0):0}}function M7(g,c){const f=g.add(c)._unit(),_=jt(g.x*f.x+g.y*f.y,-1,1);var A,x,T;return T=Math.acos(_),Math.min(4,Math.max(-4,Math.tan(T)))/4*nhe*((A=g).x*(x=c).y-A.y*x.x<0?-1:1)}const rhe=[g=>g.x<0,g=>g.x>yn,g=>g.y<0,g=>g.y>yn];function ihe(g,c,f,_){const A=[4];if(_===0)return A;f._mult(_);const x=g.sub(f),T=c.sub(f),B=[g,c,x,T];for(let U=0;U<4;U++)for(const j of B)if(rhe[U](j)){A.push(U);break}return A}class C7{constructor(c){this.vertexArray=new uc,this.indexArray=new wo,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut},f=>ehe.includes(f)),this._segments=new bs,this.hiddenByLandmarkVertexArray=new tm,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new bs}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(c,f,_,A=!1){const x=c.length;if(x>2){let T=Math.max(0,this._segments.get().length-1);const B=this._segments._prepareSegment(4*x,this.vertexArray.length,2*this._segmentToGroundQuads[T].length);let U;T!==this._segments.get().length-1&&(T++,this._segmentToGroundQuads[T]=[],this._segmentToRegionTriCounts[T]=[0,0,0,0,0]);{const j=c[0],R=c[1];U=M7(j.sub(c[x-1])._perp()._unit(),R.sub(j)._perp()._unit())}for(let j=0;j<x;j++){const R=j===x-1?0:j+1,N=c[j],V=c[R],z=c[R===x-1?0:R+1],G=V.sub(N)._perp()._unit(),X=M7(G,z.sub(V)._perp()._unit()),K=U,te=X;if(H3(N,V,f)||A&&R7(N,f)&&R7(V,f)){U=X;continue}const ce=B.vertexLength;BM(this.vertexArray,N,V,1,1,K),BM(this.vertexArray,N,V,1,0,K),BM(this.vertexArray,N,V,0,1,te),BM(this.vertexArray,N,V,0,0,te),B.vertexLength+=4;const he=ihe(N,V,G,_);for(const ne of he)this._segmentToGroundQuads[T].push({id:ce,region:ne}),this._segmentToRegionTriCounts[T][ne]+=2,B.primitiveLength+=2;U=X}}}prepareBorderSegments(){if(!this.hasData())return;const c=this._segments.get(),f=c.length;for(let _=0;_<f;_++)this._segmentToGroundQuads[_].sort((A,x)=>A.region-x.region);for(let _=0;_<f;_++){const A=this._segmentToGroundQuads[_],x=c[_],T=this._segmentToRegionTriCounts[_];T.reduce((U,j)=>U+j,0);let B=0;for(let U=0;U<=4;U++){const j=T[U];if(j!==0){let R=this.regionSegments[U];R||(R=this.regionSegments[U]=new bs);const N={vertexOffset:x.vertexOffset,primitiveOffset:x.primitiveOffset+B,vertexLength:x.vertexLength,primitiveLength:j};R.get().push(N)}B+=j}for(let U=0;U<A.length;U++){const j=A[U].id;this.indexArray.emplaceBack(j,j+1,j+3),this.indexArray.emplaceBack(j,j+3,j+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(c,f,_,A,x,T){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,c,f,_,A,x,T)}upload(c){this.hasData()&&(this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Xue.members),this.indexBuffer=c.createIndexBuffer(this.indexArray))}uploadPaintProperties(c){this.hasData()&&this.programConfigurations.upload(c)}update(c,f,_,A,x,T){this.hasData()&&this.programConfigurations.updatePaintArrays(c,f,_,A,x,T)}updateHiddenByLandmark(c){if(!this.hasData())return;const f=c.groundVertexCount+c.groundVertexArrayOffset;if(c.groundVertexCount===0)return;const _=c.flags&Jg?1:0;for(let A=c.groundVertexArrayOffset;A<f;++A)this.hiddenByLandmarkVertexArray.emplace(A,_);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(c){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=c.createVertexBuffer(this.hiddenByLandmarkVertexArray,Zue.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let c=0;c<=4;c++){const f=this.regionSegments[c];f&&f.destroy()}}}}class kM{constructor(c){this.zoom=c.zoom,this.canonical=c.canonical,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=c.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=c.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new wo,this.footprintVertices=new cc,this.footprintSegments=[],this.layoutVertexArray=new Js,this.centroidVertexArray=new rh,this.wallVertexArray=new im,this.indexArray=new wo,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut},f=>Que.includes(f)),this.segments=new bs,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.groundEffect=new C7(c),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(c,f){}populate(c,f,_,A){this.features=[],this.hasPattern=L3("fill-extrusion",this.layers,f),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=rt(_),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:x,id:T,index:B,sourceLayerIndex:U}of c){const j=this.layers[0]._featureFilter.needGeometry,R=pn(x,j);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),R,_))continue;const N={id:T,sourceLayerIndex:U,index:B,geometry:j?R.geometry:fn(x,_,A),properties:x.properties,type:x.type,patterns:{}},V=this.layoutVertexArray.length,z=V3[N.type]==="Polygon";if(this.hasPattern)this.features.push(D3("fill-extrusion",this.layers,N,this.zoom,f));else if(this.wallMode)for(const G of N.geometry)for(const X of b7(G,z))this.addFeature(N,[X],B,_,{},f.availableImages,A,f.brightness);else this.addFeature(N,N.geometry,B,_,{},f.availableImages,A,f.brightness);f.featureIndex.insert(x,N.geometry,B,U,this.index,V)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(c,f,_,A,x,T){for(const B of this.features){const U=V3[B.type]==="Polygon",{geometry:j}=B;if(this.wallMode)for(const R of j)for(const N of b7(R,U))this.addFeature(B,[N],B.index,f,_,A,x,T);else this.addFeature(B,j,B.index,f,_,A,x,T)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(c,f,_,A,x){const T=Object.keys(c).length!==0;if(T&&!this.stateDependentLayers.length)return;const B=T?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(c,f,B,_,A,x),this.groundEffect.update(c,f,B,_,A,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Kue),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.wallVertexBuffer=c.createVertexBuffer(this.wallVertexArray,que.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=c.createVertexBuffer(this.layoutVertexExtArray,Yue.members,!0)),this.groundEffect.upload(c)),this.groundEffect.uploadPaintProperties(c),this.programConfigurations.upload(c),this.uploaded=!0}uploadCentroid(c){this.groundEffect.uploadHiddenByLandmark(c),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,$ue.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,f,_,A,x,T,B,U){const j=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(c,{})/this.tileToMeter,R=[new St(0,0),new St(yn,yn)],N=B.projection,V=N.name==="globe",z=this.wallMode||V3[c.type]==="Polygon",G=new T7;G.centroidDataIndex=this.centroidData.length;const X=new A7,K=this.layers[0].paint.get("fill-extrusion-base").evaluate(c,{},A)<=0,te=this.layers[0].paint.get("fill-extrusion-height").evaluate(c,{},A);let ce;if(X.height=te,X.vertexArrayOffset=this.layoutVertexArray.length,X.groundVertexArrayOffset=this.groundEffect.vertexArray.length,V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pd),this.wallMode){if(V)return void Lt("Non zero fill-extrusion-line-width is not yet supported on globe.");if(f.length!==1)return;ce=function(Re){const Ye=Re[0].x===Re[Re.length-1].x&&Re[0].y===Re[Re.length-1].y;(function(dn){let tn=0;const nr=dn.length;for(let In=0;In<nr;In++)tn+=(dn[(In+1)%nr].x-dn[In].x)*(dn[(In+1)%nr].y+dn[In].y);return tn>=0})(Re)||(Re=Re.reverse());const Qe={geometry:[],joinNormals:[],indices:[]},ct=[],ht=[],ft=[];let mt=Re.length;if(mt<(Ye?3:2))return Qe;for(;mt>=2&&Re[mt-1].equals(Re[mt-2]);)mt--;let Et,vt,Ut,Yt,Dt,Rn=0;for(;Rn<mt-1&&Re[Rn].equals(Re[Rn+1]);)Rn++;Ye&&(Et=Re[mt-2],Dt=Re[Rn].sub(Et)._unit()._perp());for(let dn=Rn;dn<mt;dn++){if(Ut=dn===mt-1?Ye?Re[Rn+1]:void 0:Re[dn+1],Ut&&Re[dn].equals(Ut))continue;Dt&&(Yt=Dt),Et&&(vt=Et),Et=Re[dn],Dt=Ut?Ut.sub(Et)._unit()._perp():Yt,Yt=Yt||Dt;let tn=Yt.add(Dt);tn.x===0&&tn.y===0||tn._unit();const nr=tn.x*Dt.x+tn.y*Dt.y,In=nr!==0?1/nr:1/0,Nn=Yt.x*Dt.y-Yt.y*Dt.x>0;let wr="miter";const Or=2;wr==="miter"&&In>Or&&(wr="bevel"),wr==="bevel"&&(In>100&&(wr="flipbevel"),In<Or&&(wr="miter"));const Pr=(Lr,jr,Wr,Ui)=>{const Ti=new St(Lr.x,Lr.y),Tr=new St(Lr.x,Lr.y);Ti.x+=jr.x*Ui,Ti.y+=jr.y*Ui,Tr.x-=jr.x*Math.max(Wr,1),Tr.y-=jr.y*Math.max(Wr,1),ft.push(jr),ct.push(Ti),ht.push(Tr)};if(wr==="miter")tn._mult(In),Pr(Et,tn,0,0);else if(wr==="flipbevel")tn=Dt.mult(-1),Pr(Et,tn,0,0),Pr(Et,tn.mult(-1),0,0);else{const Lr=-Math.sqrt(In*In-1),jr=Nn?Lr:0,Wr=Nn?0:Lr;vt&&Pr(Et,Yt,jr,Wr),Ut&&Pr(Et,Dt,jr,Wr)}}Qe.geometry=[...ct,...ht.reverse(),ct[0]],Qe.joinNormals=[...ft,...ft.reverse(),ft[ft.length-1]];const bn=Qe.geometry.length-1;for(let dn=0;dn<bn/2;dn++)if(dn+1<bn/2){let tn=dn,nr=dn+1,In=bn-1-dn,Nn=bn-2-dn;tn=tn===0?bn-1:tn-1,nr=nr===0?bn-1:nr-1,In=In===0?bn-1:In-1,Nn=Nn===0?bn-1:Nn-1,Qe.indices.push(In),Qe.indices.push(nr),Qe.indices.push(tn),Qe.indices.push(In),Qe.indices.push(Nn),Qe.indices.push(nr)}return Qe}(f[0]),f=[ce.geometry]}const he=(Re,Ye)=>Re<(Ye.length-1)/2||Re===Ye.length-1,ne=this.wallMode?[f]:IM(f,500);for(let Re=ne.length-1;Re>=0;Re--){const Ye=ne[Re];(Ye.length===0||(de=Ye[0]).every(ze=>ze.x<=0)||de.every(ze=>ze.x>=yn)||de.every(ze=>ze.y<=0)||de.every(ze=>ze.y>=yn))&&ne.splice(Re,1)}var de;let ge;if(V)ge=B7(ne,R,A);else{ge=[];for(const Re of ne)ge.push({polygon:Re,bounds:R})}const Me=z?this.edgeRadius:0,Be=Me>0&&this.zoom<17,Oe=(Re,Ye)=>{if(Re.length===0)return!1;const ze=Re[Re.length-1];return Ye.x===ze.x&&Ye.y===ze.y};for(const{polygon:Re,bounds:Ye}of ge){let ze=0,Qe=0;for(const mt of Re)z&&!mt[0].equals(mt[mt.length-1])&&mt.push(mt[0]),Qe+=z?mt.length-1:mt.length;const ct=this.segments.prepareSegment((z?5:4)*Qe,this.layoutVertexArray,this.indexArray);X.footprintSegIdx<0&&(X.footprintSegIdx=this.footprintSegments.length),X.polygonSegIdx<0&&(X.polygonSegIdx=this.polygonSegments.length);const ht={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ft=new S7;if(ft.vertexOffset=this.footprintVertices.length,ft.indexOffset=3*this.footprintIndices.length,ft.ringIndices=[],z){const mt=[],Et=[];ze=ct.vertexLength;for(let Ut=0;Ut<Re.length;Ut++){const Yt=Re[Ut];Yt.length&&Ut!==0&&Et.push(mt.length/2);const Dt=[];let Rn,bn;Rn=Yt[1].sub(Yt[0])._perp()._unit(),ft.ringIndices.push(Yt.length-1);for(let dn=1;dn<Yt.length;dn++){const tn=Yt[dn],nr=Yt[dn===Yt.length-1?1:dn+1],In=tn.clone();if(Me){bn=nr.sub(tn)._perp()._unit();const Nn=Rn.add(bn)._unit(),wr=Me*Math.min(4,1/(Rn.x*Nn.x+Rn.y*Nn.y));In.x+=wr*Nn.x,In.y+=wr*Nn.y,In.x=Math.round(In.x),In.y=Math.round(In.y),Rn=bn}if(!K||Me!==0&&!Be||Oe(Dt,In)||Dt.push(In),Hw(this.layoutVertexArray,In.x,In.y,0,0,1,1,0),this.wallMode){const Nn=he(dn,Yt);jw(this.wallVertexArray,ce.joinNormals[dn],!Nn)}ct.vertexLength++,this.footprintVertices.emplaceBack(tn.x,tn.y),mt.push(tn.x,tn.y),V&&Ww(this.layoutVertexExtArray,N.projectTilePoint(In.x,In.y,A),N.upVector(A,In.x,In.y))}K&&(Me===0||Be)&&(Dt.length!==0&&Oe(Dt,Dt[0])&&Dt.pop(),this.groundEffect.addData(Dt,Ye,j))}const vt=this.wallMode?ce.indices:zw(mt,Et);for(let Ut=0;Ut<vt.length;Ut+=3)this.footprintIndices.emplaceBack(ft.vertexOffset+vt[Ut+0],ft.vertexOffset+vt[Ut+1],ft.vertexOffset+vt[Ut+2]),this.indexArray.emplaceBack(ze+vt[Ut],ze+vt[Ut+2],ze+vt[Ut+1]),ct.primitiveLength++;ft.indexCount+=vt.length,ft.vertexCount+=this.footprintVertices.length-ft.vertexOffset}for(let mt=0;mt<Re.length;mt++){const Et=Re[mt];G.startRing(X,Et[0]);let vt=Et.length>4&&P7(Et[Et.length-2],Et[0],Et[1]),Ut=Me?she(Et[Et.length-2],Et[0],Et[1],Me):0;const Yt=[];let Dt,Rn,bn;Rn=Et[1].sub(Et[0])._perp()._unit();let dn=!0;for(let tn=1,nr=0;tn<Et.length;tn++){let In=Et[tn-1],Nn=Et[tn];const wr=Et[tn===Et.length-1?1:tn+1];if(G.appendEdge(X,Nn,In),H3(Nn,In,Ye)){Me&&(Rn=wr.sub(Nn)._perp()._unit(),dn=!dn);continue}const Or=Nn.sub(In)._perp(),Pr=Or.x/(Math.abs(Or.x)+Math.abs(Or.y)),Lr=Or.y>0?1:0,jr=In.dist(Nn);if(nr+jr>32768&&(nr=0),Me){bn=wr.sub(Nn)._perp()._unit();let Tr=I7(In,Nn,wr,E7(Rn,bn),Me);isNaN(Tr)&&(Tr=0);const vi=Nn.sub(In)._unit();In=In.add(vi.mult(Ut))._round(),Nn=Nn.add(vi.mult(-Tr))._round(),Ut=Tr,Rn=bn,K&&this.zoom>=17&&(Oe(Yt,In)||Yt.push(In),Oe(Yt,Nn)||Yt.push(Nn))}const Wr=ct.vertexLength,Ui=Et.length>4&&P7(In,Nn,wr);let Ti=L7(nr,vt,dn);if(Hw(this.layoutVertexArray,In.x,In.y,Pr,Lr,0,0,Ti),Hw(this.layoutVertexArray,In.x,In.y,Pr,Lr,0,1,Ti),this.wallMode){const Tr=he(tn-1,Et),vi=ce.joinNormals[tn-1];jw(this.wallVertexArray,vi,Tr),jw(this.wallVertexArray,vi,Tr)}if(nr+=jr,Ti=L7(nr,Ui,!dn),vt=Ui,Hw(this.layoutVertexArray,Nn.x,Nn.y,Pr,Lr,0,0,Ti),Hw(this.layoutVertexArray,Nn.x,Nn.y,Pr,Lr,0,1,Ti),this.wallMode){const Tr=he(tn,Et),vi=ce.joinNormals[tn];jw(this.wallVertexArray,vi,Tr),jw(this.wallVertexArray,vi,Tr)}if(ct.vertexLength+=4,this.indexArray.emplaceBack(Wr+0,Wr+1,Wr+2),this.indexArray.emplaceBack(Wr+1,Wr+3,Wr+2),ct.primitiveLength+=2,Me){const Tr=ze+(tn===1?Et.length-2:tn-2),vi=tn===1?ze:Tr+1;if(this.indexArray.emplaceBack(Wr+1,Tr,Wr+3),this.indexArray.emplaceBack(Tr,vi,Wr+3),ct.primitiveLength+=2,Dt===void 0&&(Dt=Wr),!H3(wr,Et[tn],Ye)){const bi=tn===Et.length-1?Dt:ct.vertexLength;this.indexArray.emplaceBack(Wr+2,Wr+3,bi),this.indexArray.emplaceBack(Wr+3,bi+1,bi),this.indexArray.emplaceBack(Wr+3,vi,bi+1),ct.primitiveLength+=3}dn=!dn}if(V){const Tr=this.layoutVertexExtArray,vi=N.projectTilePoint(In.x,In.y,A),bi=N.projectTilePoint(Nn.x,Nn.y,A),ss=N.upVector(A,In.x,In.y),js=N.upVector(A,Nn.x,Nn.y);Ww(Tr,vi,ss),Ww(Tr,vi,ss),Ww(Tr,bi,js),Ww(Tr,bi,js)}}z&&(ze+=Et.length-1),K&&Me&&this.zoom>=17&&(Yt.length!==0&&Oe(Yt,Yt[0])&&Yt.pop(),this.groundEffect.addData(Yt,Ye,j,Me>0))}this.footprintSegments.push(ft),ht.triangleCount=this.indexArray.length-ht.triangleArrayOffset,this.polygonSegments.push(ht),++X.footprintSegLen,++X.polygonSegLen}if(X.vertexCount=this.layoutVertexArray.length-X.vertexArrayOffset,X.groundVertexCount=this.groundEffect.vertexArray.length-X.groundVertexArrayOffset,X.vertexCount!==0){if(X.centroidXY=G.borders?w7:this.encodeCentroid(G,X),this.centroidData.push(X),G.borders){this.featuresOnBorder.push(G);const Re=this.featuresOnBorder.length-1;for(let Ye=0;Ye<G.borders.length;Ye++)G.borders[Ye][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ye].push(Re)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,U),this.groundEffect.addPaintPropertiesData(c,_,x,T,A,U),this.maxHeight=Math.max(this.maxHeight,te)}}sortBorders(){for(let c=0;c<this.borderFeatureIndices.length;c++)this.borderFeatureIndices[c].sort((f,_)=>this.featuresOnBorder[f].borders[c][0]-this.featuresOnBorder[_].borders[c][0])}splitToSubtiles(){const c=[];for(let B=0;B<this.centroidData.length;B++){const U=this.centroidData[B],j=+(U.min.y+U.max.y>yn),R=2*j+(+(U.min.x+U.max.x>yn)^j);for(let N=0;N<U.polygonSegLen;N++){const V=U.polygonSegIdx+N;c.push({centroidIdx:B,subtile:R,polygonSegmentIdx:V,triangleSegmentIdx:this.polygonSegments[V].triangleSegIdx})}}const f=new wo;c.sort((B,U)=>B.triangleSegmentIdx===U.triangleSegmentIdx?B.subtile-U.subtile:B.triangleSegmentIdx-U.triangleSegmentIdx);let _=0,A=0,x=0;for(const B of c){if(B.triangleSegmentIdx!==_)break;x++}const T=c.length;for(;A!==c.length;){_=c[A].triangleSegmentIdx;let B=0,U=A,j=A;for(let R=U;R<x&&c[R].subtile===B;R++)j++;for(;U!==x;){const R=c[U];B=R.subtile;const N=this.centroidData[R.centroidIdx].min.clone(),V=this.centroidData[R.centroidIdx].max.clone(),z={vertexOffset:this.segments.segments[_].vertexOffset,primitiveOffset:f.length,vertexLength:this.segments.segments[_].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let G=U;G<j;G++){const X=c[G],K=this.polygonSegments[X.polygonSegmentIdx],te=this.centroidData[X.centroidIdx].min,ce=this.centroidData[X.centroidIdx].max,he=this.indexArray.uint16;for(let ne=K.triangleArrayOffset;ne<K.triangleArrayOffset+K.triangleCount;ne++)f.emplaceBack(he[3*ne],he[3*ne+1],he[3*ne+2]);z.primitiveLength+=K.triangleCount,N.x=Math.min(N.x,te.x),N.y=Math.min(N.y,te.y),V.x=Math.max(V.x,ce.x),V.y=Math.max(V.y,ce.y)}z.primitiveLength>0&&this.triangleSubSegments.push({segment:z,min:N,max:V}),U=j;for(let G=U;G<x&&c[G].subtile===c[U].subtile;G++)j++}A=x;for(let R=A;R<T&&c[R].triangleSegmentIdx===c[A].triangleSegmentIdx;R++)x++}f._trim(),this.indexArray=f}getVisibleSegments(c,f,_){const A=new bs;if(this.wallMode){for(const X of this.triangleSubSegments)A.segments.push(X.segment);return A}let x=0,T=0;const B=1<<c.canonical.z;if(f){const X=f.getMinMaxForTile(c);X&&(x=X.min,T=X.max)}T+=this.maxHeight;const U=c.toUnwrapped();let j;const R=[U.canonical.x/B+U.wrap,U.canonical.y/B],N=[(U.canonical.x+1)/B+U.wrap,(U.canonical.y+1)/B],V=(X,K,te)=>[X[0]*(1-te[0])+K[0]*te[0],X[1]*(1-te[1])+K[1]*te[1]],z=[],G=[];for(const X of this.triangleSubSegments){z[0]=X.min.x/yn,z[1]=X.min.y/yn,G[0]=X.max.x/yn,G[1]=X.max.y/yn;const K=V(R,N,z),te=V(R,N,G);if(new Ki([K[0],K[1],x],[te[0],te[1],T]).intersectsPrecise(_)===0){j&&(A.segments.push(j),j=void 0);continue}const ce=X.segment;j&&j.vertexOffset!==ce.vertexOffset&&(A.segments.push(j),j=void 0),j?(j.vertexLength+=ce.vertexLength,j.primitiveLength+=ce.primitiveLength):j={vertexOffset:ce.vertexOffset,primitiveLength:ce.primitiveLength,vertexLength:ce.vertexLength,primitiveOffset:ce.primitiveOffset,sortKey:void 0,vaos:{}}}return j&&A.segments.push(j),A}encodeCentroid(c,f){const _=c.centroid(),A=f.span(),x=Math.min(7,Math.round(A.x*this.tileToMeter/10)),T=Math.min(7,Math.round(A.y*this.tileToMeter/10));return new St(jt(_.x,1,yn-1)<<3|x,jt(_.y,1,yn-1)<<3|T)}encodeBorderCentroid(c){if(!c.borders)return new St(0,0);const f=c.borders,_=Number.MAX_VALUE;if(f[0][0]!==_||f[1][0]!==_){const A=f[0][0]!==_?0:1;return new St(6|(f[0][0]!==_?0:65528),(f[A][0]+f[A][1])/2<<3|6)}{const A=f[2][0]!==_?2:3;return new St((f[A][0]+f[A][1])/2<<3|6,6|(f[2][0]!==_?0:65528))}}showCentroid(c){const f=this.centroidData[c.centroidDataIndex];f.flags&=Jg,f.centroidXY.x=0,f.centroidXY.y=0,this.writeCentroidToBuffer(f)}writeCentroidToBuffer(c){this.groundEffect.updateHiddenByLandmark(c);const f=c.vertexArrayOffset,_=c.vertexCount+c.vertexArrayOffset,A=c.flags&Jg?w7:c.centroidXY,x=this.centroidVertexArray.geta_centroid_pos0(f);if(this.centroidVertexArray.geta_centroid_pos1(f)!==A.y||x!==A.x){for(let T=f;T<_;++T)this.centroidVertexArray.emplace(T,A.x,A.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const c of this.centroidData)this.writeCentroidToBuffer(c)}updateReplacement(c,f,_){if(f.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=f.updateTime;const A=f.getReplacementRegionsForTile(c.toUnwrapped());if(U3(this.activeReplacements,A))return;if(this.activeReplacements=A,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const T of this.centroidData)T.flags&=2147483647;const x=[];for(const T of this.activeReplacements){if(T.order<_)continue;const B=Math.pow(2,T.footprintTileId.canonical.z-c.canonical.z);for(const U of this.centroidData)if(!(U.flags&Jg||T.min.x>U.max.x||U.min.x>T.max.x||T.min.y>U.max.y||U.min.y>T.max.y))for(let j=0;j<U.footprintSegLen;j++){const R=this.footprintSegments[U.footprintSegIdx+j];if(x.length=0,ohe(this.footprintVertices,R.vertexOffset,R.vertexCount,T.footprintTileId.canonical,c.canonical,x),v7(T.footprint,x,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-B)){U.flags|=Jg;break}}}for(const T of this.centroidData)this.writeCentroidToBuffer(T);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(c,f,_){let A=!1;for(let x=0;x<_.footprintSegLen;x++){const T=this.footprintSegments[_.footprintSegIdx+x];let B=0;for(const U of T.ringIndices){for(let j=B,R=U+B-1;j<U+B;R=j++){const N=this.footprintVertices.int16[2*(j+T.vertexOffset)+0],V=this.footprintVertices.int16[2*(j+T.vertexOffset)+1],z=this.footprintVertices.int16[2*(R+T.vertexOffset)+1];V>f!=z>f&&c<(this.footprintVertices.int16[2*(R+T.vertexOffset)+0]-N)*(f-V)/(z-V)+N&&(A=!A)}B=U}}return A}getHeightAtTileCoord(c,f){let _=Number.NEGATIVE_INFINITY,A=!0;const x=4*(c+yn)*yn+(f+yn);if(this.partLookup.hasOwnProperty(x)){const T=this.partLookup[x];return T?{height:T.height,hidden:!!(T.flags&Jg)}:void 0}for(const T of this.centroidData)c>T.max.x||T.min.x>c||f>T.max.y||T.min.y>f||this.footprintContainsPoint(c,f,T)&&T&&T.height>_&&(_=T.height,this.partLookup[x]=T,A=!!(T.flags&Jg));if(_!==Number.NEGATIVE_INFINITY)return{height:_,hidden:A};this.partLookup[x]=void 0}}function E7(g,c){const f=g.add(c)._unit();return g.x*f.x+g.y*f.y}function she(g,c,f,_){const A=c.sub(g)._perp()._unit(),x=f.sub(c)._perp()._unit();return I7(g,c,f,E7(A,x),_)}function I7(g,c,f,_,A){const x=Math.sqrt(1-_*_);return Math.min(g.dist(c)/3,c.dist(f)/3,A*x/_)}function H3(g,c,f){return g.x<f[0].x&&c.x<f[0].x||g.x>f[1].x&&c.x>f[1].x||g.y<f[0].y&&c.y<f[0].y||g.y>f[1].y&&c.y>f[1].y}function R7(g,c){return g.x<c[0].x||g.x>c[1].x||g.y<c[0].y||g.y>c[1].y}function P7(g,c,f){if(g.x<0||g.x>=yn||c.x<0||c.x>=yn||f.x<0||f.x>=yn)return!1;const _=f.sub(c),A=_.perp(),x=g.sub(c);return(_.x*x.x+_.y*x.y)/Math.sqrt((_.x*_.x+_.y*_.y)*(x.x*x.x+x.y*x.y))>-.866&&A.x*x.x+A.y*x.y<0}function L7(g,c,f){const _=c?2|g:-3&g;return f?1|_:-2&_}function D7(){const g=Math.PI/32,c=Math.tan(g),f=oe;return f*Math.sqrt(1+2*c*c)-f}function B7(g,c,f){const _=1<<f.z,A=We(f.x/_),x=We((f.x+1)/_),T=He(f.y/_),B=He((f.y+1)/_);return function(U,j,R,N,V=0,z){const G=[];if(!U.length||!R||!N)return G;const X=(ge,Me)=>{for(const Be of ge)G.push({polygon:Be,bounds:Me})},K=Math.ceil(Math.log2(R)),te=Math.ceil(Math.log2(N)),ce=K-te,he=[];for(let ge=0;ge<Math.abs(ce);ge++)he.push(ce>0?0:1);for(let ge=0;ge<Math.min(K,te);ge++)he.push(0),he.push(1);let ne=U;if(ne=PM(ne,j[0].y-V,j[1].y+V,1),ne=PM(ne,j[0].x-V,j[1].x+V,0),!ne.length)return G;const de=[];for(he.length?de.push({polygons:ne,bounds:j,depth:0}):X(ne,j);de.length;){const ge=de.pop(),Me=ge.depth,Be=he[Me],Oe=ge.bounds[0],Re=ge.bounds[1],Ye=Be===0?Oe.x:Oe.y,ze=Be===0?Re.x:Re.y,Qe=z?z(Be,Ye,ze):.5*(Ye+ze),ct=PM(ge.polygons,Ye-V,Qe+V,Be),ht=PM(ge.polygons,Qe-V,ze+V,Be);if(ct.length){const ft=[Oe,new St(Be===0?Qe:Re.x,Be===1?Qe:Re.y)];he.length>Me+1?de.push({polygons:ct,bounds:ft,depth:Me+1}):X(ct,ft)}if(ht.length){const ft=[new St(Be===0?Qe:Oe.x,Be===1?Qe:Oe.y),Re];he.length>Me+1?de.push({polygons:ht,bounds:ft,depth:Me+1}):X(ht,ft)}}return G}(g,c,Math.ceil((x-A)/11.25),Math.ceil((T-B)/11.25),1,(U,j,R)=>{if(U===0)return .5*(j+R);{const N=He((f.y+j/yn)/_);return(Ne(.5*(He((f.y+R/yn)/_)+N))*_-f.y)*yn}})}function ohe(g,c,f,_,A,x){const T=Math.pow(2,_.z-A.z);for(let B=0;B<f;B++){let U=g.int16[2*(B+c)+0],j=g.int16[2*(B+c)+1];U=(U+A.x*yn)*T-_.x*yn,j=(j+A.y*yn)*T-_.y*yn,x.push(new St(U,j))}}let k7,O7;function Xw(g,c){return g.x*c.x+g.y*c.y}function F7(g,c){if(g.length===1){let f=0;const _=c[f++];let A;for(;!A||_.equals(A);)if(A=c[f++],!A)return 1/0;for(;f<c.length;f++){const x=c[f],T=g[0],B=A.sub(_),U=x.sub(_),j=T.sub(_),R=Xw(B,B),N=Xw(B,U),V=Xw(U,U),z=Xw(j,B),G=Xw(j,U),X=R*V-N*N,K=(V*z-N*G)/X,te=(R*G-N*z)/X,ce=_.z*(1-K-te)+A.z*K+x.z*te;if(isFinite(ce))return ce}return 1/0}{let f=1/0;for(const _ of c)f=Math.min(f,_.z);return f}}function N7(g,c,f,_,A,x,T,B){const U=T*A.getElevationAt(g,c,!0,!0),j=x[0]!==0,R=j?x[1]===0?T*(x[0]/7-450):T*function(N,V,z){const G=Math.floor(V[0]/8),X=Math.floor(V[1]/8),K=10*(V[0]-8*G),te=10*(V[1]-8*X),ce=N.getElevationAt(G,X,!0,!0),he=N.getMeterToDEM(z),ne=Math.floor(.5*(K*he-1)),de=Math.floor(.5*(te*he-1)),ge=N.tileCoordToPixel(G,X),Me=2*ne+1,Be=2*de+1,Oe=function(ht,ft,mt,Et,vt){return[ht.getElevationAtPixel(ft,mt,!0),ht.getElevationAtPixel(ft+vt,mt,!0),ht.getElevationAtPixel(ft,mt+vt,!0),ht.getElevationAtPixel(ft+Et,mt+vt,!0)]}(N,ge.x-ne,ge.y-de,Me,Be),Re=Math.abs(Oe[0]-Oe[1]),Ye=Math.abs(Oe[2]-Oe[3]),ze=Math.abs(Oe[0]-Oe[2])+Math.abs(Oe[1]-Oe[3]),Qe=Math.min(.25,.5*he*(Re+Ye)/Me),ct=Math.min(.25,.5*he*ze/Be);return ce+Math.max(Qe*K,ct*te)}(A,x,B):U;return{base:U+(f===0)?-1:f,top:j?Math.max(R+_,U+f+2):U+_}}Fn(kM,"FillExtrusionBucket",{omit:["layers","features"]}),Fn(A7,"PartData"),Fn(S7,"FootprintSegment"),Fn(T7,"BorderCentroidData"),Fn(C7,"GroundEffect");const ahe=Qr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),lhe=Qr([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:che}=ahe,uhe=Qr([{name:"a_packed",components:4,type:"Float32"}]),{members:hhe}=uhe,fhe=Qr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:dhe}=fhe;class z7{constructor(c,f){this.width=c,this.height=f,this.nextRow=0,this.image=new Kg({width:c,height:f}),this.positions={},this.uploaded=!1}getDash(c,f){const _=this.getKey(c,f);return this.positions[_]}trim(){const c=this.width,f=this.height=ui(this.nextRow);this.image.resize({width:c,height:f})}getKey(c,f){return c.join(",")+f}getDashRanges(c,f,_){const A=[];let x=c.length%2==1?-c[c.length-1]*_:0,T=c[0]*_,B=!0;A.push({left:x,right:T,isDash:B,zeroLength:c[0]===0});let U=c[0];for(let j=1;j<c.length;j++){B=!B;const R=c[j];x=U*_,U+=R,T=U*_,A.push({left:x,right:T,isDash:B,zeroLength:R===0})}return A}addRoundDash(c,f,_){const A=f/2;for(let x=-_;x<=_;x++){const T=this.width*(this.nextRow+_+x);let B=0,U=c[B];for(let j=0;j<this.width;j++){j/U.right>1&&(U=c[++B]);const R=Math.abs(j-U.left),N=Math.abs(j-U.right),V=Math.min(R,N);let z;const G=x/_*(A+1);if(U.isDash){const X=A-Math.abs(G);z=Math.sqrt(V*V+X*X)}else z=A-Math.sqrt(V*V+G*G);this.image.data[T+j]=Math.max(0,Math.min(255,z+128))}}}addRegularDash(c,f){for(let U=c.length-1;U>=0;--U){const j=c[U],R=c[U+1];j.zeroLength?c.splice(U,1):R&&R.isDash===j.isDash&&(R.left=j.left,c.splice(U,1))}const _=c[0],A=c[c.length-1];_.isDash===A.isDash&&(_.left=A.left-this.width,A.right=_.right+this.width);const x=this.width*this.nextRow;let T=0,B=c[T];for(let U=0;U<this.width;U++){U/B.right>1&&(B=c[++T]);const j=Math.abs(U-B.left),R=Math.abs(U-B.right),N=Math.min(j,R);this.image.data[x+U]=Math.max(0,Math.min(255,(B.isDash?N:-N)+f+128))}}addDash(c,f){const _=this.getKey(c,f);if(this.positions[_])return this.positions[_];const A=f==="round",x=A?7:0,T=2*x+1;if(this.nextRow+T>this.height)return Lt("LineAtlas out of space"),null;c.length===0&&c.push(1);let B=0;for(let R=0;R<c.length;R++)c[R]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),c[R]=0),B+=c[R];if(B!==0){const R=this.width/B,N=this.getDashRanges(c,this.width,R);A?this.addRoundDash(N,R,x):this.addRegularDash(N,f==="square"?.5*R:0)}const U=this.nextRow+x;this.nextRow+=T;const j={tl:[U,x],br:[B,0]};return this.positions[_]=j,j}}Fn(z7,"LineAtlas");const phe=H1.VectorTileFeature.types,mhe=Math.cos(Math.PI/180*37.5),ghe=Math.cos(Math.PI/180*5);class j3{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=c.index,this.projection=c.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(f=>{this.gradients[f.id]={}}),this.layoutVertexArray=new Qa,this.layoutVertexArray2=new Rl,this.patternVertexArray=new co,this.indexArray=new wo,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.segments=new bs,this.maxLineLength=0,this.zOffsetVertexArray=new Dd,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.tessellationStep=c.tessellationStep?c.tessellationStep:yn/64}updateFootprints(c,f){}populate(c,f,_,A){this.hasPattern=L3("line",this.layers,f);const x=this.layers[0].layout.get("line-sort-key"),T=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!T.isConstant()||!!T.constantOr(0);const B=[];for(const{feature:N,id:V,index:z,sourceLayerIndex:G}of c){const X=this.layers[0]._featureFilter.needGeometry,K=pn(N,X);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),K,_))continue;const te=x?x.evaluate(K,{},_):void 0,ce={id:V,properties:N.properties,type:N.type,sourceLayerIndex:G,index:z,geometry:X?K.geometry:fn(N,_,A),patterns:{},sortKey:te};B.push(ce)}x&&B.sort((N,V)=>N.sortKey-V.sortKey);const{lineAtlas:U,featureIndex:j}=f,R=this.addConstantDashes(U);for(const N of B){const{geometry:V,index:z,sourceLayerIndex:G}=N;if(R&&this.addFeatureDashes(N,U),this.hasPattern){const X=D3("line",this.layers,N,this.zoom,f);this.patternFeatures.push(X)}else this.addFeature(N,V,z,_,U.positions,f.availableImages,f.brightness);j.insert(c[z].feature,V,z,G,this.index)}}addConstantDashes(c){let f=!1;for(const _ of this.layers){const A=_.paint.get("line-dasharray").value,x=_.layout.get("line-cap").value;if(A.kind!=="constant"||x.kind!=="constant")f=!0;else{const T=x.value,B=A.value;if(!B)continue;c.addDash(B,T)}}return f}addFeatureDashes(c,f){const _=this.zoom;for(const A of this.layers){const x=A.paint.get("line-dasharray").value,T=A.layout.get("line-cap").value;if(x.kind==="constant"&&T.kind==="constant")continue;let B,U;if(x.kind==="constant"){if(B=x.value,!B)continue}else B=x.evaluate({zoom:_},c);U=T.kind==="constant"?T.value:T.evaluate({zoom:_},c),f.addDash(B,U),c.patterns[A.id]=f.getKey(B,U)}}update(c,f,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,f,T?this.stateDependentLayers:this.layers,_,A,x)}addFeatures(c,f,_,A,x,T){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,f,_,A,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,hhe)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=c.createVertexBuffer(this.patternVertexArray,dhe)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=c.createVertexBuffer(this.zOffsetVertexArray,lhe.members,!0)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,che),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,f,_,A,x,T,B){const U=this.layers[0].layout,j=U.get("line-join").evaluate(c,{}),R=U.get("line-cap").evaluate(c,{}),N=U.get("line-miter-limit"),V=U.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const z of f)this.addLine(z,c,A,j,R,N,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,B)}addLine(c,f,_,A,x,T,B){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const U={zoom:this.zoom,lineProgress:void 0},j=this.layers[0].layout,R=A==="none";if(this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<c.length-1;ge++)this.totalDistance+=c[ge].dist(c[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const N=phe[f.type]==="Polygon";let V=c.length;for(;V>=2&&c[V-1].equals(c[V-2]);)V--;let z=0;for(;z<V-1&&c[z].equals(c[z+1]);)z++;if(V<(N?3:2))return;A==="bevel"&&(T=1.05);const G=this.overscaling<=16?15*yn/(512*this.overscaling):0,X=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray);let K,te,ce,he,ne,de;this.e1=this.e2=-1,N&&(K=c[V-2],ne=c[z].sub(K)._unit()._perp());for(let ge=z;ge<V;ge++){if(ce=ge===V-1?N?c[z+1]:void 0:c[ge+1],ce&&c[ge].equals(ce))continue;if(ne&&(he=ne),K&&(te=K),K=c[ge],this.hasZOffset){const ft=j.get("line-z-offset").value;if(ft.kind==="constant")de=ft.value;else{if(this.lineClips){const mt=this.totalDistance/(this.lineClips.end-this.lineClips.start);U.lineProgress=(mt*this.lineClips.start+this.distance+(te?te.dist(K):0))/mt}else Lt(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),U.lineProgress=0;de=ft.evaluate(U,f)}de=de||0}ne=ce?ce.sub(K)._unit()._perp():he,he=he||ne;const Me=te&&ce;let Be=Me?A:N||R?"butt":x;const Oe=he.x*ne.x+he.y*ne.y;if(R){const ft=function(mt){if(mt.patternJoinNone){const Et=mt.segmentPoints.length/2,vt=mt.lineSoFar-mt.segmentStart;for(let Ut=0;Ut<Et;++Ut){const Yt=mt.segmentPoints[2*Ut+1],Dt=Math.round(mt.segmentPoints[2*Ut])+.5+.25*Yt;mt.patternVertexArray.emplaceBack(Dt,vt,mt.segmentStart),mt.patternVertexArray.emplaceBack(Dt,vt,mt.segmentStart)}mt.segmentPoints.length=0}mt.e1=mt.e2=-1};if(Me&&Oe<ghe){this.updateDistance(te,K),this.addCurrentVertex(K,he,1,1,X,de),ft(this),this.addCurrentVertex(K,ne,-1,-1,X,de);continue}if(te){if(!ce){this.updateDistance(te,K),this.addCurrentVertex(K,he,1,1,X,de),ft(this);continue}Be="miter"}}let Re=he.add(ne);Re.x===0&&Re.y===0||Re._unit();const Ye=Re.x*ne.x+Re.y*ne.y,ze=Ye!==0?1/Ye:1/0,Qe=2*Math.sqrt(2-2*Ye),ct=Ye<mhe&&te&&ce,ht=he.x*ne.y-he.y*ne.x>0;if(ct&&ge>z){const ft=K.dist(te);if(ft>2*G){const mt=K.sub(K.sub(te)._mult(G/ft)._round());this.updateDistance(te,mt),this.addCurrentVertex(mt,he,0,0,X,de),te=mt}}if(Me&&Be==="round"&&(ze<B?Be="miter":ze<=2&&(Be="fakeround")),Be==="miter"&&ze>T&&(Be="bevel"),Be==="bevel"&&(ze>2&&(Be="flipbevel"),ze<T&&(Be="miter")),te&&this.updateDistance(te,K),Be==="miter")Re._mult(ze),this.addCurrentVertex(K,Re,0,0,X,de);else if(Be==="flipbevel"){if(ze>100)Re=ne.mult(-1);else{const ft=ze*he.add(ne).mag()/he.sub(ne).mag();Re._perp()._mult(ft*(ht?-1:1))}this.addCurrentVertex(K,Re,0,0,X,de),this.addCurrentVertex(K,Re.mult(-1),0,0,X,de)}else if(Be==="bevel"||Be==="fakeround"){const ft=-Math.sqrt(ze*ze-1),mt=ht?ft:0,Et=ht?0:ft;if(te&&this.addCurrentVertex(K,he,mt,Et,X,de),Be==="fakeround"){const vt=Math.round(180*Qe/Math.PI/20);for(let Ut=1;Ut<vt;Ut++){let Yt=Ut/vt;if(Yt!==.5){const Rn=Yt-.5;Yt+=Yt*Rn*(Yt-1)*((1.0904+Oe*(Oe*(3.55645-1.43519*Oe)-3.2452))*Rn*Rn+(.848013+Oe*(.215638*Oe-1.06021)))}const Dt=ne.sub(he)._mult(Yt)._add(he)._unit()._mult(ht?-1:1);this.addHalfVertex(K,Dt.x,Dt.y,!1,ht,0,X,de)}}ce&&this.addCurrentVertex(K,ne,-mt,-Et,X,de)}else Be==="butt"?this.addCurrentVertex(K,Re,0,0,X,de):Be==="square"?(te||this.addCurrentVertex(K,Re,-1,-1,X,de),this.addCurrentVertex(K,Re,0,0,X,de),te&&this.addCurrentVertex(K,Re,1,1,X,de)):Be==="round"&&(te&&(this.addCurrentVertex(K,he,0,0,X,de),this.addCurrentVertex(K,he,1,1,X,de,!0)),ce&&(this.addCurrentVertex(K,ne,-1,-1,X,de,!0),this.addCurrentVertex(K,ne,0,0,X,de)));if(ct&&ge<V-1){const ft=K.dist(ce);if(ft>2*G){const mt=K.add(ce.sub(K)._mult(G/ft)._round());this.updateDistance(K,mt),this.addCurrentVertex(mt,ne,0,0,X,de),K=mt}}}}addVerticesTo(c,f,_,A,x,T,B,U,j,R){const N=(f.w-c.w)/this.tessellationStep|0;if(N>1){this.lineSoFar=c.w;const V=(f.x-c.x)/N,z=(f.y-c.y)/N,G=(f.z-c.z)/N,X=(f.w-c.w)/N;for(let K=1;K<N;++K)c.x+=V,c.y+=z,c.z+=G,this.lineSoFar+=X,this.addHalfVertex(c,_,A,R,!1,B,j,c.z),this.addHalfVertex(c,x,T,R,!0,-U,j,c.z)}this.lineSoFar=f.w,this.addHalfVertex(f,_,A,R,!1,B,j,f.z),this.addHalfVertex(f,x,T,R,!0,-U,j,f.z)}addCurrentVertex(c,f,_,A,x,T,B=!1){const U=f.x+f.y*_,j=f.y-f.x*_,R=f.y*A-f.x,N=-f.y-f.x*A;if(T!=null){const z=yn+10,G=T,X=new h7(c.x,c.y,G,this.lineSoFar),K=U7(c,-10,z),te=this.lineSoFar;if(this.currentVertex)if(K){const ce=this.currentVertexIsOutside,he=this.currentVertex,ne=new h7(c.x,c.y,G,this.lineSoFar);d7(he,ne,-10,z),U7(ne,-10,z)||(ce&&(this.e1=this.e2=-1,this.lineSoFar=he.w,this.addHalfVertex(he,U,j,B,!1,_,x,he.z),this.addHalfVertex(he,R,N,B,!0,-A,x,he.z)),this.addVerticesTo(he,ne,U,j,R,N,_,A,x,B))}else{const ce=this.currentVertex;this.currentVertexIsOutside&&(d7(ce,X,-10,z),this.e1=this.e2=-1,this.lineSoFar=ce.w,this.addHalfVertex(ce,U,j,B,!1,_,x,ce.z),this.addHalfVertex(ce,R,N,B,!0,-A,x,ce.z)),this.addVerticesTo(ce,X,U,j,R,N,_,A,x,B)}else K||(this.addHalfVertex(c,U,j,B,!1,_,x,T),this.addHalfVertex(c,R,N,B,!0,-A,x,T));this.currentVertex=X,this.currentVertexIsOutside=K,this.lineSoFar=te}else this.addHalfVertex(c,U,j,B,!1,_,x,T),this.addHalfVertex(c,R,N,B,!0,-A,x,T)}addHalfVertex({x:c,y:f},_,A,x,T,B,U,j){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),T||this.segmentPoints.push(this.lineSoFar-this.segmentStart,B)),this.layoutVertexArray.emplaceBack((c<<1)+(x?1:0),(f<<1)+(T?1:0),Math.round(63*_)+128,Math.round(63*A)+128,1+(B===0?0:B<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=U.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),U.primitiveLength++),T?this.e2=R:this.e1=R,j!=null&&this.zOffsetVertexArray.emplaceBack(j)}updateScaledDistance(){if(this.lineClips){const c=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=c*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(c,f){this.distance+=c.dist(f),this.updateScaledDistance()}}function U7(g,c,f){return g.x<c||g.x>f||g.y<c||g.y>f}let G7,V7;function H7(g,c,f){return c*(yn/(g.tileSize*Math.pow(2,f-g.tileID.overscaledZ)))}function j7(g,c){return 1/H7(g,1,c.tileZoom)}function W7(g,c,f,_){return g.translatePosMatrix(_||c.tileID.projMatrix,c,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}Fn(j3,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const X7=g=>{const c=[];$7(g)&&c.push("RENDER_LINE_DASH"),g.paint.get("line-gradient")&&c.push("RENDER_LINE_GRADIENT");const f=g.paint.get("line-trim-offset");f[0]===0&&f[1]===0||c.push("RENDER_LINE_TRIM_OFFSET"),g.paint.get("line-border-width").constantOr(1)!==0&&c.push("RENDER_LINE_BORDER");const _=g.layout.get("line-join").constantOr("miter")==="none",A=!!g.paint.get("line-pattern").constantOr(1);return _&&A&&c.push("LINE_JOIN_NONE"),c};function $7(g){const c=g.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}let W3;const q7=()=>W3||(W3={layout:G7||(G7=new ji({"line-cap":new Kn(At.layout_line["line-cap"]),"line-join":new Kn(At.layout_line["line-join"]),"line-miter-limit":new gn(At.layout_line["line-miter-limit"]),"line-round-limit":new gn(At.layout_line["line-round-limit"]),"line-sort-key":new Kn(At.layout_line["line-sort-key"]),"line-z-offset":new Kn(At.layout_line["line-z-offset"]),visibility:new gn(At.layout_line.visibility)})),paint:V7||(V7=new ji({"line-opacity":new Kn(At.paint_line["line-opacity"]),"line-color":new Kn(At.paint_line["line-color"]),"line-translate":new gn(At.paint_line["line-translate"]),"line-translate-anchor":new gn(At.paint_line["line-translate-anchor"]),"line-width":new Kn(At.paint_line["line-width"]),"line-gap-width":new Kn(At.paint_line["line-gap-width"]),"line-offset":new Kn(At.paint_line["line-offset"]),"line-blur":new Kn(At.paint_line["line-blur"]),"line-dasharray":new Kn(At.paint_line["line-dasharray"]),"line-pattern":new Kn(At.paint_line["line-pattern"]),"line-gradient":new ac(At.paint_line["line-gradient"]),"line-trim-offset":new gn(At.paint_line["line-trim-offset"]),"line-trim-fade-range":new gn(At.paint_line["line-trim-fade-range"]),"line-trim-color":new gn(At.paint_line["line-trim-color"]),"line-emissive-strength":new gn(At.paint_line["line-emissive-strength"]),"line-border-width":new Kn(At.paint_line["line-border-width"]),"line-border-color":new Kn(At.paint_line["line-border-color"]),"line-occlusion-opacity":new gn(At.paint_line["line-occlusion-opacity"])}))},W3);class vhe extends Kn{possiblyEvaluate(c,f){return f=new ds(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,transition:f.transition}),super.possiblyEvaluate(c,f)}evaluate(c,f,_,A){return f=Sr({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(c,f,_,A)}}let $w;function Z7(g,c){return c>0?c+2*g:g}const _he=Qr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yhe=Qr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),xhe=Qr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Qr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const bhe=Qr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),whe=Qr([{name:"a_texb",components:2,type:"Uint16"}]),She=Qr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Ahe=Qr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Qr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Y7=Qr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),The=Qr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qr([{name:"triangle",components:3,type:"Uint16"}]),Qr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Qr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Qr([{type:"Float32",name:"offsetX"}]),Qr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Na=24;const _f=128;function X3(g,c){const{expression:f}=c;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new ds(g+1))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:_,interpolationType:A}=f;let x=0;for(;x<_.length&&_[x]<=g;)x++;x=Math.max(0,x-1);let T=x;for(;T<_.length&&_[T]<g+1;)T++;T=Math.min(_.length-1,T);const B=_[x],U=_[T];return f.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:U,interpolationType:A}:{kind:"camera",minZoom:B,maxZoom:U,minSize:f.evaluate(new ds(B)),maxSize:f.evaluate(new ds(U)),interpolationType:A}}}function OM(g,{uSize:c,uSizeT:f},{lowerSize:_,upperSize:A}){return g.kind==="source"?_/_f:g.kind==="composite"?cr(_/_f,A/_f,f):c}function j1(g,c){let f=0,_=0;if(g.kind==="constant")_=g.layoutSize;else if(g.kind!=="source"){const{interpolationType:A,minZoom:x,maxZoom:T}=g,B=A?jt(hl.interpolationFactor(A,c,x,T),0,1):0;g.kind==="camera"?_=cr(g.minSize,g.maxSize,B):f=B}return{uSizeT:f,uSize:_}}var Mhe=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:_f,evaluateSizeForFeature:OM,evaluateSizeForZoom:j1,getSizeData:X3});function Che(g,c,f){return g.sections.forEach(_=>{_.text=function(A,x,T){const B=x.layout.get("text-transform").evaluate(T,{});return B==="uppercase"?A=A.toLocaleUpperCase():B==="lowercase"&&(A=A.toLocaleLowerCase()),Fa.applyArabicShaping&&(A=Fa.applyArabicShaping(A)),A}(_.text,c,f)}),g}const qw={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Ehe(g){return g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""}function Ihe(g){return g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""}var K7,$3,J7,q3={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Rhe(){return K7||(K7=1,q3.read=function(g,c,f,_,A){var x,T,B=8*A-_-1,U=(1<<B)-1,j=U>>1,R=-7,N=f?A-1:0,V=f?-1:1,z=g[c+N];for(N+=V,x=z&(1<<-R)-1,z>>=-R,R+=B;R>0;x=256*x+g[c+N],N+=V,R-=8);for(T=x&(1<<-R)-1,x>>=-R,R+=_;R>0;T=256*T+g[c+N],N+=V,R-=8);if(x===0)x=1-j;else{if(x===U)return T?NaN:1/0*(z?-1:1);T+=Math.pow(2,_),x-=j}return(z?-1:1)*T*Math.pow(2,x-_)},q3.write=function(g,c,f,_,A,x){var T,B,U,j=8*x-A-1,R=(1<<j)-1,N=R>>1,V=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=_?0:x-1,G=_?1:-1,X=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(B=isNaN(c)?1:0,T=R):(T=Math.floor(Math.log(c)/Math.LN2),c*(U=Math.pow(2,-T))<1&&(T--,U*=2),(c+=T+N>=1?V/U:V*Math.pow(2,1-N))*U>=2&&(T++,U/=2),T+N>=R?(B=0,T=R):T+N>=1?(B=(c*U-1)*Math.pow(2,A),T+=N):(B=c*Math.pow(2,N-1)*Math.pow(2,A),T=0));A>=8;g[f+z]=255&B,z+=G,B/=256,A-=8);for(T=T<<A|B,j+=A;j>0;g[f+z]=255&T,z+=G,T/=256,j-=8);g[f+z-G]|=128*X}),q3}function Q7(){if(J7)return $3;J7=1,$3=c;var g=Rhe();function c(ne){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ne)?ne:new Uint8Array(ne||0),this.pos=0,this.type=0,this.length=this.buf.length}c.Varint=0,c.Fixed64=1,c.Bytes=2,c.Fixed32=5;var f=4294967296,_=1/f,A=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function x(ne){return ne.type===c.Bytes?ne.readVarint()+ne.pos:ne.pos+1}function T(ne,de,ge){return ge?4294967296*de+(ne>>>0):4294967296*(de>>>0)+(ne>>>0)}function B(ne,de,ge){var Me=de<=16383?1:de<=2097151?2:de<=268435455?3:Math.floor(Math.log(de)/(7*Math.LN2));ge.realloc(Me);for(var Be=ge.pos-1;Be>=ne;Be--)ge.buf[Be+Me]=ge.buf[Be]}function U(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeVarint(ne[ge])}function j(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSVarint(ne[ge])}function R(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFloat(ne[ge])}function N(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeDouble(ne[ge])}function V(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeBoolean(ne[ge])}function z(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFixed32(ne[ge])}function G(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSFixed32(ne[ge])}function X(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFixed64(ne[ge])}function K(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSFixed64(ne[ge])}function te(ne,de){return(ne[de]|ne[de+1]<<8|ne[de+2]<<16)+16777216*ne[de+3]}function ce(ne,de,ge){ne[ge]=de,ne[ge+1]=de>>>8,ne[ge+2]=de>>>16,ne[ge+3]=de>>>24}function he(ne,de){return(ne[de]|ne[de+1]<<8|ne[de+2]<<16)+(ne[de+3]<<24)}return c.prototype={destroy:function(){this.buf=null},readFields:function(ne,de,ge){for(ge=ge||this.length;this.pos<ge;){var Me=this.readVarint(),Be=Me>>3,Oe=this.pos;this.type=7&Me,ne(Be,de,this),this.pos===Oe&&this.skip(Me)}return de},readMessage:function(ne,de){return this.readFields(ne,de,this.readVarint()+this.pos)},readFixed32:function(){var ne=te(this.buf,this.pos);return this.pos+=4,ne},readSFixed32:function(){var ne=he(this.buf,this.pos);return this.pos+=4,ne},readFixed64:function(){var ne=te(this.buf,this.pos)+te(this.buf,this.pos+4)*f;return this.pos+=8,ne},readSFixed64:function(){var ne=te(this.buf,this.pos)+he(this.buf,this.pos+4)*f;return this.pos+=8,ne},readFloat:function(){var ne=g.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ne},readDouble:function(){var ne=g.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ne},readVarint:function(ne){var de,ge,Me=this.buf;return de=127&(ge=Me[this.pos++]),ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<7,ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<14,ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<21,ge<128?de:function(Be,Oe,Re){var Ye,ze,Qe=Re.buf;if(Ye=(112&(ze=Qe[Re.pos++]))>>4,ze<128||(Ye|=(127&(ze=Qe[Re.pos++]))<<3,ze<128)||(Ye|=(127&(ze=Qe[Re.pos++]))<<10,ze<128)||(Ye|=(127&(ze=Qe[Re.pos++]))<<17,ze<128)||(Ye|=(127&(ze=Qe[Re.pos++]))<<24,ze<128)||(Ye|=(1&(ze=Qe[Re.pos++]))<<31,ze<128))return T(Be,Ye,Oe);throw new Error("Expected varint not more than 10 bytes")}(de|=(15&(ge=Me[this.pos]))<<28,ne,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ne=this.readVarint();return ne%2==1?(ne+1)/-2:ne/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ne=this.readVarint()+this.pos,de=this.pos;return this.pos=ne,ne-de>=12&&A?function(ge,Me,Be){return A.decode(ge.subarray(Me,Be))}(this.buf,de,ne):function(ge,Me,Be){for(var Oe="",Re=Me;Re<Be;){var Ye,ze,Qe,ct=ge[Re],ht=null,ft=ct>239?4:ct>223?3:ct>191?2:1;if(Re+ft>Be)break;ft===1?ct<128&&(ht=ct):ft===2?(192&(Ye=ge[Re+1]))==128&&(ht=(31&ct)<<6|63&Ye)<=127&&(ht=null):ft===3?(ze=ge[Re+2],(192&(Ye=ge[Re+1]))==128&&(192&ze)==128&&((ht=(15&ct)<<12|(63&Ye)<<6|63&ze)<=2047||ht>=55296&&ht<=57343)&&(ht=null)):ft===4&&(ze=ge[Re+2],Qe=ge[Re+3],(192&(Ye=ge[Re+1]))==128&&(192&ze)==128&&(192&Qe)==128&&((ht=(15&ct)<<18|(63&Ye)<<12|(63&ze)<<6|63&Qe)<=65535||ht>=1114112)&&(ht=null)),ht===null?(ht=65533,ft=1):ht>65535&&(ht-=65536,Oe+=String.fromCharCode(ht>>>10&1023|55296),ht=56320|1023&ht),Oe+=String.fromCharCode(ht),Re+=ft}return Oe}(this.buf,de,ne)},readBytes:function(){var ne=this.readVarint()+this.pos,de=this.buf.subarray(this.pos,ne);return this.pos=ne,de},readPackedVarint:function(ne,de){if(this.type!==c.Bytes)return ne.push(this.readVarint(de));var ge=x(this);for(ne=ne||[];this.pos<ge;)ne.push(this.readVarint(de));return ne},readPackedSVarint:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSVarint());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSVarint());return ne},readPackedBoolean:function(ne){if(this.type!==c.Bytes)return ne.push(this.readBoolean());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readBoolean());return ne},readPackedFloat:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFloat());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFloat());return ne},readPackedDouble:function(ne){if(this.type!==c.Bytes)return ne.push(this.readDouble());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readDouble());return ne},readPackedFixed32:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFixed32());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFixed32());return ne},readPackedSFixed32:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSFixed32());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSFixed32());return ne},readPackedFixed64:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFixed64());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFixed64());return ne},readPackedSFixed64:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSFixed64());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSFixed64());return ne},skip:function(ne){var de=7&ne;if(de===c.Varint)for(;this.buf[this.pos++]>127;);else if(de===c.Bytes)this.pos=this.readVarint()+this.pos;else if(de===c.Fixed32)this.pos+=4;else{if(de!==c.Fixed64)throw new Error("Unimplemented type: "+de);this.pos+=8}},writeTag:function(ne,de){this.writeVarint(ne<<3|de)},realloc:function(ne){for(var de=this.length||16;de<this.pos+ne;)de*=2;if(de!==this.length){var ge=new Uint8Array(de);ge.set(this.buf),this.buf=ge,this.length=de}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ne){this.realloc(4),ce(this.buf,ne,this.pos),this.pos+=4},writeSFixed32:function(ne){this.realloc(4),ce(this.buf,ne,this.pos),this.pos+=4},writeFixed64:function(ne){this.realloc(8),ce(this.buf,-1&ne,this.pos),ce(this.buf,Math.floor(ne*_),this.pos+4),this.pos+=8},writeSFixed64:function(ne){this.realloc(8),ce(this.buf,-1&ne,this.pos),ce(this.buf,Math.floor(ne*_),this.pos+4),this.pos+=8},writeVarint:function(ne){(ne=+ne||0)>268435455||ne<0?function(de,ge){var Me,Be;if(de>=0?(Me=de%4294967296|0,Be=de/4294967296|0):(Be=~(-de/4294967296),4294967295^(Me=~(-de%4294967296))?Me=Me+1|0:(Me=0,Be=Be+1|0)),de>=18446744073709552e3||de<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ge.realloc(10),function(Oe,Re,Ye){Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Ye.buf[Ye.pos]=127&(Oe>>>=7)}(Me,0,ge),function(Oe,Re){var Ye=(7&Oe)<<4;Re.buf[Re.pos++]|=Ye|((Oe>>>=3)?128:0),Oe&&(Re.buf[Re.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Re.buf[Re.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Re.buf[Re.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Re.buf[Re.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Re.buf[Re.pos++]=127&Oe)))))}(Be,ge)}(ne,this):(this.realloc(4),this.buf[this.pos++]=127&ne|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=ne>>>7&127))))},writeSVarint:function(ne){this.writeVarint(ne<0?2*-ne-1:2*ne)},writeBoolean:function(ne){this.writeVarint(!!ne)},writeString:function(ne){ne=String(ne),this.realloc(4*ne.length),this.pos++;var de=this.pos;this.pos=function(Me,Be,Oe){for(var Re,Ye,ze=0;ze<Be.length;ze++){if((Re=Be.charCodeAt(ze))>55295&&Re<57344){if(!Ye){Re>56319||ze+1===Be.length?(Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189):Ye=Re;continue}if(Re<56320){Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189,Ye=Re;continue}Re=Ye-55296<<10|Re-56320|65536,Ye=null}else Ye&&(Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189,Ye=null);Re<128?Me[Oe++]=Re:(Re<2048?Me[Oe++]=Re>>6|192:(Re<65536?Me[Oe++]=Re>>12|224:(Me[Oe++]=Re>>18|240,Me[Oe++]=Re>>12&63|128),Me[Oe++]=Re>>6&63|128),Me[Oe++]=63&Re|128)}return Oe}(this.buf,ne,this.pos);var ge=this.pos-de;ge>=128&&B(de,ge,this),this.pos=de-1,this.writeVarint(ge),this.pos+=ge},writeFloat:function(ne){this.realloc(4),g.write(this.buf,ne,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ne){this.realloc(8),g.write(this.buf,ne,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ne){var de=ne.length;this.writeVarint(de),this.realloc(de);for(var ge=0;ge<de;ge++)this.buf[this.pos++]=ne[ge]},writeRawMessage:function(ne,de){this.pos++;var ge=this.pos;ne(de,this);var Me=this.pos-ge;Me>=128&&B(ge,Me,this),this.pos=ge-1,this.writeVarint(Me),this.pos+=Me},writeMessage:function(ne,de,ge){this.writeTag(ne,c.Bytes),this.writeRawMessage(de,ge)},writePackedVarint:function(ne,de){de.length&&this.writeMessage(ne,U,de)},writePackedSVarint:function(ne,de){de.length&&this.writeMessage(ne,j,de)},writePackedBoolean:function(ne,de){de.length&&this.writeMessage(ne,V,de)},writePackedFloat:function(ne,de){de.length&&this.writeMessage(ne,R,de)},writePackedDouble:function(ne,de){de.length&&this.writeMessage(ne,N,de)},writePackedFixed32:function(ne,de){de.length&&this.writeMessage(ne,z,de)},writePackedSFixed32:function(ne,de){de.length&&this.writeMessage(ne,G,de)},writePackedFixed64:function(ne,de){de.length&&this.writeMessage(ne,X,de)},writePackedSFixed64:function(ne,de){de.length&&this.writeMessage(ne,K,de)},writeBytesField:function(ne,de){this.writeTag(ne,c.Bytes),this.writeBytes(de)},writeFixed32Field:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeFixed32(de)},writeSFixed32Field:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeSFixed32(de)},writeFixed64Field:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeFixed64(de)},writeSFixed64Field:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeSFixed64(de)},writeVarintField:function(ne,de){this.writeTag(ne,c.Varint),this.writeVarint(de)},writeSVarintField:function(ne,de){this.writeTag(ne,c.Varint),this.writeSVarint(de)},writeStringField:function(ne,de){this.writeTag(ne,c.Bytes),this.writeString(de)},writeFloatField:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeFloat(de)},writeDoubleField:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeDouble(de)},writeBooleanField:function(ne,de){this.writeVarintField(ne,!!de)}},$3}var FM=h(Q7());const Z3=3;function Phe(g,c,f){c.glyphs=[],g===1&&f.readMessage(Lhe,c)}function Lhe(g,c,f){if(g===3){const{id:_,bitmap:A,width:x,height:T,left:B,top:U,advance:j}=f.readMessage(Dhe,{});c.glyphs.push({id:_,bitmap:new Kg({width:x+2*Z3,height:T+2*Z3},A),metrics:{width:x,height:T,left:B,top:U,advance:j}})}else g===4?c.ascender=f.readSVarint():g===5&&(c.descender=f.readSVarint())}function Dhe(g,c,f){g===1?c.id=f.readVarint():g===2?c.bitmap=f.readBytes():g===3?c.width=f.readVarint():g===4?c.height=f.readVarint():g===5?c.left=f.readSVarint():g===6?c.top=f.readSVarint():g===7&&(c.advance=f.readVarint())}const eG=Z3,Tu={horizontal:1,vertical:2,horizontalOnly:3};class Zw{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,f){const _=new Zw;return _.scale=c||1,_.fontStack=f,_}static forImage(c){const f=new Zw;return f.imageName=c,f}}class W1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,f){const _=new W1;for(let A=0;A<c.sections.length;A++){const x=c.sections[A];x.image?_.addImageSection(x):_.addTextSection(x,f)}return _}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSections(){return this.sections}getSectionIndex(c){return this.sectionIndex[c]}getCodePoint(c){return this.text.codePointAt(c)}verticalizePunctuation(c){this.text=function(f,_){let A="";for(let x=0;x<f.length;x++){const T=f.charCodeAt(x+1)||null,B=f.charCodeAt(x-1)||null;A+=!_&&(T&&Td(T)&&!qw[f[x+1]]||B&&Td(B)&&!qw[f[x-1]])||!qw[f[x]]?f[x]:qw[f[x]]}return A}(this.text,c)}trim(){let c=0;for(let _=0;_<this.text.length&&NM[this.text.charCodeAt(_)];_++)c++;let f=this.text.length;for(let _=this.text.length-1;_>=0&&_>=c&&NM[this.text.charCodeAt(_)];_--)f--;this.text=this.text.substring(c,f),this.sectionIndex=this.sectionIndex.slice(c,f)}substring(c,f){const _=new W1;return _.text=this.text.substring(c,f),_.sectionIndex=this.sectionIndex.slice(c,f),_.sections=this.sections,_}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,f)=>Math.max(c,this.sections[f].scale),0)}addTextSection(c,f){this.text+=c.text,this.sections.push(Zw.forText(c.scale,c.fontStack||f));const _=this.sections.length-1;for(let A=0;A<c.text.length;++A)this.sectionIndex.push(_)}addImageSection(c){const f=c.image?c.image.namePrimary:"";if(f.length===0)return void Lt("Can't add FormattedSection with an empty image.");const _=this.getNextImageSectionCharCode();_?(this.text+=String.fromCodePoint(_),this.sections.push(Zw.forImage(f)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Y3(g,c,f,_,A,x,T,B,U,j,R,N,V,z,G){const X=W1.fromFeature(g,A);N===Tu.vertical&&X.verticalizePunctuation(V);let K=[];const te=function(ge,Me,Be,Oe,Re,Ye){if(!ge)return[];const ze=[],Qe=function(mt,Et,vt,Ut,Yt,Dt){let Rn=0;for(let bn=0;bn<mt.length();bn++){const dn=mt.getSection(bn);Rn+=tG(mt.getCodePoint(bn),dn,Ut,Yt,Et,Dt)}return Rn/Math.max(1,Math.ceil(Rn/vt))}(ge,Me,Be,Oe,Re,Ye),ct=ge.text.indexOf("")>=0;let ht=0;for(let mt=0;mt<ge.length();mt++){const Et=ge.getSection(mt),vt=ge.getCodePoint(mt);if(NM[vt]||(ht+=tG(vt,Et,Oe,Re,Me,Ye)),mt<ge.length()-1){const Ut=!((ft=vt)<11904||!(Yn["Bopomofo Extended"](ft)||Yn.Bopomofo(ft)||Yn["CJK Compatibility Forms"](ft)||Yn["CJK Compatibility Ideographs"](ft)||Yn["CJK Compatibility"](ft)||Yn["CJK Radicals Supplement"](ft)||Yn["CJK Strokes"](ft)||Yn["CJK Symbols and Punctuation"](ft)||Yn["CJK Unified Ideographs Extension A"](ft)||Yn["CJK Unified Ideographs"](ft)||Yn["Enclosed CJK Letters and Months"](ft)||Yn["Halfwidth and Fullwidth Forms"](ft)||Yn.Hiragana(ft)||Yn["Ideographic Description Characters"](ft)||Yn["Kangxi Radicals"](ft)||Yn["Katakana Phonetic Extensions"](ft)||Yn.Katakana(ft)||Yn["Vertical Forms"](ft)||Yn["Yi Radicals"](ft)||Yn["Yi Syllables"](ft)));(Bhe[vt]||Ut||Et.imageName)&&ze.push(rG(mt+1,ht,Qe,ze,khe(vt,ge.getCodePoint(mt+1),Ut&&ct),!1))}}var ft;return iG(rG(ge.length(),ht,Qe,ze,0,!0))}(X,j,x,c,_,z),{processBidirectionalText:ce,processStyledBidirectionalText:he}=Fa;if(ce&&X.sections.length===1){const ge=ce(X.toString(),te);for(const Me of ge){const Be=new W1;Be.text=Me,Be.sections=X.sections;for(let Oe=0;Oe<Me.length;Oe++)Be.sectionIndex.push(0);K.push(Be)}}else if(he){const ge=he(X.text,X.sectionIndex,te);for(const Me of ge){const Be=new W1;Be.text=Me[0],Be.sectionIndex=Me[1],Be.sections=X.sections,K.push(Be)}}else K=function(ge,Me){const Be=[],Oe=ge.text;let Re=0;for(const Ye of Me)Be.push(ge.substring(Re,Ye)),Re=Ye;return Re<Oe.length&&Be.push(ge.substring(Re,Oe.length)),Be}(X,te);const ne=[],de={positionedLines:ne,text:X.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ge,Me,Be,Oe,Re,Ye,ze,Qe,ct,ht,ft,mt){let Et=0,vt=0,Ut=0;const Yt=Qe==="right"?1:Qe==="left"?0:.5;let Dt=!1;for(const In of Re){const Nn=In.getSections();for(const wr of Nn){if(wr.imageName)continue;const Or=Me[wr.fontStack];if(Or&&(Dt=Or.ascender!==void 0&&Or.descender!==void 0,!Dt))break}if(!Dt)break}let Rn=0;for(const In of Re){In.trim();const Nn=In.getMaxScale(),wr=(Nn-1)*Na,Or={positionedGlyphs:[],lineOffset:0};ge.positionedLines[Rn]=Or;const Pr=Or.positionedGlyphs;let Lr=0;if(!In.length()){vt+=Ye,++Rn;continue}let jr=0,Wr=0;for(let Ti=0;Ti<In.length();Ti++){const Tr=In.getSection(Ti),vi=In.getSectionIndex(Ti),bi=In.getCodePoint(Ti);let ss=Tr.scale,js=null,po=null,Ws=null,ks=Na,ua=0;const So=!(ct===Tu.horizontal||!ft&&!Kp(bi)||ft&&(NM[bi]||(bn=bi,Yn.Arabic(bn)||Yn["Arabic Supplement"](bn)||Yn["Arabic Extended-A"](bn)||Yn["Arabic Presentation Forms-A"](bn)||Yn["Arabic Presentation Forms-B"](bn))));if(Tr.imageName){const za=Oe[Tr.imageName];if(!za)continue;Ws=Tr.imageName,ge.iconsInText=ge.iconsInText||!0,po=za.paddedRect;const Ji=za.displaySize;ss=ss*Na/mt,js={width:Ji[0],height:Ji[1],left:0,top:-eG,advance:So?Ji[1]:Ji[0],localGlyph:!1},ua=Dt?-js.height*ss:Nn*Na-17-Ji[1]*ss,ks=js.advance;const pc=(So?Ji[0]:Ji[1])*ss-Na*Nn;pc>0&&pc>Lr&&(Lr=pc)}else{const za=Be[Tr.fontStack];if(!za)continue;za[bi]&&(po=za[bi]);const Ji=Me[Tr.fontStack];if(!Ji)continue;const pc=Ji.glyphs[bi];if(!pc)continue;if(js=pc.metrics,ks=bi!==8203?Na:0,Dt){const Sf=Ji.ascender!==void 0?Math.abs(Ji.ascender):0,oh=Ji.descender!==void 0?Math.abs(Ji.descender):0,ah=(Sf+oh)*ss;jr<ah&&(jr=ah,Wr=(Sf-oh)/2*ss),ua=-Sf*ss}else ua=(Nn-ss)*Na-17}So?(ge.verticalizable=!0,Pr.push({glyph:bi,imageName:Ws,x:Et,y:vt+ua,vertical:So,scale:ss,localGlyph:js.localGlyph,fontStack:Tr.fontStack,sectionIndex:vi,metrics:js,rect:po}),Et+=ks*ss+ht):(Pr.push({glyph:bi,imageName:Ws,x:Et,y:vt+ua,vertical:So,scale:ss,localGlyph:js.localGlyph,fontStack:Tr.fontStack,sectionIndex:vi,metrics:js,rect:po}),Et+=js.advance*ss+ht)}Pr.length!==0&&(Ut=Math.max(Et-ht,Ut),Dt?sG(Pr,Yt,Lr,Wr,Ye*Nn/2):sG(Pr,Yt,Lr,0,Ye/2)),Et=0;const Ui=Ye*Nn+Lr;Or.lineOffset=Math.max(Lr,wr),vt+=Ui,++Rn}var bn;const dn=vt,{horizontalAlign:tn,verticalAlign:nr}=K3(ze);(function(In,Nn,wr,Or,Pr,Lr){const jr=(Nn-wr)*Pr,Wr=-Lr*Or;for(const Ui of In)for(const Ti of Ui.positionedGlyphs)Ti.x+=jr,Ti.y+=Wr})(ge.positionedLines,Yt,tn,nr,Ut,dn),ge.top+=-nr*dn,ge.bottom=ge.top+dn,ge.left+=-tn*Ut,ge.right=ge.left+Ut,ge.hasBaseline=Dt}(de,c,f,_,K,T,B,U,N,j,V,G),!function(ge){for(const Me of ge)if(Me.positionedGlyphs.length!==0)return!1;return!0}(ne)&&de}const NM={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Bhe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tG(g,c,f,_,A,x){if(c.imageName){const T=_[c.imageName];return T?T.displaySize[0]*c.scale*Na/x+A:0}{const T=f[c.fontStack],B=T&&T.glyphs[g];return B?B.metrics.advance*c.scale+A:0}}function nG(g,c,f,_){const A=Math.pow(g-c,2);return _?g<c?A/2:2*A:A+Math.abs(f)*f}function khe(g,c,f){let _=0;return g===10&&(_-=1e4),f&&(_+=150),g!==40&&g!==65288||(_+=50),c!==41&&c!==65289||(_+=50),_}function rG(g,c,f,_,A,x){let T=null,B=nG(c,f,A,x);for(const U of _){const j=nG(c-U.x,f,A,x)+U.badness;j<=B&&(T=U,B=j)}return{index:g,x:c,priorBreak:T,badness:B}}function iG(g){return g?iG(g.priorBreak).concat(g.index):[]}function K3(g){let c=.5,f=.5;switch(g){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(g){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:c,verticalAlign:f}}function sG(g,c,f,_,A){if(!(c||f||_||A))return;const x=g.length-1,T=g[x],B=(T.x+T.metrics.advance*T.scale)*c;for(let U=0;U<=x;U++)g[U].x-=B,g[U].y+=f+_+A}function Ohe(g,c,f,_){const{horizontalAlign:A,verticalAlign:x}=K3(_),T=f[0]-g.displaySize[0]*A,B=f[1]-g.displaySize[1]*x;return{imagePrimary:g,imageSecondary:c,top:B,bottom:B+g.displaySize[1],left:T,right:T+g.displaySize[0]}}function oG(g,c,f,_,A,x){const T=g.imagePrimary;let B;if(T.content){const K=T.content,te=T.pixelRatio||1;B=[K[0]/te,K[1]/te,T.displaySize[0]-K[2]/te,T.displaySize[1]-K[3]/te]}const U=c.left*x,j=c.right*x;let R,N,V,z;f==="width"||f==="both"?(z=A[0]+U-_[3],N=A[0]+j+_[1]):(z=A[0]+(U+j-T.displaySize[0])/2,N=z+T.displaySize[0]);const G=c.top*x,X=c.bottom*x;return f==="height"||f==="both"?(R=A[1]+G-_[0],V=A[1]+X+_[2]):(R=A[1]+(G+X-T.displaySize[1])/2,V=R+T.displaySize[1]),{imagePrimary:T,imageSecondary:void 0,top:R,right:N,bottom:V,left:z,collisionPadding:B}}class am extends St{constructor(c,f,_,A,x){super(c,f),this.angle=A,this.z=_,x!==void 0&&(this.segment=x)}clone(){return new am(this.x,this.y,this.z,this.angle,this.segment)}}function aG(g,c,f,_,A){if(c.segment===void 0)return!0;let x=c,T=c.segment+1,B=0;for(;B>-f/2;){if(T--,T<0)return!1;B-=g[T].dist(x),x=g[T]}B+=g[T].dist(g[T+1]),T++;const U=[];let j=0;for(;B<f/2;){const R=g[T],N=g[T+1];if(!N)return!1;let V=g[T-1].angleTo(R)-R.angleTo(N);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:B,angleDelta:V}),j+=V;B-U[0].distance>_;)j-=U.shift().angleDelta;if(j>A)return!1;T++,B+=R.dist(N)}return!0}function lG(g){let c=0;for(let f=0;f<g.length-1;f++)c+=g[f].dist(g[f+1]);return c}function cG(g,c,f){return g?.6*c*f:0}function uG(g,c){return Math.max(g?g.right-g.left:0,c?c.right-c.left:0)}function Fhe(g,c,f,_,A,x){const T=cG(f,A,x),B=uG(f,_)*x;let U=0;const j=lG(g)/2;for(let R=0;R<g.length-1;R++){const N=g[R],V=g[R+1],z=N.dist(V);if(U+z>j){const G=(j-U)/z,X=cr(N.x,V.x,G),K=cr(N.y,V.y,G),te=new am(X,K,0,V.angleTo(N),R);return!T||aG(g,te,B,T,c)?te:void 0}U+=z}}function Nhe(g,c,f,_,A,x,T,B,U){const j=cG(_,x,T),R=uG(_,A),N=R*T,V=g[0].x===0||g[0].x===U||g[0].y===0||g[0].y===U;return c-N<c/4&&(c=N+c/4),hG(g,V?c/2*B%c:(R/2+2*x)*T*B%c,c,j,f,N,V,!1,U)}function hG(g,c,f,_,A,x,T,B,U){const j=x/2,R=lG(g);let N=0,V=c-f,z=[];for(let G=0;G<g.length-1;G++){const X=g[G],K=g[G+1],te=X.dist(K),ce=K.angleTo(X);for(;V+f<N+te;){V+=f;const he=(V-N)/te,ne=cr(X.x,K.x,he),de=cr(X.y,K.y,he);if(ne>=0&&ne<U&&de>=0&&de<U&&V-j>=0&&V+j<=R){const ge=new am(ne,de,0,ce,G);_&&!aG(g,ge,x,_,A)||z.push(ge)}}N+=te}return B||z.length||T||(z=hG(g,N/2,f,_,A,x,T,!0,U)),z}function fG(g,c,f,_,A){const x=[];for(let T=0;T<g.length;T++){const B=g[T];let U;for(let j=0;j<B.length-1;j++){let R=B[j],N=B[j+1];R.x<c&&N.x<c||(R.x<c?R=new St(c,R.y+(c-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x<c&&(N=new St(c,R.y+(c-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y<f&&N.y<f||(R.y<f?R=new St(R.x+(f-R.y)/(N.y-R.y)*(N.x-R.x),f)._round():N.y<f&&(N=new St(R.x+(f-R.y)/(N.y-R.y)*(N.x-R.x),f)._round()),R.x>=_&&N.x>=_||(R.x>=_?R=new St(_,R.y+(_-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x>=_&&(N=new St(_,R.y+(_-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y>=A&&N.y>=A||(R.y>=A?R=new St(R.x+(A-R.y)/(N.y-R.y)*(N.x-R.x),A)._round():N.y>=A&&(N=new St(R.x+(A-R.y)/(N.y-R.y)*(N.x-R.x),A)._round()),U&&R.equals(U[U.length-1])||(U=[R],x.push(U)),U.push(N)))))}}return x}function dG(g){let c=0,f=0;for(const T of g)c+=T.w*T.h,f=Math.max(f,T.w);g.sort((T,B)=>B.h-T.h);const _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),f),h:1/0}];let A=0,x=0;for(const T of g)for(let B=_.length-1;B>=0;B--){const U=_[B];if(!(T.w>U.w||T.h>U.h)){if(T.x=U.x,T.y=U.y,x=Math.max(x,T.y+T.h),A=Math.max(A,T.x+T.w),T.w===U.w&&T.h===U.h){const j=_.pop();B<_.length&&(_[B]=j)}else T.h===U.h?(U.x+=T.w,U.w-=T.w):T.w===U.w?(U.y+=T.h,U.h-=T.h):(_.push({x:U.x+T.w,y:U.y,w:U.w-T.w,h:T.h}),U.y+=T.h,U.h-=T.h);break}}return{w:A,h:x,fill:c/(A*x)||0}}Fn(am,"Anchor");const Yw=1;class J3{constructor(c,{pixelRatio:f,version:_,stretchX:A,stretchY:x,content:T},B){this.paddedRect=c,this.pixelRatio=f,this.stretchX=A,this.stretchY=x,this.content=T,this.version=_,this.padding=B}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class pG{constructor(c,f,_){const A={},x={};this.haveRenderCallbacks=[];const T=[];this.addImages(c,A,Yw,T),this.addImages(f,x,2,T);const{w:B,h:U}=dG(T),j=new gl({width:B||1,height:U||1});for(const R in c){const N=c[R],V=A[R].paddedRect;gl.copy(N.data,j,{x:0,y:0},{x:V.x+Yw,y:V.y+Yw},N.data,_,N.sdf)}for(const R in f){const N=f[R],V=x[R].paddedRect;let z=x[R].padding;const G=V.x+z,X=V.y+z,K=N.data.width,te=N.data.height;z=z>1?z-1:z,gl.copy(N.data,j,{x:0,y:0},{x:G,y:X},N.data,_),gl.copy(N.data,j,{x:0,y:te-z},{x:G,y:X-z},{width:K,height:z},_),gl.copy(N.data,j,{x:0,y:0},{x:G,y:X+te},{width:K,height:z},_),gl.copy(N.data,j,{x:K-z,y:0},{x:G-z,y:X},{width:z,height:te},_),gl.copy(N.data,j,{x:0,y:0},{x:G+K,y:X},{width:z,height:te},_),gl.copy(N.data,j,{x:K-z,y:te-z},{x:G-z,y:X-z},{width:z,height:z},_),gl.copy(N.data,j,{x:0,y:te-z},{x:G+K,y:X-z},{width:z,height:z},_),gl.copy(N.data,j,{x:0,y:0},{x:G+K,y:X+te},{width:z,height:z},_),gl.copy(N.data,j,{x:K-z,y:0},{x:G-z,y:X+te},{width:z,height:z},_)}this.image=j,this.iconPositions=A,this.patternPositions=x}addImages(c,f,_,A){for(const x in c){const T=c[x],B={x:0,y:0,w:T.data.width+2*_,h:T.data.height+2*_};A.push(B),f[x]=new J3(B,T,_),T.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(c,f,_){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(A=>c.hasImage(A,_)),c.dispatchRenderCallbacks(this.haveRenderCallbacks,_);for(const A in c.getUpdatedImages(_))this.patchUpdatedImage(this.iconPositions[A],c.getImage(A,_),f),this.patchUpdatedImage(this.patternPositions[A],c.getImage(A,_),f)}patchUpdatedImage(c,f,_){if(!c||!f||c.version===f.version)return;c.version=f.version;const[A,x]=c.tl;_.update(f.data,{position:{x:A,y:x}})}}Fn(J3,"ImagePosition"),Fn(pG,"ImageAtlas");const Kw=1e20;function mG(g,c,f,_,A,x,T,B,U){for(let j=c;j<c+_;j++)gG(g,f*x+j,x,A,T,B,U);for(let j=f;j<f+A;j++)gG(g,j*x+c,1,_,T,B,U)}function gG(g,c,f,_,A,x,T){x[0]=0,T[0]=-Kw,T[1]=Kw,A[0]=g[c];for(let B=1,U=0,j=0;B<_;B++){A[B]=g[c+B*f];const R=B*B;do{const N=x[U];j=(A[B]-A[N]+R-N*N)/(B-N)/2}while(j<=T[U]&&--U>-1);U++,x[U]=B,T[U]=j,T[U+1]=Kw}for(let B=0,U=0;B<_;B++){for(;T[U+1]<B;)U++;const j=x[U],R=B-j;g[c+B*f]=A[j]+R*R}}const yf=2,Q3={none:0,ideographs:1,all:2};class X1{constructor(c,f,_){this.requestManager=c,this.localGlyphMode=f,this.localFontFamily=_,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(c,f){this.urls[f]=c}getGlyphs(c,f,_){const A=[],x=this.urls[f]||nt.GLYPHS_URL;for(const T in c)for(const B of c[T])A.push({stack:T,id:B});tr(A,({stack:T,id:B},U)=>{let j=this.entries[T];j||(j=this.entries[T]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=j.glyphs[B];if(R!==void 0)return void U(null,{stack:T,id:B,glyph:R});if(R=this._tinySDF(j,T,B),R)return j.glyphs[B]=R,void U(null,{stack:T,id:B,glyph:R});const N=Math.floor(B/256);if(256*N>65535)return void U(new Error("glyphs > 65535 not supported"));if(j.ranges[N])return void U(null,{stack:T,id:B,glyph:R});let V=j.requests[N];V||(V=j.requests[N]=[],X1.loadGlyphRange(T,N,x,this.requestManager,(z,G)=>{if(G){j.ascender=G.ascender,j.descender=G.descender;for(const X in G.glyphs)this._doesCharSupportLocalGlyph(+X)||(j.glyphs[+X]=G.glyphs[+X]);j.ranges[N]=!0}for(const X of V)X(z,G);delete j.requests[N]})),V.push((z,G)=>{z?U(z):G&&U(null,{stack:T,id:B,glyph:G.glyphs[B]||null})})},(T,B)=>{if(T)_(T);else if(B){const U={};for(const{stack:j,id:R,glyph:N}of B)U[j]===void 0&&(U[j]={}),U[j].glyphs===void 0&&(U[j].glyphs={}),U[j].glyphs[R]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics},U[j].ascender=this.entries[j].ascender,U[j].descender=this.entries[j].descender;_(null,U)}})}_doesCharSupportLocalGlyph(c){return this.localGlyphMode!==Q3.none&&(this.localGlyphMode===Q3.all?!!this.localFontFamily:!!this.localFontFamily&&(Yn["CJK Unified Ideographs"](c)||Yn["Hangul Syllables"](c)||Yn.Hiragana(c)||Yn.Katakana(c)||Yn["CJK Symbols and Punctuation"](c)||Yn["CJK Unified Ideographs Extension A"](c)||Yn["CJK Unified Ideographs Extension B"](c)))}_tinySDF(c,f,_){const A=this.localFontFamily;if(!A||!this._doesCharSupportLocalGlyph(_))return;let x=c.tinySDF;if(!x){let X="400";/bold/i.test(f)?X="900":/medium/i.test(f)?X="500":/light/i.test(f)&&(X="200"),x=c.tinySDF=new X1.TinySDF({fontFamily:A,fontWeight:X,fontSize:24*yf,buffer:3*yf,radius:8*yf}),x.fontWeight=X}if(this.localGlyphs[x.fontWeight][_])return this.localGlyphs[x.fontWeight][_];const T=String.fromCodePoint(_),{data:B,width:U,height:j,glyphWidth:R,glyphHeight:N,glyphLeft:V,glyphTop:z,glyphAdvance:G}=x.draw(T);return this.localGlyphs[x.fontWeight][_]={id:_,bitmap:new Kg({width:U,height:j},B),metrics:{width:R/yf,height:N/yf,left:V/yf,top:z/yf-27,advance:G/yf,localGlyph:!0}}}}X1.loadGlyphRange=function(g,c,f,_,A){const x=256*c,T=x+255,B=_.transformRequest(_.normalizeGlyphsURL(f).replace("{fontstack}",g).replace("{range}",`${x}-${T}`),Zi.Glyphs);Ls(B,(U,j)=>{if(U)A(U);else if(j){const R={},N=function(V){return new FM(V).readFields(Phe,{})}(j);for(const V of N.glyphs)R[V.id]=V;A(null,{glyphs:R,ascender:N.ascender,descender:N.descender})}})},X1.TinySDF=class{constructor({fontSize:g=24,buffer:c=3,radius:f=8,cutoff:_=.25,fontFamily:A="sans-serif",fontWeight:x="normal",fontStyle:T="normal"}={}){this.buffer=c,this.cutoff=_,this.radius=f;const B=this.size=g+4*c,U=this._createCanvas(B),j=this.ctx=U.getContext("2d",{willReadFrequently:!0});j.font=`${T} ${x} ${g}px ${A}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Uint16Array(B)}_createCanvas(g){const c=document.createElement("canvas");return c.width=c.height=g,c}draw(g){const{width:c,actualBoundingBoxAscent:f,actualBoundingBoxDescent:_,actualBoundingBoxLeft:A,actualBoundingBoxRight:x}=this.ctx.measureText(g),T=Math.ceil(f),B=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-A))),U=Math.min(this.size-this.buffer,T+Math.ceil(_)),j=B+2*this.buffer,R=U+2*this.buffer,N=Math.max(j*R,0),V=new Uint8ClampedArray(N),z={data:V,width:j,height:R,glyphWidth:B,glyphHeight:U,glyphTop:T,glyphLeft:0,glyphAdvance:c};if(B===0||U===0)return z;const{ctx:G,buffer:X,gridInner:K,gridOuter:te}=this;G.clearRect(X,X,B,U),G.fillText(g,X,X+T);const ce=G.getImageData(X,X,B,U);te.fill(Kw,0,N),K.fill(0,0,N);for(let he=0;he<U;he++)for(let ne=0;ne<B;ne++){const de=ce.data[4*(he*B+ne)+3]/255;if(de===0)continue;const ge=(he+X)*j+ne+X;if(de===1)te[ge]=0,K[ge]=Kw;else{const Me=.5-de;te[ge]=Me>0?Me*Me:0,K[ge]=Me<0?Me*Me:0}}mG(te,0,0,j,R,j,this.f,this.v,this.z),mG(K,X,X,B,U,j,this.f,this.v,this.z);for(let he=0;he<N;he++){const ne=Math.sqrt(te[he])-Math.sqrt(K[he]);V[he]=Math.round(255-255*(ne/this.radius+this.cutoff))}return z}};const Qg=Yw;function vG(g,c,f,_){const A=[],x=g.imagePrimary,T=x.pixelRatio,B=x.paddedRect.w-2*Qg,U=x.paddedRect.h-2*Qg,j=g.right-g.left,R=g.bottom-g.top,N=x.stretchX||[[0,B]],V=x.stretchY||[[0,U]],z=(Ye,ze)=>Ye+ze[1]-ze[0],G=N.reduce(z,0),X=V.reduce(z,0),K=B-G,te=U-X;let ce=0,he=G,ne=0,de=X,ge=0,Me=K,Be=0,Oe=te;if(x.content&&_){const Ye=x.content;ce=zM(N,0,Ye[0]),ne=zM(V,0,Ye[1]),he=zM(N,Ye[0],Ye[2]),de=zM(V,Ye[1],Ye[3]),ge=Ye[0]-ce,Be=Ye[1]-ne,Me=Ye[2]-Ye[0]-he,Oe=Ye[3]-Ye[1]-de}const Re=(Ye,ze,Qe,ct)=>{const ht=UM(Ye.stretch-ce,he,j,g.left),ft=GM(Ye.fixed-ge,Me,Ye.stretch,G),mt=UM(ze.stretch-ne,de,R,g.top),Et=GM(ze.fixed-Be,Oe,ze.stretch,X),vt=UM(Qe.stretch-ce,he,j,g.left),Ut=GM(Qe.fixed-ge,Me,Qe.stretch,G),Yt=UM(ct.stretch-ne,de,R,g.top),Dt=GM(ct.fixed-Be,Oe,ct.stretch,X),Rn=new St(ht,mt),bn=new St(vt,mt),dn=new St(vt,Yt),tn=new St(ht,Yt),nr=new St(ft/T,Et/T),In=new St(Ut/T,Dt/T),Nn=c*Math.PI/180;if(Nn){const Wr=Math.sin(Nn),Ui=Math.cos(Nn),Ti=[Ui,-Wr,Wr,Ui];Rn._matMult(Ti),bn._matMult(Ti),tn._matMult(Ti),dn._matMult(Ti)}const wr=Ye.stretch+Ye.fixed,Or=Qe.stretch+Qe.fixed,Pr=ze.stretch+ze.fixed,Lr=ct.stretch+ct.fixed,jr=g.imageSecondary;return{tl:Rn,tr:bn,bl:tn,br:dn,texPrimary:{x:x.paddedRect.x+Qg+wr,y:x.paddedRect.y+Qg+Pr,w:Or-wr,h:Lr-Pr},texSecondary:jr?{x:jr.paddedRect.x+Qg+wr,y:jr.paddedRect.y+Qg+Pr,w:Or-wr,h:Lr-Pr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nr,pixelOffsetBR:In,minFontScaleX:Me/T/j,minFontScaleY:Oe/T/R,isSDF:f}};if(_&&(x.stretchX||x.stretchY)){const Ye=_G(N,K,G),ze=_G(V,te,X);for(let Qe=0;Qe<Ye.length-1;Qe++){const ct=Ye[Qe],ht=Ye[Qe+1];for(let ft=0;ft<ze.length-1;ft++)A.push(Re(ct,ze[ft],ht,ze[ft+1]))}}else A.push(Re({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:U+1}));return A}function zM(g,c,f){let _=0;for(const A of g)_+=Math.max(c,Math.min(f,A[1]))-Math.max(c,Math.min(f,A[0]));return _}function _G(g,c,f){const _=[{fixed:-Qg,stretch:0}];for(const[A,x]of g){const T=_[_.length-1];_.push({fixed:A-T.stretch,stretch:T.stretch}),_.push({fixed:A-T.stretch,stretch:T.stretch+(x-A)})}return _.push({fixed:c+Qg,stretch:f}),_}function UM(g,c,f,_){return g/c*f+_}function GM(g,c,f,_){return g-c*f/_}function zhe(g,c,f,_){const A=c+g.positionedLines[_].lineOffset;return _===0?f+A/2:f+(A+(c+g.positionedLines[_-1].lineOffset))/2}function Uhe(g,c=1,f=!1){let _=1/0,A=1/0,x=-1/0,T=-1/0;const B=g[0];for(let z=0;z<B.length;z++){const G=B[z];(!z||G.x<_)&&(_=G.x),(!z||G.y<A)&&(A=G.y),(!z||G.x>x)&&(x=G.x),(!z||G.y>T)&&(T=G.y)}const U=Math.min(x-_,T-A);let j=U/2;const R=new qh([],Ghe);if(U===0)return new St(_,A);for(let z=_;z<x;z+=U)for(let G=A;G<T;G+=U)R.push(new $1(z+j,G+j,j,g));let N=function(z){let G=0,X=0,K=0;const te=z[0];for(let ce=0,he=te.length,ne=he-1;ce<he;ne=ce++){const de=te[ce],ge=te[ne],Me=de.x*ge.y-ge.x*de.y;X+=(de.x+ge.x)*Me,K+=(de.y+ge.y)*Me,G+=3*Me}return new $1(X/G,K/G,0,z)}(g),V=R.length;for(;R.length;){const z=R.pop();(z.d>N.d||!N.d)&&(N=z,f&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,V)),z.max-N.d<=c||(j=z.h/2,R.push(new $1(z.p.x-j,z.p.y-j,j,g)),R.push(new $1(z.p.x+j,z.p.y-j,j,g)),R.push(new $1(z.p.x-j,z.p.y+j,j,g)),R.push(new $1(z.p.x+j,z.p.y+j,j,g)),V+=4)}return f&&(console.log(`num probes: ${V}`),console.log(`best distance: ${N.d}`)),N.p}function Ghe(g,c){return c.max-g.max}class $1{constructor(c,f,_,A){this.p=new St(c,f),this.h=_,this.d=function(x,T){let B=!1,U=1/0;for(let j=0;j<T.length;j++){const R=T[j];for(let N=0,V=R.length,z=V-1;N<V;z=N++){const G=R[N],X=R[z];G.y>x.y!=X.y>x.y&&x.x<(X.x-G.x)*(x.y-G.y)/(X.y-G.y)+G.x&&(B=!B),U=Math.min(U,Ci(x,G,X))}}return(B?1:-1)*Math.sqrt(U)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}}const e4=Number.POSITIVE_INFINITY,Vhe=Math.sqrt(2);function yG(g,[c,f]){let _=0,A=0;if(f===e4){c<0&&(c=0);const x=c/Vhe;switch(g){case"top-right":case"top-left":A=x-7;break;case"bottom-right":case"bottom-left":A=7-x;break;case"bottom":A=7-c;break;case"top":A=c-7}switch(g){case"top-right":case"bottom-right":_=-x;break;case"top-left":case"bottom-left":_=x;break;case"left":_=c;break;case"right":_=-c}}else{switch(c=Math.abs(c),f=Math.abs(f),g){case"top-right":case"top-left":case"top":A=f-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-f}switch(g){case"top-right":case"bottom-right":case"right":_=-c;break;case"top-left":case"bottom-left":case"left":_=c}}return[_,A]}function t4(g){switch(g){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hhe(g,c,f,_,A,x,T,B,U,j,R,N,V,z,G){let X=x.textMaxSize.evaluate(c,{},N);X===void 0&&(X=T);const K=g.layers[0].layout,te=K.get("icon-offset").evaluate(c,{},N),ce=bG(f.horizontal)||f.vertical,he=V.name==="globe",ne=Na,de=T/ne,ge=g.tilePixelRatio*X/ne,Me=(ht=g.overscaling,g.zoom>18&&ht>2&&(ht>>=1),Math.max(yn/(512*ht),1)*K.get("symbol-spacing")),Be=K.get("text-padding")*g.tilePixelRatio,Oe=K.get("icon-padding")*g.tilePixelRatio,Re=sn(K.get("text-max-angle")),Ye=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",ze=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Qe=K.get("symbol-placement"),ct=Me/2;var ht;const ft=K.get("icon-text-fit").evaluate(c,{},N),mt=K.get("icon-text-fit-padding").evaluate(c,{},N),Et=ft!=="none";let vt;g.hasAnyIconTextFit===!1&&Et&&(g.hasAnyIconTextFit=!0),_&&Et&&(g.allowVerticalPlacement&&f.vertical&&(vt=oG(_,f.vertical,ft,mt,te,de)),ce&&(_=oG(_,ce,ft,mt,te,de)));const Ut=(Yt,Dt,Rn)=>{if(Dt.x<0||Dt.x>=yn||Dt.y<0||Dt.y>=yn)return;let bn=null;if(he){const{x:dn,y:tn,z:nr}=V.projectTilePoint(Dt.x,Dt.y,Rn);bn={anchor:new am(dn,tn,nr,0,void 0),up:V.upVector(Rn,Dt.x,Dt.y)}}(function(dn,tn,nr,In,Nn,wr,Or,Pr,Lr,jr,Wr,Ui,Ti,Tr,vi,bi,ss,js,po,Ws,ks,ua,So,za,Ji,pc,Sf){const oh=dn.addToLineVertexArray(tn,In);let ah,m_,i0,g_,m2,VV,HV,jV=0,WV=0,XV=0,$V=0,R4=-1,P4=-1;const Ud={};let qV=$o("");const v_=nr?nr.anchor:tn,L4=Lr.layout.get("icon-text-fit").evaluate(ks,{},Ji)!=="none";let D4=0,B4=0;if(Lr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[D4,B4]=Lr.layout.get("text-offset").evaluate(ks,{},Ji).map(qc=>qc*Na):(D4=Lr.layout.get("text-radial-offset").evaluate(ks,{},Ji)*Na,B4=e4),dn.allowVerticalPlacement&&Nn.vertical){const qc=Nn.vertical;if(vi)VV=n4(qc),Pr&&(HV=n4(Pr));else{const Zc=Lr.layout.get("text-rotate").evaluate(ks,{},Ji)+90;i0=VM(jr,v_,tn,Wr,Ui,Ti,qc,Tr,Zc,bi),Pr&&(g_=VM(jr,v_,tn,Wr,Ui,Ti,Pr,js,Zc))}}if(wr){const qc=Lr.layout.get("icon-rotate").evaluate(ks,{},Ji),Zc=vG(wr,qc,So,L4),tx=Pr?vG(Pr,qc,So,L4):void 0;m_=VM(jr,v_,tn,Wr,Ui,Ti,wr,js,qc),jV=4*Zc.length;const ZV=dn.iconSizeData;let __=null;ZV.kind==="source"?(__=[_f*Lr.layout.get("icon-size").evaluate(ks,{},Ji)],__[0]>e0&&Lt(`${dn.layerIds[0]}: Value for "icon-size" is >= ${Jw}. Reduce your "icon-size".`)):ZV.kind==="composite"&&(__=[_f*ua.compositeIconSizes[0].evaluate(ks,{},Ji),_f*ua.compositeIconSizes[1].evaluate(ks,{},Ji)],(__[0]>e0||__[1]>e0)&&Lt(`${dn.layerIds[0]}: Value for "icon-size" is >= ${Jw}. Reduce your "icon-size".`)),dn.addSymbols(dn.icon,Zc,__,Ws,po,ks,!1,nr,tn,oh.lineStartIndex,oh.lineLength,-1,za,Ji,pc,Sf),R4=dn.icon.placedSymbolArray.length-1,tx&&(WV=4*tx.length,dn.addSymbols(dn.icon,tx,__,Ws,po,ks,Tu.vertical,nr,tn,oh.lineStartIndex,oh.lineLength,-1,za,Ji,pc,Sf),P4=dn.icon.placedSymbolArray.length-1)}for(const qc in Nn.horizontal){const Zc=Nn.horizontal[qc];ah||(qV=$o(Zc.text),vi?m2=n4(Zc):ah=VM(jr,v_,tn,Wr,Ui,Ti,Zc,Tr,Lr.layout.get("text-rotate").evaluate(ks,{},Ji),bi));const tx=Zc.positionedLines.length===1;if(XV+=xG(dn,nr,tn,Zc,Or,Lr,vi,ks,bi,oh,Nn.vertical?Tu.horizontal:Tu.horizontalOnly,tx?Object.keys(Nn.horizontal):[qc],Ud,R4,ua,za,Ji,pc),tx)break}Nn.vertical&&($V+=xG(dn,nr,tn,Nn.vertical,Or,Lr,vi,ks,bi,oh,Tu.vertical,["vertical"],Ud,P4,ua,za,Ji,pc));let s0=-1;const k4=(qc,Zc)=>qc?Math.max(qc,Zc):Zc;s0=k4(m2,s0),s0=k4(VV,s0),s0=k4(HV,s0);const ide=s0>-1?1:0;dn.glyphOffsetArray.length>=65535&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ks.sortKey!==void 0&&dn.addToSortKeyRanges(dn.symbolInstances.length,ks.sortKey),dn.symbolInstances.emplaceBack(tn.x,tn.y,v_.x,v_.y,v_.z,Ud.right>=0?Ud.right:-1,Ud.center>=0?Ud.center:-1,Ud.left>=0?Ud.left:-1,Ud.vertical>=0?Ud.vertical:-1,R4,P4,qV,ah!==void 0?ah:dn.collisionBoxArray.length,ah!==void 0?ah+1:dn.collisionBoxArray.length,i0!==void 0?i0:dn.collisionBoxArray.length,i0!==void 0?i0+1:dn.collisionBoxArray.length,m_!==void 0?m_:dn.collisionBoxArray.length,m_!==void 0?m_+1:dn.collisionBoxArray.length,g_||dn.collisionBoxArray.length,g_?g_+1:dn.collisionBoxArray.length,Wr,XV,$V,jV,WV,ide,0,D4,B4,s0,0,L4?1:0)})(g,Dt,bn,Yt,f,_,A,vt,g.layers[0],g.collisionBoxArray,c.index,c.sourceLayerIndex,g.index,Be,Ye,U,0,Oe,ze,te,c,x,j,R,N,z,G)};if(Qe==="line")for(const Yt of fG(c.geometry,0,0,yn,yn)){const Dt=Nhe(Yt,Me,Re,f.vertical||ce,_,ne,ge,g.overscaling,yn);for(const Rn of Dt)ce&&jhe(g,ce.text,ct,Rn)||Ut(Yt,Rn,N)}else if(Qe==="line-center"){for(const Yt of c.geometry)if(Yt.length>1){const Dt=Fhe(Yt,Re,f.vertical||ce,_,ne,ge);Dt&&Ut(Yt,Dt,N)}}else if(c.type==="Polygon")for(const Yt of IM(c.geometry,0)){const Dt=Uhe(Yt,16);Ut(Yt[0],new am(Dt.x,Dt.y,0,0,void 0),N)}else if(c.type==="LineString")for(const Yt of c.geometry)Ut(Yt,new am(Yt[0].x,Yt[0].y,0,0,void 0),N);else if(c.type==="Point")for(const Yt of c.geometry)for(const Dt of Yt)Ut([Dt],new am(Dt.x,Dt.y,0,0,void 0),N)}const Jw=255,e0=Jw*_f;function xG(g,c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K,te){const ce=function(de,ge,Me,Be,Oe,Re,Ye,ze){const Qe=[];if(ge.positionedLines.length===0)return Qe;const ct=Be.layout.get("text-rotate").evaluate(Re,{})*Math.PI/180,ht=function(Ut){const Yt=Ut[0],Dt=Ut[1],Rn=Yt*Dt;return Rn>0?[Yt,-Dt]:Rn<0?[-Yt,Dt]:Yt===0?[Dt,Yt]:[Dt,-Yt]}(Me);let ft=Math.abs(ge.top-ge.bottom);for(const Ut of ge.positionedLines)ft-=Ut.lineOffset;const mt=ge.positionedLines.length,Et=ft/mt;let vt=ge.top-Me[1];for(let Ut=0;Ut<mt;++Ut){const Yt=ge.positionedLines[Ut];vt=zhe(ge,Et,vt,Ut);for(const Dt of Yt.positionedGlyphs){if(!Dt.rect)continue;const Rn=Dt.rect||{};let bn=eG+1,dn=!0,tn=1,nr=0;if(Dt.imageName){const Ws=Ye[Dt.imageName];if(!Ws)continue;if(Ws.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}dn=!1,tn=Ws.pixelRatio,bn=Yw/tn}const In=(Oe||ze)&&Dt.vertical,Nn=Dt.metrics.advance*Dt.scale/2,wr=Dt.metrics,Or=Dt.rect;if(Or===null)continue;ze&&ge.verticalizable&&(nr=Dt.imageName?Nn-Dt.metrics.width*Dt.scale/2:0);const Pr=Oe?[Dt.x+Nn,Dt.y]:[0,0];let Lr=[0,0],jr=[0,0],Wr=!1;Oe||(In?(jr=[Dt.x+Nn+ht[0],Dt.y+ht[1]-nr],Wr=!0):Lr=[Dt.x+Nn+Me[0],Dt.y+Me[1]-nr]);const Ui=Or.w*Dt.scale/(tn*(Dt.localGlyph?yf:1)),Ti=Or.h*Dt.scale/(tn*(Dt.localGlyph?yf:1));let Tr,vi,bi,ss;if(In){const Ws=Dt.y-vt,ks=new St(-Nn,Nn-Ws),ua=-Math.PI/2,So=new St(...jr);Tr=new St(-Nn+Lr[0],Lr[1]),Tr._rotateAround(ua,ks)._add(So),Tr.x+=-Ws+Nn,Tr.y-=(wr.left-bn)*Dt.scale;const za=Dt.imageName?wr.advance*Dt.scale:Na*Dt.scale,Ji=String.fromCodePoint(Dt.glyph);Ehe(Ji)?Tr.x+=(1-bn)*Dt.scale:Ihe(Ji)?Tr.x+=za-wr.height*Dt.scale+(-bn-1)*Dt.scale:Tr.x+=Dt.imageName||wr.width+2*bn===Or.w&&wr.height+2*bn===Or.h?(za-Ti)/2:(za-(wr.height+2*bn)*Dt.scale)/2,vi=new St(Tr.x,Tr.y-Ui),bi=new St(Tr.x+Ti,Tr.y),ss=new St(Tr.x+Ti,Tr.y-Ui)}else{const Ws=(wr.left-bn)*Dt.scale-Nn+Lr[0],ks=(-wr.top-bn)*Dt.scale+Lr[1],ua=Ws+Ui,So=ks+Ti;Tr=new St(Ws,ks),vi=new St(ua,ks),bi=new St(Ws,So),ss=new St(ua,So)}if(ct){let Ws;Ws=Oe?new St(0,0):Wr?new St(ht[0],ht[1]):new St(Me[0],Me[1]),Tr._rotateAround(ct,Ws),vi._rotateAround(ct,Ws),bi._rotateAround(ct,Ws),ss._rotateAround(ct,Ws)}const js=new St(0,0),po=new St(0,0);Qe.push({tl:Tr,tr:vi,bl:bi,br:ss,texPrimary:Rn,texSecondary:void 0,writingMode:ge.writingMode,glyphOffset:Pr,sectionIndex:Dt.sectionIndex,isSDF:dn,pixelOffsetTL:js,pixelOffsetBR:po,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,_,U,x,T,B,A,g.allowVerticalPlacement),he=g.textSizeData;let ne=null;he.kind==="source"?(ne=[_f*x.layout.get("text-size").evaluate(B,{},K)],ne[0]>e0&&Lt(`${g.layerIds[0]}: Value for "text-size" is >= ${Jw}. Reduce your "text-size".`)):he.kind==="composite"&&(ne=[_f*G.compositeTextSizes[0].evaluate(B,{},K),_f*G.compositeTextSizes[1].evaluate(B,{},K)],(ne[0]>e0||ne[1]>e0)&&Lt(`${g.layerIds[0]}: Value for "text-size" is >= ${Jw}. Reduce your "text-size".`)),g.addSymbols(g.text,ce,ne,U,T,B,R,c,f,j.lineStartIndex,j.lineLength,z,X,K,te,!1);for(const de of N)V[de]=g.text.placedSymbolArray.length-1;return 4*ce.length}function bG(g){for(const c in g)return g[c];return null}function VM(g,c,f,_,A,x,T,B,U,j){let R=T.top,N=T.bottom,V=T.left,z=T.right;const G=T.collisionPadding;if(G&&(V-=G[0],R-=G[1],z+=G[2],N+=G[3]),U){const X=new St(V,R),K=new St(z,R),te=new St(V,N),ce=new St(z,N),he=sn(U);let ne=new St(0,0);j&&(ne=new St(j[0],j[1])),X._rotateAround(he,ne),K._rotateAround(he,ne),te._rotateAround(he,ne),ce._rotateAround(he,ne),V=Math.min(X.x,K.x,te.x,ce.x),z=Math.max(X.x,K.x,te.x,ce.x),R=Math.min(X.y,K.y,te.y,ce.y),N=Math.max(X.y,K.y,te.y,ce.y)}return g.emplaceBack(c.x,c.y,c.z,f.x,f.y,V,R,z,N,B,_,A,x),g.length-1}function n4(g){g.collisionPadding&&(g.top-=g.collisionPadding[1],g.bottom+=g.collisionPadding[3]);const c=g.bottom-g.top;return c>0?Math.max(10,c):null}function jhe(g,c,f,_){const A=g.compareText;if(c in A){const x=A[c];for(let T=x.length-1;T>=0;T--)if(_.dist(x[T])<f)return!0}else A[c]=[];return A[c].push(_),!1}function wG(g,c){const f=g.fovAboveCenter,_=g.elevation?g.elevation.getMinElevationBelowMSL()*c:0,A=(g._camera.position[2]*g.worldSize-_)/Math.cos(g._pitch),x=Math.sin(f)*A/Math.sin(Math.max(Math.PI/2-g._pitch-f,.01));let T=Math.sin(g._pitch)*x+A;const B=A*(1/g._horizonShift);return g.elevation&&g.elevation.exaggeration()!==0||(T*=1+Math.max(g.zoom-17,0)),Math.min(1.01*T,B)}function Qw(g,c){if(!c.isReprojectedInTileSpace)return{scale:1<<g.z,x:g.x,y:g.y,x2:g.x+1,y2:g.y+1,projection:c};const f=Math.pow(2,-g.z),_=g.x*f,A=(g.x+1)*f,x=g.y*f,T=(g.y+1)*f,B=We(_),U=We(A),j=He(x),R=He(T),N=c.project(B,j),V=c.project(U,j),z=c.project(U,R),G=c.project(B,R);let X=Math.min(N.x,V.x,z.x,G.x),K=Math.min(N.y,V.y,z.y,G.y),te=Math.max(N.x,V.x,z.x,G.x),ce=Math.max(N.y,V.y,z.y,G.y);const he=f/16;function ne(ge,Me,Be,Oe,Re,Ye){const ze=(Be+Re)/2,Qe=(Oe+Ye)/2,ct=c.project(We(ze),He(Qe)),ht=Math.max(0,X-ct.x,K-ct.y,ct.x-te,ct.y-ce);X=Math.min(X,ct.x),te=Math.max(te,ct.x),K=Math.min(K,ct.y),ce=Math.max(ce,ct.y),ht>he&&(ne(ge,ct,Be,Oe,ze,Qe),ne(ct,Me,ze,Qe,Re,Ye))}ne(N,V,_,x,A,x),ne(V,z,A,x,A,T),ne(z,G,A,T,_,T),ne(G,N,_,T,_,x),X-=he,K-=he,te+=he,ce+=he;const de=1/Math.max(te-X,ce-K);return{scale:de,x:X*de,y:K*de,x2:te*de,y2:ce*de,projection:c}}function SG(g,{x:c,y:f},_=0){return new St(((c-_)*g.scale-g.x)*yn,(f*g.scale-g.y)*yn)}const Whe=Pe.mat4.identity(new Float32Array(16));class t0{constructor(c){this.spec=c,this.name=c.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(c,f){return{x:0,y:0,z:0}}unproject(c,f){return new ue(0,0)}projectTilePoint(c,f,_){return{x:c,y:f,z:0}}locationPoint(c,f,_=!0){return c._coordinatePoint(c.locationCoordinate(f),_)}pixelsPerMeter(c,f){return De(1,c)*f}pixelSpaceConversion(c,f,_){return 1}farthestPixelDistance(c){return wG(c,c.pixelsPerMeter)}pointCoordinate(c,f,_,A){const x=c.horizonLineFromTop(!1),T=new St(f,Math.max(x,_));return c.rayIntersectionCoordinate(c.pointRayIntersection(T,A))}pointCoordinate3D(c,f,_){const A=new St(f,_);if(c.elevation)return c.elevation.pointCoordinate(A);{const x=this.pointCoordinate(c,A.x,A.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(c,f){if(c.elevation&&c.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(c,f.x,f.y);const _=c.horizonLineFromTop();return f.y<_}createInversionMatrix(c,f){return Whe}createTileMatrix(c,f,_){let A,x,T;const B=_.canonical,U=Pe.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const j=Qw(B,this);A=1,x=j.x+_.wrap*j.scale,T=j.y,Pe.mat4.scale(U,U,[A/j.scale,A/j.scale,c.pixelsPerMeter/f])}else A=f/c.zoomScale(B.z),x=(B.x+Math.pow(2,B.z)*_.wrap)*A,T=B.y*A;return Pe.mat4.translate(U,U,[x,T,0]),Pe.mat4.scale(U,U,[A/yn,A/yn,1]),U}upVector(c,f,_){return[0,0,1]}upVectorScale(c,f,_){return{metersToTile:1}}}class Xhe extends t0{constructor(c){super(c),this.range=[4,7],this.center=c.center||[-96,37.5];const[f,_]=this.parallels=c.parallels||[29.5,45.5],A=Math.sin(sn(f));this.n=(A+Math.sin(sn(_)))/2,this.c=1+A*(2*this.n-A),this.r0=Math.sqrt(this.c)/this.n}project(c,f){const{n:_,c:A,r0:x}=this,T=sn(c-this.center[0]),B=sn(f),U=Math.sqrt(A-2*_*Math.sin(B))/_;return{x:U*Math.sin(T*_),y:U*Math.cos(T*_)-x,z:0}}unproject(c,f){const{n:_,c:A,r0:x}=this,T=x+f;let B=Math.atan2(c,Math.abs(T))*Math.sign(T);T*_<0&&(B-=Math.PI*Math.sign(c)*Math.sign(T));const U=sn(this.center[0])*_;B=Un(B,-Math.PI-U,Math.PI-U);const j=jt(at(B/_)+this.center[0],-180,180),R=Math.asin(jt((A-(c*c+T*T)*_*_)/(2*_),-1,1)),N=jt(at(R),-Ke,Ke);return new ue(j,N)}}const e2=1.340264,t2=-.081106,n2=893e-6,r2=.003796,HM=Math.sqrt(3)/2;class $he extends t0{project(c,f){f=f/180*Math.PI,c=c/180*Math.PI;const _=Math.asin(HM*Math.sin(f)),A=_*_,x=A*A*A;return{x:.5*(c*Math.cos(_)/(HM*(e2+3*t2*A+x*(7*n2+9*r2*A)))/Math.PI+.5),y:1-.5*(_*(e2+t2*A+x*(n2+r2*A))/Math.PI+1),z:0}}unproject(c,f){c=(2*c-.5)*Math.PI;let _=f=(2*(1-f)-1)*Math.PI,A=_*_,x=A*A*A;for(let R,N,V,z=0;z<12&&(N=_*(e2+t2*A+x*(n2+r2*A))-f,V=e2+3*t2*A+x*(7*n2+9*r2*A),R=N/V,_=jt(_-R,-Math.PI/3,Math.PI/3),A=_*_,x=A*A*A,!(Math.abs(R)<1e-12));++z);const T=HM*c*(e2+3*t2*A+x*(7*n2+9*r2*A))/Math.cos(_),B=Math.asin(Math.sin(_)/HM),U=jt(180*T/Math.PI,-180,180),j=jt(180*B/Math.PI,-Ke,Ke);return new ue(U,j)}}class qhe extends t0{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0}project(c,f){return{x:.5+c/360,y:.5-f/360,z:0}}unproject(c,f){const _=360*(c-.5),A=jt(360*(.5-f),-Ke,Ke);return new ue(_,A)}}const q1=Math.PI/2;function jM(g){return Math.tan((q1+g)/2)}class Zhe extends t0{constructor(c){super(c),this.center=c.center||[0,30];const[f,_]=this.parallels=c.parallels||[30,30];let A=sn(f),x=sn(_);this.southernCenter=A+x<0,this.southernCenter&&(A=-A,x=-x);const T=Math.cos(A),B=jM(A);this.n=A===x?Math.sin(A):Math.log(T/Math.cos(x))/Math.log(jM(x)/B),this.f=T*Math.pow(jM(A),this.n)/this.n}project(c,f){f=sn(f),this.southernCenter&&(f=-f),c=sn(c-this.center[0]);const _=1e-6,{n:A,f:x}=this;x>0?f<-q1+_&&(f=-q1+_):f>q1-_&&(f=q1-_);const T=x/Math.pow(jM(f),A);let B=T*Math.sin(A*c),U=x-T*Math.cos(A*c);return B=.5*(B/Math.PI+.5),U=.5*(U/Math.PI+.5),{x:B,y:this.southernCenter?U:1-U,z:0}}unproject(c,f){c=(2*c-.5)*Math.PI,this.southernCenter&&(f=1-f),f=(2*(1-f)-.5)*Math.PI;const{n:_,f:A}=this,x=A-f,T=Math.sign(x),B=Math.sign(_)*Math.sqrt(c*c+x*x);let U=Math.atan2(c,Math.abs(x))*T;x*_<0&&(U-=Math.PI*Math.sign(c)*T);const j=jt(at(U/_)+this.center[0],-180,180),R=jt(at(2*Math.atan(Math.pow(A/B,1/_))-q1),-Ke,Ke);return new ue(j,this.southernCenter?-R:R)}}class AG extends t0{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(c,f){return{x:ke(c),y:Ne(f),z:0}}unproject(c,f){const _=We(c),A=He(f);return new ue(_,A)}}const TG=sn(Ke);class Yhe extends t0{project(c,f){const _=(f=sn(f))*f,A=_*_;return{x:.5*((c=sn(c))*(.8707-.131979*_+A*(A*(.003971*_-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(f*(1.007226+_*(.015085+A*(.028874*_-.044475-.005916*A)))/Math.PI+1),z:0}}unproject(c,f){c=(2*c-.5)*Math.PI;let _=f=(2*(1-f)-1)*Math.PI,A=25,x=0,T=_*_;do{T=_*_;const j=T*T;x=(_*(1.007226+T*(.015085+j*(.028874*T-.044475-.005916*j)))-f)/(1.007226+T*(.045255+j*(.259866*T-.311325-.005916*11*j))),_=jt(_-x,-TG,TG)}while(Math.abs(x)>1e-6&&--A>0);T=_*_;const B=jt(at(c/(.8707+T*(T*(T*T*T*(.003971-.001529*T)-.013791)-.131979))),-180,180),U=at(_);return new ue(B,U)}}const MG=sn(Ke);class Khe extends t0{project(c,f){f=sn(f),c=sn(c);const _=Math.cos(f),A=2/Math.PI,x=Math.acos(_*Math.cos(c/2)),T=Math.sin(x)/x,B=.5*(c*A+2*_*Math.sin(c/2)/T)||0,U=.5*(f+Math.sin(f)/T)||0;return{x:.5*(B/Math.PI+.5),y:1-.5*(U/Math.PI+1),z:0}}unproject(c,f){let _=c=(2*c-.5)*Math.PI,A=f=(2*(1-f)-1)*Math.PI,x=25;const T=1e-6;let B=0,U=0;do{const j=Math.cos(A),R=Math.sin(A),N=2*R*j,V=R*R,z=j*j,G=Math.cos(_/2),X=Math.sin(_/2),K=2*G*X,te=X*X,ce=1-z*G*G,he=ce?1/ce:0,ne=ce?Math.acos(j*G)*Math.sqrt(1/ce):0,de=.5*(2*ne*j*X+2*_/Math.PI)-c,ge=.5*(ne*R+A)-f,Me=.5*he*(z*te+ne*j*G*V)+1/Math.PI,Be=he*(K*N/4-ne*R*X),Oe=.125*he*(N*X-ne*R*z*K),Re=.5*he*(V*G+ne*te*j)+.5,Ye=Be*Oe-Re*Me;B=(ge*Be-de*Re)/Ye,U=(de*Oe-ge*Me)/Ye,_=jt(_-B,-Math.PI,Math.PI),A=jt(A-U,-MG,MG)}while((Math.abs(B)>T||Math.abs(U)>T)&&--x>0);return new ue(at(_),at(A))}}class CG extends t0{constructor(c){super(c),this.center=c.center||[0,0],this.parallels=c.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(sn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(c,f){const{scale:_,cosPhi:A}=this;return{x:sn(c)*A*_+.5,y:-Math.sin(sn(f))/A*_+.5,z:0}}unproject(c,f){const{scale:_,cosPhi:A}=this,x=-(f-.5)/_,T=jt(at((c-.5)/_)/A,-180,180),B=Math.asin(jt(x*A,-1,1)),U=jt(at(B),-Ke,Ke);return new ue(T,U)}}class Jhe extends AG{constructor(c){super(c),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(c,f,_){const A=Fw(c,f,_),x=TM(Nd(_));return Pe.vec3.transformMat4(A,A,x),{x:A[0],y:A[1],z:A[2]}}locationPoint(c,f){const _=Q(f.lat,f.lng),A=Pe.vec3.normalize([],_),x=c.elevation?c.elevation.getAtPointOrZero(c.locationCoordinate(f),c._centerAltitude):c._centerAltitude,T=De(1,0)*yn*x;Pe.vec3.scaleAndAdd(_,_,A,T);const B=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.multiply(B,c.pixelMatrix,c.globeMatrix),Pe.vec3.transformMat4(_,_,B),new St(_[0],_[1])}pixelsPerMeter(c,f){return De(1,0)*f}pixelSpaceConversion(c,f,_){const A=De(1,c)*f,x=cr(De(1,45)*f,A,_);return this.pixelsPerMeter(c,f)/x}createTileMatrix(c,f,_){const A=M3(Nd(_.canonical));return Pe.mat4.multiply(new Float64Array(16),c.globeMatrix,A)}createInversionMatrix(c,f){const{center:_}=c,A=TM(Nd(f));return Pe.mat4.rotateY(A,A,sn(_.lng)),Pe.mat4.rotateX(A,A,sn(_.lat)),Pe.mat4.scale(A,A,[c._pixelsPerMercatorPixel,c._pixelsPerMercatorPixel,1]),Float32Array.from(A)}pointCoordinate(c,f,_,A){return wM(c,f,_,!0)||new xt(0,0)}pointCoordinate3D(c,f,_){const A=this.pointCoordinate(c,f,_,0);return[A.x,A.y,A.z]}isPointAboveHorizon(c,f){return!wM(c,f.x,f.y,!1)}farthestPixelDistance(c){const f=function(A,x){const T=A.cameraToCenterDistance,B=A._centerAltitude*x,U=A._camera,j=A._camera.forward(),R=Pe.vec3.add([],Pe.vec3.scale([],j,-T),[0,0,B]),N=A.worldSize/(2*Math.PI),V=[0,0,-N],z=A.width/A.height,G=Math.tan(A.fovAboveCenter),X=Pe.vec3.scale([],U.up(),G),K=Pe.vec3.scale([],U.right(),G*z),te=Pe.vec3.normalize([],Pe.vec3.add([],Pe.vec3.add([],j,X),K)),ce=[];let he;if(new vf(R,te).closestPointOnSphere(V,N,ce)){const ne=Pe.vec3.add([],ce,V),de=Pe.vec3.sub([],ne,R);he=Math.cos(A.fovAboveCenter)*Pe.vec3.length(de)}else{const ne=Pe.vec3.sub([],R,V),de=Pe.vec3.sub([],V,R);Pe.vec3.normalize(de,de);const ge=Pe.vec3.length(ne)-N;he=Math.sqrt(ge*(ge+2*N));const Me=Math.acos(he/(N+ge))-Math.acos(Pe.vec3.dot(j,de));he*=Math.cos(Me)}return 1.01*he}(c,this.pixelsPerMeter(c.center.lat,c.worldSize)),_=Yg(c.zoom);if(_>0){const A=wG(c,De(1,c.center.lat)*c.worldSize),x=c.worldSize/(2*Math.PI),T=Math.max(c.width,c.height)/c.worldSize*Math.PI;return cr(f,A+x*(1-Math.cos(T)),Math.pow(_,10))}return f}upVector(c,f,_){return Fw(f,_,c,1)}upVectorScale(c){return{metersToTile:sm(AM(Nd(c)))}}}function EG(g){const c=g.parallels,f=!!c&&Math.abs(c[0]+c[1])<.01;switch(g.name){case"mercator":return new AG(g);case"equirectangular":return new qhe(g);case"naturalEarth":return new Yhe(g);case"equalEarth":return new $he(g);case"winkelTripel":return new Khe(g);case"albers":return f?new CG(g):new Xhe(g);case"lambertConformalConic":return f?new CG(g):new Zhe(g);case"globe":return new Jhe(g)}throw new Error(`Invalid projection name: ${g.name}`)}const Qhe=H1.VectorTileFeature.types,efe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function WM(g,c,f,_,A,x,T,B,U,j,R,N,V){const z=B?Math.min(e0,Math.round(B[0])):0,G=B?Math.min(e0,Math.round(B[1])):0;g.emplaceBack(c,f,Math.round(32*_),Math.round(32*A),x,T,(z<<1)+(U?1:0),G,16*j,16*R,256*N,256*V)}function XM(g,c,f){g.emplaceBack(c,f)}function $M(g,c,f,_,A,x,T){g.emplaceBack(c,f,_,A,x,T)}function qM(g,c,f,_,A){g.emplaceBack(c,f,_,A),g.emplaceBack(c,f,_,A),g.emplaceBack(c,f,_,A),g.emplaceBack(c,f,_,A)}function tfe(g){for(const c of g.sections)if(B1(c.text))return!0;return!1}class r4{constructor(c){this.layoutVertexArray=new s_,this.indexArray=new wo,this.programConfigurations=c,this.segments=new bs,this.dynamicLayoutVertexArray=new Rl,this.opacityVertexArray=new Ug,this.placedSymbolArray=new jg,this.iconTransitioningVertexArray=new Su,this.globeExtVertexArray=new Hc,this.zOffsetVertexArray=new Dd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(c,f,_,A,x){this.isEmpty()||(_&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,_he.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,xhe.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,efe,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=c.createVertexBuffer(this.iconTransitioningVertexArray,whe.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=c.createVertexBuffer(this.globeExtVertexArray,yhe.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||x)&&(this.zOffsetVertexBuffer=c.createVertexBuffer(this.zOffsetVertexArray,bhe.members,!0)),this.opacityVertexBuffer.itemSize=1),(_||A)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Fn(r4,"SymbolBuffers");class i4{constructor(c,f,_){this.layoutVertexArray=new c,this.layoutAttributes=f,this.indexArray=new _,this.segments=new bs,this.collisionVertexArray=new mf,this.collisionVertexArrayExt=new Rl}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,She.members,!0),this.collisionVertexBufferExt=c.createVertexBuffer(this.collisionVertexArrayExt,Ahe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Fn(i4,"CollisionBuffers");class ZM{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.lut=c.lut,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(T=>T.fqid),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Pe.mat4.identity([]),this.placementViewportMatrix=Pe.mat4.identity([]);const f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=X3(this.zoom,f["text-size"]),this.iconSizeData=X3(this.zoom,f["icon-size"]);const _=this.layers[0].layout,A=_.get("symbol-sort-key"),x=_.get("symbol-z-order");this.canOverlap=_.get("text-allow-overlap")||_.get("icon-allow-overlap")||_.get("text-ignore-placement")||_.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=_.get("text-writing-mode").map(T=>Tu[T]),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=c.sourceID,this.projection=c.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=_.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new r4(new rr(this.layers,{zoom:this.zoom,lut:this.lut},c=>c.startsWith("text")||c.startsWith("symbol"))),this.icon=new r4(new rr(this.layers,{zoom:this.zoom,lut:this.lut},c=>c.startsWith("icon")||c.startsWith("symbol"))),this.glyphOffsetArray=new Wg,this.lineVertexArray=new Xg,this.symbolInstances=new el}calculateGlyphDependencies(c,f,_,A,x){for(let T=0;T<c.length;T++){const B=c.codePointAt(T);if(B===void 0)break;if(f[B]=!0,A&&x&&B<=65535){const U=qw[c.charAt(T)];U&&(f[U.charCodeAt(0)]=!0)}}}updateFootprints(c,f){}updateReplacement(c,f){if(f.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=f.updateTime;const _=f.getReplacementRegionsForTile(c.toUnwrapped(),!0);return!U3(this.activeReplacements,_)&&(this.activeReplacements=_,!0)}populate(c,f,_,A){const x=this.layers[0],T=x.layout,B=this.projection.name==="globe",U=T.get("text-font"),j=T.get("text-field"),R=T.get("icon-image"),N=(j.value.kind!=="constant"||j.value.value instanceof Lo&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(U.value.kind!=="constant"||U.value.value.length>0),V=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,z=T.get("symbol-sort-key");if(this.features=[],!N&&!V)return;const G=f.iconDependencies,X=f.glyphDependencies,K=f.availableImages,te=new ds(this.zoom);for(const{feature:ce,id:he,index:ne,sourceLayerIndex:de}of c){const ge=x._featureFilter.needGeometry,Me=pn(ce,ge);if(!x._featureFilter.filter(te,Me,_))continue;if(ge||(Me.geometry=fn(ce,_,A)),B&&ce.type!==1&&_.z<=5){const Ye=Me.geometry,ze=.98078528056,Qe=(ct,ht)=>{const ft=Fw(ct.x,ct.y,_,1),mt=Fw(ht.x,ht.y,_,1);return Pe.vec3.dot(ft,mt)<ze};for(let ct=0;ct<Ye.length;ct++)Ye[ct]=hn(Ye[ct],Qe)}let Be,Oe;if(N){const Ye=x.getValueAndResolveTokens("text-field",Me,_,K),ze=Lo.factory(Ye);tfe(ze)&&(this.hasRTLText=!0),(!this.hasRTLText||Og()==="unavailable"||this.hasRTLText&&Fa.isParsed())&&(Be=Che(ze,x,Me))}if(V){const Ye=x.getValueAndResolveTokens("icon-image",Me,_,K);Oe=Ye instanceof qo?Ye:qo.fromString(Ye)}if(!Be&&!Oe)continue;const Re=this.sortFeaturesByKey?z.evaluate(Me,{},_):void 0;if(this.features.push({id:he,text:Be,icon:Oe,index:ne,sourceLayerIndex:de,geometry:Me.geometry,properties:ce.properties,type:Qhe[ce.type],sortKey:Re}),Oe&&(G[Oe.namePrimary]=!0,Oe.nameSecondary&&(G[Oe.nameSecondary]=!0)),Be){const Ye=U.evaluate(Me,{},_).join(","),ze=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Tu.vertical)>=0;for(const Qe of Be.sections)if(Qe.image)G[Qe.image.namePrimary]=!0;else{const ct=Gc(Be.toString()),ht=Qe.fontStack||Ye,ft=X[ht]=X[ht]||{};this.calculateGlyphDependencies(Qe.text,ft,ze,this.allowVerticalPlacement,ct)}}}T.get("symbol-placement")==="line"&&(this.features=function(ce){const he={},ne={},de=[];let ge=0;function Me(Ye){de.push(ce[Ye]),ge++}function Be(Ye,ze,Qe){const ct=ne[Ye];return delete ne[Ye],ne[ze]=ct,de[ct].geometry[0].pop(),de[ct].geometry[0]=de[ct].geometry[0].concat(Qe[0]),ct}function Oe(Ye,ze,Qe){const ct=he[ze];return delete he[ze],he[Ye]=ct,de[ct].geometry[0].shift(),de[ct].geometry[0]=Qe[0].concat(de[ct].geometry[0]),ct}function Re(Ye,ze,Qe){const ct=Qe?ze[0][ze[0].length-1]:ze[0][0];return`${Ye}:${ct.x}:${ct.y}`}for(let Ye=0;Ye<ce.length;Ye++){const ze=ce[Ye],Qe=ze.geometry,ct=ze.text?ze.text.toString():null;if(!ct){Me(Ye);continue}const ht=Re(ct,Qe),ft=Re(ct,Qe,!0);if(ht in ne&&ft in he&&ne[ht]!==he[ft]){const mt=Oe(ht,ft,Qe),Et=Be(ht,ft,de[mt].geometry);delete he[ht],delete ne[ft],ne[Re(ct,de[Et].geometry,!0)]=Et,de[mt].geometry=null}else ht in ne?Be(ht,ft,Qe):ft in he?Oe(ht,ft,Qe):(Me(Ye),he[ht]=ge-1,ne[ft]=ge-1)}return de.filter(Ye=>Ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,he)=>ce.sortKey-he.sortKey)}update(c,f,_,A,x){const T=Object.keys(c).length!==0;if(T&&!this.stateDependentLayers.length)return;const B=T?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(c,f,B,_,A,x),this.icon.programConfigurations.updatePaintArrays(c,f,B,_,A,x)}updateZOffset(){const c=(x,T,B)=>{_+=T,_>x.length&&x.resize(_);for(let U=-T;U<0;U++)x.emplace(U+_,B)},f=(x,T,B)=>{A+=T,A>x.length&&x.resize(A);for(let U=-T;U<0;U++)x.emplace(U+A,B)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let _=0,A=0;for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x),{numHorizontalGlyphVertices:B,numVerticalGlyphVertices:U,numIconVertices:j}=T,R=T.zOffset,N=j>0;if((B>0||U>0)&&(c(this.text.zOffsetVertexArray,B,R),c(this.text.zOffsetVertexArray,U,R)),N){const{placedIconSymbolIndex:V,verticalPlacedIconSymbolIndex:z}=T;V>=0&&f(this.icon.zOffsetVertexArray,j,R),z>=0&&f(this.icon.zOffsetVertexArray,T.numVerticalIconVertices,R)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=EG(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,f){const _=this.lineVertexArray.length;if(c.segment!==void 0)for(const{x:A,y:x}of f)this.lineVertexArray.emplaceBack(A,x);return{lineStartIndex:_,lineLength:this.lineVertexArray.length-_}}addSymbols(c,f,_,A,x,T,B,U,j,R,N,V,z,G,X,K){const te=c.indexArray,ce=c.layoutVertexArray,he=c.globeExtVertexArray,ne=c.segments.prepareSegment(4*f.length,ce,te,this.canOverlap?T.sortKey:void 0),de=this.glyphOffsetArray.length,ge=ne.vertexLength,Me=this.allowVerticalPlacement&&B===Tu.vertical?Math.PI/2:0,Be=T.text&&T.text.sections;for(let Re=0;Re<f.length;Re++){const{tl:Ye,tr:ze,bl:Qe,br:ct,texPrimary:ht,texSecondary:ft,pixelOffsetTL:mt,pixelOffsetBR:Et,minFontScaleX:vt,minFontScaleY:Ut,glyphOffset:Yt,isSDF:Dt,sectionIndex:Rn}=f[Re],bn=ne.vertexLength,dn=Yt[1];if(WM(ce,j.x,j.y,Ye.x,dn+Ye.y,ht.x,ht.y,_,Dt,mt.x,mt.y,vt,Ut),WM(ce,j.x,j.y,ze.x,dn+ze.y,ht.x+ht.w,ht.y,_,Dt,Et.x,mt.y,vt,Ut),WM(ce,j.x,j.y,Qe.x,dn+Qe.y,ht.x,ht.y+ht.h,_,Dt,mt.x,Et.y,vt,Ut),WM(ce,j.x,j.y,ct.x,dn+ct.y,ht.x+ht.w,ht.y+ht.h,_,Dt,Et.x,Et.y,vt,Ut),U){const{x:tn,y:nr,z:In}=U.anchor,[Nn,wr,Or]=U.up;$M(he,tn,nr,In,Nn,wr,Or),$M(he,tn,nr,In,Nn,wr,Or),$M(he,tn,nr,In,Nn,wr,Or),$M(he,tn,nr,In,Nn,wr,Or),qM(c.dynamicLayoutVertexArray,tn,nr,In,Me)}else qM(c.dynamicLayoutVertexArray,j.x,j.y,j.z,Me);if(K){const tn=ft||ht;XM(c.iconTransitioningVertexArray,tn.x,tn.y),XM(c.iconTransitioningVertexArray,tn.x+tn.w,tn.y),XM(c.iconTransitioningVertexArray,tn.x,tn.y+tn.h),XM(c.iconTransitioningVertexArray,tn.x+tn.w,tn.y+tn.h)}te.emplaceBack(bn,bn+1,bn+2),te.emplaceBack(bn+1,bn+2,bn+3),ne.vertexLength+=4,ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Yt[0]),Re!==f.length-1&&Rn===f[Re+1].sectionIndex||c.programConfigurations.populatePaintArrays(ce.length,T,T.index,{},z,G,X,Be&&Be[Rn])}const Oe=U?U.anchor:j;c.placedSymbolArray.emplaceBack(Oe.x,Oe.y,Oe.z,j.x,j.y,de,this.glyphOffsetArray.length-de,ge,R,N,j.segment,_?_[0]:0,_?_[1]:0,A[0],A[1],B,0,!1,0,V,0)}_commitLayoutVertex(c,f,_,A,x,T,B){c.emplaceBack(f,_,A,x,T,Math.round(B.x),Math.round(B.y))}_addCollisionDebugVertices(c,f,_,A,x,T,B){const U=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),j=U.vertexLength,R=B.tileAnchorX,N=B.tileAnchorY;for(let z=0;z<4;z++)_.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(_.collisionVertexArrayExt,f,c.padding,B.zOffset),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x1,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x2,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x2,c.y2)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x1,c.y2)),U.vertexLength+=4;const V=_.indexArray;V.emplaceBack(j,j+1),V.emplaceBack(j+1,j+2),V.emplaceBack(j+2,j+3),V.emplaceBack(j+3,j),U.primitiveLength+=4}_addTextDebugCollisionBoxes(c,f,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceTextSize(c,T,f,B);this._addCollisionDebugVertices(U,j,this.textCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,T)}}_addIconDebugCollisionBoxes(c,f,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceIconSize(c,f,T.placedIconSymbolIndex);this._addCollisionDebugVertices(U,j,this.iconCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,T)}}generateCollisionDebugBuffers(c,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new i4(dl,Y7.members,Su),this.iconCollisionBox=new i4(dl,Y7.members,Su);const _=j1(this.iconSizeData,c),A=j1(this.textSizeData,c);for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(A,c,f,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(A,c,f,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,c,f,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,c,f,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(c,f,_,A){const x=this.text.placedSymbolArray.get(f.rightJustifiedTextSymbolIndex>=0?f.rightJustifiedTextSymbolIndex:f.centerJustifiedTextSymbolIndex>=0?f.centerJustifiedTextSymbolIndex:f.leftJustifiedTextSymbolIndex>=0?f.leftJustifiedTextSymbolIndex:f.verticalPlacedTextSymbolIndex>=0?f.verticalPlacedTextSymbolIndex:A),T=OM(this.textSizeData,c,x)/Na;return this.tilePixelRatio*T}getSymbolInstanceIconSize(c,f,_){const A=this.icon.placedSymbolArray.get(_),x=OM(this.iconSizeData,c,A);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(c,f,_,A){c.emplaceBack(f,-_,-_,A),c.emplaceBack(f,_,-_,A),c.emplaceBack(f,_,_,A),c.emplaceBack(f,-_,_,A)}_updateTextDebugCollisionBoxes(c,f,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceTextSize(c,T,f,B);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,j,U.padding,T.zOffset)}}_updateIconDebugCollisionBoxes(c,f,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceIconSize(c,f,T.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,j,U.padding,T.zOffset)}}updateCollisionDebugBuffers(c,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=j1(this.iconSizeData,c),A=j1(this.textSizeData,c);for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(A,c,f,T.textBoxStartIndex,T.textBoxEndIndex,T),this._updateTextDebugCollisionBoxes(A,c,f,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._updateIconDebugCollisionBoxes(_,c,f,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._updateIconDebugCollisionBoxes(_,c,f,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(c,f,_,A,x,T,B,U,j){const R={};if(f<_){const{x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(f);R.textBox={x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.textFeatureIndex=de}if(A<x){const{x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(A);R.verticalTextBox={x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.verticalTextFeatureIndex=de}if(T<B){const{x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(T);R.iconBox={x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.iconFeatureIndex=de}if(U<j){const{x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(U);R.verticalIconBox={x1:N,y1:V,x2:z,y2:G,padding:X,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.verticalIconFeatureIndex=de}return R}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,_.textBoxStartIndex,_.textBoxEndIndex,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_.iconBoxStartIndex,_.iconBoxEndIndex,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(c,f){const _=c.placedSymbolArray.get(f),A=_.vertexStartIndex+4*_.numGlyphs;for(let x=_.vertexStartIndex;x<A;x+=4)c.indexArray.emplaceBack(x,x+1,x+2),c.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const f=Math.sin(c),_=Math.cos(c),A=[],x=[],T=[];for(let B=0;B<this.symbolInstances.length;++B){T.push(B);const U=this.symbolInstances.get(B);A.push(0|Math.round(f*U.tileAnchorX+_*U.tileAnchorY)),x.push(U.featureIndex)}return T.sort((B,U)=>A[B]-A[U]||x[U]-x[B]),T}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let c=0;c<this.symbolInstances.length;++c)this.symbolInstanceIndexesSortedZOffset.push(c)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((c,f)=>this.symbolInstances.get(f).zOffset-this.symbolInstances.get(c).zOffset)}addToSortKeyRanges(c,f){const _=this.sortKeyRanges[this.sortKeyRanges.length-1];_&&_.sortKey===f?_.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes){const _=this.symbolInstances.get(f);this.featureSortOrder.push(_.featureIndex);const{rightJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:T,verticalPlacedTextSymbolIndex:B,placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:j}=_;A>=0&&this.addIndicesForPlacedSymbol(this.text,A),x>=0&&x!==A&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&T!==x&&T!==A&&this.addIndicesForPlacedSymbol(this.text,T),B>=0&&this.addIndicesForPlacedSymbol(this.text,B),U>=0&&this.addIndicesForPlacedSymbol(this.icon,U),j>=0&&this.addIndicesForPlacedSymbol(this.icon,j)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let IG,RG,s4;Fn(ZM,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ZM.addDynamicAttributes=qM;class PG{constructor(c){this.type=c.property.overrides?c.property.overrides.runtimeType:Jl,this.defaultValue=c}evaluate(c){if(c.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(c.formattedSection))return f.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Fn(PG,"FormatSectionOverride",{omit:["defaultValue"]});const o4=()=>s4||(s4={layout:IG||(IG=new ji({"symbol-placement":new gn(At.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(At.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(At.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kn(At.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(At.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new gn(At.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new gn(At.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gn(At.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(At.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(At.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kn(At.layout_symbol["icon-size"]),"icon-text-fit":new Kn(At.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kn(At.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kn(At.layout_symbol["icon-image"]),"icon-rotate":new Kn(At.layout_symbol["icon-rotate"]),"icon-padding":new gn(At.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(At.layout_symbol["icon-keep-upright"]),"icon-offset":new Kn(At.layout_symbol["icon-offset"]),"icon-anchor":new Kn(At.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(At.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(At.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(At.layout_symbol["text-rotation-alignment"]),"text-field":new Kn(At.layout_symbol["text-field"]),"text-font":new Kn(At.layout_symbol["text-font"]),"text-size":new Kn(At.layout_symbol["text-size"]),"text-max-width":new Kn(At.layout_symbol["text-max-width"]),"text-line-height":new Kn(At.layout_symbol["text-line-height"]),"text-letter-spacing":new Kn(At.layout_symbol["text-letter-spacing"]),"text-justify":new Kn(At.layout_symbol["text-justify"]),"text-radial-offset":new Kn(At.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(At.layout_symbol["text-variable-anchor"]),"text-anchor":new Kn(At.layout_symbol["text-anchor"]),"text-max-angle":new gn(At.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(At.layout_symbol["text-writing-mode"]),"text-rotate":new Kn(At.layout_symbol["text-rotate"]),"text-padding":new gn(At.layout_symbol["text-padding"]),"text-keep-upright":new gn(At.layout_symbol["text-keep-upright"]),"text-transform":new Kn(At.layout_symbol["text-transform"]),"text-offset":new Kn(At.layout_symbol["text-offset"]),"text-allow-overlap":new gn(At.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gn(At.layout_symbol["text-ignore-placement"]),"text-optional":new gn(At.layout_symbol["text-optional"]),visibility:new gn(At.layout_symbol.visibility)})),paint:RG||(RG=new ji({"icon-opacity":new Kn(At.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Kn(At.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Kn(At.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Kn(At.paint_symbol["text-emissive-strength"]),"icon-color":new Kn(At.paint_symbol["icon-color"]),"icon-halo-color":new Kn(At.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kn(At.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kn(At.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(At.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(At.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Kn(At.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Kn(At.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Kn(At.paint_symbol["text-occlusion-opacity"]),"text-color":new Kn(At.paint_symbol["text-color"],{runtimeType:Us,getOverride:g=>g.textColor,hasOverride:g=>!!g.textColor}),"text-halo-color":new Kn(At.paint_symbol["text-halo-color"]),"text-halo-width":new Kn(At.paint_symbol["text-halo-width"]),"text-halo-blur":new Kn(At.paint_symbol["text-halo-blur"]),"text-translate":new gn(At.paint_symbol["text-translate"]),"text-translate-anchor":new gn(At.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new gn(At.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new gn(At.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new gn(At.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new gn(At.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Kn(At.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new gn(At.paint_symbol["symbol-elevation-reference"])}))},s4);class YM extends Hs{constructor(c,f,_,A){super(c,o4(),f,_,A),this._colorAdjustmentMatrix=Pe.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=c.paint!==void 0&&("icon-occlusion-opacity"in c.paint||"text-occlusion-opacity"in c.paint)}recalculate(c,f){super.recalculate(c,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const _=this.layout.get("text-writing-mode");if(_){const A=[];for(const x of _)A.indexOf(x)<0&&A.push(x);this.layout._values["text-writing-mode"]=A}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(c,f,_,A){return this._saturation===c&&this._contrast===f&&this._brightnessMin===_&&this._brightnessMax===A||(this._colorAdjustmentMatrix=function(x,T,B,U){x=Xe(x),T=Ee(T);const j=Pe.mat4.create(),R=x/3,N=1-2*R,V=[N,R,R,0,R,N,R,0,R,R,N,0,0,0,0,1],z=.5-.5*T,G=U-B;return Pe.mat4.multiply(j,[G,0,0,0,0,G,0,0,0,0,G,0,B,B,B,1],[T,0,0,0,0,T,0,0,0,0,T,0,z,z,z,1]),Pe.mat4.multiply(j,j,V),j}(c,f,_,A),this._saturation=c,this._contrast=f,this._brightnessMin=_,this._brightnessMax=A),this._colorAdjustmentMatrix}getValueAndResolveTokens(c,f,_,A){const x=this.layout.get(c).evaluate(f,{},_,A),T=this._unevaluatedLayout._values[c];return T.isDataDriven()||bd(T.value)||!x?x:function(B,U){return U.replace(/{([^{}]+)}/g,(j,R)=>R in B?String(B[R]):"")}(f.properties,x)}createBucket(c){return new ZM(c)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const c of o4().paint.overridableProperties){if(!YM.hasPaintOverride(this.layout,c))continue;const f=this.paint.get(c),_=new PG(f),A=new $p(_,f.property.specification,this.scope,this.options);let x=null;x=f.value.kind==="constant"||f.value.kind==="source"?new Dg("source",A):new fl("composite",A,f.value.zoomStops,f.value._interpolationType),this.paint._values[c]=new Ju(f.property,x,f.parameters)}}_handleOverridablePaintPropertyUpdate(c,f,_){return!(!this.layout||f.isDataDriven()||_.isDataDriven())&&YM.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,f){const _=c.get("text-field"),A=o4().paint.properties[f];let x=!1;const T=B=>{for(const U of B)if(A.overrides&&A.overrides.hasOverride(U))return void(x=!0)};if(_.value.kind==="constant"&&_.value.value instanceof Lo)T(_.value.value.sections);else if(_.value.kind==="source"){const B=j=>{x||(j instanceof cl&&Ds(j.value)===$a?T(j.value.sections):j instanceof La?T(j.sections):j.eachChild(B))},U=_.value;U._styleExpression&&B(U._styleExpression.expression)}return x}getProgramIds(){return["symbol"]}getDefaultProgramParams(c,f,_){return{config:new on(this,{zoom:f,lut:_}),overrideFog:!1}}}let LG,DG,BG,kG;var a4=Qr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function l4(g){switch(g){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function c4(g){switch(g){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class u4{constructor(c,f,_,A){this.context=c,this.format=_,this.useMipmap=A&&A.useMipmap,this.texture=c.gl.createTexture(),this.update(f,{premultiply:A&&A.premultiply})}update(c,f){const _=c&&c instanceof HTMLVideoElement&&c.width===0?c.videoWidth:c.width,A=c&&c instanceof HTMLVideoElement&&c.height===0?c.videoHeight:c.height,{context:x}=this,{gl:T}=x,{x:B,y:U}=f&&f.position?f.position:{x:0,y:0},j=Math.max(B+_,this.size?this.size[0]:0),R=Math.max(U+A,this.size?this.size[1]:0);!this.size||this.size[0]===j&&this.size[1]===R||(T.bindTexture(T.TEXTURE_2D,null),T.deleteTexture(this.texture),this.texture=T.createTexture(),this.size=null),T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA8&&(!f||f.premultiply!==!1));const N=c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||ImageBitmap&&c instanceof ImageBitmap;if(!this.size&&j>0&&R>0){const V=this.useMipmap?Math.floor(Math.log2(Math.max(j,R)))+1:1;T.texStorage2D(T.TEXTURE_2D,V,this.format,j,R),this.size=[j,R]}if(this.size)if(N)T.texSubImage2D(T.TEXTURE_2D,0,B,U,l4(this.format),c4(this.format),c);else{const V=c.data;V&&T.texSubImage2D(T.TEXTURE_2D,0,B,U,_,A,l4(this.format),c4(this.format),V)}this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(c,f,_=!1){const{context:A}=this,{gl:x}=A;x.bindTexture(x.TEXTURE_2D,this.texture),c!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,c),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap&&!_?c===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:c),this.minFilter=c),f!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,f),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,f),this.wrapS=f)}bindExtraParam(c,f,_,A){const{context:x}=this,{gl:T}=x;T.bindTexture(T.TEXTURE_2D,this.texture),f!==this.magFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,f),this.magFilter=f),c!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?c===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR:c),this.minFilter=c),_!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,_),this.wrapS=_),A!==this.wrapT&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,A),this.wrapT=A)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class KM{constructor(c,f){this.context=c,this.texture=f}bind(c,f){const{context:_}=this,{gl:A}=_;A.bindTexture(A.TEXTURE_2D,this.texture),c!==this.minFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,c),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,c),this.minFilter=c),f!==this.wrapS&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,f),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,f),this.wrapS=f)}}function JM(g,c,f,_,A,x,T,B){const U=[g,c,1,f,_,1,A,x,1],j=[T,B,1],R=Pe.mat3.adjoint([],U),[N,V,z]=Pe.vec3.transformMat3(j,j,R);return Pe.mat3.multiply(U,U,[N,0,0,0,V,0,0,0,z])}function OG(g,c,f,_,A,x,T,B){const U=function(j,R,N,V,z,G,X,K){const te=JM(0,0,1,0,1,1,0,1),ce=JM(j,R,N,V,z,G,X,K),he=Pe.mat3.adjoint([],te);return Pe.mat3.multiply(ce,ce,he)}(g,c,f,_,A,x,T,B);return[U[2]/U[8]/yn,U[5]/U[8]/yn]}function QM(g){return[g[0],Math.min(Math.max(g[1],-Ke),Ke)]}class FG extends Vu{constructor(c,f,_,A){super(),this.id=c,this.dispatcher=_,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(A),this.options=f,this._dirty=!1}load(c,f){if(this._loaded=f||!1,this.fire(new Kl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return c&&(this.coordinates=c),this._loaded=!0,void this._finishLoading();this._imageRequest=As(this.map._requestManager.transformRequest(this.url,Zi.Image),(_,A)=>{this._imageRequest=null,this._loaded=!0,_?this.fire(new Tp(_)):A&&(this.image=A instanceof HTMLImageElement?Cn.getImageData(A):A,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}setTexture(c){if(!(c.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new KM(this.map.painter.context,c.handle),this.width=c.dimensions[0],this.height=c.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Kl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(c){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof KM||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(c){if(this.coordinates=c,this._boundsArray=void 0,this._unsupportedCoords=!1,!c.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let f=c[0][1],_=c[0][1];for(const x of c)x[1]>_&&(_=x[1]),x[1]<f&&(f=x[1]);const A=(_+f)/2;if(A>Ke?this.onNorthPole=!0:A<-Ke&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const x=c.map(xt.fromLngLat);this.tileID=function(T){let B=1/0,U=1/0,j=-1/0,R=-1/0;for(const X of T)B=Math.min(B,X.x),U=Math.min(U,X.y),j=Math.max(j,X.x),R=Math.max(R,X.y);const N=Math.max(j-B,R-U),V=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),z=Math.pow(2,V);let G=Math.floor((B+j)/2*z);return G>1&&(G-=1),new Ko(V,G,Math.floor((U+R)/2*z))}(x),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Kl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(c){for(const te in this.tiles){const ce=this.tiles[te];ce.state!=="loaded"&&(ce.state="loaded",ce.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const f=Qw(new Ko(0,0,0),this.map.transform.projection),_=[f.projection.project(this.coordinates[0][0],this.coordinates[0][1]),f.projection.project(this.coordinates[1][0],this.coordinates[1][1]),f.projection.project(this.coordinates[2][0],this.coordinates[2][1]),f.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(te){const ce=te[1].x-te[0].x,he=te[1].y-te[0].y,ne=te[2].x-te[1].x,de=te[2].y-te[1].y,ge=te[3].x-te[2].x,Me=te[3].y-te[2].y,Be=te[0].x-te[3].x,Oe=te[0].y-te[3].y,Re=ce*de-ne*he,Ye=ne*Me-ge*de,ze=ge*Oe-Be*Me,Qe=Be*he-ce*Oe;return Re>0&&Ye>0&&ze>0&&Qe>0||Re<0&&Ye<0&&ze<0&&Qe<0}(_))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const A=Qw(this.tileID,this.map.transform.projection),[x,T,B,U]=this.coordinates.map(te=>{const ce=A.projection.project(te[0],te[1]);return SG(A,ce)._round()});this.perspectiveTransform=OG(x.x,x.y,T.x,T.y,B.x,B.y,U.x,U.y);const j=this._boundsArray=new Js;j.emplaceBack(x.x,x.y,0,0),j.emplaceBack(T.x,T.y,yn,0),j.emplaceBack(U.x,U.y,0,yn),j.emplaceBack(B.x,B.y,yn,yn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=c.createVertexBuffer(j,a4.members),this.boundsSegments=bs.simpleSegment(0,0,4,2);const R=[],N=[QM((V=this.coordinates)[0]),QM(V[1]),QM(V[2]),QM(V[3])];var V;const[z,G,X,K]=function(te){let ce=te[0][0],he=ce,ne=te[0][1],de=ne;for(let ge=1;ge<te.length;ge++)te[ge][0]<ce?ce=te[ge][0]:te[ge][0]>he&&(he=te[ge][0]),te[ge][1]<ne?ne=te[ge][1]:te[ge][1]>de&&(de=te[ge][1]);return[ce,ne,he-ce,de-ne]}(N);{const te=new Js,[ce,he,ne,de]=function(mt){let Et=mt[0].x,vt=Et,Ut=mt[0].y,Yt=Ut;for(let Dt=1;Dt<mt.length;Dt++)mt[Dt].x<Et?Et=mt[Dt].x:mt[Dt].x>vt&&(vt=mt[Dt].x),mt[Dt].y<Ut?Ut=mt[Dt].y:mt[Dt].y>Yt&&(Yt=mt[Dt].y);return[Et,Ut,vt-Et,Yt-Ut]}(_),ge=mt=>[(mt.x-ce)/ne,(mt.y-he)/de],[Me,Be,Oe,Re]=_.map(ge),Ye=function(mt,Et,vt,Ut,Yt,Dt,Rn,bn){const dn=JM(0,0,1,0,1,1,0,1),tn=JM(mt,Et,vt,Ut,Yt,Dt,Rn,bn),nr=Pe.mat3.adjoint([],tn);return Pe.mat3.multiply(dn,dn,nr)}(Me[0],Me[1],Be[0],Be[1],Oe[0],Oe[1],Re[0],Re[1]);this.elevatedGlobePerspectiveTransform=OG(Me[0],Me[1],Be[0],Be[1],Oe[0],Oe[1],Re[0],Re[1]);const ze=(mt,Et)=>{R.push(mt.lng);const vt=Math.round((mt.lng-z)/X*yn),Ut=Math.round((mt.lat-G)/K*yn),Yt=ge(Et),Dt=Pe.vec3.transformMat3([],[Yt[0],Yt[1],1],Ye),Rn=Math.round(Dt[0]/Dt[2]*yn),bn=Math.round(Dt[1]/Dt[2]*yn);te.emplaceBack(vt,Ut,Rn,bn)},Qe=_[3].x-_[0].x,ct=_[3].y-_[0].y,ht=_[2].x-_[1].x,ft=_[2].y-_[1].y;for(let mt=0;mt<65;mt++){const Et=mt/64,vt=[_[0].x+Et*Qe,_[0].y+Et*ct],Ut=[_[1].x+Et*ht,_[1].y+Et*ft],Yt=Ut[0]-vt[0],Dt=Ut[1]-vt[1];for(let Rn=0;Rn<65;Rn++){const bn=Rn/64,dn={x:vt[0]+Yt*bn,y:vt[1]+Dt*bn,z:0};ze(f.projection.unproject(dn.x,dn.y),dn)}}this.elevatedGlobeVertexBuffer=c.createVertexBuffer(te,a4.members)}{this.maxLongitudeTriangleSize=0;let te=[],ce=new wo;const he=(ne,de,ge)=>{ce.emplaceBack(ne,de,ge);const Me=R[ne],Be=R[de],Oe=R[ge],Re=Math.min(Math.min(Me,Be),Oe),Ye=Math.max(Math.max(Me,Be),Oe)-Re;Ye>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ye),te.push(Re+Ye/2)};for(let ne=0;ne<64;ne++)for(let de=0;de<64;de++){const ge=65*ne+de,Me=ge+1,Be=ge+65,Oe=Be+1;he(ge,Be,Me),he(Me,Be,Oe)}[te,ce]=function(ne,de){const ge=Array.from({length:ne.length},(Oe,Re)=>Re);ge.sort((Oe,Re)=>ne[Oe]-ne[Re]);const Me=[],Be=new wo;for(let Oe=0;Oe<ge.length;Oe++){const Re=ge[Oe];Me.push(ne[Re]);const Ye=3*Re,ze=Ye+1;Be.emplaceBack(de.uint16[Ye],de.uint16[ze],de.uint16[ze+1])}return[Me,Be]}(te,ce),this.elevatedGlobeTrianglesCenterLongitudes=te,this.elevatedGlobeIndexBuffer=c.createIndexBuffer(ce)}this.elevatedGlobeSegments=bs.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,X/yn,0,K/yn,0,0,G,z,0])}prepare(){const c=Object.keys(this.tiles).length!==0;if(this.tileID&&!c)return;const f=this.map.painter.context,_=f.gl;!this._dirty||this.texture instanceof KM||(this.texture?this.texture.update(this.image):(this.texture=new u4(f,this.image,_.RGBA8),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE)),this._dirty=!1),c&&this._prepareData(f)}loadTile(c,f){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},f(null)):(c.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(c){const f=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!f)return null;const _=this.elevatedGlobeTrianglesCenterLongitudes;let A=(x=c+180)+360*Math.round((_[0]-x)/360);var x;const T=new bs,B=(N,V)=>{T.segments.push({vertexOffset:0,primitiveOffset:N,vertexLength:f.segments[0].vertexLength,primitiveLength:V,sortKey:void 0,vaos:{}})},U=.51*this.maxLongitudeTriangleSize;if(Math.abs(_[0]-A)<=U){const N=xe(_,0,_.length,A+U);return N===_.length||B(N,Tt(_,N+1,_.length,A+360-U)-N),T}A<_[0]&&(A+=360);const j=Tt(_,0,_.length,A-U);if(j===_.length)return B(0,_.length),T;B(0,j-0);const R=xe(_,j+1,_.length,A+U);return R!==_.length&&B(R,_.length-R),T}}const nfe=(Math.pow(256,2)-1)/16907520;class NG extends Hs{constructor(c,f,_,A){super(c,{layout:BG||(BG=new ji({visibility:new gn(At.layout_raster.visibility)})),paint:kG||(kG=new ji({"raster-opacity":new gn(At.paint_raster["raster-opacity"]),"raster-color":new ac(At.paint_raster["raster-color"]),"raster-color-mix":new gn(At.paint_raster["raster-color-mix"]),"raster-color-range":new gn(At.paint_raster["raster-color-range"]),"raster-hue-rotate":new gn(At.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(At.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(At.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(At.paint_raster["raster-saturation"]),"raster-contrast":new gn(At.paint_raster["raster-contrast"]),"raster-resampling":new gn(At.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(At.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new gn(At.paint_raster["raster-emissive-strength"]),"raster-array-band":new gn(At.paint_raster["raster-array-band"]),"raster-elevation":new gn(At.paint_raster["raster-elevation"])}))},f,_,A),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(c){return!(c&&c._source instanceof FG&&(c._source.onNorthPole||c._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(c){c!=="raster-color"&&c!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(c){if(!this.hasColorMap()||!this._curRampRange)return;const f=this._transitionablePaint._values["raster-color"].value.expression,[_,A]=c||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(_)&&isNaN(A)||_===this._curRampRange[0]&&A===this._curRampRange[1]||(this.colorRamp=Nw({expression:f,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:_,end:A}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[_,A])}}let zG,UG,GG,VG,HG;class jG extends Hs{constructor(c,f,_,A){super(c,{layout:zG||(zG=new ji({visibility:new gn(At["layout_raster-particle"].visibility)})),paint:UG||(UG=new ji({"raster-particle-array-band":new gn(At["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new gn(At["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ac(At["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new gn(At["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new gn(At["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new gn(At["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new gn(At["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new gn(At["paint_raster-particle"]["raster-particle-elevation"])}))},f,_,A),this._updateColorRamp(),this.lastInvalidatedAt=Cn.now()}onRemove(c){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(c){return!1}_handleSpecialPaintPropertyUpdate(c){c!=="raster-particle-color"&&c!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),c==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const c=this._transitionablePaint._values["raster-particle-color"].value.expression,f=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Nw({expression:c,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:f}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Cn.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class rfe extends Hs{constructor(c,f){super(c,{},f,null),this.implementation=c,c.slot&&(this.slot=c.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(c){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)}onRemove(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)}}function h4(g,c,f){const _=[0,0,1],A=Pe.quat.identity([]);return Pe.quat.rotateY(A,A,f?-sn(g)+Math.PI:sn(g)),Pe.quat.rotateX(A,A,-sn(c)),Pe.vec3.transformQuat(_,_,A),Pe.vec3.normalize(_,_)}function WG(g,c){const f=eC(g.projection,g.zoom,g.width,g.height),_=function(x,T,B,U,j){const R=new ue(B.lng-180*n0,B.lat),N=new ue(B.lng+180*n0,B.lat),V=x.project(R.lng,R.lat),z=x.project(N.lng,N.lat),G=-Math.atan2(z.y-V.y,z.x-V.x),X=xt.fromLngLat(B);X.y=jt(X.y,-1+n0,1-n0);const K=X.toLngLat(),te=x.project(K.lng,K.lat),ce=xt.fromLngLat(K);ce.x+=n0;const he=ce.toLngLat(),ne=x.project(he.lng,he.lat),de=$G(ne.x-te.x,ne.y-te.y,G),ge=xt.fromLngLat(K);ge.y+=n0;const Me=ge.toLngLat(),Be=x.project(Me.lng,Me.lat),Oe=$G(Be.x-te.x,Be.y-te.y,G),Re=Math.abs(de.x)/Math.abs(Oe.y),Ye=Pe.mat4.identity([]);Pe.mat4.rotateZ(Ye,Ye,-G*(1-(j?0:U)));const ze=Pe.mat4.identity([]);return Pe.mat4.scale(ze,ze,[1,1-(1-Re)*U,1]),ze[4]=-Oe.x/Oe.y*U,Pe.mat4.rotateZ(ze,ze,G),Pe.mat4.multiply(ze,Ye,ze),ze}(g.projection,0,g.center,f,c),A=XG(g);return Pe.mat4.scale(_,_,[A,A,1]),_}function XG(g){const c=g.projection,f=eC(g.projection,g.zoom,g.width,g.height),_=f4(c,g.center),A=f4(c,ue.convert(c.center));return Math.pow(2,_*f+(1-f)*A)}function eC(g,c,f,_,A=1/0){const x=g.range;if(!x)return 0;const T=Math.min(A,Math.max(f,_)),B=Math.log(T/1024)/Math.LN2;return mr(x[0]+B,x[1]+B,c)}const n0=1/4e4;function f4(g,c){const f=jt(c.lat,-Ke,Ke),_=new ue(c.lng-180*n0,f),A=new ue(c.lng+180*n0,f),x=g.project(_.lng,f),T=g.project(A.lng,f),B=xt.fromLngLat(_),U=xt.fromLngLat(A),j=T.x-x.x,R=T.y-x.y,N=U.x-B.x,V=U.y-B.y,z=Math.sqrt((N*N+V*V)/(j*j+R*R));return Math.log(z)/Math.LN2}function $G(g,c,f){const _=Math.cos(f),A=Math.sin(f);return{x:g*_-c*A,y:g*A+c*_}}function qG(g,c,f){Pe.mat4.identity(g),Pe.mat4.rotateZ(g,g,sn(c[2])),Pe.mat4.rotateX(g,g,sn(c[0])),Pe.mat4.rotateY(g,g,sn(c[1])),Pe.mat4.scale(g,g,f),Pe.mat4.multiply(g,g,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function tC(g,c,f,_,A,x,T,B){const U=[f[0]-c[0],f[1]-c[1],0],j=[_[0]-c[0],_[1]-c[1],0];if(Pe.vec3.length(U)<1e-12||Pe.vec3.length(j)<1e-12)return Pe.quat.identity(g);const R=Pe.vec3.cross([],U,j);Pe.vec3.normalize(R,R),Pe.vec3.subtract(j,_,c),U[2]=(x-A)*B,j[2]=(T-A)*B;const N=U;return Pe.vec3.cross(N,U,j),Pe.vec3.normalize(N,N),Pe.quat.rotationTo(g,R,N)}function d4(g,c,f=!1){const _=Yg(c.zoom),A=function(x,T,B){const U=T.worldSize,j=[x[12],x[13],x[14]],R=He(j[1]/U),N=We(j[0]/U),V=Pe.mat4.identity([]),z=De(1,R)*U,G=De(1,0)*U*ut(R,T.zoom),X=1/C3(U);let K=G*X;if(B){const ne=eC(T.projection,T.zoom,T.width,T.height,1024);K=X*T.projection.pixelSpaceConversion(T.center.lat,U,ne)}const te=Q(R,N);Pe.vec3.add(te,te,Pe.vec3.scale([],Pe.vec3.normalize([],te),z*K*j[2]));const ce=function(ne){const de=[ne[0],ne[1],ne[2]];let ge=[0,1,0];const Me=Pe.vec3.cross([],ge,de);return Pe.vec3.cross(ge,de,Me),Pe.vec3.squaredLength(ge)===0&&(ge=[0,1,0],Pe.vec3.cross(Me,de,ge)),Pe.vec3.normalize(Me,Me),Pe.vec3.normalize(ge,ge),Pe.vec3.normalize(de,de),[Me[0],Me[1],Me[2],0,ge[0],ge[1],ge[2],0,de[0],de[1],de[2],0,ne[0],ne[1],ne[2],1]}(te);Pe.mat4.scale(V,V,[K,K,K*z]),Pe.mat4.translate(V,V,[-j[0],-j[1],-j[2]]);const he=Pe.mat4.multiply([],T.globeMatrix,ce);return Pe.mat4.multiply(he,he,V),Pe.mat4.multiply(he,he,x),he}(g,c,f);if(_>0){const x=function(T,B){const U=B.worldSize,j=De(1,0)*U*ut(B.center.lat,B.zoom)/C3(U),R=De(1,B.center.lat)*U,N=Pe.mat4.identity([]);return Pe.mat4.rotateY(N,N,sn(B.center.lng)),Pe.mat4.rotateX(N,N,sn(B.center.lat)),Pe.mat4.translate(N,N,[0,0,u]),Pe.mat4.scale(N,N,[j,j,j*R]),Pe.mat4.translate(N,N,[B.point.x-.5*U,B.point.y-.5*U,0]),Pe.mat4.multiply(N,N,T),Pe.mat4.multiply(N,B.globeMatrix,N)}(g,c);return function(T,B,U){const j=(G,X,K)=>{const te=Pe.vec3.length(G),ce=Pe.vec3.length(X),he=om(G,X,K);return Pe.vec3.scale(he,he,1/Pe.vec3.length(he)*cr(te,ce,K))},R=j([T[0],T[1],T[2]],[B[0],B[1],B[2]],U),N=j([T[4],T[5],T[6]],[B[4],B[5],B[6]],U),V=j([T[8],T[9],T[10]],[B[8],B[9],B[10]],U),z=om([T[12],T[13],T[14]],[B[12],B[13],B[14]],U);return[R[0],R[1],R[2],0,N[0],N[1],N[2],0,V[0],V[1],V[2],0,z[0],z[1],z[2],1]}(A,x,_)}return A}function ZG(g,c,f,_){const A=Ki.projectAabbCorners(_,f);let x=Number.MAX_VALUE,T=-1;for(let j=0;j<A.length;++j){const R=A[j];R[0]=(.5*R[0]+.5)*c.width,R[1]=(.5-.5*R[1])*c.height,R[2]<x&&(T=j,x=R[2])}const B=j=>new St(A[j][0],A[j][1]);let U;switch(T){case 0:case 6:U=[B(1),B(5),B(4),B(7),B(3),B(2),B(1)];break;case 1:case 7:U=[B(0),B(4),B(5),B(6),B(2),B(3),B(0)];break;case 3:case 5:U=[B(1),B(0),B(4),B(7),B(6),B(2),B(1)];break;default:U=[B(1),B(5),B(6),B(7),B(3),B(0),B(1)]}if(xn(g,U))return x}const ife=Qr([{name:"a_pos_3f",components:3,type:"Float32"}]),sfe=Qr([{name:"a_color_3f",components:3,type:"Float32"}]),ofe=Qr([{name:"a_color_4f",components:4,type:"Float32"}]),afe=Qr([{name:"a_uv_2f",components:2,type:"Float32"}]),lfe=Qr([{name:"a_normal_3f",components:3,type:"Float32"}]),cfe=Qr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),ufe=Qr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),YG={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class nC{constructor(c,f,_,A){this.message=(c?`${c}: `:"")+_,A&&(this.identifier=A),f!=null&&f.__line__&&(this.line=f.__line__)}}function KG(g,c){const f=g.indexOf("://")===-1;try{return new URL(g,f&&c?"http://example.com":void 0),!0}catch{return!1}}class JG{constructor(c,f){this.feature=c,this.instancedDataOffset=f,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class QG{constructor(){this.instancedDataArray=new Bd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class p4{constructor(c){this.zoom=c.zoom,this.canonical=c.canonical,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.fqid),this.projection=c.projection,this.index=c.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(c,f){}populate(c,f,_,A){this.tileToMeter=rt(_);const x=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:T,id:B,index:U,sourceLayerIndex:j}of c){const R=B??(T.properties&&T.properties.hasOwnProperty("id")?T.properties.id:void 0),N=pn(T,x);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),N,_))continue;const V={id:R,sourceLayerIndex:j,index:U,geometry:x?N.geometry:fn(T,_,A),properties:T.properties,type:T.type,patterns:{}},z=this.addFeature(V,V.geometry,N);z&&f.featureIndex.insert(T,V.geometry,U,j,this.index,this.instancesPerModel[z].instancedDataArray.length,yn/32)}this.lookup=null}update(c,f,_,A){for(const x in this.instancesPerModel){const T=this.instancesPerModel[x];for(const B in c)T.idToFeaturesIndex.hasOwnProperty(B)&&(this.evaluate(T.features[T.idToFeaturesIndex[B]],c[B],T,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let c=!1;for(const f in this.instancesPerModel){const _=this.instancesPerModel[f];for(const A of _.features){const x=this.layers[0],T=A.feature,B=this.canonical,U=x.paint.get("model-rotation").evaluate(T,{},B),j=x.paint.get("model-scale").evaluate(T,{},B),R=x.paint.get("model-translation").evaluate(T,{},B);Pe.vec3.exactEquals(A.rotation,U)&&Pe.vec3.exactEquals(A.scale,j)&&Pe.vec3.exactEquals(A.translation,R)||(this.evaluate(A,A.featureStates,_,!0),c=!0)}}return c}updateReplacement(c,f,_,A){if(f.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=f.updateTime;const x=f.getReplacementRegionsForTile(c.toUnwrapped(),!0);if(U3(this.activeReplacements,x))return!1;this.activeReplacements=x;let T=!1;for(const B in this.instancesPerModel){const U=this.instancesPerModel[B],j=U.instancedDataArray;for(const R of U.features){const N=R.instancedDataOffset,V=R.instancedDataCount;for(let z=0;z<V;z++){const G=16*(z+N);let X=j.float32[G+0];const K=X>yn;X=K?X-yn:X;const te=Math.floor(X),ce=j.float32[G+1];let he=!1;for(const ne of this.activeReplacements)if(!p7(ne,_,YG.Model,A)&&!(ne.min.x>te||te>ne.max.x||ne.min.y>ce||ce>ne.max.y)&&(he=x7(y7(te,ce,c.canonical,ne.footprintTileId.canonical),ne.footprint),he))break;j.float32[G]=he?X+yn:X,T=T||he!==K}}}return T}isEmpty(){for(const c in this.instancesPerModel)if(this.instancesPerModel[c].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(c){if(!this.uploaded)for(const f in this.instancesPerModel){const _=this.instancesPerModel[f];_.instancedDataArray.length<0||_.instancedDataArray.length===0||(_.instancedDataBuffer?_.instancedDataBuffer.updateData(_.instancedDataArray):_.instancedDataBuffer=c.createVertexBuffer(_.instancedDataArray,cfe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const f in this.instancesPerModel){const _=this.instancesPerModel[f];_.instancedDataArray.length!==0&&_.instancedDataBuffer&&_.instancedDataBuffer.destroy()}const c=this.layers[0].modelManager;if(c&&this.modelUris)for(const f of this.modelUris)c.removeModel(f,"")}addFeature(c,f,_){const A=this.layers[0],x=A.layout.get("model-id").evaluate(_,{},this.canonical);if(!x)return Lt(`modelId is not evaluated for layer ${A.id} and it is not going to get rendered.`),x;KG(x,!1)&&(this.modelUris.includes(x)||this.modelUris.push(x)),this.instancesPerModel[x]||(this.instancesPerModel[x]=new QG);const T=this.instancesPerModel[x],B=T.instancedDataArray,U=new JG(_,B.length);for(const j of f)for(const R of j){if(R.x<0||R.x>=yn||R.y<0||R.y>=yn)continue;const N=(this.lookupDim-1)/yn,V=this.lookupDim*(R.y*N|0)+R.x*N|0;if(this.lookup){if(this.lookup[V]!==0)continue;this.lookup[V]=1}this.instanceCount++;const z=B.length;B.resize(z+1),T.instancesEvaluatedElevation.push(0),B.float32[16*z]=R.x,B.float32[16*z+1]=R.y}return U.instancedDataCount=T.instancedDataArray.length-U.instancedDataOffset,U.instancedDataCount>0&&(c.id&&(T.idToFeaturesIndex[c.id]=T.features.length),T.features.push(U),this.evaluate(U,{},T,!1)),x}getModelUris(){return this.modelUris}evaluate(c,f,_,A){const x=this.layers[0],T=c.feature,B=this.canonical,U=c.rotation=x.paint.get("model-rotation").evaluate(T,f,B),j=c.scale=x.paint.get("model-scale").evaluate(T,f,B),R=c.translation=x.paint.get("model-translation").evaluate(T,f,B),N=x.paint.get("model-color").evaluate(T,f,B);N.a=x.paint.get("model-color-mix-intensity").evaluate(T,f,B);const V=[];this.maxVerticalOffset<R[2]&&(this.maxVerticalOffset=R[2]),this.maxScale=Math.max(Math.max(this.maxScale,j[0]),Math.max(j[1],j[2])),qG(V,U,j);const z=Math.round(100*N.a)+N.b/1.05;for(let G=0;G<c.instancedDataCount;++G){const X=c.instancedDataOffset+G,K=16*X,te=_.instancedDataArray.float32;let ce=0;A&&(ce=te[K+6]-_.instancesEvaluatedElevation[X]);const he=0|te[K+1];te[K]=(0|te[K])+N.r/1.05,te[K+1]=he+N.g/1.05,te[K+2]=z,te[K+3]=1/(B.z>10?this.tileToMeter:rt(B,he)),te[K+4]=R[0],te[K+5]=R[1],te[K+6]=R[2]+ce,te[K+7]=V[0],te[K+8]=V[1],te[K+9]=V[2],te[K+10]=V[4],te[K+11]=V[5],te[K+12]=V[6],te[K+13]=V[8],te[K+14]=V[9],te[K+15]=V[10],_.instancesEvaluatedElevation[X]=R[2]}}}let eV,tV;Fn(p4,"ModelBucket",{omit:["layers"]}),Fn(QG,"PerModelAttributes"),Fn(JG,"ModelFeature");const f_=64,Z1={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function nV(g,c,f,_,A,x,T,B,U,j=!1){const R=f.zoom,N=f.project(_),V=ut(_.lat,R),z=1/V;Pe.mat4.identity(g),Pe.mat4.translate(g,g,[N.x+T[0]*z,N.y+T[1]*z,T[2]]);let G=1,X=1;const K=f.worldSize;if(j){if(f.projection.name==="mercator"){let ne=0;f.elevation&&(ne=f.elevation.getAtPointOrZero(new xt(N.x/K,N.y/K),0));const de=Pe.vec4.transformMat4([],[N.x,N.y,ne,1],f.projMatrix)[3]/f.cameraToCenterDistance;G=de,X=de*ut(f.center.lat,R)}else if(f.projection.name==="globe"){const ne=d4(g,f),de=Pe.mat4.multiply([],f.projMatrix,ne),ge=[0,0,0,1];Pe.vec4.transformMat4(ge,ge,de);const Me=ge[3]/f.cameraToCenterDistance,Be=Yg(R),Oe=f.projection.pixelsPerMeter(_.lat,K)*ut(_.lat,R),Re=f.projection.pixelsPerMeter(f.center.lat,K)*ut(f.center.lat,R);G=Me/cr(Oe,tt(f.center.lat),Be),X=Me*V/Oe,G*=Re,X*=Re}}else G=z;Pe.mat4.scale(g,g,[G,G,X]);const te=[...g],ce=c.orientation,he=[];if(qG(he,[ce[0]+A[0],ce[1]+A[1],ce[2]+A[2]],x),Pe.mat4.multiply(g,te,he),B&&f.elevation){let ne=0;const de=[];if(U&&f.elevation){ne=function(Be,Oe,Re,Ye,ze){const Qe=Oe.elevation;if(!Qe)return 0;const ct=Ki.projectAabbCorners(Re,Ye),ht=De(1,ze.lat)*Oe.worldSize,ft=function(nr,In){const Nn=[0,0,1],wr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Or of wr){const Pr=nr[Or.corners[0]],Lr=nr[Or.corners[1]],jr=nr[Or.corners[2]],Wr=[Lr[0]-Pr[0],Lr[1]-Pr[1],In*(Lr[2]-Pr[2])],Ui=Pe.vec3.cross(Wr,Wr,[jr[0]-Pr[0],jr[1]-Pr[1],In*(jr[2]-Pr[2])]);Pe.vec3.normalize(Ui,Ui),Or.dotProductWithUp=Pe.vec3.dot(Ui,Nn)}return wr.sort((Or,Pr)=>Or.dotProductWithUp-Pr.dotProductWithUp),wr[0].corners}(ct,ht),mt=ct[ft[0]],Et=ct[ft[1]],vt=ct[ft[2]],Ut=ct[ft[3]],Yt=Qe.getAtPointOrZero(new xt(mt[0]/Oe.worldSize,mt[1]/Oe.worldSize),0),Dt=Qe.getAtPointOrZero(new xt(Et[0]/Oe.worldSize,Et[1]/Oe.worldSize),0),Rn=Qe.getAtPointOrZero(new xt(vt[0]/Oe.worldSize,vt[1]/Oe.worldSize),0),bn=Qe.getAtPointOrZero(new xt(Ut[0]/Oe.worldSize,Ut[1]/Oe.worldSize),0),dn=(Yt+bn)/2,tn=(Dt+Rn)/2;return dn>tn?Dt<Rn?tC(Be,Et,Ut,mt,Dt,bn,Yt,ht):tC(Be,vt,mt,Ut,Rn,Yt,bn,ht):Yt<bn?tC(Be,mt,Et,vt,Yt,Dt,Rn,ht):tC(Be,Ut,vt,Et,bn,Rn,Dt,ht),Math.max(dn,tn)}(de,f,c.aabb,g,_);const ge=Pe.mat4.fromQuat([],de),Me=Pe.mat4.multiply([],ge,he);Pe.mat4.multiply(g,te,Me)}else ne=f.elevation.getAtPointOrZero(new xt(N.x/K,N.y/K),0);ne!==0&&(g[14]+=ne)}}function i2(g,c,f=!1){g.uploaded||(g.gfxTexture=new u4(c,g.image,f?c.gl.R8:c.gl.RGBA8,{useMipmap:g.sampler.minFilter>=c.gl.NEAREST_MIPMAP_NEAREST}),g.uploaded=!0,g.image=null)}function hfe(g,c,f){g.indexBuffer=c.createIndexBuffer(g.indexArray,!1,!0),g.vertexBuffer=c.createVertexBuffer(g.vertexArray,ife.members,!1,!0),g.normalArray&&(g.normalBuffer=c.createVertexBuffer(g.normalArray,lfe.members,!1,!0)),g.texcoordArray&&(g.texcoordBuffer=c.createVertexBuffer(g.texcoordArray,afe.members,!1,!0)),g.colorArray&&(g.colorBuffer=c.createVertexBuffer(g.colorArray,(g.colorArray.bytesPerElement===12?sfe:ofe).members,!1,!0)),g.featureArray&&(g.pbrBuffer=c.createVertexBuffer(g.featureArray,ufe.members,!0)),g.segments=bs.simpleSegment(0,0,g.vertexArray.length,g.indexArray.length);const _=g.material;_.pbrMetallicRoughness.baseColorTexture&&i2(_.pbrMetallicRoughness.baseColorTexture,c),_.pbrMetallicRoughness.metallicRoughnessTexture&&i2(_.pbrMetallicRoughness.metallicRoughnessTexture,c),_.normalTexture&&i2(_.normalTexture,c),_.occlusionTexture&&i2(_.occlusionTexture,c,f),_.emissionTexture&&i2(_.emissionTexture,c)}function m4(g,c,f){if(g.meshes)for(const _ of g.meshes)hfe(_,c,f);if(g.children)for(const _ of g.children)m4(_,c,f)}function rC(g){if(g.meshes)for(const c of g.meshes)c.indexArray.destroy(),c.vertexArray.destroy(),c.colorArray&&c.colorArray.destroy(),c.normalArray&&c.normalArray.destroy(),c.texcoordArray&&c.texcoordArray.destroy(),c.featureArray&&c.featureArray.destroy();if(g.children)for(const c of g.children)rC(c)}function g4(g){if(g.meshes)for(const f of g.meshes)f.vertexBuffer&&(f.vertexBuffer.destroy(),f.indexBuffer.destroy(),f.normalBuffer&&f.normalBuffer.destroy(),f.texcoordBuffer&&f.texcoordBuffer.destroy(),f.colorBuffer&&f.colorBuffer.destroy(),f.pbrBuffer&&f.pbrBuffer.destroy(),f.segments.destroy(),f.material&&((c=f.material).pbrMetallicRoughness.baseColorTexture&&c.pbrMetallicRoughness.baseColorTexture.gfxTexture&&c.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),c.pbrMetallicRoughness.metallicRoughnessTexture&&c.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&c.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),c.normalTexture&&c.normalTexture.gfxTexture&&c.normalTexture.gfxTexture.destroy(),c.emissionTexture&&c.emissionTexture.gfxTexture&&c.emissionTexture.gfxTexture.destroy(),c.occlusionTexture&&c.occlusionTexture.gfxTexture&&c.occlusionTexture.gfxTexture.destroy()));var c;if(g.children)for(const f of g.children)g4(f)}class Y1{constructor(c,f,_){this._demTile=c,this._dem=this._demTile.dem,this._scale=f,this._offset=_}static create(c,f,_){const A=_||c.findDEMTileFor(f);if(!A||!A.dem)return;const x=A.dem,T=A.tileID,B=1<<f.canonical.z-T.canonical.z;return new Y1(A,x.dim/yn/B,[(f.canonical.x/B-T.canonical.x)*x.dim,(f.canonical.y/B-T.canonical.y)*x.dim])}tileCoordToPixel(c,f){const _=f*this._scale+this._offset[1],A=Math.floor(c*this._scale+this._offset[0]),x=Math.floor(_);return new St(A,x)}getElevationAt(c,f,_,A){const x=c*this._scale+this._offset[0],T=f*this._scale+this._offset[1],B=Math.floor(x),U=Math.floor(T),j=this._dem;return A=!!A,_?cr(cr(j.get(B,U,A),j.get(B,U+1,A),T-U),cr(j.get(B+1,U,A),j.get(B+1,U+1,A),T-U),x-B):j.get(B,U,A)}getElevationAtPixel(c,f,_){return this._dem.get(c,f,!!_)}getMeterToDEM(c){return(1<<this._demTile.tileID.canonical.z)*De(1,c)*this._dem.stride}}const v4=new Float32Array(262144),d_=new Uint8Array(262144);function rV(g){let c=0;if(g.meshes)for(const f of g.meshes)c=Math.max(c,f.aabb.max[2]);if(g.children)for(const f of g.children)c=Math.max(c,rV(f));return c}function iV(g,c,f){if(g.meshes)for(const _ of g.meshes)_.aabb.min[0]!==1/0&&f.insert(c,_.aabb.min[0],_.aabb.min[1],_.aabb.max[0],_.aabb.max[1]);if(g.children)for(const _ of g.children)iV(_,c,f)}const sV=["","wall","door","roof","window","lamp","logo"];class oV{constructor(c){this.node=c,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:c.id,geometry:[],properties:{height:rV(c)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Ki([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let c=0;const f=new Ki([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const _ of this.node.meshes)this.node.lightMeshIndex!==c&&(_.transformedAabb=Ki.applyTransformFast(_.aabb,this.node.matrix),f.encapsulate(_.transformedAabb)),c++;this.aabb=f}return this.aabb}}class iC{constructor(c,f,_,A,x,T){this.id=f,this.modelTraits|=Z1.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,_&&(this.modelTraits|=Z1.HasMapboxMeshFeatures),A&&(this.modelTraits|=Z1.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const B of c)this.nodesInfo.push(new oV(B)),iV(B,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}updateFootprints(c,f){for(const _ of this.getNodesInfo()){const A=_.node;A.footprint&&f.push({footprint:A.footprint,id:c})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(c){if(!this.needsUpload)return;const f=this.getNodesInfo();for(const _ of f){const A=_.node;this.uploaded?this.updatePbrBuffer(A):m4(A,c,!0)}for(const _ of f)rC(_.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(c){let f=!1;if(!c.meshes)return f;for(const _ of c.meshes)_.pbrBuffer&&(_.pbrBuffer.updateData(_.featureArray),f=!0);return f}needsReEvaluation(c,f,_){const A=c.transform.projectionOptions,x=c.style.getBrightness(),T=this.brightness!==x;return!!(!this.uploaded||this.dirty||A.name!==this.projection.name||s2(_.paint.get("model-color").value,T)||s2(_.paint.get("model-color-mix-intensity").value,T)||s2(_.paint.get("model-roughness").value,T)||s2(_.paint.get("model-emissive-strength").value,T)||s2(_.paint.get("model-height-based-emissive-strength-multiplier").value,T))&&(this.projection=A,this.brightness=x,!0)}evaluateScale(c,f){if(c.transform.zoom===this.zoom)return;this.zoom=c.transform.zoom;const _=this.getNodesInfo(),A=this.id.canonical;for(const x of _){const T=x.feature;x.evaluatedScale=f.paint.get("model-scale").evaluate(T,{},A)}}evaluate(c){const f=this.getNodesInfo();for(const _ of f){if(!_.node.meshes)continue;const A=_.feature,x=_.node.meshes&&_.node.meshes[0].featureData,T=_.evaluatedColor[2],B=_.evaluatedRMEA[2],U=this.id.canonical;if(_.hasTranslucentParts=!1,x){for(let j=0;j<sV.length;j++){const R=sV[j];R.length&&(A.properties.part=R);const N=c.paint.get("model-color").evaluate(A,{},U).toRenderColor(null),V=c.paint.get("model-color-mix-intensity").evaluate(A,{},U);_.evaluatedColor[j]=[N.r,N.g,N.b,V],_.evaluatedRMEA[j][0]=c.paint.get("model-roughness").evaluate(A,{},U),_.evaluatedRMEA[j][2]=c.paint.get("model-emissive-strength").evaluate(A,{},U),_.evaluatedRMEA[j][3]=N.a,_.emissionHeightBasedParams[j]=c.paint.get("model-height-based-emissive-strength-multiplier").evaluate(A,{},U),!_.hasTranslucentParts&&N.a<1&&(_.hasTranslucentParts=!0)}delete A.properties.part,dfe(_,T!==_.evaluatedColor[2]||B!==_.evaluatedRMEA[2],this.modelTraits)}else _.evaluatedRMEA[0][2]=c.paint.get("model-emissive-strength").evaluate(A,{},U);_.evaluatedScale=c.paint.get("model-scale").evaluate(A,{},U),this.updatePbrBuffer(_.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(c,f,_,A){const x=c.findDEMTileFor(_);if(x&&(x.tileID.canonical!==this.terrainTile||f!==this.terrainExaggeration)){if(x.dem&&x.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=x.tileID.overscaledZ;const T=Y1.create(c,_,x);if(!T)return;this.modelTraits&Z1.HasMapboxMeshFeatures&&this.updateDEM(c,T,_,A);for(const B of this.getNodesInfo()){const U=B.node;if(!U.footprint||!U.footprint.vertices||!U.footprint.vertices.length)continue;const j=U.footprint.vertices;let R=T.getElevationAt(j[0].x,j[0].y,!0,!0);for(let N=1;N<j.length;N++)R=Math.min(R,T.getElevationAt(j[N].x,j[N].y,!0,!0));U.elevation=R}}this.terrainTile=x.tileID.canonical,this.terrainExaggeration=f}}updateDEM(c,f,_,A){let x=f._dem._modifiedForSources[A];if(x===void 0&&(f._dem._modifiedForSources[A]=[],x=f._dem._modifiedForSources[A]),x.includes(_.canonical))return;const T=f._dem.dim;x.push(_.canonical);let B=!1;for(const U of this.getNodesInfo()){const j=U.node;if(!j.footprint||!j.footprint.grid)continue;const R=j.footprint.grid,N=f.tileCoordToPixel(R.min.x,R.min.y),V=f.tileCoordToPixel(R.max.x,R.max.y),z=Math.min(Math.min(T-V.y,N.x),Math.min(N.y,T-V.x));if(z<0)continue;const G=jt(z,2,5);let X=Math.max(0,N.x-G),K=Math.max(0,N.y-G),te=Math.min(V.x+G,T-1),ce=Math.min(V.y+G,T-1);for(let ge=K;ge<=ce;++ge)for(let Me=X;Me<=te;++Me)d_[ge*T+Me]=255;let he=0,ne=0;for(let ge=0;ge<R.cellsY;++ge)for(let Me=0;Me<R.cellsX;++Me){if(!R.cells[ge*R.cellsX+Me])continue;const Be=f.tileCoordToPixel(R.min.x+Me/R.xScale,R.min.y+ge/R.yScale),Oe=f.tileCoordToPixel(R.min.x+(Me+1)/R.xScale,R.min.y+(ge+1)/R.yScale);for(let Re=Be.y;Re<=Math.min(Oe.y+1,T-1);++Re)for(let Ye=Be.x;Ye<=Math.min(Oe.x+1,T-1);++Ye)d_[Re*T+Ye]===255&&(d_[Re*T+Ye]=0,he+=f.getElevationAtPixel(Ye,Re),ne++)}const de=he/ne;X=Math.max(1,N.x-G),K=Math.max(1,N.y-G),te=Math.min(V.x+G,T-2),ce=Math.min(V.y+G,T-2),B=!0;for(let ge=K;ge<=ce;++ge)for(let Me=X;Me<=te;++Me)d_[ge*T+Me]===0&&(v4[ge*T+Me]=f._dem.set(Me,ge,de));for(let ge=1;ge<G;++ge){X=Math.max(1,N.x-ge),K=Math.max(1,N.y-ge),te=Math.min(V.x+ge,T-2),ce=Math.min(V.y+ge,T-2);for(let Me=K;Me<=ce;++Me)for(let Be=X;Be<=te;++Be){const Oe=Me*T+Be;if(d_[Oe]===255){let Re=0,Ye=0,ze=-1,Qe=-1;for(let ct=-1;ct<=1;++ct)for(let ht=-1;ht<=1;++ht){const ft=(Me+ct)*T+Be+ht;if(d_[ft]>=ge)continue;const mt=v4[ft],Et=Math.abs(mt);Et>Ye&&(Re=mt,Ye=Et,ze=ht,Qe=ct)}if(Ye>.1){const ct=1-(ge+.5*Math.abs(ze*Qe))/G;let ht=f._dem.get(Be,Me)+Re*ct;const ft=f._dem.get(Be+ze,Me+Qe),mt=f._dem.get(Be-ze,Me-Qe,!0);(ht-ft)*(ht-mt)>0&&(ht=(ft+mt)/2),v4[Oe]=f._dem.set(Be,Me,ht),d_[Oe]=ge}}}}}B&&(f._demTile.needsDEMTextureUpload=!0,f._dem._timestamp=Cn.now())}getNodesInfo(){return this.nodesInfo}destroy(){const c=this.getNodesInfo();for(const f of c)rC(f.node),g4(f.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(c,f){if(f.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=f.updateTime;const _=f.getReplacementRegionsForTile(c.toUnwrapped()),A=this.getNodesInfo();for(let x=0;x<this.nodesInfo.length;x++){const T=A[x].node;A[x].hiddenByReplacement=!!T.footprint&&!_.find(B=>B.footprint===T.footprint)}}getHeightAtTileCoord(c,f){const _=this.getNodesInfo(),A=[],x=[0,0,0],T=Pe.mat4.identity([]);for(let B=0;B<this.nodesInfo.length;B++){const U=_[B],j=U.node.meshes[0],R=j.transformedAabb;if(c<R.min[0]||f<R.min[1]||c>R.max[0]||f>R.max[1])continue;if(U.node.hidden===!0)return{height:1/0,maxHeight:U.feature.properties.height,hidden:!1,verticalScale:U.evaluatedScale[2]};Pe.mat4.invert(T,U.node.matrix),x[0]=c,x[1]=f,Pe.vec3.transformMat4(x,x,T);const N=(x[0]-j.aabb.min[0])/(j.aabb.max[0]-j.aabb.min[0])*f_|0,V=Math.min(63,(x[1]-j.aabb.min[1])/(j.aabb.max[1]-j.aabb.min[1])*f_|0)*f_+Math.min(63,N),z=j.heightmap[V];if(!(z<0&&U.node.footprint))return U.hiddenByReplacement?void 0:{height:z,maxHeight:U.feature.properties.height,hidden:!1,verticalScale:U.evaluatedScale[2]};if(U.node.footprint.grid.query(new St(c,f),new St(c,f),A),A.length>0)return{height:void 0,maxHeight:U.feature.properties.height,hidden:U.hiddenByReplacement,verticalScale:U.evaluatedScale[2]}}}}function s2(g,c){return!g.isLightConstant&&c}function ffe(g,c,f,_,A,x,T,B){let U=(61440&c|(61440&c)>>4)>>8,j=(3840&c|(3840&c)>>4)>>4,R=240&c|(240&c)>>4;f[3]>0&&(U=cr(U,255*f[0],f[3]),j=cr(j,255*f[1],f[3]),R=cr(R,255*f[2],f[3]));const N=U<<8|j,V=R<<8|Math.floor(255*_[3]),z=function(ge){const Me=jt(ge,0,2);return Math.min(Math.round(.5*Me*255),255)}(_[2])<<8|15*_[0]<<4|15*_[1],G=jt(A[0],0,1),X=jt(A[1],0,1),K=jt(A[2],0,1),te=jt(A[3],0,1);let ce,he,ne,de;if(G!==X&&T!==x&&X!==G){const ge=T-x;he=1/(ge*(X-G)),ne=-(x+ge*G)/(ge*(X-G));const Me=jt(A[4],-1,1);de=Math.pow(10,Me),ce=255*K<<8|255*te}else ce=65535,he=0,ne=1,de=1;if(g.emplaceBack(N,V,z,ce,he,ne,de),B){const ge=B.length;B.clear();for(let Me=0;Me<ge;Me++)B.emplaceBack(N,V,z,ce,he,ne,de)}}function dfe(g,c,f){const _=g.node;let A=0;const x=f&Z1.HasMeshoptCompression;for(const T of _.meshes){if(_.lights&&_.lightMeshIndex===A||!T.featureData)continue;T.featureArray=new ca,T.featureArray.reserve(T.featureData.length);let B=c;for(const U of T.featureData){const j=x?65535&U:U>>16&65535,R=x?U>>16&65535:65535&U,N=(15&R)<8?15&R:0,V=g.evaluatedRMEA[N],z=g.evaluatedColor[N],G=g.emissionHeightBasedParams[N];let X;if(B&&N===2&&_.lights&&(X=new ca,X.resize(10*_.lights.length)),ffe(T.featureArray,j,z,V,G,T.aabb.min[2],T.aabb.max[2],X),X&&B){B=!1;const K=_.meshes[_.lightMeshIndex];K.featureArray=X,K.featureArray._trim()}}T.featureArray._trim(),A++}}function aV(g,c,f,_){const A=1<<g.z;c.lat=He((_/yn+g.y)/A),c.lng=We((f/yn+g.x)/A)}Fn(iC,"Tiled3dModelBucket",{omit:["layers"]}),Fn(oV,"Tiled3dModelFeature");const pfe={circle:class extends Hs{constructor(g,c,f,_){super(g,{layout:Ai||(Ai=new ji({"circle-sort-key":new Kn(At.layout_circle["circle-sort-key"]),visibility:new gn(At.layout_circle.visibility)})),paint:Ns||(Ns=new ji({"circle-radius":new Kn(At.paint_circle["circle-radius"]),"circle-color":new Kn(At.paint_circle["circle-color"]),"circle-blur":new Kn(At.paint_circle["circle-blur"]),"circle-opacity":new Kn(At.paint_circle["circle-opacity"]),"circle-translate":new gn(At.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(At.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(At.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(At.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kn(At.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kn(At.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kn(At.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new gn(At.paint_circle["circle-emissive-strength"])}))},c,f,_)}createBucket(g){return new er(g)}queryRadius(g){const c=g;return ws("circle-radius",this,c)+ws("circle-stroke-width",this,c)+Li(this.paint.get("circle-translate"))}queryIntersectsFeature(g,c,f,_,A,x,T,B){const U=pi(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),j=this.paint.get("circle-radius").evaluate(c,f)+this.paint.get("circle-stroke-width").evaluate(c,f);return z9(g,_,x,T,B,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",U,j)}getProgramIds(){return["circle"]}getDefaultProgramParams(g,c,f){const _=N9(this);return{config:new on(this,{zoom:c,lut:f}),defines:_,overrideFog:!1}}},heatmap:class extends Hs{createBucket(g){return new G9(g)}constructor(g,c,f,_){super(g,{layout:V9||(V9=new ji({visibility:new gn(At.layout_heatmap.visibility)})),paint:H9||(H9=new ji({"heatmap-radius":new Kn(At.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kn(At.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(At.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ac(At.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(At.paint_heatmap["heatmap-opacity"])}))},c,f,_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Nw({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(g){return ws("heatmap-radius",this,g)}queryIntersectsFeature(g,c,f,_,A,x,T,B){const U=this.paint.get("heatmap-radius").evaluate(c,f);return z9(g,_,x,T,B,!0,!0,new St(0,0),U)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(g,c,f){return g==="heatmap"?{config:new on(this,{zoom:c,lut:f}),overrideFog:!1}:{}}},hillshade:class extends Hs{constructor(g,c,f,_){super(g,{layout:j9||(j9=new ji({visibility:new gn(At.layout_hillshade.visibility)})),paint:W9||(W9=new ji({"hillshade-illumination-direction":new gn(At.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(At.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(At.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(At.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(At.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(At.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new gn(At.paint_hillshade["hillshade-emissive-strength"])}))},c,f,_)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(g,c,f){return{overrideFog:!1}}},fill:class extends Hs{constructor(g,c,f,_){super(g,{layout:Q9||(Q9=new ji({"fill-sort-key":new Kn(At.layout_fill["fill-sort-key"]),visibility:new gn(At.layout_fill.visibility)})),paint:e7||(e7=new ji({"fill-antialias":new gn(At.paint_fill["fill-antialias"]),"fill-opacity":new Kn(At.paint_fill["fill-opacity"]),"fill-color":new Kn(At.paint_fill["fill-color"]),"fill-outline-color":new Kn(At.paint_fill["fill-outline-color"]),"fill-translate":new gn(At.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(At.paint_fill["fill-translate-anchor"]),"fill-pattern":new Kn(At.paint_fill["fill-pattern"]),"fill-emissive-strength":new gn(At.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Kn(At.paint_fill["fill-z-offset"])}))},c,f,_)}getProgramIds(){const g=this.paint.get("fill-pattern"),c=g&&g.constantOr(1),f=[c?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&f.push(c&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),f}getDefaultProgramParams(g,c,f){return{config:new on(this,{zoom:c,lut:f}),overrideFog:!1}}recalculate(g,c){super.recalculate(g,c);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(g){return new B3(g)}queryRadius(){return Li(this.paint.get("fill-translate"))}queryIntersectsFeature(g,c,f,_,A,x){return!g.queryGeometry.isAboveHorizon&&yr(kr(g.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),_)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Hs{constructor(g,c,f,_){super(g,{layout:k7||(k7=new ji({visibility:new gn(At["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new gn(At["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:O7||(O7=new ji({"fill-extrusion-opacity":new gn(At["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kn(At["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(At["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(At["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Kn(At["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kn(At["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kn(At["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(At["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Kn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Kn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new gn(At["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new gn(At["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new gn(At["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Kn(At["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Kn(At["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new gn(At["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},c,f,_),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(g){return new kM(g)}queryRadius(){return Li(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(g,c,f,_,A,x,T,B,U){const j=pi(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(c,f),N=this.paint.get("fill-extrusion-base").evaluate(c,f),V=[0,0],z=B&&x.elevation,G=x.elevation?x.elevation.exaggeration():1,X=g.tile.getBucket(this);if(z&&X instanceof kM){const ne=X.centroidVertexArray,de=U+1;de<ne.length&&(V[0]=ne.geta_centroid_pos0(de),V[1]=ne.geta_centroid_pos1(de))}if(V[0]===0&&V[1]===1)return!1;x.projection.name==="globe"&&(_=B7([_],[new St(0,0),new St(yn,yn)],g.tileID.canonical).map(ne=>ne.polygon).flat());const K=z?B:null,[te,ce]=function(ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct){return ne.projection.name==="globe"?function(ht,ft,mt,Et,vt,Ut,Yt,Dt,Rn,bn,dn){const tn=[],nr=[],In=ht.projection.upVectorScale(dn,ht.center.lat,ht.worldSize).metersToTile,Nn=[0,0,0,1],wr=[0,0,0,1],Or=(Lr,jr,Wr,Ui)=>{Lr[0]=jr,Lr[1]=Wr,Lr[2]=Ui,Lr[3]=1},Pr=D7();mt>0&&(mt+=Pr),Et+=Pr;for(const Lr of ft){const jr=[],Wr=[];for(const Ui of Lr){const Ti=Ui.x+vt.x,Tr=Ui.y+vt.y,vi=ht.projection.projectTilePoint(Ti,Tr,dn),bi=ht.projection.upVector(dn,Ui.x,Ui.y);let ss=mt,js=Et;if(Yt){const po=N7(Ti,Tr,mt,Et,Yt,Dt,Rn,bn);ss+=po.base,js+=po.top}mt!==0?Or(Nn,vi.x+bi[0]*In*ss,vi.y+bi[1]*In*ss,vi.z+bi[2]*In*ss):Or(Nn,vi.x,vi.y,vi.z),Or(wr,vi.x+bi[0]*In*js,vi.y+bi[1]*In*js,vi.z+bi[2]*In*js),Pe.vec3.transformMat4(Nn,Nn,Ut),Pe.vec3.transformMat4(wr,wr,Ut),jr.push(new h_(Nn[0],Nn[1],Nn[2])),Wr.push(new h_(wr[0],wr[1],wr[2]))}tn.push(jr),nr.push(Wr)}return[tn,nr]}(ne,de,ge,Me,Be,Oe,Re,Ye,ze,Qe,ct):Re?function(ht,ft,mt,Et,vt,Ut,Yt,Dt,Rn){const bn=[],dn=[],tn=[0,0,0,1];for(const nr of ht){const In=[],Nn=[];for(const wr of nr){const Or=wr.x+Et.x,Pr=wr.y+Et.y,Lr=N7(Or,Pr,ft,mt,Ut,Yt,Dt,Rn);tn[0]=Or,tn[1]=Pr,tn[2]=Lr.base,tn[3]=1,Pe.vec4.transformMat4(tn,tn,vt),tn[3]=Math.max(tn[3],1e-5);const jr=new h_(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);tn[0]=Or,tn[1]=Pr,tn[2]=Lr.top,tn[3]=1,Pe.vec4.transformMat4(tn,tn,vt),tn[3]=Math.max(tn[3],1e-5);const Wr=new h_(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);In.push(jr),Nn.push(Wr)}bn.push(In),dn.push(Nn)}return[bn,dn]}(de,ge,Me,Be,Oe,Re,Ye,ze,Qe):function(ht,ft,mt,Et,vt){const Ut=[],Yt=[],Dt=vt[8]*ft,Rn=vt[9]*ft,bn=vt[10]*ft,dn=vt[11]*ft,tn=vt[8]*mt,nr=vt[9]*mt,In=vt[10]*mt,Nn=vt[11]*mt;for(const wr of ht){const Or=[],Pr=[];for(const Lr of wr){const jr=Lr.x+Et.x,Wr=Lr.y+Et.y,Ui=vt[0]*jr+vt[4]*Wr+vt[12],Ti=vt[1]*jr+vt[5]*Wr+vt[13],Tr=vt[2]*jr+vt[6]*Wr+vt[14],vi=vt[3]*jr+vt[7]*Wr+vt[15],bi=Ui+Dt,ss=Ti+Rn,js=Tr+bn,po=Math.max(vi+dn,1e-5),Ws=Ui+tn,ks=Ti+nr,ua=Tr+In,So=Math.max(vi+Nn,1e-5);Or.push(new h_(bi/po,ss/po,js/po)),Pr.push(new h_(Ws/So,ks/So,ua/So))}Ut.push(Or),Yt.push(Pr)}return[Ut,Yt]}(de,ge,Me,Be,Oe)}(x,_,N,R,j,T,K,V,G,x.center.lat,g.tileID.canonical),he=g.queryGeometry;return function(ne,de,ge){let Me=1/0;yr(ge,de)&&(Me=F7(ge,de[0]));for(let Be=0;Be<de.length;Be++){const Oe=de[Be],Re=ne[Be];for(let Ye=0;Ye<Oe.length-1;Ye++){const ze=Oe[Ye],Qe=[ze,Oe[Ye+1],Re[Ye+1],Re[Ye],ze];xn(ge,Qe)&&(Me=Math.min(Me,F7(ge,Qe)))}}return Me!==1/0&&Me}(te,ce,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends Hs{constructor(g,c,f,_){const A=q7();super(g,A,c,f,_),A.layout&&(this.layout=new Qu(A.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(g){if(g==="line-gradient"){const c=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=c._styleExpression&&c._styleExpression.expression instanceof _d,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(g,c){super.recalculate(g,c),this.paint._values["line-floorwidth"]=(()=>{if($w)return $w;const f=q7();return $w=new vhe(f.paint.properties["line-width"].specification),$w.useIntegerZoom=!0,$w})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)}createBucket(g){return new j3(g)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(g,c,f){const _=X7(this);return{config:new on(this,{zoom:c,lut:f}),defines:_,overrideFog:!1}}queryRadius(g){const c=g,f=Z7(ws("line-width",this,c),ws("line-gap-width",this,c)),_=ws("line-offset",this,c);return f/2+Math.abs(_)+Li(this.paint.get("line-translate"))}queryIntersectsFeature(g,c,f,_,A,x){if(g.queryGeometry.isAboveHorizon)return!1;const T=kr(g.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),B=g.pixelToTileUnitsFactor/2*Z7(this.paint.get("line-width").evaluate(c,f),this.paint.get("line-gap-width").evaluate(c,f)),U=this.paint.get("line-offset").evaluate(c,f);return U&&(_=function(j,R){const N=[],V=new St(0,0);for(let z=0;z<j.length;z++){const G=j[z],X=[];for(let K=0;K<G.length;K++){const te=G[K],ce=G[K+1],he=K===0?V:te.sub(G[K-1])._unit()._perp(),ne=K===G.length-1?V:ce.sub(te)._unit()._perp(),de=he._add(ne)._unit();de._mult(1/(de.x*ne.x+de.y*ne.y)),X.push(de._mult(R)._add(te))}N.push(X)}return N}(_,U*g.pixelToTileUnitsFactor)),function(j,R,N){for(let V=0;V<R.length;V++){const z=R[V];if(j.length>=3){for(let G=0;G<z.length;G++)if(is(j,z[G]))return!0}if(qn(j,z,N))return!0}return!1}(T,_,B)}isTileClipped(){return!0}isDraped(g){const c=this.layout.get("line-z-offset");return c.isConstant()&&!c.constantOr(0)}},symbol:YM,background:class extends Hs{constructor(g,c,f,_){super(g,{layout:LG||(LG=new ji({visibility:new gn(At.layout_background.visibility)})),paint:DG||(DG=new ji({"background-pitch-alignment":new gn(At.paint_background["background-pitch-alignment"]),"background-color":new gn(At.paint_background["background-color"]),"background-pattern":new gn(At.paint_background["background-pattern"]),"background-opacity":new gn(At.paint_background["background-opacity"]),"background-emissive-strength":new gn(At.paint_background["background-emissive-strength"])}))},c,f,_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(g,c,f){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:NG,"raster-particle":jG,sky:class extends Hs{constructor(g,c,f,_){super(g,{layout:GG||(GG=new ji({visibility:new gn(At.layout_sky.visibility)})),paint:VG||(VG=new ji({"sky-type":new gn(At.paint_sky["sky-type"]),"sky-atmosphere-sun":new gn(At.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new gn(At.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new gn(At.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new gn(At.paint_sky["sky-gradient-radius"]),"sky-gradient":new ac(At.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new gn(At.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new gn(At.paint_sky["sky-atmosphere-color"]),"sky-opacity":new gn(At.paint_sky["sky-opacity"])}))},c,f,_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="sky-gradient"?this._updateColorRamp():g!=="sky-atmosphere-sun"&&g!=="sky-atmosphere-halo-color"&&g!=="sky-atmosphere-color"&&g!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Nw({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(g){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const c=g.style.light.properties.get("position");return this._lightPosition.azimuthal!==c.azimuthal||this._lightPosition.polar!==c.polar}return!1}getCenter(g,c){if(this.paint.get("sky-type")==="atmosphere"){const _=this.paint.get("sky-atmosphere-sun"),A=!_,x=g.style.light,T=x.properties.get("position");return A&&x.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),A?h4(T.azimuthal,90-T.polar,c):h4(_[0],90-_[1],c)}const f=this.paint.get("sky-gradient-center");return h4(f[0],90-f[1],c)}isSky(){return!0}markSkyboxValid(g){this._skyboxInvalidated=!1,this._lightPosition=g.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const g=this.paint.get("sky-type");return g==="atmosphere"?["skyboxCapture","skybox"]:g==="gradient"?["skyboxGradient"]:null}},slot:class extends Hs{constructor(g,c,f,_){super(g,{paint:HG||(HG=new ji({}))},c,null)}},model:class extends Hs{constructor(g,c,f,_){super(g,{layout:eV||(eV=new ji({visibility:new gn(At.layout_model.visibility),"model-id":new Kn(At.layout_model["model-id"])})),paint:tV||(tV=new ji({"model-opacity":new gn(At.paint_model["model-opacity"]),"model-rotation":new Kn(At.paint_model["model-rotation"]),"model-scale":new Kn(At.paint_model["model-scale"]),"model-translation":new Kn(At.paint_model["model-translation"]),"model-color":new Kn(At.paint_model["model-color"]),"model-color-mix-intensity":new Kn(At.paint_model["model-color-mix-intensity"]),"model-type":new gn(At.paint_model["model-type"]),"model-cast-shadows":new gn(At.paint_model["model-cast-shadows"]),"model-receive-shadows":new gn(At.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new gn(At.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Kn(At.paint_model["model-emissive-strength"]),"model-roughness":new Kn(At.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Kn(At.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new gn(At.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new gn(At.paint_model["model-front-cutoff"])}))},c,f,_),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(g){return new p4(g)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(g){return g instanceof iC?yn-1:0}queryIntersectsFeature(g,c,f,_,A,x){if(!this.modelManager)return!1;const T=this.modelManager,B=g.tile.getBucket(this);if(!(B&&B instanceof p4))return!1;const U=B;for(const j in U.instancesPerModel){const R=U.instancesPerModel[j],N=c.id!==void 0?c.id:c.properties&&c.properties.hasOwnProperty("id")?c.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(N)){const V=R.features[R.idToFeaturesIndex[N]],z=T.getModel(j,this.scope);if(!z)return!1;let G=Pe.mat4.create();const X=new ue(0,0),K=U.canonical;let te=Number.MAX_VALUE;for(let ce=0;ce<V.instancedDataCount;++ce){const he=16*(V.instancedDataOffset+ce),ne=R.instancedDataArray.float32,de=[ne[he+4],ne[he+5],ne[he+6]];aV(K,X,ne[he],0|ne[he+1]),nV(G,z,x,X,V.rotation,V.scale,de,!1,!1,!1),x.projection.name==="globe"&&(G=d4(G,x));const ge=Pe.mat4.multiply([],x.projMatrix,G),Me=g.queryGeometry,Be=ZG(Me.isPointQuery()?Me.screenBounds:Me.screenGeometry,x,ge,z.aabb);Be!=null&&(te=Math.min(Be,te))}return te!==Number.MAX_VALUE&&te}}return!1}_handleOverridablePaintPropertyUpdate(g,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven()||g!=="model-color"&&g!=="model-color-mix-intensity"&&g!=="model-rotation"&&g!=="model-scale"&&g!=="model-translation"&&g!=="model-emissive-strength")}_isPropertyZoomDependent(g){const c=this._transitionablePaint._values[g];return c!=null&&c.value!=null&&c.value.expression!=null&&c.value.expression instanceof fl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(g,c,f,_){const A=g.tile,x=A.getBucket(this);let T=null,B=Number.MAX_VALUE;if(!(x&&x instanceof iC))return{queryFeature:T,intersectionZ:B};const U=x.getNodesInfo()[c];if(U.hiddenByReplacement||!U.node.meshes||!f.filter(new ds(A.tileID.overscaledZ),U.feature,A.tileID.canonical))return{queryFeature:T,intersectionZ:B};const j=U.node,R=_.calculatePosMatrix(A.tileID.toUnwrapped(),_.worldSize),N=U.evaluatedScale;let V=0;_.elevation&&j.elevation&&(V=j.elevation*_.elevation.exaggeration()),Pe.mat4.translate(R,R,[(j.anchor?j.anchor[0]:0)*(N[0]-1),(j.anchor?j.anchor[1]:0)*(N[1]-1),V]),Pe.mat4.scale(R,R,N),Pe.mat4.multiply(R,R,j.matrix);const z=g.queryGeometry,G=z.isPointQuery()?z.screenBounds:z.screenGeometry,X=function(te){const ce=Pe.mat4.multiply([],R,te.matrix),he=Pe.mat4.multiply(ce,_.expandedFarZProjMatrix,ce);for(let ne=0;ne<te.meshes.length;++ne){const de=te.meshes[ne];if(ne===te.lightMeshIndex)continue;const ge=ZG(G,_,he,de.aabb);ge!=null&&(B=Math.min(ge,B))}if(te.children)for(const ne of te.children)X(ne)};if(X(j),B===Number.MAX_VALUE)return{queryFeature:T,intersectionZ:B};const K=new ue(0,0);return aV(A.tileID.canonical,K,U.node.anchor[0],U.node.anchor[1]),T={type:"Feature",geometry:{type:"Point",coordinates:[K.lng,K.lat]},properties:U.feature.properties,id:U.feature.id,state:{},layer:this.serialize()},{queryFeature:T,intersectionZ:B}}},clip:class extends Hs{constructor(g,c,f,_){super(g,{layout:t7||(t7=new ji({"clip-layer-types":new gn(At.layout_clip["clip-layer-types"]),"clip-layer-scope":new gn(At.layout_clip["clip-layer-scope"])})),paint:n7||(n7=new ji({}))},c,f,_)}recalculate(g,c){super.recalculate(g,c)}createBucket(g){return new r7(g)}isTileClipped(){return!0}is3D(){return!0}}};class mfe{constructor(c){this._callback=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class gfe{constructor(){this.tasks={},this.taskQueue=[],Fr(["process"],this),this.invoker=new mfe(this.process),this.nextId=0}add(c,f){const _=this.nextId++,A=function({type:x,isSymbolTile:T,zoom:B}){return B=B||0,x==="message"?0:x!=="maybePrepare"||T?x!=="parseTile"||T?x==="parseTile"&&T?300-B:x==="maybePrepare"&&T?400-B:500:200-B:100-B}(f);if(A===0){try{c()}finally{}return null}return this.tasks[_]={fn:c,metadata:f,priority:A,id:_},this.taskQueue.push(_),this.invoker.trigger(),{cancel:()=>{delete this.tasks[_]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(_=>!!this.tasks[_]),!this.taskQueue.length)return;const c=this.pick();if(c===null)return;const f=this.tasks[c];if(delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),!f)return;f.fn()}finally{}}pick(){let c=null,f=1/0;for(let A=0;A<this.taskQueue.length;A++){const x=this.tasks[this.taskQueue[A]];x.priority<f&&(f=x.priority,c=A)}if(c===null)return null;const _=this.taskQueue[c];return this.taskQueue.splice(c,1),_}remove(){this.invoker.remove()}}class lV{constructor(c,f,_){this.target=c,this.parent=f,this.mapId=_,this.callbacks={},this.cancelCallbacks={},Fr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new gfe}send(c,f,_,A,x=!1,T){const B=Math.round(1e18*Math.random()).toString(36).substring(0,10);_&&(_.metadata=T,this.callbacks[B]=_);const U=new Set;return this.target.postMessage({id:B,type:c,hasCallback:!!_,targetMapId:A,mustQueue:x,sourceMapId:this.mapId,data:ya(f,U)},U),{cancel:()=>{_&&delete this.callbacks[B],this.target.postMessage({id:B,type:"<cancel>",targetMapId:A,sourceMapId:this.mapId})}}}receive(c){const f=c.data,_=f.id;if(_&&(!f.targetMapId||this.mapId===f.targetMapId))if(f.type==="<cancel>"){const A=this.cancelCallbacks[_];delete this.cancelCallbacks[_],A&&A.cancel()}else if(f.mustQueue||Ar()){const A=this.callbacks[_],x=this.scheduler.add(()=>this.processTask(_,f),A&&A.metadata||{type:"message"});x&&(this.cancelCallbacks[_]=x)}else this.processTask(_,f)}processTask(c,f){if(delete this.cancelCallbacks[c],f.type==="<response>"){const _=this.callbacks[c];delete this.callbacks[c],_&&(f.error?_(Ku(f.error)):_(null,Ku(f.data)))}else{const _=new Set,A=f.hasCallback?(T,B)=>{this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:T?ya(T):null,data:ya(B,_)},_)}:T=>{},x=Ku(f.data);if(this.parent[f.type])this.parent[f.type](f.sourceMapId,x,A);else if(this.parent.getWorkerSource){const T=f.type.split(".");this.parent.getWorkerSource(f.sourceMapId,T[0],x.source,x.scope)[T[1]](x,A)}else A(new Error(`Could not find function ${f.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class K1{constructor(c,f){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=ir();const _=this.workerPool.acquire(this.id);for(let A=0;A<_.length;A++){const x=new K1.Actor(_[A],f,this.id);x.name=`Worker ${A}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,f,_){tr(this.actors,(A,x)=>{A.send(c,f,x)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}K1.Actor=lV;class cV{constructor(c){this.size=c,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(c,f){const _=this.toIdx(c,f);return{min:this.minimums[_],max:this.maximums[_]}}isLeaf(c,f){return this.leaves[this.toIdx(c,f)]}toIdx(c,f){return f*this.size+c}}function uV(g,c,f,_){let A=0,x=Number.MAX_VALUE;for(let T=0;T<3;T++)if(Math.abs(_[T])<1e-15){if(f[T]<g[T]||f[T]>c[T])return null}else{const B=1/_[T];let U=(g[T]-f[T])*B,j=(c[T]-f[T])*B;if(U>j){const R=U;U=j,j=R}if(U>A&&(A=U),j<x&&(x=j),A>x)return null}return A}function hV(g,c,f,_,A,x,T,B,U,j,R){const N=_-g,V=A-c,z=x-f,G=T-g,X=B-c,K=U-f,te=R[1]*K-R[2]*X,ce=R[2]*G-R[0]*K,he=R[0]*X-R[1]*G,ne=N*te+V*ce+z*he;if(Math.abs(ne)<1e-15)return null;const de=1/ne,ge=j[0]-g,Me=j[1]-c,Be=j[2]-f,Oe=(ge*te+Me*ce+Be*he)*de;if(Oe<0||Oe>1)return null;const Re=Me*z-Be*V,Ye=Be*N-ge*z,ze=ge*V-Me*N,Qe=(R[0]*Re+R[1]*Ye+R[2]*ze)*de;return Qe<0||Oe+Qe>1?null:(G*Re+X*Ye+K*ze)*de}function fV(g,c,f){return(g-c)/(f-c)}function dV(g,c,f,_,A,x,T,B,U){const j=1<<f,R=x-_,N=T-A,V=(g+1)/j*R+_,z=(c+0)/j*N+A,G=(c+1)/j*N+A;B[0]=(g+0)/j*R+_,B[1]=z,U[0]=V,U[1]=G}class pV{constructor(c){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=c,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const f=function(x){const T=Math.ceil(Math.log2(x.dim/8)),B=[];let U=Math.ceil(Math.pow(2,T));const j=1/U,R=(z,G,X,K,te)=>{const ce=K?1:0,he=(z+1)*X-ce,ne=G*X,de=(G+1)*X-ce;te[0]=z*X,te[1]=ne,te[2]=he,te[3]=de};let N=new cV(U);const V=[];for(let z=0;z<U*U;z++){R(z%U,Math.floor(z/U),j,!1,V);const G=r0(V[0],V[1],x),X=r0(V[2],V[1],x),K=r0(V[2],V[3],x),te=r0(V[0],V[3],x);N.minimums.push(Math.min(G,X,K,te)),N.maximums.push(Math.max(G,X,K,te)),N.leaves.push(1)}for(B.push(N),U/=2;U>=1;U/=2){const z=B[B.length-1];N=new cV(U);for(let G=0;G<U*U;G++){R(G%U,Math.floor(G/U),2,!0,V);const X=z.getElevation(V[0],V[1]),K=z.getElevation(V[2],V[1]),te=z.getElevation(V[2],V[3]),ce=z.getElevation(V[0],V[3]),he=z.isLeaf(V[0],V[1]),ne=z.isLeaf(V[2],V[1]),de=z.isLeaf(V[2],V[3]),ge=z.isLeaf(V[0],V[3]),Me=Math.min(X.min,K.min,te.min,ce.min),Be=Math.max(X.max,K.max,te.max,ce.max),Oe=he&&ne&&de&&ge;N.maximums.push(Be),N.minimums.push(Me),N.leaves.push(Be-Me<=5&&Oe?1:0)}B.push(N)}return B}(this.dem),_=f.length-1,A=f[_];this._addNode(A.minimums[0],A.maximums[0],A.leaves[0]),this._construct(f,0,0,_,0)}raycastRoot(c,f,_,A,x,T,B=1){return uV([c,f,-100],[_,A,this.maximums[0]*B],x,T)}raycast(c,f,_,A,x,T,B=1){if(!this.nodeCount)return null;const U=this.raycastRoot(c,f,_,A,x,T,B);if(U==null)return null;const j=[],R=[],N=[],V=[],z=[{idx:0,t:U,nodex:0,nodey:0,depth:0}];for(;z.length>0;){const{idx:G,t:X,nodex:K,nodey:te,depth:ce}=z.pop();if(this.leaves[G]){dV(K,te,ce,c,f,_,A,N,V);const ne=1<<ce,de=(K+0)/ne,ge=(K+1)/ne,Me=(te+0)/ne,Be=(te+1)/ne,Oe=r0(de,Me,this.dem)*B,Re=r0(ge,Me,this.dem)*B,Ye=r0(ge,Be,this.dem)*B,ze=r0(de,Be,this.dem)*B,Qe=hV(N[0],N[1],Oe,V[0],N[1],Re,V[0],V[1],Ye,x,T),ct=hV(V[0],V[1],Ye,N[0],V[1],ze,N[0],N[1],Oe,x,T),ht=Math.min(Qe!==null?Qe:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(ht!==Number.MAX_VALUE)return ht;{const ft=Pe.vec3.scaleAndAdd([],x,T,X);if(mV(Oe,Re,ze,Ye,fV(ft[0],N[0],V[0]),fV(ft[1],N[1],V[1]))>=ft[2])return X}continue}let he=0;for(let ne=0;ne<this._siblingOffset.length;ne++){dV((K<<1)+this._siblingOffset[ne][0],(te<<1)+this._siblingOffset[ne][1],ce+1,c,f,_,A,N,V),N[2]=-100,V[2]=this.maximums[this.childOffsets[G]+ne]*B;const de=uV(N,V,x,T);if(de!=null){const ge=de;j[ne]=ge;let Me=!1;for(let Be=0;Be<he&&!Me;Be++)ge>=j[R[Be]]&&(R.splice(Be,0,ne),Me=!0);Me||(R[he]=ne),he++}}for(let ne=0;ne<he;ne++){const de=R[ne];z.push({idx:this.childOffsets[G]+de,t:j[de],nodex:(K<<1)+this._siblingOffset[de][0],nodey:(te<<1)+this._siblingOffset[de][1],depth:ce+1})}}return null}_addNode(c,f,_){return this.minimums.push(c),this.maximums.push(f),this.leaves.push(_),this.childOffsets.push(0),this.nodeCount++}_construct(c,f,_,A,x){if(c[A].isLeaf(f,_)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const T=A-1,B=c[T];let U=0,j=0;for(let R=0;R<this._siblingOffset.length;R++){const N=2*f+this._siblingOffset[R][0],V=2*_+this._siblingOffset[R][1],z=B.getElevation(N,V),G=B.isLeaf(N,V),X=this._addNode(z.min,z.max,G);G&&(U|=1<<R),j||(j=X)}for(let R=0;R<this._siblingOffset.length;R++)U&1<<R||this._construct(c,2*f+this._siblingOffset[R][0],2*_+this._siblingOffset[R][1],T,j+R)}}function mV(g,c,f,_,A,x){return cr(cr(g,f,x),cr(c,_,x),A)}function r0(g,c,f){const _=f.dim,A=jt(g*_-.5,0,_-1),x=jt(c*_-.5,0,_-1),T=Math.floor(A),B=Math.floor(x),U=Math.min(T+1,_-1),j=Math.min(B+1,_-1);return mV(f.get(T,B),f.get(U,B),f.get(T,j),f.get(U,j),A-T,x-B)}const vfe={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function _fe(g,c,f){return(256*g*256+256*c+f)/10-1e4}function yfe(g,c,f){return 256*g+c+f/256-32768}class sC{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(c,f,_,A=!1){if(this.uid=c,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(_&&_!=="mapbox"&&_!=="terrarium")return void Lt(`"${_}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=f.height;const x=this.dim=f.height-2,T=new Uint32Array(f.data.buffer);if(this.pixels=new Uint8Array(f.data.buffer),this.floatView=new Float32Array(f.data.buffer),this.borderReady=A,this._modifiedForSources={},!A){for(let U=0;U<x;U++)T[this._idx(-1,U)]=T[this._idx(0,U)],T[this._idx(x,U)]=T[this._idx(x-1,U)],T[this._idx(U,-1)]=T[this._idx(U,0)],T[this._idx(U,x)]=T[this._idx(U,x-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(x,-1)]=T[this._idx(x-1,0)],T[this._idx(-1,x)]=T[this._idx(0,x-1)],T[this._idx(x,x)]=T[this._idx(x-1,x-1)]}const B=_==="terrarium"?yfe:_fe;for(let U=0;U<T.length;++U){const j=4*U;this.floatView[U]=B(this.pixels[j],this.pixels[j+1],this.pixels[j+2])}this._timestamp=Cn.now()}_buildQuadTree(){this._tree=new pV(this)}get(c,f,_=!1){_&&(c=jt(c,-1,this.dim),f=jt(f,-1,this.dim));const A=this._idx(c,f);return this.floatView[A]}set(c,f,_){const A=this._idx(c,f),x=this.floatView[A];return this.floatView[A]=_,_-x}static getUnpackVector(c){return vfe[c]}_idx(c,f){if(c<-1||c>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(c+1)}static pack(c,f){const _=[0,0,0,0],A=sC.getUnpackVector(f);let x=Math.floor((c+A[3])/A[2]);return _[2]=x%256,x=Math.floor(x/256),_[1]=x%256,x=Math.floor(x/256),_[0]=x,_}getPixels(){return new q9({width:this.stride,height:this.stride},this.pixels)}backfillBorder(c,f,_){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let A=f*this.dim,x=f*this.dim+this.dim,T=_*this.dim,B=_*this.dim+this.dim;switch(f){case-1:A=x-1;break;case 1:x=A+1}switch(_){case-1:T=B-1;break;case 1:B=T+1}const U=-f*this.dim,j=-_*this.dim;for(let R=T;R<B;R++)for(let N=A;N<x;N++){const V=4*this._idx(N,R),z=4*this._idx(N+U,R+j);this.pixels[V+0]=c.pixels[z+0],this.pixels[V+1]=c.pixels[z+1],this.pixels[V+2]=c.pixels[z+2],this.pixels[V+3]=c.pixels[z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function xfe(g,c,f){g===1?c.header_length=f.readFixed32():g===2?c.x=f.readVarint():g===3?c.y=f.readVarint():g===4?c.z=f.readVarint():g===5&&c.layers.push(function(_,A){return _.readFields(Tfe,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},A)}(f,f.readVarint()+f.pos))}function bfe(g,c,f){g===1?(c.delta_filter=function(_,A){return _.readFields(wfe,{block_size:0},A)}(f,f.readVarint()+f.pos),c.filter="delta_filter"):g===2?(f.readVarint(),c.filter="zigzag_filter"):g===3?(f.readVarint(),c.filter="bitshuffle_filter"):g===4&&(f.readVarint(),c.filter="byteshuffle_filter")}function wfe(g,c,f){g===1&&(c.block_size=f.readVarint())}function Sfe(g,c,f){g===1?(f.readVarint(),c.codec="gzip_data"):g===2?(f.readVarint(),c.codec="jpeg_image"):g===3?(f.readVarint(),c.codec="webp_image"):g===4&&(f.readVarint(),c.codec="png_image")}function Afe(g,c,f){g===1?c.first_byte=f.readFixed64():g===2?c.last_byte=f.readFixed64():g===3?c.filters.push(function(_,A){return _.readFields(bfe,{},A)}(f,f.readVarint()+f.pos)):g===4?c.codec=function(_,A){return _.readFields(Sfe,{},A)}(f,f.readVarint()+f.pos):g===5?c.deprecated_offset=f.readFloat():g===6?c.deprecated_scale=f.readFloat():g===7?c.bands.push(f.readString()):g===8?c.offset=f.readDouble():g===9&&(c.scale=f.readDouble())}function Tfe(g,c,f){g===1?c.version=f.readVarint():g===2?c.name=f.readString():g===3?c.units=f.readString():g===4?c.tilesize=f.readVarint():g===5?c.buffer=f.readVarint():g===6?c.pixel_format=f.readVarint():g===7&&c.data_index.push(function(_,A){return _.readFields(Afe,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},A)}(f,f.readVarint()+f.pos))}function Mfe(g,c,f){if(g===2)(function(_,A,x){_.readFields(Cfe,x,A)})(f,f.readVarint()+f.pos,c);else if(g===3)throw new Error("Not implemented")}function Cfe(g,c,f){if(g===1){let _=0;const A=f.readVarint()+f.pos;for(;f.pos<A;)c[_++]=f.readVarint()}}Fn(sC,"DEMData"),Fn(pV,"DemMinMaxQuadTree",{omit:["dem"]});class Efe{constructor(c){this.capacity=c,this.cache=new Map}get(c){if(!this.cache.has(c))return;const f=this.cache.get(c);return this.cache.delete(c),this.cache.set(c,f),f}put(c,f){this.cache.has(c)?this.cache.delete(c):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(c,f)}}function Ife(g,c){if(c.length!==4)throw new Error(`Expected data of dimension 4 but got ${c.length}.`);let f=c[3];for(let _=2;_>=1;_--){const A=_===1?1:0,x=_===2?1:0;for(let T=0;T<c[0];T++){const B=c[1]*T;for(let U=A;U<c[1];U++){const j=c[2]*(U+B);for(let R=x;R<c[2];R++){const N=c[3]*(R+j);for(let V=0;V<c[3];V++){const z=N+V;g[z]+=g[z-f]}}}}f*=c[_]}return g}function Rfe(g){for(let c=0,f=g.length;c<f;c++)g[c]=g[c]>>>1^-(1&g[c]);return g}function Pfe(g,c){switch(c){case"uint32":return g;case"uint16":for(let f=0;f<g.length;f+=2){const _=g[f],A=g[f+1];g[f]=(240&_)>>4|(61440&_)>>8|(240&A)<<4|61440&A,g[f+1]=15&_|(3840&_)>>4|(15&A)<<8|(3840&A)<<4}return g;case"uint8":for(let f=0;f<g.length;f+=4){const _=g[f],A=g[f+1],x=g[f+2],T=g[f+3];g[f+0]=(192&_)>>6|(192&A)>>4|(192&x)>>2|192&T,g[f+1]=(48&_)>>4|(48&A)>>2|48&x|(48&T)<<2,g[f+2]=(12&_)>>2|12&A|(12&x)<<2|(12&T)<<4,g[f+3]=3&_|(3&A)<<2|(3&x)<<4|(3&T)<<6}return g;default:throw new Error(`Invalid pixel format, "${c}"`)}}var Mu=Uint8Array,o2=Uint16Array,Lfe=Int32Array,gV=new Mu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vV=new Mu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dfe=new Mu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_V=function(g,c){for(var f=new o2(31),_=0;_<31;++_)f[_]=c+=1<<g[_-1];var A=new Lfe(f[30]);for(_=1;_<30;++_)for(var x=f[_];x<f[_+1];++x)A[x]=x-f[_]<<5|_;return{b:f,r:A}},yV=_V(gV,2),xV=yV.b,Bfe=yV.r;xV[28]=258,Bfe[258]=28;for(var kfe=_V(vV,0).b,bV=new o2(32768),fo=0;fo<32768;++fo){var J1=(43690&fo)>>1|(21845&fo)<<1;bV[fo]=((65280&(J1=(61680&(J1=(52428&J1)>>2|(13107&J1)<<2))>>4|(3855&J1)<<4))>>8|(255&J1)<<8)>>1}var a2=function(g,c,f){for(var _=g.length,A=0,x=new o2(c);A<_;++A)g[A]&&++x[g[A]-1];var T,B=new o2(c);for(A=1;A<c;++A)B[A]=B[A-1]+x[A-1]<<1;T=new o2(1<<c);var U=15-c;for(A=0;A<_;++A)if(g[A])for(var j=A<<4|g[A],R=c-g[A],N=B[g[A]-1]++<<R,V=N|(1<<R)-1;N<=V;++N)T[bV[N]>>U]=j;return T},l2=new Mu(288);for(fo=0;fo<144;++fo)l2[fo]=8;for(fo=144;fo<256;++fo)l2[fo]=9;for(fo=256;fo<280;++fo)l2[fo]=7;for(fo=280;fo<288;++fo)l2[fo]=8;var wV=new Mu(32);for(fo=0;fo<32;++fo)wV[fo]=5;var Ofe=a2(l2,9),Ffe=a2(wV,5),_4=function(g){for(var c=g[0],f=1;f<g.length;++f)g[f]>c&&(c=g[f]);return c},xf=function(g,c,f){var _=c/8|0;return(g[_]|g[_+1]<<8)>>(7&c)&f},y4=function(g,c){var f=c/8|0;return(g[f]|g[f+1]<<8|g[f+2]<<16)>>(7&c)},Nfe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],bf=function(g,c,f){var _=new Error(c||Nfe[g]);if(_.code=g,Error.captureStackTrace&&Error.captureStackTrace(_,bf),!f)throw _;return _},zfe=new Mu(0),Ufe=typeof TextDecoder<"u"&&new TextDecoder;try{Ufe.decode(zfe,{stream:!0})}catch{}const Gfe={gzip_data:"gzip"};class sh extends Error{constructor(c){super(c),this.name="MRTError"}}const Vfe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},SV={uint32:1,uint16:2,uint8:4},Hfe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let x4;class b4{constructor(c=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=c}getLayer(c){const f=this.layers[c];if(!f)throw new sh(`Layer '${c}' not found`);return f}getHeaderLength(c){const f=new Uint8Array(c),_=new DataView(c);if(f[0]!==13)throw new sh("File is not a valid MRT.");return _.getUint32(1,!0)}parseHeader(c){const f=new Uint8Array(c),_=this.getHeaderLength(c);if(f.length<_)throw new sh(`Expected header with length >= ${_} but got buffer of length ${f.length}`);const A=function(x,T){return x.readFields(xfe,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new x4(f.subarray(0,_)));if(!isNaN(this.x)&&(this.x!==A.x||this.y!==A.y||this.z!==A.z))throw new sh(`Invalid attempt to parse header ${A.z}/${A.x}/${A.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=A.x,this.y=A.y,this.z=A.z;for(const x of A.layers)this.layers[x.name]=new jfe(x,{cacheSize:this._cacheSize});return this}createDecodingTask(c){const f=[],_=this.getLayer(c.layerName);for(let A of c.blockIndices){const x=_.dataIndex[A],T=x.first_byte-c.firstByte,B=x.last_byte-c.firstByte;if(_._blocksInProgress.has(A))continue;const U={layerName:_.name,firstByte:T,lastByte:B,pixelFormat:_.pixelFormat,blockIndex:A,blockShape:[x.bands.length].concat(_.bandShape),buffer:_.buffer,codec:x.codec.codec,filters:x.filters.map(j=>j.filter)};_._blocksInProgress.add(A),f.push(U)}return new AV(f,()=>{f.forEach(A=>_._blocksInProgress.delete(A.blockIndex))},(A,x)=>{if(f.forEach(T=>_._blocksInProgress.delete(T.blockIndex)),A)throw A;x.forEach(T=>{this.getLayer(T.layerName).processDecodedData(T)})})}}class jfe{constructor({version:c,name:f,units:_,tilesize:A,pixel_format:x,buffer:T,data_index:B},U){if(this.version=c,this.version!==1)throw new sh(`Cannot parse raster layer encoded with MRT version ${c}`);this.name=f,this.units=_,this.tileSize=A,this.buffer=T,this.pixelFormat=Vfe[x],this.dataIndex=B,this.bandShape=[A+2*T,A+2*T,SV[this.pixelFormat]],this._decodedBlocks=new Efe(U?U.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return SV[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:c})=>c).flat()}processDecodedData(c){const f=c.blockIndex.toString();this._decodedBlocks.get(f)||this._decodedBlocks.put(f,c.data)}getBlockForBand(c){let f=0;switch(typeof c){case"string":for(const[_,A]of this.dataIndex.entries()){for(const[x,T]of A.bands.entries())if(T===c)return{bandIndex:f+x,blockIndex:_,blockBandIndex:x};f+=A.bands.length}break;case"number":for(const[_,A]of this.dataIndex.entries()){if(c>=f&&c<f+A.bands.length)return{bandIndex:c,blockIndex:_,blockBandIndex:c-f};f+=A.bands.length}break;default:throw new sh(`Invalid band \`${JSON.stringify(c)}\`. Expected string or integer.`)}throw new sh(`Band not found: ${JSON.stringify(c)}`)}getDataRange(c){let f=1/0,_=-1/0;const A=[],x=new Set;for(const T of c){const{blockIndex:B}=this.getBlockForBand(T);if(B<0)throw new sh(`Invalid band: ${JSON.stringify(T)}`);const U=this.dataIndex[B];A.includes(B)||A.push(B),x.add(B),f=Math.min(f,U.first_byte),_=Math.max(_,U.last_byte)}if(x.size>this.cacheSize)throw new sh(`Number of blocks to decode (${x.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:f,lastByte:_,blockIndices:A}}hasBand(c){const{blockIndex:f}=this.getBlockForBand(c);return f>=0}hasDataForBand(c){const{blockIndex:f}=this.getBlockForBand(c);return f>=0&&!!this._decodedBlocks.get(f.toString())}getBandView(c){const{blockIndex:f,blockBandIndex:_}=this.getBlockForBand(c),A=this._decodedBlocks.get(f.toString());if(!A)throw new sh(`Data for band ${JSON.stringify(c)} of layer "${this.name}" not decoded.`);const x=this.dataIndex[f],T=this.bandShape.reduce((j,R)=>j*R,1),B=_*T,U=A.subarray(B,B+T);return{data:U,bytes:new Uint8Array(U.buffer).subarray(U.byteOffset,U.byteOffset+U.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:x.offset!==0?x.offset:x.deprecated_offset,scale:x.scale!==0?x.scale:x.deprecated_scale}}}b4.setPbf=function(g){x4=g};class AV{constructor(c,f,_){this.tasks=c,this._onCancel=f,this._onComplete=_,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(c,f){this._finalized||(this._onComplete(c,f),this._finalized=!0)}}b4.performDecoding=function(g,c){const f=new Uint8Array(g);return Promise.all(c.tasks.map(_=>{const{layerName:A,firstByte:x,lastByte:T,pixelFormat:B,blockShape:U,blockIndex:j,filters:R,codec:N}=_,V=f.subarray(x,T+1),z=new Uint32Array(U[0]*U[1]*U[2]);let G;if(N!=="gzip_data")throw new sh(`Unhandled codec: ${N}`);return G=function(X,K){if(!globalThis.DecompressionStream&&K==="gzip_data")return Promise.resolve(((ne=function(Me){Me[0]==31&&Me[1]==139&&Me[2]==8||bf(6,"invalid gzip data");var Be=Me[3],Oe=10;4&Be&&(Oe+=2+(Me[10]|Me[11]<<8));for(var Re=(Be>>3&1)+(Be>>4&1);Re>0;Re-=!Me[Oe++]);return Oe+(2&Be)}(he=X))+8>he.length&&bf(6,"invalid gzip data"),function(Me,Be,Oe,Re){var Ye=Me.length;if(!Ye||Be.f&&!Be.l)return Oe||new Mu(0);var ze=!Oe,Qe=ze||Be.i!=2,ct=Be.i;ze&&(Oe=new Mu(3*Ye));var ht,ft,mt=function(i0){var g_=Oe.length;if(i0>g_){var m2=new Mu(Math.max(2*g_,i0));m2.set(Oe),Oe=m2}},Et=Be.f||0,vt=Be.p||0,Ut=Be.b||0,Yt=Be.l,Dt=Be.d,Rn=Be.m,bn=Be.n,dn=8*Ye;do{if(!Yt){Et=xf(Me,vt,1);var tn=xf(Me,vt+1,3);if(vt+=3,!tn){var nr=Me[(Tr=4+((vt+7)/8|0))-4]|Me[Tr-3]<<8,In=Tr+nr;if(In>Ye){ct&&bf(0);break}Qe&&mt(Ut+nr),Oe.set(Me.subarray(Tr,In),Ut),Be.b=Ut+=nr,Be.p=vt=8*In,Be.f=Et;continue}if(tn==1)Yt=Ofe,Dt=Ffe,Rn=9,bn=5;else if(tn==2){var Nn=xf(Me,vt,31)+257,wr=xf(Me,vt+10,15)+4,Or=Nn+xf(Me,vt+5,31)+1;vt+=14;for(var Pr=new Mu(Or),Lr=new Mu(19),jr=0;jr<wr;++jr)Lr[Dfe[jr]]=xf(Me,vt+3*jr,7);vt+=3*wr;var Wr=_4(Lr),Ui=(1<<Wr)-1,Ti=a2(Lr,Wr);for(jr=0;jr<Or;){var Tr,vi=Ti[xf(Me,vt,Ui)];if(vt+=15&vi,(Tr=vi>>4)<16)Pr[jr++]=Tr;else{var bi=0,ss=0;for(Tr==16?(ss=3+xf(Me,vt,3),vt+=2,bi=Pr[jr-1]):Tr==17?(ss=3+xf(Me,vt,7),vt+=3):Tr==18&&(ss=11+xf(Me,vt,127),vt+=7);ss--;)Pr[jr++]=bi}}var js=Pr.subarray(0,Nn),po=Pr.subarray(Nn);Rn=_4(js),bn=_4(po),Yt=a2(js,Rn),Dt=a2(po,bn)}else bf(1);if(vt>dn){ct&&bf(0);break}}Qe&&mt(Ut+131072);for(var Ws=(1<<Rn)-1,ks=(1<<bn)-1,ua=vt;;ua=vt){var So=(bi=Yt[y4(Me,vt)&Ws])>>4;if((vt+=15&bi)>dn){ct&&bf(0);break}if(bi||bf(2),So<256)Oe[Ut++]=So;else{if(So==256){ua=vt,Yt=null;break}var za=So-254;So>264&&(za=xf(Me,vt,(1<<(Sf=gV[jr=So-257]))-1)+xV[jr],vt+=Sf);var Ji=Dt[y4(Me,vt)&ks],pc=Ji>>4;if(Ji||bf(3),vt+=15&Ji,po=kfe[pc],pc>3){var Sf=vV[pc];po+=y4(Me,vt)&(1<<Sf)-1,vt+=Sf}if(vt>dn){ct&&bf(0);break}Qe&&mt(Ut+131072);var oh=Ut+za;if(Ut<po){var ah=0-po,m_=Math.min(po,oh);for(ah+Ut<0&&bf(3);Ut<m_;++Ut)Oe[Ut]=(void 0)[ah+Ut]}for(;Ut<oh;++Ut)Oe[Ut]=Oe[Ut-po]}}Be.l=Yt,Be.p=ua,Be.b=Ut,Be.f=Et,Yt&&(Et=1,Be.m=Rn,Be.d=Dt,Be.n=bn)}while(!Et);return Ut!=Oe.length&&ze?(ht=Oe,((ft=Ut)==null||ft>ht.length)&&(ft=ht.length),new Mu(ht.subarray(0,ft))):Oe.subarray(0,Ut)}(he.subarray(ne,-8),{i:2},new Mu(((te=he)[(ce=te.length)-4]|te[ce-3]<<8|te[ce-2]<<16|te[ce-1]<<24)>>>0))));var te,ce,he,ne;const de=Gfe[K];if(!de)throw new Error(`Unhandled codec: ${K}`);const ge=new globalThis.DecompressionStream(de);return new Response(new Blob([X]).stream().pipeThrough(ge)).arrayBuffer().then(Me=>new Uint8Array(Me))}(V,N).then(X=>(function(K,te){K.readFields(Mfe,te)}(new x4(X),z),new Hfe[B](z.buffer))),G.then(X=>{for(let K=R.length-1;K>=0;K--)switch(R[K]){case"delta_filter":Ife(X,U);break;case"zigzag_filter":Rfe(X);break;case"bitshuffle_filter":Pfe(X,B);break;default:throw new sh(`Unhandled filter "${R[K]}"`)}return{layerName:A,blockIndex:j,data:X}}).catch(X=>{throw X})}))},Fn(AV,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var c2={workerUrl:"",workerClass:null,workerParams:void 0};const w4="mapboxgl_preloaded_worker_pool";class u2{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<u2.workerCount;)this.workers.push(c2.workerClass!=null?new c2.workerClass:new self.Worker(c2.workerUrl,c2.workerParams));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.workers&&this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[w4]}numActive(){return Object.keys(this.active).length}}let h2;function oC(){return h2||(h2=new u2),h2}u2.workerCount=2;let f2,S4,wf,Q1,A4,ex=null;function TV(){return Ar()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:S4||nt.DRACO_URL}function MV(){if(Ar()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Q1)return Q1;const g=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Q1=WebAssembly.validate(g)?nt.MESHOPT_SIMD_URL:nt.MESHOPT_URL,Q1}const aC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Wfe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},d2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function CV(g,c,f){const _=f.json.bufferViews.length,A=f.buffers.length;c.bufferView=_,f.json.bufferViews[_]={buffer:A,byteLength:g.byteLength},f.buffers[A]=g}const T4="KHR_draco_mesh_compression";function Xfe(g,c){const f=g.extensions&&g.extensions[T4];if(!f)return;const _=new wf.Decoder,A=PV(c,f.bufferView),x=new wf.Mesh;if(!_.DecodeArrayToMesh(A,A.byteLength,x))throw new Error("Failed to decode Draco mesh");const T=c.json.accessors[g.indices],B=aC[T.componentType],U=T.count*B.BYTES_PER_ELEMENT,j=wf._malloc(U);B===Uint16Array?_.GetTrianglesUInt16Array(x,U,j):_.GetTrianglesUInt32Array(x,U,j),CV(wf.memory.buffer.slice(j,j+U),T,c),wf._free(j);for(const R of Object.keys(f.attributes)){const N=_.GetAttributeByUniqueId(x,f.attributes[R]),V=c.json.accessors[g.attributes[R]],z=Wfe[V.componentType],G=V.count*d2[V.type]*aC[V.componentType].BYTES_PER_ELEMENT,X=wf._malloc(G);_.GetAttributeDataArrayForAllPoints(x,N,wf[z],G,X),CV(wf.memory.buffer.slice(X,X+G),V,c),wf._free(X)}_.destroy(),x.destroy(),delete g.extensions[T4]}const lC="EXT_meshopt_compression";function $fe(g,c){if(!g.extensions||!g.extensions[lC])return;const f=g.extensions[lC],_=new Uint8Array(c.buffers[f.buffer],f.byteOffset||0,f.byteLength||0),A=new Uint8Array(f.count*f.byteStride);A4.decodeGltfBuffer(A,f.count,f.byteStride,_,f.mode,f.filter),g.buffer=c.buffers.length,g.byteOffset=0,c.buffers[g.buffer]=A.buffer,delete g.extensions[lC]}const EV=1179937895,IV=new TextDecoder("utf8");function RV(g,c){return new URL(g,c).href}function qfe(g,c,f,_){return fetch(RV(g.uri,_)).then(A=>A.arrayBuffer()).then(A=>{c.buffers[f]=A})}function PV(g,c){const f=g.json.bufferViews[c];return new Uint8Array(g.buffers[f.buffer],f.byteOffset||0,f.byteLength)}function Zfe(g,c,f,_){if(g.uri){const A=RV(g.uri,_);return fetch(A).then(x=>x.blob()).then(x=>createImageBitmap(x)).then(x=>{c.images[f]=x})}if(g.bufferView!==void 0){const A=PV(c,g.bufferView),x=new Blob([A],{type:g.mimeType});return createImageBitmap(x).then(T=>{c.images[f]=T})}}function LV(g,c=0,f){const _={json:null,images:[],buffers:[]};if(new Uint32Array(g,c,1)[0]===EV){const R=new Uint32Array(g,c);let N=2;const V=(R[N++]>>2)-3,z=R[N++]>>2;if(N++,_.json=JSON.parse(IV.decode(R.subarray(N,N+z))),N+=z,N<V){const G=R[N++];N++;const X=c+(N<<2);_.buffers[0]=g.slice(X,X+G)}}else _.json=JSON.parse(IV.decode(new Uint8Array(g,c)));const{buffers:A,images:x,meshes:T,extensionsUsed:B,bufferViews:U}=_.json;let j=Promise.resolve();if(A){const R=[];for(let N=0;N<A.length;N++){const V=A[N];V.uri?R.push(qfe(V,_,N,f)):_.buffers[N]||(_.buffers[N]=null)}j=Promise.all(R)}return j.then(()=>{const R=[],N=B&&B.includes(T4),V=B&&B.includes(lC);if(N&&R.push(function(){if(!wf)return f2??(f2=function(z){let G,X=null;function K(){G=new Uint8Array(X.buffer)}function te(){throw new Error("Unexpected Draco error.")}const ce={a:{a:te,d:function(he,ne,de){return G.copyWithin(he,ne,ne+de)},c:function(he){const ne=G.length,de=Math.max(he>>>0,Math.ceil(1.2*ne)),ge=Math.ceil((de-ne)/65536);try{return X.grow(ge),K(),!0}catch{return!1}},b:te}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(z,ce):z.then(he=>he.arrayBuffer()).then(he=>WebAssembly.instantiate(he,ce))).then(he=>{const{Rb:ne,Qb:de,P:ge,T:Me,X:Be,Ja:Oe,La:Re,Qa:Ye,Va:ze,Wa:Qe,eb:ct,jb:ht,f:ft,e:mt,yb:Et,zb:vt,Ab:Ut,Bb:Yt,Db:Dt,Gb:Rn}=he.instance.exports;X=mt;const bn=(()=>{let dn=0,tn=0,nr=0,In=0;return Nn=>{nr&&(ne(In),ne(dn),tn+=nr,nr=dn=0),dn||(tn+=128,dn=de(tn));const wr=Nn.length+7&-8;let Or=dn;wr>=tn&&(nr=wr,Or=In=de(wr));for(let Pr=0;Pr<Nn.length;Pr++)G[Or+Pr]=Nn[Pr];return Or}})();return K(),ft(),{memory:mt,_free:ne,_malloc:de,Mesh:class{constructor(){this.ptr=ge()}destroy(){Me(this.ptr)}},Decoder:class{constructor(){this.ptr=Oe()}destroy(){ht(this.ptr)}DecodeArrayToMesh(dn,tn,nr){const In=bn(dn),Nn=Re(this.ptr,In,tn,nr.ptr);return!!Be(Nn)}GetAttributeByUniqueId(dn,tn){return{ptr:Ye(this.ptr,dn.ptr,tn)}}GetTrianglesUInt16Array(dn,tn,nr){ze(this.ptr,dn.ptr,tn,nr)}GetTrianglesUInt32Array(dn,tn,nr){Qe(this.ptr,dn.ptr,tn,nr)}GetAttributeDataArrayForAllPoints(dn,tn,nr,In,Nn){ct(this.ptr,dn.ptr,tn.ptr,nr,In,Nn)}},DT_INT8:Et(),DT_UINT8:vt(),DT_INT16:Ut(),DT_UINT16:Yt(),DT_UINT32:Dt(),DT_FLOAT32:Rn()}})}(fetch(TV())),f2.then(z=>{wf=z,f2=void 0}))}()),V&&R.push(function(){if(A4)return;const z=function(G){let X;const K=WebAssembly.instantiateStreaming(G,{}).then(he=>{X=he.instance,X.exports.__wasm_call_ctors()}),te={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ce={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:K,supported:!0,decodeGltfBuffer(he,ne,de,ge,Me,Be){(function(Oe,Re,Ye,ze,Qe,ct,ht){const ft=Oe.exports.sbrk,mt=ze+3&-4,Et=ft(mt*Qe),vt=ft(ct.length),Ut=new Uint8Array(Oe.exports.memory.buffer);Ut.set(ct,vt);const Yt=Re(Et,ze,Qe,vt,ct.length);if(Yt===0&&ht&&ht(Et,mt,Qe),Ye.set(Ut.subarray(Et,Et+ze*Qe)),ft(Et-ft(0)),Yt!==0)throw new Error(`Malformed buffer data: ${Yt}`)})(X,X.exports[ce[Me]],he,ne,de,ge,X.exports[te[Be]])}}}(fetch(MV()));return z.ready.then(()=>{A4=z})}()),x)for(let z=0;z<x.length;z++)R.push(Zfe(x[z],_,z,f));return(R.length?Promise.all(R):Promise.resolve()).then(()=>{if(N&&T)for(const{primitives:z}of T)for(const G of z)Xfe(G,_);if(V&&T&&U)for(const z of U)$fe(z,_);return _})})}function p_(g,c){const f=g.json.bufferViews[c.bufferView],_=aC[c.componentType];return new _(g.buffers[f.buffer],(c.byteOffset||0)+(f.byteOffset||0),c.count*(f.byteStride&&f.byteStride!==d2[c.type]*_.BYTES_PER_ELEMENT?f.byteStride/_.BYTES_PER_ELEMENT:d2[c.type]))}function M4(g,c,f,_){const A=aC[c.componentType],x=function(R){switch(R){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(A),T=g.json.bufferViews[c.bufferView],B=T.byteStride?T.byteStride/A.BYTES_PER_ELEMENT:d2[c.type],U=f.float32,j=U.length/f.capacity;for(let R=0,N=0;R<c.count*B;R+=B,N+=j)for(let V=0;V<j;V++)U[N+V]=_[R+V]*x;f._trim()}function Yfe(g,c,f){const _=g.indices,A=g.attributes,x={};x.indexArray=new wo;const T=c.json.accessors[_],B=T.count/3;x.indexArray.reserve(B);const U=p_(c,T);for(let V=0;V<B;V++)x.indexArray.emplaceBack(U[3*V],U[3*V+1],U[3*V+2]);x.indexArray._trim(),x.vertexArray=new co;const j=c.json.accessors[A.POSITION];x.vertexArray.reserve(j.count);const R=p_(c,j);for(let V=0;V<j.count;V++)x.vertexArray.emplaceBack(R[3*V],R[3*V+1],R[3*V+2]);if(x.vertexArray._trim(),x.aabb=new Ki(j.min,j.max),x.centroid=function(V,z){const G=[0,0,0],X=V.length;if(X>0){for(let K=0;K<X;K++){const te=3*V[K];G[0]+=z[te],G[1]+=z[te+1],G[2]+=z[te+2]}G[0]/=X,G[1]/=X,G[2]/=X}return G}(U,R),A.COLOR_0!==void 0){const V=c.json.accessors[A.COLOR_0],z=d2[V.type],G=p_(c,V);x.colorArray=z===3?new co:new Rl,x.colorArray.resize(V.count),M4(c,V,x.colorArray,G)}if(A.NORMAL!==void 0){x.normalArray=new co;const V=c.json.accessors[A.NORMAL];x.normalArray.resize(V.count);const z=p_(c,V);M4(c,V,x.normalArray,z)}if(A.TEXCOORD_0!==void 0&&f.length>0){x.texcoordArray=new fc;const V=c.json.accessors[A.TEXCOORD_0];x.texcoordArray.resize(V.count);const z=p_(c,V);M4(c,V,x.texcoordArray,z)}if(A._FEATURE_ID_RGBA4444!==void 0){const V=c.json.accessors[A._FEATURE_ID_RGBA4444];c.json.extensionsUsed&&c.json.extensionsUsed.includes("EXT_meshopt_compression")&&(x.featureData=p_(c,V))}A._FEATURE_RGBA4444!==void 0&&(x.featureData=new Uint32Array(p_(c,c.json.accessors[A._FEATURE_RGBA4444]).buffer));const N=g.material;return x.material=function(V,z){const{emissiveFactor:G=[0,0,0],alphaMode:X="OPAQUE",alphaCutoff:K=.5,normalTexture:te,occlusionTexture:ce,emissiveTexture:he,doubleSided:ne}=V,{baseColorFactor:de=[1,1,1,1],metallicFactor:ge=1,roughnessFactor:Me=1,baseColorTexture:Be,metallicRoughnessTexture:Oe}=V.pbrMetallicRoughness||{},Re=ce?z[ce.index]:void 0;if(ce&&ce.extensions&&ce.extensions.KHR_texture_transform&&Re){const Ye=ce.extensions.KHR_texture_transform;Re.offsetScale=[Ye.offset[0],Ye.offset[1],Ye.scale[0],Ye.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new vr(...de),metallicFactor:ge,roughnessFactor:Me,baseColorTexture:Be?z[Be.index]:void 0,metallicRoughnessTexture:Oe?z[Oe.index]:void 0},doubleSided:ne,emissiveFactor:G,alphaMode:X,alphaCutoff:K,normalTexture:te?z[te.index]:void 0,occlusionTexture:Re,emissionTexture:he?z[he.index]:void 0,defined:V.defined===void 0}}(N!==void 0?c.json.materials[N]:{defined:!1},f),x}function DV(g,c,f){const{matrix:_,rotation:A,translation:x,scale:T,mesh:B,extras:U,children:j}=g,R={};if(R.matrix=_||Pe.mat4.fromRotationTranslationScale([],A||[0,0,0,1],x||[0,0,0],T||[1,1,1]),B!==void 0){R.meshes=f[B];const N=R.anchor=[0,0];for(const V of R.meshes){const{min:z,max:G}=V.aabb;N[0]+=z[0]+G[0],N[1]+=z[1]+G[1]}N[0]=Math.floor(N[0]/R.meshes.length/2),N[1]=Math.floor(N[1]/R.meshes.length/2)}if(U&&(U.id&&(R.id=U.id),U.lights&&(R.lights=function(N){if(!N.length)return[];const V=function(te){const ce=atob(te),he=new Uint8Array(ce.length);for(let ne=0;ne<ce.length;ne++)he[ne]=ce.codePointAt(ne);return he}(N),z=[],G=V.length/24,X=new Uint16Array(V.buffer),K=new Float32Array(V.buffer);for(let te=0;te<G;te++){const ce=X[2*te*6]/30,he=X[2*te*6+1]/30,ne=X[2*te*6+10]/100,de=K[6*te+1],ge=K[6*te+2],Me=K[6*te+3],Be=K[6*te+4],Oe=Me-de,Re=Be-ge,Ye=Math.hypot(Oe,Re);z.push({pos:[de+.5*Oe,ge+.5*Re,he],normal:[Re/Ye,-Oe/Ye,0],width:Ye,height:ce,depth:ne,points:[de,ge,Me,Be]})}return z}(U.lights))),j){const N=[];for(const V of j)N.push(DV(c.json.nodes[V],c,f));R.children=N}return R}function Kfe(g){if(g.vertices.length===0||g.indices.length===0)return null;const c=new k3(g.vertices,g.indices,8,256),[f,_]=[c.min.clone(),c.max.clone()];return{vertices:g.vertices,indices:g.indices,grid:c,min:f,max:_}}function Jfe(g){if(!g.extras||!g.extras.ground)return null;const c=g.extras.ground;if(!c||!Array.isArray(c)||c.length===0)return null;const f=c[0];if(!f||!Array.isArray(f)||f.length===0)return null;const _=[];for(const T of f){if(!Array.isArray(T)||T.length!==2)continue;const B=T[0],U=T[1];typeof B=="number"&&typeof U=="number"&&_.push(new St(B,U))}if(_.length<3)return null;_.length>1&&_[_.length-1].equals(_[0])&&_.pop();let A=0;for(let T=0;T<_.length;T++){const B=_[T],U=_[(T+1)%_.length],j=_[(T+2)%_.length];A+=(B.x-U.x)*(j.y-U.y)-(j.x-U.x)*(B.y-U.y)}A>0&&_.reverse();const x=zw(_.flatMap(T=>[T.x,T.y]),[]);return x.length===0?null:{vertices:_,indices:x}}function Qfe(g,c){const f=[],_=[];let A=0;const x=[];for(const T of g){A=f.length;const B=T.vertexArray.float32,U=T.indexArray.uint16;for(let j=0;j<T.vertexArray.length;j++)x[0]=B[3*j+0],x[1]=B[3*j+1],x[2]=B[3*j+2],Pe.vec3.transformMat4(x,x,c),f.push(new St(x[0],x[1]));for(let j=0;j<3*T.indexArray.length;j++)_.push(U[j]+A)}if(_.length%3!=0)return null;for(let T=0;T<_.length;T+=3){const B=f[_[T+0]],U=f[_[T+1]],j=f[_[T+2]];(B.x-U.x)*(j.y-U.y)-(j.x-U.x)*(B.y-U.y)>0&&([_[T+1],_[T+2]]=[_[T+2],_[T+1]])}return{vertices:f,indices:_}}function BV(g){const c=function(U,j){const R=[],N=WebGL2RenderingContext;if(U.json.textures)for(const V of U.json.textures){const z={magFilter:N.LINEAR,minFilter:N.NEAREST,wrapS:N.REPEAT,wrapT:N.REPEAT};V.sampler!==void 0&&Object.assign(z,U.json.samplers[V.sampler]),R.push({image:j[V.source],sampler:z,uploaded:!1})}return R}(g,g.images),f=function(U,j){const R=[];for(const N of U.json.meshes){const V=[];for(const z of N.primitives)V.push(Yfe(z,U,j));R.push(V)}return R}(g,c),{scenes:_,scene:A,nodes:x}=g.json,T=_?_[A||0].nodes:x,B=[];for(const U of T)B.push(DV(x[U],g,f));return function(U,j,R){const N={},V=new Set;for(let z=0;z<U.length;z++){const G=R[j[z]];if(!G.extras)continue;const X=G.extras["mapbox:footprint:version"],K=G.extras["mapbox:footprint:id"];(X||K)&&V.add(z),X==="1.0.0"&&K&&(N[K]=z)}for(let z=0;z<U.length;z++){if(V.has(z))continue;const G=U[z],X=R[j[z]];if(!X.extras)continue;let K=null;G.id in N&&(K=Qfe(U[N[G.id]].meshes,G.matrix)),K||(K=Jfe(X)),K&&(G.footprint=Kfe(K))}if(V.size>0){const z=Array.from(V.values()).sort((G,X)=>G-X);for(let G=z.length-1;G>=0;G--)U.splice(z[G],1)}}(B,T,g.json.nodes),B}function ede(g){g.heightmap=new Float32Array(4096),g.heightmap.fill(-1);const c=g.vertexArray.float32,f=g.aabb.min[0]-1,_=g.aabb.min[1]-1,A=f_/(g.aabb.max[0]-f+2),x=f_/(g.aabb.max[1]-_+2);for(let T=0;T<c.length;T+=3){const B=c[T+2],U=(c[T+0]-f)*A|0,j=(c[T+1]-_)*x|0;B>g.heightmap[j*f_+U]&&(g.heightmap[j*f_+U]=B)}}function tde(g,c){const f={};f.indexArray=new wo,f.indexArray.reserve(4*g.length),f.vertexArray=new co,f.vertexArray.reserve(10*g.length),f.colorArray=new Rl,f.vertexArray.reserve(10*g.length);let _=0;for(const T of g){const B=Math.min(10,Math.max(4,1.3*T.height))*c,U=[-T.normal[1],T.normal[0],0],j=Math.min(.29,.1*T.width/T.depth),R=T.width-2*T.depth*c*(j+.01),N=Pe.vec3.scaleAndAdd([],T.pos,U,R/2),V=Pe.vec3.scaleAndAdd([],T.pos,U,-R/2),z=[N[0],N[1],N[2]+T.height],G=[V[0],V[1],V[2]+T.height],X=Pe.vec3.scaleAndAdd([],T.normal,U,j);Pe.vec3.scale(X,X,B);const K=Pe.vec3.scaleAndAdd([],T.normal,U,-j);Pe.vec3.scale(K,K,B),Pe.vec3.add(X,N,X),Pe.vec3.add(K,V,K),N[2]+=.1,V[2]+=.1,f.vertexArray.emplaceBack(X[0],X[1],X[2]),f.vertexArray.emplaceBack(K[0],K[1],K[2]),f.vertexArray.emplaceBack(N[0],N[1],N[2]),f.vertexArray.emplaceBack(V[0],V[1],V[2]),f.vertexArray.emplaceBack(z[0],z[1],z[2]),f.vertexArray.emplaceBack(G[0],G[1],G[2]),f.vertexArray.emplaceBack(N[0],N[1],N[2]),f.vertexArray.emplaceBack(V[0],V[1],V[2]),f.vertexArray.emplaceBack(X[0],X[1],X[2]),f.vertexArray.emplaceBack(K[0],K[1],K[2]);const te=R/B/2;f.colorArray.emplaceBack(-te-j,-1,te,.8),f.colorArray.emplaceBack(te+j,-1,te,.8),f.colorArray.emplaceBack(-te,0,te,1.3),f.colorArray.emplaceBack(te,0,te,1.3),f.colorArray.emplaceBack(te+j,-.8,te,.7),f.colorArray.emplaceBack(te+j,-.8,te,.7),f.colorArray.emplaceBack(0,0,te,1.3),f.colorArray.emplaceBack(0,0,te,1.3),f.colorArray.emplaceBack(te+j,-1.2,te,.8),f.colorArray.emplaceBack(te+j,-1.2,te,.8),f.indexArray.emplaceBack(6+_,4+_,8+_),f.indexArray.emplaceBack(7+_,9+_,5+_),f.indexArray.emplaceBack(0+_,1+_,2+_),f.indexArray.emplaceBack(1+_,3+_,2+_),_+=10}const A={defined:!0,emissiveFactor:[0,0,0]},x={};return x.baseColorFactor=vr.white,A.pbrMetallicRoughness=x,f.material=A,f.aabb=new Ki([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),f}class kV{constructor(c){this._stringToNumber={},this._numberToString=[];for(let f=0;f<c.length;f++){const _=c[f];this._stringToNumber[_]=f,this._numberToString[f]=_}}encode(c){return this._stringToNumber[c]}decode(c){return this._numberToString[c]}}const nde=["id","tile","layer","source","sourceLayer","state"];class OV{constructor(c,f,_,A,x){this.type="Feature",this._vectorTileFeature=c,this._z=f,this._x=_,this._y=A,this.properties=c.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const f of nde)this[f]!==void 0&&(c[f]=this[f]);return c}}class FV{constructor(c,f){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Uc(yn,16,0),this.featureIndexArray=new nm,this.promoteId=f,this.is3DTile=!1}insert(c,f,_,A,x,T=0,B=0){const U=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(_,A,x,T);const j=this.grid;for(let R=0;R<f.length;R++){const N=f[R],V=[1/0,1/0,-1/0,-1/0];for(let z=0;z<N.length;z++){const G=N[z];V[0]=Math.min(V[0],G.x),V[1]=Math.min(V[1],G.y),V[2]=Math.max(V[2],G.x),V[3]=Math.max(V[3],G.y)}B!==0&&(V[0]-=B,V[1]-=B,V[2]+=B,V[3]+=B),V[0]<yn&&V[1]<yn&&V[2]>=0&&V[3]>=0&&j.insert(U,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new H1.VectorTile(new FM(this.rawTileData)).layers,this.sourceLayerCoder=new kV(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const c in this.vtLayers)this.vtFeatures[c]=[]}return this.vtLayers}query(c,f,_,A){this.loadVTLayers();const x=c.params||{},T=rs(x.filter),B=c.tileResult,U=c.transform,j=B.bufferedTilespaceBounds,R=this.grid.query(j.min.x,j.min.y,j.max.x,j.max.y,(G,X,K,te)=>Wc(B.bufferedTilespaceGeometry,G,X,K,te));R.sort(rde);let N=null;U.elevation&&R.length>0&&(N=Y1.create(U.elevation,this.tileID));const V={};let z;for(let G=0;G<R.length;G++){const X=R[G];if(X===z)continue;z=X;const K=this.featureIndexArray.get(X);let te=null;if(this.is3DTile){const ce=this.bucketLayerIDs[0][0],he=f[ce];if(he.type!=="model")continue;const{queryFeature:ne,intersectionZ:de}=he.queryIntersectsMatchingFeature(B,K.featureIndex,T,U);ne&&this.appendToResult(V,ce,K.featureIndex,ne,de)}else this.loadMatchingFeature(V,K,T,x.layers,x.availableImages,f,_,A,(ce,he,ne,de=0)=>(te||(te=fn(ce,this.tileID.canonical,c.tileTransform)),he.queryIntersectsFeature(B,ce,ne,te,this.z,c.transform,c.pixelPosMatrix,N,de)))}return V}loadMatchingFeature(c,f,_,A,x,T,B,U,j){const{featureIndex:R,bucketIndex:N,sourceLayerIndex:V,layoutVertexArrayOffset:z}=f,G=this.bucketLayerIDs[N];if(A&&!function(ce,he){for(let ne=0;ne<ce.length;ne++)if(he.indexOf(ce[ne])>=0)return!0;return!1}(A,G))return;const X=this.sourceLayerCoder.decode(V),K=this.vtLayers[X].feature(R);if(_.needGeometry){const ce=pn(K,!0);if(!_.filter(new ds(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!_.filter(new ds(this.tileID.overscaledZ),K))return;const te=this.getId(K,X);for(let ce=0;ce<G.length;ce++){const he=G[ce];if(A&&A.indexOf(he)<0)continue;const ne=T[he];if(!ne)continue;let de={};te!==void 0&&U&&(de=U.getState(ne.sourceLayer||"_geojsonTileLayer",te));const ge=!j||j(K,ne,de,z);if(!ge)continue;const Me=new OV(K,this.z,this.x,this.y,te),Be=Sr({},B[he]);Be.paint=NV(Be.paint,ne.paint,K,de,x),Be.layout=NV(Be.layout,ne.layout,K,de,x),Me.layer=Be,this.appendToResult(c,he,R,Me,ge)}}appendToResult(c,f,_,A,x){let T=c[f];T===void 0&&(T=c[f]=[]),T.push({featureIndex:_,feature:A,intersectionZ:x})}lookupSymbolFeatures(c,f,_,A,x,T,B,U){const j={};this.loadVTLayers();const R=rs(x);for(const N of c)this.loadMatchingFeature(j,{bucketIndex:_,sourceLayerIndex:A,featureIndex:N,layoutVertexArrayOffset:0},R,T,B,U,f);return j}loadFeature(c){const{featureIndex:f,sourceLayerIndex:_}=c;this.loadVTLayers();const A=this.sourceLayerCoder.decode(_),x=this.vtFeatures[A];if(x[f])return x[f];const T=this.vtLayers[A].feature(f);return x[f]=T,T}hasLayer(c){for(const f of this.bucketLayerIDs)for(const _ of f)if(c===_)return!0;return!1}getId(c,f){let _=c.id;if(this.promoteId){const A=typeof this.promoteId=="string"?this.promoteId:this.promoteId[f];A!=null&&(_=c.properties[A]),typeof _=="boolean"&&(_=Number(_))}return _}}function NV(g,c,f,_,A){return Nr(g,(x,T)=>{const B=c instanceof Qu?c.get(T):null;return B&&B.evaluate?B.evaluate(f,_,A):B})}function rde(g,c){return c-g}Fn(FV,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const zV=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class C4{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[f,_]=new Uint8Array(c,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");const A=_>>4;if(A!==1)throw new Error(`Got v${A} data when expected v1.`);const x=zV[15&_];if(!x)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(c,2,1),[B]=new Uint32Array(c,4,1);return new C4(B,T,x,c)}constructor(c,f=64,_=Float64Array,A){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=_,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const x=zV.indexOf(this.ArrayType),T=2*c*this.ArrayType.BYTES_PER_ELEMENT,B=c*this.IndexArrayType.BYTES_PER_ELEMENT,U=(8-B%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${_}.`);A&&A instanceof ArrayBuffer?(this.data=A,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+B+U,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+T+B+U),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+B+U,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=c)}add(c,f){const _=this._pos>>1;return this.ids[_]=_,this.coords[this._pos++]=c,this.coords[this._pos++]=f,_}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return E4(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,f,_,A){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:T,nodeSize:B}=this,U=[0,x.length-1,0],j=[];for(;U.length;){const R=U.pop()||0,N=U.pop()||0,V=U.pop()||0;if(N-V<=B){for(let K=V;K<=N;K++){const te=T[2*K],ce=T[2*K+1];te>=c&&te<=_&&ce>=f&&ce<=A&&j.push(x[K])}continue}const z=V+N>>1,G=T[2*z],X=T[2*z+1];G>=c&&G<=_&&X>=f&&X<=A&&j.push(x[z]),(R===0?c<=G:f<=X)&&(U.push(V),U.push(z-1),U.push(1-R)),(R===0?_>=G:A>=X)&&(U.push(z+1),U.push(N),U.push(1-R))}return j}within(c,f,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:x,nodeSize:T}=this,B=[0,A.length-1,0],U=[],j=_*_;for(;B.length;){const R=B.pop()||0,N=B.pop()||0,V=B.pop()||0;if(N-V<=T){for(let K=V;K<=N;K++)GV(x[2*K],x[2*K+1],c,f)<=j&&U.push(A[K]);continue}const z=V+N>>1,G=x[2*z],X=x[2*z+1];GV(G,X,c,f)<=j&&U.push(A[z]),(R===0?c-_<=G:f-_<=X)&&(B.push(V),B.push(z-1),B.push(1-R)),(R===0?c+_>=G:f+_>=X)&&(B.push(z+1),B.push(N),B.push(1-R))}return U}}function E4(g,c,f,_,A,x){if(A-_<=f)return;const T=_+A>>1;UV(g,c,T,_,A,x),E4(g,c,f,_,T-1,1-x),E4(g,c,f,T+1,A,1-x)}function UV(g,c,f,_,A,x){for(;A>_;){if(A-_>600){const j=A-_+1,R=f-_+1,N=Math.log(j),V=.5*Math.exp(2*N/3),z=.5*Math.sqrt(N*V*(j-V)/j)*(R-j/2<0?-1:1);UV(g,c,f,Math.max(_,Math.floor(f-R*V/j+z)),Math.min(A,Math.floor(f+(j-R)*V/j+z)),x)}const T=c[2*f+x];let B=_,U=A;for(p2(g,c,_,f),c[2*A+x]>T&&p2(g,c,_,A);B<U;){for(p2(g,c,B,U),B++,U--;c[2*B+x]<T;)B++;for(;c[2*U+x]>T;)U--}c[2*_+x]===T?p2(g,c,_,U):(U++,p2(g,c,U,A)),U<=f&&(_=U+1),f<=U&&(A=U-1)}}function p2(g,c,f,_){I4(g,f,_),I4(c,2*f,2*_),I4(c,2*f+1,2*_+1)}function I4(g,c,f){const _=g[c];g[c]=g[f],g[f]=_}function GV(g,c,f,_){const A=g-f,x=c-_;return A*A+x*x}o.$=Jp,o.A=class extends nC{},o.B=mu,o.C=hd,o.D=Bs,o.E=Vu,o.F=Rg,o.G=jp,o.H=Kv,o.I=J3,o.J=bd,o.K=di,o.L=e_,o.M=wd,o.N=Ml,o.O=ic,o.P=St,o.Q=Qh,o.R=Zi,o.S=Da,o.T=u4,o.U=Cp,o.V=nC,o.W=Ks,o.X=Wp,o.Y=Ig,o.Z=function(g){const c=g.value;let f=[];if(!c)return f;const _=mu(c);return _!=="string"?(f=f.concat([new nC(g.key,c,`string expected, "${_}" found`)]),f):(KG(c,!0)||(f=f.concat([new nC(g.key,c,`invalid url "${c}"`)])),f)},o._=At,o.a=function(g){return nt.API_CDN_URL_REGEX.test(g)},o.a$=a_,o.a0=ji,o.a1=gn,o.a2=class{constructor(g){this.specification=g}possiblyEvaluate(g,c){return En(g.expression.evaluate(c))}interpolate(g,c,f){return{x:cr(g.x,c.x,f),y:cr(g.y,c.y,f),z:cr(g.z,c.z,f),azimuthal:cr(g.azimuthal,c.azimuthal,f),polar:cr(g.polar,c.polar,f)}}},o.a3=ds,o.a4=fl,o.a5=xt,o.a6=Pe,o.a7=mr,o.a8=Qu,o.a9=Yg,o.aA=Yi,o.aB=NG,o.aC=jG,o.aD=FG,o.aE=function(g,c){const f=document.createElement("video");f.muted=!0,f.onloadstart=function(){c(null,f)};for(let _=0;_<g.length;_++){const A=document.createElement("source");fs(g[_])||(f.crossOrigin="Anonymous"),A.src=g[_],f.appendChild(A)}return{cancel:()=>{}}},o.aF=KM,o.aG=function(g){return fetch(g).then(c=>c.arrayBuffer()).then(c=>LV(c,0,g))},o.aH=BV,o.aI=class{constructor(g,c,f,_){this.id=g,this.position=c!=null?new ue(c[0],c[1]):new ue(0,0),this.orientation=f??[0,0,0],this.nodes=_,this.uploaded=!1,this.aabb=new Ki([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(g,c){if(Pe.mat4.multiply(g.matrix,c,g.matrix),g.meshes)for(const f of g.meshes){const _=Ki.applyTransformFast(f.aabb,g.matrix);this.aabb.encapsulate(_)}if(g.children)for(const f of g.children)this._applyTransformations(f,g.matrix)}computeBoundsAndApplyParent(){const g=Pe.mat4.identity([]);for(const c of this.nodes)this._applyTransformations(c,g)}computeModelMatrix(g,c,f,_,A,x,T=!1){nV(this.matrix,this,g.transform,this.position,c,f,_,A,x,T)}upload(g){if(!this.uploaded){for(const c of this.nodes)m4(c,g);for(const c of this.nodes)rC(c);this.uploaded=!0}}destroy(){for(const g of this.nodes)g4(g)}},o.aJ=Fr,o.aK=Qw,o.aL=We,o.aM=He,o.aN=Js,o.aO=wo,o.aP=ir,o.aQ=Hg,o.aR=ZM,o.aS=function(){Fa.isLoading()||Fa.isLoaded()||Og()!=="deferred"||Fg()},o.aT=rs,o.aU=pn,o.aV=OV,o.aW=Vr,o.aX=j3,o.aY=B3,o.aZ=fn,o.a_=cc,o.aa=cr,o.ab=yn,o.ac=ud,o.ad=class{constructor(g){this.specification=g}possiblyEvaluate(g,c){return function([f,_]){const A=En([1,f,_]);return{x:A.x,y:A.y,z:A.z}}(g.expression.evaluate(c))}interpolate(g,c,f){return{x:cr(g.x,c.x,f),y:cr(g.y,c.y,f),z:cr(g.z,c.z,f)}}},o.ae=function(g,c,f=0,_=!0){const A=new St(f,f),x=g.sub(A),T=c.add(A),B=[x,new St(T.x,x.y),T,new St(x.x,T.y)];return _&&B.push(x.clone()),B},o.af=function(g,c){const f=[];for(let _=0;_<g.length;_++){const A=Un(_-1,-1,g.length-1),x=Un(_+1,-1,g.length-1),T=g[_],B=g[x],U=g[A].sub(T).unit(),j=B.sub(T).unit(),R=j.angleWithSep(U.x,U.y),N=U.add(j).unit().mult(-1*c/Math.sin(R/2));f.push(T.add(N))}return f},o.ag=SG,o.ah=Wc,o.ai=function(g,c,f=0){return Pe.vec3.fromValues(((c.x-f)*g.scale-g.x)*yn,(c.y*g.scale-g.y)*yn,et(c.z,c.y))},o.aj=vf,o.ak=H7,o.al=function(g){let c=1/0,f=1/0,_=-1/0,A=-1/0;for(const x of g)c=Math.min(c,x.x),f=Math.min(f,x.y),_=Math.max(_,x.x),A=Math.max(A,x.y);return{min:new St(c,f),max:new St(_,A)}},o.am=ke,o.an=is,o.ao=Zt,o.ap=jt,o.aq=u,o.ar=function(g,c){const f={};for(let _=0;_<c.length;_++){const A=c[_];A in g&&(f[A]=g[A])}return f},o.as=ve,o.at=Ne,o.au=class{constructor(g){this.entries={},this.scheduler=g}request(g,c,f,_){const A=this.entries[g]=this.entries[g]||{callbacks:[]};if(A.result){const[x,T]=A.result;return this.scheduler?this.scheduler.add(()=>{_(x,T)},c):_(x,T),()=>{}}return A.callbacks.push(_),A.cancel||(A.cancel=f((x,T)=>{A.result=[x,T];for(const B of A.callbacks)this.scheduler?this.scheduler.add(()=>{B(x,T)},c):B(x,T);setTimeout(()=>delete this.entries[g],3e3)})),()=>{A.result||(A.callbacks=A.callbacks.filter(x=>x!==_),A.callbacks.length||(A.cancel(),delete this.entries[g]))}}},o.av=df,o.aw=function(g,c,f){const _=JSON.stringify(g.request);return g.data&&(this.deduped.entries[_]={result:[null,g.data]}),this.deduped.request(_,{type:"parseTile",isSymbolTile:g.isSymbolTile,zoom:g.tileZoom},A=>{const x=Ls(g.request,(T,B,U,j)=>{T?A(T):B&&A(null,{vectorTile:f?void 0:new H1.VectorTile(new FM(B)),rawData:B,cacheControl:U,expires:j})});return()=>{x.cancel(),A()}},c)},o.ax=function(g){gr++,gr>It&&(g.getActor().send("enforceCacheSizeLimit",Ct),gr=0)},o.ay=Mn,o.az=function(g){return g<=1?1:Math.pow(2,Math.floor(Math.log(g)/Math.LN2))},o.b=function(g){return nt.API_FONTS_REGEX.test(g)},o.b$=function(g){const{x:c,y:f}=g.point,{lng:_,lat:A}=g._center;return k9(c,f,g.worldSize,_,A)},o.b0=$c,o.b1=bs,o.b2=zw,o.b3=a4,o.b4=function(g,c){const f=Yg(c.zoom);if(f===0)return Nd(g);const _=SM(g),A=T3(_),x=ke(_.getWest())*c.worldSize,T=ke(_.getEast())*c.worldSize,B=Ne(_.getNorth())*c.worldSize,U=Ne(_.getSouth())*c.worldSize,j=[x,B,0],R=[T,B,0],N=[x,U,0],V=[T,U,0],z=Pe.mat4.invert([],c.globeMatrix);return Pe.vec3.transformMat4(j,j,z),Pe.vec3.transformMat4(R,R,z),Pe.vec3.transformMat4(N,N,z),Pe.vec3.transformMat4(V,V,z),A[0]=om(A[0],N,f),A[1]=om(A[1],V,f),A[2]=om(A[2],R,f),A[3]=om(A[3],j,f),Ki.fromPoints(A)},o.b5=TM,o.b6=Fw,o.b7=om,o.b8=pf,o.b9=Pl,o.bA=Un,o.bB=sn,o.bC=hi,o.bD=De,o.bE=function(g,c,f){g[4*c+0]=f[0],g[4*c+1]=f[1],g[4*c+2]=f[2],g[4*c+3]=f[3]},o.bF=Wn,o.bG=pe,o.bH=Te,o.bI=ie,o.bJ=Y,o.bK=ue,o.bL=EG,o.bM=No,o.bN=Zg,o.bO=XG,o.bP=Ko,o.bQ=L9,o.bR=function(g,c,f,_,A,x,T,B,U){if(U.name==="globe")return L9(g,c,new Ko(f,_,A),!1);const j=Qw({z:f,x:_,y:A},U);return new Ki([(x+j.x/j.scale)*c,c*(j.y/j.scale),T],[(x+j.x2/j.scale)*c,c*(j.y2/j.scale),B])},o.bS=function(g,c,f){let _=0;for(let A=0;A<2;++A)g[A]>0&&(_+=(g[A]-0)*(g[A]-0)),c[A]<0&&(_+=(0-c[A])*(0-c[A]));return _},o.bT=Ke,o.bU=w,o.bV=function(g){const c=Pe.mat4.identity(new Float64Array(16));Pe.mat4.multiply(c,g.pixelMatrix,g.globeMatrix);const f=[0,W,0],_=[0,$,0];return Pe.vec3.transformMat4(f,f,c),Pe.vec3.transformMat4(_,_,c),[f[0]>0&&f[0]<=g.width&&f[1]>0&&f[1]<=g.height&&!E3(g,new ue(g.center.lat,90)),_[0]>0&&_[0]<=g.width&&_[1]>0&&_[1]<=g.height&&!E3(g,new ue(g.center.lat,-90))]},o.bW=function(g,c){const{scale:f}=g.tileTransform,_=f*yn/(g.tileSize*Math.pow(2,c.zoom-g.tileID.overscaledZ+g.tileID.canonical.z));return Pe.mat2.scale(new Float32Array(4),c.inverseAdjustmentMatrix,[_,_])},o.bX=eC,o.bY=WG,o.bZ=function(g){const c=WG(g,!0);return Pe.mat2.invert([],[c[0],c[1],c[4],c[5]])},o.b_=Fd,o.ba=b4,o.bb=FM,o.bc=Ls,o.bd=function(g){const c=[];for(const f in g)c.push(g[f]);return c},o.be=function(g,c){const f=[];for(const _ in g)_ in c||f.push(_);return f},o.bf=tr,o.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bh=Jt,o.bi=function(g,c){const{x:f,y:_}=g.point,A=k9(f,_,g.worldSize/g._pixelsPerMercatorPixel,0,0);return Pe.mat4.multiply(A,A,M3(Nd(c)))},o.bj=j1,o.bk=Tu,o.bl=OM,o.bm=function(g,c,f,_,A){const x=5*c+2;g.float32[x+0]=f,g.float32[x+1]=_,g.float32[x+2]=A},o.bn=qM,o.bo=fG,o.bp=xn,o.bq=Na,o.br=p7,o.bs=YG,o.bt=y7,o.bu=x7,o.bv=t4,o.bw=yG,o.bx=K3,o.by=C4,o.bz=vr,o.c=pt,o.c$=ml,o.c0=at,o.c1=pl,o.c2=p,o.c3=function(g){const c=Math.round((g+45+360)%360/90)%4;return Ue[c]},o.c4=45,o.c5=we,o.c6=dt,o.c7=function(g,c,f){const _=Math.sqrt(g*g+c*c+f*f),A=_>0?Math.acos(f/_)*Gn:0;let x=g!==0||c!==0?Math.atan2(-c,-g)*Gn+90:0;return x<0&&(x+=360),[_,x,A]},o.c8=rt,o.c9=Ki,o.cA=function(g){const c=Ke-5;g=jt(g,-c,c)/c*90;const f=Math.pow(Math.abs(Math.sin(sn(g))),3);return Math.round(f*(F.length-1))},o.cB=function(g,c,f,_){const A=c.getNorth(),x=c.getSouth(),T=c.getWest(),B=c.getEast(),U=1<<g.z,j=B-T,R=A-x,N=j/P,V=-R/F[f],z=[0,N,0,V,0,0,A,T,0];if(g.z>0){const G=180/_;Pe.mat3.multiply(z,z,[G/j+1,0,0,0,G/R+1,0,-.5*G/N,.5*G/V,1])}return z[2]=U,z[5]=g.x,z[8]=g.y,z},o.cC=Nd,o.cD=function(g,c,f){const _=Pe.mat4.identity(new Float64Array(16)),A=(c/(1<<g)-.5)*Math.PI*2;return Pe.mat4.rotateY(_,f.globeMatrix,A),Float32Array.from(_)},o.cE=class{isDataAvailableAtPoint(g){const c=this._source();if(this.isUsingMockSource()||!c||g.y<0||g.y>1)return!1;const f=c.getSource().maxzoom,_=1<<f,A=Math.floor(g.x),x=Math.floor((g.x-A)*_),T=Math.floor(g.y*_),B=this.findDEMTileFor(new Yi(f,A,f,x,T));return!(!B||!B.dem)}getAtPointOrZero(g,c=0){return this.getAtPoint(g,c)||0}getAtPoint(g,c,f=!0){if(this.isUsingMockSource())return null;c==null&&(c=null);const _=this._source();if(!_||g.y<0||g.y>1)return c;const A=_.getSource().maxzoom,x=1<<A,T=Math.floor(g.x),B=g.x-T,U=new Yi(A,T,A,Math.floor(B*x),Math.floor(g.y*x)),j=this.findDEMTileFor(U);if(!j||!j.dem)return c;const R=j.dem,N=1<<j.tileID.canonical.z,V=(B*N-j.tileID.canonical.x)*R.dim,z=(g.y*N-j.tileID.canonical.y)*R.dim,G=Math.floor(V),X=Math.floor(z);return(f?this.exaggeration():1)*cr(cr(R.get(G,X),R.get(G,X+1),z-X),cr(R.get(G+1,X),R.get(G+1,X+1),z-X),V-G)}getAtTileOffset(g,c,f){const _=1<<g.canonical.z;return this.getAtPointOrZero(new xt(g.wrap+(g.canonical.x+c/yn)/_,(g.canonical.y+f/yn)/_))}getAtTileOffsetFunc(g,c,f,_){return A=>{const x=this.getAtTileOffset(g,A.x,A.y),T=_.upVector(g.canonical,A.x,A.y),B=_.upVectorScale(g.canonical,c,f).metersToTile;return Pe.vec3.scale(T,T,x*B),T}}getForTilePoints(g,c,f,_){if(this.isUsingMockSource())return!1;const A=Y1.create(this,g,_);return!!A&&(c.forEach(x=>{x[2]=this.exaggeration()*A.getElevationAt(x[0],x[1],f)}),!0)}getMinMaxForTile(g){if(this.isUsingMockSource())return null;const c=this.findDEMTileFor(g);if(!c||!c.dem)return null;const f=c.dem.tree,_=c.tileID,A=1<<g.canonical.z-_.canonical.z;let x=g.canonical.x/A-_.canonical.x,T=g.canonical.y/A-_.canonical.y,B=0;for(let U=0;U<g.canonical.z-_.canonical.z&&!f.leaves[B];U++){x*=2,T*=2;const j=2*Math.floor(T)+Math.floor(x);B=f.childOffsets[B]+j,x%=1,T%=1}return{min:this.exaggeration()*f.minimums[B],max:this.exaggeration()*f.maximums[B]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(g,c,f){throw new Error("Pure virtual method called.")}pointCoordinate(g){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(g){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const g=this.visibleDemTiles;if(g.length===0)return null;let c=!1,f=Number.MAX_VALUE,_=Number.MIN_VALUE;for(const A of g){const x=this.getMinMaxForTile(A.tileID);x&&(f=Math.min(f,x.min),_=Math.max(_,x.max),c=!0)}return c?{min:f,max:_}:null}},o.cF=q9,o.cG=sm,o.cH=function(g,c){return[Math.pow(g[0],2.2)*c,Math.pow(g[1],2.2)*c,Math.pow(g[2],2.2)*c]},o.cI=B9,o.cJ=Xe,o.cK=Ee,o.cL=256,o.cM=function(g,c){const f=[0,0,0],_=TM(Nd(c.canonical));return Pe.vec3.transformMat4(f,f,_),Pe.vec3.transformMat4(f,f,g),f},o.cN=g=>({u_camera_to_center_distance:new ie(g),u_extrude_scale:new zr(g),u_device_pixel_ratio:new ie(g),u_matrix:new Wn(g),u_inv_rot_matrix:new Wn(g),u_merc_center:new pe(g),u_tile_id:new Te(g),u_zoom_transition:new ie(g),u_up_dir:new Te(g),u_emissive_strength:new ie(g)}),o.cO=g=>({u_matrix:new Wn(g),u_pixels_to_tile_units:new zr(g),u_device_pixel_ratio:new ie(g),u_units_to_pixels:new pe(g),u_dash_image:new Y(g),u_gradient_image:new Y(g),u_image_height:new ie(g),u_texsize:new pe(g),u_tile_units_to_pixels:new ie(g),u_alpha_discard_threshold:new ie(g),u_trim_offset:new pe(g),u_trim_fade_range:new pe(g),u_trim_color:new dt(g),u_emissive_strength:new ie(g)}),o.cP=g=>({u_matrix:new Wn(g),u_texsize:new pe(g),u_pixels_to_tile_units:new zr(g),u_device_pixel_ratio:new ie(g),u_image:new Y(g),u_units_to_pixels:new pe(g),u_tile_units_to_pixels:new ie(g),u_alpha_discard_threshold:new ie(g),u_trim_offset:new pe(g)}),o.cQ=xa,o.cR=The,o.cS=Mhe,o.cT=N9,o.cU=(g,c,f,_,A,x)=>{const T=g.transform,B=T.projection.name==="globe";let U;if(x.paint.get("circle-pitch-alignment")==="map")if(B){const R=B9(T.zoom,c.canonical)*T._pixelsPerMercatorPixel;U=Float32Array.from([R,0,0,R])}else U=T.calculatePixelsToTileUnitsMatrix(f);else U=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const j={u_camera_to_center_distance:g.transform.getCameraToCenterDistance(T.projection),u_matrix:g.translatePosMatrix(c.projMatrix,f,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Cn.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:Iue,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:x.paint.get("circle-emissive-strength")};if(B){j.u_inv_rot_matrix=_,j.u_merc_center=A,j.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],j.u_zoom_transition=Yg(T.zoom);const R=A[0]*yn,N=A[1]*yn;j.u_up_dir=T.projection.upVector(new Ko(0,0,0),R,N)}return j},o.cV=X7,o.cW=(g,c,f,_,A,x)=>{const T=g.transform;return{u_matrix:W7(g,c,f,_),u_texsize:c.imageAtlasTexture?c.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:A,u_image:0,u_tile_units_to_pixels:j7(c,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x}},o.cX=(g,c,f,_,A,x,T)=>{const B=g.transform,U=B.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:W7(g,c,f,_),u_pixels_to_tile_units:U,u_device_pixel_ratio:x,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:A,u_texsize:$7(f)&&c.lineAtlasTexture?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:j7(c,g.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:f.paint.get("line-trim-fade-range"),u_trim_color:f.paint.get("line-trim-color").toRenderColor(f.lut).toArray01(),u_emissive_strength:f.paint.get("line-emissive-strength")}},o.cY=ui,o.cZ=Nw,o.c_=D7,o.ca=En,o.cb=function(g){return[Math.pow(g[0],1/2.2),Math.pow(g[1],1/2.2),Math.pow(g[2],1/2.2)]},o.cc=function(g){return g({pluginStatus:lo,pluginURL:oc}),kg.on("pluginStateChange",g),g},o.cd=K1,o.ce=oC,o.cf=X1,o.cg=Q3,o.ch=_s,o.ci=k1,o.cj=yt,o.ck=$o,o.cl=yi,o.cm=function(g){const c=g.indexOf(th);return c>=0?g.slice(0,c):g},o.cn=function(g){return g.indexOf(th)>=0},o.co=function(g){const c=g.indexOf(th);return c>=0?g.slice(c+1):""},o.cp=function(g){const c=[],f=g.id;return f===void 0&&c.push({message:`layers.${f}: missing required property "id"`}),g.render===void 0&&c.push({message:`layers.${f}: missing required method "render"`}),g.renderingMode&&g.renderingMode!=="2d"&&g.renderingMode!=="3d"&&c.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),c},o.cq=function(g,c,f,_){return g.type==="custom"?new rfe(g,c):new pfe[g.type](g,c,f,_)},o.cr=Hr,o.cs=kg,o.ct=Xo,o.cu=Ot,o.cv=class extends O{constructor(g){super(g),this.current=br}set(g,c,f){if(this.fetchUniformLocation(g,c)){for(let _=0;_<9;_++)if(f[_]!==this.current[_]){this.current=f,this.gl.uniformMatrix3fv(this.location,!1,f);break}}}},o.cw=$t,o.cx=function(g,c,f){const _=Yg(f.zoom),A=g.style.map._antialias,x=c.options.extStandardDerivativesForceOff||g.terrain&&g.terrain.exaggeration()>0;return _===0&&!A&&!x},o.cy=function(g){const c=g.pixelsPerMeter,f=c/De(1,g.center.lat),_=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.translate(_,_,[g.point.x,g.point.y,0]),Pe.mat4.scale(_,_,[f,f,c]),Float32Array.from(_)},o.cz=SM,o.d=function(g){return nt.API_TILEJSON_REGEX.test(g)},o.d$=h,o.d0=kM,o.d1=Jg,o.d2=450,o.d3=7,o.d4=nfe,o.d5=Qr,o.d6=Vg,o.d7=256,o.d8=M3,o.d9=co,o.dA=O9,o.dB=function(g){const c=[0,0,0],f=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.multiply(f,g.pixelMatrix,g.globeMatrix),Pe.vec3.transformMat4(c,c,f),new St(c[0],c[1])},o.dC=function(g,c,f=!1){if(lo===Md||lo===af||lo===Cd)throw new Error("setRTLTextPlugin cannot be called multiple times.");oc=Cn.resolveURL(g),lo=Md,lf=c,n_(),f||Fg()},o.dD=Og,o.dE=function(){oC().acquire(w4)},o.dF=function(){const g=h2;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(w4),h2=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=u2,o.dH=function(g){const c=Xn();if(!c)return;const f=c.delete(Mt);g&&f.catch(g).then(()=>g())},o.dI=c2,o.dJ=TV,o.dK=function(g){S4=Cn.resolveURL(g),ex||(ex=new K1(oC(),new Vu)),ex.broadcast("setDracoUrl",S4)},o.dL=MV,o.dM=function(g){Q1=Cn.resolveURL(g),ex||(ex=new K1(oC(),new Vu)),ex.broadcast("setMeshoptUrl",Q1)},o.dN=Fn,o.dO=Kg,o.dP=yf,o.dQ=kV,o.dR=FV,o.dS=z7,o.dT=Nr,o.dU=pG,o.dV=function(g,c,f,_,A,x,T,B,U,j,R){g.createArrays(),g.tilePixelRatio=yn/(512*g.overscaling),g.compareText={},g.iconsNeedLinear=!1;const N=g.layers[0].layout,V=g.layers[0]._unevaluatedLayout._values,z={};if(g.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=g.textSizeData;z.compositeTextSizes=[V["text-size"].possiblyEvaluate(new ds(te),B),V["text-size"].possiblyEvaluate(new ds(ce),B)]}if(g.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=g.iconSizeData;z.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new ds(te),B),V["icon-size"].possiblyEvaluate(new ds(ce),B)]}z.layoutTextSize=V["text-size"].possiblyEvaluate(new ds(U+1),B),z.layoutIconSize=V["icon-size"].possiblyEvaluate(new ds(U+1),B),z.textMaxSize=V["text-size"].possiblyEvaluate(new ds(18),B);const G=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",X=N.get("text-size");let K=!1;for(const te of g.features)if(te.icon&&te.icon.nameSecondary){K=!0;break}for(const te of g.features){const ce=N.get("text-font").evaluate(te,{},B).join(","),he=X.evaluate(te,{},B),ne=z.layoutTextSize.evaluate(te,{},B),de=(z.layoutIconSize.evaluate(te,{},B),{horizontal:{},vertical:void 0}),ge=te.text;let Me,Be=[0,0];if(ge){const Ye=ge.toString(),ze=N.get("text-letter-spacing").evaluate(te,{},B)*Na,Qe=N.get("text-line-height").evaluate(te,{},B)*Na,ct=Yp(Ye)?ze:0,ht=N.get("text-anchor").evaluate(te,{},B),ft=N.get("text-variable-anchor");if(!ft){const Yt=N.get("text-radial-offset").evaluate(te,{},B);Be=Yt?yG(ht,[Yt*Na,e4]):N.get("text-offset").evaluate(te,{},B).map(Dt=>Dt*Na)}let mt=G?"center":N.get("text-justify").evaluate(te,{},B);const Et=N.get("symbol-placement")==="point",vt=Et?N.get("text-max-width").evaluate(te,{},B)*Na:1/0,Ut=Yt=>{g.allowVerticalPlacement&&Gc(Ye)&&(de.vertical=Y3(ge,c,f,A,ce,vt,Qe,ht,Yt,ct,Be,Tu.vertical,!0,ne,he))};if(!G&&ft){const Yt=mt==="auto"?ft.map(Rn=>t4(Rn)):[mt];let Dt=!1;for(let Rn=0;Rn<Yt.length;Rn++){const bn=Yt[Rn];if(!de.horizontal[bn])if(Dt)de.horizontal[bn]=de.horizontal[0];else{const dn=Y3(ge,c,f,A,ce,vt,Qe,"center",bn,ct,Be,Tu.horizontal,!1,ne,he);dn&&(de.horizontal[bn]=dn,Dt=dn.positionedLines.length===1)}}Ut("left")}else{if(mt==="auto"&&(mt=t4(ht)),Et||N.get("text-writing-mode").indexOf("horizontal")>=0||!Gc(Ye)){const Yt=Y3(ge,c,f,A,ce,vt,Qe,ht,mt,ct,Be,Tu.horizontal,!1,ne,he);Yt&&(de.horizontal[mt]=Yt)}Ut(Et?"left":mt)}}let Oe=!1;if(te.icon&&te.icon.namePrimary){const Ye=_[te.icon.namePrimary];Ye&&(Me=Ohe(A[te.icon.namePrimary],te.icon.nameSecondary?A[te.icon.nameSecondary]:void 0,N.get("icon-offset").evaluate(te,{},B),N.get("icon-anchor").evaluate(te,{},B)),Oe=Ye.sdf,g.sdfIcons===void 0?g.sdfIcons=Ye.sdf:g.sdfIcons!==Ye.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ye.pixelRatio!==g.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(g.iconsNeedLinear=!0))}const Re=bG(de.horizontal)||de.vertical;g.iconsInText||(g.iconsInText=!!Re&&Re.iconsInText),(Re||Me)&&Hhe(g,te,de,Me,_,z,ne,0,Be,Oe,T,B,j,R,K)}x&&g.generateCollisionDebugBuffers(U,g.collisionBoxArray)},o.dW=H1,o.dX=sC,o.dY=cn,o.dZ=u7,o.d_=Q7,o.da=jc,o.db=Gg,o.dc=function(g,c,f,_,A){return jt((g-c)/(f-c)*(A-_)+_,_,A)},o.dd=Yu,o.de=ut,o.df=class{constructor(g,c,f,_){this.context=g,this.format=_,this.size=f,this.texture=g.gl.createTexture();const[A,x,T]=this.size,{gl:B}=g;B.bindTexture(B.TEXTURE_3D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(!1),B.texImage3D(B.TEXTURE_3D,0,this.format,A,x,T,0,l4(this.format),c4(this.format),c.data)}bind(g,c){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_3D,this.texture),g!==this.minFilter&&(_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MAG_FILTER,g),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MIN_FILTER,g),this.minFilter=g),c!==this.wrapS&&(_.texParameteri(_.TEXTURE_3D,_.TEXTURE_WRAP_S,c),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_WRAP_T,c),this.wrapS=c)}destroy(){const{gl:g}=this.context;g.deleteTexture(this.texture),this.texture=null}},o.dg=d4,o.dh=[1,1,1],o.di=Y1,o.dj=Z1,o.dk=Su,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new St(1/0,1/0),max:new St(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(g,c=!1){const f=g7(new St(0,0),new St(yn,yn),g),_=[];if(c&&!z3(f,this._globalClipBounds))return _;for(const A of this._activeRegions){if(A.hiddenByOverlap||!z3(f,A))continue;const x=Jue(A.min,A.max,g);_.push({min:x.min,max:x.max,sourceId:this._sourceIds[A.priority],footprint:A.footprint,footprintTileId:A.tileId,order:A.order,clipMask:A.clipMask,clipScope:A.clipScope})}return _}setSources(g){this._setSources(g.map(c=>({getSourceId:()=>c.cache.id,getFootprints:()=>{const f=[];for(const _ of c.cache.getVisibleCoordinates()){const A=c.cache.getTile(_).buckets[c.layer];A&&A.updateFootprints(_.toUnwrapped(),f)}return f},getOrder:()=>c.order,getClipMask:()=>c.clipMask,getClipScope:()=>c.clipScope})))}_addSource(g){const c=g.getFootprints();if(c.length===0)return;const f=g.getOrder(),_=g.getClipMask(),A=g.getClipScope();for(const x of c){if(!x.footprint)continue;const T=g7(x.footprint.min,x.footprint.max,x.id);this._activeRegions.push({min:T.min,max:T.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:x.id,footprint:x.footprint,order:f,clipMask:_,clipScope:A})}this._sourceIds.push(g.getSourceId())}_computeReplacement(){this._activeRegions.sort((c,f)=>c.priority-f.priority||DM(c.min,f.min)||DM(c.max,f.max)||c.order-f.order||c.clipMask-f.clipMask||function(_,A){const x=(T,B)=>T+B;return _.length-A.length||_.reduce(x,"").localeCompare(A.reduce(x,""))}(c.clipScope,f.clipScope));let g=this._activeRegions.length!==this._prevRegions.length;if(!g){let c=0;for(;!g&&c!==this._activeRegions.length;){const f=this._activeRegions[c],_=this._prevRegions[c];g=f.priority!==_.priority||!m7(f,_)||f.order!==_.order||f.clipMask!==_.clipMask||!Jt(f.clipScope,_.clipScope),++c}}if(g){++this._updateTime;for(const f of this._activeRegions)f.order!==LM&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,f.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,f.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,f.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,f.max.y));const c=f=>{const _=this._activeRegions;if(f>=_.length)return f;const A=_[f].priority;for(;f<_.length&&_[f].priority===A;)++f;return f};if(this._sourceIds.length>1){let f=0,_=c(f);for(;f!==_;){let A=f;const x=f;for(;A!==_;){const T=this._activeRegions[A];T.hiddenByOverlap=!1;for(let B=0;B<x;B++){const U=this._activeRegions[B];if(!U.hiddenByOverlap&&T.order===LM&&z3(T,U)&&(T.hiddenByOverlap=_7(T.footprint,T.tileId,U.footprint,U.tileId),T.hiddenByOverlap))break}++A}f=_,_=c(f)}}}}_setSources(g){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let c=g.length-1;c>=0;c--)this._addSource(g[c]);this._computeReplacement()}},o.dm=class{constructor(g){this._createGrid(g),this._createPoles(g)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const g of this._poleSegments)g.destroy();for(const g of this._gridSegments)g.withSkirts.destroy(),g.withoutSkirts.destroy()}_fillGridMeshWithLods(g,c){const f=new cc,_=new wo,A=[],x=g+1+2,T=c[0]+1,B=c[0]+1+(1+c.length),U=(j,R,N)=>{let V=j===x-1?j-2:j===0?j:j-1;return V+=N?24575:0,[V,R]};for(let j=0;j<x;++j)f.emplaceBack(...U(j,0,!0));for(let j=0;j<T;++j)for(let R=0;R<x;++R)f.emplaceBack(...U(R,j,(R===0||R===x-1)&&!0));for(let j=0;j<c.length;++j){const R=c[j];for(let N=0;N<x;++N)f.emplaceBack(...U(N,R,!0))}for(let j=0;j<c.length;++j){const R=_.length,N=c[j]+1+2,V=new wo;for(let X=0;X<N-1;X++){const K=X===N-2,te=K?x*(B-c.length+j-X):x;for(let ce=0;ce<x-1;ce++){const he=X*x+ce;X===0||K||ce===0||ce===x-2?(V.emplaceBack(he+1,he,he+te),V.emplaceBack(he+te,he+te+1,he+1)):(_.emplaceBack(he+1,he,he+te),_.emplaceBack(he+te,he+te+1,he+1))}}const z=bs.simpleSegment(0,R,f.length,_.length-R);for(let X=0;X<V.uint16.length;X+=3)_.emplaceBack(V.uint16[X],V.uint16[X+1],V.uint16[X+2]);const G=bs.simpleSegment(0,R,f.length,_.length-R);A.push({withoutSkirts:z,withSkirts:G})}return{vertices:f,indices:_,segments:A}}_createGrid(g){const c=this._fillGridMeshWithLods(P,F);this._gridSegments=c.segments,this._gridBuffer=g.createVertexBuffer(c.vertices,$c.members),this._gridIndexBuffer=g.createIndexBuffer(c.indices,!0)}_createPoles(g){const c=new wo;for(let T=0;T<=P;T++)c.emplaceBack(0,T+1,T+2);this._poleIndexBuffer=g.createIndexBuffer(c,!0);const f=new jc,_=new jc,A=new jc,x=new jc;this._poleSegments=[];for(let T=0,B=0;T<p;T++){const U=360/(1<<T);f.emplaceBack(0,-u,0,.5,0),_.emplaceBack(0,-u,0,.5,1),A.emplaceBack(0,-u,0,.5,.5),x.emplaceBack(0,-u,0,.5,.5);for(let j=0;j<=P;j++){let R=j/P,N=0;const V=cr(0,U,R),[z,G,X]=J(Cue,Eue,V,u);f.emplaceBack(z,G,X,R,N),_.emplaceBack(z,G,X,R,1-N);const K=sn(V);R=.5+.5*Math.sin(K),N=.5+.5*Math.cos(K),A.emplaceBack(z,G,X,R,N),x.emplaceBack(z,G,X,R,1-N)}this._poleSegments.push(bs.simpleSegment(B,0,66,64)),B+=66}this._poleNorthVertexBuffer=g.createVertexBuffer(f,dc,!1),this._poleSouthVertexBuffer=g.createVertexBuffer(_,dc,!1),this._texturedPoleNorthVertexBuffer=g.createVertexBuffer(A,dc,!1),this._texturedPoleSouthVertexBuffer=g.createVertexBuffer(x,dc,!1)}getGridBuffers(g,c){return[this._gridBuffer,this._gridIndexBuffer,c?this._gridSegments[g].withSkirts:this._gridSegments[g].withoutSkirts]}getPoleBuffers(g,c){return[c?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,c?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[g]]}},o.dn=LM,o.dp=An,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=Sn,o.ds=st,o.dt=Q,o.du=function([g,c,f]){const _=Math.hypot(g,c,f),A=Math.atan2(g,f),x=.5*Math.PI-Math.acos(-c/_);return new ue(at(A),at(x))},o.dv=f4,o.dw=oe,o.dx=function(g){const c=g.navigator?g.navigator.userAgent:null;return!!function(f){if(Ps==null){const _=f.navigator?f.navigator.userAgent:null;Ps=!!f.safari||!(!_||!(/\b(iPad|iPhone|iPod)\b/.test(_)||_.match("Safari")&&!_.match("Chrome")))}return Ps}(g)&&c&&(c.match("Version/15.4")||c.match("Version/15.5")||c.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(g,c){Ct=g,It=c},o.dz=E3,o.e=nt,o.e0=function(g){let c=0;if(new Uint32Array(g,0,1)[0]!==EV){const f=new Uint32Array(g,0,7),[,,_,A,x,T]=f;c=f.byteLength+A+x+T+x,(_!==g.byteLength||c>=g.byteLength)&&Lt("Invalid b3dm header information.")}return LV(g,c)},o.e1=function(g,c){const f=BV(g);for(const _ of f){for(const A of _.meshes)ede(A);_.lights&&(_.lightMeshIndex=_.meshes.length,_.meshes.push(tde(_.lights,c)))}return f},o.e2=iC,o.e3=lV,o.e4=Fa,o.e5=function(g){lr(),_n!=null&&_n.then(c=>{c.keys().then(f=>{for(let _=0;_<f.length-g;_++)c.delete(f[_])})})},o.f=function(g){return g.indexOf("mapbox:")===0},o.g=function(g,c){return Xo(Sr(g,{method:"GET"}),c)},o.h=Je,o.i=function(g){return nt.API_STYLE_REGEX.test(g)&&!pt(g)},o.j=function(g){return decodeURIComponent(atob(g).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(g){return btoa(encodeURIComponent(g).replace(/%([0-9A-F]{2})/g,(c,f)=>String.fromCharCode(+("0x"+f))))},o.l=Sr,o.m=dr,o.n=function(g,c){return Xo(Sr(g,{type:"json"}),c)},o.o=As,o.p=function(g,c){return Xo(Sr(g,{method:"POST"}),c)},o.q=Cn,o.r=gl,o.s=function(g){try{const c=self[g];return c.setItem("_mapbox_test_",1),c.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=Tp,o.u=function(){return function g(c){return c?(c^Math.random()*(16>>c/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,g)}()},o.v=function(g){return!!g&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(g)},o.w=Lt,o.x=Kl,o.y=2,o.z=dG}),a(["./shared"],function(o){function h(Tt){const xe=Tt?Tt.url.toString():void 0;return xe?performance.getEntriesByName(xe):[]}function d(Tt){if(typeof Tt=="number"||typeof Tt=="boolean"||typeof Tt=="string"||Tt==null)return JSON.stringify(Tt);if(Array.isArray(Tt)){let Ee="[";for(const Xe of Tt)Ee+=`${d(Xe)},`;return`${Ee}]`}let xe="{";for(const Ee of Object.keys(Tt).sort())xe+=`${Ee}:${d(Tt[Ee])},`;return`${xe}}`}function m(Tt){let xe="";for(const Ee of o.bg)xe+=`/${d(Tt[Ee])}`;return xe}class v{constructor(xe){this.keyCache={},this._layers={},this._layerConfigs={},xe&&this.replace(xe)}replace(xe,Ee){this._layerConfigs={},this._layers={},this.update(xe,[],Ee)}update(xe,Ee,Xe){this._options=Xe;for(const Je of xe)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=o.cq(Je,this.scope,null,this._options)).compileFilter(Xe),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of Ee)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const nt=function(Je,pt){const Rt={};for(let Pt=0;Pt<Je.length;Pt++){const zt=pt&&pt[Je[Pt].id]||m(Je[Pt]);pt&&(pt[Je[Pt].id]=zt);let Bt=Rt[zt];Bt||(Bt=Rt[zt]=[]),Bt.push(Je[Pt])}const gt=[];for(const Pt in Rt)gt.push(Rt[Pt]);return gt}(o.bd(this._layerConfigs),this.keyCache);for(const Je of nt){const pt=Je.map(ln=>this._layers[ln.id]),Rt=pt[0];if(Rt.visibility==="none")continue;const gt=Rt.source||"";let Pt=this.familiesBySource[gt];Pt||(Pt=this.familiesBySource[gt]={});const zt=Rt.sourceLayer||"_geojsonTileLayer";let Bt=Pt[zt];Bt||(Bt=Pt[zt]=[]),Bt.push(pt)}}}const y=1*o.dP;class S{constructor(xe){const Ee={},Xe=[];for(const Rt in xe){const gt=xe[Rt],Pt=Ee[Rt]={};for(const zt in gt.glyphs){const Bt=gt.glyphs[+zt];if(!Bt||Bt.bitmap.width===0||Bt.bitmap.height===0)continue;const ln=Bt.metrics.localGlyph?y:1,Mn={x:0,y:0,w:Bt.bitmap.width+2*ln,h:Bt.bitmap.height+2*ln};Xe.push(Mn),Pt[zt]=Mn}}const{w:nt,h:Je}=o.z(Xe),pt=new o.dO({width:nt||1,height:Je||1});for(const Rt in xe){const gt=xe[Rt];for(const Pt in gt.glyphs){const zt=gt.glyphs[+Pt];if(!zt||zt.bitmap.width===0||zt.bitmap.height===0)continue;const Bt=Ee[Rt][Pt],ln=zt.metrics.localGlyph?y:1;o.dO.copy(zt.bitmap,pt,{x:0,y:0},{x:Bt.x+ln,y:Bt.y+ln},zt.bitmap)}}this.image=pt,this.positions=Ee}}o.dN(S,"GlyphAtlas");class E{constructor(xe){this.tileID=new o.aA(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),this.tileZoom=xe.tileZoom,this.uid=xe.uid,this.zoom=xe.zoom,this.lut=xe.lut,this.canonical=xe.tileID.canonical,this.pixelRatio=xe.pixelRatio,this.tileSize=xe.tileSize,this.source=xe.source,this.scope=xe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=xe.showCollisionBoxes,this.collectResourceTiming=!!xe.collectResourceTiming,this.promoteId=xe.promoteId,this.isSymbolTile=xe.isSymbolTile,this.tileTransform=o.aK(xe.tileID.canonical,xe.projection),this.projection=xe.projection,this.brightness=xe.brightness,this.extraShadowCaster=!!xe.extraShadowCaster,this.tessellationStep=xe.tessellationStep}parse(xe,Ee,Xe,nt,Je){this.status="parsing",this.data=xe,this.collisionBoxArray=new o.aQ;const pt=new o.dQ(Object.keys(xe.layers).sort()),Rt=new o.dR(this.tileID,this.promoteId);Rt.bucketLayerIDs=[];const gt={},Pt=new o.dS(256,256),zt={featureIndex:Rt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Pt,availableImages:Xe,brightness:this.brightness},Bt=Ee.familiesBySource[this.source];for(const Ct in Bt){const It=xe.layers[Ct];if(!It)continue;let wn=!1,_n=!1,zn=!1;for(const gr of Bt[Ct])gr[0].type==="symbol"?wn=!0:_n=!0,gr[0].is3D()&&gr[0].type!=="model"&&(zn=!0);if(this.extraShadowCaster&&!zn||this.isSymbolTile===!0&&!wn||this.isSymbolTile===!1&&!_n)continue;It.version===1&&o.w(`Vector tile source "${this.source}" layer "${Ct}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xn=pt.encode(Ct),lr=[];for(let gr=0;gr<It.length;gr++){const dr=It.feature(gr),fi=Rt.getId(dr,Ct);lr.push({feature:dr,id:fi,index:gr,sourceLayerIndex:Xn})}for(const gr of Bt[Ct]){const dr=gr[0];(!this.extraShadowCaster||dr.is3D()&&dr.type!=="model")&&(this.isSymbolTile!==void 0&&dr.type==="symbol"!==this.isSymbolTile||dr.minzoom&&this.zoom<Math.floor(dr.minzoom)||dr.maxzoom&&this.zoom>=dr.maxzoom||dr.visibility!=="none"&&(M(gr,this.zoom,zt.brightness,Xe),(gt[dr.id]=dr.createBucket({index:Rt.bucketLayerIDs.length,layers:gr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(lr,zt,this.tileID.canonical,this.tileTransform),Rt.bucketLayerIDs.push(gr.map(fi=>fi.id))))}}let ln,Mn,Cn,Ge;Pt.trim();const yt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Mt=()=>{if(ln)return this.status="done",Je(ln);if(this.extraShadowCaster)this.status="done",Je(null,{buckets:o.bd(gt).filter(Ct=>!Ct.isEmpty()),featureIndex:Rt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:zt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Mn&&Cn&&Ge){const Ct=new S(Mn),It=new o.dU(Cn,Ge,this.lut);for(const wn in gt){const _n=gt[wn];_n instanceof o.aR?(M(_n.layers,this.zoom,zt.brightness,Xe),o.dV(_n,Mn,Ct.positions,Cn,It.iconPositions,this.showCollisionBoxes,Xe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):_n.hasPattern&&(_n instanceof o.aX||_n instanceof o.aY||_n instanceof o.d0)&&(M(_n.layers,this.zoom,zt.brightness,Xe),_n.addFeatures(zt,this.tileID.canonical,It.patternPositions,Xe,this.tileTransform,this.brightness))}this.status="done",Je(null,{buckets:o.bd(gt).filter(wn=>!wn.isEmpty()),featureIndex:Rt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ct.image,lineAtlas:Pt,imageAtlas:It,brightness:zt.brightness})}};if(!this.extraShadowCaster){const Ct=o.dT(zt.glyphDependencies,_n=>Object.keys(_n).map(Number));Object.keys(Ct).length?nt.send("getGlyphs",{uid:this.uid,stacks:Ct,scope:this.scope},(_n,zn)=>{ln||(ln=_n,Mn=zn,Mt())},void 0,!1,yt):Mn={};const It=Object.keys(zt.iconDependencies);It.length?nt.send("getImages",{icons:It,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(_n,zn)=>{ln||(ln=_n,Cn=zn,Mt())},void 0,!1,yt):Cn={};const wn=Object.keys(zt.patternDependencies);wn.length?nt.send("getImages",{icons:wn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(_n,zn)=>{ln||(ln=_n,Ge=zn,Mt())},void 0,!1,yt):Ge={}}Mt()}}function M(Tt,xe,Ee,Xe){const nt=new o.a3(xe,{brightness:Ee});for(const Je of Tt)Je.recalculate(nt,Xe)}class C extends o.E{constructor(xe,Ee,Xe,nt,Je,pt){super(),this.actor=xe,this.layerIndex=Ee,this.availableImages=Xe,this.loadVectorData=Je||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(xe.scheduler),this.isSpriteLoaded=nt,this.scheduler=xe.scheduler,this.brightness=pt}loadTile(xe,Ee){const Xe=xe.uid,nt=xe&&xe.request,Je=nt&&nt.collectResourceTiming,pt=this.loading[Xe]=new E(xe);pt.abort=this.loadVectorData(xe,(Rt,gt)=>{const Pt=!this.loading[Xe];if(delete this.loading[Xe],Pt||Rt||!gt)return pt.status="done",Pt||(this.loaded[Xe]=pt),Ee(Rt);const zt=gt.rawData,Bt={};gt.expires&&(Bt.expires=gt.expires),gt.cacheControl&&(Bt.cacheControl=gt.cacheControl),pt.vectorTile=gt.vectorTile||new o.dW.VectorTile(new o.bb(zt));const ln=()=>{pt.parse(pt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Mn,Cn)=>{if(Mn||!Cn)return Ee(Mn);const Ge={};if(Je){const yt=h(nt);yt.length>0&&(Ge.resourceTiming=JSON.parse(JSON.stringify(yt)))}Ee(null,o.l({rawTileData:zt.slice(0)},Cn,Bt,Ge))})};this.isSpriteLoaded?ln():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(ln,{type:"parseTile",isSymbolTile:xe.isSymbolTile,zoom:xe.tileZoom}):ln()}),this.loaded=this.loaded||{},this.loaded[Xe]=pt})}reloadTile(xe,Ee){const Xe=this.loaded,nt=xe.uid;if(Xe&&Xe[nt]){const Je=Xe[nt];Je.showCollisionBoxes=xe.showCollisionBoxes,Je.projection=xe.projection,Je.brightness=xe.brightness,Je.tileTransform=o.aK(xe.tileID.canonical,xe.projection),Je.extraShadowCaster=xe.extraShadowCaster,Je.lut=xe.lut;const pt=(Rt,gt)=>{const Pt=Je.reloadCallback;Pt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,Pt)),Ee(Rt,gt)};Je.status==="parsing"?Je.reloadCallback=pt:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,pt):pt())}else Ee(null,void 0)}abortTile(xe,Ee){const Xe=xe.uid,nt=this.loading[Xe];nt&&(nt.abort&&nt.abort(),delete this.loading[Xe]),Ee()}removeTile(xe,Ee){const Xe=this.loaded,nt=xe.uid;Xe&&Xe[nt]&&delete Xe[nt],Ee()}}class L{loadTile(xe,Ee){const{uid:Xe,encoding:nt,rawImageData:Je,padding:pt}=xe,Rt=ImageBitmap&&Je instanceof ImageBitmap?this.getImageData(Je,pt):Je;Ee(null,new o.dX(Xe,Rt,nt,pt<1))}getImageData(xe,Ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(xe.width,xe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=xe.width,this.offscreenCanvas.height=xe.height,this.offscreenCanvasContext.drawImage(xe,0,0,xe.width,xe.height);const Xe=this.offscreenCanvasContext.getImageData(-Ee,-Ee,xe.width+2*Ee,xe.height+2*Ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Xe}}o.ba.setPbf(o.bb);class k{decodeRasterArray({task:xe,buffer:Ee},Xe){o.ba.performDecoding(Ee,xe).then(nt=>{Xe(null,nt)},nt=>{Xe(nt)})}}const H=o.dW.VectorTileFeature.prototype.toGeoJSON;class q{constructor(xe){this._feature=xe,this.extent=o.ab,this.type=xe.type,this.properties=xe.tags,"id"in xe&&!isNaN(xe.id)&&(this.id=parseInt(xe.id,10))}loadGeometry(){if(this._feature.type===1){const xe=[];for(const Ee of this._feature.geometry)xe.push([new o.P(Ee[0],Ee[1])]);return xe}{const xe=[];for(const Ee of this._feature.geometry){const Xe=[];for(const nt of Ee)Xe.push(new o.P(nt[0],nt[1]));xe.push(Xe)}return xe}}toGeoJSON(xe,Ee,Xe){return H.call(this,xe,Ee,Xe)}}class Z{constructor(xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=xe.length,this._features=xe}feature(xe){return new q(this._features[xe])}}const ee=64/4096,re=128;class se{constructor(){this.features=new Map}clear(){this.features.clear()}load(xe=[],Ee){for(const Xe of xe){const nt=Xe.id;if(nt==null)continue;let Je=this.features.get(nt);Je&&this.updateCache(Je,Ee),Xe.geometry?(Je=fe(Xe),this.updateCache(Je,Ee),this.features.set(nt,Je)):this.features.delete(nt),this.updateCache(Je,Ee)}}updateCache(xe,Ee){for(const{canonical:Xe,uid:nt}of Object.values(Ee)){const{z:Je,x:pt,y:Rt}=Xe;ae(xe,Math.pow(2,Je),pt,Rt)&&delete Ee[nt]}}getTile(xe,Ee,Xe){const nt=Math.pow(2,xe),Je=[];for(const pt of this.features.values())ae(pt,nt,Ee,Xe)&&Je.push(je(pt,nt,Ee,Xe));return{features:Je}}getFeatures(){return[...this.features.values()]}}function ae({minX:Tt,minY:xe,maxX:Ee,maxY:Xe},nt,Je,pt){return Tt<(Je+1+ee)/nt&&xe<(pt+1+ee)/nt&&Ee>(Je-ee)/nt&&Xe>(pt-ee)/nt}function fe(Tt){const{id:xe,geometry:Ee,properties:Xe}=Tt;if(!Ee)return;if(Ee.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:nt,coordinates:Je}=Ee,pt={id:xe,type:1,geometry:[],tags:Xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Rt=pt.geometry;if(nt==="Point")Se(Je,Rt,pt);else if(nt==="MultiPoint")for(const gt of Je)Se(gt,Rt,pt);else if(nt==="LineString")pt.type=2,Ce(Je,Rt,pt);else if(nt==="MultiLineString")pt.type=2,Ie(Je,Rt,pt);else if(nt==="Polygon")pt.type=3,Ie(Je,Rt,pt,!0);else{if(nt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");pt.type=3;for(const gt of Je)Ie(gt,Rt,pt,!0)}return pt}function Se([Tt,xe],Ee,Xe){const nt=o.am(Tt);let Je=o.at(xe);Je=Je<0?0:Je>1?1:Je,Ee.push(nt,Je),Xe.minX=Math.min(Xe.minX,nt),Xe.minY=Math.min(Xe.minY,Je),Xe.maxX=Math.max(Xe.maxX,nt),Xe.maxY=Math.max(Xe.maxY,Je)}function Ce(Tt,xe,Ee,Xe=!1,nt=!1){const Je=[];for(const pt of Tt)Se(pt,Je,Ee);xe.push(Je),Xe&&function(pt,Rt){let gt=0;for(let Pt=0,zt=pt.length,Bt=zt-2;Pt<zt;Bt=Pt,Pt+=2)gt+=(pt[Pt]-pt[Bt])*(pt[Pt+1]+pt[Bt+1]);if(gt>0===Rt)for(let Pt=0,zt=pt.length;Pt<zt/2;Pt+=2){const Bt=pt[Pt],ln=pt[Pt+1];pt[Pt]=pt[zt-2-Pt],pt[Pt+1]=pt[zt-1-Pt],pt[zt-2-Pt]=Bt,pt[zt-1-Pt]=ln}}(Je,nt)}function Ie(Tt,xe,Ee,Xe=!1){for(let nt=0;nt<Tt.length;nt++)Ce(Tt[nt],xe,Ee,Xe,nt===0)}function je(Tt,xe,Ee,Xe){const{id:nt,type:Je,geometry:pt,tags:Rt}=Tt,gt=[];if(Je===1)(function(Pt,zt,Bt,ln,Mn){for(let Cn=0;Cn<Pt.length;Cn+=2){const Ge=Math.round(o.ab*(Pt[Cn+0]*zt-Bt)),yt=Math.round(o.ab*(Pt[Cn+1]*zt-ln));Mn.push([Ge,yt])}})(pt,xe,Ee,Xe,gt);else for(const Pt of pt)Le(Pt,xe,Ee,Xe,gt);return{id:nt,type:Je,geometry:gt,tags:Rt}}function Le(Tt,xe,Ee,Xe,nt){const Je=-re,pt=o.ab+re;let Rt;for(let gt=0;gt<Tt.length-2;gt+=2){let Pt=Math.round(o.ab*(Tt[gt+0]*xe-Ee)),zt=Math.round(o.ab*(Tt[gt+1]*xe-Xe)),Bt=Math.round(o.ab*(Tt[gt+2]*xe-Ee)),ln=Math.round(o.ab*(Tt[gt+3]*xe-Xe));const Mn=Bt-Pt,Cn=ln-zt;Pt<Je&&Bt<Je||(Pt<Je?(zt+=Math.round(Cn*((Je-Pt)/Mn)),Pt=Je):Bt<Je&&(ln=zt+Math.round(Cn*((Je-Pt)/Mn)),Bt=Je),zt<Je&&ln<Je||(zt<Je?(Pt+=Math.round(Mn*((Je-zt)/Cn)),zt=Je):ln<Je&&(Bt=Pt+Math.round(Mn*((Je-zt)/Cn)),ln=Je),Pt>=pt&&Bt>=pt||(Pt>=pt?(zt+=Math.round(Cn*((pt-Pt)/Mn)),Pt=pt):Bt>=pt&&(ln=zt+Math.round(Cn*((pt-Pt)/Mn)),Bt=pt),zt>=pt&&ln>=pt||(zt>=pt?(Pt+=Math.round(Mn*((pt-zt)/Cn)),zt=pt):ln>=pt&&(Bt=Pt+Math.round(Mn*((pt-zt)/Cn)),ln=pt),Rt&&Pt===Rt[Rt.length-1][0]&&zt===Rt[Rt.length-1][1]||(Rt=[[Pt,zt]],nt.push(Rt)),Rt.push([Bt,ln])))))}}var ot,ye,$e,Ve={exports:{}},_t=function(){if($e)return Ve.exports;$e=1;var Tt=o.d_(),xe=function(){if(ye)return ot;ye=1;var zt=o.dY(),Bt=o.dZ().VectorTileFeature;function ln(Cn,Ge){this.options=Ge||{},this.features=Cn,this.length=Cn.length}function Mn(Cn,Ge){this.id=typeof Cn.id=="number"?Cn.id:void 0,this.type=Cn.type,this.rawGeometry=Cn.type===1?[Cn.geometry]:Cn.geometry,this.properties=Cn.tags,this.extent=Ge||4096}return ot=ln,ln.prototype.feature=function(Cn){return new Mn(this.features[Cn],this.options.extent)},Mn.prototype.loadGeometry=function(){var Cn=this.rawGeometry;this.geometry=[];for(var Ge=0;Ge<Cn.length;Ge++){for(var yt=Cn[Ge],Mt=[],Ct=0;Ct<yt.length;Ct++)Mt.push(new zt(yt[Ct][0],yt[Ct][1]));this.geometry.push(Mt)}return this.geometry},Mn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Cn=this.geometry,Ge=1/0,yt=-1/0,Mt=1/0,Ct=-1/0,It=0;It<Cn.length;It++)for(var wn=Cn[It],_n=0;_n<wn.length;_n++){var zn=wn[_n];Ge=Math.min(Ge,zn.x),yt=Math.max(yt,zn.x),Mt=Math.min(Mt,zn.y),Ct=Math.max(Ct,zn.y)}return[Ge,Mt,yt,Ct]},Mn.prototype.toGeoJSON=Bt.prototype.toGeoJSON,ot}();function Ee(zt){var Bt=new Tt;return function(ln,Mn){for(var Cn in ln.layers)Mn.writeMessage(3,Xe,ln.layers[Cn])}(zt,Bt),Bt.finish()}function Xe(zt,Bt){var ln;Bt.writeVarintField(15,zt.version||1),Bt.writeStringField(1,zt.name||""),Bt.writeVarintField(5,zt.extent||4096);var Mn={keys:[],values:[],keycache:{},valuecache:{}};for(ln=0;ln<zt.length;ln++)Mn.feature=zt.feature(ln),Bt.writeMessage(2,nt,Mn);var Cn=Mn.keys;for(ln=0;ln<Cn.length;ln++)Bt.writeStringField(3,Cn[ln]);var Ge=Mn.values;for(ln=0;ln<Ge.length;ln++)Bt.writeMessage(4,Pt,Ge[ln])}function nt(zt,Bt){var ln=zt.feature;ln.id!==void 0&&Bt.writeVarintField(1,ln.id),Bt.writeMessage(2,Je,zt),Bt.writeVarintField(3,ln.type),Bt.writeMessage(4,gt,ln)}function Je(zt,Bt){var ln=zt.feature,Mn=zt.keys,Cn=zt.values,Ge=zt.keycache,yt=zt.valuecache;for(var Mt in ln.properties){var Ct=ln.properties[Mt],It=Ge[Mt];if(Ct!==null){It===void 0&&(Mn.push(Mt),Ge[Mt]=It=Mn.length-1),Bt.writeVarint(It);var wn=typeof Ct;wn!=="string"&&wn!=="boolean"&&wn!=="number"&&(Ct=JSON.stringify(Ct));var _n=wn+":"+Ct,zn=yt[_n];zn===void 0&&(Cn.push(Ct),yt[_n]=zn=Cn.length-1),Bt.writeVarint(zn)}}}function pt(zt,Bt){return(Bt<<3)+(7&zt)}function Rt(zt){return zt<<1^zt>>31}function gt(zt,Bt){for(var ln=zt.loadGeometry(),Mn=zt.type,Cn=0,Ge=0,yt=ln.length,Mt=0;Mt<yt;Mt++){var Ct=ln[Mt],It=1;Mn===1&&(It=Ct.length),Bt.writeVarint(pt(1,It));for(var wn=Mn===3?Ct.length-1:Ct.length,_n=0;_n<wn;_n++){_n===1&&Mn!==1&&Bt.writeVarint(pt(2,wn-1));var zn=Ct[_n].x-Cn,Xn=Ct[_n].y-Ge;Bt.writeVarint(Rt(zn)),Bt.writeVarint(Rt(Xn)),Cn+=zn,Ge+=Xn}Mn===3&&Bt.writeVarint(pt(7,1))}}function Pt(zt,Bt){var ln=typeof zt;ln==="string"?Bt.writeStringField(1,zt):ln==="boolean"?Bt.writeBooleanField(7,zt):ln==="number"&&(zt%1!=0?Bt.writeDoubleField(3,zt):zt<0?Bt.writeSVarintField(6,zt):Bt.writeVarintField(5,zt))}return Ve.exports=Ee,Ve.exports.fromVectorTileJs=Ee,Ve.exports.fromGeojsonVt=function(zt,Bt){Bt=Bt||{};var ln={};for(var Mn in zt)ln[Mn]=new xe(zt[Mn].features,Bt),ln[Mn].name=Mn,ln[Mn].version=Bt.version,ln[Mn].extent=Bt.extent;return Ee({layers:ln})},Ve.exports.GeoJSONWrapper=xe,Ve.exports}(),wt=o.d$(_t);const Vt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Tt=>Tt},lt=Math.fround||(Ht=new Float32Array(1),Tt=>(Ht[0]=+Tt,Ht[0]));var Ht;const Qt=3,rn=5,jn=6;class Bn{constructor(xe){this.options=Object.assign(Object.create(Vt),xe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(xe){const{log:Ee,minZoom:Xe,maxZoom:nt}=this.options;Ee&&console.time("total time");const Je=`prepare ${xe.length} points`;Ee&&console.time(Je),this.points=xe;const pt=[];for(let gt=0;gt<xe.length;gt++){const Pt=xe[gt];if(!Pt.geometry)continue;const[zt,Bt]=Pt.geometry.coordinates,ln=lt(qe(zt)),Mn=lt(mn(Bt));pt.push(ln,Mn,1/0,gt,-1,1),this.options.reduce&&pt.push(0)}let Rt=this.trees[nt+1]=this._createTree(pt);Ee&&console.timeEnd(Je);for(let gt=nt;gt>=Xe;gt--){const Pt=+Date.now();Rt=this.trees[gt]=this._createTree(this._cluster(Rt,gt)),Ee&&console.log("z%d: %d clusters in %dms",gt,Rt.numItems,+Date.now()-Pt)}return Ee&&console.timeEnd("total time"),this}getClusters(xe,Ee){let Xe=((xe[0]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,xe[1]));let Je=xe[2]===180?180:((xe[2]+180)%360+360)%360-180;const pt=Math.max(-90,Math.min(90,xe[3]));if(xe[2]-xe[0]>=360)Xe=-180,Je=180;else if(Xe>Je){const Bt=this.getClusters([Xe,nt,180,pt],Ee),ln=this.getClusters([-180,nt,Je,pt],Ee);return Bt.concat(ln)}const Rt=this.trees[this._limitZoom(Ee)],gt=Rt.range(qe(Xe),mn(pt),qe(Je),mn(nt)),Pt=Rt.data,zt=[];for(const Bt of gt){const ln=this.stride*Bt;zt.push(Pt[ln+rn]>1?Tn(Pt,ln,this.clusterProps):this.points[Pt[ln+Qt]])}return zt}getChildren(xe){const Ee=this._getOriginId(xe),Xe=this._getOriginZoom(xe),nt="No cluster with the specified id.",Je=this.trees[Xe];if(!Je)throw new Error(nt);const pt=Je.data;if(Ee*this.stride>=pt.length)throw new Error(nt);const Rt=this.options.radius/(this.options.extent*Math.pow(2,Xe-1)),gt=Je.within(pt[Ee*this.stride],pt[Ee*this.stride+1],Rt),Pt=[];for(const zt of gt){const Bt=zt*this.stride;pt[Bt+4]===xe&&Pt.push(pt[Bt+rn]>1?Tn(pt,Bt,this.clusterProps):this.points[pt[Bt+Qt]])}if(Pt.length===0)throw new Error(nt);return Pt}getLeaves(xe,Ee,Xe){const nt=[];return this._appendLeaves(nt,xe,Ee=Ee||10,Xe=Xe||0,0),nt}getTile(xe,Ee,Xe){const nt=this.trees[this._limitZoom(xe)],Je=Math.pow(2,xe),{extent:pt,radius:Rt}=this.options,gt=Rt/pt,Pt=(Xe-gt)/Je,zt=(Xe+1+gt)/Je,Bt={features:[]};return this._addTileFeatures(nt.range((Ee-gt)/Je,Pt,(Ee+1+gt)/Je,zt),nt.data,Ee,Xe,Je,Bt),Ee===0&&this._addTileFeatures(nt.range(1-gt/Je,Pt,1,zt),nt.data,Je,Xe,Je,Bt),Ee===Je-1&&this._addTileFeatures(nt.range(0,Pt,gt/Je,zt),nt.data,-1,Xe,Je,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(xe){let Ee=this._getOriginZoom(xe)-1;for(;Ee<=this.options.maxZoom;){const Xe=this.getChildren(xe);if(Ee++,Xe.length!==1)break;xe=Xe[0].properties.cluster_id}return Ee}_appendLeaves(xe,Ee,Xe,nt,Je){const pt=this.getChildren(Ee);for(const Rt of pt){const gt=Rt.properties;if(gt&&gt.cluster?Je+gt.point_count<=nt?Je+=gt.point_count:Je=this._appendLeaves(xe,gt.cluster_id,Xe,nt,Je):Je<nt?Je++:xe.push(Rt),xe.length===Xe)break}return Je}_createTree(xe){const Ee=new o.by(xe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Xe=0;Xe<xe.length;Xe+=this.stride)Ee.add(xe[Xe],xe[Xe+1]);return Ee.finish(),Ee.data=xe,Ee}_addTileFeatures(xe,Ee,Xe,nt,Je,pt){for(const Rt of xe){const gt=Rt*this.stride,Pt=Ee[gt+rn]>1;let zt,Bt,ln;if(Pt)zt=Pe(Ee,gt,this.clusterProps),Bt=Ee[gt],ln=Ee[gt+1];else{const Ge=this.points[Ee[gt+Qt]];zt=Ge.properties;const[yt,Mt]=Ge.geometry.coordinates;Bt=qe(yt),ln=mn(Mt)}const Mn={type:1,geometry:[[Math.round(this.options.extent*(Bt*Je-Xe)),Math.round(this.options.extent*(ln*Je-nt))]],tags:zt};let Cn;Cn=Pt||this.options.generateId?Ee[gt+Qt]:this.points[Ee[gt+Qt]].id,Cn!==void 0&&(Mn.id=Cn),pt.features.push(Mn)}}_limitZoom(xe){return Math.max(this.options.minZoom,Math.min(Math.floor(+xe),this.options.maxZoom+1))}_cluster(xe,Ee){const{radius:Xe,extent:nt,reduce:Je,minPoints:pt}=this.options,Rt=Xe/(nt*Math.pow(2,Ee)),gt=xe.data,Pt=[],zt=this.stride;for(let Bt=0;Bt<gt.length;Bt+=zt){if(gt[Bt+2]<=Ee)continue;gt[Bt+2]=Ee;const ln=gt[Bt],Mn=gt[Bt+1],Cn=xe.within(gt[Bt],gt[Bt+1],Rt),Ge=gt[Bt+rn];let yt=Ge;for(const Mt of Cn){const Ct=Mt*zt;gt[Ct+2]>Ee&&(yt+=gt[Ct+rn])}if(yt>Ge&&yt>=pt){let Mt,Ct=ln*Ge,It=Mn*Ge,wn=-1;const _n=(Bt/zt<<5)+(Ee+1)+this.points.length;for(const zn of Cn){const Xn=zn*zt;if(gt[Xn+2]<=Ee)continue;gt[Xn+2]=Ee;const lr=gt[Xn+rn];Ct+=gt[Xn]*lr,It+=gt[Xn+1]*lr,gt[Xn+4]=_n,Je&&(Mt||(Mt=this._map(gt,Bt,!0),wn=this.clusterProps.length,this.clusterProps.push(Mt)),Je(Mt,this._map(gt,Xn)))}gt[Bt+4]=_n,Pt.push(Ct/yt,It/yt,1/0,_n,-1,yt),Je&&Pt.push(wn)}else{for(let Mt=0;Mt<zt;Mt++)Pt.push(gt[Bt+Mt]);if(yt>1)for(const Mt of Cn){const Ct=Mt*zt;if(!(gt[Ct+2]<=Ee)){gt[Ct+2]=Ee;for(let It=0;It<zt;It++)Pt.push(gt[Ct+It])}}}}return Pt}_getOriginId(xe){return xe-this.points.length>>5}_getOriginZoom(xe){return(xe-this.points.length)%32}_map(xe,Ee,Xe){if(xe[Ee+rn]>1){const pt=this.clusterProps[xe[Ee+jn]];return Xe?Object.assign({},pt):pt}const nt=this.points[xe[Ee+Qt]].properties,Je=this.options.map(nt);return Xe&&Je===nt?Object.assign({},Je):Je}}function Tn(Tt,xe,Ee){return{type:"Feature",id:Tt[xe+Qt],properties:Pe(Tt,xe,Ee),geometry:{type:"Point",coordinates:[(Xe=Tt[xe],360*(Xe-.5)),cn(Tt[xe+1])]}};var Xe}function Pe(Tt,xe,Ee){const Xe=Tt[xe+rn],nt=Xe>=1e4?`${Math.round(Xe/1e3)}k`:Xe>=1e3?Math.round(Xe/100)/10+"k":Xe,Je=Tt[xe+jn],pt=Je===-1?{}:Object.assign({},Ee[Je]);return Object.assign(pt,{cluster:!0,cluster_id:Tt[xe+Qt],point_count:Xe,point_count_abbreviated:nt})}function qe(Tt){return Tt/360+.5}function mn(Tt){const xe=Math.sin(Tt*Math.PI/180),Ee=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Ee<0?0:Ee>1?1:Ee}function cn(Tt){const xe=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp(xe))/Math.PI-90}function St(Tt,xe,Ee,Xe){let nt=Xe;const Je=xe+(Ee-xe>>1);let pt,Rt=Ee-xe;const gt=Tt[xe],Pt=Tt[xe+1],zt=Tt[Ee],Bt=Tt[Ee+1];for(let ln=xe+3;ln<Ee;ln+=3){const Mn=Jt(Tt[ln],Tt[ln+1],gt,Pt,zt,Bt);if(Mn>nt)pt=ln,nt=Mn;else if(Mn===nt){const Cn=Math.abs(ln-Je);Cn<Rt&&(pt=ln,Rt=Cn)}}nt>Xe&&(pt-xe>3&&St(Tt,xe,pt,Xe),Tt[pt+2]=nt,Ee-pt>3&&St(Tt,pt,Ee,Xe))}function Jt(Tt,xe,Ee,Xe,nt,Je){let pt=nt-Ee,Rt=Je-Xe;if(pt!==0||Rt!==0){const gt=((Tt-Ee)*pt+(xe-Xe)*Rt)/(pt*pt+Rt*Rt);gt>1?(Ee=nt,Xe=Je):gt>0&&(Ee+=pt*gt,Xe+=Rt*gt)}return pt=Tt-Ee,Rt=xe-Xe,pt*pt+Rt*Rt}function kn(Tt,xe,Ee,Xe){const nt={id:Tt??null,type:xe,geometry:Ee,tags:Xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Gn(nt,Ee);else if(xe==="Polygon")Gn(nt,Ee[0]);else if(xe==="MultiLineString")for(const Je of Ee)Gn(nt,Je);else if(xe==="MultiPolygon")for(const Je of Ee)Gn(nt,Je[0]);return nt}function Gn(Tt,xe){for(let Ee=0;Ee<xe.length;Ee+=3)Tt.minX=Math.min(Tt.minX,xe[Ee]),Tt.minY=Math.min(Tt.minY,xe[Ee+1]),Tt.maxX=Math.max(Tt.maxX,xe[Ee]),Tt.maxY=Math.max(Tt.maxY,xe[Ee+1])}function sn(Tt,xe,Ee,Xe){if(!xe.geometry)return;const nt=xe.geometry.coordinates;if(nt&&nt.length===0)return;const Je=xe.geometry.type,pt=Math.pow(Ee.tolerance/((1<<Ee.maxZoom)*Ee.extent),2);let Rt=[],gt=xe.id;if(Ee.promoteId?gt=xe.properties[Ee.promoteId]:Ee.generateId&&(gt=Xe||0),Je==="Point")at(nt,Rt);else if(Je==="MultiPoint")for(const Pt of nt)at(Pt,Rt);else if(Je==="LineString")Ue(nt,Rt,pt,!1);else if(Je==="MultiLineString"){if(Ee.lineMetrics){for(const Pt of nt)Rt=[],Ue(Pt,Rt,pt,!1),Tt.push(kn(gt,"LineString",Rt,xe.properties));return}$t(nt,Rt,pt,!1)}else if(Je==="Polygon")$t(nt,Rt,pt,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(const Pt of xe.geometry.geometries)sn(Tt,{id:gt,geometry:Pt,properties:xe.properties},Ee,Xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Pt of nt){const zt=[];$t(Pt,zt,pt,!0),Rt.push(zt)}}Tt.push(kn(gt,Je,Rt,xe.properties))}function at(Tt,xe){xe.push(An(Tt[0]),Sn(Tt[1]),0)}function Ue(Tt,xe,Ee,Xe){let nt,Je,pt=0;for(let gt=0;gt<Tt.length;gt++){const Pt=An(Tt[gt][0]),zt=Sn(Tt[gt][1]);xe.push(Pt,zt,0),gt>0&&(pt+=Xe?(nt*zt-Pt*Je)/2:Math.sqrt(Math.pow(Pt-nt,2)+Math.pow(zt-Je,2))),nt=Pt,Je=zt}const Rt=xe.length-3;xe[2]=1,St(xe,0,Rt,Ee),xe[Rt+2]=1,xe.size=Math.abs(pt),xe.start=0,xe.end=xe.size}function $t(Tt,xe,Ee,Xe){for(let nt=0;nt<Tt.length;nt++){const Je=[];Ue(Tt[nt],Je,Ee,Xe),xe.push(Je)}}function An(Tt){return Tt/360+.5}function Sn(Tt){const xe=Math.sin(Tt*Math.PI/180),Ee=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Ee<0?0:Ee>1?1:Ee}function jt(Tt,xe,Ee,Xe,nt,Je,pt,Rt){if(Xe/=xe,Je>=(Ee/=xe)&&pt<Xe)return Tt;if(pt<Ee||Je>=Xe)return null;const gt=[];for(const Pt of Tt){const zt=Pt.geometry;let Bt=Pt.type;const ln=nt===0?Pt.minX:Pt.minY,Mn=nt===0?Pt.maxX:Pt.maxY;if(ln>=Ee&&Mn<Xe){gt.push(Pt);continue}if(Mn<Ee||ln>=Xe)continue;let Cn=[];if(Bt==="Point"||Bt==="MultiPoint")mr(zt,Cn,Ee,Xe,nt);else if(Bt==="LineString")Un(zt,Cn,Ee,Xe,nt,!1,Rt.lineMetrics);else if(Bt==="MultiLineString")Sr(zt,Cn,Ee,Xe,nt,!1);else if(Bt==="Polygon")Sr(zt,Cn,Ee,Xe,nt,!0);else if(Bt==="MultiPolygon")for(const Ge of zt){const yt=[];Sr(Ge,yt,Ee,Xe,nt,!0),yt.length&&Cn.push(yt)}if(Cn.length){if(Rt.lineMetrics&&Bt==="LineString"){for(const Ge of Cn)gt.push(kn(Pt.id,Bt,Ge,Pt.tags));continue}Bt!=="LineString"&&Bt!=="MultiLineString"||(Cn.length===1?(Bt="LineString",Cn=Cn[0]):Bt="MultiLineString"),Bt!=="Point"&&Bt!=="MultiPoint"||(Bt=Cn.length===3?"Point":"MultiPoint"),gt.push(kn(Pt.id,Bt,Cn,Pt.tags))}}return gt.length?gt:null}function mr(Tt,xe,Ee,Xe,nt){for(let Je=0;Je<Tt.length;Je+=3){const pt=Tt[Je+nt];pt>=Ee&&pt<=Xe&&Ln(xe,Tt[Je],Tt[Je+1],Tt[Je+2])}}function Un(Tt,xe,Ee,Xe,nt,Je,pt){let Rt=tr(Tt);const gt=nt===0?ir:ui;let Pt,zt,Bt=Tt.start;for(let yt=0;yt<Tt.length-3;yt+=3){const Mt=Tt[yt],Ct=Tt[yt+1],It=Tt[yt+2],wn=Tt[yt+3],_n=Tt[yt+4],zn=nt===0?Mt:Ct,Xn=nt===0?wn:_n;let lr=!1;pt&&(Pt=Math.sqrt(Math.pow(Mt-wn,2)+Math.pow(Ct-_n,2))),zn<Ee?Xn>Ee&&(zt=gt(Rt,Mt,Ct,wn,_n,Ee),pt&&(Rt.start=Bt+Pt*zt)):zn>Xe?Xn<Xe&&(zt=gt(Rt,Mt,Ct,wn,_n,Xe),pt&&(Rt.start=Bt+Pt*zt)):Ln(Rt,Mt,Ct,It),Xn<Ee&&zn>=Ee&&(zt=gt(Rt,Mt,Ct,wn,_n,Ee),lr=!0),Xn>Xe&&zn<=Xe&&(zt=gt(Rt,Mt,Ct,wn,_n,Xe),lr=!0),!Je&&lr&&(pt&&(Rt.end=Bt+Pt*zt),xe.push(Rt),Rt=tr(Tt)),pt&&(Bt+=Pt)}let ln=Tt.length-3;const Mn=Tt[ln],Cn=Tt[ln+1],Ge=nt===0?Mn:Cn;Ge>=Ee&&Ge<=Xe&&Ln(Rt,Mn,Cn,Tt[ln+2]),ln=Rt.length-3,Je&&ln>=3&&(Rt[ln]!==Rt[0]||Rt[ln+1]!==Rt[1])&&Ln(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&xe.push(Rt)}function tr(Tt){const xe=[];return xe.size=Tt.size,xe.start=Tt.start,xe.end=Tt.end,xe}function Sr(Tt,xe,Ee,Xe,nt,Je){for(const pt of Tt)Un(pt,xe,Ee,Xe,nt,Je,!1)}function Ln(Tt,xe,Ee,Xe){Tt.push(xe,Ee,Xe)}function ir(Tt,xe,Ee,Xe,nt,Je){const pt=(Je-xe)/(Xe-xe);return Ln(Tt,Je,Ee+(nt-Ee)*pt,1),pt}function ui(Tt,xe,Ee,Xe,nt,Je){const pt=(Je-Ee)/(nt-Ee);return Ln(Tt,xe+(Xe-xe)*pt,Je,1),pt}function Fr(Tt,xe){const Ee=[];for(let Xe=0;Xe<Tt.length;Xe++){const nt=Tt[Xe],Je=nt.type;let pt;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")pt=or(nt.geometry,xe);else if(Je==="MultiLineString"||Je==="Polygon"){pt=[];for(const Rt of nt.geometry)pt.push(or(Rt,xe))}else if(Je==="MultiPolygon"){pt=[];for(const Rt of nt.geometry){const gt=[];for(const Pt of Rt)gt.push(or(Pt,xe));pt.push(gt)}}Ee.push(kn(nt.id,Je,pt,nt.tags))}return Ee}function or(Tt,xe){const Ee=[];Ee.size=Tt.size,Tt.start!==void 0&&(Ee.start=Tt.start,Ee.end=Tt.end);for(let Xe=0;Xe<Tt.length;Xe+=3)Ee.push(Tt[Xe]+xe,Tt[Xe+1],Tt[Xe+2]);return Ee}function Nr(Tt,xe){if(Tt.transformed)return Tt;const Ee=1<<Tt.z,Xe=Tt.x,nt=Tt.y;for(const Je of Tt.features){const pt=Je.geometry,Rt=Je.type;if(Je.geometry=[],Rt===1)for(let gt=0;gt<pt.length;gt+=2)Je.geometry.push(Hr(pt[gt],pt[gt+1],xe,Ee,Xe,nt));else for(let gt=0;gt<pt.length;gt++){const Pt=[];for(let zt=0;zt<pt[gt].length;zt+=2)Pt.push(Hr(pt[gt][zt],pt[gt][zt+1],xe,Ee,Xe,nt));Je.geometry.push(Pt)}}return Tt.transformed=!0,Tt}function Hr(Tt,xe,Ee,Xe,nt,Je){return[Math.round(Ee*(Tt*Xe-nt)),Math.round(Ee*(xe*Xe-Je))]}function yi(Tt,xe,Ee,Xe,nt){const Je=xe===nt.maxZoom?0:nt.tolerance/((1<<xe)*nt.extent),pt={features:[],numPoints:0,numSimplified:0,numFeatures:Tt.length,source:null,x:Ee,y:Xe,z:xe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Rt of Tt)Fe(pt,Rt,Je,nt);return pt}function Fe(Tt,xe,Ee,Xe){const nt=xe.geometry,Je=xe.type,pt=[];if(Tt.minX=Math.min(Tt.minX,xe.minX),Tt.minY=Math.min(Tt.minY,xe.minY),Tt.maxX=Math.max(Tt.maxX,xe.maxX),Tt.maxY=Math.max(Tt.maxY,xe.maxY),Je==="Point"||Je==="MultiPoint")for(let Rt=0;Rt<nt.length;Rt+=3)pt.push(nt[Rt],nt[Rt+1]),Tt.numPoints++,Tt.numSimplified++;else if(Je==="LineString")Lt(pt,nt,Tt,Ee,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(let Rt=0;Rt<nt.length;Rt++)Lt(pt,nt[Rt],Tt,Ee,Je==="Polygon",Rt===0);else if(Je==="MultiPolygon")for(let Rt=0;Rt<nt.length;Rt++){const gt=nt[Rt];for(let Pt=0;Pt<gt.length;Pt++)Lt(pt,gt[Pt],Tt,Ee,!0,Pt===0)}if(pt.length){let Rt=xe.tags||null;if(Je==="LineString"&&Xe.lineMetrics){Rt={};for(const Pt in xe.tags)Rt[Pt]=xe.tags[Pt];Rt.mapbox_clip_start=nt.start/nt.size,Rt.mapbox_clip_end=nt.end/nt.size}const gt={geometry:pt,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:Rt};xe.id!==null&&(gt.id=xe.id),Tt.features.push(gt)}}function Lt(Tt,xe,Ee,Xe,nt,Je){const pt=Xe*Xe;if(Xe>0&&xe.size<(nt?pt:Xe))return void(Ee.numPoints+=xe.length/3);const Rt=[];for(let gt=0;gt<xe.length;gt+=3)(Xe===0||xe[gt+2]>pt)&&(Ee.numSimplified++,Rt.push(xe[gt],xe[gt+1])),Ee.numPoints++;nt&&function(gt,Pt){let zt=0;for(let Bt=0,ln=gt.length,Mn=ln-2;Bt<ln;Mn=Bt,Bt+=2)zt+=(gt[Bt]-gt[Mn])*(gt[Bt+1]+gt[Mn+1]);if(zt>0===Pt)for(let Bt=0,ln=gt.length;Bt<ln/2;Bt+=2){const Mn=gt[Bt],Cn=gt[Bt+1];gt[Bt]=gt[ln-2-Bt],gt[Bt+1]=gt[ln-1-Bt],gt[ln-2-Bt]=Mn,gt[ln-1-Bt]=Cn}}(Rt,Je),Tt.push(Rt)}const Kt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class un{constructor(xe,Ee){const Xe=(Ee=this.options=function(Je,pt){for(const Rt in pt)Je[Rt]=pt[Rt];return Je}(Object.create(Kt),Ee)).debug;if(Xe&&console.time("preprocess data"),Ee.maxZoom<0||Ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ee.promoteId&&Ee.generateId)throw new Error("promoteId and generateId cannot be used together.");let nt=function(Je,pt){const Rt=[];if(Je.type==="FeatureCollection")for(let gt=0;gt<Je.features.length;gt++)sn(Rt,Je.features[gt],pt,gt);else sn(Rt,Je.type==="Feature"?Je:{geometry:Je},pt);return Rt}(xe,Ee);this.tiles={},this.tileCoords=[],Xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ee.indexMaxZoom,Ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),nt=function(Je,pt){const Rt=pt.buffer/pt.extent;let gt=Je;const Pt=jt(Je,1,-1-Rt,Rt,0,-1,2,pt),zt=jt(Je,1,1-Rt,2+Rt,0,-1,2,pt);return(Pt||zt)&&(gt=jt(Je,1,-Rt,1+Rt,0,-1,2,pt)||[],Pt&&(gt=Fr(Pt,1).concat(gt)),zt&&(gt=gt.concat(Fr(zt,-1)))),gt}(nt,Ee),nt.length&&this.splitTile(nt,0,0,0),Xe&&(nt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(xe,Ee,Xe,nt,Je,pt,Rt){const gt=[xe,Ee,Xe,nt],Pt=this.options,zt=Pt.debug;for(;gt.length;){nt=gt.pop(),Xe=gt.pop(),Ee=gt.pop(),xe=gt.pop();const Bt=1<<Ee,ln=En(Ee,Xe,nt);let Mn=this.tiles[ln];if(!Mn&&(zt>1&&console.time("creation"),Mn=this.tiles[ln]=yi(xe,Ee,Xe,nt,Pt),this.tileCoords.push({z:Ee,x:Xe,y:nt}),zt)){zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ee,Xe,nt,Mn.numFeatures,Mn.numPoints,Mn.numSimplified),console.timeEnd("creation"));const lr=`z${Ee}`;this.stats[lr]=(this.stats[lr]||0)+1,this.total++}if(Mn.source=xe,Je==null){if(Ee===Pt.indexMaxZoom||Mn.numPoints<=Pt.indexMaxPoints)continue}else{if(Ee===Pt.maxZoom||Ee===Je)continue;if(Je!=null){const lr=Je-Ee;if(Xe!==pt>>lr||nt!==Rt>>lr)continue}}if(Mn.source=null,xe.length===0)continue;zt>1&&console.time("clipping");const Cn=.5*Pt.buffer/Pt.extent,Ge=.5-Cn,yt=.5+Cn,Mt=1+Cn;let Ct=null,It=null,wn=null,_n=null,zn=jt(xe,Bt,Xe-Cn,Xe+yt,0,Mn.minX,Mn.maxX,Pt),Xn=jt(xe,Bt,Xe+Ge,Xe+Mt,0,Mn.minX,Mn.maxX,Pt);xe=null,zn&&(Ct=jt(zn,Bt,nt-Cn,nt+yt,1,Mn.minY,Mn.maxY,Pt),It=jt(zn,Bt,nt+Ge,nt+Mt,1,Mn.minY,Mn.maxY,Pt),zn=null),Xn&&(wn=jt(Xn,Bt,nt-Cn,nt+yt,1,Mn.minY,Mn.maxY,Pt),_n=jt(Xn,Bt,nt+Ge,nt+Mt,1,Mn.minY,Mn.maxY,Pt),Xn=null),zt>1&&console.timeEnd("clipping"),gt.push(Ct||[],Ee+1,2*Xe,2*nt),gt.push(It||[],Ee+1,2*Xe,2*nt+1),gt.push(wn||[],Ee+1,2*Xe+1,2*nt),gt.push(_n||[],Ee+1,2*Xe+1,2*nt+1)}}getTile(xe,Ee,Xe){xe=+xe,Ee=+Ee,Xe=+Xe;const nt=this.options,{extent:Je,debug:pt}=nt;if(xe<0||xe>24)return null;const Rt=1<<xe,gt=En(xe,Ee=Ee+Rt&Rt-1,Xe);if(this.tiles[gt])return Nr(this.tiles[gt],Je);pt>1&&console.log("drilling down to z%d-%d-%d",xe,Ee,Xe);let Pt,zt=xe,Bt=Ee,ln=Xe;for(;!Pt&&zt>0;)zt--,Bt>>=1,ln>>=1,Pt=this.tiles[En(zt,Bt,ln)];return Pt&&Pt.source?(pt>1&&(console.log("found parent tile z%d-%d-%d",zt,Bt,ln),console.time("drilling down")),this.splitTile(Pt.source,zt,Bt,ln,xe,Ee,Xe),pt>1&&console.timeEnd("drilling down"),this.tiles[gt]?Nr(this.tiles[gt],Je):null):null}}function En(Tt,xe,Ee){return 32*((1<<Tt)*Ee+xe)+Tt}function Ar(Tt,xe){const Ee=Tt.tileID.canonical;if(!this._geoJSONIndex)return void xe(null,null);const Xe=this._geoJSONIndex.getTile(Ee.z,Ee.x,Ee.y);if(!Xe)return void xe(null,null);const nt=new Z(Xe.features);let Je=wt(nt);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),xe(null,{vectorTile:nt,rawData:Je.buffer})}class Vr extends C{constructor(xe,Ee,Xe,nt,Je,pt){super(xe,Ee,Xe,nt,Ar,pt),Je&&(this.loadGeoJSON=Je),this._dynamicIndex=new se}loadData(xe,Ee){const Xe=xe&&xe.request,nt=Xe&&Xe.collectResourceTiming;this.loadGeoJSON(xe,(Je,pt)=>{if(Je||!pt)return Ee(Je);if(typeof pt!="object")return Ee(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`));{try{if(xe.filter){const gt=o.M(xe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(gt.result==="error")throw new Error(gt.value.map(Pt=>`${Pt.key}: ${Pt.message}`).join(", "));pt.features=pt.features.filter(Pt=>gt.value.evaluate({zoom:0},Pt))}xe.dynamic?(pt.type==="Feature"&&(pt={type:"FeatureCollection",features:[pt]}),xe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(pt.features,this.loaded),xe.cluster&&(pt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=xe.cluster?new Bn(function({superclusterOptions:gt,clusterProperties:Pt}){if(!Pt||!gt)return gt;const zt={},Bt={},ln={accumulated:null,zoom:0},Mn={properties:null},Cn=Object.keys(Pt);for(const Ge of Cn){const[yt,Mt]=Pt[Ge],Ct=o.M(Mt),It=o.M(typeof yt=="string"?[yt,["accumulated"],["get",Ge]]:yt);zt[Ge]=Ct.value,Bt[Ge]=It.value}return gt.map=Ge=>{Mn.properties=Ge;const yt={};for(const Mt of Cn)yt[Mt]=zt[Mt].evaluate(ln,Mn);return yt},gt.reduce=(Ge,yt)=>{Mn.properties=yt;for(const Mt of Cn)ln.accumulated=Ge[Mt],Ge[Mt]=Bt[Mt].evaluate(ln,Mn)},gt}(xe)).load(pt.features):xe.dynamic?this._dynamicIndex:function(gt,Pt){return new un(gt,Pt)}(pt,xe.geojsonVtOptions)}catch(gt){return Ee(gt)}const Rt={};if(nt){const gt=h(Xe);gt&&(Rt.resourceTiming={},Rt.resourceTiming[xe.source]=JSON.parse(JSON.stringify(gt)))}Ee(null,Rt)}})}reloadTile(xe,Ee){const Xe=this.loaded;return Xe&&Xe[xe.uid]?xe.partial?Ee(null,void 0):super.reloadTile(xe,Ee):this.loadTile(xe,Ee)}loadGeoJSON(xe,Ee){if(xe.request)o.n(xe.request,Ee);else{if(typeof xe.data!="string")return Ee(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`));try{return Ee(null,JSON.parse(xe.data))}catch{return Ee(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(xe,Ee){try{Ee(null,this._geoJSONIndex.getClusterExpansionZoom(xe.clusterId))}catch(Xe){Ee(Xe)}}getClusterChildren(xe,Ee){try{Ee(null,this._geoJSONIndex.getChildren(xe.clusterId))}catch(Xe){Ee(Xe)}}getClusterLeaves(xe,Ee){try{Ee(null,this._geoJSONIndex.getLeaves(xe.clusterId,xe.limit,xe.offset))}catch(Xe){Ee(Xe)}}}class hs{constructor(xe,Ee){this.tileID=new o.aA(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),this.tileZoom=xe.tileZoom,this.uid=xe.uid,this.zoom=xe.zoom,this.canonical=xe.tileID.canonical,this.pixelRatio=xe.pixelRatio,this.tileSize=xe.tileSize,this.source=xe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=xe.projection,this.brightness=Ee}parse(xe,Ee,Xe,nt){this.status="parsing";const Je=new o.aA(Xe.tileID.overscaledZ,Xe.tileID.wrap,Xe.tileID.canonical.z,Xe.tileID.canonical.x,Xe.tileID.canonical.y),pt={},Rt=Ee.familiesBySource[Xe.source],gt=new o.dR(Je,Xe.promoteId);return gt.bucketLayerIDs=[],gt.is3DTile=!0,o.e0(xe).then(Pt=>{if(!Pt)return nt(new Error("Could not parse tile"));const zt=o.e1(Pt,1/o.c8(Xe.tileID.canonical)),Bt=Pt.json.extensionsUsed&&Pt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Pt.json.asset.extras&&Pt.json.asset.extras.MAPBOX_mesh_features,ln=Pt.json.extensionsUsed&&Pt.json.extensionsUsed.includes("EXT_meshopt_compression"),Mn=new o.a3(this.zoom,{brightness:this.brightness});for(const Cn in Rt)for(const Ge of Rt[Cn]){const yt=Ge[0];gt.bucketLayerIDs.push(Ge.map(Ct=>Ct.id)),yt.recalculate(Mn,[]);const Mt=new o.e2(zt,Je,Bt,ln,this.brightness,gt);Bt||(Mt.needsUpload=!0),pt[yt.fqid]=Mt,Mt.evaluate(yt)}this.status="done",nt(null,{buckets:pt,featureIndex:gt})}).catch(Pt=>nt(new Error(Pt.message)))}}class Ps{constructor(xe,Ee,Xe,nt,Je,pt){this.actor=xe,this.layerIndex=Ee,this.brightness=pt,this.loading={},this.loaded={}}loadTile(xe,Ee){const Xe=xe.uid,nt=this.loading[Xe]=new hs(xe,this.brightness);o.bc(xe.request,(Je,pt)=>{const Rt=!this.loading[Xe];return delete this.loading[Xe],Rt||Je?(nt.status="done",Rt||(this.loaded[Xe]=nt),Ee(Je)):pt&&pt.byteLength!==0?void nt.parse(pt,this.layerIndex,xe,(gt,Pt)=>{nt.status="done",this.loaded=this.loaded||{},this.loaded[Xe]=nt,gt||!Pt?Ee(gt):Ee(null,Pt)}):(nt.status="done",this.loaded[Xe]=nt,Ee())})}reloadTile(xe,Ee){const Xe=this.loaded,nt=xe.uid;if(Xe&&Xe[nt]){const Je=Xe[nt];Je.projection=xe.projection,Je.brightness=xe.brightness;const pt=(Rt,gt)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(xe,Ee)),Ee(Rt,gt)};Je.status==="parsing"?Je.reloadCallback=pt:Je.status==="done"&&this.loadTile(xe,Ee)}}abortTile(xe,Ee){const Xe=xe.uid;this.loading[Xe]&&delete this.loading[Xe],Ee()}removeTile(xe,Ee){const Xe=this.loaded,nt=xe.uid;Xe&&Xe[nt]&&delete Xe[nt],Ee()}}class hi{constructor(xe){this.self=xe,this.actor=new o.e3(xe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bL({name:"mercator"}),this.workerSourceTypes={vector:C,geojson:Vr,"batched-model":Ps},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ee,Xe)=>{if(this.workerSourceTypes[Ee])throw new Error(`Worker source with name "${Ee}" already registered.`);this.workerSourceTypes[Ee]=Xe},this.self.registerRTLTextPlugin=Ee=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=Ee.applyArabicShaping,o.e4.processBidirectionalText=Ee.processBidirectionalText,o.e4.processStyledBidirectionalText=Ee.processStyledBidirectionalText}}clearCaches(xe,Ee,Xe){delete this.layerIndexes[xe],delete this.availableImages[xe],delete this.workerSources[xe],delete this.demWorkerSources[xe],delete this.rasterArrayWorkerSource,Xe()}checkIfReady(xe,Ee,Xe){Xe()}setReferrer(xe,Ee){this.referrer=Ee}spriteLoaded(xe,{scope:Ee,isLoaded:Xe}){if(this.isSpriteLoaded[xe]||(this.isSpriteLoaded[xe]={}),this.isSpriteLoaded[xe][Ee]=Xe,this.workerSources[xe]&&this.workerSources[xe][Ee])for(const nt in this.workerSources[xe][Ee]){const Je=this.workerSources[xe][Ee][nt];for(const pt in Je){const Rt=Je[pt];Rt instanceof C&&(Rt.isSpriteLoaded=Xe,Rt.fire(new o.x("isSpriteLoaded")))}}}setImages(xe,{scope:Ee,images:Xe},nt){if(this.availableImages[xe]||(this.availableImages[xe]={}),this.availableImages[xe][Ee]=Xe,this.workerSources[xe]&&this.workerSources[xe][Ee]){for(const Je in this.workerSources[xe][Ee]){const pt=this.workerSources[xe][Ee][Je];for(const Rt in pt)pt[Rt].availableImages=Xe}nt()}else nt()}setProjection(xe,Ee){this.projections[xe]=o.bL(Ee)}setBrightness(xe,Ee,Xe){this.brightness=Ee,Xe()}setLayers(xe,Ee,Xe){this.getLayerIndex(xe,Ee.scope).replace(Ee.layers,Ee.options),Xe()}updateLayers(xe,Ee,Xe){this.getLayerIndex(xe,Ee.scope).update(Ee.layers,Ee.removedIds,Ee.options),Xe()}loadTile(xe,Ee,Xe){Ee.projection=this.projections[xe]||this.defaultProjection,this.getWorkerSource(xe,Ee.type,Ee.source,Ee.scope).loadTile(Ee,Xe)}loadDEMTile(xe,Ee,Xe){this.getDEMWorkerSource(xe,Ee.source,Ee.scope).loadTile(Ee,Xe)}decodeRasterArray(xe,Ee,Xe){this.getRasterArrayWorkerSource().decodeRasterArray(Ee,Xe)}reloadTile(xe,Ee,Xe){Ee.projection=this.projections[xe]||this.defaultProjection,this.getWorkerSource(xe,Ee.type,Ee.source,Ee.scope).reloadTile(Ee,Xe)}abortTile(xe,Ee,Xe){this.getWorkerSource(xe,Ee.type,Ee.source,Ee.scope).abortTile(Ee,Xe)}removeTile(xe,Ee,Xe){this.getWorkerSource(xe,Ee.type,Ee.source,Ee.scope).removeTile(Ee,Xe)}removeSource(xe,Ee,Xe){if(!(this.workerSources[xe]&&this.workerSources[xe][Ee.scope]&&this.workerSources[xe][Ee.scope][Ee.type]&&this.workerSources[xe][Ee.scope][Ee.type][Ee.source]))return;const nt=this.workerSources[xe][Ee.scope][Ee.type][Ee.source];delete this.workerSources[xe][Ee.scope][Ee.type][Ee.source],nt.removeSource!==void 0?nt.removeSource(Ee,Xe):Xe()}loadWorkerSource(xe,Ee,Xe){try{this.self.importScripts(Ee.url),Xe()}catch(nt){Xe(nt.toString())}}syncRTLPluginState(xe,Ee,Xe){try{o.e4.setState(Ee);const nt=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&nt!=null){this.self.importScripts(nt);const Je=o.e4.isParsed();Xe(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${nt}`),Je)}}catch(nt){Xe(nt.toString())}}setDracoUrl(xe,Ee){this.dracoUrl=Ee}getAvailableImages(xe,Ee){this.availableImages[xe]||(this.availableImages[xe]={});let Xe=this.availableImages[xe][Ee];return Xe||(Xe=[]),Xe}getLayerIndex(xe,Ee){this.layerIndexes[xe]||(this.layerIndexes[xe]={});let Xe=this.layerIndexes[xe][Ee];return Xe||(Xe=this.layerIndexes[xe][Ee]=new v,Xe.scope=Ee),Xe}getWorkerSource(xe,Ee,Xe,nt){return this.workerSources[xe]||(this.workerSources[xe]={}),this.workerSources[xe][nt]||(this.workerSources[xe][nt]={}),this.workerSources[xe][nt][Ee]||(this.workerSources[xe][nt][Ee]={}),this.isSpriteLoaded[xe]||(this.isSpriteLoaded[xe]={}),this.workerSources[xe][nt][Ee][Xe]||(this.workerSources[xe][nt][Ee][Xe]=new this.workerSourceTypes[Ee]({send:(Je,pt,Rt,gt,Pt,zt)=>{this.actor.send(Je,pt,Rt,xe,Pt,zt)},scheduler:this.actor.scheduler},this.getLayerIndex(xe,nt),this.getAvailableImages(xe,nt),this.isSpriteLoaded[xe][nt],void 0,this.brightness)),this.workerSources[xe][nt][Ee][Xe]}getDEMWorkerSource(xe,Ee,Xe){return this.demWorkerSources[xe]||(this.demWorkerSources[xe]={}),this.demWorkerSources[xe][Xe]||(this.demWorkerSources[xe][Xe]={}),this.demWorkerSources[xe][Xe][Ee]||(this.demWorkerSources[xe][Xe][Ee]=new L),this.demWorkerSources[xe][Xe][Ee]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new k),this.rasterArrayWorkerSource}enforceCacheSizeLimit(xe,Ee){o.e5(Ee)}getWorkerPerformanceMetrics(xe,Ee,Xe){Xe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new hi(self)),hi}),a(["./shared"],function(o){var h="3.7.0";const d={create:"create",load:"load",fullLoad:"fullLoad"},m={mark(b){performance.mark(b)},measure(b,u,p){performance.measure(b,u,p)}};function v(b){const u=b.name.split("?")[0];return o.a(u)&&u.includes("mapbox-gl.js")?"javascript":o.a(u)&&u.includes("mapbox-gl.css")?"css":o.b(u)?"fontRange":o.c(u)?"sprite":o.i(u)?"style":o.d(u)?"tilejson":"other"}var y,S={},E=function(){if(y)return S;function b(w){return!u(w)}function u(w){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var P,F,W=new Blob([""],{type:"text/javascript"}),$=URL.createObjectURL(W);try{F=new Worker($),P=!0}catch{P=!1}return F&&F.terminate(),URL.revokeObjectURL($),P}()?function(){var P=document.createElement("canvas");P.width=P.height=1;var F=P.getContext("2d");if(!F)return!1;var W=F.getImageData(0,0,1,1);return W&&W.width===P.width}()?(p[I=w&&w.failIfMajorPerformanceCaveat]===void 0&&(p[I]=function(P){var F,W=function($){var J=document.createElement("canvas"),Q=Object.create(b.webGLContextAttributes);return Q.failIfMajorPerformanceCaveat=$,J.getContext("webgl2",Q)}(P);if(!W)return!1;try{F=W.createShader(W.VERTEX_SHADER)}catch{return!1}return!(!F||W.isContextLost())&&(W.shaderSource(F,"void main() {}"),W.compileShader(F),W.getShaderParameter(F,W.COMPILE_STATUS)===!0)}(I)),p[I]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var I}y=1,S.supported=b,S.notSupportedReason=u;var p={};return b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},S}();function M(b,u,p){const w=document.createElement(b);return u!=null&&(w.className=u),p&&p.appendChild(w),w}function C(b,u,p){const w=document.createElementNS("http://www.w3.org/2000/svg",b);for(const I of Object.keys(u))w.setAttributeNS(null,I,String(u[I]));return p&&p.appendChild(w),w}const L=typeof document<"u"?document.documentElement&&document.documentElement.style:null,k=L&&L.userSelect!==void 0?"userSelect":"WebkitUserSelect";let H;function q(){L&&k&&(H=L[k],L[k]="none")}function Z(){L&&k&&(L[k]=H)}function ee(b){b.preventDefault(),b.stopPropagation(),window.removeEventListener("click",ee,!0)}function re(){window.addEventListener("click",ee,!0),window.setTimeout(()=>{window.removeEventListener("click",ee,!0)},0)}function se(b,u){const p=b.getBoundingClientRect();return Se(b,p,u)}function ae(b,u){const p=b.getBoundingClientRect(),w=[];for(let I=0;I<u.length;I++)w.push(Se(b,p,u[I]));return w}function fe(b){return window.InstallTrigger!==void 0&&b.button===2&&b.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button}function Se(b,u,p){const w=b.offsetWidth===u.width?1:b.offsetWidth/u.width;return new o.P((p.clientX-u.left)*w,(p.clientY-u.top)*w)}const Ce="01",Ie="NO_ACCESS_TOKEN";class je{constructor(u,p,w){this._transformRequestFn=u,this._customAccessToken=p,this._silenceAuthErrors=!!w,this._createSkuToken()}_createSkuToken(){const u=function(){let p="";for(let w=0;w<10;w++)p+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ce,p].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,p){return this._transformRequestFn&&this._transformRequestFn(u,p)||{url:u}}normalizeStyleURL(u,p){if(!o.f(u))return u;const w=ot(u);return w.params.push(`sdk=js-${h}`),w.path=`/styles/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||p)}normalizeGlyphsURL(u,p){if(!o.f(u))return u;const w=ot(u);return w.path=`/fonts/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||p)}normalizeModelURL(u,p){if(!o.f(u))return u;const w=ot(u);return w.path=`/models/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||p)}normalizeSourceURL(u,p,w,I){if(!o.f(u))return u;const P=ot(u);return P.path=`/v4/${P.authority}.json`,P.params.push("secure"),w&&P.params.push(`language=${w}`),I&&P.params.push(`worldview=${I}`),this._makeAPIURL(P,this._customAccessToken||p)}normalizeSpriteURL(u,p,w,I){const P=ot(u);return o.f(u)?(P.path=`/styles/v1${P.path}/sprite${p}${w}`,this._makeAPIURL(P,this._customAccessToken||I)):(P.path+=`${p}${w}`,ye(P))}normalizeTileURL(u,p,w){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!o.f(u))return u;const I=ot(u);I.path=I.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${p||w&&I.authority!=="raster"&&w===512?"@2x":""}${o.m.supported?".webp":"$1"}`),I.authority==="raster"?I.path=`/${o.e.RASTER_URL_PREFIX}${I.path}`:I.authority==="rasterarrays"?I.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${I.path}`:I.authority==="3dtiles"?I.path=`/${o.e.TILES3D_URL_PREFIX}${I.path}`:(I.path=I.path.replace(/^.+\/v4\//,"/"),I.path=`/${o.e.TILE_URL_VERSION}${I.path}`);const P=this._customAccessToken||function(F){for(const W of F){const $=W.match(/^access_token=(.*)$/);if($)return $[1]}return null}(I.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&P&&this._skuToken&&I.params.push(`sku=${this._skuToken}`),this._makeAPIURL(I,P)}canonicalizeTileURL(u,p){const w=ot(u);if(!w.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!w.path.match(/\.[\w]+$/))return u;let I="mapbox://";w.path.match(/^\/raster\/v1\//)?I+=`raster/${w.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:w.path.match(/^\/rasterarrays\/v1\//)?I+=`rasterarrays/${w.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:I+=`tiles/${w.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let P=w.params;return p&&(P=P.filter(F=>!F.match(/^access_token=/))),P.length&&(I+=`?${P.join("&")}`),I}canonicalizeTileset(u,p){const w=!!p&&o.f(p),I=[];for(const P of u.tiles||[])o.h(P)?I.push(this.canonicalizeTileURL(P,w)):I.push(P);return I}_makeAPIURL(u,p){const w="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",I=ot(o.e.API_URL);if(u.protocol=I.protocol,u.authority=I.authority,u.protocol==="http"){const P=u.params.indexOf("secure");P>=0&&u.params.splice(P,1)}if(I.path!=="/"&&(u.path=`${I.path}${u.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return ye(u);if(p=p||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!p)throw new Error(`An API access token is required to use Mapbox GL. ${w}`);if(p[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${w}`)}return u.params=u.params.filter(P=>P.indexOf("access_token")===-1),u.params.push(`access_token=${p||""}`),ye(u)}}const Le=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ot(b){const u=b.match(Le);if(!u)throw new Error("Unable to parse URL object");return{protocol:u[1],authority:u[2],path:u[3]||"/",params:u[4]?u[4].split("&"):[]}}function ye(b){const u=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${u}`}const $e="mapbox.eventData";function Ve(b){if(!b)return null;const u=b.split(".");if(!u||u.length!==3)return null;try{return JSON.parse(o.j(u[1]))}catch{return null}}class _t{constructor(u){this.type=u,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(u){const p=Ve(o.e.ACCESS_TOKEN);let w="";return w=p&&p.u?o.k(p.u):o.e.ACCESS_TOKEN||"",u?`${$e}.${u}:${w}`:`${$e}:${w}`}fetchEventData(){const u=o.s("localStorage"),p=this.getStorageKey(),w=this.getStorageKey("uuid");if(u)try{const I=localStorage.getItem(p);I&&(this.eventData=JSON.parse(I));const P=localStorage.getItem(w);P&&(this.anonId=P)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const u=o.s("localStorage"),p=this.getStorageKey(),w=this.getStorageKey("uuid"),I=this.anonId;if(u&&I)try{localStorage.setItem(w,I),Object.keys(this.eventData).length>=1&&localStorage.setItem(p,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(u){}postEvent(u,p,w,I){if(!o.e.EVENTS_URL)return;const P=ot(o.e.EVENTS_URL);P.params.push(`access_token=${I||o.e.ACCESS_TOKEN||""}`);const F={event:this.type,created:new Date(u).toISOString()},W=p?o.l(F,p):F,$={url:ye(P),headers:{"Content-Type":"text/plain"},body:JSON.stringify([W])};this.pendingRequest=o.p($,J=>{this.pendingRequest=null,w(J),this.saveEventData(),this.processRequests(I)})}queueRequest(u,p){this.queue.push(u),this.processRequests(p)}}const wt=new class extends _t{constructor(b){super("appUserTurnstile"),this._customAccessToken=b}postTurnstileEvent(b,u){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(b)&&b.some(p=>o.f(p)||o.h(p))&&this.queueRequest(Date.now(),u)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const u=Ve(o.e.ACCESS_TOKEN),p=u?u.u:o.e.ACCESS_TOKEN;let w=p!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),w=!0);const I=this.queue.shift();if(this.eventData.lastSuccess){const P=new Date(this.eventData.lastSuccess),F=new Date(I),W=(I-this.eventData.lastSuccess)/864e5;w=w||W>=1||W<-1||P.getDate()!==F.getDate()}else w=!0;w?this.postEvent(I,{sdkIdentifier:"mapbox-gl-js",sdkVersion:h,skuId:Ce,"enabled.telemetry":!1,userId:this.anonId},P=>{P||(this.eventData.lastSuccess=I,this.eventData.tokenU=p)},b):this.processRequests()}},Vt=wt.postTurnstileEvent.bind(wt),lt=new class extends _t{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(b,u,p,w){this.skuToken=u,this.errorCb=w,o.e.EVENTS_URL&&(p||o.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},p):this.errorCb(new Error(Ie)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:u,timestamp:p}=this.queue.shift();u&&this.success[u]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:h,skuId:Ce,skuToken:this.skuToken,userId:this.anonId},w=>{w?this.errorCb(w):u&&(this.success[u]=!0)},b))}remove(){this.errorCb=null}},Ht=lt.postMapLoadEvent.bind(lt),Qt=new class extends _t{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(b){let u=this.mapInstanceIdMap.get(b);return u||(u=o.u(),this.mapInstanceIdMap.set(b,u)),u}getEventId(b){const u=this.eventIdPerMapInstanceMap.get(b)||0;return this.eventIdPerMapInstanceMap.set(b,u+1),u}postStyleLoadEvent(b,u){const{map:p,style:w,importedStyles:I}=u;if(!o.e.EVENTS_URL||!b&&!o.e.ACCESS_TOKEN)return;const P=this.getMapInstanceId(p),F={mapInstanceId:P,eventId:this.getEventId(P),style:w};I.length&&(F.importedStyles=I),this.queueRequest({timestamp:Date.now(),payload:F},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:u,payload:p}=this.queue.shift();this.postEvent(u,p,()=>{},b)}},rn=Qt.postStyleLoadEvent.bind(Qt),jn=new class extends _t{constructor(){super("gljs.performance")}postPerformanceEvent(b,u){o.e.EVENTS_URL&&(b||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:u},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:u,performanceData:p}=this.queue.shift(),w=function(I){const P=performance.getEntriesByType("resource"),F=performance.getEntriesByType("mark"),W=function(ue){const ve={};if(ue){for(const _e in ue)if(_e!=="other")for(const be of ue[_e]){const we=`${_e}ResolveRangeMin`,ke=`${_e}ResolveRangeMax`,Ne=`${_e}RequestCount`,De=`${_e}RequestCachedCount`;ve[we]=Math.min(ve[we]||1/0,be.startTime),ve[ke]=Math.max(ve[ke]||-1/0,be.responseEnd);const We=He=>{ve[He]===void 0&&(ve[He]=0),++ve[He]};be.transferSize!==void 0&&be.transferSize===0&&We(De),We(Ne)}}return ve}(function(ue,ve){const _e={};if(ue)for(const be of ue){const we=ve(be);_e[we]===void 0&&(_e[we]=[]),_e[we].push(be)}return _e}(P,v)),$=window.devicePixelRatio,J=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Q=J?J.effectiveType:void 0,oe={counters:[],metadata:[],attributes:[]},le=(ue,ve,_e)=>{_e!=null&&ue.push({name:ve,value:_e.toString()})};for(const ue in W)le(oe.counters,ue,W[ue]);if(I.interactionRange[0]!==1/0&&I.interactionRange[1]!==-1/0&&(le(oe.counters,"interactionRangeMin",I.interactionRange[0]),le(oe.counters,"interactionRangeMax",I.interactionRange[1])),F)for(const ue of Object.keys(d)){const ve=d[ue],_e=F.find(be=>be.name===ve);_e&&le(oe.counters,ve,_e.startTime)}return le(oe.counters,"visibilityHidden",I.visibilityHidden),le(oe.attributes,"style",function(ue){if(ue)for(const ve of ue){const _e=ve.name.split("?")[0];if(o.i(_e)){const be=_e.split("/").slice(-2);if(be.length===2)return`mapbox://styles/${be[0]}/${be[1]}`}}}(P)),le(oe.attributes,"terrainEnabled",I.terrainEnabled?"true":"false"),le(oe.attributes,"fogEnabled",I.fogEnabled?"true":"false"),le(oe.attributes,"projection",I.projection),le(oe.attributes,"zoom",I.zoom),le(oe.metadata,"devicePixelRatio",$),le(oe.metadata,"connectionEffectiveType",Q),le(oe.metadata,"navigatorUserAgent",navigator.userAgent),le(oe.metadata,"screenWidth",window.screen.width),le(oe.metadata,"screenHeight",window.screen.height),le(oe.metadata,"windowWidth",window.innerWidth),le(oe.metadata,"windowHeight",window.innerHeight),le(oe.metadata,"mapWidth",I.width/$),le(oe.metadata,"mapHeight",I.height/$),le(oe.metadata,"webglRenderer",I.renderer),le(oe.metadata,"webglVendor",I.vendor),le(oe.metadata,"sdkVersion",h),le(oe.metadata,"sdkIdentifier","mapbox-gl-js"),oe}(p);for(const I of w.metadata);for(const I of w.counters);for(const I of w.attributes);this.postEvent(u,w,()=>{},b)}},Bn=jn.postPerformanceEvent.bind(jn),Tn=new class extends _t{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(b,u,p,w){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const I=ot(o.e.API_URL+o.e.SESSION_PATH);I.params.push(`sku=${u||""}`),I.params.push(`access_token=${w||o.e.ACCESS_TOKEN||""}`);const P={url:ye(I),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(P,F=>{this.pendingRequest=null,p(F),this.saveEventData(),this.processRequests(w)})}getSessionAPI(b,u,p,w){this.skuToken=u,this.errorCb=w,o.e.SESSION_PATH&&o.e.API_URL&&(p||o.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},p):this.errorCb(new Error(Ie)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:u,timestamp:p}=this.queue.shift();u&&this.success[u]||this.getSession(p,this.skuToken,w=>{w?this.errorCb(w):u&&(this.success[u]=!0)},b)}remove(){this.errorCb=null}},Pe=Tn.getSessionAPI.bind(Tn),qe=new Set;function mn(b,u){u?qe.add(b):qe.delete(b)}class cn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(u,p){this._updatedSourceCaches[u]=p,this.setDirty()}discardSourceCacheUpdate(u){delete this._updatedSourceCaches[u]}updateLayer(u){const p=u.scope;this._updatedLayers[p]=this._updatedLayers[p]||new Set,this._updatedLayers[p].add(u.id),this.setDirty()}removeLayer(u){const p=u.scope;this._removedLayers[p]=this._removedLayers[p]||{},this._updatedLayers[p]=this._updatedLayers[p]||new Set,this._removedLayers[p][u.id]=u,this._updatedLayers[p].delete(u.id),this._updatedPaintProps.delete(u.fqid),this.setDirty()}getRemovedLayer(u){return this._removedLayers[u.scope]?this._removedLayers[u.scope][u.id]:null}discardLayerRemoval(u){this._removedLayers[u.scope]&&delete this._removedLayers[u.scope][u.id]}getLayerUpdatesByScope(){const u={};for(const p in this._updatedLayers)u[p]=u[p]||{},u[p].updatedIds=Array.from(this._updatedLayers[p].values());for(const p in this._removedLayers)u[p]=u[p]||{},u[p].removedIds=Object.keys(this._removedLayers[p]);return u}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(u){this._updatedPaintProps.add(u.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(u){this._updatedImages.add(u),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function St(b){const{userImage:u}=b;return!!(u&&u.render&&u.render())&&(b.data.replace(new Uint8Array(u.data.buffer)),!0)}class Jt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(u){this.images[u]={},this.loaded[u]=!1,this.updatedImages[u]={},this.patterns[u]={},this.callbackDispatchedThisFrame[u]={},this.atlasImage[u]=new o.r({width:1,height:1})}isLoaded(){for(const u in this.loaded)if(!this.loaded[u])return!1;return!0}setLoaded(u,p){if(this.loaded[p]!==u&&(this.loaded[p]=u,u)){for(const{ids:w,callback:I}of this.requestors)this._notify(w,p,I);this.requestors=[]}}hasImage(u,p){return!!this.getImage(u,p)}getImage(u,p){return this.images[p][u]}addImage(u,p,w){this._validate(u,w)&&(this.images[p][u]=w)}_validate(u,p){let w=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new o.t(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new o.t(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(p.content,p)||(this.fire(new o.t(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,p){if(!u)return!0;let w=0;for(const I of u){if(I[0]<w||I[1]<I[0]||p<I[1])return!1;w=I[1]}return!0}_validateContent(u,p){return!(u&&(u.length!==4||u[0]<0||p.data.width<u[0]||u[1]<0||p.data.height<u[1]||u[2]<0||p.data.width<u[2]||u[3]<0||p.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,p,w){w.version=this.images[p][u].version+1,this.images[p][u]=w,this.updatedImages[p][u]=!0}removeImage(u,p){const w=this.images[p][u];delete this.images[p][u],delete this.patterns[p][u],w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(u){return Object.keys(this.images[u])}getImages(u,p,w){let I=!0;const P=!!this.loaded[p];if(!P)for(const F of u)this.images[p][F]||(I=!1);P||I?this._notify(u,p,w):this.requestors.push({ids:u,scope:p,callback:w})}getUpdatedImages(u){return this.updatedImages[u]}_notify(u,p,w){const I={};for(const P of u){this.images[p][P]||this.fire(new o.x("styleimagemissing",{id:P}));const F=this.images[p][P];F?I[P]={data:F.data.clone(),pixelRatio:F.pixelRatio,sdf:F.sdf,version:F.version,stretchX:F.stretchX,stretchY:F.stretchY,content:F.content,hasRenderCallback:!!(F.userImage&&F.userImage.render)}:o.w(`Image "${P}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}w(null,I)}getPixelSize(u){const{width:p,height:w}=this.atlasImage[u];return{width:p,height:w}}getPattern(u,p,w){const I=this.patterns[p][u],P=this.getImage(u,p);if(!P)return null;if(I&&I.position.version===P.version)return I.position;if(I)I.position.version=P.version;else{const F={w:P.data.width+2*o.y,h:P.data.height+2*o.y,x:0,y:0},W=new o.I(F,P,o.y);this.patterns[p][u]={bin:F,position:W}}return this._updatePatternAtlas(p,w),this.patterns[p][u].position}bind(u,p){const w=u.gl;let I=this.atlasTexture[p];I?this.dirty&&(I.update(this.atlasImage[p]),this.dirty=!1):(I=new o.T(u,this.atlasImage[p],w.RGBA8),this.atlasTexture[p]=I),I.bind(w.LINEAR,w.CLAMP_TO_EDGE)}_updatePatternAtlas(u,p){const w=[];for(const W in this.patterns[u])w.push(this.patterns[u][W].bin);const{w:I,h:P}=o.z(w),F=this.atlasImage[u];F.resize({width:I||1,height:P||1});for(const W in this.patterns[u]){const{bin:$,position:J}=this.patterns[u][W];let Q=J.padding;const oe=$.x+Q,le=$.y+Q,ue=this.images[u][W].data,ve=ue.width,_e=ue.height;Q=Q>1?Q-1:Q,o.r.copy(ue,F,{x:0,y:0},{x:oe,y:le},{width:ve,height:_e},p),o.r.copy(ue,F,{x:0,y:_e-Q},{x:oe,y:le-Q},{width:ve,height:Q},p),o.r.copy(ue,F,{x:0,y:0},{x:oe,y:le+_e},{width:ve,height:Q},p),o.r.copy(ue,F,{x:ve-Q,y:0},{x:oe-Q,y:le},{width:Q,height:_e},p),o.r.copy(ue,F,{x:0,y:0},{x:oe+ve,y:le},{width:Q,height:_e},p),o.r.copy(ue,F,{x:ve-Q,y:_e-Q},{x:oe-Q,y:le-Q},{width:Q,height:Q},p),o.r.copy(ue,F,{x:0,y:_e-Q},{x:oe+ve,y:le-Q},{width:Q,height:Q},p),o.r.copy(ue,F,{x:0,y:0},{x:oe+ve,y:le+_e},{width:Q,height:Q},p),o.r.copy(ue,F,{x:ve-Q,y:0},{x:oe-Q,y:le+_e},{width:Q,height:Q},p)}this.dirty=!0}beginFrame(){for(const u in this.images)this.callbackDispatchedThisFrame[u]={}}dispatchRenderCallbacks(u,p){for(const w of u){if(this.callbackDispatchedThisFrame[p][w])continue;this.callbackDispatchedThisFrame[p][w]=!0;const I=this.images[p][w];St(I)&&this.updateImage(w,p,I)}}}function kn(b){const u=b.key,p=b.value,w=b.valueSpec||{},I=b.objectElementValidators||{},P=b.style,F=b.styleSpec;let W=[];const $=o.B(p);if($!=="object")return[new o.V(u,p,`object expected, ${$} found`)];for(const J in p){const Q=J.split(".")[0];let oe;I[Q]?oe=I[Q]:w[Q]?oe=Lt:I["*"]?oe=I["*"]:w["*"]&&(oe=Lt),oe?W=W.concat(oe({key:(u&&`${u}.`)+J,value:p[J],valueSpec:w[Q]||w["*"],style:P,styleSpec:F,object:p,objectKey:J},p)):W.push(new o.A(u,p[J],`unknown property "${J}"`))}for(const J in w)I[J]||w[J].required&&w[J].default===void 0&&p[J]===void 0&&W.push(new o.V(u,p,`missing required property "${J}"`));return W}function Gn(b){const u=b.value,p=b.valueSpec,w=b.style,I=b.styleSpec,P=b.key,F=b.arrayElementValidator||Lt;if(o.B(u)!=="array")return[new o.V(P,u,`array expected, ${o.B(u)} found`)];if(p.length&&u.length!==p.length)return[new o.V(P,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new o.V(P,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let W={type:p.value,values:p.values,minimum:p.minimum,maximum:p.maximum,function:void 0};I.$version<7&&(W.function=p.function),o.B(p.value)==="object"&&(W=p.value);let $=[];for(let J=0;J<u.length;J++)$=$.concat(F({array:u,arrayIndex:J,value:u[J],valueSpec:W,style:w,styleSpec:I,key:`${P}[${J}]`},!0));return $}function sn(b){const u=b.key,p=b.value,w=b.valueSpec;let I=o.B(p);if(I==="number"&&p!=p&&(I="NaN"),I!=="number")return[new o.V(u,p,`number expected, ${I} found`)];if("minimum"in w){let P=w.minimum;if(o.B(w.minimum)==="array"&&(P=w.minimum[b.arrayIndex]),p<P)return[new o.V(u,p,`${p} is less than the minimum value ${P}`)]}if("maximum"in w){let P=w.maximum;if(o.B(w.maximum)==="array"&&(P=w.maximum[b.arrayIndex]),p>P)return[new o.V(u,p,`${p} is greater than the maximum value ${P}`)]}return[]}function at(b){const u=b.valueSpec,p=o.D(b.value.type);let w,I,P,F={};const W=p!=="categorical"&&b.value.property===void 0,$=!W,J=o.B(b.value.stops)==="array"&&o.B(b.value.stops[0])==="array"&&o.B(b.value.stops[0][0])==="object",Q=kn({key:b.key,value:b.value,valueSpec:b.styleSpec.function,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{stops:function(ue){if(p==="identity")return[new o.V(ue.key,ue.value,'identity function may not have a "stops" property')];let ve=[];const _e=ue.value;return ve=ve.concat(Gn({key:ue.key,value:_e,valueSpec:ue.valueSpec,style:ue.style,styleSpec:ue.styleSpec,arrayElementValidator:oe})),o.B(_e)==="array"&&_e.length===0&&ve.push(new o.V(ue.key,_e,"array must have at least one stop")),ve},default:function(ue){return Lt({key:ue.key,value:ue.value,valueSpec:u,style:ue.style,styleSpec:ue.styleSpec})}}});return p==="identity"&&W&&Q.push(new o.V(b.key,b.value,'missing required property "property"')),p==="identity"||b.value.stops||Q.push(new o.V(b.key,b.value,'missing required property "stops"')),p==="exponential"&&b.valueSpec.expression&&!o.F(b.valueSpec)&&Q.push(new o.V(b.key,b.value,"exponential functions not supported")),b.styleSpec.$version>=8&&($&&!o.G(b.valueSpec)?Q.push(new o.V(b.key,b.value,"property functions not supported")):W&&!o.H(b.valueSpec)&&Q.push(new o.V(b.key,b.value,"zoom functions not supported"))),p!=="categorical"&&!J||b.value.property!==void 0||Q.push(new o.V(b.key,b.value,'"property" property is required')),Q;function oe(ue){let ve=[];const _e=ue.value,be=ue.key;if(o.B(_e)!=="array")return[new o.V(be,_e,`array expected, ${o.B(_e)} found`)];if(_e.length!==2)return[new o.V(be,_e,`array length 2 expected, length ${_e.length} found`)];if(J){if(o.B(_e[0])!=="object")return[new o.V(be,_e,`object expected, ${o.B(_e[0])} found`)];if(_e[0].zoom===void 0)return[new o.V(be,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new o.V(be,_e,"object stop key must have value")];const we=o.D(_e[0].zoom);if(typeof we!="number")return[new o.V(be,_e[0].zoom,"stop zoom values must be numbers")];if(P&&P>we)return[new o.V(be,_e[0].zoom,"stop zoom values must appear in ascending order")];we!==P&&(P=we,I=void 0,F={}),ve=ve.concat(kn({key:`${be}[0]`,value:_e[0],valueSpec:{zoom:{}},style:ue.style,styleSpec:ue.styleSpec,objectElementValidators:{zoom:sn,value:le}}))}else ve=ve.concat(le({key:`${be}[0]`,value:_e[0],valueSpec:{},style:ue.style,styleSpec:ue.styleSpec},_e));return o.J(o.K(_e[1]))?ve.concat([new o.V(`${be}[1]`,_e[1],"expressions are not allowed in function stops.")]):ve.concat(Lt({key:`${be}[1]`,value:_e[1],valueSpec:u,style:ue.style,styleSpec:ue.styleSpec}))}function le(ue,ve){const _e=o.B(ue.value),be=o.D(ue.value),we=ue.value!==null?ue.value:ve;if(w){if(_e!==w)return[new o.V(ue.key,we,`${_e} stop domain type must match previous stop domain type ${w}`)]}else w=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new o.V(ue.key,we,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&p!=="categorical"){let ke=`number expected, ${_e} found`;return o.G(u)&&p===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ue.key,we,ke)]}return p!=="categorical"||_e!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?p!=="categorical"&&_e==="number"&&typeof be=="number"&&typeof I=="number"&&I!==void 0&&be<I?[new o.V(ue.key,we,"stop domain values must appear in ascending order")]:(I=be,p==="categorical"&&be in F?[new o.V(ue.key,we,"stop domain values must be unique")]:(F[be]=!0,[])):[new o.V(ue.key,we,`integer expected, found ${String(be)}`)]}}function Ue(b){const u=(b.expressionContext==="property"?o.L:o.M)(o.K(b.value),b.valueSpec);if(u.result==="error")return u.value.map(w=>new o.V(`${b.key}${w.key}`,b.value,w.message));const p=u.value.expression||u.value._styleExpression.expression;if(b.expressionContext==="property"&&b.propertyKey==="text-font"&&!p.outputDefined())return[new o.V(b.key,b.value,`Invalid data expression for "${b.propertyKey}". Output values must be contained as literals within the expression.`)];if(b.expressionContext==="property"&&b.propertyType==="layout"&&!o.N(p))return[new o.V(b.key,b.value,'"feature-state" data expressions are not supported with layout properties.')];if(b.expressionContext==="filter")return $t(p,b);if(b.expressionContext&&b.expressionContext.indexOf("cluster")===0){if(!o.O(p,["zoom","feature-state"]))return[new o.V(b.key,b.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(b.expressionContext==="cluster-initial"&&!o.Q(p))return[new o.V(b.key,b.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $t(b,u){const p=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(u.valueSpec&&u.valueSpec.expression)for(const I of u.valueSpec.expression.parameters)p.delete(I);if(p.size===0)return[];const w=[];return b instanceof o.S&&p.has(b.name)?[new o.V(u.key,u.value,`["${b.name}"] expression is not supported in a filter for a ${u.object.type} layer with id: ${u.object.id}`)]:(b.eachChild(I=>{w.push(...$t(I,u))}),w)}function An(b){const u=b.key,p=b.value,w=b.valueSpec,I=[];return Array.isArray(w.values)?w.values.indexOf(o.D(p))===-1&&I.push(new o.V(u,p,`expected one of [${w.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(w.values).indexOf(o.D(p))===-1&&I.push(new o.V(u,p,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(p)} found`)),I}function Sn(b){return o.W(o.K(b.value))?Ue(o.C({},b,{expressionContext:"filter",valueSpec:b.styleSpec[`filter_${b.layerType||"fill"}`]})):jt(b)}function jt(b){const u=b.value,p=b.key;if(o.B(u)!=="array")return[new o.V(p,u,`array expected, ${o.B(u)} found`)];const w=b.styleSpec;let I,P=[];if(u.length<1)return[new o.V(p,u,"filter array must have at least 1 element")];switch(P=P.concat(An({key:`${p}[0]`,value:u[0],valueSpec:w.filter_operator,style:b.style,styleSpec:b.styleSpec})),o.D(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&o.D(u[1])==="$type"&&P.push(new o.V(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&P.push(new o.V(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(I=o.B(u[1]),I!=="string"&&P.push(new o.V(`${p}[1]`,u[1],`string expected, ${I} found`)));for(let F=2;F<u.length;F++)I=o.B(u[F]),o.D(u[1])==="$type"?P=P.concat(An({key:`${p}[${F}]`,value:u[F],valueSpec:w.geometry_type,style:b.style,styleSpec:b.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&P.push(new o.V(`${p}[${F}]`,u[F],`string, number, or boolean expected, ${I} found`));break;case"any":case"all":case"none":for(let F=1;F<u.length;F++)P=P.concat(jt({key:`${p}[${F}]`,value:u[F],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":I=o.B(u[1]),u.length!==2?P.push(new o.V(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):I!=="string"&&P.push(new o.V(`${p}[1]`,u[1],`string expected, ${I} found`))}return P}function mr(b,u){const p=b.key,w=b.style,I=b.layer,P=b.styleSpec,F=b.value,W=b.objectKey,$=P[`${u}_${b.layerType}`];if(!$)return[];const J=W.match(/^(.*)-transition$/);if(u==="paint"&&J&&$[J[1]]&&$[J[1]].transition)return Lt({key:p,value:F,valueSpec:P.transition,style:w,styleSpec:P});const Q=b.valueSpec||$[W];if(!Q)return[new o.A(p,F,`unknown property "${W}"`)];let oe;if(o.B(F)==="string"&&o.G(Q)&&!Q.tokens&&(oe=/^{([^}]+)}$/.exec(F))){const ue=`\`{ "type": "identity", "property": ${oe?JSON.stringify(oe[1]):'"_"'} }\``;return[new o.V(p,F,`"${W}" does not support interpolation syntax
Use an identity property function instead: ${ue}.`)]}const le=[];if(b.layerType==="symbol")W!=="text-field"||!w||w.glyphs||w.imports||le.push(new o.V(p,F,'use of "text-field" requires a style "glyphs" property')),W==="text-font"&&o.X(o.K(F))&&o.D(F.type)==="identity"&&le.push(new o.V(p,F,'"text-font" does not support identity functions'));else if(b.layerType==="model"&&u==="paint"&&I&&I.layout&&I.layout.hasOwnProperty("model-id")&&o.G(Q)&&(o.Y(Q)||o.H(Q))){const ue=o.L(o.K(F),Q),ve=ue.value.expression||ue.value._styleExpression.expression;ve&&!o.O(ve,["measure-light"])&&(W==="model-emissive-strength"&&o.Q(ve)&&o.N(ve)||le.push(new o.V(p,F,`${W} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return le.concat(Lt({key:b.key,value:F,valueSpec:Q,style:w,styleSpec:P,expressionContext:"property",propertyType:u,propertyKey:W}))}function Un(b){return mr(b,"paint")}function tr(b){return mr(b,"layout")}function Sr(b){let u=[];const p=b.value,w=b.key,I=b.style,P=b.styleSpec;p.type||p.ref||u.push(new o.V(w,p,'either "type" or "ref" is required'));let F=o.D(p.type);const W=o.D(p.ref);if(p.id){const $=o.D(p.id);for(let J=0;J<b.arrayIndex;J++){const Q=I.layers[J];o.D(Q.id)===$&&u.push(new o.V(w,p.id,`duplicate layer id "${p.id}", previously used at line ${Q.id.__line__}`))}}if("ref"in p){let $;["type","source","source-layer","filter","layout"].forEach(J=>{J in p&&u.push(new o.V(w,p[J],`"${J}" is prohibited for ref layers`))}),I.layers.forEach(J=>{o.D(J.id)===W&&($=J)}),$?$.ref?u.push(new o.V(w,p.ref,"ref cannot reference another ref layer")):F=o.D($.type):typeof W=="string"&&u.push(new o.V(w,p.ref,`ref layer "${W}" not found`))}else if(F!=="background"&&F!=="sky"&&F!=="slot")if(p.source){const $=I.sources&&I.sources[p.source],J=$&&o.D($.type);$?J==="vector"&&F==="raster"?u.push(new o.V(w,p.source,`layer "${p.id}" requires a raster source`)):J==="raster"&&F!=="raster"?u.push(new o.V(w,p.source,`layer "${p.id}" requires a vector source`)):J!=="vector"||p["source-layer"]?J==="raster-dem"&&F!=="hillshade"?u.push(new o.V(w,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="raster-array"||["raster","raster-particle"].includes(F)?F!=="line"||!p.paint||!p.paint["line-gradient"]&&!p.paint["line-trim-offset"]||J==="geojson"&&$.lineMetrics?F==="raster-particle"&&J!=="raster-array"&&u.push(new o.V(w,p.source,`layer "${p.id}" requires a 'raster-array' source.`)):u.push(new o.V(w,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new o.V(w,p.source,"raster-array source can only be used with layer type 'raster'.")):u.push(new o.V(w,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new o.V(w,p.source,`source "${p.source}" not found`))}else u.push(new o.V(w,p,'missing required property "source"'));return u=u.concat(kn({key:w,value:p,valueSpec:P.layer,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Lt({key:`${w}.type`,value:p.type,valueSpec:P.layer.type,style:b.style,styleSpec:b.styleSpec,object:p,objectKey:"type"}),filter:$=>Sn(o.C({layerType:F},$)),layout:$=>kn({layer:p,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":J=>tr(o.C({layerType:F},J))}}),paint:$=>kn({layer:p,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":J=>Un(o.C({layerType:F,layer:p},J))}})}})),u}function Ln(b){const u=b.value,p=b.key,w=o.B(u);return w!=="string"?[new o.V(p,u,`string expected, ${w} found`)]:[]}const ir={promoteId:function({key:b,value:u}){if(o.B(u)==="string")return Ln({key:b,value:u});{const p=[];for(const w in u)p.push(...Ln({key:`${b}.${w}`,value:u[w]}));return p}}};function ui(b){const u=b.value,p=b.key,w=b.styleSpec,I=b.style;if(!u.type)return[new o.V(p,u,'"type" is required')];const P=o.D(u.type);let F=[];switch(["vector","raster","raster-dem","raster-array"].includes(P)&&(u.url||u.tiles||F.push(new o.A(p,u,'Either "url" or "tiles" is required.'))),P){case"vector":case"raster":case"raster-dem":case"raster-array":return F=F.concat(kn({key:p,value:u,valueSpec:w[`source_${P.replace("-","_")}`],style:b.style,styleSpec:w,objectElementValidators:ir})),F;case"geojson":if(F=kn({key:p,value:u,valueSpec:w.source_geojson,style:I,styleSpec:w,objectElementValidators:ir}),u.cluster)for(const W in u.clusterProperties){const[$,J]=u.clusterProperties[W],Q=typeof $=="string"?[$,["accumulated"],["get",W]]:$;F.push(...Ue({key:`${p}.${W}.map`,value:J,expressionContext:"cluster-map"})),F.push(...Ue({key:`${p}.${W}.reduce`,value:Q,expressionContext:"cluster-reduce"}))}return F;case"video":return kn({key:p,value:u,valueSpec:w.source_video,style:I,styleSpec:w});case"image":return kn({key:p,value:u,valueSpec:w.source_image,style:I,styleSpec:w});case"canvas":return[new o.V(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return An({key:`${p}.type`,value:u.type,valueSpec:{values:Fr(w)},style:I,styleSpec:w})}}function Fr(b){return b.source.reduce((u,p)=>{const w=b[p];return w.type.type==="enum"&&(u=u.concat(Object.keys(w.type.values))),u},[])}function or(b){const u=b.value,p=b.styleSpec,w=p.light,I=b.style;let P=[];const F=o.B(u);if(u===void 0)return P;if(F!=="object")return P=P.concat([new o.V("light",u,`object expected, ${F} found`)]),P;for(const W in u){const $=W.match(/^(.*)-transition$/);P=P.concat($&&w[$[1]]&&w[$[1]].transition?Lt({key:W,value:u[W],valueSpec:p.transition,style:I,styleSpec:p}):w[W]?Lt({key:W,value:u[W],valueSpec:w[W],style:I,styleSpec:p}):[new o.V(W,u[W],`unknown property "${W}"`)])}return P}function Nr(b){const u=b.value;let p=[];if(!u)return p;const w=o.B(u);if(w!=="object")return p=p.concat([new o.V("light-3d",u,`object expected, ${w} found`)]),p;const I=b.styleSpec,P=I["light-3d"],F=b.key,W=b.style,$=b.style.lights;for(const oe of["type","id"])if(!(oe in u))return p=p.concat([new o.V("light-3d",u,`missing property ${oe} on light`)]),p;if(u.type&&$)for(let oe=0;oe<b.arrayIndex;oe++){const le=o.D(u.type),ue=$[oe];o.D(ue.type)===le&&p.push(new o.V(F,u.id,`duplicate light type "${u.type}", previously defined at line ${ue.id.__line__}`))}const J=`properties_light_${u.type}`;if(!(J in I))return p=p.concat([new o.V("light-3d",u,`Invalid light type ${u.type}`)]),p;const Q=I[J];for(const oe in u)if(oe==="properties"){const le=u[oe],ue=o.B(le);if(ue!=="object")return p=p.concat([new o.V("properties",le,`object expected, ${ue} found`)]),p;for(const ve in le)p=p.concat(Q[ve]?Lt({key:ve,value:le[ve],valueSpec:Q[ve],style:W,styleSpec:I}):[new o.A(b.key,le[ve],`unknown property "${ve}"`)])}else{const le=oe.match(/^(.*)-transition$/);p=p.concat(le&&P[le[1]]&&P[le[1]].transition?Lt({key:oe,value:u[oe],valueSpec:I.transition,style:W,styleSpec:I}):P[oe]?Lt({key:oe,value:u[oe],valueSpec:P[oe],style:W,styleSpec:I}):[new o.A(oe,u[oe],`unknown property "${oe}"`)])}return p}function Hr(b){const u=b.value,p=b.key,w=b.style,I=b.styleSpec,P=I.terrain;let F=[];const W=o.B(u);if(u===void 0||W==="null")return F;if(W!=="object")return F=F.concat([new o.V("terrain",u,`object expected, ${W} found`)]),F;for(const $ in u){const J=$.match(/^(.*)-transition$/);F=F.concat(J&&P[J[1]]&&P[J[1]].transition?Lt({key:$,value:u[$],valueSpec:I.transition,style:w,styleSpec:I}):P[$]?Lt({key:$,value:u[$],valueSpec:P[$],style:w,styleSpec:I}):[new o.A($,u[$],`unknown property "${$}"`)])}if(u.source){const $=w.sources&&w.sources[u.source],J=$&&o.D($.type);$?J!=="raster-dem"&&F.push(new o.V(p,u.source,`terrain cannot be used with a source of type ${String(J)}, it only be used with a "raster-dem" source type`)):F.push(new o.V(p,u.source,`source "${u.source}" not found`))}else F.push(new o.V(p,u,'terrain is missing required property "source"'));return F}function yi(b){const u=b.value,p=b.style,w=b.styleSpec,I=w.fog;let P=[];const F=o.B(u);if(u===void 0)return P;if(F!=="object")return P=P.concat([new o.V("fog",u,`object expected, ${F} found`)]),P;for(const W in u){const $=W.match(/^(.*)-transition$/);P=P.concat($&&I[$[1]]&&I[$[1]].transition?Lt({key:W,value:u[W],valueSpec:w.transition,style:p,styleSpec:w}):I[W]?Lt({key:W,value:u[W],valueSpec:I[W],style:p,styleSpec:w}):[new o.A(W,u[W],`unknown property "${W}"`)])}return P}const Fe={"*":()=>[],array:Gn,boolean:function(b){const u=b.value,p=b.key,w=o.B(u);return w!=="boolean"?[new o.V(p,u,`boolean expected, ${w} found`)]:[]},number:sn,color:function(b){const u=b.key,p=b.value,w=o.B(p);return w!=="string"?[new o.V(u,p,`color expected, ${w} found`)]:o.U.parseCSSColor(p)===null?[new o.V(u,p,`color expected, "${p}" found`)]:[]},enum:An,filter:Sn,function:at,layer:Sr,object:kn,source:ui,model:o.Z,light:or,"light-3d":Nr,terrain:Hr,fog:yi,string:Ln,formatted:function(b){return Ln(b).length===0?[]:Ue(b)},resolvedImage:function(b){return Ln(b).length===0?[]:Ue(b)},projection:function(b){const u=b.value,p=b.styleSpec,w=p.projection,I=b.style;let P=[];const F=o.B(u);if(F==="object")for(const W in u)P=P.concat(Lt({key:W,value:u[W],valueSpec:w[W],style:I,styleSpec:p}));else F!=="string"&&(P=P.concat([new o.V("projection",u,`object or string expected, ${F} found`)]));return P},import:function(b){const{value:u,styleSpec:p}=b,{data:w,...I}=u;Object.defineProperty(I,"__line__",{value:u.__line__,enumerable:!1});let P=kn(o.C({},b,{value:I,valueSpec:p.import}));return o.D(I.id)===""&&P.push(new o.V(`${b.key}.id`,I,"import id can't be an empty string")),w&&(P=P.concat(un(w,p,{key:`${b.key}.data`}))),P}};function Lt(b,u=!1){const p=b.value,w=b.valueSpec,I=b.styleSpec;if(w.expression&&o.X(o.D(p)))return at(b);if(w.expression&&o.J(o.K(p)))return Ue(b);if(w.type&&Fe[w.type]){const P=Fe[w.type](b);return u===!0&&P.length>0&&o.B(b.value)==="array"?Ue(b):P}return kn(o.C({},b,{valueSpec:w.type?I[w.type]:w}))}function Kt(b){const u=b.value,p=b.key,w=Ln(b);return w.length||(u.indexOf("{fontstack}")===-1&&w.push(new o.V(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&w.push(new o.V(p,u,'"glyphs" url must include a "{range}" token'))),w}function un(b,u=o._,p={}){return Lt({key:p.key||"",value:b,valueSpec:u.$root,styleSpec:u,style:b,objectElementValidators:{glyphs:Kt,"*":()=>[]}})}function En(b,u=o._){return Je(un(b,u))}const Ar=b=>Je(ui(b)),Vr=b=>Je(or(b)),hs=b=>Je(Nr(b)),Ps=b=>Je(Hr(b)),hi=b=>Je(yi(b)),Tt=b=>Je(Sr(b)),xe=b=>Je(Sn(b)),Ee=b=>Je(Un(b)),Xe=b=>Je(tr(b)),nt=b=>Je(o.Z(b));function Je(b){return b.slice().sort((u,p)=>u.line&&p.line?u.line-p.line:0)}function pt(b,u){let p=!1;if(u&&u.length)for(const w of u)w instanceof o.A?o.w(w.message):(b.fire(new o.t(new Error(w.message))),p=!0);return p}let Rt;class gt extends o.E{constructor(u,p="flat"){super(),this._transitionable=new o.$(Rt||(Rt=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(u,p),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,p,w={}){this._validate(Vr,u,w)||(this._transitionable.setTransitionOrValue(u),this.id=p)}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,w){return(!w||w.validate!==!1)&&pt(this,u.call(En,o.l({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}const Pt=new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)});let zt=class extends o.E{constructor(b,u,p,w){super(),this.scope=p,this._transitionable=new o.$(Pt,p,w),this._transitionable.setTransitionOrValue(b,w),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(b,u){this._transitionable.setTransitionOrValue(b,u)}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}getExaggeration(b){return this._transitioning.possiblyEvaluate(new o.a3(b)).get("exaggeration")}isZoomDependent(){const b=this._transitionable._values.exaggeration;return b!=null&&b.value!=null&&b.value.expression!=null&&b.value.expression instanceof o.a4}};const Bt=45,ln=65,Mn=.05;function Cn(b,u,p,w){const I=o.a7(Bt,ln,p),[P,F]=Ge(b,w);let W=1-Math.min(1,Math.exp((u-P)/(F-P)*-6));return W*=W*W,W=Math.min(1,1.00747*W),W*I*b.alpha}function Ge(b,u){const p=.5/Math.tan(.5*u);return[b.range[0]+p,b.range[1]+p]}function yt(b,u,p,w,I){const P=o.a6.vec3.transformMat4([],[u,p,w],I.mercatorFogMatrix);return Cn(b,o.a6.vec3.length(P),I.pitch,I._fov)}function Mt(b,u,p,w,I,P,F){const W=[[p,w,0],[I,w,0],[I,P,0],[p,P,0]];let $=Number.MAX_VALUE,J=-Number.MAX_VALUE;for(const Q of W){const oe=o.a6.vec3.transformMat4([],Q,u),le=o.a6.vec3.length(oe);$=Math.min($,le),J=Math.max(J,le)}return[Cn(b,$,F.pitch,F._fov),Cn(b,J,F.pitch,F._fov)]}const Ct=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});class It extends o.E{constructor(u,p,w,I){super(),this._transitionable=new o.$(Ct,w,new Map(I)),this.set(u,I),this._transitioning=this._transitionable.untransitioned(),this._transform=p,this.properties=new o.a8(Ct),this.scope=w}get state(){const u=this._transform,p=u.projection.name==="globe",w=o.a9(u.zoom),I=this.properties.get("range"),P=[.5,3];return{range:p?[o.aa(P[0],I[0],w),o.aa(P[1],I[1],w)]:I,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,p,w={}){if(this._validate(hi,u,w))return;const I=o.l({},u);for(const P of Object.keys(o._.fog))I[P]===void 0&&(I[P]=o._.fog[P].default);this._options=I,this._transitionable.setTransitionOrValue(this._options,p)}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(Bt,ln,u))*p.a}getOpacityAtLatLng(u,p){return this._transform.projection.supportsFog?function(w,I,P){const F=o.a5.fromLngLat(I),W=P.elevation?P.elevation.getAtPointOrZero(F):0;return yt(w,F.x,F.y,W,P)}(this.state,u,p):0}getOpacityForTile(u){if(!this._transform.projection.supportsFog)return[1,1];const p=this._transform.calculateFogTileMatrix(u.toUnwrapped());return Mt(this.state,p,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(u,p,w,I,P){return this._transform.projection.supportsFog?Mt(this.state,u,p,w,I,P,this._transform):[1,1]}getFovAdjustedRange(u){return this._transform.projection.supportsFog?Ge(this.state,u):[0,1]}isVisibleOnFrustum(u){if(!this._transform.projection.supportsFog)return!1;const p=[4,5,6,7];for(const w of p){const I=u.points[w];let P;if(I[2]>=0)P=I;else{const F=u.points[w-4];P=o.ac(F,I,F[2]/(F[2]-I[2]))}if(yt(this.state,P[0],P[1],0,this._transform)>=Mn)return!0}return!1}updateConfig(u){this._transitionable.setTransitionOrValue(this._options,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,w){return(!w||w.validate!==!1)&&pt(this,u.call(En,o.l({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class wn extends o.E{constructor(u,p,w,I){super(),this.scope=w,this._options=u,this.properties=new o.a8(p),this._transitionable=new o.$(p,w,new Map(I)),this._transitionable.setTransitionOrValue(u.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(u){this._transitionable.setTransitionOrValue(this._options.properties,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(u,p){this._options=u,this._transitionable.setTransitionOrValue(u.properties,p)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let _n,zn;class Xn{constructor(u,p,w,I){this.screenBounds=u,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,I)}static createFromScreenPoints(u,p){let w,I;if(u instanceof o.P||typeof u[0]=="number"){const P=o.P.convert(u);w=[P],I=p.isPointAboveHorizon(P)}else{const P=o.P.convert(u[0]),F=o.P.convert(u[1]);w=[P,F],I=o.ae(P,F).every(W=>p.isPointAboveHorizon(W))}return new Xn(w,p.getCameraPoint(),I,p)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(u){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const p=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],I=o.ae(p,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<w.x?I.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?I[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(I[3]=this.cameraPoint)),o.af(I,u)}bufferedCameraGeometryGlobe(u){const p=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],I=o.ae(p,w,u),P=this.cameraPoint.clone();switch(3*((P.y>p.y)+(P.y>w.y))+((P.x>p.x)+(P.x>w.x))){case 0:I[0]=P,I[4]=P.clone();break;case 1:I.splice(1,0,P);break;case 2:I[1]=P;break;case 3:I.splice(4,0,P);break;case 5:I.splice(2,0,P);break;case 6:I[3]=P;break;case 7:I.splice(3,0,P);break;case 8:I[2]=P}return I}containsTile(u,p,w,I=0){const P=u.queryPadding/p._pixelsPerMercatorPixel+1,F=w?this._bufferedCameraMercator(P,p):this._bufferedScreenMercator(P,p);let W=u.tileID.wrap+(F.unwrapped?I:0);const $=F.polygon.map(be=>o.ag(u.tileTransform,be,W));if(!o.ah($,0,0,o.ab,o.ab))return;W=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?I:0);const J=this.screenGeometryMercator.polygon.map(be=>o.ai(u.tileTransform,be,W)),Q=J.map(be=>new o.P(be[0],be[1])),oe=p.getFreeCameraOptions().position||new o.a5(0,0,0),le=o.ai(u.tileTransform,oe,W),ue=J.map(be=>{const we=o.a6.vec3.sub(be,be,le);return o.a6.vec3.normalize(we,we),new o.aj(le,we)}),ve=o.ak(u,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Q,tilespaceRays:ue,bufferedTilespaceGeometry:$,bufferedTilespaceBounds:(_e=o.al($),_e.min.x=o.ap(_e.min.x,0,o.ab),_e.min.y=o.ap(_e.min.y,0,o.ab),_e.max.x=o.ap(_e.max.x,0,o.ab),_e.max.y=o.ap(_e.max.y,0,o.ab),_e),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:ve};var _e}_bufferedScreenMercator(u,p){const w=dr(u);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{let I;return I=p.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(u),p):{polygon:this.bufferedScreenGeometry(u).map(P=>p.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[w]=I,I}}_bufferedCameraMercator(u,p){const w=dr(u);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{let I;return I=p.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),p):{polygon:this.bufferedCameraGeometry(u).map(P=>p.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[w]=I,I}}_projectAndResample(u,p){const w=function(P,F){const W=o.a6.mat4.multiply([],F.pixelMatrix,F.globeMatrix),$=[0,-o.aq,0,1],J=[0,o.aq,0,1],Q=[0,0,0,1];o.a6.vec4.transformMat4($,$,W),o.a6.vec4.transformMat4(J,J,W),o.a6.vec4.transformMat4(Q,Q,W);const oe=new o.P($[0]/$[3],$[1]/$[3]),le=new o.P(J[0]/J[3],J[1]/J[3]),ue=o.an(P,oe)&&$[3]<Q[3],ve=o.an(P,le)&&J[3]<Q[3];if(!ue&&!ve)return null;const _e=function(et,Ke,tt){for(let ut=1;ut<et.length;ut++){const st=gr(Ke.pointCoordinate3D(et[ut-1]).x),rt=gr(Ke.pointCoordinate3D(et[ut]).x);if(tt<0){if(st<rt)return{idx:ut,t:-st/(rt-1-st)}}else if(rt<st)return{idx:ut,t:(1-st)/(rt+1-st)}}return null}(P,F,ue?-1:1);if(!_e)return null;const{idx:be,t:we}=_e;let ke=be>1?lr(P.slice(0,be),F):[],Ne=be<P.length?lr(P.slice(be),F):[];ke=ke.map(et=>new o.P(gr(et.x),et.y)),Ne=Ne.map(et=>new o.P(gr(et.x),et.y));const De=[...ke];De.length===0&&De.push(Ne[Ne.length-1]);const We=o.aa(De[De.length-1].y,(Ne.length===0?ke[0]:Ne[0]).y,we);let He;return He=ue?[new o.P(0,We),new o.P(0,0),new o.P(1,0),new o.P(1,We)]:[new o.P(1,We),new o.P(1,1),new o.P(0,1),new o.P(0,We)],De.push(...He),Ne.length===0?De.push(ke[0]):De.push(...Ne),{polygon:De.map(et=>new o.a5(et.x,et.y)),unwrapped:!1}}(u,p);if(w)return w;const I=function(P,F){let W=!1,$=-1/0,J=0;for(let oe=0;oe<P.length-1;oe++)P[oe].x>$&&($=P[oe].x,J=oe);for(let oe=0;oe<P.length-1;oe++){const le=(J+oe)%(P.length-1),ue=P[le],ve=P[le+1];Math.abs(ue.x-ve.x)>.5&&(ue.x<ve.x?(ue.x+=1,le===0&&(P[P.length-1].x+=1)):(ve.x+=1,le+1===P.length-1&&(P[0].x+=1)),W=!0)}const Q=o.am(F.center.lng);return W&&Q<Math.abs(Q-1)&&P.forEach(oe=>{oe.x-=1}),{polygon:P,unwrapped:W}}(lr(u,p).map(P=>new o.P(gr(P.x),P.y)),p);return{polygon:I.polygon.map(P=>new o.a5(P.x,P.y)),unwrapped:I.unwrapped}}}function lr(b,u){return o.ao(b,p=>{const w=u.pointCoordinate3D(p);p.x=w.x,p.y=w.y},1/256)}function gr(b){return b<0?1+b%1:b%1}function dr(b){return 100*b|0}function fi(b,u,p,w,I){const P=function(W,$){if(W)return I(W);if($){if(b.url&&$.tiles&&b.tiles&&delete b.tiles,$.variants){if(!Array.isArray($.variants))return I(new Error("variants must be an array"));for(const Q of $.variants){if(Q==null||typeof Q!="object"||Q.constructor!==Object)return I(new Error("variant must be an object"));if(!Array.isArray(Q.capabilities))return I(new Error("capabilities must be an array"));if(Q.capabilities.length===1&&Q.capabilities[0]==="meshopt"){$=o.l($,Q);break}}}const J=o.ar(o.l($,b),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);$.vector_layers&&(J.vectorLayers=$.vector_layers,J.vectorLayerIds=J.vectorLayers.map(Q=>Q.id)),$.raster_layers&&(J.rasterLayers=$.raster_layers,J.rasterLayerIds=J.rasterLayers.map(Q=>Q.id)),J.tiles=u.canonicalizeTileset(J,b.url),I(null,J)}},F=function(W,$,J){if(!W)return null;if(!$&&!J)return W;J=J||W.worldview_default;const Q=Object.values(W.language||{});if(Q.length===0)return null;const oe=Object.values(W.worldview||{});if(oe.length===0)return null;const le=Q.every(ve=>ve===$),ue=oe.every(ve=>ve===J);return le&&ue?W:$ in(W.language_options||{})||J in(W.worldview_options||{})?null:W.language_options&&W.worldview_options?W:null}(b.data,p,w);return F?o.q.frame(()=>P(null,F)):b.url?o.n(u.transformRequest(u.normalizeSourceURL(b.url,null,p,w),o.R.Source),P):o.q.frame(()=>{const{data:W,...$}=b;P(null,$)})}class ki{constructor(u,p,w){this.bounds=o.as.convert(this.validateBounds(u)),this.minzoom=p||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const p=Math.pow(2,u.z),w=Math.floor(o.am(this.bounds.getWest())*p),I=Math.floor(o.at(this.bounds.getNorth())*p),P=Math.ceil(o.am(this.bounds.getEast())*p),F=Math.ceil(o.at(this.bounds.getSouth())*p);return u.x>=w&&u.x<P&&u.y>=I&&u.y<F}}class Hi extends o.E{constructor(u,p,w,I){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(p,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},p),this._collectResourceTiming=!!p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(I),this._tileWorkers={},this._deduped=new o.au}load(u){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,w=this.map._worldview;this._tileJSONRequest=fi(this._options,this.map._requestManager,p,w,(I,P)=>{this._tileJSONRequest=null,this._loaded=!0,I?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),w&&w.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${w}`),this.fire(new o.t(I))):P&&(o.l(this,P),P.bounds&&(this.tileBounds=new ki(P.bounds,this.minzoom,this.maxzoom)),Vt(P.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),u&&u(I)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(u){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(u,p){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),I=this.map._requestManager.transformRequest(w,o.R.Tile),P=this.map.style?this.map.style.getLut(this.scope):null,F={request:I,data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,lut:P?{image:P.image.clone()}:null,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:u.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(F.request.collectResourceTiming=this._collectResourceTiming,u.actor&&u.state!=="expired")u.state==="loading"?u.reloadCallback=p:u.request=u.actor.send("reloadTile",F,W.bind(this));else if(u.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",F,W.bind(this),void 0,!0);else{const $=o.aw.call({deduped:this._deduped},F,(J,Q)=>{J||!Q?W.call(this,J):(F.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},u.actor&&u.actor.send("loadTile",F,W.bind(this),void 0,!0))},!0);u.request={cancel:$}}function W($,J){return delete u.request,u.aborted?p(null):$&&$.status!==404?p($):(J&&J.resourceTiming&&(u.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&u.setExpiryData(J),u.loadVectorData(J,this.map.painter),o.ax(this.dispatcher),p(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(u,p){u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope}),u.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ss extends o.E{constructor(u,p,w,I){super(),this.id=u,this.dispatcher=w,this.setEventedParent(I),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},p),o.l(this,o.ar(p,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=fi(this._options,this.map._requestManager,null,null,(p,w)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new o.t(p)):w&&(o.l(this,w),w.bounds&&(this.tileBounds=new ki(w.bounds,this.minzoom,this.maxzoom)),Vt(w.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),u&&u(p)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(u){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,p){const w=o.q.devicePixelRatio>=2,I=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);u.request=o.o(this.map._requestManager.transformRequest(I,o.R.Tile),(P,F,W,$)=>(delete u.request,u.aborted?(u.state="unloaded",p(null)):P?(u.state="errored",p(P)):F?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:W,expires:$}),u.setTexture(F,this.map.painter),u.state="loaded",o.ax(this.dispatcher),void p(null)):p(null)))}abortTile(u,p){u.request&&(u.request.cancel(),delete u.request),p&&p()}unloadTile(u,p){u.texture&&u.texture instanceof o.T?(u.destroy(!0),u.texture&&u.texture instanceof o.T&&this.map.painter.saveTileTexture(u.texture)):u.destroy(),p&&p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Er extends Ss{constructor(u,p,w,I){super(u,p,w,I),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},p)}triggerRepaint(u){const p=this.map.painter._terrain,w=this.map.style.getSourceCache(this.id);p&&p.enabled&&w&&p._clearRenderCacheForTile(w.id,u.tileID),this.map.triggerRepaint()}loadTile(u,p){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),I=this.map._requestManager.transformRequest(w,o.R.Tile);u.requestParams=I,u.actor||(u.actor=this.dispatcher.getActor()),u.request=u.fetchHeader(void 0,(P,F,W,$)=>{if(delete u.request,u.aborted)return u.state="unloaded",p(null);if(P)return P.code===20?void 0:(u.state="errored",p(P));this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:W,expires:$}),u.state="empty",p(null)})}unloadTile(u,p){const w=u.texture;w&&w instanceof o.T?(u.destroy(!0),this.map.painter.saveTileTexture(w)):(u.destroy(),u.flushQueues(),u._isHeaderLoaded=!1,delete u._mrt,delete u.textureDescriptor),u.fbo&&(u.fbo.destroy(),delete u.fbo),delete u.request,delete u.requestParams,delete u.neighboringTiles,u.state="unloaded"}prepareTile(u,p,w){u._isHeaderLoaded&&(u.state!=="empty"&&(u.state="reloading"),u.fetchBand(p,w,(I,P)=>{if(I)return u.state="errored",this.fire(new o.t(I)),void this.triggerRepaint(u);P&&(u.setTexture(P,this.map.painter),u.state="loaded",this.triggerRepaint(u))}))}getInitialBand(u){if(!this.rasterLayers)return 0;const p=this.rasterLayers.find(({id:P})=>P===u),w=p&&p.fields,I=w&&w.bands&&w.bands;return I?I[0]:0}getTextureDescriptor(u,p,w){if(!u)return;const I=p.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!I)return;let P=null;p instanceof o.aB?P=p.paint.get("raster-array-band"):p instanceof o.aC&&(P=p.paint.get("raster-particle-array-band"));const F=P||this.getInitialBand(I);if(F!=null)if(u.textureDescriptor){if(!u.updateNeeded(I,F)||w)return Object.assign({},u.textureDescriptor,{texture:u.texture})}else this.prepareTile(u,I,F)}}const Qn={vector:Hi,raster:Ss,"raster-dem":class extends Ss{constructor(b,u,p,w){super(b,u,p,w),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(b,u){const p=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(I,P){I&&(b.state="errored",u(I)),P&&(b.dem=P,b.dem.onDeserialize(),b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0,b.state="loaded",u(null))}b.request=o.o(this.map._requestManager.transformRequest(p,o.R.Tile),(function(I,P,F,W){if(delete b.request,b.aborted)b.state="unloaded",u(null);else if(I)b.state="errored",u(I);else if(P){this.map._refreshExpiredTiles&&b.setExpiryData({cacheControl:F,expires:W});const $=ImageBitmap&&P instanceof ImageBitmap&&o.ay(),J=1-(P.width-o.az(P.width))/2;J<1||b.neighboringTiles||(b.neighboringTiles=this._getNeighboringTiles(b.tileID));const Q=$?P:o.q.getImageData(P,J),oe={uid:b.uid,coord:b.tileID,source:this.id,scope:this.scope,rawImageData:Q,encoding:this.encoding,padding:J};b.actor&&b.state!=="expired"||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",oe,w.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(b){const u=b.canonical,p=Math.pow(2,u.z),w=(u.x-1+p)%p,I=u.x===0?b.wrap-1:b.wrap,P=(u.x+1+p)%p,F=u.x+1===p?b.wrap+1:b.wrap,W={};return W[new o.aA(b.overscaledZ,I,u.z,w,u.y).key]={backfilled:!1},W[new o.aA(b.overscaledZ,F,u.z,P,u.y).key]={backfilled:!1},u.y>0&&(W[new o.aA(b.overscaledZ,I,u.z,w,u.y-1).key]={backfilled:!1},W[new o.aA(b.overscaledZ,b.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},W[new o.aA(b.overscaledZ,F,u.z,P,u.y-1).key]={backfilled:!1}),u.y+1<p&&(W[new o.aA(b.overscaledZ,I,u.z,w,u.y+1).key]={backfilled:!1},W[new o.aA(b.overscaledZ,b.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},W[new o.aA(b.overscaledZ,F,u.z,P,u.y+1).key]={backfilled:!1}),W}},"raster-array":Er,geojson:class extends o.E{constructor(b,u,p,w){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(w),this._data=u.data,this._options=o.l({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.minzoom!==void 0&&(this.minzoom=u.minzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const I=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*I,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*I,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.ab,radius:(u.clusterRadius!==void 0?u.clusterRadius:50)*I,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter,dynamic:u.dynamic},u.workerOptions)}onAdd(b){this.map=b,this.setData(this._data)}setData(b){return this._data=b,this._updateWorkerData(),this}updateData(b){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof b!="string"&&(b.type==="Feature"&&(b={type:"FeatureCollection",features:[b]}),b.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof b!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const u=new Map;for(const p of this._data.features)u.set(p.id,p);for(const p of b.features)u.set(p.id,p);this._data.features=[...u.values()]}else this._data=b;return this._updateWorkerData(!0),this}getClusterExpansionZoom(b,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id,scope:this.scope},u),this}getClusterChildren(b,u){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id,scope:this.scope},u),this}getClusterLeaves(b,u,p,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:b,limit:u,offset:p},w),this}_updateWorkerData(b=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const u=o.l({append:b},this.workerOptions);u.scope=this.scope;const p=this._data;typeof p=="string"?(u.request=this.map._requestManager.transformRequest(o.q.resolveURL(p),o.R.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(p),this._pendingLoad=this.actor.send(`${this.type}.loadData`,u,(w,I)=>{if(this._loaded=!0,this._pendingLoad=null,w)this.fire(new o.t(w));else{const P={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&I&&I.resourceTiming&&I.resourceTiming[this.id]&&(P.resourceTiming=I.resourceTiming[this.id]),b&&(this._partialReload=!0),this.fire(new o.x("data",P)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(b),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(b,u){const p=b.actor?"reloadTile":"loadTile";b.actor=this.actor;const w=this.map.style?this.map.style.getLut(this.scope):null,I=this._partialReload,P={type:this.type,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w?{image:w.image.clone()}:null,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:I};b.request=this.actor.send(p,P,(F,W)=>I&&!W?(b.state="loaded",u(null)):(delete b.request,b.destroy(),b.aborted?u(null):F?u(F):(b.loadVectorData(W,this.map.painter,p==="reloadTile"),u(null))),void 0,p==="loadTile")}abortTile(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0}unloadTile(b,u){this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id,scope:this.scope}),b.destroy()}onRemove(b){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(b,u,p,w){super(b,u,p,w),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const b=this.options;this.urls=[];for(const u of b.urls)this.urls.push(this.map._requestManager.transformRequest(u,o.R.Source).url);o.aE(this.urls,(u,p)=>{this._loaded=!0,u?this.fire(new o.t(u)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const u=this.video.seekable;b<u.start(0)||b>u.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,u=b.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(b,this.video,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(b)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(b,u,p,w){super(),this.id=b,this.type="model",this.models=[],this._loaded=!1,this._options=u}load(){const b=[];for(const u in this._options.models){const p=this._options.models[u],w=o.aG(this.map._requestManager.transformRequest(p.uri,o.R.Model).url).then(I=>{if(!I)return;const P=o.aH(I),F=new o.aI(u,p.position,p.orientation,P);F.computeBoundsAndApplyParent(),this.models.push(F)}).catch(I=>{this.fire(new o.t(new Error(`Could not load model ${u} from ${p.uri}: ${I.message}`)))});b.push(w)}return Promise.allSettled(b).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(u=>{this.fire(new o.t(new Error(`Could not load models: ${u.message}`)))})}onAdd(b){this.map=b,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(b,u){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(b,u,p,w){super(),this.type="batched-model",this.id=b,this.tileSize=512,this._options=u,this.tiles=this._options.tiles,this.maxzoom=u.maxzoom||19,this.minzoom=u.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=p,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(w)}onAdd(b){this.map=b,this.load()}load(b){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=fi(this._options,this.map._requestManager,u,p,(w,I)=>{this._tileJSONRequest=null,this._loaded=!0,w?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),p&&p.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.t(w))):I&&(o.l(this,I),I.bounds&&(this.tileBounds=new ki(I.bounds,this.minzoom,this.maxzoom)),Vt(I.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),b&&b(w)})}hasTransition(){return!1}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}loaded(){return this._loaded}loadTile(b,u){const p=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(p,o.R.Tile),data:void 0,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:b.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(b.actor&&b.state!=="expired")if(b.state==="loading")b.reloadCallback=u;else{if(b.buckets){const P=Object.values(b.buckets);for(const F of P)F.dirty=!0;return void(b.state="loaded")}b.request=b.actor.send("reloadTile",w,I.bind(this))}else b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",w,I.bind(this),void 0,!0);function I(P,F){return b.aborted?u(null):P&&P.status!==404?u(P):(F&&(F.resourceTiming&&(b.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&b.setExpiryData(F),b.buckets={...b.buckets,...F.buckets},F.featureIndex&&(b.latestFeatureIndex=F.featureIndex)),b.state="loaded",void u(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(b,u,p,w){super(b,u,p,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(P=>typeof P!="number"))||this.fire(new o.t(new o.V(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${b}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${b}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(b){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context;this.texture?!b&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(u,this.canvas,u.gl.RGBA8,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}},custom:class extends o.E{constructor(b,u,p,w){super(),this.id=b,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=u,this.setEventedParent(w),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ki(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(b){this.map=b,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(b),this.load()}onRemove(b){this._implementation.onRemove&&this._implementation.onRemove(b)}hasTile(b){if(this._implementation.hasTile){const{x:u,y:p,z:w}=b.canonical;return this._implementation.hasTile({x:u,y:p,z:w})}return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b,u){const{x:p,y:w,z:I}=b.tileID.canonical,P=new AbortController;b.request=Promise.resolve(this._implementation.loadTile({x:p,y:w,z:I},{signal:P.signal})).then((function(F){return delete b.request,b.aborted?(b.state="unloaded",u(null)):F===void 0?(b.state="errored",u(null)):F===null?(this.loadTileData(b,{width:this.tileSize,height:this.tileSize,data:null}),b.state="loaded",u(null)):function(W){return W instanceof ImageData||W instanceof HTMLCanvasElement||W instanceof ImageBitmap||W instanceof HTMLImageElement}(F)?(this.loadTileData(b,F),b.state="loaded",void u(null)):(b.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(F=>{F.code!==20&&(b.state="errored",u(F))}),b.request.cancel=()=>P.abort()}loadTileData(b,u){b.setTexture(u,this.map.painter)}unloadTile(b,u){if(b.texture&&b.texture instanceof o.T?(b.destroy(!0),b.texture&&b.texture instanceof o.T&&this.map.painter.saveTileTexture(b.texture)):b.destroy(),this._implementation.unloadTile){const{x:p,y:w,z:I}=b.tileID.canonical;this._implementation.unloadTile({x:p,y:w,z:I})}u&&u()}abortTile(b,u){b.request&&b.request.cancel&&(b.request.cancel(),delete b.request),u&&u()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(b=>({x:b.canonical.x,y:b.canonical.y,z:b.canonical.z}))}_clearTiles(){const b=o.av(this.id,this.scope);this.map.style.clearSource(b)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},Zi=function(b,u,p,w){const I=new Qn[u.type](b,u,p,w);if(I.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${I.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],I),I};function qr(b,u){const p=o.a6.mat4.identity([]);return o.a6.mat4.scale(p,p,[.5*b.width,.5*-b.height,1]),o.a6.mat4.translate(p,p,[1,-1,0]),o.a6.mat4.multiply(p,p,b.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(p)}function _s(b,u,p,w,I,P,F,W=!1){const $=b.tilesIn(w,F,W);$.sort(Ls);const J=[];for(const oe of $)J.push({wrappedTileID:oe.tile.tileID.wrapped().key,queryResults:oe.tile.queryRenderedFeatures(u,p,b._state,oe,I,P,qr(b.transform,oe.tile.tileID),W)});const Q=function(oe){const le={},ue={};for(const ve of oe){const _e=ve.queryResults,be=ve.wrappedTileID,we=ue[be]=ue[be]||{};for(const ke in _e){const Ne=_e[ke],De=we[ke]=we[ke]||{},We=le[ke]=le[ke]||[];for(const He of Ne)De[He.featureIndex]||(De[He.featureIndex]=!0,We.push(He))}}return le}(J);for(const oe in Q)Q[oe].forEach(le=>{const ue=le.feature,ve=ue.layer;ve&&ve.type!=="background"&&ve.type!=="sky"&&ve.type!=="slot"&&(ue.source=ve.source,ve["source-layer"]&&(ue.sourceLayer=ve["source-layer"]),ue.state=ue.id!==void 0?b.getFeatureState(ve["source-layer"],ue.id):{})});return Q}function Xo(b,u){const p=b.getRenderableIds().map(P=>b.getTileByID(P)),w=[],I={};for(let P=0;P<p.length;P++){const F=p[P],W=F.tileID.canonical.key;I[W]||(I[W]=!0,F.querySourceFeatures(w,u))}return w}function Ls(b,u){const p=b.tileID,w=u.tileID;return p.overscaledZ-w.overscaledZ||p.canonical.y-w.canonical.y||p.wrap-w.wrap||p.canonical.x-w.canonical.x}const fs=32,Pi=33,oo=new Uint16Array(8184);for(let b=0;b<2046;b++){let u=b+2,p=0,w=0,I=0,P=0,F=0,W=0;for(1&u?I=P=F=fs:p=w=W=fs;(u>>=1)>1;){const J=p+I>>1,Q=w+P>>1;1&u?(I=p,P=w,p=F,w=W):(p=I,w=P,I=F,P=W),F=J,W=Q}const $=4*b;oo[$+0]=p,oo[$+1]=w,oo[$+2]=I,oo[$+3]=P}const Po=new Uint16Array(2178),As=new Uint8Array(1089),Bc=new Uint16Array(1089);function Ra(b){return b===0?-.03125:b===32?.03125:0}const ld={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class kc{constructor(u,p,w,I,P){this.tileID=u,this.uid=o.aP(),this.uses=0,this.tileSize=p,this.tileZoom=w,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=P,I&&I.style&&(this._lastUpdatedBrightness=I.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",I&&I.transform&&(this.projection=I.transform.projection)}registerFadeDuration(u){const p=u+this.timeAdded;p<o.q.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(u,p,w){if(this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=function(I,P){const F={};if(!P)return F;for(const W of I){const $=W.layerIds.map(J=>P.getLayer(J)).filter(Boolean);if($.length!==0){W.layers=$,W.stateDependentLayerIds&&(W.stateDependentLayers=W.stateDependentLayerIds.map(J=>$.filter(Q=>Q.id===J)[0]));for(const J of $)F[J.fqid]=W}}return F}(u.buckets,p.style),this.hasSymbolBuckets=!1;for(const I in this.buckets){const P=this.buckets[I];if(P instanceof o.aR){if(this.hasSymbolBuckets=!0,!w)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const I in this.buckets){const P=this.buckets[I];if(P instanceof o.aR&&P.hasRTLText){this.hasRTLText=!0,o.aS();break}}this.queryPadding=0;for(const I in this.buckets){const P=this.buckets[I],F=p.style.getOwnLayer(I);if(!F)continue;const W=F.queryRadius(P);this.queryPadding=Math.max(this.queryPadding,W)}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),u.lineAtlas&&(this.lineAtlas=u.lineAtlas),this._lastUpdatedBrightness=u.brightness}else this.collisionBoxArray=new o.aQ}unloadVectorData(){if(this.hasData()){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(u){return this.buckets[u.fqid]}upload(u){for(const I in this.buckets){const P=this.buckets[I];P.uploadPending()&&P.upload(u)}const p=u.gl,w=this.imageAtlas;if(w&&!w.uploaded){const I=!!Object.keys(w.patternPositions).length;this.imageAtlasTexture=new o.T(u,w.image,p.RGBA8,{useMipmap:I}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(u,this.glyphAtlasImage,p.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(u,this.lineAtlas.image,p.R8),this.lineAtlas.uploaded=!0)}prepare(u,p,w){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture,w),!p||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const I=p.style.getBrightness();(this._lastUpdatedBrightness||I)&&(this._lastUpdatedBrightness&&I&&Math.abs(this._lastUpdatedBrightness-I)<.001||(this._lastUpdatedBrightness=I,this.updateBuckets(p)))}queryRenderedFeatures(u,p,w,I,P,F,W,$){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:I,pixelPosMatrix:W,transform:F,params:P,tileTransform:this.tileTransform},u,p,w):{}}querySourceFeatures(u,p){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const I=w.loadVTLayers(),P=p?p.sourceLayer:"",F=I._geojsonTileLayer||I[P];if(!F)return;const W=o.aT(p&&p.filter),{z:$,x:J,y:Q}=this.tileID.canonical,oe={z:$,x:J,y:Q};for(let le=0;le<F.length;le++){const ue=F.feature(le);if(W.needGeometry){const be=o.aU(ue,!0);if(!W.filter(new o.a3(this.tileID.overscaledZ),be,this.tileID.canonical))continue}else if(!W.filter(new o.a3(this.tileID.overscaledZ),ue))continue;const ve=w.getId(ue,P),_e=new o.aV(ue,$,J,Q,ve);_e.tile=oe,u.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const p=this.expirationTime;if(u.cacheControl){const w=o.aW(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let I=!1;if(this.expirationTime>w)I=!1;else if(p)if(this.expirationTime<p)I=!0;else{const P=this.expirationTime-p;P?this.expirationTime=w+Math.max(P,3e4):I=!0}else I=!0;I?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(u,p){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(u).length!==0&&p&&this.updateBuckets(p)}updateBuckets(u){if(!this.latestFeatureIndex)return;const p=this.latestFeatureIndex.loadVTLayers(),w=u.style.listImages(),I=u.style.getBrightness();for(const P in this.buckets){if(!u.style.hasLayer(P))continue;const F=this.buckets[P],W=F.layers[0].sourceLayer||"_geojsonTileLayer",$=p[W],J=u.style.getOwnSourceCache(F.layers[0].source);let Q={};J&&(Q=J._state.getState(W,void 0)),F.update(Q,$,w,this.imageAtlas&&this.imageAtlas.patternPositions||{},I),(F instanceof o.aX||F instanceof o.aY)&&u._terrain&&u._terrain.enabled&&J&&F.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(J.id,this.tileID);const oe=u&&u.style&&u.style.getOwnLayer(P);oe&&(this.queryPadding=Math.max(this.queryPadding,oe.queryRadius(F)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(u){this.symbolFadeHoldUntil=o.q.now()+u}setTexture(u,p){const w=p.context,I=w.gl;this.texture=this.texture||p.getTileTexture(u.width),this.texture&&this.texture instanceof o.T?this.texture.update(u):(this.texture=new o.T(w,u,I.RGBA8,{useMipmap:!0}),this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE))}setDependencies(u,p){const w={};for(const I of p)w[I]=!0;this.dependencies[u]=w}hasDependency(u,p){for(const w of u){const I=this.dependencies[w];if(I){for(const P of p)if(I[P])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(u,p){if(!p||p.name==="mercator"||this._tileDebugBuffer)return;const w=o.aZ(ld,this.tileID.canonical,this.tileTransform)[0],I=new o.a_,P=new o.a$;for(let F=0;F<w.length;F++){const{x:W,y:$}=w[F];I.emplaceBack(W,$),P.emplaceBack(F)}P.emplaceBack(0),this._tileDebugIndexBuffer=u.createIndexBuffer(P),this._tileDebugBuffer=u.createVertexBuffer(I,o.b0.members),this._tileDebugSegments=o.b1.simpleSegment(0,0,I.length,P.length)}_makeTileBoundsBuffers(u,p){if(this._tileBoundsBuffer||!p||p.name==="mercator")return;const w=o.aZ(ld,this.tileID.canonical,this.tileTransform)[0];let I,P;if(this.isRaster){const F=function(W,$){const J=o.aK(W,$),Q=Math.pow(2,W.z);for(let be=0;be<Pi;be++)for(let we=0;we<Pi;we++){const ke=o.aL((W.x+(we+Ra(we))/fs)/Q),Ne=o.aM((W.y+(be+Ra(be))/fs)/Q),De=$.project(ke,Ne),We=be*Pi+we;Po[2*We+0]=Math.round((De.x*J.scale-J.x)*o.ab),Po[2*We+1]=Math.round((De.y*J.scale-J.y)*o.ab)}As.fill(0),Bc.fill(0);for(let be=2045;be>=0;be--){const we=4*be,ke=oo[we+0],Ne=oo[we+1],De=oo[we+2],We=oo[we+3],He=ke+De>>1,et=Ne+We>>1,Ke=He+et-Ne,tt=et+ke-He,ut=Ne*Pi+ke,st=We*Pi+De,rt=et*Pi+He,xt=Math.hypot((Po[2*ut+0]+Po[2*st+0])/2-Po[2*rt+0],(Po[2*ut+1]+Po[2*st+1])/2-Po[2*rt+1])>=16;As[rt]=As[rt]||(xt?1:0),be<1022&&(As[rt]=As[rt]||As[(Ne+tt>>1)*Pi+(ke+Ke>>1)]||As[(We+tt>>1)*Pi+(De+Ke>>1)])}const oe=new o.aN,le=new o.aO;let ue=0;function ve(be,we){const ke=we*Pi+be;return Bc[ke]===0&&(oe.emplaceBack(Po[2*ke+0],Po[2*ke+1],be*o.ab/fs,we*o.ab/fs),Bc[ke]=++ue),Bc[ke]-1}function _e(be,we,ke,Ne,De,We){const He=be+ke>>1,et=we+Ne>>1;if(Math.abs(be-De)+Math.abs(we-We)>1&&As[et*Pi+He])_e(De,We,be,we,He,et),_e(ke,Ne,De,We,He,et);else{const Ke=ve(be,we),tt=ve(ke,Ne),ut=ve(De,We);le.emplaceBack(Ke,tt,ut)}}return _e(0,0,fs,fs,fs,0),_e(fs,fs,0,0,0,fs),{vertices:oe,indices:le}}(this.tileID.canonical,p);I=F.vertices,P=F.indices}else{I=new o.aN,P=new o.aO;for(const{x:W,y:$}of w)I.emplaceBack(W,$,0,0);const F=o.b2(I.int16,void 0,4);for(let W=0;W<F.length;W+=3)P.emplaceBack(F[W],F[W+1],F[W+2])}this._tileBoundsBuffer=u.createVertexBuffer(I,o.b3.members),this._tileBoundsIndexBuffer=u.createIndexBuffer(P),this._tileBoundsSegments=o.b1.simpleSegment(0,0,I.length,P.length)}_makeGlobeTileDebugBuffers(u,p){const w=p.projection;if(!w||w.name!=="globe"||p.freezeTileCoverage)return;const I=this.tileID.canonical,P=o.b4(I,p),F=o.b5(P),W=o.a9(p.zoom);let $;W>0&&($=o.a6.mat4.invert(new Float64Array(16),p.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(u,I,p,F,$,W),this._makeGlobeTileDebugTextBuffer(u,I,p,F,$,W)}_globePoint(u,p,w,I,P,F,W){let $=o.b6(u,p,w);if(F){const J=1<<w.z,Q=o.am(I.center.lng),oe=o.at(I.center.lat),le=(w.x+.5)/J-Q;let ue=0;le>.5?ue=-1:le<-.5&&(ue=1);let ve=(u/o.ab+w.x)/J+ue,_e=(p/o.ab+w.y)/J;ve=(ve-Q)*I._pixelsPerMercatorPixel+Q,_e=(_e-oe)*I._pixelsPerMercatorPixel+oe;const be=[ve*I.worldSize,_e*I.worldSize,0];o.a6.vec3.transformMat4(be,be,F),$=o.b7($,be,W)}return o.a6.vec3.transformMat4($,$,P)}_makeGlobeTileDebugBorderBuffer(u,p,w,I,P,F){const W=new o.a_,$=new o.a$,J=new o.b8,Q=(le,ue,ve,_e,be)=>{const we=(ve-le)/(be-1),ke=(_e-ue)/(be-1),Ne=W.length;for(let De=0;De<be;De++){const We=le+De*we,He=ue+De*ke;W.emplaceBack(We,He);const et=this._globePoint(We,He,p,w,I,P,F);J.emplaceBack(et[0],et[1],et[2]),$.emplaceBack(Ne+De)}},oe=o.ab;Q(0,0,oe,0,16),Q(oe,0,oe,oe,16),Q(oe,oe,0,oe,16),Q(0,oe,0,0,16),this._tileDebugIndexBuffer=u.createIndexBuffer($),this._tileDebugBuffer=u.createVertexBuffer(W,o.b0.members),this._globeTileDebugBorderBuffer=u.createVertexBuffer(J,o.b9.members),this._tileDebugSegments=o.b1.simpleSegment(0,0,W.length,$.length)}_makeGlobeTileDebugTextBuffer(u,p,w,I,P,F){const W=o.ab/4,$=new o.a_,J=new o.aO,Q=new o.b8,oe=25;J.reserve(32),$.reserve(oe),Q.reserve(oe);const le=(ue,ve)=>oe*ue+ve;for(let ue=0;ue<oe;ue++){const ve=ue*W;for(let _e=0;_e<oe;_e++){const be=_e*W;$.emplaceBack(be,ve);const we=this._globePoint(be,ve,p,w,I,P,F);Q.emplaceBack(we[0],we[1],we[2])}}for(let ue=0;ue<4;ue++)for(let ve=0;ve<4;ve++){const _e=le(ue,ve),be=le(ue,ve+1),we=le(ue+1,ve),ke=le(ue+1,ve+1);J.emplaceBack(_e,be,we),J.emplaceBack(we,be,ke)}this._tileDebugTextIndexBuffer=u.createIndexBuffer(J),this._tileDebugTextBuffer=u.createVertexBuffer($,o.b0.members),this._globeTileDebugTextBuffer=u.createVertexBuffer(Q,o.b9.members),this._tileDebugTextSegments=o.b1.simpleSegment(0,0,oe,32)}destroy(u=!1){for(const p in this.buckets)this.buckets[p].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!u&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.ba.setPbf(o.bb);class og extends kc{constructor(u,p,w,I,P){super(u,p,w,I,P),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(u,p){const w=p.context,I=w.gl;this.texture=this.texture||p.getTileTexture(u.width),this.texture&&this.texture instanceof o.T?this.texture.update(u,{premultiply:!1}):this.texture=new o.T(w,u,I.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(u=16384,p){const w=this._mrt=new o.ba(30),I=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(u-1)}});return this.entireBuffer=null,this.request=o.bc(I,(P,F,W,$)=>{if(P)p(P);else try{const J=w.getHeaderLength(F);if(J>u)return void(this.request=this.fetchHeader(J,p));w.parseHeader(F),this._isHeaderLoaded=!0;let Q=0;for(const oe of Object.values(w.layers))Q=Math.max(Q,oe.dataIndex[oe.dataIndex.length-1].last_byte);F.byteLength>=Q&&(this.entireBuffer=F),p(null,this.entireBuffer||F,W,$)}catch(J){p(J)}}),this.request}fetchBand(u,p,w){const I=this._mrt;if(!this._isHeaderLoaded||!I)return void w(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void w(new Error("Can't fetch tile band without an actor"));let F;const W=(oe,le)=>{F.complete(oe,le),oe?w(oe):(this.updateTextureDescriptor(u,p),w(null,this.textureDescriptor&&this.textureDescriptor.img))},$=(oe,le)=>{if(oe)return w(oe);const ue=P.send("decodeRasterArray",{buffer:le,task:F},W,void 0,!0);this._workQueue.push(()=>{ue&&ue.cancel(),F.cancel()})},J=I.getLayer(u);if(!J)return void w(new Error(`Unknown sourceLayer "${u}"`));if(J.hasDataForBand(p))return this.updateTextureDescriptor(u,p),void w(null,this.textureDescriptor?this.textureDescriptor.img:null);const Q=J.getDataRange([p]);if(F=I.createDecodingTask(Q),!F||F.tasks.length)if(this.flushQueues(),this.entireBuffer)$(null,this.entireBuffer.slice(Q.firstByte,Q.lastByte+1));else{const oe=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Q.firstByte}-${Q.lastByte}`}}),le=o.bc(oe,$);this._fetchQueue.push(()=>{le.cancel(),F.cancel()})}else w(null)}updateNeeded(u,p){return(!this.textureDescriptor||this.textureDescriptor.band!==p||this.textureDescriptor.layer!==u)&&this.state!=="errored"}updateTextureDescriptor(u,p){if(!this._mrt)return;const w=this._mrt.getLayer(u);if(!w||!w.hasBand(p)||!w.hasDataForBand(p))return;const{bytes:I,tileSize:P,buffer:F,offset:W,scale:$}=w.getBandView(p),J=P+2*F,Q={data:I,width:J,height:J},oe=this.texture;oe&&oe instanceof o.T&&oe.update(Q,{premultiply:!1}),this.textureDescriptor={layer:u,band:p,img:Q,buffer:F,offset:W,tileSize:P,format:w.pixelFormat,mix:[$,256*$,65536*$,16777216*$]}}}class Ap{constructor(u,p){this.max=u,this.onRemove=p,this.reset()}reset(){for(const u in this.data)for(const p of this.data[u])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(u,p,w){const I=u.wrapped().key;this.data[I]===void 0&&(this.data[I]=[]);const P={value:p,timeout:void 0};if(w!==void 0&&(P.timeout=setTimeout(()=>{this.remove(u,P)},w)),this.data[I].push(P),this.order.push(I),this.order.length>this.max){const F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(u){return u.wrapped().key in this.data}getAndRemove(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null}_getAndRemoveByKey(u){const p=this.data[u].shift();return p.timeout&&clearTimeout(p.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),p.value}getByKey(u){const p=this.data[u];return p?p[0].value:null}get(u){return this.has(u)?this.data[u.wrapped().key][0].value:null}remove(u,p){if(!this.has(u))return this;const w=u.wrapped().key,I=p===void 0?0:this.data[w].indexOf(p),P=this.data[w][I];return this.data[w].splice(I,1),P.timeout&&clearTimeout(P.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(P.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(u){for(this.max=u;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(u){const p=[];for(const w in this.data)for(const I of this.data[w])u(I.value)||p.push(I);for(const w of p)this.remove(w.value.tileID,w)}}class ag{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,p,w){const I=String(p);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][I]=this.stateChanges[u][I]||{},o.l(this.stateChanges[u][I],w),this.deletedStates[u]===null){this.deletedStates[u]={};for(const P in this.state[u])P!==I&&(this.deletedStates[u][P]=null)}else if(this.deletedStates[u]&&this.deletedStates[u][I]===null){this.deletedStates[u][I]={};for(const P in this.state[u][I])w[P]||(this.deletedStates[u][I][P]=null)}else for(const P in w)this.deletedStates[u]&&this.deletedStates[u][I]&&this.deletedStates[u][I][P]===null&&delete this.deletedStates[u][I][P]}removeFeatureState(u,p,w){if(this.deletedStates[u]===null)return;const I=String(p);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&p!==void 0)this.deletedStates[u][I]!==null&&(this.deletedStates[u][I]=this.deletedStates[u][I]||{},this.deletedStates[u][I][w]=null);else if(p!==void 0)if(this.stateChanges[u]&&this.stateChanges[u][I])for(w in this.deletedStates[u][I]={},this.stateChanges[u][I])this.deletedStates[u][I][w]=null;else this.deletedStates[u][I]=null;else this.deletedStates[u]=null}getState(u,p){const w=this.state[u]||{},I=this.stateChanges[u]||{},P=this.deletedStates[u];if(P===null)return{};if(p!==void 0){const W=String(p),$=o.l({},w[W],I[W]);if(P){const J=P[p];if(J===null)return{};for(const Q in J)delete $[Q]}return $}const F=o.l({},w,I);if(P)for(const W in P)delete F[W];return F}initializeTileState(u,p){u.setFeatureState(this.state,p)}coalesceChanges(u,p){const w={};for(const I in this.stateChanges){this.state[I]=this.state[I]||{};const P={};for(const F in this.stateChanges[I])this.state[I][F]||(this.state[I][F]={}),o.l(this.state[I][F],this.stateChanges[I][F]),P[F]=this.state[I][F];w[I]=P}for(const I in this.deletedStates){this.state[I]=this.state[I]||{};const P={};if(this.deletedStates[I]===null)for(const F in this.state[I])P[F]={},this.state[I][F]={};else for(const F in this.deletedStates[I]){if(this.deletedStates[I][F]===null)this.state[I][F]={};else if(this.state[I][F])for(const W of Object.keys(this.deletedStates[I][F]))delete this.state[I][F][W];P[F]=this.state[I][F]}w[I]=w[I]||{},o.l(w[I],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const I in u)u[I].setFeatureState(w,p)}}class $o extends o.E{constructor(u,p,w){super(),this.id=u,this._onlySymbols=w,p.on("data",I=>{I.dataType==="source"&&I.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&I.dataType==="source"&&I.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),p.on("error",()=>{this._sourceErrored=!0}),this._source=p,this._tiles={},this._cache=new Ap(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ag,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(u){this.map=u,this._minTileCacheSize=this._minTileCacheSize===void 0&&u?u._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&u?u._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const u in this._tiles){const p=this._tiles[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(u,p){return u.isSymbolTile=this._onlySymbols,u.isExtraShadowCaster=this._shadowCasterTiles[u.tileID.key],this._source.loadTile(u,p)}_unloadTile(u){if(this._source.unloadTile)return this._source.unloadTile(u)}_abortTile(u){if(this._source.abortTile)return this._source.abortTile(u)}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const w=this._tiles[p];w.upload(u),w.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.bd(this._tiles).map(u=>u.tileID).sort(Kl).map(u=>u.key)}getRenderableIds(u,p){const w=[];for(const I in this._tiles)this._isIdRenderable(+I,u,p)&&w.push(this._tiles[I]);return u?w.sort((I,P)=>{const F=I.tileID,W=P.tileID,$=new o.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle),J=new o.P(W.canonical.x,W.canonical.y)._rotate(this.transform.angle);return F.overscaledZ-W.overscaledZ||J.y-$.y||J.x-$.x}).map(I=>I.tileID.key):w.map(I=>I.tileID).sort(Kl).map(I=>I.key)}hasRenderableParent(u){const p=this.findLoadedParent(u,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(u,p,w){return this._tiles[u]&&this._tiles[u].hasData()&&!this._coveredTiles[u]&&(p||!this._tiles[u].holdingForFade())&&(w||!this._shadowCasterTiles[u])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)this._tiles[u].state!=="errored"&&this._reloadTile(+u,"reloading")}}_reloadTile(u,p){const w=this._tiles[u];w&&(w.state!=="loading"&&(w.state=p),this._loadTile(w,this._tileLoaded.bind(this,w,u,p)))}_tileLoaded(u,p,w,I){if(I)if(u.state="errored",I.status!==404)this._source.fire(new o.t(I,{tile:u}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:u})),!(u.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const P=this.map.painter.terrain;this.update(this.transform,P.getScaledDemTileSize(),!0),P.resetTileLookupCache(this.id)}else this.update(this.transform)}else u.timeAdded=o.q.now(),w==="expired"&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(p,u),this._source.type==="raster-dem"&&u.dem&&this._backfillDEM(u),this._state.initializeTileState(u,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:u,coord:u.tileID,sourceCacheId:this.id}))}_backfillDEM(u){const p=this.getRenderableIds();for(let I=0;I<p.length;I++){const P=p[I];if(u.neighboringTiles&&u.neighboringTiles[P]){const F=this.getTileByID(P);w(u,F),w(F,u)}}function w(I,P){if(!I.dem||I.dem.borderReady)return;I.needsHillshadePrepare=!0,I.needsDEMTextureUpload=!0;let F=P.tileID.canonical.x-I.tileID.canonical.x;const W=P.tileID.canonical.y-I.tileID.canonical.y,$=Math.pow(2,I.tileID.canonical.z),J=P.tileID.key;F===0&&W===0||Math.abs(W)>1||(Math.abs(F)>1&&(Math.abs(F+$)===1?F+=$:Math.abs(F-$)===1&&(F-=$)),P.dem&&I.dem&&(I.dem.backfillBorder(P.dem,F,W),I.neighboringTiles&&I.neighboringTiles[J]&&(I.neighboringTiles[J].backfilled=!0)))}}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._tiles[u]}_retainLoadedChildren(u,p,w,I){for(const P in this._tiles){let F=this._tiles[P];if(I[P]||!F.hasData()||F.tileID.overscaledZ<=p||F.tileID.overscaledZ>w)continue;let W=F.tileID;for(;F&&F.tileID.overscaledZ>p+1;){const J=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[J.key],F&&F.hasData()&&(W=J)}let $=W;for(;$.overscaledZ>p;)if($=$.scaledTo($.overscaledZ-1),u[$.key]){I[W.key]=W;break}}}findLoadedParent(u,p){if(u.key in this._loadedParentTiles){const w=this._loadedParentTiles[u.key];return w&&w.tileID.overscaledZ>=p?w:null}for(let w=u.overscaledZ-1;w>=p;w--){const I=u.scaledTo(w),P=this._getLoadedTile(I);if(P)return P}}_getLoadedTile(u){const p=this._tiles[u.key];return p&&p.hasData()?p:this._cache.getByKey(this._source.reparseOverscaled?u.wrapped().key:u.canonical.key)}updateCacheSize(u,p){p=p||this._source.tileSize;const w=Math.ceil(u.width/p)+1,I=Math.ceil(u.height/p)+1,P=Math.floor(w*I*5),F=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,P):P,W=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,F):F;this._cache.setMaxSize(W)}handleWrapJump(u){const p=Math.round((u-(this._prevLng===void 0?u:this._prevLng))/360);if(this._prevLng=u,p){const w={};for(const I in this._tiles){const P=this._tiles[I];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+p),w[P.tileID.key]=P}this._tiles=w;for(const I in this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(const I in this._tiles)this._setTileReloadTimer(+I,this._tiles[I])}}update(u,p,w,I){if(this.transform=u,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!w)return;this.updateCacheSize(u,p),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let F;if(this.used||this.usedForTerrain){if(this._source.tileID)F=u.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new o.aA(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y));else if(this.tileCoverLift!==0){const J=u.clone();J.tileCoverLift=this.tileCoverLift,F=J.coveringTiles({tileSize:p||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&u.projection.name==="globe"&&(F.push(new o.aA(1,0,1,0,0)),F.push(new o.aA(1,0,1,1,0)),F.push(new o.aA(1,0,1,0,1)),F.push(new o.aA(1,0,1,1,1)))}else if(F=u.coveringTiles({tileSize:p||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const J=this._source.hasTile.bind(this._source);F=F.filter(Q=>J(Q))}}else F=[];if(F.length>0&&this.castsShadows&&I&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Tp(this._source.type)){const J=u.coveringZoomLevel({tileSize:p||this._source.tileSize,roundZoom:this._source.roundZoom&&!w}),Q=Math.min(J,this._source.maxzoom);if(P){const oe=u.extendTileCover(F,Q);for(const le of oe)F.push(le)}else{const oe=u.extendTileCover(F,Q,I);for(const le of oe)this._shadowCasterTiles[le.key]=!0,F.push(le)}}const W=this._updateRetainedTiles(F);if(Tp(this._source.type)&&F.length!==0){const J={},Q={},oe=Object.keys(W);for(const ue of oe){const ve=W[ue],_e=this._tiles[ue];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=o.q.now())continue;const be=this.findLoadedParent(ve,Math.max(ve.overscaledZ-$o.maxOverzooming,this._source.minzoom));be&&(this._addTile(be.tileID),J[be.tileID.key]=be.tileID),Q[ue]=ve}const le=F[F.length-1].overscaledZ;for(const ue in this._tiles){const ve=this._tiles[ue];if(W[ue]||!ve.hasData())continue;let _e=ve.tileID;for(;_e.overscaledZ>le;){_e=_e.scaledTo(_e.overscaledZ-1);const be=this._tiles[_e.key];if(be&&be.hasData()&&Q[_e.key]){W[ue]=ve.tileID;break}}}for(const ue in J)W[ue]||(this._coveredTiles[ue]=!0,W[ue]=J[ue])}for(const J in W)this._tiles[J].clearFadeHold();const $=o.be(this._tiles,W);for(const J of $){const Q=this._tiles[J];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+J)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const u in this._tiles)this._tiles[u].holdingForFade()&&this._removeTile(+u)}_updateRetainedTiles(u){const p={};if(u.length===0)return p;const w={},I=u.reduce((J,Q)=>Math.min(J,Q.overscaledZ),1/0),P=u[0].overscaledZ,F=Math.max(P-$o.maxOverzooming,this._source.minzoom),W=Math.max(P+$o.maxUnderzooming,this._source.minzoom),$={};for(const J of u){const Q=this._addTile(J);p[J.key]=J,Q.hasData()||I<this._source.maxzoom&&($[J.key]=J)}this._retainLoadedChildren($,I,W,p);for(const J of u){let Q=this._tiles[J.key];if(Q.hasData())continue;if(J.canonical.z>=this._source.maxzoom){const le=J.children(this._source.maxzoom)[0],ue=this.getTile(le);if(ue&&ue.hasData()){p[le.key]=le;continue}}else{const le=J.children(this._source.maxzoom);if(p[le[0].key]&&p[le[1].key]&&p[le[2].key]&&p[le[3].key])continue}let oe=Q.wasRequested();for(let le=J.overscaledZ-1;le>=F;--le){const ue=J.scaledTo(le);if(w[ue.key]||(w[ue.key]=!0,Q=this.getTile(ue),!Q&&oe&&(Q=this._addTile(ue)),Q&&(p[ue.key]=ue,oe=Q.wasRequested(),Q.hasData())))break}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const u in this._tiles){const p=[];let w,I=this._tiles[u].tileID;for(;I.overscaledZ>0;){if(I.key in this._loadedParentTiles){w=this._loadedParentTiles[I.key];break}p.push(I.key);const P=I.scaledTo(I.overscaledZ-1);if(w=this._getLoadedTile(P),w)break;I=P}for(const P of p)this._loadedParentTiles[P]=w}}_addTile(u){let p=this._tiles[u.key];if(p)return p.isExtraShadowCaster!==!0||this._shadowCasterTiles[u.key]||this._reloadTile(u.key,"reloading"),p;p=this._cache.getAndRemove(u),p&&(this._setTileReloadTimer(u.key,p),p.tileID=u,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[u.key]&&(clearTimeout(this._cacheTimers[u.key]),delete this._cacheTimers[u.key],this._setTileReloadTimer(u.key,p)));const w=!!p;if(!w){const I=this.map?this.map.painter:null,P=this._source.tileSize*u.overscaleFactor();p=this._source.type==="raster-array"?new og(u,P,this.transform.tileZoom,I,this._isRaster):new kc(u,P,this.transform.tileZoom,I,this._isRaster),this._loadTile(p,this._tileLoaded.bind(this,p,u.key,p.state))}return p?(p.uses++,this._tiles[u.key]=p,w||this._source.fire(new o.x("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p):null}_setTileReloadTimer(u,p){u in this._timers&&(clearTimeout(this._timers[u]),delete this._timers[u]);const w=p.getExpiryTimeout();w&&(this._timers[u]=setTimeout(()=>{this._reloadTile(u,"expired"),delete this._timers[u]},w))}_removeTile(u){const p=this._tiles[u];p&&(p.uses--,delete this._tiles[u],this._timers[u]&&(clearTimeout(this._timers[u]),delete this._timers[u]),p.uses>0||(p.hasData()&&p.state!=="reloading"||p.state==="empty"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u in this._tiles)this._removeTile(+u);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(u,p,w){const I=[],P=this.transform;if(!P)return I;const F=P.projection.name==="globe",W=o.am(P.center.lng);for(const $ in this._tiles){const J=this._tiles[$];if(w&&J.clearQueryDebugViz(),J.holdingForFade())continue;let Q;if(F){const oe=J.tileID.canonical;if(oe.z===0){const le=[Math.abs(o.ap(W,...cd(oe,-1))-W),Math.abs(o.ap(W,...cd(oe,1))-W)];Q=[0,2*le.indexOf(Math.min(...le))-1]}else{const le=[Math.abs(o.ap(W,...cd(oe,-1))-W),Math.abs(o.ap(W,...cd(oe,0))-W),Math.abs(o.ap(W,...cd(oe,1))-W)];Q=[le.indexOf(Math.min(...le))-1]}}else Q=[0];for(const oe of Q){const le=u.containsTile(J,P,p,oe);le&&I.push(le)}}return I}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(u){return this._getRenderableCoordinates(u)}_getRenderableCoordinates(u,p){const w=this.getRenderableIds(u,p).map(P=>this._tiles[P].tileID),I=this.transform.projection.name==="globe";for(const P of w)P.projMatrix=this.transform.calculateProjMatrix(P.toUnwrapped()),P.expandedProjMatrix=I?this.transform.calculateProjMatrix(P.toUnwrapped(),!1,!0):P.projMatrix;return w}sortCoordinatesByDistance(u){const p=u.slice(),w=this.transform._camera.position,I=this.transform._camera.forward(),P={};for(const F of p){const W=1/(1<<F.canonical.z);P[F.key]=((F.canonical.x+.5)*W+F.wrap-w[0])*I[0]+((F.canonical.y+.5)*W-w[1])*I[1]-w[2]*I[2]}return p.sort((F,W)=>P[F.key]-P[W.key]),p}hasTransition(){if(this._source.hasTransition())return!0;if(Tp(this._source.type))for(const u in this._tiles){const p=this._tiles[u];if(p.fadeEndTime!==void 0&&p.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(u,p,w){this._state.updateState(u=u||"_geojsonTileLayer",p,w)}removeFeatureState(u,p,w){this._state.removeFeatureState(u=u||"_geojsonTileLayer",p,w)}getFeatureState(u,p){return this._state.getState(u=u||"_geojsonTileLayer",p)}setDependencies(u,p,w){const I=this._tiles[u];I&&I.setDependencies(p,w)}reloadTilesForDependencies(u,p){for(const w in this._tiles)this._tiles[w].hasDependency(u,p)&&this._reloadTile(+w,"reloading");this._cache.filter(w=>!w.hasDependency(u,p))}_preloadTiles(u,p){if(!this._sourceLoaded){const $=()=>{this._sourceLoaded&&(this._source.off("data",$),this._preloadTiles(u,p))};return void this._source.on("data",$)}const w=new Map,I=Array.isArray(u)?u:[u],P=this.map.painter.terrain,F=this.usedForTerrain&&P?P.getScaledDemTileSize():this._source.tileSize;for(const $ of I){const J=$.coveringTiles({tileSize:F,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Q of J)w.set(Q.key,Q);this.usedForTerrain&&$.updateElevation(!1)}const W=Array.from(w.values());o.bf(W,($,J)=>{const Q=new kc($,this._source.tileSize*$.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Q,oe=>{this._source.type==="raster-dem"&&Q.dem&&this._backfillDEM(Q),J(oe,Q)})},p)}}function Kl(b,u){const p=Math.abs(2*b.wrap)-+(b.wrap<0),w=Math.abs(2*u.wrap)-+(u.wrap<0);return b.overscaledZ-u.overscaledZ||w-p||u.canonical.y-b.canonical.y||u.canonical.x-b.canonical.x}function Tp(b){return b==="raster"||b==="image"||b==="video"||b==="custom"}function cd(b,u){const p=1<<b.z;return[b.x/p+u,(b.x+1)/p+u]}$o.maxOverzooming=10,$o.maxUnderzooming=3;class Mp{constructor(u){this.style=u,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const u=!1,p=!1;for(const w in this.style._mergedLayers){const I=this.style._mergedLayers[w];if(I.type==="fill-extrusion")this.layers.push({layer:I,visible:u,visibilityChanged:p});else if(I.type==="model"){const P=this.style.getLayerSource(I);P&&P.type==="batched-model"&&this.layers.push({layer:I,visible:u,visibilityChanged:p})}}}onNewFrame(u){this.layersGotHidden=!1;for(const p of this.layers){const w=p.layer;let I=!1;w.type==="fill-extrusion"?I=!w.isHidden(u)&&w.paint.get("fill-extrusion-opacity")>0:w.type==="model"&&(I=!w.isHidden(u)&&w.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!I&&p.visible,p.visible=I}}updateZOffset(u,p){this.currentBuildingBuckets=[];for(const I of this.layers){const P=I.layer,F=this.style.getLayerSourceCache(P);let W=1;P.type==="fill-extrusion"&&(W=I.visible?P.paint.get("fill-extrusion-vertical-scale"):0);let $=F?F.getTile(p):null;if(!$&&F&&p.canonical.z>F.getSource().minzoom){let J=p.scaledTo(Math.min(F.getSource().maxzoom,p.overscaledZ-1));for(;J.overscaledZ>=F.getSource().minzoom&&($=F.getTile(J),!$&&J.overscaledZ!==0);)J=J.scaledTo(J.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:$?$.getBucket(P):null,tileID:$?$.tileID:p,verticalScale:W})}u.hasAnyZOffset=!1;let w=!1;for(let I=0;I<u.symbolInstances.length;I++){const P=u.symbolInstances.get(I),F=P.zOffset,W=this._getHeightAtTileOffset(p,P.tileAnchorX,P.tileAnchorY);P.zOffset=W!==Number.NEGATIVE_INFINITY?W:F,w||F===P.zOffset||(w=!0),u.hasAnyZOffset||P.zOffset===0||(u.hasAnyZOffset=!0)}w&&(u.zOffsetBuffersNeedUpload=!0,u.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(u,p,w,I){let P=p,F=w;if(u.canonical.z!==I.canonical.z){const W=I.canonical,$=1/(1<<u.canonical.z-W.z);P=(p+u.canonical.x*o.ab)*$-W.x*o.ab|0,F=(w+u.canonical.y*o.ab)*$-W.y*o.ab|0}return{tileX:P,tileY:F}}_getHeightAtTileOffset(u,p,w){let I,P;for(let F=0;F<this.layers.length;++F){if(this.layers[F].layer.type!=="fill-extrusion")continue;const{bucket:W,tileID:$,verticalScale:J}=this.currentBuildingBuckets[F];if(!W)continue;const{tileX:Q,tileY:oe}=this._mapCoordToOverlappingTile(u,p,w,$),le=W.getHeightAtTileCoord(Q,oe);le&&le.height!==void 0&&(le.hidden?I=le.height:P=Math.max(le.height*J,P||0))}if(P!==void 0)return P;for(let F=0;F<this.layers.length;++F){const W=this.layers[F];if(W.layer.type!=="model"||!W.visible)continue;const{bucket:$,tileID:J}=this.currentBuildingBuckets[F];if(!$)continue;const{tileX:Q,tileY:oe}=this._mapCoordToOverlappingTile(u,p,w,J),le=$.getHeightAtTileCoord(Q,oe);if(le&&!le.hidden)return le.height===void 0&&I!==void 0?Math.min(le.maxHeight,I)*le.verticalScale:le.height?le.height*le.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Vu(b,u){const p={};for(const w in b)w!=="ref"&&(p[w]=b[w]);return o.bg.forEach(w=>{w in u&&(p[w]=u[w])}),p}function Gh(b){b=b.slice();const u=Object.create(null);for(let p=0;p<b.length;p++)u[b[p].id]=b[p];for(let p=0;p<b.length;p++)"ref"in b[p]&&(b[p]=Vu(b[p],u[b[p].ref]));return b}const si={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Cp(b,u,p){p.push({command:si.addSource,args:[b,u[b]]})}function vr(b,u,p){u.push({command:si.removeSource,args:[b]}),p[b]=!0}function T1(b,u,p,w){vr(b,p,w),Cp(b,u,p)}function cr(b,u,p){let w;for(w in b[p])if(b[p].hasOwnProperty(w)&&w!=="data"&&!o.bh(b[p][w],u[p][w]))return!1;for(w in u[p])if(u[p].hasOwnProperty(w)&&w!=="data"&&!o.bh(b[p][w],u[p][w]))return!1;return!0}function ud(b,u,p,w,I,P){let F;for(F in u=u||{},b=b||{})b.hasOwnProperty(F)&&(o.bh(b[F],u[F])||p.push({command:P,args:[w,F,u[F],I]}));for(F in u)u.hasOwnProperty(F)&&!b.hasOwnProperty(F)&&(o.bh(b[F],u[F])||p.push({command:P,args:[w,F,u[F],I]}))}function Vh(b){return b.id}function hd(b,u){return b[u.id]=u,b}class xs{constructor(u,p){this.reset(u,p)}reset(u,p){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=o.ap(u,0,1);let p=1,w=this._distances[p];const I=u*this.paddedLength+this.padding;for(;w<I&&p<this._distances.length;)w=this._distances[++p];const P=p-1,F=this._distances[P],W=w-F,$=W>0?(I-F)/W:0;return this.points[P].mult(1-$).add(this.points[p].mult($))}}class fd{constructor(u,p,w){const I=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(p/w);for(let F=0;F<this.xCellCount*this.yCellCount;F++)I.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=p,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,p,w,I,P){this._forEachCell(p,w,I,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(p),this.bboxes.push(w),this.bboxes.push(I),this.bboxes.push(P)}insertCircle(u,p,w,I){this._forEachCell(p-I,w-I,p+I,w+I,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(p),this.circles.push(w),this.circles.push(I)}_insertBoxCell(u,p,w,I,P,F){this.boxCells[P].push(F)}_insertCircleCell(u,p,w,I,P,F){this.circleCells[P].push(F)}_query(u,p,w,I,P,F){if(w<0||u>this.width||I<0||p>this.height)return!P&&[];const W=[];if(u<=0&&p<=0&&this.width<=w&&this.height<=I){if(P)return!0;for(let $=0;$<this.boxKeys.length;$++)W.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const J=this.circles[3*$],Q=this.circles[3*$+1],oe=this.circles[3*$+2];W.push({key:this.circleKeys[$],x1:J-oe,y1:Q-oe,x2:J+oe,y2:Q+oe})}return F?W.filter(F):W}return this._forEachCell(u,p,w,I,this._queryCell,W,{hitTest:P,seenUids:{box:{},circle:{}}},F),P?W.length>0:W}_queryCircle(u,p,w,I,P){const F=u-w,W=u+w,$=p-w,J=p+w;if(W<0||F>this.width||J<0||$>this.height)return!I&&[];const Q=[];return this._forEachCell(F,$,W,J,this._queryCellCircle,Q,{hitTest:I,circle:{x:u,y:p,radius:w},seenUids:{box:{},circle:{}}},P),I?Q.length>0:Q}query(u,p,w,I,P){return this._query(u,p,w,I,!1,P)}hitTest(u,p,w,I,P){return this._query(u,p,w,I,!0,P)}hitTestCircle(u,p,w,I){return this._queryCircle(u,p,w,!0,I)}_queryCell(u,p,w,I,P,F,W,$){const J=W.seenUids,Q=this.boxCells[P];if(Q!==null){const le=this.bboxes;for(const ue of Q)if(!J.box[ue]){J.box[ue]=!0;const ve=4*ue;if(u<=le[ve+2]&&p<=le[ve+3]&&w>=le[ve+0]&&I>=le[ve+1]&&(!$||$(this.boxKeys[ue]))){if(W.hitTest)return F.push(!0),!0;F.push({key:this.boxKeys[ue],x1:le[ve],y1:le[ve+1],x2:le[ve+2],y2:le[ve+3]})}}}const oe=this.circleCells[P];if(oe!==null){const le=this.circles;for(const ue of oe)if(!J.circle[ue]){J.circle[ue]=!0;const ve=3*ue;if(this._circleAndRectCollide(le[ve],le[ve+1],le[ve+2],u,p,w,I)&&(!$||$(this.circleKeys[ue]))){if(W.hitTest)return F.push(!0),!0;{const _e=le[ve],be=le[ve+1],we=le[ve+2];F.push({key:this.circleKeys[ue],x1:_e-we,y1:be-we,x2:_e+we,y2:be+we})}}}}}_queryCellCircle(u,p,w,I,P,F,W,$){const J=W.circle,Q=W.seenUids,oe=this.boxCells[P];if(oe!==null){const ue=this.bboxes;for(const ve of oe)if(!Q.box[ve]){Q.box[ve]=!0;const _e=4*ve;if(this._circleAndRectCollide(J.x,J.y,J.radius,ue[_e+0],ue[_e+1],ue[_e+2],ue[_e+3])&&(!$||$(this.boxKeys[ve])))return F.push(!0),!0}}const le=this.circleCells[P];if(le!==null){const ue=this.circles;for(const ve of le)if(!Q.circle[ve]){Q.circle[ve]=!0;const _e=3*ve;if(this._circlesCollide(ue[_e],ue[_e+1],ue[_e+2],J.x,J.y,J.radius)&&(!$||$(this.circleKeys[ve])))return F.push(!0),!0}}}_forEachCell(u,p,w,I,P,F,W,$){const J=this._convertToXCellCoord(u),Q=this._convertToYCellCoord(p),oe=this._convertToXCellCoord(w),le=this._convertToYCellCoord(I);for(let ue=J;ue<=oe;ue++)for(let ve=Q;ve<=le;ve++)if(P.call(this,u,p,w,I,this.xCellCount*ve+ue,F,W,$))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,p,w,I,P,F){const W=I-u,$=P-p,J=w+F;return J*J>W*W+$*$}_circleAndRectCollide(u,p,w,I,P,F,W){const $=(F-I)/2,J=Math.abs(u-(I+$));if(J>$+w)return!1;const Q=(W-P)/2,oe=Math.abs(p-(P+Q));if(oe>Q+w)return!1;if(J<=$||oe<=Q)return!0;const le=J-$,ue=oe-Q;return le*le+ue*ue<=w*w}}const Jl={unknown:0,flipRequired:1,flipNotRequired:2},On=Math.tan(85*Math.PI/180);function ei(b,u,p,w,I,P,F){const W=o.a6.mat4.create();if(p)if(P.name==="globe"){const $=o.bi(I,u);o.a6.mat4.multiply(W,W,$)}else{const $=o.a6.mat2.invert([],F);W[0]=$[0],W[1]=$[1],W[4]=$[2],W[5]=$[3],w||o.a6.mat4.rotateZ(W,W,I.angle)}else o.a6.mat4.multiply(W,I.labelPlaneMatrix,b);return W}function Zr(b,u,p,w,I,P,F){const W=ei(b,u,p,w,I,P,F);return P.name==="globe"&&p||(W[2]=W[6]=W[10]=W[14]=0),W}function Us(b,u,p,w,I,P,F){if(p){if(P.name==="globe"){const W=ei(b,u,p,w,I,P,F);return o.a6.mat4.invert(W,W),o.a6.mat4.multiply(W,b,W),W}{const W=o.a6.mat4.clone(b),$=o.a6.mat4.identity([]);return $[0]=F[0],$[1]=F[1],$[4]=F[2],$[5]=F[3],o.a6.mat4.multiply(W,W,$),w||o.a6.mat4.rotateZ(W,W,-I.angle),W}}return I.glCoordMatrix}function ga(b,u,p,w){const I=[b,u,p,1];p?o.a6.vec4.transformMat4(I,I,w):lg(I,I,w);const P=I[3];return I[0]/=P,I[1]/=P,I[2]/=P,I}function ni(b,u){return Math.min(.5+b/u*.5,1.5)}function al(b,u){const p=b[0]/b[3],w=b[1]/b[3];return p>=-u[0]&&p<=u[0]&&w>=-u[1]&&w<=u[1]}function $a(b,u,p,w,I,P,F,W,$,J){const Q=p.transform,oe=w?b.textSizeData:b.iconSizeData,le=o.bj(oe,p.transform.zoom),ue=Q.projection.name==="globe",ve=[256/p.width*2+1,256/p.height*2+1],_e=w?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;_e.clear();let be=null;ue&&(be=w?b.text.globeExtVertexArray:b.icon.globeExtVertexArray);const we=b.lineVertexArray,ke=w?b.text.placedSymbolArray:b.icon.placedSymbolArray,Ne=p.transform.width/p.transform.height;let De,We=!1;for(let He=0;He<ke.length;He++){const et=ke.get(He),{numGlyphs:Ke,writingMode:tt}=et;if(tt!==o.bk.vertical||We||De===o.bk.horizontal||(We=!0),De=tt,(et.hidden||tt===o.bk.vertical)&&!We){ll(Ke,_e);continue}We=!1;const ut=new o.P(et.tileAnchorX,et.tileAnchorY);let{x:st,y:rt,z:xt}=Q.projection.projectTilePoint(ut.x,ut.y,J.canonical);if($){const[qt,en,er]=$(ut);st+=qt,rt+=en,xt+=er}const Ft=[st,rt,xt,1];if(o.a6.vec4.transformMat4(Ft,Ft,u),!al(Ft,ve)){ll(Ke,_e);continue}const Zt=Ft[3],kt=ni(p.transform.getCameraToCenterDistance(Q.projection),Zt),hn=o.bl(oe,le,et),bt=F?hn/kt:hn*kt,Wt=ga(st,rt,xt,I);if(Wt[3]<=0){ll(Ke,_e);continue}let Gt={};const fn=F?null:$,pn=Ts(et,bt,!1,W,u,I,P,b.glyphOffsetArray,we,_e,be,Wt,ut,Gt,Ne,fn,Q.projection,J,F);We=pn.useVertical,fn&&pn.needsFlipping&&(Gt={}),(pn.notEnoughRoom||We||pn.needsFlipping&&Ts(et,bt,!0,W,u,I,P,b.glyphOffsetArray,we,_e,be,Wt,ut,Gt,Ne,fn,Q.projection,J,F).notEnoughRoom)&&ll(Ke,_e)}w?(b.text.dynamicLayoutVertexBuffer.updateData(_e),be&&b.text.globeExtVertexBuffer&&b.text.globeExtVertexBuffer.updateData(be)):(b.icon.dynamicLayoutVertexBuffer.updateData(_e),be&&b.icon.globeExtVertexBuffer&&b.icon.globeExtVertexBuffer.updateData(be))}function pu(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e){const{lineStartIndex:be,glyphStartIndex:we,segment:ke}=W,Ne=we+W.numGlyphs,De=be+W.lineLength,We=u.getoffsetX(we),He=u.getoffsetX(Ne-1),et=dd(b*We,p,w,I,P,F,ke,be,De,$,J,Q,oe,le,!0,ue,ve,_e);if(!et)return null;const Ke=dd(b*He,p,w,I,P,F,ke,be,De,$,J,Q,oe,le,!0,ue,ve,_e);return Ke?{first:et,last:Ke}:null}function sa(b,u,p,w){return b===o.bk.horizontal&&Math.abs(w)>Math.abs(p)?{useVertical:!0}:b===o.bk.vertical?w>0?{needsFlipping:!0}:null:u!==Jl.unknown&&function(I,P){return I===0||Math.abs(P/I)>On}(p,w)?u===Jl.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null}function Ts(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we,ke){const Ne=u/24,De=b.lineOffsetX*Ne,We=b.lineOffsetY*Ne,{lineStartIndex:He,glyphStartIndex:et,numGlyphs:Ke,segment:tt,writingMode:ut,flipState:st}=b,rt=He+b.lineLength,xt=Ft=>{if(Q){const[bt,Wt,Gt]=Ft.up,fn=J.length;o.bm(Q,fn+0,bt,Wt,Gt),o.bm(Q,fn+1,bt,Wt,Gt),o.bm(Q,fn+2,bt,Wt,Gt),o.bm(Q,fn+3,bt,Wt,Gt)}const[Zt,kt,hn]=Ft.point;o.bn(J,Zt,kt,hn,Ft.angle)};if(Ke>1){const Ft=pu(Ne,W,De,We,p,oe,le,b,$,P,ue,_e,!1,be,we,ke);if(!Ft)return{notEnoughRoom:!0};if(w&&!p){let[Zt,kt,hn]=Ft.first.point,[bt,Wt,Gt]=Ft.last.point;[Zt,kt]=ga(Zt,kt,hn,F),[bt,Wt]=ga(bt,Wt,Gt,F);const fn=sa(ut,st,(bt-Zt)*ve,Wt-kt);if(b.flipState=fn&&fn.needsFlipping?Jl.flipRequired:Jl.flipNotRequired,fn)return fn}xt(Ft.first);for(let Zt=et+1;Zt<et+Ke-1;Zt++){const kt=dd(Ne*W.getoffsetX(Zt),De,We,p,oe,le,tt,He,rt,$,P,ue,_e,!1,!1,be,we,ke);if(!kt)return J.length-=4*(Zt-et),{notEnoughRoom:!0};xt(kt)}xt(Ft.last)}else{if(w&&!p){const Zt=ga(le.x,le.y,0,I),kt=He+tt+1,hn=new o.P($.getx(kt),$.gety(kt)),bt=ga(hn.x,hn.y,0,I),Wt=bt[3]>0?bt:Pa(le,hn,Zt,1,I,void 0,be,we.canonical),Gt=sa(ut,st,(Wt[0]-Zt[0])*ve,Wt[1]-Zt[1]);if(b.flipState=Gt&&Gt.needsFlipping?Jl.flipRequired:Jl.flipNotRequired,Gt)return Gt}const Ft=dd(Ne*W.getoffsetX(et),De,We,p,oe,le,tt,He,rt,$,P,ue,_e,!1,!1,be,we,ke);if(!Ft)return{notEnoughRoom:!0};xt(Ft)}return{}}function M1(b,u,p,w,I){const{x:P,y:F,z:W}=w.projectTilePoint(b.x,b.y,u);if(!I)return ga(P,F,W,p);const[$,J,Q]=I(b);return ga(P+$,F+J,W+Q,p)}function Pa(b,u,p,w,I,P,F,W){const $=M1(b.sub(u)._unit()._add(b),W,I,F,P);return o.a6.vec3.sub($,p,$),o.a6.vec3.normalize($,$),o.a6.vec3.scaleAndAdd($,p,$,w)}function dd(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we){const ke=w?b-u:b+u;let Ne=ke>0?1:-1,De=0;w&&(Ne*=-1,De=Math.PI),Ne<0&&(De+=Math.PI);let We=W+F+(Ne>0?0:1)|0,He=I,et=I,Ke=0,tt=0;const ut=Math.abs(ke),st=[],rt=[];let xt=P,Ft=xt;const Zt=()=>Pa(Ft,xt,et,ut-Ke+1,Q,le,_e,be.canonical);for(;Ke+tt<=ut;){if(We+=Ne,We<W||We>=$)return null;if(et=He,Ft=xt,st.push(et),ue&&rt.push(Ft),xt=new o.P(J.getx(We),J.gety(We)),He=oe[We],!He){const en=M1(xt,be.canonical,Q,_e,le);He=en[3]>0?oe[We]=en:Zt()}Ke+=tt,tt=o.a6.vec3.distance(et,He)}ve&&le&&(oe[We]&&(He=Zt(),tt=o.a6.vec3.distance(et,He)),oe[We]=He);const kt=(ut-Ke)/tt,hn=xt.sub(Ft)._mult(kt)._add(Ft),bt=o.a6.vec3.sub([],He,et),Wt=o.a6.vec3.scaleAndAdd([],et,bt,kt);let Gt=[0,0,1],fn=bt[0],pn=bt[1];if(we&&(Gt=_e.upVector(be.canonical,hn.x,hn.y),Gt[0]!==0||Gt[1]!==0||Gt[2]!==1)){const en=[Gt[2],0,-Gt[0]],er=o.a6.vec3.cross([],Gt,en);o.a6.vec3.normalize(en,en),o.a6.vec3.normalize(er,er),fn=o.a6.vec3.dot(bt,en),pn=o.a6.vec3.dot(bt,er)}if(p){const en=o.a6.vec3.cross([],Gt,bt);o.a6.vec3.normalize(en,en),o.a6.vec3.scaleAndAdd(Wt,Wt,en,p*Ne)}const qt=De+Math.atan2(pn,fn);return st.push(Wt),ue&&rt.push(hn),{point:Wt,angle:qt,path:st,tilePath:rt,up:Gt}}function ll(b,u){const p=u.length,w=p+4*b;u.resize(w),u.float32.fill(-1/0,4*p,4*w)}function lg(b,u,p){const w=u[0],I=u[1];return b[0]=p[0]*w+p[4]*I+p[12],b[1]=p[1]*w+p[5]*I+p[13],b[3]=p[3]*w+p[7]*I+p[15],b}const Gs=100;class Lo{constructor(u,p,w=new fd(u.width+200,u.height+200,25),I=new fd(u.width+200,u.height+200,25)){this.transform=u,this.grid=w,this.ignoredGrid=I,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+Gs,this.screenBottomBoundary=u.height+Gs,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=p}placeCollisionBox(u,p,w,I,P,F,W,$){let J=w.projectedAnchorX,Q=w.projectedAnchorY,oe=w.projectedAnchorZ;const le=w.elevation,ue=w.tileID,ve=u.getProjection();if(le&&ue){const[He,et,Ke]=ve.upVector(ue.canonical,w.tileAnchorX,w.tileAnchorY),tt=ve.upVectorScale(ue.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=He*le*tt,Q+=et*le*tt,oe+=Ke*le*tt}const _e=this.projectAndGetPerspectiveRatio(W,J,Q,oe,w.tileID,ve.name==="globe"||!!le||this.transform.pitch>0,ve),be=F*_e.perspectiveRatio,we=(w.x1*p+I.x-w.padding)*be+_e.point.x,ke=(w.y1*p+I.y-w.padding)*be+_e.point.y,Ne=(w.x2*p+I.x+w.padding)*be+_e.point.x,De=(w.y2*p+I.y+w.padding)*be+_e.point.y,We=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(we,ke,Ne,De)||!P&&this.grid.hitTest(we,ke,Ne,De,$)||We?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[we,ke,Ne,De],offscreen:this.isOffscreen(we,ke,Ne,De),occluded:!1}}placeCollisionCircles(u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e){const be=[],we=this.transform.elevation,ke=u.getProjection(),Ne=we?we.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,ke):null,De=new o.P(w.tileAnchorX,w.tileAnchorY);let{x:We,y:He,z:et}=ke.projectTilePoint(De.x,De.y,_e.canonical);if(Ne){const[hn,bt,Wt]=Ne(De);We+=hn,He+=bt,et+=Wt}const Ke=ke.name==="globe",tt=this.projectAndGetPerspectiveRatio(W,We,He,et,_e,Ke||!!we||this.transform.pitch>0,ke),{perspectiveRatio:ut}=tt,st=(oe?F/ut:F*ut)/o.bq,rt=ga(We,He,et,$),xt=tt.signedDistanceFromCamera>0?pu(st,P,w.lineOffsetX*st,w.lineOffsetY*st,!1,rt,De,w,I,$,{},we&&!oe?Ne:null,oe&&!!we,ke,_e,oe):null;let Ft=!1,Zt=!1,kt=!0;if(xt&&!tt.occluded){const hn=.5*ue*ut+ve,bt=new o.P(-100,-100),Wt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Gt=new xs,{first:fn,last:pn}=xt,qt=fn.path.length;let en=[];for(let Dn=qt-1;Dn>=1;Dn--)en.push(fn.path[Dn]);for(let Dn=1;Dn<pn.path.length;Dn++)en.push(pn.path[Dn]);const er=2.5*hn;J&&(en=en.map(([Dn,yr,qn],ur)=>(Ne&&!Ke&&(qn=Ne(ur<qt-1?fn.tilePath[qt-1-ur]:pn.tilePath[ur-qt+2])[2]),ga(Dn,yr,qn,J))),en.some(Dn=>Dn[3]<=0)&&(en=[]));let xn=[];if(en.length>0){let Dn=1/0,yr=-1/0,qn=1/0,ur=-1/0;for(const Ur of en)Dn=Math.min(Dn,Ur[0]),qn=Math.min(qn,Ur[1]),yr=Math.max(yr,Ur[0]),ur=Math.max(ur,Ur[1]);yr>=bt.x&&Dn<=Wt.x&&ur>=bt.y&&qn<=Wt.y&&(xn=[en.map(Ur=>new o.P(Ur[0],Ur[1]))],(Dn<bt.x||yr>Wt.x||qn<bt.y||ur>Wt.y)&&(xn=o.bo(xn,bt.x,bt.y,Wt.x,Wt.y)))}for(const Dn of xn){Gt.reset(Dn,.25*hn);let yr=0;yr=Gt.length<=.5*hn?1:Math.ceil(Gt.paddedLength/er)+1;for(let qn=0;qn<yr;qn++){const ur=qn/Math.max(yr-1,1),Ur=Gt.lerp(ur),Br=Ur.x+Gs,Ci=Ur.y+Gs;be.push(Br,Ci,hn,0);const zi=Br-hn,is=Ci-hn,Wc=Br+hn,Qs=Ci+hn;if(kt=kt&&this.isOffscreen(zi,is,Wc,Qs),Zt=Zt||this.isInsideGrid(zi,is,Wc,Qs),!p&&this.grid.hitTestCircle(Br,Ci,hn,le)&&(Ft=!0,!Q))return{circles:[],offscreen:!1,collisionDetected:Ft,occluded:!1}}}}return{circles:!Q&&Ft||!Zt?[]:be,offscreen:kt,collisionDetected:Ft,occluded:tt.occluded}}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let w=1/0,I=1/0,P=-1/0,F=-1/0;for(const Q of u){const oe=new o.P(Q.x+Gs,Q.y+Gs);w=Math.min(w,oe.x),I=Math.min(I,oe.y),P=Math.max(P,oe.x),F=Math.max(F,oe.y),p.push(oe)}const W=this.grid.query(w,I,P,F).concat(this.ignoredGrid.query(w,I,P,F)),$={},J={};for(const Q of W){const oe=Q.key;if($[oe.bucketInstanceId]===void 0&&($[oe.bucketInstanceId]={}),$[oe.bucketInstanceId][oe.featureIndex])continue;const le=[new o.P(Q.x1,Q.y1),new o.P(Q.x2,Q.y1),new o.P(Q.x2,Q.y2),new o.P(Q.x1,Q.y2)];o.bp(p,le)&&($[oe.bucketInstanceId][oe.featureIndex]=!0,J[oe.bucketInstanceId]===void 0&&(J[oe.bucketInstanceId]=[]),J[oe.bucketInstanceId].push(oe.featureIndex))}return J}insertCollisionBox(u,p,w,I,P){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:I,collisionGroupID:P},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,p,w,I,P){const F=p?this.ignoredGrid:this.grid,W={bucketInstanceId:w,featureIndex:I,collisionGroupID:P};for(let $=0;$<u.length;$+=4)F.insertCircle(W,u[$],u[$+1],u[$+2])}projectAndGetPerspectiveRatio(u,p,w,I,P,F,W){const $=[p,w,I,1];let J=!1;I||this.transform.pitch>0?(o.a6.vec4.transformMat4($,$,u),this.fogState&&P&&W.name!=="globe"&&(J=function(le,ue,ve,_e,be,we){const ke=we.calculateFogTileMatrix(be),Ne=[ue,ve,_e];return o.a6.vec3.transformMat4(Ne,Ne,ke),Cn(le,o.a6.vec3.length(Ne),we.pitch,we._fov)}(this.fogState,p,w,I,P.toUnwrapped(),this.transform)>.9)):lg($,$,u);const Q=$[3];return{point:new o.P(($[0]/Q+1)/2*this.transform.width+Gs,(-$[1]/Q+1)/2*this.transform.height+Gs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(W)/Q*.5,1.5),signedDistanceFromCamera:Q,occluded:F&&$[2]>Q||J}}isOffscreen(u,p,w,I){return w<Gs||u>=this.screenRightBoundary||I<Gs||p>this.screenBottomBoundary}isInsideGrid(u,p,w,I){return w>=0&&u<this.gridRightBoundary&&I>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const u=o.a6.mat4.identity([]);return o.a6.mat4.translate(u,u,[-100,-100,0]),u}}function qo(b,u,p){const w=u.createTileMatrix(b,b.worldSize,p.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),b.projMatrix,w)}function Hh(b,u,p){if(u.projection.name===p.projection.name)return b.projMatrix;const w=p.clone();return w.setProjection(u.projection),qo(w,u.getProjection(),b)}function Oc(b,u,p){return u.name===p.projection.name?b.projMatrix:qo(p,u,b)}class Ds{constructor(u,p,w,I){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?p:-p))):I&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class va{constructor(u,p,w,I,P,F=!1){this.text=new Ds(u?u.text:null,p,w,P),this.icon=new Ds(u?u.icon:null,p,I,P),this.clipped=F}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cl{constructor(u,p,w,I=!1){this.text=u,this.icon=p,this.skipFade=w,this.clipped=I}}class qs{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class Hu{constructor(u,p,w,I,P){this.bucketInstanceId=u,this.featureIndex=p,this.sourceLayerIndex=w,this.bucketIndex=I,this.tileID=P}}class Zs{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const p=++this.maxGroupID;this.collisionGroups[u]={ID:p,predicate:w=>w.collisionGroupID===p}}return this.collisionGroups[u]}}function La(b,u,p,w,I){const{horizontalAlign:P,verticalAlign:F}=o.bx(b),W=-(P-.5)*u,$=-(F-.5)*p,J=o.bw(b,w);return new o.P(W+J[0]*I,$+J[1]*I)}function qa(b,u,p,w,I){const P=new o.P(b,u);return p&&P._rotate(w?I:-I),P}class mu{constructor(u,p,w,I,P,F){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new Lo(this.transform,P),this.buildingIndex=F,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Zs(w),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,p,w,I){const P=w.getBucket(p),F=w.latestFeatureIndex;if(!P||!F||p.fqid!==P.layerIds[0])return;const W=P.layers[0].layout,$=P.layers[0].paint,J=w.collisionBoxArray,Q=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),oe=w.tileSize/o.ab,le=w.tileID.toUnwrapped();this.transform.setProjection(P.projection);const ue=(ve=w.tileID,_e=P.getProjection(),be=this.transform,_e.name===this.projection?be.calculateProjMatrix(ve.toUnwrapped()):qo(be,_e,ve));var ve,_e,be;const we=W.get("text-pitch-alignment")==="map",ke=W.get("text-rotation-alignment")==="map";p.compileFilter();const Ne=p.dynamicFilter(),De=p.dynamicFilterNeedsFeature(),We=this.transform.calculatePixelsToTileUnitsMatrix(w),He=Zr(ue,w.tileID.canonical,we,ke,this.transform,P.getProjection(),We);let et=null;if(we){const ut=Us(ue,w.tileID.canonical,we,ke,this.transform,P.getProjection(),We);et=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,ut)}let Ke=null;Ne&&w.latestFeatureIndex&&(Ke={unwrappedTileID:le,dynamicFilter:Ne,dynamicFilterNeedsFeature:De}),this.retainedQueryData[P.bucketInstanceId]=new Hu(P.bucketInstanceId,F,P.sourceLayerIndex,P.index,w.tileID);const tt={bucket:P,layout:W,paint:$,posMatrix:ue,textLabelPlaneMatrix:He,labelToScreenMatrix:et,clippingData:Ke,scale:Q,textPixelRatio:oe,holdingForFade:w.holdingForFade(),collisionBoxArray:J,partiallyEvaluatedTextSize:o.bj(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.bj(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID),latestFeatureIndex:w.latestFeatureIndex};if(I)for(const ut of P.sortKeyRanges){const{sortKey:st,symbolInstanceStart:rt,symbolInstanceEnd:xt}=ut;u.push({sortKey:st,symbolInstanceStart:rt,symbolInstanceEnd:xt,parameters:tt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we,ke){const{textOffset0:Ne,textOffset1:De,crossTileID:We}=le,He=[Ne,De],et=La(u,w,I,He,P),Ke=this.collisionIndex.placeCollisionBox(ve,P,p,qa(et.x,et.y,F,W,this.transform.angle),oe,$,J,Q.predicate);if(be){const tt=ve.getSymbolInstanceIconSize(ke,this.transform.zoom,le.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,tt,be,qa(et.x,et.y,F,W,this.transform.angle),oe,$,J,Q.predicate).box.length===0)return}if(Ke.box.length>0){let tt;return this.prevPlacement&&this.prevPlacement.variableOffsets[We]&&this.prevPlacement.placements[We]&&this.prevPlacement.placements[We].text&&(tt=this.prevPlacement.variableOffsets[We].anchor),this.variableOffsets[We]={textOffset:He,width:w,height:I,anchor:u,textScale:P,prevAnchor:tt},this.markUsedJustification(ve,u,le,_e),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,_e,le),this.placedOrientations[We]=_e),{shift:et,placedGlyphBoxes:Ke}}}placeLayerBucketPart(u,p,w,I){const{bucket:P,layout:F,paint:W,posMatrix:$,textLabelPlaneMatrix:J,labelToScreenMatrix:Q,clippingData:oe,textPixelRatio:le,holdingForFade:ue,collisionBoxArray:ve,partiallyEvaluatedTextSize:_e,partiallyEvaluatedIconSize:be,collisionGroup:we,latestFeatureIndex:ke}=u.parameters,Ne=F.get("text-optional"),De=F.get("icon-optional"),We=F.get("text-allow-overlap"),He=F.get("icon-allow-overlap"),et=F.get("text-rotation-alignment")==="map",Ke=F.get("text-pitch-alignment")==="map",tt=F.get("symbol-z-elevate"),ut=W.get("symbol-z-offset"),st=W.get("symbol-elevation-reference")==="sea";this.transform.setProjection(P.projection);let rt=We&&(He||!P.hasIconData()||De),xt=He&&(We||!P.hasTextData()||Ne);const Ft=!ut.isConstant();!P.collisionArrays&&ve&&P.deserializeCollisionBoxes(ve),w&&I&&P.updateCollisionDebugBuffers(this.transform.zoom,ve);const Zt=(kt,hn,bt)=>{const{crossTileID:Wt,numVerticalGlyphVertices:Gt}=kt;let fn=null;if(oe&&oe.dynamicFilterNeedsFeature||Ft){const kr=this.retainedQueryData[P.bucketInstanceId];fn=ke.loadFeature({featureIndex:kt.featureIndex,bucketIndex:kr.bucketIndex,sourceLayerIndex:kr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(oe&&!(0,oe.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},fn,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new o.P(kt.tileAnchorX,kt.tileAnchorY),this.transform.calculateDistanceTileData(oe.unwrappedTileID)))return this.placements[Wt]=new cl(!1,!1,!1,!0),void p.add(Wt);const pn=ut.evaluate(fn,{});if(p.has(Wt))return;if(ue)return void(this.placements[Wt]=new cl(!1,!1,!1));let qt=!1,en=!1,er=!0,xn=!1,Dn=!1,yr=null,qn={box:null,offscreen:null,occluded:null},ur={box:null,offscreen:null,occluded:null},Ur=null,Br=null,Ci=null,zi=0,is=0,Wc=0;bt.textFeatureIndex?zi=bt.textFeatureIndex:kt.useRuntimeCollisionCircles&&(zi=kt.featureIndex),bt.verticalTextFeatureIndex&&(is=bt.verticalTextFeatureIndex);const Qs=kr=>{kr.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const pi=this.transform.elevation;kr.elevation=st?pn:pn+(pi?pi.getAtTileOffset(kr.tileID,kr.tileAnchorX,kr.tileAnchorY):0),kr.elevation+=kt.zOffset},Yr=bt.textBox;if(Yr){Qs(Yr);const kr=Ai=>{let Ns=o.bk.horizontal;if(P.allowVerticalPlacement&&!Ai&&this.prevPlacement){const eo=this.prevPlacement.placedOrientations[Wt];eo&&(this.placedOrientations[Wt]=eo,Ns=eo,this.markUsedOrientation(P,Ns,kt))}return Ns},pi=(Ai,Ns)=>{if(P.allowVerticalPlacement&&Gt>0&&bt.verticalTextBox){for(const eo of P.writingModes)if(eo===o.bk.vertical?(qn=Ns(),ur=qn):qn=Ai(),qn&&qn.box&&qn.box.length)break}else qn=Ai()};if(F.get("text-variable-anchor")){let Ai=F.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Wt]){const oi=this.prevPlacement.variableOffsets[Wt];Ai.indexOf(oi.anchor)>0&&(Ai=Ai.filter(Fo=>Fo!==oi.anchor),Ai.unshift(oi.anchor))}const Ns=(oi,Fo,Ko)=>{const No=P.getSymbolInstanceTextSize(_e,kt,this.transform.zoom,hn),Yi=(oi.x2-oi.x1)*No+2*oi.padding,pl=(oi.y2-oi.y1)*No+2*oi.padding,ml=kt.hasIconTextFit&&!He?Fo:null;ml&&Qs(ml);let Xc={box:[],offscreen:!1,occluded:!1};const dc=We?2*Ai.length:Ai.length;for(let Pl=0;Pl<dc;++Pl){const $c=this.attemptAnchorPlacement(Ai[Pl%Ai.length],oi,Yi,pl,No,et,Ke,le,$,we,Pl>=Ai.length,kt,hn,P,Ko,ml,_e,be);if($c&&(Xc=$c.placedGlyphBoxes,Xc&&Xc.box&&Xc.box.length)){qt=!0,yr=$c.shift;break}}return Xc};pi(()=>Ns(Yr,bt.iconBox,o.bk.horizontal),()=>{const oi=bt.verticalTextBox;return oi&&Qs(oi),P.allowVerticalPlacement&&!(qn&&qn.box&&qn.box.length)&&Gt>0&&oi?Ns(oi,bt.verticalIconBox,o.bk.vertical):{box:null,offscreen:null,occluded:null}}),qn&&(qt=qn.box,er=qn.offscreen,xn=qn.occluded);const eo=kr(!(!qn||!qn.box));if(!qt&&this.prevPlacement){const oi=this.prevPlacement.variableOffsets[Wt];oi&&(this.variableOffsets[Wt]=oi,this.markUsedJustification(P,oi.anchor,kt,eo))}}else{const Ai=(Ns,eo)=>{const oi=P.getSymbolInstanceTextSize(_e,kt,this.transform.zoom,hn),Fo=this.collisionIndex.placeCollisionBox(P,oi,Ns,new o.P(0,0),We,le,$,we.predicate);return Fo&&Fo.box&&Fo.box.length&&(this.markUsedOrientation(P,eo,kt),this.placedOrientations[Wt]=eo),Fo};pi(()=>Ai(Yr,o.bk.horizontal),()=>{const Ns=bt.verticalTextBox;return P.allowVerticalPlacement&&Gt>0&&Ns?(Qs(Ns),Ai(Ns,o.bk.vertical)):{box:null,offscreen:null,occluded:null}}),kr(!!(qn&&qn.box&&qn.box.length))}}if(Ur=qn,qt=Ur&&Ur.box&&Ur.box.length>0,er=Ur&&Ur.offscreen,xn=Ur&&Ur.occluded,kt.useRuntimeCollisionCircles){const kr=P.text.placedSymbolArray.get(kt.centerJustifiedTextSymbolIndex>=0?kt.centerJustifiedTextSymbolIndex:kt.verticalPlacedTextSymbolIndex),pi=o.bl(P.textSizeData,_e,kr),Ai=F.get("text-padding");Br=this.collisionIndex.placeCollisionCircles(P,We,kr,P.lineVertexArray,P.glyphOffsetArray,pi,$,J,Q,w,Ke,we.predicate,kt.collisionCircleDiameter*pi/o.bq,Ai,this.retainedQueryData[P.bucketInstanceId].tileID),qt=We||Br.circles.length>0&&!Br.collisionDetected,er=er&&Br.offscreen,xn=Br.occluded}if(bt.iconFeatureIndex&&(Wc=bt.iconFeatureIndex),bt.iconBox){const kr=pi=>{Qs(pi);const Ai=kt.hasIconTextFit&&yr?qa(yr.x,yr.y,et,Ke,this.transform.angle):new o.P(0,0),Ns=P.getSymbolInstanceIconSize(be,this.transform.zoom,kt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Ns,pi,Ai,He,le,$,we.predicate)};ur&&ur.box&&ur.box.length&&bt.verticalIconBox?(Ci=kr(bt.verticalIconBox),en=Ci.box.length>0):(Ci=kr(bt.iconBox),en=Ci.box.length>0),er=er&&Ci.offscreen,Dn=Ci.occluded}const Fi=Ne||kt.numHorizontalGlyphVertices===0&&Gt===0,ws=De||kt.numIconVertices===0;if(Fi||ws?ws?Fi||(en=en&&qt):qt=en&&qt:en=qt=en&&qt,qt&&Ur&&Ur.box&&this.collisionIndex.insertCollisionBox(Ur.box,F.get("text-ignore-placement"),P.bucketInstanceId,ur&&ur.box&&is?is:zi,we.ID),en&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,F.get("icon-ignore-placement"),P.bucketInstanceId,Wc,we.ID),Br&&(qt&&this.collisionIndex.insertCollisionCircles(Br.circles,F.get("text-ignore-placement"),P.bucketInstanceId,zi,we.ID),w)){const kr=P.bucketInstanceId;let pi=this.collisionCircleArrays[kr];pi===void 0&&(pi=this.collisionCircleArrays[kr]=new qs);for(let Ai=0;Ai<Br.circles.length;Ai+=4)pi.circles.push(Br.circles[Ai+0]),pi.circles.push(Br.circles[Ai+1]),pi.circles.push(Br.circles[Ai+2]),pi.circles.push(Br.collisionDetected?1:0)}const Li=P.projection.name!=="globe";rt=rt&&(Li||!xn),xt=xt&&(Li||!Dn),this.placements[Wt]=new cl(qt||rt,en||xt,er||P.justReloaded),p.add(Wt)};if(tt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(P,this.retainedQueryData[P.bucketInstanceId].tileID),P.updateZOffset()),P.sortFeaturesByY){const kt=P.getSortedSymbolIndexes(this.transform.angle);for(let hn=kt.length-1;hn>=0;--hn){const bt=kt[hn];Zt(P.symbolInstances.get(bt),bt,P.collisionArrays[bt])}P.hasAnyZOffset&&o.w(`${P.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(P.hasAnyZOffset){const kt=P.getSortedIndexesByZOffset();for(let hn=0;hn<kt.length;++hn){const bt=kt[hn];Zt(P.symbolInstances.get(bt),bt,P.collisionArrays[bt])}}else for(let kt=u.symbolInstanceStart;kt<u.symbolInstanceEnd;kt++)Zt(P.symbolInstances.get(kt),kt,P.collisionArrays[kt]);if(w&&P.bucketInstanceId in this.collisionCircleArrays){const kt=this.collisionCircleArrays[P.bucketInstanceId];o.a6.mat4.invert(kt.invProjMatrix,$),kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(u,p,w,I){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:W,verticalPlacedTextSymbolIndex:$,crossTileID:J}=w,Q=o.bv(p),oe=I===o.bk.vertical?$:Q==="left"?P:Q==="center"?F:Q==="right"?W:-1;P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=oe>=0&&P!==oe?0:J),F>=0&&(u.text.placedSymbolArray.get(F).crossTileID=oe>=0&&F!==oe?0:J),W>=0&&(u.text.placedSymbolArray.get(W).crossTileID=oe>=0&&W!==oe?0:J),$>=0&&(u.text.placedSymbolArray.get($).crossTileID=oe>=0&&$!==oe?0:J)}markUsedOrientation(u,p,w){const I=p===o.bk.horizontal||p===o.bk.horizontalOnly?p:0,P=p===o.bk.vertical?p:0,{leftJustifiedTextSymbolIndex:F,centerJustifiedTextSymbolIndex:W,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:J}=w,Q=u.text.placedSymbolArray;F>=0&&(Q.get(F).placedOrientation=I),W>=0&&(Q.get(W).placedOrientation=I),$>=0&&(Q.get($).placedOrientation=I),J>=0&&(Q.get(J).placedOrientation=P)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let w=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const I=p?p.symbolFadeChange(u):1,P=p?p.opacities:{},F=p?p.variableOffsets:{},W=p?p.placedOrientations:{};for(const $ in this.placements){const J=this.placements[$],Q=P[$];Q?(this.opacities[$]=new va(Q,I,J.text,J.icon,null,J.clipped),w=w||J.text!==Q.text.placed||J.icon!==Q.icon.placed):(this.opacities[$]=new va(null,I,J.text,J.icon,J.skipFade,J.clipped),w=w||J.text||J.icon)}for(const $ in P){const J=P[$];if(!this.opacities[$]){const Q=new va(J,I,!1,!1);Q.isHidden()||(this.opacities[$]=Q,w=w||J.text.placed||J.icon.placed)}}for(const $ in F)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=F[$]);for(const $ in W)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=W[$]);w?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:u)}updateLayerOpacities(u,p,w,I){const P=new Set;for(const F of p){const W=F.getBucket(u);W&&F.latestFeatureIndex&&u.fqid===W.layerIds[0]&&(this.updateBucketOpacities(W,P,F,F.collisionBoxArray,w,I,F.tileID,u.scope),W.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(W,F.tileID),W.updateZOffset()))}}updateBucketOpacities(u,p,w,I,P,F,W,$){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const J=u.layers[0].layout,Q=u.layers[0].paint,oe=!!u.layers[0].dynamicFilter(),le=new va(null,0,!1,!1,!0),ue=J.get("text-allow-overlap"),ve=J.get("icon-allow-overlap"),_e=J.get("text-variable-anchor"),be=J.get("text-rotation-alignment")==="map",we=J.get("text-pitch-alignment")==="map",ke=Q.get("symbol-z-offset"),Ne=Q.get("symbol-elevation-reference")==="sea",De=!ke.isConstant(),We=new va(null,0,ue&&(ve||!u.hasIconData()||J.get("icon-optional")),ve&&(ue||!u.hasTextData()||J.get("text-optional")),!0);!u.collisionArrays&&I&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(I);const He=(Ke,tt,ut)=>{for(let st=0;st<tt/4;st++)Ke.opacityVertexArray.emplaceBack(ut)};let et=0;F&&u.updateReplacement(W,F);for(let Ke=0;Ke<u.symbolInstances.length;Ke++){const tt=u.symbolInstances.get(Ke),{numHorizontalGlyphVertices:ut,numVerticalGlyphVertices:st,crossTileID:rt,numIconVertices:xt,tileAnchorX:Ft,tileAnchorY:Zt}=tt;let kt=null;if(tt&&De){const xn=this.retainedQueryData[u.bucketInstanceId];kt=w.latestFeatureIndex.loadFeature({featureIndex:tt.featureIndex,bucketIndex:xn.bucketIndex,sourceLayerIndex:xn.sourceLayerIndex,layoutVertexArrayOffset:0})}const hn=ke.evaluate(kt,{}),bt=p.has(rt);let Wt=this.opacities[rt];bt?Wt=le:Wt||(Wt=We,this.opacities[rt]=Wt),p.add(rt);const Gt=ut>0||st>0,fn=xt>0,pn=this.placedOrientations[rt],qt=pn===o.bk.vertical,en=pn===o.bk.horizontal||pn===o.bk.horizontalOnly;!Gt&&!fn||Wt.isHidden()||et++;let er=!1;if((Gt||fn)&&F)for(const xn of u.activeReplacements){if(o.br(xn,P,o.bs.Symbol,$)||xn.min.x>Ft||Ft>xn.max.x||xn.min.y>Zt||Zt>xn.max.y)continue;const Dn=o.bt(Ft,Zt,W.canonical,xn.footprintTileId.canonical);if(er=o.bu(Dn,xn.footprint),er)break}if(Gt){const xn=er?gu:Wu(Wt.text);He(u.text,ut,qt?gu:xn),He(u.text,st,en?gu:xn);const Dn=Wt.text.isHidden(),{leftJustifiedTextSymbolIndex:yr,centerJustifiedTextSymbolIndex:qn,rightJustifiedTextSymbolIndex:ur,verticalPlacedTextSymbolIndex:Ur}=tt,Br=u.text.placedSymbolArray,Ci=Dn||qt?1:0;yr>=0&&(Br.get(yr).hidden=Ci),qn>=0&&(Br.get(qn).hidden=Ci),ur>=0&&(Br.get(ur).hidden=Ci),Ur>=0&&(Br.get(Ur).hidden=Dn||en?1:0);const zi=this.variableOffsets[rt];zi&&this.markUsedJustification(u,zi.anchor,tt,pn);const is=this.placedOrientations[rt];is&&(this.markUsedJustification(u,"left",tt,is),this.markUsedOrientation(u,is,tt))}if(fn){const xn=er?gu:Wu(Wt.icon),{placedIconSymbolIndex:Dn,verticalPlacedIconSymbolIndex:yr}=tt,qn=u.icon.placedSymbolArray,ur=Wt.icon.isHidden()?1:0;Dn>=0&&(He(u.icon,xt,qt?gu:xn),qn.get(Dn).hidden=ur),yr>=0&&(He(u.icon,tt.numVerticalIconVertices,en?gu:xn),qn.get(yr).hidden=ur)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const xn=u.collisionArrays[Ke];if(xn){let Dn=new o.P(0,0),yr=!0;if(xn.textBox||xn.verticalTextBox){if(_e){const ur=this.variableOffsets[rt];ur?(Dn=La(ur.anchor,ur.width,ur.height,ur.textOffset,ur.textScale),be&&Dn._rotate(we?this.transform.angle:-this.transform.angle)):yr=!1}oe&&(yr=!Wt.clipped),xn.textBox&&Ep(u.textCollisionBox.collisionVertexArray,Wt.text.placed,!yr||qt,hn,Ne,Dn.x,Dn.y),xn.verticalTextBox&&Ep(u.textCollisionBox.collisionVertexArray,Wt.text.placed,!yr||en,hn,Ne,Dn.x,Dn.y)}const qn=yr&&!!(!en&&xn.verticalIconBox);xn.iconBox&&Ep(u.iconCollisionBox.collisionVertexArray,Wt.icon.placed,qn,hn,Ne,tt.hasIconTextFit?Dn.x:0,tt.hasIconTextFit?Dn.y:0),xn.verticalIconBox&&Ep(u.iconCollisionBox.collisionVertexArray,Wt.icon.placed,!qn,hn,Ne,tt.hasIconTextFit?Dn.x:0,tt.hasIconTextFit?Dn.y:0)}}}if(u.fullyClipped=et===0,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Ke.invProjMatrix,u.placementViewportMatrix=Ke.viewportMatrix,u.collisionCircleArray=Ke.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,p){const w=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function Ep(b,u,p,w,I,P,F){b.emplaceBack(u?1:0,p?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,p?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,p?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,p?1:0,P||0,F||0,w,I?1:0)}const oa=Math.pow(2,25),ju=Math.pow(2,24),Ip=Math.pow(2,17),Da=Math.pow(2,16),cg=Math.pow(2,9),Rp=Math.pow(2,8),Fv=Math.pow(2,1);function Wu(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const u=b.placed?1:0,p=Math.floor(127*b.opacity);return p*oa+u*ju+p*Ip+u*Da+p*cg+u*Rp+p*Fv+u}const gu=0;class C1{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,p,w,I,P){const F=this._bucketParts;for(;this._currentTileIndex<u.length;)if(p.getBucketParts(F,I,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((W,$)=>W.sortKey-$.sortKey));this._currentPartIndex<F.length;){const W=F[this._currentPartIndex];if(p.placeLayerBucketPart(W,this._seenCrossTileIDs,w,W.symbolInstanceStart===0),this._currentPartIndex++,P())return!0}return!1}}class pd{constructor(u,p,w,I,P,F,W,$,J){this.placement=new mu(u,P,F,W,$,J),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(u,p,w,I){const P=o.q.now(),F=()=>{const W=o.q.now()-P;return!this._forceFullPlacement&&W>2};for(;this._currentPlacementIndex>=0;){const W=p[u[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(W.type==="symbol"&&(!W.minzoom||W.minzoom<=$)&&(!W.maxzoom||W.maxzoom>$)){const J=W,Q=J.layout.get("symbol-z-elevate"),oe=J.layout.get("symbol-sort-key").constantOr(1)!==void 0,le=J.layout.get("symbol-z-order"),ue=le==="viewport-y"||le==="auto"&&!(le!=="viewport-y"&&oe),ve=J.layout.get("text-allow-overlap")||J.layout.get("icon-allow-overlap")||J.layout.get("text-ignore-placement")||J.layout.get("icon-ignore-placement"),_e=ue&&ve,be=this._inProgressLayer=this._inProgressLayer||new C1(J),we=o.av(W.source,W.scope);if(be.continuePlacement(Q||_e?I[we]:w[we],this.placement,this._showCollisionBoxes,W,F))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const Xu=512/o.ab/2;class Nv{constructor(u,p,w){this.tileID=u,this.bucketInstanceId=w,this.index=new o.by(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const I=u.canonical.x*o.ab,P=u.canonical.y*o.ab;for(let F=0;F<p.length;F++){const{key:W,crossTileID:$,tileAnchorX:J,tileAnchorY:Q}=p.get(F),oe=Math.floor((I+J)*Xu),le=Math.floor((P+Q)*Xu);this.index.add(oe,le),this.keys.push(W),this.crossTileIDs.push($)}this.index.finish()}findMatches(u,p,w){const I=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),P=Xu/Math.pow(2,p.canonical.z-this.tileID.canonical.z),F=p.canonical.x*o.ab,W=p.canonical.y*o.ab;for(let $=0;$<u.length;$++){const J=u.get($);if(J.crossTileID)continue;const{key:Q,tileAnchorX:oe,tileAnchorY:le}=J,ue=Math.floor((F+oe)*P),ve=Math.floor((W+le)*P),_e=this.index.range(ue-I,ve-I,ue+I,ve+I);for(const be of _e){const we=this.crossTileIDs[be];if(this.keys[be]===Q&&!w.has(we)){w.add(we),J.crossTileID=we;break}}}}}class Ql{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class jh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const p=Math.round((u-this.lng)/360);if(p!==0)for(const w in this.indexes){const I=this.indexes[w],P={};for(const F in I){const W=I[F];W.tileID=W.tileID.unwrapTo(W.tileID.wrap+p),P[W.tileID.key]=W}this.indexes[w]=P}this.lng=u}addBucket(u,p,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let P=0;P<p.symbolInstances.length;P++)p.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const I=this.usedCrossTileIDs[u.overscaledZ];for(const P in this.indexes){const F=this.indexes[P];if(Number(P)>u.overscaledZ)for(const W in F){const $=F[W];$.tileID.isChildOf(u)&&$.findMatches(p.symbolInstances,u,I)}else{const W=F[u.scaledTo(Number(P)).key];W&&W.findMatches(p.symbolInstances,u,I)}}for(let P=0;P<p.symbolInstances.length;P++){const F=p.symbolInstances.get(P);F.crossTileID||(F.crossTileID=w.generate(),I.add(F.crossTileID))}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Nv(u,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(u,p){for(const w of p.crossTileIDs)this.usedCrossTileIDs[u].delete(w)}removeStaleBuckets(u){let p=!1;for(const w in this.indexes){const I=this.indexes[w];for(const P in I)u[I[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,I[P]),delete I[P],p=!0)}return p}}class Wh{constructor(){this.layerIndexes={},this.crossTileIDs=new Ql,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,p,w,I){let P=this.layerIndexes[u.fqid];P===void 0&&(P=this.layerIndexes[u.fqid]=new jh);let F=!1;const W={};I.name!=="globe"&&P.handleWrapJump(w);for(const $ of p){const J=$.getBucket(u);J&&u.fqid===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket($.tileID,J,this.crossTileIDs)&&(F=!0),W[J.bucketInstanceId]=!0)}return P.removeStaleBuckets(W)&&(F=!0),F}pruneUnusedLayers(u){const p={};u.forEach(w=>{p[w]=!0});for(const w in this.layerIndexes)p[w]||delete this.layerIndexes[w]}}const _a=771;class Mr{constructor(u,p,w,I){this.blendFunction=u,this.blendColor=p,this.mask=w,this.blendEquation=I}}Mr.Replace=[1,0,1,0],Mr.disabled=new Mr(Mr.Replace,o.bz.transparent,[!1,!1,!1,!1]),Mr.unblended=new Mr(Mr.Replace,o.bz.transparent,[!0,!0,!0,!0]),Mr.alphaBlended=new Mr([1,_a,1,_a],o.bz.transparent,[!0,!0,!0,!0]),Mr.alphaBlendedNonPremultiplied=new Mr([770,_a,770,_a],o.bz.transparent,[!0,!0,!0,!0]),Mr.multiply=new Mr([774,0,774,0],o.bz.transparent,[!0,!0,!0,!0]);class $n{constructor(u,p,w){this.func=u,this.mask=p,this.range=w}}$n.ReadOnly=!1,$n.ReadWrite=!0,$n.disabled=new $n(519,$n.ReadOnly,[0,1]);const vu=7680;class pr{constructor(u,p,w,I,P,F){this.test=u,this.ref=p,this.mask=w,this.fail=I,this.depthFail=P,this.pass=F}}pr.disabled=new pr({func:519,mask:0},0,0,vu,vu,vu);const ec=1029,tc=2305;class _r{constructor(u,p,w){this.enable=u,this.mode=p,this.frontFace=w}}function Pp(b,u){const p=o.bC(b,3);o.a6.mat4.fromQuat(b,u),o.bE(b,3,p)}function md(b,u){const p=o.a6.quat.identity([]);return o.a6.quat.rotateZ(p,p,-u),o.a6.quat.rotateX(p,p,-b),p}function Ba(b,u){const p=[b[0],b[1],0],w=[u[0],u[1],0];if(o.a6.vec3.length(p)>=1e-15){const F=o.a6.vec3.normalize([],p);o.a6.vec3.scale(w,F,o.a6.vec3.dot(w,F)),u[0]=w[0],u[1]=w[1]}const I=o.a6.vec3.cross([],u,b);if(o.a6.vec3.len(I)<1e-15)return null;const P=Math.atan2(-I[1],I[0]);return md(Math.atan2(Math.sqrt(b[0]*b[0]+b[1]*b[1]),-b[2]),P)}_r.disabled=new _r(!1,ec,tc),_r.backCCW=new _r(!0,ec,tc),_r.backCW=new _r(!0,ec,2304),_r.frontCW=new _r(!0,1028,2304),_r.frontCCW=new _r(!0,1028,tc);class xo{constructor(u,p){this.position=u,this.orientation=p}get position(){return this._position}set position(u){if(u){const p=u instanceof o.a5?u:new o.a5(u[0],u[1],u[2]);this._renderWorldCopies&&(p.x=o.bA(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(u,p){if(this.orientation=null,!this.position)return;const w=this.position,I=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(u)):0,P=o.a5.fromLngLat(u,I),F=[P.x-w.x,P.y-w.y,P.z-w.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=Ba(F,p)}setPitchBearing(u,p){this.orientation=md(o.bB(u),o.bB(-p))}}class ns{constructor(u,p){this._transform=o.a6.mat4.identity([]),this.orientation=p,this.position=u}get mercatorPosition(){const u=this.position;return new o.a5(u[0],u[1],u[2])}get position(){const u=o.bC(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var p;u&&o.bE(this._transform,3,[(p=u)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||o.a6.quat.identity([]),u&&Pp(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,p){this._orientation=md(u,p),Pp(this._transform,this._orientation)}forward(){const u=o.bC(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=o.bC(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=o.bC(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,p){const w=new Float64Array(16);return o.a6.mat4.invert(w,this.getWorldToCamera(u,p)),w}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(u,p,w){const I=this.position;o.a6.vec3.scale(I,I,-u);const P=new Float64Array(16);return o.a6.mat4.fromScaling(P,[w,w,w]),o.a6.mat4.translate(P,P,I),P[10]*=p,P}getWorldToCamera(u,p){const w=new Float64Array(16),I=new Float64Array(4),P=this.position;return o.a6.quat.conjugate(I,this._orientation),o.a6.vec3.scale(P,P,-u),o.a6.mat4.fromQuat(w,I),o.a6.mat4.translate(w,w,P),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=p,w[9]*=p,w[10]*=p,w[11]*=p,w}getCameraToClipPerspective(u,p,w,I){const P=new Float64Array(16);return o.a6.mat4.perspective(P,u,p,w,I),P}getCameraToClipOrthographic(u,p,w,I,P,F){const W=new Float64Array(16);return o.a6.mat4.ortho(W,u,p,w,I,P,F),W}getDistanceToElevation(u,p=!1){const w=u===0?0:o.bD(u,p?o.aM(this.position[1]):this.position[1]),I=this.forward();return(w-this.position[2])/I[2]}clone(){return new ns([...this.position],[...this.orientation])}}const ao={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Za{constructor(u=0,p=0,w=0,I=0){if(isNaN(u)||u<0||isNaN(p)||p<0||isNaN(w)||w<0||isNaN(I)||I<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=p,this.left=w,this.right=I}interpolate(u,p,w){return p.top!=null&&u.top!=null&&(this.top=o.aa(u.top,p.top,w)),p.bottom!=null&&u.bottom!=null&&(this.bottom=o.aa(u.bottom,p.bottom,w)),p.left!=null&&u.left!=null&&(this.left=o.aa(u.left,p.left,w)),p.right!=null&&u.right!=null&&(this.right=o.aa(u.right,p.right,w)),this}getCenter(u,p){const w=o.ap((this.left+u-this.right)/2,0,u),I=o.ap((this.top+p-this.bottom)/2,0,p);return new o.P(w,I)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Za(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Xh=(b,u,p)=>(1-p)*b+p*u,$h=b=>b*b*b*b*b;class gd{constructor(u,p,w,I,P,F,W){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=w??0,this._maxPitch=I??60,this.setProjection(F),this.setMaxBounds(W),this.width=0,this.height=0,this._center=new o.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Za,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ns,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const u=new gd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(u,p=!1){const w=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||w)&&this._updateCameraOnTerrain(),(u||w)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=o.bL(this.projectionOptions);const w=this.getProjection(),I=!o.bh(p,w);return I&&this._calcMatrices(),this.mercatorFromTransition=!1,I}setOrthographicProjectionAtLowPitch(u){return this._orthographicProjectionAtLowPitch!==u&&(this._orthographicProjectionAtLowPitch=u,this._calcMatrices(),!0)}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bL({name:"mercator"});const p=u!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bA(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const p=-u*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const p=o.ap(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=o.bB(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const p=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(u){this._tileCoverLift!==u&&(this._tileCoverLift=u)}_updateCameraOnTerrain(){const u=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,p=this.elevation&&u===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||u===Number.NEGATIVE_INFINITY&&(!p||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const w=this._elevation;p||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&w.exaggeration()&&this._centerAltitudeValidForExaggeration!==w.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*w.exaggeration(),this._centerAltitudeValidForExaggeration=w.exaggeration()):(this._centerAltitude=u||0,this._centerAltitudeValidForExaggeration=w.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let I=0,P=0;for(let F=0;F<p.length;F++){const W=new o.P(p[F][0]*this.width,w+p[F][1]*(this.height-w)),$=u.pointCoordinate(W);if(!$)continue;const J=1/Math.hypot($[0]-this._camera.position[0],$[1]-this._camera.position[1]);I+=$[3]*J,P+=J}return P===0?NaN:I/P}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const u=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=this.pixelsPerMeter/this.worldSize*p,I=this._mercatorZfromZoom(u),P=this._mercatorZfromZoom(this._maxZoom),F=Math.max(I-w,P);this._setZoom(this._zoomFromMercatorZ(F))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let w;w=u.z<this._camera.position[2]?[p.x,p.y,p.z]:[u.x,u.y,u.z];const I=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,w));return o.ap(this._zoomFromMercatorZ(I),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let p=!1;if(u.orientation&&!o.a6.quat.exactEquals(u.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(u.orientation)),u.position){const w=[u.position.x,u.position.y,u.position.z];o.a6.vec3.exactEquals(w,this._camera.position)||(this._setCameraPosition(w),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,p=new xo;return p.position=new o.a5(u[0],u[1],u[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(u){if(!o.a6.quat.length(u))return!1;o.a6.quat.normalize(u,u);const p=o.a6.vec3.transformQuat([],[0,0,-1],u),w=o.a6.vec3.transformQuat([],[0,-1,0],u);if(w[2]<0)return!1;const I=Ba(p,w);return!!I&&(this._camera.orientation=I,!0)}_setCameraPosition(u){const p=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,I=this.cameraToCenterDistance;u[2]=o.ap(u[2],I/w,I/p),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,p,w){this._unmodified=!1,this._edgeInsets.interpolate(u,p,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const p=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(u){const p=[new o.bM(0,u)];if(this.renderWorldCopies){const w=this.pointCoordinate(new o.P(0,0)),I=this.pointCoordinate(new o.P(this.width,0)),P=this.pointCoordinate(new o.P(this.width,this.height)),F=this.pointCoordinate(new o.P(0,this.height)),W=Math.floor(Math.min(w.x,I.x,P.x,F.x)),$=Math.floor(Math.max(w.x,I.x,P.x,F.x)),J=1;for(let Q=W-J;Q<=$+J;Q++)Q!==0&&p.push(new o.bM(Q,u))}return p}isLODDisabled(u){return(!u||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(u,p,w){let I=[];const P=w!==void 0,F=!P;if(F&&this.zoom<p||P&&w[0]===0&&w[1]===0)return I;const W=new Set,$=(Q,oe,le,ue,ve)=>{const _e=o.c1(oe,Q,le,ue,ve);W.has(_e)||(I.push(new o.aA(Q,oe,le,ue,ve)),W.add(_e))};for(let Q=0;Q<u.length;Q++){const oe=u[Q];if(F&&oe.canonical.z!==p)continue;const le=oe.canonical,ue=oe.overscaledZ,ve=oe.wrap,_e=1<<le.z,be=le.x+1<_e,we=le.x>0,ke=le.y+1<_e,Ne=le.y>0,De=oe.wrap-(we?0:1),We=oe.wrap+(be?0:1),He=we?le.x-1:_e-1,et=be?le.x+1:0;if(P)w[0]<0?($(ue,We,le.z,et,le.y),w[1]<0&&ke&&($(ue,ve,le.z,le.x,le.y+1),$(ue,We,le.z,et,le.y+1)),w[1]>0&&Ne&&($(ue,ve,le.z,le.x,le.y-1),$(ue,We,le.z,et,le.y-1))):w[0]>0?($(ue,De,le.z,He,le.y),w[1]<0&&ke&&($(ue,ve,le.z,le.x,le.y+1),$(ue,De,le.z,He,le.y+1)),w[1]>0&&Ne&&($(ue,ve,le.z,le.x,le.y-1),$(ue,De,le.z,He,le.y-1))):w[1]<0&&ke?$(ue,ve,le.z,le.x,le.y+1):Ne&&$(ue,ve,le.z,le.x,le.y-1);else{const Ke=oe.visibleQuadrants;1&Ke&&($(ue,De,le.z,He,le.y),Ne&&($(ue,ve,le.z,le.x,le.y-1),$(ue,De,le.z,He,le.y-1))),2&Ke&&($(ue,We,le.z,et,le.y),Ne&&($(ue,ve,le.z,le.x,le.y-1),$(ue,We,le.z,et,le.y-1))),4&Ke&&($(ue,De,le.z,He,le.y),ke&&($(ue,ve,le.z,le.x,le.y+1),$(ue,De,le.z,He,le.y+1))),8&Ke&&($(ue,We,le.z,et,le.y),ke&&($(ue,ve,le.z,le.x,le.y+1),$(ue,We,le.z,et,le.y+1)))}}const J=[];for(const Q of I)I.some(oe=>Q.isChildOf(oe))||J.push(Q);if(I=J.filter(Q=>!u.some(oe=>!!(Q.overscaledZ<p&&oe.isChildOf(Q))||Q.equals(oe)||Q.isChildOf(oe))),F){const Q=1<<p,oe=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=[Q*oe.x,Q*oe.y],ue=4,ve=ue*ue;I=I.filter(_e=>{const be=_e.canonical.x+.5-le[0],we=_e.canonical.y+.5-le[1];return be*be+we*we<ve})}return I}coveringTiles(u){let p=this.coveringZoomLevel(u);const w=p,I=this.elevation&&this.elevation.exaggeration(),P=I&&!u.isTerrainDEM,F=this.projection.name==="mercator";if(u.minzoom!==void 0&&p<u.minzoom)return[];u.maxzoom!==void 0&&p>u.maxzoom&&(p=u.maxzoom);const W=this.locationCoordinate(this.center),$=this.center.lat,J=1<<p,Q=[J*W.x,J*W.y,0],oe=this.projection.name==="globe",le=!oe,ue=o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,le),ve=oe?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=J*o.bD(1,this.center.lat),be=this._camera.position[2]/o.bD(1,this.center.lat),we=[J*ve.x,J*ve.y,be*(le?1:_e)],ke=oe||I,Ne=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),De=this.isLODDisabled(!0)?p:0;let We;if(this._elevation&&u.isTerrainDEM)We=1e4*this._elevation.exaggeration();else if(this._elevation){const bt=this._elevation.getMinMaxForVisibleTiles();We=bt?bt.max:this._centerAltitude}else We=this._centerAltitude;const He=u.isTerrainDEM?-We:this._elevation?this._elevation.getMinElevationBelowMSL():0,et=this.projection.isReprojectedInTileSpace?o.bO(this):1,Ke=bt=>{const Gt=new o.a5(bt.x+25e-6,bt.y,bt.z),fn=new o.a5(bt.x,bt.y+25e-6,bt.z),pn=bt.toLngLat(),qt=Gt.toLngLat(),en=fn.toLngLat(),er=this.locationCoordinate(pn),xn=this.locationCoordinate(qt),Dn=this.locationCoordinate(en),yr=Math.hypot(xn.x-er.x,xn.y-er.y),qn=Math.hypot(Dn.x-er.x,Dn.y-er.y);return Math.sqrt(yr*qn)*et/25e-6},tt=bt=>{const Wt=We,Gt=He;return{aabb:o.bR(this,J,0,0,0,bt,Gt,Wt,this.projection),zoom:0,x:0,y:0,minZ:Gt,maxZ:Wt,wrap:bt,fullyVisible:!1}},ut=[];let st=[];const rt=p,xt=u.reparseOverscaled?w:p,Ft=(be-this._centerAltitude)*_e,Zt=bt=>{if(!this._elevation||!bt.tileID||!F)return;const Wt=this._elevation.getMinMaxForTile(bt.tileID),Gt=bt.aabb;Wt?(Gt.min[2]=Wt.min,Gt.max[2]=Wt.max,Gt.center[2]=(Gt.min[2]+Gt.max[2])/2):(bt.shouldSplit=hn(bt),bt.shouldSplit||(Gt.min[2]=Gt.max[2]=Gt.center[2]=this._centerAltitude))},kt=(bt,Wt)=>{if(.707*Wt<bt)return 1;const Gt=Wt/bt;return Gt/(1.4144271570014144+(Math.pow(1.1,Gt-1.4144271570014144+1)-1)/(1.1-1)-1)},hn=bt=>{if(bt.zoom<De)return!0;if(bt.zoom===rt)return!1;if(bt.shouldSplit!=null)return bt.shouldSplit;const Wt=bt.aabb.distanceX(we),Gt=bt.aabb.distanceY(we);let fn=Ft,pn=1;if(oe){fn=bt.aabb.distanceZ(we);const qn=Math.pow(2,bt.zoom),ur=o.aM((bt.y+1)/qn),Ur=o.aM(bt.y/qn),Br=Math.min(Math.max($,ur),Ur),Ci=o.c5(Br)/o.c5($);if(pn=Br===$?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=o.c2&&bt.zoom===rt-1&&Ci>=.9)return!0}else if(P&&(fn=bt.aabb.distanceZ(we)*_e),this.projection.isReprojectedInTileSpace&&w<=5){const qn=Math.pow(2,bt.zoom),ur=Ke(new o.a5((bt.x+.5)/qn,(bt.y+.5)/qn));pn=ur>.85?1:ur}if(!F){const qn=Math.sqrt(Wt*Wt+Gt*Gt+fn*fn);let ur=(1<<rt-bt.zoom)*Ne*pn;return ur*=kt(Math.max(fn,Ft),qn),qn<ur}let qt=Number.MAX_VALUE,en=0;const er=bt.aabb.getCorners(),xn=[];for(const qn of er){o.a6.vec3.sub(xn,qn,we),oe||(P?xn[2]*=_e:xn[2]=Ft);const ur=o.a6.vec3.dot(xn,this._camera.forward());ur<qt&&(qt=ur,en=Math.abs(xn[2]))}let Dn=(1<<rt-bt.zoom)*Ne*pn;if(Dn*=kt(Math.max(en,Ft),qt),qt<Dn)return!0;const yr=bt.aabb.closestPoint(Q);return yr[0]===Q[0]&&yr[1]===Q[1]};if(this.renderWorldCopies)for(let bt=1;bt<=3;bt++)ut.push(tt(-bt)),ut.push(tt(bt));for(ut.push(tt(0));ut.length>0;){const bt=ut.pop(),Wt=bt.x,Gt=bt.y;let fn=bt.fullyVisible;const pn=()=>this.projection.name==="globe"&&(bt.y===0||bt.y===(1<<bt.zoom)-1);if(!fn){let qt=ke?bt.aabb.intersects(ue):bt.aabb.intersectsFlat(ue);if(qt===0&&pn()){const en=new o.bP(bt.zoom,Wt,Gt);qt=o.bQ(this,J,en,!0).intersects(ue)}if(qt===0)continue;fn=qt===2}if(bt.zoom!==rt&&hn(bt))for(let qt=0;qt<4;qt++){const en=(Wt<<1)+qt%2,er=(Gt<<1)+(qt>>1),xn={aabb:F?bt.aabb.quadrant(qt):o.bR(this,J,bt.zoom+1,en,er,bt.wrap,bt.minZ,bt.maxZ,this.projection),zoom:bt.zoom+1,x:en,y:er,wrap:bt.wrap,fullyVisible:fn,tileID:void 0,shouldSplit:void 0,minZ:bt.minZ,maxZ:bt.maxZ};P&&!oe&&(xn.tileID=new o.aA(bt.zoom+1===rt?xt:bt.zoom+1,bt.wrap,bt.zoom+1,en,er),Zt(xn)),ut.push(xn)}else{const qt=bt.zoom===rt?xt:bt.zoom;if(u.minzoom&&u.minzoom>qt)continue;let en=0;if(!fn){let yr=ke?bt.aabb.intersectsPrecise(ue):bt.aabb.intersectsPreciseFlat(ue);if(yr===0&&pn()){const qn=new o.bP(bt.zoom,Wt,Gt);yr=o.bQ(this,J,qn,!0).intersectsPrecise(ue)}if(yr===0)continue;if(u.calculateQuadrantVisibility)if(ue.containsPoint(bt.aabb.center))en=15;else for(let qn=0;qn<4;qn++)bt.aabb.quadrant(qn).intersects(ue)!==0&&(en|=1<<qn)}const er=Q[0]-(.5+Wt+(bt.wrap<<bt.zoom))*(1<<p-bt.zoom),xn=Q[1]-.5-Gt,Dn=bt.tileID?bt.tileID:new o.aA(qt,bt.wrap,bt.zoom,Wt,Gt);u.calculateQuadrantVisibility&&(Dn.visibleQuadrants=en),st.push({tileID:Dn,distanceSq:er*er+xn*xn})}}if(this.fogCullDistSq){const bt=this.fogCullDistSq,Wt=this.horizonLineFromTop();st=st.filter(Gt=>{const fn=[0,0,0,1],pn=[o.ab,o.ab,0,1],qt=this.calculateFogTileMatrix(Gt.tileID.toUnwrapped());o.a6.vec4.transformMat4(fn,fn,qt),o.a6.vec4.transformMat4(pn,pn,qt);const en=o.a6.vec4.min([],fn,pn),er=o.a6.vec4.max([],fn,pn),xn=o.bS(en,er);if(xn===0)return!0;let Dn=!1;const yr=this._elevation;if(yr&&xn>bt&&Wt!==0){const qn=this.calculateProjMatrix(Gt.tileID.toUnwrapped());let ur;u.isTerrainDEM||(ur=yr.getMinMaxForTile(Gt.tileID)),ur||(ur={min:He,max:We});const Ur=o.c3(this.rotation),Br=[Ur[0]*o.ab,Ur[1]*o.ab,ur.max];o.a6.vec3.transformMat4(Br,Br,qn),Dn=(1-Br[1])*this.height*.5<Wt}return xn<bt||Dn})}return st.sort((bt,Wt)=>bt.distanceSq-Wt.distanceSq).map(bt=>bt.tileID)}resize(u,p){this.width=u,this.height=p,this.pixelsToGLUnits=[2/u,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const p=o.ap(u.lat,-o.bT,o.bT),w=this.projection.project(u.lng,p);return new o.P(w.x*this.worldSize,w.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,p){let w,I;const P=this.centerPoint;if(this.projection.name==="globe"){const W=this.worldSize;w=(p.x-P.x)/W,I=(p.y-P.y)/W}else{const W=this.pointCoordinate(p),$=this.pointCoordinate(P);w=W.x-$.x,I=W.y-$.y}const F=this.locationCoordinate(u);this.setLocation(new o.a5(F.x-w,F.y-I))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,p){const w=p?o.bD(p,u.lat):void 0,I=this.projection.project(u.lng,u.lat);return new o.a5(I.x,I.y,w)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,p){const w=p??this._centerAltitude,I=[u.x,u.y,0,1],P=[u.x,u.y,1,1];o.a6.vec4.transformMat4(I,I,this.pixelMatrixInverse),o.a6.vec4.transformMat4(P,P,this.pixelMatrixInverse);const F=P[3];o.a6.vec4.scale(I,I,1/I[3]),o.a6.vec4.scale(P,P,1/F);const W=I[2],$=P[2];return{p0:I,p1:P,t:W===$?0:(w-W)/($-W)}}screenPointToMercatorRay(u){const p=[u.x,u.y,0,1],w=[u.x,u.y,1,1];return o.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),o.a6.vec4.transformMat4(w,w,this.pixelMatrixInverse),o.a6.vec4.scale(p,p,1/p[3]),o.a6.vec4.scale(w,w,1/w[3]),p[2]=o.bD(p[2],this._center.lat)*this.worldSize,w[2]=o.bD(w[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(p,p,1/this.worldSize),o.a6.vec4.scale(w,w,1/this.worldSize),new o.aj([p[0],p[1],p[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],w,p)))}rayIntersectionCoordinate(u){const{p0:p,p1:w,t:I}=u,P=o.bD(p[2],this._center.lat),F=o.bD(w[2],this._center.lat);return new o.a5(o.aa(p[0],w[0],I)/this.worldSize,o.aa(p[1],w[1],I)/this.worldSize,o.aa(P,F,I))}pointCoordinate(u,p=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,p)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let p=this.projection.pointCoordinate3D(this,u.x,u.y);if(p)return new o.a5(p[0],p[1],p[2]);let w=0,I=this.horizonLineFromTop();if(u.y>I)return this.pointCoordinate(u);const P=.02*I,F=u.clone();for(let W=0;W<10&&I-w>P;W++){F.y=o.aa(w,I,.66);const $=this.projection.pointCoordinate3D(this,F.x,F.y);$?(I=F.y,p=$):w=F.y}return p?new o.a5(p[0],p[1],p[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=o.bU)return!this.isPointAboveHorizon(u);const p=this.pointCoordinate(u);return p.y>=0&&p.y<=1}_coordinatePoint(u,p){const w=p&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,I=[u.x*this.worldSize,u.y*this.worldSize,w+u.toAltitude(),1];return o.a6.vec4.transformMat4(I,I,this.pixelMatrix),I[3]>0?new o.P(I[0]/I[3],I[1]/I[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:p}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,P=this.pointLocation3D(new o.P(p,u)),F=this.pointLocation3D(new o.P(I,u)),W=this.pointLocation3D(new o.P(I,w)),$=this.pointLocation3D(new o.P(p,w));let J=Math.min(P.lng,F.lng,W.lng,$.lng),Q=Math.max(P.lng,F.lng,W.lng,$.lng),oe=Math.min(P.lat,F.lat,W.lat,$.lat),le=Math.max(P.lat,F.lat,W.lat,$.lat);const ue=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,_e=(be,we,ke,Ne,De)=>{const We=(be+ke)/2,He=(we+Ne)/2,et=new o.P(We,He),{lng:Ke,lat:tt}=this.pointLocation3D(et),ut=Math.max(0,J-Ke,oe-tt,Ke-Q,tt-le);J=Math.min(J,Ke),Q=Math.max(Q,Ke),oe=Math.min(oe,tt),le=Math.max(le,tt),(De<ve||ut>ue)&&(_e(be,we,We,He,De+1),_e(We,He,ke,Ne,De+1))};if(_e(p,u,I,u,1),_e(I,u,I,w,1),_e(I,w,p,w,1),_e(p,w,p,u,1),this.projection.name==="globe"){const[be,we]=o.bV(this);be?(le=90,Q=180,J=-180):we&&(oe=-90,Q=180,J=-180)}return new o.as(new o.bK(J,oe),new o.bK(Q,le))}_getBoundsRectangular(u,p){const{top:w,left:I}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,F=this.width-this._edgeInsets.right,W=new o.P(I,w),$=new o.P(F,w),J=new o.P(F,P),Q=new o.P(I,P);let oe=this.pointCoordinate(W,u),le=this.pointCoordinate($,u);const ue=this.pointCoordinate(J,p),ve=this.pointCoordinate(Q,p),_e=(be,we)=>(we.y-be.y)/(we.x-be.x);return oe.y>1&&le.y>=0?oe=new o.a5((1-ve.y)/_e(ve,oe)+ve.x,1):oe.y<0&&le.y<=1&&(oe=new o.a5(-ve.y/_e(ve,oe)+ve.x,0)),le.y>1&&oe.y>=0?le=new o.a5((1-ue.y)/_e(ue,le)+ue.x,1):le.y<0&&oe.y<=1&&(le=new o.a5(-ue.y/_e(ue,le)+ue.x,0)),new o.as().extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(ue))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=u.visibleDemTiles.reduce((w,I)=>{if(I.dem){const P=I.dem.tree;w.min=Math.min(w.min,P.minimums[0]),w.max=Math.max(w.max,P.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*u.exaggeration(),p.max*u.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,w=this.height/2-p*(1-this._horizonShift);return u?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-o.bT,this.maxLat=o.bT,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,p){return this.projection.createTileMatrix(this,p,u)}calculateDistanceTileData(u){const p=u.key,w=this._distanceTileDataCache;if(w[p])return w[p];const I=u.canonical,P=1/this.height,F=this.cameraWorldSize,W=F/this.zoomScale(I.z),$=(I.x+Math.pow(2,I.z)*u.wrap)*W,J=I.y*W,Q=this.point;Q.x*=F/this.worldSize,Q.y*=F/this.worldSize;const oe=this.angle,le=Math.sin(-oe),ue=-Math.cos(-oe);return w[p]={bearing:[le,ue],center:[(Q.x-$)*P,(Q.y-J)*P],scale:W/o.ab*P},w[p]}calculateFogTileMatrix(u){const p=u.key,w=this._fogTileMatrixCache;if(w[p])return w[p];const I=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return o.a6.mat4.multiply(I,this.worldToFogMatrix,I),w[p]=new Float32Array(I),w[p]}calculateProjMatrix(u,p=!1,w=!1){const I=u.key;let P;if(P=w?this._expandedProjMatrixCache:p?this._alignedProjMatrixCache:this._projMatrixCache,P[I])return P[I];const F=this.calculatePosMatrix(u,this.worldSize);let W;return W=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:w?this.expandedFarZProjMatrix:p?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(F,W,F),P[I]=new Float32Array(F),P[I]}calculatePixelsToTileUnitsMatrix(u){const p=u.tileID.key,w=this._pixelsToTileUnitsCache;if(w[p])return w[p];const I=o.bW(u,this);return w[p]=I,w[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const u=1/this.worldSize,p=o.a6.mat4.fromScaling([],[u,u,u]);return o.a6.mat4.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const u=this._elevation;this._updateCameraState();const p=o.bD(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(p),I=this._camera.forward(),P=o.bD(1,this._center.lat);w[2]/=P,I[2]/=P,o.a6.vec3.normalize(I,I);const F=u.raycast(w,I,u.exaggeration());if(F){const W=o.a6.vec3.scaleAndAdd([],w,I,F),$=new o.a5(W[0],W[1],o.bD(W[2],o.aM(W[1]))),J=($.z+o.a6.vec3.length([$.x-w[0],$.y-w[1],$.z-w[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(J),this._centerAltitude=$.toAltitude(),this._center=this.coordinateLocation($),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const p=this._elevation,w=o.bD(1,this._center.lat)*this.worldSize,I=this._computeCameraPosition(w),P=p.getAtPointOrZero(new o.a5(...I)),F=this.pixelsPerMeter/this.worldSize*P,W=this._minimumHeightOverTerrain(),$=I[2]-F;if($<=W)if($<0||u){const J=this.locationCoordinate(this._center,this._centerAltitude),Q=[I[0],I[1],J.z-I[2]],oe=o.a6.vec3.length(Q);Q[2]-=(W-$)/this._pixelsPerMercatorPixel;const le=o.a6.vec3.length(Q);if(le===0)return;o.a6.vec3.scale(Q,Q,oe/le*this._pixelsPerMercatorPixel),this._camera.position=[I[0],I[1],J.z*this._pixelsPerMercatorPixel-Q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const le=this.center;return le.lat=o.ap(le.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(le.lng=o.ap(le.lng,this.minLng,this.maxLng)),this.center=le,void(this._constraining=!1)}const p=this._unmodified,{x:w,y:I}=this.point;let P=0,F=w,W=I;const $=this.width/2,J=this.height/2,Q=this.worldMinY*this.scale,oe=this.worldMaxY*this.scale;if(I-J<Q&&(W=Q+J),I+J>oe&&(W=oe-J),oe-Q<this.height&&(P=Math.max(P,this.height/(oe-Q)),W=(oe+Q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const le=this.worldMinX*this.scale,ue=this.worldMaxX*this.scale,ve=this.worldSize/2-(le+ue)/2;F=(w+ve+this.worldSize)%this.worldSize-ve,F-$<le&&(F=le+$),F+$>ue&&(F=ue-$),ue-le<this.width&&(P=Math.max(P,this.width/(ue-le)),F=(ue+le)/2)}F===w&&W===I||(this.center=this.unproject(new o.P(F,W))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,p=this.projection.name==="globe",w=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bD(1,this.center.lat)/o.bD(1,o.c4));const I=o.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,I),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const P=this.projection.zAxisUnit==="meters"?w:1,F=this._camera.getWorldToCamera(this.worldSize,P);let W;const $=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if($[8]=2*-u.x/this.width,$[9]=2*u.y/this.height,this.isOrthographic){let tt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ut=tt*this.aspect,st=-ut,rt=-tt;ut-=u.x,st-=u.x,tt+=u.y,rt+=u.y,W=this._camera.getCameraToClipOrthographic(st,ut,rt,tt,this._nearZ,this._farZ),((xt,Ft,Zt,kt)=>{for(let hn=0;hn<16;hn++)xt[hn]=Xh(Ft[hn],Zt[hn],kt)})(W,W,$,$h(this.pitch>=15?1:this.pitch/15))}else W=$;const J=o.a6.mat4.mul([],$,F);let Q=o.a6.mat4.mul([],W,F);if(this.projection.isReprojectedInTileSpace){const tt=this.locationCoordinate(this.center),ut=o.a6.mat4.identity([]);o.a6.mat4.translate(ut,ut,[tt.x*this.worldSize,tt.y*this.worldSize,0]),o.a6.mat4.multiply(ut,ut,o.bY(this)),o.a6.mat4.translate(ut,ut,[-tt.x*this.worldSize,-tt.y*this.worldSize,0]),o.a6.mat4.multiply(Q,Q,ut),o.a6.mat4.multiply(J,J,ut),this.inverseAdjustmentMatrix=o.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],Q,[this.worldSize,this.worldSize,this.worldSize/P,1]),this.projMatrix=Q,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),p){const tt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);tt[8]=2*-u.x/this.width,tt[9]=2*u.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],tt,F)}else this.expandedFarZProjMatrix=this.projMatrix;const oe=o.a6.mat4.invert([],W);this.frustumCorners=o.b_.fromInvProjectionMatrix(oe,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!p);const le=new Float32Array(16);o.a6.mat4.identity(le),o.a6.mat4.scale(le,le,[1,-1,1]),o.a6.mat4.rotateX(le,le,this._pitch),o.a6.mat4.rotateZ(le,le,this.angle);const ue=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(ue);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ue[8]=2*-u.x/this.width,ue[9]=2*(u.y+ve)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(le,ue,le);const _e=this.point,be=_e.x,we=_e.y,ke=this.width%2/2,Ne=this.height%2/2,De=Math.cos(this.angle),We=Math.sin(this.angle),He=be-Math.round(be)+De*ke+We*Ne,et=we-Math.round(we)+De*Ne+We*ke,Ke=new Float64Array(Q);if(o.a6.mat4.translate(Ke,Ke,[He>.5?He-1:He,et>.5?et-1:et,0]),this.alignedProjMatrix=Ke,Q=o.a6.mat4.create(),o.a6.mat4.scale(Q,Q,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(Q,Q,[1,-1,0]),this.labelPlaneMatrix=Q,Q=o.a6.mat4.create(),o.a6.mat4.scale(Q,Q,[1,-1,1]),o.a6.mat4.translate(Q,Q,[-1,-1,0]),o.a6.mat4.scale(Q,Q,[2/this.width,2/this.height,1]),this.glCoordMatrix=Q,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,J),this._calcFogMatrices(),this._distanceTileDataCache={},Q=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!Q)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Q,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.b$(this);const tt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(tt,tt,F),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Q;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,w=this._camera.position,I=1/this.height/this._pixelsPerMercatorPixel,P=[u,u,p];o.a6.vec3.scale(P,P,I),o.a6.vec3.scale(w,w,-1),o.a6.vec3.multiply(w,w,P);const F=o.a6.mat4.create();o.a6.mat4.translate(F,F,w),o.a6.mat4.scale(F,F,P),this.mercatorFogMatrix=F,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,p,I)}_computeCameraPosition(u){const p=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,w=this._camera.forward(),I=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-u/this.worldSize*this._centerAltitude;return[I.x/this.worldSize-w[0]*P,I.y/this.worldSize-w[1]*P,u/this.worldSize*this._centerAltitude-w[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=this._camera.position[2],I=u[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),I>0&&(P=Math.min((p-w)/I,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,u,P),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,p=this._camera.forward(),{pitch:w,bearing:I}=this._camera.getPitchBearing(),P=o.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,F=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bB(this._maxPitch)),W=Math.max((u[2]-P)/Math.cos(w),F),$=this._zoomFromMercatorZ(W);o.a6.vec3.scaleAndAdd(u,u,p,W),this._pitch=o.ap(w,o.bB(this.minPitch),o.bB(this.maxPitch)),this.angle=o.bA(I,-Math.PI,Math.PI),this._setZoom(o.ap($,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let p=0,w=o.bU,I=0,P=1/0;for(;w-p>1e-6&&w>p;){const F=p+.5*(w-p),W=this.tileSize*Math.pow(2,F),$=this.getCameraToCenterDistance(this.projection,F,W),J=this.scaleZoom($/(u*this.tileSize)),Q=Math.abs(F-J);Q<P&&(P=Q,I=F),F<J?p=F:w=F}return I}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,p){const w=Math.min(u.x,p.x),I=Math.max(u.x,p.x),P=Math.min(u.y,p.y),F=Math.max(u.y,p.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const W=[new o.P(w,P),new o.P(I,F),new o.P(w,F),new o.P(I,P)],$=this.renderWorldCopies?-3:0,J=this.renderWorldCopies?4:1;for(const Q of W){const oe=this.pointRayIntersection(Q);if(oe.t<0)return!0;const le=this.rayIntersectionCoordinate(oe);if(le.x<$||le.y<0||le.x>J||le.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(u,p){const w=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,u)),I=this._zoomFromMercatorZ(w)+p;return w-this._mercatorZfromZoom(I)}getCameraPoint(){if(this.projection.name==="globe"){const u=function([p,w,I],P){const F=[p,w,I,1];o.a6.vec4.transformMat4(F,F,P);const W=F[3]=Math.max(F[3],1e-6);return F[0]/=W,F[1]/=W,F[2]/=W,F}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,u))}}getCameraToCenterDistance(u,p=this.zoom,w=this.worldSize){const I=o.bX(u,p,this.width,this.height,1024),P=u.pixelSpaceConversion(this.center.lat,w,I);let F=.5/Math.tan(.5*this._fov)*this.height*P;return this.isOrthographic&&(F=Xh(1,F,$h(this.pitch>=15?1:this.pitch/15))),F}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(u,u,this.globeMatrix),u}getFrustum(u){return o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,this.projection.zAxisUnit==="meters")}}const nc=(b,u)=>{if(u>0&&b.terrain&&o.w("Cutoff is currently disabled on terrain"),u<=0||b.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const p=b.transform,w=Math.max(Math.abs(p._zoom-(b.minCutoffZoom-1)),1),I=p.isLODDisabled(!1)?o.a7(60,45,p.pitch):o.a7(30,15,p.pitch),P=p._farZ-p._nearZ,F=u*p.height,W=((1-($=I))*p.cameraToCenterDistance+$*(p._farZ+F))*w;var $;return{shouldRenderCutoff:I<1,uniformValues:{u_cutoff_params:[p._nearZ,p._farZ,(W-p._nearZ)/P,(W-F-p._nearZ)/P]}}},ys={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class qh{constructor(u,p){this.aabb=u,this.lastCascade=p}}class yn{add(u,p){const w=this.receivers[u.key];w!==void 0?(w.aabb.min[0]=Math.min(w.aabb.min[0],p.min[0]),w.aabb.min[1]=Math.min(w.aabb.min[1],p.min[1]),w.aabb.min[2]=Math.min(w.aabb.min[2],p.min[2]),w.aabb.max[0]=Math.max(w.aabb.max[0],p.max[0]),w.aabb.max[1]=Math.max(w.aabb.max[1],p.max[1]),w.aabb.max[2]=Math.max(w.aabb.max[2],p.max[2])):this.receivers[u.key]=new qh(p,null)}clear(){this.receivers={}}get(u){return this.receivers[u.key]}computeRequiredCascades(u,p,w){const I=o.c9.fromPoints(u.points);let P=0;for(const F in this.receivers){const W=this.receivers[F];if(!W||!I.intersectsAabb(W.aabb))continue;W.aabb.min=I.closestPoint(W.aabb.min),W.aabb.max=I.closestPoint(W.aabb.max);const $=W.aabb.getCorners();for(let J=0;J<w.length;J++){let Q=!0;for(const oe of $){const le=[oe[0]*p,oe[1]*p,oe[2]];if(o.a6.vec3.transformMat4(le,le,w[J].matrix),le[0]<-1||le[0]>1||le[1]<-1||le[1]>1){Q=!1;break}}if(W.lastCascade=J,P=Math.max(P,J),Q)break}}return P+1}}class ug{constructor(u){this.painter=u,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new yn,this._depthMode=new $n(u.context.gl.LEQUAL,$n.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,u.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),u.tp.registerParameter(ys,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),u.tp.registerParameter(ys,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),u.tp.registerParameter(ys,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),u.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const u of this._cascades)u.texture.destroy(),u.framebuffer.destroy();this._cascades=[]}updateShadowParameters(u,p){const w=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!p||!p.properties)return;const I=p.properties.get("shadow-intensity");if(!p.shadowsEnabled()||I<=0||(this._shadowLayerCount=w.style.order.reduce((ve,_e)=>{const be=w.style._mergedLayers[_e];return ve+(be.hasShadowPass()&&!be.isHidden(u.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const P=w.context,F=ys.shadowMapResolution,W=ys.shadowMapResolution;if(this._cascades.length===0||ys.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<ys.cascadeCount;++ve){const _e=w._shadowMapDebug,be=P.gl,we=P.createFramebuffer(F,W,_e,"texture"),ke=new o.T(P,{width:F,height:W,data:null},be.DEPTH_COMPONENT16);if(we.depthAttachment.set(ke.texture),_e){const Ne=new o.T(P,{width:F,height:W,data:null},be.RGBA8);we.colorAttachment.set(Ne.texture)}this._cascades.push({framebuffer:we,texture:ke,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bN,scale:0})}}this.shadowDirection=Zh(p);let $=0;if(u.elevation){const ve=u.elevation,_e=[1e4,-1e4];ve.visibleDemTiles.filter(be=>be.dem).forEach(be=>{const we=be.dem.tree;_e[0]=Math.min(_e[0],we.minimums[0]),_e[1]=Math.max(_e[1],we.maximums[0])}),_e[0]!==1e4&&($=(_e[1]-_e[0])*ve.exaggeration())}const J=1.5*u.cameraToCenterDistance,Q=3*J,oe=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const _e=this._cascades[ve];let be=u.height/50,we=1;ys.cascadeCount===1?we=Q:ve===0?we=J:(be=J,we=Q);const[ke,Ne]=Dp(u,this.shadowDirection,be,we,ys.shadowMapResolution,$);_e.scale=u.scale,_e.matrix=ke,_e.boundingSphereRadius=Ne,o.a6.mat4.invert(oe,_e.matrix),_e.frustum=o.bN.fromInvProjectionMatrix(oe,1,0,!0),_e.far=we}const le=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[le].far,this._cascades[le].far],this._uniformValues.u_shadow_intensity=I,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ys.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ys.shadowMapResolution,this._uniformValues.u_shadowmap_0=ao.ShadowMap0,this._uniformValues.u_shadowmap_1=ao.ShadowMap0+1,this._groundShadowTiles=w.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ue=w.transform.elevation;for(const ve of this._groundShadowTiles){let _e={min:0,max:0};if(ue){const be=ue.getMinMaxForTile(ve);be&&(_e=be)}this.addShadowReceiver(ve.toUnwrapped(),_e.min,_e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(u){this._enabled=u}drawShadowPass(u,p){if(!this.enabled)return;const w=this.painter,I=w.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(w.transform.getFrustum(0),w.transform.worldSize,this._cascades),I.viewport.set([0,0,ys.shadowMapResolution,ys.shadowMapResolution]);for(let P=0;P<this._numCascadesToRender;++P){w.currentShadowCascade=P,I.bindFramebuffer.set(this._cascades[P].framebuffer.framebuffer),I.clear({color:o.bz.white,depth:1});for(const F of u.order){const W=u._mergedLayers[F];if(!W.hasShadowPass()||W.isHidden(w.transform.zoom))continue;const $=u.getLayerSourceCache(W),J=$?p[$.id]:void 0;(W.type==="model"||J&&J.length)&&w.renderLayer(w,$,W,J)}}w.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const u=this.painter,p=u.style,w=u.context,I=p.directionalLight,P=p.ambientLight;if(!I||!P)return;const F=[],W=nc(u,u.longestCutoffRange);W.shouldRenderCutoff&&F.push("RENDER_CUTOFF");const $=Lp(p,I,P),J=new $n(w.gl.LEQUAL,$n.ReadOnly,u.depthRangeFor3D);for(const Q of this._groundShadowTiles){const oe=Q.toUnwrapped(),le=u.isTileAffectedByFog(Q),ue=u.getOrCreateProgram("groundShadow",{defines:F,overrideFog:le});this.setupShadows(oe,ue),u.uploadCommonUniforms(w,ue,oe,null,W);const ve={u_matrix:u.transform.calculateProjMatrix(oe),u_ground_shadow_factor:$};ue.draw(u,w.gl.TRIANGLES,J,pr.disabled,Mr.multiply,_r.disabled,ve,"ground_shadow",u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments,{},u.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Mr.unblended:Mr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(u){const p=this.painter.transform,w=p.calculatePosMatrix(u,p.worldSize);return o.a6.mat4.multiply(w,this._cascades[this.painter.currentShadowCascade].matrix,w),Float32Array.from(w)}calculateShadowPassMatrixFromMatrix(u){return o.a6.mat4.multiply(u,this._cascades[this.painter.currentShadowCascade].matrix,u),Float32Array.from(u)}setupShadows(u,p,w,I=0){if(!this.enabled)return;const P=this.painter.transform,F=this.painter.context,W=F.gl,$=this._uniformValues,J=new Float64Array(16),Q=P.calculatePosMatrix(u,P.worldSize);for(let oe=0;oe<this._cascades.length;oe++)o.a6.mat4.multiply(J,this._cascades[oe].matrix,Q),$[oe===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(J),F.activeTexture.set(W.TEXTURE0+ao.ShadowMap0+oe),this._cascades[oe].texture.bind(W.NEAREST,W.CLAMP_TO_EDGE);if(this.useNormalOffset=!!w,this.useNormalOffset){const oe=o.c8(u.canonical),le=2/P.tileSize*o.ab/ys.shadowMapResolution,ue=le*this._cascades[0].boundingSphereRadius,ve=le*this._cascades[this._cascades.length-1].boundingSphereRadius,_e=(w==="vector-tile"?1:3)/Math.pow(2,I-u.canonical.z-(1-P.zoom+Math.floor(P.zoom)));$.u_shadow_normal_offset=[oe,ue*_e,ve*_e],$.u_shadow_bias=[6e-5,.0012,.012]}else $.u_shadow_bias=[36e-5,.0012,.012];p.setShadowUniformValues(F,$)}setupShadowsFromMatrix(u,p,w=!1){if(!this.enabled)return;const I=this.painter.context,P=I.gl,F=this._uniformValues,W=new Float64Array(16);for(let $=0;$<ys.cascadeCount;$++)o.a6.mat4.multiply(W,this._cascades[$].matrix,u),F[$===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(W),I.activeTexture.set(P.TEXTURE0+ao.ShadowMap0+$),this._cascades[$].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=w,w){const $=ys.normalOffset;F.u_shadow_normal_offset=[1,$,$],F.u_shadow_bias=[6e-5,.0012,.012]}else F.u_shadow_bias=[36e-5,.0012,.012];p.setShadowUniformValues(I,F)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(u,p,w,I){if(I[2]>=0)return{};const P=function($,J,Q){const oe=Q/(1<<$.canonical.z);return new o.c9([$.canonical.x*oe+$.wrap*Q,$.canonical.y*oe+$.wrap*Q,0],[($.canonical.x+1)*oe+$.wrap*Q,($.canonical.y+1)*oe+$.wrap*Q,J])}(u,p,w).getCorners(),F=p/-I[2];I[0]<0?(o.a6.vec3.add(P[0],P[0],[I[0]*F,0,0]),o.a6.vec3.add(P[3],P[3],[I[0]*F,0,0])):I[0]>0&&(o.a6.vec3.add(P[1],P[1],[I[0]*F,0,0]),o.a6.vec3.add(P[2],P[2],[I[0]*F,0,0])),I[1]<0?(o.a6.vec3.add(P[0],P[0],[0,I[1]*F,0]),o.a6.vec3.add(P[1],P[1],[0,I[1]*F,0])):I[1]>0&&(o.a6.vec3.add(P[2],P[2],[0,I[1]*F,0]),o.a6.vec3.add(P[3],P[3],[0,I[1]*F,0]));const W={};return W.vertices=P,W.planes=[Fc(P[1],P[0],P[4]),Fc(P[2],P[1],P[5]),Fc(P[3],P[2],P[6]),Fc(P[0],P[3],P[7])],W}addShadowReceiver(u,p,w){this._receivers.add(u,o.c9.fromTileIdAndHeight(u,p,w))}getMaxCascadeForTile(u){const p=this._receivers.get(u);return p&&p.lastCascade?p.lastCascade:0}}function Fc(b,u,p){const w=o.a6.vec3.sub([],p,u),I=o.a6.vec3.sub([],b,u),P=o.a6.vec3.cross([],w,I),F=o.a6.vec3.length(P);return F===0?[0,0,1,0]:(o.a6.vec3.scale(P,P,1/F),[P[0],P[1],P[2],-o.a6.vec3.dot(P,u)])}function Zh(b){const u=b.properties.get("direction"),p=o.c7(u.x,u.y,u.z);p[2]=o.ap(p[2],0,75);const w=o.ca([p[0],p[1],p[2]]);return o.a6.vec3.fromValues(w.x,w.y,w.z)}function Lp(b,u,p){const w=u.properties.get("color"),I=u.properties.get("intensity"),P=u.properties.get("direction"),F=[P.x,P.y,P.z],W=p.properties.get("color"),$=p.properties.get("intensity"),J=Math.max(o.a6.vec3.dot([0,0,1],F),0),Q=[0,0,0];o.a6.vec3.scale(Q,W.toRenderColor(b.getLut(u.scope)).toArray01Linear().slice(0,3),$);const oe=[0,0,0];return o.a6.vec3.scale(oe,w.toRenderColor(b.getLut(p.scope)).toArray01Linear().slice(0,3),J*I),o.cb([Q[0]>0?Q[0]/(Q[0]+oe[0]):0,Q[1]>0?Q[1]/(Q[1]+oe[1]):0,Q[2]>0?Q[2]/(Q[2]+oe[2]):0])}function Dp(b,u,p,w,I,P){const F=b.zoom,W=b.scale,$=b.worldSize,J=1/$,Q=b.aspect,oe=Math.sqrt(1+Q*Q)*Math.tan(.5*b.fovX),le=oe*oe,ue=w-p,ve=w+p;let _e,be;le>ue/ve?(_e=w,be=w*oe):(_e=.5*ve*(1+le),be=.5*Math.sqrt(ue*ue+2*(w*w+p*p)*le+ve*ve*le*le));const we=b.projection.pixelsPerMeter(b.center.lat,$),ke=b._camera.getCameraToWorldMercator(),Ne=[0,0,-_e*J];o.a6.vec3.transformMat4(Ne,Ne,ke);let De=be*J;const We=b._edgeInsets;if(!(We.left===0&&We.top===0&&We.right===0&&We.bottom===0||We.left===We.right&&We.top===We.bottom)){const fn=b._camera.getWorldToCamera(b.worldSize,b.projection.zAxisUnit==="meters"?we:1),pn=b._camera.getCameraToClipPerspective(b._fov,b.width/b.height,p,w);pn[8]=2*-b.centerOffset.x/b.width,pn[9]=2*b.centerOffset.y/b.height;const qt=new Float64Array(16);o.a6.mat4.mul(qt,pn,fn);const en=new Float64Array(16);o.a6.mat4.invert(en,qt);const er=o.bN.fromInvProjectionMatrix(en,$,F,!0);for(const xn of er.points){const Dn=((He=xn)[0]/=W,He[1]/=W,He[2]=o.bD(He[2],b._center.lat),He);De=Math.max(De,o.a6.vec3.len(o.a6.vec3.subtract([],Ne,Dn)))}}var He;De*=I/(I-1);const et=Math.acos(u[2]),Ke=Math.atan2(-u[0],-u[1]),tt=new ns;tt.position=Ne,tt.setPitchBearing(et,Ke);const ut=tt.getWorldToCamera($,we),st=De*$,rt=Math.min(b._mercatorZfromZoom(17)*$*-2,-2*st),xt=tt.getCameraToClipOrthographic(-st,st,-st,st,rt,(st+P*we)/u[2]),Ft=new Float64Array(16);o.a6.mat4.multiply(Ft,xt,ut);const Zt=o.a6.vec3.fromValues(Math.floor(1e6*Ne[0])/1e6*$,Math.floor(1e6*Ne[1])/1e6*$,0),kt=.5*I,hn=[0,0,0];o.a6.vec3.transformMat4(hn,Zt,Ft),o.a6.vec3.scale(hn,hn,kt);const bt=[Math.floor(hn[0]),Math.floor(hn[1]),Math.floor(hn[2])],Wt=[0,0,0];o.a6.vec3.sub(Wt,hn,bt),o.a6.vec3.scale(Wt,Wt,-1/kt);const Gt=new Float64Array(16);return o.a6.mat4.identity(Gt),o.a6.mat4.translate(Gt,Gt,Wt),o.a6.mat4.multiply(Ft,Gt,Ft),[Ft,st]}class Ya extends o.E{constructor(u){super(),this.requestManager=u,this.models={"":{}},this.numModelsLoading={}}loadModel(u,p){return o.aG(this.requestManager.transformRequest(p,o.R.Model).url).then(w=>{if(!w)return;const I=o.aH(w),P=new o.aI(u,void 0,void 0,I);return P.computeBoundsAndApplyParent(),P}).catch(w=>{if(w&&w.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${u} from ${p}: ${w.message}`)))})}load(u,p){this.models[p]||(this.models[p]={});const w=Object.keys(u);this.numModelsLoading[p]=(this.numModelsLoading[p]||0)+w.length;const I=[];for(const P of w)I.push(this.loadModel(P,u[P]));Promise.allSettled(I).then(P=>{for(let F=0;F<P.length;F++){const{status:W,value:$}=P[F];W==="fulfilled"&&$&&(this.models[p][w[F]]={model:$,numReferences:1})}this.numModelsLoading[p]-=w.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(P=>{this.fire(new o.t(new Error(`Could not load models: ${P.message}`)))})}isLoaded(){for(const u in this.numModelsLoading)if(this.numModelsLoading[u]>0)return!1;return!0}hasModel(u,p){return!!this.getModel(u,p)}getModel(u,p){return this.models[p]||(this.models[p]={}),this.models[p][u]?this.models[p][u].model:void 0}addModel(u,p,w){this.models[w]||(this.models[w]={}),this.hasModel(u,w)&&this.models[w][u].numReferences++,this.load({[u]:this.requestManager.normalizeModelURL(p)},w)}addModels(u,p){this.models[p]||(this.models[p]={});const w={};for(const I in u)this.models[p][I]={},w[I]=this.requestManager.normalizeModelURL(u[I]);this.load(w,p)}addModelsFromBucket(u,p){this.models[p]||(this.models[p]={});const w={};for(const I of u)this.hasModel(I,p)?this.models[p][I].numReferences++:w[I]=this.requestManager.normalizeModelURL(I);this.load(w,p)}removeModel(u,p){if(this.models[p]&&this.models[p][u]&&(this.models[p][u].numReferences--,this.models[p][u].numReferences===0)){const w=this.models[p][u].model;delete this.models[p][u],w.destroy()}}listModels(u){return this.models[u]||(this.models[u]={}),Object.keys(this.models[u])}upload(u,p){this.models[p]||(this.models[p]={});for(const w in this.models[p])this.models[p][w].model&&this.models[p][w].model.upload(u.context)}}const hg=new o.a0({data:new o.a1(o._.colorTheme.data)}),aa=(b,u)=>pt(b,u&&u.filter(p=>p.identifier!=="source.canvas")),ka=o.ar(si,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Nc=o.ar(si,["setCenter","setZoom","setBearing","setPitch"]),Yh={version:8,layers:[],sources:{}},rc={duration:300,delay:0};class Oa extends o.E{constructor(u,p={}){super(),this.map=u,this.scope=p.scope||"",this.globalId=null,this.fragments=[],this.importDepth=p.importDepth||0,this.importsCache=p.importsCache||new Map,this.resolvedImports=p.resolvedImports||new Set,this.transition=o.l({},rc),this._buildingIndex=new Mp(this),this.crossTileSymbolIndex=new Wh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=p.styleChanges||new cn,this.dispatcher=p.dispatcher?p.dispatcher:new o.cd(o.ce(),this),p.imageManager?this.imageManager=p.imageManager:(this.imageManager=new Jt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=p.glyphManager?p.glyphManager:new o.cf(u._requestManager,p.localFontFamily?o.cg.all:p.localIdeographFontFamily?o.cg.ideographs:o.cg.none,p.localFontFamily||p.localIdeographFontFamily),p.modelManager?this.modelManager=p.modelManager:(this.modelManager=new Ya(u._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=p.configOptions?p.configOptions:new Map,this._configDependentLayers=p.configDependentLayers?p.configDependentLayers:new Set,this._config=p.config,this._initialConfig=p.initialConfig,this.dispatcher.broadcast("setReferrer",o.ch());const w=this;this._rtlTextPluginCallback=Oa.registerForPluginStateChange(I=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},(P,F)=>{if(o.ci(P),F&&F.every(W=>W))for(const W in w._sourceCaches){const $=w._sourceCaches[W],J=$.getSource().type;J!=="vector"&&J!=="geojson"||$.reload()}})}),this.on("data",I=>{if(I.dataType!=="source"||I.sourceDataType!=="metadata")return;const P=this.getOwnSource(I.sourceId);if(P&&P.vectorLayerIds)for(const F in this._layers){const W=this._layers[F];W.source===P.id&&this._validateLayer(W)}})}load(u){return u?(typeof u=="string"?this.loadURL(u):this.loadJSON(u),this):this}_getGlobalId(u){if(!u)return null;if(typeof u=="string"){if(o.f(u))return u;const p=o.cj(u);if(!p.startsWith("http"))try{return new URL(p,location.href).toString()}catch{return p}return p}return`json://${o.ck(JSON.stringify(u))}`}_diffStyle(u,p,w){this.globalId=this._getGlobalId(u);const I=(P,F)=>{try{F(null,this.setState(P,w))}catch(W){F(W,!1)}};if(typeof u=="string"){const P=this.map._requestManager.normalizeStyleURL(u),F=this.map._requestManager.transformRequest(P,o.R.Style);o.n(F,(W,$)=>{W?this.fire(new o.t(W)):$&&I($,p)})}else typeof u=="object"&&I(u,p)}loadURL(u,p={}){this.fire(new o.x("dataloading",{dataType:"style"}));const w=typeof p.validate=="boolean"?p.validate:!o.f(u);this.globalId=this._getGlobalId(u),u=this.map._requestManager.normalizeStyleURL(u,p.accessToken),this.resolvedImports.add(u);const I=this.importsCache.get(u);if(I)return this._load(I,w);const P=this.map._requestManager.transformRequest(u,o.R.Style);this._request=o.n(P,(F,W)=>{if(this._request=null,F)this.fire(new o.t(F));else if(W)return this.importsCache.set(u,W),this._load(W,w)})}loadJSON(u,p={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(u),this._request=o.q.frame(()=>{this._request=null,this._load(u,p.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(Yh,!1)}_loadImports(u,p,w){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const I=[];for(const P of u){const F=this._createFragmentStyle(P),W=new Promise(Q=>{F.once("style.import.load",Q),F.once("error",Q)}).then(()=>this.mergeAll());if(I.push(W),this.resolvedImports.has(P.url)){F.loadEmpty();continue}const $=P.data||this.importsCache.get(P.url);$?(F.loadJSON($,{validate:p}),this._isInternalStyle($)&&(F.globalId=null)):P.url?F.loadURL(P.url,{validate:p}):F.loadEmpty();const J={style:F,id:P.id,config:P.config};if(w){const Q=this.fragments.findIndex(({id:oe})=>oe===w);this.fragments=this.fragments.slice(0,Q).concat(J).concat(this.fragments.slice(Q))}else this.fragments.push(J)}return Promise.allSettled(I)}getImportGlobalIds(u=this,p=new Set){for(const w of u.fragments)w.style.globalId&&p.add(w.style.globalId),this.getImportGlobalIds(w.style,p);return[...p.values()]}_createFragmentStyle(u){const p=this.scope?o.av(u.id,this.scope):u.id;let w;const I=this._initialConfig&&this._initialConfig[p];(u.config||I)&&(w=o.l({},u.config,I));const P=new Oa(this.map,{scope:p,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:w,configOptions:this.options,configDependentLayers:this._configDependentLayers});return P.setEventedParent(this.map,{style:P}),P}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(u){return this.isRootStyle()&&(u.fragment||!!u.schema&&u.fragment!==!1)}_load(u,p){const w=u.schema;if(this._isInternalStyle(u)){const F=o.l({},Yh,{imports:[{id:"basemap",data:u,url:""}]});return void this._load(F,p)}if(this.updateConfig(this._config,w),p&&aa(this,En(u)))return;this._loaded=!0,this.stylesheet=o.cl(u);const I=()=>{for(const J in u.sources)this.addSource(J,u.sources[J],{validate:!1,isInitialLoad:!0});u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(u.glyphs,this.scope);const F=Gh(this.stylesheet.layers);if(this._order=F.map(J=>J.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const J=this.stylesheet.lights[0];this.light=new gt(J.properties,J.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new gt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const J of F){const Q=o.cq(J,this.scope,this._styleColorTheme.lut,this.options);Q.configDependencies.size!==0&&this._configDependentLayers.add(Q.fqid),Q.setEventedParent(this,{layer:{id:Q.id}}),this._layers[Q.id]=Q,this._serializedLayers[Q.id]=Q.serialize();const oe=this.getOwnLayerSourceCache(Q),le=!!this.directionalLight&&this.directionalLight.shadowsEnabled();oe&&Q.canCastShadows()&&le&&(oe.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const W=this.stylesheet.terrain;W&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(W,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const $=this.isRootStyle();u.imports?this._loadImports(u.imports,p).then(()=>{this._reloadImports(),this.fire(new o.x($?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x($?"style.load":"style.import.load")))},P=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=P,P){const F=this._evaluateColorThemeData(P);this._loadColorTheme(F).then(()=>{I()}).catch(W=>{o.w(`Couldn't load color theme from the stylesheet: ${W}`),I()})}else this._styleColorTheme.lut=null,I()}isRootStyle(){return this.importDepth===0}mergeAll(){let u,p,w,I,P,F,W,$;const J={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Q=>{if(Q.stylesheet){if(Q.light!=null&&(u=Q.light),Q.stylesheet.lights)for(const oe of Q.stylesheet.lights)oe.type==="ambient"&&Q.ambientLight!=null&&(p=Q.ambientLight),oe.type==="directional"&&Q.directionalLight!=null&&(w=Q.directionalLight);I=this._prioritizeTerrain(I,Q.terrain,Q.stylesheet.terrain),Q.stylesheet.fog&&Q.fog!=null&&(P=Q.fog),Q.stylesheet.camera!=null&&($=Q.stylesheet.camera),Q.stylesheet.projection!=null&&(F=Q.stylesheet.projection),Q.stylesheet.transition!=null&&(W=Q.stylesheet.transition),J[Q.scope]=Q._styleColorTheme}}),this.light=u,this.ambientLight=p,this.directionalLight=w,this.fog=P,this._styleColorThemeForScope=J,I===null?delete this.terrain:this.terrain=I,this.camera=$||{"camera-projection":"perspective"},this.projection=F||{name:"mercator"},this.transition=o.l({},rc,W),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(u){const p=w=>{for(const I of w.fragments)p(I.style);u(w)};p(this)}_prioritizeTerrain(u,p,w){const I=u&&u.drapeRenderMode===0;return w===null?p&&p.drapeRenderMode===0?p:I?u:null:p!=null&&(!u||I||p&&p.drapeRenderMode===1)?p:u}mergeTerrain(){let u;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(p=>{u=this._prioritizeTerrain(u,p.terrain,p.stylesheet.terrain)}),u===null?delete this.terrain:this.terrain=u}mergeProjection(){let u;this.forEachFragmentStyle(p=>{p.stylesheet.projection!=null&&(u=p.stylesheet.projection)}),this.projection=u||{name:"mercator"}}mergeSources(){const u={},p={},w={};this.forEachFragmentStyle(I=>{for(const P in I._sourceCaches){const F=o.av(P,I.scope);u[F]=I._sourceCaches[P]}for(const P in I._otherSourceCaches){const F=o.av(P,I.scope);p[F]=I._otherSourceCaches[P]}for(const P in I._symbolSourceCaches){const F=o.av(P,I.scope);w[F]=I._symbolSourceCaches[P]}}),this._mergedSourceCaches=u,this._mergedOtherSourceCaches=p,this._mergedSymbolSourceCaches=w}mergeLayers(){const u={},p=[],w={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(P=>{for(const F of P._order){const W=P._layers[F];if(W.type==="slot"){const $=o.cm(F);if(u[$])continue;u[$]=[]}W.slot&&u[W.slot]?u[W.slot].push(W):p.push(W)}}),this._mergedOrder=[];const I=(P=[])=>{for(const F of P)if(F.type==="slot"){const W=o.cm(F.id);u[W]&&I(u[W]),this._mergedSlots.push(W)}else{const W=o.av(F.id,F.scope);this._mergedOrder.push(W),w[W]=F,F.is3D()&&(this._has3DLayers=!0),F.type==="circle"&&(this._hasCircleLayers=!0),F.type==="symbol"&&(this._hasSymbolLayers=!0),F.type==="clip"&&(this._clipLayerPresent=!0)}};I(p),this._mergedOrder.sort((P,F)=>{const W=w[P],$=w[F];return W.hasInitialOcclusionOpacityProperties?$.is3D()?1:0:W.is3D()&&$.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=w,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(u){return this.stylesheet.camera=o.l({},this.stylesheet.camera,u),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(u){return u.data?function(p,w,I){const P=o.l({},w);for(const W of Object.keys(o._.colorTheme))P[W]===void 0&&(P[W]=o._.colorTheme[W].default);const F=new o.$(hg,p,new Map(I));return F.setTransitionOrValue(P,I),F.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,u,this.options).get("data"):null}_loadColorTheme(u){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const p=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((w,I)=>{const P="data:image/png;base64,";if(!u||u.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void w();let F=u;F.startsWith(P)||(F=P+F);const W="mapbox-reserved-lut",$=new Image;$.src=F,$.onerror=()=>{this._styleColorTheme.lutLoading=!1,I(new Error("Failed to load image data"))},$.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==p)return void w();this._styleColorTheme.lutLoading=!1;const{width:J,height:Q,data:oe}=o.q.getImageData($);if(Q>32)return void I(new Error("The height of the image must be less than or equal to 32 pixels."));if(J!==Q*Q)return void I(new Error("The width of the image must be equal to the height squared."));this.getImage(W)&&this.removeImage(W),this.addImage(W,{data:new o.r({width:J,height:Q},oe),pixelRatio:1,sdf:!1,version:0});const le=this.imageManager.getImage(W,this.scope);le?(this._styleColorTheme.lut={image:le.data,data:u},w()):I(new Error("Missing LUT image."))}})}getLut(u){const p=this._styleColorThemeForScope[u];return p?p.lut:null}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(u){this._spriteRequest=function(p,w,I){let P,F,W;const $=o.q.devicePixelRatio>1?"@2x":"";let J=o.n(w.transformRequest(w.normalizeSpriteURL(p,$,".json"),o.R.SpriteJSON),(le,ue)=>{J=null,W||(W=le,P=ue,oe())}),Q=o.o(w.transformRequest(w.normalizeSpriteURL(p,$,".png"),o.R.SpriteImage),(le,ue)=>{Q=null,W||(W=le,F=ue,oe())});function oe(){if(W)I(W);else if(P&&F){const le=o.q.getImageData(F),ue={};for(const ve in P){const{width:_e,height:be,x:we,y:ke,sdf:Ne,pixelRatio:De,stretchX:We,stretchY:He,content:et}=P[ve],Ke=new o.r({width:_e,height:be});o.r.copy(le,Ke,{x:we,y:ke},{x:0,y:0},{width:_e,height:be},null),ue[ve]={data:Ke,pixelRatio:De,sdf:Ne,stretchX:We,stretchY:He,content:et}}I(null,ue)}}return{cancel(){J&&(J.cancel(),J=null),Q&&(Q.cancel(),Q=null)}}}(u,this.map._requestManager,(p,w)=>{if(this._spriteRequest=null,p)this.fire(new o.t(p));else if(w)for(const I in w)this.imageManager.addImage(I,this.scope,w[I]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(u){const p=this.getOwnSource(u.source);if(!p)return;const w=u.sourceLayer;w&&(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.t(new Error(`Source layer "${w}" does not exist on source "${p.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:u}of this.fragments)if(!u.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((u,p)=>{const w=this.fragments[p];return w&&w.style&&(u.data=w.style.serialize()),u})}_serializeSources(){const u={};for(const p in this._sourceCaches){const w=this._sourceCaches[p].getSource();u[w.id]||(u[w.id]=w.serialize())}return u}_serializeLayers(u){const p=[];for(const w of u){const I=this._layers[w];I&&I.type!=="custom"&&p.push(I.serialize())}return p}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(u){return!!this.terrain&&u.isDraped(this.getLayerSourceCache(u))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(u){const p=this.getOwnLayer(u);if(p)return p;this.fire(new o.t(new Error(`The layer '${u}' does not exist in the map's style.`)))}_checkSource(u){const p=this.getOwnSource(u);if(p)return p;this.fire(new o.t(new Error(`The source '${u}' does not exist in the map's style.`)))}precompilePrograms(u,p){const w=this.map.painter;if(w)for(let I=u.minzoom||0;I<(u.maxzoom||25.5);I++){const P=u.getProgramIds();if(P)for(const F of P){const W=u.getDefaultProgramParams(F,p.zoom,this._styleColorTheme.lut);W&&(w.style=this,this.fog&&(w._fogVisible=!0,W.overrideFog=!0,w.getOrCreateProgram(F,W)),w._fogVisible=!1,W.overrideFog=!1,w.getOrCreateProgram(F,W),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(W.overrideRtt=!0,w.getOrCreateProgram(F,W)))}}}update(u){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(u),this.directionalLight&&this.directionalLight.recalculate(u);const p=this.calculateLightsBrightness();u.brightness=p||0,p!==this._brightness&&(this._brightness=p,this.dispatcher.broadcast("setBrightness",p));const w=this._changes.isDirty();let I=!1;if(this._changes.isDirty()){const F=this._changes.getLayerUpdatesByScope();for(const W in F){const{updatedIds:$,removedIds:J}=F[W];($||J)&&(this._updateWorkerLayers(W,$,J),I=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(u),this.light&&this.light.updateTransitions(u),this.ambientLight&&this.ambientLight.updateTransitions(u),this.directionalLight&&this.directionalLight.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._changes.reset()}const P={};for(const F in this._mergedSourceCaches){const W=this._mergedSourceCaches[F];P[F]=W.used,W.used=!1,W.tileCoverLift=0}for(const F of this._mergedOrder){const W=this._mergedLayers[F];if(W.recalculate(u,this._availableImages),!W.isHidden(u.zoom)){const $=this.getLayerSourceCache(W);$&&($.used=!0,$.tileCoverLift=Math.max($.tileCoverLift,W.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(W,u)}):this.precompilePrograms(W,u))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&I&&this.mergeLayers();for(const F in P){const W=this._mergedSourceCaches[F];P[F]!==W.used&&W.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:W.getSource().id}))}this.light&&this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),w&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=this._changes.getUpdatedImages();if(u.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],u);this._changes.resetUpdatedImages()}}_updateWorkerLayers(u,p,w){const I=this.getFragmentStyle(u);I&&this.dispatcher.broadcast("updateLayers",{layers:p?I._serializeLayers(p):[],scope:u,removedIds:w||[],options:I.options})}setState(u,p){if(this._checkLoaded(),aa(this,En(u)))return!1;(u=o.cl(u)).layers=Gh(u.layers);const w=function(F,W){if(!F)return[{command:si.setStyle,args:[W]}];let $=[];try{if(!o.bh(F.version,W.version))return[{command:si.setStyle,args:[W]}];if(o.bh(F.center,W.center)||$.push({command:si.setCenter,args:[W.center]}),o.bh(F.zoom,W.zoom)||$.push({command:si.setZoom,args:[W.zoom]}),o.bh(F.bearing,W.bearing)||$.push({command:si.setBearing,args:[W.bearing]}),o.bh(F.pitch,W.pitch)||$.push({command:si.setPitch,args:[W.pitch]}),o.bh(F.sprite,W.sprite)||$.push({command:si.setSprite,args:[W.sprite]}),o.bh(F.glyphs,W.glyphs)||$.push({command:si.setGlyphs,args:[W.glyphs]}),o.bh(F.imports,W.imports)||function(ue=[],ve=[],_e){ve=ve||[];const be=(ue=ue||[]).map(Vh),we=ve.map(Vh),ke=ue.reduce(hd,{}),Ne=ve.reduce(hd,{}),De=be.slice();let We,He,et,Ke;for(We=0,He=0;We<be.length;We++)et=be[We],Ne.hasOwnProperty(et)?He++:(_e.push({command:si.removeImport,args:[et]}),De.splice(De.indexOf(et,He),1));for(We=0,He=0;We<we.length;We++)et=we[we.length-1-We],De[De.length-1-We]!==et&&(ke.hasOwnProperty(et)?(_e.push({command:si.removeImport,args:[et]}),De.splice(De.lastIndexOf(et,De.length-He),1)):He++,Ke=De[De.length-We],_e.push({command:si.addImport,args:[Ne[et],Ke]}),De.splice(De.length-We,0,et));for(const tt of ve){const ut=ke[tt.id];ut&&!o.bh(ut,tt)&&_e.push({command:si.updateImport,args:[tt.id,tt]})}}(F.imports,W.imports,$),o.bh(F.transition,W.transition)||$.push({command:si.setTransition,args:[W.transition]}),o.bh(F.light,W.light)||$.push({command:si.setLight,args:[W.light]}),o.bh(F.fog,W.fog)||$.push({command:si.setFog,args:[W.fog]}),o.bh(F.projection,W.projection)||$.push({command:si.setProjection,args:[W.projection]}),o.bh(F.lights,W.lights)||$.push({command:si.setLights,args:[W.lights]}),o.bh(F.camera,W.camera)||$.push({command:si.setCamera,args:[W.camera]}),!o.bh(F["color-theme"],W["color-theme"]))return[{command:si.setStyle,args:[W]}];const J={},Q=[];(function(ue,ve,_e,be){let we;for(we in ve=ve||{},ue=ue||{})ue.hasOwnProperty(we)&&(ve.hasOwnProperty(we)||vr(we,_e,be));for(we in ve){if(!ve.hasOwnProperty(we))continue;const ke=ve[we];ue.hasOwnProperty(we)?o.bh(ue[we],ke)||(ue[we].type==="geojson"&&ke.type==="geojson"&&cr(ue,ve,we)?_e.push({command:si.setGeoJSONSourceData,args:[we,ke.data]}):T1(we,ve,_e,be)):Cp(we,ve,_e)}})(F.sources,W.sources,Q,J);const oe=[];F.layers&&F.layers.forEach(ue=>{ue.source&&J[ue.source]?$.push({command:si.removeLayer,args:[ue.id]}):oe.push(ue)});let le=F.terrain;le&&J[le.source]&&($.push({command:si.setTerrain,args:[void 0]}),le=void 0),$=$.concat(Q),o.bh(le,W.terrain)||$.push({command:si.setTerrain,args:[W.terrain]}),function(ue,ve,_e){ve=ve||[];const be=(ue=ue||[]).map(Vh),we=ve.map(Vh),ke=ue.reduce(hd,{}),Ne=ve.reduce(hd,{}),De=be.slice(),We=Object.create(null);let He,et,Ke,tt,ut,st,rt;for(He=0,et=0;He<be.length;He++)Ke=be[He],Ne.hasOwnProperty(Ke)?et++:(_e.push({command:si.removeLayer,args:[Ke]}),De.splice(De.indexOf(Ke,et),1));for(He=0,et=0;He<we.length;He++)Ke=we[we.length-1-He],De[De.length-1-He]!==Ke&&(ke.hasOwnProperty(Ke)?(_e.push({command:si.removeLayer,args:[Ke]}),De.splice(De.lastIndexOf(Ke,De.length-et),1)):et++,st=De[De.length-He],_e.push({command:si.addLayer,args:[Ne[Ke],st]}),De.splice(De.length-He,0,Ke),We[Ke]=!0);for(He=0;He<we.length;He++)if(Ke=we[He],tt=ke[Ke],ut=Ne[Ke],!We[Ke]&&!o.bh(tt,ut))if(o.bh(tt.source,ut.source)&&o.bh(tt["source-layer"],ut["source-layer"])&&o.bh(tt.type,ut.type)){for(rt in ud(tt.layout,ut.layout,_e,Ke,null,si.setLayoutProperty),ud(tt.paint,ut.paint,_e,Ke,null,si.setPaintProperty),o.bh(tt.slot,ut.slot)||_e.push({command:si.setSlot,args:[Ke,ut.slot]}),o.bh(tt.filter,ut.filter)||_e.push({command:si.setFilter,args:[Ke,ut.filter]}),o.bh(tt.minzoom,ut.minzoom)&&o.bh(tt.maxzoom,ut.maxzoom)||_e.push({command:si.setLayerZoomRange,args:[Ke,ut.minzoom,ut.maxzoom]}),tt)tt.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?ud(tt[rt],ut[rt],_e,Ke,rt.slice(6),si.setPaintProperty):o.bh(tt[rt],ut[rt])||_e.push({command:si.setLayerProperty,args:[Ke,rt,ut[rt]]}));for(rt in ut)ut.hasOwnProperty(rt)&&!tt.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?ud(tt[rt],ut[rt],_e,Ke,rt.slice(6),si.setPaintProperty):o.bh(tt[rt],ut[rt])||_e.push({command:si.setLayerProperty,args:[Ke,rt,ut[rt]]}))}else _e.push({command:si.removeLayer,args:[Ke]}),st=De[De.lastIndexOf(Ke)+1],_e.push({command:si.addLayer,args:[ut,st]})}(oe,W.layers,$)}catch(J){console.warn("Unable to compute style diff:",J),$=[{command:si.setStyle,args:[W]}]}return $}(this.serialize(),u).filter(F=>!(F.command in Nc));if(w.length===0)return!1;const I=w.filter(F=>!(F.command in ka));if(I.length>0)throw new Error(`Unimplemented: ${I.map(F=>F.command).join(", ")}.`);const P=[];return w.forEach(F=>{P.push(this[F.command].apply(this,F.args))}),p&&Promise.all(P).then(p),this.stylesheet=u,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(u,p){return this.getImage(u)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,this.scope,p),this._afterImageUpdated(u),this)}updateImage(u,p){this.imageManager.updateImage(u,this.scope,p)}getImage(u){return this.imageManager.getImage(u,this.scope)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u,this.scope),this._afterImageUpdated(u),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(u),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(u,p,w={}){return this._checkLoaded(),this._validate(nt,`models.${u}`,p,null,w)||(this.modelManager.addModel(u,p,this.scope),this._changes.setDirty()),this}hasModel(u){return this.modelManager.hasModel(u,this.scope)}removeModel(u){return this.hasModel(u)?(this.modelManager.removeModel(u,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(u,p,w={}){if(this._checkLoaded(),this.getOwnSource(u)!==void 0)throw new Error(`There is already a source with ID "${u}".`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(Ar,`sources.${u}`,p,null,w))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const I=Zi(u,p,this.dispatcher,this);I.scope=this.scope,I.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(I.id),source:I.serialize(),sourceId:I.id}));const P=F=>{const W=(F?"symbol:":"other:")+I.id,$=o.av(W,this.scope),J=this._sourceCaches[W]=new $o($,I,F);(F?this._symbolSourceCaches:this._otherSourceCaches)[I.id]=J,J.onAdd(this.map)};P(!1),p.type!=="vector"&&p.type!=="geojson"||P(!0),I.onAdd&&I.onAdd(this.map),w.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(u){this._checkLoaded();const p=this.getOwnSource(u);if(!p)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===u)return this.fire(new o.t(new Error(`Source "${u}" cannot be removed while layer "${I}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===u)return this.fire(new o.t(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const w=this.getOwnSourceCaches(u);for(const I of w){const P=o.cm(I.id);delete this._sourceCaches[P],this._changes.discardSourceCacheUpdate(I.id),I.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:I.getSource().id})),I.setEventedParent(null),I.clearTiles()}return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],this.mergeSources(),p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(u,p){this._checkLoaded(),this.getOwnSource(u).setData(p),this._changes.setDirty()}getOwnSource(u){const p=this.getOwnSourceCache(u);return p&&p.getSource()}getOwnSources(){const u=[];for(const p in this._otherSourceCaches){const w=this.getOwnSourceCache(p);w&&u.push(w.getSource())}return u}areTilesLoaded(){const u=this._mergedSourceCaches;for(const p in u){const w=u[p]._tiles;for(const I in w){const P=w[I];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0}setLights(u){if(this._checkLoaded(),!u)return delete this.ambientLight,void delete this.directionalLight;const p=this._getTransitionParameters();for(const I of u){if(this._validate(hs,"lights",I))return;switch(I.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(I),P.updateTransitions(p)}else this.ambientLight=new wn(I,_n||(_n=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(I),P.updateTransitions(p)}else this.directionalLight=new wn(I,zn||(zn=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const w=new o.a3(this.z||0,p);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const u=this.directionalLight,p=this.ambientLight;if(!u||!p)return;const w=oe=>.2126*(oe[0]<=.03928?oe[0]/12.92:Math.pow((oe[0]+.055)/1.055,2.4))+.7152*(oe[1]<=.03928?oe[1]/12.92:Math.pow((oe[1]+.055)/1.055,2.4))+.0722*(oe[2]<=.03928?oe[2]/12.92:Math.pow((oe[2]+.055)/1.055,2.4)),I=u.properties.get("color").toRenderColor(null).toArray01(),P=u.properties.get("intensity"),F=u.properties.get("direction"),W=1-o.c7(F.x,F.y,F.z)[2]/90,$=w(I)*P*W,J=p.properties.get("color").toRenderColor(null).toArray01(),Q=p.properties.get("intensity");return($+w(J)*Q)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const u=[];return this.directionalLight&&u.push(this.directionalLight.get()),this.ambientLight&&u.push(this.ambientLight.get()),u}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(u){if(!u)return this;if(o.cn(u)){const p=o.co(u),w=this.fragments.find(({id:P})=>P===p);if(!w)throw new Error(`Style import not found: ${u}`);const I=o.cm(u);return w.style.getFragmentStyle(I)}{const p=this.fragments.find(({id:w})=>w===u);if(!p)throw new Error(`Style import not found: ${u}`);return p.style}}getConfigProperty(u,p){const w=this.getFragmentStyle(u);if(!w)return null;const I=o.av(p,w.scope),P=w.options.get(I),F=P?P.value||P.default:null;return F?F.serialize():null}setConfigProperty(u,p,w){const I=this.getFragmentStyle(u);if(!I)return;const P=I.stylesheet.schema;if(!P||!P[p])return;const F=o.M(w);if(F.result!=="success")return void aa(this,F.value);const W=F.value.expression,$=o.av(p,I.scope),J=I.options.get($);if(!J)return;let Q;const{minValue:oe,maxValue:le,stepValue:ue,type:ve,values:_e}=P[p],be=o.M(P[p].default);be.result==="success"&&(Q=be.value.expression),Q?(this.options.set($,{...J,value:W,default:Q,minValue:oe,maxValue:le,stepValue:ue,type:ve,values:_e}),this.updateConfigDependencies(p)):this.fire(new o.t(new Error(`No schema defined for the config option "${p}" in the "${u}" fragment.`)))}getConfig(u){const p=this.getFragmentStyle(u);if(!p)return null;const w=p.stylesheet.schema;if(!w)return null;const I={};for(const P in w){const F=o.av(P,p.scope),W=p.options.get(F),$=W?W.value||W.default:null;I[P]=$?$.serialize():null}return I}setConfig(u,p){const w=this.getFragmentStyle(u);w&&(w.updateConfig(p,w.stylesheet.schema),this.updateConfigDependencies())}getSchema(u){const p=this.getFragmentStyle(u);return p?p.stylesheet.schema:null}setSchema(u,p){const w=this.getFragmentStyle(u);w&&(w.stylesheet.schema=p,w.updateConfig(w._config,p),this.updateConfigDependencies())}updateConfig(u,p){if(this._config=u,u||p)if(p)for(const w in p){let I,P;const F=o.M(p[w].default);if(F.result==="success"&&(I=F.value.expression),u&&u[w]!==void 0){const le=o.M(u[w]);le.result==="success"&&(P=le.value.expression)}const{minValue:W,maxValue:$,stepValue:J,type:Q,values:oe}=p[w];if(I){const le=o.av(w,this.scope);this.options.set(le,{default:I,value:P,minValue:W,maxValue:$,stepValue:J,type:Q,values:oe})}else this.fire(new o.t(new Error(`No schema defined for config option "${w}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(u){for(const p of this._configDependentLayers){const w=this.getLayer(p);if(w){if(u&&!w.configDependencies.has(u))continue;w.possiblyEvaluateVisibility(),this._updateLayer(w)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(p=>{if(p._styleColorTheme.colorTheme){const w=p._evaluateColorThemeData(p._styleColorTheme.colorTheme);(!p._styleColorTheme.lut&&w!==""||p._styleColorTheme.lut&&w!==p._styleColorTheme.lut.data)&&p.setColorTheme(p._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(u,p,w={}){this._checkLoaded();const I=u.id;if(this._layers[I])return void this.fire(new o.t(new Error(`Layer with id "${I}" already exists on this map`)));let P;if(u.type==="custom"){if(aa(this,o.cp(u)))return;P=o.cq(u,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof u.source=="object"&&(this.addSource(I,u.source),u=o.cl(u),u=o.l(u,{source:I})),this._validate(Tt,`layers.${I}`,u,{arrayIndex:-1},w))return;P=o.cq(u,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(P),P.setEventedParent(this,{layer:{id:I}}),this._serializedLayers[P.id]=P.serialize()}P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid);let F=this._order.length;if(p){const Q=this._order.indexOf(p);if(Q===-1)return void this.fire(new o.t(new Error(`Layer with id "${p}" does not exist on this map.`)));P.slot===this._layers[p].slot?F=Q:o.w(`Layer with id "${p}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(F,0,I),this._layerOrderChanged=!0,this._layers[I]=P;const W=this.getOwnLayerSourceCache(P),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();W&&P.canCastShadows()&&$&&(W.castsShadows=!0);const J=this._changes.getRemovedLayer(P);if(J&&P.source&&W&&P.type!=="custom"){this._changes.discardLayerRemoval(P);const Q=o.av(P.source,P.scope);J.type!==P.type?this._changes.updateSourceCache(Q,"clear"):(this._changes.updateSourceCache(Q,"reload"),W.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),P.scope=this.scope,this.mergeLayers()}moveLayer(u,p){this._checkLoaded();const w=this._checkLayer(u);if(!w||u===p)return;const I=this._order.indexOf(u);this._order.splice(I,1);let P=this._order.length;if(p){const F=this._order.indexOf(p);if(F===-1)return void this.fire(new o.t(new Error(`Layer with id "${p}" does not exist on this map.`)));w.slot===this._layers[p].slot?P=F:o.w(`Layer with id "${p}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,u),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(u){this._checkLoaded();const p=this._checkLayer(u);if(!p)return;p.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),delete this._layers[u],delete this._serializedLayers[u],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(p.fqid),this._changes.removeLayer(p);const I=this.getOwnLayerSourceCache(p);if(I&&I.castsShadows){let P=!1;for(const F in this._layers)if(this._layers[F].source===p.source&&this._layers[F].canCastShadows()){P=!0;break}I.castsShadows=P}p.onRemove&&p.onRemove(this.map),this.mergeLayers()}getOwnLayer(u){return this._layers[u]}hasLayer(u){return u in this._mergedLayers}hasLayerType(u){for(const p in this._layers)if(this._layers[p].type===u)return!0;return!1}setLayerZoomRange(u,p,w){this._checkLoaded();const I=this._checkLayer(u);I&&(I.minzoom===p&&I.maxzoom===w||(p!=null&&(I.minzoom=p),w!=null&&(I.maxzoom=w),this._updateLayer(I)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(u,p){this._checkLoaded();const w=this._checkLayer(u);w&&w.slot!==p&&(w.slot=p,this._updateLayer(w))}setFilter(u,p,w={}){this._checkLoaded();const I=this._checkLayer(u);if(I&&!o.bh(I.filter,p))return p==null?(I.filter=void 0,void this._updateLayer(I)):void(this._validate(xe,`layers.${I.id}.filter`,p,{layerType:I.type},w)||(I.filter=o.cl(p),this._updateLayer(I)))}getFilter(u){const p=this._checkLayer(u);if(p)return o.cl(p.filter)}setLayoutProperty(u,p,w,I={}){this._checkLoaded();const P=this._checkLayer(u);if(P&&!o.bh(P.getLayoutProperty(p),w)){if(w!=null&&(!I||I.validate!==!1)&&aa(P,Xe.call(En,{key:`layers.${u}.layout.${p}`,layerType:P.type,objectKey:p,value:w,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;P.setLayoutProperty(p,w),P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),this._updateLayer(P)}}getLayoutProperty(u,p){const w=this._checkLayer(u);if(w)return w.getLayoutProperty(p)}setPaintProperty(u,p,w,I={}){this._checkLoaded();const P=this._checkLayer(u);if(!P||o.bh(P.getPaintProperty(p),w)||w!=null&&(!I||I.validate!==!1)&&aa(P,Ee.call(En,{key:`layers.${u}.paint.${p}`,layerType:P.type,objectKey:p,value:w,styleSpec:o._})))return;const F=P.setPaintProperty(p,w);P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),F&&this._updateLayer(P),this._changes.updatePaintProperties(P)}getPaintProperty(u,p){const w=this._checkLayer(u);if(w)return w.getPaintProperty(p)}setFeatureState(u,p){this._checkLoaded();const w=u.source,I=u.sourceLayer,P=this._checkSource(w);if(!P)return;const F=P.type;if(F==="geojson"&&I)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(F==="vector"&&!I)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));u.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const W=this.getOwnSourceCaches(w);for(const $ of W)$.setFeatureState(I,u.id,p)}removeFeatureState(u,p){this._checkLoaded();const w=u.source,I=this._checkSource(w);if(!I)return;const P=I.type,F=P==="vector"?u.sourceLayer:void 0;if(P==="vector"&&!F)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&typeof u.id!="string"&&typeof u.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const W=this.getOwnSourceCaches(w);for(const $ of W)$.removeFeatureState(F,u.id,p)}getFeatureState(u){this._checkLoaded();const p=u.source,w=u.sourceLayer,I=this._checkSource(p);if(I){if(I.type!=="vector"||w)return u.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(p)[0].getFeatureState(w,u.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(u){return this.stylesheet.transition=o.l({},this.stylesheet.transition,u),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const u=this.getTerrain(),p=u&&this.terrain&&this.terrain.scope===this.scope?u:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:p,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},w=>w!==void 0)}_updateLayer(u){this._changes.updateLayer(u);const p=this.getLayerSourceCache(u),w=o.av(u.source,u.scope),I=this._changes.getUpdatedSourceCaches();u.source&&!I[w]&&p&&p.getSource().type!=="raster"&&(this._changes.updateSourceCache(w,"reload"),p.pause()),u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const p=W=>this._mergedLayers[W].is3D(),w=this.order,I={},P=[];for(let W=w.length-1;W>=0;W--){const $=w[W];if(p($)){I[$]=W;for(const J of u){const Q=J[$];if(Q)for(const oe of Q)P.push(oe)}}}P.sort((W,$)=>$.intersectionZ-W.intersectionZ);const F=[];for(let W=w.length-1;W>=0;W--){const $=w[W];if(p($))for(let J=P.length-1;J>=0;J--){const Q=P[J].feature;if(Q.layer&&I[Q.layer.id]<W)break;F.push(Q),P.pop()}else for(const J of u){const Q=J[$];if(Q)for(const oe of Q)F.push(oe.feature)}}return F}queryRenderedFeatures(u,p,w){p&&p.filter&&this._validate(xe,"queryRenderedFeatures.filter",p.filter,null,p),p.scope=this.scope,p.availableImages=this._availableImages,p.serializedLayers=this._serializedLayers;const I={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];for(const J of p.layers){const Q=this._mergedLayers[J];if(!Q)return this.fire(new o.t(new Error(`The layer '${J}' does not exist in the map's style and cannot be queried for features.`))),[];I[Q.source]=!0}}const P=[],F=p.serializedLayers||{},W=p&&p.layers?p.layers.some(J=>{const Q=this.getLayer(J);return Q&&Q.is3D()}):this.has3DLayers(),$=Xn.createFromScreenPoints(u,w);for(const J in this._mergedSourceCaches){const Q=this._mergedSourceCaches[J].getSource();if(!Q||Q.scope!==p.scope)continue;const oe=this._mergedSourceCaches[J].getSource().id;p.layers&&!I[oe]||P.push(_s(this._mergedSourceCaches[J],this._mergedLayers,F,$,p,w,W,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(J,Q,oe,le,ue,ve,_e){const be={},we=ve.queryRenderedSymbols(le),ke=[];for(const Ne of Object.keys(we).map(Number))ke.push(_e[Ne]);ke.sort(Ls);for(const Ne of ke){const De=Ne.featureIndex.lookupSymbolFeatures(we[Ne.bucketInstanceId],Q,Ne.bucketIndex,Ne.sourceLayerIndex,ue.filter,ue.layers,ue.availableImages,J);for(const We in De){const He=be[We]=be[We]||[],et=De[We];et.sort((Ke,tt)=>{const ut=Ne.featureSortOrder;if(ut){const st=ut.indexOf(Ke.featureIndex);return ut.indexOf(tt.featureIndex)-st}return tt.featureIndex-Ke.featureIndex});for(const Ke of et)He.push(Ke)}}for(const Ne in be)be[Ne].forEach(De=>{const We=De.feature,He=oe(J[Ne]);if(!He)return;const et=He.getFeatureState(We.layer["source-layer"],We.id);We.source=We.layer.source,We.layer["source-layer"]&&(We.sourceLayer=We.layer["source-layer"]),We.state=et});return be}(this._mergedLayers,F,this.getLayerSourceCache.bind(this),$.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(u,p){p&&p.filter&&this._validate(xe,"querySourceFeatures.filter",p.filter,null,p);const w=this.getOwnSourceCaches(u);let I=[];for(const P of w)I=I.concat(Xo(P,p));return I}addSourceType(u,p,w){return Oa.getSourceType(u)?w(new Error(`A source type called "${u}" already exists.`)):(Oa.setSourceType(u,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:p.workerSourceURL},w):w(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(u,p,w={}){this._checkLoaded();const I=this.light.getLight();let P=!1;for(const W in u)if(!o.bh(u[W],I[W])){P=!0;break}if(!P)return;const F=this._getTransitionParameters();this.light.setLight(u,p,w),this.light.updateTransitions(F)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(u,p=1){if(this._checkLoaded(),!u)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),p===0&&delete this.terrain,u===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let w=u;const I=u.source==null;if(p===1){if(this.disableElevatedTerrain)return;if(typeof w.source=="object"){const W="terrain-dem-src";this.addSource(W,w.source),w=o.cl(w),w=o.l(w,{source:W})}const P=o.l({},w),F={};if(this.terrain&&I){P.source=this.terrain.get().source;const W=this.terrain?this.getFragmentStyle(this.terrain.scope):null;W&&(F.style=W.serialize())}if(this._validate(Ps,"terrain",P,F))return}if(!this.terrain||this.terrain.scope!==this.scope&&!I||this.terrain&&p!==this.terrain.drapeRenderMode){if(!w)return;this._createTerrain(w,p),this.fire(new o.x("data",{dataType:"style"}))}else{const P=this.terrain,F=P.get();for(const W of Object.keys(o._.terrain))!w.hasOwnProperty(W)&&o._.terrain[W].default&&(w[W]=o._.terrain[W].default);for(const W in u)if(!o.bh(u[W],F[W])){P.set(u,this.options),this.stylesheet.terrain=u;const $=this._getTransitionParameters({duration:0});P.updateTransitions($),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const p=this.fog=new It(u,this.map.transform,this.scope,this.options);this.stylesheet.fog=p.get();const w=this._getTransitionParameters({duration:0});p.updateTransitions(w)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog;if(!o.bh(p.get(),u)){p.set(u,this.options),this.stylesheet.fog=p.get();const w=this._getTransitionParameters({duration:0});p.updateTransitions(w)}}else this._createFog(u);this._markersNeedUpdate=!0}setColorTheme(u){this._checkLoaded();const p=()=>{for(const I in this._layers)this._layers[I].lut=this._styleColorTheme.lut;for(const I in this._sourceCaches)this._sourceCaches[I].clearTiles()};if(this._styleColorTheme.colorTheme=u,!u)return this._styleColorTheme.lut=null,void p();const w=this._evaluateColorThemeData(u);this._loadColorTheme(w).then(()=>{this.fire(new o.x("colorthemeset")),p()}).catch(I=>{o.w(`Couldn't set color theme: ${I}`)})}_getTransitionParameters(u){return{now:o.q.now(),transition:o.l(this.transition,u)}}updateDrapeFirstLayers(){if(!this.terrain)return;const u=[],p=[];for(const w of this._mergedOrder)this.isLayerDraped(this._mergedLayers[w])?u.push(w):p.push(w);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...p)}_createTerrain(u,p){const w=this.terrain=new zt(u,p,this.scope,this.options);p===1&&(this.stylesheet.terrain=u),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const I=this._getTransitionParameters({duration:0});w.updateTransitions(I)}_force3DLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="fill-extrusion"&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="symbol"&&this._updateLayer(p)}}_validate(u,p,w,I,P={}){if(P&&P.validate===!1)return!1;const F=o.l({},this.serialize());return aa(this,u.call(En,o.l({key:p,style:F,value:w,styleSpec:o._},I)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._mergedLayers)this._mergedLayers[u].setEventedParent(null);for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles(),this._mergedSourceCaches[u].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(u){const p=this.getSourceCaches(u);for(const w of p)w.clearTiles()}clearSources(){for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles()}reloadSource(u){const p=this.getSourceCaches(u);for(const w of p)w.resume(),w.reload()}reloadSources(){for(const u of this.getSources())u.reload&&u.reload()}updateSources(u){let p;this.directionalLight&&(p=Zh(this.directionalLight));for(const w in this._mergedSourceCaches)this._mergedSourceCaches[w].update(u,void 0,void 0,p)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const p=this._sourceCaches[u];p.resume(),p.reload()}}_updatePlacement(u,p,w,I,P,F,W=!1){let $=!1,J=!1;const Q={},oe={};for(const le of this._mergedOrder){const ue=this._mergedLayers[le];if(ue.type!=="symbol")continue;const ve=o.av(ue.source,ue.scope);let _e=Q[ve];if(!_e){const we=this.getLayerSourceCache(ue);if(!we)continue;const ke=we.getRenderableIds(!0).map(Ne=>we.getTileByID(Ne));oe[ve]=ke.slice(),_e=Q[ve]=ke.sort((Ne,De)=>De.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(De.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(ue,_e,p.center.lng,p.projection);$=$||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),W=W||this._layerOrderChanged||I===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(W||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),p.zoom))&&(this.pauseablePlacement=new pd(p,this._mergedOrder,W,w,I,P,this.placement,this.fog&&p.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Q,oe),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),J=!0),$&&this.pauseablePlacement.placement.setStale()),J||$){this._buildingIndex.onNewFrame(p.zoom);for(let le=0;le<this._mergedOrder.length;le++){const ue=this._mergedLayers[this._mergedOrder[le]];if(ue.type!=="symbol")continue;const ve=this.isLayerClipped(ue);this.placement.updateLayerOpacities(ue,Q[o.av(ue.source,ue.scope)],le,ve?F:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}addImport(u,p){this._checkLoaded();const w=this.stylesheet.imports=this.stylesheet.imports||[];if(w.findIndex(({id:P})=>P===u.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${u.id}' already exists in the map's style.`)));if(!p)return w.push(u),this._loadImports([u],!0);const I=w.findIndex(({id:P})=>P===p);return I===-1&&this.fire(new o.t(new Error(`Import with id "${p}" does not exist on this map.`))),this.stylesheet.imports=w.slice(0,I).concat(u).concat(w.slice(I)),this._loadImports([u],!0,p)}updateImport(u,p){this._checkLoaded();const w=this.stylesheet.imports||[],I=this.getImportIndex(u);return I===-1?this:typeof p=="string"?(this.setImportUrl(u,p),this):(p.url&&p.url!==w[I].url&&this.setImportUrl(u,p.url),o.bh(p.config,w[I].config)||this.setImportConfig(u,p.config),o.bh(p.data,w[I].data)||this.setImportData(u,p.data),this)}moveImport(u,p){this._checkLoaded();let w=this.stylesheet.imports||[];const I=this.getImportIndex(u);if(I===-1)return this;const P=this.getImportIndex(p);if(P===-1)return this;const F=w[I],W=this.fragments[I];return w=w.filter(({id:$})=>$!==u),this.fragments=this.fragments.filter(({id:$})=>$!==u),this.stylesheet.imports=w.slice(0,P).concat(F).concat(w.slice(P)),this.fragments=this.fragments.slice(0,P).concat(W).concat(this.fragments.slice(P)),this.mergeLayers(),this}setImportUrl(u,p){this._checkLoaded();const w=this.stylesheet.imports||[],I=this.getImportIndex(u);if(I===-1)return this;w[I].url=p;const P=this.fragments[I];return P.style=this._createFragmentStyle(w[I]),P.style.on("style.import.load",()=>this.mergeAll()),P.style.loadURL(p),this}setImportData(u,p){this._checkLoaded();const w=this.getImportIndex(u),I=this.stylesheet.imports||[];return w===-1?this:p?(this.fragments[w].style.setState(p),this._reloadImports(),this):(delete I[w].data,this.setImportUrl(u,I[w].url))}setImportConfig(u,p){this._checkLoaded();const w=this.getImportIndex(u),I=this.stylesheet.imports||[];if(w===-1)return this;p?I[w].config=p:delete I[w].config;const P=this.fragments[w],F=P.style.stylesheet&&P.style.stylesheet.schema;return P.config=p,P.style.updateConfig(p,F),this.updateConfigDependencies(),this}removeImport(u){this._checkLoaded();const p=this.stylesheet.imports||[],w=this.getImportIndex(u);w!==-1&&(p.splice(w,1),this.fragments[w].style._remove(),this.fragments.splice(w,1),this._reloadImports())}getImportIndex(u){const p=(this.stylesheet.imports||[]).findIndex(w=>w.id===u);return p===-1&&this.fire(new o.t(new Error(`Import '${u}' does not exist in the map's style and cannot be updated.`))),p}getLayer(u){return this._mergedLayers[u]}getSources(){const u=[];for(const p in this._mergedOtherSourceCaches){const w=this._mergedOtherSourceCaches[p];w&&u.push(w.getSource())}return u}getSource(u,p){const w=this.getSourceCache(u,p);return w&&w.getSource()}getLayerSource(u){const p=this.getLayerSourceCache(u);return p&&p.getSource()}getSourceCache(u,p){const w=o.av(u,p);return this._mergedOtherSourceCaches[w]}getLayerSourceCache(u){const p=o.av(u.source,u.scope);return u.type==="symbol"?this._mergedSymbolSourceCaches[p]:this._mergedOtherSourceCaches[p]}getSourceCaches(u){if(u==null)return Object.values(this._mergedSourceCaches);const p=[];return this._mergedOtherSourceCaches[u]&&p.push(this._mergedOtherSourceCaches[u]),this._mergedSymbolSourceCaches[u]&&p.push(this._mergedSymbolSourceCaches[u]),p}updateSourceCaches(){const u=this._changes.getUpdatedSourceCaches();for(const p in u){const w=u[p];w==="reload"?this.reloadSource(p):w==="clear"&&this.clearSource(p)}}updateLayers(u){const p=this._changes.getUpdatedPaintProperties();for(const w of p){const I=this.getLayer(w);I&&I.updateTransitions(u)}}getImages(u,p,w){this.imageManager.getImages(p.icons,p.scope,w),this._updateTilesForChangedImages();const I=P=>{P&&P.setDependencies(p.tileID.key,p.type,p.icons)};I(this._otherSourceCaches[p.source]),I(this._symbolSourceCaches[p.source])}getGlyphs(u,p,w){this.glyphManager.getGlyphs(p.stacks,p.scope,w)}getResource(u,p,w){return o.ct(p,w)}getOwnSourceCache(u){return this._otherSourceCaches[u]}getOwnLayerSourceCache(u){return u.type==="symbol"?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}getOwnSourceCaches(u){const p=[];return this._otherSourceCaches[u]&&p.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&p.push(this._symbolSourceCaches[u]),p}_isSourceCacheLoaded(u){const p=this.getOwnSourceCaches(u);return p.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${u}'`))),!1):p.every(w=>w.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(u,p){if(!this._clipLayerPresent&&u.type!=="fill-extrusion")return!1;const w=u.type==="fill-extrusion"&&u.sourceLayer==="building";if(u.is3D()){if(w||p&&p.type==="batched-model"||u.type==="model")return!0}else if(u.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(u=>{u.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Oa.getSourceType=function(b){return Qn[b]},Oa.setSourceType=function(b,u){Qn[b]=u},Oa.registerForPluginStateChange=o.cc;var Kh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,fg=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Bp=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Ms="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",kp=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,dg=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,pg=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Op=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Ka=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Jh=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Cs=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Do=[];Vs(Kh,Do),Vs(Bp,Do),Vs(fg,Do);const Ys={"_prelude_fog.vertex.glsl":dg,"_prelude_terrain.vertex.glsl":kp,"_prelude_shadow.vertex.glsl":Jh,"_prelude_fog.fragment.glsl":pg,"_prelude_shadow.fragment.glsl":Cs,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Op,"_prelude_raster_particle.glsl":Ka},_u={};Kr("",kp),Kr(pg,dg),Kr(Cs,Jh),Kr(Op,""),Kr(Ka,"");const yu=Kr(fg,Bp),$u=Kh;var qu={background:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Kr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Kr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Kr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Kr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Kr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Kr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Kr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Kr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Kr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ms),skyboxGradient:Kr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ms),skyboxCapture:Kr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Kr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Kr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Vs(b,u){const p=b.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let w of p)if(w=w.trim(),w[0]==="#"&&w.includes("if")&&!w.includes("endif")){w=w.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const I=w.split(" ");for(const P of I)u.includes(P)||u.push(P)}}function Kr(b,u){const p=/#include\s+"([^"]+)"/g,w=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let I=u.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);I&&(I=I.map(J=>{const Q=J.split(" ");return Q[Q.length-1]}),I=[...new Set(I)]);const P={},F=[],W=[];if(b=b.replace(p,(J,Q)=>(W.push(Q),"")),(u=u.replace(p,(J,Q)=>(F.push(Q),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let $=[...Do];Vs(b,$),Vs(u,$);for(const J of[...F,...W])Ys[J]||console.error(`Undefined include: ${J}`),_u[J]||(_u[J]=[],Vs(Ys[J],_u[J])),$=[...$,..._u[J]];return{fragmentSource:b=b.replace(w,(J,Q,oe,le,ue)=>(P[ue]=!0,Q==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
in ${oe} ${le} ${ue};
#else
uniform ${oe} ${le} u_${ue};
#endif
`:Q==="initialize"?`
#ifdef HAS_UNIFORM_u_${ue}
    ${oe} ${le} ${ue} = u_${ue};
#endif
`:Q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    in ${oe} ${le} ${ue};
#endif
`:Q==="initialize-attribute"?"":void 0)),vertexSource:u=u.replace(w,(J,Q,oe,le,ue)=>{const ve=le==="float"?"vec2":le,_e=ue.match(/color/)?"color":ve;return Q==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
in ${oe} ${le} a_${ue};
#endif
`:P[ue]?Q==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
in ${oe} ${ve} a_${ue};
out ${oe} ${le} ${ue};
#else
uniform ${oe} ${le} u_${ue};
#endif
`:Q==="initialize"?_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = a_${ue};
#else
    ${oe} ${le} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = unpack_mix_${_e}(a_${ue}, u_${ue}_t);
#else
    ${oe} ${le} ${ue} = u_${ue};
#endif
`:Q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    in ${oe} ${le} a_${ue};
    out ${oe} ${le} ${ue};
#endif
`:Q==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    ${ue} = a_${ue};
#endif
`:void 0:Q==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
in ${oe} ${ve} a_${ue};
#else
uniform ${oe} ${le} u_${ue};
#endif
`:Q==="define-instanced"?_e==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ue}0;
in vec4 a_${ue}1;
in vec4 a_${ue}2;
in vec4 a_${ue}3;
#else
uniform ${oe} ${le} u_${ue};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${oe} ${ve} a_${ue};
#else
uniform ${oe} ${le} u_${ue};
#endif
`:Q==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    ${oe} ${le} ${ue} = a_${ue};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${oe} ${le} ${ue} = a_${ue};
#else
    ${oe} ${le} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${oe} ${le} ${ue} = unpack_mix_${_e}(a_${ue}, u_${ue}_t);
#else
    ${oe} ${le} ${ue} = u_${ue};
#endif
`}),staticAttributes:I,usedDefines:$,vertexIncludes:F,fragmentIncludes:W}}class Zu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,p,w,I,P,F,W,$){this.context=u;let J=this.boundPaintVertexBuffers.length!==I.length;for(let oe=0;!J&&oe<I.length;oe++)this.boundPaintVertexBuffers[oe]!==I[oe]&&(J=!0);let Q=this.boundDynamicVertexBuffers.length!==W.length;for(let oe=0;!Q&&oe<W.length;oe++)this.boundDynamicVertexBuffers[oe]!==W[oe]&&(Q=!0);if(!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==w||J||Q||this.boundIndexBuffer!==P||this.boundVertexOffset!==F)this.freshBind(p,w,I,P,F,W,$);else{u.bindVertexArrayOES.set(this.vao);for(const oe of W)oe&&(oe.bind(),$&&oe.instanceCount&&oe.setVertexAttribDivisor(u.gl,p,$));P&&P.dynamicDraw&&P.bind()}}freshBind(u,p,w,I,P,F,W){const $=u.numAttributes,J=this.context,Q=J.gl;this.vao&&this.destroy(),this.vao=J.gl.createVertexArray(),J.bindVertexArrayOES.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=I,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=F,p.enableAttributes(Q,u),p.bind(),p.setVertexAttribPointers(Q,u,P);for(const oe of w)oe.enableAttributes(Q,u),oe.bind(),oe.setVertexAttribPointers(Q,u,P);for(const oe of F)oe&&(oe.enableAttributes(Q,u),oe.bind(),oe.setVertexAttribPointers(Q,u,P),W&&oe.instanceCount&&oe.setVertexAttribDivisor(Q,u,W));I&&I.bind(),J.currentNumAttributes=$}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Qh(b,u){const p=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new o.a5(0,w/p).toLngLat().lat,new o.a5(0,(w+1)/p).toLngLat().lat]}function Ml(b,u,p,w,I,P,F){const W=b.context,$=W.gl,J=p.hillshadeFBO;if(!J)return;b.prepareDrawTile();const Q=b.isTileAffectedByFog(u),oe=b.getOrCreateProgram("hillshade",{overrideFog:Q});W.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,J.colorAttachment.get());const le=((be,we,ke,Ne)=>{const De=ke.paint.get("hillshade-shadow-color"),We=ke.paint.get("hillshade-highlight-color"),He=ke.paint.get("hillshade-accent-color"),et=ke.paint.get("hillshade-emissive-strength");let Ke=o.bB(ke.paint.get("hillshade-illumination-direction"));if(ke.paint.get("hillshade-illumination-anchor")==="viewport")Ke-=be.transform.angle;else if(be.style&&be.style.enable3dLights()&&be.style.directionalLight){const ut=be.style.directionalLight.properties.get("direction"),st=o.c7(ut.x,ut.y,ut.z);Ke=o.bB(st[1])}const tt=!be.options.moving;return{u_matrix:Ne||be.transform.calculateProjMatrix(we.tileID.toUnwrapped(),tt),u_image:0,u_latrange:Qh(0,we.tileID),u_light:[ke.paint.get("hillshade-exaggeration"),Ke],u_shadow:De.toRenderColor(ke.lut),u_highlight:We.toRenderColor(ke.lut),u_emissive_strength:et,u_accent:He.toRenderColor(ke.lut)}})(b,p,w,b.terrain?u.projMatrix:null);b.uploadCommonUniforms(W,oe,u.toUnwrapped());const{tileBoundsBuffer:ue,tileBoundsIndexBuffer:ve,tileBoundsSegments:_e}=b.getTileBoundsBuffers(p);oe.draw(b,$.TRIANGLES,I,P,F,_r.disabled,le,w.id,ue,ve,_e)}function ul(b,u,p){if(!u.needsDEMTextureUpload)return;const w=b.context,I=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||b.getTileTexture(p.stride);const P=p.getPixels();u.demTexture?u.demTexture.update(P,{premultiply:!1}):u.demTexture=new o.T(w,P,I.R32F,{premultiply:!1}),u.needsDEMTextureUpload=!1}function ic(b,u,p){const w=b.context,I=w.gl;if(!u.dem)return;const P=u.dem;if(w.activeTexture.set(I.TEXTURE1),ul(b,u,P),!u.demTexture)return;u.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const F=P.dim;w.activeTexture.set(I.TEXTURE0);let W=u.hillshadeFBO;if(!W){const le=new o.T(w,{width:F,height:F,data:null},I.RGBA8);le.bind(I.LINEAR,I.CLAMP_TO_EDGE),W=u.hillshadeFBO=w.createFramebuffer(F,F,!0,"renderbuffer"),W.colorAttachment.set(le.texture)}w.bindFramebuffer.set(W.framebuffer),w.viewport.set([0,0,F,F]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:J,tileBoundsSegments:Q}=b.getMercatorTileBoundsBuffers(),oe=[];b.linearFloatFilteringSupported()&&oe.push("TERRAIN_DEM_FLOAT_FORMAT"),b.getOrCreateProgram("hillshadePrepare",{defines:oe}).draw(b,I.TRIANGLES,$n.disabled,pr.disabled,Mr.unblended,_r.disabled,((le,ue)=>{const ve=ue.stride,_e=o.a6.mat4.create();return o.a6.mat4.ortho(_e,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(_e,_e,[0,-o.ab,0]),{u_matrix:_e,u_image:1,u_dimension:[ve,ve],u_zoom:le.overscaledZ}})(u.tileID,P),p.id,$,J,Q),u.needsHillshadePrepare=!1}class xi{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vd extends xi{getDefault(){return o.bz.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class zv extends xi{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class mg extends xi{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class Fp extends xi{getDefault(){return[!0,!0,!0,!0]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class _d extends xi{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Uv extends xi{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class Gv extends xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const p=this.current;(u.func!==p.func||u.ref!==p.ref||u.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class gg extends xi{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class zc extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=u,this.dirty=!1}}class Vv extends xi{getDefault(){return[0,1]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class vg extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=u,this.dirty=!1}}class _g extends xi{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Hv extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.BLEND):p.disable(p.BLEND),this.current=u,this.dirty=!1}}class ef extends xi{getDefault(){const u=this.gl;return[u.ONE,u.ZERO,u.ONE,u.ZERO]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.blendFuncSeparate(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class yg extends xi{getDefault(){return o.bz.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class xg extends xi{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(u,u),this.current=u,this.dirty=!1)}}class bg extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=u,this.dirty=!1}}class jv extends xi{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class wg extends xi{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let E1=class extends xi{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}};class yd extends xi{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class Np extends xi{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Wv extends xi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class hl extends xi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Xv extends xi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class zp extends xi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Up extends xi{getDefault(){return null}set(u){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Sg extends xi{getDefault(){return null}set(u){this.gl&&(u!==this.current||this.dirty)&&(this.gl.bindVertexArray(u),this.current=u,this.dirty=!1)}}class Ag extends xi{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class tf extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class $v extends xi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Gp extends xi{constructor(u,p){super(u),this.context=u,this.parent=p}getDefault(){return null}}class Tg extends Gp{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Vp extends Gp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Mg extends Gp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,this.attachment(),p.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class xd extends Vp{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const I1=(b,u,p)=>({u_matrix:b,u_image0:0,u_skirt_height:u,u_ground_shadow_factor:p}),qv=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e)=>({u_proj_matrix:Float32Array.from(b),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(w),u_merc_matrix:p,u_zoom_transition:I,u_merc_center:P,u_image0:0,u_frustum_tl:F,u_frustum_tr:W,u_frustum_br:$,u_frustum_bl:J,u_globe_pos:Q,u_globe_radius:oe,u_viewport:le,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:ue,u_far_z_cutoff:ve});function Zv(b,u){return b!=null&&u!=null&&!(!b.hasData()||!u.hasData())&&b.demTexture!=null&&u.demTexture!=null&&b.tileID.key!==u.tileID.key}const nf=new class{constructor(){this.operations={}}newMorphing(b,u,p,w,I){if(b in this.operations){const P=this.operations[b];P.to.tileID.key!==p.tileID.key&&(P.queued=p)}else this.operations[b]={startTime:w,phase:0,duration:I,from:u,to:p,queued:null}}getMorphValuesForProxy(b){if(!(b in this.operations))return null;const u=this.operations[b];return{from:u.from,to:u.to,phase:u.phase}}update(b){for(const u in this.operations){const p=this.operations[u];for(p.phase=(b-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,b)){delete this.operations[u];break}}}_nextOp(b,u){return!!b.queued&&(b.from=b.to,b.to=b.queued,b.queued=null,b.phase=0,b.startTime=u,!0)}_validOp(b){return b.from.hasData()&&b.to.hasData()}},Yv={0:null,1:"TERRAIN_VERTEX_MORPHING"};function sc(b,u,p){if(u===0)return 0;const w=u<1&&p===514?.25/u:1;return 6*Math.pow(1.5,22-b)*Math.max(u,1)*w}function Cg(b,u){const p=1<<b.z;return!u&&(b.x===0||b.x===p-1)||b.y===0||b.y===p-1}const xu=b=>({u_matrix:b});function Yu(b,u,p,w,I){if(I>0){const P=o.q.now(),F=(P-b.timeAdded)/I,W=u?(P-u.timeAdded)/I:-1,$=p.getSource(),J=w.coveringZoomLevel({tileSize:$.tileSize,roundZoom:$.roundZoom}),Q=!u||Math.abs(u.tileID.overscaledZ-J)>Math.abs(b.tileID.overscaledZ-J),oe=Q&&b.refreshedUponExpiration?1:o.ap(Q?F:1-W,0,1);return b.refreshedUponExpiration&&F>=1&&(b.refreshedUponExpiration=!1),u?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}class bu extends $o{constructor(u){const p={type:"raster-dem",maxzoom:u.transform.maxZoom},w=new o.cd(o.ce(),null),I=Zi("mock-dem",p,w,u.style);super("mock-dem",I,!1),I.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,p){u.state="loaded",p(null)}}class Hp extends $o{constructor(u){const p=Zi("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new o.cd(o.ce(),null),u.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,p,w){if(u.freezeTileCoverage)return;this.transform=u;const I=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,F)=>{if(P[F.key]="",!this._tiles[F.key]){const W=new kc(F,this._source.tileSize*F.overscaleFactor(),u.tileZoom);W.state="loaded",this._tiles[F.key]=W}return P},{});for(const P in this._tiles)P in I||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(u){const p=this.proxyCachedFBO[u];if(p!==void 0){const w=Object.values(p);this.renderCachePool.push(...w),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Eg extends o.aA{constructor(u,p,w){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=p,this.projMatrix=w}}class rf extends o.cE{constructor(u,p){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},u.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,I,P]=function($){const J=new o.a_,Q=new o.aO,oe=131;J.reserve(17161),Q.reserve(33800);const le=o.ab/128,ue=o.ab+le/2,ve=ue+le;for(let be=-le;be<ve;be+=le)for(let we=-le;we<ve;we+=le){const ke=we<0||we>ue||be<0||be>ue?24575:0,Ne=o.ap(Math.round(we),0,o.ab),De=o.ap(Math.round(be),0,o.ab);J.emplaceBack(Ne+ke,De)}const _e=(be,we)=>{const ke=we*oe+be;Q.emplaceBack(ke+1,ke,ke+oe),Q.emplaceBack(ke+oe,ke+oe+1,ke+1)};for(let be=1;be<129;be++)for(let we=1;we<129;we++)_e(we,be);return[0,129].forEach(be=>{for(let we=0;we<130;we++)_e(we,be),_e(be,we)}),[J,Q,32768]}(),F=u.context;this.gridBuffer=F.createVertexBuffer(w,o.b0.members),this.gridIndexBuffer=F.createIndexBuffer(I),this.gridSegments=o.b1.simpleSegment(0,0,w.length,I.length),this.gridNoSkirtSegments=o.b1.simpleSegment(0,0,w.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Hp(p.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const W=F.gl;this._overlapStencilMode=new pr({func:W.GEQUAL,mask:255},0,255,W.KEEP,W.KEEP,W.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new bu(p.map),this._pendingGroundEffectLayers=[]}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),this._style=u,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,p,w){if(u&&u.terrain){this._style!==u&&(this.style=u,this._evaluationZoom=void 0);const I=u.terrain.properties,P=u.terrain.drapeRenderMode===0,F=u.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const W=u.terrain&&u.terrain.scope,$=I.get("source"),J=P?this._mockSourceCache:u.getSourceCache($,W);if(!J)return void o.w(`Couldn't find terrain source "${$}".`);if(this.sourceCache=J,this._exaggeration=F?this.calculateExaggeration(p):I.get("exaggeration"),!p.projection.requiresDraping&&F&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Q=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const oe=this.getScaledDemTileSize();this.sourceCache.update(p,oe,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Q(),this._initializing=!0),Q(),p.updateElevation(!0,w),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0,this._previousZoom=p.zoom}else this._disable()}calculateExaggeration(u){const p=this._previousCameraAltitude,w=u.getFreeCameraOptions().position.z/u.pixelsPerMeter*u.worldSize;this._previousCameraAltitude=w;const I=p!=null?w-p:Number.MAX_VALUE;if(Math.abs(I)<2)return this._exaggeration;const P=u.zoom,F=this._style.terrain;if(!this._previousUpdateTimestamp)return F.getExaggeration(P);let W=P-this._previousZoom;const $=this._previousUpdateTimestamp;let J=P;this._evaluationZoom!=null&&(J=this._evaluationZoom,Math.abs(P-J)>.5&&(W=.5*(P-J+W)),W*I<0&&(J+=W)),this._evaluationZoom=J;const Q=F.getExaggeration(J),oe=Q===F.getExaggeration(Math.max(0,J-.1));if(oe&&Math.abs(Q-this._exaggeration)<.01)return Q;let le=Math.min(.1,.00375*(this._updateTimestamp-$));return(oe||Q<.1||Math.abs(W)<1e-4)&&(le=Math.min(.2,4*le)),o.aa(this._exaggeration,Q,le)}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(u){u.coord&&u.dataType==="source"?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):u.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._mergedSourceCaches)this._style._mergedSourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=w._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(w.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const I=this.proxyCoords=p.getIds().map($=>{const J=p.getTileByID($).tileID;return J.projMatrix=w.calculateProjMatrix(J.toUnwrapped()),J});(function($,J){const Q=J.transform.pointCoordinate(J.transform.getCameraPoint()),oe=new o.P(Q.x,Q.y);$.sort((le,ue)=>{if(ue.overscaledZ-le.overscaledZ)return ue.overscaledZ-le.overscaledZ;const ve=new o.P(le.canonical.x+(1<<le.canonical.z)*le.wrap,le.canonical.y),_e=new o.P(ue.canonical.x+(1<<ue.canonical.z)*ue.wrap,ue.canonical.y),be=oe.mult(1<<le.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ve)-be.distSqr(_e)})})(I,this.painter);const P=this.proxyToSource||{};this.proxyToSource={},I.forEach($=>{this.proxyToSource[$.key]={}}),this.terrainTileForTile={};const F=this._style._mergedSourceCaches;for(const $ in F){const J=F[$];if(!J.used||(J!==this.sourceCache&&this.resetTileLookupCache(J.id),this._setupProxiedCoordsForOrtho(J,u[$],P),J.usedForTerrain))continue;const Q=u[$];J.getSource().reparseOverscaled&&this._assignTerrainTiles(Q)}this.proxiedCoords[p.id]=I.map($=>new Eg($,$.key,this.orthoMatrix)),this._assignTerrainTiles(I),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1;const W={};this._visibleDemTiles=[];for(const $ of this.proxyCoords){const J=this.terrainTileForTile[$.key];if(!J)continue;const Q=J.tileID.key;Q in W||(this._visibleDemTiles.push(J),W[Q]=Q)}}_assignTerrainTiles(u){this._initializing||u.forEach(p=>{if(this.terrainTileForTile[p.key])return;const w=this._findTileCoveringTileID(p,this.sourceCache);w&&(this.terrainTileForTile[p.key]=w)})}_prepareDEMTextures(){const u=this.painter.context,p=u.gl;for(const w in this.terrainTileForTile){const I=this.terrainTileForTile[w],P=I.dem;!P||I.demTexture&&!I.needsDEMTextureUpload||(u.activeTexture.set(p.TEXTURE1),ul(this.painter,I,P))}}_prepareDemTileUniforms(u,p,w,I){if(!p||p.demTexture==null)return!1;const P=u.tileID.canonical,F=Math.pow(2,p.tileID.canonical.z-P.z),W=I||"";return w[`u_dem_tl${W}`]=[P.x*F%1,P.y*F%1],w[`u_dem_scale${W}`]=F,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let u=0;const p=this._visibleDemTiles.reduce((w,I)=>{if(!I.dem)return w;const P=I.dem.tree.minimums[0];return P>0&&u++,w+P},0);return u?p/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,p=u.gl;u.activeTexture.set(p.TEXTURE2);const w=this._getLoadedAreaMinimum(),I=new o.cF({width:1,height:1},new Float32Array([w]));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(I,{premultiply:!1}):P=this._emptyDEMTexture=new o.T(u,I,p.R32F,{premultiply:!1}),P}setupElevationDraw(u,p,w){const I=this.painter.context,P=I.gl,F={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};F.u_exaggeration=this.exaggeration();let W=null,$=null,J=1;if(w&&w.morphing&&this._useVertexMorphing){const ue=w.morphing.srcDemTile,ve=w.morphing.dstDemTile;J=w.morphing.phase,ue&&ve&&(this._prepareDemTileUniforms(u,ue,F,"_prev")&&($=ue),this._prepareDemTileUniforms(u,ve,F)&&(W=ve))}const Q=ue=>ue&&ue.demTexture&&this.painter.linearFloatFilteringSupported()?P.LINEAR:P.NEAREST;let oe=null;var le;if(this.enabled?$&&W?(oe=W.demTexture,I.activeTexture.set(P.TEXTURE4),$.demTexture.bind(Q($),P.CLAMP_TO_EDGE),F.u_dem_lerp=J):(W=this.terrainTileForTile[u.tileID.key],oe=this._prepareDemTileUniforms(u,W,F)?W.demTexture:this.emptyDEMTexture):oe=this.emptyDEMTexture,I.activeTexture.set(P.TEXTURE2),oe&&(F.u_dem_size=(le=oe).size[0]===1?1:le.size[0]-2,oe.bind(Q(W),P.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(w&&w.useDepthForOcclusion,p,F),w&&w.useMeterToDem&&W){const ue=(1<<W.tileID.canonical.z)*o.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;F.u_meter_to_dem=ue}if(w&&w.labelPlaneMatrixInv&&(F.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),p.setTerrainUniformValues(I,F),this.painter.transform.projection.name==="globe"){const ue=this.globeUniformValues(this.painter.transform,u.tileID.canonical,w&&w.useDenormalizedUpVectorScale);p.setGlobeUniformValues(I,ue)}}globeUniformValues(u,p,w){const I=u.projection;return{u_tile_tl_up:I.upVector(p,0,0),u_tile_tr_up:I.upVector(p,o.ab,0),u_tile_br_up:I.upVector(p,o.ab,o.ab),u_tile_bl_up:I.upVector(p,0,o.ab),u_tile_up_scale:w?o.cG(1):I.upVectorScale(p,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const p=this.painter,w=this.painter.context;u.length!==0&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(I,P,F,W,$){if(I.transform.projection.name==="globe")(function(J,Q,oe,le,ue){const ve=J.context,_e=ve.gl;let be,we;const ke=J.transform,Ne=o.cx(J,ve,ke),De=(xt,Ft)=>{if(we===Ft)return;const Zt=[Yv[Ft],"PROJECTION_GLOBE_VIEW"];Ne&&Zt.push("CUSTOM_ANTIALIASING");const kt=J.isTileAffectedByFog(xt);be=J.getOrCreateProgram("globeRaster",{defines:Zt,overrideFog:kt}),we=Ft},We=J.colorModeForRenderPass(),He=new $n(_e.LEQUAL,$n.ReadWrite,J.depthRangeFor3D);nf.update(ue);const et=o.cy(ke),Ke=[o.am(ke.center.lng),o.at(ke.center.lat)],tt=J.globeSharedBuffers,ut=[ke.width*o.q.devicePixelRatio,ke.height*o.q.devicePixelRatio],st=Float32Array.from(ke.globeMatrix),rt={useDenormalizedUpVectorScale:!0};{const xt=J.transform,Ft=sc(xt.zoom,Q.exaggeration(),Q.sourceCache._source.tileSize);we=-1;const Zt=_e.TRIANGLES;for(const kt of le){const hn=oe.getTile(kt),bt=pr.disabled,Wt=Q.prevTerrainTileForTile[kt.key],Gt=Q.terrainTileForTile[kt.key];Zv(Wt,Gt)&&nf.newMorphing(kt.key,Wt,Gt,ue,250),ve.activeTexture.set(_e.TEXTURE0),hn.texture&&hn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const fn=nf.getMorphValuesForProxy(kt.key),pn=fn?1:0;fn&&o.C(rt,{morphing:{srcDemTile:fn.from,dstDemTile:fn.to,phase:o.cw(fn.phase)}});const qt=o.cz(kt.canonical),en=o.cA(qt.getCenter().lat),er=o.cB(kt.canonical,qt,en,xt.worldSize/xt._pixelsPerMercatorPixel),xn=o.b5(o.cC(kt.canonical)),Dn=qv(xt.expandedFarZProjMatrix,st,et,xn,o.a9(xt.zoom),Ke,xt.frustumCorners.TL,xt.frustumCorners.TR,xt.frustumCorners.BR,xt.frustumCorners.BL,xt.globeCenterInViewSpace,xt.globeRadius,ut,Ft,xt._farZ,er);if(De(kt,pn),be&&(Q.setupElevationDraw(hn,be,rt),J.uploadCommonUniforms(ve,be,kt.toUnwrapped()),tt)){const[yr,qn,ur]=tt.getGridBuffers(en,Ft!==0);be.draw(J,Zt,He,bt,We,_r.backCCW,Dn,"globe_raster",yr,qn,ur)}}}if(tt&&(J.renderDefaultNorthPole||J.renderDefaultSouthPole)){const xt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ne&&xt.push("CUSTOM_ANTIALIASING"),be=J.getOrCreateProgram("globeRaster",{defines:xt});for(const Ft of le){const{x:Zt,y:kt,z:hn}=Ft.canonical,bt=kt===0,Wt=kt===(1<<hn)-1,[Gt,fn,pn,qt]=tt.getPoleBuffers(hn,!1);if(qt&&(bt||Wt)){const en=oe.getTile(Ft);ve.activeTexture.set(_e.TEXTURE0),en.texture&&en.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let er=o.cD(hn,Zt,ke);const xn=o.b5(o.cC(Ft.canonical)),Dn=(yr,qn)=>yr.draw(J,_e.TRIANGLES,He,pr.disabled,We,_r.disabled,qv(ke.expandedFarZProjMatrix,er,er,xn,0,Ke,ke.frustumCorners.TL,ke.frustumCorners.TR,ke.frustumCorners.BR,ke.frustumCorners.BL,ke.globeCenterInViewSpace,ke.globeRadius,ut,0,ke._farZ),"globe_pole_raster",qn,pn,qt);Q.setupElevationDraw(en,be,rt),J.uploadCommonUniforms(ve,be,Ft.toUnwrapped()),bt&&J.renderDefaultNorthPole&&Dn(be,Gt),Wt&&J.renderDefaultSouthPole&&(er=o.a6.mat4.scale(o.a6.mat4.create(),er,[1,-1,1]),Dn(be,fn))}}}})(I,P,F,W,$);else{const J=I.context,Q=J.gl;let oe,le;const ue=I.shadowRenderer,ve=nc(I,I.longestCutoffRange),_e=We=>{if(le===We)return;const He=[];He.push(Yv[We]),ve.shouldRenderCutoff&&He.push("RENDER_CUTOFF"),oe=I.getOrCreateProgram("terrainRaster",{defines:He}),le=We},be=I.colorModeForRenderPass(),we=new $n(Q.LEQUAL,$n.ReadWrite,I.depthRangeFor3D);nf.update($);const ke=I.transform,Ne=sc(ke.zoom,P.exaggeration(),P.sourceCache._source.tileSize);let De=[0,0,0];if(ue){const We=I.style.directionalLight,He=I.style.ambientLight;We&&He&&(De=Lp(I.style,We,He))}{le=-1;const We=Q.TRIANGLES,[He,et]=[P.gridIndexBuffer,P.gridSegments];for(const Ke of W){const tt=F.getTile(Ke),ut=pr.disabled,st=P.prevTerrainTileForTile[Ke.key],rt=P.terrainTileForTile[Ke.key];Zv(st,rt)&&nf.newMorphing(Ke.key,st,rt,$,250),J.activeTexture.set(Q.TEXTURE0),tt.texture&&tt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const xt=nf.getMorphValuesForProxy(Ke.key),Ft=xt?1:0;let Zt;xt&&(Zt={morphing:{srcDemTile:xt.from,dstDemTile:xt.to,phase:o.cw(xt.phase)}});const kt=I1(Ke.projMatrix,Cg(Ke.canonical,ke.renderWorldCopies)?Ne/10:Ne,De);if(_e(Ft),!oe)continue;P.setupElevationDraw(tt,oe,Zt);const hn=Ke.toUnwrapped();ue&&ue.setupShadows(hn,oe),I.uploadCommonUniforms(J,oe,hn,null,ve),oe.draw(I,We,we,ut,be,_r.backCCW,kt,"terrain_raster",P.gridBuffer,He,et)}}}}(p,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(this._drapedRenderBatches.length===0)return u+1;this.renderingToTexture=!0;const p=this.painter,w=this.painter.context,I=this.proxySourceCache,P=this.proxiedCoords[I.id],F=this._drapedRenderBatches.shift(),W=p.style.order,$=[];let J=0;for(const Q of P){const oe=I.getTileByID(Q.proxyTileKey),le=I.proxyCachedFBO[Q.key]?I.proxyCachedFBO[Q.key][u]:void 0,ue=le!==void 0?I.renderCache[le]:this.pool[J++],ve=le!==void 0;if(oe.texture=ue.tex,ve&&!ue.dirty){$.push(oe.tileID);continue}let _e;w.bindFramebuffer.set(ue.fb.framebuffer),this.renderedToTile=!1,ue.dirty&&(w.clear({color:o.bz.transparent,stencil:0}),ue.dirty=!1);for(let be=F.start;be<=F.end;++be){const we=p.style._mergedLayers[W[be]];if(we.isHidden(p.transform.zoom))continue;const ke=p.style.getLayerSourceCache(we),Ne=ke?this.proxyToSource[Q.key][ke.id]:[Q];if(!Ne)continue;const De=Ne;w.viewport.set([0,0,ue.fb.width,ue.fb.height]),_e!==(ke?ke.id:null)&&(this._setupStencil(ue,Ne,we,ke),_e=ke?ke.id:null),p.renderLayer(p,ke,we,De)}if(this._drapedRenderBatches.length===0)for(const be of this._pendingGroundEffectLayers){const we=p.style._mergedLayers[W[be]];if(we.isHidden(p.transform.zoom))continue;const ke=p.style.getLayerSourceCache(we),Ne=ke?this.proxyToSource[Q.key][ke.id]:[Q];if(!Ne)continue;const De=Ne;w.viewport.set([0,0,ue.fb.width,ue.fb.height]),_e!==(ke?ke.id:null)&&(this._setupStencil(ue,Ne,we,ke),_e=ke?ke.id:null),p.renderLayer(p,ke,we,De)}this.renderedToTile?(ue.dirty=!0,$.push(oe.tileID)):ve||--J,J===5&&(J=0,this.renderToBackBuffer($))}return this.renderToBackBuffer($),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height]),F.end+1}postRender(){}isLayerOrderingCorrect(u){const p=u.order.length;let w=-1,I=p;for(let P=0;P<p;++P)this._style.isLayerDraped(u._mergedLayers[u.order[P]])?w=Math.max(w,P):I=Math.min(I,P);return I>w}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{u=Math.min(u,p.dem.tree.minimums[0])}),u===0?u:(u-30)*this._exaggeration}raycast(u,p,w){if(!this._visibleDemTiles)return null;const I=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const F=P.tileID,W=1<<F.overscaledZ,{x:$,y:J}=F.canonical,Q=$/W,oe=($+1)/W,le=J/W,ue=(J+1)/W;return{minx:Q,miny:le,maxx:oe,maxy:ue,t:P.dem.tree.raycastRoot(Q,le,oe,ue,u,p,w),tile:P}});I.sort((P,F)=>(P.t!==null?P.t:Number.MAX_VALUE)-(F.t!==null?F.t:Number.MAX_VALUE));for(const P of I){if(P.t==null)return null;const F=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,u,p,w);if(F!=null)return F}return null}_createFBO(){const u=this.painter.context,p=u.gl,w=this.drapeBufferSize;u.activeTexture.set(p.TEXTURE0);const I=new o.T(u,{width:w[0],height:w[1],data:null},p.RGBA8);I.bind(p.LINEAR,p.CLAMP_TO_EDGE);const P=u.createFramebuffer(w[0],w[1],!0,null);return P.colorAttachment.set(I.texture),P.depthAttachment=new xd(u,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:P,tex:I,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const u in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const p=this._style._mergedLayers[u],w=p.isHidden(this.painter.transform.zoom);return p.type==="hillshade"||p.type==="custom"?!w&&p.shouldRedrape():!w&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const w of this._style.getSources())if(w instanceof Hi){u=!0;break}if(!u)return;const p={};for(let w=0;w<this._style.order.length;++w){const I=this._style._mergedLayers[this._style.order[w]],P=this._style.getLayerSourceCache(I);if(P&&!p[P.id]&&!I.isHidden(this.painter.transform.zoom)&&I.type==="line"&&I.widthExpression()instanceof o.a4){p[P.id]=!0;for(const F of this.proxyCoords){const W=this.proxyToSource[F.key][P.id];if(W)for(const $ of W)this._clearRenderCacheForTile(P.id,$)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const w in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[w]._source instanceof Ss){u=!0;break}if(!u)return;const p={};for(let w=0;w<this._style.order.length;++w){const I=this._style._mergedLayers[this._style.order[w]],P=this._style.getLayerSourceCache(I);if(!P||p[P.id]||I.isHidden(this.painter.transform.zoom)||I.type!=="raster")continue;const F=I.paint.get("raster-fade-duration");for(const W of this.proxyCoords){const $=this.proxyToSource[W.key][P.id];if($)for(const J of $){const Q=Yu(P.getTile(J),P.findLoadedParent(J,0),P,this.painter.transform,F);(Q.opacity!==1||Q.mix!==0)&&this._clearRenderCacheForTile(P.id,J)}}}}_setupDrapedRenderBatches(){const u=this._style.order,p=u.length;if(p===0)return;const w=[];this._pendingGroundEffectLayers=[];let I,P=0,F=this._style._mergedLayers[u[P]];for(;!this._style.isLayerDraped(F)&&F.isHidden(this.painter.transform.zoom)&&++P<p;)F=this._style._mergedLayers[u[P]];for(;P<p;++P){const W=this._style._mergedLayers[u[P]];W.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(W)?I===void 0&&(I=P):(W.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(P),I!==void 0&&(w.push({start:I,end:P-1}),I=void 0)))}if(I!==void 0&&w.push({start:I,end:P-1}),w.length!==0){const W=w[w.length-1];this._pendingGroundEffectLayers.every($=>$>W.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=w}_setupRenderCache(u){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const F=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let W=0;W<F.length;++W){const $=Object.values(F[W]);p.renderCachePool.push(...$)}}return}this._clearRasterLayersFromRenderCache();const w=this.proxyCoords,I=this._tilesDirty;for(let F=w.length-1;F>=0;F--){const W=w[F];if(p.getTileByID(W.key),p.proxyCachedFBO[W.key]!==void 0){const $=u[W.key],J=this.proxyToSource[W.key];let Q=0;for(const oe in J){const le=J[oe],ue=$[oe];if(!ue||ue.length!==le.length||le.some((ve,_e)=>ve!==ue[_e]||I[oe]&&I[oe].hasOwnProperty(ve.key))){Q=-1;break}++Q}for(const oe in p.proxyCachedFBO[W.key])p.renderCache[p.proxyCachedFBO[W.key][oe]].dirty=Q<0||Q!==Object.values($).length}}const P=[...this._drapedRenderBatches];P.sort((F,W)=>W.end-W.start-(F.end-F.start));for(const F of P)for(const W of w){if(p.proxyCachedFBO[W.key])continue;let $=p.renderCachePool.pop();$===void 0&&p.renderCache.length<50&&($=p.renderCache.length,p.renderCache.push(this._createFBO())),$!==void 0&&(p.proxyCachedFBO[W.key]={},p.proxyCachedFBO[W.key][F.start]=$,p.renderCache[$].dirty=!0)}this._tilesDirty={}}_setupStencil(u,p,w,I){if(!I||!this._sourceTilesOverlap[I.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,F=P.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let W;if(w.isTileClipped())W=p.length,this._overlapStencilMode.test={func:F.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);W=1,this._overlapStencilMode.test={func:F.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+W>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=W,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):pr.disabled}_renderTileClippingMasks(u,p){const w=this.painter,I=this.painter.context,P=I.gl;w._tileClippingMaskIDs={},I.setColorMode(Mr.disabled),I.setDepthMode($n.disabled);const F=w.getOrCreateProgram("clippingMask");for(const W of u){const $=w._tileClippingMaskIDs[W.key]=--p;F.draw(w,P.TRIANGLES,$n.disabled,new pr({func:P.ALWAYS,mask:0},$,255,P.KEEP,P.KEEP,P.REPLACE),Mr.disabled,_r.disabled,xu(W.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(u){const p=this.painter.transform;if(u.x<0||u.x>p.width||u.y<0||u.y>p.height)return null;const w=[u.x,u.y,1,1];o.a6.vec4.transformMat4(w,w,p.pixelMatrixInverse),o.a6.vec4.scale(w,w,1/w[3]),w[0]/=p.worldSize,w[1]/=p.worldSize;const I=p._camera.position,P=o.bD(1,p.center.lat),F=[I[0],I[1],I[2]/P,0],W=o.a6.vec3.subtract([],w.slice(0,3),F);o.a6.vec3.normalize(W,W);const $=this.raycast(F,W,this._exaggeration);return $!==null&&$?(o.a6.vec3.scaleAndAdd(F,F,W,$),F[3]=F[2],F[2]*=P,F):null}_setupProxiedCoordsForOrtho(u,p,w){if(u.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(u,p,w);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords;for(let $=0;$<P.length;$++){const J=P[$],Q=this._findTileCoveringTileID(J,u);if(Q){const oe=this._createProxiedId(J,Q,w[J.key]&&w[J.key][u.id]);I.push(oe),this.proxyToSource[J.key][u.id]=[oe]}}let F=!1;const W=new Set;for(let $=0;$<p.length;$++){const J=u.getTile(p[$]);if(!J||!J.hasData())continue;const Q=this._findTileCoveringTileID(J.tileID,this.proxySourceCache);if(Q&&Q.tileID.canonical.z!==J.tileID.canonical.z){const oe=this.proxyToSource[Q.tileID.key][u.id],le=this._createProxiedId(Q.tileID,J,w[Q.tileID.key]&&w[Q.tileID.key][u.id]);oe?oe.splice(oe.length-1,0,le):this.proxyToSource[Q.tileID.key][u.id]=[le];const ue=this.proxyToSource[Q.tileID.key][u.id];W.has(ue)||W.add(ue),I.push(le),F=!0}}if(this._sourceTilesOverlap[u.id]=F,F&&this._debugParams.sortTilesHiZFirst)for(const $ of W)$.sort((J,Q)=>Q.overscaledZ-J.overscaledZ)}_setupProxiedCoordsForImageSource(u,p,w){if(!u.getSource().loaded())return;const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords,F=u.getSource(),W=F.tileID;if(!W)return;const $=new o.P(W.x,W.y)._div(1<<W.z),J=F.coordinates.map(o.a5.fromLngLat).reduce((oe,le)=>(oe.min.x=Math.min(oe.min.x,le.x-$.x),oe.min.y=Math.min(oe.min.y,le.y-$.y),oe.max.x=Math.max(oe.max.x,le.x-$.x),oe.max.y=Math.max(oe.max.y,le.y-$.y),oe),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Q=(oe,le)=>{const ue=oe.wrap+oe.canonical.x/(1<<oe.canonical.z),ve=oe.canonical.y/(1<<oe.canonical.z),_e=o.ab/(1<<oe.canonical.z),be=le.wrap+le.canonical.x/(1<<le.canonical.z),we=le.canonical.y/(1<<le.canonical.z);return ue+_e<be+J.min.x||ue>be+J.max.x||ve+_e<we+J.min.y||ve>we+J.max.y};for(let oe=0;oe<P.length;oe++){const le=P[oe];for(let ue=0;ue<p.length;ue++){const ve=u.getTile(p[ue]);if(!ve||!ve.hasData()||Q(le,ve.tileID))continue;const _e=this._createProxiedId(le,ve,w[le.key]&&w[le.key][u.id]),be=this.proxyToSource[le.key][u.id];be?be.push(_e):this.proxyToSource[le.key][u.id]=[_e],I.push(_e)}}}_createProxiedId(u,p,w){let I=this.orthoMatrix;if(w){const P=w.find(F=>F.key===p.tileID.key);if(P)return P}if(p.tileID.key!==u.key){const P=u.canonical.z-p.tileID.canonical.z;let F,W,$;I=o.a6.mat4.create();const J=p.tileID.wrap-u.wrap<<u.overscaledZ;P>0?(F=o.ab>>P,W=F*((p.tileID.canonical.x<<P)-u.canonical.x+J),$=F*((p.tileID.canonical.y<<P)-u.canonical.y)):(F=o.ab<<-P,W=o.ab*(p.tileID.canonical.x-(u.canonical.x+J<<-P)),$=o.ab*(p.tileID.canonical.y-(u.canonical.y<<-P))),o.a6.mat4.ortho(I,0,F,0,F,0,1),o.a6.mat4.translate(I,I,[W,$,0])}return new Eg(p.tileID,u.key,I)}_findTileCoveringTileID(u,p){let w=p.getTile(u);if(w&&w.hasData())return w;const I=this._findCoveringTileCache[p.id],P=I[u.key];if(w=P?p.getTileByID(P):null,w&&w.hasData()||P===null)return w;let F=w?w.tileID:u,W=F.overscaledZ;const $=p.getSource().minzoom,J=[];if(!P){const oe=p.getSource().maxzoom;if(u.canonical.z>=oe){const le=u.canonical.z-oe;p.getSource().reparseOverscaled?(W=Math.max(u.canonical.z+2,p.transform.tileZoom),F=new o.aA(W,u.wrap,oe,u.canonical.x>>le,u.canonical.y>>le)):le!==0&&(W=oe,F=new o.aA(W,u.wrap,oe,u.canonical.x>>le,u.canonical.y>>le))}F.key!==u.key&&(J.push(F.key),w=p.getTile(F))}const Q=oe=>{J.forEach(le=>{I[le]=oe}),J.length=0};for(W-=1;W>=$&&(!w||!w.hasData());W--){w&&Q(w.tileID.key);const oe=F.calculateScaledKey(W);if(w=p.getTileByID(oe),w&&w.hasData())break;const le=I[oe];if(le===null)break;le===void 0?J.push(oe):w=p.getTileByID(le)}return Q(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,p){let w=this._tilesDirty[u];w||(w=this._tilesDirty[u]={}),w[p.key]=!0}}function Zo(b,u,p){const w=function(W,$,J){const Q=o.a6.vec3.dot($,W),oe=o.a6.vec3.dot(J,[.2126,.7152,.0722]),le=(ve,_e,be)=>(1-be)*ve+be*_e,ue=le(1-.3*Math.min(oe,1),1,Math.min(Q+1,1));return le(.92,1,Math.asin(o.ap($[2],-1,1))/Math.PI+.5)*ue}(b,[0,0,1],u),I=[0,0,0];o.a6.vec3.scale(I,p.slice(0,3),w);const P=[0,0,0];o.a6.vec3.scale(P,u.slice(0,3),b[2]);const F=[0,0,0];return o.a6.vec3.add(F,I,P),o.cb(F)}const sf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],R1=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class bo{static cacheKey(u,p,w,I){let P=`${p}${I?I.cacheKey:""}`;for(const F of w)u.usedDefines.includes(F)&&(P+=`/${F}`);return P}constructor(u,p,w,I,P,F){const W=u.gl;this.program=W.createProgram(),this.configuration=I,this.name=p,this.fixedDefines=[...F];const $=I?I.getBinderAttributes():[],J=(w.staticAttributes||[]).concat($);let Q=I?I.defines():[];Q=Q.concat(F.map(be=>`#define ${be}`));const oe=`#version 300 es
`;let le=oe+Q.concat("precision mediump float;",$u,yu.fragmentSource).join(`
`);for(const be of w.fragmentIncludes)le+=`
${Ys[be]}`;le+=`
${w.fragmentSource}`;let ue=oe+Q.concat("precision highp float;",$u,yu.vertexSource).join(`
`);for(const be of w.vertexIncludes)ue+=`
${Ys[be]}`;ue+=`
${w.vertexSource}`;const ve=W.createShader(W.FRAGMENT_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);W.shaderSource(ve,le),W.compileShader(ve),W.attachShader(this.program,ve);const _e=W.createShader(W.VERTEX_SHADER);if(W.isContextLost())this.failedToCreate=!0;else{W.shaderSource(_e,ue),W.compileShader(_e),W.attachShader(this.program,_e),this.attributes={},this.numAttributes=J.length;for(let be=0;be<this.numAttributes;be++)if(J[be]){const we=J[be].startsWith("a_")?J[be]:`a_${J[be]}`;W.bindAttribLocation(this.program,be,we),this.attributes[we]=be}W.linkProgram(this.program),W.deleteShader(_e),W.deleteShader(ve),this.fixedUniforms=P(u),this.binderUniforms=I?I.getUniforms(u):[],(F.includes("TERRAIN")||p.indexOf("symbol")!==-1||p.indexOf("circle")!==-1)&&(this.terrainUniforms=(be=>({u_dem:new o.bJ(be),u_dem_prev:new o.bJ(be),u_dem_tl:new o.bG(be),u_dem_scale:new o.bI(be),u_dem_tl_prev:new o.bG(be),u_dem_scale_prev:new o.bI(be),u_dem_size:new o.bI(be),u_dem_lerp:new o.bI(be),u_exaggeration:new o.bI(be),u_depth:new o.bJ(be),u_depth_size_inv:new o.bG(be),u_depth_range_unpack:new o.bG(be),u_occluder_half_size:new o.bI(be),u_occlusion_depth_offset:new o.bI(be),u_meter_to_dem:new o.bI(be),u_label_plane_matrix_inv:new o.bF(be)}))(u)),F.includes("GLOBE")&&(this.globeUniforms=(be=>({u_tile_tl_up:new o.bH(be),u_tile_tr_up:new o.bH(be),u_tile_br_up:new o.bH(be),u_tile_bl_up:new o.bH(be),u_tile_up_scale:new o.bI(be)}))(u)),F.includes("FOG")&&(this.fogUniforms=(be=>({u_fog_matrix:new o.bF(be),u_fog_range:new o.bG(be),u_fog_color:new o.c6(be),u_fog_horizon_blend:new o.bI(be),u_fog_vertical_limit:new o.bG(be),u_fog_temporal_offset:new o.bI(be),u_frustum_tl:new o.bH(be),u_frustum_tr:new o.bH(be),u_frustum_br:new o.bH(be),u_frustum_bl:new o.bH(be),u_globe_pos:new o.bH(be),u_globe_radius:new o.bI(be),u_globe_transition:new o.bI(be),u_is_globe:new o.bJ(be),u_viewport:new o.bG(be)}))(u)),F.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(be=>({u_cutoff_params:new o.c6(be)}))(u)),F.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(be=>({u_lighting_ambient_color:new o.bH(be),u_lighting_directional_dir:new o.bH(be),u_lighting_directional_color:new o.bH(be),u_ground_radiance:new o.bH(be)}))(u)),F.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(be=>({u_light_matrix_0:new o.bF(be),u_light_matrix_1:new o.bF(be),u_fade_range:new o.bG(be),u_shadow_normal_offset:new o.bH(be),u_shadow_intensity:new o.bI(be),u_shadow_texel_size:new o.bI(be),u_shadow_map_resolution:new o.bI(be),u_shadow_direction:new o.bH(be),u_shadow_bias:new o.bH(be),u_shadowmap_0:new o.bJ(be),u_shadowmap_1:new o.bJ(be)}))(u))}}setTerrainUniformValues(u,p){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in p)w[I]&&w[I].set(this.program,I,p[I])}}setGlobeUniformValues(u,p){if(!this.globeUniforms)return;const w=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in p)w[I]&&w[I].set(this.program,I,p[I])}}setFogUniformValues(u,p){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in p)w[I].set(this.program,I,p[I])}}setCutoffUniformValues(u,p){if(!this.cutoffUniforms)return;const w=this.cutoffUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in p)w[I].set(this.program,I,p[I])}}setLightsUniformValues(u,p){if(!this.lightsUniforms)return;const w=this.lightsUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in p)w[I].set(this.program,I,p[I])}}setShadowUniformValues(u,p){if(this.failedToCreate||!this.shadowUniforms)return;const w=this.shadowUniforms;u.program.set(this.program);for(const I in p)w[I].set(this.program,I,p[I])}_drawDebugWireframe(u,p,w,I,P,F,W,$,J,Q){const oe=u.options.wireframe;if(oe.terrain===!1&&oe.layers2D===!1&&oe.layers3D===!1)return;const le=u.context;if(!(!(!oe.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!oe.layers2D||u._terrain&&u._terrain.renderingToTexture||!sf.includes(this.name))||!(!oe.layers3D||!R1.includes(this.name))))return;const ue=le.gl,ve=u.wireframeDebugCache.getLinesFromTrianglesBuffer(u.frameCounter,P,le);if(!ve)return;const _e=[...this.fixedDefines];_e.push("DEBUG_WIREFRAME");const be=u.getOrCreateProgram(this.name,{config:this.configuration,defines:_e});le.program.set(be.program);const we=(De,We,He)=>{if(We[De]&&He[De])for(const et in We[De])He[De][et]&&He[De][et].set(He.program,et,We[De][et].current)};J&&J.setUniforms(be.program,le,be.binderUniforms,W,{zoom:$}),we("fixedUniforms",this,be),we("terrainUniforms",this,be),we("globeUniforms",this,be),we("fogUniforms",this,be),we("lightsUniforms",this,be),we("shadowUniforms",this,be),ve.bind(),le.setColorMode(new Mr([ue.ONE,ue.ONE_MINUS_SRC_ALPHA,ue.ZERO,ue.ONE],o.bz.transparent,[!0,!0,!0,!1])),le.setDepthMode(new $n(p.func===ue.LESS?ue.LEQUAL:p.func,$n.ReadOnly,p.range)),le.setStencilMode(pr.disabled);const ke=3*F.primitiveLength*2,Ne=3*F.primitiveOffset*2*2;Q&&Q>1?ue.drawElementsInstanced(ue.LINES,ke,ue.UNSIGNED_SHORT,Ne,Q):ue.drawElements(ue.LINES,ke,ue.UNSIGNED_SHORT,Ne),P.bind(),le.program.set(this.program),le.setDepthMode(p),le.setStencilMode(w),le.setColorMode(I)}draw(u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be){const we=u.context,ke=we.gl;if(this.failedToCreate)return;we.program.set(this.program),we.setDepthMode(w),we.setStencilMode(I),we.setColorMode(P),we.setCullFace(F);for(const We of Object.keys(this.fixedUniforms))this.fixedUniforms[We].set(this.program,We,W[We]);ve&&ve.setUniforms(this.program,we,this.binderUniforms,le,{zoom:ue});const Ne={[ke.POINTS]:1,[ke.LINES]:2,[ke.TRIANGLES]:3,[ke.LINE_STRIP]:1}[p],De=be&&be>0?1:void 0;for(const We of oe.get()){const He=We.vaos||(We.vaos={});(He[$]||(He[$]=new Zu)).bind(we,this,J,ve?ve.getPaintVertexBuffers():[],Q,We.vertexOffset,_e||[],De),be&&be>1?ke.drawElementsInstanced(p,We.primitiveLength*Ne,ke.UNSIGNED_SHORT,We.primitiveOffset*Ne*2,be):Q?ke.drawElements(p,We.primitiveLength*Ne,ke.UNSIGNED_SHORT,We.primitiveOffset*Ne*2):ke.drawArrays(p,We.vertexOffset,We.vertexLength),p===ke.TRIANGLES&&Q&&this._drawDebugWireframe(u,w,I,P,Q,We,le,ue,ve,be)}}}function la(b,u){const p=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,b.transform.tileZoom)/p,I=w*(u.tileID.canonical.x+u.tileID.wrap*p),P=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture?u.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(u,1,b.transform.tileZoom),u_pixel_coord_upper:[I>>16,P>>16],u_pixel_coord_lower:[65535&I,65535&P]}}const jp=o.a6.mat4.create(),Ig=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e)=>{const be=u.style.light,we=be.properties.get("position"),ke=[we.x,we.y,we.z],Ne=o.a6.mat3.create();be.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Ne,-u.transform.angle),o.a6.vec3.transformMat3(ke,ke,Ne));const De=be.properties.get("color"),We=u.transform,He={u_matrix:b,u_lightpos:ke,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_vertical_gradient:+p,u_opacity:w,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:jp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:I,u_edge_radius:P,u_width_scale:F,u_flood_light_color:le,u_vertical_scale:ue,u_flood_light_intensity:ve,u_ground_shadow_factor:_e};return We.projection.name==="globe"&&(He.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],He.u_zoom_transition=J,He.u_inv_rot_matrix=oe,He.u_merc_center=Q,He.u_up_dir=We.projection.upVector(new o.bP(0,0,0),Q[0]*o.ab,Q[1]*o.ab),He.u_height_lift=$),He},Kv=(b,u,p,w)=>({u_matrix:b,u_edge_radius:u,u_width_scale:p,u_vertical_scale:w}),Rg=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve)=>{const _e=Ig(b,u,p,w,I,P,F,W,J,Q,oe,le,ue,ve,1,[0,0,0]),be={u_height_factor:-Math.pow(2,W.overscaledZ)/$.tileSize/8};return o.l(_e,la(u,$),be)},Wp=(b,u)=>({u_matrix:b,u_emissive_strength:u}),Pg=(b,u,p,w)=>o.l(Wp(b,u),la(p,w)),Jv=(b,u,p)=>({u_matrix:b,u_world:p,u_emissive_strength:u}),of=(b,u,p,w,I)=>o.l(Pg(b,u,p,w),{u_world:I}),P1=(b,u,p,w)=>{const I=o.ab/p.tileSize;return{u_matrix:b,u_camera_to_center_distance:u.getCameraToCenterDistance(w),u_extrude_scale:[u.pixelsToGLUnits[0]/I,u.pixelsToGLUnits[1]/I]}},Qv=(b,u,p=1)=>({u_matrix:b,u_color:u.toRenderColor(null),u_overlay:0,u_overlay_scale:p}),Xp=o.a6.mat4.create(),Lg=(b,u,p,w,I,P,F)=>{const W=b.transform,$=W.projection.name==="globe",J=$?o.cI(W.zoom,u.canonical)*W._pixelsPerMercatorPixel:o.ak(p,1,P),Q={u_matrix:u.projMatrix,u_extrude_scale:J,u_intensity:F,u_inv_rot_matrix:Xp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if($){Q.u_inv_rot_matrix=w,Q.u_merc_center=I,Q.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],Q.u_zoom_transition=o.a9(W.zoom);const oe=I[0]*o.ab,le=I[1]*o.ab;Q.u_up_dir=W.projection.upVector(new o.bP(0,0,0),oe,le)}return Q};function $p(b,[u,p,w,I],[P,F]){if(P===F)return[0,0,0,0];const W=255*(b-1)/(b*(F-P));return[u*W,p*W,w*W,I*W]}function bd(b,u,[p,w]){return p===w?0:.5/b+(u-p)*(b-1)/(b*(w-p))}const wd=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we,ke,Ne,De)=>({u_matrix:b,u_normalize_matrix:u,u_globe_matrix:p,u_merc_matrix:w,u_grid_matrix:I,u_tl_parent:P,u_scale_parent:J,u_fade_t:Q.mix,u_opacity:Q.opacity*oe.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:oe.paint.get("raster-brightness-min"),u_brightness_high:oe.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(oe.paint.get("raster-saturation")),u_contrast_factor:o.cK(oe.paint.get("raster-contrast")),u_spin_weights:Dg(oe.paint.get("raster-hue-rotate")),u_perspective_transform:le,u_raster_elevation:ue,u_zoom_transition:F,u_merc_center:W,u_cutoff_params:$,u_colorization_mix:$p(o.cL,_e,we),u_colorization_offset:bd(o.cL,be,we),u_color_ramp:ve,u_texture_offset:[Ne/(ke+2*Ne),ke/(ke+2*Ne)],u_texture_res:[ke+2*Ne,ke+2*Ne],u_emissive_strength:De});function Dg(b){b*=Math.PI/180;const u=Math.sin(b),p=Math.cos(b);return[(2*p+1)/3,(-Math.sqrt(3)*u-p+1)/3,(Math.sqrt(3)*u-p+1)/3]}const fl=.05,e_=(b,u,p,w,I,P,F,W,$,J,Q,oe)=>({u_matrix:b,u_normalize_matrix:u,u_globe_matrix:p,u_merc_matrix:w,u_grid_matrix:I,u_tl_parent:P,u_scale_parent:J,u_fade_t:Q.mix,u_opacity:Q.opacity,u_image0:0,u_image1:1,u_raster_elevation:oe,u_zoom_transition:F,u_merc_center:W,u_cutoff_params:$}),Sd=(b,u,p,w,I,P,F,W,$,J)=>({u_particle_texture:b,u_particle_texture_side_len:u,u_tile_offset:p,u_velocity:w,u_color_ramp:P,u_velocity_res:I,u_max_speed:F,u_uv_offset:W,u_data_scale:[255*$[0],255*$[1]],u_data_offset:J,u_particle_pos_scale:1.1,u_particle_pos_offset:[fl,fl]}),qp=(b,u,p,w,I,P,F,W,$,J)=>({u_particle_texture:b,u_particle_texture_side_len:u,u_velocity:p,u_velocity_res:w,u_max_speed:I,u_speed_factor:P,u_reset_rate:F,u_rand_seed:Math.random(),u_uv_offset:W,u_data_scale:[255*$[0],255*$[1]],u_data_offset:J,u_particle_pos_scale:1.1,u_particle_pos_offset:[fl,fl]}),Cl=o.a6.mat4.create(),t_=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we,ke,Ne,De)=>{const We=I.transform,He={u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:We.getCameraToCenterDistance(ke),u_rotate_symbol:+p,u_aspect_ratio:We.width/We.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:F,u_coord_matrix:W,u_is_text:+J,u_elevation_from_sea:$?1:0,u_pitch_with_map:+w,u_texsize:Q,u_texsize_icon:oe,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Cl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Cl,u_up_vector:[0,-1,0],u_color_adj_mat:Ne,u_icon_transition:De||0,u_gamma_scale:w?I.transform.getCameraToCenterDistance(ke)*Math.cos(I.terrain?0:I.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+le};return ke.name==="globe"&&(He.u_tile_id=[ue.canonical.x,ue.canonical.y,1<<ue.canonical.z],He.u_zoom_transition=ve,He.u_inv_rot_matrix=be,He.u_merc_center=_e,He.u_camera_forward=We._camera.forward(),He.u_ecef_origin=o.cM(We.globeMatrix,ue.toUnwrapped()),He.u_tile_matrix=Float32Array.from(We.globeMatrix),He.u_up_vector=we),He},L1=(b,u,p,w)=>({u_matrix:b,u_emissive_strength:u,u_opacity:p,u_color:w}),Uc=(b,u,p,w,I,P,F,W,$)=>o.l(function(J,Q,oe,le,ue,ve){const{width:_e,height:be}=le.imageManager.getPixelSize(Q),we=Math.pow(2,ve.tileID.overscaledZ),ke=ve.tileSize*Math.pow(2,le.transform.tileZoom)/we,Ne=ke*(ve.tileID.canonical.x+ve.tileID.wrap*we),De=ke*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:oe.tl,u_pattern_br:oe.br,u_texsize:[_e,be],u_pattern_size:oe.displaySize,u_pattern_units_to_pixels:ue?[le.transform.width,-1*le.transform.height]:[1/o.ak(ve,1,le.transform.tileZoom),1/o.ak(ve,1,le.transform.tileZoom)],u_pixel_coord_upper:[Ne>>16,De>>16],u_pixel_coord_lower:[65535&Ne,65535&De]}}(0,P,F,w,W,$),{u_matrix:b,u_emissive_strength:u,u_opacity:p}),El=new Float32Array(o.a6.mat4.identity([])),Fn=(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue=[0,0,0],ve)=>{const _e=I.style.light,be=_e.properties.get("position"),we=[-be.x,-be.y,be.z],ke=o.a6.mat3.create();_e.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(ke,-I.transform.angle),o.a6.vec3.transformMat3(we,we,ke));const Ne=Q.alphaMode==="MASK",De=_e.properties.get("color").toRenderColor(null),We=le.paint.get("model-ambient-occlusion-intensity"),He=le.paint.get("model-color").constantOr(o.bz.white).toRenderColor(null),et=le.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:b,u_lighting_matrix:u,u_normal_matrix:p,u_node_matrix:w||El,u_lightpos:we,u_lightintensity:_e.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_camera_pos:ue,u_opacity:P,u_baseTextureIsAlpha:0,u_alphaMask:+Ne,u_alphaCutoff:Q.alphaCutoff,u_baseColorFactor:[F.r,F.g,F.b,F.a],u_emissiveFactor:[W[0],W[1],W[2],1],u_metallicFactor:$,u_roughnessFactor:J,u_baseColorTexture:ao.BaseColor,u_metallicRoughnessTexture:ao.MetallicRoughness,u_normalTexture:ao.Normal,u_occlusionTexture:ao.Occlusion,u_emissionTexture:ao.Emission,u_lutTexture:ao.LUT,u_color_mix:[He.r,He.g,He.b,et],u_aoIntensity:We,u_emissive_strength:oe,u_occlusionTextureTransform:ve||[0,0,0,0]}},sr=(b,u=El,p=El)=>({u_matrix:b,u_instance:u,u_node_matrix:p}),Zp={fillExtrusion:b=>({u_matrix:new o.bF(b),u_lightpos:new o.bH(b),u_lightintensity:new o.bI(b),u_lightcolor:new o.bH(b),u_vertical_gradient:new o.bI(b),u_opacity:new o.bI(b),u_edge_radius:new o.bI(b),u_width_scale:new o.bI(b),u_ao:new o.bG(b),u_tile_id:new o.bH(b),u_zoom_transition:new o.bI(b),u_inv_rot_matrix:new o.bF(b),u_merc_center:new o.bG(b),u_up_dir:new o.bH(b),u_height_lift:new o.bI(b),u_flood_light_color:new o.bH(b),u_vertical_scale:new o.bI(b),u_flood_light_intensity:new o.bI(b),u_ground_shadow_factor:new o.bH(b)}),fillExtrusionDepth:b=>({u_matrix:new o.bF(b),u_edge_radius:new o.bI(b),u_width_scale:new o.bI(b),u_vertical_scale:new o.bI(b)}),fillExtrusionPattern:b=>({u_matrix:new o.bF(b),u_lightpos:new o.bH(b),u_lightintensity:new o.bI(b),u_lightcolor:new o.bH(b),u_vertical_gradient:new o.bI(b),u_height_factor:new o.bI(b),u_edge_radius:new o.bI(b),u_width_scale:new o.bI(b),u_ao:new o.bG(b),u_tile_id:new o.bH(b),u_zoom_transition:new o.bI(b),u_inv_rot_matrix:new o.bF(b),u_merc_center:new o.bG(b),u_up_dir:new o.bH(b),u_height_lift:new o.bI(b),u_image:new o.bJ(b),u_texsize:new o.bG(b),u_pixel_coord_upper:new o.bG(b),u_pixel_coord_lower:new o.bG(b),u_tile_units_to_pixels:new o.bI(b),u_opacity:new o.bI(b)}),fillExtrusionGroundEffect:b=>({u_matrix:new o.bF(b),u_opacity:new o.bI(b),u_ao_pass:new o.bI(b),u_meter_to_tile:new o.bI(b),u_ao:new o.bG(b),u_flood_light_intensity:new o.bI(b),u_flood_light_color:new o.bH(b),u_attenuation:new o.bI(b),u_edge_radius:new o.bI(b),u_fb:new o.bJ(b),u_fb_size:new o.bI(b),u_dynamic_offset:new o.bI(b)}),fill:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b)}),fillPattern:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b),u_image:new o.bJ(b),u_texsize:new o.bG(b),u_pixel_coord_upper:new o.bG(b),u_pixel_coord_lower:new o.bG(b),u_tile_units_to_pixels:new o.bI(b)}),fillOutline:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b),u_world:new o.bG(b)}),fillOutlinePattern:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b),u_world:new o.bG(b),u_image:new o.bJ(b),u_texsize:new o.bG(b),u_pixel_coord_upper:new o.bG(b),u_pixel_coord_lower:new o.bG(b),u_tile_units_to_pixels:new o.bI(b)}),circle:o.cN,collisionBox:b=>({u_matrix:new o.bF(b),u_camera_to_center_distance:new o.bI(b),u_extrude_scale:new o.bG(b)}),collisionCircle:b=>({u_matrix:new o.bF(b),u_inv_matrix:new o.bF(b),u_camera_to_center_distance:new o.bI(b),u_viewport_size:new o.bG(b)}),debug:b=>({u_color:new o.cu(b),u_matrix:new o.bF(b),u_overlay:new o.bJ(b),u_overlay_scale:new o.bI(b)}),clippingMask:b=>({u_matrix:new o.bF(b)}),heatmap:b=>({u_extrude_scale:new o.bI(b),u_intensity:new o.bI(b),u_matrix:new o.bF(b),u_inv_rot_matrix:new o.bF(b),u_merc_center:new o.bG(b),u_tile_id:new o.bH(b),u_zoom_transition:new o.bI(b),u_up_dir:new o.bH(b)}),heatmapTexture:b=>({u_image:new o.bJ(b),u_color_ramp:new o.bJ(b),u_opacity:new o.bI(b)}),hillshade:b=>({u_matrix:new o.bF(b),u_image:new o.bJ(b),u_latrange:new o.bG(b),u_light:new o.bG(b),u_shadow:new o.cu(b),u_highlight:new o.cu(b),u_emissive_strength:new o.bI(b),u_accent:new o.cu(b)}),hillshadePrepare:b=>({u_matrix:new o.bF(b),u_image:new o.bJ(b),u_dimension:new o.bG(b),u_zoom:new o.bI(b)}),line:o.cO,linePattern:o.cP,raster:b=>({u_matrix:new o.bF(b),u_normalize_matrix:new o.bF(b),u_globe_matrix:new o.bF(b),u_merc_matrix:new o.bF(b),u_grid_matrix:new o.cv(b),u_tl_parent:new o.bG(b),u_scale_parent:new o.bI(b),u_fade_t:new o.bI(b),u_opacity:new o.bI(b),u_image0:new o.bJ(b),u_image1:new o.bJ(b),u_brightness_low:new o.bI(b),u_brightness_high:new o.bI(b),u_saturation_factor:new o.bI(b),u_contrast_factor:new o.bI(b),u_spin_weights:new o.bH(b),u_perspective_transform:new o.bG(b),u_raster_elevation:new o.bI(b),u_zoom_transition:new o.bI(b),u_merc_center:new o.bG(b),u_cutoff_params:new o.c6(b),u_colorization_mix:new o.c6(b),u_colorization_offset:new o.bI(b),u_color_ramp:new o.bJ(b),u_texture_offset:new o.bG(b),u_texture_res:new o.bG(b),u_emissive_strength:new o.bI(b)}),rasterParticle:b=>({u_matrix:new o.bF(b),u_normalize_matrix:new o.bF(b),u_globe_matrix:new o.bF(b),u_merc_matrix:new o.bF(b),u_grid_matrix:new o.cv(b),u_tl_parent:new o.bG(b),u_scale_parent:new o.bI(b),u_fade_t:new o.bI(b),u_opacity:new o.bI(b),u_image0:new o.bJ(b),u_image1:new o.bJ(b),u_raster_elevation:new o.bI(b),u_zoom_transition:new o.bI(b),u_merc_center:new o.bG(b),u_cutoff_params:new o.c6(b)}),rasterParticleTexture:b=>({u_texture:new o.bJ(b),u_opacity:new o.bI(b)}),rasterParticleDraw:b=>({u_particle_texture:new o.bJ(b),u_particle_texture_side_len:new o.bI(b),u_tile_offset:new o.bG(b),u_velocity:new o.bJ(b),u_color_ramp:new o.bJ(b),u_velocity_res:new o.bG(b),u_max_speed:new o.bI(b),u_uv_offset:new o.bG(b),u_data_scale:new o.bG(b),u_data_offset:new o.bI(b),u_particle_pos_scale:new o.bI(b),u_particle_pos_offset:new o.bG(b)}),rasterParticleUpdate:b=>({u_particle_texture:new o.bJ(b),u_particle_texture_side_len:new o.bI(b),u_velocity:new o.bJ(b),u_velocity_res:new o.bG(b),u_max_speed:new o.bI(b),u_speed_factor:new o.bI(b),u_reset_rate:new o.bI(b),u_rand_seed:new o.bI(b),u_uv_offset:new o.bG(b),u_data_scale:new o.bG(b),u_data_offset:new o.bI(b),u_particle_pos_scale:new o.bI(b),u_particle_pos_offset:new o.bG(b)}),symbol:b=>({u_is_size_zoom_constant:new o.bJ(b),u_is_size_feature_constant:new o.bJ(b),u_size_t:new o.bI(b),u_size:new o.bI(b),u_camera_to_center_distance:new o.bI(b),u_rotate_symbol:new o.bJ(b),u_aspect_ratio:new o.bI(b),u_fade_change:new o.bI(b),u_matrix:new o.bF(b),u_label_plane_matrix:new o.bF(b),u_coord_matrix:new o.bF(b),u_is_text:new o.bJ(b),u_elevation_from_sea:new o.bJ(b),u_pitch_with_map:new o.bJ(b),u_texsize:new o.bG(b),u_texsize_icon:new o.bG(b),u_texture:new o.bJ(b),u_texture_icon:new o.bJ(b),u_gamma_scale:new o.bI(b),u_device_pixel_ratio:new o.bI(b),u_tile_id:new o.bH(b),u_zoom_transition:new o.bI(b),u_inv_rot_matrix:new o.bF(b),u_merc_center:new o.bG(b),u_camera_forward:new o.bH(b),u_tile_matrix:new o.bF(b),u_up_vector:new o.bH(b),u_ecef_origin:new o.bH(b),u_is_halo:new o.bJ(b),u_icon_transition:new o.bI(b),u_color_adj_mat:new o.bF(b)}),background:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b),u_opacity:new o.bI(b),u_color:new o.cu(b)}),backgroundPattern:b=>({u_matrix:new o.bF(b),u_emissive_strength:new o.bI(b),u_opacity:new o.bI(b),u_image:new o.bJ(b),u_pattern_tl:new o.bG(b),u_pattern_br:new o.bG(b),u_texsize:new o.bG(b),u_pattern_size:new o.bG(b),u_pixel_coord_upper:new o.bG(b),u_pixel_coord_lower:new o.bG(b),u_pattern_units_to_pixels:new o.bG(b)}),terrainRaster:b=>({u_matrix:new o.bF(b),u_image0:new o.bJ(b),u_skirt_height:new o.bI(b),u_ground_shadow_factor:new o.bH(b)}),skybox:b=>({u_matrix:new o.bF(b),u_sun_direction:new o.bH(b),u_cubemap:new o.bJ(b),u_opacity:new o.bI(b),u_temporal_offset:new o.bI(b)}),skyboxGradient:b=>({u_matrix:new o.bF(b),u_color_ramp:new o.bJ(b),u_center_direction:new o.bH(b),u_radius:new o.bI(b),u_opacity:new o.bI(b),u_temporal_offset:new o.bI(b)}),skyboxCapture:b=>({u_matrix_3f:new o.cv(b),u_sun_direction:new o.bH(b),u_sun_intensity:new o.bI(b),u_color_tint_r:new o.c6(b),u_color_tint_m:new o.c6(b),u_luminance:new o.bI(b)}),globeRaster:b=>({u_proj_matrix:new o.bF(b),u_globe_matrix:new o.bF(b),u_normalize_matrix:new o.bF(b),u_merc_matrix:new o.bF(b),u_zoom_transition:new o.bI(b),u_merc_center:new o.bG(b),u_image0:new o.bJ(b),u_grid_matrix:new o.cv(b),u_skirt_height:new o.bI(b),u_far_z_cutoff:new o.bI(b),u_frustum_tl:new o.bH(b),u_frustum_tr:new o.bH(b),u_frustum_br:new o.bH(b),u_frustum_bl:new o.bH(b),u_globe_pos:new o.bH(b),u_globe_radius:new o.bI(b),u_viewport:new o.bG(b)}),globeAtmosphere:b=>({u_frustum_tl:new o.bH(b),u_frustum_tr:new o.bH(b),u_frustum_br:new o.bH(b),u_frustum_bl:new o.bH(b),u_horizon:new o.bI(b),u_transition:new o.bI(b),u_fadeout_range:new o.bI(b),u_color:new o.c6(b),u_high_color:new o.c6(b),u_space_color:new o.c6(b),u_temporal_offset:new o.bI(b),u_horizon_angle:new o.bI(b)}),model:b=>({u_matrix:new o.bF(b),u_lighting_matrix:new o.bF(b),u_normal_matrix:new o.bF(b),u_node_matrix:new o.bF(b),u_lightpos:new o.bH(b),u_lightintensity:new o.bI(b),u_lightcolor:new o.bH(b),u_camera_pos:new o.bH(b),u_opacity:new o.bI(b),u_baseColorFactor:new o.c6(b),u_emissiveFactor:new o.c6(b),u_metallicFactor:new o.bI(b),u_roughnessFactor:new o.bI(b),u_baseTextureIsAlpha:new o.bJ(b),u_alphaMask:new o.bJ(b),u_alphaCutoff:new o.bI(b),u_baseColorTexture:new o.bJ(b),u_metallicRoughnessTexture:new o.bJ(b),u_normalTexture:new o.bJ(b),u_occlusionTexture:new o.bJ(b),u_emissionTexture:new o.bJ(b),u_lutTexture:new o.bJ(b),u_color_mix:new o.c6(b),u_aoIntensity:new o.bI(b),u_emissive_strength:new o.bI(b),u_occlusionTextureTransform:new o.c6(b)}),modelDepth:b=>({u_matrix:new o.bF(b),u_instance:new o.bF(b),u_node_matrix:new o.bF(b)}),groundShadow:b=>({u_matrix:new o.bF(b),u_ground_shadow_factor:new o.bH(b)}),stars:b=>({u_matrix:new o.bF(b),u_up:new o.bH(b),u_right:new o.bH(b),u_intensity_multiplier:new o.bI(b)}),occlusion:b=>({u_matrix:new o.bF(b),u_anchorPos:new o.bH(b),u_screenSizePx:new o.bG(b),u_occluderSizePx:new o.bG(b),u_color:new o.c6(b)})};class ya{constructor(u,p,w,I){this.id=ya.uniqueIdxCounter,ya.uniqueIdxCounter++,this.context=u;const P=u.gl;this.buffer=P.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||I||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){this.id=ya.uniqueIdxCounter,ya.uniqueIdxCounter++;const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ya.uniqueIdxCounter=0;const Ku={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yn{constructor(u,p,w,I,P,F){this.length=p.length,this.attributes=w,this.itemSize=p.bytesPerElement,this.dynamicDraw=I,this.instanceCount=F,this.context=u;const W=u.gl;this.buffer=W.createBuffer(),u.bindVertexBuffer.set(this.buffer),W.bufferData(W.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?W.DYNAMIC_DRAW:W.STATIC_DRAW),this.dynamicDraw||P||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,p){for(let w=0;w<this.attributes.length;w++){const I=p.attributes[this.attributes[w].name];I!==void 0&&u.enableVertexAttribArray(I)}}setVertexAttribPointers(u,p,w){for(let I=0;I<this.attributes.length;I++){const P=this.attributes[I],F=p.attributes[P.name];F!==void 0&&u.vertexAttribPointer(F,P.components,u[Ku[P.type]],!1,this.itemSize,P.offset+this.itemSize*(w||0))}}setVertexAttribDivisor(u,p,w){for(let I=0;I<this.attributes.length;I++){const P=p.attributes[this.attributes[I].name];P!==void 0&&this.instanceCount&&this.instanceCount>0&&u.vertexAttribDivisor(P,w)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Gc{constructor(u,p,w,I,P){this.context=u,this.width=p,this.height=w;const F=this.framebuffer=u.gl.createFramebuffer();I&&(this.colorAttachment=new Tg(u,F)),P&&(this.depthAttachmentType=P,this.depthAttachment=P==="renderbuffer"?new Vp(u,F):new Mg(u,F))}destroy(){const u=this.context.gl;if(this.colorAttachment){const p=this.colorAttachment.get();p&&u.deleteTexture(p)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const p=this.depthAttachment.get();p&&u.deleteRenderbuffer(p)}else{const p=this.depthAttachment.get();p&&u.deleteTexture(p)}u.deleteFramebuffer(this.framebuffer)}}class Yp{constructor(u,p){this.gl=u,this.clearColor=new vd(this),this.clearDepth=new zv(this),this.clearStencil=new mg(this),this.colorMask=new Fp(this),this.depthMask=new _d(this),this.stencilMask=new Uv(this),this.stencilFunc=new Gv(this),this.stencilOp=new gg(this),this.stencilTest=new zc(this),this.depthRange=new Vv(this),this.depthTest=new vg(this),this.depthFunc=new _g(this),this.blend=new Hv(this),this.blendFunc=new ef(this),this.blendColor=new yg(this),this.blendEquation=new xg(this),this.cullFace=new bg(this),this.cullFaceSide=new jv(this),this.frontFace=new wg(this),this.program=new E1(this),this.activeTexture=new yd(this),this.viewport=new Np(this),this.bindFramebuffer=new Wv(this),this.bindRenderbuffer=new hl(this),this.bindTexture=new Xv(this),this.bindVertexBuffer=new zp(this),this.bindElementBuffer=new Up(this),this.bindVertexArrayOES=new Sg(this),this.pixelStoreUnpack=new Ag(this),this.pixelStoreUnpackPremultiplyAlpha=new tf(this),this.pixelStoreUnpackFlipY=new $v(this),this.options=p?{...p}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=u.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),this.maxPointSize=u.getParameter(u.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,p,w){return new ya(this,u,p,w)}createVertexBuffer(u,p,w,I,P){return new Yn(this,u,p,w,I,P)}createRenderbuffer(u,p,w){const I=this.gl,P=I.createRenderbuffer();return this.bindRenderbuffer.set(P),I.renderbufferStorage(I.RENDERBUFFER,u,p,w),this.bindRenderbuffer.set(null),P}createFramebuffer(u,p,w,I){return new Gc(this,u,p,w,I)}clear({color:u,depth:p,stencil:w,colorMask:I}){const P=this.gl;let F=0;u&&(F|=P.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set(I||[!0,!0,!0,!0])),p!==void 0&&(F|=P.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),w!==void 0&&(F|=P.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),P.clear(F)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){o.bh(u.blendFunction,Mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor),u.blendEquation?this.blendEquation.set(u.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(u.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Ad;function Kp(b,u,p,w,I,P,F){const W=b.context,$=W.gl,J=b.transform,Q=b.getOrCreateProgram("collisionBox"),oe=[];let le=0,ue=0;for(let De=0;De<w.length;De++){const We=w[De],He=u.getTile(We),et=He.getBucket(p);if(!et)continue;const Ke=Hh(We,et,J);let tt=Ke;I[0]===0&&I[1]===0||(tt=b.translatePosMatrix(Ke,He,I,P));const ut=F?et.textCollisionBox:et.iconCollisionBox,st=et.collisionCircleArray;if(st.length>0){const rt=o.a6.mat4.create(),xt=tt;o.a6.mat4.mul(rt,et.placementInvProjMatrix,J.glCoordMatrix),o.a6.mat4.mul(rt,rt,et.placementViewportMatrix),oe.push({circleArray:st,circleOffset:ue,transform:xt,invTransform:rt,projection:et.getProjection()}),le+=st.length/4,ue=le}ut&&(b.terrain&&b.terrain.setupElevationDraw(He,Q),Q.draw(b,$.LINES,$n.disabled,pr.disabled,b.colorModeForRenderPass(),_r.disabled,P1(tt,J,He,et.getProjection()),p.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,null,J.zoom,null,[ut.collisionVertexBuffer,ut.collisionVertexBufferExt]))}if(!F||!oe.length)return;const ve=b.getOrCreateProgram("collisionCircle"),_e=new o.cQ;_e.resize(4*le),_e._trim();let be=0;for(const De of oe)for(let We=0;We<De.circleArray.length/4;We++){const He=4*We,et=De.circleArray[He+0],Ke=De.circleArray[He+1],tt=De.circleArray[He+2],ut=De.circleArray[He+3];_e.emplace(be++,et,Ke,tt,ut,0),_e.emplace(be++,et,Ke,tt,ut,1),_e.emplace(be++,et,Ke,tt,ut,2),_e.emplace(be++,et,Ke,tt,ut,3)}(!Ad||Ad.length<2*le)&&(Ad=function(De){const We=2*De,He=new o.aO;He.resize(We),He._trim();for(let et=0;et<We;et++){const Ke=6*et;He.uint16[Ke+0]=4*et+0,He.uint16[Ke+1]=4*et+1,He.uint16[Ke+2]=4*et+2,He.uint16[Ke+3]=4*et+2,He.uint16[Ke+4]=4*et+3,He.uint16[Ke+5]=4*et+0}return He}(le));const we=W.createIndexBuffer(Ad,!0),ke=W.createVertexBuffer(_e,o.cR.members,!0);for(const De of oe){const We={u_matrix:De.transform,u_inv_matrix:De.invTransform,u_camera_to_center_distance:(Ne=J).getCameraToCenterDistance(De.projection),u_viewport_size:[Ne.width,Ne.height]};ve.draw(b,$.TRIANGLES,$n.disabled,pr.disabled,b.colorModeForRenderPass(),_r.disabled,We,p.id,ke,we,o.b1.simpleSegment(0,2*De.circleOffset,De.circleArray.length,De.circleArray.length/2),null,J.zoom)}var Ne;ke.destroy(),we.destroy()}const Td=o.a6.mat4.create();function Bg(b){const u=b._camera.getWorldToCamera(b.worldSize,1),p=o.a6.mat4.multiply([],u,b.globeMatrix);o.a6.mat4.invert(p,p);const w=[0,0,0],I=[0,1,0,0];return o.a6.vec4.transformMat4(I,I,p),w[0]=I[0],w[1]=I[1],w[2]=I[2],o.a6.vec3.normalize(w,w),w}function D1({width:b,height:u,anchor:p,textOffset:w,textScale:I},P){const{horizontalAlign:F,verticalAlign:W}=o.bx(p),$=-(F-.5)*b,J=-(W-.5)*u,Q=o.bw(p,w);return new o.P(($/I+Q[0])*P,(J/I+Q[1])*P)}function B1(b,u,p,w,I,P,F,W,$,J,Q){const oe=b.text.placedSymbolArray,le=b.text.dynamicLayoutVertexArray,ue=b.icon.dynamicLayoutVertexArray,ve={},_e=b.getProjection(),be=Oc(W,_e,P),we=P.elevation,ke=_e.upVectorScale(W.canonical,P.center.lat,P.worldSize).metersToTile;le.clear();for(let Ne=0;Ne<oe.length;Ne++){const De=oe.get(Ne),{tileAnchorX:We,tileAnchorY:He,numGlyphs:et}=De,Ke=De.hidden||!De.crossTileID||b.allowVerticalPlacement&&!De.placedOrientation?null:w[De.crossTileID];if(Ke){let tt=0,ut=0,st=0;if(we){const Gt=we?we.getAtTileOffset(W,We,He):0,[fn,pn,qt]=_e.upVector(W.canonical,We,He);tt=Gt*fn*ke,ut=Gt*pn*ke,st=Gt*qt*ke}let[rt,xt,Ft,Zt]=ga(De.projectedAnchorX+tt,De.projectedAnchorY+ut,De.projectedAnchorZ+st,p?be:F);const kt=ni(P.getCameraToCenterDistance(_e),Zt);let hn=I.evaluateSizeForFeature(b.textSizeData,J,De)*kt/o.bq;p&&(hn*=b.tilePixelRatio/$);const bt=D1(Ke,hn);p?({x:rt,y:xt,z:Ft}=_e.projectTilePoint(We+bt.x,He+bt.y,W.canonical),[rt,xt,Ft]=ga(rt+tt,xt+ut,Ft+st,F)):(u&&bt._rotate(-P.angle),rt+=bt.x,xt+=bt.y,Ft=0);const Wt=b.allowVerticalPlacement&&De.placedOrientation===o.bk.vertical?Math.PI/2:0;for(let Gt=0;Gt<et;Gt++)o.bn(le,rt,xt,Ft,Wt);Q&&De.associatedIconIndex>=0&&(ve[De.associatedIconIndex]={x:rt,y:xt,z:Ft,angle:Wt})}else ll(et,le)}if(Q){ue.clear();const Ne=b.icon.placedSymbolArray;for(let De=0;De<Ne.length;De++){const We=Ne.get(De),{numGlyphs:He}=We,et=ve[De];if(We.hidden||!et)ll(He,ue);else{const{x:Ke,y:tt,z:ut,angle:st}=et;for(let rt=0;rt<He;rt++)o.bn(ue,Ke,tt,ut,st)}}b.icon.dynamicLayoutVertexBuffer.updateData(ue)}b.text.dynamicLayoutVertexBuffer.updateData(le)}function Md(b,u,p,w,I,P,F={}){const W=p.paint.get("icon-translate"),$=p.paint.get("text-translate"),J=p.paint.get("icon-translate-anchor"),Q=p.paint.get("text-translate-anchor"),oe=p.layout.get("icon-rotation-alignment"),le=p.layout.get("text-rotation-alignment"),ue=p.layout.get("icon-pitch-alignment"),ve=p.layout.get("text-pitch-alignment"),_e=p.layout.get("icon-keep-upright"),be=p.layout.get("text-keep-upright"),we=p.paint.get("icon-color-saturation"),ke=p.paint.get("icon-color-contrast"),Ne=p.paint.get("icon-color-brightness-min"),De=p.paint.get("icon-color-brightness-max"),We=p.paint.get("symbol-elevation-reference")==="sea",He=p.paint.get("text-occlusion-opacity").constantOr(0),et=b.context,Ke=et.gl,tt=b.transform,ut=oe==="map",st=le==="map",rt=ue==="map",xt=ve==="map",Ft=p.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Zt=!1;const kt=b.depthModeForSublayer(0,$n.ReadOnly),hn=[o.am(tt.center.lng),o.at(tt.center.lat)],bt=p.layout.get("text-variable-anchor"),Wt=tt.projection.name==="globe",Gt=[],fn=[0,-1,0];for(const pn of w){const qt=u.getTile(pn),en=qt.getBucket(p);if(!en||en.projection.name==="mercator"&&Wt||en.fullyClipped)continue;const er=en.projection.name==="globe",xn=er?o.a9(tt.zoom):0,Dn=Oc(pn,en.getProjection(),tt),yr=tt.calculatePixelsToTileUnitsMatrix(qt),qn=bt&&en.hasTextData(),ur=en.hasIconTextFit()&&qn&&en.hasIconData(),Ur=en.getProjection().createInversionMatrix(tt,pn.canonical),Br=Li=>{tt.depthOcclusionForSymbolsAndCircles&&(p.hasInitialOcclusionOpacityProperties||b.terrain)&&(Li.push("DEPTH_D24"),Li.push("DEPTH_OCCLUSION"))},Ci=()=>{const Li=ut&&p.layout.get("symbol-placement")!=="point",kr=[];Br(kr);const pi=Li||ur,Ai=p.paint.get("icon-image-cross-fade").constantOr(0);b.terrainRenderModeElevated()&&rt&&kr.push("PITCH_WITH_MAP_TERRAIN"),er&&(kr.push("PROJECTION_GLOBE_VIEW"),pi&&kr.push("PROJECTED_POS_ON_VIEWPORT")),Ai>0&&kr.push("ICON_TRANSITION"),en.icon.zOffsetVertexBuffer&&kr.push("Z_OFFSET"),we===0&&ke===0&&Ne===0&&De===1||kr.push("COLOR_ADJUSTMENT"),en.sdfIcons&&kr.push("RENDER_SDF");const Ns=en.icon.programConfigurations.get(p.id),eo=b.getOrCreateProgram("symbol",{config:Ns,defines:kr}),oi=qt.imageAtlasTexture?qt.imageAtlasTexture.size:[0,0],Fo=en.iconSizeData,Ko=o.bj(Fo,tt.zoom),No=rt||tt.pitch!==0,Yi=ei(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr),pl=Us(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr),ml=b.translatePosMatrix(pl,qt,W,J,!0),Xc=b.translatePosMatrix(Dn,qt,W,J),dc=pi?Td:Yi,Pl=ut&&!rt&&!Li;let $c=fn;!Wt&&!tt.mercatorFromTransition||ut||($c=Bg(tt));const vf=er?$c:fn,Fd=p.getColorAdjustmentMatrix(we,ke,Ne,De),ih=t_(Fo.kind,Ko,Pl,rt,b,Xc,dc,ml,We,!1,oi,[0,0],!0,pn,xn,hn,Ur,vf,en.getProjection(),Fd,Ai),$g=qt.imageAtlasTexture?qt.imageAtlasTexture:null,qg=p.layout.get("icon-size").constantOr(0)!==1||en.iconsNeedLinear,G1=en.sdfIcons||b.options.rotating||b.options.zooming||qg||No?Ke.LINEAR:Ke.NEAREST,Zg=en.sdfIcons&&p.paint.get("icon-halo-width").constantOr(1)!==0,Ki=b.terrain&&rt&&Li?o.a6.mat4.invert(o.a6.mat4.create(),Yi):Td;if(Li&&en.icon){const sm=tt.elevation,S3=sm?sm.getAtTileOffsetFunc(pn,tt.center.lat,tt.worldSize,en.getProjection()):null,wM=Zr(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr);$a(en,Dn,b,!1,wM,pl,rt,_e,S3,pn)}return{program:eo,buffers:en.icon,uniformValues:ih,atlasTexture:$g,atlasTextureIcon:null,atlasInterpolation:G1,atlasInterpolationIcon:null,isSDF:en.sdfIcons,hasHalo:Zg,tile:qt,labelPlaneMatrixInv:Ki}},zi=()=>{const Li=st&&p.layout.get("symbol-placement")!=="point",kr=[],pi=Li||bt||ur;b.terrainRenderModeElevated()&&xt&&kr.push("PITCH_WITH_MAP_TERRAIN"),er&&(kr.push("PROJECTION_GLOBE_VIEW"),pi&&kr.push("PROJECTED_POS_ON_VIEWPORT")),en.text.zOffsetVertexBuffer&&kr.push("Z_OFFSET"),en.iconsInText&&kr.push("RENDER_TEXT_AND_SYMBOL"),kr.push("RENDER_SDF"),Br(kr);const Ai=en.text.programConfigurations.get(p.id),Ns=b.getOrCreateProgram("symbol",{config:Ai,defines:kr});let eo,oi=[0,0],Fo=null;const Ko=en.textSizeData;en.iconsInText&&(oi=qt.imageAtlasTexture?qt.imageAtlasTexture.size:[0,0],Fo=qt.imageAtlasTexture?qt.imageAtlasTexture:null,eo=xt||tt.pitch!==0||b.options.rotating||b.options.zooming||Ko.kind==="composite"||Ko.kind==="camera"?Ke.LINEAR:Ke.NEAREST);const No=qt.glyphAtlasTexture?qt.glyphAtlasTexture.size:[0,0],Yi=o.bj(Ko,tt.zoom),pl=ei(Dn,qt.tileID.canonical,xt,st,tt,en.getProjection(),yr),ml=Us(Dn,qt.tileID.canonical,xt,st,tt,en.getProjection(),yr),Xc=b.translatePosMatrix(ml,qt,$,Q,!0),dc=b.translatePosMatrix(Dn,qt,$,Q),Pl=pi?Td:pl,$c=st&&!xt&&!Li;let vf=fn;!Wt&&!tt.mercatorFromTransition||st||(vf=Bg(tt));const Fd=t_(Ko.kind,Yi,$c,xt,b,dc,Pl,Xc,We,!0,No,oi,!0,pn,xn,hn,Ur,er?vf:fn,en.getProjection(),He),ih=qt.glyphAtlasTexture?qt.glyphAtlasTexture:null,$g=Ke.LINEAR,qg=p.paint.get("text-halo-width").constantOr(1)!==0,G1=b.terrain&&xt&&Li?o.a6.mat4.invert(o.a6.mat4.create(),pl):Td;if(Li&&en.text){const Zg=tt.elevation,Ki=Zg?Zg.getAtTileOffsetFunc(pn,tt.center.lat,tt.worldSize,en.getProjection()):null,sm=Zr(Dn,qt.tileID.canonical,xt,st,tt,en.getProjection(),yr);$a(en,Dn,b,!0,sm,ml,xt,be,Ki,pn)}return{program:Ns,buffers:en.text,uniformValues:Fd,atlasTexture:ih,atlasTextureIcon:Fo,atlasInterpolation:$g,atlasInterpolationIcon:eo,isSDF:!0,hasHalo:qg,tile:qt,labelPlaneMatrixInv:G1}},is=en.icon.segments.get().length,Wc=en.text.segments.get().length,Qs=is&&!F.onlyText?Ci():null,Yr=Wc&&!F.onlyIcons?zi():null,Fi=p.paint.get("icon-opacity").constantOr(1),ws=p.paint.get("text-opacity").constantOr(1);if(Ft&&en.canOverlap){Zt=!0;const Li=Fi&&!F.onlyText?en.icon.segments.get():[],kr=ws&&!F.onlyIcons?en.text.segments.get():[];for(const pi of Li)Gt.push({segments:new o.b1([pi]),sortKey:pi.sortKey,state:Qs});for(const pi of kr)Gt.push({segments:new o.b1([pi]),sortKey:pi.sortKey,state:Yr})}else F.onlyText||Gt.push({segments:Fi?en.icon.segments:new o.b1([]),sortKey:0,state:Qs}),F.onlyIcons||Gt.push({segments:ws?en.text.segments:new o.b1([]),sortKey:0,state:Yr})}Zt&&Gt.sort((pn,qt)=>pn.sortKey-qt.sortKey);for(const pn of Gt){const qt=pn.state;if(qt)if(b.terrain?b.terrain.setupElevationDraw(qt.tile,qt.program,{useDepthForOcclusion:tt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:qt.labelPlaneMatrixInv}):b.setupDepthForOcclusion(tt.depthOcclusionForSymbolsAndCircles,qt.program),et.activeTexture.set(Ke.TEXTURE0),qt.atlasTexture&&qt.atlasTexture.bind(qt.atlasInterpolation,Ke.CLAMP_TO_EDGE,!0),qt.atlasTextureIcon&&(et.activeTexture.set(Ke.TEXTURE1),qt.atlasTextureIcon&&qt.atlasTextureIcon.bind(qt.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE,!0)),b.uploadCommonLightUniforms(b.context,qt.program),qt.hasHalo){const en=qt.uniformValues;en.u_is_halo=1,af(qt.buffers,pn.segments,p,b,qt.program,kt,I,P,en,2),en.u_is_halo=0}else{if(qt.isSDF){const en=qt.uniformValues;qt.hasHalo&&(en.u_is_halo=1,af(qt.buffers,pn.segments,p,b,qt.program,kt,I,P,en,1)),en.u_is_halo=0}af(qt.buffers,pn.segments,p,b,qt.program,kt,I,P,qt.uniformValues,1)}}}function af(b,u,p,w,I,P,F,W,$,J){const Q=[b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer,b.iconTransitioningVertexBuffer,b.globeExtVertexBuffer,b.zOffsetVertexBuffer];I.draw(w,w.context.gl.TRIANGLES,P,F,W,_r.disabled,$,p.id,b.layoutVertexBuffer,b.indexBuffer,u,p.paint,w.transform.zoom,b.programConfigurations.get(p.id),Q,J)}function Cd(b,u,p,w,I,P,F){const W=b.context.gl,$=p.paint.get("fill-pattern"),J=p.is3D(),Q=J?b.stencilModeFor3D():pr.disabled,oe=$&&$.constantOr(1);let le,ue,ve,_e,be;F?(ue=oe&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",le=W.LINES):(ue=oe?"fillPattern":"fill",le=W.TRIANGLES);for(const we of w){const ke=u.getTile(we);if(oe&&!ke.patternsLoaded())continue;const Ne=ke.getBucket(p);if(!Ne)continue;b.prepareDrawTile();const De=Ne.programConfigurations.get(p.id),We=b.isTileAffectedByFog(we),He=b.getOrCreateProgram(ue,{config:De,overrideFog:We});oe&&(b.context.activeTexture.set(W.TEXTURE0),ke.imageAtlasTexture&&ke.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),De.updatePaintBuffers());const et=$.constantOr(null);if(et&&ke.imageAtlas){const ut=ke.imageAtlas.patternPositions[et.toString()];ut&&De.setConstantPatternPositions(ut)}const Ke=b.translatePosMatrix(we.projMatrix,ke,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor")),tt=p.paint.get("fill-emissive-strength");if(F){_e=Ne.indexBuffer2,be=Ne.segments2;const ut=b.terrain&&b.terrain.renderingToTexture?b.terrain.drapeBufferSize:[W.drawingBufferWidth,W.drawingBufferHeight];ve=ue==="fillOutlinePattern"&&oe?of(Ke,tt,b,ke,ut):Jv(Ke,tt,ut)}else _e=Ne.indexBuffer,be=Ne.segments,ve=oe?Pg(Ke,tt,b,ke):Wp(Ke,tt);b.uploadCommonUniforms(b.context,He,we.toUnwrapped()),He.draw(b,le,I,J?Q:b.stencilModeForClipping(we),P,_r.disabled,ve,p.id,Ne.layoutVertexBuffer,_e,be,p.paint,b.transform.zoom,De,void 0)}}function lf(b,u,p,w,I,P,F,W){p.resetLayerRenderingStats(b);const $=b.context,J=$.gl,Q=b.transform,oe=p.paint.get("fill-extrusion-pattern"),le=oe.constantOr(1),ue=p.paint.get("fill-extrusion-opacity"),ve=b.style.enable3dLights(),_e=p.paint.get(ve&&!le?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],we=p.layout.get("fill-extrusion-edge-radius"),ke=we>0&&!p.paint.get("fill-extrusion-rounded-roof"),Ne=ke?0:we,De=Q.projection.name==="globe"?o.c_():0,We=Q.projection.name==="globe",He=We?o.a9(Q.zoom):0,et=[o.am(Q.center.lng),o.at(Q.center.lat)],Ke=p.paint.get("fill-extrusion-flood-light-color").toRenderColor(p.lut).toArray01().slice(0,3),tt=p.paint.get("fill-extrusion-flood-light-intensity"),ut=p.paint.get("fill-extrusion-vertical-scale"),st=p.paint.get("fill-extrusion-line-width").constantOr(1)!==0,rt=nc(b,p.paint.get("fill-extrusion-cutoff-fade-range")),xt=[];let Ft;We&&xt.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&xt.push("FAUX_AO"),ke&&xt.push("ZERO_ROOF_RADIUS"),W&&xt.push("HAS_CENTROID"),tt>0&&xt.push("FLOOD_LIGHT"),rt.shouldRenderCutoff&&xt.push("RENDER_CUTOFF"),st&&xt.push("RENDER_WALL_MODE");const Zt=b.renderPass==="shadow",kt=b.shadowRenderer,hn=Zt&&!!kt;b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!0);let bt=[0,0,0];if(kt){const fn=b.style.directionalLight,pn=b.style.ambientLight;fn&&pn&&(bt=Lp(b.style,fn,pn)),Ft=xt.concat(["SHADOWS_SINGLE_CASCADE"])}const Wt=hn?"fillExtrusionDepth":le?"fillExtrusionPattern":"fillExtrusion",Gt=p.getLayerRenderingStats();for(const fn of w){const pn=u.getTile(fn),qt=pn.getBucket(p);if(!qt||qt.projection.name!==Q.projection.name)continue;let en=!1;kt&&(en=kt.getMaxCascadeForTile(fn.toUnwrapped())===0);const er=b.isTileAffectedByFog(fn),xn=qt.programConfigurations.get(p.id),Dn=b.getOrCreateProgram(Wt,{config:xn,defines:en?Ft:xt,overrideFog:er});if(b.terrain&&b.terrain.setupElevationDraw(pn,Dn,{useMeterToDem:!0}),!qt.centroidVertexBuffer){const zi=Dn.attributes.a_centroid_pos;zi!==void 0&&J.vertexAttrib2f(zi,0,0)}!Zt&&kt&&kt.setupShadows(pn.tileID.toUnwrapped(),Dn,"vector-tile",pn.tileID.overscaledZ),le&&(b.context.activeTexture.set(J.TEXTURE0),pn.imageAtlasTexture&&pn.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),xn.updatePaintBuffers());const yr=oe.constantOr(null);if(yr&&pn.imageAtlas){const zi=pn.imageAtlas.patternPositions[yr.toString()];zi&&xn.setConstantPatternPositions(zi)}const qn=p.paint.get("fill-extrusion-vertical-gradient"),ur=1/qt.tileToMeter;let Ur;if(Zt&&kt){if(Og(pn.tileID,qt,b))continue;const zi=kt.calculateShadowPassMatrixFromTile(pn.tileID.toUnwrapped());Ur=Kv(zi,Ne,ur,ut)}else{const zi=b.translatePosMatrix(fn.expandedProjMatrix,pn,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),is=Q.projection.createInversionMatrix(Q,fn.canonical);Ur=le?Rg(zi,b,qn,ue,be,Ne,ur,fn,pn,De,He,et,is,Ke,ut):Ig(zi,b,qn,ue,be,Ne,ur,fn,De,He,et,is,Ke,ut,tt,bt)}b.uploadCommonUniforms($,Dn,fn.toUnwrapped(),null,rt);let Br=qt.segments;if(Q.projection.name==="mercator"&&!Zt&&(Br=qt.getVisibleSegments(pn.tileID,b.terrain,b.transform.getFrustum(0)),!Br.get().length))continue;if(Gt)if(Zt)for(const zi of Br.get())Gt.numRenderedVerticesInShadowPass+=zi.primitiveLength;else for(const zi of Br.get())Gt.numRenderedVerticesInTransparentPass+=zi.primitiveLength;const Ci=[];(b.terrain||W)&&Ci.push(qt.centroidVertexBuffer),We&&Ci.push(qt.layoutVertexExtBuffer),st&&Ci.push(qt.wallVertexBuffer),Dn.draw(b,$.gl.TRIANGLES,I,P,F,_r.backCCW,Ur,p.id,qt.layoutVertexBuffer,qt.indexBuffer,Br,p.paint,b.transform.zoom,xn,Ci)}b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!1)}function lo(b,u,p,w,I,P,F,W,$,J,Q,oe,le,ue,ve,_e,be,we,ke){const Ne=b.context,De=Ne.gl,We=b.transform,He=b.transform.zoom,et=[],Ke=nc(b,p.paint.get("fill-extrusion-cutoff-fade-range"));J==="clear"?(et.push("CLEAR_SUBPASS"),ke&&(et.push("CLEAR_FROM_TEXTURE"),Ne.activeTexture.set(De.TEXTURE0),ke.bind(De.LINEAR,De.CLAMP_TO_EDGE))):J==="sdf"&&et.push("SDF_SUBPASS"),be&&et.push("HAS_CENTROID"),Ke.shouldRenderCutoff&&et.push("RENDER_CUTOFF");const tt=p.layout.get("fill-extrusion-edge-radius"),ut=(st,rt,xt,Ft,Zt)=>{const kt=rt.programConfigurations.get(p.id),hn=b.isTileAffectedByFog(st),bt=b.getOrCreateProgram("fillExtrusionGroundEffect",{config:kt,defines:et,overrideFog:hn}),Wt=((fn,pn,qt,en,er,xn,Dn,yr,qn,ur,Ur)=>({u_matrix:pn,u_opacity:qt,u_ao_pass:en?1:0,u_meter_to_tile:er,u_ao:xn,u_flood_light_intensity:Dn,u_flood_light_color:yr,u_attenuation:qn,u_edge_radius:ur,u_fb:0,u_fb_size:Ur,u_dynamic_offset:1}))(0,Ft,Q,$,Zt,[oe,le*Zt],ue,ve,_e,He>=17?0:tt*Zt,ke?ke.size[0]:0),Gt=[];be&&Gt.push(rt.hiddenByLandmarkVertexBuffer),b.uploadCommonUniforms(Ne,bt,st.toUnwrapped(),null,Ke),bt.draw(b,Ne.gl.TRIANGLES,I,P,F,W,Wt,p.id,rt.vertexBuffer,rt.indexBuffer,xt,p.paint,He,kt,Gt)};for(const st of w){const rt=u.getTile(st),xt=rt.getBucket(p);if(!xt||xt.projection.name!==We.projection.name||!xt.groundEffect||xt.groundEffect&&!xt.groundEffect.hasData())continue;const Ft=xt.groundEffect,Zt=1/xt.tileToMeter;{const kt=b.translatePosMatrix(st.projMatrix,rt,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),hn=Ft.getDefaultSegment();ut(st,Ft,hn,kt,Zt)}if(we)for(let kt=0;kt<4;kt++){const hn=o.c$[kt](st),bt=u.getTile(hn);if(!bt)continue;const Wt=bt.getBucket(p);if(!Wt||Wt.projection.name!==We.projection.name||!Wt.groundEffect||Wt.groundEffect&&!Wt.groundEffect.hasData())continue;const Gt=Wt.groundEffect;let fn,pn;kt===0?(fn=[-o.ab,0,0],pn=1):kt===1?(fn=[o.ab,0,0],pn=0):kt===2?(fn=[0,-o.ab,0],pn=3):(fn=[0,o.ab,0],pn=2);const qt=Gt.regionSegments[pn];if(!qt)continue;const en=new Float32Array(16);o.a6.mat4.translate(en,st.projMatrix,fn),ut(st,Gt,qt,b.translatePosMatrix(en,rt,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Zt)}}}function oc(b,u,p,w,I,P,F){w.centroidVertexArray.length===0&&w.createCentroidsBuffer();const W=P?P.findDEMTileFor(p):null;if(!(W&&W.dem||F))return;const $=we=>new o.P(Math.ceil((we+o.d2)*o.d3),0),J=we=>{const ke=u.getSource().minzoom,Ne=We=>{const He=u.getTileByID(We);if(He&&He.hasData())return He.getBucket(I)},De=[0,-1,1];for(const We of De){if(we.overscaledZ+We<ke)continue;const He=Ne(we.calculateScaledKey(we.overscaledZ+We));if(He)return He}},Q=[0,0,0],oe=(we,ke)=>(Q[0]=Math.min(we.min.y,ke.min.y),Q[1]=Math.max(we.max.y,ke.max.y),Q[2]=o.ab-ke.min.x>we.max.x?ke.min.x-o.ab:we.max.x,Q),le=(we,ke)=>(Q[0]=Math.min(we.min.x,ke.min.x),Q[1]=Math.max(we.max.x,ke.max.x),Q[2]=o.ab-ke.min.y>we.max.y?ke.min.y-o.ab:we.max.y,Q),ue=[(we,ke)=>oe(we,ke),(we,ke)=>oe(ke,we),(we,ke)=>le(we,ke),(we,ke)=>le(ke,we)],ve=(we,ke,Ne,De,We,He,et)=>{if(!P)return 0;const Ke=[[He?Ne:we,He?we:Ne,0],[He?Ne:ke,He?ke:Ne,0]],tt=et<0?o.ab+et:et,ut=[He?tt:(we+ke)/2,He?(we+ke)/2:tt,0];return Ne===0&&et<0||Ne!==0&&et>0?P.getForTilePoints(We,[ut],!0,De):Ke.push(ut),P.getForTilePoints(p,Ke,!0,W),Math.max(Ke[0][2],Ke[1][2],ut[2])/P.exaggeration()};for(let we=0;we<4;we++){const ke=w.borderFeatureIndices[we];if(ke.length===0)continue;const Ne=o.c$[we](p),De=J(Ne);if(!(De&&De instanceof o.d0)||w.borderDoneWithNeighborZ[we]===De.canonical.z)continue;De.centroidVertexArray.length===0&&De.createCentroidsBuffer();const We=P?P.findDEMTileFor(Ne):null;if(!(We&&We.dem||F))continue;const He=(we<2?1:5)-we,et=De.borderDoneWithNeighborZ[He]!==w.canonical.z,Ke=De.borderFeatureIndices[He];let tt=0;if(w.canonical.z!==De.canonical.z){for(const ut of ke)w.showCentroid(w.featuresOnBorder[ut]);if(et)for(const ut of Ke)De.showCentroid(De.featuresOnBorder[ut]);w.borderDoneWithNeighborZ[we]=De.canonical.z,De.borderDoneWithNeighborZ[He]=w.canonical.z}for(const ut of ke){const st=w.featuresOnBorder[ut],rt=w.centroidData[st.centroidDataIndex],xt=st.borders[we];let Ft;for(;tt<Ke.length;){Ft=De.featuresOnBorder[Ke[tt]];const Zt=Ft.borders[He];if(Zt[1]>xt[0]+3||Zt[0]>xt[0]-3)break;De.showCentroid(Ft),tt++}if(Ft&&tt<Ke.length){const Zt=tt;let kt=0;for(;!(Ft.borders[He][0]>xt[1]-3)&&(kt++,++tt!==Ke.length);)Ft=De.featuresOnBorder[Ke[tt]];Ft=De.featuresOnBorder[Ke[Zt]];let hn=!1;if(kt>=1){const Gt=Ft.borders[He];Math.abs(xt[0]-Gt[0])<3&&Math.abs(xt[1]-Gt[1])<3&&(kt=1,hn=!0,tt=Zt+1)}else if(kt===0){w.showCentroid(st);continue}const bt=De.centroidData[Ft.centroidDataIndex];F&&hn&&(((_e=rt).flags|(be=bt).flags)&o.d1?(_e.flags|=o.d1,be.flags|=o.d1):(_e.flags&=~o.d1,be.flags&=~o.d1));const Wt=st.intersectsCount()>1||Ft.intersectsCount()>1;if(kt>1)tt=Zt,rt.centroidXY=bt.centroidXY=new o.P(0,0);else if(We&&We.dem&&!Wt){const Gt=ue[we](rt,bt),fn=we%2?o.ab-1:0,pn=ve(Gt[0],Math.min(o.ab-1,Gt[1]),fn,We,Ne,we<2,Gt[2]);rt.centroidXY=bt.centroidXY=$(pn)}else Wt?rt.centroidXY=bt.centroidXY=new o.P(0,0):(rt.centroidXY=w.encodeBorderCentroid(st),bt.centroidXY=De.encodeBorderCentroid(Ft));w.writeCentroidToBuffer(rt),De.writeCentroidToBuffer(bt)}else w.showCentroid(st)}w.borderDoneWithNeighborZ[we]=De.canonical.z,De.borderDoneWithNeighborZ[He]=w.canonical.z}var _e,be;(w.needsCentroidUpdate||!w.centroidVertexBuffer&&w.centroidVertexArray.length!==0)&&w.uploadCentroid(b)}const k1=[1,0,0],n_=[0,1,0],kg=[0,0,1];function Og(b,u,p){const w=p.transform,I=p.shadowRenderer;if(!I)return!0;const P=b.toUnwrapped(),F=w.tileSize*I._cascades[p.currentShadowCascade].scale;let W=u.maxHeight;if(w.elevation){const _e=w.elevation.getMinMaxForTile(b);_e&&(W+=_e.max)}const $=[...I.shadowDirection];$[2]=-$[2];const J=I.computeSimplifiedTileShadowVolume(P,W,F,$);if(!J)return!1;const Q=[k1,n_,kg,$,[$[0],0,$[2]],[0,$[1],$[2]]],oe=w.projection.name==="globe",le=w.scaleZoom(F),ue=o.bN.fromInvProjectionMatrix(w.invProjMatrix,w.worldSize,le,!oe),ve=I.getCurrentCascadeFrustum();return ue.intersectsPrecise(J.vertices,J.planes,Q)===0||ve.intersectsPrecise(J.vertices,J.planes,Q)===0}function Fg(b){return[b[0]*o.d4,b[1]*o.d4,b[2]*o.d4,0]}function Fa(b,u,p,w,I,P,F,W,$){const J=w.getSource(),Q=p.globeSharedBuffers;if(!Q)return;let oe,le,ue;if(u&&(oe=w.getTile(u)),J instanceof o.aD?(le=J.texture,ue=o.cD(0,0,p.transform)):oe&&u&&(le=oe.texture,ue=o.cD(u.canonical.z,u.canonical.x,p.transform)),!le||!ue)return;b||(ue=o.a6.mat4.scale(o.a6.mat4.create(),ue,[1,-1,1]));const ve=p.context,_e=ve.gl,be=I.paint.get("raster-resampling")==="nearest"?_e.NEAREST:_e.LINEAR,we=p.colorModeForDrapableLayerRenderPass(P),ke=F.defines;ke.push("GLOBE_POLES");const Ne=new $n(_e.LEQUAL,$n.ReadWrite,p.depthRangeFor3D),De=Float32Array.from(p.transform.expandedFarZProjMatrix),We=Float32Array.from(o.b5(o.cC(new o.bP(0,0,0))));p.terrain&&p.terrain.prepareDrawTile(),ve.activeTexture.set(_e.TEXTURE0),le.bind(be,_e.CLAMP_TO_EDGE),ve.activeTexture.set(_e.TEXTURE1),le.bind(be,_e.CLAMP_TO_EDGE),le.useMipmap&&ve.extTextureFilterAnisotropic&&p.transform.pitch>20&&_e.texParameterf(_e.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[He,et,Ke,tt]=u?Q.getPoleBuffers(u.canonical.z,!1):Q.getPoleBuffers(0,!0),ut=I.paint.get("raster-elevation");let st;b?(st=He,p.renderDefaultNorthPole=ut!==0):(st=et,p.renderDefaultSouthPole=ut!==0);const rt=Fg(F.mix),xt=((Zt,kt,hn,bt,Wt,Gt,fn,pn,qt,en,er,xn,Dn)=>wd(Zt,kt,hn,new Float32Array(16),new Float32Array(9),[0,0],bt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Gt,[0,0],pn,2,en,er,xn,1,0,Dn))(De,We,ue,o.a9(p.transform.zoom),0,I,0,ut,0,rt,F.offset,F.range,P),Ft=p.getOrCreateProgram("raster",{defines:ke});p.uploadCommonUniforms(ve,Ft,null),Ft.draw(p,_e.TRIANGLES,Ne,$,we,W,xt,I.id,st,Ke,tt)}function ds(b){const u=b._nearZ,p=b.projection.farthestPixelDistance(b),w=p-u,I=.2*b.height,P=u+I;return[u,p,(P-I-u)/w,(P-u)/w]}function cf(b,u,p,w){if(b)return u instanceof Er&&b instanceof og?u.getTextureDescriptor(b,p,!0):{texture:b.texture,mix:Fg(w.mix),offset:w.offset,buffer:0,tileSize:1}}var Ed=o.d5([{name:"a_index",type:"Int16",components:1}]);class Jp{constructor(u,p,w,I){const P={width:w[0],height:w[1],data:null},F=u.gl;this.targetColorTexture=new o.T(u,P,F.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(u,P,F.RGBA8,{useMipmap:!1}),this.context=u,this.updateParticleTexture(p,I),this.lastInvalidatedAt=0}updateParticleTexture(u,p){if(this.particleTextureDimension===p.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const w=this.context.gl,I=p.width*p.height;this.particleTexture0=new o.T(this.context,p,w.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,p,w.RGBA8,{premultiply:!1,useMipmap:!1});const P=new o.d6;P.reserve(I);for(let F=0;F<I;F++)P.emplaceBack(F);this.particleIndexBuffer=this.context.createVertexBuffer(P,Ed.members,!0),this.particleSegment=o.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=p.width}update(u){return!(this.lastInvalidatedAt<u&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Qp(b,u,p){if(!b)return null;const w=u.getTextureDescriptor(b,p,!0);if(!w)return null;let{texture:I,mix:P,offset:F,tileSize:W,buffer:$,format:J}=w;if(!I||!J)return null;let Q=!1;return J==="uint32"&&(Q=!0,P[3]=0,P=$p(o.d7,P,[0,p.paint.get("raster-particle-max-speed")]),F=bd(o.d7,F,[0,p.paint.get("raster-particle-max-speed")])),{texture:I,textureOffset:[$/(W+2*$),W/(W+2*$)],tileSize:W,scalarData:Q,scale:P,offset:F,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[J]]}}function Id(b){const u=b._nearZ,p=b.projection.farthestPixelDistance(b),w=p-u,I=.2*b.height,P=u+I;return[u,p,(P-I-u)/w,(P-u)/w]}const r_=new o.bz(1,0,0,1),Ju=new o.bz(0,1,0,1),Qu=new o.bz(0,0,1,1),gn=new o.bz(1,0,1,1),Kn=new o.bz(0,1,1,1);function ac(b,u,p,w,I,P,F){const W=b.context,$=b.transform,J=W.gl,Q=$.projection.name==="globe",oe=Q?["PROJECTION_GLOBE_VIEW"]:[];let le=o.a6.mat4.clone(p.projMatrix);if(Q&&o.a9($.zoom)>0){const rt=o.b4(p.canonical,$),xt=o.d8(rt);le=o.a6.mat4.multiply(new Float32Array(16),$.globeMatrix,xt),o.a6.mat4.multiply(le,$.projMatrix,le)}const ue=o.a6.mat4.create();ue[12]+=2*I/(o.q.devicePixelRatio*$.width),ue[13]+=2*P/(o.q.devicePixelRatio*$.height),o.a6.mat4.multiply(le,ue,le);const ve=b.getOrCreateProgram("debug",{defines:oe}),_e=u.getTileByID(p.key);b.terrain&&b.terrain.setupElevationDraw(_e,ve);const be=$n.disabled,we=pr.disabled,ke=b.colorModeForRenderPass(),Ne="$debug";W.activeTexture.set(J.TEXTURE0),b.emptyTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Q?_e._makeGlobeTileDebugBuffers(b.context,$):_e._makeDebugTileBoundsBuffers(b.context,$.projection);const De=_e._tileDebugBuffer||b.debugBuffer,We=_e._tileDebugIndexBuffer||b.debugIndexBuffer,He=_e._tileDebugSegments||b.debugSegments;if(ve.draw(b,J.LINE_STRIP,be,we,ke,_r.disabled,Qv(le,w),Ne,De,We,He,null,null,null,[_e._globeTileDebugBorderBuffer]),F){const rt=_e.latestRawTileData,xt=Math.floor((rt&&rt.byteLength||0)/1024);let Ft=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Ft+=` => ${p.overscaledZ}`),Ft+=` ${_e.state}`,Ft+=` ${xt}kb`,function(Zt,kt){Zt.initDebugOverlayCanvas();const hn=Zt.debugOverlayCanvas,bt=Zt.context.gl,Wt=Zt.debugOverlayCanvas.getContext("2d");Wt.clearRect(0,0,hn.width,hn.height),Wt.shadowColor="white",Wt.shadowBlur=2,Wt.lineWidth=1.5,Wt.strokeStyle="white",Wt.textBaseline="top",Wt.font="bold 36px Open Sans, sans-serif",Wt.fillText(kt,5,5),Wt.strokeText(kt,5,5),Zt.debugOverlayTexture.update(hn),Zt.debugOverlayTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE)}(b,Ft)}const et=u.getTile(p).tileSize,Ke=512/Math.min(et,512)*(p.overscaledZ/$.zoom)*.5,tt=_e._tileDebugTextBuffer||b.debugBuffer,ut=_e._tileDebugTextIndexBuffer||b.quadTriangleIndexBuffer,st=_e._tileDebugTextSegments||b.debugSegments;ve.draw(b,J.TRIANGLES,be,we,Mr.alphaBlended,_r.disabled,Qv(le,o.bz.transparent,Ke),Ne,tt,ut,st,null,null,null,[_e._globeTileDebugTextBuffer])}function ji(b,u,p,w){Bs(b,0,u+p/2,b.transform.width,p,w)}function At(b,u,p,w){Bs(b,u-p/2,0,p,b.transform.height,w)}function Bs(b,u,p,w,I,P){const F=b.context,W=F.gl;W.enable(W.SCISSOR_TEST),W.scissor(u*o.q.devicePixelRatio,p*o.q.devicePixelRatio,w*o.q.devicePixelRatio,I*o.q.devicePixelRatio),F.clear({color:P}),W.disable(W.SCISSOR_TEST)}const di=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ks}=di;function rs(b,u,p,w){b.emplaceBack(u,p,w)}class Bo{constructor(u){this.vertexArray=new o.d9,this.indices=new o.aO,rs(this.vertexArray,-1,-1,1),rs(this.vertexArray,1,-1,1),rs(this.vertexArray,-1,1,1),rs(this.vertexArray,1,1,1),rs(this.vertexArray,-1,-1,-1),rs(this.vertexArray,1,-1,-1),rs(this.vertexArray,-1,1,-1),rs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,Ks),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=o.b1.simpleSegment(0,0,36,12)}}function ko(b,u,p,w,I,P){const F=b.context.gl,W=u.paint.get("sky-atmosphere-color"),$=u.paint.get("sky-atmosphere-halo-color"),J=u.paint.get("sky-atmosphere-sun-intensity"),Q=((oe,le,ue,ve,_e)=>({u_matrix_3f:oe,u_sun_direction:le,u_sun_intensity:ue,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),w),I,J,W,$);F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+P,u.skyboxTexture,0),p.draw(b,F.TRIANGLES,$n.disabled,pr.disabled,Mr.unblended,_r.frontCW,Q,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const lc=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Oo{constructor(u){const p=new o.da;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const w=new o.aO;w.emplaceBack(0,1,2),w.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(p,lc.members),this.indexBuffer=u.createIndexBuffer(w),this.segments=o.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const em=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class uf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class hf{constructor(u){this.colorModeAlphaBlendedWriteRGB=new Mr([1,_a,1,_a],o.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Mr([1,0,1,0],o.bz.transparent,[!1,!1,!1,!0]),this.params=new uf,this.updateNeeded=!0,u.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),u.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(u){const p=u.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Oo(p);const w=this.params.sizeRange,I=this.params.intensityRange,P=function(Q){const oe=o.dd(30),le=[];for(let ue=0;ue<Q;++ue){const ve=2*Math.PI*oe(),_e=Math.acos(1-2*oe())-.5*Math.PI;le.push(o.a6.vec3.fromValues(Math.cos(_e)*Math.cos(ve),Math.cos(_e)*Math.sin(ve),Math.sin(_e)))}return le}(this.params.starsCount),F=o.dd(300),W=new o.db,$=new o.aO;let J=0;for(let Q=0;Q<P.length;++Q){const oe=o.a6.vec3.scale([],P[Q],200),le=Math.max(0,1+.01*w*(1*F()-.5)),ue=Math.max(0,1+.01*I*(1*F()-.5));W.emplaceBack(oe[0],oe[1],oe[2],-1,-1,le,ue),W.emplaceBack(oe[0],oe[1],oe[2],1,-1,le,ue),W.emplaceBack(oe[0],oe[1],oe[2],1,1,le,ue),W.emplaceBack(oe[0],oe[1],oe[2],-1,1,le,ue),$.emplaceBack(J+0,J+1,J+2),$.emplaceBack(J+0,J+2,J+3),J+=4}this.starsVx=p.createVertexBuffer(W,em.members),this.starsIdx=p.createIndexBuffer($),this.starsSegments=o.b1.simpleSegment(0,0,W.length,$.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(u,p){const w=u.context,I=w.gl,P=u.transform,F=new $n(I.LEQUAL,$n.ReadOnly,[0,1]),W=o.a9(P.zoom),$=u.style.getLut(p.scope),J=p.properties.get("color").toRenderColor($).toArray01(),Q=p.properties.get("high-color").toRenderColor($).toArray01(),oe=p.properties.get("space-color").toRenderColor($).toArray01PremultipliedAlpha(),le=5e-4,ue=o.dc(p.properties.get("horizon-blend"),0,1,le,.25),ve=o.cx(u,w,P)&&ue===le?P.worldSize/(2*Math.PI*1.025)-1:P.globeRadius,_e=u.frameCounter/1e3%1,be=o.a6.vec3.length(P.globeCenterInViewSpace),we=Math.sqrt(Math.pow(be,2)-Math.pow(ve,2)),ke=Math.acos(we/be),Ne=De=>{const We=P.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];De&&We.push("ALPHA_PASS");const He=u.getOrCreateProgram("globeAtmosphere",{defines:We}),et=((tt,ut,st,rt,xt,Ft,Zt,kt,hn,bt,Wt,Gt)=>({u_frustum_tl:tt,u_frustum_tr:ut,u_frustum_br:st,u_frustum_bl:rt,u_horizon:xt,u_transition:Ft,u_fadeout_range:Zt,u_color:kt,u_high_color:hn,u_space_color:bt,u_temporal_offset:Wt,u_horizon_angle:Gt}))(P.frustumCorners.TL,P.frustumCorners.TR,P.frustumCorners.BR,P.frustumCorners.BL,P.frustumCorners.horizon,W,ue,J,Q,oe,_e,ke);u.uploadCommonUniforms(w,He);const Ke=this.atmosphereBuffer;Ke&&He.draw(u,I.TRIANGLES,F,pr.disabled,De?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,_r.backCW,et,De?"atmosphere_glow_alpha":"atmosphere_glow",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)};Ne(!1),Ne(!0)}drawStars(u,p){const w=o.ap(p.properties.get("star-intensity"),0,1);if(w===0)return;const I=u.context,P=I.gl,F=u.transform,W=u.getOrCreateProgram("stars"),$=o.a6.quat.identity([]);o.a6.quat.rotateX($,$,-F._pitch),o.a6.quat.rotateZ($,$,-F.angle),o.a6.quat.rotateX($,$,o.bB(F._center.lat)),o.a6.quat.rotateY($,$,-o.bB(F._center.lng));const J=o.a6.mat4.fromQuat(new Float32Array(16),$),Q=o.a6.mat4.multiply([],F.starsProjMatrix,J),oe=o.a6.mat3.fromMat4([],J),le=o.a6.mat3.invert([],oe),ue=[0,1,0];o.a6.vec3.transformMat3(ue,ue,le),o.a6.vec3.scale(ue,ue,this.params.sizeMultiplier);const ve=[1,0,0];o.a6.vec3.transformMat3(ve,ve,le),o.a6.vec3.scale(ve,ve,this.params.sizeMultiplier);const _e=(be=ue,we=ve,ke=w,{u_matrix:Float32Array.from(Q),u_up:be,u_right:we,u_intensity_multiplier:ke});var be,we,ke;u.uploadCommonUniforms(I,W),this.starsVx&&this.starsIdx&&W.draw(u,P.TRIANGLES,$n.disabled,pr.disabled,this.colorModeAlphaBlendedWriteRGB,_r.disabled,_e,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Rd(b,u){const p=[...b],w=u.cameraWorldSizeForFog/u.worldSize,I=o.a6.mat4.identity([]);return o.a6.mat4.scale(I,I,[w,w,1]),o.a6.mat4.multiply(p,I,p),o.a6.mat4.multiply(p,u.worldToFogMatrix,p),p}function eh(b,u,p,w,I){const P=p.material,F=w.context,{baseColorTexture:W,metallicRoughnessTexture:$}=P.pbrMetallicRoughness,{normalTexture:J,occlusionTexture:Q,emissionTexture:oe}=P;function le(ue,ve,_e){if(ue&&(b.push(ve),F.activeTexture.set(F.gl.TEXTURE0+_e),ue.gfxTexture)){const{minFilter:be,magFilter:we,wrapS:ke,wrapT:Ne}=ue.sampler;ue.gfxTexture.bindExtraParam(be,we,ke,Ne)}}le(W,"HAS_TEXTURE_u_baseColorTexture",ao.BaseColor),le($,"HAS_TEXTURE_u_metallicRoughnessTexture",ao.MetallicRoughness),le(J,"HAS_TEXTURE_u_normalTexture",ao.Normal),le(Q,"HAS_TEXTURE_u_occlusionTexture",ao.Occlusion),le(oe,"HAS_TEXTURE_u_emissionTexture",ao.Emission),I&&(I.texture||(I.texture=new o.df(w.context,I.image,[I.image.height,I.image.height,I.image.height],F.gl.RGBA8)),F.activeTexture.set(F.gl.TEXTURE0+ao.LUT),I.texture&&I.texture.bind(F.gl.LINEAR,F.gl.CLAMP_TO_EDGE),b.push("APPLY_LUT_ON_GPU")),p.texcoordBuffer&&(b.push("HAS_ATTRIBUTE_a_uv_2f"),u.push(p.texcoordBuffer)),p.colorBuffer&&(b.push(p.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),u.push(p.colorBuffer)),p.normalBuffer&&(b.push("HAS_ATTRIBUTE_a_normal_3f"),u.push(p.normalBuffer)),p.pbrBuffer&&(b.push("HAS_ATTRIBUTE_a_pbr"),b.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),u.push(p.pbrBuffer)),P.alphaMode!=="OPAQUE"&&P.alphaMode!=="MASK"||b.push("UNPREMULT_TEXTURE_IN_SHADER"),P.defined||b.push("DIFFUSE_SHADED"),b.push("USE_STANDARD_DERIVATIVES")}function Yo(b,u,p,w,I,P){const F=p.paint.get("model-opacity"),W=u.context,$=new $n(u.context.gl.LEQUAL,$n.ReadWrite,u.depthRangeFor3D),J=u.transform,Q=b.mesh,oe=Q.material,le=oe.pbrMetallicRoughness,ue=u.style.fog;let ve;ve=u.transform.projection.zAxisUnit==="pixels"?[...b.nodeModelMatrix]:o.a6.mat4.multiply([],w.zScaleMatrix,b.nodeModelMatrix),o.a6.mat4.multiply(ve,w.negCameraPosMatrix,ve);const _e=o.a6.mat4.invert([],ve);o.a6.mat4.transpose(_e,_e);const be=p.paint.get("model-emissive-strength").constantOr(0),we=Fn(new Float32Array(b.worldViewProjection),new Float32Array(ve),new Float32Array(_e),null,u,F,le.baseColorFactor.toRenderColor(null),oe.emissiveFactor,le.metallicFactor,le.roughnessFactor,oe,be,p),ke={defines:[]},Ne=[];eh(ke.defines,Ne,Q,u,p.lut);const De=u.shadowRenderer;De&&(De.useNormalOffset=!1);let We=null;if(ue){const Ke=Rd(b.nodeModelMatrix,u.transform);if(We=new Float32Array(Ke),J.projection.name!=="globe"){const tt=Q.aabb.min,ut=Q.aabb.max,[st,rt]=ue.getOpacityForBounds(Ke,tt[0],tt[1],ut[0],ut[1]);ke.overrideFog=st>=Mn||rt>=Mn}}const He=nc(u,p.paint.get("model-cutoff-fade-range"));He.shouldRenderCutoff&&ke.defines.push("RENDER_CUTOFF");const et=u.getOrCreateProgram("model",ke);u.uploadCommonUniforms(W,et,null,We,He),u.renderPass!=="shadow"&&De&&De.setupShadowsFromMatrix(b.nodeModelMatrix,et),et.draw(u,W.gl.TRIANGLES,$,I,P,Q.material.doubleSided?_r.disabled:_r.backCCW,we,p.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,p.paint,u.transform.zoom,void 0,Ne)}function ff(b,u,p,w,I,P,F){let W;W=b.projection.name==="globe"?o.dg(p,b):[...p],o.a6.mat4.multiply(W,W,u.matrix);const $=o.a6.mat4.multiply([],w,W);if(u.meshes)for(const J of u.meshes){if(J.material.alphaMode!=="BLEND"){F.push({mesh:J,depth:0,modelIndex:I,worldViewProjection:$,nodeModelMatrix:W});continue}const Q=o.a6.vec3.transformMat4([],J.centroid,$);Q[2]>0&&P.push({mesh:J,depth:Q[2],modelIndex:I,worldViewProjection:$,nodeModelMatrix:W})}if(u.children)for(const J of u.children)ff(b,J,p,w,I,P,F)}function th(b,u,p,w){const I=p.shadowRenderer;if(!I)return;const P=I.getShadowPassDepthMode(),F=I.getShadowPassColorMode(),W=I.calculateShadowPassMatrixFromMatrix(u),$=sr(W);p.getOrCreateProgram("modelDepth",{defines:p._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(p,p.context.gl.TRIANGLES,P,pr.disabled,F,_r.backCCW,$,w.id,b.vertexBuffer,b.indexBuffer,b.segments,w.paint,p.transform.zoom,void 0,void 0)}function df(b,u,p){const w=u.updateZoomBasedPaintProperties(),I=function(P,F,W){let $,J,Q,oe=P.terrain?P.terrain.exaggeration():0;if(P.terrain&&oe>0){const le=P.terrain,ue=le.findDEMTileFor(W);ue&&ue.dem?$=o.di.create(le,W,ue):oe=0}if(oe===0&&(F.terrainElevationMin=0,F.terrainElevationMax=0),oe===F.validForExaggeration&&(oe===0||$&&$._demTile&&$._demTile.tileID===F.validForDEMTile.id&&$._dem._timestamp===F.validForDEMTile.timestamp))return!1;for(const le in F.instancesPerModel){const ue=F.instancesPerModel[le];for(let ve=0;ve<ue.instancedDataArray.length;++ve){const _e=($?oe*$.getElevationAt(0|ue.instancedDataArray.float32[16*ve],0|ue.instancedDataArray.float32[16*ve+1],!0,!0):0)+ue.instancesEvaluatedElevation[ve];ue.instancedDataArray.float32[16*ve+6]=_e,J=J?Math.min(F.terrainElevationMin,_e):_e,Q=Q?Math.max(F.terrainElevationMax,_e):_e}}return F.terrainElevationMin=J||0,F.terrainElevationMax=Q||0,F.validForExaggeration=oe,F.validForDEMTile=$&&$._demTile?{id:$._demTile.tileID,timestamp:$._dem._timestamp}:{id:void 0,timestamp:0},!0}(b,u,p);(w||I)&&(u.uploaded=!1,u.upload(b.context))}const Ja={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.c9([0,0,0],[o.ab,o.ab,0])};function i_(b,u){const p=1<<b.canonical.z,w=u.getFreeCameraOptions().position,I=u.elevation,P=b.canonical.x/p,F=(b.canonical.x+1)/p,W=b.canonical.y/p,$=(b.canonical.y+1)/p;let J=u._centerAltitude;if(I){const ue=I.getMinMaxForTile(b);ue&&ue.max>J&&(J=ue.max)}const Q=o.ap(w.x,P,F)-w.x,oe=o.ap(w.y,W,$)-w.y,le=o.bD(J,u.center.lat)-w.z;return u._zoomFromMercatorZ(Math.sqrt(Q*Q+oe*oe+le*le))}function Hs(b,u,p,w,I,P,F){const W=b.context,$=b.renderPass==="shadow",J=b.shadowRenderer,Q=$&&J?J.getShadowPassDepthMode():new $n(W.gl.LEQUAL,$n.ReadWrite,b.depthRangeFor3D),oe=b.isTileAffectedByFog(P);if(p.meshes)for(const le of p.meshes){const ue=["MODEL_POSITION_ON_GPU"],ve=[];let _e,be,we;w.instancedDataArray.length>20&&ue.push("INSTANCED_ARRAYS");const ke=nc(b,u.paint.get("model-cutoff-fade-range"));if(ke.shouldRenderCutoff&&ue.push("RENDER_CUTOFF"),$&&J)_e=b.getOrCreateProgram("modelDepth",{defines:ue}),be=sr(F.shadowTileMatrix,F.shadowTileMatrix,Float32Array.from(p.matrix)),we=J.getShadowPassColorMode();else{eh(ue,ve,le,b,u.lut),_e=b.getOrCreateProgram("model",{defines:ue,overrideFog:oe});const De=le.material,We=De.pbrMetallicRoughness,He=u.paint.get("model-opacity"),et=u.paint.get("model-emissive-strength").constantOr(0);be=Fn(P.expandedProjMatrix,Float32Array.from(p.matrix),new Float32Array(16),null,b,He,We.baseColorFactor.toRenderColor(null),De.emissiveFactor,We.metallicFactor,We.roughnessFactor,De,et,u,I),J&&(F.shadowUniformsInitialized?_e.setShadowUniformValues(W,J.getShadowUniformValues()):(J.setupShadows(P.toUnwrapped(),_e,"model-tile",P.overscaledZ),F.shadowUniformsInitialized=!0)),we=ke.shouldRenderCutoff||He<1||De.alphaMode!=="OPAQUE"?Mr.alphaBlended:Mr.unblended}b.uploadCommonUniforms(W,_e,P.toUnwrapped(),null,ke);const Ne=le.material.doubleSided?_r.disabled:_r.backCCW;if(w.instancedDataArray.length>20)ve.push(w.instancedDataBuffer),_e.draw(b,W.gl.TRIANGLES,Q,pr.disabled,we,Ne,be,u.id,le.vertexBuffer,le.indexBuffer,le.segments,u.paint,b.transform.zoom,void 0,ve,w.instancedDataArray.length);else{const De=$?"u_instance":"u_normal_matrix";for(let We=0;We<w.instancedDataArray.length;++We)be[De]=new Float32Array(w.instancedDataArray.arrayBuffer,64*We,16),_e.draw(b,W.gl.TRIANGLES,Q,pr.disabled,we,Ne,be,u.id,le.vertexBuffer,le.indexBuffer,le.segments,u.paint,b.transform.zoom,void 0,ve)}}if(p.children)for(const le of p.children)Hs(b,u,le,w,I,P,F)}const Ng=[1,-1,1];function Il(b,u,p,w){if(!p.modelManager)return!0;const I=p.modelManager;if(!p.shadowRenderer)return!0;const P=p.shadowRenderer,F=u.aabb;let W=!0,$=b.maxHeight;if($===0){let Q=0;for(const oe in b.instancesPerModel){const le=I.getModel(oe,w);le?Q=Math.max(Q,Math.max(Math.max(le.aabb.max[0],le.aabb.max[1]),le.aabb.max[2])):W=!1}$=b.maxScale*Q*1.41+b.maxVerticalOffset,W&&(b.maxHeight=$)}F.max[2]=$,F.min[2]+=b.terrainElevationMin,F.max[2]+=b.terrainElevationMax,o.a6.vec3.transformMat4(F.min,F.min,u.tileMatrix),o.a6.vec3.transformMat4(F.max,F.max,u.tileMatrix);const J=F.intersects(P.getCurrentCascadeFrustum());return p.currentShadowCascade===0&&(b.isInsideFirstShadowMapFrustum=J===2),J===0}function Oi(b,u){const p=b.uniformValues.u_cutoff_params[0],w=b.uniformValues.u_cutoff_params[1],I=b.uniformValues.u_cutoff_params[2],P=b.uniformValues.u_cutoff_params[3];return w===p||P===I?1:o.ap(((u-p)/(w-p)-I)/(P-I),0,1)}function Qr(b,u,p,w){if(u.pitch<20)return 1;const I=u.getWorldToCameraMatrix();o.a6.mat4.multiply(I,I,b);const P=o.a6.vec4.fromValues(p.min[0],p.min[1],p.min[2],1);let F=o.a6.vec4.transformMat4(o.a6.vec4.create(),P,I),W=F,$=F;P[1]=p.max[1],F=o.a6.vec4.transformMat4(o.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,$=F[1]>$[1]?F:$,P[0]=p.max[0],F=o.a6.vec4.transformMat4(o.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,$=F[1]>$[1]?F:$,P[1]=p.min[1],F=o.a6.vec4.transformMat4(o.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,$=F[1]>$[1]?F:$;const J=o.ap(w[0],0,1),Q=100*u.pixelsPerMeter*o.ap(w[1],0,1),oe=o.ap(w[2],0,1),le=o.a6.vec4.lerp(o.a6.vec4.create(),W,$,J),ue=Math.tan(.5*u.fovX),ve=-le[2]*ue;if(Q===0)return le[1]<-Math.abs(ve)?oe:1;const _e=(-Math.abs(ve)-le[1])/Q,be=(ke,Ne,De)=>(1-De)*ke+De*Ne,we=o.ap(be(1,oe,_e),oe,1);return be(1,we,o.ap((u.pitch-20)/20,0,1))}class zg{}class cc{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(u,p,w){{const oe=this._storage.get(p.id);if(oe)return oe.lastUsedFrameIdx=u,oe.buf}const I=w.gl,P=I.getBufferParameter(I.ELEMENT_ARRAY_BUFFER,I.BUFFER_SIZE),F=new ArrayBuffer(P),W=new Int16Array(F);I.getBufferSubData(I.ELEMENT_ARRAY_BUFFER,0,new Int16Array(F));const $=new o.dk;for(let oe=0;oe<P/2;oe+=3){const le=W[oe],ue=W[oe+1],ve=W[oe+2];$.emplaceBack(le,ue),$.emplaceBack(ue,ve),$.emplaceBack(ve,le)}const J=w.bindVertexArrayOES.current,Q=new zg;return Q.buf=new ya(w,$),Q.lastUsedFrameIdx=u,this._storage.set(p.id,Q),w.bindVertexArrayOES.set(J),Q.buf}update(u){for(const[p,w]of this._storage)u-w.lastUsedFrameIdx>30&&(w.buf.destroy(),this._storage.delete(p))}destroy(){for(const[u,p]of this._storage)p.buf.destroy(),this._storage.delete(u)}}class pf{constructor(u){this.occluderSize=30,this.depthOffset=-1e-4,u.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),u.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Js={symbol:function(b,u,p,w,I){if(b.renderPass!=="translucent")return;const P=pr.disabled,F=b.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(J,Q,oe,le,ue,ve,_e){const be=Q.transform,we=ue==="map",ke=ve==="map";for(const Ne of J){const De=le.getTile(Ne),We=De.getBucket(oe);if(!We||!We.text||!We.text.segments.get().length)continue;const He=o.bj(We.textSizeData,be.zoom),et=Oc(Ne,We.getProjection(),be),Ke=be.calculatePixelsToTileUnitsMatrix(De),tt=ei(et,De.tileID.canonical,ke,we,be,We.getProjection(),Ke),ut=We.hasIconTextFit()&&We.hasIconData();if(He){const st=Math.pow(2,be.zoom-De.tileID.overscaledZ);B1(We,we,ke,_e,o.cS,be,tt,Ne,st,He,ut)}}}(w,b,p,u,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),I);const W=p.paint.get("icon-opacity").constantOr(1)!==0,$=p.paint.get("text-opacity").constantOr(1)!==0;p.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(W||$)?Md(b,u,p,w,P,F):(W&&Md(b,u,p,w,P,F,{onlyIcons:!0}),$&&Md(b,u,p,w,P,F,{onlyText:!0})),u.map.showCollisionBoxes&&(Kp(b,u,p,w,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),Kp(b,u,p,w,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(b,u,p,w){if(b.renderPass!=="translucent")return;const I=p.paint.get("circle-opacity"),P=p.paint.get("circle-stroke-width"),F=p.paint.get("circle-stroke-opacity"),W=p.layout.get("circle-sort-key").constantOr(1)!==void 0,$=p.paint.get("circle-emissive-strength");if(I.constantOr(1)===0&&(P.constantOr(1)===0||F.constantOr(1)===0))return;const J=b.context,Q=J.gl,oe=b.transform,le=b.depthModeForSublayer(0,$n.ReadOnly),ue=pr.disabled,ve=b.colorModeForDrapableLayerRenderPass($),_e=oe.projection.name==="globe",be=[o.am(oe.center.lng),o.at(oe.center.lat)],we=[];for(let Ne=0;Ne<w.length;Ne++){const De=w[Ne],We=u.getTile(De),He=We.getBucket(p);if(!He||He.projection.name!==oe.projection.name)continue;const et=He.programConfigurations.get(p.id),Ke=o.cT(p),tt=b.isTileAffectedByFog(De);_e&&Ke.push("PROJECTION_GLOBE_VIEW"),Ke.push("DEPTH_D24"),b.terrain&&oe.depthOcclusionForSymbolsAndCircles&&Ke.push("DEPTH_OCCLUSION");const ut=b.getOrCreateProgram("circle",{config:et,defines:Ke,overrideFog:tt}),st=He.layoutVertexBuffer,rt=He.globeExtVertexBuffer,xt=He.indexBuffer,Ft=oe.projection.createInversionMatrix(oe,De.canonical),Zt={programConfiguration:et,program:ut,layoutVertexBuffer:st,globeExtVertexBuffer:rt,indexBuffer:xt,uniformValues:o.cU(b,De,We,Ft,be,p),tile:We};if(W){const kt=He.segments.get();for(const hn of kt)we.push({segments:new o.b1([hn]),sortKey:hn.sortKey,state:Zt})}else we.push({segments:He.segments,sortKey:0,state:Zt})}W&&we.sort((Ne,De)=>Ne.sortKey-De.sortKey);const ke={useDepthForOcclusion:oe.depthOcclusionForSymbolsAndCircles};for(const Ne of we){const{programConfiguration:De,program:We,layoutVertexBuffer:He,globeExtVertexBuffer:et,indexBuffer:Ke,uniformValues:tt,tile:ut}=Ne.state,st=Ne.segments;b.terrain&&b.terrain.setupElevationDraw(ut,We,ke),b.uploadCommonUniforms(J,We,ut.tileID.toUnwrapped()),We.draw(b,Q.TRIANGLES,le,ue,ve,_r.disabled,tt,p.id,He,Ke,st,p.paint,oe.zoom,De,[et])}},heatmap:function(b,u,p,w){if(p.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const I=b.context,P=I.gl,F=pr.disabled,W=new Mr([P.ONE,P.ONE,P.ONE,P.ONE],o.bz.transparent,[!0,!0,!0,!0]);(function(ue,ve,_e,be){const we=ue.gl,ke=ve.width*be,Ne=ve.height*be;ue.activeTexture.set(we.TEXTURE1),ue.viewport.set([0,0,ke,Ne]);let De=_e.heatmapFbo;if(!De||De&&(De.width!==ke||De.height!==Ne)){De&&De.destroy();const We=we.createTexture();we.bindTexture(we.TEXTURE_2D,We),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),De=_e.heatmapFbo=ue.createFramebuffer(ke,Ne,!0,null),function(He,et,Ke,tt,ut,st){const rt=He.gl;rt.texImage2D(rt.TEXTURE_2D,0,He.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,ut,st,0,rt.RGBA,He.extRenderToTextureHalfFloat?rt.HALF_FLOAT:rt.UNSIGNED_BYTE,null),tt.colorAttachment.set(Ke)}(ue,0,We,De,ke,Ne)}else we.bindTexture(we.TEXTURE_2D,De.colorAttachment.get()),ue.bindFramebuffer.set(De.framebuffer)})(I,b,p,b.transform.projection.name==="globe"?.5:.25),I.clear({color:o.bz.transparent});const $=b.transform,J=$.projection.name==="globe",Q=J?["PROJECTION_GLOBE_VIEW"]:[],oe=J?_r.frontCCW:_r.disabled,le=[o.am($.center.lng),o.at($.center.lat)];for(let ue=0;ue<w.length;ue++){const ve=w[ue];if(u.hasRenderableParent(ve))continue;const _e=u.getTile(ve),be=_e.getBucket(p);if(!be||be.projection.name!==$.projection.name)continue;const we=b.isTileAffectedByFog(ve),ke=be.programConfigurations.get(p.id),Ne=b.getOrCreateProgram("heatmap",{config:ke,defines:Q,overrideFog:we}),{zoom:De}=b.transform;b.terrain&&b.terrain.setupElevationDraw(_e,Ne),b.uploadCommonUniforms(I,Ne,ve.toUnwrapped());const We=$.projection.createInversionMatrix($,ve.canonical);Ne.draw(b,P.TRIANGLES,$n.disabled,F,W,oe,Lg(b,ve,_e,We,le,De,p.paint.get("heatmap-intensity")),p.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,p.paint,b.transform.zoom,ke,J?[be.globeExtVertexBuffer]:null)}I.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(I,P){const F=I.context,W=F.gl,$=P.heatmapFbo;if(!$)return;F.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,$.colorAttachment.get()),F.activeTexture.set(W.TEXTURE1);let J=P.colorRampTexture;J||(J=P.colorRampTexture=new o.T(F,P.colorRamp,W.RGBA8)),J.bind(W.LINEAR,W.CLAMP_TO_EDGE),I.getOrCreateProgram("heatmapTexture").draw(I,W.TRIANGLES,$n.disabled,pr.disabled,I.colorModeForRenderPass(),_r.disabled,((Q,oe,le,ue)=>({u_image:0,u_color_ramp:1,u_opacity:oe.paint.get("heatmap-opacity")}))(0,P),P.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,P.paint,I.transform.zoom)}(b,p))},line:function(b,u,p,w){if(b.renderPass!=="translucent")return;const I=p.paint.get("line-opacity"),P=p.paint.get("line-width");if(I.constantOr(1)===0||P.constantOr(1)===0)return;const F=p.paint.get("line-emissive-strength"),W=p.paint.get("line-occlusion-opacity"),$=b.context,J=$.gl,Q=p.layout.get("line-z-offset"),oe=!Q.isConstant()||!!Q.constantOr(0),le=oe?new $n(b.depthOcclusion?J.GREATER:J.LEQUAL,$n.ReadOnly,b.depthRangeFor3D):b.depthModeForSublayer(0,$n.ReadOnly),ue=b.colorModeForDrapableLayerRenderPass(F),ve=b.terrain&&b.terrain.renderingToTexture,_e=ve?1:o.q.devicePixelRatio,be=p.paint.get("line-dasharray"),we=be.constantOr(1),ke=p.layout.get("line-cap"),Ne=be.constantOr(null),De=ke.constantOr(null),We=p.paint.get("line-pattern"),He=We.constantOr(1),et=We.constantOr(null),Ke=p.paint.get("line-opacity").constantOr(1);let tt=!He&&Ke!==1||b.depthOcclusion&&W>0&&W<1;const ut=p.paint.get("line-gradient"),st=He?"linePattern":"line",rt=o.cV(p);let xt;if(ve&&b.terrain&&b.terrain.clipOrMaskOverlapStencilType()&&(tt=!1),W!==0&&b.depthOcclusion){const Zt=p.paint._values["line-opacity"];Zt&&Zt.value&&Zt.value.kind==="constant"?xt=Zt.value:o.w(`Occlusion opacity for layer ${p.id} is supported only when line-opacity isn't data-driven.`)}if(oe&&(b.forceTerrainMode=!0),!oe&&W!==0&&b.terrain&&!ve)return void o.w(`Occlusion opacity for layer ${p.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Ft=tt&&oe?b.stencilModeFor3D():pr.disabled;for(const Zt of w){const kt=u.getTile(Zt);if(He&&!kt.patternsLoaded())continue;const hn=kt.getBucket(p);if(!hn)continue;b.prepareDrawTile();const bt=hn.programConfigurations.get(p.id),Wt=b.isTileAffectedByFog(Zt),Gt=b.getOrCreateProgram(st,{config:bt,defines:oe?[...rt,"ELEVATED"]:rt,overrideFog:Wt});if(et&&kt.imageAtlas){const xn=kt.imageAtlas.patternPositions[et.toString()];xn&&bt.setConstantPatternPositions(xn)}if(!He&&Ne&&De&&kt.lineAtlas){const xn=kt.lineAtlas.getDash(Ne,De);xn&&bt.setConstantPatternPositions(xn)}let[fn,pn]=p.paint.get("line-trim-offset");(De==="round"||De==="square")&&fn!==pn&&(fn===0&&(fn-=1),pn===1&&(pn+=1));const qt=ve?Zt.projMatrix:null,en=He?o.cW(b,kt,p,qt,_e,[fn,pn]):o.cX(b,kt,p,qt,hn.lineClipsArray.length,_e,[fn,pn]);if(ut){const xn=hn.gradients[p.id];let Dn=xn.texture;if(p.gradientVersion!==xn.version){let yr=256;if(p.stepInterpolant){const qn=u.getSource().maxzoom,ur=Zt.canonical.z===qn?Math.ceil(1<<b.transform.maxZoom-Zt.canonical.z):1;yr=o.ap(o.cY(hn.maxLineLength/o.ab*1024*ur),256,$.maxTextureSize)}xn.gradient=o.cZ({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:yr,image:xn.gradient||void 0,clips:hn.lineClipsArray}),xn.texture?xn.texture.update(xn.gradient):xn.texture=new o.T($,xn.gradient,J.RGBA8),xn.version=p.gradientVersion,Dn=xn.texture}$.activeTexture.set(J.TEXTURE1),Dn.bind(p.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}we&&($.activeTexture.set(J.TEXTURE0),kt.lineAtlasTexture&&kt.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),bt.updatePaintBuffers()),He&&($.activeTexture.set(J.TEXTURE0),kt.imageAtlasTexture&&kt.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),bt.updatePaintBuffers()),oe&&b.terrain.setupElevationDraw(kt,Gt),b.uploadCommonUniforms($,Gt,Zt.toUnwrapped());const er=xn=>{xt!=null&&(xt.value=Ke*W),Gt.draw(b,J.TRIANGLES,le,xn,ue,_r.disabled,en,p.id,hn.layoutVertexBuffer,hn.indexBuffer,hn.segments,p.paint,b.transform.zoom,bt,[hn.layoutVertexBuffer2,hn.patternVertexBuffer,hn.zOffsetVertexBuffer]),xt!=null&&(xt.value=Ke)};if(tt&&!oe){const xn=b.stencilModeForClipping(Zt).ref;xn===0&&ve&&$.clear({stencil:0});const Dn={func:J.EQUAL,mask:255};en.u_alpha_discard_threshold=.8,er(new pr(Dn,xn,255,J.KEEP,J.KEEP,J.INVERT)),en.u_alpha_discard_threshold=0,er(new pr(Dn,xn,255,J.KEEP,J.KEEP,J.KEEP))}else tt&&oe&&(en.u_alpha_discard_threshold=.001),er(oe?Ft:b.stencilModeForClipping(Zt))}tt&&(b.resetStencilClippingMasks(),ve&&$.clear({stencil:0})),W===0||b.depthOcclusion||ve||b.layersWithOcclusionOpacity.push(b.currentLayer),oe&&(b.forceTerrainMode=!1)},fill:function(b,u,p,w){const I=p.paint.get("fill-color"),P=p.paint.get("fill-opacity"),F=p.is3D(),W=new $n(b.context.gl.LEQUAL,$n.ReadWrite,b.depthRangeFor3D);if(P.constantOr(1)===0)return;const $=p.paint.get("fill-emissive-strength"),J=b.colorModeForDrapableLayerRenderPass($),Q=p.paint.get("fill-pattern"),oe=b.opaquePassEnabledForLayer()&&!Q.constantOr(1)&&I.constantOr(o.bz.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===oe){const le=F?W:b.depthModeForSublayer(1,b.renderPass==="opaque"?$n.ReadWrite:$n.ReadOnly);Cd(b,u,p,w,le,J,!1)}if(!F&&b.renderPass==="translucent"&&p.paint.get("fill-antialias")){const le=F?W:b.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,$n.ReadOnly);Cd(b,u,p,w,le,J,!0)}},"fill-extrusion":function(b,u,p,w){const I=p.paint.get("fill-extrusion-opacity"),P=b.context,F=P.gl,W=b.terrain,$=W&&W.renderingToTexture;if(I===0)return;const J=b.conflationActive&&b.style.isLayerClipped(p,u.getSource()),Q=b.style.order.indexOf(p.fqid);if(J&&function(oe,le,ue,ve,_e){for(const be of ve){const we=le.getTile(be).getBucket(ue);we&&(we.updateReplacement(be,oe.replacementSource,_e),we.uploadCentroid(oe.context))}}(b,u,p,w,Q),W||J)for(const oe of w){const le=u.getTile(oe).getBucket(p);le&&oc(b.context,u,oe,le,p,W,J)}if(b.renderPass==="shadow"&&b.shadowRenderer){const oe=b.shadowRenderer;if(W&&I<.65&&p._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const le=oe.getShadowPassDepthMode(),ue=oe.getShadowPassColorMode();lf(b,u,p,w,le,pr.disabled,ue,J)}else if(b.renderPass==="translucent"){const oe=!p.paint.get("fill-extrusion-pattern").constantOr(1),le=p.paint.get("fill-extrusion-color").constantOr(o.bz.white);if(!$&&le.a!==0){const ue=new $n(b.context.gl.LEQUAL,$n.ReadWrite,b.depthRangeFor3D);I===1&&oe?lf(b,u,p,w,ue,pr.disabled,Mr.unblended,J):(lf(b,u,p,w,ue,pr.disabled,Mr.disabled,J),lf(b,u,p,w,ue,b.stencilModeFor3D(),b.colorModeForRenderPass(),J),b.resetStencilClippingMasks())}if(b.style.enable3dLights()&&oe&&(!W&&b.transform.projection.name!=="globe"||$)){const ue=p.paint.get("fill-extrusion-opacity"),ve=p.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e=p.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),be=p.paint.get("fill-extrusion-flood-light-intensity"),we=p.paint.get("fill-extrusion-flood-light-color").toRenderColor(p.lut).toArray01().slice(0,3),ke=ve>0&&_e>0,Ne=be>0,De=(He,et,Ke)=>(1-Ke)*He+Ke*et,We=He=>{const et=b.depthModeForSublayer(1,$n.ReadOnly,F.LEQUAL,!0),Ke=p.paint.get(He?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),tt=De(.1,3,Ke),ut=b._showOverdrawInspector;if(!ut){const st=new pr({func:F.ALWAYS,mask:255},255,255,F.KEEP,F.KEEP,F.REPLACE),rt=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],o.bz.transparent,[!1,!1,!1,!0],F.MIN);lo(b,u,p,w,et,st,rt,_r.disabled,He,"sdf",ue,ve,_e,be,we,tt,J,!1)}{const st=ut?pr.disabled:new pr({func:F.EQUAL,mask:255},255,255,F.KEEP,F.DECR,F.DECR),rt=ut?b.colorModeForRenderPass():new Mr([F.ONE_MINUS_DST_ALPHA,F.DST_ALPHA,F.ONE,F.ONE],o.bz.transparent,[!0,!0,!0,!0]);lo(b,u,p,w,et,st,rt,_r.disabled,He,"color",ue,ve,_e,be,we,tt,J,!1)}};if($){const He=(et,Ke,tt)=>{const ut=b.depthModeForSublayer(1,$n.ReadOnly,F.LEQUAL,!1),st=p.paint.get(et?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),rt=De(.1,3,st);{const xt=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],o.bz.transparent,[!1,!1,!1,!0]);lo(b,u,p,w,ut,pr.disabled,xt,_r.disabled,et,"clear",ue,ve,_e,be,we,rt,J,Ke)}{const xt=new pr({func:F.ALWAYS,mask:255},255,255,F.KEEP,F.KEEP,F.REPLACE),Ft=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],o.bz.transparent,[!1,!1,!1,!0],F.MIN);lo(b,u,p,w,ut,xt,Ft,_r.disabled,et,"sdf",ue,ve,_e,be,we,rt,J,Ke)}{const xt=et?F.ZERO:F.ONE_MINUS_DST_ALPHA,Ft=new pr({func:F.EQUAL,mask:255},255,255,F.KEEP,F.DECR,F.DECR),Zt=new Mr([xt,F.DST_ALPHA,F.ONE_MINUS_DST_ALPHA,F.ZERO],o.bz.transparent,[!0,!0,!0,!0]);lo(b,u,p,w,ut,Ft,Zt,_r.disabled,et,"color",ue,ve,_e,be,we,rt,J,Ke)}{const xt=new Mr([F.ONE,F.ONE,F.ONE,et?F.ZERO:F.ONE],o.bz.transparent,[!1,!1,!1,!0],et?F.FUNC_ADD:F.MAX);lo(b,u,p,w,ut,pr.disabled,xt,_r.disabled,et,"clear",ue,ve,_e,be,we,rt,J,Ke,tt)}};if(ke||Ne){let et;if(b.prepareDrawTile(),W){const Ke=W.drapeBufferSize[0],tt=W.drapeBufferSize[1];et=W.framebufferCopyTexture,et&&(!et||et.size[0]===Ke&&et.size[1]===tt)||(et&&et.destroy(),et=W.framebufferCopyTexture=new o.T(P,new o.r({width:Ke,height:tt}),F.RGBA8)),et.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.copyTexImage2D(F.TEXTURE_2D,0,F.RGBA,0,0,Ke,tt,0)}ke&&He(!0,!1,et),Ne&&He(!1,!0,et)}}else ke&&We(!0),Ne&&We(!1),(ke||Ne)&&b.resetStencilClippingMasks()}}},hillshade:function(b,u,p,w){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent"||b.style.disableElevatedTerrain)return;const I=b.context,P=b.terrain&&b.terrain.renderingToTexture,[F,W]=b.renderPass!=="translucent"||P?[{},w]:b.stencilConfigForOverlap(w);for(const $ of W){const J=u.getTile($);if(J.needsHillshadePrepare&&b.renderPass==="offscreen")ic(b,J,p);else if(b.renderPass==="translucent"){const Q=b.depthModeForSublayer(0,$n.ReadOnly),oe=p.paint.get("hillshade-emissive-strength"),le=b.colorModeForDrapableLayerRenderPass(oe),ue=P&&b.terrain?b.terrain.stencilModeForRTTOverlap($):F[$.overscaledZ];Ml(b,$,J,p,Q,ue,le)}}I.viewport.set([0,0,b.width,b.height]),b.resetStencilClippingMasks()},raster:function(b,u,p,w,I,P){if(b.renderPass!=="translucent"||p.paint.get("raster-opacity")===0)return;const F=b.transform.projection.name==="globe",W=p.paint.get("raster-elevation")!==0,$=W&&F;if(b.renderElevatedRasterBackface&&!$)return;const J=b.context,Q=J.gl,oe=u.getSource(),le=function(He,et,Ke,tt){const ut=et.paint.get("raster-color"),st=He.type==="raster-array",rt=[],xt=et.paint.get("raster-resampling"),Ft=et.paint.get("raster-color-mix");let Zt=et.paint.get("raster-color-range");const kt=[Ft[0],Ft[1],Ft[2],0],hn=Ft[3];let bt=xt==="nearest"?tt.NEAREST:tt.LINEAR;if(st&&(rt.push("RASTER_ARRAY"),ut||rt.push("RASTER_COLOR"),xt==="linear"&&rt.push("RASTER_ARRAY_LINEAR"),bt=tt.NEAREST,!Zt&&He.rasterLayers)){const Wt=He.rasterLayers.find(({id:Gt})=>Gt===et.sourceLayer);Wt&&Wt.fields&&Wt.fields.range&&(Zt=Wt.fields.range)}if(Zt=Zt||[0,1],ut){rt.push("RASTER_COLOR"),Ke.activeTexture.set(tt.TEXTURE2),et.updateColorRamp(Zt);let Wt=et.colorRampTexture;Wt||(Wt=et.colorRampTexture=new o.T(Ke,et.colorRamp,tt.RGBA8)),Wt.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}return{mix:kt,range:Zt,offset:hn,defines:rt,resampling:bt}}(oe,p,J,Q);if(oe instanceof o.aD&&!w.length&&!F)return;const ue=p.paint.get("raster-emissive-strength"),ve=b.colorModeForDrapableLayerRenderPass(ue),_e=b.terrain&&b.terrain.renderingToTexture,be=!b.options.moving,we=p.paint.get("raster-resampling")==="nearest"?Q.NEAREST:Q.LINEAR;if(oe instanceof o.aD&&!w.length&&(oe.onNorthPole||oe.onSouthPole)){const He=W?b.stencilModeFor3D():pr.disabled;return void Fa(!!oe.onNorthPole,null,b,u,p,ue,le,_r.disabled,He)}if(!w.length)return;const[ke,Ne]=oe instanceof o.aD||_e?[{},w]:b.stencilConfigForOverlap(w),De=Ne[Ne.length-1].overscaledZ;$&&le.defines.push("PROJECTION_GLOBE_VIEW"),W&&le.defines.push("RENDER_CUTOFF");const We=(He,et,Ke)=>{for(const tt of He){const ut=tt.toUnwrapped(),st=u.getTile(tt);if(_e&&(!st||!st.hasData()))continue;J.activeTexture.set(Q.TEXTURE0);const rt=cf(st,oe,p,le);if(!rt||!rt.texture)continue;const{texture:xt,mix:Ft,offset:Zt,tileSize:kt,buffer:hn}=rt;let bt,Wt;_e?(bt=$n.disabled,Wt=tt.projMatrix):W?(bt=new $n(Q.LEQUAL,$n.ReadWrite,b.depthRangeFor3D),Wt=F?Float32Array.from(b.transform.expandedFarZProjMatrix):b.transform.calculateProjMatrix(ut,be)):(bt=b.depthModeForSublayer(tt.overscaledZ-De,p.paint.get("raster-opacity")===1?$n.ReadWrite:$n.ReadOnly,Q.LESS),Wt=b.transform.calculateProjMatrix(ut,be));const Gt=b.terrain&&_e?b.terrain.stencilModeForRTTOverlap(tt):ke[tt.overscaledZ],fn=P?0:p.paint.get("raster-fade-duration");st.registerFadeDuration(fn);const pn=u.findLoadedParent(tt,0),qt=Yu(st,pn,u,b.transform,fn);let en,er;b.terrain&&b.terrain.prepareDrawTile(),J.activeTexture.set(Q.TEXTURE0),xt.bind(we,Q.CLAMP_TO_EDGE),J.activeTexture.set(Q.TEXTURE1),pn?(pn.texture&&pn.texture.bind(we,Q.CLAMP_TO_EDGE),en=Math.pow(2,pn.tileID.overscaledZ-st.tileID.overscaledZ),er=[st.tileID.canonical.x*en%1,st.tileID.canonical.y*en%1]):xt.bind(we,Q.CLAMP_TO_EDGE),xt.useMipmap&&J.extTextureFilterAnisotropic&&b.transform.pitch>20&&Q.texParameterf(Q.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const xn=b.transform;let Dn;const yr=W?ds(xn):[0,0,0,0];let qn,ur,Ur,Br,Ci,zi=0;if($&&oe instanceof o.aD&&oe.coordinates.length>3)qn=Float32Array.from(o.b5(o.cC(new o.bP(0,0,0)))),ur=Float32Array.from(xn.globeMatrix),Ur=Float32Array.from(o.cy(xn)),Br=[o.am(xn.center.lng),o.at(xn.center.lat)],Dn=oe.elevatedGlobePerspectiveTransform,Ci=oe.elevatedGlobeGridMatrix||new Float32Array(9);else if($){const Yr=o.cz(tt.canonical);zi=o.cA(Yr.getCenter().lat),qn=Float32Array.from(o.b5(o.cC(tt.canonical))),ur=Float32Array.from(xn.globeMatrix),Ur=Float32Array.from(o.cy(xn)),Br=[o.am(xn.center.lng),o.at(xn.center.lat)],Dn=[0,0],Ci=Float32Array.from(o.cB(tt.canonical,Yr,zi,xn.worldSize/xn._pixelsPerMercatorPixel))}else Dn=oe instanceof o.aD?oe.perspectiveTransform:[0,0],qn=new Float32Array(16),ur=new Float32Array(9),Ur=new Float32Array(16),Br=[0,0],Ci=new Float32Array(9);const is=wd(Wt,qn,ur,Ur,Ci,er||[0,0],o.a9(b.transform.zoom),Br,yr,en||1,qt,p,Dn,W?p.paint.get("raster-elevation"):0,2,Ft,Zt,le.range,kt,hn,ue),Wc=b.isTileAffectedByFog(tt),Qs=b.getOrCreateProgram("raster",{defines:le.defines,overrideFog:Wc});if(b.uploadCommonUniforms(J,Qs,ut),oe instanceof o.aD){const Yr=oe.elevatedGlobeVertexBuffer,Fi=oe.elevatedGlobeIndexBuffer;if(_e||!F)oe.boundsBuffer&&oe.boundsSegments&&Qs.draw(b,Q.TRIANGLES,bt,pr.disabled,ve,_r.disabled,is,p.id,oe.boundsBuffer,b.quadTriangleIndexBuffer,oe.boundsSegments);else if(Yr&&Fi){const ws=xn.zoom<=o.c2?oe.elevatedGlobeSegments:oe.getSegmentsForLongitude(xn.center.lng);ws&&Qs.draw(b,Q.TRIANGLES,bt,pr.disabled,ve,et,is,p.id,Yr,Fi,ws)}}else if($){bt=new $n(Q.LEQUAL,$n.ReadOnly,b.depthRangeFor3D);const Yr=b.globeSharedBuffers;if(Yr){const[Fi,ws,Li]=Yr.getGridBuffers(zi,!1);Qs.draw(b,Q.TRIANGLES,bt,Ke||Gt,b.colorModeForRenderPass(),et,is,p.id,Fi,ws,Li)}}else{const{tileBoundsBuffer:Yr,tileBoundsIndexBuffer:Fi,tileBoundsSegments:ws}=b.getTileBoundsBuffers(st);Qs.draw(b,Q.TRIANGLES,bt,Gt,ve,_r.disabled,is,p.id,Yr,Fi,ws)}}if(!(oe instanceof o.aD)&&$)for(const tt of He){const ut=tt.canonical.y===(1<<tt.canonical.z)-1;tt.canonical.y===0&&Fa(!0,tt,b,u,p,ue,le,et,Ke||pr.disabled),ut&&Fa(!1,tt,b,u,p,ue,le,et===_r.frontCW?_r.backCW:_r.frontCW,Ke||pr.disabled)}};$?We(Ne,b.renderElevatedRasterBackface?_r.backCW:_r.frontCW,b.stencilModeFor3D()):We(Ne,_r.disabled,void 0),b.resetStencilClippingMasks()},"raster-particle":function(b,u,p,w,I,P){b.renderPass==="offscreen"&&function(F,W,$,J){if(!J.length)return;const Q=F.context,oe=Q.gl,le=W.getSource();if(!(le instanceof Er))return;const ue=Math.ceil(Math.sqrt($.paint.get("raster-particle-count")));let ve=$.particlePositionRGBAImage;if(!ve||ve.width!==ue){const Ne=function(De){const We=De*De,He=new Uint8Array(4*We),et=function(tt){return tt|=0,tt=Math.imul(2747636419^tt,2654435769),tt=Math.imul(tt^tt>>>16,2654435769),((tt=Math.imul(tt^tt>>>16,2654435769))>>>0)/4294967296},Ke=1/1.1;for(let tt=0;tt<We;tt++){const ut=Ke*(et(2*tt+0)+fl),st=Ke*(et(2*tt+1)+fl),rt=255*ut%1,xt=255*st%1,Ft=rt,Zt=st-xt/255,kt=xt;He[4*tt+0]=255*(ut-rt/255),He[4*tt+1]=255*Ft,He[4*tt+2]=255*Zt,He[4*tt+3]=255*kt}return He}(ue);ve=$.particlePositionRGBAImage=new o.r({width:ue,height:ue},Ne)}let _e=$.particleFramebuffer;_e?_e.width!==ue&&(_e.destroy(),_e=$.particleFramebuffer=Q.createFramebuffer(ue,ue,!0,null)):_e=$.particleFramebuffer=Q.createFramebuffer(ue,ue,!0,null);const be=[];for(const Ne of J){const De=W.getTile(Ne);if(!(De instanceof og))continue;const We=Qp(De,le,$);if(!We)continue;const He=[De.tileSize,De.tileSize];let et=$.tileFramebuffer;et||(et=$.tileFramebuffer=Q.createFramebuffer(He[0],He[1],!0,null));let Ke=De.rasterParticleState;Ke||(Ke=De.rasterParticleState=new Jp(Q,Ne,He,ve));const tt=Ke.update($.lastInvalidatedAt);Ke.particleTextureDimension!==ue&&Ke.updateParticleTexture(Ne,ve);const ut=Ke.targetColorTexture;Ke.targetColorTexture=Ke.backgroundColorTexture,Ke.backgroundColorTexture=ut;const st=Ke.particleTexture0;Ke.particleTexture0=Ke.particleTexture1,Ke.particleTexture1=st,be.push([Ne,We,Ke,tt])}if(be.length===0)return;const we=o.q.now(),ke=$.previousDrawTimestamp?.001*(we-$.previousDrawTimestamp):.0167;if($.previousDrawTimestamp=we,$.hasColorMap()){Q.activeTexture.set(oe.TEXTURE0+2);let Ne=$.colorRampTexture;Ne||(Ne=$.colorRampTexture=new o.T(Q,$.colorRamp,oe.RGBA8)),Ne.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)}Q.bindFramebuffer.set($.tileFramebuffer.framebuffer),function(Ne,De,We){const He=Ne.context,et=He.gl,Ke=De.tileFramebuffer;He.activeTexture.set(et.TEXTURE0);const tt={u_texture:0,u_opacity:1.05*(st=De.paint.get("raster-particle-fade-opacity-factor"))/(st+.05)},ut=Ne.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var st;for(const rt of We){const[,,xt,Ft]=rt;Ke.colorAttachment.set(xt.targetColorTexture.texture),He.viewport.set([0,0,Ke.width,Ke.height]),He.clear({color:o.bz.transparent}),Ft&&(xt.backgroundColorTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE),ut.draw(Ne,et.TRIANGLES,$n.disabled,pr.disabled,Mr.alphaBlended,_r.disabled,tt,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments))}}(F,$,be),function(Ne,De,We,He){const et=Ne.context,Ke=et.gl,tt=We.tileFramebuffer,ut=Ne.transform.projection.name==="globe",st=We.paint.get("raster-particle-max-speed");for(const rt of He){const[xt,Ft,Zt]=rt;et.activeTexture.set(Ke.TEXTURE0+0),Ft.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),tt.colorAttachment.set(Zt.targetColorTexture.texture);const kt=Ne.getOrCreateProgram("rasterParticleDraw",{defines:Ft.defines,overrideFog:!1});et.activeTexture.set(Ke.TEXTURE0+1);const hn=Ft.scalarData?[]:[0,1,2,3].map(Gt=>o.c$[Gt](xt));hn.push(xt);const bt=xt.canonical.x,Wt=xt.canonical.y;for(const Gt of hn){const fn=De.getTile(ut?Gt.wrapped():Gt);if(!fn)continue;const pn=fn.rasterParticleState;if(!pn)continue;const qt=Gt.canonical.x+(1<<Gt.canonical.z)*(Gt.wrap-xt.wrap),en=Gt.canonical.y;pn.particleTexture0.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const er=Sd(1,pn.particleTexture0.size[0],[qt-bt,en-Wt],0,Ft.texture.size,2,st,Ft.textureOffset,Ft.scale,Ft.offset);kt.draw(Ne,Ke.POINTS,$n.disabled,pr.disabled,Mr.alphaBlended,_r.disabled,er,We.id,pn.particleIndexBuffer,void 0,pn.particleSegment)}}}(F,W,$,be),Q.bindFramebuffer.set($.particleFramebuffer.framebuffer),function(Ne,De,We,He){const et=Ne.context,Ke=et.gl,tt=De.paint.get("raster-particle-max-speed"),ut=He*De.paint.get("raster-particle-speed-factor")*.15,st=function(xt){return Math.pow(xt,6)}(.01+1*De.paint.get("raster-particle-reset-rate-factor")),rt=De.particleFramebuffer;et.viewport.set([0,0,rt.width,rt.height]);for(const xt of We){const[,Ft,Zt]=xt;et.activeTexture.set(Ke.TEXTURE0+0),Ft.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),et.activeTexture.set(Ke.TEXTURE0+1);const kt=Zt.particleTexture0;kt.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const hn=qp(1,kt.size[0],0,Ft.texture.size,tt,ut,st,Ft.textureOffset,Ft.scale,Ft.offset);rt.colorAttachment.set(Zt.particleTexture1.texture),et.clear({color:o.bz.transparent}),Ne.getOrCreateProgram("rasterParticleUpdate",{defines:Ft.defines}).draw(Ne,Ke.TRIANGLES,$n.disabled,pr.disabled,Mr.unblended,_r.disabled,hn,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments)}}(F,$,be,ke)}(b,u,p,w),b.renderPass==="translucent"&&(function(F,W,$,J,Q){const oe=F.context,le=oe.gl,ue=W.getSource().tileSize,ve=5*(1-o.a7(o.bU,o.bU+1,F.transform.zoom))*ue+$.paint.get("raster-particle-elevation"),_e=!F.options.moving,be=F.transform.projection.name==="globe";if(!J.length)return;const[we,ke]=F.stencilConfigForOverlap(J),Ne=[];be&&Ne.push("PROJECTION_GLOBE_VIEW");const De=F.stencilModeFor3D();for(const We of ke){const He=We.toUnwrapped(),et=W.getTile(We);if(!et.rasterParticleState)continue;const Ke=et.rasterParticleState,tt=100;et.registerFadeDuration(tt);const ut=W.findLoadedParent(We,0),st=Yu(et,ut,W,F.transform,tt);let rt,xt;F.terrain&&F.terrain.prepareDrawTile(),oe.activeTexture.set(le.TEXTURE0),Ke.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),oe.activeTexture.set(le.TEXTURE1),ut&&ut.rasterParticleState?(ut.rasterParticleState.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),rt=Math.pow(2,ut.tileID.overscaledZ-et.tileID.overscaledZ),xt=[et.tileID.canonical.x*rt%1,et.tileID.canonical.y*rt%1]):Ke.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Ft=be?Float32Array.from(F.transform.expandedFarZProjMatrix):F.transform.calculateProjMatrix(He,_e),Zt=F.transform,kt=Id(Zt),hn=o.cz(We.canonical),bt=o.cA(hn.getCenter().lat);let Wt,Gt,fn,pn,qt;be?(Wt=Float32Array.from(o.b5(o.cC(We.canonical))),Gt=Float32Array.from(Zt.globeMatrix),fn=Float32Array.from(o.cy(Zt)),pn=[o.am(Zt.center.lng),o.at(Zt.center.lat)],qt=Float32Array.from(o.cB(We.canonical,hn,bt,Zt.worldSize/Zt._pixelsPerMercatorPixel))):(Wt=new Float32Array(16),Gt=new Float32Array(9),fn=new Float32Array(16),pn=[0,0],qt=new Float32Array(9));const en=e_(Ft,Wt,Gt,fn,qt,xt||[0,0],o.a9(F.transform.zoom),pn,kt,rt||1,st,ve),er=F.isTileAffectedByFog(We),xn=F.getOrCreateProgram("rasterParticle",{defines:Ne,overrideFog:er});if(F.uploadCommonUniforms(oe,xn,He),be){const Dn=new $n(le.LEQUAL,$n.ReadOnly,F.depthRangeFor3D),yr=0,qn=F.globeSharedBuffers;if(qn){const[ur,Ur,Br]=qn.getGridBuffers(bt,yr!==0);xn.draw(F,le.TRIANGLES,Dn,De,Mr.alphaBlended,F.renderElevatedRasterBackface?_r.frontCCW:_r.backCCW,en,$.id,ur,Ur,Br)}}else{const Dn=F.depthModeForSublayer(0,$n.ReadOnly),yr=we[We.overscaledZ],{tileBoundsBuffer:qn,tileBoundsIndexBuffer:ur,tileBoundsSegments:Ur}=F.getTileBoundsBuffers(et);xn.draw(F,le.TRIANGLES,Dn,yr,Mr.alphaBlended,_r.disabled,en,$.id,qn,ur,Ur)}}F.resetStencilClippingMasks()}(b,u,p,w),b.style.map.triggerRepaint())},background:function(b,u,p,w){const I=p.paint.get("background-color"),P=p.paint.get("background-opacity"),F=p.paint.get("background-emissive-strength"),W=p.paint.get("background-pitch-alignment")==="viewport";if(P===0)return;const $=b.context,J=$.gl,Q=b.transform,oe=Q.tileSize,le=p.paint.get("background-pattern");let ue;if(le!==void 0&&(le===null||(ue=b.imageManager.getPattern(le.toString(),p.scope,b.style.getLut(p.scope)),!ue)))return;const ve=!le&&I.a===1&&P===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ve)return;const _e=pr.disabled,be=b.depthModeForSublayer(0,ve==="opaque"?$n.ReadWrite:$n.ReadOnly),we=b.colorModeForDrapableLayerRenderPass(F),ke=le?"backgroundPattern":"background";let Ne,De=w;if(De||(Ne=b.getBackgroundTiles(),De=Object.values(Ne).map(We=>We.tileID)),le&&($.activeTexture.set(J.TEXTURE0),b.imageManager.bind(b.context,p.scope)),W){const We=b.getOrCreateProgram(ke,{overrideFog:!1,overrideRtt:!0}),He=new Float32Array(o.a6.mat4.identity([])),et=new o.aA(0,0,0,0,0),Ke=le?Uc(He,F,P,b,0,p.scope,ue,W,{tileID:et,tileSize:oe}):L1(He,F,P,I.toRenderColor(p.lut));We.draw(b,J.TRIANGLES,be,_e,we,_r.disabled,Ke,p.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments)}else for(const We of De){const He=b.isTileAffectedByFog(We),et=b.getOrCreateProgram(ke,{overrideFog:He}),Ke=We.toUnwrapped(),tt=w?We.projMatrix:b.transform.calculateProjMatrix(Ke);b.prepareDrawTile();const ut=u?u.getTile(We):Ne?Ne[We.key]:new kc(We,oe,Q.zoom,b),st=le?Uc(tt,F,P,b,0,p.scope,ue,W,{tileID:We,tileSize:oe}):L1(tt,F,P,I.toRenderColor(p.lut));b.uploadCommonUniforms($,et,Ke);const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:xt,tileBoundsSegments:Ft}=b.getTileBoundsBuffers(ut);et.draw(b,J.TRIANGLES,be,_e,we,_r.disabled,st,p.id,rt,xt,Ft)}},sky:function(b,u,p){const w=b._atmosphere?o.a9(b.transform.zoom):1,I=p.paint.get("sky-opacity")*w;if(I===0)return;const P=b.context,F=p.paint.get("sky-type"),W=new $n(P.gl.LEQUAL,$n.ReadOnly,[0,1]),$=b.frameCounter/1e3%1;F==="atmosphere"?b.renderPass==="offscreen"?p.needsSkyboxCapture(b)&&(function(J,Q,oe,le){const ue=J.context,ve=ue.gl;let _e=Q.skyboxFbo;if(!_e){_e=Q.skyboxFbo=ue.createFramebuffer(32,32,!0,null),Q.skyboxGeometry=new Bo(ue),Q.skyboxTexture=ue.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,Q.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Ne=0;Ne<6;++Ne)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}ue.bindFramebuffer.set(_e.framebuffer),ue.viewport.set([0,0,32,32]);const be=Q.getCenter(J,!0),we=J.getOrCreateProgram("skyboxCapture"),ke=new Float64Array(16);o.a6.mat4.identity(ke),o.a6.mat4.rotateY(ke,ke,.5*-Math.PI),ko(J,Q,we,ke,be,0),o.a6.mat4.identity(ke),o.a6.mat4.rotateY(ke,ke,.5*Math.PI),ko(J,Q,we,ke,be,1),o.a6.mat4.identity(ke),o.a6.mat4.rotateX(ke,ke,.5*-Math.PI),ko(J,Q,we,ke,be,2),o.a6.mat4.identity(ke),o.a6.mat4.rotateX(ke,ke,.5*Math.PI),ko(J,Q,we,ke,be,3),o.a6.mat4.identity(ke),ko(J,Q,we,ke,be,4),o.a6.mat4.identity(ke),o.a6.mat4.rotateY(ke,ke,Math.PI),ko(J,Q,we,ke,be,5),ue.viewport.set([0,0,J.width,J.height])}(b,p),p.markSkyboxValid(b)):b.renderPass==="sky"&&function(J,Q,oe,le,ue){const ve=J.context,_e=ve.gl,be=J.transform,we=J.getOrCreateProgram("skybox");ve.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Q.skyboxTexture);const ke=((Ne,De,We,He,et)=>({u_matrix:Ne,u_sun_direction:De,u_cubemap:0,u_opacity:He,u_temporal_offset:et}))(be.skyboxMatrix,Q.getCenter(J,!1),0,le,ue);J.uploadCommonUniforms(ve,we),we.draw(J,_e.TRIANGLES,oe,pr.disabled,J.colorModeForRenderPass(),_r.backCW,ke,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(b,p,W,I,$):F==="gradient"&&b.renderPass==="sky"&&function(J,Q,oe,le,ue){const ve=J.context,_e=ve.gl,be=J.transform,we=J.getOrCreateProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Bo(ve)),ve.activeTexture.set(_e.TEXTURE0);let ke=Q.colorRampTexture;ke||(ke=Q.colorRampTexture=new o.T(ve,Q.colorRamp,_e.RGBA8)),ke.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Ne=((De,We,He,et,Ke)=>({u_matrix:De,u_color_ramp:0,u_center_direction:We,u_radius:o.bB(He),u_opacity:et,u_temporal_offset:Ke}))(be.skyboxMatrix,Q.getCenter(J,!1),Q.paint.get("sky-gradient-radius"),le,ue);J.uploadCommonUniforms(ve,we),we.draw(J,_e.TRIANGLES,oe,pr.disabled,J.colorModeForRenderPass(),_r.backCW,Ne,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(b,p,W,I,$)},debug:function(b,u,p,w,I,P){for(let F=0;F<p.length;F++)if(I){const J=new o.bz(w.r*.8,w.g*.8,w.b*.8,1);ac(b,u,p[F],w,-1,-1,P),ac(b,u,p[F],w,-1,1,P),ac(b,u,p[F],w,1,1,P),ac(b,u,p[F],w,1,-1,P),ac(b,u,p[F],J,0,0,P)}else ac(b,u,p[F],w,0,0,P)},custom:function(b,u,p,w){const I=b.context,P=p.implementation;if(!b.transform.projection.unsupportedLayers||!b.transform.projection.unsupportedLayers.includes("custom")||b.terrain&&(b.terrain.renderingToTexture||b.renderPass==="offscreen")&&p.isDraped(u)){if(b.renderPass==="offscreen"){const F=P.prerender;if(F){if(b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),b.transform.projection.name==="globe"){const W=b.transform.pointMerc;F.call(P,I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),o.a9(b.transform.zoom),[W.x,W.y],b.transform.pixelsPerMeterRatio)}else F.call(P,I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState()}}else if(b.renderPass==="translucent"){if(b.terrain&&b.terrain.renderingToTexture){const W=P.renderToTile;if(W){const $=w[0].canonical,J=new o.a5($.x+w[0].wrap*(1<<$.z),$.y,$.z);I.setDepthMode($n.disabled),I.setStencilMode(pr.disabled),I.setColorMode(b.colorModeForRenderPass()),b.setCustomLayerDefaults(),W.call(P,I.gl,J),I.setDirty(),b.setBaseState()}return}b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),I.setStencilMode(pr.disabled);const F=P.renderingMode==="3d"?new $n(b.context.gl.LEQUAL,$n.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,$n.ReadOnly);if(I.setDepthMode(F),b.transform.projection.name==="globe"){const W=b.transform.pointMerc;P.render(I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),o.a9(b.transform.zoom),[W.x,W.y],b.transform.pixelsPerMeterRatio)}else P.render(I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState(),I.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(b,u,p,w){if(b.renderPass==="opaque")return;const I=p.paint.get("model-opacity");if(I===0)return;const P=p.paint.get("model-cast-shadows");if(b.renderPass==="shadow"&&(!P||b.terrain&&I<.65&&p._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const F=b.shadowRenderer,W=p.paint.get("model-receive-shadows");F&&(F.useNormalOffset=!0,W||(F.enabled=!1));const $=()=>{F&&(F.useNormalOffset=!0,W||(F.enabled=!0))},J=u.getSource();if(b.renderPass==="light-beam"&&J.type!=="batched-model")return;if(J.type==="vector"||J.type==="geojson")return function(we,ke,Ne,De,We){const He=we.transform;if(He.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${He.projection.name} projection is not yet implemented`);const et=He.getFreeCameraOptions().position;if(!we.modelManager)return;const Ke=we.modelManager;Ne.modelManager=Ke;const tt=we.shadowRenderer;if(!Ne._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ut=Ne._unevaluatedLayout._values["model-id"],st={...Ne.layout.get("model-id").parameters},rt=we.style.order.indexOf(Ne.fqid);for(const xt of De){const Ft=ke.getTile(xt).getBucket(Ne);if(!Ft||Ft.projection.name!==He.projection.name)continue;const Zt=Ft.getModelUris();Zt&&!Ft.modelsRequested&&(Ke.addModelsFromBucket(Zt,We),Ft.modelsRequested=!0);const kt=i_(xt,He);st.zoom=kt;const hn=ut.possiblyEvaluate(st);if(df(we,Ft,xt),Ja.shadowUniformsInitialized=!1,Ja.useSingleShadowCascade=!!tt&&tt.getMaxCascadeForTile(xt.toUnwrapped())===0,we.renderPass==="shadow"&&tt){if(we.currentShadowCascade===1&&Ft.isInsideFirstShadowMapFrustum)continue;const Gt=He.calculatePosMatrix(xt.toUnwrapped(),He.worldSize);if(Ja.tileMatrix.set(Gt),Ja.shadowTileMatrix=Float32Array.from(tt.calculateShadowPassMatrixFromMatrix(Gt)),Ja.aabb.min.fill(0),Ja.aabb.max[0]=Ja.aabb.max[1]=o.ab,Ja.aabb.max[2]=0,Il(Ft,Ja,we,Ne.scope))continue}const bt=1<<xt.canonical.z,Wt=[((et.x-xt.wrap)*bt-xt.canonical.x)*o.ab,(et.y*bt-xt.canonical.y)*o.ab,et.z*bt*o.ab];we.conflationActive&&Object.keys(Ft.instancesPerModel).length>0&&we.style.isLayerClipped(Ne,ke.getSource())&&Ft.updateReplacement(xt,we.replacementSource,rt,We)&&(Ft.uploaded=!1,Ft.upload(we.context));for(let Gt in Ft.instancesPerModel){const fn=Ft.instancesPerModel[Gt];fn.features.length>0&&(Gt=hn.evaluate(fn.features[0].feature,{}));const pn=Ke.getModel(Gt,We);if(pn&&pn.uploaded)for(const qt of pn.nodes)Hs(we,Ne,qt,fn,Wt,xt,Ja)}}}(b,u,p,w,J.type==="vector"?p.scope:""),void $();if(!J.loaded())return;if(J.type==="batched-model")return function(we,ke,Ne,De){Ne.resetLayerRenderingStats(we);const We=we.context,He=we.transform,et=we.style.fog,Ke=we.shadowRenderer;if(He.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${He.projection.name} projection is not yet implemented`);const tt=we.transform.getFreeCameraOptions().position,ut=o.a6.vec3.scale([],[tt.x,tt.y,tt.z],we.transform.worldSize),st=o.a6.vec3.negate([],ut),rt=o.a6.mat4.identity([]),xt=o.de(He.center.lat,He.zoom),Ft=o.a6.mat4.fromScaling([],[1,1,1/xt]);o.a6.mat4.translate(rt,rt,st);const Zt=Ne.paint.get("model-opacity"),kt=new $n(We.gl.LEQUAL,$n.ReadWrite,we.depthRangeFor3D),hn=new $n(We.gl.LEQUAL,$n.ReadOnly,we.depthRangeFor3D),bt=new o.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Wt=we.renderPass==="shadow",Gt=Wt&&Ke?Ke.getCurrentCascadeFrustum():He.getFrustum(He.scaleZoom(He.worldSize)),fn=Ne.paint.get("model-front-cutoff"),pn=fn[2]<1,qt=nc(we,Ne.paint.get("model-cutoff-fade-range")),en=Ne.getLayerRenderingStats();(function(er,xn,Dn,yr){const qn=er.terrain?er.terrain.exaggeration():0,ur=er.transform.zoom;for(const Ur of yr){const Br=xn.getTile(Ur).getBucket(Dn);Br&&(er.conflationActive&&Br.updateReplacement(Ur,er.replacementSource),Br.evaluateScale(er,Dn),er.terrain&&qn>0&&Br.elevationUpdate(er.terrain,qn,Ur,Dn.source),Br.needsReEvaluation(er,ur,Dn)&&Br.evaluate(Dn))}})(we,ke,Ne,De),function(){let er,xn,Dn;pn?(er=De.length-1,xn=-1,Dn=-1):(er=0,xn=De.length,Dn=1);const yr=new Float64Array(16),qn=o.a6.vec3.create(),ur=new o.P(0,0);for(let Ur=er;Ur!==xn;Ur+=Dn){const Br=De[Ur],Ci=ke.getTile(Br).getBucket(Ne);if(!Ci||!Ci.uploaded)continue;let zi=!1;Ke&&(zi=Ke.getMaxCascadeForTile(Br.toUnwrapped())===0);const is=He.calculatePosMatrix(Br.toUnwrapped(),He.worldSize),Wc=Ci.modelTraits;!Wt&&pn&&(o.a6.mat4.invert(yr,is),o.a6.vec3.transformMat4(qn,ut,yr),ur.x=qn[0],ur.y=qn[1]);const Qs=[];for(const Yr of Ci.getNodesInfo()){if(Yr.hiddenByReplacement||!Yr.node.meshes)continue;const Fi=Yr.node;let ws=0;we.terrain&&Fi.elevation&&(ws=Fi.elevation*we.terrain.exaggeration());const Li=(()=>{const Yi=Yr.aabb;return bt.min=[...Yi.min],bt.max=[...Yi.max],bt.min[2]+=ws,bt.max[2]+=ws,o.a6.vec3.transformMat4(bt.min,bt.min,is),o.a6.vec3.transformMat4(bt.max,bt.max,is),bt})(),kr=Yr.evaluatedScale;if(kr[0]<=1&&kr[1]<=1&&kr[2]<=1&&Li.intersects(Gt)===0)continue;if(!Wt&&pn){const Yi=.16666666666666666;Yr.cameraCollisionOpacity=ut[0]>Li.min[0]&&ut[0]<Li.max[0]&&ut[1]>Li.min[1]&&ut[1]<Li.max[1]&&ut[2]*xt<Li.max[2]&&Fi.footprint&&o.bu(ur,Fi.footprint)?Math.max(Yr.cameraCollisionOpacity-Yi,0):Math.min(1,Yr.cameraCollisionOpacity+Yi)}const pi=[...is],Ai=Fi.anchor?Fi.anchor[0]:0,Ns=Fi.anchor?Fi.anchor[1]:0;o.a6.mat4.translate(pi,pi,[Ai*(kr[0]-1),Ns*(kr[1]-1),ws]),o.a6.vec3.exactEquals(kr,o.dh)||o.a6.mat4.scale(pi,pi,kr);const eo=o.a6.mat4.multiply([],pi,Fi.matrix),oi=o.a6.mat4.multiply([],He.expandedFarZProjMatrix,eo),Fo=o.a6.mat4.multiply([],He.expandedFarZProjMatrix,pi),Ko=o.a6.vec4.transformMat4([],[Ai,Ns,ws,1],oi)[2];Fi.hidden=!1;let No=Zt;Wt||(pn&&(No*=Yr.cameraCollisionOpacity,No*=Qr(pi,He,Yr.aabb,fn)),No*=Oi(qt,Ko)),No!==0?Qs.push({nodeInfo:Yr,depth:Ko,opacity:No,wvpForNode:oi,wvpForTile:Fo,nodeModelMatrix:eo,tileModelMatrix:pi}):Fi.hidden=!0}Wt||Qs.sort((Yr,Fi)=>!pn||Yr.opacity===1&&Fi.opacity===1?Yr.depth<Fi.depth?-1:1:Yr.opacity===1?-1:Fi.opacity===1?1:Yr.depth>Fi.depth?-1:1);for(const Yr of Qs){const Fi=Yr.nodeInfo,ws=Fi.node;let Li=o.a6.mat4.multiply([],Ft,Yr.tileModelMatrix);o.a6.mat4.multiply(Li,rt,Li);const kr=o.a6.mat4.invert([],Li);o.a6.mat4.transpose(kr,kr),o.a6.mat4.scale(kr,kr,Ng),Li=o.a6.mat4.multiply(Li,Li,ws.matrix);const pi=we.renderPass==="light-beam",Ai=Wc&o.dj.HasMapboxMeshFeatures,Ns=Ai?0:Fi.evaluatedRMEA[0][2];for(let eo=0;eo<ws.meshes.length;++eo){const oi=ws.meshes[eo],Fo=eo===ws.lightMeshIndex;let Ko=Yr.wvpForNode;if(Fo){if(!pi&&!we.terrain&&we.shadowRenderer){we.currentLayer<we.firstLightBeamLayer&&(we.firstLightBeamLayer=we.currentLayer);continue}Ko=Yr.wvpForTile}else if(pi)continue;const No={defines:[]},Yi=[];if(eh(No.defines,Yi,oi,we,Ne.lut),Ai||No.defines.push("DIFFUSE_SHADED"),zi&&No.defines.push("SHADOWS_SINGLE_CASCADE"),en&&(Wt?en.numRenderedVerticesInShadowPass+=oi.vertexArray.length:en.numRenderedVerticesInTransparentPass+=oi.vertexArray.length),Wt){th(oi,Yr.nodeModelMatrix,we,Ne);continue}let pl=null;if(et){const vf=Rd(Yr.nodeModelMatrix,we.transform);if(pl=new Float32Array(vf),He.projection.name!=="globe"){const Fd=oi.aabb.min,ih=oi.aabb.max,[$g,qg]=et.getOpacityForBounds(vf,Fd[0],Fd[1],ih[0],ih[1]);No.overrideFog=$g>=Mn||qg>=Mn}}const ml=oi.material;let Xc;ml.occlusionTexture&&ml.occlusionTexture.offsetScale&&(Xc=ml.occlusionTexture.offsetScale,No.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Wt&&Ke&&(Ke.useNormalOffset=!!oi.normalBuffer);const dc=we.getOrCreateProgram("model",No);!Wt&&Ke&&Ke.setupShadowsFromMatrix(Yr.tileModelMatrix,dc,Ke.useNormalOffset),we.uploadCommonUniforms(We,dc,null,pl);const Pl=ml.pbrMetallicRoughness;Pl.metallicFactor=.9,Pl.roughnessFactor=.5;const $c=Fn(new Float32Array(Ko),new Float32Array(Li),new Float32Array(kr),new Float32Array(ws.matrix),we,Yr.opacity,Pl.baseColorFactor.toRenderColor(null),ml.emissiveFactor,Pl.metallicFactor,Pl.roughnessFactor,ml,Ns,Ne,[0,0,0],Xc);!Fo&&(Fi.hasTranslucentParts||Yr.opacity<1)&&dc.draw(we,We.gl.TRIANGLES,kt,pr.disabled,Mr.disabled,_r.backCCW,$c,Ne.id,oi.vertexBuffer,oi.indexBuffer,oi.segments,Ne.paint,we.transform.zoom,void 0,Yi),dc.draw(we,We.gl.TRIANGLES,Fo?hn:kt,pr.disabled,Fo||Yr.opacity<1||Fi.hasTranslucentParts?Mr.alphaBlended:Mr.unblended,_r.backCCW,$c,Ne.id,oi.vertexBuffer,oi.indexBuffer,oi.segments,Ne.paint,we.transform.zoom,void 0,Yi)}}}}()}(b,u,p,w),void $();if(J.type!=="model")return;const Q=J.getModels(),oe=[],le=b.transform.getFreeCameraOptions().position,ue=o.a6.vec3.scale([],[le.x,le.y,le.z],b.transform.worldSize);o.a6.vec3.negate(ue,ue);const ve=[],_e=[];let be=0;for(const we of Q){const ke=p.paint.get("model-rotation").constantOr(null),Ne=p.paint.get("model-scale").constantOr(null),De=p.paint.get("model-translation").constantOr(null);we.computeModelMatrix(b,ke,Ne,De,!0,!0,!1);const We=o.a6.mat4.identity([]),He=o.de(we.position.lat,b.transform.zoom),et=o.a6.mat4.fromScaling([],[1,1,1/He]);o.a6.mat4.translate(We,We,ue),oe.push({zScaleMatrix:et,negCameraPosMatrix:We});for(const Ke of we.nodes)ff(b.transform,Ke,we.matrix,b.transform.expandedFarZProjMatrix,be,ve,_e);be++}if(ve.sort((we,ke)=>ke.depth-we.depth),b.renderPass!=="shadow"){if(I===1)for(const we of _e)Yo(we,b,p,oe[we.modelIndex],pr.disabled,b.colorModeForRenderPass());else{for(const we of _e)Yo(we,b,p,oe[we.modelIndex],pr.disabled,Mr.disabled);for(const we of _e)Yo(we,b,p,oe[we.modelIndex],b.stencilModeFor3D(),b.colorModeForRenderPass());b.resetStencilClippingMasks()}for(const we of ve)Yo(we,b,p,oe[we.modelIndex],pr.disabled,b.colorModeForRenderPass());$()}else{for(const we of _e)th(we.mesh,we.nodeModelMatrix,b,p);for(const we of ve)th(we.mesh,we.nodeModelMatrix,b,p);$()}}},uc={model:function(b,u,p){const w=u.getSource();if(!w.loaded())return;if(w.type==="vector"||w.type==="geojson")return void(p.modelManager&&p.modelManager.upload(p,w.type==="vector"?b.scope:""));if(w.type==="batched-model"||w.type!=="model")return;const I=w.getModels();for(const P of I)P.upload(p.context)},raster:function(b,u,p){const w=u.getSource();if(!(w instanceof Er&&w.loaded()))return;const I=b.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!I)return;const P=b.paint.get("raster-array-band")||w.getInitialBand(I);if(P==null)return;const F=u.getIds().map(W=>u.getTileByID(W));for(const W of F)W.updateNeeded(I,P)&&w.prepareTile(W,I,P)},"raster-particle":function(b,u,p){const w=u.getSource();if(!(w instanceof Er&&w.loaded()))return;const I=b.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!I)return;const P=b.paint.get("raster-particle-array-band")||w.getInitialBand(I);if(P==null)return;const F=u.getIds().map(W=>u.getTileByID(W));for(const W of F)W.updateNeeded(I,P)&&w.prepareTile(W,I,P)}};class Qa{constructor(u,p,w,I){this.context=new Yp(u,p),this.transform=w,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=I,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const P=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const W of P)this._debugParams.enabledLayers[W]=!0;I.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),I.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),I.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),I.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),I.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const W of P)I.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],W);this.occlusionParams=new pf(I),this.setup(),this.numSublayers=$o.maxUnderzooming+$o.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ug(this),this._wireframeDebugCache=new cc,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const F=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,F,u.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(u,p){const w=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rf(this,u));const I=this._terrain;this.transform.elevation=w?I:null,I.update(u,this.transform,p),this.transform.elevation&&!I.enabled&&(this.transform.elevation=null)}_updateFog(u){const p=u.fog;if(!p||this.transform.projection.name==="globe"||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,I]=p.getFovAdjustedRange(this.transform._fov);if(w>I)return void(this.transform.fogCullDistSq=null);const P=w+.78*(I-w);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(u){u&&!this._terrain&&(this._terrain=new rf(this,this.style)),this._forceTerrainMode=u}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(u,p){if(this.width=u*o.q.devicePixelRatio,this.height=p*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._mergedLayers[w].resize()}setup(){const u=this.context,p=new o.a_;p.emplaceBack(0,0),p.emplaceBack(o.ab,0),p.emplaceBack(0,o.ab),p.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=u.createVertexBuffer(p,o.b0.members),this.tileExtentSegments=o.b1.simpleSegment(0,0,4,2);const w=new o.a_;w.emplaceBack(0,0),w.emplaceBack(o.ab,0),w.emplaceBack(0,o.ab),w.emplaceBack(o.ab,o.ab),this.debugBuffer=u.createVertexBuffer(w,o.b0.members),this.debugSegments=o.b1.simpleSegment(0,0,4,5);const I=new o.a_;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(-1,1),I.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(I,o.b0.members),this.viewportSegments=o.b1.simpleSegment(0,0,4,2);const P=new o.aN;P.emplaceBack(0,0,0,0),P.emplaceBack(o.ab,0,o.ab,0),P.emplaceBack(0,o.ab,0,o.ab),P.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=u.createVertexBuffer(P,o.b3.members),this.mercatorBoundsSegments=o.b1.simpleSegment(0,0,4,2);const F=new o.aO;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(F);const W=new o.a$;for(const J of[0,1,3,2,0])W.emplaceBack(J);this.debugIndexBuffer=u.createIndexBuffer(W),this.emptyTexture=new o.T(u,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA8),this.identityMat=o.a6.mat4.create();const $=this.context.gl;this.stencilClearMode=new pr({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,u.TRIANGLES,$n.disabled,this.stencilClearMode,Mr.disabled,_r.disabled,xu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,p,w){if(!p||this.currentStencilSource===p.id||!u.isTileClipped()||!w||w.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let W=!1;for(const $ of w)if(this._tileClippingMaskIDs[$.key]===void 0){W=!0;break}if(!W)return}this.currentStencilSource=p.id;const I=this.context,P=I.gl;this.nextStencilID+w.length>256&&this.clearStencil(),I.setColorMode(Mr.disabled),I.setDepthMode($n.disabled);const F=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const W of w){const $=p.getTile(W),J=this._tileClippingMaskIDs[W.key]=this.nextStencilID++,{tileBoundsBuffer:Q,tileBoundsIndexBuffer:oe,tileBoundsSegments:le}=this.getTileBoundsBuffers($);F.draw(this,P.TRIANGLES,$n.disabled,new pr({func:P.ALWAYS,mask:0},J,255,P.KEEP,P.KEEP,P.REPLACE),Mr.disabled,_r.disabled,xu(W.projMatrix),"$clipping",Q,oe,le)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,p=this.context.gl;return new pr({func:p.NOTEQUAL,mask:255},u,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const p=this.context.gl;return new pr({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(u){const p=this.context.gl,w=u.sort((F,W)=>W.overscaledZ-F.overscaledZ),I=w[w.length-1].overscaledZ,P=w[0].overscaledZ-I+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const F={};for(let W=0;W<P;W++)F[W+I]=new pr({func:p.GEQUAL,mask:255},W+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=P,[F,w]}return[{[I]:pr.disabled},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new Mr([u.CONSTANT_COLOR,u.ONE,u.CONSTANT_COLOR,u.ONE],new o.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mr.unblended:Mr.alphaBlended}colorModeForDrapableLayerRenderPass(u){const p=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Mr([p.ONE,p.ONE_MINUS_SRC_ALPHA,p.CONSTANT_ALPHA,p.ONE_MINUS_SRC_ALPHA],new o.bz(0,0,0,u===void 0?0:u),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(u,p,w,I=!1){if(this.depthOcclusion)return new $n(this.context.gl.GREATER,$n.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!I)return $n.disabled;const P=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new $n(w||this.context.gl.LEQUAL,p,[P,P])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const u=this.context.gl,p=Math.ceil(this.width),w=Math.ceil(this.height),I=this.context.bindFramebuffer.get(),P=u.getParameter(u.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===p&&this.depthFBO.height===w||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),p!==0&&w!==0&&(this.depthFBO=new Gc(this.context,p,w,!1,"texture"),this.depthTexture=new o.T(this.context,{width:p,height:w,data:null},u.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(I),u.bindTexture(u.TEXTURE_2D,P),this.depthFBO&&(u.bindFramebuffer(u.READ_FRAMEBUFFER,null),u.bindFramebuffer(u.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),u.blitFramebuffer(0,0,p,w,0,0,p,w,u.DEPTH_BUFFER_BIT,u.NEAREST),u.bindFramebuffer(u.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((u,p)=>u+p/this._fpsHistory.length,0))}render(u,p){const w=o.q.now();this._dt=w-this._timeStamp,this._timeStamp=w,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=u.map.repaint,this.style=u,this.options=p;const I=this.style._mergedLayers,P=this.style.order.filter(st=>{const rt=I[st];return!(rt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[rt.type]});let F=!1,W=!1;for(const st of P){const rt=I[st];rt.type==="circle"&&(F=!0),rt.type==="symbol"&&(rt.hasInitialOcclusionOpacityProperties?W=!0:F=!0)}const $=P.map(st=>I[st]),J=this.style._mergedSourceCaches;this.imageManager=u.imageManager,this.modelManager=u.modelManager,this.symbolFadeChange=u.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let Q=0,oe=!1;for(const st in J){const rt=J[st];rt.used&&(rt.prepare(this.context),rt.getSource().usedInConflation&&++Q)}let le=!1;for(const st of $)st.isHidden(this.transform.zoom)||(st.type==="clip"&&(le=!0),this.prepareLayer(st));const ue={},ve={},_e={},be={},we={};for(const st in J){const rt=J[st];ue[st]=rt.getVisibleCoordinates(),ve[st]=ue[st].slice().reverse(),_e[st]=rt.getVisibleCoordinates(!0).reverse(),be[st]=rt.getShadowCasterCoordinates(),we[st]=rt.sortCoordinatesByDistance(ue[st])}const ke=st=>{const rt=this.style.getLayerSourceCache(st);return rt&&rt.used?rt.getSource():null};if(Q||le||this._clippingActiveLastFrame){const st=[],rt=[];let xt=0;for(const Ft of $)this.isSourceForClippingOrConflation(Ft,ke(Ft))&&(st.push(Ft),rt.push(xt)),xt++;if(st&&(le||st.length>1)||this._clippingActiveLastFrame){le=!1;const Ft=[];for(let Zt=0;Zt<st.length;Zt++){const kt=st[Zt],hn=rt[Zt],bt=this.style.getLayerSourceCache(kt);if(!bt||!bt.used||!bt.getSource().usedInConflation&&kt.type!=="clip")continue;let Wt=o.dn,Gt=o.bs.None;const fn=[];let pn=!0;if(kt.type==="clip"){Wt=hn;for(const qt of kt.layout.get("clip-layer-types"))Gt|=qt==="model"?o.bs.Model:qt==="symbol"?o.bs.Symbol:o.bs.FillExtrusion;for(const qt of kt.layout.get("clip-layer-scope"))fn.push(qt);kt.isHidden(this.transform.zoom)?pn=!1:le=!0}pn&&Ft.push({layer:kt.fqid,cache:bt,order:Wt,clipMask:Gt,clipScope:fn})}this.replacementSource.setSources(Ft),oe=!0}}this._clippingActiveLastFrame=le,oe||this.replacementSource.clear(),this.conflationActive=oe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let st=0;st<$.length;st++){const rt=$[st],xt=rt.cutoffRange();if(this.longestCutoffRange=Math.max(xt,this.longestCutoffRange),xt>0){const Ft=ke(rt);Ft&&(this.minCutoffZoom=Math.max(Ft.minzoom,this.minCutoffZoom)),rt.minzoom&&(this.minCutoffZoom=Math.max(rt.minzoom,this.minCutoffZoom))}rt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=st),this._lastOcclusionLayer=st)}const Ne=this.style&&this.style.fog;Ne?(this._fogVisible=Ne.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ne.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0);const De=this._shadowRenderer;if(De){De.updateShadowParameters(this.transform,this.style.directionalLight);for(const st in J)for(const rt of ue[st]){let xt={min:0,max:0};this.terrain&&(xt=this.terrain.getMinMaxForTile(rt)||xt),De.addShadowReceiver(rt.toUnwrapped(),xt.min,xt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new hf(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!qe.has(this.context.gl))return;this.renderPass="offscreen";for(const st of $){const rt=u.getLayerSourceCache(st);if(!st.hasOffscreenPass()||st.isHidden(this.transform.zoom))continue;const xt=rt?ve[rt.id]:void 0;(st.type==="custom"||st.type==="raster"||st.type==="raster-particle"||st.isSky()||xt&&xt.length)&&this.renderLayer(this,rt,st,xt)}this.depthRangeFor3D=[0,1-($.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,be)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const We=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),He=(()=>{if(p.showOverdrawInspector)return o.bz.black;const st=this.style.fog;if(st&&this.transform.projection.supportsFog){const rt=this.style.getLut(st.scope);if(!We){const xt=st.properties.get("color").toRenderColor(rt).toArray01();return new o.bz(...xt)}if(We){const xt=st.properties.get("space-color").toRenderColor(rt).toArray01();return new o.bz(...xt)}}return o.bz.transparent})();if(this.context.clear({color:He,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const st=$[this.currentLayer],rt=u.getLayerSourceCache(st);if(st.isSky())continue;const xt=rt?(st.is3D()?we:ve)[rt.id]:void 0;this._renderTileClippingMasks(st,rt,xt),this.renderLayer(this,rt,st,xt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const st=$[this.currentLayer],rt=u.getLayerSourceCache(st);st.isSky()&&this.renderLayer(this,rt,st,rt?ve[rt.id]:void 0)}function et(st,rt){let xt;return rt&&(xt=(st.type==="symbol"?_e:st.is3D()?we:ve)[rt.id]),xt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<P.length;){const st=$[this.currentLayer];if(st.type==="raster"||st.type==="raster-particle"){const rt=u.getLayerSourceCache(st);this.renderLayer(this,rt,st,et(st,rt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Ke=0;De&&(Ke=De.getShadowCastingLayerCount());let tt=!1,ut=-1;for(let st=0;st<P.length;++st){const rt=$[st];rt.isHidden(this.transform.zoom)||rt.is3D()&&(ut=st)}for(W&&ut===-1&&(F=!0);this.currentLayer<P.length;){const st=$[this.currentLayer],rt=u.getLayerSourceCache(st);if(st.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(st)){if(st.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(F&&!tt&&this.terrain&&!this.transform.isOrthographic&&(tt=!0,this.blitDepth()),W&&ut!==-1&&this.currentLayer===ut+1&&!this.transform.isOrthographic&&this.blitDepth(),st.is3D()||this.terrain||this._renderTileClippingMasks(st,rt,rt?ue[rt.id]:void 0),this.renderLayer(this,rt,st,et(st,rt)),!this.terrain&&De&&Ke>0&&st.hasShadowPass()&&--Ke==0&&(De.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const xt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=xt;this.currentLayer++){const Ft=$[this.currentLayer];if(!Ft.hasLightBeamPass())continue;const Zt=u.getLayerSourceCache(Ft);this.renderLayer(this,Zt,Ft,Zt?ve[Zt.id]:void 0)}this.currentLayer=xt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const xt=this.currentLayer;this.depthOcclusion=!0;for(const Ft of this.layersWithOcclusionOpacity){this.currentLayer=Ft;const Zt=$[this.currentLayer],kt=u.getLayerSourceCache(Zt),hn=kt?ve[kt.id]:void 0;Zt.is3D()||this.terrain||this._renderTileClippingMasks(Zt,kt,kt?ue[kt.id]:void 0),this.renderLayer(this,kt,Zt,hn)}this.depthOcclusion=!1,this.currentLayer=xt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let st=null;$.forEach(rt=>{const xt=u.getLayerSourceCache(rt);xt&&!rt.isHidden(this.transform.zoom)&&xt.getVisibleCoordinates().length&&(!st||st.getSource().maxzoom<xt.getSource().maxzoom)&&(st=xt)}),st&&this.options.showTileBoundaries&&Js.debug(this,st,st.getVisibleCoordinates(),o.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Js.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(st){const rt=st.transform.padding;ji(st,st.transform.height-(rt.top||0),3,r_),ji(st,rt.bottom||0,3,Ju),At(st,rt.left||0,3,Qu),At(st,st.transform.width-(rt.right||0),3,gn);const xt=st.transform.centerPoint;(function(Ft,Zt,kt,hn){Bs(Ft,Zt-1,kt-10,2,20,hn),Bs(Ft,Zt-10,kt-1,20,2,hn)})(st,xt.x,st.transform.height-xt.y,Kn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),oe||(this.conflationActive=!1)}prepareLayer(u){this.gpuTimingStart(u);const{unsupportedLayers:p}=this.transform.projection,w=!p||!p.includes(u.type);if(uc[u.type]&&(w||this.terrain&&u.type==="custom")){const I=this.style.getLayerSourceCache(u);uc[u.type](u,I,this)}this.gpuTimingEnd()}renderLayer(u,p,w,I){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="sky"||w.type==="custom"||w.type==="model"||w.type==="raster"||w.type==="raster-particle"||I&&I.length)&&(this.id=w.id,this.gpuTimingStart(w),u.transform.projection.unsupportedLayers&&u.transform.projection.unsupportedLayers.includes(w.type)&&(!u.terrain||w.type!=="custom")||w.type==="clip"||Js[w.type](u,p,w,I,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery,w=this.context.gl;let I=this.gpuTimers[u.id];I||(I=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:w.createQuery()}),I.calls++,w.beginQuery(p.TIME_ELAPSED_EXT,I.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,p=this.context.gl,w=p.createQuery();this.deferredRenderGpuTimeQueries.push(w),p.beginQuery(u.TIME_ELAPSED_EXT,w)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const p={};for(const w in u){const I=u[w],P=this.context.extTimerQuery,F=P.getQueryParameter(I.query,this.context.gl.QUERY_RESULT)/1e6;P.deleteQueryEXT(I.query),p[w]=F}return p}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery,w=this.context.gl;let I=0;for(const P of u)I+=p.getQueryParameter(P,w.QUERY_RESULT)/1e6,p.deleteQueryEXT(P);return I}translatePosMatrix(u,p,w,I,P){if(!w[0]&&!w[1])return u;const F=P?I==="map"?this.transform.angle:0:I==="viewport"?-this.transform.angle:0;if(F){const J=Math.sin(F),Q=Math.cos(F);w=[w[0]*Q-w[1]*J,w[0]*J+w[1]*Q]}const W=[P?w[0]:o.ak(p,w[0],this.transform.zoom),P?w[1]:o.ak(p,w[1],this.transform.zoom),0],$=new Float32Array(16);return o.a6.mat4.translate($,u,W),$}saveTileTexture(u){const p=u.size[0],w=this._tileTextures[p];w?w.push(u):this._tileTextures[p]=[u]}getTileTexture(u){const p=this._tileTextures[u];return p&&p.length>0?p.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(u,p,w){const I=w===void 0?this.terrain&&this.terrain.renderingToTexture:w,P=[];return this.style&&this.style.enable3dLights()&&(u==="globeRaster"||u==="terrainRaster"?(P.push("LIGHTING_3D_MODE"),P.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):I||P.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||P.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?P.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):P.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(P.push("TERRAIN"),this.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&P.push("GLOBE"),!this._fogVisible||I||p!==void 0&&!p||P.push("FOG","FOG_DITHERING"),I&&P.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&P.push("OVERDRAW_INSPECTOR"),P}getOrCreateProgram(u,p){this.cache=this.cache||{};const w=p&&p.defines||[],I=p&&p.config,P=this.currentGlobalDefines(u,p&&p.overrideFog,p&&p.overrideRtt).concat(w),F=bo.cacheKey(qu[u],u,P,I);return this.cache[F]||(this.cache[F]=new bo(this.context,u,qu[u],I,Zp[u],P)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(u,p){if(this.style.enable3dLights()){const w=this.style.directionalLight,I=this.style.ambientLight;if(w&&I){const P=((F,W,$)=>{const J=F.properties.get("direction"),Q=F.properties.get("color").toRenderColor($.getLut(F.scope)).toArray01(),oe=F.properties.get("intensity"),le=W.properties.get("color").toRenderColor($.getLut(W.scope)).toArray01(),ue=W.properties.get("intensity"),ve=[J.x,J.y,J.z],_e=o.cH(le,ue),be=o.cH(Q,oe);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:ve,u_lighting_directional_color:be,u_ground_radiance:Zo(ve,be,_e)}})(w,I,this.style);p.setLightsUniformValues(u,P)}}}uploadCommonUniforms(u,p,w,I,P){if(this.uploadCommonLightUniforms(u,p),this.terrain&&this.terrain.renderingToTexture)return;const F=this.style.fog;if(F){const W=F.getOpacity(this.transform.pitch),$=((J,Q,oe,le,ue,ve,_e,be,we,ke,Ne,De)=>{const We=J.transform,He=Q.properties.get("color").toRenderColor(J.style.getLut(Q.scope)).toArray01();He[3]=le;const et=J.frameCounter/1e3%1,[Ke,tt]=Q.properties.get("vertical-range");return{u_fog_matrix:oe?We.calculateFogTileMatrix(oe):De||J.identityMat,u_fog_range:Q.getFovAdjustedRange(We._fov),u_fog_color:He,u_fog_horizon_blend:Q.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ke,tt),tt],u_fog_temporal_offset:et,u_frustum_tl:ue,u_frustum_tr:ve,u_frustum_br:_e,u_frustum_bl:be,u_globe_pos:we,u_globe_radius:ke,u_viewport:Ne,u_globe_transition:o.a9(We.zoom),u_is_globe:+(We.projection.name==="globe")}})(this,F,w,W,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],I);p.setFogUniformValues(u,$)}P&&p.setCutoffUniformValues(u,P.uniformValues)}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,p=u.createTexture();return u.bindTexture(u.TEXTURE_2D,p),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&u.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const u=this._backgroundTiles,p=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const I of w)p[I.key]=u[I.key]||new kc(I,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(u,p){return!(!u.is3D()||u.type!=="clip"&&(u.minzoom&&u.minzoom>this.transform.zoom||(this.style._clipLayerPresent||u.sourceLayer!=="building")&&(!p||p.type!=="batched-model")))}isTileAffectedByFog(u){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let p=this._cachedTileFogOpacities[u.key];return p||(this._cachedTileFogOpacities[u.key]=p=this.style.fog.getOpacityForTile(u)),p[0]>=Mn||p[1]>=Mn}setupDepthForOcclusion(u,p,w){const I=this.context,P=I.gl,F=!!w;var W;w||(w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),I.activeTexture.set(P.TEXTURE3),u&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),w.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],w.u_depth_range_unpack=[2/((W=this.depthRangeFor3D)[1]-W[0]),-1-2*W[0]/(W[1]-W[0])],w.u_occluder_half_size=.5*this.occlusionParams.occluderSize,w.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.activeTexture.set(P.TEXTURE0),F||p.setTerrainUniformValues(I,w)}}function Rl(b,u){let p=!1,w=null;const I=()=>{w=null,p&&(b(),w=setTimeout(I,u),p=!1)};return()=>(p=!0,w||I(),w)}class co{constructor(u){this._hashName=u&&encodeURIComponent(u),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Rl(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const p=Vc(u);if(this._hashName){const w=this._hashName;let I=!1;const P=location.hash.slice(1).split("&").map(F=>{const W=F.split("=")[0];return W===w?(I=!0,`${W}=${p}`):F}).filter(F=>F);return I||P.push(`${w}=${p}`),`#${P.join("&")}`}return`#${p}`}_getCurrentHash(){const u=location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(p=w)}),(p&&p[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(w=>isNaN(w))){const w=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(p[3]||0):u.getBearing();return u.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:w,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Vc(b,u){const p=b.getCenter(),w=Math.round(100*b.getZoom())/100,I=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,I),F=Math.round(p.lng*P)/P,W=Math.round(p.lat*P)/P,$=b.getBearing(),J=b.getPitch();let Q=u?`/${F}/${W}/${w}`:`${w}/${W}/${F}`;return($||J)&&(Q+="/"+Math.round(10*$)/10),J&&(Q+=`/${Math.round(J)}`),Q}const wu={linearity:.3,easing:o.dp(0,0,.3,1)},Pd=o.l({deceleration:2500,maxSpeed:1400},wu),s_=o.l({deceleration:20,maxSpeed:1400},wu),Hc=o.l({deceleration:1e3,maxSpeed:360},wu),Ug=o.l({deceleration:1e3,maxSpeed:90},wu);class Su{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,p=o.q.now();for(;u.length>0&&p-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)p.zoom+=P.zoomDelta||0,p.bearing+=P.bearingDelta||0,p.pitch+=P.pitchDelta||0,P.panDelta&&p.pan._add(P.panDelta),P.around&&(p.around=P.around),P.pinchAround&&(p.pinchAround=P.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(p.pan.mag()){const P=dl(p.pan.mag(),w,o.l({},Pd,u||{}));I.offset=p.pan.mult(P.amount/p.pan.mag()),I.center=this._map.transform.center,nh(I,P)}if(p.zoom){const P=dl(p.zoom,w,s_);I.zoom=this._map.transform.zoom+P.amount,nh(I,P)}if(p.bearing){const P=dl(p.bearing,w,Hc);I.bearing=this._map.transform.bearing+o.ap(P.amount,-179,179),nh(I,P)}if(p.pitch){const P=dl(p.pitch,w,Ug);I.pitch=this._map.transform.pitch+P.amount,nh(I,P)}if(I.zoom||I.bearing){const P=p.pinchAround===void 0?p.around:p.pinchAround;I.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),I.noMoveStart=!0,I}}function nh(b,u){(!b.duration||b.duration<u.duration)&&(b.duration=u.duration,b.easing=u.easing)}function dl(b,u,p){const{maxSpeed:w,linearity:I,deceleration:P}=p,F=o.ap(b*I/(u/1e3),-w,w),W=Math.abs(F)/(P*I);return{easing:p.easing,duration:1e3*W,amount:F*(W/2)}}class xa extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,w,I={}){const P=se(p.getCanvasContainer(),w),F=p.unproject(P);super(u,o.l({point:P,lngLat:F,originalEvent:w},I)),this._defaultPrevented=!1,this.target=p}}class mf extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,w){const I=u==="touchend"?w.changedTouches:w.touches,P=ae(p.getCanvasContainer(),I),F=P.map($=>p.unproject($)),W=P.reduce(($,J,Q,oe)=>$.add(J.div(oe.length)),new o.P(0,0));super(u,{points:P,point:W,lngLats:F,lngLat:p.unproject(W),originalEvent:w}),this._defaultPrevented=!1}}class wo extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p){super("wheel",{originalEvent:p}),this._defaultPrevented=!1}}class Ld{constructor(u,p){this._map=u,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new wo(this._map,u))}mousedown(u,p){return this._mousedownPos=p,this._firePreventable(new xa(u.type,this._map,u))}mouseup(u){this._map.fire(new xa(u.type,this._map,u))}preclick(u){const p=o.l({},u);p.type="preclick",this._map.fire(new xa(p.type,this._map,p))}click(u,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(u),this._map.fire(new xa(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new xa(u.type,this._map,u))}mouseover(u){this._map.fire(new xa(u.type,this._map,u))}mouseout(u){this._map.fire(new xa(u.type,this._map,u))}touchstart(u){return this._firePreventable(new mf(u.type,this._map,u))}touchmove(u){this._map.fire(new mf(u.type,this._map,u))}touchend(u){this._map.fire(new mf(u.type,this._map,u))}touchcancel(u){this._map.fire(new mf(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class o_{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new xa(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new xa(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Dd{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,p){this.isEnabled()&&u.shiftKey&&u.button===0&&(q(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(u,p){if(!this._active)return;const w=p,I=this._startPos,P=this._lastPos;if(!I||!P||P.equals(w)||!this._box&&w.dist(I)<this._clickTolerance)return;this._lastPos=w,this._box||(this._box=M("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const F=Math.min(I.x,w.x),W=Math.max(I.x,w.x),$=Math.min(I.y,w.y),J=Math.max(I.y,w.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${F}px,${$}px)`,this._box.style.width=W-F+"px",this._box.style.height=J-$+"px")})}mouseupWindow(u,p){if(!this._active)return;const w=this._startPos,I=p;if(w&&u.button===0){if(this.reset(),re(),w.x!==I.x||w.y!==I.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:u})),{cameraAnimation:P=>P.fitScreenCoordinates(w,I,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(u,p){return this._map.fire(new o.x(u,{originalEvent:p}))}}function jc(b,u){const p={};for(let w=0;w<b.length;w++)p[b[w].identifier]=u[w];return p}class Gg{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,p,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=function(I){const P=new o.P(0,0);for(const F of I)P._add(F);return P.div(I.length)}(p),this.touches=jc(w,p)))}touchmove(u,p,w){if(this.aborted||!this.centroid)return;const I=jc(w,p);for(const P in this.touches){const F=I[P];(!F||F.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(u,p,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}class hc{constructor(u){this.singleTap=new Gg(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,p,w){this.singleTap.touchstart(u,p,w)}touchmove(u,p,w){this.singleTap.touchmove(u,p,w)}touchend(u,p,w){const I=this.singleTap.touchend(u,p,w);if(I){const P=u.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(I)<30;if(P&&F||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}class a_{constructor(){this._zoomIn=new hc({numTouches:1,numTaps:2}),this._zoomOut=new hc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,p,w){this._zoomIn.touchstart(u,p,w),this._zoomOut.touchstart(u,p,w)}touchmove(u,p,w){this._zoomIn.touchmove(u,p,w),this._zoomOut.touchmove(u,p,w)}touchend(u,p,w){const I=this._zoomIn.touchend(u,p,w),P=this._zoomOut.touchend(u,p,w);return I?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(I)},{originalEvent:u})}):P?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(P)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const fc={0:1,2:2};class Bd{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,p){return!1}_move(u,p){return{}}mousedown(u,p){if(this._lastPoint)return;const w=fe(u);this._correctButton(u,w)&&(this._lastPoint=p,this._eventButton=w)}mousemoveWindow(u,p){const w=this._lastPoint;if(w){if(u.preventDefault(),this._eventButton!=null&&function(I,P){const F=fc[P];return I.buttons===void 0||(I.buttons&F)!==F}(u,this._eventButton))this.reset();else if(this._moved||!(p.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(w,p)}}mouseupWindow(u){this._lastPoint&&fe(u)===this._eventButton&&(this._moved&&re(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ca extends Bd{mousedown(u,p){super.mousedown(u,p),this._lastPoint&&(this._active=!0)}_correctButton(u,p){return p===0&&!u.ctrlKey}_move(u,p){return{around:p,panDelta:p.sub(u)}}}class Vg extends Bd{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const w=.8*(p.x-u.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(u){u.preventDefault()}}class tm extends Bd{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const w=-.5*(p.y-u.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(u){u.preventDefault()}}class O1{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(u,p,w){return this._calculateTransform(u,p,w)}touchmove(u,p,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(w.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,p,w)}}touchend(u,p,w){this._calculateTransform(u,p,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,p,w){w.length>0&&(this._active=!0);const I=jc(w,p),P=new o.P(0,0),F=new o.P(0,0);let W=0;for(const J in I){const Q=I[J],oe=this._touches[J];oe&&(P._add(Q),F._add(Q.sub(oe)),W++,I[J]=Q)}if(this._touches=I,W<this._minTouches||!F.mag())return;const $=F.div(W);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(W),panDelta:$}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Hg{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,p,w){return{}}touchstart(u,p,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([p[0],p[1]]))}touchmove(u,p,w){const I=this._firstTwoTouches;if(!I)return;u.preventDefault();const[P,F]=I,W=kd(w,p,P),$=kd(w,p,F);if(!W||!$)return;const J=this._aroundCenter?null:W.add($).div(2);return this._move([W,$],J,u)}touchend(u,p,w){if(!this._firstTwoTouches)return;const[I,P]=this._firstTwoTouches,F=kd(w,p,I),W=kd(w,p,P);F&&W||(this._active&&re(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function kd(b,u,p){for(let w=0;w<b.length;w++)if(b[w].identifier===p)return u[w]}function jg(b,u){return Math.log(b/u)/Math.LN2}class F1 extends Hg{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,p){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(jg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jg(this._distance,w),pinchAround:p}}}function el(b,u){return 180*b.angleWith(u)/Math.PI}class Wg extends Hg{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,p){const w=this._vector;if(this._vector=u[0].sub(u[1]),w&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:el(this._vector,w),pinchAround:p}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const p=25/(Math.PI*this._minDiameter)*360,w=this._startVector;if(!w)return!1;const I=el(u,w);return Math.abs(I)<p}}function Xg(b){return Math.abs(b.y)>Math.abs(b.x)}class Au extends Hg{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,Xg(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,p,w){const I=this._lastPoints;if(!I)return;const P=u[0].sub(I[0]),F=u[1].sub(I[1]);return this._map._cooperativeGestures&&!o.dq()&&w.touches.length<3||(this._valid=this.gestureBeginsVertically(P,F,w.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(P.y+F.y)/2*-.5})}gestureBeginsVertically(u,p,w){if(this._valid!==void 0)return this._valid;const I=u.mag()>=2,P=p.mag()>=2;if(!I&&!P)return;if(!I||!P)return this._firstMove==null&&(this._firstMove=w),w-this._firstMove<100&&void 0;const F=u.y>0==p.y>0;return Xg(u)&&Xg(p)&&F}}const nm={panStep:100,bearingStep:15,pitchStep:10};class rh{constructor(){const u=nm;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let p=0,w=0,I=0,P=0,F=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),P=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),P=1);break;case 38:u.shiftKey?I=1:(u.preventDefault(),F=-1);break;case 40:u.shiftKey?I=-1:(u.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(w=0,I=0),{cameraAnimation:W=>{const $=W.getZoom();W.easeTo({duration:300,easeId:"keyboardHandler",easing:rm,zoom:p?Math.round($)+p*(u.shiftKey?2:1):$,bearing:W.getBearing()+w*this._bearingStep,pitch:W.getPitch()+I*this._pitchStep,offset:[-P*this._panStep,-F*this._panStep],center:W.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function rm(b){return b*(2-b)}const im=4.000244140625,l_=1/450;class Ow{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._handler=p,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=l_,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=o.q.now(),I=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,p!==0&&p%im==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":I>400?(this._type=null,this._lastValue=p,this._timeout=window.setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(I*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),u.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=u,this._delta-=p,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=se(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;this._type==="wheel"&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(this._delta!==0){const J=this._type==="wheel"&&Math.abs(this._delta)>im?this._wheelZoomRate:this._defaultZoomRate;let Q=2/(1+Math.exp(-Math.abs(this._delta*J)));this._delta<0&&Q!==0&&(Q=1/Q);const oe=p(),le=Math.pow(2,oe),ue=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):le;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(ue*Q))),this._type==="wheel"&&(this._startZoom=oe,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const w=typeof this._targetZoom=="number"?this._targetZoom:p(),I=this._startZoom,P=this._easing;let F,W=!1;if(this._type==="wheel"&&I&&P){const J=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),Q=P(J);F=o.aa(I,w,Q),J<1?this._frameId||(this._frameId=!0):W=!0}else F=w,W=!0;this._active=!0,W&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let $=F-p();return $*this._lastDelta<0&&($=0),{noInertia:!0,needsRenderFrame:!W,zoomDelta:$,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let p=o.dr;if(this._prevEase){const w=this._prevEase,I=(o.q.now()-w.start)/w.duration,P=w.easing(I+.01)-w.easing(I),F=.27/Math.sqrt(P*P+1e-4)*.01,W=Math.sqrt(.0729-F*F);p=o.dp(F,W,.25,1)}return this._prevEase={start:o.q.now(),duration:u,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class bs{constructor(u,p){this._clickZoom=u,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class c_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,p){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(u.shiftKey?-1:1),around:w.unproject(p)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class N1{constructor(){this._tap=new hc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,p,w){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=p[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(u,p,w))}touchmove(u,p,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const I=p[0],P=I.y-this._swipePoint.y;return this._swipePoint=I,u.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(u,p,w)}touchend(u,p,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(u,p,w)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class z1{constructor(u,p,w){this._el=u,this._mousePan=p,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class gf{constructor(u,p,w){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=p,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class U1{constructor(u,p,w,I){this._el=u,this._touchZoom=p,this._touchRotate=w,this._tapDragZoom=I,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Od=b=>b.zoom||b.drag||b.pitch||b.rotate;class D extends o.x{}class O{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,p){const w=o.a6.vec3.sub([],p,u);this.radius=o.a6.vec3.length(w[2]<0?o.a6.vec3.div([],w,this.constants):[w[0],w[1],0])}projectRay(u){o.a6.vec3.div(u,u,this.constants),o.a6.vec3.normalize(u,u),o.a6.vec3.mul(u,u,this.constants);const p=o.a6.vec3.scale([],u,this.radius);if(p[2]>0){const w=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(p,[0,0,1])),I=o.a6.vec3.scale([],o.a6.vec3.normalize([],[p[0],p[1],0]),this.radius),P=o.a6.vec3.add([],p,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],I,w),p),2));p[0]=P[0],p[1]=P[1]}return p}}function Y(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class ie{constructor(u,p){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Su(u),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new O,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),o.aJ(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[I,P,F]of this._listeners){const W=I===document?this.handleWindowEvent:this.handleEvent;I.addEventListener(P,W,F)}}destroy(){for(const[u,p,w]of this._listeners){const I=u===document?this.handleWindowEvent:this.handleEvent;u.removeEventListener(p,I,w)}}_addDefaultHandlers(u){const p=this._map,w=p.getCanvasContainer();this._add("mapEvent",new Ld(p,u));const I=p.boxZoom=new Dd(p,u);this._add("boxZoom",I);const P=new a_,F=new c_;p.doubleClickZoom=new bs(F,P),this._add("tapZoom",P),this._add("clickZoom",F);const W=new N1;this._add("tapDragZoom",W);const $=p.touchPitch=new Au(p);this._add("touchPitch",$);const J=new Vg(u),Q=new tm(u);p.dragRotate=new gf(u,J,Q),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);const oe=new ca(u),le=new O1(p,u);p.dragPan=new z1(w,oe,le),this._add("mousePan",oe),this._add("touchPan",le,["touchZoom","touchRotate"]);const ue=new Wg,ve=new F1;p.touchZoomRotate=new U1(w,ve,ue,W),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new o_(p));const _e=p.scrollZoom=new Ow(p,this);this._add("scrollZoom",_e,["mousePan"]);const be=p.keyboard=new rh;this._add("keyboard",be);for(const we of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[we]&&p[we].enable(u[we])}_add(u,p,w){this._handlers.push({handlerName:u,handler:p,allowed:w}),this._handlersById[u]=p}stop(u){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Od(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,p,w){for(const I in u)if(I!==w&&(!p||p.indexOf(I)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const p=[];for(const w of u)this._el.contains(w.target)&&p.push(w);return p}handleEvent(u,p){this._updatingCamera=!0;const w=u.type==="renderFrame",I=w?void 0:u,P={needsRenderFrame:!1},F={},W={},$=u.touches?this._getMapTouches(u.touches):void 0,J=$?ae(this._el,$):w?void 0:se(this._el,u);for(const{handlerName:le,handler:ue,allowed:ve}of this._handlers){if(!ue.isEnabled())continue;let _e;this._blockedByActive(W,ve,le)?ue.reset():ue[p||u.type]&&(_e=ue[p||u.type](u,J,$),this.mergeHandlerResult(P,F,_e,le,I),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||ue.isActive())&&(W[le]=ue)}const Q={};for(const le in this._previousActiveHandlers)W[le]||(Q[le]=I);this._previousActiveHandlers=W,(Object.keys(Q).length||Y(P))&&(this._changes.push([P,F,Q]),this._triggerRenderFrame()),(Object.keys(W).length||Y(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=P;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))}mergeHandlerResult(u,p,w,I,P){if(!w)return;o.l(u,w);const F={handlerName:I,originalEvent:w.originalEvent||P};w.zoomDelta!==void 0&&(p.zoom=F),w.panDelta!==void 0&&(p.drag=F),w.pitchDelta!==void 0&&(p.pitch=F),w.bearingDelta!==void 0&&(p.rotate=F)}_applyChanges(){const u={},p={},w={};for(const[I,P,F]of this._changes)I.panDelta&&(u.panDelta=(u.panDelta||new o.P(0,0))._add(I.panDelta)),I.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+I.pitchDelta),I.around!==void 0&&(u.around=I.around),I.aroundCoord!==void 0&&(u.aroundCoord=I.aroundCoord),I.pinchAround!==void 0&&(u.pinchAround=I.pinchAround),I.noInertia&&(u.noInertia=I.noInertia),o.l(p,P),o.l(w,F);this._updateMapTransform(u,p,w),this._changes=[]}_updateMapTransform(u,p,w){const I=this._map,P=I.transform,F=ke=>[ke.x,ke.y,ke.z];if((ke=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!Y(u)){const ke=P.zoom;P.cameraElevationReference="sea",this._originalZoom!=null&&P._orthographicProjectionAtLowPitch&&P.projection.name!=="globe"&&P.pitch===0?(P.cameraElevationReference="ground",P.zoom=this._originalZoom):(P.recenterOnTerrain(),P.cameraElevationReference="ground"),ke!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&I._stop(!0),!Y(u))return void this._fireEvents(p,w,!0);let{panDelta:W,zoomDelta:$,bearingDelta:J,pitchDelta:Q,around:oe,aroundCoord:le,pinchAround:ue}=u;P._isCameraConstrained&&($>0&&($=0),P._isCameraConstrained=!1),ue!==void 0&&(oe=ue),($||(ke=>p[ke]&&!this._eventsInProgress[ke])("drag"))&&oe&&(this._dragOrigin=F(P.pointCoordinate3D(oe)),this._originalZoom=P.zoom,this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",I._stop(!0),oe=oe||I.transform.centerPoint,J&&(P.bearing+=J),Q&&(P.pitch+=Q),P._updateCameraState();const ve=[0,0,0];if(W)if(P.projection.name==="mercator"){const ke=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(oe).dir),Ne=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(oe.sub(W)).dir);ve[0]=Ne[0]-ke[0],ve[1]=Ne[1]-ke[1]}else{const ke=P.pointCoordinate(oe);if(P.projection.name==="globe"){W=W.rotate(-P.angle);const Ne=P._pixelsPerMercatorPixel/P.worldSize;ve[0]=-W.x*o.ds(o.aM(ke.y))*Ne,ve[1]=-W.y*o.ds(P.center.lat)*Ne}else{const Ne=P.pointCoordinate(oe.sub(W));ke&&Ne&&(ve[0]=Ne.x-ke.x,ve[1]=Ne.y-ke.y)}}const _e=P.zoom,be=[0,0,0];if($){const ke=F(le||P.pointCoordinate3D(oe)),Ne={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],ke,P._camera.position))};if(Ne.dir[2]<0){const De=P.zoomDeltaToMovement(ke,$);o.a6.vec3.scale(be,Ne.dir,De)}}const we=o.a6.vec3.add(ve,ve,be);P._translateCameraConstrained(we),$&&Math.abs(P.zoom-_e)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(p,w,!0)}_fireEvents(u,p,w){const I=Od(this._eventsInProgress),P=Od(u),F={};for(const Q in u){const{originalEvent:oe}=u[Q];this._eventsInProgress[Q]||(F[`${Q}start`]=oe),this._eventsInProgress[Q]=u[Q]}!I&&P&&this._fireEvent("movestart",P.originalEvent);for(const Q in F)this._fireEvent(Q,F[Q]);P&&this._fireEvent("move",P.originalEvent);for(const Q in u){const{originalEvent:oe}=u[Q];this._fireEvent(Q,oe)}const W={};let $;for(const Q in this._eventsInProgress){const{handlerName:oe,originalEvent:le}=this._eventsInProgress[Q];this._handlersById[oe].isActive()||(delete this._eventsInProgress[Q],$=p[oe]||le,W[`${Q}end`]=$)}for(const Q in W)this._fireEvent(Q,W[Q]);const J=Od(this._eventsInProgress);if(w&&(I||P)&&!J){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=le=>le!==0&&-this._bearingSnap<le&&le<this._bearingSnap;Q?(oe(Q.bearing||this._map.getBearing())&&(Q.bearing=0),this._map.easeTo(Q,{originalEvent:$})):(this._map.fire(new o.x("moveend",{originalEvent:$})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,p){this._map.fire(new o.x(u,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new D("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const pe="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Te extends o.E{constructor(u,p){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=p.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(u,p){return this.jumpTo({center:u},p)}panBy(u,p,w){return u=o.P.convert(u).mult(-1),this.panTo(this.transform.center,o.l({offset:u},p),w)}panTo(u,p,w){return this.easeTo(o.l({center:u},p),w)}getZoom(){return this.transform.zoom}setZoom(u,p){return this.jumpTo({zoom:u},p),this}zoomTo(u,p,w){return this.easeTo(o.l({zoom:u},p),w)}zoomIn(u,p){return this.zoomTo(this.getZoom()+1,u,p),this}zoomOut(u,p){return this.zoomTo(this.getZoom()-1,u,p),this}getBearing(){return this.transform.bearing}setBearing(u,p){return this.jumpTo({bearing:u},p),this}getPadding(){return this.transform.padding}setPadding(u,p){return this.jumpTo({padding:u},p),this}rotateTo(u,p,w){return this.easeTo(o.l({bearing:u},p),w)}resetNorth(u,p){return this.rotateTo(0,o.l({duration:1e3},u),p),this}resetNorthPitch(u,p){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},u),p),this}snapToNorth(u,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,p):this}getPitch(){return this.transform.pitch}setPitch(u,p){return this.jumpTo({pitch:u},p),this}cameraForBounds(u,p){u=o.as.convert(u);const w=p&&p.bearing||0,I=p&&p.pitch||0,P=u.getNorthWest(),F=u.getSouthEast();return this._cameraForBounds(this.transform,P,F,w,I,p)}_extendPadding(u){const p={top:0,right:0,bottom:0,left:0};return u==null?o.l({},p,this.transform.padding):typeof u=="number"?{top:u,bottom:u,right:u,left:u}:o.l({},p,u)}_extendCameraOptions(u){return(u=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=this._extendPadding(u.padding),u}_minimumAABBFrustumDistance(u,p){const w=p.max[0]-p.min[0],I=p.max[1]-p.min[1];return w/I>u.aspect?w/(2*Math.tan(.5*u.fovX)*u.aspect):I/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,p,w,I,P,F){const W=u.clone(),$=this._extendCameraOptions(F);W.bearing=I,W.pitch=P;const J=o.bK.convert(p),Q=o.bK.convert(w),oe=.5*(J.lat+Q.lat),le=.5*(J.lng+Q.lng),ue=o.dt(oe,le),ve=o.a6.vec3.normalize([],ue),_e=o.a6.vec3.normalize([],o.a6.vec3.cross([],ve,[0,1,0])),be=o.a6.vec3.cross([],_e,ve),we=[_e[0],_e[1],_e[2],0,be[0],be[1],be[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],ke=[ue,o.dt(J.lat,J.lng),o.dt(Q.lat,J.lng),o.dt(Q.lat,Q.lng),o.dt(J.lat,Q.lng),o.dt(oe,J.lng),o.dt(oe,Q.lng),o.dt(J.lat,le),o.dt(Q.lat,le)];let Ne=o.c9.fromPoints(ke.map(Gt=>[o.a6.vec3.dot(_e,Gt),o.a6.vec3.dot(be,Gt),o.a6.vec3.dot(ve,Gt)]));const De=o.a6.vec3.transformMat4([],Ne.center,we);o.a6.vec3.squaredLength(De)===0&&o.a6.vec3.set(De,0,0,1),o.a6.vec3.normalize(De,De),o.a6.vec3.scale(De,De,o.aq),W.center=o.du(De);const We=W.getWorldToCameraMatrix(),He=o.a6.mat4.invert(new Float64Array(16),We);Ne=o.c9.applyTransform(Ne,o.a6.mat4.multiply([],We,we));const et=this._extendAABB(Ne,W,$,I);if(!et)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=et,o.a6.vec3.transformMat4(De,De,We);const Ke=.5*(Ne.max[2]-Ne.min[2]),tt=this._minimumAABBFrustumDistance(W,Ne),ut=o.a6.vec3.scale([],[0,0,1],Ke),st=o.a6.vec3.add(ut,De,ut),rt=tt+(W.pitch===0?0:o.a6.vec3.distance(De,st)),xt=W.globeCenterInViewSpace,Ft=o.a6.vec3.sub([],De,[xt[0],xt[1],xt[2]]);o.a6.vec3.normalize(Ft,Ft),o.a6.vec3.scale(Ft,Ft,rt);const Zt=o.a6.vec3.add([],De,Ft);o.a6.vec3.transformMat4(Zt,Zt,He);const kt=o.dw/o.aq,hn=o.a6.vec3.length(Zt),bt=o.bD(Math.max(hn*kt-o.dw,Number.EPSILON),0),Wt=Math.min(W.zoomFromMercatorZAdjusted(bt),$.maxZoom);return Wt>.5*(o.c2+o.bU)?(W.setProjection({name:"mercator"}),W.zoom=Wt,this._cameraForBounds(W,p,w,I,P,F)):{center:W.center,zoom:Wt,bearing:I,pitch:P}}_extendAABB(u,p,w,I){const P=.5*((w.padding.left||0)+(w.padding.right||0)),F=.5*((w.padding.top||0)+(w.padding.bottom||0)),W=F,$=P,J=P,Q=F,oe=p.width-($+J),le=p.height-(W+Q),ue=o.a6.vec3.sub([],u.max,u.min),ve=Math.min(oe/ue[0],le/ue[1]),_e=Math.min(p.scaleZoom(p.scale*ve),w.maxZoom);if(isNaN(_e))return null;const be=p.scale/p.zoomScale(_e),we=new o.c9([u.min[0]-$*be,u.min[1]-Q*be,u.min[2]],[u.max[0]+J*be,u.max[1]+W*be,u.max[2]]),ke=(typeof w.offset.x=="number"&&typeof w.offset.y=="number"?new o.P(w.offset.x,w.offset.y):o.P.convert(w.offset)).rotate(-o.bB(I));return we.center[0]-=ke.x*be,we.center[1]+=ke.y*be,we}queryTerrainElevation(u,p){const w=this.transform.elevation;return w?(p=o.l({},{exaggerated:!0},p),w.getAtPoint(o.a5.fromLngLat(u),null,p.exaggerated)):null}_cameraForBounds(u,p,w,I,P,F){if(u.projection.name==="globe")return this._cameraForBoundsOnGlobe(u,p,w,I,P,F);const W=u.clone(),$=this._extendCameraOptions(F);W.bearing=I,W.pitch=P;const J=o.bK.convert(p),Q=o.bK.convert(w),oe=new o.bK(J.lng,Q.lat),le=new o.bK(Q.lng,J.lat),ue=W.project(J),ve=W.project(Q),_e=this.queryTerrainElevation(J),be=this.queryTerrainElevation(Q),we=this.queryTerrainElevation(oe),ke=this.queryTerrainElevation(le),Ne=[[ue.x,ue.y,Math.min(_e||0,be||0,we||0,ke||0)],[ve.x,ve.y,Math.max(_e||0,be||0,we||0,ke||0)]];let De=o.c9.fromPoints(Ne);const We=W.getWorldToCameraMatrix(),He=o.a6.mat4.invert(new Float64Array(16),We);De=o.c9.applyTransform(De,We);const et=this._extendAABB(De,W,$,I);if(!et)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=et;const Ke=.5*o.a6.vec3.sub([],De.max,De.min)[2],tt=this._minimumAABBFrustumDistance(W,De),ut=[0,0,1,0];o.a6.vec4.transformMat4(ut,ut,We),o.a6.vec4.normalize(ut,ut);const st=o.a6.vec3.scale([],ut,tt+Ke),rt=o.a6.vec3.add([],De.center,st);o.a6.vec3.transformMat4(De.center,De.center,He),o.a6.vec3.transformMat4(rt,rt,He);const xt=W.unproject(new o.P(De.center[0],De.center[1])),Ft=o.dv(W.projection,xt),Zt=Math.pow(2,Ft),kt=Math.min(W._zoomFromMercatorZ(rt[2]*W.pixelsPerMeter*Zt/W.worldSize),$.maxZoom);return W.mercatorFromTransition&&kt<.5*(o.c2+o.bU)?(W.setProjection({name:"globe"}),W.zoom=kt,this._cameraForBounds(W,p,w,I,P,F)):{center:xt,zoom:kt,bearing:I,pitch:P}}fitBounds(u,p,w){const I=this.cameraForBounds(u,p);return this._fitInternal(I,p,w)}fitScreenCoordinates(u,p,w,I,P){const F=o.P.convert(u),W=o.P.convert(p),$=new o.P(Math.min(F.x,W.x),Math.min(F.y,W.y)),J=new o.P(Math.max(F.x,W.x),Math.max(F.y,W.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(F,W))return this;const Q=this.transform.pointLocation3D($),oe=this.transform.pointLocation3D(J),le=this.transform.pointLocation3D(new o.P($.x,J.y)),ue=this.transform.pointLocation3D(new o.P(J.x,$.y)),ve=[Math.min(Q.lng,oe.lng,le.lng,ue.lng),Math.min(Q.lat,oe.lat,le.lat,ue.lat)],_e=[Math.max(Q.lng,oe.lng,le.lng,ue.lng),Math.max(Q.lat,oe.lat,le.lat,ue.lat)],be=I&&I.pitch?I.pitch:this.getPitch(),we=this._cameraForBounds(this.transform,ve,_e,w,be,I);return this._fitInternal(we,I,P)}_fitInternal(u,p,w){return u?(p=o.l(u,p)).linear?this.easeTo(p,w):this.flyTo(p,w):this}jumpTo(u,p){this.stop();const w=u.preloadOnly?this.transform.clone():this.transform;let I=!1,P=!1,F=!1;"zoom"in u&&w.zoom!==+u.zoom&&(I=!0,w.zoom=+u.zoom),u.center!==void 0&&(w.center=o.bK.convert(u.center)),"bearing"in u&&w.bearing!==+u.bearing&&(P=!0,w.bearing=+u.bearing),"pitch"in u&&w.pitch!==+u.pitch&&(F=!0,w.pitch=+u.pitch);const W=typeof u.padding=="number"?this._extendPadding(u.padding):u.padding;if(u.padding!=null&&!w.isPaddingEqual(W))if(u.retainPadding===!1){const $=w.clone();$.padding=W,w.setLocationAtPoint(w.center,$.centerPoint)}else w.padding=W;return u.preloadOnly?(this._preloadTiles(w),this):(this.fire(new o.x("movestart",p)).fire(new o.x("move",p)),I&&this.fire(new o.x("zoomstart",p)).fire(new o.x("zoom",p)).fire(new o.x("zoomend",p)),P&&this.fire(new o.x("rotatestart",p)).fire(new o.x("rotate",p)).fire(new o.x("rotateend",p)),F&&this.fire(new o.x("pitchstart",p)).fire(new o.x("pitch",p)).fire(new o.x("pitchend",p)),this.fire(new o.x("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(pe),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,p){const w=this.transform;if(!w.projection.supportsFreeCamera)return o.w(pe),this;this.stop();const I=w.zoom,P=w.pitch,F=w.bearing;w.setFreeCameraOptions(u);const W=I!==w.zoom,$=P!==w.pitch,J=F!==w.bearing;return this.fire(new o.x("movestart",p)).fire(new o.x("move",p)),W&&this.fire(new o.x("zoomstart",p)).fire(new o.x("zoom",p)).fire(new o.x("zoomend",p)),J&&this.fire(new o.x("rotatestart",p)).fire(new o.x("rotate",p)).fire(new o.x("rotateend",p)),$&&this.fire(new o.x("pitchstart",p)).fire(new o.x("pitch",p)).fire(new o.x("pitchend",p)),this.fire(new o.x("moveend",p)),this}easeTo(u,p){this._stop(!1,u.easeId),((u=o.l({offset:[0,0],duration:500,easing:o.dr},u)).animate===!1||this._prefersReducedMotion(u))&&(u.duration=0);const w=this.transform,I=this.getZoom(),P=this.getBearing(),F=this.getPitch(),W=this.getPadding(),$="zoom"in u?+u.zoom:I,J="bearing"in u?this._normalizeBearing(u.bearing,P):P,Q="pitch"in u?+u.pitch:F,oe=this._extendPadding(u.padding),le=o.P.convert(u.offset);let ue,ve,_e;if(w.projection.name==="globe"){const ut=o.a5.fromLngLat(w.center),st=le.rotate(-w.angle);ut.x+=st.x/w.worldSize,ut.y+=st.y/w.worldSize;const rt=ut.toLngLat(),xt=o.bK.convert(u.center||rt);this._normalizeCenter(xt),ue=w.centerPoint.add(st),ve=new o.P(ut.x,ut.y).mult(w.worldSize),_e=new o.P(o.am(xt.lng),o.at(xt.lat)).mult(w.worldSize).sub(ve)}else{ue=w.centerPoint.add(le);const ut=w.pointLocation(ue),st=o.bK.convert(u.center||ut);this._normalizeCenter(st),ve=w.project(ut),_e=w.project(st).sub(ve)}const be=w.zoomScale($-I);let we,ke;u.around&&(we=o.bK.convert(u.around),ke=w.locationPoint(we));const Ne=this._zooming||$!==I,De=this._rotating||P!==J,We=this._pitching||Q!==F,He=!w.isPaddingEqual(oe),et=u.retainPadding===!1?w.clone():w,Ke=ut=>st=>{if(Ne&&(ut.zoom=o.aa(I,$,st)),De&&(ut.bearing=o.aa(P,J,st)),We&&(ut.pitch=o.aa(F,Q,st)),He&&(et.interpolatePadding(W,oe,st),ue=et.centerPoint.add(le)),we)ut.setLocationAtPoint(we,ke);else{const rt=ut.zoomScale(ut.zoom-I),xt=$>I?Math.min(2,be):Math.max(.5,be),Ft=Math.pow(xt,1-st),Zt=ut.unproject(ve.add(_e.mult(st*Ft)).mult(rt));ut.setLocationAtPoint(ut.renderWorldCopies?Zt.wrap():Zt,ue)}return u.preloadOnly||this._fireMoveEvents(p),ut};if(u.preloadOnly){const ut=this._emulate(Ke,u.duration,w);return this._preloadTiles(ut),this}const tt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=De,this._pitching=We,this._padding=He,this._easeId=u.easeId,this._prepareEase(p,u.noMoveStart,tt),this._ease(Ke(w),ut=>{w.cameraElevationReference==="sea"&&w.recenterOnTerrain(),this._afterEase(p,ut)},u),this}_prepareEase(u,p,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),p||w.moving||this.fire(new o.x("movestart",u)),this._zooming&&!w.zooming&&this.fire(new o.x("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new o.x("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new o.x("pitchstart",u))}_fireMoveEvents(u){this.fire(new o.x("move",u)),this._zooming&&this.fire(new o.x("zoom",u)),this._rotating&&this.fire(new o.x("rotate",u)),this._pitching&&this.fire(new o.x("pitch",u))}_afterEase(u,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const w=this._zooming,I=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new o.x("zoomend",u)),I&&this.fire(new o.x("rotateend",u)),P&&this.fire(new o.x("pitchend",u)),this.fire(new o.x("moveend",u))}flyTo(u,p){if(this._prefersReducedMotion(u)){const Gt=o.ar(u,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Gt,p)}this.stop(),u=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},u);const w=this.transform,I=this.getZoom(),P=this.getBearing(),F=this.getPitch(),W=this.getPadding(),$="zoom"in u?o.ap(+u.zoom,w.minZoom,w.maxZoom):I,J="bearing"in u?this._normalizeBearing(u.bearing,P):P,Q="pitch"in u?+u.pitch:F,oe=this._extendPadding(u.padding),le=w.zoomScale($-I),ue=o.P.convert(u.offset);let ve=w.centerPoint.add(ue);const _e=w.pointLocation(ve),be=o.bK.convert(u.center||_e);this._normalizeCenter(be);const we=w.project(_e),ke=w.project(be).sub(we);let Ne=u.curve;const De=Math.max(w.width,w.height),We=De/le,He=ke.mag();if("minZoom"in u){const Gt=o.ap(Math.min(u.minZoom,I,$),w.minZoom,w.maxZoom),fn=De/w.zoomScale(Gt-I);Ne=Math.sqrt(fn/He*2)}const et=Ne*Ne;function Ke(Gt){const fn=(We*We-De*De+(Gt?-1:1)*et*et*He*He)/(2*(Gt?We:De)*et*He);return Math.log(Math.sqrt(fn*fn+1)-fn)}function tt(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function ut(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const st=Ke(0);let rt=function(Gt){return ut(st)/ut(st+Ne*Gt)},xt=function(Gt){return De*((ut(st)*(tt(fn=st+Ne*Gt)/ut(fn))-tt(st))/et)/He;var fn},Ft=(Ke(1)-st)/Ne;if(Math.abs(He)<1e-6||!isFinite(Ft)){if(Math.abs(De-We)<1e-6)return this.easeTo(u,p);const Gt=We<De?-1:1;Ft=Math.abs(Math.log(We/De))/Ne,xt=function(){return 0},rt=function(fn){return Math.exp(Gt*Ne*fn)}}u.duration="duration"in u?+u.duration:1e3*Ft/("screenSpeed"in u?+u.screenSpeed/Ne:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const Zt=P!==J,kt=Q!==F,hn=!w.isPaddingEqual(oe),bt=u.retainPadding===!1?w.clone():w,Wt=Gt=>fn=>{const pn=fn*Ft,qt=1/rt(pn);Gt.zoom=fn===1?$:I+Gt.scaleZoom(qt),Zt&&(Gt.bearing=o.aa(P,J,fn)),kt&&(Gt.pitch=o.aa(F,Q,fn)),hn&&(bt.interpolatePadding(W,oe,fn),ve=bt.centerPoint.add(ue));const en=fn===1?be:Gt.unproject(we.add(ke.mult(xt(pn))).mult(qt));return Gt.setLocationAtPoint(Gt.renderWorldCopies?en.wrap():en,ve),Gt._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(p),Gt};if(u.preloadOnly){const Gt=this._emulate(Wt,u.duration,w);return this._preloadTiles(Gt),this}return this._zooming=!0,this._rotating=Zt,this._pitching=kt,this._padding=hn,this._prepareEase(p,!1),this._ease(Wt(w),()=>this._afterEase(p),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(u){}_cancelRenderFrame(u){}_stop(u,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const w=this._onEaseEnd;this._onEaseEnd=void 0,w.call(this,p)}if(!u){const w=this.handlers;w&&w.stop(!1)}return this}_ease(u,p,w){w.animate===!1||w.duration===0?(u(1),p()):(this._easeStart=o.q.now(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,p){u=o.bA(u,-180,180);const w=Math.abs(u-p);return Math.abs(u-360-p)<w&&(u-=360),Math.abs(u+360-p)<w&&(u+=360),u}_normalizeCenter(u){const p=this.transform;if(p.maxBounds||p.projection.name!=="globe"&&!p.renderWorldCopies)return;const w=u.lng-p.center.lng;u.lng+=w>180?-360:w<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,p,w){const I=Math.ceil(15*p/1e3),P=[],F=u(w.clone());for(let W=0;W<=I;W++){const $=F(W/I);P.push($.clone())}return P}_preloadTiles(u,p){}}class dt{constructor(u={}){this.options=u,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const p=this.options&&this.options.compact,w=u._getUIString("AttributionControl.ToggleAttribution");this._map=u,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",w);const I=M("span","mapboxgl-ctrl-icon",this._compactButton);return I.setAttribute("aria-hidden","true"),I.setAttribute("title",w),this._innerContainer=M("div","mapboxgl-ctrl-attrib-inner",this._container),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(u){const w=p.reduce((I,P,F)=>(P.value&&(I+=`${P.key}=${P.value}${F<p.length-1?"&":""}`),I),"?");u.href=`${o.e.FEEDBACK_URL}/${w}#${Vc(this._map,!0)}`,u.rel="noopener nofollow"}}_updateData(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}const p=this._map.style._mergedSourceCaches;for(const I in p){const P=p[I];if(P.used){const F=P.getSource();F.attribution&&u.indexOf(F.attribution)<0&&u.push(F.attribution)}}u.sort((I,P)=>I.length-P.length),u=u.filter((I,P)=>{for(let F=P+1;F<u.length;F++)if(u[F].indexOf(I)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ot{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=M("div","mapboxgl-ctrl");const p=M("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(Object.entries(u).length===0)return!0;for(const p in u){const w=u[p].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class vn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const p=++this._id;return this._queue.push({callback:u,id:p,cancelled:!1}),p}remove(u){const p=this._currentlyRunning,w=p?this._queue.concat(p):this._queue;for(const I of w)if(I.id===u)return void(I.cancelled=!0)}run(u=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const w of p)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Wn{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const p=o.cw((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,p,w){this._start=this.getValue(p),this._end=u,this._startTime=p,this._endTime=p+w}}const br={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class ai{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class zr{constructor(u){this.map=u,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(u,p){if(this.typeById.has(u))throw new Error(`Interaction id "${u}" already exists.`);const{type:w,filter:I}=p;if(I){const F=o.M(I,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(F.result==="error")throw new Error(F.value.map(W=>`${W.key}: ${W.message}`).join(", "));this.filters.set(u,F.value)}const P=this.interactionsByType.get(w)||new Map;P.size===0&&(this.map.on(w,this.handleType),this.interactionsByType.set(w,P)),P.set(u,p),this.typeById.set(u,w)}remove(u){const p=this.typeById.get(u);if(!p)return;this.typeById.delete(u),this.filters.delete(u);const w=this.interactionsByType.get(p);w&&(w.delete(u),w.size===0&&this.map.off(p,this.handleType))}handleType(u){const p=u.features||this.map.queryRenderedFeatures(u.point);if(!p)return;const w=this.interactionsByType.get(u.type),I={zoom:0};for(const[P,F]of w){const W=this.filters.get(P),{handler:$,layers:J}=F;for(const Q of p)if((!J||J.includes(Q.layer.id))&&(!W||W.evaluate(I,Q))&&$({id:P,feature:Q,interaction:F})!==!1)break}}}const ps={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Ir={showCompass:!0,showZoom:!0,visualizePitch:!1};class uo{constructor(u,p,w=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new Vg({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,w&&(this.mousePitch=new tm({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(u,p){this.mouseRotate.mousedown(u,p),this.mousePitch&&this.mousePitch.mousedown(u,p),q()}move(u,p){const w=this.map,I=this.mouseRotate.mousemoveWindow(u,p),P=I&&I.bearingDelta;if(P&&w.setBearing(w.getBearing()+P),this.mousePitch){const F=this.mousePitch.mousemoveWindow(u,p),W=F&&F.pitchDelta;W&&w.setPitch(w.getPitch()+W)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(o.l({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),se(this.element,u)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,se(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){u.targetTouches.length!==1?this.reset():(this._lastPos=ae(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ho(b,u,p){if(b=new o.bK(b.lng,b.lat),u){const w=new o.bK(b.lng-360,b.lat),I=new o.bK(b.lng+360,b.lat),P=360*Math.ceil(Math.abs(b.lng-p.center.lng)/360),F=p.locationPoint(b).distSqr(u),W=u.x<0||u.y<0||u.x>p.width||u.y>p.height;p.locationPoint(w).distSqr(u)<F&&(W||Math.abs(w.lng-p.center.lng)<P)?b=w:p.locationPoint(I).distSqr(u)<F&&(W||Math.abs(I.lng-p.center.lng)<P)&&(b=I)}for(;Math.abs(b.lng-p.center.lng)>180;){const w=p.locationPoint(b);if(w.x>=0&&w.y>=0&&w.x<=p.width&&w.y<=p.height)break;b.lng>p.center.lng?b.lng-=360:b.lng+=360}return b}const Xt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Nt extends o.E{constructor(u,p){if(super(),(u instanceof HTMLElement||p)&&(u=o.l({element:u},p)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=o.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=M("div");const P=41,F=27,W=C("svg",{display:"block",height:P*this._scale+"px",width:F*this._scale+"px",viewBox:`0 0 ${F} ${P}`},this._element),$=C("radialGradient",{id:"shadowGradient"},C("defs",{},W));C("stop",{offset:"10%","stop-opacity":.4},$),C("stop",{offset:"100%","stop-opacity":.05},$),C("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},W),C("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},W),C("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},W),C("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},W),this._offset=o.P.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",P=>{P.preventDefault()}),this._element.addEventListener("mousedown",P=>{P.preventDefault()});const w=this._element.classList;for(const P in Xt)w.remove(`mapboxgl-marker-anchor-${P}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`);const I=u&&u.className?u.className.trim().split(/\s+/):[];w.add(...I),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=o.bK.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const I=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[I,-1*(38.1-13.5+I)],"bottom-right":[-I,-1*(38.1-13.5+I)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const p=u.code,w=u.charCode||u.keyCode;p!=="Space"&&p!=="Enter"&&w!==32&&w!==13||this.togglePopup()}_onMapClick(u){const p=u.originalEvent.target,w=this._element;this._popup&&(p===w||w.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,p=this._pos;if(!u||!p)return!1;const w=u.unproject(p),I=u.getFreeCameraOptions();if(!I.position)return!1;const P=I.position.toLngLat();return P.distanceTo(w)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const p=this._pos;if(!p||p.x<0||p.x>u.transform.width||p.y<0||p.y>u.transform.height)return void this._clearFadeTimer();const w=u.unproject(p);let I;u._showingGlobe()&&o.dz(u.transform,this._lngLat)?I=0:(I=1-u._queryFogOpacity(w),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(I*=this._occludedOpacity)),this._element.style.opacity=`${I}`,this._element.style.pointerEvents=I>0?"auto":"none",this._popup&&this._popup._setOpacity(I),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${u.x}px,${u.y}px)
            ${Xt[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const u=this._pos,p=this._map,w=this.getPitchAlignment();if(!p||!u||w!=="map")return"";if(!p._showingGlobe()){const $=p.getPitch();return $?`rotateX(${$}deg)`:""}const I=o.c0(o.dA(p.transform,this._lngLat)),P=u.sub(o.dB(p.transform)),F=Math.abs(P.x)+Math.abs(P.y);if(F===0)return"";const W=I/F;return`rotateX(${-P.y*W}deg) rotateY(${P.x*W}deg)`}_calculateZTransform(){const u=this._pos,p=this._map;if(!p||!u)return"";let w=0;const I=this.getRotationAlignment();if(I==="map")if(p._showingGlobe()){const P=p.project(new o.bK(this._lngLat.lng,this._lngLat.lat+.001)),F=p.project(new o.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);w=o.c0(Math.atan2(F.y,F.x))-90}else w=-p.getBearing();else if(I==="horizon"){const P=o.a7(4,6,p.getZoom()),F=o.dB(p.transform);F.y+=P*p.transform.height;const W=u.sub(F),$=o.c0(Math.atan2(W.y,W.x));w=($>90?$-270:$+90)*(1-P)}return w+=this._rotation,w?`rotateZ(${w}deg)`:""}_update(u){cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=ho(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),u===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=o.P.convert(u),this._update(),this}addClassName(u){return this._element.classList.add(u),this}removeClassName(u){return this._element.classList.remove(u),this}toggleClassName(u){return this._element.classList.toggle(u)}_onMove(u){const p=this._map;if(!p)return;const w=this._pointerdownPos,I=this._positionDelta;if(w&&I){if(!this._isDragging){const P=this._clickTolerance||p._clickTolerance;if(u.point.dist(w)<P)return;this._isDragging=!0}this._pos=u.point.sub(I),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(u){const p=this._map,w=this._pos;p&&w&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(w),this._pointerdownPos=u.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const p=this._map;return p&&(u?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const on={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},rr={maxWidth:100,unit:"metric"},Rr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},gi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},li=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ni(b=new o.P(0,0),u="bottom"){if(typeof b=="number"){const p=Math.round(Math.sqrt(.5*Math.pow(b,2)));switch(u){case"top":return new o.P(0,b);case"top-left":return new o.P(p,p);case"top-right":return new o.P(-p,p);case"bottom":return new o.P(0,-b);case"bottom-left":return new o.P(p,-p);case"bottom-right":return new o.P(-p,-p);case"left":return new o.P(b,0);case"right":return new o.P(-b,0)}return new o.P(0,0)}return b instanceof o.P||Array.isArray(b)?o.P.convert(b):o.P.convert(b[u]||[0,0])}return{version:h,supported:E.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends Te{constructor(b){m.mark(d.create);const u=b;if((b=o.l({},ps,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(b.antialias&&o.dx(window)&&(b.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new gd(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),b),this._repaint=!!b.repaint,this._interactive=b.interactive,this._minTileCacheSize=b.minTileCacheSize,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=b.crossSourceCollisions,this._collectResourceTiming=b.collectResourceTiming,this._language=this._parseLanguage(b.language),this._worldview=b.worldview,this._renderTaskQueue=new vn,this._domRenderTaskQueue=new vn,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aP(),this._locale=o.l({},br,b.locale),this._clickTolerance=b.clickTolerance,this._cooperativeGestures=b.cooperativeGestures,this._performanceMetricsCollection=b.performanceMetricsCollection,this._tessellationStep=b.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=b.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Wn(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new je(b.transformRequest,b.accessToken,b.testMode),this._silenceAuthErrors=!!b.testMode,this._contextCreateOptions=b.contextCreateOptions?{...b.contextCreateOptions}:{},typeof b.container=="string"){const p=document.getElementById(b.container);if(!p)throw new Error(`Container '${b.container.toString()}' not found.`);this._container=p}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),b.maxBounds&&this.setMaxBounds(b.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ai),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new ie(this,b),this._localFontFamily=b.localFontFamily,this._localIdeographFontFamily=b.localIdeographFontFamily,(b.style||!b.testMode)&&this.setStyle(b.style||o.e.DEFAULT_STYLE,{config:b.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),b.projection&&this.setProjection(b.projection),b.hash&&(this._hash=new co(typeof b.hash=="string"&&b.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){u.center==null&&u.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch});const p=b.bounds;p&&(this.resize(),this.fitBounds(p,o.l({},b.fitBoundsOptions,{duration:0})))}this.resize(),b.attributionControl&&this.addControl(new dt({customAttribution:b.customAttribution})),this._logoControl=new Ot,this.addControl(this._logoControl,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",p=>{this._update(p.dataType==="style"),this.fire(new o.x(`${p.dataType}data`,p))}),this.on("dataloading",p=>{this.fire(new o.x(`${p.dataType}dataloading`,p))}),this._interactions=new zr(this)}_getMapId(){return this._mapId}addControl(b,u){if(u===void 0&&(u=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=b.onAdd(this);this._controls.push(b);const w=this._controlPositions[u];return u.indexOf("bottom")!==-1?w.insertBefore(p,w.firstChild):w.appendChild(p),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(b);return u>-1&&this._controls.splice(u,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(b){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new o.x("movestart",b)).fire(new o.x("move",b)),this.fire(new o.x("resize",b)),u&&this.fire(new o.x("moveend",b)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(b){return this.transform.setMaxBounds(o.as.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b?this.setZoom(b):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b?this.setZoom(b):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b?this.setPitch(b):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b?this.setPitch(b):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(b){return b==="auto"?navigator.language:Array.isArray(b)?b.length===0?void 0:b.map(u=>u==="auto"?navigator.language:u):b}setLanguage(b){const u=this._parseLanguage(b);if(!this.style||u===this._language)return this;this._language=u,this.style.reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(b){return this.style&&b!==this._worldview?(this._worldview=b,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(b){return this._lazyInitEmptyStyle(),b?typeof b=="string"&&(b={name:b}):b=null,this._useExplicitProjection=!!b,this._prioritizeAndUpdateProjection(b,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const b=this.transform,u=b.projection.name;let p;u==="globe"&&b.zoom>=o.bU?(b.setMercatorFromTransition(),p=!0):u==="mercator"&&b.zoom<o.bU&&(b.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(b,u){return this._updateProjection(b||u||{name:"mercator"})}_updateProjection(b){let u;return u=b.name==="globe"&&this.transform.zoom>=o.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(b),this.style.applyProjectionUpdate(),u&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(b){return this.transform.locationPoint3D(o.bK.convert(b))}unproject(b){return this.transform.pointLocation3D(o.P.convert(b))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(b,u,p){if(b==="mouseenter"||b==="mouseover"){let w=!1;const I=F=>{const W=u.filter(J=>this.getLayer(J)),$=W.length?this.queryRenderedFeatures(F.point,{layers:W}):[];$.length?w||(w=!0,p.call(this,new xa(b,this,F.originalEvent,{features:$}))):w=!1},P=()=>{w=!1};return{layers:new Set(u),listener:p,delegates:{mousemove:I,mouseout:P}}}if(b==="mouseleave"||b==="mouseout"){let w=!1;const I=F=>{const W=u.filter($=>this.getLayer($));(W.length?this.queryRenderedFeatures(F.point,{layers:W}):[]).length?w=!0:w&&(w=!1,p.call(this,new xa(b,this,F.originalEvent)))},P=F=>{w&&(w=!1,p.call(this,new xa(b,this,F.originalEvent)))};return{layers:new Set(u),listener:p,delegates:{mousemove:I,mouseout:P}}}{const w=I=>{const P=u.filter(W=>this.getLayer(W)),F=P.length?this.queryRenderedFeatures(I.point,{layers:P}):[];F.length&&(I.features=F,p.call(this,I),delete I.features)};return{layers:new Set(u),listener:p,delegates:{[b]:w}}}}on(b,u,p){if(typeof u=="function"||p===void 0)return super.on(b,u);if(Array.isArray(u)||(u=[u]),u){for(const I of u)if(!this._isValidId(I))return this}const w=this._createDelegatedListener(b,u,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(w);for(const I in w.delegates)this.on(I,w.delegates[I]);return this}once(b,u,p){if(typeof u=="function"||p===void 0)return super.once(b,u);if(Array.isArray(u)||(u=[u]),u){for(const I of u)if(!this._isValidId(I))return this}const w=this._createDelegatedListener(b,u,p);for(const I in w.delegates)this.once(I,w.delegates[I]);return this}off(b,u,p){if(typeof u=="function"||p===void 0)return super.off(b,u);const w=new Set(Array.isArray(u)?u:[u]);for(const F of w)if(!this._isValidId(F))return this;const I=(F,W)=>{if(F.size!==W.size)return!1;for(const $ of F)if(!W.has($))return!1;return!0},P=this._delegatedListeners?this._delegatedListeners[b]:void 0;return P&&(F=>{for(let W=0;W<F.length;W++){const $=F[W];if($.listener===p&&I($.layers,w)){for(const J in $.delegates)this.off(J,$.delegates[J]);return F.splice(W,1),this}}})(P),this}queryRenderedFeatures(b,u){if(!this.style)return[];if(u!==void 0||b===void 0||b instanceof o.P||Array.isArray(b)||(u=b,b=void 0),b=b||[[0,0],[this.transform.width,this.transform.height]],(u=u||{}).layers&&Array.isArray(u.layers)){for(const p of u.layers)if(!this._isValidId(p))return[]}return this.style.queryRenderedFeatures(b,u,this.transform)}querySourceFeatures(b,u){return this._isValidId(b)?this.style.querySourceFeatures(b,u):[]}isPointOnSurface(b){const{name:u}=this.transform.projection;return u!=="globe"&&u!=="mercator"&&o.w(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(b))}addInteraction(b,u){return this._interactions.add(b,u),this}removeInteraction(b){return this._interactions.remove(b),this}setStyle(b,u){return u=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u),this.style&&b&&u.diff!==!1&&u.localFontFamily===this._localFontFamily&&u.localIdeographFontFamily===this._localIdeographFontFamily&&!u.config?(this.style._diffStyle(b,(p,w)=>{p?(o.w(`Unable to perform style diff: ${String(p.message||p.error||p)}. Rebuilding the style from scratch.`),this._updateStyle(b,u)):w&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(b,u))}_getUIString(b){const u=this._locale[b];if(u==null)throw new Error(`Missing UI string '${b}'`);return u}_updateStyle(b,u){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),b){const p=o.l({},u);u&&u.config&&(p.initialConfig=u.config,delete p.config),this.style=new Oa(this,p).load(b),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Oa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(b){return b==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.cn(b)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${b}".`))),!1)}addSource(b,u){return this._isValidId(b)?(this._lazyInitEmptyStyle(),this.style.addSource(b,u),this._update(!0)):this}isSourceLoaded(b){return!!this._isValidId(b)&&!!this.style&&this.style._isSourceCacheLoaded(b)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(b,u,p){this._lazyInitEmptyStyle(),this.style.addSourceType(b,u,p)}removeSource(b){return this._isValidId(b)?(this.style.removeSource(b),this._updateTerrain(),this._update(!0)):this}getSource(b){return this._isValidId(b)?this.style.getOwnSource(b):null}addImage(b,u,{pixelRatio:p=1,sdf:w=!1,stretchX:I,stretchY:P,content:F}={}){if(this._lazyInitEmptyStyle(),u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap){const{width:W,height:$,data:J}=o.q.getImageData(u);this.style.addImage(b,{data:new o.r({width:W,height:$},J),pixelRatio:p,stretchX:I,stretchY:P,content:F,sdf:w,version:0})}else if(u.width===void 0||u.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:W,height:$}=u,J=u;this.style.addImage(b,{data:new o.r({width:W,height:$},new Uint8Array(J.data)),pixelRatio:p,stretchX:I,stretchY:P,content:F,sdf:w,version:0,userImage:J}),J.onAdd&&J.onAdd(this,b)}}updateImage(b,u){this._lazyInitEmptyStyle();const p=this.style.getImage(b);if(!p)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap?o.q.getImageData(u):u,{width:I,height:P,data:F}=w;if(I===void 0||P===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(I!==p.data.width||P!==p.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${I}, ${P})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`)));const W=!(u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap);p.data.replace(F,W),this.style.updateImage(b,p)}hasImage(b){return b?!!this.style&&!!this.style.getImage(b):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,u){o.o(this._requestManager.transformRequest(b,o.R.Image),(p,w)=>{u(p,w instanceof HTMLImageElement?o.q.getImageData(w):w)})}listImages(){return this.style.listImages()}addModel(b,u){this._lazyInitEmptyStyle(),this.style.addModel(b,u)}hasModel(b){return b?this.style.hasModel(b):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(b){this.style.removeModel(b)}listModels(){return this.style.listModels()}addLayer(b,u){return this._isValidId(b.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(b,u),this._update(!0)):this}getSlot(b){const u=this.getLayer(b);return u&&u.slot||null}setSlot(b,u){return this.style.setSlot(b,u),this.style.mergeLayers(),this._update(!0)}addImport(b,u){return this.style.addImport(b,u),this}updateImport(b,u){return typeof u!="string"&&u.id!==b?(this.removeImport(b),this.addImport(u)):(this.style.updateImport(b,u),this._update(!0))}removeImport(b){return this.style.removeImport(b),this}moveImport(b,u){return this.style.moveImport(b,u),this._update(!0)}moveLayer(b,u){return this._isValidId(b)?(this.style.moveLayer(b,u),this._update(!0)):this}removeLayer(b){return this._isValidId(b)?(this.style.removeLayer(b),this._update(!0)):this}getLayer(b){if(!this._isValidId(b))return null;const u=this.style.getOwnLayer(b);return u?u.type==="custom"?u.implementation:u.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(b,u,p){return this._isValidId(b)?(this.style.setLayerZoomRange(b,u,p),this._update(!0)):this}setFilter(b,u,p={}){return this._isValidId(b)?(this.style.setFilter(b,u,p),this._update(!0)):this}getFilter(b){return this._isValidId(b)?this.style.getFilter(b):null}setPaintProperty(b,u,p,w={}){return this._isValidId(b)?(this.style.setPaintProperty(b,u,p,w),this._update(!0)):this}getPaintProperty(b,u){return this._isValidId(b)?this.style.getPaintProperty(b,u):null}setLayoutProperty(b,u,p,w={}){return this._isValidId(b)?(this.style.setLayoutProperty(b,u,p,w),this._update(!0)):this}getLayoutProperty(b,u){return this._isValidId(b)?this.style.getLayoutProperty(b,u):null}getSchema(b){return this.style.getSchema(b)}setSchema(b,u){return this.style.setSchema(b,u),this._update(!0)}getConfig(b){return this.style.getConfig(b)}setConfig(b,u){return this.style.setConfig(b,u),this._update(!0)}getConfigProperty(b,u){return this.style.getConfigProperty(b,u)}setConfigProperty(b,u,p){return this.style.setConfigProperty(b,u,p),this._update(!0)}setLights(b){if(this._lazyInitEmptyStyle(),b&&b.length===1&&b[0].type==="flat"){const u=b[0];u.properties?this.style.setFlatLight(u.properties,u.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(b),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const b=this.style.getLights()||[];return b.length===0&&b.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),b}setLight(b,u={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:b}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(b){return this._lazyInitEmptyStyle(),!b&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(b),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(b){return this._lazyInitEmptyStyle(),this.style.setFog(b),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(b){return this._lazyInitEmptyStyle(),this.style.setColorTheme(b),this._update(!0)}setCamera(b){return this.style.setCamera(b),this._triggerCameraUpdate(b)}_triggerCameraUpdate(b){return this._update(this.transform.setOrthographicProjectionAtLowPitch(b["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(b){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bK.convert(b),this.transform):0}setFeatureState(b,u){return this._isValidId(b.source)?(this.style.setFeatureState(b,u),this._update()):this}removeFeatureState(b,u){return this._isValidId(b.source)?(this.style.removeFeatureState(b,u),this._update()):this}getFeatureState(b){return this._isValidId(b.source)?this.style.getFeatureState(b):null}_updateContainerDimensions(){if(!this._container)return;const b=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let p,w,I,P=this._container;for(;P&&(!w||!I);){const F=window.getComputedStyle(P).transform;F&&F!=="none"&&(p=F.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&p[0]!=="0"&&p[0]!=="1"&&(w=p[0]),p[3]&&p[3]!=="0"&&p[3]!=="1"&&(I=p[3])),P=P.parentElement}this._containerWidth=w?Math.abs(b/w):b,this._containerHeight=I?Math.abs(u/I):u}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=M("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=M("div","mapboxgl-canvas-container",b);this._canvas=M("canvas","mapboxgl-canvas",u),this._interactive&&(u.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=M("div","mapboxgl-control-container",b),w=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(I=>{w[I]=M("div",`mapboxgl-ctrl-${I}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,u){const p=o.q.devicePixelRatio||1;this._canvas.width=p*Math.ceil(b),this._canvas.height=p*Math.ceil(u),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${u}px`}_addMarker(b){this._markers.push(b)}_removeMarker(b){const u=this._markers.indexOf(b);u!==-1&&this._markers.splice(u,1)}_addPopup(b){this._popups.push(b)}_removePopup(b){const u=this._popups.indexOf(b);u!==-1&&this._popups.splice(u,1)}_setupPainter(){const b=o.l({},E.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._canvas.getContext("webgl2",b);u?(mn(u,!0),this.painter=new Qa(u,this._contextCreateOptions,this.transform,this._tp),this.on("data",p=>{p.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(u)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_requestDomTask(b){!this.loaded()||this.loaded()&&!this.isMoving()?b():this._domRenderTaskQueue.add(b)}_render(b){let u;this.fire(new o.x("renderstart")),++this._frameId;const p=this.painter.context.extTimerQuery,w=o.q.now(),I=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(u=I.createQuery(),I.beginQuery(p.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(b),this._domRenderTaskQueue.run(b),this._removed)return;this._updateProjectionTransition();const P=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,Q=this.transform.pitch,oe=o.q.now(),le=new o.a3(J,{now:oe,fadeDuration:P,pitch:Q,transition:this.style.transition});this.style.update(le)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let F=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),F=this._updateAverageElevation(w),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):F=this._updateAverageElevation(w);const W=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,this.painter.replacementSource);if(W&&(this._placementDirty=W.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,m.mark(d.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const J=o.q.now()-w;I.endQuery(p.TIME_ELAPSED_EXT),setTimeout(()=>{const Q=I.getQueryParameter(u,I.QUERY_RESULT)/1e6;I.deleteQuery(u),this.fire(new o.x("gpu-timing-frame",{cpuTime:J,gpuTime:Q}))},50)}if(this.listens("gpu-timing-layer")){const J=this.painter.collectGpuTimers();setTimeout(()=>{const Q=this.painter.queryGpuTimers(J);this.fire(new o.x("gpu-timing-layer",{layerTimes:Q}))},50)}if(this.listens("gpu-timing-deferred-render")){const J=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Q=this.painter.queryGpuTimeDeferredRender(J);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:Q}))},50)}const $=this._sourcesDirty||this._styleDirty||this._placementDirty||F;if($||this._repaint)this.triggerRepaint();else{const J=this.idle();if(J&&(F=this._updateAverageElevation(w,!0)),F)this.triggerRepaint();else if(this._triggerFrame(!1),J&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Q=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:Q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,m.mark(d.fullLoad),this._performanceMetricsCollection&&Bn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(b){for(const u of this._markers)b&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!b||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(b,u=!1){const p=I=>(this.transform.averageElevation=I,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&p(0);const w=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(w||(u||b-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(b)){const I=this.transform.averageElevation;let P=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(P)?P=0:this._averageElevationLastSampledAt=b;const F=Math.abs(I-P);if(F>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(P),p(P);this._averageElevation.easeTo(P,b,300)}else if(F>1e-4)return this._averageElevation.jumpTo(P),p(P)}return!!this._averageElevation.isEasing(b)&&p(this._averageElevation.getValue(b))}_authenticate(){Pe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,b=>{if(b&&(b.message===Ie||b.status===401)){const u=this.painter.context.gl;mn(u,!1),this._logoControl instanceof Ot&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ht(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&rn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const b=this._isDragging();this.painter.updateTerrain(this.style,b)}_calculateSpeedIndex(){const b=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const p=this.painter.context.gl,w=p.createFramebuffer();function I(P){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,P,0);const F=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,F),F}return p.bindFramebuffer(p.FRAMEBUFFER,w),this._canvasPixelComparison(I(b),u.canvasCopies.map(I),u.timeStamps)}_canvasPixelComparison(b,u,p){let w=p[1]-p[0];const I=b.length/4;for(let P=0;P<u.length;P++){const F=u[P];let W=0;for(let $=0;$<F.length;$+=4)F[$]===b[$]&&F[$+1]===b[$+1]&&F[$+2]===b[$+2]&&F[$+3]===b[$+3]&&(W+=1);w+=(p[P+2]-p[P+1])*(1-W/I)}return w}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),qe.delete(this.painter.context.gl),Tn.remove(),lt.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(b){this._renderNextFrame=this._renderNextFrame||b,this.style&&!this._frame&&(this._frame=o.q.frame(u=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(u)}))}_preloadTiles(b){const u=this.style?this.style.getSourceCaches():[];return o.bf(u,(p,w)=>p._preloadTiles(b,w),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(b){this._showParseStatus!==b&&(this._showParseStatus=b,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(b){this._showTerrainWireframe!==b&&(this._showTerrainWireframe=b,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(b){this._showLayers2DWireframe!==b&&(this._showLayers2DWireframe=b,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(b){this._showLayers3DWireframe!==b&&(this._showLayers3DWireframe=b,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(b){this._speedIndexTiming!==b&&(this._speedIndexTiming=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,this._tp.refreshUI(),b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(b){this._showTileAABBs!==b&&(this._showTileAABBs=b,this._tp.refreshUI(),b&&this._update())}_setCacheLimits(b,u){o.dy(b,u)}get version(){return h}},NavigationControl:class{constructor(b={}){this.options=o.l({},Ir,b),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),M("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),M("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:u}):p.resetNorth({},{originalEvent:u}))}),this._compassIcon=M("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map;if(!b)return;const u=b.getZoom(),p=u===b.getMaxZoom(),w=u===b.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())}_rotateCompassArrow(){const b=this._map;if(!b)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(b.transform.pitch*(Math.PI/180)),.5)}) rotateX(${b.transform.pitch}deg) rotateZ(${b.transform.angle*(180/Math.PI)}deg)`:`rotate(${b.transform.angle*(180/Math.PI)}deg)`;b._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),b.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&b.on("pitch",this._rotateCompassArrow),b.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new uo(b,this._compass,this.options.visualizePitch)),this._container}onRemove(){const b=this._map;b&&(this._container.remove(),this.options.showZoom&&b.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&b.off("pitch",this._rotateCompassArrow),b.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(b,u){const p=M("button",b,this._container);return p.type="button",p.addEventListener("click",u),p}_setButtonTitle(b,u){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${u}`);b.setAttribute("aria-label",p),b.firstElementChild&&b.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends o.E{constructor(b={}){super();const u=navigator.geolocation;this.options=o.l({geolocation:u},on,b),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Rl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(b){return this._map=b,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(b){const u=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,b(p)};this._supportsGeolocation!==void 0?b(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(p=>u(p.state!=="denied")).catch(()=>u()):u()}_isOutOfMapMaxBounds(b){const u=this._map.getMaxBounds(),p=b.coords;return!!u&&(p.longitude<u.getWest()||p.longitude>u.getEast()||p.latitude<u.getSouth()||p.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",b)),this._finish()}}_updateCamera(b){const u=new o.bK(b.coords.longitude,b.coords.latitude),p=b.coords.accuracy,w=this._map.getBearing(),I=o.l({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(p),I,{geolocateSource:!0})}_updateMarker(b){if(b){const u=new o.bK(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map.transform,u=o.bD(1,b._center.lat)*b.worldSize,p=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=M("button","mapboxgl-ctrl-geolocate",this._container),M("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M("div","mapboxgl-user-location"),this._dotElement.appendChild(M("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(M("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Nt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=M("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(b){this._userLocationDotMarker&&(b.webkitCompassHeading?this._heading=b.webkitCompassHeading:b.absolute===!0&&(this._heading=-1*b.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(b={maximumAge:6e5,timeout:0},this._noTimeout=!0):(b=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,b),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const b=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(u=>{u==="granted"&&b()}).catch(console.error):b()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dt,ScaleControl:class{constructor(b={}){this.options=o.l({},rr,b),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const b=this.options.maxWidth||100,u=this._map,p=u._containerHeight/2,w=u._containerWidth/2-b/2,I=u.unproject([w,p]),P=u.unproject([w+b,p]),F=I.distanceTo(P);if(this.options.unit==="imperial"){const W=3.2808*F;W>5280?this._setScale(b,W/5280,"mile"):this._setScale(b,W,"foot")}else this.options.unit==="nautical"?this._setScale(b,F/1852,"nautical-mile"):F>=1e3?this._setScale(b,F/1e3,"kilometer"):this._setScale(b,F,"meter")}_setScale(b,u,p){this._map._requestDomTask(()=>{const w=function(P){const F=Math.pow(10,`${Math.floor(P)}`.length-1);let W=P/F;return W=W>=10?10:W>=5?5:W>=3?3:W>=2?2:W>=1?1:function($){const J=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*J)/J}(W),F*W}(u),I=w/u;this._container.innerHTML=this._isNumberFormatSupported&&p!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(w):`${w}&nbsp;${Rr[p]}`,this._container.style.width=b*I+"px"})}onAdd(b){return this._map=b,this._language=b.getLanguage(),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(b){this._language=b,this._update()}setUnit(b){this.options.unit=b,this._update()}},FullscreenControl:class{constructor(b={}){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=M("button","mapboxgl-ctrl-fullscreen",this._controlContainer);M("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",b)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(b){super(),this.options=o.l(Object.create(gi),b),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(b&&b.className?b.className.trim().split(/\s+/):[])}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&b.on("preclick",this._onClose),this.options.closeOnMove&&b.on("move",this._onClose),b.on("remove",this.remove),this._update(),b._addPopup(this),this._focusFirstElement(),this._trackPointer?(b.on("mousemove",this._onMouseEvent),b.on("mouseup",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")):b.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const b=this._map;return b&&(b.off("move",this._update),b.off("move",this._onClose),b.off("preclick",this._onClose),b.off("click",this._onClose),b.off("remove",this.remove),b.off("mousemove",this._onMouseEvent),b.off("mouseup",this._onMouseEvent),b.off("drag",this._onMouseEvent),b._canvasContainer&&b._canvasContainer.classList.remove("mapboxgl-track-pointer"),b._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(b){this._lngLat=o.bK.convert(b),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const b=this._map;return b&&(b.off("move",this._update),b.on("mousemove",this._onMouseEvent),b.on("drag",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const u=document.createDocumentFragment(),p=document.createElement("body");let w;for(p.innerHTML=b;w=p.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=M("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(b),this.options.closeButton){const p=this._closeButton=M("button","mapboxgl-popup-close-button",u);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(b){return this._classList.add(b),this._updateClassList(),this}removeClassName(b){return this._classList.delete(b),this._updateClassList(),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){let u;return this._classList.delete(b)?u=!1:(this._classList.add(b),u=!0),this._updateClassList(),u}_onMouseEvent(b){this._update(b.point)}_getAnchor(b){if(this.options.anchor)return this.options.anchor;const u=this._map,p=this._container,w=this._pos;if(!u||!p||!w)return"bottom";const I=p.offsetWidth,P=p.offsetHeight,F=w.x<I/2,W=w.x>u.transform.width-I/2;if(w.y+b<P)return F?"top-left":W?"top-right":"top";if(w.y>u.transform.height-P){if(F)return"bottom-left";if(W)return"bottom-right"}return F?"left":W?"right":"bottom"}_updateClassList(){const b=this._container;if(!b)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),b.className=u.join(" ")}_update(b){const u=this._map,p=this._content;if(!u||!this._lngLat&&!this._trackPointer||!p)return;let w=this._container;if(w||(w=this._container=M("div","mapboxgl-popup",u.getContainer()),this._tip=M("div","mapboxgl-popup-tip",w),w.appendChild(p)),this.options.maxWidth&&w.style.maxWidth!==this.options.maxWidth&&(w.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ho(this._lngLat,this._pos,u.transform)),!this._trackPointer||b){const I=this._pos=this._trackPointer&&b instanceof o.P?b:u.project(this._lngLat),P=Ni(this.options.offset),F=this._anchor=this._getAnchor(P.y),W=Ni(this.options.offset,F),$=I.add(W).round();u._requestDomTask(()=>{this._container&&F&&(this._container.style.transform=`${Xt[F]} translate(${$.x}px,${$.y}px)`)})}if(!this._marker&&u._showingGlobe()){const I=o.dz(u.transform,this._lngLat)?0:1;this._setOpacity(I)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(li);b&&b.focus()}_onClose(){this.remove()}_setOpacity(b){this._container&&(this._container.style.opacity=`${b}`),this._content&&(this._content.style.pointerEvents=b?"auto":"none")}},Marker:Nt,Style:Oa,LngLat:o.bK,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:xo,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(b){o.e.ACCESS_TOKEN=b},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(b){o.e.API_URL=b},get workerCount(){return o.dG.workerCount},set workerCount(b){o.dG.workerCount=b},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){o.e.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){o.dH(b)},get workerUrl(){return o.dI.workerUrl},set workerUrl(b){o.dI.workerUrl=b},get workerClass(){return o.dI.workerClass},set workerClass(b){o.dI.workerClass=b},get workerParams(){return o.dI.workerParams},set workerParams(b){o.dI.workerParams=b},get dracoUrl(){return o.dJ()},set dracoUrl(b){o.dK(b)},get meshoptUrl(){return o.dL()},set meshoptUrl(b){o.dM(b)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var l=s;return l})})(dce);var nUe=dce.exports;const D0=SL(nUe),rUe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null),t={lng:-74.5,lat:40,zoom:9,bearing:0,pitch:0},[r,i]=Ae.useState(t),s=()=>{e.current.flyTo({center:[t.lng,t.lat],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch})};return Ae.useEffect(()=>(D0.accessToken="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",e.current=new D0.Map({container:n.current,center:[r.lng,r.lat],zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),e.current&&e.current.on("move",()=>{const a=e.current.getCenter();i({...r,lng:a.lng,lat:a.lat})}),e.current&&e.current.on("zoom",()=>{const a=e.current.getZoom();i({...r,zoom:a})}),e.current&&e.current.on("rotate",()=>{const a=e.current.getBearing();i({...r,bearing:a})}),e.current&&e.current.on("pitch",()=>{const a=e.current.getPitch();i({...r,pitch:a})}),()=>{e.current.remove()}),[]),me.jsxs("div",{children:[me.jsxs("div",{className:"absolute bottom-0 left-0 m-1 p-1 rounded-md bg-black-500 text-white z-10",children:["Longitude: ",r.lng.toFixed(4)," | Latitude: ",r.lat.toFixed(4)," | Zoom: ",r.zoom.toFixed(2)," | Bearing: ",r.bearing.toFixed(2)," | Pitch: ",r.pitch.toFixed(2),me.jsx("button",{className:"ml-6 bg-slate-500 rounded-md",onClick:s,children:"RESET"})]}),me.jsx("div",{className:"w-screen h-screen z-0",ref:n})]})};(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function n(k){try{return k.defaultView&&k.defaultView.frameElement||null}catch{return null}}var e=function(k){for(var H=k,q=n(H);q;)H=q.ownerDocument,q=n(H);return H}(window.document),t=[],r=null,i=null;function s(k){this.time=k.time,this.target=k.target,this.rootBounds=S(k.rootBounds),this.boundingClientRect=S(k.boundingClientRect),this.intersectionRect=S(k.intersectionRect||y()),this.isIntersecting=!!k.intersectionRect;var H=this.boundingClientRect,q=H.width*H.height,Z=this.intersectionRect,ee=Z.width*Z.height;q?this.intersectionRatio=Number((ee/q).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function a(k,H){var q=H||{};if(typeof k!="function")throw new Error("callback must be a function");if(q.root&&q.root.nodeType!=1&&q.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=o(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=k,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(q.rootMargin),this.thresholds=this._initThresholds(q.threshold),this.root=q.root||null,this.rootMargin=this._rootMarginValues.map(function(Z){return Z.value+Z.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return r||(r=function(k,H){!k||!H?i=y():i=E(k,H),t.forEach(function(q){q._checkForIntersections()})}),r},a._resetCrossOriginUpdater=function(){r=null,i=null},a.prototype.observe=function(k){var H=this._observationTargets.some(function(q){return q.element==k});if(!H){if(!(k&&k.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:k,entry:null}),this._monitorIntersections(k.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(k){this._observationTargets=this._observationTargets.filter(function(H){return H.element!=k}),this._unmonitorIntersections(k.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var k=this._queuedEntries.slice();return this._queuedEntries=[],k},a.prototype._initThresholds=function(k){var H=k||[0];return Array.isArray(H)||(H=[H]),H.sort().filter(function(q,Z,ee){if(typeof q!="number"||isNaN(q)||q<0||q>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return q!==ee[Z-1]})},a.prototype._parseRootMargin=function(k){var H=k||"0px",q=H.split(/\s+/).map(function(Z){var ee=/^(-?\d*\.?\d+)(px|%)$/.exec(Z);if(!ee)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(ee[1]),unit:ee[2]}});return q[1]=q[1]||q[0],q[2]=q[2]||q[0],q[3]=q[3]||q[1],q},a.prototype._monitorIntersections=function(k){var H=k.defaultView;if(H&&this._monitoringDocuments.indexOf(k)==-1){var q=this._checkForIntersections,Z=null,ee=null;this.POLL_INTERVAL?Z=H.setInterval(q,this.POLL_INTERVAL):(h(H,"resize",q,!0),h(k,"scroll",q,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in H&&(ee=new H.MutationObserver(q),ee.observe(k,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(k),this._monitoringUnsubscribes.push(function(){var ae=k.defaultView;ae&&(Z&&ae.clearInterval(Z),d(ae,"resize",q,!0)),d(k,"scroll",q,!0),ee&&ee.disconnect()});var re=this.root&&(this.root.ownerDocument||this.root)||e;if(k!=re){var se=n(k);se&&this._monitorIntersections(se.ownerDocument)}}},a.prototype._unmonitorIntersections=function(k){var H=this._monitoringDocuments.indexOf(k);if(H!=-1){var q=this.root&&(this.root.ownerDocument||this.root)||e,Z=this._observationTargets.some(function(se){var ae=se.element.ownerDocument;if(ae==k)return!0;for(;ae&&ae!=q;){var fe=n(ae);if(ae=fe&&fe.ownerDocument,ae==k)return!0}return!1});if(!Z){var ee=this._monitoringUnsubscribes[H];if(this._monitoringDocuments.splice(H,1),this._monitoringUnsubscribes.splice(H,1),ee(),k!=q){var re=n(k);re&&this._unmonitorIntersections(re.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var k=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var H=0;H<k.length;H++)k[H]()},a.prototype._checkForIntersections=function(){if(!(!this.root&&r&&!i)){var k=this._rootIsInDom(),H=k?this._getRootRect():y();this._observationTargets.forEach(function(q){var Z=q.element,ee=v(Z),re=this._rootContainsTarget(Z),se=q.entry,ae=k&&re&&this._computeTargetAndRootIntersection(Z,ee,H),fe=null;this._rootContainsTarget(Z)?(!r||this.root)&&(fe=H):fe=y();var Se=q.entry=new s({time:l(),target:Z,boundingClientRect:ee,rootBounds:fe,intersectionRect:ae});se?k&&re?this._hasCrossedThreshold(se,Se)&&this._queuedEntries.push(Se):se&&se.isIntersecting&&this._queuedEntries.push(Se):this._queuedEntries.push(Se)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(k,H,q){if(window.getComputedStyle(k).display!="none"){for(var Z=H,ee=C(k),re=!1;!re&&ee;){var se=null,ae=ee.nodeType==1?window.getComputedStyle(ee):{};if(ae.display=="none")return null;if(ee==this.root||ee.nodeType==9)if(re=!0,ee==this.root||ee==e)r&&!this.root?!i||i.width==0&&i.height==0?(ee=null,se=null,Z=null):se=i:se=q;else{var fe=C(ee),Se=fe&&v(fe),Ce=fe&&this._computeTargetAndRootIntersection(fe,Se,q);Se&&Ce?(ee=fe,se=E(Se,Ce)):(ee=null,Z=null)}else{var Ie=ee.ownerDocument;ee!=Ie.body&&ee!=Ie.documentElement&&ae.overflow!="visible"&&(se=v(ee))}if(se&&(Z=m(se,Z)),!Z)break;ee=ee&&C(ee)}return Z}},a.prototype._getRootRect=function(){var k;if(this.root&&!L(this.root))k=v(this.root);else{var H=L(this.root)?this.root:e,q=H.documentElement,Z=H.body;k={top:0,left:0,right:q.clientWidth||Z.clientWidth,width:q.clientWidth||Z.clientWidth,bottom:q.clientHeight||Z.clientHeight,height:q.clientHeight||Z.clientHeight}}return this._expandRectByRootMargin(k)},a.prototype._expandRectByRootMargin=function(k){var H=this._rootMarginValues.map(function(Z,ee){return Z.unit=="px"?Z.value:Z.value*(ee%2?k.width:k.height)/100}),q={top:k.top-H[0],right:k.right+H[1],bottom:k.bottom+H[2],left:k.left-H[3]};return q.width=q.right-q.left,q.height=q.bottom-q.top,q},a.prototype._hasCrossedThreshold=function(k,H){var q=k&&k.isIntersecting?k.intersectionRatio||0:-1,Z=H.isIntersecting?H.intersectionRatio||0:-1;if(q!==Z)for(var ee=0;ee<this.thresholds.length;ee++){var re=this.thresholds[ee];if(re==q||re==Z||re<q!=re<Z)return!0}},a.prototype._rootIsInDom=function(){return!this.root||M(e,this.root)},a.prototype._rootContainsTarget=function(k){var H=this.root&&(this.root.ownerDocument||this.root)||e;return M(H,k)&&(!this.root||H==k.ownerDocument)},a.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},a.prototype._unregisterInstance=function(){var k=t.indexOf(this);k!=-1&&t.splice(k,1)};function l(){return window.performance&&performance.now&&performance.now()}function o(k,H){var q=null;return function(){q||(q=setTimeout(function(){k(),q=null},H))}}function h(k,H,q,Z){typeof k.addEventListener=="function"?k.addEventListener(H,q,Z):typeof k.attachEvent=="function"&&k.attachEvent("on"+H,q)}function d(k,H,q,Z){typeof k.removeEventListener=="function"?k.removeEventListener(H,q,Z):typeof k.detachEvent=="function"&&k.detachEvent("on"+H,q)}function m(k,H){var q=Math.max(k.top,H.top),Z=Math.min(k.bottom,H.bottom),ee=Math.max(k.left,H.left),re=Math.min(k.right,H.right),se=re-ee,ae=Z-q;return se>=0&&ae>=0&&{top:q,bottom:Z,left:ee,right:re,width:se,height:ae}||null}function v(k){var H;try{H=k.getBoundingClientRect()}catch{}return H?(H.width&&H.height||(H={top:H.top,right:H.right,bottom:H.bottom,left:H.left,width:H.right-H.left,height:H.bottom-H.top}),H):y()}function y(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function S(k){return!k||"x"in k?k:{top:k.top,y:k.top,bottom:k.bottom,left:k.left,x:k.left,right:k.right,width:k.width,height:k.height}}function E(k,H){var q=H.top-k.top,Z=H.left-k.left;return{top:q,left:Z,height:H.height,width:H.width,bottom:q+H.height,right:Z+H.width}}function M(k,H){for(var q=H;q;){if(q==k)return!0;q=C(q)}return!1}function C(k){var H=k.parentNode;return k.nodeType==9&&k!=e?n(k):(H&&H.assignedSlot&&(H=H.assignedSlot.parentNode),H&&H.nodeType==11&&H.host?H.host:H)}function L(k){return k&&k.nodeType===9}window.IntersectionObserver=a,window.IntersectionObserverEntry=s})();function iUe(n,e=document){return typeof n=="string"?Array.from(e.querySelectorAll(n)):n instanceof Element?[n]:n instanceof NodeList?Array.from(n):n instanceof Array?n:[]}function sUe(n){const e=document.createElement("div");e.className=`scrollama__debug-step ${n}`,e.style.position="fixed",e.style.left="0",e.style.width="100%",e.style.zIndex="9999",e.style.borderTop="2px solid black",e.style.borderBottom="2px solid black";const t=document.createElement("p");return t.style.position="absolute",t.style.left="0",t.style.height="1px",t.style.width="100%",t.style.borderTop="1px dashed black",e.appendChild(t),document.body.appendChild(e),e}function oUe({id:n,step:e,marginTop:t}){const{index:r,height:i}=e,s=`scrollama__debug-step--${n}-${r}`;let a=document.querySelector(`.${s}`);a||(a=sUe(s)),a.style.top=`${t*-1}px`,a.style.height=`${i}px`,a.querySelector("p").style.top=`${i/2}px`}function aUe(){const n="abcdefghijklmnopqrstuvwxyz",e=Date.now(),t=[];for(let r=0;r<6;r+=1){const i=n[Math.floor(Math.random()*n.length)];t.push(i)}return`${t.join("")}${e}`}function bI(n){console.error(`scrollama error: ${n}`)}function hS(n){return+n.getAttribute("data-scrollama-index")}function lUe(n,e){const t=Math.ceil(n/e),r=[],i=1/t;for(let s=0;s<t+1;s+=1)r.push(s*i);return r}function rO(n){if(typeof n=="string"&&n.indexOf("px")>0){const e=+n.replace("px","");return isNaN(e)?(err("offset value must be in 'px' format. Fallback to 0.5."),{format:"percent",value:.5}):{format:"pixels",value:e}}else if(typeof n=="number"||!isNaN(+n))return n>1&&err("offset value is greater than 1. Fallback to 1."),n<0&&err("offset value is lower than 0. Fallback to 0."),{format:"percent",value:Math.min(Math.max(0,n),1)};return null}function cUe(n){n.forEach(e=>e.node.setAttribute("data-scrollama-index",e.index))}function uUe(n){const{top:e}=n.getBoundingClientRect(),t=window.pageYOffset,r=document.body.clientTop||0;return e+t-r}let eb,cR,bm;function mce(n){const e=n?n.scrollTop:window.pageYOffset;eb!==e&&(eb=e,eb>cR?bm="down":eb<cR&&(bm="up"),cR=eb)}function hUe(n){eb=0,cR=0,document.addEventListener("scroll",()=>mce(n))}function fUe(){let n={},e=aUe(),t=[],r,i,s,a=0,l=!1,o=!1,h=!1,d=!1,m=[];function v(){n={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},m=[]}function y(Ie){Ie&&!l&&Se(),!Ie&&l&&q(),l=Ie}function S(Ie,je){const Le=hS(Ie),ot=t[Le];je!==void 0&&(ot.progress=je);const ye={element:Ie,index:Le,progress:je,direction:bm};ot.state==="enter"&&n.stepProgress(ye)}function E(Ie,je=!0){const Le=hS(Ie),ot=t[Le],ye={element:Ie,index:Le,direction:bm};ot.direction=bm,ot.state="enter",m[Le]||n.stepEnter(ye),d&&(m[Le]=!0)}function M(Ie,je=!0){const Le=hS(Ie),ot=t[Le];if(!ot.state)return!1;const ye={element:Ie,index:Le,direction:bm};o&&(bm==="down"&&ot.progress<1?S(Ie,1):bm==="up"&&ot.progress>0&&S(Ie,0)),ot.direction=bm,ot.state="exit",n.stepExit(ye)}function C([Ie]){const je=hS(Ie.target),Le=t[je],ot=Ie.target.offsetHeight;ot!==Le.height&&(Le.height=ot,H(Le),re(Le),Z(Le))}function L([Ie]){mce(i);const{isIntersecting:je,target:Le}=Ie;je?E(Le):M(Le)}function k([Ie]){const je=hS(Ie.target),Le=t[je],{isIntersecting:ot,intersectionRatio:ye,target:$e}=Ie;ot&&Le.state==="enter"&&S($e,ye)}function H({observers:Ie}){Object.keys(Ie).map(je=>{Ie[je].disconnect()})}function q(){t.forEach(H)}function Z(Ie){const je=new ResizeObserver(C);je.observe(Ie.node),Ie.observers.resize=je}function ee(){t.forEach(Z)}function re(Ie){const je=window.innerHeight,Le=Ie.offset||r,ot=Le.format==="pixels"?1:je,ye=Le.value*ot,$e=Ie.height/2-ye,Ve=Ie.height/2-(je-ye),lt={rootMargin:`${$e}px 0px ${Ve}px 0px`,threshold:.5,root:s},Ht=new IntersectionObserver(L,lt);Ht.observe(Ie.node),Ie.observers.step=Ht,h&&oUe({id:e,step:Ie,marginTop:$e,marginBottom:Ve})}function se(){t.forEach(re)}function ae(Ie){const je=window.innerHeight,Le=Ie.offset||r,ot=Le.format==="pixels"?1:je,ye=Le.value*ot,$e=-ye+Ie.height,Ve=ye-je,_t=`${$e}px 0px ${Ve}px 0px`,wt=lUe(Ie.height,a),Vt={rootMargin:_t,threshold:wt},lt=new IntersectionObserver(k,Vt);lt.observe(Ie.node),Ie.observers.progress=lt}function fe(){t.forEach(ae)}function Se(){q(),ee(),se(),o&&fe()}const Ce={};return Ce.setup=({step:Ie,parent:je,offset:Le=.5,threshold:ot=4,progress:ye=!1,once:$e=!1,debug:Ve=!1,container:_t=void 0,root:wt=null})=>(hUe(_t),t=iUe(Ie,je).map((Vt,lt)=>({index:lt,direction:void 0,height:Vt.offsetHeight,node:Vt,observers:{},offset:rO(Vt.dataset.offset),top:uUe(Vt),progress:0,state:void 0})),t.length?(o=ye,d=$e,h=Ve,a=Math.max(1,+ot),r=rO(Le),i=_t,s=wt,v(),cUe(t),y(!0),Ce):(bI("no step elements"),Ce)),Ce.enable=()=>(y(!0),Ce),Ce.disable=()=>(y(!1),Ce),Ce.destroy=()=>(y(!1),v(),Ce),Ce.resize=()=>(Se(),Ce),Ce.offset=Ie=>Ie==null?r.value:(r=rO(Ie),Se(),Ce),Ce.onStepEnter=Ie=>(typeof Ie=="function"?n.stepEnter=Ie:bI("onStepEnter requires a function"),Ce),Ce.onStepExit=Ie=>(typeof Ie=="function"?n.stepExit=Ie:bI("onStepExit requires a function"),Ce),Ce.onStepProgress=Ie=>(typeof Ie=="function"?n.stepProgress=Ie:bI("onStepProgress requires a function"),Ce),Ce}const gce="/about_portfolio/assets/first%20period-Cjp1RjP4.jpeg",_z="/about_portfolio/assets/hui-Ao1uY3rr.jpeg",vce="/about_portfolio/assets/naipiao-BUdMlmen.jpg",r9="/about_portfolio/assets/qindiao-CKTdrbCg.png",_ce="/about_portfolio/assets/quanqiu-DnDfEiIO.jpeg",yce="/about_portfolio/assets/quanqiuhua-CFNf60Po.jpeg",i9="/about_portfolio/assets/sanjuqingan-Bkq-CSnX.png",s9="/about_portfolio/assets/sanyuan-BxeIias_.png",o9="/about_portfolio/assets/sanyuanshangshi-DbcI-flH.jpeg",a9="/about_portfolio/assets/shangshi-CZtwHG4A.jpeg",xce="/about_portfolio/assets/stage2-D7wGlXfP.png",bce="/about_portfolio/assets/Thankyou-DonPtijT.jpeg",wce="/about_portfolio/assets/zhiliang-CZ_P7IVS.jpeg",dUe="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",yz=["mapbox://styles/linklink/cm2v9ot6s00fu01pwfs3q147j","mapbox://styles/linklink/cm2fmcw0200bb01ph6edf69ne","mapbox://styles/linklink/cl097w45i001o15mueqt9chmp"],zl={style:yz[0],showMarkers:!1,markerColor:"#3FB1CE",inset:!0,theme:"dark",use3dTerrain:!0,title:"      ",byline:`



`,footer:'Source: source citations, etc. <br> Created using <a href="https://github.com/mapbox/storytelling" target="_blank">Mapbox Storytelling</a> template.',chapters:[{id:"first-period",alignment:"fully",hidden:!1,title:"",description:'""',image:gce,location:{center:[122.418398,34.759483],zoom:4.5,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"qindiao",alignment:"right",hidden:!1,title:"",image:r9,description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;10",location:{center:[120.922941,27.893666],zoom:10,pitch:0,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan",alignment:"left",hidden:!1,title:"",image:s9,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",location:{center:[116.489303,39.923409],zoom:10,pitch:8.01,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_conclusion",alignment:"fully",hidden:!1,title:"",image:vce,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[116.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_map",alignment:"right",hidden:!0,location:{center:[114.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-stage",alignment:"fully",hidden:!1,image:xce,description:"&nbsp;&nbsp;&nbsp;&nbsp;1949-1978197897<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1978<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"zhengce",alignment:"right",title:"",hidden:!1,image:wce,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984719912000",location:{center:[116.70918,40.142585],zoom:7,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"yilishangshi",alignment:"left",title:"",hidden:!1,image:a9,description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A",location:{center:[111.74918,40.842585],zoom:10,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"chengli",alignment:"fully",title:"",hidden:!1,image:_z,description:"&nbsp;&nbsp;&nbsp;&nbsp;19901995<br/>&nbsp;&nbsp;&nbsp;&nbsp;19905<br/>&nbsp;&nbsp;&nbsp;&nbsp;19921<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-map",alignment:"left",title:"",hidden:!0,image:_z,location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-stage",alignment:"fully",title:"21",hidden:!1,image:_ce,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan2",alignment:"right",title:"",hidden:!1,image:o9,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",location:{center:[116.74918,40.842585],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanju",alignment:"left",title:"",hidden:!1,image:i9,description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[114.586506,38.151115],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"international",alignment:"fully",title:"",hidden:!1,image:yce,description:"<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-map",alignment:"fully",hidden:!0,location:{center:[114.586506,38.151115],zoom:3,pitch:0,bearing:0},mapType:4,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"Thankyou",alignment:"fully",title:"",hidden:!1,image:bce,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]}]},Sce="/about_portfolio/assets/bashi-j4Q9hrvQ.png",Ace="/about_portfolio/assets/bifengtang-yZIlcoLv.jpeg",Tce="/about_portfolio/assets/guangming-Ch0sfKFV.png",l9="/about_portfolio/assets/guangze-COXCU3fq.png",Mce="/about_portfolio/assets/hongxing-TMciPCkF.png",Cce="/about_portfolio/assets/sanyuan2-ek_zenH7.jpeg",Ece="/about_portfolio/assets/song-DXjP89Jt.png",Ice="/about_portfolio/assets/wandashan-CrxNEfy8.png",Rce="/about_portfolio/assets/weigang-CEFEuaeN.png",Pce="/about_portfolio/assets/wushilan-CQSBRYUS.jpeg",Lce="/about_portfolio/assets/xiaoxiniu-CJwZNYCM.jpeg",Dce="/about_portfolio/assets/xiyuchun-BftcuwaV.png",Bce="/about_portfolio/assets/yili-xXFaKPoe.jpeg",kce="/about_portfolio/assets/youzhiyou-DEWmaBTZ.jpeg";var pUe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[120.722941,27.793666]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:r9,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.489303,39.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",image:s9,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.419303,30.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Tce,imageHeight:200,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[129.589303,44.603409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;50-80",image:Mce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1928<br/>&nbsp;&nbsp;&nbsp;&nbsp;75,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Ece,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[87.419303,43.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1955<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;60,",image:Dce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[126.686109,45.738561]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;101963750",image:Ice,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.9736,41.1272]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1956<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Bce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.308198,39.869373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Sce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[117.318198,39.259373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19588<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:l9,imageHeight:100,imageWidth:220}}]},mUe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[111.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:a9,imageHeight:120,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19491983",image:Rce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2001",image:l9,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.70918,40.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;199750%20012003",image:Cce,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[114.70918,30.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19986499<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:Ace,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.586506,31.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1998",image:kce,imageHeight:200,imageWidth:200}},{type:"Feature",geometry:{type:"Point",coordinates:[123.586506,23.151115]},properties:{title:"50",description:"&nbsp;&nbsp;&nbsp;&nbsp;501994",image:Pce,imageHeight:200,imageWidth:180}},{type:"Feature",geometry:{type:"Point",coordinates:[101.586506,36.751115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2002",image:Lce,imageHeight:200,imageWidth:200}}]},gUe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[114.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:i9,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",image:o9,imageHeight:120,imageWidth:220}}]},vUe={type:"FeatureCollection",features:[]};const _Ue=[null,pUe,mUe,gUe,vUe],yUe=()=>{const n=Ae.useRef(null);let e=Ae.useRef(null);const t=Ae.useRef(null),r=Ae.useRef(null),i=Ae.useRef(null);let s=!0,a=[],l=0;const o={fill:["fill-opacity"],line:["line-opacity"],circle:["circle-opacity","circle-stroke-opacity"],symbol:["icon-opacity","text-opacity"],raster:["raster-opacity"],"fill-extrusion":["fill-extrusion-opacity"],heatmap:["heatmap-opacity"]},h={left:"lefty",center:"centered",right:"righty",full:"fully"},d=M=>{let C=n.current.getLayer(M).type;return o[C]},m=M=>{d(M.layer).forEach(L=>{let k={};if(M.duration){let H=L+"-transition";k={duration:M.duration},n.current.setPaintProperty(M.layer,H,k)}n.current.setPaintProperty(M.layer,L,M.opacity,k)})},v=M=>{const L=M.indexOf("?")!==-1?"&pluginName=scrollytellingV2":"?pluginName=scrollytellingV2";return{url:M+L}},y=M=>{e.current.addSource("boundsSource",{type:"geojson",data:M}),e.current.addLayer({id:"boundsLayer",type:"fill",source:"boundsSource",layout:{},paint:{"fill-color":"#fff","fill-opacity":.2}}),e.current.addLayer({id:"outlineLayer",type:"line",source:"boundsSource",layout:{},paint:{"line-color":"#000","line-width":1}})},S=M=>{e.current.getSource("boundsSource").setData(M)},E=()=>{let M=n.current.getBounds(),C={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[M._sw.lng,M._sw.lat],[M._ne.lng,M._sw.lat],[M._ne.lng,M._ne.lat],[M._sw.lng,M._ne.lat],[M._sw.lng,M._sw.lat]]]}}]};s?(y(C),s=!1):S(C)};return Ae.useEffect(()=>{D0.accessToken=dUe,n.current=new D0.Map({container:r.current,style:yz[l],center:zl.chapters[0].location.center,zoom:zl.chapters[0].location.zoom,bearing:zl.chapters[0].location.bearing,pitch:zl.chapters[0].location.pitch,interactive:!0,transformRequest:v,projection:zl.projection});const M=new D0.NavigationControl({showCompass:!0,showZoom:!0});n.current.addControl(M,"top-left"),e.current=new D0.Map({container:t.current,style:"mapbox://styles/mapbox/dark-v10",center:zl.chapters[0].location.center,zoom:3,hash:!1,interactive:!1,attributionControl:!1});let C=fUe();n.current.on("load",()=>{n.current.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),n.current.setTerrain({source:"mapbox-dem",exaggeration:1.5}),n.current.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),n.current.on("move",E),n.current.dragPan.enable(),n.current.keyboard.enable(),C.setup({step:".step",offset:.5}).onStepEnter(L=>{const k=zl.chapters.find(H=>H.id===L.element.id);if(L.element.classList.add("active"),n.current[k.mapAnimation||"flyTo"](k.location),k.mapType!==l&&(l=k.mapType,l!==0)){if(n.current.setStyle(yz[l]),a!==null)for(let H=a.length-1;H>=0;H--)a[H].remove();for(let H of _Ue[l].features){let q=document.createElement("div");q.className="marker",q.style.backgroundImage="url("+H.properties.image+")",q.style.height="50px",q.style.width="50px",a.push(new D0.Marker(q).setLngLat(H.geometry.coordinates).setPopup(new D0.Popup({closeButton:!1,offset:25}).setHTML(`<h3>${H.properties.title}</h3><img src=${H.properties.image} height=${H.properties.imageHeight} width=${H.properties.imageWidth}><p>${H.properties.description}</p>`)).addTo(n.current))}}k.location.zoom<5?e.current.flyTo({center:k.location.center,zoom:0}):e.current.flyTo({center:k.location.center,zoom:3}),k.onChapterEnter.length>0&&k.onChapterEnter.forEach(m),k.callback&&window[k.callback](),k.rotateAnimation&&n.current.once("moveend",()=>{const H=n.current.getBearing();n.current.rotateTo(H+180,{duration:3e4,easing:function(q){return q}})})}).onStepExit(L=>{console.log(n.current.getStyle().layers);let k=zl.chapters.find(H=>H.id===L.element.id);L.element.classList.remove("active"),k.onChapterExit.length>0&&k.onChapterExit.forEach(m)})})},[]),me.jsxs("div",{className:"w-screen h-screen",children:[me.jsx("div",{className:"w-full h-full fixed",ref:r}),me.jsx("div",{className:"top-20 right-4 h-40 w-60 fixed pointer-events-none transition-opacity ease-in-out",ref:t}),me.jsxs("div",{className:"box-content",ref:i,children:[me.jsxs("div",{className:`z-5 top-20 full-bar relative ${zl.theme}`,children:[me.jsxs("h1",{className:"m-0 p-4 text-center leading-8",children:[" ",zl.title," "]}),zl.subtitle&&me.jsx("h2",{className:"m-0 p-4 text-center",children:zl.subtitle}),me.jsx("p",{className:"m-0 p-4 text-center leading-8",children:zl.byline})]}),me.jsx("div",{className:"z-5 w-full relative",children:zl.chapters.map((M,C)=>me.jsxs("div",{id:M.id,className:`p-4 dark step card ${C===0?"active":""} ${M.hidden?"hidden":""} ${h[M.alignment]||"centered"}`,children:[M.title&&me.jsx("h2",{children:M.title}),M.image&&me.jsx("img",{src:M.image,alt:M.title}),M.description&&me.jsx("p",{children:M.description})]},C))}),me.jsx("p",{className:`w-full min-h-5 py-2 text-center text-sm ${zl.theme}`,children:zl.footer})]})]})},xUe=()=>me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h1",{className:"font-bold text-3xl text-center",children:"HTML+CSS  "}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsxs("div",{className:"barGraph",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsxs("div",{className:"pieGraph",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]})]}),bUe="China",wUe=[{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""}]}]},{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""},{name:""}]}]}],SUe={name:bUe,children:wUe};function AUe(n){var e=0,t=n.children,r=t&&t.length;if(!r)e=1;else for(;--r>=0;)e+=t[r].value;n.value=e}function TUe(){return this.eachAfter(AUe)}function MUe(n,e){let t=-1;for(const r of this)n.call(e,r,++t,this);return this}function CUe(n,e){for(var t=this,r=[t],i,s,a=-1;t=r.pop();)if(n.call(e,t,++a,this),i=t.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function EUe(n,e){for(var t=this,r=[t],i=[],s,a,l,o=-1;t=r.pop();)if(i.push(t),s=t.children)for(a=0,l=s.length;a<l;++a)r.push(s[a]);for(;t=i.pop();)n.call(e,t,++o,this);return this}function IUe(n,e){let t=-1;for(const r of this)if(n.call(e,r,++t,this))return r}function RUe(n){return this.eachAfter(function(e){for(var t=+n(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)t+=r[i].value;e.value=t})}function PUe(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function LUe(n){for(var e=this,t=DUe(e,n),r=[e];e!==t;)e=e.parent,r.push(e);for(var i=r.length;n!==t;)r.splice(i,0,n),n=n.parent;return r}function DUe(n,e){if(n===e)return n;var t=n.ancestors(),r=e.ancestors(),i=null;for(n=t.pop(),e=r.pop();n===e;)i=n,n=t.pop(),e=r.pop();return i}function BUe(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function kUe(){return Array.from(this)}function OUe(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function FUe(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e}function*NUe(){var n=this,e,t=[n],r,i,s;do for(e=t.reverse(),t=[];n=e.pop();)if(yield n,r=n.children)for(i=0,s=r.length;i<s;++i)t.push(r[i]);while(t.length)}function c9(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=GUe)):e===void 0&&(e=UUe);for(var t=new cL(n),r,i=[t],s,a,l,o;r=i.pop();)if((a=e(r.data))&&(o=(a=Array.from(a)).length))for(r.children=a,l=o-1;l>=0;--l)i.push(s=a[l]=new cL(a[l])),s.parent=r,s.depth=r.depth+1;return t.eachBefore(HUe)}function zUe(){return c9(this).eachBefore(VUe)}function UUe(n){return n.children}function GUe(n){return Array.isArray(n)?n[1]:null}function VUe(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function HUe(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function cL(n){this.data=n,this.depth=this.height=0,this.parent=null}cL.prototype=c9.prototype={constructor:cL,count:TUe,each:MUe,eachAfter:EUe,eachBefore:CUe,find:IUe,sum:RUe,sort:PUe,path:LUe,ancestors:BUe,descendants:kUe,leaves:OUe,links:FUe,copy:zUe,[Symbol.iterator]:NUe};function jUe(n){return n==null?null:WUe(n)}function WUe(n){if(typeof n!="function")throw new Error;return n}function OK(){return 0}function XUe(n){return function(){return n}}const $Ue=1664525,qUe=1013904223,FK=4294967296;function ZUe(){let n=1;return()=>(n=($Ue*n+qUe)%FK)/FK}function YUe(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function KUe(n,e){let t=n.length,r,i;for(;t;)i=e()*t--|0,r=n[t],n[t]=n[i],n[i]=r;return n}function JUe(n,e){for(var t=0,r=(n=KUe(Array.from(n),e)).length,i=[],s,a;t<r;)s=n[t],a&&Oce(a,s)?++t:(a=e8e(i=QUe(i,s)),t=0);return a}function QUe(n,e){var t,r;if(iO(e,n))return[e];for(t=0;t<n.length;++t)if(wI(e,n[t])&&iO(LS(n[t],e),n))return[n[t],e];for(t=0;t<n.length-1;++t)for(r=t+1;r<n.length;++r)if(wI(LS(n[t],n[r]),e)&&wI(LS(n[t],e),n[r])&&wI(LS(n[r],e),n[t])&&iO(Fce(n[t],n[r],e),n))return[n[t],n[r],e];throw new Error}function wI(n,e){var t=n.r-e.r,r=e.x-n.x,i=e.y-n.y;return t<0||t*t<r*r+i*i}function Oce(n,e){var t=n.r-e.r+Math.max(n.r,e.r,1)*1e-9,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function iO(n,e){for(var t=0;t<e.length;++t)if(!Oce(n,e[t]))return!1;return!0}function e8e(n){switch(n.length){case 1:return t8e(n[0]);case 2:return LS(n[0],n[1]);case 3:return Fce(n[0],n[1],n[2])}}function t8e(n){return{x:n.x,y:n.y,r:n.r}}function LS(n,e){var t=n.x,r=n.y,i=n.r,s=e.x,a=e.y,l=e.r,o=s-t,h=a-r,d=l-i,m=Math.sqrt(o*o+h*h);return{x:(t+s+o/m*d)/2,y:(r+a+h/m*d)/2,r:(m+i+l)/2}}function Fce(n,e,t){var r=n.x,i=n.y,s=n.r,a=e.x,l=e.y,o=e.r,h=t.x,d=t.y,m=t.r,v=r-a,y=r-h,S=i-l,E=i-d,M=o-s,C=m-s,L=r*r+i*i-s*s,k=L-a*a-l*l+o*o,H=L-h*h-d*d+m*m,q=y*S-v*E,Z=(S*H-E*k)/(q*2)-r,ee=(E*M-S*C)/q,re=(y*k-v*H)/(q*2)-i,se=(v*C-y*M)/q,ae=ee*ee+se*se-1,fe=2*(s+Z*ee+re*se),Se=Z*Z+re*re-s*s,Ce=-(Math.abs(ae)>1e-6?(fe+Math.sqrt(fe*fe-4*ae*Se))/(2*ae):Se/fe);return{x:r+Z+ee*Ce,y:i+re+se*Ce,r:Ce}}function NK(n,e,t){var r=n.x-e.x,i,s,a=n.y-e.y,l,o,h=r*r+a*a;h?(s=e.r+t.r,s*=s,o=n.r+t.r,o*=o,s>o?(i=(h+o-s)/(2*h),l=Math.sqrt(Math.max(0,o/h-i*i)),t.x=n.x-i*r-l*a,t.y=n.y-i*a+l*r):(i=(h+s-o)/(2*h),l=Math.sqrt(Math.max(0,s/h-i*i)),t.x=e.x+i*r-l*a,t.y=e.y+i*a+l*r)):(t.x=e.x+t.r,t.y=e.y)}function zK(n,e){var t=n.r+e.r-1e-6,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function UK(n){var e=n._,t=n.next._,r=e.r+t.r,i=(e.x*t.r+t.x*e.r)/r,s=(e.y*t.r+t.y*e.r)/r;return i*i+s*s}function SI(n){this._=n,this.next=null,this.previous=null}function n8e(n,e){if(!(s=(n=YUe(n)).length))return 0;var t,r,i,s,a,l,o,h,d,m,v;if(t=n[0],t.x=0,t.y=0,!(s>1))return t.r;if(r=n[1],t.x=-r.r,r.x=t.r,r.y=0,!(s>2))return t.r+r.r;NK(r,t,i=n[2]),t=new SI(t),r=new SI(r),i=new SI(i),t.next=i.previous=r,r.next=t.previous=i,i.next=r.previous=t;e:for(o=3;o<s;++o){NK(t._,r._,i=n[o]),i=new SI(i),h=r.next,d=t.previous,m=r._.r,v=t._.r;do if(m<=v){if(zK(h._,i._)){r=h,t.next=r,r.previous=t,--o;continue e}m+=h._.r,h=h.next}else{if(zK(d._,i._)){t=d,t.next=r,r.previous=t,--o;continue e}v+=d._.r,d=d.previous}while(h!==d.next);for(i.previous=t,i.next=r,t.next=r.previous=r=i,a=UK(t);(i=i.next)!==r;)(l=UK(i))<a&&(t=i,a=l);r=t.next}for(t=[r._],i=r;(i=i.next)!==r;)t.push(i._);for(i=JUe(t,e),o=0;o<s;++o)t=n[o],t.x-=i.x,t.y-=i.y;return i.r}function r8e(n){return Math.sqrt(n.value)}function i8e(){var n=null,e=1,t=1,r=OK;function i(s){const a=ZUe();return s.x=e/2,s.y=t/2,n?s.eachBefore(GK(n)).eachAfter(sO(r,.5,a)).eachBefore(VK(1)):s.eachBefore(GK(r8e)).eachAfter(sO(OK,1,a)).eachAfter(sO(r,s.r/Math.min(e,t),a)).eachBefore(VK(Math.min(e,t)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(n=jUe(s),i):n},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:XUe(+s),i):r},i}function GK(n){return function(e){e.children||(e.r=Math.max(0,+n(e)||0))}}function sO(n,e,t){return function(r){if(i=r.children){var i,s,a=i.length,l=n(r)*e||0,o;if(l)for(s=0;s<a;++s)i[s].r+=l;if(o=n8e(i,t),l)for(s=0;s<a;++s)i[s].r-=l;r.r=o+l}}}function VK(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function DS(n,e,t){this.k=n,this.x=e,this.y=t}DS.prototype={constructor:DS,scale:function(n){return n===1?this:new DS(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new DS(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};DS.prototype;const s8e=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);return Ae.useEffect(()=>{const t=n.current.getContext("2d");t.save();const r=[n.current.width,n.current.height],i=[100,100];t.fillStyle="red",t.translate(-.5*i[0],-.5*i[1]),t.beginPath(),t.rect(.5*r[0],.5*r[1],i[0],i[1]),t.fill(),t.restore();const s=e.current.getContext("2d"),a=[e.current.width,e.current.height],l=c9(SUe).sum(v=>1).sort((v,y)=>y.value-v.value);console.log(l);const h=i8e().size(a).padding(3)(l),d=2*Math.PI,m=(v,y,{fillStyle:S="rgba(0,0,0,0.2)",textColor:E="white"}={})=>{const M=y.children;if(v.fillStyle=S,v.beginPath(),v.arc(y.x,y.y,y.r,0,d),v.fill(),M)for(const C of M)m(v,C);else{const C=y.data.name;v.fillStyle=E,v.font="1rem Aerial",v.textAlign="center",v.fillText(C,y.x,y.y)}};console.log(h.children),m(s,h)},[]),me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h1",{className:"font-bold text-3xl text-center",children:"canvas "}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(hierarchy)"}),me.jsx("canvas",{ref:e,width:1024,height:1024,className:"ml-3 border-2 border-black-500 border-solid"})]})},o8e=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);let t;const r=`
    attribute vec2 position;
    void main() {
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,i=`
    precision mediump float;
    void main() {
      gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
    }
  `,s=`
    attribute vec2 position;
    varying vec3 color;
    void main() {
      color = vec3(0.5 + position, 0.0);
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,a=`
    precision mediump float;
    varying vec3 color;
    void main() {
      gl_FragColor = vec4(color, 1.0);
    }
  `;let l;const o=(v,y,S)=>{t=v.getContext("webgl");const E=t.createShader(t.VERTEX_SHADER);t.shaderSource(E,y),t.compileShader(E),t.getShaderParameter(E,t.COMPILE_STATUS)||console.error("Vertex shader compilation failed:",t.getShaderInfoLog(E));const M=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(M,S),t.compileShader(M),t.getShaderParameter(M,t.COMPILE_STATUS)||console.error("Fragment shader compilation failed:",t.getShaderInfoLog(M)),l=t.createProgram(),t.attachShader(l,E),t.attachShader(l,M),t.linkProgram(l),t.getProgramParameter(l,t.LINK_STATUS)||console.error("Program linking failed:",t.getProgramInfoLog(l)),t.useProgram(l)},h=new Float32Array([-1,-1,0,1,1,-1]),d=()=>{const v=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,h,t.STATIC_DRAW);const y=t.getAttribLocation(l,"position");t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(y)},m=()=>{t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,h.length/2)};return Ae.useEffect(()=>{o(n.current,r,i),d(),m(),o(e.current,s,a),d(),m()},[]),me.jsxs("div",{className:"absolute top-20 w-full flex",children:[me.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),me.jsx("canvas",{ref:e,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"})]})};function oO(n,e,t){if(n&&n.length){const[r,i]=e,s=Math.PI/180*t,a=Math.cos(s),l=Math.sin(s);for(const o of n){const[h,d]=o;o[0]=(h-r)*a-(d-i)*l+r,o[1]=(h-r)*l+(d-i)*a+i}}}function a8e(n,e){return n[0]===e[0]&&n[1]===e[1]}function l8e(n,e,t,r=1){const i=t,s=Math.max(e,.1),a=n[0]&&n[0][0]&&typeof n[0][0]=="number"?[n]:n,l=[0,0];if(i)for(const h of a)oO(h,l,i);const o=function(h,d,m){const v=[];for(const L of h){const k=[...L];a8e(k[0],k[k.length-1])||k.push([k[0][0],k[0][1]]),k.length>2&&v.push(k)}const y=[];d=Math.max(d,.1);const S=[];for(const L of v)for(let k=0;k<L.length-1;k++){const H=L[k],q=L[k+1];if(H[1]!==q[1]){const Z=Math.min(H[1],q[1]);S.push({ymin:Z,ymax:Math.max(H[1],q[1]),x:Z===H[1]?H[0]:q[0],islope:(q[0]-H[0])/(q[1]-H[1])})}}if(S.sort((L,k)=>L.ymin<k.ymin?-1:L.ymin>k.ymin?1:L.x<k.x?-1:L.x>k.x?1:L.ymax===k.ymax?0:(L.ymax-k.ymax)/Math.abs(L.ymax-k.ymax)),!S.length)return y;let E=[],M=S[0].ymin,C=0;for(;E.length||S.length;){if(S.length){let L=-1;for(let k=0;k<S.length&&!(S[k].ymin>M);k++)L=k;S.splice(0,L+1).forEach(k=>{E.push({s:M,edge:k})})}if(E=E.filter(L=>!(L.edge.ymax<=M)),E.sort((L,k)=>L.edge.x===k.edge.x?0:(L.edge.x-k.edge.x)/Math.abs(L.edge.x-k.edge.x)),(m!==1||C%d==0)&&E.length>1)for(let L=0;L<E.length;L+=2){const k=L+1;if(k>=E.length)break;const H=E[L].edge,q=E[k].edge;y.push([[Math.round(H.x),M],[Math.round(q.x),M]])}M+=m,E.forEach(L=>{L.edge.x=L.edge.x+m*L.edge.islope}),C++}return y}(a,s,r);if(i){for(const h of a)oO(h,l,-i);(function(h,d,m){const v=[];h.forEach(y=>v.push(...y)),oO(v,d,m)})(o,l,-i)}return o}function yM(n,e){var t;const r=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=4*e.strokeWidth),i=Math.round(Math.max(i,.1));let s=1;return e.roughness>=1&&(((t=e.randomizer)===null||t===void 0?void 0:t.next())||Math.random())>.7&&(s=i),l8e(n,i,r,s||1)}class u9{constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){const r=yM(e,t);return{type:"fillSketch",ops:this.renderLines(r,t)}}renderLines(e,t){const r=[];for(const i of e)r.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],t));return r}}function g3(n){const e=n[0],t=n[1];return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}class c8e extends u9{fillPolygons(e,t){let r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);const i=yM(e,Object.assign({},t,{hachureGap:r})),s=Math.PI/180*t.hachureAngle,a=[],l=.5*r*Math.cos(s),o=.5*r*Math.sin(s);for(const[h,d]of i)g3([h,d])&&a.push([[h[0]-l,h[1]+o],[...d]],[[h[0]+l,h[1]-o],[...d]]);return{type:"fillSketch",ops:this.renderLines(a,t)}}}class u8e extends u9{fillPolygons(e,t){const r=this._fillPolygons(e,t),i=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),s=this._fillPolygons(e,i);return r.ops=r.ops.concat(s.ops),r}}class h8e{constructor(e){this.helper=e}fillPolygons(e,t){const r=yM(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(r,t)}dotsOnLines(e,t){const r=[];let i=t.hachureGap;i<0&&(i=4*t.strokeWidth),i=Math.max(i,.1);let s=t.fillWeight;s<0&&(s=t.strokeWidth/2);const a=i/4;for(const l of e){const o=g3(l),h=o/i,d=Math.ceil(h)-1,m=o-d*i,v=(l[0][0]+l[1][0])/2-i/4,y=Math.min(l[0][1],l[1][1]);for(let S=0;S<d;S++){const E=y+m+S*i,M=v-a+2*Math.random()*a,C=E-a+2*Math.random()*a,L=this.helper.ellipse(M,C,s,s,t);r.push(...L.ops)}}return{type:"fillSketch",ops:r}}}class f8e{constructor(e){this.helper=e}fillPolygons(e,t){const r=yM(e,t);return{type:"fillSketch",ops:this.dashedLine(r,t)}}dashedLine(e,t){const r=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,i=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,s=[];return e.forEach(a=>{const l=g3(a),o=Math.floor(l/(r+i)),h=(l+i-o*(r+i))/2;let d=a[0],m=a[1];d[0]>m[0]&&(d=a[1],m=a[0]);const v=Math.atan((m[1]-d[1])/(m[0]-d[0]));for(let y=0;y<o;y++){const S=y*(r+i),E=S+r,M=[d[0]+S*Math.cos(v)+h*Math.cos(v),d[1]+S*Math.sin(v)+h*Math.sin(v)],C=[d[0]+E*Math.cos(v)+h*Math.cos(v),d[1]+E*Math.sin(v)+h*Math.sin(v)];s.push(...this.helper.doubleLineOps(M[0],M[1],C[0],C[1],t))}}),s}}class d8e{constructor(e){this.helper=e}fillPolygons(e,t){const r=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,i=t.zigzagOffset<0?r:t.zigzagOffset,s=yM(e,t=Object.assign({},t,{hachureGap:r+i}));return{type:"fillSketch",ops:this.zigzagLines(s,i,t)}}zigzagLines(e,t,r){const i=[];return e.forEach(s=>{const a=g3(s),l=Math.round(a/(2*t));let o=s[0],h=s[1];o[0]>h[0]&&(o=s[1],h=s[0]);const d=Math.atan((h[1]-o[1])/(h[0]-o[0]));for(let m=0;m<l;m++){const v=2*m*t,y=2*(m+1)*t,S=Math.sqrt(2*Math.pow(t,2)),E=[o[0]+v*Math.cos(d),o[1]+v*Math.sin(d)],M=[o[0]+y*Math.cos(d),o[1]+y*Math.sin(d)],C=[E[0]+S*Math.cos(d+Math.PI/4),E[1]+S*Math.sin(d+Math.PI/4)];i.push(...this.helper.doubleLineOps(E[0],E[1],C[0],C[1],r),...this.helper.doubleLineOps(C[0],C[1],M[0],M[1],r))}}),i}}const Jc={};class p8e{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const m8e=0,aO=1,HK=2,AI={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function lO(n,e){return n.type===e}function h9(n){const e=[],t=function(a){const l=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))l[l.length]={type:m8e,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];l[l.length]={type:aO,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return l[l.length]={type:HK,text:""},l}(n);let r="BOD",i=0,s=t[i];for(;!lO(s,HK);){let a=0;const l=[];if(r==="BOD"){if(s.text!=="M"&&s.text!=="m")return h9("M0,0"+n);i++,a=AI[s.text],r=s.text}else lO(s,aO)?a=AI[r]:(i++,a=AI[s.text],r=s.text);if(!(i+a<t.length))throw new Error("Path data ended short");for(let o=i;o<i+a;o++){const h=t[o];if(!lO(h,aO))throw new Error("Param not a number: "+r+","+h.text);l[l.length]=+h.text}if(typeof AI[r]!="number")throw new Error("Bad segment: "+r);{const o={key:r,data:l};e.push(o),i+=a,s=t[i],r==="M"&&(r="L"),r==="m"&&(r="l")}}return e}function Nce(n){let e=0,t=0,r=0,i=0;const s=[];for(const{key:a,data:l}of n)switch(a){case"M":s.push({key:"M",data:[...l]}),[e,t]=l,[r,i]=l;break;case"m":e+=l[0],t+=l[1],s.push({key:"M",data:[e,t]}),r=e,i=t;break;case"L":s.push({key:"L",data:[...l]}),[e,t]=l;break;case"l":e+=l[0],t+=l[1],s.push({key:"L",data:[e,t]});break;case"C":s.push({key:"C",data:[...l]}),e=l[4],t=l[5];break;case"c":{const o=l.map((h,d)=>d%2?h+t:h+e);s.push({key:"C",data:o}),e=o[4],t=o[5];break}case"Q":s.push({key:"Q",data:[...l]}),e=l[2],t=l[3];break;case"q":{const o=l.map((h,d)=>d%2?h+t:h+e);s.push({key:"Q",data:o}),e=o[2],t=o[3];break}case"A":s.push({key:"A",data:[...l]}),e=l[5],t=l[6];break;case"a":e+=l[5],t+=l[6],s.push({key:"A",data:[l[0],l[1],l[2],l[3],l[4],e,t]});break;case"H":s.push({key:"H",data:[...l]}),e=l[0];break;case"h":e+=l[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...l]}),t=l[0];break;case"v":t+=l[0],s.push({key:"V",data:[t]});break;case"S":s.push({key:"S",data:[...l]}),e=l[2],t=l[3];break;case"s":{const o=l.map((h,d)=>d%2?h+t:h+e);s.push({key:"S",data:o}),e=o[2],t=o[3];break}case"T":s.push({key:"T",data:[...l]}),e=l[0],t=l[1];break;case"t":e+=l[0],t+=l[1],s.push({key:"T",data:[e,t]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=r,t=i}return s}function zce(n){const e=[];let t="",r=0,i=0,s=0,a=0,l=0,o=0;for(const{key:h,data:d}of n){switch(h){case"M":e.push({key:"M",data:[...d]}),[r,i]=d,[s,a]=d;break;case"C":e.push({key:"C",data:[...d]}),r=d[4],i=d[5],l=d[2],o=d[3];break;case"L":e.push({key:"L",data:[...d]}),[r,i]=d;break;case"H":r=d[0],e.push({key:"L",data:[r,i]});break;case"V":i=d[0],e.push({key:"L",data:[r,i]});break;case"S":{let m=0,v=0;t==="C"||t==="S"?(m=r+(r-l),v=i+(i-o)):(m=r,v=i),e.push({key:"C",data:[m,v,...d]}),l=d[0],o=d[1],r=d[2],i=d[3];break}case"T":{const[m,v]=d;let y=0,S=0;t==="Q"||t==="T"?(y=r+(r-l),S=i+(i-o)):(y=r,S=i);const E=r+2*(y-r)/3,M=i+2*(S-i)/3,C=m+2*(y-m)/3,L=v+2*(S-v)/3;e.push({key:"C",data:[E,M,C,L,m,v]}),l=y,o=S,r=m,i=v;break}case"Q":{const[m,v,y,S]=d,E=r+2*(m-r)/3,M=i+2*(v-i)/3,C=y+2*(m-y)/3,L=S+2*(v-S)/3;e.push({key:"C",data:[E,M,C,L,y,S]}),l=m,o=v,r=y,i=S;break}case"A":{const m=Math.abs(d[0]),v=Math.abs(d[1]),y=d[2],S=d[3],E=d[4],M=d[5],C=d[6];m===0||v===0?(e.push({key:"C",data:[r,i,M,C,M,C]}),r=M,i=C):(r!==M||i!==C)&&(Uce(r,i,M,C,m,v,y,S,E).forEach(function(L){e.push({key:"C",data:L})}),r=M,i=C);break}case"Z":e.push({key:"Z",data:[]}),r=s,i=a}t=h}return e}function fS(n,e,t){return[n*Math.cos(t)-e*Math.sin(t),n*Math.sin(t)+e*Math.cos(t)]}function Uce(n,e,t,r,i,s,a,l,o,h){const d=(m=a,Math.PI*m/180);var m;let v=[],y=0,S=0,E=0,M=0;if(h)[y,S,E,M]=h;else{[n,e]=fS(n,e,-d),[t,r]=fS(t,r,-d);const Ce=(n-t)/2,Ie=(e-r)/2;let je=Ce*Ce/(i*i)+Ie*Ie/(s*s);je>1&&(je=Math.sqrt(je),i*=je,s*=je);const Le=i*i,ot=s*s,ye=Le*ot-Le*Ie*Ie-ot*Ce*Ce,$e=Le*Ie*Ie+ot*Ce*Ce,Ve=(l===o?-1:1)*Math.sqrt(Math.abs(ye/$e));E=Ve*i*Ie/s+(n+t)/2,M=Ve*-s*Ce/i+(e+r)/2,y=Math.asin(parseFloat(((e-M)/s).toFixed(9))),S=Math.asin(parseFloat(((r-M)/s).toFixed(9))),n<E&&(y=Math.PI-y),t<E&&(S=Math.PI-S),y<0&&(y=2*Math.PI+y),S<0&&(S=2*Math.PI+S),o&&y>S&&(y-=2*Math.PI),!o&&S>y&&(S-=2*Math.PI)}let C=S-y;if(Math.abs(C)>120*Math.PI/180){const Ce=S,Ie=t,je=r;S=o&&S>y?y+120*Math.PI/180*1:y+120*Math.PI/180*-1,v=Uce(t=E+i*Math.cos(S),r=M+s*Math.sin(S),Ie,je,i,s,a,0,o,[S,Ce,E,M])}C=S-y;const L=Math.cos(y),k=Math.sin(y),H=Math.cos(S),q=Math.sin(S),Z=Math.tan(C/4),ee=4/3*i*Z,re=4/3*s*Z,se=[n,e],ae=[n+ee*k,e-re*L],fe=[t+ee*q,r-re*H],Se=[t,r];if(ae[0]=2*se[0]-ae[0],ae[1]=2*se[1]-ae[1],h)return[ae,fe,Se].concat(v);{v=[ae,fe,Se].concat(v);const Ce=[];for(let Ie=0;Ie<v.length;Ie+=3){const je=fS(v[Ie][0],v[Ie][1],d),Le=fS(v[Ie+1][0],v[Ie+1][1],d),ot=fS(v[Ie+2][0],v[Ie+2][1],d);Ce.push([je[0],je[1],Le[0],Le[1],ot[0],ot[1]])}return Ce}}const g8e={randOffset:function(n,e){return ri(n,e)},randOffsetWithRange:function(n,e,t){return uL(n,e,t)},ellipse:function(n,e,t,r,i){const s=Vce(t,r,i);return xz(n,e,i,s).opset},doubleLineOps:function(n,e,t,r,i){return wv(n,e,t,r,i,!0)}};function Gce(n,e,t,r,i){return{type:"path",ops:wv(n,e,t,r,i)}}function uR(n,e,t){const r=(n||[]).length;if(r>2){const i=[];for(let s=0;s<r-1;s++)i.push(...wv(n[s][0],n[s][1],n[s+1][0],n[s+1][1],t));return e&&i.push(...wv(n[r-1][0],n[r-1][1],n[0][0],n[0][1],t)),{type:"path",ops:i}}return r===2?Gce(n[0][0],n[0][1],n[1][0],n[1][1],t):{type:"path",ops:[]}}function v8e(n,e,t,r,i){return function(s,a){return uR(s,!0,a)}([[n,e],[n+t,e],[n+t,e+r],[n,e+r]],i)}function jK(n,e){if(n.length){const t=typeof n[0][0]=="number"?[n]:n,r=TI(t[0],1*(1+.2*e.roughness),e),i=e.disableMultiStroke?[]:TI(t[0],1.5*(1+.22*e.roughness),$K(e));for(let s=1;s<t.length;s++){const a=t[s];if(a.length){const l=TI(a,1*(1+.2*e.roughness),e),o=e.disableMultiStroke?[]:TI(a,1.5*(1+.22*e.roughness),$K(e));for(const h of l)h.op!=="move"&&r.push(h);for(const h of o)h.op!=="move"&&i.push(h)}}return{type:"path",ops:r.concat(i)}}return{type:"path",ops:[]}}function Vce(n,e,t){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(n/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(t.curveStepCount,t.curveStepCount/Math.sqrt(200)*r)),s=2*Math.PI/i;let a=Math.abs(n/2),l=Math.abs(e/2);const o=1-t.curveFitting;return a+=ri(a*o,t),l+=ri(l*o,t),{increment:s,rx:a,ry:l}}function xz(n,e,t,r){const[i,s]=qK(r.increment,n,e,r.rx,r.ry,1,r.increment*uL(.1,uL(.4,1,t),t),t);let a=hL(i,null,t);if(!t.disableMultiStroke&&t.roughness!==0){const[l]=qK(r.increment,n,e,r.rx,r.ry,1.5,0,t),o=hL(l,null,t);a=a.concat(o)}return{estimatedPoints:s,opset:{type:"path",ops:a}}}function WK(n,e,t,r,i,s,a,l,o){const h=n,d=e;let m=Math.abs(t/2),v=Math.abs(r/2);m+=ri(.01*m,o),v+=ri(.01*v,o);let y=i,S=s;for(;y<0;)y+=2*Math.PI,S+=2*Math.PI;S-y>2*Math.PI&&(y=0,S=2*Math.PI);const E=2*Math.PI/o.curveStepCount,M=Math.min(E/2,(S-y)/2),C=ZK(M,h,d,m,v,y,S,1,o);if(!o.disableMultiStroke){const L=ZK(M,h,d,m,v,y,S,1.5,o);C.push(...L)}return a&&(l?C.push(...wv(h,d,h+m*Math.cos(y),d+v*Math.sin(y),o),...wv(h,d,h+m*Math.cos(S),d+v*Math.sin(S),o)):C.push({op:"lineTo",data:[h,d]},{op:"lineTo",data:[h+m*Math.cos(y),d+v*Math.sin(y)]})),{type:"path",ops:C}}function XK(n,e){const t=zce(Nce(h9(n))),r=[];let i=[0,0],s=[0,0];for(const{key:a,data:l}of t)switch(a){case"M":s=[l[0],l[1]],i=[l[0],l[1]];break;case"L":r.push(...wv(s[0],s[1],l[0],l[1],e)),s=[l[0],l[1]];break;case"C":{const[o,h,d,m,v,y]=l;r.push(..._8e(o,h,d,m,v,y,s,e)),s=[v,y];break}case"Z":r.push(...wv(s[0],s[1],i[0],i[1],e)),s=[i[0],i[1]]}return{type:"path",ops:r}}function cO(n,e){const t=[];for(const r of n)if(r.length){const i=e.maxRandomnessOffset||0,s=r.length;if(s>2){t.push({op:"move",data:[r[0][0]+ri(i,e),r[0][1]+ri(i,e)]});for(let a=1;a<s;a++)t.push({op:"lineTo",data:[r[a][0]+ri(i,e),r[a][1]+ri(i,e)]})}}return{type:"fillPath",ops:t}}function jx(n,e){return function(t,r){let i=t.fillStyle||"hachure";if(!Jc[i])switch(i){case"zigzag":Jc[i]||(Jc[i]=new c8e(r));break;case"cross-hatch":Jc[i]||(Jc[i]=new u8e(r));break;case"dots":Jc[i]||(Jc[i]=new h8e(r));break;case"dashed":Jc[i]||(Jc[i]=new f8e(r));break;case"zigzag-line":Jc[i]||(Jc[i]=new d8e(r));break;default:i="hachure",Jc[i]||(Jc[i]=new u9(r))}return Jc[i]}(e,g8e).fillPolygons(n,e)}function $K(n){const e=Object.assign({},n);return e.randomizer=void 0,n.seed&&(e.seed=n.seed+1),e}function Hce(n){return n.randomizer||(n.randomizer=new p8e(n.seed||0)),n.randomizer.next()}function uL(n,e,t,r=1){return t.roughness*r*(Hce(t)*(e-n)+n)}function ri(n,e,t=1){return uL(-n,n,e,t)}function wv(n,e,t,r,i,s=!1){const a=s?i.disableMultiStrokeFill:i.disableMultiStroke,l=bz(n,e,t,r,i,!0,!1);if(a)return l;const o=bz(n,e,t,r,i,!0,!0);return l.concat(o)}function bz(n,e,t,r,i,s,a){const l=Math.pow(n-t,2)+Math.pow(e-r,2),o=Math.sqrt(l);let h=1;h=o<200?1:o>500?.4:-.0016668*o+1.233334;let d=i.maxRandomnessOffset||0;d*d*100>l&&(d=o/10);const m=d/2,v=.2+.2*Hce(i);let y=i.bowing*i.maxRandomnessOffset*(r-e)/200,S=i.bowing*i.maxRandomnessOffset*(n-t)/200;y=ri(y,i,h),S=ri(S,i,h);const E=[],M=()=>ri(m,i,h),C=()=>ri(d,i,h),L=i.preserveVertices;return a?E.push({op:"move",data:[n+(L?0:M()),e+(L?0:M())]}):E.push({op:"move",data:[n+(L?0:ri(d,i,h)),e+(L?0:ri(d,i,h))]}),a?E.push({op:"bcurveTo",data:[y+n+(t-n)*v+M(),S+e+(r-e)*v+M(),y+n+2*(t-n)*v+M(),S+e+2*(r-e)*v+M(),t+(L?0:M()),r+(L?0:M())]}):E.push({op:"bcurveTo",data:[y+n+(t-n)*v+C(),S+e+(r-e)*v+C(),y+n+2*(t-n)*v+C(),S+e+2*(r-e)*v+C(),t+(L?0:C()),r+(L?0:C())]}),E}function TI(n,e,t){if(!n.length)return[];const r=[];r.push([n[0][0]+ri(e,t),n[0][1]+ri(e,t)]),r.push([n[0][0]+ri(e,t),n[0][1]+ri(e,t)]);for(let i=1;i<n.length;i++)r.push([n[i][0]+ri(e,t),n[i][1]+ri(e,t)]),i===n.length-1&&r.push([n[i][0]+ri(e,t),n[i][1]+ri(e,t)]);return hL(r,null,t)}function hL(n,e,t){const r=n.length,i=[];if(r>3){const s=[],a=1-t.curveTightness;i.push({op:"move",data:[n[1][0],n[1][1]]});for(let l=1;l+2<r;l++){const o=n[l];s[0]=[o[0],o[1]],s[1]=[o[0]+(a*n[l+1][0]-a*n[l-1][0])/6,o[1]+(a*n[l+1][1]-a*n[l-1][1])/6],s[2]=[n[l+1][0]+(a*n[l][0]-a*n[l+2][0])/6,n[l+1][1]+(a*n[l][1]-a*n[l+2][1])/6],s[3]=[n[l+1][0],n[l+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else r===3?(i.push({op:"move",data:[n[1][0],n[1][1]]}),i.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[2][0],n[2][1]]})):r===2&&i.push(...bz(n[0][0],n[0][1],n[1][0],n[1][1],t,!0,!0));return i}function qK(n,e,t,r,i,s,a,l){const o=[],h=[];if(l.roughness===0){n/=4,h.push([e+r*Math.cos(-n),t+i*Math.sin(-n)]);for(let d=0;d<=2*Math.PI;d+=n){const m=[e+r*Math.cos(d),t+i*Math.sin(d)];o.push(m),h.push(m)}h.push([e+r*Math.cos(0),t+i*Math.sin(0)]),h.push([e+r*Math.cos(n),t+i*Math.sin(n)])}else{const d=ri(.5,l)-Math.PI/2;h.push([ri(s,l)+e+.9*r*Math.cos(d-n),ri(s,l)+t+.9*i*Math.sin(d-n)]);const m=2*Math.PI+d-.01;for(let v=d;v<m;v+=n){const y=[ri(s,l)+e+r*Math.cos(v),ri(s,l)+t+i*Math.sin(v)];o.push(y),h.push(y)}h.push([ri(s,l)+e+r*Math.cos(d+2*Math.PI+.5*a),ri(s,l)+t+i*Math.sin(d+2*Math.PI+.5*a)]),h.push([ri(s,l)+e+.98*r*Math.cos(d+a),ri(s,l)+t+.98*i*Math.sin(d+a)]),h.push([ri(s,l)+e+.9*r*Math.cos(d+.5*a),ri(s,l)+t+.9*i*Math.sin(d+.5*a)])}return[h,o]}function ZK(n,e,t,r,i,s,a,l,o){const h=s+ri(.1,o),d=[];d.push([ri(l,o)+e+.9*r*Math.cos(h-n),ri(l,o)+t+.9*i*Math.sin(h-n)]);for(let m=h;m<=a;m+=n)d.push([ri(l,o)+e+r*Math.cos(m),ri(l,o)+t+i*Math.sin(m)]);return d.push([e+r*Math.cos(a),t+i*Math.sin(a)]),d.push([e+r*Math.cos(a),t+i*Math.sin(a)]),hL(d,null,o)}function _8e(n,e,t,r,i,s,a,l){const o=[],h=[l.maxRandomnessOffset||1,(l.maxRandomnessOffset||1)+.3];let d=[0,0];const m=l.disableMultiStroke?1:2,v=l.preserveVertices;for(let y=0;y<m;y++)y===0?o.push({op:"move",data:[a[0],a[1]]}):o.push({op:"move",data:[a[0]+(v?0:ri(h[0],l)),a[1]+(v?0:ri(h[0],l))]}),d=v?[i,s]:[i+ri(h[y],l),s+ri(h[y],l)],o.push({op:"bcurveTo",data:[n+ri(h[y],l),e+ri(h[y],l),t+ri(h[y],l),r+ri(h[y],l),d[0],d[1]]});return o}function dS(n){return[...n]}function YK(n,e=0){const t=n.length;if(t<3)throw new Error("A curve must have at least three points.");const r=[];if(t===3)r.push(dS(n[0]),dS(n[1]),dS(n[2]),dS(n[2]));else{const i=[];i.push(n[0],n[0]);for(let l=1;l<n.length;l++)i.push(n[l]),l===n.length-1&&i.push(n[l]);const s=[],a=1-e;r.push(dS(i[0]));for(let l=1;l+2<i.length;l++){const o=i[l];s[0]=[o[0],o[1]],s[1]=[o[0]+(a*i[l+1][0]-a*i[l-1][0])/6,o[1]+(a*i[l+1][1]-a*i[l-1][1])/6],s[2]=[i[l+1][0]+(a*i[l][0]-a*i[l+2][0])/6,i[l+1][1]+(a*i[l][1]-a*i[l+2][1])/6],s[3]=[i[l+1][0],i[l+1][1]],r.push(s[1],s[2],s[3])}}return r}function hR(n,e){return Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)}function y8e(n,e,t){const r=hR(e,t);if(r===0)return hR(n,e);let i=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),hR(n,fy(e,t,i))}function fy(n,e,t){return[n[0]+(e[0]-n[0])*t,n[1]+(e[1]-n[1])*t]}function wz(n,e,t,r){const i=r||[];if(function(l,o){const h=l[o+0],d=l[o+1],m=l[o+2],v=l[o+3];let y=3*d[0]-2*h[0]-v[0];y*=y;let S=3*d[1]-2*h[1]-v[1];S*=S;let E=3*m[0]-2*v[0]-h[0];E*=E;let M=3*m[1]-2*v[1]-h[1];return M*=M,y<E&&(y=E),S<M&&(S=M),y+S}(n,e)<t){const l=n[e+0];i.length?(s=i[i.length-1],a=l,Math.sqrt(hR(s,a))>1&&i.push(l)):i.push(l),i.push(n[e+3])}else{const o=n[e+0],h=n[e+1],d=n[e+2],m=n[e+3],v=fy(o,h,.5),y=fy(h,d,.5),S=fy(d,m,.5),E=fy(v,y,.5),M=fy(y,S,.5),C=fy(E,M,.5);wz([o,v,E,C],0,t,i),wz([C,M,S,m],0,t,i)}var s,a;return i}function x8e(n,e){return fL(n,0,n.length,e)}function fL(n,e,t,r,i){const s=i||[],a=n[e],l=n[t-1];let o=0,h=1;for(let d=e+1;d<t-1;++d){const m=y8e(n[d],a,l);m>o&&(o=m,h=d)}return Math.sqrt(o)>r?(fL(n,e,h+1,r,s),fL(n,h,t,r,s)):(s.length||s.push(a),s.push(l)),s}function uO(n,e=.15,t){const r=[],i=(n.length-1)/3;for(let s=0;s<i;s++)wz(n,3*s,e,r);return t&&t>0?fL(r,0,r.length,t):r}const Iu="none";class dL{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,r){return{shape:e,sets:t||[],options:r||this.defaultOptions}}line(e,t,r,i,s){const a=this._o(s);return this._d("line",[Gce(e,t,r,i,a)],a)}rectangle(e,t,r,i,s){const a=this._o(s),l=[],o=v8e(e,t,r,i,a);if(a.fill){const h=[[e,t],[e+r,t],[e+r,t+i],[e,t+i]];a.fillStyle==="solid"?l.push(cO([h],a)):l.push(jx([h],a))}return a.stroke!==Iu&&l.push(o),this._d("rectangle",l,a)}ellipse(e,t,r,i,s){const a=this._o(s),l=[],o=Vce(r,i,a),h=xz(e,t,a,o);if(a.fill)if(a.fillStyle==="solid"){const d=xz(e,t,a,o).opset;d.type="fillPath",l.push(d)}else l.push(jx([h.estimatedPoints],a));return a.stroke!==Iu&&l.push(h.opset),this._d("ellipse",l,a)}circle(e,t,r,i){const s=this.ellipse(e,t,r,r,i);return s.shape="circle",s}linearPath(e,t){const r=this._o(t);return this._d("linearPath",[uR(e,!1,r)],r)}arc(e,t,r,i,s,a,l=!1,o){const h=this._o(o),d=[],m=WK(e,t,r,i,s,a,l,!0,h);if(l&&h.fill)if(h.fillStyle==="solid"){const v=Object.assign({},h);v.disableMultiStroke=!0;const y=WK(e,t,r,i,s,a,!0,!1,v);y.type="fillPath",d.push(y)}else d.push(function(v,y,S,E,M,C,L){const k=v,H=y;let q=Math.abs(S/2),Z=Math.abs(E/2);q+=ri(.01*q,L),Z+=ri(.01*Z,L);let ee=M,re=C;for(;ee<0;)ee+=2*Math.PI,re+=2*Math.PI;re-ee>2*Math.PI&&(ee=0,re=2*Math.PI);const se=(re-ee)/L.curveStepCount,ae=[];for(let fe=ee;fe<=re;fe+=se)ae.push([k+q*Math.cos(fe),H+Z*Math.sin(fe)]);return ae.push([k+q*Math.cos(re),H+Z*Math.sin(re)]),ae.push([k,H]),jx([ae],L)}(e,t,r,i,s,a,h));return h.stroke!==Iu&&d.push(m),this._d("arc",d,h)}curve(e,t){const r=this._o(t),i=[],s=jK(e,r);if(r.fill&&r.fill!==Iu)if(r.fillStyle==="solid"){const a=jK(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],l=e;if(l.length){const o=typeof l[0][0]=="number"?[l]:l;for(const h of o)h.length<3?a.push(...h):h.length===3?a.push(...uO(YK([h[0],h[0],h[1],h[2]]),10,(1+r.roughness)/2)):a.push(...uO(YK(h),10,(1+r.roughness)/2))}a.length&&i.push(jx([a],r))}return r.stroke!==Iu&&i.push(s),this._d("curve",i,r)}polygon(e,t){const r=this._o(t),i=[],s=uR(e,!0,r);return r.fill&&(r.fillStyle==="solid"?i.push(cO([e],r)):i.push(jx([e],r))),r.stroke!==Iu&&i.push(s),this._d("polygon",i,r)}path(e,t){const r=this._o(t),i=[];if(!e)return this._d("path",i,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=r.fill&&r.fill!=="transparent"&&r.fill!==Iu,a=r.stroke!==Iu,l=!!(r.simplification&&r.simplification<1),o=function(d,m,v){const y=zce(Nce(h9(d))),S=[];let E=[],M=[0,0],C=[];const L=()=>{C.length>=4&&E.push(...uO(C,m)),C=[]},k=()=>{L(),E.length&&(S.push(E),E=[])};for(const{key:q,data:Z}of y)switch(q){case"M":k(),M=[Z[0],Z[1]],E.push(M);break;case"L":L(),E.push([Z[0],Z[1]]);break;case"C":if(!C.length){const ee=E.length?E[E.length-1]:M;C.push([ee[0],ee[1]])}C.push([Z[0],Z[1]]),C.push([Z[2],Z[3]]),C.push([Z[4],Z[5]]);break;case"Z":L(),E.push([M[0],M[1]])}if(k(),!v)return S;const H=[];for(const q of S){const Z=x8e(q,v);Z.length&&H.push(Z)}return H}(e,1,l?4-4*(r.simplification||1):(1+r.roughness)/2),h=XK(e,r);if(s)if(r.fillStyle==="solid")if(o.length===1){const d=XK(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(d.ops)})}else i.push(cO(o,r));else i.push(jx(o,r));return a&&(l?o.forEach(d=>{i.push(uR(d,!1,r))}):i.push(h)),this._d("path",i,r)}opsToPath(e,t){let r="";for(const i of e.ops){const s=typeof t=="number"&&t>=0?i.data.map(a=>+a.toFixed(t)):i.data;switch(i.op){case"move":r+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":r+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":r+=`L${s[0]} ${s[1]} `}}return r.trim()}toPaths(e){const t=e.sets||[],r=e.options||this.defaultOptions,i=[];for(const s of t){let a=null;switch(s.type){case"path":a={d:this.opsToPath(s),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Iu};break;case"fillPath":a={d:this.opsToPath(s),stroke:Iu,strokeWidth:0,fill:r.fill||Iu};break;case"fillSketch":a=this.fillSketch(s,r)}a&&i.push(a)}return i}fillSketch(e,t){let r=t.fillWeight;return r<0&&(r=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||Iu,strokeWidth:r,fill:Iu}}_mergedShape(e){return e.filter((t,r)=>r===0||t.op!=="move")}}class b8e{constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new dL(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const a of t)switch(a.type){case"path":i.save(),i.strokeStyle=r.stroke==="none"?"transparent":r.stroke,i.lineWidth=r.strokeWidth,r.strokeLineDash&&i.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(i.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(i,a,s),i.restore();break;case"fillPath":{i.save(),i.fillStyle=r.fill||"";const l=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,a,s,l),i.restore();break}case"fillSketch":this.fillSketch(i,a,r)}}fillSketch(e,t,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=i,this._drawToContext(e,t,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,r,i="nonzero"){e.beginPath();for(const s of t.ops){const a=typeof r=="number"&&r>=0?s.data.map(l=>+l.toFixed(r)):s.data;switch(s.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1])}}t.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,r,i,s){const a=this.gen.line(e,t,r,i,s);return this.draw(a),a}rectangle(e,t,r,i,s){const a=this.gen.rectangle(e,t,r,i,s);return this.draw(a),a}ellipse(e,t,r,i,s){const a=this.gen.ellipse(e,t,r,i,s);return this.draw(a),a}circle(e,t,r,i){const s=this.gen.circle(e,t,r,i);return this.draw(s),s}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r),r}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r),r}arc(e,t,r,i,s,a,l=!1,o){const h=this.gen.arc(e,t,r,i,s,a,l,o);return this.draw(h),h}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r),r}path(e,t){const r=this.gen.path(e,t);return this.draw(r),r}}const MI="http://www.w3.org/2000/svg";class w8e{constructor(e,t){this.svg=e,this.gen=new dL(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,s=i.createElementNS(MI,"g"),a=e.options.fixedDecimalPlaceDigits;for(const l of t){let o=null;switch(l.type){case"path":o=i.createElementNS(MI,"path"),o.setAttribute("d",this.opsToPath(l,a)),o.setAttribute("stroke",r.stroke),o.setAttribute("stroke-width",r.strokeWidth+""),o.setAttribute("fill","none"),r.strokeLineDash&&o.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&o.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":o=i.createElementNS(MI,"path"),o.setAttribute("d",this.opsToPath(l,a)),o.setAttribute("stroke","none"),o.setAttribute("stroke-width","0"),o.setAttribute("fill",r.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||o.setAttribute("fill-rule","evenodd");break;case"fillSketch":o=this.fillSketch(i,l,r)}o&&s.appendChild(o)}return s}fillSketch(e,t,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);const s=e.createElementNS(MI,"path");return s.setAttribute("d",this.opsToPath(t,r.fixedDecimalPlaceDigits)),s.setAttribute("stroke",r.fill||""),s.setAttribute("stroke-width",i+""),s.setAttribute("fill","none"),r.fillLineDash&&s.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,t){return this.gen.opsToPath(e,t)}line(e,t,r,i,s){const a=this.gen.line(e,t,r,i,s);return this.draw(a)}rectangle(e,t,r,i,s){const a=this.gen.rectangle(e,t,r,i,s);return this.draw(a)}ellipse(e,t,r,i,s){const a=this.gen.ellipse(e,t,r,i,s);return this.draw(a)}circle(e,t,r,i){const s=this.gen.circle(e,t,r,i);return this.draw(s)}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r)}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r)}arc(e,t,r,i,s,a,l=!1,o){const h=this.gen.arc(e,t,r,i,s,a,l,o);return this.draw(h)}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r)}path(e,t){const r=this.gen.path(e,t);return this.draw(r)}}var jce={canvas:(n,e)=>new b8e(n,e),svg:(n,e)=>new w8e(n,e),generator:n=>new dL(n),newSeed:()=>dL.newSeed()};class hw extends Array{constructor(e=1,t=0){super(e,t)}set x(e){this[0]=e}set y(e){this[1]=e}get x(){return this[0]}get y(){return this[1]}get length(){return Math.hypot(this[0],this[1])}get dir(){return Math.atan2(this[1],this[0])}copy(){return new hw(this[0],this[1])}add(e){return this.x+=e.x,this.y+=e.y,this}rotate(e){const[t,r]=this;return this[0]=t*Math.cos(e)-r*Math.sin(e),this[1]=t*Math.sin(e)+r*Math.cos(e),this}scale(e){return this[0]*=e,this[1]*=e,this}}const S8e=()=>{const n=Ae.useRef(null),e={roughness:2.2,strokeWidth:4,fill:"blue"},t={stroke:"red",strokeWidth:4,fill:"yellow",fillStyle:"solid"},r={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},i=(s,a,l,o)=>{const h=2*Math.PI/s;let d=new hw(a,l),m=[[d.x,d.y]],v=new hw(o,0);for(let y=0;y<s;y++)d=d.copy().add(v.rotate(h)),m.push([d.x,d.y]);return m};return Ae.useEffect(()=>{const s=jce.canvas(n.current),a=s.ctx;a.translate(256,256),a.scale(1,-1),s.path("M-180 0L-80 100L20 0",e),s.path("M-20 0L80 100L180 0",e),s.circle(0,150,105,t),s.polygon(i(5,n.current.width/2,0,50),r),s.polygon(i(10,0,0,20),r)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},A8e=()=>{const n=Ae.useRef(null),e=(t,r,i,s,a,l)=>{let o=new hw().rotate(a).scale(i),h=r.copy().add(o);if(t.lineWidth=s,t.beginPath(),t.moveTo(...r),t.lineTo(...h),t.stroke(),s>2){let d=Math.PI/4+.5*(a+.2)+(Math.random()-.5)*l;e(t,h,i*.9,s*.8,d,l*.9);let m=Math.PI/4+.5*(a-.2)+(Math.random()-.5)*l;e(t,h,i*.9,s*.8,m,l*.9)}s<5&&Math.random()<.3&&(t.save(),t.strokeStyle="red",t.lineWidth=Math.random()*5,t.beginPath(),t.moveTo(...h),t.lineTo(h.x,h.y-2),t.stroke(),t.restore())};return Ae.useEffect(()=>{const t=n.current.getContext("2d");t.translate(0,n.current.height),t.scale(1,-1),t.lineCap="round",e(t,new hw(512,0),50,10,1,3)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},T8e=()=>{const n=Ae.useRef(null),e={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},t={stroke:"blue",strokeWidth:3},r=Math.PI*2,i=60;function s(o,h,d,m=0,v=r){const y=v-m===r?r:v-m,S=[];for(let E=0;E<i;E++){let M=o+d*Math.cos(m+y*E/i),C=h+d*Math.sin(m+y*E/i);S.push([M,C])}return S}function a(o,h,d,m,v=0,y=r){const S=y-v===r?r:y-v,E=[];for(let M=0;M<=i;M++){let C=o+d*Math.cos(v+S*M/i),L=h+m*Math.sin(v+S*M/i);E.push([C,L])}return E}function l(o,h,d,m,v){let y=[];for(let S=0;S<i;S++){const E=S/i,M=(1-E)*m+E*v,C=o+2*d*M*M,L=h+2*d*M;y.push([C,L])}return y}return Ae.useEffect(()=>{const o=jce.canvas(n.current),h=o.ctx;h.translate(512,256),h.scale(1,-1),o.polygon(s(-100,0,50),e),o.polygon(a(0,0,50,30),e);const d=l(100,0,5,-5,5);for(let m=0;m<d.length-1;m++)o.line(d[m][0],d[m][1],d[m+1][0],d[m+1][1],t)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},M8e=()=>{const n={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red"},e={width:0,height:0,border:"80px solid",margin:2,"border-color":"green yellow red black"},t={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red","border-left":0},r={width:"160px",height:"`60px",background:"linear-gradient(45deg, red, red 50%, transparent 50%)"},i={width:"160px",height:"120px",position:"relative",overflow:"hidden"},s={content:"",position:"absolute",left:0,top:0,right:0,bottom:0,background:"red",transformOrigin:"left bottom",transform:"rotate(45deg)"},a={position:"relative",width:0,height:0,"border-width":"0 80px 80px","border-style":"solid","border-color":"transparent transparent red"},l={content:"",position:"absolute",top:"1px",left:"-76px","border-width":"0 76px 76px","border-style":"solid","border-color":"transparent transparent yellow"},o={width:"160px",height:"120px",border:"0px solid transparent",borderTop:"60px solid red",borderLeft:"40px solid transparent"};return me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; linear-gradient; rotate; +border) "}),me.jsxs("div",{className:"flex",children:[me.jsx("div",{style:n}),me.jsx("div",{style:e}),me.jsx("div",{style:t}),me.jsx("div",{style:r}),me.jsx("div",{style:i,children:me.jsx("div",{style:s})}),me.jsx("div",{style:a,children:me.jsx("div",{style:l})})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(skew)"}),me.jsxs("div",{className:"flex",children:[me.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-x-12"}),me.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-y-12"})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; "}),me.jsx("div",{className:"flex",children:me.jsx("div",{style:o})})]})},C8e=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"600px",height:"600px",border:"black 1px solid",display:"flex","align-items":"flex-start","flex-wrap":"wrap","align-content":"flex-start"},e={height:"100px",flex:"0 0 25%",border:"red 1px solid",margin:"0"};return me.jsxs("div",{style:n,children:[me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"})]})},E8e=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"white",backgroundColor:"black",display:"flex",alignItems:"center"},e={width:"50px",height:"50px",border:"red 1px solid",marginRight:"10px"},t={overflowWrap:"anywhere"};return me.jsxs("div",{style:n,children:[me.jsx("img",{src:yre,alt:"",style:e}),me.jsx("p",{style:t,children:"ttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt"})]})},I8e=()=>{const n={border:"purple 1px solid",flex:1},e={"box-sizing":"border-box",width:"100vw",height:"100vh",display:"flex","flex-direction":"column",border:"yellow 4px solid"},t={border:"red 1px solid",flex:"80%",display:"flex",width:"100%",height:"100%"},r={border:"blue 1px solid",flex:1},i={flex:"0 0 12em"};return me.jsxs("div",{style:e,children:[me.jsx("header",{style:n,children:"header"}),me.jsxs("div",{style:t,children:[me.jsx("div",{style:{...r,...i},children:"1"}),me.jsx("div",{style:r,children:"2"}),me.jsx("div",{style:{...r,...i},children:"3"})]}),me.jsx("footer",{style:n,children:"footer"})]})};function R8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{d:"M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3Z"}),Ae.createElement("path",{fillRule:"evenodd",d:"M13 6H3v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V6ZM5.72 7.47a.75.75 0 0 1 1.06 0L8 8.69l1.22-1.22a.75.75 0 1 1 1.06 1.06L9.06 9.75l1.22 1.22a.75.75 0 1 1-1.06 1.06L8 10.81l-1.22 1.22a.75.75 0 0 1-1.06-1.06l1.22-1.22-1.22-1.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const P8e=Ae.forwardRef(R8e);function L8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const D8e=Ae.forwardRef(L8e);function B8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z",clipRule:"evenodd"}))}const k8e=Ae.forwardRef(B8e);function O8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{d:"M5 6.5A1.5 1.5 0 0 1 6.5 5h6A1.5 1.5 0 0 1 14 6.5v6a1.5 1.5 0 0 1-1.5 1.5h-6A1.5 1.5 0 0 1 5 12.5v-6Z"}),Ae.createElement("path",{d:"M3.5 2A1.5 1.5 0 0 0 2 3.5v6A1.5 1.5 0 0 0 3.5 11V6.5a3 3 0 0 1 3-3H11A1.5 1.5 0 0 0 9.5 2h-6Z"}))}const F8e=Ae.forwardRef(O8e);function N8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z",clipRule:"evenodd"}))}const KK=Ae.forwardRef(N8e);/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function JK(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function CI(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JK(Object(t),!0).forEach(function(r){G8e(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):JK(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function z8e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function QK(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Wce(r.key),r)}}function U8e(n,e,t){return e&&QK(n.prototype,e),t&&QK(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function G8e(n,e,t){return e=Wce(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pL(){return pL=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pL.apply(this,arguments)}function V8e(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wce(n){var e=V8e(n,"string");return typeof e=="symbol"?e:String(e)}var Xce={exports:{}};(function(n){typeof window>"u"||function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=r&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,l=(r||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(o){var h,d,m,v,y,S,E,M,C;if(h=o.match(a),!h)throw new Error("invalid data URI");for(d=h[2]?h[1]:"text/plain"+(h[3]||";charset=US-ASCII"),m=!!h[4],v=o.slice(h[0].length),m?y=atob(v):y=decodeURIComponent(v),S=new ArrayBuffer(y.length),E=new Uint8Array(S),M=0;M<y.length;M+=1)E[M]=y.charCodeAt(M);return r?new Blob([i?E:S],{type:d}):(C=new s,C.append(S),C.getBlob(d))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(o,h,d){var m=this;setTimeout(function(){d&&t.toDataURL&&l?o(l(m.toDataURL(h,d))):o(m.mozGetAsFile("blob",h))})}:t.toDataURL&&l&&(t.msToBlob?t.toBlob=function(o,h,d){var m=this;setTimeout(function(){(h&&h!=="image/png"||d)&&t.toDataURL&&l?o(l(m.toDataURL(h,d))):o(m.msToBlob(h))})}:t.toBlob=function(o,h,d){var m=this;setTimeout(function(){o(l(m.toDataURL(h,d)))})})),n.exports?n.exports=l:e.dataURLtoBlob=l}(window)})(Xce);var eJ=Xce.exports,H8e=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},tJ={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},j8e=typeof window<"u"&&typeof window.document<"u",Sv=j8e?window:{},mL=function(e){return e>0&&e<1/0},W8e=Array.prototype.slice;function f9(n){return Array.from?Array.from(n):W8e.call(n)}var X8e=/^image\/.+$/;function Sz(n){return X8e.test(n)}function $8e(n){var e=Sz(n)?n.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var $ce=String.fromCharCode;function q8e(n,e,t){var r="",i;for(t+=e,i=e;i<t;i+=1)r+=$ce(n.getUint8(i));return r}var Z8e=Sv.btoa;function nJ(n,e){for(var t=[],r=8192,i=new Uint8Array(n);i.length>0;)t.push($ce.apply(null,f9(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(e,";base64,").concat(Z8e(t.join("")))}function Y8e(n){var e=new DataView(n),t;try{var r,i,s;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var a=e.byteLength,l=2;l+1<a;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){i=l;break}l+=1}if(i){var o=i+4,h=i+10;if(q8e(e,o,4)==="Exif"){var d=e.getUint16(h);if(r=d===18761,(r||d===19789)&&e.getUint16(h+2,r)===42){var m=e.getUint32(h+4,r);m>=8&&(s=h+m)}}}if(s){var v=e.getUint16(s,r),y,S;for(S=0;S<v;S+=1)if(y=s+S*12+2,e.getUint16(y,r)===274){y+=8,t=e.getUint16(y,r),e.setUint16(y,1,r);break}}}catch{t=1}return t}function K8e(n){var e=0,t=1,r=1;switch(n){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var J8e=/\.\d*(?:0|9){12}\d*$/;function rJ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return J8e.test(n)?Math.round(n*e)/e:n}function pS(n){var e=n.aspectRatio,t=n.height,r=n.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",s=mL(r),a=mL(t);if(s&&a){var l=t*e;(i==="contain"||i==="none")&&l>r||i==="cover"&&l<r?t=r/e:r=t*e}else s?t=r/e:a&&(r=t*e);return{width:r,height:t}}function Q8e(n){for(var e=f9(new Uint8Array(n)),t=e.length,r=[],i=0;i+3<t;){var s=e[i],a=e[i+1];if(s===255&&a===218)break;if(s===255&&a===216)i+=2;else{var l=e[i+2]*256+e[i+3],o=i+l+2,h=e.slice(i,o);r.push(h),i=o}}return r.reduce(function(d,m){return m[0]===255&&m[1]===225?d.concat(m):d},[])}function e9e(n,e){var t=f9(new Uint8Array(n));if(t[2]!==255||t[3]!==224)return n;var r=t[4]*256+t[5],i=[255,216].concat(e,t.slice(4+r));return new Uint8Array(i)}var t9e=Sv.ArrayBuffer,hO=Sv.FileReader,ny=Sv.URL||Sv.webkitURL,n9e=/\.\w+$/,r9e=Sv.Compressor,i9e=function(){function n(e,t){z8e(this,n),this.file=e,this.exif=[],this.image=new Image,this.options=CI(CI({},tJ),t),this.aborted=!1,this.result=null,this.init()}return U8e(n,[{key:"init",value:function(){var t=this,r=this.file,i=this.options;if(!H8e(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var s=r.type;if(!Sz(s)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!ny||!hO){this.fail(new Error("The current browser does not support image compression."));return}t9e||(i.checkOrientation=!1,i.retainExif=!1);var a=s==="image/jpeg",l=a&&i.checkOrientation,o=a&&i.retainExif;if(ny&&!l&&!o)this.load({url:ny.createObjectURL(r)});else{var h=new hO;this.reader=h,h.onload=function(d){var m=d.target,v=m.result,y={},S=1;l&&(S=Y8e(v),S>1&&pL(y,K8e(S))),o&&(t.exif=Q8e(v)),l||o?!ny||S>1?y.url=nJ(v,s):y.url=ny.createObjectURL(r):y.url=v,t.load(y)},h.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},h.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},h.onloadend=function(){t.reader=null},l||o?h.readAsArrayBuffer(r):h.readAsDataURL(r)}}},{key:"load",value:function(t){var r=this,i=this.file,s=this.image;s.onload=function(){r.draw(CI(CI({},t),{},{naturalWidth:s.naturalWidth,naturalHeight:s.naturalHeight}))},s.onabort=function(){r.fail(new Error("Aborted to load the image."))},s.onerror=function(){r.fail(new Error("Failed to load the image."))},Sv.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Sv.navigator.userAgent)&&(s.crossOrigin="anonymous"),s.alt=i.name,s.src=t.url}},{key:"draw",value:function(t){var r=this,i=t.naturalWidth,s=t.naturalHeight,a=t.rotate,l=a===void 0?0:a,o=t.scaleX,h=o===void 0?1:o,d=t.scaleY,m=d===void 0?1:d,v=this.file,y=this.image,S=this.options,E=document.createElement("canvas"),M=E.getContext("2d"),C=Math.abs(l)%180===90,L=(S.resize==="contain"||S.resize==="cover")&&mL(S.width)&&mL(S.height),k=Math.max(S.maxWidth,0)||1/0,H=Math.max(S.maxHeight,0)||1/0,q=Math.max(S.minWidth,0)||0,Z=Math.max(S.minHeight,0)||0,ee=i/s,re=S.width,se=S.height;if(C){var ae=[H,k];k=ae[0],H=ae[1];var fe=[Z,q];q=fe[0],Z=fe[1];var Se=[se,re];re=Se[0],se=Se[1]}L&&(ee=re/se);var Ce=pS({aspectRatio:ee,width:k,height:H},"contain");k=Ce.width,H=Ce.height;var Ie=pS({aspectRatio:ee,width:q,height:Z},"cover");if(q=Ie.width,Z=Ie.height,L){var je=pS({aspectRatio:ee,width:re,height:se},S.resize);re=je.width,se=je.height}else{var Le=pS({aspectRatio:ee,width:re,height:se}),ot=Le.width;re=ot===void 0?i:ot;var ye=Le.height;se=ye===void 0?s:ye}re=Math.floor(rJ(Math.min(Math.max(re,q),k))),se=Math.floor(rJ(Math.min(Math.max(se,Z),H)));var $e=-re/2,Ve=-se/2,_t=re,wt=se,Vt=[];if(L){var lt=0,Ht=0,Qt=i,rn=s,jn=pS({aspectRatio:ee,width:i,height:s},{contain:"cover",cover:"contain"}[S.resize]);Qt=jn.width,rn=jn.height,lt=(i-Qt)/2,Ht=(s-rn)/2,Vt.push(lt,Ht,Qt,rn)}if(Vt.push($e,Ve,_t,wt),C){var Bn=[se,re];re=Bn[0],se=Bn[1]}E.width=re,E.height=se,Sz(S.mimeType)||(S.mimeType=v.type);var Tn="transparent";v.size>S.convertSize&&S.convertTypes.indexOf(S.mimeType)>=0&&(S.mimeType="image/jpeg");var Pe=S.mimeType==="image/jpeg";if(Pe&&(Tn="#fff"),M.fillStyle=Tn,M.fillRect(0,0,re,se),S.beforeDraw&&S.beforeDraw.call(this,M,E),!this.aborted&&(M.save(),M.translate(re/2,se/2),M.rotate(l*Math.PI/180),M.scale(h,m),M.drawImage.apply(M,[y].concat(Vt)),M.restore(),S.drew&&S.drew.call(this,M,E),!this.aborted)){var qe=function(cn){if(!r.aborted){var St=function(sn){return r.done({naturalWidth:i,naturalHeight:s,result:sn})};if(cn&&Pe&&S.retainExif&&r.exif&&r.exif.length>0){var Jt=function(sn){return St(eJ(nJ(e9e(sn,r.exif),S.mimeType)))};if(cn.arrayBuffer)cn.arrayBuffer().then(Jt).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var kn=new hO;r.reader=kn,kn.onload=function(Gn){var sn=Gn.target;Jt(sn.result)},kn.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},kn.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},kn.onloadend=function(){r.reader=null},kn.readAsArrayBuffer(cn)}}else St(cn)}};E.toBlob?E.toBlob(qe,S.mimeType,S.quality):qe(eJ(E.toDataURL(S.mimeType,S.quality)))}}},{key:"done",value:function(t){var r=t.naturalWidth,i=t.naturalHeight,s=t.result,a=this.file,l=this.image,o=this.options;if(ny&&l.src.indexOf("blob:")===0&&ny.revokeObjectURL(l.src),s)if(o.strict&&!o.retainExif&&s.size>a.size&&o.mimeType===a.type&&!(o.width>r||o.height>i||o.minWidth>r||o.minHeight>i||o.maxWidth<r||o.maxHeight<i))s=a;else{var h=new Date;s.lastModified=h.getTime(),s.lastModifiedDate=h,s.name=a.name,s.name&&s.type!==a.type&&(s.name=s.name.replace(n9e,$8e(s.type)))}else s=a;this.result=s,o.success&&o.success.call(this,s)}},{key:"fail",value:function(t){var r=this.options;if(r.error)r.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=r9e,n}},{key:"setDefaults",value:function(t){pL(tJ,t)}}]),n}();const s9e="/about_portfolio/assets/biaozhun-C5OcRpNC.png",o9e="/about_portfolio/assets/target-DS1CVM5s.svg",ry=[Sce,s9e,Ace,gce,Tce,l9,Mce,_z,vce,r9,_ce,yce,i9,s9,Cce,o9e,bce,Ice,Rce,Pce,Lce,Dce,Bce,kce,wce,o9,a9,Ece,xce],a9e=()=>{const[n,e]=Ae.useState(0),t=Array.from({length:ry.length}).map(()=>Ae.useRef(null)),r=Ae.useRef(null);return Ae.useEffect(()=>{if(n===1){const i=new IntersectionObserver(s=>{s.forEach(a=>{if(a.isIntersecting){let l=a.target;l.src=l.dataset.src,i.unobserve(l)}})});t.forEach(s=>{s.current&&i.observe(s.current)})}if(n===2&&ry.forEach((i,s)=>{fetch(i).then(a=>a.blob()).then(a=>{new i9e(a,{quality:.6,maxWidth:600,maxHeight:800,success(l){let o=URL.createObjectURL(l);t[s].current.src=o},error(l){console.log("error in compressor:",l)}})}).catch(a=>console.log("error in fetch:",a))}),n===3){const i=new IntersectionObserver(s=>{s[0].isIntersecting&&(ry.forEach((a,l)=>{l>10&&(t[l].current.src=a)}),i.unobserve(r.current))});r.current&&i.observe(r.current)}},[n]),me.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[me.jsxs("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""}),me.jsx("div",{className:"mr-8 text-right",children:me.jsxs(fce,{children:[me.jsxs(t9,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:["",me.jsx(D8e,{className:"size-4 fill-white/60"})]}),me.jsxs(n9,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[me.jsx(Uf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(0),children:['loading="lazy"',me.jsx(k8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Uf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(1),children:["IntersectionObserver",me.jsx(F8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Uf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(2),children:["",me.jsx(P8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Uf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(3),children:["",me.jsx(KK,{className:"size-4 fill-white/30"})]})}),me.jsx(Uf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(4),children:["",me.jsx(KK,{className:"size-4 fill-white/30"})]})})]})]})})]}),me.jsx("div",{children:n===0&&ry.map((i,s)=>me.jsx("img",{src:i,alt:"",className:"w-full p-2",loading:"lazy"},s))}),n===1&&me.jsxs("div",{children:[me.jsxs("p",{children:[" ","vue@vueuse/core{useIntersectionObserver}dom"," "]}),me.jsx("p",{children:`useIntersectionObserver(refContent, ([{ isIntersecting }]) => {
    isVisible.value = isIntersecting; });`}),me.jsx("p",{children:"refContentdomisIntersectingrefdomisVisibleboolean"}),me.jsx("a",{href:"https://ruanyifeng.com/blog/2016/11/intersectionobserver_api.html",children:""}),ry.map((i,s)=>me.jsx("img",{ref:t[s],"data-src":i,alt:s,className:"w-full p-2"},s))]}),n===2&&me.jsxs("div",{children:[me.jsx("p",{children:""}),me.jsx("p",{children:"compressorjs"}),ry.map((i,s)=>me.jsx("img",{ref:t[s],alt:s,className:"w-full p-2"},s))]}),n===3&&me.jsxs("div",{children:[me.jsx("p",{children:"/"}),ry.map((i,s)=>me.jsxs("div",{children:[s<10&&me.jsx("img",{src:i,alt:s,className:"w-full p-2"},s),s===10&&me.jsx("p",{ref:r,children:"--------------------------------"}),s>10&&me.jsx("img",{ref:t[s],alt:s,className:"w-full  p-2"},s)]}))]}),n===4&&me.jsxs("div",{children:[me.jsx("div",{children:"* CDN"}),me.jsx("div",{children:"* "}),me.jsx("div",{children:"* ElementUIUI"})]})]})},l9e=()=>me.jsxs("div",{className:"absolute top-20 m-4 w-1/2 h-1/2 border-4 border-solid border-cyan-500",children:[me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"whitespace-nowrap overflow-hidden text-ellipsis",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgd               egeeeeeeeeeeeeeeeeee         eeeeeeeeeeeddddddggga    aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),me.jsx("br",{}),me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"whitespace-normal overflow-hidden break-all",children:"mmliugeojdgas      edrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeee              eeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),me.jsx("br",{}),me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"overflow-hidden break-all text-ellipsis line-clamp-3",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})})]}),c9e=()=>me.jsxs("div",{className:"absolute top-20 m-4 w-1/2",children:[me.jsx("p",{children:"input+buttoninput"}),me.jsx("br",{}),me.jsxs("div",{className:"flex",children:[me.jsx("input",{className:"border-2 flex-grow",type:"text"}),me.jsx("button",{className:"ml-2",children:"Search"})]})]}),u9e=()=>me.jsx("div",{className:"absolute left-1/4 top-1/4 w-1/3 h-1/3",children:me.jsx("div",{className:"split-line",children:"SplitLine"})}),h9e=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"};return me.jsxs("div",{className:"absolute top-20 p-4 w-full h-full flex flex-wrap content-start",children:[me.jsxs("div",{style:n,children:[me.jsx("p",{children:"1(,)flex + m-auto"}),me.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"m-auto",children:"box1"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"2(,)grid + place-items-center"}),me.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box2"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"3(,)table-cell + align-middle"}),me.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box3"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"4(,) + transform"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:"box4"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"5(,)"}),me.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"5-1(,)"}),me.jsx("div",{className:"flex justify-center items-center border-4 border-solid border-red-500",children:me.jsx("div",{children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"6()flex + m-auto"}),me.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500 m-auto",children:"box1"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"7()grid + place-items-center"}),me.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box2"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"8()table-cell + align-middle"}),me.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box3"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"9() + transform"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border-2 border-solid border-green-500",children:"box4"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"10()"}),me.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"11(),top-1/2 left-1/2 -ml- -mt-"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -ml-6 -mt-6 border-2 border-solid border-green-500",children:"box1"})})]})]})},f9e=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"},e={"font-size":"10px"},t={transform:"scale(0.83)"};return me.jsxs("div",{className:"absolute top-20 m-4 w-screen h-full flex",children:[me.jsxs("div",{style:n,children:[me.jsx("p",{children:"1, "}),me.jsx("div",{style:e,children:"box1"})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"2text-xs + scale(0.83),10/12"}),me.jsx("div",{className:"text-xs",style:t,children:"box2"})]}),me.jsx("div",{style:n,children:me.jsx("p",{children:"3htmlfont-size100pxfont-size1rem"})})]})},d9e=()=>{const n={display:"flex",height:"100px"},e={flex:"0 0 100px",backgroundColor:"red"},t={flexGrow:1,backgroundColor:"yellow"},r={display:"table",width:"100%"},i={display:"table-cell",width:"100px",height:"100px",backgroundColor:"red"},s={display:"table-cell",backgroundColor:"yellow"},a={display:"grid",gridTemplateColumns:"100px auto",gridTemplateRows:"100px"},l={backgroundColor:"red"},o={backgroundColor:"yellow"},h={width:"100%",overflow:"hidden"},d={display:"inline-block",width:"100px",height:"100px",backgroundColor:"red"},m={display:"inline-block",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"},v={width:"100%",overflow:"hidden"},y={display:"inline-block",position:"absolute",left:0,right:0,width:"100px",height:"100px",backgroundColor:"red"},S={display:"inline-block",marginLeft:"100px",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"};return me.jsxs("div",{className:"absolute w-screen top-20 ",children:[me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: flex; right: flex-grow = 1"}),me.jsxs("div",{style:n,children:[me.jsx("div",{style:e,children:"left"}),me.jsx("div",{style:t,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: grid, grid-template-rows, grid-template-cols;"}),me.jsxs("div",{style:a,children:[me.jsx("div",{style:l,children:"left"}),me.jsx("div",{style:o,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: table,; left/right: table-cell"}),me.jsxs("div",{style:r,children:[me.jsx("div",{style:i,children:"left"}),me.jsx("div",{style:s,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"right: calcwidth"}),me.jsxs("div",{style:h,children:[me.jsx("div",{style:d,children:"left"}),me.jsx("div",{style:m,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"leftabsolute,rightmargin-leftleft"}),me.jsxs("div",{style:v,children:[me.jsx("div",{style:y,children:"left"}),me.jsx("div",{style:S,children:"right"})]})]})]})},p9e=()=>{const n={height:"1px",background:"black",transform:"scaleY(0.5)",transformOrigin:"50% 100%"},e={height:"1px",background:"black",boxShadow:"0 0 0.5px  black"};return Ae.useEffect(()=>{document.addEventListener("contextmenu",t=>{t.preventDefault()}),document.addEventListener("selectstart",t=>{t.preventDefault()}),document.addEventListener("copy",t=>{t.preventDefault()}),document.addEventListener("cut",t=>{t.preventDefault()})},[]),me.jsxs("div",{className:"absolute w-screen top-20 ",children:[me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"transform: scaleY(0.5)"}),me.jsx("div",{style:n})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"box-shadow"}),me.jsx("div",{style:e})]}),me.jsx("div",{children:me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""})})]})},m9e=[{imageUrl:vSe,name:"CSS",type:"Frontend"},{imageUrl:_Se,name:"Express",type:"Backend"},{imageUrl:ySe,name:"Git",type:"Version Control"},{imageUrl:xSe,name:"GitHub",type:"Version Control"},{imageUrl:bSe,name:"HTML",type:"Frontend"},{imageUrl:wSe,name:"JavaScript",type:"Frontend"},{imageUrl:SSe,name:"MongoDB",type:"Database"},{imageUrl:ASe,name:"Motion",type:"Animation"},{imageUrl:TSe,name:"Material-UI",type:"Frontend"},{imageUrl:MSe,name:"Next.js",type:"Frontend"},{imageUrl:CSe,name:"Node.js",type:"Backend"},{imageUrl:ESe,name:"React",type:"Frontend"},{imageUrl:ISe,name:"Redux",type:"State Management"},{imageUrl:RSe,name:"Sass",type:"Frontend"},{imageUrl:PSe,name:"Tailwind CSS",type:"Frontend"},{imageUrl:LSe,name:"TypeScript",type:"Frontend"}],g9e=[{title:"-",company_name:"",icon:mX,iconBg:"#fbc3bc",date:"2021.07-2021.08",points:["",""]},{title:"-",company_name:"AR",icon:GSe,iconBg:"#accbe1",date:"2023.07 -2023.08",points:["AR AR ","","Windows AR APP Windows AR AR ","unity c# Lua AR "]},{title:"Web Developer",company_name:"",icon:USe,iconBg:"#b7e4c7",date:"2024.06-2024.08",points:["Developing and maintaining web applications using React.js and other related technologies.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Participating in code reviews and providing constructive feedback to other developers."]},{title:"",company_name:"GIS",icon:mX,iconBg:"#fbc3bc",date:"2023.09",points:["","","",""]}],v9e=[{iconUrl:BSe,theme:"btn-back-red",name:"",description:`(2021.10 -2021.12)

KeplerKepler.gl OD 
HTML CSS BootStrap supermap iclient for leaflet SuperMapSuperMap.iserver SQL APIAPIPOI `,link:"https://github.com/youxt-njnu/XuXiaKe"},{iconUrl:kSe,theme:"btn-back-pink",name:"",description:`C#GIS(2021.10 -2021.12) 
dotspatial C# .net GIS  ,,, `,link:"https://github.com/youxt-njnu/ProjectSnapshot/blob/master/c%23%E4%B8%8EGIS%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91-%E5%9C%9F%E5%A3%A4%E5%9B%BE%E6%96%91%E8%AF%86%E5%88%AB%E4%B8%8E%E5%B1%9E%E6%80%A7%E9%A2%84%E6%B5%8B%E7%B3%BB%E7%BB%9F.pdf"},{iconUrl:FSe,theme:"btn-back-green",name:"",description:`(2022.04-2022.06) 

 3D
Mapbox JS JS, Bootstrap Echarts `,link:"https://github.com/youxt-njnu/Milk"},{iconUrl:yre,theme:"btn-back-blue",name:"GIS",description:`GIS WebGIS (2022.10 -2022.12)
Axure QGIS postgresql geoserverJquery Ajax httphttp-server openlayer Mapbox echarts `,link:"https://github.com/youxt-njnu/hgisworkHD"},{iconUrl:OSe,theme:"btn-back-yellow",name:"Flappy Bird",description:`XluaFlappy Birdc#(2023.08-2023.09)
Flappy Bird is a mobile game developed by Vietnamese video game artist and programmer Dong Nguyen. The game is a side-scroller where the player controls a bird, attempting to fly between columns of green pipes without hitting them.`,link:"https://github.com/youxt-njnu/flappy_bird_xlua"},{iconUrl:DSe,theme:"btn-back-black",name:"AR",description:`AR(2023.12-2024.06)
 GISARARAR`,link:"https://mp.weixin.qq.com/s?__biz=MzU4MTc2MDAyNg==&mid=2247484289&idx=1&sn=ca9ab0ac73791c6a453b5d0364130248&chksm=fc6d6a49da4532c55ff74676bd34092d37bd742f1ee040c1740ca72043ab6e9050428ac70ce1&scene=126&sessionid=1724225266#rd"}],Qi="",qce=[{name:"postprocessLut",img:"https://s2.loli.net/2024/10/17/HrfLEsU4zydXaAt.png",path:Qi+"bird",component:Jke,type:"1",info:"react-three-fiber"},{name:"",img:"https://s2.loli.net/2024/10/17/yexj6A8cqVvMKDN.png",path:Qi+"sky",component:YSe,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/08/05/hBc1om3X5euCRkt.png",path:Qi+"fox",component:Zke,type:"",info:""},{name:"",img:"https://dragonir.github.io/3d/static/media/earthDigital.8c221282f247bb724b85.png",path:Qi+"earth-digital",component:Wke,type:"",info:"3Dshader..."},{name:"",img:"https://s2.loli.net/2024/10/05/Ypj16zckvyd78Do.png",path:Qi+"earth-moving",component:cOe,type:"",info:"geometry"},{name:"",img:"https://s2.loli.net/2024/10/05/WiUuGJ3CbnagLc6.png",path:Qi+"light-model",component:XOe,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/18/16FgOsBTyM8NntV.png",path:Qi+"descent-3d",component:qOe,type:"ShaderToy",info:"ShaderToy3D"},{name:"",img:"https://s2.loli.net/2024/11/29/53zmKr7wkDXvEOV.png",path:Qi+"box-rotate",component:ZOe,type:"rotate",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/xOVH39vBsNUohSE.png",path:Qi+"multimedia",component:QOe,type:"multimedia",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/oHnINiSMd9mua7z.png",path:Qi+"multimedia2",component:aFe,type:"multimedia",info:"gltfdraco"},{name:"",img:"https://s2.loli.net/2024/11/29/D48EJRLzi5kofpw.png",path:Qi+"particle",component:N6e,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/36QACaqtnJ5FHyX.png",path:Qi+"astronaut-particle",component:G6e,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/MUL51g9qBvkbtiO.png",path:Qi+"postprocess-box",component:X6e,type:"",info:""},{name:"RickMorty",img:"https://s2.loli.net/2024/11/29/Sfsr5BiyhOXI7mc.png",path:Qi+"rick-morty",component:J6e,type:"",info:""},{name:"ShaderPattern",img:"https://s2.loli.net/2024/11/29/19j8O2X3ofJuT7F.png",path:Qi+"shader-pattern",component:tUe,type:"",info:""}],Zce=[{name:"",img:"https://s2.loli.net/2024/10/17/OsrIyLWMmZ6Ezpk.png",path:Qi+"mapbox-simple",component:rUe,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/08/tDnLboVM1TEu47K.png",path:Qi+"milk-story",component:yUe,type:"",info:""}],Yce=[{name:"html+css ",img:"https://s2.loli.net/2024/11/16/KmZYDPr6bvtiW5V.png",path:Qi+"bar-pie",component:xUe,type:"html+css",info:""},{name:"CanvasDemo",img:"https://s2.loli.net/2024/11/26/A7GhwiavVftz2P3.png",path:Qi+"canvas-demo",component:s8e,type:"canvas",info:"canvas"},{name:"WebglUseage",img:"",path:Qi+"webgl-useage",component:o8e,type:"webgl",info:"webgl"},{name:"roughUsage",img:"https://s2.loli.net/2024/12/14/HNgQxS9EdbOqKnF.png",path:Qi+"rough-usage",component:S8e,type:"rough",info:""},{name:"randomTree",img:"https://s2.loli.net/2024/12/14/EipXTY8VClbhZ2R.png",path:Qi+"random-tree",component:A8e,type:"vector2d",info:"vector2d"},{name:"ParametricEquation",img:"",path:Qi+"parametric-equation",component:T8e,type:"parametric",info:""}],Kce=[{name:"",img:"https://s2.loli.net/2024/11/06/ozbCSmLM4FHTfXn.png",path:Qi+"holy-grail",component:I8e,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/PnIGVfoybwmxq1e.png",path:Qi+"hanging",component:E8e,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/ZWJEAH8I9XdKyzl.png",path:Qi+"float",component:C8e,type:"flex",info:"flex wrapflex content"},{name:"",img:"https://s2.loli.net/2024/11/08/KTBDMSPIRjyZtxr.png",path:Qi+"split-line",component:u9e,type:"",info:"::before, ::after"},{name:"",img:"https://s2.loli.net/2024/11/16/kpwcFnbIV64gJlo.png",path:Qi+"img-load",component:a9e,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/chJoFXtiAQOIZ24.png",path:Qi+"vertical-center",component:h9e,type:"css",info:""},{name:"10px",img:"https://s2.loli.net/2024/11/16/6UAxNLktFWEp19D.png",path:Qi+"px10",component:f9e,type:"css",info:"10px"},{name:"",img:"https://s2.loli.net/2024/11/16/STwlbGxRraoVyvt.png",path:Qi+"multi-line",component:l9e,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/TGhwNUIS4juCtAP.png",path:Qi+"search-btn",component:c9e,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/27/jt7IVgvzb5Scuk8.png",path:Qi+"two-band",component:d9e,type:"css",info:""},{name:"0.5px",img:"https://s2.loli.net/2024/11/27/m5CWc6qbVNaH9GJ.png",path:Qi+"line05",component:p9e,type:"css",info:"0.5px+"},{name:"",img:"https://s2.loli.net/2024/11/16/m8LDxkrKYtHVG94.png",path:Qi+"draw-poly",component:M8e,type:"css",info:"CSS"}];var v3={},Jce={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var s="",a=0;a<arguments.length;a++){var l=arguments[a];l&&(s=i(s,r(l)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var l in s)e.call(s,l)&&s[l]&&(a=i(a,l));return a}function i(s,a){return a?s?s+" "+a:s+a:s}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(Jce);var Qce=Jce.exports;v3.__esModule=!0;v3.default=void 0;var _9e=d9(Ae),M0=d9(_re),y9e=d9(Qce);function d9(n){return n&&n.__esModule?n:{default:n}}const eue=({animate:n=!0,className:e="",layout:t="2-columns",lineColor:r="#FFF",children:i})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",r),_9e.default.createElement("div",{className:(0,y9e.default)(e,"vertical-timeline",{"vertical-timeline--animate":n,"vertical-timeline--two-columns":t==="2-columns","vertical-timeline--one-column-left":t==="1-column"||t==="1-column-left","vertical-timeline--one-column-right":t==="1-column-right"})},i));eue.propTypes={children:M0.default.oneOfType([M0.default.arrayOf(M0.default.node),M0.default.node]).isRequired,className:M0.default.string,animate:M0.default.bool,layout:M0.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:M0.default.string};var x9e=eue;v3.default=x9e;var _3={};function Az(){return Az=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Az.apply(this,arguments)}function b9e(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Tz(n,e)}function Tz(n,e){return Tz=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Tz(n,e)}function w9e(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}var Mz=new Map,EI=new WeakMap,iJ=0,tue=void 0;function S9e(n){tue=n}function A9e(n){return n?(EI.has(n)||(iJ+=1,EI.set(n,iJ.toString())),EI.get(n)):"0"}function T9e(n){return Object.keys(n).sort().filter(function(e){return n[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?A9e(n.root):n[e])}).toString()}function M9e(n){var e=T9e(n),t=Mz.get(e);if(!t){var r=new Map,i,s=new IntersectionObserver(function(a){a.forEach(function(l){var o,h=l.isIntersecting&&i.some(function(d){return l.intersectionRatio>=d});n.trackVisibility&&typeof l.isVisible>"u"&&(l.isVisible=h),(o=r.get(l.target))==null||o.forEach(function(d){d(h,l)})})},n);i=s.thresholds||(Array.isArray(n.threshold)?n.threshold:[n.threshold||0]),t={id:e,observer:s,elements:r},Mz.set(e,t)}return t}function p9(n,e,t,r){if(t===void 0&&(t={}),r===void 0&&(r=tue),typeof window.IntersectionObserver>"u"&&r!==void 0){var i=n.getBoundingClientRect();return e(r,{isIntersecting:r,target:n,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:i,intersectionRect:i,rootBounds:i}),function(){}}var s=M9e(t),a=s.id,l=s.observer,o=s.elements,h=o.get(n)||[];return o.has(n)||o.set(n,h),h.push(e),l.observe(n),function(){h.splice(h.indexOf(e),1),h.length===0&&(o.delete(n),l.unobserve(n)),o.size===0&&(l.disconnect(),Mz.delete(a))}}var C9e=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function sJ(n){return typeof n.children!="function"}var gL=function(n){b9e(e,n);function e(r){var i;return i=n.call(this,r)||this,i.node=null,i._unobserveCb=null,i.handleNode=function(s){i.node&&(i.unobserve(),!s&&!i.props.triggerOnce&&!i.props.skip&&i.setState({inView:!!i.props.initialInView,entry:void 0})),i.node=s||null,i.observeNode()},i.handleChange=function(s,a){s&&i.props.triggerOnce&&i.unobserve(),sJ(i.props)||i.setState({inView:s,entry:a}),i.props.onChange&&i.props.onChange(s,a)},i.state={inView:!!r.initialInView,entry:void 0},i}var t=e.prototype;return t.componentDidUpdate=function(i){(i.rootMargin!==this.props.rootMargin||i.root!==this.props.root||i.threshold!==this.props.threshold||i.skip!==this.props.skip||i.trackVisibility!==this.props.trackVisibility||i.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},t.componentWillUnmount=function(){this.unobserve(),this.node=null},t.observeNode=function(){if(!(!this.node||this.props.skip)){var i=this.props,s=i.threshold,a=i.root,l=i.rootMargin,o=i.trackVisibility,h=i.delay,d=i.fallbackInView;this._unobserveCb=p9(this.node,this.handleChange,{threshold:s,root:a,rootMargin:l,trackVisibility:o,delay:h},d)}},t.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},t.render=function(){if(!sJ(this.props)){var i=this.state,s=i.inView,a=i.entry;return this.props.children({inView:s,entry:a,ref:this.handleNode})}var l=this.props,o=l.children,h=l.as,d=w9e(l,C9e);return Ae.createElement(h||"div",Az({ref:this.handleNode},d),o)},e}(Ae.Component);gL.displayName="InView";gL.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function E9e(n){var e=n===void 0?{}:n,t=e.threshold,r=e.delay,i=e.trackVisibility,s=e.rootMargin,a=e.root,l=e.triggerOnce,o=e.skip,h=e.initialInView,d=e.fallbackInView,m=Ae.useRef(),v=Ae.useState({inView:!!h}),y=v[0],S=v[1],E=Ae.useCallback(function(C){m.current!==void 0&&(m.current(),m.current=void 0),!o&&C&&(m.current=p9(C,function(L,k){S({inView:L,entry:k}),k.isIntersecting&&l&&m.current&&(m.current(),m.current=void 0)},{root:a,rootMargin:s,threshold:t,trackVisibility:i,delay:r},d))},[Array.isArray(t)?t.toString():t,a,s,l,o,i,d,r]);Ae.useEffect(function(){!m.current&&y.entry&&!l&&!o&&S({inView:!!h})});var M=[E,y.inView,y.entry];return M.ref=M[0],M.inView=M[1],M.entry=M[2],M}const I9e=Object.freeze(Object.defineProperty({__proto__:null,InView:gL,default:gL,defaultFallbackInView:S9e,observe:p9,useInView:E9e},Symbol.toStringTag,{value:"Module"})),R9e=lde(I9e);_3.__esModule=!0;_3.default=void 0;var C0=m9(Ae),Ao=m9(_re),II=m9(Qce),P9e=R9e;function m9(n){return n&&n.__esModule?n:{default:n}}const nue=({children:n="",className:e="",contentArrowStyle:t=null,contentStyle:r=null,date:i="",dateClassName:s="",icon:a=null,iconClassName:l="",iconOnClick:o=null,onTimelineElementClick:h=null,iconStyle:d=null,id:m="",position:v="",style:y=null,textClassName:S="",intersectionObserverProps:E={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:M=!1})=>C0.default.createElement(P9e.InView,E,({inView:C,ref:L})=>C0.default.createElement("div",{ref:L,id:m,className:(0,II.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":v==="left","vertical-timeline-element--right":v==="right","vertical-timeline-element--no-children":n===""}),style:y},C0.default.createElement(C0.default.Fragment,null,C0.default.createElement("span",{style:d,onClick:o,className:(0,II.default)(l,"vertical-timeline-element-icon",{"bounce-in":C||M,"is-hidden":!(C||M)})},a),C0.default.createElement("div",{style:r,onClick:h,className:(0,II.default)(S,"vertical-timeline-element-content",{"bounce-in":C||M,"is-hidden":!(C||M)})},C0.default.createElement("div",{style:t,className:"vertical-timeline-element-content-arrow"}),n,C0.default.createElement("span",{className:(0,II.default)(s,"vertical-timeline-element-date")},i)))));nue.propTypes={children:Ao.default.oneOfType([Ao.default.arrayOf(Ao.default.node),Ao.default.node]),className:Ao.default.string,contentArrowStyle:Ao.default.shape({}),contentStyle:Ao.default.shape({}),date:Ao.default.node,dateClassName:Ao.default.string,icon:Ao.default.element,iconClassName:Ao.default.string,iconStyle:Ao.default.shape({}),iconOnClick:Ao.default.func,onTimelineElementClick:Ao.default.func,id:Ao.default.string,position:Ao.default.string,style:Ao.default.shape({}),textClassName:Ao.default.string,visible:Ao.default.bool,intersectionObserverProps:Ao.default.shape({root:Ao.default.object,rootMargin:Ao.default.string,threshold:Ao.default.number,triggerOnce:Ao.default.bool})};var L9e=nue;_3.default=L9e;var oJ={VerticalTimeline:v3.default,VerticalTimelineElement:_3.default};const g9=()=>me.jsxs("section",{className:"cta",children:[me.jsxs("p",{className:"cta-text",children:["Have a project in mind? ",me.jsx("br",{className:"sm:block hidden"}),"Let's build something together! "]}),me.jsx(G0,{to:"/contact",className:"btn",children:"Contact"})]}),D9e=()=>me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:["Hello, I'm ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:" Shealin"})]}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsx("p",{children:"/+86-15651736857"}),me.jsx("p",{children:"you_yxt@163.com"}),me.jsx("p",{children:""}),me.jsx("p",{children:"GIS"}),me.jsx("p",{children:"619567"}),me.jsx("p",{children:"AR"}),me.jsx("p",{children:""}),me.jsx("p",{children:"GISArcGIS/QGISGeoserverPostgreSQL&PostGIS"}),me.jsx("p",{children:"3Dhtml&css&js, nodejs, react; BootStrap, ECharts; ThreeJS, Cesium, WebGL"}),me.jsx("p",{children:"ARVuforiaU3DMapbox SDK for UnityLua"}),me.jsx("p",{children:"I have a background in GIS, Augmented Reality and front end, so  is like the perfect place for me."})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsx("h4",{className:"text-slate-800",children:"GPA:4.22/52019.09~2023.07"}),me.jsx("p",{children:"GIScience"}),me.jsx("p",{children:"(99)(96)C++GIS(98)C#GIS(97)GIS(95)"}),me.jsx("p",{children:"38322021H2021C/C++ "}),me.jsx("h4",{className:"text-slate-800",children:"2023.09"}),me.jsx("p",{children:""}),me.jsx("p",{children:"2024202412"})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsx("h4",{className:"text-slate-800",children:""}),me.jsx("p",{children:"You, X., Chen, G.*, & Duan, J. (Forthcoming). Exploring Traffic Planning Networks across Multiple Scales Based on Urban Morphology: A Case Study of Nanjing, China. Journal of Urban Planning and Development. https://doi.org/10.1061/JUPDDM/UPENG-5086."}),me.jsx("p",{children:"Duan, J., Zhao, Z., Xu, Y., You, X., Yang, F., & Chen, G.* (2024). Spatial distribution characteristics and driving factors of Little Giant enterprises in Chinas megacity clusters based on random forest and MGWR. Land, 13(7), 1105. https://doi.org/10.3390/land13071105."}),me.jsx("p",{children:"Deng, Z., You, X., Shi, Z., Gao, H., Hu, X., Yu, Z., & Yuan, L.* (2022). Identification of urban functional zones based on the spatial specificity of online car-hailing traffic cycle. ISPRS International Journal of Geo-Information, 11(8), 435. https://doi.org/10.3390/ijgi11080435."}),me.jsx("h4",{className:"text-slate-800",children:""}),me.jsx("p",{children:"Chen, G., Xu, Y., Duan, J., You, X., Zhao, Z., & Yang, F. (2024). A method for constructing knowledge graphs in the biopharmaceutical industry. China Patent No. 202410712065.2. Authorized, pending issuance."}),me.jsx("p",{children:""})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsxs("p",{children:["2023 AR ",me.jsx("br",{}),"1. 20802020",me.jsx("br",{}),"2.  AR ",me.jsx("br",{}),"3.  AR "]}),me.jsxs("p",{children:["2020-2023,",me.jsx("br",{}),"1. ",me.jsx("br",{}),"2. "]}),me.jsx("p",{children:"2021-2022"}),me.jsx("p",{children:"2019-2020AHP-"})]}),me.jsxs("div",{className:"py-8 flex flex-col",children:[me.jsx("h3",{className:"subhead-text",children:""}),me.jsx("div",{className:"mt-16 flex flex-wrap gap-12",children:m9e.map(n=>me.jsxs("div",{className:"block-container w-20 h-20",children:[me.jsx("div",{className:"btn-back rounded-xl"}),me.jsx("div",{className:"btn-front rounded-xl flex justify-center items-center",children:me.jsx("img",{src:n.imageUrl,alt:n.name,className:"w-1/2 h-1/2 object-contain"})})]}))})]}),me.jsxs("div",{className:"py-16",children:[me.jsx("h3",{className:"subhead-text",children:""}),me.jsx("div",{className:"mt-2 flex flex-col gap-3 text-slate-500 "}),me.jsx("div",{className:"mt-12 flex",children:me.jsx(oJ.VerticalTimeline,{children:g9e.map(n=>me.jsxs(oJ.VerticalTimelineElement,{date:n.date,icon:me.jsx("div",{className:"flex justify-center items-center w-full h-full",children:me.jsx("img",{src:n.icon,alt:n.company_name,className:"w-[60%] h-[60%] object-contain"})}),iconStyle:{background:n.iconBg},contentStyle:{borderBottom:"8px",borderStyle:"solid",borderBottomColor:n.iconBg,boxShadow:"none"},children:[me.jsxs("div",{children:[me.jsx("h3",{className:"text-black text-xl font-poppins font-semibold",children:n.title}),me.jsx("p",{className:"text-black-500 font-medium font-base",style:{margin:0},children:n.company_name})]}),me.jsx("ul",{className:"my-5 list-disc ml-5 space-y-2",children:n.points.map((e,t)=>me.jsx("li",{className:"text-black-500/50 font-normal pl-1 text-sm",children:e},`experience-point-${t}`))})]},n.company_name))})})]}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(g9,{})]}),RI=n=>me.jsxs("div",{className:"group relative",children:[me.jsx("div",{className:"relative h-80 w-full overflow-hidden rounded-lg bg-white sm:aspect-h-1 sm:aspect-w-2 lg:aspect-h-1 lg:aspect-w-1 group-hover:opacity-75 sm:h-64",children:me.jsx("img",{src:n.img,alt:n.name,className:"h-full w-full object-cover object-center"})}),me.jsx("h3",{className:"mt-1 text-sm text-slate-500",children:me.jsxs("div",{children:[me.jsx("span",{className:"absolute inset-0"}),n.type]})}),me.jsx("p",{className:"mb-3 text-base font-semibold text-slate-900",children:n.info})]}),B9e=()=>me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"ThreeJS"})," Works "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-6 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:qce.map((n,e)=>me.jsx(G0,{to:n.path,children:me.jsx(RI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"Mapbox GL JS"})," Works "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Zce.map((n,e)=>me.jsx(G0,{to:n.path,children:me.jsx(RI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:" 2D"})," Visualization "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Yce.map((n,e)=>me.jsx(G0,{to:n.path,children:me.jsx(RI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:""}),"  "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Kce.map((n,e)=>me.jsx(G0,{to:n.path,children:me.jsx(RI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(g9,{})]}),ST={_origin:"https://api.emailjs.com"},k9e=(n,e="https://api.emailjs.com")=>{ST._userID=n,ST._origin=e},rue=(n,e,t)=>{if(!n)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class aJ{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const iue=(n,e,t={})=>new Promise((r,i)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:a})=>{const l=new aJ(a);l.status===200||l.text==="OK"?r(l):i(l)}),s.addEventListener("error",({target:a})=>{i(new aJ(a))}),s.open("POST",ST._origin+n,!0),Object.keys(t).forEach(a=>{s.setRequestHeader(a,t[a])}),s.send(e)}),O9e=(n,e,t,r)=>{const i=r||ST._userID;return rue(i,n,e),iue("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:i,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})},F9e=n=>{let e;if(typeof n=="string"?e=document.querySelector(n):e=n,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},N9e=(n,e,t,r)=>{const i=r||ST._userID,s=F9e(t);rue(i,n,e);const a=new FormData(s);return a.append("lib_version","3.11.0"),a.append("service_id",n),a.append("template_id",e),a.append("user_id",i),iue("/api/v1.0/email/send-form",a)},z9e={init:k9e,send:O9e,sendForm:N9e},U9e=({type:n,text:e})=>me.jsx("div",{className:"absolute top-10 left-0 right-0 flex justify-center items-center",children:me.jsxs("div",{className:`${n==="danger"?"bg-red-800":"bg-blue-800"} p-2 text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex items-center`,role:"alert",children:[me.jsx("p",{className:`${n==="danger"?"bg-red-500":"bg-blue-500"} flex rounded-full uppercase px-2 py-1 font-semibold mr-3 text-xs`,children:n==="danger"?"Failed":"Success"}),me.jsxs("p",{className:"mr-2 text-left",children:[" ",e," "]})]})}),G9e=()=>{const[n,e]=Ae.useState({show:!1,text:"",type:"danger"});return{alert:n,showAlert:({text:i,type:s="danger"})=>e({show:!0,text:i,type:s}),hideAlert:()=>e({show:!1,text:"",type:"danger"})}},V9e=()=>{const n=Ae.useRef(null),[e,t]=Ae.useState({name:"",email:"",message:""}),[r,i]=Ae.useState(!1),[s,a]=Ae.useState("idle"),{alert:l,showAlert:o,hideAlert:h}=G9e(),d=S=>{t({...e,[S.target.name]:S.target.value})},m=()=>{a("walk")},v=()=>{a("idle")},y=S=>{S.preventDefault(),i(!0),a("hit"),z9e.send("service_5bezaam","template_dafnzfi",{from_name:e.name,to_name:"Shealin",from_email:e.email,to_email:"yikeyouIl@gmail.com",message:e.message},"JpbkxBEdlS8faxCrq").then(()=>{i(!1),o({show:!0,text:"Your message has been sent successfully!",type:"success"}),setTimeout(()=>{h(),a("idle"),t({name:"",email:"",message:""})},[3e3])}).catch(E=>{i(!1),a("idle"),console.log(E),o({show:!0,text:"I didn't receive your message",type:"danger"})})};return me.jsxs("section",{className:"relative flex lg:flex-row flex-col max-container h-[100vh]",children:[l.show&&me.jsx(U9e,{...l}),me.jsxs("div",{className:"flex-1 min-w-[50%] flex flex-col",children:[me.jsx("h1",{className:"head-text",children:"Get in Touch"}),me.jsxs("form",{action:"",className:"w-full flex flex-col gap-7 mt-14",ref:n,onSubmit:y,children:[me.jsxs("label",{className:"text-black-500 font-semibold",children:["Name",me.jsx("input",{type:"text",name:"name",className:"input",placeholder:"John",required:!0,value:e.name,onChange:d,onFocus:m,onBlur:v})]}),me.jsxs("label",{className:"text-black-500 font-semibold",children:["Email",me.jsx("input",{type:"email",name:"email",className:"input",placeholder:"John@gmail.com",required:!0,value:e.email,onChange:d,onFocus:m,onBlur:v})]}),me.jsxs("label",{className:"text-black-500 font-semibold",children:["Your Message",me.jsx("textarea",{name:"message",rows:"4",className:"textarea",placeholder:"Let me know how I can help you!",required:!0,value:e.message,onChange:d,onFocus:m,onBlur:v})]}),me.jsx("button",{type:"submit",className:"btn",disabled:r,onFocus:m,onBlur:v,children:r?"Sending...":"Submit"})]})]}),me.jsx("div",{className:"lg:w-1/2 w-full lg:h-auto md:h-[550px] h-[350px]",children:me.jsxs(wD,{camera:{position:[0,0,5],fov:75,near:.1,far:1e3},children:[me.jsx("ambientLight",{intensity:.5}),me.jsx("directionalLight",{intensity:2.5,position:[0,0,1]}),me.jsx(Ae.Suspense,{fallback:me.jsx(vU,{}),children:me.jsx(wle,{currentAnimation:s,position:[.5,.35,0],rotation:[12.6,-.5,0],scale:[.5,.5,.5]})})]})})]})},H9e="/about_portfolio/assets/sakura-Dh6hhofb.mp3",fO=({text:n,link:e,btnText:t})=>me.jsxs("div",{className:"info-box",children:[me.jsx("p",{className:"whitespace-pre-wrap font-medium sm:text-xl text-center",children:n}),me.jsxs(G0,{to:e,className:"neo-brutalism-white neo-btn",children:[t,me.jsx("img",{src:xre,className:"w-4 h-4 object-contain"})]})]}),j9e={1:me.jsxs("h1",{className:"sm:text-xl sm:leading-snug text-center neo-brutalism-blue py-4 px-8 text-white mx-5",children:["Hi, I am ",me.jsx("span",{className:"font-semibold",children:"Shealin"})," ",me.jsx("br",{}),"(...)"]}),2:me.jsx(fO,{text:"...",link:"/about",btnText:"Learn more"}),3:me.jsx(fO,{text:"...",link:"/projects",btnText:"Visit projects"}),4:me.jsx(fO,{text:"?",link:"/contact",btnText:"Let's talk"})},W9e=({currentStage:n})=>j9e[n]||null;var X9e=Object.defineProperty,$9e=(n,e)=>{for(var t in e)X9e(n,t,{get:e[t],enumerable:!0})},fw={};$9e(fw,{assign:()=>J9e,colors:()=>av,createStringInterpolator:()=>S9,skipAnimation:()=>hue,to:()=>uue,willAdvance:()=>A9});var v9=bM(),us=n=>xM(n,v9),_9=bM();us.write=n=>xM(n,_9);var y3=bM();us.onStart=n=>xM(n,y3);var y9=bM();us.onFrame=n=>xM(n,y9);var x9=bM();us.onFinish=n=>xM(n,x9);var Hb=[];us.setTimeout=(n,e)=>{const t=us.now()+e,r=()=>{const s=Hb.findIndex(a=>a.cancel==r);~s&&Hb.splice(s,1),$0-=~s?1:0},i={time:t,handler:n,cancel:r};return Hb.splice(sue(t),0,i),$0+=1,oue(),i};var sue=n=>~(~Hb.findIndex(e=>e.time>n)||~Hb.length);us.cancel=n=>{y3.delete(n),y9.delete(n),x9.delete(n),v9.delete(n),_9.delete(n)};us.sync=n=>{Cz=!0,us.batchedUpdates(n),Cz=!1};us.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function r(...i){e=i,us.onStart(t)}return r.handler=n,r.cancel=()=>{y3.delete(t),e=null},r};var b9=typeof window<"u"?window.requestAnimationFrame:()=>{};us.use=n=>b9=n;us.now=typeof performance<"u"?()=>performance.now():Date.now;us.batchedUpdates=n=>n();us.catch=console.error;us.frameLoop="always";us.advance=()=>{us.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):lue()};var X0=-1,$0=0,Cz=!1;function xM(n,e){Cz?(e.delete(n),n(0)):(e.add(n),oue())}function oue(){X0<0&&(X0=0,us.frameLoop!=="demand"&&b9(aue))}function q9e(){X0=-1}function aue(){~X0&&(b9(aue),us.batchedUpdates(lue))}function lue(){const n=X0;X0=us.now();const e=sue(X0);if(e&&(cue(Hb.splice(0,e),t=>t.handler()),$0-=e),!$0){q9e();return}y3.flush(),v9.flush(n?Math.min(64,X0-n):16.667),y9.flush(),_9.flush(),x9.flush()}function bM(){let n=new Set,e=n;return{add(t){$0+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return $0-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,$0-=e.size,cue(e,r=>r(t)&&n.add(r)),$0+=n.size,e=n)}}}function cue(n,e){n.forEach(t=>{try{e(t)}catch(r){us.catch(r)}})}function Z9e(){}var Y9e=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),ia={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function K9e(n,e){if(ia.arr(n)){if(!ia.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}var Nm=(n,e)=>n.forEach(e);function Ez(n,e,t){if(ia.arr(n)){for(let r=0;r<n.length;r++)e.call(t,n[r],`${r}`);return}for(const r in n)n.hasOwnProperty(r)&&e.call(t,n[r],r)}var PI=n=>ia.und(n)?[]:ia.arr(n)?n:[n],w9=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),S9,uue,av=null,hue=!1,A9=Z9e,J9e=n=>{n.to&&(uue=n.to),n.now&&(us.now=n.now),n.colors!==void 0&&(av=n.colors),n.skipAnimation!=null&&(hue=n.skipAnimation),n.createStringInterpolator&&(S9=n.createStringInterpolator),n.requestAnimationFrame&&us.use(n.requestAnimationFrame),n.batchedUpdates&&(us.batchedUpdates=n.batchedUpdates),n.willAdvance&&(A9=n.willAdvance),n.frameLoop&&(us.frameLoop=n.frameLoop)},yA=new Set,Sh=[],dO=[],vL=0,T9={get idle(){return!yA.size&&!Sh.length},start(n){vL>n.priority?(yA.add(n),us.onStart(Q9e)):(fue(n),us(Iz))},advance:Iz,sort(n){if(vL)us.onFrame(()=>T9.sort(n));else{const e=Sh.indexOf(n);~e&&(Sh.splice(e,1),due(n))}},clear(){Sh=[],yA.clear()}};function Q9e(){yA.forEach(fue),yA.clear(),us(Iz)}function fue(n){Sh.includes(n)||due(n)}function due(n){Sh.splice(e7e(Sh,e=>e.priority>n.priority),0,n)}function Iz(n){const e=dO;for(let t=0;t<Sh.length;t++){const r=Sh[t];vL=r.priority,r.idle||(A9(r),r.advance(n),r.idle||e.push(r))}return vL=0,dO=Sh,dO.length=0,Sh=e,Sh.length>0}function e7e(n,e){const t=n.findIndex(e);return t<0?n.length:t}var t7e={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Hf="[-+]?\\d*\\.?\\d+",_L=Hf+"%";function x3(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}var n7e=new RegExp("rgb"+x3(Hf,Hf,Hf)),r7e=new RegExp("rgba"+x3(Hf,Hf,Hf,Hf)),i7e=new RegExp("hsl"+x3(Hf,_L,_L)),s7e=new RegExp("hsla"+x3(Hf,_L,_L,Hf)),o7e=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,a7e=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,l7e=/^#([0-9a-fA-F]{6})$/,c7e=/^#([0-9a-fA-F]{8})$/;function u7e(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=l7e.exec(n))?parseInt(e[1]+"ff",16)>>>0:av&&av[n]!==void 0?av[n]:(e=n7e.exec(n))?(Wx(e[1])<<24|Wx(e[2])<<16|Wx(e[3])<<8|255)>>>0:(e=r7e.exec(n))?(Wx(e[1])<<24|Wx(e[2])<<16|Wx(e[3])<<8|uJ(e[4]))>>>0:(e=o7e.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=c7e.exec(n))?parseInt(e[1],16)>>>0:(e=a7e.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=i7e.exec(n))?(lJ(cJ(e[1]),LI(e[2]),LI(e[3]))|255)>>>0:(e=s7e.exec(n))?(lJ(cJ(e[1]),LI(e[2]),LI(e[3]))|uJ(e[4]))>>>0:null}function pO(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function lJ(n,e,t){const r=t<.5?t*(1+e):t+e-t*e,i=2*t-r,s=pO(i,r,n+1/3),a=pO(i,r,n),l=pO(i,r,n-1/3);return Math.round(s*255)<<24|Math.round(a*255)<<16|Math.round(l*255)<<8}function Wx(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function cJ(n){return(parseFloat(n)%360+360)%360/360}function uJ(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function LI(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function hJ(n){let e=u7e(n);if(e===null)return n;e=e||0;const t=(e&4278190080)>>>24,r=(e&16711680)>>>16,i=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${r}, ${i}, ${s})`}var AT=(n,e,t)=>{if(ia.fun(n))return n;if(ia.arr(n))return AT({range:n,output:e,extrapolate:t});if(ia.str(n.output[0]))return S9(n);const r=n,i=r.output,s=r.range||[0,1],a=r.extrapolateLeft||r.extrapolate||"extend",l=r.extrapolateRight||r.extrapolate||"extend",o=r.easing||(h=>h);return h=>{const d=f7e(h,s);return h7e(h,s[d],s[d+1],i[d],i[d+1],o,a,l,r.map)}};function h7e(n,e,t,r,i,s,a,l,o){let h=o?o(n):n;if(h<e){if(a==="identity")return h;a==="clamp"&&(h=e)}if(h>t){if(l==="identity")return h;l==="clamp"&&(h=t)}return r===i?r:e===t?n<=e?r:i:(e===-1/0?h=-h:t===1/0?h=h-e:h=(h-e)/(t-e),h=s(h),r===-1/0?h=-h:i===1/0?h=h+r:h=h*(i-r)+r,h)}function f7e(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}var TT=Symbol.for("FluidValue.get"),MT=Symbol.for("FluidValue.observers"),yL=n=>!!(n&&n[TT]),xL=n=>n&&n[TT]?n[TT]():n;function d7e(n,e){n.eventObserved?n.eventObserved(e):n(e)}function Rz(n,e){const t=n[MT];t&&t.forEach(r=>{d7e(r,e)})}var p7e=class{constructor(n){if(!n&&!(n=this.get))throw Error("Unknown getter");m7e(this,n)}},m7e=(n,e)=>mue(n,TT,e);function pue(n,e){if(n[TT]){let t=n[MT];t||mue(n,MT,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function Pz(n,e){const t=n[MT];if(t&&t.has(e)){const r=t.size-1;r?t.delete(e):n[MT]=null,n.observerRemoved&&n.observerRemoved(r,e)}}var mue=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),fR=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g7e=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,fJ=new RegExp(`(${fR.source})(%|[a-z]+)`,"i"),v7e=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,b3=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,gue=n=>{const[e,t]=_7e(n);if(!e||w9())return n;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(t&&t.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(t);return i||n}else{if(t&&b3.test(t))return gue(t);if(t)return t}return n},_7e=n=>{const e=b3.exec(n);if(!e)return[,];const[,t,r]=e;return[t,r]},mO,y7e=(n,e,t,r,i)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(r)}, ${i})`,vue=n=>{mO||(mO=av?new RegExp(`(${Object.keys(av).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(s=>xL(s).replace(b3,gue).replace(g7e,hJ).replace(mO,hJ)),t=e.map(s=>s.match(fR).map(Number)),i=t[0].map((s,a)=>t.map(l=>{if(!(a in l))throw Error('The arity of each "output" value must be equal');return l[a]})).map(s=>AT({...n,output:s}));return s=>{var o;const a=!fJ.test(e[0])&&((o=e.find(h=>fJ.test(h)))==null?void 0:o.replace(fR,""));let l=0;return e[0].replace(fR,()=>`${i[l++](s)}${a||""}`).replace(v7e,y7e)}},_ue="react-spring: ",yue=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${_ue}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},x7e=yue(console.warn);function b7e(){x7e(`${_ue}The "interpolate" function is deprecated in v9 (use "to" instead)`)}yue(console.warn);function xue(n){return ia.str(n)&&(n[0]=="#"||/\d/.test(n)||!w9()&&b3.test(n)||n in(av||{}))}var bue=w9()?Ae.useEffect:Ae.useLayoutEffect,w7e=()=>{const n=Ae.useRef(!1);return bue(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function S7e(){const n=Ae.useState()[1],e=w7e();return()=>{e.current&&n(Math.random())}}function A7e(n,e){const[t]=Ae.useState(()=>({inputs:e,result:n()})),r=Ae.useRef(),i=r.current;let s=i;return s?e&&s.inputs&&T7e(e,s.inputs)||(s={inputs:e,result:n()}):s=t,Ae.useEffect(()=>{r.current=s,i==t&&(t.inputs=t.result=void 0)},[s]),s.result}function T7e(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var M7e=n=>Ae.useEffect(n,C7e),C7e=[],CT=Symbol.for("Animated:node"),E7e=n=>!!n&&n[CT]===n,M9=n=>n&&n[CT],wue=(n,e)=>Y9e(n,CT,e),C9=n=>n&&n[CT]&&n[CT].getPayload(),Sue=class{constructor(){wue(this,this)}getPayload(){return this.payload||[]}},w3=class extends Sue{constructor(n){super(),this._value=n,this.done=!0,this.durationProgress=0,ia.num(this._value)&&(this.lastPosition=this._value)}static create(n){return new w3(n)}getPayload(){return[this]}getValue(){return this._value}setValue(n,e){return ia.num(n)&&(this.lastPosition=n,e&&(n=Math.round(n/e)*e,this.done&&(this.lastPosition=n))),this._value===n?!1:(this._value=n,!0)}reset(){const{done:n}=this;this.done=!1,ia.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,n&&(this.lastVelocity=null),this.v0=null)}},E9=class extends w3{constructor(n){super(0),this._string=null,this._toString=AT({output:[n,n]})}static create(n){return new E9(n)}getValue(){const n=this._string;return n??(this._string=this._toString(this._value))}setValue(n){if(ia.str(n)){if(n==this._string)return!1;this._string=n,this._value=1}else if(super.setValue(n))this._string=null;else return!1;return!0}reset(n){n&&(this._toString=AT({output:[this.getValue(),n]})),this._value=0,super.reset()}},bL={dependencies:null},I9=class extends Sue{constructor(n){super(),this.source=n,this.setValue(n)}getValue(n){const e={};return Ez(this.source,(t,r)=>{E7e(t)?e[r]=t.getValue(n):yL(t)?e[r]=xL(t):n||(e[r]=t)}),e}setValue(n){this.source=n,this.payload=this._makePayload(n)}reset(){this.payload&&Nm(this.payload,n=>n.reset())}_makePayload(n){if(n){const e=new Set;return Ez(n,this._addToPayload,e),Array.from(e)}}_addToPayload(n){bL.dependencies&&yL(n)&&bL.dependencies.add(n);const e=C9(n);e&&Nm(e,t=>this.add(t))}},Aue=class extends I9{constructor(n){super(n)}static create(n){return new Aue(n)}getValue(){return this.source.map(n=>n.getValue())}setValue(n){const e=this.getPayload();return n.length==e.length?e.map((t,r)=>t.setValue(n[r])).some(Boolean):(super.setValue(n.map(I7e)),!0)}};function I7e(n){return(xue(n)?E9:w3).create(n)}function R7e(n){const e=M9(n);return e?e.constructor:ia.arr(n)?Aue:xue(n)?E9:w3}var dJ=(n,e)=>{const t=!ia.fun(n)||n.prototype&&n.prototype.isReactComponent;return Ae.forwardRef((r,i)=>{const s=Ae.useRef(null),a=t&&Ae.useCallback(S=>{s.current=D7e(i,S)},[i]),[l,o]=L7e(r,e),h=S7e(),d=()=>{const S=s.current;if(t&&!S)return;(S?e.applyAnimatedValues(S,l.getValue(!0)):!1)===!1&&h()},m=new P7e(d,o),v=Ae.useRef();bue(()=>(v.current=m,Nm(o,S=>pue(S,m)),()=>{v.current&&(Nm(v.current.deps,S=>Pz(S,v.current)),us.cancel(v.current.update))})),Ae.useEffect(d,[]),M7e(()=>()=>{const S=v.current;Nm(S.deps,E=>Pz(E,S))});const y=e.getComponentProps(l.getValue());return Ae.createElement(n,{...y,ref:a})})},P7e=class{constructor(n,e){this.update=n,this.deps=e}eventObserved(n){n.type=="change"&&us.write(this.update)}};function L7e(n,e){const t=new Set;return bL.dependencies=t,n.style&&(n={...n,style:e.createAnimatedStyle(n.style)}),n=new I9(n),bL.dependencies=null,[n,t]}function D7e(n,e){return n&&(ia.fun(n)?n(e):n.current=e),e}var pJ=Symbol.for("AnimatedComponent"),B7e=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=i=>new I9(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:r},s=a=>{const l=mJ(a)||"Anonymous";return ia.str(a)?a=s[a]||(s[a]=dJ(a,i)):a=a[pJ]||(a[pJ]=dJ(a,i)),a.displayName=`Animated(${l})`,a};return Ez(n,(a,l)=>{ia.arr(n)&&(l=mJ(a)),s[l]=s(a)}),{animated:s}},mJ=n=>ia.str(n)?n:n&&ia.str(n.displayName)?n.displayName:ia.fun(n)&&n.name||null,gJ=n=>n instanceof Tue,k7e=1,Tue=class extends p7e{constructor(){super(...arguments),this.id=k7e++,this._priority=0}get priority(){return this._priority}set priority(n){this._priority!=n&&(this._priority=n,this._onPriorityChange(n))}get(){const n=M9(this);return n&&n.getValue()}to(...n){return fw.to(this,n)}interpolate(...n){return b7e(),fw.to(this,n)}toJSON(){return this.get()}observerAdded(n){n==1&&this._attach()}observerRemoved(n){n==0&&this._detach()}_attach(){}_detach(){}_onChange(n,e=!1){Rz(this,{type:"change",parent:this,value:n,idle:e})}_onPriorityChange(n){this.idle||T9.sort(this),Rz(this,{type:"priority",parent:this,priority:n})}},R9=({children:n,...e})=>{const t=Ae.useContext(wL),r=e.pause||!!t.pause,i=e.immediate||!!t.immediate;e=A7e(()=>({pause:r,immediate:i}),[r,i]);const{Provider:s}=wL;return Ae.createElement(s,{value:e},n)},wL=O7e(R9,{});R9.Provider=wL.Provider;R9.Consumer=wL.Consumer;function O7e(n,e){return Object.assign(n,Ae.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}var F7e=class extends Tue{constructor(n,e){super(),this.source=n,this.idle=!0,this._active=new Set,this.calc=AT(...e);const t=this._get(),r=R7e(t);wue(this,r.create(t))}advance(n){const e=this._get(),t=this.get();K9e(e,t)||(M9(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&vJ(this._active)&&gO(this)}_get(){const n=ia.arr(this.source)?this.source.map(xL):PI(xL(this.source));return this.calc(...n)}_start(){this.idle&&!vJ(this._active)&&(this.idle=!1,Nm(C9(this),n=>{n.done=!1}),fw.skipAnimation?(us.batchedUpdates(()=>this.advance()),gO(this)):T9.start(this))}_attach(){let n=1;Nm(PI(this.source),e=>{yL(e)&&pue(e,this),gJ(e)&&(e.idle||this._active.add(e),n=Math.max(n,e.priority+1))}),this.priority=n,this._start()}_detach(){Nm(PI(this.source),n=>{yL(n)&&Pz(n,this)}),this._active.clear(),gO(this)}eventObserved(n){n.type=="change"?n.idle?this.advance():(this._active.add(n.parent),this._start()):n.type=="idle"?this._active.delete(n.parent):n.type=="priority"&&(this.priority=PI(this.source).reduce((e,t)=>Math.max(e,(gJ(t)?t.priority:0)+1),0))}};function N7e(n){return n.idle!==!1}function vJ(n){return!n.size||Array.from(n).every(N7e)}function gO(n){n.idle||(n.idle=!0,Nm(C9(n),e=>{e.done=!0}),Rz(n,{type:"idle",parent:n}))}fw.assign({createStringInterpolator:vue,to:(n,e)=>new F7e(n,e)});var z7e=["primitive"].concat(Object.keys(Nne).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));fw.assign({createStringInterpolator:vue,colors:t7e,frameLoop:"demand"});Zwe(()=>{us.advance()});var U7e=B7e(z7e,{applyAnimatedValues:uy}),G7e=U7e.animated;const V7e="/about_portfolio/assets/island-BN767CUw.glb",H7e=({isRotating:n,setIsRotating:e,setCurrentStage:t,...r})=>{const i=Ae.useRef(),{gl:s,viewport:a}=rre(),{nodes:l,materials:o}=rg(V7e),h=Ae.useRef(0),d=Ae.useRef(0),m=.95,v=C=>{C.stopPropagation(),C.preventDefault(),e(!0);const L=C.touches?C.touches[0].clientX:C.clientX;h.current=L},y=C=>{C.stopPropagation(),C.preventDefault(),e(!1)},S=C=>{if(C.stopPropagation(),C.preventDefault(),n){const L=C.touches?C.touches[0].clientX:C.clientX,k=(L-h.current)/a.width;i.current.rotation.y+=k*.01*Math.PI,h.current=L,d.current=k*.01*Math.PI}},E=C=>{C.key==="ArrowLeft"?(n||e(!0),i.current.rotation.y+=.01*Math.PI,d.current=.0125):C.key==="ArrowRight"&&(n||e(!0),i.current.rotation.y-=.01*Math.PI,d.current=-.0125)},M=C=>{(C.key==="ArrowLeft"||C.key==="ArrowRight")&&e(!1)};return eM(()=>{if(!n)d.current*=m,Math.abs(d.current)<.001&&(d.current=0),i.current.rotation.y+=d.current;else{const L=(i.current.rotation.y%(2*Math.PI)+2*Math.PI)%(2*Math.PI);switch(!0){case(L>=5.45&&L<=5.85):t(4);break;case(L>=.85&&L<=1.3):t(3);break;case(L>=2.4&&L<=2.6):t(2);break;case(L>=4.25&&L<=4.75):t(1);break;default:t(null)}}}),Ae.useEffect(()=>{const C=s.domElement;return C.addEventListener("pointerdown",v),C.addEventListener("pointerup",y),C.addEventListener("pointermove",S),document.addEventListener("keydown",E),document.addEventListener("keyup",M),()=>{C.removeEventListener("pointerdown",v),C.removeEventListener("pointerup",y),C.removeEventListener("pointermove",S),document.removeEventListener("keydown",E),document.removeEventListener("keyup",M)}},[s,v,y,S]),me.jsxs(G7e.group,{ref:i,...r,children:[me.jsx("mesh",{geometry:l.polySurface944_tree_body_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface945_tree1_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface946_tree2_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface947_tree1_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface948_tree_body_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface949_tree_body_0.geometry,material:o.PaletteMaterial001}),me.jsx("mesh",{geometry:l.pCube11_rocks1_0.geometry,material:o.PaletteMaterial001})]})},j7e="/about_portfolio/assets/plane-Dk3bBBjR.glb",W7e=({isRotating:n,...e})=>{const t=Ae.useRef(),{scene:r,animations:i}=rg(j7e),{actions:s}=gU(i,t);return Ae.useEffect(()=>{n?s["Take 001"].play():s["Take 001"].stop()},[s,n]),me.jsx("mesh",{...e,ref:t,children:me.jsx("primitive",{object:r})})},X7e="/about_portfolio/assets/sky-B0A1kvoP.glb",$7e=({isRotating:n})=>{const e=rg(X7e),t=Ae.useRef();return eM((r,i)=>{n&&(t.current.rotation.y+=.15*i)}),me.jsx("mesh",{ref:t,children:me.jsx("primitive",{object:e.scene})})},q7e=()=>{const n=Ae.useRef(new Audio(H9e));n.current.volume=.4,n.current.loop=!0;const[e,t]=Ae.useState(!1),[r,i]=Ae.useState(1),[s,a]=Ae.useState(!1);Ae.useEffect(()=>(s&&n.current.play(),()=>{n.current.pause()}),[s]);const l=()=>{let S=null,E=[0,7.5,-43],M=[.1,4.7,0];return window.innerWidth<768?S=[.2,.2,.2]:S=[.4,.4,.4],[S,E,M]},[o,h,d]=l(),m=()=>{let S,E;return window.innerWidth<768?(S=[1.5,1.5,1.5],E=[2,0,-1]):(S=[3,3,3],E=[8,0,-4]),[S,E]},[v,y]=m();return me.jsxs("section",{className:"w-full h-screen relative",children:[me.jsxs("div",{className:"absolute top-28 left-0 right-0 z-10 flex items-center justify-center",children:[r&&me.jsx(W9e,{currentStage:r})," "]}),me.jsx(wD,{className:`w-full h-screen bg-transparent ${e?"cursor-grabbing":"cursor-grab"} `,camera:{near:.1,far:1e3},children:me.jsxs(Ae.Suspense,{fallback:me.jsx(vU,{}),children:[me.jsx("directionalLight",{position:[1,1,1],intensity:2}),me.jsx("ambientLight",{intensity:.5}),me.jsx("hemisphereLight",{skyColor:"#b1e1ff",groundColor:"#000000",intensity:1}),me.jsx($ke,{}),me.jsx(W7e,{scale:v,position:y,isRotating:e,rotation:[10,0,10]}),me.jsx($7e,{isRotating:e}),me.jsx(H7e,{position:h,scale:o,rotation:d,isRotating:e,setIsRotating:t,setCurrentStage:i}),me.jsx(Kke,{rotation:[.1,90,0],position:[0,-10,-80],scale:[.6,.6,.6]})]})}),me.jsx("div",{className:"absolute bottom-2 left-2",children:me.jsx("img",{src:s?NSe:zSe,alt:"sound",className:"w-10 h-10 cursor-pointer object-contain",onClick:()=>a(!s)})})]})},Z7e=()=>me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:["My ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:" Projects"})]}),me.jsx("div",{className:"mt-5 flex flex-col gap-3 text-slate-500",children:me.jsx("p",{children:"I've embarked on numerous projects throughout the years, but these are the ones I hold closest to my heart. Mayn of them are open-source, so if you come across something that piques your interest, feel free to explore the codebase and contribute your ideas for further enhancements. You collaboration is highly valued! "})}),me.jsx("div",{className:"flex flex-wrap my-20 gap-16",children:v9e.map(n=>me.jsxs("div",{className:"lg:w=[400px] w-full",children:[me.jsxs("div",{className:"block-container w-12 h-12",children:[me.jsx("div",{className:`btn-back rounded-xl ${n.theme}`}),me.jsx("div",{className:"btn-front rounded-xl flex justify-center items-center",children:me.jsx("img",{src:n.iconUrl,alt:"Project Icon",className:"w-1/2 h-1/2 object-contain"})})]}),me.jsxs("div",{className:"mt-5 flex flex-col",children:[me.jsx("h4",{className:"text-2xl font-poppins font-semibold",children:n.name}),me.jsx("p",{className:"whitespace-pre-wrap mt-2 text-slate-500",children:n.description}),me.jsxs("div",{className:"mt-5 flex items-center gap-2 font-poppins",children:[me.jsx(G0,{to:n.link,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-blue-600",children:"Live Link"}),me.jsx("img",{src:xre,alt:"arrow",className:"w-4 h-4 object-contain"})]})]})]},n.name))}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(g9,{})]}),Y7e=()=>me.jsx("main",{className:"bg-slate-300/20 h-full",children:me.jsxs(Cge,{basename:"/about_portfolio/",children:[me.jsx(gSe,{}),me.jsx(Ae.Suspense,{fallback:me.jsx(vU,{}),children:me.jsxs(xge,{children:[me.jsx(qd,{path:"/",element:me.jsx(q7e,{})}),me.jsx(qd,{path:"/about",element:me.jsx(D9e,{})}),me.jsx(qd,{path:"/projects",element:me.jsx(Z7e,{})}),me.jsx(qd,{path:"/arts",element:me.jsx(B9e,{})}),qce.map((n,e)=>me.jsx(qd,{path:n.path,element:me.jsx(n.component,{})},e)),Zce.map((n,e)=>me.jsx(qd,{path:n.path,element:me.jsx(n.component,{})},e)),Yce.map((n,e)=>me.jsx(qd,{path:n.path,element:me.jsx(n.component,{})},e)),Kce.map((n,e)=>me.jsx(qd,{path:n.path,element:me.jsx(n.component,{})},e)),me.jsx(qd,{path:"/contact",element:me.jsx(V9e,{})})]})})]})});vO.createRoot(document.getElementById("root")).render(me.jsx(Y7e,{}))});export default K7e();
